<!DOCTYPE html>
<html><head><title>NativeWrapper.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(1474);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.CoreCLR.Eventing/DotNetCode/Eventing/Reader/NativeWrapper.cs" target="_top">DotNetCode\Eventing\Reader\NativeWrapper.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.CoreCLR.Eventing" target="_top">src\Microsoft.PowerShell.CoreCLR.Eventing\Microsoft.PowerShell.CoreCLR.Eventing.csproj</a> (Microsoft.PowerShell.CoreCLR.Eventing)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="c">/*============================================================
**
**
** Purpose:
** This internal class contains wrapper methods over the Native
** Methods of the Eventlog API.   Unlike the raw Native Methods,
** these methods throw EventLogExceptions, check platform
** availability and perform additional helper functionality
** specific to function.  Also, all methods of this class expose
** the Link Demand for Unmanaged Permission to callers.
**
============================================================*/</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Principal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i n">Eventing</span>.<span class="i n">Reader</span>
{
    <b>internal static class</b> <a id="d1b7c153b72fb44f" href="../../../R/d1b7c153b72fb44f.html" target="n" data-glyph="2,0" class="t t">NativeWrapper</a>
    {
        <b>public class</b> <a id="6df5076a255b8a01" href="../../../R/6df5076a255b8a01.html" target="n" data-glyph="0,1" class="t t">SystemProperties</a>
        {
            <span class="c">// indicates if the SystemProperties values were already computed (for this event Instance, surely).</span>
            <b>public bool</b> <a id="4ab70f630a56cd8c" href="../../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">filled</a> = <b>false</b>;
 
            <b>public ushort</b>? <a id="37a77a9b917e5ae7" href="../../../R/37a77a9b917e5ae7.html" target="n" data-glyph="42,2" class="i field">Id</a> = <b>null</b>;
            <b>public byte</b>? <a id="3cfe82313e5c97b0" href="../../../R/3cfe82313e5c97b0.html" target="n" data-glyph="42,2" class="i field">Version</a> = <b>null</b>;
            <b>public ushort</b>? <a id="607d639d6481a3bf" href="../../../R/607d639d6481a3bf.html" target="n" data-glyph="42,2" class="i field">Qualifiers</a> = <b>null</b>;
            <b>public byte</b>? <a id="254c83dcd89b7477" href="../../../R/254c83dcd89b7477.html" target="n" data-glyph="42,2" class="i field">Level</a> = <b>null</b>;
            <b>public ushort</b>? <a id="9d1de906d8483232" href="../../../R/9d1de906d8483232.html" target="n" data-glyph="42,2" class="i field">Task</a> = <b>null</b>;
            <b>public byte</b>? <a id="bdcd89e317ccd97d" href="../../../R/bdcd89e317ccd97d.html" target="n" data-glyph="42,2" class="i field">Opcode</a> = <b>null</b>;
            <b>public ulong</b>? <a id="dbec06cbbc0746e6" href="../../../R/dbec06cbbc0746e6.html" target="n" data-glyph="42,2" class="i field">Keywords</a> = <b>null</b>;
            <b>public ulong</b>? <a id="501ffd491b0b281b" href="../../../R/501ffd491b0b281b.html" target="n" data-glyph="42,2" class="i field">RecordId</a> = <b>null</b>;
            <b>public string</b> <a id="b542c7ece9b6f3a3" href="../../../R/b542c7ece9b6f3a3.html" target="n" data-glyph="42,2" class="i field">ProviderName</a> = <b>null</b>;
            <b>public</b> <span class="i">Guid</span>? <a id="59e94ab6799734c3" href="../../../R/59e94ab6799734c3.html" target="n" data-glyph="42,2" class="i field">ProviderId</a> = <b>null</b>;
            <b>public string</b> <a id="8a5be370450e0ee9" href="../../../R/8a5be370450e0ee9.html" target="n" data-glyph="42,2" class="i field">ChannelName</a> = <b>null</b>;
            <b>public uint</b>? <a id="b59f566d02231c87" href="../../../R/b59f566d02231c87.html" target="n" data-glyph="42,2" class="i field">ProcessId</a> = <b>null</b>;
            <b>public uint</b>? <a id="3b39e13d2807c803" href="../../../R/3b39e13d2807c803.html" target="n" data-glyph="42,2" class="i field">ThreadId</a> = <b>null</b>;
            <b>public string</b> <a id="f28054d62c259f77" href="../../../R/f28054d62c259f77.html" target="n" data-glyph="42,2" class="i field">ComputerName</a> = <b>null</b>;
            <b>public</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Principal</span>.<span class="i">SecurityIdentifier</span> <a id="2d72edb6578683ef" href="../../../R/2d72edb6578683ef.html" target="n" data-glyph="42,2" class="i field">UserId</a> = <b>null</b>;
            <b>public</b> <span class="i">DateTime</span>? <a id="1d36cbf361b654d2" href="../../../R/1d36cbf361b654d2.html" target="n" data-glyph="42,2" class="i field">TimeCreated</a> = <b>null</b>;
            <b>public</b> <span class="i">Guid</span>? <a id="8b29c5e20ffa2e99" href="../../../R/8b29c5e20ffa2e99.html" target="n" data-glyph="42,2" class="i field">ActivityId</a> = <b>null</b>;
            <b>public</b> <span class="i">Guid</span>? <a id="17eb702f1dbb1df8" href="../../../R/17eb702f1dbb1df8.html" target="n" data-glyph="42,2" class="i field">RelatedActivityId</a> = <b>null</b>;
 
            <b>public</b> <a id="316fe2e383b987ee" href="../../../R/../../0000000000.html" target="n" data-glyph="72,2" class="t constructor">SystemProperties</a>()
            {
            }
        }
 
        <b>private static void</b> <a id="29862274e5436431" href="../../../R/29862274e5436431.html" target="n" data-glyph="76,1" class="i method">ThrowEventLogException</a>(<b>int</b> <span id="r0 rd" class="r0 r">errorCode</span>)
        {
            <b>string</b> <span id="r1 rd" class="r1 r">message</span> = <b>new</b> <span class="i">Win32Exception</span>(<span class="r0 r">errorCode</span>).<span class="i">Message</span>;
 
            <b>switch</b> (<span class="r0 r">errorCode</span>)
            {
                <b>case</b> 2:
                <b>case</b> 3:
                <b>case</b> 15007:
                <b>case</b> 15027:
                <b>case</b> 15028:
                <b>case</b> 15002:
                    <b>throw</b> <b>new</b> <span class="i">EventLogNotFoundException</span>(<span class="r1 r">message</span>);
 
                <b>case</b> 13:
                <b>case</b> 15005:
                    <b>throw</b> <b>new</b> <span class="i">EventLogInvalidDataException</span>(<span class="r1 r">message</span>);
 
                <b>case</b> 1818: <span class="c">// RPC_S_CALL_CANCELED is converted to ERROR_CANCELLED</span>
                <b>case</b> 1223:
                    <b>throw</b> <b>new</b> <span class="i">OperationCanceledException</span>();
 
                <b>case</b> 15037:
                    <b>throw</b> <b>new</b> <span class="i">EventLogProviderDisabledException</span>(<span class="r1 r">message</span>);
 
                <b>case</b> 5:
                    <b>throw</b> <b>new</b> <span class="i">UnauthorizedAccessException</span>();
 
                <b>case</b> 15011:
                <b>case</b> 15012:
                    <b>throw</b> <b>new</b> <span class="i">EventLogReadingException</span>(<span class="r1 r">message</span>);
 
                <b>default</b>:
                    <b>throw</b> <b>new</b> <span class="i">EventLogException</span>(<span class="r1 r">message</span>);
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="9e621a2a057f3b40" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtQuery</a>(
                            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r2 rd" class="r2 r">session</span>,
                            <b>string</b> <span id="r3 rd" class="r3 r">path</span>,
                            <b>string</b> <span id="r4 rd" class="r4 r">query</span>,
                            <b>int</b> <span id="r5 rd" class="r5 r">flags</span>)
        {
            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r6 rd" class="r6 r">handle</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#a1eaf7fb9b8b2ebc" class="i method">EvtQuery</a>(<span class="r2 r">session</span>, <span class="r3 r">path</span>, <span class="r4 r">query</span>, <span class="r5 r">flags</span>);
            <b>int</b> <span id="r7 rd" class="r7 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (<span class="r6 r">handle</span>.<a href="EventLogHandle.cs.html#122cef311c35274f" class="i property">IsInvalid</a>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r7 r">win32Error</span>);
            <b>return</b> <span class="r6 r">handle</span>;
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static void</b> <a id="a9678bf1c1f9570f" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtSeek</a>(
                            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r8 rd" class="r8 r">resultSet</span>,
                            <b>long</b> <span id="r9 rd" class="r9 r">position</span>,
                            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r10 rd" class="r10 r">bookmark</span>,
                            <b>int</b> <span id="r11 rd" class="r11 r">timeout</span>,
                            <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f4a2a79568df4a00" class="t t">EvtSeekFlags</a> <span id="r12 rd" class="r12 r">flags</span>)
        {
            <b>bool</b> <span id="r13 rd" class="r13 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#860c2b5c1a0ed671" class="i method">EvtSeek</a>(<span class="r8 r">resultSet</span>, <span class="r9 r">position</span>, <span class="r10 r">bookmark</span>, <span class="r11 r">timeout</span>, <span class="r12 r">flags</span>);
            <b>int</b> <span id="r14 rd" class="r14 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (!<span class="r13 r">status</span>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r14 r">win32Error</span>);
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static bool</b> <a id="5e80147fcec348c8" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtNext</a>(
                            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r15 rd" class="r15 r">queryHandle</span>,
                            <b>int</b> <span id="r16 rd" class="r16 r">eventSize</span>,
                            <span class="i">IntPtr</span>[] <span id="r17 rd" class="r17 r">events</span>,
                            <b>int</b> <span id="r18 rd" class="r18 r">timeout</span>,
                            <b>int</b> <span id="r19 rd" class="r19 r">flags</span>,
                            <b>ref int</b> <span id="r20 rd" class="r20 r">returned</span>)
        {
            <b>bool</b> <span id="r21 rd" class="r21 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#9f5b8ad422e8f9dc" class="i method">EvtNext</a>(<span class="r15 r">queryHandle</span>, <span class="r16 r">eventSize</span>, <span class="r17 r">events</span>, <span class="r18 r">timeout</span>, <span class="r19 r">flags</span>, <b>ref</b> <span class="r20 r">returned</span>);
            <b>int</b> <span id="r22 rd" class="r22 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (!<span class="r21 r">status</span> &amp;&amp; <span class="r22 r">win32Error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#677de97964ba203c" class="i field">ERROR_NO_MORE_ITEMS</a>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r22 r">win32Error</span>);
            <b>return</b> <span class="r22 r">win32Error</span> == 0;
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static void</b> <a id="9f3024a20155a346" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtCancel</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r23 rd" class="r23 r">handle</span>)
        {
            <b>if</b> (!<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#b447446477be62ee" class="i method">EvtCancel</a>(<span class="r23 r">handle</span>))
            {
                <b>int</b> <span id="r24 rd" class="r24 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r24 r">win32Error</span>);
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static void</b> <a id="f86dec713bff757e" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtClose</a>(<span class="i">IntPtr</span> <span id="r25 rd" class="r25 r">handle</span>)
        {
            <span class="c">//</span>
            <span class="c">// purposely don&#39;t check and throw - this is</span>
            <span class="c">// always called in cleanup / finalize / etc..</span>
            <span class="c">//</span>
            <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#6fccaad588c37451" class="i method">EvtClose</a>(<span class="r25 r">handle</span>);
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="7fa1bfd2f5085f64" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtOpenProviderMetadata</a>(
                            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r26 rd" class="r26 r">session</span>,
                            <b>string</b> <span id="r27 rd" class="r27 r">ProviderId</span>,
                            <b>string</b> <span id="r28 rd" class="r28 r">logFilePath</span>,
                            <b>int</b> <span id="r29 rd" class="r29 r">locale</span>,
                            <b>int</b> <span id="r30 rd" class="r30 r">flags</span>)
        {
            <span class="c">//</span>
            <span class="c">// ignore locale and pass 0 instead: that way, the thread locale will be retrieved in the API layer</span>
            <span class="c">// and the &quot;strict rendering&quot; flag will NOT be set.  Otherwise, the fall back logic is broken and the descriptions</span>
            <span class="c">// are not returned if the exact locale is not present on the server.</span>
            <span class="c">//</span>
            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r31 rd" class="r31 r">handle</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#a1552dc30a729ab6" class="i method">EvtOpenPublisherMetadata</a>(<span class="r26 r">session</span>, <span class="r27 r">ProviderId</span>, <span class="r28 r">logFilePath</span>, 0, <span class="r30 r">flags</span>);
 
            <b>int</b> <span id="r32 rd" class="r32 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (<span class="r31 r">handle</span>.<a href="EventLogHandle.cs.html#122cef311c35274f" class="i property">IsInvalid</a>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r32 r">win32Error</span>);
            <b>return</b> <span class="r31 r">handle</span>;
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static int</b> <a id="a5d7bdda9368571e" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtGetObjectArraySize</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r33 rd" class="r33 r">objectArray</span>)
        {
            <b>int</b> <span id="r34 rd" class="r34 r">arraySize</span>;
            <b>bool</b> <span id="r35 rd" class="r35 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#6f15393865ac1582" class="i method">EvtGetObjectArraySize</a>(<span class="r33 r">objectArray</span>, <b>out</b> <span class="r34 r">arraySize</span>);
            <b>int</b> <span id="r36 rd" class="r36 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (!<span class="r35 r">status</span>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r36 r">win32Error</span>);
            <b>return</b> <span class="r34 r">arraySize</span>;
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="1b034a7fa55b54f2" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtOpenEventMetadataEnum</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r37 rd" class="r37 r">ProviderMetadata</span>, <b>int</b> <span id="r38 rd" class="r38 r">flags</span>)
        {
            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r39 rd" class="r39 r">emEnumHandle</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#fc1f0d8fb796ebc8" class="i method">EvtOpenEventMetadataEnum</a>(<span class="r37 r">ProviderMetadata</span>, <span class="r38 r">flags</span>);
            <b>int</b> <span id="r40 rd" class="r40 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (<span class="r39 r">emEnumHandle</span>.<a href="EventLogHandle.cs.html#122cef311c35274f" class="i property">IsInvalid</a>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r40 r">win32Error</span>);
            <b>return</b> <span class="r39 r">emEnumHandle</span>;
        }
 
        <span class="c">// returns null if EOF</span>
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="8c9d9d446ec9681f" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtNextEventMetadata</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r41 rd" class="r41 r">eventMetadataEnum</span>, <b>int</b> <span id="r42 rd" class="r42 r">flags</span>)
        {
            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r43 rd" class="r43 r">emHandle</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#868077f75748d85d" class="i method">EvtNextEventMetadata</a>(<span class="r41 r">eventMetadataEnum</span>, <span class="r42 r">flags</span>);
            <b>int</b> <span id="r44 rd" class="r44 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
 
            <b>if</b> (<span class="r43 r">emHandle</span>.<a href="EventLogHandle.cs.html#122cef311c35274f" class="i property">IsInvalid</a>)
            {
                <b>if</b> (<span class="r44 r">win32Error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#677de97964ba203c" class="i field">ERROR_NO_MORE_ITEMS</a>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r44 r">win32Error</span>);
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <span class="r43 r">emHandle</span>;
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="31805ef0d9145483" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtOpenChannelEnum</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r45 rd" class="r45 r">session</span>, <b>int</b> <span id="r46 rd" class="r46 r">flags</span>)
        {
            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r47 rd" class="r47 r">channelEnum</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#403f93c0bbe89fda" class="i method">EvtOpenChannelEnum</a>(<span class="r45 r">session</span>, <span class="r46 r">flags</span>);
            <b>int</b> <span id="r48 rd" class="r48 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (<span class="r47 r">channelEnum</span>.<a href="EventLogHandle.cs.html#122cef311c35274f" class="i property">IsInvalid</a>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r48 r">win32Error</span>);
            <b>return</b> <span class="r47 r">channelEnum</span>;
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="cf4c34f05e8389c4" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtOpenProviderEnum</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r49 rd" class="r49 r">session</span>, <b>int</b> <span id="r50 rd" class="r50 r">flags</span>)
        {
            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r51 rd" class="r51 r">pubEnum</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#a7b7d4ae18b04c69" class="i method">EvtOpenPublisherEnum</a>(<span class="r49 r">session</span>, <span class="r50 r">flags</span>);
            <b>int</b> <span id="r52 rd" class="r52 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (<span class="r51 r">pubEnum</span>.<a href="EventLogHandle.cs.html#122cef311c35274f" class="i property">IsInvalid</a>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r52 r">win32Error</span>);
            <b>return</b> <span class="r51 r">pubEnum</span>;
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="af8992ac62f6a3a5" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtOpenChannelConfig</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r53 rd" class="r53 r">session</span>, <b>string</b> <span id="r54 rd" class="r54 r">channelPath</span>, <b>int</b> <span id="r55 rd" class="r55 r">flags</span>)
        {
            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r56 rd" class="r56 r">handle</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#bda6d23d9cbc0007" class="i method">EvtOpenChannelConfig</a>(<span class="r53 r">session</span>, <span class="r54 r">channelPath</span>, <span class="r55 r">flags</span>);
            <b>int</b> <span id="r57 rd" class="r57 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (<span class="r56 r">handle</span>.<a href="EventLogHandle.cs.html#122cef311c35274f" class="i property">IsInvalid</a>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r57 r">win32Error</span>);
            <b>return</b> <span class="r56 r">handle</span>;
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static void</b> <a id="cd6a58a56df3e51b" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtSaveChannelConfig</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r58 rd" class="r58 r">channelConfig</span>, <b>int</b> <span id="r59 rd" class="r59 r">flags</span>)
        {
            <b>bool</b> <span id="r60 rd" class="r60 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c70be863f825ff2c" class="i method">EvtSaveChannelConfig</a>(<span class="r58 r">channelConfig</span>, <span class="r59 r">flags</span>);
            <b>int</b> <span id="r61 rd" class="r61 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (!<span class="r60 r">status</span>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r61 r">win32Error</span>);
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="2135fd3b494fca17" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtOpenLog</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r62 rd" class="r62 r">session</span>, <b>string</b> <span id="r63 rd" class="r63 r">path</span>, <span class="i">PathType</span> <span id="r64 rd" class="r64 r">flags</span>)
        {
            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r65 rd" class="r65 r">logHandle</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c4ead4b9bf6021bd" class="i method">EvtOpenLog</a>(<span class="r62 r">session</span>, <span class="r63 r">path</span>, <span class="r64 r">flags</span>);
            <b>int</b> <span id="r66 rd" class="r66 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (<span class="r65 r">logHandle</span>.<a href="EventLogHandle.cs.html#122cef311c35274f" class="i property">IsInvalid</a>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r66 r">win32Error</span>);
            <b>return</b> <span class="r65 r">logHandle</span>;
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static void</b> <a id="5289679ddc6fad07" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtExportLog</a>(
                            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r67 rd" class="r67 r">session</span>,
                            <b>string</b> <span id="r68 rd" class="r68 r">channelPath</span>,
                            <b>string</b> <span id="r69 rd" class="r69 r">query</span>,
                            <b>string</b> <span id="r70 rd" class="r70 r">targetFilePath</span>,
                            <b>int</b> <span id="r71 rd" class="r71 r">flags</span>)
        {
            <b>bool</b> <span id="r72 rd" class="r72 r">status</span>;
            <span class="r72 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#ff13b2626223f02c" class="i method">EvtExportLog</a>(<span class="r67 r">session</span>, <span class="r68 r">channelPath</span>, <span class="r69 r">query</span>, <span class="r70 r">targetFilePath</span>, <span class="r71 r">flags</span>);
            <b>int</b> <span id="r73 rd" class="r73 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (!<span class="r72 r">status</span>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r73 r">win32Error</span>);
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static void</b> <a id="45ffce95e57d852b" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtArchiveExportedLog</a>(
                            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r74 rd" class="r74 r">session</span>,
                            <b>string</b> <span id="r75 rd" class="r75 r">logFilePath</span>,
                            <b>int</b> <span id="r76 rd" class="r76 r">locale</span>,
                            <b>int</b> <span id="r77 rd" class="r77 r">flags</span>)
        {
            <b>bool</b> <span id="r78 rd" class="r78 r">status</span>;
            <span class="r78 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#6f3c419e2746ac27" class="i method">EvtArchiveExportedLog</a>(<span class="r74 r">session</span>, <span class="r75 r">logFilePath</span>, <span class="r76 r">locale</span>, <span class="r77 r">flags</span>);
            <b>int</b> <span id="r79 rd" class="r79 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (!<span class="r78 r">status</span>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r79 r">win32Error</span>);
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static void</b> <a id="24ad994136f4256e" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtClearLog</a>(
                            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r80 rd" class="r80 r">session</span>,
                            <b>string</b> <span id="r81 rd" class="r81 r">channelPath</span>,
                            <b>string</b> <span id="r82 rd" class="r82 r">targetFilePath</span>,
                            <b>int</b> <span id="r83 rd" class="r83 r">flags</span>)
        {
            <b>bool</b> <span id="r84 rd" class="r84 r">status</span>;
            <span class="r84 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#b2f0c8d3d514de1b" class="i method">EvtClearLog</a>(<span class="r80 r">session</span>, <span class="r81 r">channelPath</span>, <span class="r82 r">targetFilePath</span>, <span class="r83 r">flags</span>);
            <b>int</b> <span id="r85 rd" class="r85 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (!<span class="r84 r">status</span>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r85 r">win32Error</span>);
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="db60304ccf02618b" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtCreateRenderContext</a>(
                            <b>int</b> <span id="r86 rd" class="r86 r">valuePathsCount</span>,
                            <b>string</b>[] <span id="r87 rd" class="r87 r">valuePaths</span>,
                            <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#041814b0d2f378d3" class="t t">EvtRenderContextFlags</a> <span id="r88 rd" class="r88 r">flags</span>)
        {
            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r89 rd" class="r89 r">renderContextHandleValues</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#7feaca2d1179a4f0" class="i method">EvtCreateRenderContext</a>(<span class="r86 r">valuePathsCount</span>, <span class="r87 r">valuePaths</span>, <span class="r88 r">flags</span>);
            <b>int</b> <span id="r90 rd" class="r90 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (<span class="r89 r">renderContextHandleValues</span>.<a href="EventLogHandle.cs.html#122cef311c35274f" class="i property">IsInvalid</a>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r90 r">win32Error</span>);
            <b>return</b> <span class="r89 r">renderContextHandleValues</span>;
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static void</b> <a id="aba0e20aa6ba99eb" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtRender</a>(
                            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r91 rd" class="r91 r">context</span>,
                            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r92 rd" class="r92 r">eventHandle</span>,
                            <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#cbf7f0e52ab71aa1" class="t t">EvtRenderFlags</a> <span id="r93 rd" class="r93 r">flags</span>,
                            <span class="i">StringBuilder</span> <span id="r94 rd" class="r94 r">buffer</span>)
        {
            <b>int</b> <span id="r95 rd" class="r95 r">buffUsed</span>;
            <b>int</b> <span id="r96 rd" class="r96 r">propCount</span>;
            <b>bool</b> <span id="r97 rd" class="r97 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtRender</span>(<span class="r91 r">context</span>, <span class="r92 r">eventHandle</span>, <span class="r93 r">flags</span>, <span class="r94 r">buffer</span>.<span class="i">Capacity</span>, <span class="r94 r">buffer</span>, <b>out</b> <span class="r95 r">buffUsed</span>, <b>out</b> <span class="r96 r">propCount</span>);
            <b>int</b> <span id="r98 rd" class="r98 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
 
            <b>if</b> (!<span class="r97 r">status</span>)
            {
                <b>if</b> (<span class="r98 r">win32Error</span> == <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                {
                    <span class="c">// reallocate the new RenderBuffer with the right size.</span>
                    <span class="r94 r">buffer</span>.<span class="i">Capacity</span> = <span class="r95 r">buffUsed</span>;
                    <span class="r97 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtRender</span>(<span class="r91 r">context</span>, <span class="r92 r">eventHandle</span>, <span class="r93 r">flags</span>, <span class="r94 r">buffer</span>.<span class="i">Capacity</span>, <span class="r94 r">buffer</span>, <b>out</b> <span class="r95 r">buffUsed</span>, <b>out</b> <span class="r96 r">propCount</span>);
                    <span class="r98 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                }
 
                <b>if</b> (!<span class="r97 r">status</span>)
                {
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r98 r">win32Error</span>);
                }
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="6993246e0cd55058" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtOpenSession</a>(<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#761e5bea6af81fc2" class="t t">EvtLoginClass</a> <span id="r99 rd" class="r99 r">loginClass</span>, <b>ref</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#ea656cf9817fb7c8" class="t t">EvtRpcLogin</a> <span id="r100 rd" class="r100 r">login</span>, <b>int</b> <span id="r101 rd" class="r101 r">timeout</span>, <b>int</b> <span id="r102 rd" class="r102 r">flags</span>)
        {
            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r103 rd" class="r103 r">handle</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f221e019e3b9b2b2" class="i method">EvtOpenSession</a>(<span class="r99 r">loginClass</span>, <b>ref</b> <span class="r100 r">login</span>, <span class="r101 r">timeout</span>, <span class="r102 r">flags</span>);
            <b>int</b> <span id="r104 rd" class="r104 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (<span class="r103 r">handle</span>.<a href="EventLogHandle.cs.html#122cef311c35274f" class="i property">IsInvalid</a>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r104 r">win32Error</span>);
            <b>return</b> <span class="r103 r">handle</span>;
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="7c66e7371b67bda3" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtCreateBookmark</a>(<b>string</b> <span id="r105 rd" class="r105 r">bookmarkXml</span>)
        {
            <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r106 rd" class="r106 r">handle</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#19bb15096e0d1623" class="i method">EvtCreateBookmark</a>(<span class="r105 r">bookmarkXml</span>);
            <b>int</b> <span id="r107 rd" class="r107 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (<span class="r106 r">handle</span>.<a href="EventLogHandle.cs.html#122cef311c35274f" class="i property">IsInvalid</a>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r107 r">win32Error</span>);
            <b>return</b> <span class="r106 r">handle</span>;
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static void</b> <a id="e45e7da0bc84a384" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtUpdateBookmark</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r108 rd" class="r108 r">bookmark</span>, <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r109 rd" class="r109 r">eventHandle</span>)
        {
            <b>bool</b> <span id="r110 rd" class="r110 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#d98f16a24e8f98d9" class="i method">EvtUpdateBookmark</a>(<span class="r108 r">bookmark</span>, <span class="r109 r">eventHandle</span>);
            <b>int</b> <span id="r111 rd" class="r111 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (!<span class="r110 r">status</span>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r111 r">win32Error</span>);
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static object</b> <a id="cfc641258c2fdb3f" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtGetEventInfo</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r112 rd" class="r112 r">handle</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8072da41d7866f31" class="t t">EvtEventPropertyId</a> <span id="r113 rd" class="r113 r">enumType</span>)
        {
            <span class="i">IntPtr</span> <span id="r114 rd" class="r114 r">buffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>int</b> <span id="r115 rd" class="r115 r">bufferNeeded</span>;
 
            <b>try</b>
            {
                <b>bool</b> <span id="r116 rd" class="r116 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtGetEventInfo</span>(<span class="r112 r">handle</span>, <span class="r113 r">enumType</span>, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>out</b> <span class="r115 r">bufferNeeded</span>);
                <b>int</b> <span id="r117 rd" class="r117 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r116 r">status</span>)
                {
                    <b>if</b> (<span class="r117 r">error</span> == <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#436ebecf7f2f7b14" class="i field">ERROR_SUCCESS</a>) { }
                    <b>else</b>
                        <b>if</b> (<span class="r117 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                        <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r117 r">error</span>);
                }
 
                <span class="r114 r">buffer</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>((<b>int</b>)<span class="r115 r">bufferNeeded</span>);
                <span class="r116 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#585b55f35d2a44a8" class="i method">EvtGetEventInfo</a>(<span class="r112 r">handle</span>, <span class="r113 r">enumType</span>, <span class="r115 r">bufferNeeded</span>, <span class="r114 r">buffer</span>, <b>out</b> <span class="r115 r">bufferNeeded</span>);
                <span class="r117 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r116 r">status</span>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r117 r">error</span>);
 
                <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r118 rd" class="r118 r">varVal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a>&gt;(<span class="r114 r">buffer</span>);
                <b>return</b> <a href="#43eae73d3ab9bf91" class="i method">ConvertToObject</a>(<span class="r118 r">varVal</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r114 r">buffer</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r114 r">buffer</span>);
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static object</b> <a id="5920073ad217ba5a" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtGetQueryInfo</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r119 rd" class="r119 r">handle</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#51da25447f9dd273" class="t t">EvtQueryPropertyId</a> <span id="r120 rd" class="r120 r">enumType</span>)
        {
            <span class="i">IntPtr</span> <span id="r121 rd" class="r121 r">buffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>int</b> <span id="r122 rd" class="r122 r">bufferNeeded</span> = 0;
            <b>try</b>
            {
                <b>bool</b> <span id="r123 rd" class="r123 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtGetQueryInfo</span>(<span class="r119 r">handle</span>, <span class="r120 r">enumType</span>, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>ref</b> <span class="r122 r">bufferNeeded</span>);
                <b>int</b> <span id="r124 rd" class="r124 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r123 r">status</span>)
                {
                    <b>if</b> (<span class="r124 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                        <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r124 r">error</span>);
                }
 
                <span class="r121 r">buffer</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>((<b>int</b>)<span class="r122 r">bufferNeeded</span>);
                <span class="r123 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#5586e0820ad6df2a" class="i method">EvtGetQueryInfo</a>(<span class="r119 r">handle</span>, <span class="r120 r">enumType</span>, <span class="r122 r">bufferNeeded</span>, <span class="r121 r">buffer</span>, <b>ref</b> <span class="r122 r">bufferNeeded</span>);
                <span class="r124 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r123 r">status</span>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r124 r">error</span>);
 
                <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r125 rd" class="r125 r">varVal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a>&gt;(<span class="r121 r">buffer</span>);
                <b>return</b> <a href="#43eae73d3ab9bf91" class="i method">ConvertToObject</a>(<span class="r125 r">varVal</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r121 r">buffer</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>) <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r121 r">buffer</span>);
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static object</b> <a id="e0dd69b8f5fc4ce8" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtGetPublisherMetadataProperty</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r126 rd" class="r126 r">pmHandle</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8f383cca82e331f3" class="t t">EvtPublisherMetadataPropertyId</a> <span id="r127 rd" class="r127 r">thePropertyId</span>)
        {
            <span class="i">IntPtr</span> <span id="r128 rd" class="r128 r">buffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>int</b> <span id="r129 rd" class="r129 r">bufferNeeded</span>;
 
            <b>try</b>
            {
                <b>bool</b> <span id="r130 rd" class="r130 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtGetPublisherMetadataProperty</span>(<span class="r126 r">pmHandle</span>, <span class="r127 r">thePropertyId</span>, 0, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>out</b> <span class="r129 r">bufferNeeded</span>);
                <b>int</b> <span id="r131 rd" class="r131 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r130 r">status</span>)
                {
                    <b>if</b> (<span class="r131 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                        <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r131 r">error</span>);
                }
 
                <span class="r128 r">buffer</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>((<b>int</b>)<span class="r129 r">bufferNeeded</span>);
                <span class="r130 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8e4e7f663dec5131" class="i method">EvtGetPublisherMetadataProperty</a>(<span class="r126 r">pmHandle</span>, <span class="r127 r">thePropertyId</span>, 0, <span class="r129 r">bufferNeeded</span>, <span class="r128 r">buffer</span>, <b>out</b> <span class="r129 r">bufferNeeded</span>);
                <span class="r131 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r130 r">status</span>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r131 r">error</span>);
 
                <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r132 rd" class="r132 r">varVal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a>&gt;(<span class="r128 r">buffer</span>);
                <b>return</b> <a href="#43eae73d3ab9bf91" class="i method">ConvertToObject</a>(<span class="r132 r">varVal</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r128 r">buffer</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>) <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r128 r">buffer</span>);
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>internal static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="e6989cfeb3560555" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">EvtGetPublisherMetadataPropertyHandle</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r133 rd" class="r133 r">pmHandle</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8f383cca82e331f3" class="t t">EvtPublisherMetadataPropertyId</a> <span id="r134 rd" class="r134 r">thePropertyId</span>)
        {
            <span class="i">IntPtr</span> <span id="r135 rd" class="r135 r">buffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>try</b>
            {
                <b>int</b> <span id="r136 rd" class="r136 r">bufferNeeded</span>;
                <b>bool</b> <span id="r137 rd" class="r137 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtGetPublisherMetadataProperty</span>(<span class="r133 r">pmHandle</span>, <span class="r134 r">thePropertyId</span>, 0, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>out</b> <span class="r136 r">bufferNeeded</span>);
                <b>int</b> <span id="r138 rd" class="r138 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r137 r">status</span>)
                {
                    <b>if</b> (<span class="r138 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                        <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r138 r">error</span>);
                }
 
                <span class="r135 r">buffer</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>((<b>int</b>)<span class="r136 r">bufferNeeded</span>);
                <span class="r137 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8e4e7f663dec5131" class="i method">EvtGetPublisherMetadataProperty</a>(<span class="r133 r">pmHandle</span>, <span class="r134 r">thePropertyId</span>, 0, <span class="r136 r">bufferNeeded</span>, <span class="r135 r">buffer</span>, <b>out</b> <span class="r136 r">bufferNeeded</span>);
                <span class="r138 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r137 r">status</span>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r138 r">error</span>);
 
                <span class="c">//</span>
                <span class="c">// note: there is a case where returned variant does have allocated native resources</span>
                <span class="c">// associated with (e.g. ConfigArrayHandle).  If PtrToStructure throws, then we would</span>
                <span class="c">// leak that resource - fortunately PtrToStructure only throws InvalidArgument which</span>
                <span class="c">// is a logic error - not a possible runtime condition here.  Other System exceptions</span>
                <span class="c">// shouldn&#39;t be handled anyhow and the application will terminate.</span>
                <span class="c">//</span>
                <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r139 rd" class="r139 r">varVal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a>&gt;(<span class="r135 r">buffer</span>);
                <b>return</b> <a href="#8bbbbca9fc4fff6b" class="i method">ConvertToSafeHandle</a>(<span class="r139 r">varVal</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r135 r">buffer</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>) <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r135 r">buffer</span>);
            }
        }
 
        <span class="c">// implies UnsafeNativeMethods.EvtFormatMessageFlags.EvtFormatMessageId flag.</span>
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static string</b> <a id="cf6f71056df2bd67" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtFormatMessage</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r140 rd" class="r140 r">handle</span>, <b>uint</b> <span id="r141 rd" class="r141 r">msgId</span>)
        {
            <b>int</b> <span id="r142 rd" class="r142 r">bufferNeeded</span>;
 
            <span class="i">StringBuilder</span> <span id="r143 rd" class="r143 r">sb</span> = <b>new</b>(<b>null</b>);
            <b>bool</b> <span id="r144 rd" class="r144 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#9a3c027b521e90d3" class="i method">EvtFormatMessage</a>(<span class="r140 r">handle</span>, <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a>.<a href="EventLogHandle.cs.html#506ba88538eff8b0" class="i property">Zero</a>, <span class="r141 r">msgId</span>, 0, <b>null</b>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#da9d7f4c517f35bf" class="t t">EvtFormatMessageFlags</a>.<a href="../UnsafeNativeMethods.cs.html#ae9712c5af0ed123" class="i field">EvtFormatMessageId</a>, 0, <span class="r143 r">sb</span>, <b>out</b> <span class="r142 r">bufferNeeded</span>);
            <b>int</b> <span id="r145 rd" class="r145 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
 
            <span class="c">// ERROR_EVT_UNRESOLVED_VALUE_INSERT and its cousins are commonly returned for raw message text.</span>
            <b>if</b> (!<span class="r144 r">status</span> &amp;&amp; <span class="r145 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#509fbbffd4675c9f" class="i field">ERROR_EVT_UNRESOLVED_VALUE_INSERT</a>
                        &amp;&amp; <span class="r145 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f29a2f04cd5d6bb0" class="i field">ERROR_EVT_UNRESOLVED_PARAMETER_INSERT</a>
                        &amp;&amp; <span class="r145 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f4dcc1e1f4460672" class="i field">ERROR_EVT_MAX_INSERTS_REACHED</a>)
            {
                <b>switch</b> (<span class="r145 r">error</span>)
                {
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#3e299e9332a9df32" class="i field">ERROR_EVT_MESSAGE_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2129065147059a12" class="i field">ERROR_EVT_MESSAGE_ID_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#908459ec6434d866" class="i field">ERROR_EVT_MESSAGE_LOCALE_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#114122b78ed5374a" class="i field">ERROR_RESOURCE_LANG_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f01d70285e9f4332" class="i field">ERROR_MUI_FILE_NOT_FOUND</a>:
                        <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<span class="r145 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r145 r">error</span>);
            }
 
            <span class="r143 r">sb</span>.<span class="i">EnsureCapacity</span>(<span class="r142 r">bufferNeeded</span>);
            <span class="r144 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#9a3c027b521e90d3" class="i method">EvtFormatMessage</a>(<span class="r140 r">handle</span>, <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a>.<a href="EventLogHandle.cs.html#506ba88538eff8b0" class="i property">Zero</a>, <span class="r141 r">msgId</span>, 0, <b>null</b>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#da9d7f4c517f35bf" class="t t">EvtFormatMessageFlags</a>.<a href="../UnsafeNativeMethods.cs.html#ae9712c5af0ed123" class="i field">EvtFormatMessageId</a>, <span class="r142 r">bufferNeeded</span>, <span class="r143 r">sb</span>, <b>out</b> <span class="r142 r">bufferNeeded</span>);
            <span class="r145 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
 
            <b>if</b> (!<span class="r144 r">status</span> &amp;&amp; <span class="r145 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#509fbbffd4675c9f" class="i field">ERROR_EVT_UNRESOLVED_VALUE_INSERT</a>
                        &amp;&amp; <span class="r145 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f29a2f04cd5d6bb0" class="i field">ERROR_EVT_UNRESOLVED_PARAMETER_INSERT</a>
                        &amp;&amp; <span class="r145 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f4dcc1e1f4460672" class="i field">ERROR_EVT_MAX_INSERTS_REACHED</a>)
            {
                <b>switch</b> (<span class="r145 r">error</span>)
                {
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#3e299e9332a9df32" class="i field">ERROR_EVT_MESSAGE_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2129065147059a12" class="i field">ERROR_EVT_MESSAGE_ID_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#908459ec6434d866" class="i field">ERROR_EVT_MESSAGE_LOCALE_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#114122b78ed5374a" class="i field">ERROR_RESOURCE_LANG_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f01d70285e9f4332" class="i field">ERROR_MUI_FILE_NOT_FOUND</a>:
                        <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<span class="r145 r">error</span> == <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#509fbbffd4675c9f" class="i field">ERROR_EVT_UNRESOLVED_VALUE_INSERT</a>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r145 r">error</span>);
            }
 
            <b>return</b> <span class="r143 r">sb</span>.<span class="i">ToString</span>();
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static object</b> <a id="990143811d2fc20c" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtGetObjectArrayProperty</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r146 rd" class="r146 r">objArrayHandle</span>, <b>int</b> <span id="r147 rd" class="r147 r">index</span>, <b>int</b> <span id="r148 rd" class="r148 r">thePropertyId</span>)
        {
            <span class="i">IntPtr</span> <span id="r149 rd" class="r149 r">buffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>int</b> <span id="r150 rd" class="r150 r">bufferNeeded</span>;
 
            <b>try</b>
            {
                <b>bool</b> <span id="r151 rd" class="r151 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtGetObjectArrayProperty</span>(<span class="r146 r">objArrayHandle</span>, <span class="r148 r">thePropertyId</span>, <span class="r147 r">index</span>, 0, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>out</b> <span class="r150 r">bufferNeeded</span>);
                <b>int</b> <span id="r152 rd" class="r152 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
 
                <b>if</b> (!<span class="r151 r">status</span>)
                {
                    <b>if</b> (<span class="r152 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                        <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r152 r">error</span>);
                }
 
                <span class="r149 r">buffer</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>((<b>int</b>)<span class="r150 r">bufferNeeded</span>);
                <span class="r151 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b115d7b9193caf9" class="i method">EvtGetObjectArrayProperty</a>(<span class="r146 r">objArrayHandle</span>, <span class="r148 r">thePropertyId</span>, <span class="r147 r">index</span>, 0, <span class="r150 r">bufferNeeded</span>, <span class="r149 r">buffer</span>, <b>out</b> <span class="r150 r">bufferNeeded</span>);
                <span class="r152 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r151 r">status</span>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r152 r">error</span>);
 
                <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r153 rd" class="r153 r">varVal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a>&gt;(<span class="r149 r">buffer</span>);
                <b>return</b> <a href="#43eae73d3ab9bf91" class="i method">ConvertToObject</a>(<span class="r153 r">varVal</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r149 r">buffer</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>) <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r149 r">buffer</span>);
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static object</b> <a id="6e372edb51a48219" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtGetEventMetadataProperty</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r154 rd" class="r154 r">handle</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#684fba3f95b91f59" class="t t">EvtEventMetadataPropertyId</a> <span id="r155 rd" class="r155 r">enumType</span>)
        {
            <span class="i">IntPtr</span> <span id="r156 rd" class="r156 r">buffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>int</b> <span id="r157 rd" class="r157 r">bufferNeeded</span>;
 
            <b>try</b>
            {
                <b>bool</b> <span id="r158 rd" class="r158 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtGetEventMetadataProperty</span>(<span class="r154 r">handle</span>, <span class="r155 r">enumType</span>, 0, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>out</b> <span class="r157 r">bufferNeeded</span>);
                <b>int</b> <span id="r159 rd" class="r159 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r158 r">status</span>)
                {
                    <b>if</b> (<span class="r159 r">win32Error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                        <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r159 r">win32Error</span>);
                }
 
                <span class="r156 r">buffer</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>((<b>int</b>)<span class="r157 r">bufferNeeded</span>);
                <span class="r158 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f3478f90061dc3b2" class="i method">EvtGetEventMetadataProperty</a>(<span class="r154 r">handle</span>, <span class="r155 r">enumType</span>, 0, <span class="r157 r">bufferNeeded</span>, <span class="r156 r">buffer</span>, <b>out</b> <span class="r157 r">bufferNeeded</span>);
                <span class="r159 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r158 r">status</span>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r159 r">win32Error</span>);
 
                <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r160 rd" class="r160 r">varVal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a>&gt;(<span class="r156 r">buffer</span>);
                <b>return</b> <a href="#43eae73d3ab9bf91" class="i method">ConvertToObject</a>(<span class="r160 r">varVal</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r156 r">buffer</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r156 r">buffer</span>);
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static object</b> <a id="77211781c3d28e22" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtGetChannelConfigProperty</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r161 rd" class="r161 r">handle</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#de33b2110bef4b21" class="t t">EvtChannelConfigPropertyId</a> <span id="r162 rd" class="r162 r">enumType</span>)
        {
            <span class="i">IntPtr</span> <span id="r163 rd" class="r163 r">buffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>int</b> <span id="r164 rd" class="r164 r">bufferNeeded</span>;
 
            <b>try</b>
            {
                <b>bool</b> <span id="r165 rd" class="r165 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtGetChannelConfigProperty</span>(<span class="r161 r">handle</span>, <span class="r162 r">enumType</span>, 0, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>out</b> <span class="r164 r">bufferNeeded</span>);
                <b>int</b> <span id="r166 rd" class="r166 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r165 r">status</span>)
                {
                    <b>if</b> (<span class="r166 r">win32Error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                        <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r166 r">win32Error</span>);
                }
 
                <span class="r163 r">buffer</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>((<b>int</b>)<span class="r164 r">bufferNeeded</span>);
                <span class="r165 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#077ee5e6896b3399" class="i method">EvtGetChannelConfigProperty</a>(<span class="r161 r">handle</span>, <span class="r162 r">enumType</span>, 0, <span class="r164 r">bufferNeeded</span>, <span class="r163 r">buffer</span>, <b>out</b> <span class="r164 r">bufferNeeded</span>);
                <span class="r166 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r165 r">status</span>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r166 r">win32Error</span>);
 
                <span class="c">//</span>
                <span class="c">// note: there is a case where returned variant does have allocated native resources</span>
                <span class="c">// associated with (e.g. ConfigArrayHandle).  If PtrToStructure throws, then we would</span>
                <span class="c">// leak that resource - fortunately PtrToStructure only throws InvalidArgument which</span>
                <span class="c">// is a logic error - not a possible runtime condition here.  Other System exceptions</span>
                <span class="c">// shouldn&#39;t be handled anyhow and the application will terminate.</span>
                <span class="c">//</span>
                <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r167 rd" class="r167 r">varVal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a>&gt;(<span class="r163 r">buffer</span>);
                <b>return</b> <a href="#43eae73d3ab9bf91" class="i method">ConvertToObject</a>(<span class="r167 r">varVal</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r163 r">buffer</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r163 r">buffer</span>);
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static void</b> <a id="37304d42a7ccb7e9" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtSetChannelConfigProperty</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r168 rd" class="r168 r">handle</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#de33b2110bef4b21" class="t t">EvtChannelConfigPropertyId</a> <span id="r169 rd" class="r169 r">enumType</span>, <b>object</b> <span id="r170 rd" class="r170 r">val</span>)
        {
            <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r171 rd" class="r171 r">varVal</span> = <b>new</b>();
 
            <a href="CoTaskMemSafeHandle.cs.html#4ca298ef91fca869" class="t t">CoTaskMemSafeHandle</a> <span id="r172 rd" class="r172 r">taskMem</span> = <b>new</b>();
 
            <b>using</b> (<span class="r172 r">taskMem</span>)
            {
                <b>if</b> (<span class="r170 r">val</span> != <b>null</b>)
                {
                    <b>switch</b> (<span class="r169 r">enumType</span>)
                    {
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#de33b2110bef4b21" class="t t">EvtChannelConfigPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#57d7e512cc7101fc" class="i field">EvtChannelConfigEnabled</a>:
                            {
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#ba130a5d903bbc7a" class="i field">Type</a> = (<b>uint</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#b04a2b94bf9f1117" class="i field">EvtVarTypeBoolean</a>;
                                <b>if</b> ((<b>bool</b>)<span class="r170 r">val</span>) <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#fac0d094d0609d87" class="i field">Bool</a> = 1;
                                <b>else</b> <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#fac0d094d0609d87" class="i field">Bool</a> = 0;
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#de33b2110bef4b21" class="t t">EvtChannelConfigPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#7856c380e3c409c1" class="i field">EvtChannelConfigAccess</a>:
                            {
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#ba130a5d903bbc7a" class="i field">Type</a> = (<b>uint</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#41e9ccc4fe63d7d7" class="i field">EvtVarTypeString</a>;
                                <span class="r172 r">taskMem</span>.<span class="i">SetMemory</span>(<span class="i">Marshal</span>.<span class="i">StringToCoTaskMemUni</span>((<b>string</b>)<span class="r170 r">val</span>));
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#5af593504530b3e5" class="i field">StringVal</a> = <span class="r172 r">taskMem</span>.<a href="CoTaskMemSafeHandle.cs.html#6c33ed6a3e745dbd" class="i method">GetMemory</a>();
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#de33b2110bef4b21" class="t t">EvtChannelConfigPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#2e6a2825af11c502" class="i field">EvtChannelLoggingConfigLogFilePath</a>:
                            {
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#ba130a5d903bbc7a" class="i field">Type</a> = (<b>uint</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#41e9ccc4fe63d7d7" class="i field">EvtVarTypeString</a>;
                                <span class="r172 r">taskMem</span>.<span class="i">SetMemory</span>(<span class="i">Marshal</span>.<span class="i">StringToCoTaskMemUni</span>((<b>string</b>)<span class="r170 r">val</span>));
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#5af593504530b3e5" class="i field">StringVal</a> = <span class="r172 r">taskMem</span>.<a href="CoTaskMemSafeHandle.cs.html#6c33ed6a3e745dbd" class="i method">GetMemory</a>();
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#de33b2110bef4b21" class="t t">EvtChannelConfigPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#4a53f9e6a5e05c66" class="i field">EvtChannelLoggingConfigMaxSize</a>:
                            {
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#ba130a5d903bbc7a" class="i field">Type</a> = (<b>uint</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#28ba3f878a9ffb27" class="i field">EvtVarTypeUInt64</a>;
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#63648456d1939a05" class="i field">ULong</a> = (<b>ulong</b>)((<b>long</b>)<span class="r170 r">val</span>);
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#de33b2110bef4b21" class="t t">EvtChannelConfigPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#b1d48653c1db1e1c" class="i field">EvtChannelPublishingConfigLevel</a>:
                            {
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#ba130a5d903bbc7a" class="i field">Type</a> = (<b>uint</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#8c6d4f44eb07191a" class="i field">EvtVarTypeUInt32</a>;
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#704446694d98bde4" class="i field">UInteger</a> = (<b>uint</b>)((<b>int</b>)<span class="r170 r">val</span>);
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#de33b2110bef4b21" class="t t">EvtChannelConfigPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#6e5e92a5820905de" class="i field">EvtChannelPublishingConfigKeywords</a>:
                            {
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#ba130a5d903bbc7a" class="i field">Type</a> = (<b>uint</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#28ba3f878a9ffb27" class="i field">EvtVarTypeUInt64</a>;
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#63648456d1939a05" class="i field">ULong</a> = (<b>ulong</b>)((<b>long</b>)<span class="r170 r">val</span>);
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#de33b2110bef4b21" class="t t">EvtChannelConfigPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#81d9c84dd51fa909" class="i field">EvtChannelLoggingConfigRetention</a>:
                            {
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#ba130a5d903bbc7a" class="i field">Type</a> = (<b>uint</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#b04a2b94bf9f1117" class="i field">EvtVarTypeBoolean</a>;
                                <b>if</b> ((<b>bool</b>)<span class="r170 r">val</span>) <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#fac0d094d0609d87" class="i field">Bool</a> = 1;
                                <b>else</b> <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#fac0d094d0609d87" class="i field">Bool</a> = 0;
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#de33b2110bef4b21" class="t t">EvtChannelConfigPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#ca714bdf587e3adc" class="i field">EvtChannelLoggingConfigAutoBackup</a>:
                            {
                                <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#ba130a5d903bbc7a" class="i field">Type</a> = (<b>uint</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#b04a2b94bf9f1117" class="i field">EvtVarTypeBoolean</a>;
                                <b>if</b> ((<b>bool</b>)<span class="r170 r">val</span>) <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#fac0d094d0609d87" class="i field">Bool</a> = 1;
                                <b>else</b> <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#fac0d094d0609d87" class="i field">Bool</a> = 0;
                            }
 
                            <b>break</b>;
                        <b>default</b>:
                            <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>();
                    }
                }
                <b>else</b>
                {
                    <span class="r171 r">varVal</span>.<a href="../UnsafeNativeMethods.cs.html#ba130a5d903bbc7a" class="i field">Type</a> = (<b>uint</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#4d4a93924fcdf0d7" class="i field">EvtVarTypeNull</a>;
                }
 
                <b>bool</b> <span id="r173 rd" class="r173 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#4dda8bfdb0d72478" class="i method">EvtSetChannelConfigProperty</a>(<span class="r168 r">handle</span>, <span class="r169 r">enumType</span>, 0, <b>ref</b> <span class="r171 r">varVal</span>);
                <b>int</b> <span id="r174 rd" class="r174 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r173 r">status</span>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r174 r">win32Error</span>);
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static string</b> <a id="5ba02d83a045ec5c" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtNextChannelPath</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r175 rd" class="r175 r">handle</span>, <b>ref bool</b> <span id="r176 rd" class="r176 r">finish</span>)
        {
            <span class="i">StringBuilder</span> <span id="r177 rd" class="r177 r">sb</span> = <b>new</b>(<b>null</b>);
            <b>int</b> <span id="r178 rd" class="r178 r">channelNameNeeded</span>;
 
            <b>bool</b> <span id="r179 rd" class="r179 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#7e60751d8c41879f" class="i method">EvtNextChannelPath</a>(<span class="r175 r">handle</span>, 0, <span class="r177 r">sb</span>, <b>out</b> <span class="r178 r">channelNameNeeded</span>);
            <b>int</b> <span id="r180 rd" class="r180 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (!<span class="r179 r">status</span>)
            {
                <b>if</b> (<span class="r180 r">win32Error</span> == <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#677de97964ba203c" class="i field">ERROR_NO_MORE_ITEMS</a>)
                {
                    <span class="r176 r">finish</span> = <b>true</b>;
                    <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<span class="r180 r">win32Error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r180 r">win32Error</span>);
            }
 
            <span class="r177 r">sb</span>.<span class="i">EnsureCapacity</span>(<span class="r178 r">channelNameNeeded</span>);
            <span class="r179 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#7e60751d8c41879f" class="i method">EvtNextChannelPath</a>(<span class="r175 r">handle</span>, <span class="r178 r">channelNameNeeded</span>, <span class="r177 r">sb</span>, <b>out</b> <span class="r178 r">channelNameNeeded</span>);
            <span class="r180 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (!<span class="r179 r">status</span>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r180 r">win32Error</span>);
 
            <b>return</b> <span class="r177 r">sb</span>.<span class="i">ToString</span>();
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static string</b> <a id="95bb9fc32f114d5a" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtNextPublisherId</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r181 rd" class="r181 r">handle</span>, <b>ref bool</b> <span id="r182 rd" class="r182 r">finish</span>)
        {
            <span class="i">StringBuilder</span> <span id="r183 rd" class="r183 r">sb</span> = <b>new</b>(<b>null</b>);
            <b>int</b> <span id="r184 rd" class="r184 r">ProviderIdNeeded</span>;
 
            <b>bool</b> <span id="r185 rd" class="r185 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#fa76cd514f33d22b" class="i method">EvtNextPublisherId</a>(<span class="r181 r">handle</span>, 0, <span class="r183 r">sb</span>, <b>out</b> <span class="r184 r">ProviderIdNeeded</span>);
            <b>int</b> <span id="r186 rd" class="r186 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (!<span class="r185 r">status</span>)
            {
                <b>if</b> (<span class="r186 r">win32Error</span> == <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#677de97964ba203c" class="i field">ERROR_NO_MORE_ITEMS</a>)
                {
                    <span class="r182 r">finish</span> = <b>true</b>;
                    <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<span class="r186 r">win32Error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r186 r">win32Error</span>);
            }
 
            <span class="r183 r">sb</span>.<span class="i">EnsureCapacity</span>(<span class="r184 r">ProviderIdNeeded</span>);
            <span class="r185 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#fa76cd514f33d22b" class="i method">EvtNextPublisherId</a>(<span class="r181 r">handle</span>, <span class="r184 r">ProviderIdNeeded</span>, <span class="r183 r">sb</span>, <b>out</b> <span class="r184 r">ProviderIdNeeded</span>);
            <span class="r186 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
            <b>if</b> (!<span class="r185 r">status</span>)
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r186 r">win32Error</span>);
 
            <b>return</b> <span class="r183 r">sb</span>.<span class="i">ToString</span>();
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static object</b> <a id="66eb56b49d56125e" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtGetLogInfo</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r187 rd" class="r187 r">handle</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#7c81591a63128359" class="t t">EvtLogPropertyId</a> <span id="r188 rd" class="r188 r">enumType</span>)
        {
            <span class="i">IntPtr</span> <span id="r189 rd" class="r189 r">buffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>int</b> <span id="r190 rd" class="r190 r">bufferNeeded</span>;
 
            <b>try</b>
            {
                <b>bool</b> <span id="r191 rd" class="r191 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtGetLogInfo</span>(<span class="r187 r">handle</span>, <span class="r188 r">enumType</span>, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>out</b> <span class="r190 r">bufferNeeded</span>);
                <b>int</b> <span id="r192 rd" class="r192 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r191 r">status</span>)
                {
                    <b>if</b> (<span class="r192 r">win32Error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                        <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r192 r">win32Error</span>);
                }
 
                <span class="r189 r">buffer</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>((<b>int</b>)<span class="r190 r">bufferNeeded</span>);
                <span class="r191 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#26d38d93c8ff3cff" class="i method">EvtGetLogInfo</a>(<span class="r187 r">handle</span>, <span class="r188 r">enumType</span>, <span class="r190 r">bufferNeeded</span>, <span class="r189 r">buffer</span>, <b>out</b> <span class="r190 r">bufferNeeded</span>);
                <span class="r192 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r191 r">status</span>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r192 r">win32Error</span>);
 
                <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r193 rd" class="r193 r">varVal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a>&gt;(<span class="r189 r">buffer</span>);
                <b>return</b> <a href="#43eae73d3ab9bf91" class="i method">ConvertToObject</a>(<span class="r193 r">varVal</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r189 r">buffer</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r189 r">buffer</span>);
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static void</b> <a id="3b53c24a9e14b102" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtRenderBufferWithContextSystem</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r194 rd" class="r194 r">contextHandle</span>, <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r195 rd" class="r195 r">eventHandle</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#cbf7f0e52ab71aa1" class="t t">EvtRenderFlags</a> <span id="r196 rd" class="r196 r">flag</span>, <a href="#6df5076a255b8a01" class="t t">SystemProperties</a> <span id="r197 rd" class="r197 r">systemProperties</span>, <b>int</b> <span id="r198 rd" class="r198 r">SYSTEM_PROPERTY_COUNT</span>)
        {
            <span class="i">IntPtr</span> <span id="r199 rd" class="r199 r">buffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="i">IntPtr</span> <span id="r200 rd" class="r200 r">pointer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>int</b> <span id="r201 rd" class="r201 r">bufferNeeded</span>;
            <b>int</b> <span id="r202 rd" class="r202 r">propCount</span>;
 
            <b>try</b>
            {
                <b>bool</b> <span id="r203 rd" class="r203 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtRender</span>(<span class="r194 r">contextHandle</span>, <span class="r195 r">eventHandle</span>, <span class="r196 r">flag</span>, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>out</b> <span class="r201 r">bufferNeeded</span>, <b>out</b> <span class="r202 r">propCount</span>);
                <b>if</b> (!<span class="r203 r">status</span>)
                {
                    <b>int</b> <span id="r204 rd" class="r204 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                    <b>if</b> (<span class="r204 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                        <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r204 r">error</span>);
                }
 
                <span class="r199 r">buffer</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>((<b>int</b>)<span class="r201 r">bufferNeeded</span>);
                <span class="r203 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2b9f76471cb51582" class="i method">EvtRender</a>(<span class="r194 r">contextHandle</span>, <span class="r195 r">eventHandle</span>, <span class="r196 r">flag</span>, <span class="r201 r">bufferNeeded</span>, <span class="r199 r">buffer</span>, <b>out</b> <span class="r201 r">bufferNeeded</span>, <b>out</b> <span class="r202 r">propCount</span>);
                <b>int</b> <span id="r205 rd" class="r205 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r203 r">status</span>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r205 r">win32Error</span>);
 
                <b>if</b> (<span class="r202 r">propCount</span> != <span class="r198 r">SYSTEM_PROPERTY_COUNT</span>)
                    <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="s">&quot;We do not have &quot;</span> + <span class="r198 r">SYSTEM_PROPERTY_COUNT</span> + <span class="s">&quot; variants given for the UnsafeNativeMethods.EvtRenderFlags.EvtRenderEventValues flag. (System Properties)&quot;</span>);
 
                <span class="r200 r">pointer</span> = <span class="r199 r">buffer</span>;
                <span class="c">// read each Variant structure</span>
                <b>for</b> (<b>int</b> <span id="r206 rd" class="r206 r">i</span> = 0; <span class="r206 r">i</span> &lt; <span class="r202 r">propCount</span>; <span class="r206 r">i</span>++)
                {
                    <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r207 rd" class="r207 r">varVal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a>&gt;(<span class="r200 r">pointer</span>);
                    <b>switch</b> (<span class="r206 r">i</span>)
                    {
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#3832790b60954f26" class="i field">EvtSystemProviderName</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#b542c7ece9b6f3a3" class="i field">ProviderName</a> = (<b>string</b>)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#41e9ccc4fe63d7d7" class="i field">EvtVarTypeString</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#b35df97389f0f404" class="i field">EvtSystemProviderGuid</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#59e94ab6799734c3" class="i field">ProviderId</a> = (<span class="i">Guid</span>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#f30c515fd3077028" class="i field">EvtVarTypeGuid</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#e4d6dce272a09f80" class="i field">EvtSystemEventID</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#37a77a9b917e5ae7" class="i field">Id</a> = (<b>ushort</b>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#ac01be872c788e89" class="i field">EvtVarTypeUInt16</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#dc780cb6b7cf1b70" class="i field">EvtSystemQualifiers</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#607d639d6481a3bf" class="i field">Qualifiers</a> = (<b>ushort</b>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#ac01be872c788e89" class="i field">EvtVarTypeUInt16</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#3f58f3f421782c75" class="i field">EvtSystemLevel</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#254c83dcd89b7477" class="i field">Level</a> = (<b>byte</b>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#f7d573a86fd33c9f" class="i field">EvtVarTypeByte</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#54bef79cb58f9dec" class="i field">EvtSystemTask</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#9d1de906d8483232" class="i field">Task</a> = (<b>ushort</b>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#ac01be872c788e89" class="i field">EvtVarTypeUInt16</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#a232d37b5a9d1728" class="i field">EvtSystemOpcode</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#bdcd89e317ccd97d" class="i field">Opcode</a> = (<b>byte</b>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#f7d573a86fd33c9f" class="i field">EvtVarTypeByte</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#560ab3fb0f2314b9" class="i field">EvtSystemKeywords</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#dbec06cbbc0746e6" class="i field">Keywords</a> = (<b>ulong</b>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#5d881aed15a08a65" class="i field">EvtVarTypeHexInt64</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#959cd35acf1657b9" class="i field">EvtSystemTimeCreated</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#1d36cbf361b654d2" class="i field">TimeCreated</a> = (<span class="i">DateTime</span>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#adebe2f8e9aa85ed" class="i field">EvtVarTypeFileTime</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#fa699dc3e26ee127" class="i field">EvtSystemEventRecordId</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#501ffd491b0b281b" class="i field">RecordId</a> = (<b>ulong</b>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#28ba3f878a9ffb27" class="i field">EvtVarTypeUInt64</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#97bc4f54e2c01ee2" class="i field">EvtSystemActivityID</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#8b29c5e20ffa2e99" class="i field">ActivityId</a> = (<span class="i">Guid</span>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#f30c515fd3077028" class="i field">EvtVarTypeGuid</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#28f956e12ab1d044" class="i field">EvtSystemRelatedActivityID</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#17eb702f1dbb1df8" class="i field">RelatedActivityId</a> = (<span class="i">Guid</span>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#f30c515fd3077028" class="i field">EvtVarTypeGuid</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#d2a1f5b72f4fcb00" class="i field">EvtSystemProcessID</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#b59f566d02231c87" class="i field">ProcessId</a> = (<b>uint</b>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#8c6d4f44eb07191a" class="i field">EvtVarTypeUInt32</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#4097aab25ccca089" class="i field">EvtSystemThreadID</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#3b39e13d2807c803" class="i field">ThreadId</a> = (<b>uint</b>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#8c6d4f44eb07191a" class="i field">EvtVarTypeUInt32</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#2a02169168e88f3d" class="i field">EvtSystemChannel</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#8a5be370450e0ee9" class="i field">ChannelName</a> = (<b>string</b>)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#41e9ccc4fe63d7d7" class="i field">EvtVarTypeString</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#c86f6ee373a29d3c" class="i field">EvtSystemComputer</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#f28054d62c259f77" class="i field">ComputerName</a> = (<b>string</b>)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#41e9ccc4fe63d7d7" class="i field">EvtVarTypeString</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#73f750d26a8f9e1c" class="i field">EvtSystemUserID</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#2d72edb6578683ef" class="i field">UserId</a> = (<span class="i">SecurityIdentifier</span>)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#48846a057626aff6" class="i field">EvtVarTypeSid</a>);
                            <b>break</b>;
                        <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#8ac90d2f1093ef1a" class="t t">EvtSystemPropertyId</a>.<a href="../UnsafeNativeMethods.cs.html#0efa6e0a6304da84" class="i field">EvtSystemVersion</a>:
                            <span class="r197 r">systemProperties</span>.<a href="#3cfe82313e5c97b0" class="i field">Version</a> = (<b>byte</b>?)<a href="#2a73d9c9672d276f" class="i method">ConvertToObject</a>(<span class="r207 r">varVal</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#f7d573a86fd33c9f" class="i field">EvtVarTypeByte</a>);
                            <b>break</b>;
                    }
 
                    <span class="r200 r">pointer</span> = <b>new</b> <span class="i">IntPtr</span>(((<b>long</b>)<span class="r200 r">pointer</span> + <span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r207 r">varVal</span>)));
                }
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r199 r">buffer</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r199 r">buffer</span>);
            }
        }
 
        <span class="c">// EvtRenderContextFlags can be both: EvtRenderContextFlags.EvtRenderContextUser and EvtRenderContextFlags.EvtRenderContextValues</span>
        <span class="c">// Render with Context = ContextUser or ContextValues (with user defined Xpath query strings)</span>
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static</b> <span class="i">IList</span>&lt;<b>object</b>&gt; <a id="7fe3ff975b00dac5" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtRenderBufferWithContextUserOrValues</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r208 rd" class="r208 r">contextHandle</span>, <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r209 rd" class="r209 r">eventHandle</span>)
        {
            <span class="i">IntPtr</span> <span id="r210 rd" class="r210 r">buffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <span class="i">IntPtr</span> <span id="r211 rd" class="r211 r">pointer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>int</b> <span id="r212 rd" class="r212 r">bufferNeeded</span>;
            <b>int</b> <span id="r213 rd" class="r213 r">propCount</span>;
            <b>const</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#cbf7f0e52ab71aa1" class="t t">EvtRenderFlags</a> <span id="r214 rd" class="r214 r">flag</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#cbf7f0e52ab71aa1" class="t t">EvtRenderFlags</a>.<a href="../UnsafeNativeMethods.cs.html#211a0d0ba2dad6eb" class="i field">EvtRenderEventValues</a>;
 
            <b>try</b>
            {
                <b>bool</b> <span id="r215 rd" class="r215 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtRender</span>(<span class="r208 r">contextHandle</span>, <span class="r209 r">eventHandle</span>, <span class="r214 r">flag</span>, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>out</b> <span class="r212 r">bufferNeeded</span>, <b>out</b> <span class="r213 r">propCount</span>);
                <b>if</b> (!<span class="r215 r">status</span>)
                {
                    <b>int</b> <span id="r216 rd" class="r216 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                    <b>if</b> (<span class="r216 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                        <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r216 r">error</span>);
                }
 
                <span class="r210 r">buffer</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>((<b>int</b>)<span class="r212 r">bufferNeeded</span>);
                <span class="r215 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2b9f76471cb51582" class="i method">EvtRender</a>(<span class="r208 r">contextHandle</span>, <span class="r209 r">eventHandle</span>, <span class="r214 r">flag</span>, <span class="r212 r">bufferNeeded</span>, <span class="r210 r">buffer</span>, <b>out</b> <span class="r212 r">bufferNeeded</span>, <b>out</b> <span class="r213 r">propCount</span>);
                <b>int</b> <span id="r217 rd" class="r217 r">win32Error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r215 r">status</span>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r217 r">win32Error</span>);
 
                <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r218 rd" class="r218 r">valuesList</span> = <b>new</b>(<span class="r213 r">propCount</span>);
                <b>if</b> (<span class="r213 r">propCount</span> &gt; 0)
                {
                    <span class="r211 r">pointer</span> = <span class="r210 r">buffer</span>;
                    <b>for</b> (<b>int</b> <span id="r219 rd" class="r219 r">i</span> = 0; <span class="r219 r">i</span> &lt; <span class="r213 r">propCount</span>; <span class="r219 r">i</span>++)
                    {
                        <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r220 rd" class="r220 r">varVal</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a>&gt;(<span class="r211 r">pointer</span>);
                        <span class="r218 r">valuesList</span>.<span class="i">Add</span>(<a href="#43eae73d3ab9bf91" class="i method">ConvertToObject</a>(<span class="r220 r">varVal</span>));
                        <span class="r211 r">pointer</span> = <b>new</b> <span class="i">IntPtr</span>(((<b>long</b>)<span class="r211 r">pointer</span> + <span class="i">Marshal</span>.<span class="i">SizeOf</span>(<span class="r220 r">varVal</span>)));
                    }
                }
 
                <b>return</b> <span class="r218 r">valuesList</span>;
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r210 r">buffer</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r210 r">buffer</span>);
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static string</b> <a id="b9d816e55f04a237" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtFormatMessageRenderName</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r221 rd" class="r221 r">pmHandle</span>, <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r222 rd" class="r222 r">eventHandle</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#da9d7f4c517f35bf" class="t t">EvtFormatMessageFlags</a> <span id="r223 rd" class="r223 r">flag</span>)
        {
            <b>int</b> <span id="r224 rd" class="r224 r">bufferNeeded</span>;
            <span class="i">StringBuilder</span> <span id="r225 rd" class="r225 r">sb</span> = <b>new</b>(<b>null</b>);
 
            <b>bool</b> <span id="r226 rd" class="r226 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#9a3c027b521e90d3" class="i method">EvtFormatMessage</a>(<span class="r221 r">pmHandle</span>, <span class="r222 r">eventHandle</span>, 0, 0, <b>null</b>, <span class="r223 r">flag</span>, 0, <span class="r225 r">sb</span>, <b>out</b> <span class="r224 r">bufferNeeded</span>);
            <b>int</b> <span id="r227 rd" class="r227 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
 
            <b>if</b> (!<span class="r226 r">status</span> &amp;&amp; <span class="r227 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#509fbbffd4675c9f" class="i field">ERROR_EVT_UNRESOLVED_VALUE_INSERT</a>)
            {
                <span class="c">//</span>
                <span class="c">// ERROR_EVT_UNRESOLVED_VALUE_INSERT can be returned.  It means</span>
                <span class="c">// message may have one or more unsubstituted strings.  This is</span>
                <span class="c">// not an exception, but we have no way to convey the partial</span>
                <span class="c">// success out to enduser.</span>
                <span class="c">//</span>
                <b>switch</b> (<span class="r227 r">error</span>)
                {
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#3e299e9332a9df32" class="i field">ERROR_EVT_MESSAGE_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2129065147059a12" class="i field">ERROR_EVT_MESSAGE_ID_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#908459ec6434d866" class="i field">ERROR_EVT_MESSAGE_LOCALE_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#114122b78ed5374a" class="i field">ERROR_RESOURCE_LANG_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f01d70285e9f4332" class="i field">ERROR_MUI_FILE_NOT_FOUND</a>:
                        <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<span class="r227 r">error</span> != (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r227 r">error</span>);
            }
 
            <span class="r225 r">sb</span>.<span class="i">EnsureCapacity</span>(<span class="r224 r">bufferNeeded</span>);
            <span class="r226 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#9a3c027b521e90d3" class="i method">EvtFormatMessage</a>(<span class="r221 r">pmHandle</span>, <span class="r222 r">eventHandle</span>, 0, 0, <b>null</b>, <span class="r223 r">flag</span>, <span class="r224 r">bufferNeeded</span>, <span class="r225 r">sb</span>, <b>out</b> <span class="r224 r">bufferNeeded</span>);
            <span class="r227 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
 
            <b>if</b> (!<span class="r226 r">status</span> &amp;&amp; <span class="r227 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#509fbbffd4675c9f" class="i field">ERROR_EVT_UNRESOLVED_VALUE_INSERT</a>)
            {
                <b>switch</b> (<span class="r227 r">error</span>)
                {
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#3e299e9332a9df32" class="i field">ERROR_EVT_MESSAGE_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2129065147059a12" class="i field">ERROR_EVT_MESSAGE_ID_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#908459ec6434d866" class="i field">ERROR_EVT_MESSAGE_LOCALE_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#114122b78ed5374a" class="i field">ERROR_RESOURCE_LANG_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f01d70285e9f4332" class="i field">ERROR_MUI_FILE_NOT_FOUND</a>:
                        <b>return</b> <b>null</b>;
                }
 
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r227 r">error</span>);
            }
 
            <b>return</b> <span class="r225 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">// The EvtFormatMessage used for the obtaining of the Keywords names.</span>
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="6f5d8415aa918a8d" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtFormatMessageRenderKeywords</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r228 rd" class="r228 r">pmHandle</span>, <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r229 rd" class="r229 r">eventHandle</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#da9d7f4c517f35bf" class="t t">EvtFormatMessageFlags</a> <span id="r230 rd" class="r230 r">flag</span>)
        {
            <span class="i">IntPtr</span> <span id="r231 rd" class="r231 r">buffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>int</b> <span id="r232 rd" class="r232 r">bufferNeeded</span>;
 
            <b>try</b>
            {
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r233 rd" class="r233 r">keywordsList</span> = <b>new</b>();
                <b>bool</b> <span id="r234 rd" class="r234 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtFormatMessageBuffer</span>(<span class="r228 r">pmHandle</span>, <span class="r229 r">eventHandle</span>, 0, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <span class="r230 r">flag</span>, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>out</b> <span class="r232 r">bufferNeeded</span>);
                <b>int</b> <span id="r235 rd" class="r235 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
 
                <b>if</b> (!<span class="r234 r">status</span>)
                {
                    <b>switch</b> (<span class="r235 r">error</span>)
                    {
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#3e299e9332a9df32" class="i field">ERROR_EVT_MESSAGE_NOT_FOUND</a>:
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2129065147059a12" class="i field">ERROR_EVT_MESSAGE_ID_NOT_FOUND</a>:
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#908459ec6434d866" class="i field">ERROR_EVT_MESSAGE_LOCALE_NOT_FOUND</a>:
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#114122b78ed5374a" class="i field">ERROR_RESOURCE_LANG_NOT_FOUND</a>:
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f01d70285e9f4332" class="i field">ERROR_MUI_FILE_NOT_FOUND</a>:
                            <b>return</b> <span class="r233 r">keywordsList</span>.<span class="i">AsReadOnly</span>();
                    }
 
                    <b>if</b> (<span class="r235 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                        <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r235 r">error</span>);
                }
 
                <span class="r231 r">buffer</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>(<span class="r232 r">bufferNeeded</span> * 2);
                <span class="r234 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtFormatMessageBuffer</span>(<span class="r228 r">pmHandle</span>, <span class="r229 r">eventHandle</span>, 0, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <span class="r230 r">flag</span>, <span class="r232 r">bufferNeeded</span>, <span class="r231 r">buffer</span>, <b>out</b> <span class="r232 r">bufferNeeded</span>);
                <span class="r235 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r234 r">status</span>)
                {
                    <b>switch</b> (<span class="r235 r">error</span>)
                    {
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#3e299e9332a9df32" class="i field">ERROR_EVT_MESSAGE_NOT_FOUND</a>:
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2129065147059a12" class="i field">ERROR_EVT_MESSAGE_ID_NOT_FOUND</a>:
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#908459ec6434d866" class="i field">ERROR_EVT_MESSAGE_LOCALE_NOT_FOUND</a>:
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#114122b78ed5374a" class="i field">ERROR_RESOURCE_LANG_NOT_FOUND</a>:
                        <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f01d70285e9f4332" class="i field">ERROR_MUI_FILE_NOT_FOUND</a>:
                            <b>return</b> <span class="r233 r">keywordsList</span>;
                    }
 
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r235 r">error</span>);
                }
 
                <span class="i">IntPtr</span> <span id="r236 rd" class="r236 r">pointer</span> = <span class="r231 r">buffer</span>;
 
                <b>while</b> (<b>true</b>)
                {
                    <b>string</b> <span id="r237 rd" class="r237 r">s</span> = <span class="i">Marshal</span>.<span class="i">PtrToStringUni</span>(<span class="r236 r">pointer</span>);
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r237 r">s</span>))
                        <b>break</b>;
                    <span class="r233 r">keywordsList</span>.<span class="i">Add</span>(<span class="r237 r">s</span>);
                    <span class="c">// nr of bytes = # chars * 2 + 2 bytes for character &#39;\0&#39;.</span>
                    <span class="r236 r">pointer</span> = <b>new</b> <span class="i">IntPtr</span>((<b>long</b>)<span class="r236 r">pointer</span> + (<span class="r237 r">s</span>.<span class="i">Length</span> * 2) + 2);
                }
 
                <b>return</b> <span class="r233 r">keywordsList</span>.<span class="i">AsReadOnly</span>();
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r231 r">buffer</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r231 r">buffer</span>);
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static string</b> <a id="b885106f04cdca06" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtRenderBookmark</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r238 rd" class="r238 r">eventHandle</span>)
        {
            <span class="i">IntPtr</span> <span id="r239 rd" class="r239 r">buffer</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            <b>int</b> <span id="r240 rd" class="r240 r">bufferNeeded</span>;
            <b>int</b> <span id="r241 rd" class="r241 r">propCount</span>;
            <b>const</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#cbf7f0e52ab71aa1" class="t t">EvtRenderFlags</a> <span id="r242 rd" class="r242 r">flag</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#cbf7f0e52ab71aa1" class="t t">EvtRenderFlags</a>.<a href="../UnsafeNativeMethods.cs.html#cd7bcb0f264c3da2" class="i field">EvtRenderBookmark</a>;
 
            <b>try</b>
            {
                <b>bool</b> <span id="r243 rd" class="r243 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtRender</span>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a>.<a href="EventLogHandle.cs.html#506ba88538eff8b0" class="i property">Zero</a>, <span class="r238 r">eventHandle</span>, <span class="r242 r">flag</span>, 0, <span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>out</b> <span class="r240 r">bufferNeeded</span>, <b>out</b> <span class="r241 r">propCount</span>);
                <b>int</b> <span id="r244 rd" class="r244 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r243 r">status</span>)
                {
                    <b>if</b> (<span class="r244 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                        <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r244 r">error</span>);
                }
 
                <span class="r239 r">buffer</span> = <span class="i">Marshal</span>.<span class="i">AllocHGlobal</span>((<b>int</b>)<span class="r240 r">bufferNeeded</span>);
                <span class="r243 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2b9f76471cb51582" class="i method">EvtRender</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a>.<a href="EventLogHandle.cs.html#506ba88538eff8b0" class="i property">Zero</a>, <span class="r238 r">eventHandle</span>, <span class="r242 r">flag</span>, <span class="r240 r">bufferNeeded</span>, <span class="r239 r">buffer</span>, <b>out</b> <span class="r240 r">bufferNeeded</span>, <b>out</b> <span class="r241 r">propCount</span>);
                <span class="r244 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                <b>if</b> (!<span class="r243 r">status</span>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r244 r">error</span>);
 
                <b>return</b> <span class="i">Marshal</span>.<span class="i">PtrToStringUni</span>(<span class="r239 r">buffer</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r239 r">buffer</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                    <span class="i">Marshal</span>.<span class="i">FreeHGlobal</span>(<span class="r239 r">buffer</span>);
            }
        }
 
        <span class="c">// Get the formatted description, using the msgId for FormatDescription(string [])</span>
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecuritySafeCritical</span>]
        <b>public static string</b> <a id="4c0bd011a10f9556" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EvtFormatMessageFormatDescription</a>(<a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r245 rd" class="r245 r">handle</span>, <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <span id="r246 rd" class="r246 r">eventHandle</span>, <b>string</b>[] <span id="r247 rd" class="r247 r">values</span>)
        {
            <b>int</b> <span id="r248 rd" class="r248 r">bufferNeeded</span>;
 
            <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#ded2f6f892cd70a9" class="t t">EvtStringVariant</a>[] <span id="r249 rd" class="r249 r">stringVariants</span> = <b>new</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#ded2f6f892cd70a9" class="t t">EvtStringVariant</a>[<span class="r247 r">values</span>.<span class="i">Length</span>];
            <b>for</b> (<b>int</b> <span id="r250 rd" class="r250 r">i</span> = 0; <span class="r250 r">i</span> &lt; <span class="r247 r">values</span>.<span class="i">Length</span>; <span class="r250 r">i</span>++)
            {
                <span class="r249 r">stringVariants</span>[<span class="r250 r">i</span>].<a href="../UnsafeNativeMethods.cs.html#ff5c2e6b43ce2bc7" class="i field">Type</a> = (<b>uint</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#41e9ccc4fe63d7d7" class="i field">EvtVarTypeString</a>;
                <span class="r249 r">stringVariants</span>[<span class="r250 r">i</span>].<a href="../UnsafeNativeMethods.cs.html#fa9dbcb9e79b22af" class="i field">StringVal</a> = <span class="r247 r">values</span>[<span class="r250 r">i</span>];
            }
 
            <span class="i">StringBuilder</span> <span id="r251 rd" class="r251 r">sb</span> = <b>new</b>(<b>null</b>);
            <b>bool</b> <span id="r252 rd" class="r252 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtFormatMessage</span>(<span class="r245 r">handle</span>, <span class="r246 r">eventHandle</span>, 0xffffffff, <span class="r247 r">values</span>.<span class="i">Length</span>, <span class="r249 r">stringVariants</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#da9d7f4c517f35bf" class="t t">EvtFormatMessageFlags</a>.<a href="../UnsafeNativeMethods.cs.html#41440c48d93be3eb" class="i field">EvtFormatMessageEvent</a>, 0, <span class="r251 r">sb</span>, <b>out</b> <span class="r248 r">bufferNeeded</span>);
            <b>int</b> <span id="r253 rd" class="r253 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
 
            <b>if</b> (!<span class="r252 r">status</span> &amp;&amp; <span class="r253 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#509fbbffd4675c9f" class="i field">ERROR_EVT_UNRESOLVED_VALUE_INSERT</a>)
            {
                <span class="c">//</span>
                <span class="c">// ERROR_EVT_UNRESOLVED_VALUE_INSERT can be returned.  It means</span>
                <span class="c">// message may have one or more unsubstituted strings.  This is</span>
                <span class="c">// not an exception, but we have no way to convey the partial</span>
                <span class="c">// success out to enduser.</span>
                <span class="c">//</span>
                <b>switch</b> (<span class="r253 r">error</span>)
                {
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#3e299e9332a9df32" class="i field">ERROR_EVT_MESSAGE_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2129065147059a12" class="i field">ERROR_EVT_MESSAGE_ID_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#908459ec6434d866" class="i field">ERROR_EVT_MESSAGE_LOCALE_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#114122b78ed5374a" class="i field">ERROR_RESOURCE_LANG_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f01d70285e9f4332" class="i field">ERROR_MUI_FILE_NOT_FOUND</a>:
                        <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<span class="r253 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2bea76c45f94fb7f" class="i field">ERROR_INSUFFICIENT_BUFFER</a>)
                    <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r253 r">error</span>);
            }
 
            <span class="r251 r">sb</span>.<span class="i">EnsureCapacity</span>(<span class="r248 r">bufferNeeded</span>);
            <span class="r252 r">status</span> = <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<span class="i">EvtFormatMessage</span>(<span class="r245 r">handle</span>, <span class="r246 r">eventHandle</span>, 0xffffffff, <span class="r247 r">values</span>.<span class="i">Length</span>, <span class="r249 r">stringVariants</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#da9d7f4c517f35bf" class="t t">EvtFormatMessageFlags</a>.<a href="../UnsafeNativeMethods.cs.html#41440c48d93be3eb" class="i field">EvtFormatMessageEvent</a>, <span class="r248 r">bufferNeeded</span>, <span class="r251 r">sb</span>, <b>out</b> <span class="r248 r">bufferNeeded</span>);
            <span class="r253 r">error</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
 
            <b>if</b> (!<span class="r252 r">status</span> &amp;&amp; <span class="r253 r">error</span> != <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#509fbbffd4675c9f" class="i field">ERROR_EVT_UNRESOLVED_VALUE_INSERT</a>)
            {
                <b>switch</b> (<span class="r253 r">error</span>)
                {
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#3e299e9332a9df32" class="i field">ERROR_EVT_MESSAGE_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#2129065147059a12" class="i field">ERROR_EVT_MESSAGE_ID_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#908459ec6434d866" class="i field">ERROR_EVT_MESSAGE_LOCALE_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#114122b78ed5374a" class="i field">ERROR_RESOURCE_LANG_NOT_FOUND</a>:
                    <b>case</b> <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#f01d70285e9f4332" class="i field">ERROR_MUI_FILE_NOT_FOUND</a>:
                        <b>return</b> <b>null</b>;
                }
 
                <a href="#29862274e5436431" class="i method">ThrowEventLogException</a>(<span class="r253 r">error</span>);
            }
 
            <b>return</b> <span class="r251 r">sb</span>.<span class="i">ToString</span>();
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>private static object</b> <a id="43eae73d3ab9bf91" href="../../../R/43eae73d3ab9bf91.html" target="n" data-glyph="76,1" class="i method">ConvertToObject</a>(<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r254 rd" class="r254 r">val</span>)
        {
            <b>switch</b> (<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#ba130a5d903bbc7a" class="i field">Type</a>)
            {
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#8c6d4f44eb07191a" class="i field">EvtVarTypeUInt32</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#704446694d98bde4" class="i field">UInteger</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#82e610904e273462" class="i field">EvtVarTypeInt32</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#ae356f0f8faabaa9" class="i field">Integer</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#ac01be872c788e89" class="i field">EvtVarTypeUInt16</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#d08b5bf1a4e463ea" class="i field">UShort</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#0fb9eaf7bfa1816f" class="i field">EvtVarTypeInt16</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#80091b6eb6823cb0" class="i field">SByte</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#f7d573a86fd33c9f" class="i field">EvtVarTypeByte</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#81ca3bf66efd8b7c" class="i field">UInt8</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#7911d8691311648d" class="i field">EvtVarTypeSByte</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#80091b6eb6823cb0" class="i field">SByte</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#28ba3f878a9ffb27" class="i field">EvtVarTypeUInt64</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#63648456d1939a05" class="i field">ULong</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#90c1bb57b8ed9af4" class="i field">EvtVarTypeInt64</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#a936c1af4681f33d" class="i field">Long</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#5d881aed15a08a65" class="i field">EvtVarTypeHexInt64</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#63648456d1939a05" class="i field">ULong</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#c03f27626c7eea10" class="i field">EvtVarTypeHexInt32</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#ae356f0f8faabaa9" class="i field">Integer</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#3d0d247cb51cdec5" class="i field">EvtVarTypeSingle</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#e0b4e5eca21dd2bb" class="i field">Single</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#631c21694b725362" class="i field">EvtVarTypeDouble</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3fb576157b535d10" class="i field">Double</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#4d4a93924fcdf0d7" class="i field">EvtVarTypeNull</a>:
                    <b>return</b> <b>null</b>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#41e9ccc4fe63d7d7" class="i field">EvtVarTypeString</a>:
                    <b>return</b> <a href="#f5af38ca53ff2ad2" class="i method">ConvertToString</a>(<span class="r254 r">val</span>);
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#c7726713db0b5ca3" class="i field">EvtVarTypeAnsiString</a>:
                    <b>return</b> <a href="#1759e2127e5f3d63" class="i method">ConvertToAnsiString</a>(<span class="r254 r">val</span>);
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#48846a057626aff6" class="i field">EvtVarTypeSid</a>:
                    <b>return</b> (<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#5944dfed3f2c8c5e" class="i field">SidVal</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>) ? <b>null</b> : <b>new</b> <span class="i">SecurityIdentifier</span>(<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#5944dfed3f2c8c5e" class="i field">SidVal</a>);
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#f30c515fd3077028" class="i field">EvtVarTypeGuid</a>:
                    <b>return</b> (<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3906198663ca80a1" class="i field">GuidReference</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>) ? <span class="i">Guid</span>.<span class="i">Empty</span> : <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<span class="i">Guid</span>&gt;(<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3906198663ca80a1" class="i field">GuidReference</a>);
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#22339a754bfbd961" class="i field">EvtVarTypeEvtHandle</a>:
                    <b>return</b> <a href="#8bbbbca9fc4fff6b" class="i method">ConvertToSafeHandle</a>(<span class="r254 r">val</span>);
                <b>case</b> (<b>int</b>)(<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#adebe2f8e9aa85ed" class="i field">EvtVarTypeFileTime</a>:
                    <b>return</b> <span class="i">DateTime</span>.<span class="i">FromFileTime</span>((<b>long</b>)<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#b820cd9b49ebd386" class="i field">FileTime</a>);
                <b>case</b> (<b>int</b>)(<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#3c38497604cd12a9" class="i field">EvtVarTypeSysTime</a>:
                    <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#6564ad6b2fea3415" class="t t">SystemTime</a> <span id="r255 rd" class="r255 r">sysTime</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#6564ad6b2fea3415" class="t t">SystemTime</a>&gt;(<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#5772068225467ed3" class="i field">SystemTime</a>);
                    <b>return</b> <b>new</b> <span class="i">DateTime</span>(<span class="r255 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#ed7e1f8bf2c85798" class="i field">Year</a>, <span class="r255 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#7b5243983eff2370" class="i field">Month</a>, <span class="r255 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#daa9521fd0f4283a" class="i field">Day</a>, <span class="r255 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#536d885c9c82bf0a" class="i field">Hour</a>, <span class="r255 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#81b6e53510ab1b1b" class="i field">Minute</a>, <span class="r255 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#93a09f9a96f1a59d" class="i field">Second</a>, <span class="r255 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#8e5c61d7f5be0d9b" class="i field">Milliseconds</a>);
                <b>case</b> (<b>int</b>)(<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#e014dc52d728730a" class="i field">EvtVarTypeSizeT</a>:
                    <b>return</b> <span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3fb8169d7a3aa42d" class="i field">SizeT</a>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#b04a2b94bf9f1117" class="i field">EvtVarTypeBoolean</a>:
                    <b>if</b> (<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#fac0d094d0609d87" class="i field">Bool</a> != 0) <b>return</b> <b>true</b>;
                    <b>else</b> <b>return</b> <b>false</b>;
                <b>case</b> (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#c1f84039176c6deb" class="i field">EvtVarTypeBinary</a>:
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#f7d573a86fd33c9f" class="i field">EvtVarTypeByte</a>):
                    <b>if</b> (<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>) <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>byte</b>&gt;();
                    <b>byte</b>[] <span id="r256 rd" class="r256 r">arByte</span> = <b>new</b> <b>byte</b>[<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>];
                    <span class="i">Marshal</span>.<span class="i">Copy</span>(<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a>, <span class="r256 r">arByte</span>, 0, (<b>int</b>)<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>);
                    <b>return</b> <span class="r256 r">arByte</span>;
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#0fb9eaf7bfa1816f" class="i field">EvtVarTypeInt16</a>):
                    <b>if</b> (<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>) <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>short</b>&gt;();
                    <b>short</b>[] <span id="r257 rd" class="r257 r">arInt16</span> = <b>new</b> <b>short</b>[<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>];
                    <span class="i">Marshal</span>.<span class="i">Copy</span>(<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a>, <span class="r257 r">arInt16</span>, 0, (<b>int</b>)<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>);
                    <b>return</b> <span class="r257 r">arInt16</span>;
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#82e610904e273462" class="i field">EvtVarTypeInt32</a>):
                    <b>if</b> (<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>) <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>int</b>&gt;();
                    <b>int</b>[] <span id="r258 rd" class="r258 r">arInt32</span> = <b>new</b> <b>int</b>[<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>];
                    <span class="i">Marshal</span>.<span class="i">Copy</span>(<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a>, <span class="r258 r">arInt32</span>, 0, (<b>int</b>)<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>);
                    <b>return</b> <span class="r258 r">arInt32</span>;
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#90c1bb57b8ed9af4" class="i field">EvtVarTypeInt64</a>):
                    <b>if</b> (<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>) <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>long</b>&gt;();
                    <b>long</b>[] <span id="r259 rd" class="r259 r">arInt64</span> = <b>new</b> <b>long</b>[<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>];
                    <span class="i">Marshal</span>.<span class="i">Copy</span>(<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a>, <span class="r259 r">arInt64</span>, 0, (<b>int</b>)<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>);
                    <b>return</b> <span class="r259 r">arInt64</span>;
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#3d0d247cb51cdec5" class="i field">EvtVarTypeSingle</a>):
                    <b>if</b> (<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>) <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>float</b>&gt;();
                    <b>float</b>[] <span id="r260 rd" class="r260 r">arSingle</span> = <b>new</b> <b>float</b>[<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>];
                    <span class="i">Marshal</span>.<span class="i">Copy</span>(<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a>, <span class="r260 r">arSingle</span>, 0, (<b>int</b>)<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>);
                    <b>return</b> <span class="r260 r">arSingle</span>;
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#631c21694b725362" class="i field">EvtVarTypeDouble</a>):
                    <b>if</b> (<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>) <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>double</b>&gt;();
                    <b>double</b>[] <span id="r261 rd" class="r261 r">arDouble</span> = <b>new</b> <b>double</b>[<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>];
                    <span class="i">Marshal</span>.<span class="i">Copy</span>(<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a>, <span class="r261 r">arDouble</span>, 0, (<b>int</b>)<span class="r254 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>);
                    <b>return</b> <span class="r261 r">arDouble</span>;
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#7911d8691311648d" class="i field">EvtVarTypeSByte</a>):
                    <b>return</b> <a href="#8ae2c24c1fc086d8" class="i method">ConvertToArray</a>&lt;<b>sbyte</b>&gt;(<span class="r254 r">val</span>, <b>sizeof</b>(<b>sbyte</b>)); <span class="c">// not CLS-compliant</span>
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#ac01be872c788e89" class="i field">EvtVarTypeUInt16</a>):
                    <b>return</b> <a href="#8ae2c24c1fc086d8" class="i method">ConvertToArray</a>&lt;<b>ushort</b>&gt;(<span class="r254 r">val</span>, <b>sizeof</b>(<b>ushort</b>));
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#28ba3f878a9ffb27" class="i field">EvtVarTypeUInt64</a>):
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#5d881aed15a08a65" class="i field">EvtVarTypeHexInt64</a>):
                    <b>return</b> <a href="#8ae2c24c1fc086d8" class="i method">ConvertToArray</a>&lt;<b>ulong</b>&gt;(<span class="r254 r">val</span>, <b>sizeof</b>(<b>ulong</b>));
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#8c6d4f44eb07191a" class="i field">EvtVarTypeUInt32</a>):
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#c03f27626c7eea10" class="i field">EvtVarTypeHexInt32</a>):
                    <b>return</b> <a href="#8ae2c24c1fc086d8" class="i method">ConvertToArray</a>&lt;<b>uint</b>&gt;(<span class="r254 r">val</span>, <b>sizeof</b>(<b>uint</b>));
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#41e9ccc4fe63d7d7" class="i field">EvtVarTypeString</a>):
                    <b>return</b> <a href="#946637ea59e4f3a2" class="i method">ConvertToStringArray</a>(<span class="r254 r">val</span>, <b>false</b>);
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#c7726713db0b5ca3" class="i field">EvtVarTypeAnsiString</a>):
                    <b>return</b> <a href="#946637ea59e4f3a2" class="i method">ConvertToStringArray</a>(<span class="r254 r">val</span>, <b>true</b>);
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#b04a2b94bf9f1117" class="i field">EvtVarTypeBoolean</a>):
                    <b>return</b> <a href="#96cbf5b1a53a2aba" class="i method">ConvertToBoolArray</a>(<span class="r254 r">val</span>);
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#f30c515fd3077028" class="i field">EvtVarTypeGuid</a>):
                    <b>return</b> <span class="i">ConvertToArray</span>&lt;<span class="i">Guid</span>&gt;(<span class="r254 r">val</span>, 16 * <b>sizeof</b>(<b>byte</b>));
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#adebe2f8e9aa85ed" class="i field">EvtVarTypeFileTime</a>):
                    <b>return</b> <a href="#540cd8edf591bbfa" class="i method">ConvertToFileTimeArray</a>(<span class="r254 r">val</span>);
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#3c38497604cd12a9" class="i field">EvtVarTypeSysTime</a>):
                    <b>return</b> <a href="#887b27289ae54ad4" class="i method">ConvertToSysTimeArray</a>(<span class="r254 r">val</span>);
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#c1f84039176c6deb" class="i field">EvtVarTypeBinary</a>): <span class="c">// both length and count in the manifest: tracrpt supports, Crimson APIs don&#39;t</span>
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#e014dc52d728730a" class="i field">EvtVarTypeSizeT</a>):  <span class="c">// unused: array of win:pointer is returned as HexIntXX</span>
                <b>case</b> ((<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#c0d427eb2a903e90" class="t t">EvtMasks</a>.<a href="../UnsafeNativeMethods.cs.html#e861f21c8423e918" class="i field">EVT_VARIANT_TYPE_ARRAY</a> | (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#48846a057626aff6" class="i field">EvtVarTypeSid</a>): <span class="c">// unsupported by native APIs</span>
                <b>default</b>:
                    <b>throw</b> <b>new</b> <span class="i">EventLogInvalidDataException</span>();
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static object</b> <a id="2a73d9c9672d276f" href="../../../R/2a73d9c9672d276f.html" target="n" data-glyph="72,1" class="i method">ConvertToObject</a>(<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r262 rd" class="r262 r">val</span>, <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a> <span id="r263 rd" class="r263 r">desiredType</span>)
        {
            <b>if</b> (<span class="r262 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#ba130a5d903bbc7a" class="i field">Type</a> == (<b>int</b>)<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#17c215806046868e" class="t t">EvtVariantType</a>.<a href="../UnsafeNativeMethods.cs.html#4d4a93924fcdf0d7" class="i field">EvtVarTypeNull</a>) <b>return</b> <b>null</b>;
            <b>if</b> (<span class="r262 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#ba130a5d903bbc7a" class="i field">Type</a> != (<b>int</b>)<span class="r263 r">desiredType</span>)
                <b>throw</b> <b>new</b> <span class="i">EventLogInvalidDataException</span>();
 
            <b>return</b> <a href="#43eae73d3ab9bf91" class="i method">ConvertToObject</a>(<span class="r262 r">val</span>);
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static string</b> <a id="f5af38ca53ff2ad2" href="../../../R/f5af38ca53ff2ad2.html" target="n" data-glyph="72,1" class="i method">ConvertToString</a>(<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r264 rd" class="r264 r">val</span>)
        {
            <b>if</b> (<span class="r264 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#5af593504530b3e5" class="i field">StringVal</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            <b>else</b>
                <b>return</b> <span class="i">Marshal</span>.<span class="i">PtrToStringUni</span>(<span class="r264 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#5af593504530b3e5" class="i field">StringVal</a>);
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static string</b> <a id="1759e2127e5f3d63" href="../../../R/1759e2127e5f3d63.html" target="n" data-glyph="72,1" class="i method">ConvertToAnsiString</a>(<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r265 rd" class="r265 r">val</span>)
        {
            <b>if</b> (<span class="r265 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#b0a142521aec1ffe" class="i field">AnsiString</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            <b>else</b>
                <b>return</b> <span class="i">Marshal</span>.<span class="i">PtrToStringAnsi</span>(<span class="r265 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#b0a142521aec1ffe" class="i field">AnsiString</a>);
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a> <a id="8bbbbca9fc4fff6b" href="../../../R/8bbbbca9fc4fff6b.html" target="n" data-glyph="72,1" class="i method">ConvertToSafeHandle</a>(<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r266 rd" class="r266 r">val</span>)
        {
            <b>if</b> (<span class="r266 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#bfe52cf511109e3d" class="i field">Handle</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                <b>return</b> <a href="EventLogHandle.cs.html#db50848661fc54e7" class="t t">EventLogHandle</a>.<a href="EventLogHandle.cs.html#506ba88538eff8b0" class="i property">Zero</a>;
            <b>else</b>
                <b>return</b> <b>new</b> <a href="EventLogHandle.cs.html#213b9eb44275ea36" class="t constructor">EventLogHandle</a>(<span class="r266 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#bfe52cf511109e3d" class="i field">Handle</a>, <b>true</b>);
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <span class="i">Array</span> <a id="8ae2c24c1fc086d8" href="../../../R/8ae2c24c1fc086d8.html" target="n" data-glyph="72,1" class="i method">ConvertToArray</a>&lt;<span id="r267 rd t" class="r267 r t">T</span>&gt;(<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r268 rd" class="r268 r">val</span>, <b>int</b> <span id="r269 rd" class="r269 r">size</span>) <b>where</b> <span class="r267 r t">T</span> : <b>struct</b>
        {
            <span class="i">IntPtr</span> <span id="r270 rd" class="r270 r">ptr</span> = <span class="r268 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a>;
            <b>if</b> (<span class="r270 r">ptr</span> == <span class="i">IntPtr</span>.<span class="i">Zero</span>)
            {
                <b>return</b> <span class="i">Array</span>.<span class="i">CreateInstance</span>(<b>typeof</b>(<span class="r267 r t">T</span>), 0);
            }
            <b>else</b>
            {
                <span class="i">Array</span> <span id="r271 rd" class="r271 r">array</span> = <span class="i">Array</span>.<span class="i">CreateInstance</span>(<b>typeof</b>(<span class="r267 r t">T</span>), (<b>int</b>)<span class="r268 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>);
                <b>for</b> (<b>int</b> <span id="r272 rd" class="r272 r">i</span> = 0; <span class="r272 r">i</span> &lt; <span class="r268 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>; <span class="r272 r">i</span>++)
                {
                    <span class="r271 r">array</span>.<span class="i">SetValue</span>(<span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<span class="r267 r t">T</span>&gt;(<span class="r270 r">ptr</span>), <span class="r272 r">i</span>);
                    <span class="r270 r">ptr</span> = <b>new</b> <span class="i">IntPtr</span>((<b>long</b>)<span class="r270 r">ptr</span> + <span class="r269 r">size</span>);
                }
 
                <b>return</b> <span class="r271 r">array</span>;
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <span class="i">Array</span> <a id="96cbf5b1a53a2aba" href="../../../R/96cbf5b1a53a2aba.html" target="n" data-glyph="72,1" class="i method">ConvertToBoolArray</a>(<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r273 rd" class="r273 r">val</span>)
        {
            <span class="c">// NOTE: booleans are padded to 4 bytes in ETW</span>
            <span class="i">IntPtr</span> <span id="r274 rd" class="r274 r">ptr</span> = <span class="r273 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a>;
            <b>if</b> (<span class="r274 r">ptr</span> == <span class="i">IntPtr</span>.<span class="i">Zero</span>)
            {
                <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>bool</b>&gt;();
            }
            <b>else</b>
            {
                <b>bool</b>[] <span id="r275 rd" class="r275 r">array</span> = <b>new</b> <b>bool</b>[<span class="r273 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>];
                <b>for</b> (<b>int</b> <span id="r276 rd" class="r276 r">i</span> = 0; <span class="r276 r">i</span> &lt; <span class="r273 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>; <span class="r276 r">i</span>++)
                {
                    <b>bool</b> <span id="r277 rd" class="r277 r">value</span> = <span class="i">Marshal</span>.<span class="i">ReadInt32</span>(<span class="r274 r">ptr</span>) != 0;
                    <span class="r275 r">array</span>[<span class="r276 r">i</span>] = <span class="r277 r">value</span>;
                    <span class="r274 r">ptr</span> = <b>new</b> <span class="i">IntPtr</span>((<b>long</b>)<span class="r274 r">ptr</span> + 4);
                }
 
                <b>return</b> <span class="r275 r">array</span>;
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <span class="i">Array</span> <a id="540cd8edf591bbfa" href="../../../R/540cd8edf591bbfa.html" target="n" data-glyph="72,1" class="i method">ConvertToFileTimeArray</a>(<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r278 rd" class="r278 r">val</span>)
        {
            <span class="i">IntPtr</span> <span id="r279 rd" class="r279 r">ptr</span> = <span class="r278 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a>;
            <b>if</b> (<span class="r279 r">ptr</span> == <span class="i">IntPtr</span>.<span class="i">Zero</span>)
            {
                <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<span class="i">DateTime</span>&gt;();
            }
            <b>else</b>
            {
                <span class="i">DateTime</span>[] <span id="r280 rd" class="r280 r">array</span> = <b>new</b> <span class="i">DateTime</span>[<span class="r278 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>];
                <b>for</b> (<b>int</b> <span id="r281 rd" class="r281 r">i</span> = 0; <span class="r281 r">i</span> &lt; <span class="r278 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>; <span class="r281 r">i</span>++)
                {
                    <span class="r280 r">array</span>[<span class="r281 r">i</span>] = <span class="i">DateTime</span>.<span class="i">FromFileTime</span>(<span class="i">Marshal</span>.<span class="i">ReadInt64</span>(<span class="r279 r">ptr</span>));
                    <span class="r279 r">ptr</span> = <b>new</b> <span class="i">IntPtr</span>((<b>long</b>)<span class="r279 r">ptr</span> + 8 * <b>sizeof</b>(<b>byte</b>)); <span class="c">// FILETIME values are 8 bytes</span>
                }
 
                <b>return</b> <span class="r280 r">array</span>;
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static</b> <span class="i">Array</span> <a id="887b27289ae54ad4" href="../../../R/887b27289ae54ad4.html" target="n" data-glyph="72,1" class="i method">ConvertToSysTimeArray</a>(<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r282 rd" class="r282 r">val</span>)
        {
            <span class="i">IntPtr</span> <span id="r283 rd" class="r283 r">ptr</span> = <span class="r282 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a>;
            <b>if</b> (<span class="r283 r">ptr</span> == <span class="i">IntPtr</span>.<span class="i">Zero</span>)
            {
                <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<span class="i">DateTime</span>&gt;();
            }
            <b>else</b>
            {
                <span class="i">DateTime</span>[] <span id="r284 rd" class="r284 r">array</span> = <b>new</b> <span class="i">DateTime</span>[<span class="r282 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>];
                <b>for</b> (<b>int</b> <span id="r285 rd" class="r285 r">i</span> = 0; <span class="r285 r">i</span> &lt; <span class="r282 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>; <span class="r285 r">i</span>++)
                {
                    <a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#6564ad6b2fea3415" class="t t">SystemTime</a> <span id="r286 rd" class="r286 r">sysTime</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#6564ad6b2fea3415" class="t t">SystemTime</a>&gt;(<span class="r283 r">ptr</span>);
                    <span class="r284 r">array</span>[<span class="r285 r">i</span>] = <b>new</b> <span class="i">DateTime</span>(<span class="r286 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#ed7e1f8bf2c85798" class="i field">Year</a>, <span class="r286 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#7b5243983eff2370" class="i field">Month</a>, <span class="r286 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#daa9521fd0f4283a" class="i field">Day</a>, <span class="r286 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#536d885c9c82bf0a" class="i field">Hour</a>, <span class="r286 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#81b6e53510ab1b1b" class="i field">Minute</a>, <span class="r286 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#93a09f9a96f1a59d" class="i field">Second</a>, <span class="r286 r">sysTime</span>.<a href="../UnsafeNativeMethods.cs.html#8e5c61d7f5be0d9b" class="i field">Milliseconds</a>);
                    <span class="r283 r">ptr</span> = <b>new</b> <span class="i">IntPtr</span>((<b>long</b>)<span class="r283 r">ptr</span> + 16 * <b>sizeof</b>(<b>byte</b>)); <span class="c">// SystemTime values are 16 bytes</span>
                }
 
                <b>return</b> <span class="r284 r">array</span>;
            }
        }
 
        [<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityCritical</span>]
        <b>public static string</b>[] <a id="946637ea59e4f3a2" href="../../../R/946637ea59e4f3a2.html" target="n" data-glyph="72,1" class="i method">ConvertToStringArray</a>(<a href="../UnsafeNativeMethods.cs.html#709022098358381c" class="t t">UnsafeNativeMethods</a>.<a href="../UnsafeNativeMethods.cs.html#1b8ac08eca996829" class="t t">EvtVariant</a> <span id="r287 rd" class="r287 r">val</span>, <b>bool</b> <span id="r288 rd" class="r288 r">ansi</span>)
        {
            <b>if</b> (<span class="r287 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a> == <span class="i">IntPtr</span>.<span class="i">Zero</span>)
            {
                <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
            }
            <b>else</b>
            {
                <span class="i">IntPtr</span> <span id="r289 rd" class="r289 r">ptr</span> = <span class="r287 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#3c0ab78b2d560462" class="i field">Reference</a>;
                <span class="i">IntPtr</span>[] <span id="r290 rd" class="r290 r">pointersToString</span> = <b>new</b> <span class="i">IntPtr</span>[<span class="r287 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>];
                <span class="i">Marshal</span>.<span class="i">Copy</span>(<span class="r289 r">ptr</span>, <span class="r290 r">pointersToString</span>, 0, (<b>int</b>)<span class="r287 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>);
                <b>string</b>[] <span id="r291 rd" class="r291 r">stringArray</span> = <b>new</b> <b>string</b>[<span class="r287 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>];
                <b>for</b> (<b>int</b> <span id="r292 rd" class="r292 r">i</span> = 0; <span class="r292 r">i</span> &lt; <span class="r287 r">val</span>.<a href="../UnsafeNativeMethods.cs.html#405541c5160fdd5b" class="i field">Count</a>; <span class="r292 r">i</span>++)
                {
                    <span class="r291 r">stringArray</span>[<span class="r292 r">i</span>] = <span class="r288 r">ansi</span> ? <span class="i">Marshal</span>.<span class="i">PtrToStringAnsi</span>(<span class="r290 r">pointersToString</span>[<span class="r292 r">i</span>]) : <span class="i">Marshal</span>.<span class="i">PtrToStringUni</span>(<span class="r290 r">pointersToString</span>[<span class="r292 r">i</span>]);
                }
 
                <b>return</b> <span class="r291 r">stringArray</span>;
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
