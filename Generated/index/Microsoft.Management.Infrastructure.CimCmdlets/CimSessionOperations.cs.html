<!DOCTYPE html>
<html><head><title>CimSessionOperations.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(1249);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Management.Infrastructure.CimCmdlets/CimSessionOperations.cs" target="_top">CimSessionOperations.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Management.Infrastructure.CimCmdlets" target="_top">src\Microsoft.Management.Infrastructure.CimCmdlets\Microsoft.Management.Infrastructure.CimCmdlets.csproj</a> (Microsoft.Management.Infrastructure.CimCmdlets)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">region</span> Using directives
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Concurrent</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Management</span>.<span class="i n">Infrastructure</span>.<span class="i">Options</span>;
 
<span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Management</span>.<span class="i n">Infrastructure</span>.<span class="i n">CimCmdlets</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CimSessionWrapper
 
    <b>internal class</b> <a id="78aeb9bf6b3fce4e" href="R/78aeb9bf6b3fce4e.html" target="n" data-glyph="2,0" class="t t">CimSessionWrapper</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Id of the cimsession.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public uint</b> <a id="85fd2064576ddada" href="R/85fd2064576ddada.html" target="n" data-glyph="102,1" class="i property">SessionId</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InstanceId of the cimsession.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Guid</span> <a id="b73d03a35f5b34a0" href="R/b73d03a35f5b34a0.html" target="n" data-glyph="102,1" class="i property">InstanceId</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the cimsession.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="c1b0d0489469103a" href="R/c1b0d0489469103a.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computer name of the cimsession.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="c00077748b964a0f" href="R/c00077748b964a0f.html" target="n" data-glyph="102,1" class="i property">ComputerName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrapped cimsession object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">CimSession</span> <a id="e5a5ff13737b89a1" href="R/e5a5ff13737b89a1.html" target="n" data-glyph="102,1" class="i property">CimSession</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computer name of the cimsession.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="1345ea40ea5c90c7" href="R/1345ea40ea5c90c7.html" target="n" data-glyph="102,1" class="i property">Protocol</a>
        {
            <b>get</b>
            {
                <b>switch</b> (<a href="#9ff52af03006f062" class="i field">protocol</a>)
                {
                    <b>case</b> <a href="NewCimSessionOptionCommand.cs.html#0e497fefee80122f" class="t t">ProtocolType</a>.<a href="NewCimSessionOptionCommand.cs.html#e463eb81efd84241" class="i field">Dcom</a>:
                        <b>return</b> <span class="s">&quot;DCOM&quot;</span>;
                    <b>case</b> <a href="NewCimSessionOptionCommand.cs.html#0e497fefee80122f" class="t t">ProtocolType</a>.<a href="NewCimSessionOptionCommand.cs.html#8c61f7d3cd94c71c" class="i field">Default</a>:
                    <b>case</b> <a href="NewCimSessionOptionCommand.cs.html#0e497fefee80122f" class="t t">ProtocolType</a>.<a href="NewCimSessionOptionCommand.cs.html#9ed00d72429bb18e" class="i field">Wsman</a>:
                    <b>default</b>:
                        <b>return</b> <span class="s">&quot;WSMAN&quot;</span>;
                }
            }
        }
 
        <b>internal</b> <a href="NewCimSessionOptionCommand.cs.html#0e497fefee80122f" class="t t">ProtocolType</a> <a id="958f65f9c1c41e37" href="R/958f65f9c1c41e37.html" target="n" data-glyph="74,1" class="i method">GetProtocolType</a>()
        {
            <b>return</b> <a href="#9ff52af03006f062" class="i field">protocol</a>;
        }
 
        <b>private readonly</b> <a href="NewCimSessionOptionCommand.cs.html#0e497fefee80122f" class="t t">ProtocolType</a> <a id="9ff52af03006f062" href="R/9ff52af03006f062.html" target="n" data-glyph="46,1" class="i field">protocol</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PSObject that wrapped the cimSession.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="fbcb058741ea4406" href="R/fbcb058741ea4406.html" target="n" data-glyph="46,1" class="i field">psObject</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>internal</b> <a id="a7ffbf3e24500238" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">CimSessionWrapper</a>(
            <b>uint</b> <span id="r0 rd" class="r0 r">theSessionId</span>,
            <span class="i">Guid</span> <span id="r1 rd" class="r1 r">theInstanceId</span>,
            <b>string</b> <span id="r2 rd" class="r2 r">theName</span>,
            <b>string</b> <span id="r3 rd" class="r3 r">theComputerName</span>,
            <span class="i">CimSession</span> <span id="r4 rd" class="r4 r">theCimSession</span>,
            <a href="NewCimSessionOptionCommand.cs.html#0e497fefee80122f" class="t t">ProtocolType</a> <span id="r5 rd" class="r5 r">theProtocol</span>)
        {
            <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#85fd2064576ddada" class="i property">SessionId</a> = <span class="r0 r">theSessionId</span>;
            <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#b73d03a35f5b34a0" class="i property">InstanceId</a> = <span class="r1 r">theInstanceId</span>;
            <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#c1b0d0489469103a" class="i property">Name</a> = <span class="r2 r">theName</span>;
            <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#c00077748b964a0f" class="i property">ComputerName</a> = <span class="r3 r">theComputerName</span>;
            <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#e5a5ff13737b89a1" class="i property">CimSession</a> = <span class="r4 r">theCimSession</span>;
            <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#fbcb058741ea4406" class="i field">psObject</a> = <b>null</b>;
            <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#9ff52af03006f062" class="i field">protocol</a> = <span class="r5 r">theProtocol</span>;
        }
 
        <b>internal</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="92f4c6759be42d56" href="R/92f4c6759be42d56.html" target="n" data-glyph="74,1" class="i method">GetPSObject</a>()
        {
            <b>if</b> (<a href="#fbcb058741ea4406" class="i field">psObject</a> == <b>null</b>)
            {
                <a href="#fbcb058741ea4406" class="i field">psObject</a> = <b>new</b> <span class="t">PSObject</span>(<a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#e5a5ff13737b89a1" class="i property">CimSession</a>);
                <a href="#fbcb058741ea4406" class="i field">psObject</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7e69b77e801106e8" class="t t">CimSessionState</a>.<a href="#98bfe5db8cd4c253" class="i field">idPropName</a>, <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#85fd2064576ddada" class="i property">SessionId</a>));
                <a href="#fbcb058741ea4406" class="i field">psObject</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7e69b77e801106e8" class="t t">CimSessionState</a>.<a href="#1765bdaaadb9e344" class="i field">namePropName</a>, <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#c1b0d0489469103a" class="i property">Name</a>));
                <a href="#fbcb058741ea4406" class="i field">psObject</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7e69b77e801106e8" class="t t">CimSessionState</a>.<a href="#8037433fa93ec292" class="i field">instanceidPropName</a>, <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#b73d03a35f5b34a0" class="i property">InstanceId</a>));
                <a href="#fbcb058741ea4406" class="i field">psObject</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7e69b77e801106e8" class="t t">CimSessionState</a>.<a href="#678ec474c66fd880" class="i field">computernamePropName</a>, <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#c00077748b964a0f" class="i property">ComputerName</a>));
                <a href="#fbcb058741ea4406" class="i field">psObject</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#7e69b77e801106e8" class="t t">CimSessionState</a>.<a href="#0334e15e904157b4" class="i field">protocolPropName</a>, <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#1345ea40ea5c90c7" class="i property">Protocol</a>));
            }
            <b>else</b>
            {
                <a href="#fbcb058741ea4406" class="i field">psObject</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#7e69b77e801106e8" class="t t">CimSessionState</a>.<a href="#98bfe5db8cd4c253" class="i field">idPropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a> = <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#85fd2064576ddada" class="i property">SessionId</a>;
                <a href="#fbcb058741ea4406" class="i field">psObject</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#7e69b77e801106e8" class="t t">CimSessionState</a>.<a href="#1765bdaaadb9e344" class="i field">namePropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a> = <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#c1b0d0489469103a" class="i property">Name</a>;
                <a href="#fbcb058741ea4406" class="i field">psObject</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#7e69b77e801106e8" class="t t">CimSessionState</a>.<a href="#8037433fa93ec292" class="i field">instanceidPropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a> = <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#b73d03a35f5b34a0" class="i property">InstanceId</a>;
                <a href="#fbcb058741ea4406" class="i field">psObject</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#7e69b77e801106e8" class="t t">CimSessionState</a>.<a href="#678ec474c66fd880" class="i field">computernamePropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a> = <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#c00077748b964a0f" class="i property">ComputerName</a>;
                <a href="#fbcb058741ea4406" class="i field">psObject</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#7e69b77e801106e8" class="t t">CimSessionState</a>.<a href="#0334e15e904157b4" class="i field">protocolPropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a> = <a href="#78aeb9bf6b3fce4e" class="k">this</a>.<a href="#1345ea40ea5c90c7" class="i property">Protocol</a>;
            }
 
            <b>return</b> <a href="#fbcb058741ea4406" class="i field">psObject</a>;
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CimSessionState
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class used to hold all cimsession related status data related to a runspace.</span>
    <span class="c">///</span><span class="c"> Including the CimSession cache, session counters for generating session name.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="7e69b77e801106e8" href="R/7e69b77e801106e8.html" target="n" data-glyph="2,0" class="t t">CimSessionState</a> : <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default session name.</span>
        <span class="c">///</span><span class="c"> If a name is not passed, then the session is given the name CimSession</span><span class="c">&lt;</span><span class="c">int</span><span class="c">&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> where </span><span class="c">&lt;</span><span class="c">int</span><span class="c">&gt;</span><span class="c"> is the next available session number.</span>
        <span class="c">///</span><span class="c"> For example, CimSession1, CimSession2, etc...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="144da6861cb7a52e" href="R/144da6861cb7a52e.html" target="n" data-glyph="44,1" class="i field">CimSessionClassName</a> = <span class="s">&quot;CimSession&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CimSession object name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="5569272d43e68092" href="R/5569272d43e68092.html" target="n" data-glyph="44,1" class="i field">CimSessionObject</a> = <span class="s">&quot;{CimSession Object}&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CimSession object path, which is identifying a cimsession object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="c5f7a928df084810" href="R/c5f7a928df084810.html" target="n" data-glyph="44,1" class="i field">SessionObjectPath</a> = <span class="s">@&quot;CimSession id = {0}, name = {2}, ComputerName = {3}, instance id = {1}&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Id property name of cimsession wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="98bfe5db8cd4c253" href="R/98bfe5db8cd4c253.html" target="n" data-glyph="44,1" class="i field">idPropName</a> = <span class="s">&quot;Id&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Instanceid property name of cimsession wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="8037433fa93ec292" href="R/8037433fa93ec292.html" target="n" data-glyph="44,1" class="i field">instanceidPropName</a> = <span class="s">&quot;InstanceId&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name property name of cimsession wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="1765bdaaadb9e344" href="R/1765bdaaadb9e344.html" target="n" data-glyph="44,1" class="i field">namePropName</a> = <span class="s">&quot;Name&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computer name property name of cimsession object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="678ec474c66fd880" href="R/678ec474c66fd880.html" target="n" data-glyph="44,1" class="i field">computernamePropName</a> = <span class="s">&quot;ComputerName&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Protocol name property name of cimsession object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="0334e15e904157b4" href="R/0334e15e904157b4.html" target="n" data-glyph="44,1" class="i field">protocolPropName</a> = <span class="s">&quot;Protocol&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Session counter bound to current runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private uint</b> <a id="b6b5d0538f7006de" href="R/b6b5d0538f7006de.html" target="n" data-glyph="46,1" class="i field">sessionNameCounter</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dictionary used to holds all CimSessions in current runspace by session name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">HashSet</span>&lt;<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt;&gt; <a id="848e31e347a5d2be" href="R/848e31e347a5d2be.html" target="n" data-glyph="46,1" class="i field">curCimSessionsByName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dictionary used to holds all CimSessions in current runspace by computer name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">HashSet</span>&lt;<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt;&gt; <a id="ae4660c439b8aa24" href="R/ae4660c439b8aa24.html" target="n" data-glyph="46,1" class="i field">curCimSessionsByComputerName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dictionary used to holds all CimSessions in current runspace by instance ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt; <a id="e491d6be65551f62" href="R/e491d6be65551f62.html" target="n" data-glyph="46,1" class="i field">curCimSessionsByInstanceId</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dictionary used to holds all CimSessions in current runspace by session id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>uint</b>, <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt; <a id="0c2174b96879e56e" href="R/0c2174b96879e56e.html" target="n" data-glyph="46,1" class="i field">curCimSessionsById</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dictionary used to link CimSession object with PSObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">CimSession</span>, <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt; <a id="43750a573f68b2c3" href="R/43750a573f68b2c3.html" target="n" data-glyph="46,1" class="i field">curCimSessionWrapper</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7e69b77e801106e8" class="t t">CimSessionState</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="7db2294be79487c6" href="R/7db2294be79487c6.html" target="n" data-glyph="74,1" class="t constructor">CimSessionState</a>()
        {
            <a href="#b6b5d0538f7006de" class="i field">sessionNameCounter</a> = 1;
            <a href="#848e31e347a5d2be" class="i field">curCimSessionsByName</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">HashSet</span>&lt;<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt;&gt;(
                <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#ae4660c439b8aa24" class="i field">curCimSessionsByComputerName</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">HashSet</span>&lt;<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt;&gt;(
                <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#e491d6be65551f62" class="i field">curCimSessionsByInstanceId</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt;();
            <a href="#0c2174b96879e56e" class="i field">curCimSessionsById</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>uint</b>, <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt;();
            <a href="#43750a573f68b2c3" class="i field">curCimSessionWrapper</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">CimSession</span>, <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt;();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get sessions count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The count of session objects in current runspace.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="512167be8acc561c" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetSessionsCount</a>()
        {
            <b>return</b> <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#0c2174b96879e56e" class="i field">curCimSessionsById</a>.<span class="i">Count</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generates an unique session id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Unique session id under current runspace.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal uint</b> <a id="1bbb8039159cb8eb" href="R/1bbb8039159cb8eb.html" target="n" data-glyph="74,1" class="i method">GenerateSessionId</a>()
        {
            <b>return</b> <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#b6b5d0538f7006de" class="i field">sessionNameCounter</a>++;
        }
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates whether this object was disposed or not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="e37077c4a6947f9f" href="R/e37077c4a6947f9f.html" target="n" data-glyph="46,1" class="i field">_disposed</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose() calls Dispose(true).</span>
        <span class="c">///</span><span class="c"> Implement IDisposable. Do not make this method virtual.</span>
        <span class="c">///</span><span class="c"> A derived class should not be able to override this method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="57ed8c984a0b44cd" href="R/57ed8c984a0b44cd.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#853b685017a8ca74" class="i method">Dispose</a>(<b>true</b>);
            <span class="c">// This object will be cleaned up by the Dispose method.</span>
            <span class="c">// Therefore, you should call GC.SuppressFinalize to</span>
            <span class="c">// take this object off the finalization queue</span>
            <span class="c">// and prevent finalization code for this object</span>
            <span class="c">// from executing a second time.</span>
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#7e69b77e801106e8" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose(bool disposing) executes in two distinct scenarios.</span>
        <span class="c">///</span><span class="c"> If disposing equals true, the method has been called directly</span>
        <span class="c">///</span><span class="c"> or indirectly by a user&#39;s code. Managed and unmanaged resources</span>
        <span class="c">///</span><span class="c"> can be disposed.</span>
        <span class="c">///</span><span class="c"> If disposing equals false, the method has been called by the</span>
        <span class="c">///</span><span class="c"> runtime from inside the finalizer and you should not reference</span>
        <span class="c">///</span><span class="c"> other objects. Only unmanaged resources can be disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Whether it is directly called.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="853b685017a8ca74" href="R/853b685017a8ca74.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r6 rd" class="r6 r">disposing</span>)
        {
            <b>if</b> (!<a href="#7e69b77e801106e8" class="k">this</a>.<a href="#e37077c4a6947f9f" class="i field">_disposed</a>)
            {
                <b>if</b> (<span class="r6 r">disposing</span>)
                {
                    <span class="c">// free managed resources</span>
                    <a href="#f92d0e879009438d" class="i method">Cleanup</a>();
                    <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#e37077c4a6947f9f" class="i field">_disposed</a> = <b>true</b>;
                }
                <span class="c">// free native resources if there are any</span>
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Performs application-defined tasks associated with freeing, releasing, or</span>
        <span class="c">///</span><span class="c"> resetting unmanaged resources.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="f92d0e879009438d" href="R/f92d0e879009438d.html" target="n" data-glyph="72,1" class="i method">Cleanup</a>()
        {
            <b>foreach</b> (<span class="i">CimSession</span> <span id="r7 rd" class="r7 r">session</span> <b>in</b> <a href="#43750a573f68b2c3" class="i field">curCimSessionWrapper</a>.<span class="i">Keys</span>)
            {
                <span class="r7 r">session</span>.<span class="i">Dispose</span>();
            }
 
            <a href="#43750a573f68b2c3" class="i field">curCimSessionWrapper</a>.<span class="i">Clear</span>();
            <a href="#848e31e347a5d2be" class="i field">curCimSessionsByName</a>.<span class="i">Clear</span>();
            <a href="#ae4660c439b8aa24" class="i field">curCimSessionsByComputerName</a>.<span class="i">Clear</span>();
            <a href="#e491d6be65551f62" class="i field">curCimSessionsByInstanceId</a>.<span class="i">Clear</span>();
            <a href="#0c2174b96879e56e" class="i field">curCimSessionsById</a>.<span class="i">Clear</span>();
            <a href="#b6b5d0538f7006de" class="i field">sessionNameCounter</a> = 1;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Add CimSession to/remove CimSession from cache
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add new CimSession object to cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">session</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">sessionId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">instanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">protocol</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="8c681c9e3c9eaac4" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">AddObjectToCache</a>(
            <span class="i">CimSession</span> <span id="r8 rd" class="r8 r">session</span>,
            <b>uint</b> <span id="r9 rd" class="r9 r">sessionId</span>,
            <span class="i">Guid</span> <span id="r10 rd" class="r10 r">instanceId</span>,
            <b>string</b> <span id="r11 rd" class="r11 r">name</span>,
            <b>string</b> <span id="r12 rd" class="r12 r">computerName</span>,
            <a href="NewCimSessionOptionCommand.cs.html#0e497fefee80122f" class="t t">ProtocolType</a> <span id="r13 rd" class="r13 r">protocol</span>)
        {
            <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <span id="r14 rd" class="r14 r">wrapper</span> = <b>new</b>(
                <span class="r9 r">sessionId</span>, <span class="r10 r">instanceId</span>, <span class="r11 r">name</span>, <span class="r12 r">computerName</span>, <span class="r8 r">session</span>, <span class="r13 r">protocol</span>);
 
            <span class="i">HashSet</span>&lt;<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt; <span id="r15 rd" class="r15 r">objects</span>;
            <b>if</b> (!<a href="#7e69b77e801106e8" class="k">this</a>.<a href="#ae4660c439b8aa24" class="i field">curCimSessionsByComputerName</a>.<span class="i">TryGetValue</span>(<span class="r12 r">computerName</span>, <b>out</b> <span class="r15 r">objects</span>))
            {
                <span class="r15 r">objects</span> = <b>new</b> <span class="i">HashSet</span>&lt;<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt;();
                <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#ae4660c439b8aa24" class="i field">curCimSessionsByComputerName</a>.<span class="i">Add</span>(<span class="r12 r">computerName</span>, <span class="r15 r">objects</span>);
            }
 
            <span class="r15 r">objects</span>.<span class="i">Add</span>(<span class="r14 r">wrapper</span>);
 
            <b>if</b> (!<a href="#7e69b77e801106e8" class="k">this</a>.<a href="#848e31e347a5d2be" class="i field">curCimSessionsByName</a>.<span class="i">TryGetValue</span>(<span class="r11 r">name</span>, <b>out</b> <span class="r15 r">objects</span>))
            {
                <span class="r15 r">objects</span> = <b>new</b> <span class="i">HashSet</span>&lt;<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt;();
                <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#848e31e347a5d2be" class="i field">curCimSessionsByName</a>.<span class="i">Add</span>(<span class="r11 r">name</span>, <span class="r15 r">objects</span>);
            }
 
            <span class="r15 r">objects</span>.<span class="i">Add</span>(<span class="r14 r">wrapper</span>);
 
            <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#e491d6be65551f62" class="i field">curCimSessionsByInstanceId</a>.<span class="i">Add</span>(<span class="r10 r">instanceId</span>, <span class="r14 r">wrapper</span>);
            <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#0c2174b96879e56e" class="i field">curCimSessionsById</a>.<span class="i">Add</span>(<span class="r9 r">sessionId</span>, <span class="r14 r">wrapper</span>);
            <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#43750a573f68b2c3" class="i field">curCimSessionWrapper</a>.<span class="i">Add</span>(<span class="r8 r">session</span>, <span class="r14 r">wrapper</span>);
            <b>return</b> <span class="r14 r">wrapper</span>.<a href="#92f4c6759be42d56" class="i method">GetPSObject</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generates remove session message by given wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">psObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="3fb4d4f9b1125a6e" href="R/3fb4d4f9b1125a6e.html" target="n" data-glyph="74,1" class="i method">GetRemoveSessionObjectTarget</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r16 rd" class="r16 r">psObject</span>)
        {
            <b>string</b> <span id="r17 rd" class="r17 r">message</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<span class="r16 r">psObject</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <span class="i">CimSession</span>)
            {
                <b>uint</b> <span id="r18 rd" class="r18 r">id</span> = 0x0;
                <span class="i">Guid</span> <span id="r19 rd" class="r19 r">instanceId</span> = <span class="i">Guid</span>.<span class="i">Empty</span>;
                <b>string</b> <span id="r20 rd" class="r20 r">name</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>string</b> <span id="r21 rd" class="r21 r">computerName</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>if</b> (<span class="r16 r">psObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#98bfe5db8cd4c253" class="i field">idPropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a> <b>is uint</b>)
                {
                    <span class="r18 r">id</span> = <span class="i">Convert</span>.<span class="i">ToUInt32</span>(<span class="r16 r">psObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#98bfe5db8cd4c253" class="i field">idPropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>, <b>null</b>);
                }
 
                <b>if</b> (<span class="r16 r">psObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#8037433fa93ec292" class="i field">instanceidPropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a> <b>is</b> <span class="i">Guid</span>)
                {
                    <span class="r19 r">instanceId</span> = (<span class="i">Guid</span>)<span class="r16 r">psObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#8037433fa93ec292" class="i field">instanceidPropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>;
                }
 
                <b>if</b> (<span class="r16 r">psObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#1765bdaaadb9e344" class="i field">namePropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a> <b>is string</b>)
                {
                    <span class="r20 r">name</span> = (<b>string</b>)<span class="r16 r">psObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#1765bdaaadb9e344" class="i field">namePropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>;
                }
 
                <b>if</b> (<span class="r16 r">psObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#678ec474c66fd880" class="i field">computernamePropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a> <b>is string</b>)
                {
                    <span class="r21 r">computerName</span> = (<b>string</b>)<span class="r16 r">psObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#678ec474c66fd880" class="i field">computernamePropName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>;
                }
 
                <span class="r17 r">message</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <a href="#c5f7a928df084810" class="i field">SessionObjectPath</a>, <span class="r18 r">id</span>, <span class="r19 r">instanceId</span>, <span class="r20 r">name</span>, <span class="r21 r">computerName</span>);
            }
 
            <b>return</b> <span class="r17 r">message</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove given </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object from cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">psObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="ee03d2828f838657" href="R/ee03d2828f838657.html" target="n" data-glyph="74,1" class="i method">RemoveOneSessionObjectFromCache</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r22 rd" class="r22 r">psObject</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <b>if</b> (<span class="r22 r">psObject</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <span class="i">CimSession</span>)
            {
                <a href="#7f80f79dc5bb1b23" class="i method">RemoveOneSessionObjectFromCache</a>(<span class="r22 r">psObject</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as</b> <span class="i">CimSession</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove given </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object from cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">session</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="7f80f79dc5bb1b23" href="R/7f80f79dc5bb1b23.html" target="n" data-glyph="74,1" class="i method">RemoveOneSessionObjectFromCache</a>(<span class="i">CimSession</span> <span id="r23 rd" class="r23 r">session</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <b>if</b> (!<a href="#7e69b77e801106e8" class="k">this</a>.<a href="#43750a573f68b2c3" class="i field">curCimSessionWrapper</a>.<span class="i">ContainsKey</span>(<span class="r23 r">session</span>))
            {
                <b>return</b>;
            }
 
            <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <span id="r24 rd" class="r24 r">wrapper</span> = <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#43750a573f68b2c3" class="i field">curCimSessionWrapper</a>[<span class="r23 r">session</span>];
            <b>string</b> <span id="r25 rd" class="r25 r">name</span> = <span class="r24 r">wrapper</span>.<a href="#c1b0d0489469103a" class="i property">Name</a>;
            <b>string</b> <span id="r26 rd" class="r26 r">computerName</span> = <span class="r24 r">wrapper</span>.<a href="#c00077748b964a0f" class="i property">ComputerName</a>;
 
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<span class="s">&quot;name {0}, computername {1}, id {2}, instanceId {3}&quot;</span>, 1, <span class="r25 r">name</span>, <span class="r26 r">computerName</span>, <span class="r24 r">wrapper</span>.<a href="#85fd2064576ddada" class="i property">SessionId</a>, <span class="r24 r">wrapper</span>.<a href="#b73d03a35f5b34a0" class="i property">InstanceId</a>);
 
            <span class="i">HashSet</span>&lt;<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt; <span id="r27 rd" class="r27 r">objects</span>;
            <b>if</b> (<a href="#7e69b77e801106e8" class="k">this</a>.<a href="#ae4660c439b8aa24" class="i field">curCimSessionsByComputerName</a>.<span class="i">TryGetValue</span>(<span class="r26 r">computerName</span>, <b>out</b> <span class="r27 r">objects</span>))
            {
                <span class="r27 r">objects</span>.<span class="i">Remove</span>(<span class="r24 r">wrapper</span>);
            }
 
            <b>if</b> (<a href="#7e69b77e801106e8" class="k">this</a>.<a href="#848e31e347a5d2be" class="i field">curCimSessionsByName</a>.<span class="i">TryGetValue</span>(<span class="r25 r">name</span>, <b>out</b> <span class="r27 r">objects</span>))
            {
                <span class="r27 r">objects</span>.<span class="i">Remove</span>(<span class="r24 r">wrapper</span>);
            }
 
            <a href="#170bf356b8053370" class="i method">RemoveSessionInternal</a>(<span class="r23 r">session</span>, <span class="r24 r">wrapper</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove given </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object from partial of the cache only.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">session</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">psObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="170bf356b8053370" href="R/170bf356b8053370.html" target="n" data-glyph="76,1" class="i method">RemoveSessionInternal</a>(<span class="i">CimSession</span> <span id="r28 rd" class="r28 r">session</span>, <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <span id="r29 rd" class="r29 r">wrapper</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#e491d6be65551f62" class="i field">curCimSessionsByInstanceId</a>.<span class="i">Remove</span>(<span class="r29 r">wrapper</span>.<a href="#b73d03a35f5b34a0" class="i property">InstanceId</a>);
            <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#0c2174b96879e56e" class="i field">curCimSessionsById</a>.<span class="i">Remove</span>(<span class="r29 r">wrapper</span>.<a href="#85fd2064576ddada" class="i property">SessionId</a>);
            <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#43750a573f68b2c3" class="i field">curCimSessionWrapper</a>.<span class="i">Remove</span>(<span class="r28 r">session</span>);
            <span class="r28 r">session</span>.<span class="i">Dispose</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Query CimSession from cache
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add ErrorRecord to list.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">errRecords</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">propertyName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">propertyValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="80e66ad7ed387a01" href="R/80e66ad7ed387a01.html" target="n" data-glyph="76,1" class="i method">AddErrorRecord</a>(
            <b>ref</b> <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r30 rd" class="r30 r">errRecords</span>,
            <b>string</b> <span id="r31 rd" class="r31 r">propertyName</span>,
            <b>object</b> <span id="r32 rd" class="r32 r">propertyValue</span>)
        {
            <span class="r30 r">errRecords</span>.<span class="i">Add</span>(
                <b>new</b> <span class="t">ErrorRecord</span>(
                    <b>new</b> <span class="i">CimException</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="i">CimCmdletStrings</span>.<span class="i">CouldNotFindCimsessionObject</span>, <span class="r31 r">propertyName</span>, <span class="r32 r">propertyValue</span>)),
                    <b>string</b>.<span class="i">Empty</span>,
                    <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#9a72a7d3051ac7c5" class="i field">ObjectNotFound</a>,
                    <b>null</b>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Query session list by given id array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">ids</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of session wrapper objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="f804d976a9a9deff" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">QuerySession</a>(
            <span class="i">IEnumerable</span>&lt;<b>uint</b>&gt; <span id="r33 rd" class="r33 r">ids</span>,
            <b>out</b> <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r34 rd" class="r34 r">errorRecords</span>)
        {
            <span class="i">HashSet</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r35 rd" class="r35 r">sessions</span> = <b>new</b>();
            <span class="i">HashSet</span>&lt;<b>uint</b>&gt; <span id="r36 rd" class="r36 r">sessionIds</span> = <b>new</b>();
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r37 rd" class="r37 r">errRecords</span> = <b>new</b>();
            <span class="r34 r">errorRecords</span> = <span class="r37 r">errRecords</span>;
            <span class="c">// NOTES: use template function to implement this will save duplicate code</span>
            <b>foreach</b> (<b>uint</b> <span id="r38 rd" class="r38 r">id</span> <b>in</b> <span class="r33 r">ids</span>)
            {
                <b>if</b> (<a href="#7e69b77e801106e8" class="k">this</a>.<a href="#0c2174b96879e56e" class="i field">curCimSessionsById</a>.<span class="i">ContainsKey</span>(<span class="r38 r">id</span>))
                {
                    <b>if</b> (!<span class="r36 r">sessionIds</span>.<span class="i">Contains</span>(<span class="r38 r">id</span>))
                    {
                        <span class="r36 r">sessionIds</span>.<span class="i">Add</span>(<span class="r38 r">id</span>);
                        <span class="r35 r">sessions</span>.<span class="i">Add</span>(<a href="#7e69b77e801106e8" class="k">this</a>.<a href="#0c2174b96879e56e" class="i field">curCimSessionsById</a>[<span class="r38 r">id</span>].<span class="i">GetPSObject</span>());
                    }
                }
                <b>else</b>
                {
                    <a href="#80e66ad7ed387a01" class="i method">AddErrorRecord</a>(<b>ref</b> <span class="r37 r">errRecords</span>, <a href="#98bfe5db8cd4c253" class="i field">idPropName</a>, <span class="r38 r">id</span>);
                }
            }
 
            <b>return</b> <span class="r35 r">sessions</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Query session list by given instance id array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">instanceIds</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of session wrapper objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="d98b1faabded3dc2" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">QuerySession</a>(
            <span class="i">IEnumerable</span>&lt;<span class="i">Guid</span>&gt; <span id="r39 rd" class="r39 r">instanceIds</span>,
            <b>out</b> <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r40 rd" class="r40 r">errorRecords</span>)
        {
            <span class="i">HashSet</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r41 rd" class="r41 r">sessions</span> = <b>new</b>();
            <span class="i">HashSet</span>&lt;<b>uint</b>&gt; <span id="r42 rd" class="r42 r">sessionIds</span> = <b>new</b>();
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r43 rd" class="r43 r">errRecords</span> = <b>new</b>();
            <span class="r40 r">errorRecords</span> = <span class="r43 r">errRecords</span>;
            <b>foreach</b> (<span class="i">Guid</span> <span id="r44 rd" class="r44 r">instanceid</span> <b>in</b> <span class="r39 r">instanceIds</span>)
            {
                <b>if</b> (<a href="#7e69b77e801106e8" class="k">this</a>.<a href="#e491d6be65551f62" class="i field">curCimSessionsByInstanceId</a>.<span class="i">ContainsKey</span>(<span class="r44 r">instanceid</span>))
                {
                    <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <span id="r45 rd" class="r45 r">wrapper</span> = <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#e491d6be65551f62" class="i field">curCimSessionsByInstanceId</a>[<span class="r44 r">instanceid</span>];
                    <b>if</b> (!<span class="r42 r">sessionIds</span>.<span class="i">Contains</span>(<span class="r45 r">wrapper</span>.<a href="#85fd2064576ddada" class="i property">SessionId</a>))
                    {
                        <span class="r42 r">sessionIds</span>.<span class="i">Add</span>(<span class="r45 r">wrapper</span>.<a href="#85fd2064576ddada" class="i property">SessionId</a>);
                        <span class="r41 r">sessions</span>.<span class="i">Add</span>(<span class="r45 r">wrapper</span>.<a href="#92f4c6759be42d56" class="i method">GetPSObject</a>());
                    }
                }
                <b>else</b>
                {
                    <span class="i">AddErrorRecord</span>(<b>ref</b> <span class="r43 r">errRecords</span>, <a href="#8037433fa93ec292" class="i field">instanceidPropName</a>, <span class="r44 r">instanceid</span>);
                }
            }
 
            <b>return</b> <span class="r41 r">sessions</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Query session list by given name array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">nameArray</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of session wrapper objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="00efed0ea10cdfb1" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">QuerySession</a>(<span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r46 rd" class="r46 r">nameArray</span>,
            <b>out</b> <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r47 rd" class="r47 r">errorRecords</span>)
        {
            <span class="i">HashSet</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r48 rd" class="r48 r">sessions</span> = <b>new</b>();
            <span class="i">HashSet</span>&lt;<b>uint</b>&gt; <span id="r49 rd" class="r49 r">sessionIds</span> = <b>new</b>();
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r50 rd" class="r50 r">errRecords</span> = <b>new</b>();
            <span class="r47 r">errorRecords</span> = <span class="r50 r">errRecords</span>;
            <b>foreach</b> (<b>string</b> <span id="r51 rd" class="r51 r">name</span> <b>in</b> <span class="r46 r">nameArray</span>)
            {
                <b>bool</b> <span id="r52 rd" class="r52 r">foundSession</span> = <b>false</b>;
                <a href="/System.Management.Automation/A.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r53 rd" class="r53 r">pattern</span> = <b>new</b>(<span class="r51 r">name</span>, <a href="/System.Management.Automation/A.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="/System.Management.Automation/A.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <span class="i">HashSet</span>&lt;<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt;&gt; <span id="r54 rd" class="r54 r">kvp</span> <b>in</b> <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#848e31e347a5d2be" class="i field">curCimSessionsByName</a>)
                {
                    <b>if</b> (<span class="r53 r">pattern</span>.<span class="i">IsMatch</span>(<span class="r54 r">kvp</span>.<span class="i">Key</span>))
                    {
                        <span class="i">HashSet</span>&lt;<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt; <span id="r55 rd" class="r55 r">wrappers</span> = <span class="r54 r">kvp</span>.<span class="i">Value</span>;
                        <span class="r52 r">foundSession</span> = <span class="r55 r">wrappers</span>.<span class="i">Count</span> &gt; 0;
                        <b>foreach</b> (<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <span id="r56 rd" class="r56 r">wrapper</span> <b>in</b> <span class="r55 r">wrappers</span>)
                        {
                            <b>if</b> (!<span class="r49 r">sessionIds</span>.<span class="i">Contains</span>(<span class="r56 r">wrapper</span>.<a href="#85fd2064576ddada" class="i property">SessionId</a>))
                            {
                                <span class="r49 r">sessionIds</span>.<span class="i">Add</span>(<span class="r56 r">wrapper</span>.<a href="#85fd2064576ddada" class="i property">SessionId</a>);
                                <span class="r48 r">sessions</span>.<span class="i">Add</span>(<span class="r56 r">wrapper</span>.<a href="#92f4c6759be42d56" class="i method">GetPSObject</a>());
                            }
                        }
                    }
                }
 
                <b>if</b> (!<span class="r52 r">foundSession</span> &amp;&amp; !<a href="/System.Management.Automation/A.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">ContainsWildcardCharacters</span>(<span class="r51 r">name</span>))
                {
                    <a href="#80e66ad7ed387a01" class="i method">AddErrorRecord</a>(<b>ref</b> <span class="r50 r">errRecords</span>, <a href="#1765bdaaadb9e344" class="i field">namePropName</a>, <span class="r51 r">name</span>);
                }
            }
 
            <b>return</b> <span class="r48 r">sessions</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Query session list by given computer name array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">computernameArray</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of session wrapper objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="bed031235eb06bd9" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">QuerySessionByComputerName</a>(
            <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r57 rd" class="r57 r">computernameArray</span>,
            <b>out</b> <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r58 rd" class="r58 r">errorRecords</span>)
        {
            <span class="i">HashSet</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r59 rd" class="r59 r">sessions</span> = <b>new</b>();
            <span class="i">HashSet</span>&lt;<b>uint</b>&gt; <span id="r60 rd" class="r60 r">sessionIds</span> = <b>new</b>();
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r61 rd" class="r61 r">errRecords</span> = <b>new</b>();
            <span class="r58 r">errorRecords</span> = <span class="r61 r">errRecords</span>;
            <b>foreach</b> (<b>string</b> <span id="r62 rd" class="r62 r">computername</span> <b>in</b> <span class="r57 r">computernameArray</span>)
            {
                <b>bool</b> <span id="r63 rd" class="r63 r">foundSession</span> = <b>false</b>;
                <b>if</b> (<a href="#7e69b77e801106e8" class="k">this</a>.<a href="#ae4660c439b8aa24" class="i field">curCimSessionsByComputerName</a>.<span class="i">ContainsKey</span>(<span class="r62 r">computername</span>))
                {
                    <span class="i">HashSet</span>&lt;<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a>&gt; <span id="r64 rd" class="r64 r">wrappers</span> = <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#ae4660c439b8aa24" class="i field">curCimSessionsByComputerName</a>[<span class="r62 r">computername</span>];
                    <span class="r63 r">foundSession</span> = <span class="r64 r">wrappers</span>.<span class="i">Count</span> &gt; 0;
                    <b>foreach</b> (<a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <span id="r65 rd" class="r65 r">wrapper</span> <b>in</b> <span class="r64 r">wrappers</span>)
                    {
                        <b>if</b> (!<span class="r60 r">sessionIds</span>.<span class="i">Contains</span>(<span class="r65 r">wrapper</span>.<a href="#85fd2064576ddada" class="i property">SessionId</a>))
                        {
                            <span class="r60 r">sessionIds</span>.<span class="i">Add</span>(<span class="r65 r">wrapper</span>.<a href="#85fd2064576ddada" class="i property">SessionId</a>);
                            <span class="r59 r">sessions</span>.<span class="i">Add</span>(<span class="r65 r">wrapper</span>.<a href="#92f4c6759be42d56" class="i method">GetPSObject</a>());
                        }
                    }
                }
 
                <b>if</b> (!<span class="r63 r">foundSession</span>)
                {
                    <a href="#80e66ad7ed387a01" class="i method">AddErrorRecord</a>(<b>ref</b> <span class="r61 r">errRecords</span>, <a href="#678ec474c66fd880" class="i field">computernamePropName</a>, <span class="r62 r">computername</span>);
                }
            }
 
            <b>return</b> <span class="r59 r">sessions</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Query session list by given session objects array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">cimsessions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">List of session wrapper objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="316120e28cde10c4" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">QuerySession</a>(<span class="i">IEnumerable</span>&lt;<span class="i">CimSession</span>&gt; <span id="r66 rd" class="r66 r">cimsessions</span>,
            <b>out</b> <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r67 rd" class="r67 r">errorRecords</span>)
        {
            <span class="i">HashSet</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r68 rd" class="r68 r">sessions</span> = <b>new</b>();
            <span class="i">HashSet</span>&lt;<b>uint</b>&gt; <span id="r69 rd" class="r69 r">sessionIds</span> = <b>new</b>();
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r70 rd" class="r70 r">errRecords</span> = <b>new</b>();
            <span class="r67 r">errorRecords</span> = <span class="r70 r">errRecords</span>;
            <b>foreach</b> (<span class="i">CimSession</span> <span id="r71 rd" class="r71 r">cimsession</span> <b>in</b> <span class="r66 r">cimsessions</span>)
            {
                <b>if</b> (<a href="#7e69b77e801106e8" class="k">this</a>.<a href="#43750a573f68b2c3" class="i field">curCimSessionWrapper</a>.<span class="i">ContainsKey</span>(<span class="r71 r">cimsession</span>))
                {
                    <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <span id="r72 rd" class="r72 r">wrapper</span> = <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#43750a573f68b2c3" class="i field">curCimSessionWrapper</a>[<span class="r71 r">cimsession</span>];
                    <b>if</b> (!<span class="r69 r">sessionIds</span>.<span class="i">Contains</span>(<span class="r72 r">wrapper</span>.<a href="#85fd2064576ddada" class="i property">SessionId</a>))
                    {
                        <span class="r69 r">sessionIds</span>.<span class="i">Add</span>(<span class="r72 r">wrapper</span>.<a href="#85fd2064576ddada" class="i property">SessionId</a>);
                        <span class="r68 r">sessions</span>.<span class="i">Add</span>(<span class="r72 r">wrapper</span>.<a href="#92f4c6759be42d56" class="i method">GetPSObject</a>());
                    }
                }
                <b>else</b>
                {
                    <a href="#80e66ad7ed387a01" class="i method">AddErrorRecord</a>(<b>ref</b> <span class="r70 r">errRecords</span>, <a href="#144da6861cb7a52e" class="i field">CimSessionClassName</a>, <a href="#5569272d43e68092" class="i field">CimSessionObject</a>);
                }
            }
 
            <b>return</b> <span class="r68 r">sessions</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Query session wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">cimsessions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Session wrapper.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <a id="4801fff6e4eb2ef9" href="R/4801fff6e4eb2ef9.html" target="n" data-glyph="74,1" class="i method">QuerySession</a>(<span class="i">CimSession</span> <span id="r73 rd" class="r73 r">cimsession</span>)
        {
            <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <span id="r74 rd" class="r74 r">wrapper</span>;
            <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#43750a573f68b2c3" class="i field">curCimSessionWrapper</a>.<span class="i">TryGetValue</span>(<span class="r73 r">cimsession</span>, <b>out</b> <span class="r74 r">wrapper</span>);
            <b>return</b> <span class="r74 r">wrapper</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Query session object with given CimSessionInstanceID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">cimSessionInstanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">CimSession object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">CimSession</span> <a id="de17199a0d35fc86" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">QuerySession</a>(<span class="i">Guid</span> <span id="r75 rd" class="r75 r">cimSessionInstanceId</span>)
        {
            <b>if</b> (<a href="#7e69b77e801106e8" class="k">this</a>.<a href="#e491d6be65551f62" class="i field">curCimSessionsByInstanceId</a>.<span class="i">ContainsKey</span>(<span class="r75 r">cimSessionInstanceId</span>))
            {
                <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <span id="r76 rd" class="r76 r">wrapper</span> = <a href="#7e69b77e801106e8" class="k">this</a>.<a href="#e491d6be65551f62" class="i field">curCimSessionsByInstanceId</a>[<span class="r75 r">cimSessionInstanceId</span>];
                <b>return</b> <span class="r76 r">wrapper</span>.<a href="#e5a5ff13737b89a1" class="i property">CimSession</a>;
            }
 
            <b>return</b> <b>null</b>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CimSessionBase
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base class of all session operation classes.</span>
    <span class="c">///</span><span class="c"> All sessions created will be held in a ConcurrentDictionary:cimSessions.</span>
    <span class="c">///</span><span class="c"> It manages the lifecycle of the sessions being created for each</span>
    <span class="c">///</span><span class="c"> runspace according to the state of the runspace.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="a28b5e9a059e47c4" href="R/a28b5e9a059e47c4.html" target="n" data-glyph="2,0" class="t t">CimSessionBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#a28b5e9a059e47c4" class="t t">CimSessionBase</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="8853a57ae2840b44" href="R/8853a57ae2840b44.html" target="n" data-glyph="72,1" class="t constructor">CimSessionBase</a>()
        {
            <a href="#a28b5e9a059e47c4" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a> = <a href="#2218dac73c1f7604" class="i field">cimSessions</a>.<span class="i">GetOrAdd</span>(
                <a href="#35107f6038ab916a" class="i property">CurrentRunspaceId</a>,
                (<span class="i">Guid</span> <span id="r77 rd" class="r77 r">instanceId</span>) =&gt;
                {
                    <b>if</b> (<a href="/System.Management.Automation/A.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="/System.Management.Automation/A.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> != <b>null</b>)
                    {
                        <a href="/System.Management.Automation/A.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="/System.Management.Automation/A.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>.<a href="/System.Management.Automation/A.html#6866e88f64eb13d6" class="i">StateChanged</a> += <span class="i">DefaultRunspace_StateChanged</span>;
                    }
 
                    <b>return</b> <b>new</b> <a href="#7db2294be79487c6" class="t constructor">CimSessionState</a>();
                });
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thread safe static dictionary to store session objects associated</span>
        <span class="c">///</span><span class="c"> with each runspace, which is identified by a GUID. NOTE: cmdlet</span>
        <span class="c">///</span><span class="c"> can running parallelly under more than one runspace(s).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly</b> <span class="i">ConcurrentDictionary</span>&lt;<span class="i">Guid</span>, <a href="#7e69b77e801106e8" class="t t">CimSessionState</a>&gt; <a id="2218dac73c1f7604" href="R/2218dac73c1f7604.html" target="n" data-glyph="44,1" class="i field">cimSessions</a>
            = <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default runspace Id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly</b> <span class="i">Guid</span> <a id="8590c9ebaae9d2a5" href="R/8590c9ebaae9d2a5.html" target="n" data-glyph="44,1" class="i field">defaultRunspaceId</a> = <span class="i">Guid</span>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object used to hold all CimSessions and status data bound</span>
        <span class="c">///</span><span class="c"> to current runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#7e69b77e801106e8" class="t t">CimSessionState</a> <a id="6c8cb3ea400c4e56" href="R/6c8cb3ea400c4e56.html" target="n" data-glyph="44,1" class="i field">sessionState</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get current runspace id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">Guid</span> <a id="35107f6038ab916a" href="R/35107f6038ab916a.html" target="n" data-glyph="106,1" class="i property">CurrentRunspaceId</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="/System.Management.Automation/A.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="/System.Management.Automation/A.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> != <b>null</b>)
                {
                    <b>return</b> <a href="/System.Management.Automation/A.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="/System.Management.Automation/A.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>.<a href="/System.Management.Automation/A.html#af7b715fe8b1bee2" class="i property">InstanceId</a>;
                }
                <b>else</b>
                {
                    <b>return</b> <a href="#a28b5e9a059e47c4" class="t t">CimSessionBase</a>.<a href="#8590c9ebaae9d2a5" class="i field">defaultRunspaceId</a>;
                }
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>public static</b> <a href="#7e69b77e801106e8" class="t t">CimSessionState</a> <a id="e67d9d3f3d497eaa" href="R/e67d9d3f3d497eaa.html" target="n" data-glyph="72,1" class="i method">GetCimSessionState</a>()
        {
            <a href="#7e69b77e801106e8" class="t t">CimSessionState</a> <span id="r78 rd" class="r78 r">state</span> = <b>null</b>;
            <a href="#2218dac73c1f7604" class="i field">cimSessions</a>.<span class="i">TryGetValue</span>(<a href="#35107f6038ab916a" class="i property">CurrentRunspaceId</a>, <b>out</b> <span class="r78 r">state</span>);
            <b>return</b> <span class="r78 r">state</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clean up the dictionaries if the runspace is closed or broken.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r79 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Event args.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="3bc2bbeac27f1308" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">DefaultRunspace_StateChanged</a>(<b>object</b> <span id="r79 rd" class="r79 r">sender</span>, <a href="/System.Management.Automation/A.html#24ce8f9c69bf1c4a" class="t t">RunspaceStateEventArgs</a> <span id="r80 rd" class="r80 r">e</span>)
        {
            <a href="/System.Management.Automation/A.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r81 rd" class="r81 r">runspace</span> = (<a href="/System.Management.Automation/A.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>)<span class="r79 r">sender</span>;
            <b>switch</b> (<span class="r80 r">e</span>.<a href="/System.Management.Automation/A.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="/System.Management.Automation/A.html#41627f067662d11c" class="i property">State</a>)
            {
                <b>case</b> <a href="/System.Management.Automation/A.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="/System.Management.Automation/A.html#e4c76740d99e58bd" class="i field">Broken</a>:
                <b>case</b> <a href="/System.Management.Automation/A.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="/System.Management.Automation/A.html#45de84b67ba18f3f" class="i field">Closed</a>:
                    <a href="#7e69b77e801106e8" class="t t">CimSessionState</a> <span id="r82 rd" class="r82 r">state</span>;
                    <b>if</b> (<a href="#2218dac73c1f7604" class="i field">cimSessions</a>.<span class="i">TryRemove</span>(<span class="r81 r">runspace</span>.<a href="/System.Management.Automation/A.html#af7b715fe8b1bee2" class="i property">InstanceId</a>, <b>out</b> <span class="r82 r">state</span>))
                    {
                        <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#20918462b0cfc2b2" class="i field">runspaceStateChanged</a>, <span class="r81 r">runspace</span>.<a href="/System.Management.Automation/A.html#af7b715fe8b1bee2" class="i property">InstanceId</a>, <span class="r80 r">e</span>.<a href="/System.Management.Automation/A.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="/System.Management.Automation/A.html#41627f067662d11c" class="i property">State</a>));
                        <span class="r82 r">state</span>.<a href="#57ed8c984a0b44cd" class="i method">Dispose</a>();
                    }
 
                    <span class="r81 r">runspace</span>.<a href="/System.Management.Automation/A.html#6866e88f64eb13d6" class="i">StateChanged</a> -= <span class="i">DefaultRunspace_StateChanged</span>;
                    <b>break</b>;
                <b>default</b>:
                    <b>break</b>;
            }
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CimTestConnection
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CimNewSession
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">CimNewSession</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c"> is the class to create cimSession</span>
    <span class="c">///</span><span class="c"> based on given </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">NewCimSessionCommand</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="a2ea99d3dd46ab71" href="R/a2ea99d3dd46ab71.html" target="n" data-glyph="2,0" class="t t">CimNewSession</a> : <a href="#a28b5e9a059e47c4" class="t t">CimSessionBase</a>, <span class="i">IDisposable</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CimTestCimSessionContext.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal class</b> <a id="7a8660d860c73149" href="R/7a8660d860c73149.html" target="n" data-glyph="2,1" class="t t">CimTestCimSessionContext</a> : <a href="CimSessionProxy.cs.html#a3ed284ba44f69ec" class="t t">XOperationContextBase</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7a8660d860c73149" class="t t">CimTestCimSessionContext</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">theProxy</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">wrapper</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>internal</b> <a id="d316b425f1c55b63" href="R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">CimTestCimSessionContext</a>(
                <a href="CimSessionProxy.cs.html#64da31a8ef7908ad" class="t t">CimSessionProxy</a> <span id="r83 rd" class="r83 r">theProxy</span>,
                <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <span id="r84 rd" class="r84 r">wrapper</span>)
            {
                <a href="#7a8660d860c73149" class="k">this</a>.<a href="CimSessionProxy.cs.html#8f5515b7ec2ad686" class="i field">proxy</a> = <span class="r83 r">theProxy</span>;
                <a href="#7a8660d860c73149" class="k">this</a>.<a href="#3cceaf9a13d532f0" class="i property">CimSessionWrapper</a> = <span class="r84 r">wrapper</span>;
                <a href="#7a8660d860c73149" class="k">this</a>.<a href="CimSessionProxy.cs.html#b0981a065a63835f" class="i field">nameSpace</a> = <b>null</b>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">Namespace</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal</b> <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <a id="3cceaf9a13d532f0" href="R/3cceaf9a13d532f0.html" target="n" data-glyph="104,2" class="i property">CimSessionWrapper</a> { <b>get</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#a2ea99d3dd46ab71" class="t t">CimNewSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="b81f5df44afa4b34" href="R/b81f5df44afa4b34.html" target="n" data-glyph="74,1" class="t constructor">CimNewSession</a>() : <a href="#8853a57ae2840b44" class="k">base</a>()
        {
            <a href="#a2ea99d3dd46ab71" class="k">this</a>.<a href="#d806c7e880781dd7" class="i field">cimTestSession</a> = <b>new</b> <a href="#8ad6922c6b020608" class="t constructor">CimTestSession</a>();
            <a href="#a2ea99d3dd46ab71" class="k">this</a>.<a href="#fb110f31f0f8b248" class="i property">Disposed</a> = <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a new </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> base on given cmdlet</span>
        <span class="c">///</span><span class="c"> and its parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r85 r">cmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">sessionOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r87 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="ef07dd3e6b273b27" href="R/ef07dd3e6b273b27.html" target="n" data-glyph="74,1" class="i method">NewCimSession</a>(<a href="NewCimSessionCommand.cs.html#36f4dca5dd6ed8b6" class="t t">NewCimSessionCommand</a> <span id="r85 rd" class="r85 r">cmdlet</span>,
            <span class="i">CimSessionOptions</span> <span id="r86 rd" class="r86 r">sessionOptions</span>,
            <span class="i">CimCredential</span> <span id="r87 rd" class="r87 r">credential</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r88 rd" class="r88 r">computerNames</span> = <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<span class="i">GetComputerNames</span>(<span class="r85 r">cmdlet</span>.<a href="NewCimSessionCommand.cs.html#f6033c60ec21c9c2" class="i property">ComputerName</a>);
            <b>foreach</b> (<b>string</b> <span id="r89 rd" class="r89 r">computerName</span> <b>in</b> <span class="r88 r">computerNames</span>)
            {
                <a href="CimSessionProxy.cs.html#64da31a8ef7908ad" class="t t">CimSessionProxy</a> <span id="r90 rd" class="r90 r">proxy</span>;
                <b>if</b> (<span class="r86 r">sessionOptions</span> == <b>null</b>)
                {
                    <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#4021e88828f2c984" class="i method">WriteLog</a>(<span class="s">&quot;Create CimSessionOption due to NewCimSessionCommand has null sessionoption&quot;</span>, 1);
                    <span class="r86 r">sessionOptions</span> = <a href="CimSessionProxy.cs.html#64da31a8ef7908ad" class="t t">CimSessionProxy</a>.<a href="CimSessionProxy.cs.html#b725b3e51049a785" class="i method">CreateCimSessionOption</a>(<span class="r89 r">computerName</span>,
                        <span class="r85 r">cmdlet</span>.<a href="NewCimSessionCommand.cs.html#a6a650e2a54e6156" class="i property">OperationTimeoutSec</a>, <span class="r87 r">credential</span>);
                }
 
                <span class="r90 r">proxy</span> = <b>new</b> <a href="CimSessionProxy.cs.html#c8bd0dfe0076fc8c" class="t constructor">CimSessionProxyTestConnection</a>(<span class="r89 r">computerName</span>, <span class="r86 r">sessionOptions</span>);
                <b>string</b> <span id="r91 rd" class="r91 r">computerNameValue</span> = (<span class="r89 r">computerName</span> == <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#c7316551c0001b81" class="i field">NullComputerName</a>) ? <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#a6ffd9b06e0ae109" class="i field">LocalhostComputerName</a> : <span class="r89 r">computerName</span>;
                <a href="#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <span id="r92 rd" class="r92 r">wrapper</span> = <b>new</b>(0, <span class="i">Guid</span>.<span class="i">Empty</span>, <span class="r85 r">cmdlet</span>.<a href="NewCimSessionCommand.cs.html#a8276326efd2bdcf" class="i property">Name</a>, <span class="r91 r">computerNameValue</span>, <span class="r90 r">proxy</span>.<a href="CimSessionProxy.cs.html#e539a2e015f265e8" class="i property">CimSession</a>, <span class="r90 r">proxy</span>.<a href="CimSessionProxy.cs.html#56a3d42ced450d15" class="i property">Protocol</a>);
                <a href="#7a8660d860c73149" class="t t">CimTestCimSessionContext</a> <span id="r93 rd" class="r93 r">context</span> = <b>new</b>(<span class="r90 r">proxy</span>, <span class="r92 r">wrapper</span>);
                <span class="r90 r">proxy</span>.<a href="CimSessionProxy.cs.html#b1453253349bbaff" class="i property">ContextObject</a> = <span class="r93 r">context</span>;
                <span class="c">// Skip test the connection if user intend to</span>
                <b>if</b> (<span class="r85 r">cmdlet</span>.<a href="NewCimSessionCommand.cs.html#5d539da283c3de9c" class="i property">SkipTestConnection</a>.<a href="/System.Management.Automation/A.html#e9c777a85700d3da" class="i property">IsPresent</a>)
                {
                    <a href="#13d0b6d686489ee5" class="i method">AddSessionToCache</a>(<span class="r90 r">proxy</span>.<a href="CimSessionProxy.cs.html#e539a2e015f265e8" class="i property">CimSession</a>, <span class="r93 r">context</span>, <b>new</b> <a href="CmdletOperation.cs.html#ae10ed35a9305dda" class="t constructor">CmdletOperationBase</a>(<span class="r85 r">cmdlet</span>));
                }
                <b>else</b>
                {
                    <span class="c">// CimSession will be returned as part of TestConnection</span>
                    <a href="#a2ea99d3dd46ab71" class="k">this</a>.<a href="#d806c7e880781dd7" class="i field">cimTestSession</a>.<a href="#5884846c95357889" class="i method">TestCimSession</a>(<span class="r89 r">computerName</span>, <span class="r90 r">proxy</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add session to global cache,</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">cimSession</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">cmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="13d0b6d686489ee5" href="R/13d0b6d686489ee5.html" target="n" data-glyph="74,1" class="i method">AddSessionToCache</a>(<span class="i">CimSession</span> <span id="r94 rd" class="r94 r">cimSession</span>, <a href="CimSessionProxy.cs.html#a3ed284ba44f69ec" class="t t">XOperationContextBase</a> <span id="r95 rd" class="r95 r">context</span>, <a href="CmdletOperation.cs.html#813733b900a1bded" class="t t">CmdletOperationBase</a> <span id="r96 rd" class="r96 r">cmdlet</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <a href="#7a8660d860c73149" class="t t">CimTestCimSessionContext</a> <span id="r97 rd" class="r97 r">testCimSessionContext</span> = <span class="r95 r">context</span> <b>as</b> <a href="#7a8660d860c73149" class="t t">CimTestCimSessionContext</a>;
            <b>uint</b> <span id="r98 rd" class="r98 r">sessionId</span> = <a href="#a2ea99d3dd46ab71" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<a href="#1bbb8039159cb8eb" class="i method">GenerateSessionId</a>();
            <b>string</b> <span id="r99 rd" class="r99 r">originalSessionName</span> = <span class="r97 r">testCimSessionContext</span>.<a href="#3cceaf9a13d532f0" class="i property">CimSessionWrapper</a>.<a href="#c1b0d0489469103a" class="i property">Name</a>;
            <b>string</b> <span id="r100 rd" class="r100 r">sessionName</span> = <span class="r99 r">originalSessionName</span> ?? <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="s">@&quot;{0}{1}&quot;</span>, <a href="#7e69b77e801106e8" class="t t">CimSessionState</a>.<a href="#144da6861cb7a52e" class="i field">CimSessionClassName</a>, <span class="r98 r">sessionId</span>);
 
            <span class="c">// detach CimSession from the proxy object</span>
            <span class="i">CimSession</span> <span id="r101 rd" class="r101 r">createdCimSession</span> = <span class="r97 r">testCimSessionContext</span>.<a href="CimSessionProxy.cs.html#e9600aa166368a0a" class="i property">Proxy</a>.<a href="CimSessionProxy.cs.html#57ce7ce94615abb2" class="i method">Detach</a>();
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r102 rd" class="r102 r">psObject</span> = <a href="#a2ea99d3dd46ab71" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<span class="i">AddObjectToCache</span>(
                <span class="r101 r">createdCimSession</span>,
                <span class="r98 r">sessionId</span>,
                <span class="r101 r">createdCimSession</span>.<span class="i">InstanceId</span>,
                <span class="r100 r">sessionName</span>,
                <span class="r97 r">testCimSessionContext</span>.<a href="#3cceaf9a13d532f0" class="i property">CimSessionWrapper</a>.<a href="#c00077748b964a0f" class="i property">ComputerName</a>,
                <span class="r97 r">testCimSessionContext</span>.<a href="CimSessionProxy.cs.html#e9600aa166368a0a" class="i property">Proxy</a>.<a href="CimSessionProxy.cs.html#56a3d42ced450d15" class="i property">Protocol</a>);
            <span class="r96 r">cmdlet</span>.<a href="CmdletOperation.cs.html#f156f746863f4678" class="i method">WriteObject</a>(<span class="r102 r">psObject</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process all actions in the action queue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">cmdletOperation</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrapper of cmdlet, </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="CmdletOperation.cs.html#813733b900a1bded" class="t t">CmdletOperationBase</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> for details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="d1560665b82e8dc4" href="R/d1560665b82e8dc4.html" target="n" data-glyph="72,1" class="i method">ProcessActions</a>(<a href="CmdletOperation.cs.html#813733b900a1bded" class="t t">CmdletOperationBase</a> <span id="r103 rd" class="r103 r">cmdletOperation</span>)
        {
            <a href="#a2ea99d3dd46ab71" class="k">this</a>.<a href="#d806c7e880781dd7" class="i field">cimTestSession</a>.<a href="CimAsyncOperation.cs.html#9c5c2ec9bf1978b2" class="i method">ProcessActions</a>(<span class="r103 r">cmdletOperation</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process remaining actions until all operations are completed or</span>
        <span class="c">///</span><span class="c"> current cmdlet is terminated by user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">cmdletOperation</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrapper of cmdlet, </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="CmdletOperation.cs.html#813733b900a1bded" class="t t">CmdletOperationBase</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> for details.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="9375540ce15ddfc6" href="R/9375540ce15ddfc6.html" target="n" data-glyph="72,1" class="i method">ProcessRemainActions</a>(<a href="CmdletOperation.cs.html#813733b900a1bded" class="t t">CmdletOperationBase</a> <span id="r104 rd" class="r104 r">cmdletOperation</span>)
        {
            <a href="#a2ea99d3dd46ab71" class="k">this</a>.<a href="#d806c7e880781dd7" class="i field">cimTestSession</a>.<a href="CimAsyncOperation.cs.html#c5022962e409c649" class="i method">ProcessRemainActions</a>(<span class="r104 r">cmdletOperation</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private members
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#cc8421e3b7fc3c50" class="t t">CimTestSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="#cc8421e3b7fc3c50" class="t t">CimTestSession</a> <a id="d806c7e880781dd7" href="R/d806c7e880781dd7.html" target="n" data-glyph="46,1" class="i field">cimTestSession</a>;
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> <span class="c">// private members</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates whether this object was disposed or not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected bool</b> <a id="fb110f31f0f8b248" href="R/fb110f31f0f8b248.html" target="n" data-glyph="105,1" class="i property">Disposed</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose() calls Dispose(true).</span>
        <span class="c">///</span><span class="c"> Implement IDisposable. Do not make this method virtual.</span>
        <span class="c">///</span><span class="c"> A derived class should not be able to override this method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="988e83a72a6f1026" href="R/988e83a72a6f1026.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#d9665d26cd5ce912" class="i method">Dispose</a>(<b>true</b>);
            <span class="c">// This object will be cleaned up by the Dispose method.</span>
            <span class="c">// Therefore, you should call GC.SuppressFinalize to</span>
            <span class="c">// take this object off the finalization queue</span>
            <span class="c">// and prevent finalization code for this object</span>
            <span class="c">// from executing a second time.</span>
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#a2ea99d3dd46ab71" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose(bool disposing) executes in two distinct scenarios.</span>
        <span class="c">///</span><span class="c"> If disposing equals true, the method has been called directly</span>
        <span class="c">///</span><span class="c"> or indirectly by a user&#39;s code. Managed and unmanaged resources</span>
        <span class="c">///</span><span class="c"> can be disposed.</span>
        <span class="c">///</span><span class="c"> If disposing equals false, the method has been called by the</span>
        <span class="c">///</span><span class="c"> runtime from inside the finalizer and you should not reference</span>
        <span class="c">///</span><span class="c"> other objects. Only unmanaged resources can be disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Whether it is directly called.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="d9665d26cd5ce912" href="R/d9665d26cd5ce912.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r105 rd" class="r105 r">disposing</span>)
        {
            <b>if</b> (!<a href="#a2ea99d3dd46ab71" class="k">this</a>.<a href="#fb110f31f0f8b248" class="i property">Disposed</a>)
            {
                <b>if</b> (<span class="r105 r">disposing</span>)
                {
                    <span class="c">// free managed resources</span>
                    <a href="#a2ea99d3dd46ab71" class="k">this</a>.<a href="#d806c7e880781dd7" class="i field">cimTestSession</a>.<a href="CimAsyncOperation.cs.html#e7e651e1ba619c2e" class="i method">Dispose</a>();
                    <a href="#a2ea99d3dd46ab71" class="k">this</a>.<a href="#fb110f31f0f8b248" class="i property">Disposed</a> = <b>true</b>;
                }
                <span class="c">// free native resources if there are any</span>
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CimGetSession
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Get CimSession based on given id/instanceid/computername/name.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="104e447af18c5903" href="R/104e447af18c5903.html" target="n" data-glyph="2,0" class="t t">CimGetSession</a> : <a href="#a28b5e9a059e47c4" class="t t">CimSessionBase</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#104e447af18c5903" class="t t">CimGetSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="508829fc7750de04" href="R/508829fc7750de04.html" target="n" data-glyph="72,1" class="t constructor">CimGetSession</a>() : <a href="#8853a57ae2840b44" class="k">base</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> objects based on the given cmdlet</span>
        <span class="c">///</span><span class="c"> and its parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">cmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="a7d0ed8ef7fca8ff" href="R/a7d0ed8ef7fca8ff.html" target="n" data-glyph="72,1" class="i method">GetCimSession</a>(<a href="GetCimSessionCommand.cs.html#adc417bf01492585" class="t t">GetCimSessionCommand</a> <span id="r106 rd" class="r106 r">cmdlet</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r107 rd" class="r107 r">sessionToGet</span> = <b>null</b>;
            <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r108 rd" class="r108 r">errorRecords</span> = <b>null</b>;
            <b>switch</b> (<span class="r106 r">cmdlet</span>.<a href="CimCommandBase.cs.html#b346752b85d60599" class="i property">ParameterSetName</a>)
            {
                <b>case</b> <a href="CimCommandBase.cs.html#22cb7e84418c7170" class="t t">CimBaseCommand</a>.<a href="CimCommandBase.cs.html#ced06cf63a284cc2" class="i field">ComputerNameSet</a>:
                    <b>if</b> (<span class="r106 r">cmdlet</span>.<a href="GetCimSessionCommand.cs.html#7f6c36b1dc5a7798" class="i property">ComputerName</a> == <b>null</b>)
                    {
                        <span class="r107 r">sessionToGet</span> = <a href="#104e447af18c5903" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<span class="i">QuerySession</span>(<a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#0b7284d99d30c97b" class="i field">DefaultSessionName</a>, <b>out</b> <span class="r108 r">errorRecords</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r107 r">sessionToGet</span> = <a href="#104e447af18c5903" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<span class="i">QuerySessionByComputerName</span>(<span class="r106 r">cmdlet</span>.<a href="GetCimSessionCommand.cs.html#7f6c36b1dc5a7798" class="i property">ComputerName</a>, <b>out</b> <span class="r108 r">errorRecords</span>);
                    }
 
                    <b>break</b>;
                <b>case</b> <a href="CimCommandBase.cs.html#22cb7e84418c7170" class="t t">CimBaseCommand</a>.<a href="CimCommandBase.cs.html#6b0c09000669cbe2" class="i field">SessionIdSet</a>:
                    <span class="r107 r">sessionToGet</span> = <a href="#104e447af18c5903" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<span class="i">QuerySession</span>(<span class="r106 r">cmdlet</span>.<a href="GetCimSessionCommand.cs.html#331217e74364d635" class="i property">Id</a>, <b>out</b> <span class="r108 r">errorRecords</span>);
                    <b>break</b>;
                <b>case</b> <a href="CimCommandBase.cs.html#22cb7e84418c7170" class="t t">CimBaseCommand</a>.<a href="CimCommandBase.cs.html#b8659ba7ea00bb63" class="i field">InstanceIdSet</a>:
                    <span class="r107 r">sessionToGet</span> = <a href="#104e447af18c5903" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<span class="i">QuerySession</span>(<span class="r106 r">cmdlet</span>.<a href="GetCimSessionCommand.cs.html#d483d04d77d7e49b" class="i property">InstanceId</a>, <b>out</b> <span class="r108 r">errorRecords</span>);
                    <b>break</b>;
                <b>case</b> <a href="CimCommandBase.cs.html#22cb7e84418c7170" class="t t">CimBaseCommand</a>.<a href="CimCommandBase.cs.html#fb1f1e5a5a6f4e49" class="i field">NameSet</a>:
                    <span class="r107 r">sessionToGet</span> = <a href="#104e447af18c5903" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<span class="i">QuerySession</span>(<span class="r106 r">cmdlet</span>.<a href="GetCimSessionCommand.cs.html#ab0317a7221f4892" class="i property">Name</a>, <b>out</b> <span class="r108 r">errorRecords</span>);
                    <b>break</b>;
                <b>default</b>:
                    <b>break</b>;
            }
 
            <b>if</b> (<span class="r107 r">sessionToGet</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r109 rd" class="r109 r">psobject</span> <b>in</b> <span class="r107 r">sessionToGet</span>)
                {
                    <span class="r106 r">cmdlet</span>.<span class="i">WriteObject</span>(<span class="r109 r">psobject</span>);
                }
            }
 
            <b>if</b> (<span class="r108 r">errorRecords</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r110 rd" class="r110 r">errRecord</span> <b>in</b> <span class="r108 r">errorRecords</span>)
                {
                    <span class="r106 r">cmdlet</span>.<span class="i">WriteError</span>(<span class="r110 r">errRecord</span>);
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> helper methods
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CimRemoveSession
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Get CimSession based on given id/instanceid/computername/name.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="d8e38b1b5d963dc1" href="R/d8e38b1b5d963dc1.html" target="n" data-glyph="2,0" class="t t">CimRemoveSession</a> : <a href="#a28b5e9a059e47c4" class="t t">CimSessionBase</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove session action string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="dfae7857480f73cb" href="R/dfae7857480f73cb.html" target="n" data-glyph="44,1" class="i field">RemoveCimSessionActionName</a> = <span class="s">&quot;Remove CimSession&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#d8e38b1b5d963dc1" class="t t">CimRemoveSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="af36ea2eaabe9ca1" href="R/af36ea2eaabe9ca1.html" target="n" data-glyph="72,1" class="t constructor">CimRemoveSession</a>() : <a href="#8853a57ae2840b44" class="k">base</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> objects based on given cmdlet</span>
        <span class="c">///</span><span class="c"> and its parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">cmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="dfa32b690c3f2f8c" href="R/dfa32b690c3f2f8c.html" target="n" data-glyph="72,1" class="i method">RemoveCimSession</a>(<a href="RemoveCimSessionCommand.cs.html#cfe1d70654b097a6" class="t t">RemoveCimSessionCommand</a> <span id="r111 rd" class="r111 r">cmdlet</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r112 rd" class="r112 r">sessionToRemove</span> = <b>null</b>;
            <span class="i">IEnumerable</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r113 rd" class="r113 r">errorRecords</span> = <b>null</b>;
            <b>switch</b> (<span class="r111 r">cmdlet</span>.<a href="CimCommandBase.cs.html#b346752b85d60599" class="i property">ParameterSetName</a>)
            {
                <b>case</b> <a href="CimCommandBase.cs.html#22cb7e84418c7170" class="t t">CimBaseCommand</a>.<a href="CimCommandBase.cs.html#d76bf4a7a4c8e854" class="i field">CimSessionSet</a>:
                    <span class="r112 r">sessionToRemove</span> = <a href="#d8e38b1b5d963dc1" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<span class="i">QuerySession</span>(<span class="r111 r">cmdlet</span>.<a href="RemoveCimSessionCommand.cs.html#91cd0f9076abb1a6" class="i property">CimSession</a>, <b>out</b> <span class="r113 r">errorRecords</span>);
                    <b>break</b>;
                <b>case</b> <a href="CimCommandBase.cs.html#22cb7e84418c7170" class="t t">CimBaseCommand</a>.<a href="CimCommandBase.cs.html#ced06cf63a284cc2" class="i field">ComputerNameSet</a>:
                    <span class="r112 r">sessionToRemove</span> = <a href="#d8e38b1b5d963dc1" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<span class="i">QuerySessionByComputerName</span>(<span class="r111 r">cmdlet</span>.<a href="RemoveCimSessionCommand.cs.html#821939baa75fb825" class="i property">ComputerName</a>, <b>out</b> <span class="r113 r">errorRecords</span>);
                    <b>break</b>;
                <b>case</b> <a href="CimCommandBase.cs.html#22cb7e84418c7170" class="t t">CimBaseCommand</a>.<a href="CimCommandBase.cs.html#6b0c09000669cbe2" class="i field">SessionIdSet</a>:
                    <span class="r112 r">sessionToRemove</span> = <a href="#d8e38b1b5d963dc1" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<span class="i">QuerySession</span>(<span class="r111 r">cmdlet</span>.<a href="RemoveCimSessionCommand.cs.html#97e5667fc1107af9" class="i property">Id</a>, <b>out</b> <span class="r113 r">errorRecords</span>);
                    <b>break</b>;
                <b>case</b> <a href="CimCommandBase.cs.html#22cb7e84418c7170" class="t t">CimBaseCommand</a>.<a href="CimCommandBase.cs.html#b8659ba7ea00bb63" class="i field">InstanceIdSet</a>:
                    <span class="r112 r">sessionToRemove</span> = <a href="#d8e38b1b5d963dc1" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<span class="i">QuerySession</span>(<span class="r111 r">cmdlet</span>.<a href="RemoveCimSessionCommand.cs.html#9c1c1d58afb581b5" class="i property">InstanceId</a>, <b>out</b> <span class="r113 r">errorRecords</span>);
                    <b>break</b>;
                <b>case</b> <a href="CimCommandBase.cs.html#22cb7e84418c7170" class="t t">CimBaseCommand</a>.<a href="CimCommandBase.cs.html#fb1f1e5a5a6f4e49" class="i field">NameSet</a>:
                    <span class="r112 r">sessionToRemove</span> = <a href="#d8e38b1b5d963dc1" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<span class="i">QuerySession</span>(<span class="r111 r">cmdlet</span>.<a href="RemoveCimSessionCommand.cs.html#f65b7b8ca153dd20" class="i property">Name</a>, <b>out</b> <span class="r113 r">errorRecords</span>);
                    <b>break</b>;
                <b>default</b>:
                    <b>break</b>;
            }
 
            <b>if</b> (<span class="r112 r">sessionToRemove</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r114 rd" class="r114 r">psobject</span> <b>in</b> <span class="r112 r">sessionToRemove</span>)
                {
                    <b>if</b> (<span class="r111 r">cmdlet</span>.<span class="i">ShouldProcess</span>(<a href="#d8e38b1b5d963dc1" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<a href="#3fb4d4f9b1125a6e" class="i method">GetRemoveSessionObjectTarget</a>(<span class="r114 r">psobject</span>), <a href="#dfae7857480f73cb" class="i field">RemoveCimSessionActionName</a>))
                    {
                        <a href="#d8e38b1b5d963dc1" class="k">this</a>.<a href="#6c8cb3ea400c4e56" class="i field">sessionState</a>.<a href="#ee03d2828f838657" class="i method">RemoveOneSessionObjectFromCache</a>(<span class="r114 r">psobject</span>);
                    }
                }
            }
 
            <b>if</b> (<span class="r113 r">errorRecords</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r115 rd" class="r115 r">errRecord</span> <b>in</b> <span class="r113 r">errorRecords</span>)
                {
                    <span class="r111 r">cmdlet</span>.<span class="i">WriteError</span>(<span class="r115 r">errRecord</span>);
                }
            }
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CimTestSession
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#cc8421e3b7fc3c50" class="t t">CimTestSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, which is used to</span>
    <span class="c">///</span><span class="c"> test cimsession and execute async operations.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="cc8421e3b7fc3c50" href="R/cc8421e3b7fc3c50.html" target="n" data-glyph="2,0" class="t t">CimTestSession</a> : <a href="CimAsyncOperation.cs.html#c0ecd00f7d90f163" class="t t">CimAsyncOperation</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#cc8421e3b7fc3c50" class="t t">CimTestSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="8ad6922c6b020608" href="R/8ad6922c6b020608.html" target="n" data-glyph="74,1" class="t constructor">CimTestSession</a>()
            : <a href="CimAsyncOperation.cs.html#b6a9bb91f10e5995" class="k">base</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Test the session connection with</span>
        <span class="c">///</span><span class="c"> given </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="CimSessionProxy.cs.html#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r116 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">proxy</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="5884846c95357889" href="R/5884846c95357889.html" target="n" data-glyph="74,1" class="i method">TestCimSession</a>(
            <b>string</b> <span id="r116 rd" class="r116 r">computerName</span>,
            <a href="CimSessionProxy.cs.html#64da31a8ef7908ad" class="t t">CimSessionProxy</a> <span id="r117 rd" class="r117 r">proxy</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
            <a href="#cc8421e3b7fc3c50" class="k">this</a>.<a href="CimAsyncOperation.cs.html#98d303e373785a08" class="i method">SubscribeEventAndAddProxytoCache</a>(<span class="r117 r">proxy</span>);
            <span class="r117 r">proxy</span>.<a href="CimSessionProxy.cs.html#44fe19d02bb6a902" class="i method">TestConnectionAsync</a>();
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
}
</pre></td></tr></table></div></body></html>
