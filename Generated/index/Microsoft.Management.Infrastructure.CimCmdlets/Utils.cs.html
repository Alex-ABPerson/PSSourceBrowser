<!DOCTYPE html>
<html><head><title>Utils.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(449);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Management.Infrastructure.CimCmdlets/Utils.cs" target="_top">Utils.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Management.Infrastructure.CimCmdlets" target="_top">src\Microsoft.Management.Infrastructure.CimCmdlets\Microsoft.Management.Infrastructure.CimCmdlets.csproj</a> (Microsoft.Management.Infrastructure.CimCmdlets)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="c">// #define LOGENABLE // uncomment this line to enable the log,</span>
<span class="c">// create c:\temp\cim.log before invoking cimcmdlets</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">RegularExpressions</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Management</span>.<span class="i n">Infrastructure</span>.<span class="i n">CimCmdlets</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Global Non-localization strings</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="10a63abaaeca162e" href="R/10a63abaaeca162e.html" target="n" data-glyph="2,0" class="t t">ConstValue</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default computername</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b>[] <a id="0b7284d99d30c97b" href="R/0b7284d99d30c97b.html" target="n" data-glyph="44,1" class="i field">DefaultSessionName</a> = { <span class="s">@&quot;*&quot;</span> };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Empty computername, which will create DCOM session</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="c7316551c0001b81" href="R/c7316551c0001b81.html" target="n" data-glyph="44,1" class="i field">NullComputerName</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Empty computername array, which will create DCOM session</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b>[] <a id="6a01ff6cd08bd04d" href="R/6a01ff6cd08bd04d.html" target="n" data-glyph="44,1" class="i field">NullComputerNames</a> = { <a href="#c7316551c0001b81" class="i field">NullComputerName</a> };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> localhost computername, which will create WSMAN session</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="a6ffd9b06e0ae109" href="R/a6ffd9b06e0ae109.html" target="n" data-glyph="44,1" class="i field">LocalhostComputerName</a> = <span class="s">@&quot;localhost&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default namespace</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="86d47963784c9bb3" href="R/86d47963784c9bb3.html" target="n" data-glyph="44,1" class="i field">DefaultNameSpace</a> = <span class="s">@&quot;root\cimv2&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default namespace</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="63bbb3ef2bf6fd99" href="R/63bbb3ef2bf6fd99.html" target="n" data-glyph="44,1" class="i field">DefaultQueryDialect</a> = <span class="s">@&quot;WQL&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the note property that controls if &quot;PSComputerName&quot; column is shown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="4f8866cfaaa03c3b" href="R/4f8866cfaaa03c3b.html" target="n" data-glyph="44,1" class="i field">ShowComputerNameNoteProperty</a> = <span class="s">&quot;PSShowComputerName&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether given computername is either null or empty</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="a3fcb89282d9eaf8" href="R/a3fcb89282d9eaf8.html" target="n" data-glyph="74,1" class="i method">IsDefaultComputerName</a>(<b>string</b> <span id="r0 rd" class="r0 r">computerName</span>)
        {
            <b>return</b> <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r0 r">computerName</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get computer names, if it is null then return DCOM one</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">computerNames</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="b6e190de260b59d2" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetComputerNames</a>(<span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r1 rd" class="r1 r">computerNames</span>)
        {
            <b>return</b> <span class="r1 r">computerNames</span> ?? <a href="#6a01ff6cd08bd04d" class="i field">NullComputerNames</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get computer name, if it is null then return default one.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="6d7d7a82cbdf4091" href="R/6d7d7a82cbdf4091.html" target="n" data-glyph="74,1" class="i method">GetComputerName</a>(<b>string</b> <span id="r2 rd" class="r2 r">computerName</span>)
        {
            <b>return</b> <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r2 r">computerName</span>) ? <a href="#c7316551c0001b81" class="i field">NullComputerName</a> : <span class="r2 r">computerName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get namespace, if it is null then return default one</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">nameSpace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="9a43e9195707fab9" href="R/9a43e9195707fab9.html" target="n" data-glyph="74,1" class="i method">GetNamespace</a>(<b>string</b> <span id="r3 rd" class="r3 r">nameSpace</span>)
        {
            <b>return</b> <span class="r3 r">nameSpace</span> ?? <a href="#86d47963784c9bb3" class="i field">DefaultNameSpace</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get queryDialect, if it is null then return default query Dialect</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">queryDialect</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="48eeced30102460b" href="R/48eeced30102460b.html" target="n" data-glyph="74,1" class="i method">GetQueryDialectWithDefault</a>(<b>string</b> <span id="r4 rd" class="r4 r">queryDialect</span>)
        {
            <b>return</b> <span class="r4 r">queryDialect</span> ?? <a href="#63bbb3ef2bf6fd99" class="i field">DefaultQueryDialect</a>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Debug helper class used to dump debug message to log file</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="6b0644b87482dbb3" href="R/6b0644b87482dbb3.html" target="n" data-glyph="2,0" class="t t">DebugHelper</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Flag used to control generating log message into file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="0c8d437d3d03adb8" href="R/0c8d437d3d03adb8.html" target="n" data-glyph="104,1" class="i property">GenerateLog</a> { <b>get</b>; <b>set</b>; } = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether the log been initialized.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="6149b8bd6914532a" href="R/6149b8bd6914532a.html" target="n" data-glyph="46,1" class="i field">logInitialized</a> = <b>false</b>;
 
        <b>internal static bool</b> <a id="57777678191caba3" href="R/../../0000000000.html" target="n" data-glyph="104,1" class="i property">GenerateVerboseMessage</a> { <b>get</b>; <b>set</b>; } = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Flag used to control generating message into powershell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="4561b30169a070d1" href="R/4561b30169a070d1.html" target="n" data-glyph="44,1" class="i field">logFile</a> = <span class="s">@&quot;c:\temp\Cim.log&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indent space string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b> <a id="e82bfa67d9edc5f9" href="R/e82bfa67d9edc5f9.html" target="n" data-glyph="44,1" class="i field">space</a> = <span class="s">@&quot;    &quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indent space strings array.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b>[] <a id="4c9a4cd1ecee7997" href="R/4c9a4cd1ecee7997.html" target="n" data-glyph="44,1" class="i field">spaces</a> = {
                                              <b>string</b>.<span class="i">Empty</span>,
                                              <a href="#e82bfa67d9edc5f9" class="i field">space</a>,
                                              <a href="#e82bfa67d9edc5f9" class="i field">space</a> + <a href="#e82bfa67d9edc5f9" class="i field">space</a>,
                                              <a href="#e82bfa67d9edc5f9" class="i field">space</a> + <a href="#e82bfa67d9edc5f9" class="i field">space</a> + <a href="#e82bfa67d9edc5f9" class="i field">space</a>,
                                              <a href="#e82bfa67d9edc5f9" class="i field">space</a> + <a href="#e82bfa67d9edc5f9" class="i field">space</a> + <a href="#e82bfa67d9edc5f9" class="i field">space</a> + <a href="#e82bfa67d9edc5f9" class="i field">space</a>,
                                              <a href="#e82bfa67d9edc5f9" class="i field">space</a> + <a href="#e82bfa67d9edc5f9" class="i field">space</a> + <a href="#e82bfa67d9edc5f9" class="i field">space</a> + <a href="#e82bfa67d9edc5f9" class="i field">space</a> + <a href="#e82bfa67d9edc5f9" class="i field">space</a>,
                                          };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Lock the log file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly object</b> <a id="b2444ac54115ec7c" href="R/b2444ac54115ec7c.html" target="n" data-glyph="44,1" class="i field">logLock</a> = <b>new</b>();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> internal strings
        <b>internal static readonly string</b> <a id="20918462b0cfc2b2" href="R/20918462b0cfc2b2.html" target="n" data-glyph="44,1" class="i field">runspaceStateChanged</a> = <span class="s">&quot;Runspace {0} state changed to {1}&quot;</span>;
        <b>internal static readonly string</b> <a id="fcf6aae12fda1c60" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">classDumpInfo</a> = <span class="s">@&quot;Class type is {0}&quot;</span>;
        <b>internal static readonly string</b> <a id="cca475a56b393faf" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">propertyDumpInfo</a> = <span class="s">@&quot;Property name {0} of type {1}, its value is {2}&quot;</span>;
        <b>internal static readonly string</b> <a id="f2acfbcda999cb91" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">defaultPropertyType</a> = <span class="s">@&quot;It is a default property, default value is {0}&quot;</span>;
        <b>internal static readonly string</b> <a id="5b226ea47f69f4b0" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">propertyValueSet</a> = <span class="s">@&quot;This property value is set by user {0}&quot;</span>;
        <b>internal static readonly string</b> <a id="aeddb8cecb6a5525" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">addParameterSetName</a> = <span class="s">@&quot;Add parameter set {0} name to cache&quot;</span>;
        <b>internal static readonly string</b> <a id="737fd79340093f44" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">removeParameterSetName</a> = <span class="s">@&quot;Remove parameter set {0} name from cache&quot;</span>;
        <b>internal static readonly string</b> <a id="84631588b81967b7" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">currentParameterSetNameCount</a> = <span class="s">@&quot;Cache have {0} parameter set names&quot;</span>;
        <b>internal static readonly string</b> <a id="4ce02d6dbec27d29" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">currentParameterSetNameInCache</a> = <span class="s">@&quot;Cache have parameter set {0} valid {1}&quot;</span>;
        <b>internal static readonly string</b> <a id="3aa7b2f63e36fe5d" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">currentnonMandatoryParameterSetInCache</a> = <span class="s">@&quot;Cache have optional parameter set {0} valid {1}&quot;</span>;
        <b>internal static readonly string</b> <a id="963412a923f9e3a4" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">optionalParameterSetNameCount</a> = <span class="s">@&quot;Cache have {0} optional parameter set names&quot;</span>;
        <b>internal static readonly string</b> <a id="22864c062b47bebd" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">finalParameterSetName</a> = <span class="s">@&quot;------Final parameter set name of the cmdlet is {0}&quot;</span>;
        <b>internal static readonly string</b> <a id="8ab7f90a6b822900" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">addToOptionalParameterSet</a> = <span class="s">@&quot;Add to optional ParameterSetNames {0}&quot;</span>;
        <b>internal static readonly string</b> <a id="00d5540f54c11a48" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">startToResolveParameterSet</a> = <span class="s">@&quot;------Resolve ParameterSet Name&quot;</span>;
        <b>internal static readonly string</b> <a id="4826d1cfc927dd34" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">reservedString</a> = <span class="s">@&quot;------&quot;</span>;
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> runtime methods
        <b>internal static string</b> <a id="567dcc7b9d38f2c3" href="R/567dcc7b9d38f2c3.html" target="n" data-glyph="74,1" class="i method">GetSourceCodeInformation</a>(<b>bool</b> <span id="r5 rd" class="r5 r">withFileName</span>, <b>int</b> <span id="r6 rd" class="r6 r">depth</span>)
        {
            <span class="i">StackTrace</span> <span id="r7 rd" class="r7 r">trace</span> = <b>new</b>();
            <span class="i">StackFrame</span> <span id="r8 rd" class="r8 r">frame</span> = <span class="r7 r">trace</span>.<span class="i">GetFrame</span>(<span class="r6 r">depth</span>);
            <span class="c">// if (withFileName)</span>
            <span class="c">// {</span>
            <span class="c">//    return string.Format(CultureInfo.CurrentUICulture, &quot;{0}#{1}:{2}:&quot;, frame.GetFileName()., frame.GetFileLineNumber(), frame.GetMethod().Name);</span>
            <span class="c">// }</span>
            <span class="c">// else</span>
            <span class="c">// {</span>
            <span class="c">//    return string.Format(CultureInfo.CurrentUICulture, &quot;{0}:&quot;, frame.GetMethod());</span>
            <span class="c">// }</span>
 
            <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="s">&quot;{0}::{1}        &quot;</span>,
                <span class="r8 r">frame</span>.<span class="i">GetMethod</span>().<span class="i">DeclaringType</span>.<span class="i">Name</span>,
                <span class="r8 r">frame</span>.<span class="i">GetMethod</span>().<span class="i">Name</span>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write message to log file named @logFile.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="3f92c51cd9afbf2a" href="R/3f92c51cd9afbf2a.html" target="n" data-glyph="74,1" class="i method">WriteLog</a>(<b>string</b> <span id="r9 rd" class="r9 r">message</span>)
        {
            <a href="#4021e88828f2c984" class="i method">WriteLog</a>(<span class="r9 r">message</span>, 0);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write blank line to log file named @logFile.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="89544ba8805b85bb" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteEmptyLine</a>()
        {
            <span class="i">WriteLog</span>(<b>string</b>.<span class="i">Empty</span>, 0);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write message to log file named @logFile with args.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="655521cf1d3bf942" href="R/655521cf1d3bf942.html" target="n" data-glyph="74,1" class="i method">WriteLog</a>(<b>string</b> <span id="r10 rd" class="r10 r">message</span>, <b>int</b> <span id="r11 rd" class="r11 r">indent</span>, <b>params object</b>[] <span id="r12 rd" class="r12 r">args</span>)
        {
            <b>string</b> <span id="r13 rd" class="r13 r">outMessage</span> = <b>string</b>.<span class="i">Empty</span>;
            <a href="#7cbb7037f4fb8c36" class="i method">FormatLogMessage</a>(<b>ref</b> <span class="r13 r">outMessage</span>, <span class="r10 r">message</span>, <span class="r12 r">args</span>);
            <a href="#4021e88828f2c984" class="i method">WriteLog</a>(<span class="r13 r">outMessage</span>, <span class="r11 r">indent</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write message to log file w/o arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">indent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="4021e88828f2c984" href="R/4021e88828f2c984.html" target="n" data-glyph="74,1" class="i method">WriteLog</a>(<b>string</b> <span id="r14 rd" class="r14 r">message</span>, <b>int</b> <span id="r15 rd" class="r15 r">indent</span>)
        {
            <span class="i">WriteLogInternal</span>(<span class="r14 r">message</span>, <span class="r15 r">indent</span>, -1);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write message to log file named @logFile with args.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="41e91352aaa16ae7" href="R/41e91352aaa16ae7.html" target="n" data-glyph="74,1" class="i method">WriteLogEx</a>(<b>string</b> <span id="r16 rd" class="r16 r">message</span>, <b>int</b> <span id="r17 rd" class="r17 r">indent</span>, <b>params object</b>[] <span id="r18 rd" class="r18 r">args</span>)
        {
            <b>string</b> <span id="r19 rd" class="r19 r">outMessage</span> = <b>string</b>.<span class="i">Empty</span>;
            <span class="i">WriteLogInternal</span>(<b>string</b>.<span class="i">Empty</span>, 0, -1);
            <a href="#7cbb7037f4fb8c36" class="i method">FormatLogMessage</a>(<b>ref</b> <span class="r19 r">outMessage</span>, <span class="r16 r">message</span>, <span class="r18 r">args</span>);
            <a href="#7efc0fd4fd59207e" class="i method">WriteLogInternal</a>(<span class="r19 r">outMessage</span>, <span class="r17 r">indent</span>, 3);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write message to log file w/o arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">indent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="b52a9a49322f0296" href="R/b52a9a49322f0296.html" target="n" data-glyph="74,1" class="i method">WriteLogEx</a>(<b>string</b> <span id="r20 rd" class="r20 r">message</span>, <b>int</b> <span id="r21 rd" class="r21 r">indent</span>)
        {
            <span class="i">WriteLogInternal</span>(<b>string</b>.<span class="i">Empty</span>, 0, -1);
            <a href="#7efc0fd4fd59207e" class="i method">WriteLogInternal</a>(<span class="r20 r">message</span>, <span class="r21 r">indent</span>, 3);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write message to log file w/o arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">indent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="651773f290fcb6be" href="R/651773f290fcb6be.html" target="n" data-glyph="74,1" class="i method">WriteLogEx</a>()
        {
            <span class="i">WriteLogInternal</span>(<b>string</b>.<span class="i">Empty</span>, 0, -1);
            <span class="i">WriteLogInternal</span>(<b>string</b>.<span class="i">Empty</span>, 0, 3);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Format the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">Conditional</span>(<span class="s">&quot;LOGENABLE&quot;</span>)]
        <b>private static void</b> <a id="7cbb7037f4fb8c36" href="R/7cbb7037f4fb8c36.html" target="n" data-glyph="76,1" class="i method">FormatLogMessage</a>(<b>ref string</b> <span id="r24 rd" class="r24 r">outMessage</span>, <b>string</b> <span id="r22 rd" class="r22 r">message</span>, <b>params object</b>[] <span id="r23 rd" class="r23 r">args</span>)
        {
            <span class="r24 r">outMessage</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="r22 r">message</span>, <span class="r23 r">args</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write message to log file named @logFile</span>
        <span class="c">///</span><span class="c"> with indent space ahead of the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">nIndent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">Conditional</span>(<span class="s">&quot;LOGENABLE&quot;</span>)]
        <b>private static void</b> <a id="7efc0fd4fd59207e" href="R/7efc0fd4fd59207e.html" target="n" data-glyph="76,1" class="i method">WriteLogInternal</a>(<b>string</b> <span id="r25 rd" class="r25 r">message</span>, <b>int</b> <span id="r26 rd" class="r26 r">indent</span>, <b>int</b> <span id="r27 rd" class="r27 r">depth</span>)
        {
            <b>if</b> (!<a href="#6149b8bd6914532a" class="i field">logInitialized</a>)
            {
                <b>lock</b> (<a href="#b2444ac54115ec7c" class="i field">logLock</a>)
                {
                    <b>if</b> (!<a href="#6149b8bd6914532a" class="i field">logInitialized</a>)
                    {
                        <a href="#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="#0c8d437d3d03adb8" class="i property">GenerateLog</a> = <span class="i">File</span>.<span class="i">Exists</span>(<a href="#4561b30169a070d1" class="i field">logFile</a>);
                        <a href="#6149b8bd6914532a" class="i field">logInitialized</a> = <b>true</b>;
                    }
                }
            }
 
            <b>if</b> (<a href="#0c8d437d3d03adb8" class="i property">GenerateLog</a>)
            {
                <b>if</b> (<span class="r26 r">indent</span> &lt; 0)
                {
                    <span class="r26 r">indent</span> = 0;
                }
 
                <b>if</b> (<span class="r26 r">indent</span> &gt; 5)
                {
                    <span class="r26 r">indent</span> = 5;
                }
 
                <b>string</b> <span id="r28 rd" class="r28 r">sourceInformation</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>if</b> (<span class="r27 r">depth</span> != -1)
                {
                    <span class="r28 r">sourceInformation</span> = <b>string</b>.<span class="i">Format</span>(
                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                        <span class="s">&quot;Thread {0}#{1}:{2}:{3} {4}&quot;</span>,
                        <span class="i">Environment</span>.<span class="i">CurrentManagedThreadId</span>,
                        <span class="i">DateTime</span>.<span class="i">Now</span>.<span class="i">Hour</span>,
                        <span class="i">DateTime</span>.<span class="i">Now</span>.<span class="i">Minute</span>,
                        <span class="i">DateTime</span>.<span class="i">Now</span>.<span class="i">Second</span>,
                        <a href="#567dcc7b9d38f2c3" class="i method">GetSourceCodeInformation</a>(<b>true</b>, <span class="r27 r">depth</span>));
                }
 
                <b>lock</b> (<a href="#b2444ac54115ec7c" class="i field">logLock</a>)
                {
                    <b>using</b> (<span class="i">FileStream</span> <span id="r29 rd" class="r29 r">fs</span> = <b>new</b>(<a href="#4561b30169a070d1" class="i field">logFile</a>, <span class="i">FileMode</span>.<span class="i">OpenOrCreate</span>))
                    <b>using</b> (<span class="i">StreamWriter</span> <span id="r30 rd" class="r30 r">writer</span> = <b>new</b>(<span class="r29 r">fs</span>))
                    {
                        <span class="r30 r">writer</span>.<span class="i">WriteLineAsync</span>(<a href="#4c9a4cd1ecee7997" class="i field">spaces</a>[<span class="r26 r">indent</span>] + <span class="r28 r">sourceInformation</span> + <span class="s">@&quot;        &quot;</span> + <span class="r25 r">message</span>);
                    }
                }
            }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Helper class used to validate given parameter</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="f8c72936d6b64b78" href="R/f8c72936d6b64b78.html" target="n" data-glyph="2,0" class="t t">ValidationHelper</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validate the argument is not null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">argumentName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public static void</b> <a id="caa929c6143e713d" href="R/caa929c6143e713d.html" target="n" data-glyph="72,1" class="i method">ValidateNoNullArgument</a>(<b>object</b> <span id="r31 rd" class="r31 r">obj</span>, <b>string</b> <span id="r32 rd" class="r32 r">argumentName</span>)
        {
            <b>if</b> (<span class="r31 r">obj</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<span class="r32 r">argumentName</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validate the argument is not null and not whitespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">argumentName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public static void</b> <a id="bbdc5304e248c824" href="R/bbdc5304e248c824.html" target="n" data-glyph="72,1" class="i method">ValidateNoNullorWhiteSpaceArgument</a>(<b>string</b> <span id="r33 rd" class="r33 r">obj</span>, <b>string</b> <span id="r34 rd" class="r34 r">argumentName</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r33 r">obj</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="r34 r">argumentName</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validate that given classname/propertyname is a valid name compliance with DMTF standard.</span>
        <span class="c">///</span><span class="c"> Only for verifying ClassName and PropertyName argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Throw if the given value is not a valid name (class name or property name).</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="409081cd52cb29b2" href="R/409081cd52cb29b2.html" target="n" data-glyph="72,1" class="i method">ValidateArgumentIsValidName</a>(<b>string</b> <span id="r35 rd" class="r35 r">parameterName</span>, <b>string</b> <span id="r36 rd" class="r36 r">value</span>)
        {
            <a href="#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="#651773f290fcb6be" class="i method">WriteLogEx</a>();
            <b>if</b> (<span class="r36 r">value</span> != <b>null</b>)
            {
                <b>string</b> <span id="r37 rd" class="r37 r">trimed</span> = <span class="r36 r">value</span>.<span class="i">Trim</span>();
                <span class="c">// The first character should be contained in set: [A-Za-z_]</span>
                <span class="c">// Inner characters should be contained in set: [A-Za-z0-9_]</span>
                <span class="i">Regex</span> <span id="r38 rd" class="r38 r">regex</span> = <b>new</b>(<span class="s">@&quot;^[a-zA-Z_][a-zA-Z0-9_]*\z&quot;</span>);
                <b>if</b> (<span class="r38 r">regex</span>.<span class="i">IsMatch</span>(<span class="r37 r">trimed</span>))
                {
                    <a href="#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;A valid name: {0}={1}&quot;</span>, 0, <span class="r35 r">parameterName</span>, <span class="r36 r">value</span>);
                    <b>return</b> <span class="r37 r">trimed</span>;
                }
            }
 
            <a href="#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;An invalid name: {0}={1}&quot;</span>, 0, <span class="r35 r">parameterName</span>, <span class="r36 r">value</span>);
            <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="i">CimCmdletStrings</span>.<span class="i">InvalidParameterValue</span>, <span class="r36 r">value</span>, <span class="r35 r">parameterName</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validate given arry argument contains all valid name (for -SelectProperties).</span>
        <span class="c">///</span><span class="c"> * is valid for this case.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Throw if the given value contains any invalid name (class name or property name).</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>public static string</b>[] <a id="6569d8a3e3d3d650" href="R/6569d8a3e3d3d650.html" target="n" data-glyph="72,1" class="i method">ValidateArgumentIsValidName</a>(<b>string</b> <span id="r39 rd" class="r39 r">parameterName</span>, <b>string</b>[] <span id="r40 rd" class="r40 r">value</span>)
        {
            <b>if</b> (<span class="r40 r">value</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>string</b> <span id="r41 rd" class="r41 r">propertyName</span> <b>in</b> <span class="r40 r">value</span>)
                {
                    <span class="c">// * is wild char supported in select properties</span>
                    <b>if</b> ((<span class="r41 r">propertyName</span> != <b>null</b>) &amp;&amp; <b>string</b>.<span class="i">Equals</span>(<span class="r41 r">propertyName</span>.<span class="i">Trim</span>(), <span class="s">&quot;*&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>continue</b>;
                    }
 
                    <a href="#f8c72936d6b64b78" class="t t">ValidationHelper</a>.<a href="#409081cd52cb29b2" class="i method">ValidateArgumentIsValidName</a>(<span class="r39 r">parameterName</span>, <span class="r41 r">propertyName</span>);
                }
            }
 
            <b>return</b> <span class="r40 r">value</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
