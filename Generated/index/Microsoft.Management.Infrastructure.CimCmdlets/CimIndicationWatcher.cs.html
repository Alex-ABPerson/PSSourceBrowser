<!DOCTYPE html>
<html><head><title>CimIndicationWatcher.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(386);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Management.Infrastructure.CimCmdlets/CimIndicationWatcher.cs" target="_top">CimIndicationWatcher.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Management.Infrastructure.CimCmdlets" target="_top">src\Microsoft.Management.Infrastructure.CimCmdlets\Microsoft.Management.Infrastructure.CimCmdlets.csproj</a> (Microsoft.Management.Infrastructure.CimCmdlets)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">region</span> Using directives
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
 
<span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Management</span>.<span class="i n">Infrastructure</span>.<span class="i n">CimCmdlets</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Abstract Cimindication event args, which containing all elements related to</span>
    <span class="c">///</span><span class="c"> an Cimindication.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="15fad6a9ebb914fd" href="R/15fad6a9ebb914fd.html" target="n" data-glyph="0,0" class="t t"><span id="8ec46ed8c7142cbb">CimIndicationEventArgs</span></a> : <span class="i">EventArgs</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns an Object value for an operation context</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="115644e7f19043c7" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Context</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#598939c01751f535" class="i field">context</a>;
            }
        }
 
        <b>internal object</b> <a id="598939c01751f535" href="R/598939c01751f535.html" target="n" data-glyph="44,1" class="i field">context</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Cimindication exception event args, which containing occurred exception.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="ed0aff8de216b127" href="R/ed0aff8de216b127.html" target="n" data-glyph="0,0" class="t t">CimIndicationEventExceptionEventArgs</a> : <a href="#15fad6a9ebb914fd" class="t t">CimIndicationEventArgs</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns an exception</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Exception</span> <a id="8c984ae0a3c5a33d" href="R/8c984ae0a3c5a33d.html" target="n" data-glyph="102,1" class="i property">Exception</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#ed0aff8de216b127" class="t t">CimIndicationEventExceptionEventArgs</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="68b29604190935b5" href="R/68b29604190935b5.html" target="n" data-glyph="72,1" class="t constructor">CimIndicationEventExceptionEventArgs</a>(<span class="i">Exception</span> <span id="r0 rd" class="r0 r">theException</span>)
        {
            <a href="#598939c01751f535" class="i field">context</a> = <b>null</b>;
            <a href="#ed0aff8de216b127" class="k">this</a>.<a href="#8c984ae0a3c5a33d" class="i property">Exception</a> = <span class="r0 r">theException</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Cimindication event args, which containing all elements related to</span>
    <span class="c">///</span><span class="c"> an Cimindication.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="b28b775ae6b9af90" href="R/b28b775ae6b9af90.html" target="n" data-glyph="0,0" class="t t">CimIndicationEventInstanceEventArgs</a> : <a href="#15fad6a9ebb914fd" class="t t">CimIndicationEventArgs</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get ciminstance of the indication object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">CimInstance</span> <a id="eb7d7d68e4596a26" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">NewEvent</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#c9bc893f877a564c" class="i field">result</a>?.<span class="i">Instance</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get MachineId of the indication object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="91473dbe30012de6" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">MachineId</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#c9bc893f877a564c" class="i field">result</a>?.<span class="i">MachineId</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get BookMark of the indication object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="75edc118c5a38641" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Bookmark</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#c9bc893f877a564c" class="i field">result</a>?.<span class="i">Bookmark</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b28b775ae6b9af90" class="t t">CimIndicationEventInstanceEventArgs</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="c61318aa993d184f" href="R/c61318aa993d184f.html" target="n" data-glyph="72,1" class="t constructor">CimIndicationEventInstanceEventArgs</a>(<span class="i">CimSubscriptionResult</span> <span id="r1 rd" class="r1 r">result</span>)
        {
            <a href="#598939c01751f535" class="i field">context</a> = <b>null</b>;
            <a href="#b28b775ae6b9af90" class="k">this</a>.<a href="#c9bc893f877a564c" class="i field">result</a> = <span class="r1 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> subscription result</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">CimSubscriptionResult</span> <a id="c9bc893f877a564c" href="R/c9bc893f877a564c.html" target="n" data-glyph="46,1" class="i field">result</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A public class used to start/stop the subscription to specific indication source,</span>
    <span class="c">///</span><span class="c"> and listen to the incoming indications, event </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#a3582aaf988d19ac" class="i">CimIndicationArrived</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> will be raised for each cimindication.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="4f44bed0e65a2c31" href="R/4f44bed0e65a2c31.html" target="n" data-glyph="0,0" class="t t">CimIndicationWatcher</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Status of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#4f44bed0e65a2c31" class="t t">CimIndicationWatcher</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal enum</b> <a id="0cbbdbe3a45ee34b" href="R/0cbbdbe3a45ee34b.html" target="n" data-glyph="20,1" class="t t"><span id="db0321361f1fc77a">Status</span></a>
        {
            <a id="35bc06c6955b60f4" href="R/35bc06c6955b60f4.html" target="n" data-glyph="24,2" class="i field">Default</a>,
            <a id="bfe546c69948b07d" href="R/bfe546c69948b07d.html" target="n" data-glyph="24,2" class="i field">Started</a>,
            <a id="0d26077830bcb433" href="R/0d26077830bcb433.html" target="n" data-glyph="24,2" class="i field">Stopped</a>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CimIndication arrived event</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<a href="#15fad6a9ebb914fd" class="t t">CimIndicationEventArgs</a>&gt; <a id="a3582aaf988d19ac" href="R/a3582aaf988d19ac.html" target="n" data-glyph="30,1" class="i">CimIndicationArrived</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#4f44bed0e65a2c31" class="t t">CimIndicationWatcher</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">nameSpace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">queryExpression</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">operationTimeout</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="c2ff63f01b8d3fa5" href="R/c2ff63f01b8d3fa5.html" target="n" data-glyph="72,1" class="t constructor">CimIndicationWatcher</a>(
            <b>string</b> <span id="r2 rd" class="r2 r">computerName</span>,
            <b>string</b> <span id="r5 rd" class="r5 r">theNamespace</span>,
            <b>string</b> <span id="r6 rd" class="r6 r">queryDialect</span>,
            <b>string</b> <span id="r3 rd" class="r3 r">queryExpression</span>,
            <b>uint</b> <span id="r4 rd" class="r4 r">operationTimeout</span>)
        {
            <a href="Utils.cs.html#f8c72936d6b64b78" class="t t">ValidationHelper</a>.<a href="Utils.cs.html#bbdc5304e248c824" class="i method">ValidateNoNullorWhiteSpaceArgument</a>(<span class="r3 r">queryExpression</span>, <a href="#70b745604608679b" class="i field">queryExpressionParameterName</a>);
            <span class="r2 r">computerName</span> = <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#6d7d7a82cbdf4091" class="i method">GetComputerName</a>(<span class="r2 r">computerName</span>);
            <span class="r5 r">theNamespace</span> = <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#9a43e9195707fab9" class="i method">GetNamespace</a>(<span class="r5 r">theNamespace</span>);
            <a href="#0b27dd0df8c55cd4" class="i method">Initialize</a>(<span class="r2 r">computerName</span>, <b>null</b>, <span class="r5 r">theNamespace</span>, <span class="r6 r">queryDialect</span>, <span class="r3 r">queryExpression</span>, <span class="r4 r">operationTimeout</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#4f44bed0e65a2c31" class="t t">CimIndicationWatcher</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">cimSession</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">nameSpace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">queryExpression</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">operationTimeout</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="8160a1ea1cd453df" href="R/8160a1ea1cd453df.html" target="n" data-glyph="72,1" class="t constructor">CimIndicationWatcher</a>(
            <span class="i">CimSession</span> <span id="r7 rd" class="r7 r">cimSession</span>,
            <b>string</b> <span id="r10 rd" class="r10 r">theNamespace</span>,
            <b>string</b> <span id="r11 rd" class="r11 r">queryDialect</span>,
            <b>string</b> <span id="r8 rd" class="r8 r">queryExpression</span>,
            <b>uint</b> <span id="r9 rd" class="r9 r">operationTimeout</span>)
        {
            <a href="Utils.cs.html#f8c72936d6b64b78" class="t t">ValidationHelper</a>.<a href="Utils.cs.html#bbdc5304e248c824" class="i method">ValidateNoNullorWhiteSpaceArgument</a>(<span class="r8 r">queryExpression</span>, <a href="#70b745604608679b" class="i field">queryExpressionParameterName</a>);
            <a href="Utils.cs.html#f8c72936d6b64b78" class="t t">ValidationHelper</a>.<span class="i">ValidateNoNullArgument</span>(<span class="r7 r">cimSession</span>, <a href="#c14a43ad1a067b09" class="i field">cimSessionParameterName</a>);
            <span class="r10 r">theNamespace</span> = <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#9a43e9195707fab9" class="i method">GetNamespace</a>(<span class="r10 r">theNamespace</span>);
            <a href="#0b27dd0df8c55cd4" class="i method">Initialize</a>(<b>null</b>, <span class="r7 r">cimSession</span>, <span class="r10 r">theNamespace</span>, <span class="r11 r">queryDialect</span>, <span class="r8 r">queryExpression</span>, <span class="r9 r">operationTimeout</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="0b27dd0df8c55cd4" href="R/0b27dd0df8c55cd4.html" target="n" data-glyph="76,1" class="i method">Initialize</a>(
            <b>string</b> <span id="r12 rd" class="r12 r">theComputerName</span>,
            <span class="i">CimSession</span> <span id="r13 rd" class="r13 r">theCimSession</span>,
            <b>string</b> <span id="r14 rd" class="r14 r">theNameSpace</span>,
            <b>string</b> <span id="r15 rd" class="r15 r">theQueryDialect</span>,
            <b>string</b> <span id="r16 rd" class="r16 r">theQueryExpression</span>,
            <b>uint</b> <span id="r17 rd" class="r17 r">theOperationTimeout</span>)
        {
            <a href="#bfa4846b506a6fba" class="i field">enableRaisingEvents</a> = <b>false</b>;
            <a href="#bd49c5b167e35552" class="i field">status</a> = <a href="#0cbbdbe3a45ee34b" class="t t">Status</a>.<a href="#35bc06c6955b60f4" class="i field">Default</a>;
            <a href="#10f06b0eb904b8c9" class="i field">myLock</a> = <b>new</b> <b>object</b>();
            <a href="#c3d1b23697a21e99" class="i field">cimRegisterCimIndication</a> = <b>new</b> <a href="CimRegisterCimIndication.cs.html#49ada76f4f7b395b" class="t constructor">CimRegisterCimIndication</a>();
            <a href="#c3d1b23697a21e99" class="i field">cimRegisterCimIndication</a>.<a href="CimRegisterCimIndication.cs.html#5a90e42b5d6a4db5" class="i">OnNewSubscriptionResult</a> += <span class="i">NewSubscriptionResultHandler</span>;
 
            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#81b2f0f04b50cb71" class="i field">cimSession</a> = <span class="r13 r">theCimSession</span>;
            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#6c299242e10387a4" class="i field">nameSpace</a> = <span class="r14 r">theNameSpace</span>;
            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#60fe9a405a6fbd81" class="i field">queryDialect</a> = <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#48eeced30102460b" class="i method">GetQueryDialectWithDefault</a>(<span class="r15 r">theQueryDialect</span>);
            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#3ad7bfdd42f8ab1d" class="i field">queryExpression</a> = <span class="r16 r">theQueryExpression</span>;
            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#e28cbedc20015838" class="i field">operationTimeout</a> = <span class="r17 r">theOperationTimeout</span>;
            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#0eaa2447cdcd9726" class="i field">computerName</a> = <span class="r12 r">theComputerName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handler of new subscription result</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">src</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="ddd264780d4db003" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NewSubscriptionResultHandler</a>(<b>object</b> <span id="r18 rd" class="r18 r">src</span>, <a href="CimRegisterCimIndication.cs.html#32f9cd59614d5971" class="t t">CimSubscriptionEventArgs</a> <span id="r19 rd" class="r19 r">args</span>)
        {
            <span class="i">EventHandler</span>&lt;<a href="#15fad6a9ebb914fd" class="t t">CimIndicationEventArgs</a>&gt; <span id="r20 rd" class="r20 r">temp</span> = <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#a3582aaf988d19ac" class="i">CimIndicationArrived</a>;
            <b>if</b> (<span class="r20 r">temp</span> != <b>null</b>)
            {
                <span class="c">// raise the event</span>
                <a href="CimRegisterCimIndication.cs.html#1d60ebffc1aef37a" class="t t">CimSubscriptionResultEventArgs</a> <span id="r21 rd" class="r21 r">resultArgs</span> = <span class="r19 r">args</span> <b>as</b> <a href="CimRegisterCimIndication.cs.html#1d60ebffc1aef37a" class="t t">CimSubscriptionResultEventArgs</a>;
                <b>if</b> (<span class="r21 r">resultArgs</span> != <b>null</b>)
                    <span class="r20 r">temp</span>(<a href="#4f44bed0e65a2c31" class="k">this</a>, <b>new</b> <a href="#c61318aa993d184f" class="t constructor">CimIndicationEventInstanceEventArgs</a>(<span class="r21 r">resultArgs</span>.<a href="CimRegisterCimIndication.cs.html#6c485761df7e29aa" class="i property">Result</a>));
                <b>else</b>
                {
                    <a href="CimRegisterCimIndication.cs.html#56a3ad504fdf7941" class="t t">CimSubscriptionExceptionEventArgs</a> <span id="r22 rd" class="r22 r">exceptionArgs</span> = <span class="r19 r">args</span> <b>as</b> <a href="CimRegisterCimIndication.cs.html#56a3ad504fdf7941" class="t t">CimSubscriptionExceptionEventArgs</a>;
                    <b>if</b> (<span class="r22 r">exceptionArgs</span> != <b>null</b>)
                        <span class="r20 r">temp</span>(<a href="#4f44bed0e65a2c31" class="k">this</a>, <b>new</b> <a href="#68b29604190935b5" class="t constructor">CimIndicationEventExceptionEventArgs</a>(<span class="r22 r">exceptionArgs</span>.<a href="CimRegisterCimIndication.cs.html#6719452656aa7607" class="i property">Exception</a>));
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Will be called by admin\monad\src\eengine\EventManager.cs:</span>
        <span class="c">///</span><span class="c"> PSEventManager::ProcessNewSubscriber to start to listen to the Cim Indication.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If set EnableRaisingEvents to false, which will be ignored</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">BrowsableAttribute</span>(<b>false</b>)]
        <b>public bool</b> <a id="c9463253a7fcfaba" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">EnableRaisingEvents</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#bfa4846b506a6fba" class="i field">enableRaisingEvents</a>;
            }
 
            <b>set</b>
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
                <b>if</b> (<b>value</b> &amp;&amp; !<a href="#bfa4846b506a6fba" class="i field">enableRaisingEvents</a>)
                {
                    <a href="#bfa4846b506a6fba" class="i field">enableRaisingEvents</a> = <b>value</b>;
                    <a href="#358ab22978800885" class="i method">Start</a>();
                }
            }
        }
 
        <b>private bool</b> <a id="bfa4846b506a6fba" href="R/bfa4846b506a6fba.html" target="n" data-glyph="46,1" class="i field">enableRaisingEvents</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Start the subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="358ab22978800885" href="R/358ab22978800885.html" target="n" data-glyph="72,1" class="i method">Start</a>()
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <b>lock</b> (<a href="#10f06b0eb904b8c9" class="i field">myLock</a>)
            {
                <b>if</b> (<a href="#bd49c5b167e35552" class="i field">status</a> == <a href="#0cbbdbe3a45ee34b" class="t t">Status</a>.<a href="#35bc06c6955b60f4" class="i field">Default</a>)
                {
                    <b>if</b> (<a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#81b2f0f04b50cb71" class="i field">cimSession</a> == <b>null</b>)
                    {
                        <a href="#c3d1b23697a21e99" class="i field">cimRegisterCimIndication</a>.<a href="CimRegisterCimIndication.cs.html#7acf93bfe995dc1a" class="i method">RegisterCimIndication</a>(
                            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#0eaa2447cdcd9726" class="i field">computerName</a>,
                            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#6c299242e10387a4" class="i field">nameSpace</a>,
                            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#60fe9a405a6fbd81" class="i field">queryDialect</a>,
                            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#3ad7bfdd42f8ab1d" class="i field">queryExpression</a>,
                            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#e28cbedc20015838" class="i field">operationTimeout</a>);
                    }
                    <b>else</b>
                    {
                        <a href="#c3d1b23697a21e99" class="i field">cimRegisterCimIndication</a>.<a href="CimRegisterCimIndication.cs.html#6c9751a877b256c5" class="i method">RegisterCimIndication</a>(
                            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#81b2f0f04b50cb71" class="i field">cimSession</a>,
                            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#6c299242e10387a4" class="i field">nameSpace</a>,
                            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#60fe9a405a6fbd81" class="i field">queryDialect</a>,
                            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#3ad7bfdd42f8ab1d" class="i field">queryExpression</a>,
                            <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#e28cbedc20015838" class="i field">operationTimeout</a>);
                    }
 
                    <a href="#bd49c5b167e35552" class="i field">status</a> = <a href="#0cbbdbe3a45ee34b" class="t t">Status</a>.<a href="#bfe546c69948b07d" class="i field">Started</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unsubscribe the subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="529bc5e70b6481c5" href="R/529bc5e70b6481c5.html" target="n" data-glyph="72,1" class="i method">Stop</a>()
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;Status = {0}&quot;</span>, 0, <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#bd49c5b167e35552" class="i field">status</a>);
 
            <b>lock</b> (<a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#10f06b0eb904b8c9" class="i field">myLock</a>)
            {
                <b>if</b> (<a href="#bd49c5b167e35552" class="i field">status</a> == <a href="#0cbbdbe3a45ee34b" class="t t">Status</a>.<a href="#bfe546c69948b07d" class="i field">Started</a>)
                {
                    <b>if</b> (<a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#c3d1b23697a21e99" class="i field">cimRegisterCimIndication</a> != <b>null</b>)
                    {
                        <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#4021e88828f2c984" class="i method">WriteLog</a>(<span class="s">&quot;Dispose CimRegisterCimIndication object&quot;</span>, 4);
                        <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#c3d1b23697a21e99" class="i field">cimRegisterCimIndication</a>.<a href="CimAsyncOperation.cs.html#e7e651e1ba619c2e" class="i method">Dispose</a>();
                    }
 
                    <a href="#bd49c5b167e35552" class="i field">status</a> = <a href="#0cbbdbe3a45ee34b" class="t t">Status</a>.<a href="#0d26077830bcb433" class="i field">Stopped</a>;
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> internal method
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set the cmdlet object to throw ThrowTerminatingError</span>
        <span class="c">///</span><span class="c"> in case there is a subscription failure.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">cmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="3abdb5cb1c519095" href="R/3abdb5cb1c519095.html" target="n" data-glyph="74,1" class="i method">SetCmdlet</a>(<a href="/System.Management.Automation/A.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r23 rd" class="r23 r">cmdlet</span>)
        {
            <b>if</b> (<a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#c3d1b23697a21e99" class="i field">cimRegisterCimIndication</a> != <b>null</b>)
            {
                <a href="#4f44bed0e65a2c31" class="k">this</a>.<a href="#c3d1b23697a21e99" class="i field">cimRegisterCimIndication</a>.<a href="CimRegisterCimIndication.cs.html#a3110d2fbcb4d06c" class="i property">Cmdlet</a> = <span class="r23 r">cmdlet</span>;
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private members
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CimRegisterCimIndication object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="CimRegisterCimIndication.cs.html#390ec0ac9cdd39c7" class="t t">CimRegisterCimIndication</a> <a id="c3d1b23697a21e99" href="R/c3d1b23697a21e99.html" target="n" data-glyph="46,1" class="i field">cimRegisterCimIndication</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The status of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#4f44bed0e65a2c31" class="t t">CimIndicationWatcher</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#0cbbdbe3a45ee34b" class="t t">Status</a> <a id="bd49c5b167e35552" href="R/bd49c5b167e35552.html" target="n" data-glyph="46,1" class="i field">status</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Lock started field.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private object</b> <a id="10f06b0eb904b8c9" href="R/10f06b0eb904b8c9.html" target="n" data-glyph="46,1" class="i field">myLock</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CimSession parameter name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="c14a43ad1a067b09" href="R/c14a43ad1a067b09.html" target="n" data-glyph="10,1" class="i field">cimSessionParameterName</a> = <span class="s">&quot;cimSession&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> QueryExpression parameter name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="70b745604608679b" href="R/70b745604608679b.html" target="n" data-glyph="10,1" class="i field">queryExpressionParameterName</a> = <span class="s">&quot;queryExpression&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> parameters
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> parameters used to start the subscription</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="0eaa2447cdcd9726" href="R/0eaa2447cdcd9726.html" target="n" data-glyph="46,1" class="i field">computerName</a>;
        <b>private</b> <span class="i">CimSession</span> <a id="81b2f0f04b50cb71" href="R/81b2f0f04b50cb71.html" target="n" data-glyph="46,1" class="i field">cimSession</a>;
        <b>private string</b> <a id="6c299242e10387a4" href="R/6c299242e10387a4.html" target="n" data-glyph="46,1" class="i field">nameSpace</a>;
        <b>private string</b> <a id="60fe9a405a6fbd81" href="R/60fe9a405a6fbd81.html" target="n" data-glyph="46,1" class="i field">queryDialect</a>;
        <b>private string</b> <a id="3ad7bfdd42f8ab1d" href="R/3ad7bfdd42f8ab1d.html" target="n" data-glyph="46,1" class="i field">queryExpression</a>;
        <b>private uint</b> <a id="e28cbedc20015838" href="R/e28cbedc20015838.html" target="n" data-glyph="46,1" class="i field">operationTimeout</a>;
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
