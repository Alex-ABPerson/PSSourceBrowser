<!DOCTYPE html>
<html><head><title>CimSessionProxy.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(2294);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Management.Infrastructure.CimCmdlets/CimSessionProxy.cs" target="_top">CimSessionProxy.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Management.Infrastructure.CimCmdlets" target="_top">src\Microsoft.Management.Infrastructure.CimCmdlets\Microsoft.Management.Infrastructure.CimCmdlets.csproj</a> (Microsoft.Management.Infrastructure.CimCmdlets)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">region</span> Using directives
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Management</span>.<span class="i n">Infrastructure</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Management</span>.<span class="i n">Infrastructure</span>.<span class="i">Options</span>;
 
<span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Management</span>.<span class="i n">Infrastructure</span>.<span class="i n">CimCmdlets</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Context base class
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Context base class for cross operations</span>
    <span class="c">///</span><span class="c"> for example, some cmdlets need to query instance first and then</span>
    <span class="c">///</span><span class="c"> remove instance, those scenarios need context object transferred</span>
    <span class="c">///</span><span class="c"> from one operation to another.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal abstract class</b> <a id="a3ed284ba44f69ec" href="R/a3ed284ba44f69ec.html" target="n" data-glyph="2,0" class="t t"><span id="d94286b4227abb93">XOperationContextBase</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">namespace</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="64ad167b7a11070f" href="R/64ad167b7a11070f.html" target="n" data-glyph="104,1" class="i property">Namespace</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a3ed284ba44f69ec" class="k">this</a>.<a href="#b0981a065a63835f" class="i field">nameSpace</a>;
            }
        }
 
        <b>protected string</b> <a id="b0981a065a63835f" href="R/b0981a065a63835f.html" target="n" data-glyph="45,1" class="i field">nameSpace</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Session proxy.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a> <a id="e9600aa166368a0a" href="R/e9600aa166368a0a.html" target="n" data-glyph="104,1" class="i property">Proxy</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a3ed284ba44f69ec" class="k">this</a>.<a href="#8f5515b7ec2ad686" class="i field">proxy</a>;
            }
        }
 
        <b>protected</b> <a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a> <a id="8f5515b7ec2ad686" href="R/8f5515b7ec2ad686.html" target="n" data-glyph="45,1" class="i field">proxy</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class provides all information regarding the</span>
    <span class="c">///</span><span class="c"> current invocation to the .NET API.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="32d328f526694471" href="R/32d328f526694471.html" target="n" data-glyph="2,0" class="t t">InvocationContext</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#32d328f526694471" class="t t">InvocationContext</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">proxy</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="8fdb5511b849b58c" href="R/8fdb5511b849b58c.html" target="n" data-glyph="74,1" class="t constructor">InvocationContext</a>(<a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a> <span id="r0 rd" class="r0 r">proxy</span>)
        {
            <b>if</b> (<span class="r0 r">proxy</span> != <b>null</b>)
            {
                <a href="#32d328f526694471" class="k">this</a>.<a href="#445f0b7741f7d182" class="i property">ComputerName</a> = <span class="r0 r">proxy</span>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">ComputerName</span>;
                <a href="#32d328f526694471" class="k">this</a>.<a href="#c586910e947bba7a" class="i property">TargetCimInstance</a> = <span class="r0 r">proxy</span>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#32d328f526694471" class="t t">InvocationContext</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">proxy</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="1471b9a573777a2d" href="R/1471b9a573777a2d.html" target="n" data-glyph="74,1" class="t constructor">InvocationContext</a>(<b>string</b> <span id="r1 rd" class="r1 r">computerName</span>, <span class="i">CimInstance</span> <span id="r2 rd" class="r2 r">targetCimInstance</span>)
        {
            <a href="#32d328f526694471" class="k">this</a>.<a href="#445f0b7741f7d182" class="i property">ComputerName</a> = <span class="r1 r">computerName</span>;
            <a href="#32d328f526694471" class="k">this</a>.<a href="#c586910e947bba7a" class="i property">TargetCimInstance</a> = <span class="r2 r">targetCimInstance</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ComputerName of the session</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> return value could be null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal virtual string</b> <a id="445f0b7741f7d182" href="R/445f0b7741f7d182.html" target="n" data-glyph="104,1" class="i property">ComputerName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CimInstance on which the current operation against.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> return value could be null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal virtual</b> <span class="i">CimInstance</span> <a id="c586910e947bba7a" href="R/c586910e947bba7a.html" target="n" data-glyph="104,1" class="i property">TargetCimInstance</a> { <b>get</b>; }
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Preprocessing of result object interface
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines a method to preprocessing an result object before sending to</span>
    <span class="c">///</span><span class="c"> output pipeline.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">ComVisible</span>(<b>false</b>)]
    <b>internal interface</b> <a id="ed7e09bec2263c9a" href="R/ed7e09bec2263c9a.html" target="n" data-glyph="50,0" class="t t">IObjectPreProcess</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Performs pre processing of given result object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">resultObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Pre-processed object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>object</b> <a id="06815c069d8c939d" href="R/06815c069d8c939d.html" target="n" data-glyph="72,1" class="i method">Process</a>(<b>object</b> <span id="r3 rd" class="r3 r">resultObject</span>);
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Eventargs class
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> CmdletActionEventArgs holds a CimBaseAction object</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="f9a63e977fe06b4e" href="R/f9a63e977fe06b4e.html" target="n" data-glyph="2,0" class="t t">CmdletActionEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#f9a63e977fe06b4e" class="t t">CmdletActionEventArgs</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">CimBaseAction object bound to the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="c22ae10b28933993" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">CmdletActionEventArgs</a>(<a href="CimBaseAction.cs.html#0953d185c863ca27" class="t t">CimBaseAction</a> <span id="r4 rd" class="r4 r">action</span>)
        {
            <a href="#f9a63e977fe06b4e" class="k">this</a>.<a href="#36809e757e44acff" class="i field">Action</a> = <span class="r4 r">action</span>;
        }
 
        <b>public readonly</b> <a href="CimBaseAction.cs.html#0953d185c863ca27" class="t t">CimBaseAction</a> <a id="36809e757e44acff" href="R/36809e757e44acff.html" target="n" data-glyph="42,1" class="i field">Action</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> OperationEventArgs holds a cancellation object, and an operation.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="57e1a1cbcfd66ad9" href="R/57e1a1cbcfd66ad9.html" target="n" data-glyph="2,0" class="t t">OperationEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#57e1a1cbcfd66ad9" class="t t">OperationEventArgs</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">operationCancellation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object used to cancel the operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">operation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Async observable operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="8820809133f03d0f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">OperationEventArgs</a>(<span class="i">IDisposable</span> <span id="r5 rd" class="r5 r">operationCancellation</span>,
            <span class="i">IObservable</span>&lt;<b>object</b>&gt; <span id="r6 rd" class="r6 r">operation</span>,
            <b>bool</b> <span id="r7 rd" class="r7 r">theSuccess</span>)
        {
            <a href="#57e1a1cbcfd66ad9" class="k">this</a>.<a href="#b41920420cf572ab" class="i field">operationCancellation</a> = <span class="r5 r">operationCancellation</span>;
            <a href="#57e1a1cbcfd66ad9" class="k">this</a>.<a href="#b8b80152306cf716" class="i field">operation</a> = <span class="r6 r">operation</span>;
            <a href="#57e1a1cbcfd66ad9" class="k">this</a>.<a href="#32f67cf0521cf92e" class="i field">success</a> = <span class="r7 r">theSuccess</span>;
        }
 
        <b>public readonly</b> <span class="i">IDisposable</span> <a id="b41920420cf572ab" href="R/b41920420cf572ab.html" target="n" data-glyph="42,1" class="i field">operationCancellation</a>;
        <b>public readonly</b> <span class="i">IObservable</span>&lt;<b>object</b>&gt; <a id="b8b80152306cf716" href="R/b8b80152306cf716.html" target="n" data-glyph="42,1" class="i field">operation</a>;
        <b>public readonly bool</b> <a id="32f67cf0521cf92e" href="R/32f67cf0521cf92e.html" target="n" data-glyph="42,1" class="i field">success</a>;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Wrapper of </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e539a2e015f265e8" class="i property">CimSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object.</span>
    <span class="c">///</span><span class="c"> A CimSessionProxy object can only execute one operation at specific moment.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="64da31a8ef7908ad" href="R/64da31a8ef7908ad.html" target="n" data-glyph="2,0" class="t t">CimSessionProxy</a> : <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> static members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> global operation counter</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static long</b> <a id="e91fe5a70a578ba6" href="R/e91fe5a70a578ba6.html" target="n" data-glyph="46,1" class="i field">gOperationCounter</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Temporary CimSession cache lock.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly object</b> <a id="2ac53c43f11972ee" href="R/2ac53c43f11972ee.html" target="n" data-glyph="46,1" class="i field">temporarySessionCacheLock</a> = <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">temporary CimSession cache</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">Temporary CimSession means the session is created by cimcmdlets,</span>
        <span class="c">///</span><span class="c"> which is not created by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">New</span>-<span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> cmdlet.</span>
        <span class="c">///</span><span class="c"> Due to some cmdlet, such as </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">Remove</span>-<span class="i">CimInstance</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> might need to split the operation into multiple stages, i.e., query</span>
        <span class="c">///</span><span class="c"> CimInstance firstly, then remove the CimInstance resulted from query,</span>
        <span class="c">///</span><span class="c"> such that the temporary CimSession need to be shared between</span>
        <span class="c">///</span><span class="c"> multiple </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> objects, introducing a</span>
        <span class="c">///</span><span class="c"> temporary session cache is necessary to control the lifetime of the</span>
        <span class="c">///</span><span class="c"> temporary CimSession objects.</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Once the reference count of the CimSession is decreased to 0,</span>
        <span class="c">///</span><span class="c"> then call Dispose on it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">CimSession</span>, <b>uint</b>&gt; <a id="1d65cd254b951014" href="R/1d65cd254b951014.html" target="n" data-glyph="46,1" class="i field">temporarySessionCache</a> = <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e539a2e015f265e8" class="i property">CimSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> to temporary cache.</span>
        <span class="c">///</span><span class="c"> If CimSession already present in cache, then increase the refcount by 1,</span>
        <span class="c">///</span><span class="c"> otherwise insert it into the cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">session</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">CimSession to be added.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="ad75d4d49480298b" href="R/ad75d4d49480298b.html" target="n" data-glyph="74,1" class="i method">AddCimSessionToTemporaryCache</a>(<span class="i">CimSession</span> <span id="r8 rd" class="r8 r">session</span>)
        {
            <b>if</b> (<span class="r8 r">session</span> != <b>null</b>)
            {
                <b>lock</b> (<a href="#2ac53c43f11972ee" class="i field">temporarySessionCacheLock</a>)
                {
                    <b>if</b> (<a href="#1d65cd254b951014" class="i field">temporarySessionCache</a>.<span class="i">ContainsKey</span>(<span class="r8 r">session</span>))
                    {
                        <a href="#1d65cd254b951014" class="i field">temporarySessionCache</a>[<span class="r8 r">session</span>]++;
                        <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">@&quot;Increase cimsession ref count {0}&quot;</span>, 1, <a href="#1d65cd254b951014" class="i field">temporarySessionCache</a>[<span class="r8 r">session</span>]);
                    }
                    <b>else</b>
                    {
                        <a href="#1d65cd254b951014" class="i field">temporarySessionCache</a>.<span class="i">Add</span>(<span class="r8 r">session</span>, 1);
                        <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">@&quot;Add cimsession to cache. Ref count {0}&quot;</span>, 1, <a href="#1d65cd254b951014" class="i field">temporarySessionCache</a>[<span class="r8 r">session</span>]);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span><span class="c">Wrapper function to remove CimSession from cache</span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">session</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">dispose</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Whether need to dispose the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e539a2e015f265e8" class="i property">CimSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="6979af06846a593f" href="R/6979af06846a593f.html" target="n" data-glyph="76,1" class="i method">RemoveCimSessionFromTemporaryCache</a>(<span class="i">CimSession</span> <span id="r9 rd" class="r9 r">session</span>,
            <b>bool</b> <span id="r10 rd" class="r10 r">dispose</span>)
        {
            <b>if</b> (<span class="r9 r">session</span> != <b>null</b>)
            {
                <b>bool</b> <span id="r11 rd" class="r11 r">removed</span> = <b>false</b>;
                <b>lock</b> (<a href="#2ac53c43f11972ee" class="i field">temporarySessionCacheLock</a>)
                {
                    <b>if</b> (<a href="#1d65cd254b951014" class="i field">temporarySessionCache</a>.<span class="i">ContainsKey</span>(<span class="r9 r">session</span>))
                    {
                        <a href="#1d65cd254b951014" class="i field">temporarySessionCache</a>[<span class="r9 r">session</span>]--;
                        <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">@&quot;Decrease cimsession ref count {0}&quot;</span>, 1, <a href="#1d65cd254b951014" class="i field">temporarySessionCache</a>[<span class="r9 r">session</span>]);
                        <b>if</b> (<a href="#1d65cd254b951014" class="i field">temporarySessionCache</a>[<span class="r9 r">session</span>] == 0)
                        {
                            <span class="r11 r">removed</span> = <b>true</b>;
                            <a href="#1d65cd254b951014" class="i field">temporarySessionCache</a>.<span class="i">Remove</span>(<span class="r9 r">session</span>);
                        }
                    }
                }
                <span class="c">// there is a race condition that if</span>
                <span class="c">// one thread is waiting to add CimSession to cache,</span>
                <span class="c">// while current thread is removing the CimSession,</span>
                <span class="c">// then invalid CimSession may be added to cache.</span>
                <span class="c">// Ignored this scenario in CimCmdlet implementation,</span>
                <span class="c">// since the code inside cimcmdlet will not hit this</span>
                <span class="c">// scenario anyway.</span>
                <b>if</b> (<span class="r11 r">removed</span> &amp;&amp; <span class="r10 r">dispose</span>)
                {
                    <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#b52a9a49322f0296" class="i method">WriteLogEx</a>(<span class="s">@&quot;Dispose cimsession &quot;</span>, 1);
                    <span class="r9 r">session</span>.<span class="i">Dispose</span>();
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e539a2e015f265e8" class="i property">CimSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> from temporary cache.</span>
        <span class="c">///</span><span class="c"> If CimSession already present in cache, then decrease the refcount by 1,</span>
        <span class="c">///</span><span class="c"> otherwise ignore.</span>
        <span class="c">///</span><span class="c"> If refcount became 0, call dispose on the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e539a2e015f265e8" class="i property">CimSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">session</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">CimSession to be added.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="ec3fb2154a6a95d3" href="R/ec3fb2154a6a95d3.html" target="n" data-glyph="74,1" class="i method">RemoveCimSessionFromTemporaryCache</a>(<span class="i">CimSession</span> <span id="r12 rd" class="r12 r">session</span>)
        {
            <a href="#6979af06846a593f" class="i method">RemoveCimSessionFromTemporaryCache</a>(<span class="r12 r">session</span>, <b>true</b>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Event definitions
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Define an Event based on the NewActionHandler.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<a href="#f9a63e977fe06b4e" class="t t">CmdletActionEventArgs</a>&gt; <a id="04abbccddbb40bcb" href="R/04abbccddbb40bcb.html" target="n" data-glyph="30,1" class="i">OnNewCmdletAction</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event triggered when a new operation is started.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<a href="#57e1a1cbcfd66ad9" class="t t">OperationEventArgs</a>&gt; <a id="4358670844ddc0c7" href="R/4358670844ddc0c7.html" target="n" data-glyph="30,1" class="i">OnOperationCreated</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event triggered when a new operation is completed,</span>
        <span class="c">///</span><span class="c"> either success or failed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<a href="#57e1a1cbcfd66ad9" class="t t">OperationEventArgs</a>&gt; <a id="7aee8b0b9291b20b" href="R/7aee8b0b9291b20b.html" target="n" data-glyph="30,1" class="i">OnOperationDeleted</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Then create wrapper object by given CimSessionProxy object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="88fcd99575c15068" href="R/88fcd99575c15068.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxy</a>(<a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a> <span id="r13 rd" class="r13 r">proxy</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;protocol = {0}&quot;</span>, 1, <span class="r13 r">proxy</span>.<a href="#56a3d42ced450d15" class="i property">Protocol</a>);
 
            <a href="#4f8bc94fe93b1968" class="i method">CreateSetSession</a>(<b>null</b>, <span class="r13 r">proxy</span>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>, <b>null</b>, <span class="r13 r">proxy</span>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>, <span class="r13 r">proxy</span>.<a href="#9a99349f40e4a339" class="i property">IsTemporaryCimSession</a>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#56a3d42ced450d15" class="i property">Protocol</a> = <span class="r13 r">proxy</span>.<a href="#56a3d42ced450d15" class="i property">Protocol</a>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#6d62e741d043340b" class="i property">OperationTimeout</a> = <span class="r13 r">proxy</span>.<a href="#6d62e741d043340b" class="i property">OperationTimeout</a>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#452a12a26d493916" class="i field">isDefaultSession</a> = <span class="r13 r">proxy</span>.<a href="#452a12a26d493916" class="i field">isDefaultSession</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e539a2e015f265e8" class="i property">CimSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given computer name.</span>
        <span class="c">///</span><span class="c"> Then create wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="f1657d10b1a80e18" href="R/f1657d10b1a80e18.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxy</a>(<b>string</b> <span id="r14 rd" class="r14 r">computerName</span>)
        {
            <a href="#4f8bc94fe93b1968" class="i method">CreateSetSession</a>(<span class="r14 r">computerName</span>, <b>null</b>, <b>null</b>, <b>null</b>, <b>false</b>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#452a12a26d493916" class="i field">isDefaultSession</a> = <span class="r14 r">computerName</span> == <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#c7316551c0001b81" class="i field">NullComputerName</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e539a2e015f265e8" class="i property">CimSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given computer name</span>
        <span class="c">///</span><span class="c"> and session options.</span>
        <span class="c">///</span><span class="c"> Then create wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">sessionOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="f77c0b00a404a593" href="R/f77c0b00a404a593.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxy</a>(<b>string</b> <span id="r15 rd" class="r15 r">computerName</span>, <span class="i">CimSessionOptions</span> <span id="r16 rd" class="r16 r">sessionOptions</span>)
        {
            <a href="#4f8bc94fe93b1968" class="i method">CreateSetSession</a>(<span class="r15 r">computerName</span>, <b>null</b>, <span class="r16 r">sessionOptions</span>, <b>null</b>, <b>false</b>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#452a12a26d493916" class="i field">isDefaultSession</a> = <span class="r15 r">computerName</span> == <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#c7316551c0001b81" class="i field">NullComputerName</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e539a2e015f265e8" class="i property">CimSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given computer name</span>
        <span class="c">///</span><span class="c"> and cimInstance. Then create wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">cimInstance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="1240da2fc12ecd83" href="R/1240da2fc12ecd83.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxy</a>(<b>string</b> <span id="r17 rd" class="r17 r">computerName</span>, <span class="i">CimInstance</span> <span id="r18 rd" class="r18 r">cimInstance</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;ComputerName {0}; cimInstance.CimSessionInstanceID = {1}; cimInstance.CimSessionComputerName = {2}.&quot;</span>,
                0,
                <span class="r17 r">computerName</span>,
                <span class="r18 r">cimInstance</span>.<span class="i">GetCimSessionInstanceId</span>(),
                <span class="r18 r">cimInstance</span>.<span class="i">GetCimSessionComputerName</span>());
 
            <b>if</b> (<span class="r17 r">computerName</span> != <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#c7316551c0001b81" class="i field">NullComputerName</a>)
            {
                <a href="#4f8bc94fe93b1968" class="i method">CreateSetSession</a>(<span class="r17 r">computerName</span>, <b>null</b>, <b>null</b>, <b>null</b>, <b>false</b>);
                <b>return</b>;
            }
 
            <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r18 r">cimInstance</span> != <b>null</b>, <span class="s">&quot;Caller should verify cimInstance != null&quot;</span>);
 
            <span class="c">// computerName is null, fallback to create session from cimInstance</span>
            <a href="CimSessionOperations.cs.html#7e69b77e801106e8" class="t t">CimSessionState</a> <span id="r19 rd" class="r19 r">state</span> = <a href="CimSessionOperations.cs.html#a28b5e9a059e47c4" class="t t">CimSessionBase</a>.<a href="CimSessionOperations.cs.html#e67d9d3f3d497eaa" class="i method">GetCimSessionState</a>();
            <b>if</b> (<span class="r19 r">state</span> != <b>null</b>)
            {
                <span class="i">CimSession</span> <span id="r20 rd" class="r20 r">session</span> = <span class="r19 r">state</span>.<span class="i">QuerySession</span>(<span class="r18 r">cimInstance</span>.<span class="i">GetCimSessionInstanceId</span>());
                <b>if</b> (<span class="r20 r">session</span> != <b>null</b>)
                {
                    <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;Found the session from cache with InstanceID={0}.&quot;</span>, 0, <span class="r18 r">cimInstance</span>.<span class="i">GetCimSessionInstanceId</span>());
                    <a href="#4f8bc94fe93b1968" class="i method">CreateSetSession</a>(<b>null</b>, <span class="r20 r">session</span>, <b>null</b>, <b>null</b>, <b>false</b>);
                    <b>return</b>;
                }
            }
 
            <b>string</b> <span id="r21 rd" class="r21 r">cimsessionComputerName</span> = <span class="r18 r">cimInstance</span>.<span class="i">GetCimSessionComputerName</span>();
            <a href="#4f8bc94fe93b1968" class="i method">CreateSetSession</a>(<span class="r21 r">cimsessionComputerName</span>, <b>null</b>, <b>null</b>, <b>null</b>, <b>false</b>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#452a12a26d493916" class="i field">isDefaultSession</a> = <span class="r21 r">cimsessionComputerName</span> == <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#c7316551c0001b81" class="i field">NullComputerName</a>;
 
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;Create a temp session with computerName = {0}.&quot;</span>, 0, <span class="r21 r">cimsessionComputerName</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e539a2e015f265e8" class="i property">CimSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given computer name,</span>
        <span class="c">///</span><span class="c"> session options.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">sessionOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">operOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Used when create async operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="73e07e9b13029554" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxy</a>(<b>string</b> <span id="r22 rd" class="r22 r">computerName</span>, <span class="i">CimSessionOptions</span> <span id="r23 rd" class="r23 r">sessionOptions</span>, <span class="i">CimOperationOptions</span> <span id="r24 rd" class="r24 r">operOptions</span>)
        {
            <a href="#4f8bc94fe93b1968" class="i method">CreateSetSession</a>(<span class="r22 r">computerName</span>, <b>null</b>, <span class="r23 r">sessionOptions</span>, <span class="r24 r">operOptions</span>, <b>false</b>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#452a12a26d493916" class="i field">isDefaultSession</a> = <span class="r22 r">computerName</span> == <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#c7316551c0001b81" class="i field">NullComputerName</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e539a2e015f265e8" class="i property">CimSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given computer name.</span>
        <span class="c">///</span><span class="c"> Then create wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">operOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Used when create async operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="e1caebbd3412b4c7" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxy</a>(<b>string</b> <span id="r25 rd" class="r25 r">computerName</span>, <span class="i">CimOperationOptions</span> <span id="r26 rd" class="r26 r">operOptions</span>)
        {
            <a href="#4f8bc94fe93b1968" class="i method">CreateSetSession</a>(<span class="r25 r">computerName</span>, <b>null</b>, <b>null</b>, <span class="r26 r">operOptions</span>, <b>false</b>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#452a12a26d493916" class="i field">isDefaultSession</a> = <span class="r25 r">computerName</span> == <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#c7316551c0001b81" class="i field">NullComputerName</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create wrapper object by given session object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">session</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="9097fe2d7684e63b" href="R/9097fe2d7684e63b.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxy</a>(<span class="i">CimSession</span> <span id="r27 rd" class="r27 r">session</span>)
        {
            <a href="#4f8bc94fe93b1968" class="i method">CreateSetSession</a>(<b>null</b>, <span class="r27 r">session</span>, <b>null</b>, <b>null</b>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create wrapper object by given session object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">session</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">operOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Used when create async operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="afc0bfca3b4b385f" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxy</a>(<span class="i">CimSession</span> <span id="r28 rd" class="r28 r">session</span>, <span class="i">CimOperationOptions</span> <span id="r29 rd" class="r29 r">operOptions</span>)
        {
            <a href="#4f8bc94fe93b1968" class="i method">CreateSetSession</a>(<b>null</b>, <span class="r28 r">session</span>, <b>null</b>, <span class="r29 r">operOptions</span>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize CimSessionProxy object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">session</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">sessionOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">options</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="4f8bc94fe93b1968" href="R/4f8bc94fe93b1968.html" target="n" data-glyph="76,1" class="i method">CreateSetSession</a>(
            <b>string</b> <span id="r30 rd" class="r30 r">computerName</span>,
            <span class="i">CimSession</span> <span id="r32 rd" class="r32 r">cimSession</span>,
            <span class="i">CimSessionOptions</span> <span id="r31 rd" class="r31 r">sessionOptions</span>,
            <span class="i">CimOperationOptions</span> <span id="r33 rd" class="r33 r">operOptions</span>,
            <b>bool</b> <span id="r34 rd" class="r34 r">temporaryCimSession</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;computername {0}; cimsession {1}; sessionOptions {2}; operationOptions {3}.&quot;</span>, 0, <span class="r30 r">computerName</span>, <span class="r32 r">cimSession</span>, <span class="r31 r">sessionOptions</span>, <span class="r33 r">operOptions</span>);
 
            <b>lock</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#a3ca1774d0643eda" class="i field">stateLock</a>)
            {
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c4e03841cce08d67" class="i property">CancelOperation</a> = <b>null</b>;
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#bdcd6d16176ee4e7" class="i field">operation</a> = <b>null</b>;
            }
 
            <a href="#911a02fcc29638d5" class="i method">InitOption</a>(<span class="r33 r">operOptions</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#56a3d42ced450d15" class="i property">Protocol</a> = <a href="NewCimSessionOptionCommand.cs.html#0e497fefee80122f" class="t t">ProtocolType</a>.<a href="NewCimSessionOptionCommand.cs.html#9ed00d72429bb18e" class="i field">Wsman</a>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#9a99349f40e4a339" class="i property">IsTemporaryCimSession</a> = <span class="r34 r">temporaryCimSession</span>;
 
            <b>if</b> (<span class="r32 r">cimSession</span> != <b>null</b>)
            {
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a> = <span class="r32 r">cimSession</span>;
                <a href="CimSessionOperations.cs.html#7e69b77e801106e8" class="t t">CimSessionState</a> <span id="r35 rd" class="r35 r">state</span> = <a href="CimSessionOperations.cs.html#a28b5e9a059e47c4" class="t t">CimSessionBase</a>.<a href="CimSessionOperations.cs.html#e67d9d3f3d497eaa" class="i method">GetCimSessionState</a>();
                <b>if</b> (<span class="r35 r">state</span> != <b>null</b>)
                {
                    <a href="CimSessionOperations.cs.html#78aeb9bf6b3fce4e" class="t t">CimSessionWrapper</a> <span id="r36 rd" class="r36 r">wrapper</span> = <span class="r35 r">state</span>.<a href="CimSessionOperations.cs.html#4801fff6e4eb2ef9" class="i method">QuerySession</a>(<span class="r32 r">cimSession</span>);
                    <b>if</b> (<span class="r36 r">wrapper</span> != <b>null</b>)
                    {
                        <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#56a3d42ced450d15" class="i property">Protocol</a> = <span class="r36 r">wrapper</span>.<a href="CimSessionOperations.cs.html#958f65f9c1c41e37" class="i method">GetProtocolType</a>();
                    }
                }
            }
            <b>else</b>
            {
                <b>if</b> (<span class="r31 r">sessionOptions</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r31 r">sessionOptions</span> <b>is</b> <span class="i">DComSessionOptions</span>)
                    {
                        <b>string</b> <span id="r37 rd" class="r37 r">defaultComputerName</span> = <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#a3fcb89282d9eaf8" class="i method">IsDefaultComputerName</a>(<span class="r30 r">computerName</span>) ? <a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#c7316551c0001b81" class="i field">NullComputerName</a> : <span class="r30 r">computerName</span>;
                        <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a> = <a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">Create</span>(<span class="r37 r">defaultComputerName</span>, <span class="r31 r">sessionOptions</span>);
                        <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#56a3d42ced450d15" class="i property">Protocol</a> = <a href="NewCimSessionOptionCommand.cs.html#0e497fefee80122f" class="t t">ProtocolType</a>.<a href="NewCimSessionOptionCommand.cs.html#e463eb81efd84241" class="i field">Dcom</a>;
                    }
                    <b>else</b>
                    {
                        <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a> = <a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">Create</span>(<span class="r30 r">computerName</span>, <span class="r31 r">sessionOptions</span>);
                    }
                }
                <b>else</b>
                {
                    <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a> = <a href="#15e6c71cb6f3db6f" class="i method">CreateCimSessionByComputerName</a>(<span class="r30 r">computerName</span>);
                }
 
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#9a99349f40e4a339" class="i property">IsTemporaryCimSession</a> = <b>true</b>;
            }
 
            <b>if</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#9a99349f40e4a339" class="i property">IsTemporaryCimSession</a>)
            {
                <a href="#ad75d4d49480298b" class="i method">AddCimSessionToTemporaryCache</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>);
            }
 
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#4e080b7764a9d7da" class="i field">invocationContextObject</a> = <b>new</b> <a href="#8fdb5511b849b58c" class="t constructor">InvocationContext</a>(<a href="#64da31a8ef7908ad" class="k">this</a>);
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<span class="s">&quot;Protocol {0}, Is temporary session ? {1}&quot;</span>, 1, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#56a3d42ced450d15" class="i property">Protocol</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#9a99349f40e4a339" class="i property">IsTemporaryCimSession</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> set operation options
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set timeout value (seconds) of the operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public uint</b> <a id="6d62e741d043340b" href="R/6d62e741d043340b.html" target="n" data-glyph="102,1" class="i property">OperationTimeout</a>
        {
            <b>get</b>
            {
                <b>return</b> (<b>uint</b>)<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">Timeout</span>.<span class="i">TotalSeconds</span>;
            }
 
            <b>set</b>
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;OperationTimeout {0},&quot;</span>, 0, <b>value</b>);
 
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">Timeout</span> = <span class="i">TimeSpan</span>.<span class="i">FromSeconds</span>((<b>double</b>)<b>value</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set resource URI of the operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Uri</span> <a id="766aecf9a70e28e9" href="R/766aecf9a70e28e9.html" target="n" data-glyph="102,1" class="i property">ResourceUri</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">ResourceUri</span>;
            }
 
            <b>set</b>
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;ResourceUri {0},&quot;</span>, 0, <b>value</b>);
 
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">ResourceUri</span> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enable/Disable the method result streaming,</span>
        <span class="c">///</span><span class="c"> it is enabled by default.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="6175600d03d1d002" href="R/6175600d03d1d002.html" target="n" data-glyph="102,1" class="i property">EnableMethodResultStreaming</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">EnableMethodResultStreaming</span>;
            }
 
            <b>set</b>
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;EnableMethodResultStreaming {0}&quot;</span>, 0, <b>value</b>);
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">EnableMethodResultStreaming</span> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enable/Disable prompt user streaming,</span>
        <span class="c">///</span><span class="c"> it is enabled by default.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="d114e44ed0afd27f" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">EnablePromptUser</a>
        {
            <b>set</b>
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;EnablePromptUser {0}&quot;</span>, 0, <b>value</b>);
                <b>if</b> (<b>value</b>)
                {
                    <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">PromptUser</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">PromptUser</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enable the pssemantics.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="77cbb431cebf9296" href="R/77cbb431cebf9296.html" target="n" data-glyph="76,1" class="i method">EnablePSSemantics</a>()
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <span class="c">// this.options.PromptUserForceFlag...</span>
            <span class="c">// this.options.WriteErrorMode</span>
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">WriteErrorMode</span> = <span class="i">CimCallbackMode</span>.<span class="i">Inquire</span>;
 
            <span class="c">// !!!NOTES: Does not subscribe to PromptUser for CimCmdlets now</span>
            <span class="c">// since cmdlet does not provider an approach</span>
            <span class="c">// to let user select how to handle prompt message</span>
            <span class="c">// this can be enabled later if needed.</span>
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">WriteError</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">WriteError</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">WriteMessage</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">WriteMessage</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">WriteProgress</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">WriteProgress</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set keyonly property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="4935e439eeb9ebac" href="R/4935e439eeb9ebac.html" target="n" data-glyph="102,1" class="i property">KeyOnly</a>
        {
            <b>set</b> { <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">KeysOnly</span> = <b>value</b>.<a href="/System.Management.Automation/A.html#e9c777a85700d3da" class="i property">IsPresent</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set Shallow flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="3bd991944f69c2ad" href="R/3bd991944f69c2ad.html" target="n" data-glyph="102,1" class="i property">Shallow</a>
        {
            <b>set</b>
            {
                <b>if</b> (<b>value</b>.<a href="/System.Management.Automation/A.html#e9c777a85700d3da" class="i property">IsPresent</a>)
                {
                    <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">Flags</span> = <span class="i">CimOperationFlags</span>.<span class="i">PolymorphismShallow</span>;
                }
                <b>else</b>
                {
                    <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">Flags</span> = <span class="i">CimOperationFlags</span>.<span class="i">None</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize the operation option.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="911a02fcc29638d5" href="R/911a02fcc29638d5.html" target="n" data-glyph="76,1" class="i method">InitOption</a>(<span class="i">CimOperationOptions</span> <span id="r38 rd" class="r38 r">operOptions</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <b>if</b> (<span class="r38 r">operOptions</span> != <b>null</b>)
            {
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a> = <b>new</b> <span class="i">CimOperationOptions</span>(<span class="r38 r">operOptions</span>);
            }
            <b>else</b> <b>if</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a> == <b>null</b>)
            {
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a> = <b>new</b> <span class="i">CimOperationOptions</span>();
            }
 
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#6175600d03d1d002" class="i property">EnableMethodResultStreaming</a> = <b>true</b>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#77cbb431cebf9296" class="i method">EnablePSSemantics</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> misc operations
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caller call Detach to retrieve the session</span>
        <span class="c">///</span><span class="c"> object and control the lifecycle of the CimSession object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">CimSession</span> <a id="57ce7ce94615abb2" href="R/57ce7ce94615abb2.html" target="n" data-glyph="72,1" class="i method">Detach</a>()
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <span class="c">// Remove the CimSession from cache but don&#39;t dispose it</span>
            <a href="#6979af06846a593f" class="i method">RemoveCimSessionFromTemporaryCache</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>, <b>false</b>);
            <span class="i">CimSession</span> <span id="r39 rd" class="r39 r">sessionToReturn</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a> = <b>null</b>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#9a99349f40e4a339" class="i property">IsTemporaryCimSession</a> = <b>false</b>;
            <b>return</b> <span class="r39 r">sessionToReturn</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add a new operation to cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">operation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">cancelObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="0f1acb8988caf8c0" href="R/0f1acb8988caf8c0.html" target="n" data-glyph="76,1" class="i method">AddOperation</a>(<span class="i">IObservable</span>&lt;<b>object</b>&gt; <span id="r40 rd" class="r40 r">operation</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <b>lock</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#a3ca1774d0643eda" class="i field">stateLock</a>)
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3e5398ebdb91091b" class="i property">Completed</a>, <span class="s">&quot;Caller should verify that there is no operation in progress&quot;</span>);
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#bdcd6d16176ee4e7" class="i field">operation</a> = <span class="r40 r">operation</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove object from cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">operation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="2b3cba19201a574f" href="R/2b3cba19201a574f.html" target="n" data-glyph="76,1" class="i method">RemoveOperation</a>(<span class="i">IObservable</span>&lt;<b>object</b>&gt; <span id="r41 rd" class="r41 r">operation</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <b>lock</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#a3ca1774d0643eda" class="i field">stateLock</a>)
            {
                <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#bdcd6d16176ee4e7" class="i field">operation</a> == <span class="r41 r">operation</span>, <span class="s">&quot;Caller should verify that the operation to remove is the operation in progress&quot;</span>);
 
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#2ccbc0d218a6d13a" class="i method">DisposeCancelOperation</a>();
 
                <b>if</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#bdcd6d16176ee4e7" class="i field">operation</a> != <b>null</b>)
                {
                    <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#bdcd6d16176ee4e7" class="i field">operation</a> = <b>null</b>;
                }
 
                <b>if</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a> != <b>null</b> &amp;&amp; <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#b1453253349bbaff" class="i property">ContextObject</a> == <b>null</b>)
                {
                    <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#3f92c51cd9afbf2a" class="i method">WriteLog</a>(<span class="s">&quot;Dispose this proxy object @ RemoveOperation&quot;</span>);
                    <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#eb54fde44cdb1537" class="i method">Dispose</a>();
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Trigger an event that new action available</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="47e7a7e8f5f64709" href="R/47e7a7e8f5f64709.html" target="n" data-glyph="75,1" class="i method">FireNewActionEvent</a>(<a href="CimBaseAction.cs.html#0953d185c863ca27" class="t t">CimBaseAction</a> <span id="r42 rd" class="r42 r">action</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <a href="#f9a63e977fe06b4e" class="t t">CmdletActionEventArgs</a> <span id="r43 rd" class="r43 r">actionArgs</span> = <b>new</b>(<span class="r42 r">action</span>);
            <b>if</b> (!<a href="#e02fd76ed85e42cb" class="i method">PreNewActionEvent</a>(<span class="r43 r">actionArgs</span>))
            {
                <b>return</b>;
            }
 
            <span class="i">EventHandler</span>&lt;<a href="#f9a63e977fe06b4e" class="t t">CmdletActionEventArgs</a>&gt; <span id="r44 rd" class="r44 r">temp</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#04abbccddbb40bcb" class="i">OnNewCmdletAction</a>;
            <b>if</b> (<span class="r44 r">temp</span> != <b>null</b>)
            {
                <span class="r44 r">temp</span>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>, <span class="r43 r">actionArgs</span>);
            }
            <b>else</b>
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#4021e88828f2c984" class="i method">WriteLog</a>(<span class="s">&quot;Ignore action since OnNewCmdletAction is null.&quot;</span>, 5);
            }
 
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#68c9cec598073156" class="i method">PostNewActionEvent</a>(<span class="r43 r">actionArgs</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Trigger an event that new operation is created</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">cancelOperation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">operation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="dd8a5090e81fec49" href="R/dd8a5090e81fec49.html" target="n" data-glyph="76,1" class="i method">FireOperationCreatedEvent</a>(
            <span class="i">IDisposable</span> <span id="r45 rd" class="r45 r">cancelOperation</span>,
            <span class="i">IObservable</span>&lt;<b>object</b>&gt; <span id="r46 rd" class="r46 r">operation</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <a href="#57e1a1cbcfd66ad9" class="t t">OperationEventArgs</a> <span id="r47 rd" class="r47 r">args</span> = <b>new</b>(
                <span class="r45 r">cancelOperation</span>, <span class="r46 r">operation</span>, <b>false</b>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#4358670844ddc0c7" class="i">OnOperationCreated</a>?.<span class="i">Invoke</span>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>, <span class="r47 r">args</span>);
 
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#42736259183ac443" class="i method">PostOperationCreateEvent</a>(<span class="r47 r">args</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Trigger an event that an operation is deleted</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">operation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b7069c254e877ffd" href="R/b7069c254e877ffd.html" target="n" data-glyph="76,1" class="i method">FireOperationDeletedEvent</a>(
            <span class="i">IObservable</span>&lt;<b>object</b>&gt; <span id="r48 rd" class="r48 r">operation</span>,
            <b>bool</b> <span id="r49 rd" class="r49 r">success</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#100116ce8f7a352d" class="i method">WriteOperationCompleteMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>);
            <a href="#57e1a1cbcfd66ad9" class="t t">OperationEventArgs</a> <span id="r50 rd" class="r50 r">args</span> = <b>new</b>(
                <b>null</b>, <span class="r48 r">operation</span>, <span class="r49 r">success</span>);
            <a href="#73360c8b3b8847bd" class="i method">PreOperationDeleteEvent</a>(<span class="r50 r">args</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#7aee8b0b9291b20b" class="i">OnOperationDeleted</a>?.<span class="i">Invoke</span>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>, <span class="r50 r">args</span>);
 
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#65c0bad592a65e40" class="i method">PostOperationDeleteEvent</a>(<span class="r50 r">args</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#2b3cba19201a574f" class="i method">RemoveOperation</a>(<span class="r48 r">operation</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PSExtension callback functions
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WriteMessage callback</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">channel</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="06cbc135db040da9" href="R/06cbc135db040da9.html" target="n" data-glyph="74,1" class="i method">WriteMessage</a>(<b>uint</b> <span id="r51 rd" class="r51 r">channel</span>, <b>string</b> <span id="r52 rd" class="r52 r">message</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;Channel = {0} message = {1}&quot;</span>, 0, <span class="r51 r">channel</span>, <span class="r52 r">message</span>);
            <b>try</b>
            {
                <a href="CimWriteMessage.cs.html#78c7cdde338cb98d" class="t t">CimWriteMessage</a> <span id="r53 rd" class="r53 r">action</span> = <b>new</b>(<span class="r51 r">channel</span>, <span class="r52 r">message</span>);
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#47e7a7e8f5f64709" class="i method">FireNewActionEvent</a>(<span class="r53 r">action</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r54 rd" class="r54 r">ex</span>)
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;{0}&quot;</span>, 0, <span class="r54 r">ex</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write operation start verbose message</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">operation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">parameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="49f2814fdb41f27e" href="R/49f2814fdb41f27e.html" target="n" data-glyph="74,1" class="i method">WriteOperationStartMessage</a>(<b>string</b> <span id="r55 rd" class="r55 r">operation</span>, <span class="i">Hashtable</span> <span id="r56 rd" class="r56 r">parameterList</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
            <span class="i">StringBuilder</span> <span id="r57 rd" class="r57 r">parameters</span> = <b>new</b>();
            <b>if</b> (<span class="r56 r">parameterList</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>string</b> <span id="r58 rd" class="r58 r">key</span> <b>in</b> <span class="r56 r">parameterList</span>.<span class="i">Keys</span>)
                {
                    <b>if</b> (<span class="r57 r">parameters</span>.<span class="i">Length</span> &gt; 0)
                    {
                        <span class="r57 r">parameters</span>.<span class="i">Append</span>(<span class="s">&#39;,&#39;</span>);
                    }
 
                    <span class="r57 r">parameters</span>.<span class="i">Append</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="s">@&quot;&#39;{0}&#39; = {1}&quot;</span>, <span class="r58 r">key</span>, <span class="r56 r">parameterList</span>[<span class="r58 r">key</span>]));
                }
            }
 
            <b>string</b> <span id="r59 rd" class="r59 r">operationStartMessage</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>,
                <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationStart</span>,
                <span class="r55 r">operation</span>,
                (<span class="r57 r">parameters</span>.<span class="i">Length</span> == 0) ? <span class="s">&quot;null&quot;</span> : <span class="r57 r">parameters</span>.<span class="i">ToString</span>());
            <a href="#06cbc135db040da9" class="i method">WriteMessage</a>((<b>uint</b>)<span class="i">CimWriteMessageChannel</span>.<span class="i">Verbose</span>, <span class="r59 r">operationStartMessage</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write operation complete verbose message</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">operation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="100116ce8f7a352d" href="R/100116ce8f7a352d.html" target="n" data-glyph="74,1" class="i method">WriteOperationCompleteMessage</a>(<b>string</b> <span id="r60 rd" class="r60 r">operation</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
            <b>string</b> <span id="r61 rd" class="r61 r">operationCompleteMessage</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>,
                <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationCompleted</span>,
                <span class="r60 r">operation</span>);
            <a href="#06cbc135db040da9" class="i method">WriteMessage</a>((<b>uint</b>)<span class="i">CimWriteMessageChannel</span>.<span class="i">Verbose</span>, <span class="r61 r">operationCompleteMessage</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WriteProgress callback</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">activity</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">currentOperation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r64 r">statusDescription</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">percentageCompleted</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">secondsRemaining</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="5b85a28cb61a2d6a" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WriteProgress</a>(<b>string</b> <span id="r62 rd" class="r62 r">activity</span>,
            <b>string</b> <span id="r63 rd" class="r63 r">currentOperation</span>,
            <b>string</b> <span id="r64 rd" class="r64 r">statusDescription</span>,
            <b>uint</b> <span id="r65 rd" class="r65 r">percentageCompleted</span>,
            <b>uint</b> <span id="r66 rd" class="r66 r">secondsRemaining</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;activity:{0}; currentOperation:{1}; percentageCompleted:{2}; secondsRemaining:{3}&quot;</span>,
                0, <span class="r62 r">activity</span>, <span class="r63 r">currentOperation</span>, <span class="r65 r">percentageCompleted</span>, <span class="r66 r">secondsRemaining</span>);
 
            <b>try</b>
            {
                <a href="CimWriteProgress.cs.html#d202b1552c5a7e91" class="t t">CimWriteProgress</a> <span id="r67 rd" class="r67 r">action</span> = <b>new</b>(
                    <span class="r62 r">activity</span>,
                    (<b>int</b>)<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#67a3f8900f21a514" class="i field">operationID</a>,
                    <span class="r63 r">currentOperation</span>,
                    <span class="r64 r">statusDescription</span>,
                    <span class="r65 r">percentageCompleted</span>,
                    <span class="r66 r">secondsRemaining</span>);
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#47e7a7e8f5f64709" class="i method">FireNewActionEvent</a>(<span class="r67 r">action</span>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r68 rd" class="r68 r">ex</span>)
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;{0}&quot;</span>, 0, <span class="r68 r">ex</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WriteError callback</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">instance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">CimResponseType</span> <a id="838b5de40ee488af" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WriteError</a>(<span class="i">CimInstance</span> <span id="r69 rd" class="r69 r">instance</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;Error:{0}&quot;</span>, 0, <span class="r69 r">instance</span>);
            <b>try</b>
            {
                <a href="CimWriteError.cs.html#b6cd4871b3fed104" class="t t">CimWriteError</a> <span id="r70 rd" class="r70 r">action</span> = <b>new</b>(<span class="r69 r">instance</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#4e080b7764a9d7da" class="i field">invocationContextObject</a>);
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#47e7a7e8f5f64709" class="i method">FireNewActionEvent</a>(<span class="r70 r">action</span>);
                <b>return</b> <span class="r70 r">action</span>.<a href="CimBaseAction.cs.html#c3f77431c0cefb59" class="i method">GetResponse</a>();
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r71 rd" class="r71 r">ex</span>)
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;{0}&quot;</span>, 0, <span class="r71 r">ex</span>);
                <b>return</b> <span class="i">CimResponseType</span>.<span class="i">NoToAll</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PromptUser callback.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">prompt</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">CimResponseType</span> <a id="a09d419d70cd88d7" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">PromptUser</a>(<b>string</b> <span id="r72 rd" class="r72 r">message</span>, <span class="i">CimPromptType</span> <span id="r73 rd" class="r73 r">prompt</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;message:{0} prompt:{1}&quot;</span>, 0, <span class="r72 r">message</span>, <span class="r73 r">prompt</span>);
            <b>try</b>
            {
                <a href="CimPromptUser.cs.html#6dd887122172b625" class="t t">CimPromptUser</a> <span id="r74 rd" class="r74 r">action</span> = <b>new</b>(<span class="r72 r">message</span>, <span class="r73 r">prompt</span>);
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#47e7a7e8f5f64709" class="i method">FireNewActionEvent</a>(<span class="r74 r">action</span>);
                <b>return</b> <span class="r74 r">action</span>.<a href="CimBaseAction.cs.html#c3f77431c0cefb59" class="i method">GetResponse</a>();
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r75 rd" class="r75 r">ex</span>)
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;{0}&quot;</span>, 0, <span class="r75 r">ex</span>);
                <b>return</b> <span class="i">CimResponseType</span>.<span class="i">NoToAll</span>;
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Async result handler
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle async event triggered by </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="CimResultObserver.cs.html#134d59fecee2c1fb" class="t t">CimResultObserver</a>{<span class="r76 r t">T</span>}<span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">observer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object triggered the event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">resultArgs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Async result event argument.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="6669c866b03eae2c" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ResultEventHandler</a>(
            <b>object</b> <span id="r77 rd" class="r77 r">observer</span>,
            <a href="CimResultObserver.cs.html#4acf81c19af8e251" class="t t">AsyncResultEventArgsBase</a> <span id="r78 rd" class="r78 r">resultArgs</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
            <b>switch</b> (<span class="r78 r">resultArgs</span>.<a href="CimResultObserver.cs.html#5319d9db0cfc7f0f" class="i field">resultType</a>)
            {
                <b>case</b> <a href="CimResultObserver.cs.html#8cd84602dfd3efbe" class="t t">AsyncResultType</a>.<a href="CimResultObserver.cs.html#acaca7efc5d2febc" class="i field">Completion</a>:
                    {
                        <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#4021e88828f2c984" class="i method">WriteLog</a>(<span class="s">&quot;ResultEventHandler::Completion&quot;</span>, 4);
 
                        <a href="CimResultObserver.cs.html#38e66bd55fe5c7b8" class="t t">AsyncResultCompleteEventArgs</a> <span id="r79 rd" class="r79 r">args</span> = <span class="r78 r">resultArgs</span> <b>as</b> <a href="CimResultObserver.cs.html#38e66bd55fe5c7b8" class="t t">AsyncResultCompleteEventArgs</a>;
                        <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#b7069c254e877ffd" class="i method">FireOperationDeletedEvent</a>(<span class="r79 r">args</span>.<a href="CimResultObserver.cs.html#1aad2c6ca4dd3d71" class="i field">observable</a>, <b>true</b>);
                    }
 
                    <b>break</b>;
                <b>case</b> <a href="CimResultObserver.cs.html#8cd84602dfd3efbe" class="t t">AsyncResultType</a>.<a href="CimResultObserver.cs.html#d08fd72f2501c620" class="i field">Exception</a>:
                    {
                        <a href="CimResultObserver.cs.html#810111a291b07e79" class="t t">AsyncResultErrorEventArgs</a> <span id="r80 rd" class="r80 r">args</span> = <span class="r78 r">resultArgs</span> <b>as</b> <a href="CimResultObserver.cs.html#810111a291b07e79" class="t t">AsyncResultErrorEventArgs</a>;
                        <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<span class="s">&quot;ResultEventHandler::Exception {0}&quot;</span>, 4, <span class="r80 r">args</span>.<a href="CimResultObserver.cs.html#26f9871f52719c13" class="i field">error</a>);
 
                        <b>using</b> (<a href="CimWriteError.cs.html#b6cd4871b3fed104" class="t t">CimWriteError</a> <span id="r81 rd" class="r81 r">action</span> = <b>new</b>(<span class="r80 r">args</span>.<a href="CimResultObserver.cs.html#26f9871f52719c13" class="i field">error</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#4e080b7764a9d7da" class="i field">invocationContextObject</a>, <span class="r80 r">args</span>.<a href="CimResultObserver.cs.html#0130563cecf057a1" class="i field">context</a>))
                        {
                            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#47e7a7e8f5f64709" class="i method">FireNewActionEvent</a>(<span class="r81 r">action</span>);
                        }
 
                        <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#b7069c254e877ffd" class="i method">FireOperationDeletedEvent</a>(<span class="r80 r">args</span>.<a href="CimResultObserver.cs.html#1aad2c6ca4dd3d71" class="i field">observable</a>, <b>false</b>);
                    }
 
                    <b>break</b>;
                <b>case</b> <a href="CimResultObserver.cs.html#8cd84602dfd3efbe" class="t t">AsyncResultType</a>.<a href="CimResultObserver.cs.html#035ba6a8b863c84e" class="i field">Result</a>:
                    {
                        <a href="CimResultObserver.cs.html#30937535547db4e2" class="t t">AsyncResultObjectEventArgs</a> <span id="r82 rd" class="r82 r">args</span> = <span class="r78 r">resultArgs</span> <b>as</b> <a href="CimResultObserver.cs.html#30937535547db4e2" class="t t">AsyncResultObjectEventArgs</a>;
                        <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#655521cf1d3bf942" class="i method">WriteLog</a>(<span class="s">&quot;ResultEventHandler::Result {0}&quot;</span>, 4, <span class="r82 r">args</span>.<a href="CimResultObserver.cs.html#f4093598d23e8156" class="i field">resultObject</a>);
                        <b>object</b> <span id="r83 rd" class="r83 r">resultObject</span> = <span class="r82 r">args</span>.<a href="CimResultObserver.cs.html#f4093598d23e8156" class="i field">resultObject</a>;
                        <b>if</b> (!<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#452a12a26d493916" class="i field">isDefaultSession</a>)
                        {
                            <a href="#6582a934c2456eb7" class="i method">AddShowComputerNameMarker</a>(<span class="r83 r">resultObject</span>);
                        }
 
                        <b>if</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#a0187330a5f4f78e" class="i property">ObjectPreProcess</a> != <b>null</b>)
                        {
                            <span class="r83 r">resultObject</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#a0187330a5f4f78e" class="i property">ObjectPreProcess</a>.<a href="#06815c069d8c939d" class="i method">Process</a>(<span class="r83 r">resultObject</span>);
                        }
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
                        <span class="r83 r">resultObject</span> = <a href="#a1310e89cb5c8117" class="i method">PostProcessCimInstance</a>(<span class="r83 r">resultObject</span>);
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                        <a href="CimWriteResultObject.cs.html#b7a3847402daf14e" class="t t">CimWriteResultObject</a> <span id="r84 rd" class="r84 r">action</span> = <b>new</b>(<span class="r83 r">resultObject</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#b1453253349bbaff" class="i property">ContextObject</a>);
                        <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#47e7a7e8f5f64709" class="i method">FireNewActionEvent</a>(<span class="r84 r">action</span>);
                    }
 
                    <b>break</b>;
                <b>default</b>:
                    <b>break</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method adds a note property to </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r85 r">o</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
        <span class="c">///</span><span class="c"> which will cause the default PowerShell formatting and output</span>
        <span class="c">///</span><span class="c"> to include PSComputerName column/property in the display.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r85 r">o</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="6582a934c2456eb7" href="R/6582a934c2456eb7.html" target="n" data-glyph="76,1" class="i method">AddShowComputerNameMarker</a>(<b>object</b> <span id="r85 rd" class="r85 r">o</span>)
        {
            <b>if</b> (<span class="r85 r">o</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r86 rd" class="r86 r">pso</span> = <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">AsPSObject</span>(<span class="r85 r">o</span>);
            <b>if</b> (<span class="r86 r">pso</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is not</b> <span class="i">CimInstance</span>)
            {
                <b>return</b>;
            }
 
            <a href="/System.Management.Automation/A.html#964f2480da01a02c" class="t t">PSNoteProperty</a> <span id="r87 rd" class="r87 r">psShowComputerNameProperty</span> = <b>new</b>(<a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#4f8866cfaaa03c3b" class="i field">ShowComputerNameNoteProperty</a>, <b>true</b>);
            <span class="r86 r">pso</span>.<a href="/System.Management.Automation/A.html#56bc82b240e4291b" class="i property">Members</a>.<span class="i">Add</span>(<span class="r87 r">psShowComputerNameProperty</span>);
        }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
        <b>private static readonly bool</b> <a id="45d00fff4136fd0c" href="R/45d00fff4136fd0c.html" target="n" data-glyph="46,1" class="i field">isCliXmlTestabilityHookActive</a> = <a href="#0e784b443012f3ef" class="i method">GetIsCliXmlTestabilityHookActive</a>();
 
        <b>private static bool</b> <a id="0e784b443012f3ef" href="R/0e784b443012f3ef.html" target="n" data-glyph="76,1" class="i method">GetIsCliXmlTestabilityHookActive</a>()
        {
            <b>return</b> !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="i">Environment</span>.<span class="i">GetEnvironmentVariable</span>(<span class="s">&quot;CDXML_CLIXML_TEST&quot;</span>));
        }
 
        <b>private static object</b> <a id="a1310e89cb5c8117" href="R/a1310e89cb5c8117.html" target="n" data-glyph="76,1" class="i method">PostProcessCimInstance</a>(<b>object</b> <span id="r88 rd" class="r88 r">resultObject</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
            <b>if</b> (<a href="#45d00fff4136fd0c" class="i field">isCliXmlTestabilityHookActive</a> &amp;&amp; (<span class="r88 r">resultObject</span> <b>is</b> <span class="i">CimInstance</span>))
            {
                <b>string</b> <span id="r89 rd" class="r89 r">serializedForm</span> = <a href="/System.Management.Automation/A.html#9342c13ff4bbe3fb" class="t t">PSSerializer</a>.<span class="i">Serialize</span>(<span class="r88 r">resultObject</span> <b>as</b> <span class="i">CimInstance</span>, <span class="i">depth</span>: 1);
                <b>object</b> <span id="r90 rd" class="r90 r">deserializedObject</span> = <a href="/System.Management.Automation/A.html#9342c13ff4bbe3fb" class="t t">PSSerializer</a>.<span class="i">Deserialize</span>(<span class="r89 r">serializedForm</span>);
                <b>object</b> <span id="r91 rd" class="r91 r">returnObject</span> = (<span class="r90 r">deserializedObject</span> <b>is</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>) ? (<span class="r90 r">deserializedObject</span> <b>as</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>).<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> : <span class="r90 r">deserializedObject</span>;
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;Deserialized object is {0}, type {1}&quot;</span>, 1, <span class="r91 r">returnObject</span>, <span class="r91 r">returnObject</span>.<span class="i">GetType</span>());
                <b>return</b> <span class="r91 r">returnObject</span>;
            }
 
            <b>return</b> <span class="r88 r">resultObject</span>;
        }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Async operations
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> create a cim instance asynchronously</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">instance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="d42891f53146f25a" href="R/d42891f53146f25a.html" target="n" data-glyph="72,1" class="i method">CreateInstanceAsync</a>(<b>string</b> <span id="r92 rd" class="r92 r">namespaceName</span>, <span class="i">CimInstance</span> <span id="r93 rd" class="r93 r">instance</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r93 r">instance</span> != <b>null</b>, <span class="s">&quot;Caller should verify that instance != NULL.&quot;</span>);
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;EnableMethodResultStreaming = {0}&quot;</span>, 0, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">EnableMethodResultStreaming</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <span class="r93 r">instance</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameCreateInstance</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r92 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;instance&quot;</span>, <span class="r93 r">instance</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
            <span class="i">CimAsyncResult</span>&lt;<span class="i">CimInstance</span>&gt; <span id="r94 rd" class="r94 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">CreateInstanceAsync</span>(<span class="r92 r">namespaceName</span>, <span class="r93 r">instance</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <span class="i">ConsumeCimInstanceAsync</span>(<span class="r94 r">asyncResult</span>, <b>new</b> <span class="t">CimResultContext</span>(<span class="r93 r">instance</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Delete a cim instance asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">instance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="ef041d125cf1fd17" href="R/ef041d125cf1fd17.html" target="n" data-glyph="72,1" class="i method">DeleteInstanceAsync</a>(<b>string</b> <span id="r95 rd" class="r95 r">namespaceName</span>, <span class="i">CimInstance</span> <span id="r96 rd" class="r96 r">instance</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r96 r">instance</span> != <b>null</b>, <span class="s">&quot;Caller should verify that instance != NULL.&quot;</span>);
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;namespace = {0}; classname = {1};&quot;</span>, 0, <span class="r95 r">namespaceName</span>, <span class="r96 r">instance</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <span class="r96 r">instance</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameDeleteInstance</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r95 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;instance&quot;</span>, <span class="r96 r">instance</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
            <span class="i">CimAsyncStatus</span> <span id="r97 rd" class="r97 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">DeleteInstanceAsync</span>(<span class="r95 r">namespaceName</span>, <span class="r96 r">instance</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <span class="i">ConsumeObjectAsync</span>(<span class="r97 r">asyncResult</span>, <b>new</b> <span class="t">CimResultContext</span>(<span class="r96 r">instance</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get cim instance asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">instanceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="3472750fbb776935" href="R/3472750fbb776935.html" target="n" data-glyph="72,1" class="i method">GetInstanceAsync</a>(<b>string</b> <span id="r98 rd" class="r98 r">namespaceName</span>, <span class="i">CimInstance</span> <span id="r99 rd" class="r99 r">instance</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r99 r">instance</span> != <b>null</b>, <span class="s">&quot;Caller should verify that instance != NULL.&quot;</span>);
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;namespace = {0}; classname = {1}; keyonly = {2}&quot;</span>, 0, <span class="r98 r">namespaceName</span>, <span class="r99 r">instance</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">KeysOnly</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <span class="r99 r">instance</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameGetInstance</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r98 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;instance&quot;</span>, <span class="r99 r">instance</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
            <span class="i">CimAsyncResult</span>&lt;<span class="i">CimInstance</span>&gt; <span id="r100 rd" class="r100 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">GetInstanceAsync</span>(<span class="r98 r">namespaceName</span>, <span class="r99 r">instance</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <span class="i">ConsumeCimInstanceAsync</span>(<span class="r100 r">asyncResult</span>, <b>new</b> <span class="t">CimResultContext</span>(<span class="r99 r">instance</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Modify cim instance asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">instance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="5c1a94d005dccc31" href="R/5c1a94d005dccc31.html" target="n" data-glyph="72,1" class="i method">ModifyInstanceAsync</a>(<b>string</b> <span id="r101 rd" class="r101 r">namespaceName</span>, <span class="i">CimInstance</span> <span id="r102 rd" class="r102 r">instance</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r102 r">instance</span> != <b>null</b>, <span class="s">&quot;Caller should verify that instance != NULL.&quot;</span>);
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;namespace = {0}; classname = {1}&quot;</span>, 0, <span class="r101 r">namespaceName</span>, <span class="r102 r">instance</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <span class="r102 r">instance</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameModifyInstance</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r101 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;instance&quot;</span>, <span class="r102 r">instance</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
            <span class="i">CimAsyncResult</span>&lt;<span class="i">CimInstance</span>&gt; <span id="r103 rd" class="r103 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">ModifyInstanceAsync</span>(<span class="r101 r">namespaceName</span>, <span class="r102 r">instance</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <span class="i">ConsumeObjectAsync</span>(<span class="r103 r">asyncResult</span>, <b>new</b> <span class="t">CimResultContext</span>(<span class="r102 r">instance</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enumerate cim instance associated with the</span>
        <span class="c">///</span><span class="c"> given instance asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">sourceInstance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">associationClassName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r107 r">resultClassName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">sourceRole</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r109 r">resultRole</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="add4447b7970893c" href="R/add4447b7970893c.html" target="n" data-glyph="72,1" class="i method">EnumerateAssociatedInstancesAsync</a>(
            <b>string</b> <span id="r104 rd" class="r104 r">namespaceName</span>,
            <span class="i">CimInstance</span> <span id="r105 rd" class="r105 r">sourceInstance</span>,
            <b>string</b> <span id="r106 rd" class="r106 r">associationClassName</span>,
            <b>string</b> <span id="r107 rd" class="r107 r">resultClassName</span>,
            <b>string</b> <span id="r108 rd" class="r108 r">sourceRole</span>,
            <b>string</b> <span id="r109 rd" class="r109 r">resultRole</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r105 r">sourceInstance</span> != <b>null</b>, <span class="s">&quot;Caller should verify that sourceInstance != NULL.&quot;</span>);
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;Instance class {0}, association class {1}&quot;</span>, 0, <span class="r105 r">sourceInstance</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>, <span class="r106 r">associationClassName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <span class="r105 r">sourceInstance</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameEnumerateAssociatedInstances</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r104 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;sourceInstance&quot;</span>, <span class="r105 r">sourceInstance</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;associationClassName&quot;</span>, <span class="r106 r">associationClassName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;resultClassName&quot;</span>, <span class="r107 r">resultClassName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;sourceRole&quot;</span>, <span class="r108 r">sourceRole</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;resultRole&quot;</span>, <span class="r109 r">resultRole</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
            <span class="i">CimAsyncMultipleResults</span>&lt;<span class="i">CimInstance</span>&gt; <span id="r110 rd" class="r110 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">EnumerateAssociatedInstancesAsync</span>(<span class="r104 r">namespaceName</span>, <span class="r105 r">sourceInstance</span>, <span class="r106 r">associationClassName</span>, <span class="r107 r">resultClassName</span>, <span class="r108 r">sourceRole</span>, <span class="r109 r">resultRole</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <span class="i">ConsumeCimInstanceAsync</span>(<span class="r110 r">asyncResult</span>, <b>new</b> <span class="t">CimResultContext</span>(<span class="r105 r">sourceInstance</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enumerate cim instance asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">className</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="dfdc5af678cb6373" href="R/dfdc5af678cb6373.html" target="n" data-glyph="72,1" class="i method">EnumerateInstancesAsync</a>(<b>string</b> <span id="r111 rd" class="r111 r">namespaceName</span>, <b>string</b> <span id="r112 rd" class="r112 r">className</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;KeyOnly {0}&quot;</span>, 0, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">KeysOnly</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <b>null</b>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameEnumerateInstances</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r111 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;className&quot;</span>, <span class="r112 r">className</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
            <span class="i">CimAsyncMultipleResults</span>&lt;<span class="i">CimInstance</span>&gt; <span id="r113 rd" class="r113 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">EnumerateInstancesAsync</span>(<span class="r111 r">namespaceName</span>, <span class="r112 r">className</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <b>string</b> <span id="r114 rd" class="r114 r">errorSource</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="s">&quot;{0}:{1}&quot;</span>, <span class="r111 r">namespaceName</span>, <span class="r112 r">className</span>);
            <span class="i">ConsumeCimInstanceAsync</span>(<span class="r113 r">asyncResult</span>, <b>new</b> <a href="CimResultObserver.cs.html#09cac1fc01eba3f2" class="t constructor">CimResultContext</a>(<span class="r114 r">errorSource</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enumerate referencing instance associated with</span>
        <span class="c">///</span><span class="c"> the given instance asynchronously</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r115 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r116 r">sourceInstance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">associationClassName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">sourceRole</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="f8b36a0298a1d697" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EnumerateReferencingInstancesAsync</a>(
            <b>string</b> <span id="r115 rd" class="r115 r">namespaceName</span>,
            <span class="i">CimInstance</span> <span id="r116 rd" class="r116 r">sourceInstance</span>,
            <b>string</b> <span id="r117 rd" class="r117 r">associationClassName</span>,
            <b>string</b> <span id="r118 rd" class="r118 r">sourceRole</span>)
        {
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Query cim instance asynchronously</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r119 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r120 r">queryDialect</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r121 r">queryExpression</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="1e62f49e5051c03e" href="R/1e62f49e5051c03e.html" target="n" data-glyph="72,1" class="i method">QueryInstancesAsync</a>(
            <b>string</b> <span id="r119 rd" class="r119 r">namespaceName</span>,
            <b>string</b> <span id="r120 rd" class="r120 r">queryDialect</span>,
            <b>string</b> <span id="r121 rd" class="r121 r">queryExpression</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;KeyOnly = {0}&quot;</span>, 0, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">KeysOnly</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <b>null</b>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameQueryInstances</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r119 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;queryDialect&quot;</span>, <span class="r120 r">queryDialect</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;queryExpression&quot;</span>, <span class="r121 r">queryExpression</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
            <span class="i">CimAsyncMultipleResults</span>&lt;<span class="i">CimInstance</span>&gt; <span id="r122 rd" class="r122 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">QueryInstancesAsync</span>(<span class="r119 r">namespaceName</span>, <span class="r120 r">queryDialect</span>, <span class="r121 r">queryExpression</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <span class="i">ConsumeCimInstanceAsync</span>(<span class="r122 r">asyncResult</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enumerate cim class asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r123 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">className</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="97a81a4dcb89e6e2" href="R/97a81a4dcb89e6e2.html" target="n" data-glyph="72,1" class="i method">EnumerateClassesAsync</a>(<b>string</b> <span id="r123 rd" class="r123 r">namespaceName</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;namespace {0}&quot;</span>, 0, <span class="r123 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <b>null</b>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameEnumerateClasses</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r123 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
            <span class="i">CimAsyncMultipleResults</span>&lt;<span class="i">CimClass</span>&gt; <span id="r124 rd" class="r124 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">EnumerateClassesAsync</span>(<span class="r123 r">namespaceName</span>, <b>null</b>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <span class="i">ConsumeCimClassAsync</span>(<span class="r124 r">asyncResult</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enumerate cim class asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r125 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r126 r">className</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="58de08903bf2c304" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EnumerateClassesAsync</a>(<b>string</b> <span id="r125 rd" class="r125 r">namespaceName</span>, <b>string</b> <span id="r126 rd" class="r126 r">className</span>)
        {
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <b>null</b>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameEnumerateClasses</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r125 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;className&quot;</span>, <span class="r126 r">className</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
            <span class="i">CimAsyncMultipleResults</span>&lt;<span class="i">CimClass</span>&gt; <span id="r127 rd" class="r127 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">EnumerateClassesAsync</span>(<span class="r125 r">namespaceName</span>, <span class="r126 r">className</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <b>string</b> <span id="r128 rd" class="r128 r">errorSource</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="s">&quot;{0}:{1}&quot;</span>, <span class="r125 r">namespaceName</span>, <span class="r126 r">className</span>);
            <span class="i">ConsumeCimClassAsync</span>(<span class="r127 r">asyncResult</span>, <b>new</b> <a href="CimResultObserver.cs.html#09cac1fc01eba3f2" class="t constructor">CimResultContext</a>(<span class="r128 r">errorSource</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get cim class asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r129 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r130 r">className</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="57969678a16d4282" href="R/57969678a16d4282.html" target="n" data-glyph="72,1" class="i method">GetClassAsync</a>(<b>string</b> <span id="r129 rd" class="r129 r">namespaceName</span>, <b>string</b> <span id="r130 rd" class="r130 r">className</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;namespace = {0}, className = {1}&quot;</span>, 0, <span class="r129 r">namespaceName</span>, <span class="r130 r">className</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <b>null</b>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameGetClass</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r129 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;className&quot;</span>, <span class="r130 r">className</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
            <span class="i">CimAsyncResult</span>&lt;<span class="i">CimClass</span>&gt; <span id="r131 rd" class="r131 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">GetClassAsync</span>(<span class="r129 r">namespaceName</span>, <span class="r130 r">className</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <b>string</b> <span id="r132 rd" class="r132 r">errorSource</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="s">&quot;{0}:{1}&quot;</span>, <span class="r129 r">namespaceName</span>, <span class="r130 r">className</span>);
            <span class="i">ConsumeCimClassAsync</span>(<span class="r131 r">asyncResult</span>, <b>new</b> <a href="CimResultObserver.cs.html#09cac1fc01eba3f2" class="t constructor">CimResultContext</a>(<span class="r132 r">errorSource</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoke method of a given cim instance asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r133 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r134 r">instance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r135 r">methodName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">methodParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="6ba81b9742d6faa8" href="R/6ba81b9742d6faa8.html" target="n" data-glyph="72,1" class="i method">InvokeMethodAsync</a>(
            <b>string</b> <span id="r133 rd" class="r133 r">namespaceName</span>,
            <span class="i">CimInstance</span> <span id="r134 rd" class="r134 r">instance</span>,
            <b>string</b> <span id="r135 rd" class="r135 r">methodName</span>,
            <span class="i">CimMethodParametersCollection</span> <span id="r136 rd" class="r136 r">methodParameters</span>)
        {
            <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r134 r">instance</span> != <b>null</b>, <span class="s">&quot;Caller should verify that instance != NULL.&quot;</span>);
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;EnableMethodResultStreaming = {0}&quot;</span>, 0, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">EnableMethodResultStreaming</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <span class="r134 r">instance</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameInvokeMethod</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r133 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;instance&quot;</span>, <span class="r134 r">instance</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;methodName&quot;</span>, <span class="r135 r">methodName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
            <span class="i">CimAsyncMultipleResults</span>&lt;<span class="i">CimMethodResultBase</span>&gt; <span id="r137 rd" class="r137 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">InvokeMethodAsync</span>(<span class="r133 r">namespaceName</span>, <span class="r134 r">instance</span>, <span class="r135 r">methodName</span>, <span class="r136 r">methodParameters</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <span class="i">ConsumeCimInvokeMethodResultAsync</span>(<span class="r137 r">asyncResult</span>, <span class="r134 r">instance</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>, <span class="r135 r">methodName</span>, <b>new</b> <span class="t">CimResultContext</span>(<span class="r134 r">instance</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invoke static method of a given class asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r138 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r139 r">className</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">methodName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">methodParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="a06fc767780a887c" href="R/a06fc767780a887c.html" target="n" data-glyph="72,1" class="i method">InvokeMethodAsync</a>(
            <b>string</b> <span id="r138 rd" class="r138 r">namespaceName</span>,
            <b>string</b> <span id="r139 rd" class="r139 r">className</span>,
            <b>string</b> <span id="r140 rd" class="r140 r">methodName</span>,
            <span class="i">CimMethodParametersCollection</span> <span id="r141 rd" class="r141 r">methodParameters</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;EnableMethodResultStreaming = {0}&quot;</span>, 0, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">EnableMethodResultStreaming</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <b>null</b>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameInvokeMethod</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r138 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;className&quot;</span>, <span class="r139 r">className</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;methodName&quot;</span>, <span class="r140 r">methodName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
            <span class="i">CimAsyncMultipleResults</span>&lt;<span class="i">CimMethodResultBase</span>&gt; <span id="r142 rd" class="r142 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">InvokeMethodAsync</span>(<span class="r138 r">namespaceName</span>, <span class="r139 r">className</span>, <span class="r140 r">methodName</span>, <span class="r141 r">methodParameters</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <b>string</b> <span id="r143 rd" class="r143 r">errorSource</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="s">&quot;{0}:{1}&quot;</span>, <span class="r138 r">namespaceName</span>, <span class="r139 r">className</span>);
            <span class="i">ConsumeCimInvokeMethodResultAsync</span>(<span class="r142 r">asyncResult</span>, <span class="r139 r">className</span>, <span class="r140 r">methodName</span>, <b>new</b> <a href="CimResultObserver.cs.html#09cac1fc01eba3f2" class="t constructor">CimResultContext</a>(<span class="r143 r">errorSource</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Subscribe to cim indication asynchronously</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r144 r">namespaceName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r145 r">queryDialect</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r146 r">queryExpression</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="bc21511d5872f3b2" href="R/bc21511d5872f3b2.html" target="n" data-glyph="72,1" class="i method">SubscribeAsync</a>(
            <b>string</b> <span id="r144 rd" class="r144 r">namespaceName</span>,
            <b>string</b> <span id="r145 rd" class="r145 r">queryDialect</span>,
            <b>string</b> <span id="r146 rd" class="r146 r">queryExpression</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;QueryDialect = &#39;{0}&#39;; queryExpression = &#39;{1}&#39;&quot;</span>, 0, <span class="r145 r">queryDialect</span>, <span class="r146 r">queryExpression</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <b>null</b>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a> = <span class="i">CimCmdletStrings</span>.<span class="i">CimOperationNameSubscribeIndication</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Clear</span>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;namespaceName&quot;</span>, <span class="r144 r">namespaceName</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;queryDialect&quot;</span>, <span class="r145 r">queryDialect</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>.<span class="i">Add</span>(<span class="s">@&quot;queryExpression&quot;</span>, <span class="r146 r">queryExpression</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#49f2814fdb41f27e" class="i method">WriteOperationStartMessage</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3ac75ad161e764da" class="i field">operationName</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#d2ce1532016e4708" class="i field">operationParameters</a>);
 
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">Flags</span> |= <span class="i">CimOperationFlags</span>.<span class="i">ReportOperationStarted</span>;
            <span class="i">CimAsyncMultipleResults</span>&lt;<span class="i">CimSubscriptionResult</span>&gt; <span id="r147 rd" class="r147 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">SubscribeAsync</span>(<span class="r144 r">namespaceName</span>, <span class="r145 r">queryDialect</span>, <span class="r146 r">queryExpression</span>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>);
            <span class="i">ConsumeCimSubscriptionResultAsync</span>(<span class="r147 r">asyncResult</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Test connection asynchronously</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="44fe19d02bb6a902" href="R/44fe19d02bb6a902.html" target="n" data-glyph="72,1" class="i method">TestConnectionAsync</a>()
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#b52a9a49322f0296" class="i method">WriteLogEx</a>(<span class="s">&quot;Start test connection&quot;</span>, 0);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#485ff620c2f0820f" class="i method">CheckAvailability</a>();
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16b29a32410f3ff5" class="i property">TargetCimInstance</a> = <b>null</b>;
            <span class="i">CimAsyncResult</span>&lt;<span class="i">CimInstance</span>&gt; <span id="r148 rd" class="r148 r">asyncResult</span> = <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">TestConnectionAsync</span>();
            <span class="c">// ignore the test connection result objects</span>
            <span class="i">ConsumeCimInstanceAsync</span>(<span class="r148 r">asyncResult</span>, <b>true</b>, <b>null</b>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> pre action APIs
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called before new action event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r149 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual bool</b> <a id="e02fd76ed85e42cb" href="R/e02fd76ed85e42cb.html" target="n" data-glyph="75,1" class="i method">PreNewActionEvent</a>(<a href="#f9a63e977fe06b4e" class="t t">CmdletActionEventArgs</a> <span id="r149 rd" class="r149 r">args</span>)
        {
            <b>return</b> <b>true</b>;
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called before operation delete event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r150 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="73360c8b3b8847bd" href="R/73360c8b3b8847bd.html" target="n" data-glyph="75,1" class="i method">PreOperationDeleteEvent</a>(<a href="#57e1a1cbcfd66ad9" class="t t">OperationEventArgs</a> <span id="r150 rd" class="r150 r">args</span>)
        {
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> post action APIs
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after new action event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r151 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="68c9cec598073156" href="R/68c9cec598073156.html" target="n" data-glyph="75,1" class="i method">PostNewActionEvent</a>(<a href="#f9a63e977fe06b4e" class="t t">CmdletActionEventArgs</a> <span id="r151 rd" class="r151 r">args</span>)
        {
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after operation create event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r152 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="42736259183ac443" href="R/42736259183ac443.html" target="n" data-glyph="75,1" class="i method">PostOperationCreateEvent</a>(<a href="#57e1a1cbcfd66ad9" class="t t">OperationEventArgs</a> <span id="r152 rd" class="r152 r">args</span>)
        {
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after operation delete event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r153 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="65c0bad592a65e40" href="R/65c0bad592a65e40.html" target="n" data-glyph="75,1" class="i method">PostOperationDeleteEvent</a>(<a href="#57e1a1cbcfd66ad9" class="t t">OperationEventArgs</a> <span id="r153 rd" class="r153 r">args</span>)
        {
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unique operation ID</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private long</b> <a id="67a3f8900f21a514" href="R/67a3f8900f21a514.html" target="n" data-glyph="46,1" class="i field">operationID</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The CimSession object managed by this proxy object,</span>
        <span class="c">///</span><span class="c"> which is either created by constructor OR passed in by caller.</span>
        <span class="c">///</span><span class="c"> The session will be closed while disposing this proxy object</span>
        <span class="c">///</span><span class="c"> if it is created by constuctor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">CimSession</span> <a id="e539a2e015f265e8" href="R/e539a2e015f265e8.html" target="n" data-glyph="104,1" class="i property">CimSession</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The current CimInstance object, against which issued</span>
        <span class="c">///</span><span class="c"> current operation, it could be null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">CimInstance</span> <a id="16b29a32410f3ff5" href="R/16b29a32410f3ff5.html" target="n" data-glyph="104,1" class="i property">TargetCimInstance</a> { <b>get</b>; <b>private set</b>; }
 
        <b>internal bool</b> <a id="9a99349f40e4a339" href="R/9a99349f40e4a339.html" target="n" data-glyph="104,1" class="i property">IsTemporaryCimSession</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The CimOperationOptions object, which specifies the options</span>
        <span class="c">///</span><span class="c"> of the operation against the session object.</span>
        <span class="c">///</span><span class="c"> Caller can control the timeout, method streaming support, and</span>
        <span class="c">///</span><span class="c"> extended ps semantics support, etc.</span>
        <span class="c">///</span><span class="c"> The setting MUST be set before start new operation on the</span>
        <span class="c">///</span><span class="c"> this proxy object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">CimOperationOptions</span> <a id="426addf15ff8857b" href="R/426addf15ff8857b.html" target="n" data-glyph="104,1" class="i property">OperationOptions</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All operations completed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="3e5398ebdb91091b" href="R/3e5398ebdb91091b.html" target="n" data-glyph="106,1" class="i property">Completed</a>
        {
            <b>get</b> { <b>return</b> <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#bdcd6d16176ee4e7" class="i field">operation</a> == <b>null</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Lock object used to lock</span>
        <span class="c">///</span><span class="c"> operation </span><span class="c">&amp;</span><span class="c"> cancelOperation members.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly object</b> <a id="a3ca1774d0643eda" href="R/a3ca1774d0643eda.html" target="n" data-glyph="46,1" class="i field">stateLock</a> = <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The operation issued by cimSession.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IObservable</span>&lt;<b>object</b>&gt; <a id="bdcd6d16176ee4e7" href="R/bdcd6d16176ee4e7.html" target="n" data-glyph="46,1" class="i field">operation</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The current operation name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="3ac75ad161e764da" href="R/3ac75ad161e764da.html" target="n" data-glyph="46,1" class="i field">operationName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The current operation parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Hashtable</span> <a id="d2ce1532016e4708" href="R/d2ce1532016e4708.html" target="n" data-glyph="46,1" class="i field">operationParameters</a> = <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handler used to cancel operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IDisposable</span> <a id="b08570f60c22bc05" href="R/b08570f60c22bc05.html" target="n" data-glyph="46,1" class="i field">_cancelOperation</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CancelOperation disposed flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private int</b> <a id="16f91854f7010daa" href="R/16f91854f7010daa.html" target="n" data-glyph="46,1" class="i field">_cancelOperationDisposed</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose the cancel operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="2ccbc0d218a6d13a" href="R/2ccbc0d218a6d13a.html" target="n" data-glyph="76,1" class="i method">DisposeCancelOperation</a>()
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;CancelOperation Disposed = {0}&quot;</span>, 0, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16f91854f7010daa" class="i field">_cancelOperationDisposed</a>);
            <b>if</b> (<span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16f91854f7010daa" class="i field">_cancelOperationDisposed</a>, 1, 0) == 0)
            {
                <b>if</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#b08570f60c22bc05" class="i field">_cancelOperation</a> != <b>null</b>)
                {
                    <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#4021e88828f2c984" class="i method">WriteLog</a>(<span class="s">&quot;CimSessionProxy::Dispose async operation.&quot;</span>, 4);
                    <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#b08570f60c22bc05" class="i field">_cancelOperation</a>.<span class="i">Dispose</span>();
                    <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#b08570f60c22bc05" class="i field">_cancelOperation</a> = <b>null</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set the cancel operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IDisposable</span> <a id="c4e03841cce08d67" href="R/c4e03841cce08d67.html" target="n" data-glyph="106,1" class="i property">CancelOperation</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#b08570f60c22bc05" class="i field">_cancelOperation</a>;
            }
 
            <b>set</b>
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#b08570f60c22bc05" class="i field">_cancelOperation</a> = <b>value</b>;
                <span class="i">Interlocked</span>.<span class="i">Exchange</span>(<b>ref</b> <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#16f91854f7010daa" class="i field">_cancelOperationDisposed</a>, 0);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Current protocol name</span>
        <span class="c">///</span><span class="c"> DCOM or WSMAN.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="NewCimSessionOptionCommand.cs.html#0e497fefee80122f" class="t t">ProtocolType</a> <a id="56a3d42ced450d15" href="R/56a3d42ced450d15.html" target="n" data-glyph="104,1" class="i property">Protocol</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cross operation context object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#a3ed284ba44f69ec" class="t t">XOperationContextBase</a> <a id="b1453253349bbaff" href="R/b1453253349bbaff.html" target="n" data-glyph="104,1" class="i property">ContextObject</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invocation context object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#32d328f526694471" class="t t">InvocationContext</a> <a id="4e080b7764a9d7da" href="R/4e080b7764a9d7da.html" target="n" data-glyph="46,1" class="i field">invocationContextObject</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A preprocess object to pre-processing the result object,</span>
        <span class="c">///</span><span class="c"> for example, adding PSTypeName, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#ed7e09bec2263c9a" class="t t">IObjectPreProcess</a> <a id="a0187330a5f4f78e" href="R/a0187330a5f4f78e.html" target="n" data-glyph="104,1" class="i property">ObjectPreProcess</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#452a12a26d493916" class="i field">isDefaultSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">langword</span><span class="c">=</span><span class="c">&quot;</span><span class="c">true</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if this </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> was</span>
        <span class="c">///</span><span class="c"> created to handle the &quot;default&quot; session, in cases where cmdlets are invoked without</span>
        <span class="c">///</span><span class="c"> ComputerName and/or CimSession parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly bool</b> <a id="452a12a26d493916" href="R/452a12a26d493916.html" target="n" data-glyph="46,1" class="i field">isDefaultSession</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IDisposable interface.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private int</b> <a id="c708ee3409180f7f" href="R/c708ee3409180f7f.html" target="n" data-glyph="46,1" class="i field">_disposed</a>;
 
        <span class="c">// Implement IDisposable.</span>
        <span class="c">// Do not make this method virtual.</span>
        <span class="c">// A derived class should not be able to override this method.</span>
        <b>public void</b> <a id="eb54fde44cdb1537" href="R/eb54fde44cdb1537.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#87171d242e692082" class="i method">Dispose</a>(<b>true</b>);
            <span class="c">// This object will be cleaned up by the Dispose method.</span>
            <span class="c">// Therefore, you should call GC.SuppressFinalize to</span>
            <span class="c">// take this object off the finalization queue</span>
            <span class="c">// and prevent finalization code for this object</span>
            <span class="c">// from executing a second time.</span>
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#64da31a8ef7908ad" class="k">this</a>);
        }
 
        <span class="c">// Dispose(bool disposing) executes in two distinct scenarios.</span>
        <span class="c">// If disposing equals true, the method has been called directly</span>
        <span class="c">// or indirectly by a user&#39;s code. Managed and unmanaged resources</span>
        <span class="c">// can be disposed.</span>
        <span class="c">// If disposing equals false, the method has been called by the</span>
        <span class="c">// runtime from inside the finalizer and you should not reference</span>
        <span class="c">// other objects. Only unmanaged resources can be disposed.</span>
        <b>protected virtual void</b> <a id="87171d242e692082" href="R/87171d242e692082.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r154 rd" class="r154 r">disposing</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;Disposed = {0}&quot;</span>, 0, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#f4973394068f65eb" class="i property">IsDisposed</a>);
 
            <b>if</b> (<span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c708ee3409180f7f" class="i field">_disposed</a>, 1, 0) == 0)
            {
                <b>if</b> (<span class="r154 r">disposing</span>)
                {
                    <span class="c">// Dispose managed resources.</span>
                    <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#2ccbc0d218a6d13a" class="i method">DisposeCancelOperation</a>();
 
                    <b>if</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a> != <b>null</b>)
                    {
                        <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">Dispose</span>();
                        <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a> = <b>null</b>;
                    }
 
                    <a href="#88162b86b0d6192c" class="i method">DisposeTemporaryCimSession</a>();
                }
            }
        }
 
        <b>public bool</b> <a id="f4973394068f65eb" href="R/f4973394068f65eb.html" target="n" data-glyph="102,1" class="i property">IsDisposed</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c708ee3409180f7f" class="i field">_disposed</a> == 1;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose temporary </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e539a2e015f265e8" class="i property">CimSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="88162b86b0d6192c" href="R/88162b86b0d6192c.html" target="n" data-glyph="76,1" class="i method">DisposeTemporaryCimSession</a>()
        {
            <b>if</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#9a99349f40e4a339" class="i property">IsTemporaryCimSession</a> &amp;&amp; <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a> != <b>null</b>)
            {
                <span class="c">// remove the cimsession from temporary cache</span>
                <a href="#ec3fb2154a6a95d3" class="i method">RemoveCimSessionFromTemporaryCache</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>);
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#9a99349f40e4a339" class="i property">IsTemporaryCimSession</a> = <b>false</b>;
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a> = <b>null</b>;
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> helper methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Consume the results of async operations</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r155 r">asyncResult</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r156 r">cimResultContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="ba8fb30ff43378e4" href="R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ConsumeCimInstanceAsync</a>(<span class="i">IObservable</span>&lt;<span class="i">CimInstance</span>&gt; <span id="r155 rd" class="r155 r">asyncResult</span>,
            <a href="CimResultObserver.cs.html#937936924a4ff7f7" class="t t">CimResultContext</a> <span id="r156 rd" class="r156 r">cimResultContext</span>)
        {
            <a href="#987c111e5f826c48" class="i method">ConsumeCimInstanceAsync</a>(<span class="r155 r">asyncResult</span>, <b>false</b>, <span class="r156 r">cimResultContext</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Consume the CimInstance results of async operations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r157 r">asyncResult</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r158 r">ignoreResultObjects</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r159 r">cimResultContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="987c111e5f826c48" href="R/987c111e5f826c48.html" target="n" data-glyph="75,1" class="i method">ConsumeCimInstanceAsync</a>(
            <span class="i">IObservable</span>&lt;<span class="i">CimInstance</span>&gt; <span id="r157 rd" class="r157 r">asyncResult</span>,
            <b>bool</b> <span id="r158 rd" class="r158 r">ignoreResultObjects</span>,
            <a href="CimResultObserver.cs.html#937936924a4ff7f7" class="t t">CimResultContext</a> <span id="r159 rd" class="r159 r">cimResultContext</span>)
        {
            <a href="CimResultObserver.cs.html#134d59fecee2c1fb" class="t t">CimResultObserver</a>&lt;<span class="i">CimInstance</span>&gt; <span id="r160 rd" class="r160 r">observer</span>;
            <b>if</b> (<span class="r158 r">ignoreResultObjects</span>)
            {
                <span class="r160 r">observer</span> = <b>new</b> <span class="t">IgnoreResultObserver</span>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>, <span class="r157 r">asyncResult</span>);
            }
            <b>else</b>
            {
                <span class="r160 r">observer</span> = <b>new</b> <span class="t">CimResultObserver</span>&lt;<span class="i">CimInstance</span>&gt;(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>, <span class="r157 r">asyncResult</span>, <span class="r159 r">cimResultContext</span>);
            }
 
            <span class="r160 r">observer</span>.<a href="CimResultObserver.cs.html#925d373fd978cd97" class="i">OnNewResult</a> += <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">ResultEventHandler</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#67a3f8900f21a514" class="i field">operationID</a> = <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <a href="#e91fe5a70a578ba6" class="i field">gOperationCounter</a>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">AddOperation</span>(<span class="r157 r">asyncResult</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c4e03841cce08d67" class="i property">CancelOperation</a> = <span class="r157 r">asyncResult</span>.<span class="i">Subscribe</span>(<span class="r160 r">observer</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">FireOperationCreatedEvent</span>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c4e03841cce08d67" class="i property">CancelOperation</a>, <span class="r157 r">asyncResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Consume the results of async operations</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r161 r">asyncResult</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r162 r">cimResultContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="a2b1328fd420338f" href="R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ConsumeObjectAsync</a>(<span class="i">IObservable</span>&lt;<b>object</b>&gt; <span id="r161 rd" class="r161 r">asyncResult</span>,
            <a href="CimResultObserver.cs.html#937936924a4ff7f7" class="t t">CimResultContext</a> <span id="r162 rd" class="r162 r">cimResultContext</span>)
        {
            <a href="CimResultObserver.cs.html#134d59fecee2c1fb" class="t t">CimResultObserver</a>&lt;<b>object</b>&gt; <span id="r163 rd" class="r163 r">observer</span> = <b>new</b>(
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>, <span class="r161 r">asyncResult</span>, <span class="r162 r">cimResultContext</span>);
 
            <span class="r163 r">observer</span>.<a href="CimResultObserver.cs.html#925d373fd978cd97" class="i">OnNewResult</a> += <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">ResultEventHandler</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#67a3f8900f21a514" class="i field">operationID</a> = <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <a href="#e91fe5a70a578ba6" class="i field">gOperationCounter</a>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#0f1acb8988caf8c0" class="i method">AddOperation</a>(<span class="r161 r">asyncResult</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c4e03841cce08d67" class="i property">CancelOperation</a> = <span class="r161 r">asyncResult</span>.<span class="i">Subscribe</span>(<span class="r163 r">observer</span>);
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#3f92c51cd9afbf2a" class="i method">WriteLog</a>(<span class="s">&quot;FireOperationCreatedEvent&quot;</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#dd8a5090e81fec49" class="i method">FireOperationCreatedEvent</a>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c4e03841cce08d67" class="i property">CancelOperation</a>, <span class="r161 r">asyncResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Consume the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimClass</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> of async operations</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r164 r">asyncResult</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r165 r">cimResultContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="7666dbda9b9f501e" href="R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ConsumeCimClassAsync</a>(<span class="i">IObservable</span>&lt;<span class="i">CimClass</span>&gt; <span id="r164 rd" class="r164 r">asyncResult</span>,
            <a href="CimResultObserver.cs.html#937936924a4ff7f7" class="t t">CimResultContext</a> <span id="r165 rd" class="r165 r">cimResultContext</span>)
        {
            <a href="CimResultObserver.cs.html#134d59fecee2c1fb" class="t t">CimResultObserver</a>&lt;<span class="i">CimClass</span>&gt; <span id="r166 rd" class="r166 r">observer</span> = <b>new</b>(
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>, <span class="r164 r">asyncResult</span>, <span class="r165 r">cimResultContext</span>);
 
            <span class="r166 r">observer</span>.<a href="CimResultObserver.cs.html#925d373fd978cd97" class="i">OnNewResult</a> += <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">ResultEventHandler</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#67a3f8900f21a514" class="i field">operationID</a> = <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <a href="#e91fe5a70a578ba6" class="i field">gOperationCounter</a>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">AddOperation</span>(<span class="r164 r">asyncResult</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c4e03841cce08d67" class="i property">CancelOperation</a> = <span class="r164 r">asyncResult</span>.<span class="i">Subscribe</span>(<span class="r166 r">observer</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">FireOperationCreatedEvent</span>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c4e03841cce08d67" class="i property">CancelOperation</a>, <span class="r164 r">asyncResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Consume the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSubscriptionResult</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> of async operations</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r167 r">asyncResult</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r168 r">cimResultContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="ca7cbc739df15cbb" href="R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ConsumeCimSubscriptionResultAsync</a>(
            <span class="i">IObservable</span>&lt;<span class="i">CimSubscriptionResult</span>&gt; <span id="r167 rd" class="r167 r">asyncResult</span>,
            <a href="CimResultObserver.cs.html#937936924a4ff7f7" class="t t">CimResultContext</a> <span id="r168 rd" class="r168 r">cimResultContext</span>)
        {
            <a href="CimResultObserver.cs.html#82d98b54a99a8db7" class="t t">CimSubscriptionResultObserver</a> <span id="r169 rd" class="r169 r">observer</span> = <b>new</b>(
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>, <span class="r167 r">asyncResult</span>, <span class="r168 r">cimResultContext</span>);
            <span class="r169 r">observer</span>.<a href="CimResultObserver.cs.html#925d373fd978cd97" class="i">OnNewResult</a> += <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">ResultEventHandler</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#67a3f8900f21a514" class="i field">operationID</a> = <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <a href="#e91fe5a70a578ba6" class="i field">gOperationCounter</a>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">AddOperation</span>(<span class="r167 r">asyncResult</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c4e03841cce08d67" class="i property">CancelOperation</a> = <span class="r167 r">asyncResult</span>.<span class="i">Subscribe</span>(<span class="r169 r">observer</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">FireOperationCreatedEvent</span>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c4e03841cce08d67" class="i property">CancelOperation</a>, <span class="r167 r">asyncResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Consume the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimMethodResultBase</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> of async operations</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r170 r">asyncResult</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r171 r">className</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r172 r">methodName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r173 r">cimResultContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="3621dbf90a712105" href="R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ConsumeCimInvokeMethodResultAsync</a>(
            <span class="i">IObservable</span>&lt;<span class="i">CimMethodResultBase</span>&gt; <span id="r170 rd" class="r170 r">asyncResult</span>,
            <b>string</b> <span id="r171 rd" class="r171 r">className</span>,
            <b>string</b> <span id="r172 rd" class="r172 r">methodName</span>,
            <a href="CimResultObserver.cs.html#937936924a4ff7f7" class="t t">CimResultContext</a> <span id="r173 rd" class="r173 r">cimResultContext</span>)
        {
            <a href="CimResultObserver.cs.html#6a5c21cb0a2a4da3" class="t t">CimMethodResultObserver</a> <span id="r174 rd" class="r174 r">observer</span> = <b>new</b>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>, <span class="r170 r">asyncResult</span>, <span class="r173 r">cimResultContext</span>)
            {
                <a href="CimResultObserver.cs.html#7844be32bd7900df" class="i property">ClassName</a> = <span class="r171 r">className</span>,
                <a href="CimResultObserver.cs.html#cc1b494aefa1d8cf" class="i property">MethodName</a> = <span class="r172 r">methodName</span>
            };
 
            <span class="r174 r">observer</span>.<a href="CimResultObserver.cs.html#925d373fd978cd97" class="i">OnNewResult</a> += <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">ResultEventHandler</span>;
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#67a3f8900f21a514" class="i field">operationID</a> = <span class="i">Interlocked</span>.<span class="i">Increment</span>(<b>ref</b> <a href="#e91fe5a70a578ba6" class="i field">gOperationCounter</a>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">AddOperation</span>(<span class="r170 r">asyncResult</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c4e03841cce08d67" class="i property">CancelOperation</a> = <span class="r170 r">asyncResult</span>.<span class="i">Subscribe</span>(<span class="r174 r">observer</span>);
            <a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">FireOperationCreatedEvent</span>(<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#c4e03841cce08d67" class="i property">CancelOperation</a>, <span class="r170 r">asyncResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check whether current proxy object is available</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="485ff620c2f0820f" href="R/485ff620c2f0820f.html" target="n" data-glyph="76,1" class="i method">CheckAvailability</a>()
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <a href="#fac47d13f994e12d" class="i method">AssertSession</a>();
            <b>lock</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#a3ca1774d0643eda" class="i field">stateLock</a>)
            {
                <b>if</b> (!<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#3e5398ebdb91091b" class="i property">Completed</a>)
                {
                    <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">CimCmdletStrings</span>.<span class="i">OperationInProgress</span>);
                }
            }
 
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<span class="s">&quot;KeyOnly {0},&quot;</span>, 1, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#426addf15ff8857b" class="i property">OperationOptions</a>.<span class="i">KeysOnly</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check the wrapped </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e539a2e015f265e8" class="i property">CimSession</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="fac47d13f994e12d" href="R/fac47d13f994e12d.html" target="n" data-glyph="76,1" class="i method">AssertSession</a>()
        {
            <b>if</b> (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#f4973394068f65eb" class="i property">IsDisposed</a> || (<a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a> == <b>null</b>))
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;Invalid CimSessionProxy object, disposed? {0}; session object {1}&quot;</span>, 1, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#f4973394068f65eb" class="i property">IsDisposed</a>, <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>);
                <b>throw</b> <b>new</b> <span class="i">ObjectDisposedException</span>(<a href="#64da31a8ef7908ad" class="k">this</a>.<span class="i">ToString</span>());
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSessionOptions</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> based on the given computerName</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">CimSession</span> <a id="15e6c71cb6f3db6f" href="R/15e6c71cb6f3db6f.html" target="n" data-glyph="76,1" class="i method">CreateCimSessionByComputerName</a>(<b>string</b> <span id="r175 rd" class="r175 r">computerName</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;ComputerName {0}&quot;</span>, 0, <span class="r175 r">computerName</span>);
 
            <span class="i">CimSessionOptions</span> <span id="r176 rd" class="r176 r">option</span> = <a href="#b725b3e51049a785" class="i method">CreateCimSessionOption</a>(<span class="r175 r">computerName</span>, 0, <b>null</b>);
            <b>if</b> (<span class="r176 r">option</span> <b>is</b> <span class="i">DComSessionOptions</span>)
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#3f92c51cd9afbf2a" class="i method">WriteLog</a>(<span class="s">&quot;Create dcom cimSession&quot;</span>);
                <a href="#64da31a8ef7908ad" class="k">this</a>.<a href="#56a3d42ced450d15" class="i property">Protocol</a> = <a href="NewCimSessionOptionCommand.cs.html#0e497fefee80122f" class="t t">ProtocolType</a>.<a href="NewCimSessionOptionCommand.cs.html#e463eb81efd84241" class="i field">Dcom</a>;
                <b>return</b> <a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">Create</span>(<a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#c7316551c0001b81" class="i field">NullComputerName</a>, <span class="r176 r">option</span>);
            }
            <b>else</b>
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#3f92c51cd9afbf2a" class="i method">WriteLog</a>(<span class="s">&quot;Create wsman cimSession&quot;</span>);
                <b>return</b> <a href="#e539a2e015f265e8" class="i property">CimSession</a>.<span class="i">Create</span>(<span class="r175 r">computerName</span>, <span class="r176 r">option</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSessionOptions</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> based on the given computerName,</span>
        <span class="c">///</span><span class="c"> timeout and credential</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r177 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r178 r">timeout</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r179 r">credential</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">CimSessionOptions</span> <a id="b725b3e51049a785" href="R/b725b3e51049a785.html" target="n" data-glyph="74,1" class="i method">CreateCimSessionOption</a>(<b>string</b> <span id="r177 rd" class="r177 r">computerName</span>,
            <b>uint</b> <span id="r178 rd" class="r178 r">timeout</span>, <span class="i">CimCredential</span> <span id="r179 rd" class="r179 r">credential</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <span class="i">CimSessionOptions</span> <span id="r180 rd" class="r180 r">option</span>;
            <b>if</b> (<a href="Utils.cs.html#10a63abaaeca162e" class="t t">ConstValue</a>.<a href="Utils.cs.html#a3fcb89282d9eaf8" class="i method">IsDefaultComputerName</a>(<span class="r177 r">computerName</span>))
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#655521cf1d3bf942" class="i method">WriteLog</a>(<span class="s">&quot;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; Use protocol DCOM  {0}&quot;</span>, 1, <span class="r177 r">computerName</span>);
                <span class="r180 r">option</span> = <b>new</b> <span class="i">DComSessionOptions</span>();
            }
            <b>else</b>
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#655521cf1d3bf942" class="i method">WriteLog</a>(<span class="s">&quot;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; Use protocol WSMAN {0}&quot;</span>, 1, <span class="r177 r">computerName</span>);
                <span class="r180 r">option</span> = <b>new</b> <span class="i">WSManSessionOptions</span>();
            }
 
            <b>if</b> (<span class="r178 r">timeout</span> != 0)
            {
                <span class="r180 r">option</span>.<span class="i">Timeout</span> = <span class="i">TimeSpan</span>.<span class="i">FromSeconds</span>((<b>double</b>)<span class="r178 r">timeout</span>);
            }
 
            <b>if</b> (<span class="r179 r">credential</span> != <b>null</b>)
            {
                <span class="r180 r">option</span>.<span class="i">AddDestinationCredentials</span>(<span class="r179 r">credential</span>);
            }
 
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;returned option :{0}.&quot;</span>, 1, <span class="r180 r">option</span>);
            <b>return</b> <span class="r180 r">option</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> class CimSessionProxyTestConnection
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Write session to pipeline after test connection success</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="9a7b277dc1c3416e" href="R/9a7b277dc1c3416e.html" target="n" data-glyph="2,0" class="t t">CimSessionProxyTestConnection</a> : <a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#9a7b277dc1c3416e" class="t t">CimSessionProxyTestConnection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given computer name</span>
        <span class="c">///</span><span class="c"> and session options.</span>
        <span class="c">///</span><span class="c"> Then create wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r181 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r182 r">sessionOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="c8bd0dfe0076fc8c" href="R/c8bd0dfe0076fc8c.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxyTestConnection</a>(<b>string</b> <span id="r181 rd" class="r181 r">computerName</span>, <span class="i">CimSessionOptions</span> <span id="r182 rd" class="r182 r">sessionOptions</span>)
            : <a href="#f77c0b00a404a593" class="k">base</a>(<span class="r181 r">computerName</span>, <span class="r182 r">sessionOptions</span>)
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> pre action APIs
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called after operation delete event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r183 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="cad4e1576d60a520" href="R/cad4e1576d60a520.html" target="n" data-glyph="75,1" class="i method">PreOperationDeleteEvent</a>(<a href="#57e1a1cbcfd66ad9" class="t t">OperationEventArgs</a> <span id="r183 rd" class="r183 r">args</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;test connection result {0}&quot;</span>, 0, <span class="r183 r">args</span>.<a href="#32f67cf0521cf92e" class="i field">success</a>);
 
            <b>if</b> (<span class="r183 r">args</span>.<a href="#32f67cf0521cf92e" class="i field">success</a>)
            {
                <span class="c">// test connection success, write session object to pipeline</span>
                <a href="CimWriteResultObject.cs.html#b7a3847402daf14e" class="t t">CimWriteResultObject</a> <span id="r184 rd" class="r184 r">result</span> = <b>new</b>(<a href="#9a7b277dc1c3416e" class="k">this</a>.<a href="#e539a2e015f265e8" class="i property">CimSession</a>, <a href="#9a7b277dc1c3416e" class="k">this</a>.<a href="#b1453253349bbaff" class="i property">ContextObject</a>);
                <a href="#9a7b277dc1c3416e" class="k">this</a>.<a href="#47e7a7e8f5f64709" class="i method">FireNewActionEvent</a>(<span class="r184 r">result</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> class CimSessionProxyGetCimClass
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Write CimClass to pipeline if the CimClass satisfied</span>
    <span class="c">///</span><span class="c"> the given conditions</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="f3aa68bfee4811ef" href="R/f3aa68bfee4811ef.html" target="n" data-glyph="2,0" class="t t">CimSessionProxyGetCimClass</a> : <a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#f3aa68bfee4811ef" class="t t">CimSessionProxyGetCimClass</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given computer name.</span>
        <span class="c">///</span><span class="c"> Then create wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r185 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="c387320ab9d96c6e" href="R/c387320ab9d96c6e.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxyGetCimClass</a>(<b>string</b> <span id="r185 rd" class="r185 r">computerName</span>)
            : <a href="#f1657d10b1a80e18" class="k">base</a>(<span class="r185 r">computerName</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#f3aa68bfee4811ef" class="t t">CimSessionProxyGetCimClass</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given computer name</span>
        <span class="c">///</span><span class="c"> and session options.</span>
        <span class="c">///</span><span class="c"> Then create wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">sessionOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="f2cb875890c54ef2" href="R/f2cb875890c54ef2.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxyGetCimClass</a>(<span class="i">CimSession</span> <span id="r186 rd" class="r186 r">session</span>)
            : <a href="#9097fe2d7684e63b" class="k">base</a>(<span class="r186 r">session</span>)
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> pre action APIs
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called before new action event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r187 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="3908043c3f7c0170" href="R/3908043c3f7c0170.html" target="n" data-glyph="75,1" class="i method">PreNewActionEvent</a>(<a href="#f9a63e977fe06b4e" class="t t">CmdletActionEventArgs</a> <span id="r187 rd" class="r187 r">args</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <b>if</b> (<span class="r187 r">args</span>.<a href="#36809e757e44acff" class="i field">Action</a> <b>is not</b> <a href="CimWriteResultObject.cs.html#b7a3847402daf14e" class="t t">CimWriteResultObject</a>)
            {
                <span class="c">// allow all other actions</span>
                <b>return</b> <b>true</b>;
            }
 
            <a href="CimWriteResultObject.cs.html#b7a3847402daf14e" class="t t">CimWriteResultObject</a> <span id="r188 rd" class="r188 r">writeResultObject</span> = <span class="r187 r">args</span>.<a href="#36809e757e44acff" class="i field">Action</a> <b>as</b> <a href="CimWriteResultObject.cs.html#b7a3847402daf14e" class="t t">CimWriteResultObject</a>;
            <b>if</b> (!(<span class="r188 r">writeResultObject</span>.<a href="CimWriteResultObject.cs.html#5001549a4e79a9c9" class="i property">Result</a> <b>is</b> <span class="i">CimClass</span> <span id="r189 rd" class="r189 r">cimClass</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<span class="s">&quot;class name = {0}&quot;</span>, 1, <span class="r189 r">cimClass</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>);
 
            <a href="CimGetCimClass.cs.html#12ab9ea6cb64caeb" class="t t">CimGetCimClassContext</a> <span id="r190 rd" class="r190 r">context</span> = <a href="#f3aa68bfee4811ef" class="k">this</a>.<a href="#b1453253349bbaff" class="i property">ContextObject</a> <b>as</b> <a href="CimGetCimClass.cs.html#12ab9ea6cb64caeb" class="t t">CimGetCimClassContext</a>;
            <span class="i">Debug</span>.<span class="i">Assert</span>(<span class="r190 r">context</span> != <b>null</b>, <span class="s">&quot;Caller should verify that CimGetCimClassContext != NULL.&quot;</span>);
 
            <a href="/System.Management.Automation/A.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r191 rd" class="r191 r">pattern</span>;
            <b>if</b> (<a href="/System.Management.Automation/A.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">ContainsWildcardCharacters</span>(<span class="r190 r">context</span>.<a href="CimGetCimClass.cs.html#b5267500535d6b2c" class="i property">ClassName</a>))
            {
                <span class="r191 r">pattern</span> = <b>new</b> <span class="t">WildcardPattern</span>(<span class="r190 r">context</span>.<a href="CimGetCimClass.cs.html#b5267500535d6b2c" class="i property">ClassName</a>, <a href="/System.Management.Automation/A.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="/System.Management.Automation/A.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                <b>if</b> (!<span class="r191 r">pattern</span>.<span class="i">IsMatch</span>(<span class="r189 r">cimClass</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>))
                {
                    <b>return</b> <b>false</b>;
                }
            }
 
            <b>if</b> (<span class="r190 r">context</span>.<a href="CimGetCimClass.cs.html#936b1ce527cd9bfa" class="i property">PropertyName</a> != <b>null</b>)
            {
                <b>bool</b> <span id="r192 rd" class="r192 r">match</span> = <b>false</b>;
                <b>if</b> (<span class="r189 r">cimClass</span>.<span class="i">CimClassProperties</span> != <b>null</b>)
                {
                    <span class="r191 r">pattern</span> = <b>new</b> <span class="t">WildcardPattern</span>(<span class="r190 r">context</span>.<a href="CimGetCimClass.cs.html#936b1ce527cd9bfa" class="i property">PropertyName</a>, <a href="/System.Management.Automation/A.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="/System.Management.Automation/A.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                    <b>foreach</b> (<span class="i">CimPropertyDeclaration</span> <span id="r193 rd" class="r193 r">decl</span> <b>in</b> <span class="r189 r">cimClass</span>.<span class="i">CimClassProperties</span>)
                    {
                        <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<span class="s">&quot;--- property name : {0}&quot;</span>, 1, <span class="r193 r">decl</span>.<span class="i">Name</span>);
                        <b>if</b> (<span class="r191 r">pattern</span>.<span class="i">IsMatch</span>(<span class="r193 r">decl</span>.<span class="i">Name</span>))
                        {
                            <span class="r192 r">match</span> = <b>true</b>;
                            <b>break</b>;
                        }
                    }
                }
 
                <b>if</b> (!<span class="r192 r">match</span>)
                {
                    <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#655521cf1d3bf942" class="i method">WriteLog</a>(<span class="s">&quot;Property name does not match: {0}&quot;</span>, 1, <span class="r190 r">context</span>.<a href="CimGetCimClass.cs.html#936b1ce527cd9bfa" class="i property">PropertyName</a>);
                    <b>return</b> <span class="r192 r">match</span>;
                }
            }
 
            <b>if</b> (<span class="r190 r">context</span>.<a href="CimGetCimClass.cs.html#c086e09be5854035" class="i property">MethodName</a> != <b>null</b>)
            {
                <b>bool</b> <span id="r194 rd" class="r194 r">match</span> = <b>false</b>;
                <b>if</b> (<span class="r189 r">cimClass</span>.<span class="i">CimClassMethods</span> != <b>null</b>)
                {
                    <span class="r191 r">pattern</span> = <b>new</b> <span class="t">WildcardPattern</span>(<span class="r190 r">context</span>.<a href="CimGetCimClass.cs.html#c086e09be5854035" class="i property">MethodName</a>, <a href="/System.Management.Automation/A.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="/System.Management.Automation/A.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                    <b>foreach</b> (<span class="i">CimMethodDeclaration</span> <span id="r195 rd" class="r195 r">decl</span> <b>in</b> <span class="r189 r">cimClass</span>.<span class="i">CimClassMethods</span>)
                    {
                        <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<span class="s">&quot;--- method name : {0}&quot;</span>, 1, <span class="r195 r">decl</span>.<span class="i">Name</span>);
                        <b>if</b> (<span class="r191 r">pattern</span>.<span class="i">IsMatch</span>(<span class="r195 r">decl</span>.<span class="i">Name</span>))
                        {
                            <span class="r194 r">match</span> = <b>true</b>;
                            <b>break</b>;
                        }
                    }
                }
 
                <b>if</b> (!<span class="r194 r">match</span>)
                {
                    <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#655521cf1d3bf942" class="i method">WriteLog</a>(<span class="s">&quot;Method name does not match: {0}&quot;</span>, 1, <span class="r190 r">context</span>.<a href="CimGetCimClass.cs.html#c086e09be5854035" class="i property">MethodName</a>);
                    <b>return</b> <span class="r194 r">match</span>;
                }
            }
 
            <b>if</b> (<span class="r190 r">context</span>.<a href="CimGetCimClass.cs.html#cedd839ecff2356f" class="i property">QualifierName</a> != <b>null</b>)
            {
                <b>bool</b> <span id="r196 rd" class="r196 r">match</span> = <b>false</b>;
                <b>if</b> (<span class="r189 r">cimClass</span>.<span class="i">CimClassQualifiers</span> != <b>null</b>)
                {
                    <span class="r191 r">pattern</span> = <b>new</b> <span class="t">WildcardPattern</span>(<span class="r190 r">context</span>.<a href="CimGetCimClass.cs.html#cedd839ecff2356f" class="i property">QualifierName</a>, <a href="/System.Management.Automation/A.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="/System.Management.Automation/A.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                    <b>foreach</b> (<span class="i">CimQualifier</span> <span id="r197 rd" class="r197 r">qualifier</span> <b>in</b> <span class="r189 r">cimClass</span>.<span class="i">CimClassQualifiers</span>)
                    {
                        <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<span class="s">&quot;--- qualifier name : {0}&quot;</span>, 1, <span class="r197 r">qualifier</span>.<span class="i">Name</span>);
                        <b>if</b> (<span class="r191 r">pattern</span>.<span class="i">IsMatch</span>(<span class="r197 r">qualifier</span>.<span class="i">Name</span>))
                        {
                            <span class="r196 r">match</span> = <b>true</b>;
                            <b>break</b>;
                        }
                    }
                }
 
                <b>if</b> (!<span class="r196 r">match</span>)
                {
                    <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#655521cf1d3bf942" class="i method">WriteLog</a>(<span class="s">&quot;Qualifier name does not match: {0}&quot;</span>, 1, <span class="r190 r">context</span>.<a href="CimGetCimClass.cs.html#cedd839ecff2356f" class="i property">QualifierName</a>);
                    <b>return</b> <span class="r196 r">match</span>;
                }
            }
 
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<span class="s">&quot;CimClass &#39;{0}&#39; is qualified.&quot;</span>, 1, <span class="r189 r">cimClass</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>);
            <b>return</b> <b>true</b>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> class CimSessionProxyNewCimInstance
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Get full </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimInstance</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> if create successfully.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="fbefcf418b0bafec" href="R/fbefcf418b0bafec.html" target="n" data-glyph="2,0" class="t t">CimSessionProxyNewCimInstance</a> : <a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#fbefcf418b0bafec" class="t t">CimSessionProxyNewCimInstance</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given computer name.</span>
        <span class="c">///</span><span class="c"> Then create wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r198 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="06c479eff99cb44d" href="R/06c479eff99cb44d.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxyNewCimInstance</a>(<b>string</b> <span id="r198 rd" class="r198 r">computerName</span>, <a href="CimNewCimInstance.cs.html#7f343e6b516373a9" class="t t">CimNewCimInstance</a> <span id="r199 rd" class="r199 r">operation</span>)
            : <a href="#f1657d10b1a80e18" class="k">base</a>(<span class="r198 r">computerName</span>)
        {
            <a href="#fbefcf418b0bafec" class="k">this</a>.<a href="#f2c451f641037e23" class="i property">NewCimInstanceOperation</a> = <span class="r199 r">operation</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#fbefcf418b0bafec" class="t t">CimSessionProxyNewCimInstance</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given computer name</span>
        <span class="c">///</span><span class="c"> and session options.</span>
        <span class="c">///</span><span class="c"> Then create wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">sessionOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="4aea45b13fa1a2cb" href="R/4aea45b13fa1a2cb.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxyNewCimInstance</a>(<span class="i">CimSession</span> <span id="r200 rd" class="r200 r">session</span>, <a href="CimNewCimInstance.cs.html#7f343e6b516373a9" class="t t">CimNewCimInstance</a> <span id="r201 rd" class="r201 r">operation</span>)
            : <a href="#9097fe2d7684e63b" class="k">base</a>(<span class="r200 r">session</span>)
        {
            <a href="#fbefcf418b0bafec" class="k">this</a>.<a href="#f2c451f641037e23" class="i property">NewCimInstanceOperation</a> = <span class="r201 r">operation</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> pre action APIs
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called before new action event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r202 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="46099d02a020ce65" href="R/46099d02a020ce65.html" target="n" data-glyph="75,1" class="i method">PreNewActionEvent</a>(<a href="#f9a63e977fe06b4e" class="t t">CmdletActionEventArgs</a> <span id="r202 rd" class="r202 r">args</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <b>if</b> (<span class="r202 r">args</span>.<a href="#36809e757e44acff" class="i field">Action</a> <b>is not</b> <a href="CimWriteResultObject.cs.html#b7a3847402daf14e" class="t t">CimWriteResultObject</a>)
            {
                <span class="c">// allow all other actions</span>
                <b>return</b> <b>true</b>;
            }
 
            <a href="CimWriteResultObject.cs.html#b7a3847402daf14e" class="t t">CimWriteResultObject</a> <span id="r203 rd" class="r203 r">writeResultObject</span> = <span class="r202 r">args</span>.<a href="#36809e757e44acff" class="i field">Action</a> <b>as</b> <a href="CimWriteResultObject.cs.html#b7a3847402daf14e" class="t t">CimWriteResultObject</a>;
            <b>if</b> (!(<span class="r203 r">writeResultObject</span>.<a href="CimWriteResultObject.cs.html#5001549a4e79a9c9" class="i property">Result</a> <b>is</b> <span class="i">CimInstance</span> <span id="r204 rd" class="r204 r">cimInstance</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<span class="s">&quot;Going to read CimInstance classname = {0}; namespace = {1}&quot;</span>, 1, <span class="r204 r">cimInstance</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>, <span class="r204 r">cimInstance</span>.<span class="i">CimSystemProperties</span>.<span class="i">Namespace</span>);
            <a href="#fbefcf418b0bafec" class="k">this</a>.<a href="#f2c451f641037e23" class="i property">NewCimInstanceOperation</a>.<a href="CimNewCimInstance.cs.html#062909649028820b" class="i method">GetCimInstance</a>(<span class="r204 r">cimInstance</span>, <a href="#fbefcf418b0bafec" class="k">this</a>.<a href="#b1453253349bbaff" class="i property">ContextObject</a>);
            <b>return</b> <b>false</b>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private members
 
        <b>internal</b> <a href="CimNewCimInstance.cs.html#7f343e6b516373a9" class="t t">CimNewCimInstance</a> <a id="f2c451f641037e23" href="R/f2c451f641037e23.html" target="n" data-glyph="104,1" class="i property">NewCimInstanceOperation</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> class CimSessionProxyNewCimInstance
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Support PassThru for set-ciminstance.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="43c4ea5f025609cb" href="R/43c4ea5f025609cb.html" target="n" data-glyph="2,0" class="t t">CimSessionProxySetCimInstance</a> : <a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#43c4ea5f025609cb" class="t t">CimSessionProxySetCimInstance</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object.</span>
        <span class="c">///</span><span class="c"> Then create wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r205 r">originalProxy</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object to clone.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r206 r">passThru</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PassThru, true means output the modified instance; otherwise does not output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="b043fa68bedfd983" href="R/b043fa68bedfd983.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxySetCimInstance</a>(<a href="#64da31a8ef7908ad" class="t t">CimSessionProxy</a> <span id="r205 rd" class="r205 r">originalProxy</span>, <b>bool</b> <span id="r206 rd" class="r206 r">passThru</span>)
            : <a href="#88fcd99575c15068" class="k">base</a>(<span class="r205 r">originalProxy</span>)
        {
            <a href="#43c4ea5f025609cb" class="k">this</a>.<a href="#e69691027151b520" class="i field">passThru</a> = <span class="r206 r">passThru</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#43c4ea5f025609cb" class="t t">CimSessionProxySetCimInstance</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given computer name.</span>
        <span class="c">///</span><span class="c"> Then create wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r207 r">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r208 r">cimInstance</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r209 r">passThru</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="c6733eda715c9018" href="R/c6733eda715c9018.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxySetCimInstance</a>(<b>string</b> <span id="r207 rd" class="r207 r">computerName</span>,
            <span class="i">CimInstance</span> <span id="r208 rd" class="r208 r">cimInstance</span>,
            <b>bool</b> <span id="r209 rd" class="r209 r">passThru</span>)
            : <a href="#1240da2fc12ecd83" class="k">base</a>(<span class="r207 r">computerName</span>, <span class="r208 r">cimInstance</span>)
        {
            <a href="#43c4ea5f025609cb" class="k">this</a>.<a href="#e69691027151b520" class="i field">passThru</a> = <span class="r209 r">passThru</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#43c4ea5f025609cb" class="t t">CimSessionProxySetCimInstance</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimSession</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> by given computer name</span>
        <span class="c">///</span><span class="c"> and session options.</span>
        <span class="c">///</span><span class="c"> Then create wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">computerName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">sessionOptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="a9cc3580b244aa3c" href="R/a9cc3580b244aa3c.html" target="n" data-glyph="72,1" class="t constructor">CimSessionProxySetCimInstance</a>(<span class="i">CimSession</span> <span id="r210 rd" class="r210 r">session</span>, <b>bool</b> <span id="r211 rd" class="r211 r">passThru</span>)
            : <a href="#9097fe2d7684e63b" class="k">base</a>(<span class="r210 r">session</span>)
        {
            <a href="#43c4ea5f025609cb" class="k">this</a>.<a href="#e69691027151b520" class="i field">passThru</a> = <span class="r211 r">passThru</span>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> pre action APIs
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called before new action event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r212 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="882c8550bf11ab6a" href="R/882c8550bf11ab6a.html" target="n" data-glyph="75,1" class="i method">PreNewActionEvent</a>(<a href="#f9a63e977fe06b4e" class="t t">CmdletActionEventArgs</a> <span id="r212 rd" class="r212 r">args</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <b>if</b> ((!<a href="#43c4ea5f025609cb" class="k">this</a>.<a href="#e69691027151b520" class="i field">passThru</a>) &amp;&amp; (<span class="r212 r">args</span>.<a href="#36809e757e44acff" class="i field">Action</a> <b>is</b> <a href="CimWriteResultObject.cs.html#b7a3847402daf14e" class="t t">CimWriteResultObject</a>))
            {
                <span class="c">// filter out any output object</span>
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Ture indicates need to output the modified result.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly bool</b> <a id="e69691027151b520" href="R/e69691027151b520.html" target="n" data-glyph="46,1" class="i field">passThru</a> = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
}
</pre></td></tr></table></div></body></html>
