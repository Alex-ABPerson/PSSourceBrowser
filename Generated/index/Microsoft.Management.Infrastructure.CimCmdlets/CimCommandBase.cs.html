<!DOCTYPE html>
<html><head><title>CimCommandBase.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(920);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.Management.Infrastructure.CimCmdlets/CimCommandBase.cs" target="_top">CimCommandBase.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.Management.Infrastructure.CimCmdlets" target="_top">src\Microsoft.Management.Infrastructure.CimCmdlets\Microsoft.Management.Infrastructure.CimCmdlets.csproj</a> (Microsoft.Management.Infrastructure.CimCmdlets)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">region</span> Using directives
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Net</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">Management</span>.<span class="i n">Infrastructure</span>.<span class="i">Options</span>;
<span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">Management</span>.<span class="i n">Infrastructure</span>.<span class="i n">CimCmdlets</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameter Set Resolving Classes
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Define class </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">ParameterDefinitionEntry</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="7d20994d716d296b" href="R/7d20994d716d296b.html" target="n" data-glyph="2,0" class="t t">ParameterDefinitionEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7d20994d716d296b" class="t t">ParameterDefinitionEntry</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">parameterSetName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">mandatory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="75da3ffbdc84f406" href="R/75da3ffbdc84f406.html" target="n" data-glyph="74,1" class="t constructor">ParameterDefinitionEntry</a>(<b>string</b> <span id="r0 rd" class="r0 r">parameterSetName</span>, <b>bool</b> <span id="r1 rd" class="r1 r">mandatory</span>)
        {
            <a href="#7d20994d716d296b" class="k">this</a>.<a href="#6fc96637ef30ae56" class="i property">IsMandatory</a> = <span class="r1 r">mandatory</span>;
            <a href="#7d20994d716d296b" class="k">this</a>.<a href="#981df3766575aa27" class="i property">ParameterSetName</a> = <span class="r0 r">parameterSetName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property ParameterSetName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="981df3766575aa27" href="R/981df3766575aa27.html" target="n" data-glyph="104,1" class="i property">ParameterSetName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Whether the parameter is mandatory to the set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="6fc96637ef30ae56" href="R/6fc96637ef30ae56.html" target="n" data-glyph="104,1" class="i property">IsMandatory</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Define class </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">ParameterSetEntry</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="97585def524dbc6b" href="R/97585def524dbc6b.html" target="n" data-glyph="2,0" class="t t">ParameterSetEntry</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">mandatoryParameterCount</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="ce92ce556de03244" href="R/ce92ce556de03244.html" target="n" data-glyph="74,1" class="t constructor">ParameterSetEntry</a>(<b>uint</b> <span id="r2 rd" class="r2 r">mandatoryParameterCount</span>)
        {
            <a href="#97585def524dbc6b" class="k">this</a>.<a href="#805caf724f7b0fe2" class="i property">MandatoryParameterCount</a> = <span class="r2 r">mandatoryParameterCount</span>;
            <a href="#97585def524dbc6b" class="k">this</a>.<a href="#21cc1525368ca4c4" class="i property">IsDefaultParameterSet</a> = <b>false</b>;
            <a href="#11af2bdbd55de3a4" class="i method">reset</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">toClone</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="15a9e0b98109c1f5" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ParameterSetEntry</a>(<a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a> <span id="r3 rd" class="r3 r">toClone</span>)
        {
            <a href="#97585def524dbc6b" class="k">this</a>.<a href="#805caf724f7b0fe2" class="i property">MandatoryParameterCount</a> = <span class="r3 r">toClone</span>.<a href="#805caf724f7b0fe2" class="i property">MandatoryParameterCount</a>;
            <a href="#97585def524dbc6b" class="k">this</a>.<a href="#21cc1525368ca4c4" class="i property">IsDefaultParameterSet</a> = <span class="r3 r">toClone</span>.<a href="#21cc1525368ca4c4" class="i property">IsDefaultParameterSet</a>;
            <a href="#11af2bdbd55de3a4" class="i method">reset</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">mandatoryParameterCount</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="i">mandatory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="107b3238b5492cc1" href="R/107b3238b5492cc1.html" target="n" data-glyph="74,1" class="t constructor">ParameterSetEntry</a>(<b>uint</b> <span id="r4 rd" class="r4 r">mandatoryParameterCount</span>, <b>bool</b> <span id="r5 rd" class="r5 r">isDefault</span>)
        {
            <a href="#97585def524dbc6b" class="k">this</a>.<a href="#805caf724f7b0fe2" class="i property">MandatoryParameterCount</a> = <span class="r4 r">mandatoryParameterCount</span>;
            <a href="#97585def524dbc6b" class="k">this</a>.<a href="#21cc1525368ca4c4" class="i property">IsDefaultParameterSet</a> = <span class="r5 r">isDefault</span>;
            <a href="#11af2bdbd55de3a4" class="i method">reset</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reset the internal status.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="11af2bdbd55de3a4" href="R/11af2bdbd55de3a4.html" target="n" data-glyph="74,1" class="i method">reset</a>()
        {
            <a href="#97585def524dbc6b" class="k">this</a>.<a href="#868d5887665061a3" class="i property">SetMandatoryParameterCount</a> = <a href="#97585def524dbc6b" class="k">this</a>.<a href="#a9857c9b078d6413" class="i property">SetMandatoryParameterCountAtBeginProcess</a>;
            <a href="#97585def524dbc6b" class="k">this</a>.<a href="#3571c55fd90aa325" class="i property">IsValueSet</a> = <a href="#97585def524dbc6b" class="k">this</a>.<a href="#7c385209201fa6b4" class="i property">IsValueSetAtBeginProcess</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">DefaultParameterSet</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="21cc1525368ca4c4" href="R/21cc1525368ca4c4.html" target="n" data-glyph="104,1" class="i property">IsDefaultParameterSet</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">MandatoryParameterCount</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal uint</b> <a id="805caf724f7b0fe2" href="R/805caf724f7b0fe2.html" target="n" data-glyph="104,1" class="i property">MandatoryParameterCount</a> { <b>get</b>; } = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">IsValueSet</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="3571c55fd90aa325" href="R/3571c55fd90aa325.html" target="n" data-glyph="104,1" class="i property">IsValueSet</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">IsValueSetAtBeginProcess</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="7c385209201fa6b4" href="R/7c385209201fa6b4.html" target="n" data-glyph="104,1" class="i property">IsValueSetAtBeginProcess</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">SetMandatoryParameterCount</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal uint</b> <a id="868d5887665061a3" href="R/868d5887665061a3.html" target="n" data-glyph="104,1" class="i property">SetMandatoryParameterCount</a> { <b>get</b>; <b>set</b>; } = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">SetMandatoryParameterCountAtBeginProcess</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal uint</b> <a id="a9857c9b078d6413" href="R/a9857c9b078d6413.html" target="n" data-glyph="104,1" class="i property">SetMandatoryParameterCountAtBeginProcess</a> { <b>get</b>; <b>set</b>; } = 0;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Define class </span><span class="c">&lt;</span><span class="c">c</span><span class="c">&gt;</span><span class="c">ParameterBinder</span><span class="c">&lt;/</span><span class="c">c</span><span class="c">&gt;</span><span class="c">.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="04547cbeeacb8dfd" href="R/04547cbeeacb8dfd.html" target="n" data-glyph="2,0" class="t t">ParameterBinder</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#04547cbeeacb8dfd" class="t t">ParameterBinder</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">parameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">sets</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="2939ca62d0719be7" href="R/2939ca62d0719be7.html" target="n" data-glyph="74,1" class="t constructor">ParameterBinder</a>(
            <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">HashSet</span>&lt;<a href="#7d20994d716d296b" class="t t">ParameterDefinitionEntry</a>&gt;&gt; <span id="r6 rd" class="r6 r">parameters</span>,
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a>&gt; <span id="r7 rd" class="r7 r">sets</span>)
        {
            <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#732a7aca5caa969d" class="i method">CloneParameterEntries</a>(<span class="r6 r">parameters</span>, <span class="r7 r">sets</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Two dictionaries used to determine the bound parameter set
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Define the parameter definition entries,</span>
        <span class="c">///</span><span class="c"> each parameter may belong a set of parameterSets, each parameter set</span>
        <span class="c">///</span><span class="c"> are defined by a </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7d20994d716d296b" class="t t">ParameterDefinitionEntry</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">HashSet</span>&lt;<a href="#7d20994d716d296b" class="t t">ParameterDefinitionEntry</a>&gt;&gt; <a id="065b7d6b5331d2f4" href="R/065b7d6b5331d2f4.html" target="n" data-glyph="46,1" class="i field">parameterDefinitionEntries</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Define parameter set entries,</span>
        <span class="c">///</span><span class="c"> each cmdlet has a list of parameter set, each has number of mandatory parameters, etc.</span>
        <span class="c">///</span><span class="c"> This data structure is used to track the number of mandatory parameter has been set for</span>
        <span class="c">///</span><span class="c"> current parameterset, whether the parameter set was been set by user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a>&gt; <a id="82a3cb15fb84408a" href="R/82a3cb15fb84408a.html" target="n" data-glyph="46,1" class="i field">parameterSetEntries</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to remember the set of parameterset were set</span>
        <span class="c">///</span><span class="c"> if any conflict occurred with current parameter,</span>
        <span class="c">///</span><span class="c"> throw exception</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="d4e949613a907fde" href="R/d4e949613a907fde.html" target="n" data-glyph="46,1" class="i field">parametersetNamesList</a> = <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter names list.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="fa072a3b38006e93" href="R/fa072a3b38006e93.html" target="n" data-glyph="46,1" class="i field">parameterNamesList</a> = <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to remember the set of parameterset were set before begin process</span>
        <span class="c">///</span><span class="c"> if any conflict occurred with current parameter,</span>
        <span class="c">///</span><span class="c"> throw exception</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="7eba8f5a6770a43d" href="R/7eba8f5a6770a43d.html" target="n" data-glyph="46,1" class="i field">parametersetNamesListAtBeginProcess</a> = <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter names list before begin process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="304c1b23e33f1f12" href="R/304c1b23e33f1f12.html" target="n" data-glyph="46,1" class="i field">parameterNamesListAtBeginProcess</a> = <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reset the status of parameter set entries</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="bb92b5ae2b8bd179" href="R/bb92b5ae2b8bd179.html" target="n" data-glyph="74,1" class="i method">reset</a>()
        {
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a>&gt; <span id="r8 rd" class="r8 r">setEntry</span> <b>in</b> <a href="#82a3cb15fb84408a" class="i field">parameterSetEntries</a>)
            {
                <span class="r8 r">setEntry</span>.<span class="i">Value</span>.<span class="i">reset</span>();
            }
 
            <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#d4e949613a907fde" class="i field">parametersetNamesList</a>.<span class="i">Clear</span>();
            <b>foreach</b> (<b>string</b> <span id="r9 rd" class="r9 r">parametersetName</span> <b>in</b> <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#7eba8f5a6770a43d" class="i field">parametersetNamesListAtBeginProcess</a>)
            {
                <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#d4e949613a907fde" class="i field">parametersetNamesList</a>.<span class="i">Add</span>(<span class="r9 r">parametersetName</span>);
            }
 
            <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#fa072a3b38006e93" class="i field">parameterNamesList</a>.<span class="i">Clear</span>();
            <b>foreach</b> (<b>string</b> <span id="r10 rd" class="r10 r">parameterName</span> <b>in</b> <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#304c1b23e33f1f12" class="i field">parameterNamesListAtBeginProcess</a>)
            {
                <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#fa072a3b38006e93" class="i field">parameterNamesList</a>.<span class="i">Add</span>(<span class="r10 r">parameterName</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A given parameter&#39;s value was set by cmdlet caller,</span>
        <span class="c">///</span><span class="c"> check and change the status of parameter set,</span>
        <span class="c">///</span><span class="c"> throw exception if confliction occurred</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/System.Management.Automation/A.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Throw if conflict parameter was set.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="e42c941e9a9487e4" href="R/e42c941e9a9487e4.html" target="n" data-glyph="74,1" class="i method">SetParameter</a>(<b>string</b> <span id="r11 rd" class="r11 r">parameterName</span>, <b>bool</b> <span id="r12 rd" class="r12 r">isBeginProcess</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;ParameterName = {0}, isBeginProcess = {1}&quot;</span>, 0, <span class="r11 r">parameterName</span>, <span class="r12 r">isBeginProcess</span>);
 
            <b>if</b> (<a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#fa072a3b38006e93" class="i field">parameterNamesList</a>.<span class="i">Contains</span>(<span class="r11 r">parameterName</span>))
            {
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;ParameterName {0} is already bound &quot;</span>, 1, <span class="r11 r">parameterName</span>);
                <b>return</b>;
            }
            <b>else</b>
            {
                <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#fa072a3b38006e93" class="i field">parameterNamesList</a>.<span class="i">Add</span>(<span class="r11 r">parameterName</span>);
                <b>if</b> (<span class="r12 r">isBeginProcess</span>)
                {
                    <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#304c1b23e33f1f12" class="i field">parameterNamesListAtBeginProcess</a>.<span class="i">Add</span>(<span class="r11 r">parameterName</span>);
                }
            }
 
            <b>if</b> (<a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#d4e949613a907fde" class="i field">parametersetNamesList</a>.<span class="i">Count</span> == 0)
            {
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r13 rd" class="r13 r">nameset</span> = <b>new</b>();
                <b>foreach</b> (<a href="#7d20994d716d296b" class="t t">ParameterDefinitionEntry</a> <span id="r14 rd" class="r14 r">parameterDefinitionEntry</span> <b>in</b> <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#065b7d6b5331d2f4" class="i field">parameterDefinitionEntries</a>[<span class="r11 r">parameterName</span>])
                {
                    <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;parameterset name = &#39;{0}&#39;; mandatory = &#39;{1}&#39;&quot;</span>, 1, <span class="r14 r">parameterDefinitionEntry</span>.<a href="#981df3766575aa27" class="i property">ParameterSetName</a>, <span class="r14 r">parameterDefinitionEntry</span>.<a href="#6fc96637ef30ae56" class="i property">IsMandatory</a>);
                    <a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a> <span id="r15 rd" class="r15 r">psEntry</span> = <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#82a3cb15fb84408a" class="i field">parameterSetEntries</a>[<span class="r14 r">parameterDefinitionEntry</span>.<a href="#981df3766575aa27" class="i property">ParameterSetName</a>];
                    <b>if</b> (<span class="r15 r">psEntry</span> == <b>null</b>)
                        <b>continue</b>;
 
                    <b>if</b> (<span class="r14 r">parameterDefinitionEntry</span>.<a href="#6fc96637ef30ae56" class="i property">IsMandatory</a>)
                    {
                        <span class="r15 r">psEntry</span>.<a href="#868d5887665061a3" class="i property">SetMandatoryParameterCount</a>++;
                        <b>if</b> (<span class="r12 r">isBeginProcess</span>)
                        {
                            <span class="r15 r">psEntry</span>.<a href="#a9857c9b078d6413" class="i property">SetMandatoryParameterCountAtBeginProcess</a>++;
                        }
 
                        <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;parameterset name = &#39;{0}&#39;; SetMandatoryParameterCount = &#39;{1}&#39;&quot;</span>, 1, <span class="r14 r">parameterDefinitionEntry</span>.<a href="#981df3766575aa27" class="i property">ParameterSetName</a>, <span class="r15 r">psEntry</span>.<a href="#868d5887665061a3" class="i property">SetMandatoryParameterCount</a>);
                    }
 
                    <b>if</b> (!<span class="r15 r">psEntry</span>.<a href="#3571c55fd90aa325" class="i property">IsValueSet</a>)
                    {
                        <span class="r15 r">psEntry</span>.<a href="#3571c55fd90aa325" class="i property">IsValueSet</a> = <b>true</b>;
                        <b>if</b> (<span class="r12 r">isBeginProcess</span>)
                        {
                            <span class="r15 r">psEntry</span>.<a href="#7c385209201fa6b4" class="i property">IsValueSetAtBeginProcess</a> = <b>true</b>;
                        }
                    }
 
                    <span class="r13 r">nameset</span>.<span class="i">Add</span>(<span class="r14 r">parameterDefinitionEntry</span>.<a href="#981df3766575aa27" class="i property">ParameterSetName</a>);
                }
 
                <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#d4e949613a907fde" class="i field">parametersetNamesList</a> = <span class="r13 r">nameset</span>;
                <b>if</b> (<span class="r12 r">isBeginProcess</span>)
                {
                    <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#7eba8f5a6770a43d" class="i field">parametersetNamesListAtBeginProcess</a> = <span class="r13 r">nameset</span>;
                }
            }
            <b>else</b>
            {
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r16 rd" class="r16 r">nameset</span> = <b>new</b>();
                <b>foreach</b> (<a href="#7d20994d716d296b" class="t t">ParameterDefinitionEntry</a> <span id="r17 rd" class="r17 r">entry</span> <b>in</b> <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#065b7d6b5331d2f4" class="i field">parameterDefinitionEntries</a>[<span class="r11 r">parameterName</span>])
                {
                    <b>if</b> (<a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#d4e949613a907fde" class="i field">parametersetNamesList</a>.<span class="i">Contains</span>(<span class="r17 r">entry</span>.<a href="#981df3766575aa27" class="i property">ParameterSetName</a>))
                    {
                        <span class="r16 r">nameset</span>.<span class="i">Add</span>(<span class="r17 r">entry</span>.<a href="#981df3766575aa27" class="i property">ParameterSetName</a>);
                        <b>if</b> (<span class="r17 r">entry</span>.<a href="#6fc96637ef30ae56" class="i property">IsMandatory</a>)
                        {
                            <a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a> <span id="r18 rd" class="r18 r">psEntry</span> = <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#82a3cb15fb84408a" class="i field">parameterSetEntries</a>[<span class="r17 r">entry</span>.<a href="#981df3766575aa27" class="i property">ParameterSetName</a>];
                            <span class="r18 r">psEntry</span>.<a href="#868d5887665061a3" class="i property">SetMandatoryParameterCount</a>++;
                            <b>if</b> (<span class="r12 r">isBeginProcess</span>)
                            {
                                <span class="r18 r">psEntry</span>.<a href="#a9857c9b078d6413" class="i property">SetMandatoryParameterCountAtBeginProcess</a>++;
                            }
 
                            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(<span class="s">&quot;parameterset name = &#39;{0}&#39;; SetMandatoryParameterCount = &#39;{1}&#39;&quot;</span>,
                                1,
                                <span class="r17 r">entry</span>.<a href="#981df3766575aa27" class="i property">ParameterSetName</a>,
                                <span class="r18 r">psEntry</span>.<a href="#868d5887665061a3" class="i property">SetMandatoryParameterCount</a>);
                        }
                    }
                }
 
                <b>if</b> (<span class="r16 r">nameset</span>.<span class="i">Count</span> == 0)
                {
                    <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="i">CimCmdletStrings</span>.<span class="i">UnableToResolveParameterSetName</span>);
                }
                <b>else</b>
                {
                    <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#d4e949613a907fde" class="i field">parametersetNamesList</a> = <span class="r16 r">nameset</span>;
                    <b>if</b> (<span class="r12 r">isBeginProcess</span>)
                    {
                        <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#7eba8f5a6770a43d" class="i field">parametersetNamesListAtBeginProcess</a> = <span class="r16 r">nameset</span>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the parameter set name based on current binding results.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="e30c769907cafdab" href="R/e30c769907cafdab.html" target="n" data-glyph="74,1" class="i method">GetParameterSet</a>()
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#651773f290fcb6be" class="i method">WriteLogEx</a>();
 
            <b>string</b> <span id="r19 rd" class="r19 r">boundParameterSetName</span> = <b>null</b>;
            <b>string</b> <span id="r20 rd" class="r20 r">defaultParameterSetName</span> = <b>null</b>;
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r21 rd" class="r21 r">noMandatoryParameterSet</span> = <b>new</b>();
 
            <span class="c">// Looking for parameter set which have mandatory parameters</span>
            <b>foreach</b> (<b>string</b> <span id="r22 rd" class="r22 r">parameterSetName</span> <b>in</b> <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#82a3cb15fb84408a" class="i field">parameterSetEntries</a>.<span class="i">Keys</span>)
            {
                <a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a> <span id="r23 rd" class="r23 r">entry</span> = <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#82a3cb15fb84408a" class="i field">parameterSetEntries</a>[<span class="r22 r">parameterSetName</span>];
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<a href="Utils.cs.html#41e91352aaa16ae7" class="i method">WriteLogEx</a>(
                    <span class="s">&quot;parameterset name = {0}, {1}/{2} mandatory parameters.&quot;</span>,
                    1,
                    <span class="r22 r">parameterSetName</span>,
                    <span class="r23 r">entry</span>.<a href="#868d5887665061a3" class="i property">SetMandatoryParameterCount</a>,
                    <span class="r23 r">entry</span>.<a href="#805caf724f7b0fe2" class="i property">MandatoryParameterCount</a>);
 
                <span class="c">// Ignore the parameter set which has no mandatory parameter firstly</span>
                <b>if</b> (<span class="r23 r">entry</span>.<a href="#805caf724f7b0fe2" class="i property">MandatoryParameterCount</a> == 0)
                {
                    <b>if</b> (<span class="r23 r">entry</span>.<a href="#21cc1525368ca4c4" class="i property">IsDefaultParameterSet</a>)
                    {
                        <span class="r20 r">defaultParameterSetName</span> = <span class="r22 r">parameterSetName</span>;
                    }
 
                    <b>if</b> (<span class="r23 r">entry</span>.<a href="#3571c55fd90aa325" class="i property">IsValueSet</a>)
                    {
                        <span class="r21 r">noMandatoryParameterSet</span>.<span class="i">Add</span>(<span class="r22 r">parameterSetName</span>);
                    }
 
                    <b>continue</b>;
                }
 
                <b>if</b> ((<span class="r23 r">entry</span>.<a href="#868d5887665061a3" class="i property">SetMandatoryParameterCount</a> == <span class="r23 r">entry</span>.<a href="#805caf724f7b0fe2" class="i property">MandatoryParameterCount</a>) &amp;&amp;
                    <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#d4e949613a907fde" class="i field">parametersetNamesList</a>.<span class="i">Contains</span>(<span class="r22 r">parameterSetName</span>))
                {
                    <b>if</b> (<span class="r19 r">boundParameterSetName</span> != <b>null</b>)
                    {
                        <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="i">CimCmdletStrings</span>.<span class="i">UnableToResolveParameterSetName</span>);
                    }
 
                    <span class="r19 r">boundParameterSetName</span> = <span class="r22 r">parameterSetName</span>;
                }
            }
 
            <span class="c">// Looking for parameter set which has no mandatory parameters</span>
            <b>if</b> (<span class="r19 r">boundParameterSetName</span> == <b>null</b>)
            {
                <span class="c">// throw if there are &gt; 1 parameter set</span>
                <b>if</b> (<span class="r21 r">noMandatoryParameterSet</span>.<span class="i">Count</span> &gt; 1)
                {
                    <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="i">CimCmdletStrings</span>.<span class="i">UnableToResolveParameterSetName</span>);
                }
                <b>else</b> <b>if</b> (<span class="r21 r">noMandatoryParameterSet</span>.<span class="i">Count</span> == 1)
                {
                    <span class="r19 r">boundParameterSetName</span> = <span class="r21 r">noMandatoryParameterSet</span>[0];
                }
            }
 
            <span class="c">// Looking for default parameter set</span>
            <b>if</b> (<span class="r19 r">boundParameterSetName</span> == <b>null</b>)
            {
                <span class="r19 r">boundParameterSetName</span> = <span class="r20 r">defaultParameterSetName</span>;
            }
 
            <span class="c">// throw if still can not find the parameter set name</span>
            <b>if</b> (<span class="r19 r">boundParameterSetName</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="i">CimCmdletStrings</span>.<span class="i">UnableToResolveParameterSetName</span>);
            }
 
            <b>return</b> <span class="r19 r">boundParameterSetName</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Deep clone the parameter entries to member variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="732a7aca5caa969d" href="R/732a7aca5caa969d.html" target="n" data-glyph="76,1" class="i method">CloneParameterEntries</a>(
            <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">HashSet</span>&lt;<a href="#7d20994d716d296b" class="t t">ParameterDefinitionEntry</a>&gt;&gt; <span id="r24 rd" class="r24 r">parameters</span>,
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a>&gt; <span id="r25 rd" class="r25 r">sets</span>)
        {
            <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#065b7d6b5331d2f4" class="i field">parameterDefinitionEntries</a> = <span class="r24 r">parameters</span>;
            <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#82a3cb15fb84408a" class="i field">parameterSetEntries</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a>&gt;();
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a>&gt; <span id="r26 rd" class="r26 r">parameterSet</span> <b>in</b> <span class="r25 r">sets</span>)
            {
                <a href="#04547cbeeacb8dfd" class="k">this</a>.<a href="#82a3cb15fb84408a" class="i field">parameterSetEntries</a>.<span class="i">Add</span>(<span class="r26 r">parameterSet</span>.<span class="i">Key</span>, <b>new</b> <span class="t">ParameterSetEntry</span>(<span class="r26 r">parameterSet</span>.<span class="i">Value</span>));
            }
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base command for all cim cmdlets.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="22cb7e84418c7170" href="R/22cb7e84418c7170.html" target="n" data-glyph="0,0" class="t t">CimBaseCommand</a> : <a href="/System.Management.Automation/A.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> resolve parameter set name
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check set parameters and set ParameterSetName</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Following are special types to be handled</span>
        <span class="c">///</span><span class="c"> Microsoft.Management.Infrastructure.Options.PacketEncoding</span>
        <span class="c">///</span><span class="c"> Microsoft.Management.Infrastructure.Options.ImpersonationType</span>
        <span class="c">///</span><span class="c"> UInt32</span>
        <span class="c">///</span><span class="c"> Authentication.None  (default value)?</span>
        <span class="c">///</span><span class="c"> ProxyType.None</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="5be341145a201f56" href="R/5be341145a201f56.html" target="n" data-glyph="74,1" class="i method">CheckParameterSet</a>()
        {
            <b>if</b> (<a href="#22cb7e84418c7170" class="k">this</a>.<a href="#a69bcd72c7d05165" class="i field">parameterBinder</a> != <b>null</b>)
            {
                <b>try</b>
                {
                    <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#b346752b85d60599" class="i property">ParameterSetName</a> = <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#a69bcd72c7d05165" class="i field">parameterBinder</a>.<a href="#e30c769907cafdab" class="i method">GetParameterSet</a>();
                }
                <b>finally</b>
                {
                    <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#a69bcd72c7d05165" class="i field">parameterBinder</a>.<a href="#bb92b5ae2b8bd179" class="i method">reset</a>();
                }
            }
 
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<span class="s">&quot;current parameterset is: &quot;</span> + <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#b346752b85d60599" class="i property">ParameterSetName</a>, 4);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Redirect to parameterBinder to set one parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="c71260563ad07657" href="R/c71260563ad07657.html" target="n" data-glyph="74,1" class="i method">SetParameter</a>(<b>object</b> <span id="r28 rd" class="r28 r">value</span>, <b>string</b> <span id="r27 rd" class="r27 r">parameterName</span>)
        {
            <span class="c">// Ignore the null value being set,</span>
            <span class="c">// Null value could be set by caller unintentionally,</span>
            <span class="c">// or by powershell to reset the parameter to default value</span>
            <span class="c">// before the next parameter binding, and ProcessRecord call</span>
            <b>if</b> (<span class="r28 r">value</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (<a href="#22cb7e84418c7170" class="k">this</a>.<a href="#a69bcd72c7d05165" class="i field">parameterBinder</a> != <b>null</b>)
            {
                <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#a69bcd72c7d05165" class="i field">parameterBinder</a>.<a href="#e42c941e9a9487e4" class="i method">SetParameter</a>(<span class="r27 r">parameterName</span>, <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#389b0e3b4a0228e1" class="i property">AtBeginProcess</a>);
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#22cb7e84418c7170" class="t t">CimBaseCommand</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="7d400d8d5437e881" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">CimBaseCommand</a>()
        {
            <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#71449a571b1bec3d" class="i field">disposed</a> = <b>false</b>;
            <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#a69bcd72c7d05165" class="i field">parameterBinder</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#22cb7e84418c7170" class="t t">CimBaseCommand</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="b21695c33cf2f8d3" href="R/b21695c33cf2f8d3.html" target="n" data-glyph="74,1" class="t constructor">CimBaseCommand</a>(<span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">HashSet</span>&lt;<a href="#7d20994d716d296b" class="t t">ParameterDefinitionEntry</a>&gt;&gt; <span id="r29 rd" class="r29 r">parameters</span>,
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#97585def524dbc6b" class="t t">ParameterSetEntry</a>&gt; <span id="r30 rd" class="r30 r">sets</span>)
        {
            <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#71449a571b1bec3d" class="i field">disposed</a> = <b>false</b>;
            <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#a69bcd72c7d05165" class="i field">parameterBinder</a> = <b>new</b> <a href="#2939ca62d0719be7" class="t constructor">ParameterBinder</a>(<span class="r29 r">parameters</span>, <span class="r30 r">sets</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> override functions of Cmdlet
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopProcessing method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="659916eef350adc7" href="R/659916eef350adc7.html" target="n" data-glyph="75,1" class="i method">StopProcessing</a>()
        {
            <a href="#ddc05f193ffd1e84" class="i method">Dispose</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable interface
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IDisposable interface.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="71449a571b1bec3d" href="R/71449a571b1bec3d.html" target="n" data-glyph="46,1" class="i field">disposed</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose() calls Dispose(true).</span>
        <span class="c">///</span><span class="c"> Implement IDisposable. Do not make this method virtual.</span>
        <span class="c">///</span><span class="c"> A derived class should not be able to override this method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="ddc05f193ffd1e84" href="R/ddc05f193ffd1e84.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#c0a5dfdec2fcb502" class="i method">Dispose</a>(<b>true</b>);
            <span class="c">// This object will be cleaned up by the Dispose method.</span>
            <span class="c">// Therefore, you should call GC.SuppressFinalize to</span>
            <span class="c">// take this object off the finalization queue</span>
            <span class="c">// and prevent finalization code for this object</span>
            <span class="c">// from executing a second time.</span>
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#22cb7e84418c7170" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose(bool disposing) executes in two distinct scenarios.</span>
        <span class="c">///</span><span class="c"> If disposing equals true, the method has been called directly</span>
        <span class="c">///</span><span class="c"> or indirectly by a user&#39;s code. Managed and unmanaged resources</span>
        <span class="c">///</span><span class="c"> can be disposed.</span>
        <span class="c">///</span><span class="c"> If disposing equals false, the method has been called by the</span>
        <span class="c">///</span><span class="c"> runtime from inside the finalizer and you should not reference</span>
        <span class="c">///</span><span class="c"> other objects. Only unmanaged resources can be disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Whether it is directly called.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected void</b> <a id="c0a5dfdec2fcb502" href="R/c0a5dfdec2fcb502.html" target="n" data-glyph="75,1" class="i method">Dispose</a>(<b>bool</b> <span id="r31 rd" class="r31 r">disposing</span>)
        {
            <span class="c">// Check to see if Dispose has already been called.</span>
            <b>if</b> (!<a href="#22cb7e84418c7170" class="k">this</a>.<a href="#71449a571b1bec3d" class="i field">disposed</a>)
            {
                <span class="c">// If disposing equals true, dispose all managed</span>
                <span class="c">// and unmanaged resources.</span>
                <b>if</b> (<span class="r31 r">disposing</span>)
                {
                    <a href="#8c751cfa4cc24b31" class="i method">DisposeInternal</a>();
                }
 
                <span class="c">// Call the appropriate methods to clean up</span>
                <span class="c">// unmanaged resources here.</span>
                <span class="c">// If disposing is false,</span>
                <span class="c">// only the following code is executed.</span>
 
                <span class="c">// Note disposing has been done.</span>
                <a href="#71449a571b1bec3d" class="i field">disposed</a> = <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clean up resources.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected virtual void</b> <a id="8c751cfa4cc24b31" href="R/8c751cfa4cc24b31.html" target="n" data-glyph="75,1" class="i method">DisposeInternal</a>()
        {
            <span class="c">// Dispose managed resources.</span>
            <b>if</b> (<a href="#22cb7e84418c7170" class="k">this</a>.<a href="#cefd01858d0a75c8" class="i field">operation</a> != <b>null</b>)
            {
                <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#cefd01858d0a75c8" class="i field">operation</a>.<a href="CimAsyncOperation.cs.html#e7e651e1ba619c2e" class="i method">Dispose</a>();
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter binder used to resolve parameter set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="#04547cbeeacb8dfd" class="t t">ParameterBinder</a> <a id="a69bcd72c7d05165" href="R/a69bcd72c7d05165.html" target="n" data-glyph="46,1" class="i field">parameterBinder</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Async operation handler</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="CimAsyncOperation.cs.html#c0ecd00f7d90f163" class="t t">CimAsyncOperation</a> <a id="cefd01858d0a75c8" href="R/cefd01858d0a75c8.html" target="n" data-glyph="46,1" class="i field">operation</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Lock object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly object</b> <a id="7807b8cfc33279cd" href="R/7807b8cfc33279cd.html" target="n" data-glyph="46,1" class="i field">myLock</a> = <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This flag is introduced to resolve the parameter set name</span>
        <span class="c">///</span><span class="c"> during process record</span>
        <span class="c">///</span><span class="c"> Whether at begin process time, false means in processrecord.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="cfb3681d62ff61cc" href="R/cfb3681d62ff61cc.html" target="n" data-glyph="46,1" class="i field">atBeginProcess</a> = <b>true</b>;
 
        <b>internal bool</b> <a id="389b0e3b4a0228e1" href="R/389b0e3b4a0228e1.html" target="n" data-glyph="104,1" class="i property">AtBeginProcess</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#cfb3681d62ff61cc" class="i field">atBeginProcess</a>;
            }
 
            <b>set</b>
            {
                <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#cfb3681d62ff61cc" class="i field">atBeginProcess</a> = <b>value</b>;
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> internal properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="CimAsyncOperation.cs.html#c0ecd00f7d90f163" class="t t">CimAsyncOperation</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> object, to which</span>
        <span class="c">///</span><span class="c"> current cmdlet will delegate all operations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="CimAsyncOperation.cs.html#c0ecd00f7d90f163" class="t t">CimAsyncOperation</a> <a id="221fb9e3afb5a7bb" href="R/221fb9e3afb5a7bb.html" target="n" data-glyph="104,1" class="i property">AsyncOperation</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#cefd01858d0a75c8" class="i field">operation</a>;
            }
 
            <b>set</b>
            {
                <b>lock</b> (<a href="#22cb7e84418c7170" class="k">this</a>.<a href="#7807b8cfc33279cd" class="i field">myLock</a>)
                {
                    <span class="i">Debug</span>.<span class="i">Assert</span>(<a href="#22cb7e84418c7170" class="k">this</a>.<a href="#cefd01858d0a75c8" class="i field">operation</a> == <b>null</b>, <span class="s">&quot;Caller should verify that operation is null&quot;</span>);
                    <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#cefd01858d0a75c8" class="i field">operation</a> = <b>value</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get current ParameterSetName of the cmdlet</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="b346752b85d60599" href="R/b346752b85d60599.html" target="n" data-glyph="104,1" class="i property">ParameterSetName</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets/Sets cmdlet operation wrapper object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="CmdletOperation.cs.html#813733b900a1bded" class="t t">CmdletOperationBase</a> <a id="06c2c22e1c68d822" href="R/06c2c22e1c68d822.html" target="n" data-glyph="104,1" class="i property">CmdletOperation</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Throw terminating error</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i n">System</span>.<span class="i">Diagnostics</span>.<span class="i">CodeAnalysis</span>.<span class="i">DoesNotReturn</span>]
        <b>internal void</b> <a id="6e0fba6b6792baaf" href="R/6e0fba6b6792baaf.html" target="n" data-glyph="74,1" class="i method">ThrowTerminatingError</a>(<span class="i">Exception</span> <span id="r32 rd" class="r32 r">exception</span>, <b>string</b> <span id="r33 rd" class="r33 r">operation</span>)
        {
            <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r34 rd" class="r34 r">errorRecord</span> = <b>new</b>(<span class="r32 r">exception</span>, <span class="r33 r">operation</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <a href="#22cb7e84418c7170" class="k">this</a>);
            <a href="#22cb7e84418c7170" class="k">this</a>.<a href="#06c2c22e1c68d822" class="i property">CmdletOperation</a>.<a href="CmdletOperation.cs.html#b314c51cac62b848" class="i method">ThrowTerminatingError</a>(<span class="r34 r">errorRecord</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> internal const strings
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Alias CN - computer name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="bc44dab22b197729" href="R/bc44dab22b197729.html" target="n" data-glyph="8,1" class="i field">AliasCN</a> = <span class="s">&quot;CN&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Alias ServerName - computer name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="c750aa3cb089ac8c" href="R/c750aa3cb089ac8c.html" target="n" data-glyph="8,1" class="i field">AliasServerName</a> = <span class="s">&quot;ServerName&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Alias OT - operation timeout.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="5b5e301b969578a3" href="R/5b5e301b969578a3.html" target="n" data-glyph="8,1" class="i field">AliasOT</a> = <span class="s">&quot;OT&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Session set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="8437b4532628e3ef" href="R/8437b4532628e3ef.html" target="n" data-glyph="8,1" class="i field">SessionSetName</a> = <span class="s">&quot;SessionSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Computer set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="972f1182da752433" href="R/972f1182da752433.html" target="n" data-glyph="8,1" class="i field">ComputerSetName</a> = <span class="s">&quot;ComputerSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Class name computer set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="5c930af3091e1b0e" href="R/5c930af3091e1b0e.html" target="n" data-glyph="8,1" class="i field">ClassNameComputerSet</a> = <span class="s">&quot;ClassNameComputerSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resource Uri computer set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="b0412407be1ee837" href="R/b0412407be1ee837.html" target="n" data-glyph="8,1" class="i field">ResourceUriComputerSet</a> = <span class="s">&quot;ResourceUriComputerSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimInstance</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> computer set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="5b1af9a0eade56bb" href="R/5b1af9a0eade56bb.html" target="n" data-glyph="8,1" class="i field">CimInstanceComputerSet</a> = <span class="s">&quot;CimInstanceComputerSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Query computer set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="7e467d09d868d020" href="R/7e467d09d868d020.html" target="n" data-glyph="8,1" class="i field">QueryComputerSet</a> = <span class="s">&quot;QueryComputerSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Class name session set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="f9dae186ad0f7ff2" href="R/f9dae186ad0f7ff2.html" target="n" data-glyph="8,1" class="i field">ClassNameSessionSet</a> = <span class="s">&quot;ClassNameSessionSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resource Uri session set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="6071933035d52e87" href="R/6071933035d52e87.html" target="n" data-glyph="8,1" class="i field">ResourceUriSessionSet</a> = <span class="s">&quot;ResourceUriSessionSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimInstance</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> session set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="fe72b53ee6d3c2ba" href="R/fe72b53ee6d3c2ba.html" target="n" data-glyph="8,1" class="i field">CimInstanceSessionSet</a> = <span class="s">&quot;CimInstanceSessionSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Query session set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="1cac7eb49c671b64" href="R/1cac7eb49c671b64.html" target="n" data-glyph="8,1" class="i field">QuerySessionSet</a> = <span class="s">&quot;QuerySessionSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimClass</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> computer set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="ebd2558ba92fef97" href="R/ebd2558ba92fef97.html" target="n" data-glyph="8,1" class="i field">CimClassComputerSet</a> = <span class="s">&quot;CimClassComputerSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">CimClass</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> session set name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="eef5e23090778658" href="R/eef5e23090778658.html" target="n" data-glyph="8,1" class="i field">CimClassSessionSet</a> = <span class="s">&quot;CimClassSessionSet&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Session related parameter set name
 
        <b>internal const string</b> <a id="ced06cf63a284cc2" href="R/ced06cf63a284cc2.html" target="n" data-glyph="8,1" class="i field">ComputerNameSet</a> = <span class="s">&quot;ComputerNameSet&quot;</span>;
        <b>internal const string</b> <a id="6b0c09000669cbe2" href="R/6b0c09000669cbe2.html" target="n" data-glyph="8,1" class="i field">SessionIdSet</a> = <span class="s">&quot;SessionIdSet&quot;</span>;
        <b>internal const string</b> <a id="b8659ba7ea00bb63" href="R/b8659ba7ea00bb63.html" target="n" data-glyph="8,1" class="i field">InstanceIdSet</a> = <span class="s">&quot;InstanceIdSet&quot;</span>;
        <b>internal const string</b> <a id="fb1f1e5a5a6f4e49" href="R/fb1f1e5a5a6f4e49.html" target="n" data-glyph="8,1" class="i field">NameSet</a> = <span class="s">&quot;NameSet&quot;</span>;
        <b>internal const string</b> <a id="d76bf4a7a4c8e854" href="R/d76bf4a7a4c8e854.html" target="n" data-glyph="8,1" class="i field">CimSessionSet</a> = <span class="s">&quot;CimSessionSet&quot;</span>;
        <b>internal const string</b> <a id="3447a1a8ff2b4dce" href="R/3447a1a8ff2b4dce.html" target="n" data-glyph="8,1" class="i field">WSManParameterSet</a> = <span class="s">&quot;WSManParameterSet&quot;</span>;
        <b>internal const string</b> <a id="bb2da356f5f946ab" href="R/bb2da356f5f946ab.html" target="n" data-glyph="8,1" class="i field">DcomParameterSet</a> = <span class="s">&quot;DcomParameterSet&quot;</span>;
        <b>internal const string</b> <a id="bcf0dff94286b682" href="R/bcf0dff94286b682.html" target="n" data-glyph="8,1" class="i field">ProtocolNameParameterSet</a> = <span class="s">&quot;ProtocolTypeSet&quot;</span>;
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> register cimindication parameter set name
        <b>internal const string</b> <a id="a2257a6b147922e9" href="R/a2257a6b147922e9.html" target="n" data-glyph="8,1" class="i field">QueryExpressionSessionSet</a> = <span class="s">&quot;QueryExpressionSessionSet&quot;</span>;
        <b>internal const string</b> <a id="1fdd0274f1e46db4" href="R/1fdd0274f1e46db4.html" target="n" data-glyph="8,1" class="i field">QueryExpressionComputerSet</a> = <span class="s">&quot;QueryExpressionComputerSet&quot;</span>;
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Credential parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="17c939848adb621d" href="R/17c939848adb621d.html" target="n" data-glyph="8,1" class="i field">CredentialParameterSet</a> = <span class="s">&quot;CredentialParameterSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Certificate parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="757487e3ef10e655" href="R/757487e3ef10e655.html" target="n" data-glyph="8,1" class="i field">CertificateParameterSet</a> = <span class="s">&quot;CertificateParameterSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CimInstance parameter alias.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="0ecb2bf11ed7772e" href="R/0ecb2bf11ed7772e.html" target="n" data-glyph="8,1" class="i field">AliasCimInstance</a> = <span class="s">&quot;CimInstance&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> internal helper function
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Throw invalid AuthenticationType</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">operationName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">authentication</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="810e4698ad510686" href="R/810e4698ad510686.html" target="n" data-glyph="74,1" class="i method">ThrowInvalidAuthenticationTypeError</a>(
            <b>string</b> <span id="r35 rd" class="r35 r">operationName</span>,
            <b>string</b> <span id="r36 rd" class="r36 r">parameterName</span>,
            <span class="i">PasswordAuthenticationMechanism</span> <span id="r37 rd" class="r37 r">authentication</span>)
        {
            <b>string</b> <span id="r38 rd" class="r38 r">message</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="i">CimCmdletStrings</span>.<span class="i">InvalidAuthenticationTypeWithNullCredential</span>,
                <span class="r37 r">authentication</span>,
                <span class="i">ImpersonatedAuthenticationMechanism</span>.<span class="i">None</span>,
                <span class="i">ImpersonatedAuthenticationMechanism</span>.<span class="i">Negotiate</span>,
                <span class="i">ImpersonatedAuthenticationMechanism</span>.<span class="i">Kerberos</span>,
                <span class="i">ImpersonatedAuthenticationMechanism</span>.<span class="i">NtlmDomain</span>);
            <a href="/System.Management.Automation/A.html#30c91f7bd86d4aba" class="t t">PSArgumentOutOfRangeException</a> <span id="r39 rd" class="r39 r">exception</span> = <b>new</b>(
                <span class="r36 r">parameterName</span>, <span class="r37 r">authentication</span>, <span class="r38 r">message</span>);
            <span class="i">ThrowTerminatingError</span>(<span class="r39 r">exception</span>, <span class="r35 r">operationName</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Throw conflict parameter error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">operationName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">conflictParameterName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="9083d5672630d81c" href="R/9083d5672630d81c.html" target="n" data-glyph="74,1" class="i method">ThrowConflictParameterWasSet</a>(
            <b>string</b> <span id="r40 rd" class="r40 r">operationName</span>,
            <b>string</b> <span id="r41 rd" class="r41 r">parameterName</span>,
            <b>string</b> <span id="r42 rd" class="r42 r">conflictParameterName</span>)
        {
            <b>string</b> <span id="r43 rd" class="r43 r">message</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>,
                <span class="i">CimCmdletStrings</span>.<span class="i">ConflictParameterWasSet</span>,
                <span class="r41 r">parameterName</span>, <span class="r42 r">conflictParameterName</span>);
            <a href="/System.Management.Automation/A.html#581bd9b947689819" class="t t">PSArgumentException</a> <span id="r44 rd" class="r44 r">exception</span> = <b>new</b>(<span class="r43 r">message</span>, <span class="r41 r">parameterName</span>);
            <span class="i">ThrowTerminatingError</span>(<span class="r44 r">exception</span>, <span class="r40 r">operationName</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Throw not found property error</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">para</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="20849e71e92ab892" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ThrowInvalidProperty</a>(
            <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r45 rd" class="r45 r">propertiesList</span>,
            <b>string</b> <span id="r46 rd" class="r46 r">className</span>,
            <b>string</b> <span id="r47 rd" class="r47 r">parameterName</span>,
            <b>string</b> <span id="r48 rd" class="r48 r">operationName</span>,
            <span class="i">IDictionary</span> <span id="r49 rd" class="r49 r">actualValue</span>)
        {
            <span class="i">StringBuilder</span> <span id="r50 rd" class="r50 r">propList</span> = <b>new</b>();
            <b>foreach</b> (<b>string</b> <span id="r51 rd" class="r51 r">property</span> <b>in</b> <span class="r45 r">propertiesList</span>)
            {
                <b>if</b> (<span class="r50 r">propList</span>.<span class="i">Length</span> &gt; 0)
                {
                    <span class="r50 r">propList</span>.<span class="i">Append</span>(<span class="s">&#39;,&#39;</span>);
                }
 
                <span class="r50 r">propList</span>.<span class="i">Append</span>(<span class="r51 r">property</span>);
            }
 
            <b>string</b> <span id="r52 rd" class="r52 r">message</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="i">CimCmdletStrings</span>.<span class="i">CouldNotFindPropertyFromGivenClass</span>,
                <span class="r46 r">className</span>, <span class="r50 r">propList</span>);
            <a href="/System.Management.Automation/A.html#30c91f7bd86d4aba" class="t t">PSArgumentOutOfRangeException</a> <span id="r53 rd" class="r53 r">exception</span> = <b>new</b>(
                <span class="r47 r">parameterName</span>, <span class="r49 r">actualValue</span>, <span class="r52 r">message</span>);
            <span class="i">ThrowTerminatingError</span>(<span class="r53 r">exception</span>, <span class="r48 r">operationName</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create credentials based on given authentication type and PSCredential.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">psCredentials</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">passwordAuthentication</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">CimCredential</span> <a id="23394e9095ca1591" href="R/23394e9095ca1591.html" target="n" data-glyph="74,1" class="i method">CreateCimCredentials</a>(<a href="/System.Management.Automation/A.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r54 rd" class="r54 r">psCredentials</span>,
            <span class="i">PasswordAuthenticationMechanism</span> <span id="r55 rd" class="r55 r">passwordAuthentication</span>,
            <b>string</b> <span id="r56 rd" class="r56 r">operationName</span>,
            <b>string</b> <span id="r57 rd" class="r57 r">parameterName</span>)
        {
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;PSCredential:{0}; PasswordAuthenticationMechanism:{1}; operationName:{2}; parameterName:{3}.&quot;</span>, 0, <span class="r54 r">psCredentials</span>, <span class="r55 r">passwordAuthentication</span>, <span class="r56 r">operationName</span>, <span class="r57 r">parameterName</span>);
 
            <span class="i">CimCredential</span> <span id="r58 rd" class="r58 r">credentials</span> = <b>null</b>;
            <b>if</b> (<span class="r54 r">psCredentials</span> != <b>null</b>)
            {
                <span class="i">NetworkCredential</span> <span id="r59 rd" class="r59 r">networkCredential</span> = <span class="r54 r">psCredentials</span>.<span class="i">GetNetworkCredential</span>();
                <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLog</span>(<span class="s">&quot;Domain:{0}; UserName:{1}; Password:{2}.&quot;</span>, 1, <span class="r59 r">networkCredential</span>.<span class="i">Domain</span>, <span class="r59 r">networkCredential</span>.<span class="i">UserName</span>, <span class="r54 r">psCredentials</span>.<a href="/System.Management.Automation/A.html#828d5fa008f1755c" class="i property">Password</a>);
                <span class="r58 r">credentials</span> = <b>new</b> <span class="i">CimCredential</span>(<span class="r55 r">passwordAuthentication</span>, <span class="r59 r">networkCredential</span>.<span class="i">Domain</span>, <span class="r59 r">networkCredential</span>.<span class="i">UserName</span>, <span class="r54 r">psCredentials</span>.<a href="/System.Management.Automation/A.html#828d5fa008f1755c" class="i property">Password</a>);
            }
            <b>else</b>
            {
                <span class="i">ImpersonatedAuthenticationMechanism</span> <span id="r60 rd" class="r60 r">impersonatedAuthentication</span>;
                <b>switch</b> (<span class="r55 r">passwordAuthentication</span>)
                {
                    <b>case</b> <span class="i">PasswordAuthenticationMechanism</span>.<span class="i">Default</span>:
                        <span class="r60 r">impersonatedAuthentication</span> = <span class="i">ImpersonatedAuthenticationMechanism</span>.<span class="i">None</span>;
                        <b>break</b>;
                    <b>case</b> <span class="i">PasswordAuthenticationMechanism</span>.<span class="i">Negotiate</span>:
                        <span class="r60 r">impersonatedAuthentication</span> = <span class="i">ImpersonatedAuthenticationMechanism</span>.<span class="i">Negotiate</span>;
                        <b>break</b>;
                    <b>case</b> <span class="i">PasswordAuthenticationMechanism</span>.<span class="i">Kerberos</span>:
                        <span class="r60 r">impersonatedAuthentication</span> = <span class="i">ImpersonatedAuthenticationMechanism</span>.<span class="i">Kerberos</span>;
                        <b>break</b>;
                    <b>case</b> <span class="i">PasswordAuthenticationMechanism</span>.<span class="i">NtlmDomain</span>:
                        <span class="r60 r">impersonatedAuthentication</span> = <span class="i">ImpersonatedAuthenticationMechanism</span>.<span class="i">NtlmDomain</span>;
                        <b>break</b>;
                    <b>default</b>:
                        <a href="#810e4698ad510686" class="i method">ThrowInvalidAuthenticationTypeError</a>(<span class="r56 r">operationName</span>, <span class="r57 r">parameterName</span>, <span class="r55 r">passwordAuthentication</span>);
                        <b>return</b> <b>null</b>;
                }
 
                <span class="r58 r">credentials</span> = <b>new</b> <span class="i">CimCredential</span>(<span class="r60 r">impersonatedAuthentication</span>);
            }
 
            <a href="Utils.cs.html#6b0644b87482dbb3" class="t t">DebugHelper</a>.<span class="i">WriteLogEx</span>(<span class="s">&quot;return credential {0}&quot;</span>, 1, <span class="r58 r">credentials</span>);
            <b>return</b> <span class="r58 r">credentials</span>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
