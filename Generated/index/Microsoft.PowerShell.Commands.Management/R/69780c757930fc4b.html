<!DOCTYPE html>
<html><head><title>NativeMethods</title><link rel="stylesheet" href="../../styles.css"/><script src="../../scripts.js"></script></head><body onload="ro();">
<div class="rH">28 references to NativeMethods</div><div class="rA">Microsoft.PowerShell.Commands.Management (28)</div><div class="rG" id="Microsoft.PowerShell.Commands.Management"><div class="rF"><div class="rN">commands\management\TimeZoneCommands.cs (28)</div>
<a href="../commands/management/TimeZoneCommands.cs.html#257"><b>257</b><i>NativeMethods</i>.DYNAMIC_TIME_ZONE_INFORMATION dtzi = new();</a>
<a href="../commands/management/TimeZoneCommands.cs.html#264"><b>264</b><i>NativeMethods</i>.TIME_ZONE_INFORMATION tzi = new();</a>
<a href="../commands/management/TimeZoneCommands.cs.html#265"><b>265</b>if (!<i>NativeMethods</i>.GetTimeZoneInformationForYear((ushort)DateTime.Now.Year, ref dtzi, ref tzi))</a>
<a href="../commands/management/TimeZoneCommands.cs.html#277"><b>277</b>if (!<i>NativeMethods</i>.SetDynamicTimeZoneInformation(ref dtzi))</a>
<a href="../commands/management/TimeZoneCommands.cs.html#285"><b>285</b><i>NativeMethods</i>.SendMessageTimeout((IntPtr)<i>NativeMethods</i>.HWND_BROADCAST, <i>NativeMethods</i>.WM_SETTINGCHANGE,</a>
<a href="../commands/management/TimeZoneCommands.cs.html#286"><b>286</b>(IntPtr)0, &quot;intl&quot;, <i>NativeMethods</i>.SMTO_ABORTIFHUNG, 5000, ref result);</a>
<a href="../commands/management/TimeZoneCommands.cs.html#336"><b>336</b>IntPtr hProcess = <i>NativeMethods</i>.GetCurrentProcess();</a>
<a href="../commands/management/TimeZoneCommands.cs.html#337"><b>337</b>if (!<i>NativeMethods</i>.OpenProcessToken(hProcess,</a>
<a href="../commands/management/TimeZoneCommands.cs.html#338"><b>338</b><i>NativeMethods</i>.TOKEN_ADJUST_PRIVILEGES | <i>NativeMethods</i>.TOKEN_QUERY, ref hToken))</a>
<a href="../commands/management/TimeZoneCommands.cs.html#346"><b>346</b><i>NativeMethods</i>.PRIVILEGE_SET ps = new()</a>
<a href="../commands/management/TimeZoneCommands.cs.html#351"><b>351</b>Attributes = <i>NativeMethods</i>.SE_PRIVILEGE_ENABLED,</a>
<a href="../commands/management/TimeZoneCommands.cs.html#355"><b>355</b>if (!<i>NativeMethods</i>.LookupPrivilegeValue(null, <i>NativeMethods</i>.SE_TIME_ZONE_NAME, ref ps.Luid))</a>
<a href="../commands/management/TimeZoneCommands.cs.html#361"><b>361</b>if (!<i>NativeMethods</i>.PrivilegeCheck(hToken, ref ps, ref hasAccess))</a>
<a href="../commands/management/TimeZoneCommands.cs.html#368"><b>368</b><i>NativeMethods</i>.CloseHandle(hToken);</a>
<a href="../commands/management/TimeZoneCommands.cs.html#383"><b>383</b>IntPtr hProcess = <i>NativeMethods</i>.GetCurrentProcess();</a>
<a href="../commands/management/TimeZoneCommands.cs.html#384"><b>384</b>if (!<i>NativeMethods</i>.OpenProcessToken(hProcess,</a>
<a href="../commands/management/TimeZoneCommands.cs.html#385"><b>385</b><i>NativeMethods</i>.TOKEN_ADJUST_PRIVILEGES | <i>NativeMethods</i>.TOKEN_QUERY, ref hToken))</a>
<a href="../commands/management/TimeZoneCommands.cs.html#393"><b>393</b><i>NativeMethods</i>.TOKEN_PRIVILEGES tp = new()</a>
<a href="../commands/management/TimeZoneCommands.cs.html#397"><b>397</b>Attributes = (enable ? <i>NativeMethods</i>.SE_PRIVILEGE_ENABLED : 0),</a>
<a href="../commands/management/TimeZoneCommands.cs.html#401"><b>401</b>if (!<i>NativeMethods</i>.LookupPrivilegeValue(null, <i>NativeMethods</i>.SE_TIME_ZONE_NAME, ref tp.Luid))</a>
<a href="../commands/management/TimeZoneCommands.cs.html#407"><b>407</b>if (!<i>NativeMethods</i>.AdjustTokenPrivileges(hToken, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero))</a>
<a href="../commands/management/TimeZoneCommands.cs.html#414"><b>414</b><i>NativeMethods</i>.CloseHandle(hToken);</a>
</div>
</div>
</body></html>