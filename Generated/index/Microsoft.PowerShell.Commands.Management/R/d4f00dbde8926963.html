<!DOCTYPE html>
<html><head><title>NativeMethods</title><link rel="stylesheet" href="../../styles.css"/><script src="../../scripts.js"></script></head><body onload="ro();">
<div class="rH">87 references to NativeMethods</div><div class="rA">Microsoft.PowerShell.Commands.Management (87)</div><div class="rG" id="Microsoft.PowerShell.Commands.Management"><div class="rF"><div class="rN">commands\management\Process.cs (3)</div>
<a href="../commands/management/Process.cs.html#2633"><b>2633</b>IntPtr jobObjectHandleIntPtr = <i>NativeMethods</i>.CreateJobObject(IntPtr.Zero, null);</a>
<a href="../commands/management/Process.cs.html#2644"><b>2644</b>bool result = <i>NativeMethods</i>.AssignProcessToJobObject(_jobObjectHandle, process.Handle);</a>
<a href="../commands/management/Process.cs.html#2660"><b>2660</b>if (<i>NativeMethods</i>.QueryInformationJobObject(_jobObjectHandle,</a>
</div>
<div class="rF"><div class="rN">commands\management\Service.cs (84)</div>
<a href="../commands/management/Service.cs.html#129"><b>129</b>bool status = <i>NativeMethods</i>.SetServiceObjectSecurity(</a>
<a href="../commands/management/Service.cs.html#138"><b>138</b>bool accessDenied = exception.NativeErrorCode == <i>NativeMethods</i>.ERROR_ACCESS_DENIED;</a>
<a href="../commands/management/Service.cs.html#655"><b>655</b>hScManager = <i>NativeMethods</i>.OpenSCManagerW(</a>
<a href="../commands/management/Service.cs.html#658"><b>658</b>dwDesiredAccess: <i>NativeMethods</i>.SC_MANAGER_CONNECT</a>
<a href="../commands/management/Service.cs.html#672"><b>672</b>hService = <i>NativeMethods</i>.OpenServiceW(</a>
<a href="../commands/management/Service.cs.html#675"><b>675</b><i>NativeMethods</i>.SERVICE_QUERY_CONFIG</a>
<a href="../commands/management/Service.cs.html#689"><b>689</b><i>NativeMethods</i>.SERVICE_DESCRIPTIONW description = new();</a>
<a href="../commands/management/Service.cs.html#690"><b>690</b>bool querySuccessful = <i>NativeMethods</i>.QueryServiceConfig2&lt;<i>NativeMethods</i>.SERVICE_DESCRIPTIONW&gt;(hService, <i>NativeMethods</i>.SERVICE_CONFIG_DESCRIPTION, out description);</a>
<a href="../commands/management/Service.cs.html#692"><b>692</b><i>NativeMethods</i>.SERVICE_DELAYED_AUTO_START_INFO autostartInfo = new();</a>
<a href="../commands/management/Service.cs.html#693"><b>693</b>querySuccessful = querySuccessful &amp;&amp; <i>NativeMethods</i>.QueryServiceConfig2&lt;<i>NativeMethods</i>.SERVICE_DELAYED_AUTO_START_INFO&gt;(hService, <i>NativeMethods</i>.SERVICE_CONFIG_DELAYED_AUTO_START_INFO, out autostartInfo);</a>
<a href="../commands/management/Service.cs.html#695"><b>695</b><i>NativeMethods</i>.QUERY_SERVICE_CONFIG serviceInfo = new();</a>
<a href="../commands/management/Service.cs.html#696"><b>696</b>querySuccessful = querySuccessful &amp;&amp; <i>NativeMethods</i>.QueryServiceConfig(hService, out serviceInfo);</a>
<a href="../commands/management/Service.cs.html#725"><b>725</b>noteProperty = new PSProperty(&quot;StartupType&quot;, <i>NativeMethods</i>.GetServiceStartupType(service.StartType, autostartInfo.fDelayedAutostart));</a>
<a href="../commands/management/Service.cs.html#733"><b>733</b>bool succeeded = <i>NativeMethods</i>.CloseServiceHandle(hService);</a>
<a href="../commands/management/Service.cs.html#742"><b>742</b>bool succeeded = <i>NativeMethods</i>.CloseServiceHandle(hScManager);</a>
<a href="../commands/management/Service.cs.html#901"><b>901</b>if (e.NativeErrorCode != <i>NativeMethods</i>.ERROR_SERVICE_ALREADY_RUNNING)</a>
<a href="../commands/management/Service.cs.html#908"><b>908</b>|| eInner.NativeErrorCode != <i>NativeMethods</i>.ERROR_SERVICE_ALREADY_RUNNING)</a>
<a href="../commands/management/Service.cs.html#1018"><b>1018</b>if (e.NativeErrorCode != <i>NativeMethods</i>.ERROR_SERVICE_NOT_ACTIVE)</a>
<a href="../commands/management/Service.cs.html#1026"><b>1026</b>|| eInner.NativeErrorCode != <i>NativeMethods</i>.ERROR_SERVICE_NOT_ACTIVE)</a>
<a href="../commands/management/Service.cs.html#1111"><b>1111</b>if (e.NativeErrorCode == <i>NativeMethods</i>.ERROR_SERVICE_NOT_ACTIVE)</a>
<a href="../commands/management/Service.cs.html#1122"><b>1122</b>&amp;&amp; eInner.NativeErrorCode == <i>NativeMethods</i>.ERROR_SERVICE_NOT_ACTIVE)</a>
<a href="../commands/management/Service.cs.html#1192"><b>1192</b>if (e.NativeErrorCode == <i>NativeMethods</i>.ERROR_SERVICE_NOT_ACTIVE)</a>
<a href="../commands/management/Service.cs.html#1203"><b>1203</b>&amp;&amp; eInner.NativeErrorCode == <i>NativeMethods</i>.ERROR_SERVICE_NOT_ACTIVE)</a>
<a href="../commands/management/Service.cs.html#1740"><b>1740</b>hScManager = <i>NativeMethods</i>.OpenSCManagerW(</a>
<a href="../commands/management/Service.cs.html#1743"><b>1743</b><i>NativeMethods</i>.SC_MANAGER_CONNECT</a>
<a href="../commands/management/Service.cs.html#1759"><b>1759</b>hService = <i>NativeMethods</i>.OpenServiceW(</a>
<a href="../commands/management/Service.cs.html#1762"><b>1762</b><i>NativeMethods</i>.SERVICE_CHANGE_CONFIG | <i>NativeMethods</i>.WRITE_DAC | <i>NativeMethods</i>.WRITE_OWNER</a>
<a href="../commands/management/Service.cs.html#1781"><b>1781</b>DWORD dwStartType = <i>NativeMethods</i>.SERVICE_NO_CHANGE;</a>
<a href="../commands/management/Service.cs.html#1782"><b>1782</b>if (!<i>NativeMethods</i>.TryGetNativeStartupType(StartupType, out dwStartType))</a>
<a href="../commands/management/Service.cs.html#1798"><b>1798</b>bool succeeded = <i>NativeMethods</i>.ChangeServiceConfigW(</a>
<a href="../commands/management/Service.cs.html#1800"><b>1800</b><i>NativeMethods</i>.SERVICE_NO_CHANGE,</a>
<a href="../commands/management/Service.cs.html#1802"><b>1802</b><i>NativeMethods</i>.SERVICE_NO_CHANGE,</a>
<a href="../commands/management/Service.cs.html#1825"><b>1825</b><i>NativeMethods</i>.SERVICE_DESCRIPTIONW sd = new();</a>
<a href="../commands/management/Service.cs.html#1831"><b>1831</b>bool status = <i>NativeMethods</i>.ChangeServiceConfig2W(</a>
<a href="../commands/management/Service.cs.html#1833"><b>1833</b><i>NativeMethods</i>.SERVICE_CONFIG_DESCRIPTION,</a>
<a href="../commands/management/Service.cs.html#1849"><b>1849</b><i>NativeMethods</i>.SERVICE_DELAYED_AUTO_START_INFO ds = new();</a>
<a href="../commands/management/Service.cs.html#1855"><b>1855</b>status = <i>NativeMethods</i>.ChangeServiceConfig2W(</a>
<a href="../commands/management/Service.cs.html#1857"><b>1857</b><i>NativeMethods</i>.SERVICE_CONFIG_DELAYED_AUTO_START_INFO,</a>
<a href="../commands/management/Service.cs.html#1936"><b>1936</b>bool succeeded = <i>NativeMethods</i>.CloseServiceHandle(hService);</a>
<a href="../commands/management/Service.cs.html#1952"><b>1952</b>bool succeeded = <i>NativeMethods</i>.CloseServiceHandle(hScManager);</a>
<a href="../commands/management/Service.cs.html#2137"><b>2137</b>hScManager = <i>NativeMethods</i>.OpenSCManagerW(</a>
<a href="../commands/management/Service.cs.html#2140"><b>2140</b><i>NativeMethods</i>.SC_MANAGER_CONNECT | <i>NativeMethods</i>.SC_MANAGER_CREATE_SERVICE</a>
<a href="../commands/management/Service.cs.html#2157"><b>2157</b>if (!<i>NativeMethods</i>.TryGetNativeStartupType(StartupType, out DWORD dwStartType))</a>
<a href="../commands/management/Service.cs.html#2204"><b>2204</b>hService = <i>NativeMethods</i>.CreateServiceW(</a>
<a href="../commands/management/Service.cs.html#2208"><b>2208</b><i>NativeMethods</i>.SERVICE_CHANGE_CONFIG | <i>NativeMethods</i>.WRITE_DAC | <i>NativeMethods</i>.WRITE_OWNER,</a>
<a href="../commands/management/Service.cs.html#2209"><b>2209</b><i>NativeMethods</i>.SERVICE_WIN32_OWN_PROCESS,</a>
<a href="../commands/management/Service.cs.html#2211"><b>2211</b><i>NativeMethods</i>.SERVICE_ERROR_NORMAL,</a>
<a href="../commands/management/Service.cs.html#2235"><b>2235</b><i>NativeMethods</i>.SERVICE_DESCRIPTIONW sd = new();</a>
<a href="../commands/management/Service.cs.html#2241"><b>2241</b>bool succeeded = <i>NativeMethods</i>.ChangeServiceConfig2W(</a>
<a href="../commands/management/Service.cs.html#2243"><b>2243</b><i>NativeMethods</i>.SERVICE_CONFIG_DESCRIPTION,</a>
<a href="../commands/management/Service.cs.html#2263"><b>2263</b><i>NativeMethods</i>.SERVICE_DELAYED_AUTO_START_INFO ds = new();</a>
<a href="../commands/management/Service.cs.html#2269"><b>2269</b>succeeded = <i>NativeMethods</i>.ChangeServiceConfig2W(</a>
<a href="../commands/management/Service.cs.html#2271"><b>2271</b><i>NativeMethods</i>.SERVICE_CONFIG_DELAYED_AUTO_START_INFO,</a>
<a href="../commands/management/Service.cs.html#2313"><b>2313</b>bool succeeded = <i>NativeMethods</i>.CloseServiceHandle(hService);</a>
<a href="../commands/management/Service.cs.html#2331"><b>2331</b>bool succeeded = <i>NativeMethods</i>.CloseServiceHandle(hScManager);</a>
<a href="../commands/management/Service.cs.html#2436"><b>2436</b>hScManager = <i>NativeMethods</i>.OpenSCManagerW(</a>
<a href="../commands/management/Service.cs.html#2439"><b>2439</b>dwDesiredAccess: <i>NativeMethods</i>.SC_MANAGER_ALL_ACCESS</a>
<a href="../commands/management/Service.cs.html#2455"><b>2455</b>hService = <i>NativeMethods</i>.OpenServiceW(</a>
<a href="../commands/management/Service.cs.html#2458"><b>2458</b><i>NativeMethods</i>.SERVICE_DELETE</a>
<a href="../commands/management/Service.cs.html#2473"><b>2473</b>bool status = <i>NativeMethods</i>.DeleteService(hService);</a>
<a href="../commands/management/Service.cs.html#2491"><b>2491</b>bool succeeded = <i>NativeMethods</i>.CloseServiceHandle(hService);</a>
<a href="../commands/management/Service.cs.html#2501"><b>2501</b>bool succeeded = <i>NativeMethods</i>.CloseServiceHandle(hScManager);</a>
<a href="../commands/management/Service.cs.html#2827"><b>2827</b>internal static bool QueryServiceConfig(NakedWin32Handle hService, out <i>NativeMethods</i>.QUERY_SERVICE_CONFIG configStructure)</a>
<a href="../commands/management/Service.cs.html#2830"><b>2830</b>configStructure = default(<i>NativeMethods</i>.QUERY_SERVICE_CONFIG);</a>
<a href="../commands/management/Service.cs.html#2832"><b>2832</b>bool status = <i>NativeMethods</i>.QueryServiceConfigW(</a>
<a href="../commands/management/Service.cs.html#2848"><b>2848</b>status = <i>NativeMethods</i>.QueryServiceConfigW(</a>
<a href="../commands/management/Service.cs.html#2853"><b>2853</b>configStructure = (<i>NativeMethods</i>.QUERY_SERVICE_CONFIG)Marshal.PtrToStructure(lpBuffer, typeof(<i>NativeMethods</i>.QUERY_SERVICE_CONFIG));</a>
<a href="../commands/management/Service.cs.html#2869"><b>2869</b>bool status = <i>NativeMethods</i>.QueryServiceConfig2W(</a>
<a href="../commands/management/Service.cs.html#2886"><b>2886</b>status = <i>NativeMethods</i>.QueryServiceConfig2W(</a>
<a href="../commands/management/Service.cs.html#2917"><b>2917</b>dwStartType = <i>NativeMethods</i>.SERVICE_NO_CHANGE;</a>
<a href="../commands/management/Service.cs.html#2922"><b>2922</b>dwStartType = <i>NativeMethods</i>.SERVICE_AUTO_START;</a>
<a href="../commands/management/Service.cs.html#2925"><b>2925</b>dwStartType = <i>NativeMethods</i>.SERVICE_DEMAND_START;</a>
<a href="../commands/management/Service.cs.html#2928"><b>2928</b>dwStartType = <i>NativeMethods</i>.SERVICE_DISABLED;</a>
<a href="../commands/management/Service.cs.html#2931"><b>2931</b>dwStartType = <i>NativeMethods</i>.SERVICE_NO_CHANGE;</a>
</div>
</div>
</body></html>