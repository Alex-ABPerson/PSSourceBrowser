<!DOCTYPE html>
<html><head><title>Navigation.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(4222);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Management/commands/management/Navigation.cs" target="_top">commands\management\Navigation.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Management" target="_top">src\Microsoft.PowerShell.Commands.Management\Microsoft.PowerShell.Commands.Management.csproj</a> (Microsoft.PowerShell.Commands.Management)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i">System</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Management</span>.<span class="i">Automation</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Management</span>.<span class="i">Automation</span>.<span class="i">Internal</span>;
<b>using</b> <span class="i">System</span>.<span class="i">Management</span>.<span class="i">Automation</span>.<span class="i">Provider</span>;
 
<b>using</b> <span class="i">Dbg</span> = <span class="i">System</span>.<span class="i">Management</span>.<span class="i">Automation</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CoreCommandBase
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The base command for the core commands.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="31745b2c942d5ae6" href="../../R/31745b2c942d5ae6.html" target="n" data-glyph="0,0" class="t t"><span id="b13a69cda8e67e3f">CoreCommandBase</span></a> : <span class="i">PSCmdlet</span>, <span class="i">IDynamicParameters</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Tracer
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of the PSTraceSource class used for trace output</span>
        <span class="c">///</span><span class="c"> using &quot;NavigationCommands&quot; as the category.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Dbg</span>.<span class="i">TraceSourceAttribute</span>(<span class="s">&quot;NavigationCommands&quot;</span>, <span class="s">&quot;The namespace navigation tracer&quot;</span>)]
        <b>internal static readonly</b> <span class="i">Dbg</span>.<span class="i">PSTraceSource</span> <a id="3b36b44a7a5db63e" href="../../R/3b36b44a7a5db63e.html" target="n" data-glyph="44,1" class="i field">tracer</a> = <span class="i">Dbg</span>.<span class="i">PSTraceSource</span>.<span class="i">GetTracer</span>(<span class="s">&quot;NavigationCommands&quot;</span>, <span class="s">&quot;The namespace navigation tracer&quot;</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Tracer
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Protected members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context for the command that is passed to the core command providers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual</b> <span class="i">CmdletProviderContext</span> <a id="5aabca2de4eb131c" href="../../R/5aabca2de4eb131c.html" target="n" data-glyph="104,1" class="i property">CmdletProviderContext</a>
        {
            <b>get</b>
            {
                <span class="i">CmdletProviderContext</span> <span id="r0 rd" class="r0 r">coreCommandContext</span> = <b>new</b>(<a href="#31745b2c942d5ae6" class="k">this</a>);
 
                <span class="r0 r">coreCommandContext</span>.<span class="i">Force</span> = <a href="#e526073d49c1c7c1" class="i property">Force</a>;
 
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r1 rd" class="r1 r">includeFilter</span> =
                    <span class="i">SessionStateUtilities</span>.<span class="i">ConvertArrayToCollection</span>&lt;<b>string</b>&gt;(<a href="#953eaff5f53e6629" class="i property">Include</a>);
 
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r2 rd" class="r2 r">excludeFilter</span> =
                    <span class="i">SessionStateUtilities</span>.<span class="i">ConvertArrayToCollection</span>&lt;<b>string</b>&gt;(<a href="#2121159277b72236" class="i property">Exclude</a>);
 
                <span class="r0 r">coreCommandContext</span>.<span class="i">SetFilters</span>(<span class="r1 r">includeFilter</span>, <span class="r2 r">excludeFilter</span>, <a href="#044d90d664ea29d1" class="i property">Filter</a>);
                <span class="r0 r">coreCommandContext</span>.<span class="i">SuppressWildcardExpansion</span> = <a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a>;
                <span class="r0 r">coreCommandContext</span>.<span class="i">DynamicParameters</span> = <a href="#e8a298d1be79229d" class="i property">RetrievedDynamicParameters</a>;
                <a href="#2ae1dad440757c3f" class="i field">stopContextCollection</a>.<span class="i">Add</span>(<span class="r0 r">coreCommandContext</span>);
 
                <b>return</b> <span class="r0 r">coreCommandContext</span>;
            }
        }
 
        <b>internal virtual</b> <span class="i">SwitchParameter</span> <a id="931307739450f618" href="../../R/931307739450f618.html" target="n" data-glyph="104,1" class="i property">SuppressWildcardExpansion</a>
        {
            <b>get</b> =&gt; <a href="#7189d2905b065992" class="i field">_suppressWildcardExpansion</a>;
            <b>set</b> =&gt; <a href="#7189d2905b065992" class="i field">_suppressWildcardExpansion</a> = <b>value</b>;
        }
 
        <b>private bool</b> <a id="7189d2905b065992" href="../../R/7189d2905b065992.html" target="n" data-glyph="46,1" class="i field">_suppressWildcardExpansion</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A virtual method for retrieving the dynamic parameters for a cmdlet. Derived cmdlets</span>
        <span class="c">///</span><span class="c"> that require dynamic parameters should override this method and return the</span>
        <span class="c">///</span><span class="c"> dynamic parameter object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the command is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object representing the dynamic parameters for the cmdlet or null if there</span>
        <span class="c">///</span><span class="c"> are none.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual object</b> <a id="44c36827175940dc" href="../../R/44c36827175940dc.html" target="n" data-glyph="74,1" class="i method">GetDynamicParameters</a>(<span class="i">CmdletProviderContext</span> <span id="r3 rd" class="r3 r">context</span>) =&gt; <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called by the base implementation that checks the SupportShouldProcess provider</span>
        <span class="c">///</span><span class="c"> capability. This virtual method gives the</span>
        <span class="c">///</span><span class="c"> derived cmdlet a chance query the CmdletProvider capabilities to determine</span>
        <span class="c">///</span><span class="c"> if the provider supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>protected virtual bool</b> <a id="8217a8ab2ffe5ba3" href="../../R/8217a8ab2ffe5ba3.html" target="n" data-glyph="105,1" class="i property">ProviderSupportsShouldProcess</a> =&gt; <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A helper for derived classes to call to determine if the paths specified</span>
        <span class="c">///</span><span class="c"> are for a provider that supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">paths</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The paths to check to see if the providers support ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the paths are to different providers, and any don&#39;t support</span>
        <span class="c">///</span><span class="c"> ShouldProcess, then the return value is false. If they all</span>
        <span class="c">///</span><span class="c"> support ShouldProcess then the return value is true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected bool</b> <a id="406a819cd9871eb1" href="../../R/406a819cd9871eb1.html" target="n" data-glyph="75,1" class="i method">DoesProviderSupportShouldProcess</a>(<b>string</b>[] <span id="r4 rd" class="r4 r">paths</span>)
        {
            <span class="c">// If no paths are specified, then default to true as the paths</span>
            <span class="c">// may be getting piped in.</span>
            <b>bool</b> <span id="r5 rd" class="r5 r">result</span> = <b>true</b>;
 
            <b>if</b> (<span class="r4 r">paths</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>string</b> <span id="r6 rd" class="r6 r">path</span> <b>in</b> <span class="r4 r">paths</span>)
                {
                    <span class="i">ProviderInfo</span> <span id="r7 rd" class="r7 r">provider</span> = <b>null</b>;
                    <span class="i">PSDriveInfo</span> <span id="r8 rd" class="r8 r">drive</span> = <b>null</b>;
 
                    <span class="c">// I don&#39;t really care about the returned path, just the provider name</span>
                    <span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">GetUnresolvedProviderPathFromPSPath</span>(
                        <span class="r6 r">path</span>,
                        <a href="#31745b2c942d5ae6" class="k">this</a>.<a href="#5aabca2de4eb131c" class="i property">CmdletProviderContext</a>,
                        <b>out</b> <span class="r7 r">provider</span>,
                        <b>out</b> <span class="r8 r">drive</span>);
 
                    <span class="c">// Check the provider&#39;s capabilities</span>
 
                    <b>if</b> (!<span class="i">CmdletProviderManagementIntrinsics</span>.<span class="i">CheckProviderCapabilities</span>(
                            <span class="i">ProviderCapabilities</span>.<span class="i">ShouldProcess</span>,
                            <span class="r7 r">provider</span>))
                    {
                        <span class="r5 r">result</span> = <b>false</b>;
                        <b>break</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r5 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The dynamic parameters which have already been retrieved from the provider</span>
        <span class="c">///</span><span class="c"> and bound by the command processor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected internal object</b> <a id="e8a298d1be79229d" href="../../R/e8a298d1be79229d.html" target="n" data-glyph="105,1" class="i property">RetrievedDynamicParameters</a> =&gt; <a href="#ba520daa7a0e07cd" class="i field">_dynamicParameters</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The dynamic parameters for the command. They are retrieved using the</span>
        <span class="c">///</span><span class="c"> GetDynamicParameters virtual method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private object</b> <a id="ba520daa7a0e07cd" href="../../R/ba520daa7a0e07cd.html" target="n" data-glyph="46,1" class="i field">_dynamicParameters</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Protected members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stops the processing of the provider by using the</span>
        <span class="c">///</span><span class="c"> CmdletProviderContext to tunnel the stop message to</span>
        <span class="c">///</span><span class="c"> the provider instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="fa1b1b2d118090f3" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">StopProcessing</a>()
        {
            <b>foreach</b> (<span class="i">CmdletProviderContext</span> <span id="r9 rd" class="r9 r">stopContext</span> <b>in</b> <a href="#2ae1dad440757c3f" class="i field">stopContextCollection</a>)
            {
                <span class="r9 r">stopContext</span>.<span class="i">StopProcessing</span>();
            }
        }
 
        <b>internal</b> <span class="i">Collection</span>&lt;<span class="i">CmdletProviderContext</span>&gt; <a id="2ae1dad440757c3f" href="../../R/2ae1dad440757c3f.html" target="n" data-glyph="44,1" class="i field">stopContextCollection</a> =
            <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the filter property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is meant to be overridden by derived classes if</span>
        <span class="c">///</span><span class="c"> they support the Filter parameter. This property is on</span>
        <span class="c">///</span><span class="c"> the base class to simplify the creation of the CmdletProviderContext.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public virtual string</b> <a id="044d90d664ea29d1" href="../../R/044d90d664ea29d1.html" target="n" data-glyph="102,1" class="i property">Filter</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the include property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is meant to be overridden by derived classes if</span>
        <span class="c">///</span><span class="c"> they support the Include parameter. This property is on</span>
        <span class="c">///</span><span class="c"> the base class to simplify the creation of the CmdletProviderContext.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public virtual string</b>[] <a id="953eaff5f53e6629" href="../../R/953eaff5f53e6629.html" target="n" data-glyph="102,1" class="i property">Include</a>
        {
            <b>get</b>;
            <b>set</b>;
        } = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the exclude property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is meant to be overridden by derived classes if</span>
        <span class="c">///</span><span class="c"> they support the Exclude parameter. This property is on</span>
        <span class="c">///</span><span class="c"> the base class to simplify the creation of the CmdletProviderContext.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public virtual string</b>[] <a id="2121159277b72236" href="../../R/2121159277b72236.html" target="n" data-glyph="102,1" class="i property">Exclude</a>
        {
            <b>get</b>;
            <b>set</b>;
        } = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the force property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gives the provider guidance on how vigorous it should be about performing</span>
        <span class="c">///</span><span class="c"> the operation. If true, the provider should do everything possible to perform</span>
        <span class="c">///</span><span class="c"> the operation. If false, the provider should attempt the operation but allow</span>
        <span class="c">///</span><span class="c"> even simple errors to terminate the operation.</span>
        <span class="c">///</span><span class="c"> For example, if the user tries to copy a file to a path that already exists and</span>
        <span class="c">///</span><span class="c"> the destination is read-only, if force is true, the provider should copy over</span>
        <span class="c">///</span><span class="c"> the existing read-only file. If force is false, the provider should write an error.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This is meant to be overridden by derived classes if</span>
        <span class="c">///</span><span class="c"> they support the Force parameter. This property is on</span>
        <span class="c">///</span><span class="c"> the base class to simplify the creation of the CmdletProviderContext.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public virtual</b> <span class="i">SwitchParameter</span> <a id="e526073d49c1c7c1" href="../../R/e526073d49c1c7c1.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b> =&gt; <a href="#ab6f59c378ac01b5" class="i field">_force</a>;
            <b>set</b> =&gt; <a href="#ab6f59c378ac01b5" class="i field">_force</a> = <b>value</b>;
        }
 
        <b>private bool</b> <a id="ab6f59c378ac01b5" href="../../R/ab6f59c378ac01b5.html" target="n" data-glyph="46,1" class="i field">_force</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the dynamic parameters for the command from</span>
        <span class="c">///</span><span class="c"> the provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="12941269813c0eb6" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetDynamicParameters</a>()
        {
            <span class="c">// Don&#39;t stream errors or Write* to the pipeline.</span>
            <span class="i">CmdletProviderContext</span> <span id="r10 rd" class="r10 r">context</span> = <a href="#5aabca2de4eb131c" class="i property">CmdletProviderContext</a>;
            <span class="r10 r">context</span>.<span class="i">PassThru</span> = <b>false</b>;
 
            <b>try</b>
            {
                <a href="#ba520daa7a0e07cd" class="i field">_dynamicParameters</a> = <a href="#44c36827175940dc" class="i method">GetDynamicParameters</a>(<span class="r10 r">context</span>);
            }
            <b>catch</b> (<span class="i">ItemNotFoundException</span>)
            {
                <a href="#ba520daa7a0e07cd" class="i field">_dynamicParameters</a> = <b>null</b>;
            }
            <b>catch</b> (<span class="i">ProviderNotFoundException</span>)
            {
                <a href="#ba520daa7a0e07cd" class="i field">_dynamicParameters</a> = <b>null</b>;
            }
            <b>catch</b> (<span class="i">DriveNotFoundException</span>)
            {
                <a href="#ba520daa7a0e07cd" class="i field">_dynamicParameters</a> = <b>null</b>;
            }
 
            <b>return</b> <a href="#ba520daa7a0e07cd" class="i field">_dynamicParameters</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the cmdlet and CmdletProvider supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="553922fddac98a78" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SupportsShouldProcess</a> =&gt; <a href="#8217a8ab2ffe5ba3" class="i property">ProviderSupportsShouldProcess</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public members
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> CoreCommandBase
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CoreCommandWithCredentialsBase
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The base class for core commands to extend when they require credentials</span>
    <span class="c">///</span><span class="c"> to be passed as parameters.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="98633376814a5912" href="../../R/98633376814a5912.html" target="n" data-glyph="0,0" class="t t"><span id="45a387ebf4bd0d16">CoreCommandWithCredentialsBase</span></a> : <a href="#31745b2c942d5ae6" class="t t">CoreCommandBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the credential parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Credential</span>()]
        <b>public</b> <span class="i">PSCredential</span> <a id="0c36e88c8099c957" href="../../R/0c36e88c8099c957.html" target="n" data-glyph="102,1" class="i property">Credential</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> parameter data
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> parameter data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Protected members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context for the command that is passed to the core command providers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override</b> <span class="i">CmdletProviderContext</span> <a id="5ad1bfe4df30aef4" href="../../R/5ad1bfe4df30aef4.html" target="n" data-glyph="104,1" class="i property">CmdletProviderContext</a>
        {
            <b>get</b>
            {
                <span class="i">CmdletProviderContext</span> <span id="r11 rd" class="r11 r">coreCommandContext</span> = <b>new</b>(<a href="#98633376814a5912" class="k">this</a>, <a href="#0c36e88c8099c957" class="i property">Credential</a>);
                <span class="r11 r">coreCommandContext</span>.<span class="i">Force</span> = <a href="#e526073d49c1c7c1" class="i property">Force</a>;
 
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r12 rd" class="r12 r">includeFilter</span> =
                    <span class="i">SessionStateUtilities</span>.<span class="i">ConvertArrayToCollection</span>&lt;<b>string</b>&gt;(<a href="#953eaff5f53e6629" class="i property">Include</a>);
 
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r13 rd" class="r13 r">excludeFilter</span> =
                    <span class="i">SessionStateUtilities</span>.<span class="i">ConvertArrayToCollection</span>&lt;<b>string</b>&gt;(<a href="#2121159277b72236" class="i property">Exclude</a>);
 
                <span class="r11 r">coreCommandContext</span>.<span class="i">SetFilters</span>(<span class="r12 r">includeFilter</span>, <span class="r13 r">excludeFilter</span>, <a href="#044d90d664ea29d1" class="i property">Filter</a>);
                <span class="r11 r">coreCommandContext</span>.<span class="i">SuppressWildcardExpansion</span> = <a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a>;
                <span class="r11 r">coreCommandContext</span>.<span class="i">DynamicParameters</span> = <a href="#e8a298d1be79229d" class="i property">RetrievedDynamicParameters</a>;
                <a href="#2ae1dad440757c3f" class="i field">stopContextCollection</a>.<span class="i">Add</span>(<span class="r11 r">coreCommandContext</span>);
 
                <b>return</b> <span class="r11 r">coreCommandContext</span>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Protected members
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> CoreCommandWithCredentialsBase
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> GetLocationCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The get-location command class.</span>
    <span class="c">///</span><span class="c"> This command does things like list the contents of a container, get</span>
    <span class="c">///</span><span class="c"> an item at a given path, get the current working directory, etc.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Get</span>, <span class="s">&quot;Location&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#ab885db5c337afd9" class="i field">LocationParameterSet</a>, <span class="i">SupportsTransactions</span> = <b>true</b>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096495&quot;</span>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<span class="i">PathInfo</span>), <span class="i">ParameterSetName</span> = <b>new</b> <b>string</b>[] { <a href="#ab885db5c337afd9" class="i field">LocationParameterSet</a> })]
    [<span class="i">OutputType</span>(<b>typeof</b>(<span class="i">PathInfoStack</span>), <span class="i">ParameterSetName</span> = <b>new</b> <b>string</b>[] { <a href="#0126438d1277b509" class="i field">StackParameterSet</a> })]
    <b>public class</b> <a id="c9e865579c97858c" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="745389287b2d3502">GetLocationCommand</span></a> : <a href="#a201b0cdc7601d58" class="t t">DriveMatchingCoreCommandBase</a>
    {
        <b>private const string</b> <a id="ab885db5c337afd9" href="../../R/ab885db5c337afd9.html" target="n" data-glyph="10,1" class="i field">LocationParameterSet</a> = <span class="s">&quot;Location&quot;</span>;
        <b>private const string</b> <a id="0126438d1277b509" href="../../R/0126438d1277b509.html" target="n" data-glyph="10,1" class="i field">StackParameterSet</a> = <span class="s">&quot;Stack&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Location parameter set parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the provider from which to get the current location.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#ab885db5c337afd9" class="i field">LocationParameterSet</a>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="4e6f46e18f91a76f" href="../../R/4e6f46e18f91a76f.html" target="n" data-glyph="102,1" class="i property">PSProvider</a>
        {
            <b>get</b> =&gt; <a href="#df8d5625f7a9cdbb" class="i field">_provider</a>;
            <b>set</b> =&gt; <a href="#df8d5625f7a9cdbb" class="i field">_provider</a> = <b>value</b> ?? <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the drive from which to get the current location.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#ab885db5c337afd9" class="i field">LocationParameterSet</a>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="4704627addcd3051" href="../../R/4704627addcd3051.html" target="n" data-glyph="102,1" class="i property">PSDrive</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Location parameter set parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Stack parameter set parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the Stack switch parameter which is used</span>
        <span class="c">///</span><span class="c"> to disambiguate parameter sets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#0126438d1277b509" class="i field">StackParameterSet</a>)]
        <b>public</b> <span class="i">SwitchParameter</span> <a id="27840fc7d69eefd7" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Stack</a>
        {
            <b>get</b> =&gt; <a href="#67ba4e48a27df7f0" class="i field">_stackSwitch</a>;
            <b>set</b> =&gt; <a href="#67ba4e48a27df7f0" class="i field">_stackSwitch</a> = <b>value</b>;
        }
 
        <b>private bool</b> <a id="67ba4e48a27df7f0" href="../../R/67ba4e48a27df7f0.html" target="n" data-glyph="46,1" class="i field">_stackSwitch</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the stack ID for the location stack that will</span>
        <span class="c">///</span><span class="c"> be retrieved.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#0126438d1277b509" class="i field">StackParameterSet</a>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="0c367fb29e025463" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">StackName</a>
        {
            <b>get</b> =&gt; <a href="#93d67f9788525f9e" class="i field">_stackNames</a>;
 
            <b>set</b> =&gt; <a href="#93d67f9788525f9e" class="i field">_stackNames</a> = <b>value</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Stack parameter set parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Location parameter set data
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the provider from which to return the current location.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="df8d5625f7a9cdbb" href="../../R/df8d5625f7a9cdbb.html" target="n" data-glyph="46,1" class="i field">_provider</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Location parameter set data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Stack parameter set data
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the location stack from which to return the stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="93d67f9788525f9e" href="../../R/93d67f9788525f9e.html" target="n" data-glyph="46,1" class="i field">_stackNames</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Stack parameter set data
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The main execution method for the get-location command. Depending on</span>
        <span class="c">///</span><span class="c"> the parameter set that is specified, the command can do many things.</span>
        <span class="c">///</span><span class="c">     -locationSet gets the current working directory as a Monad path</span>
        <span class="c">///</span><span class="c">     -stackSet gets the directory stack of directories that have been</span>
        <span class="c">///</span><span class="c">               pushed by the push-location command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="ce10296d8e3272d0" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="c">// It is OK to use a switch for string comparison here because we</span>
            <span class="c">// want a case sensitive comparison in the current culture.</span>
            <b>switch</b> (<span class="i">ParameterSetName</span>)
            {
                <b>case</b> <a href="#ab885db5c337afd9" class="i field">LocationParameterSet</a>:
                    <span class="i">PathInfo</span> <span id="r14 rd" class="r14 r">result</span> = <b>null</b>;
 
                    <b>if</b> (<a href="#4704627addcd3051" class="i property">PSDrive</a> != <b>null</b> &amp;&amp; <a href="#4704627addcd3051" class="i property">PSDrive</a>.<span class="i">Length</span> &gt; 0)
                    {
                        <b>foreach</b> (<b>string</b> <span id="r15 rd" class="r15 r">drive</span> <b>in</b> <a href="#4704627addcd3051" class="i property">PSDrive</a>)
                        {
                            <span class="i">List</span>&lt;<span class="i">PSDriveInfo</span>&gt; <span id="r16 rd" class="r16 r">foundDrives</span> = <b>null</b>;
                            <b>try</b>
                            {
                                <span class="r16 r">foundDrives</span> = <a href="#d7321f8524854fd2" class="i method">GetMatchingDrives</a>(<span class="r15 r">drive</span>, <a href="#4e6f46e18f91a76f" class="i property">PSProvider</a>, <b>null</b>);
                            }
                            <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r17 rd" class="r17 r">e</span>)
                            {
                                <span class="i">ErrorRecord</span> <span id="r18 rd" class="r18 r">errorRecord</span> =
                                    <b>new</b>(
                                        <span class="r17 r">e</span>,
                                        <span class="s">&quot;GetLocationNoMatchingDrive&quot;</span>,
                                        <span class="i">ErrorCategory</span>.<span class="i">ObjectNotFound</span>,
                                        <span class="r15 r">drive</span>);
                                <span class="i">WriteError</span>(<span class="r18 r">errorRecord</span>);
                                <b>continue</b>;
                            }
                            <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r19 rd" class="r19 r">e</span>)
                            {
                                <span class="i">ErrorRecord</span> <span id="r20 rd" class="r20 r">errorRecord</span> =
                                    <b>new</b>(
                                        <span class="r19 r">e</span>,
                                        <span class="s">&quot;GetLocationNoMatchingProvider&quot;</span>,
                                        <span class="i">ErrorCategory</span>.<span class="i">ObjectNotFound</span>,
                                        <a href="#4e6f46e18f91a76f" class="i property">PSProvider</a>);
                                <span class="i">WriteError</span>(<span class="r20 r">errorRecord</span>);
                                <b>continue</b>;
                            }
                            <b>catch</b> (<span class="i">ArgumentException</span> <span id="r21 rd" class="r21 r">argException</span>)
                            {
                                <span class="i">ErrorRecord</span> <span id="r22 rd" class="r22 r">errorRecord</span> =
                                    <b>new</b>(
                                        <span class="r21 r">argException</span>,
                                        <span class="s">&quot;GetLocationNoMatchingDrive&quot;</span>,
                                        <span class="i">ErrorCategory</span>.<span class="i">ObjectNotFound</span>,
                                        <span class="r15 r">drive</span>);
                                <span class="i">WriteError</span>(<span class="r22 r">errorRecord</span>);
                                <b>continue</b>;
                            }
 
                            <span class="c">// Get the current location for a specific drive and provider</span>
 
                            <b>foreach</b> (<span class="i">PSDriveInfo</span> <span id="r23 rd" class="r23 r">workingDrive</span> <b>in</b> <span class="r16 r">foundDrives</span>)
                            {
                                <b>try</b>
                                {
                                    <b>string</b> <span id="r24 rd" class="r24 r">path</span> =
                                        <span class="i">LocationGlobber</span>.<span class="i">GetDriveQualifiedPath</span>(
                                            <span class="r23 r">workingDrive</span>.<span class="i">CurrentLocation</span>,
                                            <span class="r23 r">workingDrive</span>);
 
                                    <span class="r14 r">result</span> = <b>new</b> <span class="i">PathInfo</span>(<span class="r23 r">workingDrive</span>, <span class="r23 r">workingDrive</span>.<span class="i">Provider</span>, <span class="r24 r">path</span>, <span class="i">SessionState</span>);
 
                                    <span class="i">WriteObject</span>(<span class="r14 r">result</span>);
                                }
                                <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r25 rd" class="r25 r">providerNotFound</span>)
                                {
                                    <span class="i">WriteError</span>(
                                        <b>new</b> <span class="i">ErrorRecord</span>(
                                            <span class="r25 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                                            <span class="r25 r">providerNotFound</span>));
                                    <b>continue</b>;
                                }
                            }
                        }
                    }
                    <span class="c">// If the drive wasn&#39;t specified but the provider was</span>
                    <b>else</b> <b>if</b> ((<a href="#4704627addcd3051" class="i property">PSDrive</a> == <b>null</b> || <a href="#4704627addcd3051" class="i property">PSDrive</a>.<span class="i">Length</span> == 0) &amp;&amp;
                             (<a href="#4e6f46e18f91a76f" class="i property">PSProvider</a> != <b>null</b> &amp;&amp; <a href="#4e6f46e18f91a76f" class="i property">PSProvider</a>.<span class="i">Length</span> &gt; 0))
                    {
                        <b>foreach</b> (<b>string</b> <span id="r26 rd" class="r26 r">providerName</span> <b>in</b> <a href="#4e6f46e18f91a76f" class="i property">PSProvider</a>)
                        {
                            <b>bool</b> <span id="r27 rd" class="r27 r">providerContainsWildcard</span> = <span class="i">WildcardPattern</span>.<span class="i">ContainsWildcardCharacters</span>(<span class="r26 r">providerName</span>);
                            <b>if</b> (!<span class="r27 r">providerContainsWildcard</span>)
                            {
                                <span class="c">// Since the Provider was specified and doesn&#39;t contain</span>
                                <span class="c">// wildcard characters, make sure it exists.</span>
 
                                <b>try</b>
                                {
                                    <span class="i">SessionState</span>.<span class="i">Provider</span>.<span class="i">GetOne</span>(<span class="r26 r">providerName</span>);
                                }
                                <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r28 rd" class="r28 r">e</span>)
                                {
                                    <span class="i">ErrorRecord</span> <span id="r29 rd" class="r29 r">errorRecord</span> =
                                        <b>new</b>(
                                            <span class="r28 r">e</span>,
                                            <span class="s">&quot;GetLocationNoMatchingProvider&quot;</span>,
                                            <span class="i">ErrorCategory</span>.<span class="i">ObjectNotFound</span>,
                                            <span class="r26 r">providerName</span>);
                                    <span class="i">WriteError</span>(<span class="r29 r">errorRecord</span>);
                                    <b>continue</b>;
                                }
                            }
 
                            <span class="c">// Match the providers</span>
 
                            <b>foreach</b> (<span class="i">ProviderInfo</span> <span id="r30 rd" class="r30 r">providerInfo</span> <b>in</b> <span class="i">SessionState</span>.<span class="i">Provider</span>.<span class="i">GetAll</span>())
                            {
                                <b>if</b> (<span class="r30 r">providerInfo</span>.<span class="i">IsMatch</span>(<span class="r26 r">providerName</span>))
                                {
                                    <b>try</b>
                                    {
                                        <span class="i">WriteObject</span>(<span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">CurrentProviderLocation</span>(<span class="r30 r">providerInfo</span>.<span class="i">FullName</span>));
                                    }
                                    <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r31 rd" class="r31 r">providerNotFound</span>)
                                    {
                                        <span class="i">WriteError</span>(
                                            <b>new</b> <span class="i">ErrorRecord</span>(
                                                <span class="r31 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                                                <span class="r31 r">providerNotFound</span>));
                                        <b>continue</b>;
                                    }
                                    <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r32 rd" class="r32 r">driveNotFound</span>)
                                    {
                                        <b>if</b> (<span class="r27 r">providerContainsWildcard</span>)
                                        {
                                            <span class="c">// NTRAID#Windows Out Of Band Releases-923607-2005/11/02-JeffJon</span>
                                            <span class="c">// This exception is ignored, because it just means we didn&#39;t find</span>
                                            <span class="c">// an active drive for the provider.</span>
                                            <b>continue</b>;
                                        }
                                        <b>else</b>
                                        {
                                            <span class="i">WriteError</span>(
                                                <b>new</b> <span class="i">ErrorRecord</span>(
                                                    <span class="r32 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                                                    <span class="r32 r">driveNotFound</span>));
                                        }
                                    }
                                }
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <span class="c">// Get the current working directory using the core command API.</span>
                        <span class="i">WriteObject</span>(<span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">CurrentLocation</span>);
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#0126438d1277b509" class="i field">StackParameterSet</a>:
                    <b>if</b> (<a href="#93d67f9788525f9e" class="i field">_stackNames</a> != <b>null</b>)
                    {
                        <b>foreach</b> (<b>string</b> <span id="r33 rd" class="r33 r">stackName</span> <b>in</b> <a href="#93d67f9788525f9e" class="i field">_stackNames</a>)
                        {
                            <b>try</b>
                            {
                                <span class="c">// Get the directory stack. This is similar to the &quot;dirs&quot; command</span>
                                <span class="i">WriteObject</span>(<span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">LocationStack</span>(<span class="r33 r">stackName</span>), <b>false</b>);
                            }
                            <b>catch</b> (<span class="i">PSArgumentException</span> <span id="r34 rd" class="r34 r">argException</span>)
                            {
                                <span class="i">WriteError</span>(
                                    <b>new</b> <span class="i">ErrorRecord</span>(
                                        <span class="r34 r">argException</span>.<span class="i">ErrorRecord</span>,
                                        <span class="r34 r">argException</span>));
                                <b>continue</b>;
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <b>try</b>
                        {
                            <span class="i">WriteObject</span>(<span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">LocationStack</span>(<b>null</b>), <b>false</b>);
                        }
                        <b>catch</b> (<span class="i">PSArgumentException</span> <span id="r35 rd" class="r35 r">argException</span>)
                        {
                            <span class="i">WriteError</span>(
                                <b>new</b> <span class="i">ErrorRecord</span>(
                                    <span class="r35 r">argException</span>.<span class="i">ErrorRecord</span>,
                                    <span class="r35 r">argException</span>));
                        }
                    }
 
                    <b>break</b>;
 
                <b>default</b>:
                    <span class="i">Dbg</span>.<span class="i">Diagnostics</span>.<span class="i">Assert</span>(<b>false</b>, <b>string</b>.<span class="i">Format</span>(<span class="i">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;One of the predefined parameter sets should have been specified, instead we got: {0}&quot;</span>, <span class="i">ParameterSetName</span>));
                    <b>break</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> command code
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> GetLocationCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> SetLocationCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The core command for setting/changing location.</span>
    <span class="c">///</span><span class="c"> This is the equivalent of cd command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Set</span>, <span class="s">&quot;Location&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#f80774da91e16dc6" class="i field">PathParameterSet</a>, <span class="i">SupportsTransactions</span> = <b>true</b>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2097049&quot;</span>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<span class="i">PathInfo</span>), <b>typeof</b>(<span class="i">PathInfoStack</span>))]
    <b>public class</b> <a id="c7073aeeee194b9b" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="d14b1cc5ebbf2831">SetLocationCommand</span></a> : <a href="#31745b2c942d5ae6" class="t t">CoreCommandBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
        <b>private const string</b> <a id="f80774da91e16dc6" href="../../R/f80774da91e16dc6.html" target="n" data-glyph="10,1" class="i field">PathParameterSet</a> = <span class="s">&quot;Path&quot;</span>;
        <b>private const string</b> <a id="a5838e05e938ed7c" href="../../R/a5838e05e938ed7c.html" target="n" data-glyph="10,1" class="i field">LiteralPathParameterSet</a> = <span class="s">&quot;LiteralPath&quot;</span>;
        <b>private const string</b> <a id="389e910cb03d263e" href="../../R/389e910cb03d263e.html" target="n" data-glyph="10,1" class="i field">StackParameterSet</a> = <span class="s">&quot;Stack&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#f80774da91e16dc6" class="i field">PathParameterSet</a>,
                   <span class="i">ValueFromPipeline</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="06ad6de8aad6d2db" href="../../R/06ad6de8aad6d2db.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> =&gt; <a href="#63763bc7f879af62" class="i field">_path</a>;
            <b>set</b> =&gt; <a href="#63763bc7f879af62" class="i field">_path</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the path property, when bound from the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#a5838e05e938ed7c" class="i field">LiteralPathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>false</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b> <a id="fefc9130efc97aeb" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b> =&gt; <a href="#63763bc7f879af62" class="i field">_path</a>;
            <b>set</b>
            {
                <a href="#63763bc7f879af62" class="i field">_path</a> = <b>value</b>;
                <a href="#31745b2c942d5ae6" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the parameter -passThru which states output from</span>
        <span class="c">///</span><span class="c"> the command should be placed in the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">SwitchParameter</span> <a id="078b1ef6e9530fc5" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">PassThru</a>
        {
            <b>get</b> =&gt; <a href="#def82e4fbb04eb6b" class="i field">_passThrough</a>;
            <b>set</b> =&gt; <a href="#def82e4fbb04eb6b" class="i field">_passThrough</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the StackName parameter which determines which location stack</span>
        <span class="c">///</span><span class="c"> to use for the push. If the parameter is missing or empty the default</span>
        <span class="c">///</span><span class="c"> location stack is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#389e910cb03d263e" class="i field">StackParameterSet</a>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="17f29233e0811205" href="../../R/17f29233e0811205.html" target="n" data-glyph="102,1" class="i property">StackName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The filter used when doing a dir.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="63763bc7f879af62" href="../../R/63763bc7f879af62.html" target="n" data-glyph="46,1" class="i field">_path</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if output should be passed through for</span>
        <span class="c">///</span><span class="c"> set-location.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="def82e4fbb04eb6b" href="../../R/def82e4fbb04eb6b.html" target="n" data-glyph="46,1" class="i field">_passThrough</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The functional part of the code that does the changing of the current</span>
        <span class="c">///</span><span class="c"> working directory.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="685fbbece5bccba6" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>object</b> <span id="r36 rd" class="r36 r">result</span> = <b>null</b>;
 
            <b>switch</b> (<span class="i">ParameterSetName</span>)
            {
                <b>case</b> <a href="#f80774da91e16dc6" class="i field">PathParameterSet</a>:
                <b>case</b> <a href="#a5838e05e938ed7c" class="i field">LiteralPathParameterSet</a>:
                    <b>try</b>
                    {
                        <span class="c">// Change the current working directory</span>
                        <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#06ad6de8aad6d2db" class="i property">Path</a>))
                        {
                            <span class="c">// If user just typed &#39;cd&#39;, go to FileSystem provider home directory</span>
                            <a href="#06ad6de8aad6d2db" class="i property">Path</a> = <span class="i">SessionState</span>.<span class="i">Internal</span>.<span class="i">GetSingleProvider</span>(<span class="i n">Commands</span>.<span class="i">FileSystemProvider</span>.<span class="i">ProviderName</span>).<span class="i">Home</span>;
                        }
 
                        <span class="r36 r">result</span> = <span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">SetLocation</span>(<a href="#06ad6de8aad6d2db" class="i property">Path</a>, <a href="#5aabca2de4eb131c" class="i property">CmdletProviderContext</a>, <span class="i">ParameterSetName</span> == <a href="#a5838e05e938ed7c" class="i field">LiteralPathParameterSet</a>);
                    }
                    <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r37 rd" class="r37 r">notSupported</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r37 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                                <span class="r37 r">notSupported</span>));
                    }
                    <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r38 rd" class="r38 r">driveNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r38 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r38 r">driveNotFound</span>));
                    }
                    <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r39 rd" class="r39 r">providerNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r39 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r39 r">providerNotFound</span>));
                    }
                    <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r40 rd" class="r40 r">pathNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r40 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r40 r">pathNotFound</span>));
                    }
                    <b>catch</b> (<span class="i">PSArgumentException</span> <span id="r41 rd" class="r41 r">argException</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r41 r">argException</span>.<span class="i">ErrorRecord</span>,
                                <span class="r41 r">argException</span>));
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#389e910cb03d263e" class="i field">StackParameterSet</a>:
 
                    <b>try</b>
                    {
                        <span class="c">// Change the default location stack</span>
                        <span class="r36 r">result</span> = <span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">SetDefaultLocationStack</span>(<a href="#17f29233e0811205" class="i property">StackName</a>);
                    }
                    <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r42 rd" class="r42 r">itemNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r42 r">itemNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r42 r">itemNotFound</span>));
                    }
 
                    <b>break</b>;
 
                <b>default</b>:
                    <span class="i">Dbg</span>.<span class="i">Diagnostics</span>.<span class="i">Assert</span>(
                        <b>false</b>,
                        <span class="s">&quot;One of the specified parameter sets should have been called&quot;</span>);
                    <b>break</b>;
            }
 
            <b>if</b> (<a href="#def82e4fbb04eb6b" class="i field">_passThrough</a> &amp;&amp; <span class="r36 r">result</span> != <b>null</b>)
            {
                <span class="i">WriteObject</span>(<span class="r36 r">result</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> SetLocationCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> PushLocationCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The core command for setting/changing location and pushing it onto a location stack.</span>
    <span class="c">///</span><span class="c"> This is the equivalent of the pushd command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Push</span>, <span class="s">&quot;Location&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#d37b677ff47b1808" class="i field">PathParameterSet</a>, <span class="i">SupportsTransactions</span> = <b>true</b>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2097105&quot;</span>)]
    <b>public class</b> <a id="5682b5abbf8be3c4" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="d78fe9fb9306bd50">PushLocationCommand</span></a> : <a href="#31745b2c942d5ae6" class="t t">CoreCommandBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
        <b>private const string</b> <a id="d37b677ff47b1808" href="../../R/d37b677ff47b1808.html" target="n" data-glyph="10,1" class="i field">PathParameterSet</a> = <span class="s">&quot;Path&quot;</span>;
        <b>private const string</b> <a id="db71f6f836729acd" href="../../R/db71f6f836729acd.html" target="n" data-glyph="10,1" class="i field">LiteralPathParameterSet</a> = <span class="s">&quot;LiteralPath&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#d37b677ff47b1808" class="i field">PathParameterSet</a>,
                   <span class="i">ValueFromPipeline</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="b7c9fc37af7778c3" href="../../R/b7c9fc37af7778c3.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> =&gt; <a href="#7021e773a291e3fb" class="i field">_path</a>;
            <b>set</b> =&gt; <a href="#7021e773a291e3fb" class="i field">_path</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the literal path parameter to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#db71f6f836729acd" class="i field">LiteralPathParameterSet</a>,
                   <span class="i">ValueFromPipeline</span> = <b>false</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b> <a id="147ee99331694c34" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b> =&gt; <a href="#7021e773a291e3fb" class="i field">_path</a>;
            <b>set</b>
            {
                <a href="#31745b2c942d5ae6" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
                <a href="#7021e773a291e3fb" class="i field">_path</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the parameter -passThru which states output from</span>
        <span class="c">///</span><span class="c"> the command should be placed in the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">SwitchParameter</span> <a id="f338ef6a31ee552b" href="../../R/f338ef6a31ee552b.html" target="n" data-glyph="102,1" class="i property">PassThru</a>
        {
            <b>get</b> =&gt; <a href="#4e118654a606ce76" class="i field">_passThrough</a>;
            <b>set</b> =&gt; <a href="#4e118654a606ce76" class="i field">_passThrough</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the StackName parameter which determines which location stack</span>
        <span class="c">///</span><span class="c"> to use for the push. If the parameter is missing or empty the default</span>
        <span class="c">///</span><span class="c"> location stack is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="11cfb68b2f5a736a" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">StackName</a>
        {
            <b>get</b> =&gt; <a href="#d958dd3aa990b47f" class="i field">_stackName</a>;
            <b>set</b> =&gt; <a href="#d958dd3aa990b47f" class="i field">_stackName</a> = <b>value</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The filter used when doing a dir.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="7021e773a291e3fb" href="../../R/7021e773a291e3fb.html" target="n" data-glyph="46,1" class="i field">_path</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if output should be passed through for</span>
        <span class="c">///</span><span class="c"> push-location.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="4e118654a606ce76" href="../../R/4e118654a606ce76.html" target="n" data-glyph="46,1" class="i field">_passThrough</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ID of the stack to use for the pop.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="d958dd3aa990b47f" href="../../R/d958dd3aa990b47f.html" target="n" data-glyph="46,1" class="i field">_stackName</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The functional part of the code that does the changing of the current</span>
        <span class="c">///</span><span class="c"> working directory and pushes the container onto the stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="c6d43197ab967439" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="c">// Push the current working directory onto the</span>
            <span class="c">// working directory stack</span>
            <span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">PushCurrentLocation</span>(<a href="#d958dd3aa990b47f" class="i field">_stackName</a>);
 
            <b>if</b> (<a href="#b7c9fc37af7778c3" class="i property">Path</a> != <b>null</b>)
            {
                <b>try</b>
                {
                    <span class="c">// Now change the directory to the one specified</span>
                    <span class="c">// in the command</span>
                    <span class="i">PathInfo</span> <span id="r43 rd" class="r43 r">result</span> = <span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">SetLocation</span>(<a href="#b7c9fc37af7778c3" class="i property">Path</a>, <a href="#5aabca2de4eb131c" class="i property">CmdletProviderContext</a>);
 
                    <b>if</b> (<a href="#f338ef6a31ee552b" class="i property">PassThru</a>)
                    {
                        <span class="i">WriteObject</span>(<span class="r43 r">result</span>);
                    }
                }
                <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r44 rd" class="r44 r">notSupported</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r44 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                            <span class="r44 r">notSupported</span>));
                    <b>return</b>;
                }
                <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r45 rd" class="r45 r">driveNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r45 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r45 r">driveNotFound</span>));
                    <b>return</b>;
                }
                <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r46 rd" class="r46 r">providerNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r46 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r46 r">providerNotFound</span>));
                    <b>return</b>;
                }
                <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r47 rd" class="r47 r">pathNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r47 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r47 r">pathNotFound</span>));
                    <b>return</b>;
                }
                <b>catch</b> (<span class="i">PSArgumentException</span> <span id="r48 rd" class="r48 r">argException</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r48 r">argException</span>.<span class="i">ErrorRecord</span>,
                            <span class="r48 r">argException</span>));
                    <b>return</b>;
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PushLocationCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> PopLocationCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The core command for pop-location.  This is the equivalent of the popd command.</span>
    <span class="c">///</span><span class="c"> It pops a container from the stack and sets the current location to that container.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Pop</span>, <span class="s">&quot;Location&quot;</span>, <span class="i">SupportsTransactions</span> = <b>true</b>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096907&quot;</span>)]
    <b>public class</b> <a id="3173c5f1b69f78d2" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="138442289d1c1e1e">PopLocationCommand</span></a> : <a href="#31745b2c942d5ae6" class="t t">CoreCommandBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the parameter -passThru which states output from</span>
        <span class="c">///</span><span class="c"> the command should be placed in the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">SwitchParameter</span> <a id="cd1f3cb17e9c0b67" href="../../R/cd1f3cb17e9c0b67.html" target="n" data-glyph="102,1" class="i property">PassThru</a>
        {
            <b>get</b> =&gt; <a href="#396fa957239f2126" class="i field">_passThrough</a>;
            <b>set</b> =&gt; <a href="#396fa957239f2126" class="i field">_passThrough</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the StackName parameter which determines which location stack</span>
        <span class="c">///</span><span class="c"> to use for the pop. If the parameter is missing or empty the default</span>
        <span class="c">///</span><span class="c"> location stack is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="d76b5313cae6e0b4" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">StackName</a>
        {
            <b>get</b> =&gt; <a href="#653c3cef8ba7acf7" class="i field">_stackName</a>;
            <b>set</b> =&gt; <a href="#653c3cef8ba7acf7" class="i field">_stackName</a> = <b>value</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if output should be passed through for</span>
        <span class="c">///</span><span class="c"> pop-location.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="396fa957239f2126" href="../../R/396fa957239f2126.html" target="n" data-glyph="46,1" class="i field">_passThrough</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ID of the stack to use for the pop.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="653c3cef8ba7acf7" href="../../R/653c3cef8ba7acf7.html" target="n" data-glyph="46,1" class="i field">_stackName</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the top container from the location stack and sets the</span>
        <span class="c">///</span><span class="c"> location to it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="e91f090069ab0c1a" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>try</b>
            {
                <span class="c">// Pop the top of the location stack.</span>
 
                <span class="i">PathInfo</span> <span id="r49 rd" class="r49 r">result</span> = <span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">PopLocation</span>(<a href="#653c3cef8ba7acf7" class="i field">_stackName</a>);
 
                <b>if</b> (<a href="#cd1f3cb17e9c0b67" class="i property">PassThru</a>)
                {
                    <span class="i">WriteObject</span>(<span class="r49 r">result</span>);
                }
            }
            <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r50 rd" class="r50 r">driveNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r50 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r50 r">driveNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r51 rd" class="r51 r">providerNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r51 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r51 r">providerNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">PSArgumentException</span> <span id="r52 rd" class="r52 r">argException</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r52 r">argException</span>.<span class="i">ErrorRecord</span>,
                        <span class="r52 r">argException</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r53 rd" class="r53 r">itemNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r53 r">itemNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r53 r">itemNotFound</span>));
                <b>return</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PopLocationCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Drive commands
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> NewPSDriveCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Mounts a drive in the Monad namespace.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">New</span>, <span class="s">&quot;PSDrive&quot;</span>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">ConfirmImpact</span> = <span class="i">ConfirmImpact</span>.<span class="i">Low</span>,
        <span class="i">SupportsTransactions</span> = <b>true</b>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096815&quot;</span>)]
    <b>public class</b> <a id="151c89af17c04ce0" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="99f4c2c2a3ed0847">NewPSDriveCommand</span></a> : <a href="#98633376814a5912" class="t t">CoreCommandWithCredentialsBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the name of the drive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="8185d4132b0dc728" href="../../R/8185d4132b0dc728.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b> =&gt; <a href="#8e81e7c7b8c6b958" class="i field">_name</a>;
            <b>set</b> =&gt; <a href="#8e81e7c7b8c6b958" class="i field">_name</a> = <b>value</b> ?? <b>throw</b> <span class="i">PSTraceSource</span>.<span class="i">NewArgumentNullException</span>(<b>nameof</b>(<b>value</b>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the provider ID.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 1, <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="82807f76cc86a744" href="../../R/82807f76cc86a744.html" target="n" data-glyph="102,1" class="i property">PSProvider</a>
        {
            <b>get</b> =&gt; <a href="#d6a1ddf3c318cc16" class="i field">_provider</a>;
            <b>set</b> =&gt; <a href="#d6a1ddf3c318cc16" class="i field">_provider</a> = <b>value</b> ?? <b>throw</b> <span class="i">PSTraceSource</span>.<span class="i">NewArgumentNullException</span>(<b>nameof</b>(<b>value</b>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the root of the drive. This path should be</span>
        <span class="c">///</span><span class="c"> a namespace specific path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 2, <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">AllowEmptyString</span>]
        <b>public string</b> <a id="dfd84591df18e8cf" href="../../R/dfd84591df18e8cf.html" target="n" data-glyph="102,1" class="i property">Root</a>
        {
            <b>get</b> =&gt; <a href="#e0d8f254b55ec0e6" class="i field">_root</a>;
            <b>set</b> =&gt; <a href="#e0d8f254b55ec0e6" class="i field">_root</a> = <b>value</b> ?? <b>throw</b> <span class="i">PSTraceSource</span>.<span class="i">NewArgumentNullException</span>(<b>nameof</b>(<b>value</b>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the description of the drive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="05f42225f0889190" href="../../R/05f42225f0889190.html" target="n" data-glyph="102,1" class="i property">Description</a>
        {
            <b>get</b> =&gt; <a href="#ee6769866eca7b3b" class="i field">_description</a>;
            <b>set</b> =&gt; <a href="#ee6769866eca7b3b" class="i field">_description</a> = <b>value</b> ?? <b>throw</b> <span class="i">PSTraceSource</span>.<span class="i">NewArgumentNullException</span>(<b>nameof</b>(<b>value</b>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the scope identifier for the drive being created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="d32da49d4899a857" href="../../R/d32da49d4899a857.html" target="n" data-glyph="102,1" class="i property">Scope</a> { <b>get</b>; <b>set</b>; }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the Persist Switch parameter.</span>
        <span class="c">///</span><span class="c"> If this switch parameter is set then the created PSDrive</span>
        <span class="c">///</span><span class="c"> would be persisted across PowerShell sessions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public</b> <span class="i">SwitchParameter</span> <a id="84bf5fde131763ff" href="../../R/84bf5fde131763ff.html" target="n" data-glyph="102,1" class="i property">Persist</a>
        {
            <b>get</b> =&gt; <a href="#63b80878766e9487" class="i field">_persist</a>;
            <b>set</b> =&gt; <a href="#63b80878766e9487" class="i field">_persist</a> = <b>value</b>;
        }
 
        <b>private bool</b> <a id="63b80878766e9487" href="../../R/63b80878766e9487.html" target="n" data-glyph="46,1" class="i field">_persist</a> = <b>false</b>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the dynamic parameters for the new-psdrive cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the command is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object representing the dynamic parameters for the cmdlet or null if there</span>
        <span class="c">///</span><span class="c"> are none.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override object</b> <a id="99079a78d46b27d2" href="../../R/99079a78d46b27d2.html" target="n" data-glyph="74,1" class="i method">GetDynamicParameters</a>(<span class="i">CmdletProviderContext</span> <span id="r54 rd" class="r54 r">context</span>)
        {
            <b>return</b> <span class="i">SessionState</span>.<span class="i">Drive</span>.<span class="i">NewDriveDynamicParameters</span>(<a href="#82807f76cc86a744" class="i property">PSProvider</a>, <span class="r54 r">context</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> New-psdrive always supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="49f10f650cddddd2" href="../../R/49f10f650cddddd2.html" target="n" data-glyph="105,1" class="i property">ProviderSupportsShouldProcess</a> =&gt; <b>true</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the drive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="8e81e7c7b8c6b958" href="../../R/8e81e7c7b8c6b958.html" target="n" data-glyph="46,1" class="i field">_name</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider ID for the drive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="d6a1ddf3c318cc16" href="../../R/d6a1ddf3c318cc16.html" target="n" data-glyph="46,1" class="i field">_provider</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The namespace specific path of the root of the drive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="e0d8f254b55ec0e6" href="../../R/e0d8f254b55ec0e6.html" target="n" data-glyph="46,1" class="i field">_root</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A description for the drive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="ee6769866eca7b3b" href="../../R/ee6769866eca7b3b.html" target="n" data-glyph="46,1" class="i field">_description</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds a new drive to the Monad namespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="ebc8d2cc2b70191c" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="i">ProviderInfo</span> <span id="r55 rd" class="r55 r">provider</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="r55 r">provider</span> = <span class="i">SessionState</span>.<span class="i">Internal</span>.<span class="i">GetSingleProvider</span>(<a href="#82807f76cc86a744" class="i property">PSProvider</a>);
            }
            <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r56 rd" class="r56 r">providerNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r56 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r56 r">providerNotFound</span>));
                <b>return</b>;
            }
 
            <span class="c">// Check to see if the provider exists</span>
            <b>if</b> (<span class="r55 r">provider</span> != <b>null</b>)
            {
                <span class="c">// Get the confirmation strings</span>
 
                <b>string</b> <span id="r57 rd" class="r57 r">action</span> = <span class="i">NavigationResources</span>.<span class="i">NewDriveConfirmAction</span>;
                <b>string</b> <span id="r58 rd" class="r58 r">resourceTemplate</span> = <span class="i">NavigationResources</span>.<span class="i">NewDriveConfirmResourceTemplate</span>;
 
                <b>string</b> <span id="r59 rd" class="r59 r">resource</span> =
                    <b>string</b>.<span class="i">Format</span>(
                       <span class="i">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                       <span class="r58 r">resourceTemplate</span>,
                       <a href="#8185d4132b0dc728" class="i property">Name</a>,
                       <span class="r55 r">provider</span>.<span class="i">FullName</span>,
                       <a href="#dfd84591df18e8cf" class="i property">Root</a>);
 
                <b>if</b> (<span class="i">ShouldProcess</span>(<span class="r59 r">resource</span>, <span class="r57 r">action</span>))
                {
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
                    <span class="c">// -Persist switch parameter is supported only for FileSystem provider.</span>
                    <b>if</b> (<a href="#84bf5fde131763ff" class="i property">Persist</a> &amp;&amp; !<span class="r55 r">provider</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="i">FileSystemProvider</span>.<span class="i">ProviderName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="i">ErrorRecord</span> <span id="r60 rd" class="r60 r">er</span> = <b>new</b>(<b>new</b> <span class="i">NotSupportedException</span>(<span class="i">FileSystemProviderStrings</span>.<span class="i">PersistNotSupported</span>), <span class="s">&quot;DriveRootNotNetworkPath&quot;</span>, <span class="i">ErrorCategory</span>.<span class="i">InvalidArgument</span>, <a href="#151c89af17c04ce0" class="k">this</a>);
                        <span class="i">ThrowTerminatingError</span>(<span class="r60 r">er</span>);
                    }
 
                    <span class="c">// Trimming forward and backward slash for FileSystem provider when -Persist is used.</span>
                    <b>if</b> (<a href="#84bf5fde131763ff" class="i property">Persist</a> &amp;&amp; <span class="r55 r">provider</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="i">FileSystemProvider</span>.<span class="i">ProviderName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <a href="#dfd84591df18e8cf" class="i property">Root</a> = <a href="#dfd84591df18e8cf" class="i property">Root</a>.<span class="i">TrimEnd</span>(<span class="s">&#39;/&#39;</span>, <span class="s">&#39;\\&#39;</span>);
                    }
 
                    <span class="c">// Create the new drive</span>
                    <span class="i">PSDriveInfo</span> <span id="r61 rd" class="r61 r">newDrive</span> =
                        <b>new</b>(
                            <a href="#8185d4132b0dc728" class="i property">Name</a>,
                            <span class="r55 r">provider</span>,
                            <a href="#dfd84591df18e8cf" class="i property">Root</a>,
                            <a href="#05f42225f0889190" class="i property">Description</a>,
                            <a href="#0c36e88c8099c957" class="i property">Credential</a>,
                            <a href="#84bf5fde131763ff" class="i property">Persist</a>);
<span class="k preprocess">#</span><span class="k preprocess">else</span>
<span class="e">                    // Create the new drive
                    PSDriveInfo newDrive =
                        new PSDriveInfo(
                            Name,
                            provider,
                            Root,
                            Description,
                            Credential,
                            persist: false);
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
                    <b>try</b>
                    {
                        <span class="i">SessionState</span>.<span class="i">Drive</span>.<span class="i">New</span>(<span class="r61 r">newDrive</span>, <a href="#d32da49d4899a857" class="i property">Scope</a>, <a href="#5ad1bfe4df30aef4" class="i property">CmdletProviderContext</a>);
                    }
                    <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r62 rd" class="r62 r">notSupported</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r62 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                                <span class="r62 r">notSupported</span>));
                        <b>return</b>;
                    }
                    <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r63 rd" class="r63 r">driveNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r63 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r63 r">driveNotFound</span>));
                        <b>return</b>;
                    }
                    <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r64 rd" class="r64 r">providerNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r64 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r64 r">providerNotFound</span>));
                        <b>return</b>;
                    }
                    <b>catch</b> (<span class="i">PSArgumentException</span> <span id="r65 rd" class="r65 r">argException</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r65 r">argException</span>.<span class="i">ErrorRecord</span>,
                                <span class="r65 r">argException</span>));
                        <b>return</b>;
                    }
                    <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r66 rd" class="r66 r">pathNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r66 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r66 r">pathNotFound</span>));
                        <b>return</b>;
                    }
                    <b>catch</b> (<span class="i">SessionStateException</span> <span id="r67 rd" class="r67 r">sessionStateException</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r67 r">sessionStateException</span>.<span class="i">ErrorRecord</span>,
                                <span class="r67 r">sessionStateException</span>));
                        <b>return</b>;
                    }
                }
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
 
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> NewPSDriveCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> DriveMatchingCoreCommandBase
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base class for Drive commands that need to glob drives on both the drive name</span>
    <span class="c">///</span><span class="c"> and the provider name.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="a201b0cdc7601d58" href="../../R/a201b0cdc7601d58.html" target="n" data-glyph="0,0" class="t t"><span id="2158ee6ff277ab24">DriveMatchingCoreCommandBase</span></a> : <a href="#31745b2c942d5ae6" class="t t">CoreCommandBase</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Globs on both the drive name and the provider name to get a list of Drives</span>
        <span class="c">///</span><span class="c"> that match the glob filters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">driveName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the drive(s) to returned. The name can contain glob characters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">providerNames</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the provider(s) to return. The name can contain glob characters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">scope</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The scope to get the drives from. If this parameter is null or empty all drives</span>
        <span class="c">///</span><span class="c"> will be retrieved.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of the drives that match the filters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">DriveNotFoundException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ProviderNotFoundException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">scope</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is less than zero, or not</span>
        <span class="c">///</span><span class="c"> a number and not &quot;script&quot;, &quot;global&quot;, &quot;local&quot;, or &quot;private&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">scope</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is less than zero or greater than the number of currently</span>
        <span class="c">///</span><span class="c"> active scopes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<span class="i">PSDriveInfo</span>&gt; <a id="d7321f8524854fd2" href="../../R/d7321f8524854fd2.html" target="n" data-glyph="74,1" class="i method">GetMatchingDrives</a>(
             <b>string</b> <span id="r68 rd" class="r68 r">driveName</span>,
            <b>string</b>[] <span id="r69 rd" class="r69 r">providerNames</span>,
            <b>string</b> <span id="r70 rd" class="r70 r">scope</span>)
        {
            <span class="i">List</span>&lt;<span class="i">PSDriveInfo</span>&gt; <span id="r71 rd" class="r71 r">results</span> = <b>new</b>();
 
            <b>if</b> (<span class="r69 r">providerNames</span> == <b>null</b> || <span class="r69 r">providerNames</span>.<span class="i">Length</span> == 0)
            {
                <span class="r69 r">providerNames</span> = <b>new</b> <b>string</b>[] { <span class="s">&quot;*&quot;</span> };
            }
 
            <b>foreach</b> (<b>string</b> <span id="r72 rd" class="r72 r">providerName</span> <b>in</b> <span class="r69 r">providerNames</span>)
            {
                <a href="#3b36b44a7a5db63e" class="i field">tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;ProviderName: {0}&quot;</span>, <span class="r72 r">providerName</span>);
 
                <b>bool</b> <span id="r73 rd" class="r73 r">providerNameEmpty</span> = <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r72 r">providerName</span>);
                <b>bool</b> <span id="r74 rd" class="r74 r">providerNameContainsWildcardCharacters</span> =
                    <span class="i">WildcardPattern</span>.<span class="i">ContainsWildcardCharacters</span>(<span class="r72 r">providerName</span>);
 
                <b>bool</b> <span id="r75 rd" class="r75 r">driveNameEmpty</span> = <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r68 r">driveName</span>);
                <b>bool</b> <span id="r76 rd" class="r76 r">driveNameContainsWildcardCharacters</span> =
                    <span class="i">WildcardPattern</span>.<span class="i">ContainsWildcardCharacters</span>(<span class="r68 r">driveName</span>);
 
                <span class="c">// This is just a simple check to see if the provider exists</span>
                <span class="c">// if the provider name is specified without glob characters.</span>
                <span class="c">// The call will throw an exception if the provider doesn&#39;t</span>
                <span class="c">// exist.</span>
                <b>if</b> (!<span class="r73 r">providerNameEmpty</span> &amp;&amp; !<span class="r74 r">providerNameContainsWildcardCharacters</span>)
                {
                    <span class="i">SessionState</span>.<span class="i">Provider</span>.<span class="i">Get</span>(<span class="r72 r">providerName</span>);
                }
 
                <span class="c">// This is just a simple check to see if the drive exists</span>
                <span class="c">// if the drive name is specified without glob characters.</span>
                <span class="c">// The call will throw an exception if the drive doesn&#39;t</span>
                <span class="c">// exist.</span>
                <b>if</b> (!<span class="r75 r">driveNameEmpty</span> &amp;&amp; !<span class="r76 r">driveNameContainsWildcardCharacters</span>)
                {
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r70 r">scope</span>))
                    {
                        <span class="i">SessionState</span>.<span class="i">Drive</span>.<span class="i">Get</span>(<span class="r68 r">driveName</span>);
                    }
                    <b>else</b>
                    {
                        <span class="i">SessionState</span>.<span class="i">Drive</span>.<span class="i">GetAtScope</span>(<span class="r68 r">driveName</span>, <span class="r70 r">scope</span>);
                    }
                }
 
                <span class="i">WildcardPattern</span> <span id="r77 rd" class="r77 r">providerMatcher</span> = <b>null</b>;
                <span class="i">PSSnapinQualifiedName</span> <span id="r78 rd" class="r78 r">pssnapinQualifiedProviderName</span> = <b>null</b>;
 
                <b>if</b> (!<span class="r73 r">providerNameEmpty</span>)
                {
                    <span class="r78 r">pssnapinQualifiedProviderName</span> = <span class="i">PSSnapinQualifiedName</span>.<span class="i">GetInstance</span>(<span class="r72 r">providerName</span>);
 
                    <b>if</b> (<span class="r78 r">pssnapinQualifiedProviderName</span> == <b>null</b>)
                    {
                        <span class="c">// This is a malformed pssnapin-qualified name so there is no chances for a match.</span>
                        <b>continue</b>;
                    }
 
                    <span class="r77 r">providerMatcher</span> =
                        <span class="i">WildcardPattern</span>.<span class="i">Get</span>(
                            <span class="r78 r">pssnapinQualifiedProviderName</span>.<span class="i">ShortName</span>,
                            <span class="i">WildcardOptions</span>.<span class="i">IgnoreCase</span>);
                }
 
                <span class="i">WildcardPattern</span> <span id="r79 rd" class="r79 r">nameMatcher</span> = <b>null</b>;
 
                <b>if</b> (!<span class="r75 r">driveNameEmpty</span>)
                {
                    <span class="r79 r">nameMatcher</span> =
                        <span class="i">WildcardPattern</span>.<span class="i">Get</span>(
                            <span class="r68 r">driveName</span>,
                            <span class="i">WildcardOptions</span>.<span class="i">IgnoreCase</span>);
                }
 
                <b>foreach</b> (<span class="i">PSDriveInfo</span> <span id="r80 rd" class="r80 r">drive</span> <b>in</b> <span class="i">SessionState</span>.<span class="i">Drive</span>.<span class="i">GetAllAtScope</span>(<span class="r70 r">scope</span>))
                {
                    <b>bool</b> <span id="r81 rd" class="r81 r">addDrive</span> = <span class="r75 r">driveNameEmpty</span>;
 
                    <b>if</b> (<a href="#31745b2c942d5ae6" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a>)
                    {
                        <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r80 r">drive</span>.<span class="i">Name</span>, <span class="r68 r">driveName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            <span class="r81 r">addDrive</span> = <b>true</b>;
                    }
                    <b>else</b>
                    {
                        <b>if</b> (<span class="r79 r">nameMatcher</span> != <b>null</b> &amp;&amp; <span class="r79 r">nameMatcher</span>.<span class="i">IsMatch</span>(<span class="r80 r">drive</span>.<span class="i">Name</span>))
                            <span class="r81 r">addDrive</span> = <b>true</b>;
                    }
 
                    <b>if</b> (<span class="r81 r">addDrive</span>)
                    {
                        <span class="c">// Now check to see if it matches the provider</span>
                        <b>if</b> (<span class="r73 r">providerNameEmpty</span> || <span class="r80 r">drive</span>.<span class="i">Provider</span>.<span class="i">IsMatch</span>(<span class="r77 r">providerMatcher</span>, <span class="r78 r">pssnapinQualifiedProviderName</span>))
                        {
                            <span class="r71 r">results</span>.<span class="i">Add</span>(<span class="r80 r">drive</span>);
                        }
                    }
                }
            }
 
            <span class="r71 r">results</span>.<span class="i">Sort</span>();
            <b>return</b> <span class="r71 r">results</span>;
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> DriveMatchingCoreCommandBase
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> RemovePSDriveCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Removes a drive that is mounted in the Monad namespace.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Remove</span>, <span class="s">&quot;PSDrive&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#c41b3df9e8425298" class="i field">NameParameterSet</a>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">SupportsTransactions</span> = <b>true</b>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2097050&quot;</span>)]
    <b>public class</b> <a id="3cee89a21f3e3da5" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="e59beb4ffae1e577">RemovePSDriveCommand</span></a> : <a href="#a201b0cdc7601d58" class="t t">DriveMatchingCoreCommandBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <b>private const string</b> <a id="c41b3df9e8425298" href="../../R/c41b3df9e8425298.html" target="n" data-glyph="10,1" class="i field">NameParameterSet</a> = <span class="s">&quot;Name&quot;</span>;
        <b>private const string</b> <a id="a256483c35a855e8" href="../../R/a256483c35a855e8.html" target="n" data-glyph="10,1" class="i field">LiteralNameParameterSet</a> = <span class="s">&quot;LiteralName&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the name of the drive to remove.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#c41b3df9e8425298" class="i field">NameParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">AllowNull</span>]
        [<span class="i">AllowEmptyCollection</span>]
        <b>public string</b>[] <a id="cf60199f6d08da39" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b> =&gt; <a href="#ca0569f67dbb33ca" class="i field">_names</a>;
            <b>set</b> =&gt; <a href="#ca0569f67dbb33ca" class="i field">_names</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the literal name parameter to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#a256483c35a855e8" class="i field">LiteralNameParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>false</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="af12d09f2fb95668" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralName</a>
        {
            <b>get</b> =&gt; <a href="#ca0569f67dbb33ca" class="i field">_names</a>;
            <b>set</b>
            {
                <a href="#a201b0cdc7601d58" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
                <a href="#ca0569f67dbb33ca" class="i field">_names</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the name provider(s) for which the drives should be removed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="a1f0a9615c4d8809" href="../../R/a1f0a9615c4d8809.html" target="n" data-glyph="102,1" class="i property">PSProvider</a>
        {
            <b>get</b> =&gt; <a href="#eb53507cbf28f97c" class="i field">_provider</a>;
            <b>set</b> =&gt; <a href="#eb53507cbf28f97c" class="i field">_provider</a> = <b>value</b> ?? <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the scope identifier from which to remove the drive.</span>
        <span class="c">///</span><span class="c"> If the scope is null or empty, the scope hierarchy will be searched</span>
        <span class="c">///</span><span class="c"> starting at the current scope through all the parent scopes to the</span>
        <span class="c">///</span><span class="c"> global scope until a drive of the given name is found to remove.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="d2f59ecbfcbfd6ad" href="../../R/d2f59ecbfcbfd6ad.html" target="n" data-glyph="102,1" class="i property">Scope</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the force property which determines if the drive</span>
        <span class="c">///</span><span class="c"> should be removed even if there were errors.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override</b> <span class="i">SwitchParameter</span> <a id="3d9432f6f565a3cb" href="../../R/3d9432f6f565a3cb.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b> =&gt; <a href="#a201b0cdc7601d58" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a>;
            <b>set</b> =&gt; <a href="#a201b0cdc7601d58" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the provider for the specified path supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="a63112c627a135fc" href="../../R/a63112c627a135fc.html" target="n" data-glyph="105,1" class="i property">ProviderSupportsShouldProcess</a> =&gt; <b>true</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the drive to remove.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="ca0569f67dbb33ca" href="../../R/ca0569f67dbb33ca.html" target="n" data-glyph="46,1" class="i field">_names</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the provider(s) for which to remove all drives.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="eb53507cbf28f97c" href="../../R/eb53507cbf28f97c.html" target="n" data-glyph="46,1" class="i field">_provider</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the specified drive from the Monad namespace using the name</span>
        <span class="c">///</span><span class="c"> of the drive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="e973ba96a59148c3" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="c">// Get the confirmation strings</span>
 
            <b>string</b> <span id="r82 rd" class="r82 r">action</span> = <span class="i">NavigationResources</span>.<span class="i">RemoveDriveConfirmAction</span>;
            <b>string</b> <span id="r83 rd" class="r83 r">resourceTemplate</span> = <span class="i">NavigationResources</span>.<span class="i">RemoveDriveConfirmResourceTemplate</span>;
 
            <b>bool</b> <span id="r84 rd" class="r84 r">verifyMatch</span> = <b>true</b>;
            <b>if</b> (<a href="#ca0569f67dbb33ca" class="i field">_names</a> == <b>null</b>)
            {
                <a href="#ca0569f67dbb33ca" class="i field">_names</a> = <b>new</b> <b>string</b>[] { <b>string</b>.<span class="i">Empty</span> };
                <span class="r84 r">verifyMatch</span> = <b>false</b>;
            }
 
            <b>foreach</b> (<b>string</b> <span id="r85 rd" class="r85 r">driveName</span> <b>in</b> <a href="#ca0569f67dbb33ca" class="i field">_names</a>)
            {
                <b>bool</b> <span id="r86 rd" class="r86 r">foundMatch</span> = <b>false</b>;
                <b>try</b>
                {
                    <b>foreach</b> (<span class="i">PSDriveInfo</span> <span id="r87 rd" class="r87 r">drive</span> <b>in</b> <a href="#d7321f8524854fd2" class="i method">GetMatchingDrives</a>(<span class="r85 r">driveName</span>, <a href="#a1f0a9615c4d8809" class="i property">PSProvider</a>, <a href="#d2f59ecbfcbfd6ad" class="i property">Scope</a>))
                    {
                        <b>string</b> <span id="r88 rd" class="r88 r">resource</span> =
                            <b>string</b>.<span class="i">Format</span>(
                                <span class="i">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                                <span class="r83 r">resourceTemplate</span>,
                                <span class="r87 r">drive</span>.<span class="i">Name</span>,
                                <span class="r87 r">drive</span>.<span class="i">Provider</span>,
                                <span class="r87 r">drive</span>.<span class="i">Root</span>);
 
                        <span class="r86 r">foundMatch</span> = <b>true</b>;
                        <b>if</b> (<span class="i">ShouldProcess</span>(<span class="r88 r">resource</span>, <span class="r82 r">action</span>))
                        {
                            <b>if</b> (!<a href="#3d9432f6f565a3cb" class="i property">Force</a> &amp;&amp; <span class="r87 r">drive</span> == <span class="i">SessionState</span>.<span class="i">Drive</span>.<span class="i">Current</span>)
                            {
                                <span class="i">PSInvalidOperationException</span> <span id="r89 rd" class="r89 r">invalidOperation</span> =
                                    (<span class="i">PSInvalidOperationException</span>)<span class="i">PSTraceSource</span>.<span class="i">NewInvalidOperationException</span>(
                                        <span class="i">NavigationResources</span>.<span class="i">RemoveDriveInUse</span>,
                                        <span class="r87 r">drive</span>.<span class="i">Name</span>);
 
                                <span class="i">WriteError</span>(
                                    <b>new</b> <span class="i">ErrorRecord</span>(
                                        <span class="r89 r">invalidOperation</span>.<span class="i">ErrorRecord</span>,
                                        <span class="r89 r">invalidOperation</span>));
                                <b>continue</b>;
                            }
 
                            <span class="i">SessionState</span>.<span class="i">Drive</span>.<span class="i">Remove</span>(<span class="r87 r">drive</span>.<span class="i">Name</span>, <a href="#3d9432f6f565a3cb" class="i property">Force</a>, <a href="#d2f59ecbfcbfd6ad" class="i property">Scope</a>, <a href="#5aabca2de4eb131c" class="i property">CmdletProviderContext</a>);
                        }
                    }
                }
                <b>catch</b> (<span class="i">DriveNotFoundException</span>)
                {
                }
                <b>catch</b> (<span class="i">ProviderNotFoundException</span>)
                {
                }
 
                <span class="c">// If a name was specified explicitly write an error if the drive wasn&#39;t</span>
                <span class="c">// found</span>
 
                <b>if</b> (<span class="r84 r">verifyMatch</span> &amp;&amp; !<span class="r86 r">foundMatch</span>)
                {
                    <span class="i">DriveNotFoundException</span> <span id="r90 rd" class="r90 r">e</span> = <b>new</b>(
                        <span class="r85 r">driveName</span>,
                        <span class="s">&quot;DriveNotFound&quot;</span>,
                        <span class="i">SessionStateStrings</span>.<span class="i">DriveNotFound</span>);
                    <span class="i">WriteError</span>(<b>new</b> <span class="i">ErrorRecord</span>(<span class="r90 r">e</span>.<span class="i">ErrorRecord</span>, <span class="r90 r">e</span>));
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> RemovePSDriveCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> GetPSDriveCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Gets a specified or listing of drives that are mounted in the Monad</span>
    <span class="c">///</span><span class="c"> namespace.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Get</span>, <span class="s">&quot;PSDrive&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#155da73e0dda8ead" class="i field">NameParameterSet</a>, <span class="i">SupportsTransactions</span> = <b>true</b>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096494&quot;</span>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<span class="i">PSDriveInfo</span>))]
    <b>public class</b> <a id="f735b5dce355ee2e" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="de5060c8b7b97b6f">GetPSDriveCommand</span></a> : <a href="#a201b0cdc7601d58" class="t t">DriveMatchingCoreCommandBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <b>private const string</b> <a id="155da73e0dda8ead" href="../../R/155da73e0dda8ead.html" target="n" data-glyph="10,1" class="i field">NameParameterSet</a> = <span class="s">&quot;Name&quot;</span>;
        <b>private const string</b> <a id="9f3a7c0651cf4d8c" href="../../R/9f3a7c0651cf4d8c.html" target="n" data-glyph="10,1" class="i field">LiteralNameParameterSet</a> = <span class="s">&quot;LiteralName&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the drive name the user is looking for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the drive name is left empty, all drives will be</span>
        <span class="c">///</span><span class="c"> returned. A globing or regular expression can also be</span>
        <span class="c">///</span><span class="c"> supplied and any drive names that match the expression</span>
        <span class="c">///</span><span class="c"> will be returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#155da73e0dda8ead" class="i field">NameParameterSet</a>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b>[] <a id="599f7e6a16b0f76f" href="../../R/599f7e6a16b0f76f.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b> =&gt; <a href="#6f631f2d586c9c24" class="i field">_name</a>;
            <b>set</b> =&gt; <a href="#6f631f2d586c9c24" class="i field">_name</a> = <b>value</b> ?? <b>new</b> <b>string</b>[] { <span class="s">&quot;*&quot;</span> };
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the literal name parameter to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#9f3a7c0651cf4d8c" class="i field">LiteralNameParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>false</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="20aa0661b5138614" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralName</a>
        {
            <b>get</b> =&gt; <a href="#6f631f2d586c9c24" class="i field">_name</a>;
            <b>set</b>
            {
                <a href="#a201b0cdc7601d58" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
                <a href="#6f631f2d586c9c24" class="i field">_name</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the scope parameter to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="478a20ba0a033c03" href="../../R/478a20ba0a033c03.html" target="n" data-glyph="102,1" class="i property">Scope</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the provider name for the</span>
        <span class="c">///</span><span class="c"> drives that should be retrieved.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the provider is left empty, all drives will be</span>
        <span class="c">///</span><span class="c"> returned. A globing or regular expression can also be</span>
        <span class="c">///</span><span class="c"> supplied and any drive with providers that match the expression</span>
        <span class="c">///</span><span class="c"> will be returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="596db1bde2148754" href="../../R/596db1bde2148754.html" target="n" data-glyph="102,1" class="i property">PSProvider</a>
        {
            <b>get</b> =&gt; <a href="#49b482d8b72314ff" class="i field">_provider</a>;
            <b>set</b> =&gt; <a href="#49b482d8b72314ff" class="i field">_provider</a> = <b>value</b> ?? <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the drive to be retrieved.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="6f631f2d586c9c24" href="../../R/6f631f2d586c9c24.html" target="n" data-glyph="46,1" class="i field">_name</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;*&quot;</span> };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The provider ID for the drives you want to see.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="49b482d8b72314ff" href="../../R/49b482d8b72314ff.html" target="n" data-glyph="46,1" class="i field">_provider</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Prepare the session for the Get-PSDrive command.</span>
        <span class="c">///</span><span class="c"> Currently, auto-loads the core modules that define drives. Ideally,</span>
        <span class="c">///</span><span class="c"> we could discover fake PSDriveInfo objects here based on drives exported</span>
        <span class="c">///</span><span class="c"> from modules.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="49928d8bf090431c" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <span class="i">SessionStateInternal</span>.<span class="i">MountDefaultDrive</span>(<span class="s">&quot;Cert&quot;</span>, <span class="i">Context</span>);
            <span class="i">SessionStateInternal</span>.<span class="i">MountDefaultDrive</span>(<span class="s">&quot;WSMan&quot;</span>, <span class="i">Context</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the drives specified by the parameters. If the name is empty, all drives</span>
        <span class="c">///</span><span class="c"> will be retrieved. If the provider is specified, only drives for that provider</span>
        <span class="c">///</span><span class="c"> will be retrieved.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="46bdbb290d81d241" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>foreach</b> (<b>string</b> <span id="r91 rd" class="r91 r">driveName</span> <b>in</b> <a href="#599f7e6a16b0f76f" class="i property">Name</a>)
            {
                <b>try</b>
                {
                    <span class="i">List</span>&lt;<span class="i">PSDriveInfo</span>&gt; <span id="r92 rd" class="r92 r">foundDrives</span> = <a href="#d7321f8524854fd2" class="i method">GetMatchingDrives</a>(<span class="r91 r">driveName</span>, <a href="#596db1bde2148754" class="i property">PSProvider</a>, <a href="#478a20ba0a033c03" class="i property">Scope</a>);
 
                    <b>if</b> (<span class="r92 r">foundDrives</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <span class="i">WriteObject</span>(<span class="r92 r">foundDrives</span>, <b>true</b>);
                    }
                    <b>else</b>
                    {
                        <span class="c">// If no drives were found and the user was asking for a specific</span>
                        <span class="c">// drive (no wildcards) then write an error</span>
 
                        <b>if</b> (!<span class="i">WildcardPattern</span>.<span class="i">ContainsWildcardCharacters</span>(<span class="r91 r">driveName</span>))
                        {
                            <span class="i">DriveNotFoundException</span> <span id="r93 rd" class="r93 r">driveNotFound</span> =
                                <b>new</b>(
                                    <span class="r91 r">driveName</span>,
                                    <span class="s">&quot;DriveNotFound&quot;</span>,
                                    <span class="i">SessionStateStrings</span>.<span class="i">DriveNotFound</span>);
 
                            <span class="i">WriteError</span>(
                                <b>new</b> <span class="i">ErrorRecord</span>(
                                    <span class="r93 r">driveNotFound</span>,
                                    <span class="s">&quot;GetDriveNoMatchingDrive&quot;</span>,
                                    <span class="i">ErrorCategory</span>.<span class="i">ObjectNotFound</span>,
                                    <span class="r91 r">driveName</span>));
                        }
                    }
                }
                <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r94 rd" class="r94 r">driveNotFound</span>)
                {
                    <span class="i">ErrorRecord</span> <span id="r95 rd" class="r95 r">errorRecord</span> =
                        <b>new</b>(
                            <span class="r94 r">driveNotFound</span>,
                            <span class="s">&quot;GetLocationNoMatchingDrive&quot;</span>,
                            <span class="i">ErrorCategory</span>.<span class="i">ObjectNotFound</span>,
                            <span class="r91 r">driveName</span>);
                    <span class="i">WriteError</span>(<span class="r95 r">errorRecord</span>);
                }
                <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r96 rd" class="r96 r">providerNotFound</span>)
                {
                    <span class="i">ErrorRecord</span> <span id="r97 rd" class="r97 r">errorRecord</span> =
                        <b>new</b>(
                            <span class="r96 r">providerNotFound</span>,
                            <span class="s">&quot;GetLocationNoMatchingDrive&quot;</span>,
                            <span class="i">ErrorCategory</span>.<span class="i">ObjectNotFound</span>,
                            <a href="#596db1bde2148754" class="i property">PSProvider</a>);
                    <span class="i">WriteError</span>(<span class="r97 r">errorRecord</span>);
                }
                <b>catch</b> (<span class="i">PSArgumentOutOfRangeException</span> <span id="r98 rd" class="r98 r">outOfRange</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r98 r">outOfRange</span>.<span class="i">ErrorRecord</span>,
                            <span class="r98 r">outOfRange</span>));
                }
                <b>catch</b> (<span class="i">PSArgumentException</span> <span id="r99 rd" class="r99 r">argException</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r99 r">argException</span>.<span class="i">ErrorRecord</span>,
                            <span class="r99 r">argException</span>));
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> GetPSDriveCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Drive commands
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Item commands
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> GetItemCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Gets the specified item using the namespace providers.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Get</span>, <span class="s">&quot;Item&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#0e92d9953d470069" class="i field">PathParameterSet</a>, <span class="i">SupportsTransactions</span> = <b>true</b>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096812&quot;</span>)]
    <b>public class</b> <a id="8c5bd2837519f2dc" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="cb6cdbc72a7ecfb3">GetItemCommand</span></a> : <a href="#98633376814a5912" class="t t">CoreCommandWithCredentialsBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <b>private const string</b> <a id="0e92d9953d470069" href="../../R/0e92d9953d470069.html" target="n" data-glyph="10,1" class="i field">PathParameterSet</a> = <span class="s">&quot;Path&quot;</span>;
        <b>private const string</b> <a id="32cabafc85ff60b1" href="../../R/32cabafc85ff60b1.html" target="n" data-glyph="10,1" class="i field">LiteralPathParameterSet</a> = <span class="s">&quot;LiteralPath&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the path to item to get.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#0e92d9953d470069" class="i field">PathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="7561a41c4435a5b3" href="../../R/7561a41c4435a5b3.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> =&gt; <a href="#cadd71a04abe342a" class="i field">_paths</a>;
            <b>set</b> =&gt; <a href="#cadd71a04abe342a" class="i field">_paths</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the literal path parameter to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#32cabafc85ff60b1" class="i field">LiteralPathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>false</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b>[] <a id="2d0cba4e61e271b5" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b> =&gt; <a href="#cadd71a04abe342a" class="i field">_paths</a>;
            <b>set</b>
            {
                <a href="#98633376814a5912" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
                <a href="#cadd71a04abe342a" class="i field">_paths</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the filter property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b> <a id="d53a16e2a49c00c1" href="../../R/d53a16e2a49c00c1.html" target="n" data-glyph="102,1" class="i property">Filter</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the include property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="0590ee39273bfb1a" href="../../R/0590ee39273bfb1a.html" target="n" data-glyph="102,1" class="i property">Include</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the exclude property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="53145b8dc8145aed" href="../../R/53145b8dc8145aed.html" target="n" data-glyph="102,1" class="i property">Exclude</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the force property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gives the provider guidance on how vigorous it should be about performing</span>
        <span class="c">///</span><span class="c"> the operation. If true, the provider should do everything possible to perform</span>
        <span class="c">///</span><span class="c"> the operation. If false, the provider should attempt the operation but allow</span>
        <span class="c">///</span><span class="c"> even simple errors to terminate the operation.</span>
        <span class="c">///</span><span class="c"> For example, if the user tries to copy a file to a path that already exists and</span>
        <span class="c">///</span><span class="c"> the destination is read-only, if force is true, the provider should copy over</span>
        <span class="c">///</span><span class="c"> the existing read-only file. If force is false, the provider should write an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override</b> <span class="i">SwitchParameter</span> <a id="f13727a5677661f4" href="../../R/f13727a5677661f4.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the dynamic parameters for the get-item cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the command is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object representing the dynamic parameters for the cmdlet or null if there</span>
        <span class="c">///</span><span class="c"> are none.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override object</b> <a id="f4acf58e1a84d545" href="../../R/f4acf58e1a84d545.html" target="n" data-glyph="74,1" class="i method">GetDynamicParameters</a>(<span class="i">CmdletProviderContext</span> <span id="r100 rd" class="r100 r">context</span>)
        {
            <b>if</b> (<a href="#7561a41c4435a5b3" class="i property">Path</a> != <b>null</b> &amp;&amp; <a href="#7561a41c4435a5b3" class="i property">Path</a>.<span class="i">Length</span> &gt; 0)
            {
                <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">GetItemDynamicParameters</span>(<a href="#7561a41c4435a5b3" class="i property">Path</a>[0], <span class="r100 r">context</span>);
            }
 
            <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">GetItemDynamicParameters</span>(<span class="s">&quot;.&quot;</span>, <span class="r100 r">context</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path of the item to get.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="cadd71a04abe342a" href="../../R/cadd71a04abe342a.html" target="n" data-glyph="46,1" class="i field">_paths</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the specified item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="e2b122a3d7e2e5c9" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>foreach</b> (<b>string</b> <span id="r101 rd" class="r101 r">path</span> <b>in</b> <a href="#cadd71a04abe342a" class="i field">_paths</a>)
            {
                <b>try</b>
                {
                    <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">Get</span>(<span class="r101 r">path</span>, <a href="#5ad1bfe4df30aef4" class="i property">CmdletProviderContext</a>);
                }
                <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r102 rd" class="r102 r">notSupported</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r102 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                            <span class="r102 r">notSupported</span>));
                }
                <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r103 rd" class="r103 r">driveNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r103 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r103 r">driveNotFound</span>));
                }
                <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r104 rd" class="r104 r">providerNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r104 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r104 r">providerNotFound</span>));
                }
                <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r105 rd" class="r105 r">pathNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r105 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r105 r">pathNotFound</span>));
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> GetItemCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> NewItemCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Creates the specified item using the namespace providers.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">New</span>, <span class="s">&quot;Item&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#c61bf30de6314ccd" class="i field">PathParameterSet</a>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">SupportsTransactions</span> = <b>true</b>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096592&quot;</span>)]
    <b>public class</b> <a id="9164b1c4ea6ef692" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="4241d0fecbe559e1">NewItemCommand</span></a> : <a href="#98633376814a5912" class="t t">CoreCommandWithCredentialsBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <b>private const string</b> <a id="70977b7f16ee0130" href="../../R/70977b7f16ee0130.html" target="n" data-glyph="10,1" class="i field">NameParameterSet</a> = <span class="s">&quot;nameSet&quot;</span>;
        <b>private const string</b> <a id="c61bf30de6314ccd" href="../../R/c61bf30de6314ccd.html" target="n" data-glyph="10,1" class="i field">PathParameterSet</a> = <span class="s">&quot;pathSet&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the container path to create the item in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#c61bf30de6314ccd" class="i field">PathParameterSet</a>, <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#70977b7f16ee0130" class="i field">NameParameterSet</a>, <span class="i">Mandatory</span> = <b>false</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="4b766612f0740480" href="../../R/4b766612f0740480.html" target="n" data-glyph="102,1" class="i property">Path</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the name of the item to create.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#70977b7f16ee0130" class="i field">NameParameterSet</a>, <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">AllowNull</span>]
        [<span class="i">AllowEmptyString</span>]
        <b>public string</b> <a id="d7121d6084490d2e" href="../../R/d7121d6084490d2e.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the type of the item to create.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;Type&quot;</span>)]
        <b>public string</b> <a id="0a54e63545f6f525" href="../../R/0a54e63545f6f525.html" target="n" data-glyph="102,1" class="i property">ItemType</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the content of the item to create.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ValueFromPipeline</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;Target&quot;</span>)]
        <b>public object</b> <a id="d19782d60675a73c" href="../../R/d19782d60675a73c.html" target="n" data-glyph="102,1" class="i property">Value</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the force property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gives the provider guidance on how vigorous it should be about performing</span>
        <span class="c">///</span><span class="c"> the operation. If true, the provider should do everything possible to perform</span>
        <span class="c">///</span><span class="c"> the operation. If false, the provider should attempt the operation but allow</span>
        <span class="c">///</span><span class="c"> even simple errors to terminate the operation.</span>
        <span class="c">///</span><span class="c"> For example, if the user tries to copy a file to a path that already exists and</span>
        <span class="c">///</span><span class="c"> the destination is read-only, if force is true, the provider should copy over</span>
        <span class="c">///</span><span class="c"> the existing read-only file. If force is false, the provider should write an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override</b> <span class="i">SwitchParameter</span> <a id="070bb8dfacf948a1" href="../../R/070bb8dfacf948a1.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the dynamic parameters for the new-item cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the command is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object representing the dynamic parameters for the cmdlet or null if there</span>
        <span class="c">///</span><span class="c"> are none.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override object</b> <a id="292d883eb111a607" href="../../R/292d883eb111a607.html" target="n" data-glyph="74,1" class="i method">GetDynamicParameters</a>(<span class="i">CmdletProviderContext</span> <span id="r106 rd" class="r106 r">context</span>)
        {
            <b>if</b> (<a href="#4b766612f0740480" class="i property">Path</a> != <b>null</b> &amp;&amp; <a href="#4b766612f0740480" class="i property">Path</a>.<span class="i">Length</span> &gt; 0)
            {
                <span class="c">// Path is only globbed if Name is specified.</span>
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#d7121d6084490d2e" class="i property">Name</a>))
                    <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">NewItemDynamicParameters</span>(<span class="i">WildcardPattern</span>.<span class="i">Escape</span>(<a href="#4b766612f0740480" class="i property">Path</a>[0]), <a href="#0a54e63545f6f525" class="i property">ItemType</a>, <a href="#d19782d60675a73c" class="i property">Value</a>, <span class="r106 r">context</span>);
                <b>else</b>
                    <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">NewItemDynamicParameters</span>(<a href="#4b766612f0740480" class="i property">Path</a>[0], <a href="#0a54e63545f6f525" class="i property">ItemType</a>, <a href="#d19782d60675a73c" class="i property">Value</a>, <span class="r106 r">context</span>);
            }
 
            <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">NewItemDynamicParameters</span>(<span class="s">&quot;.&quot;</span>, <a href="#0a54e63545f6f525" class="i property">ItemType</a>, <a href="#d19782d60675a73c" class="i property">Value</a>, <span class="r106 r">context</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the provider for the specified path supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="b947ae886e70f218" href="../../R/b947ae886e70f218.html" target="n" data-glyph="105,1" class="i property">ProviderSupportsShouldProcess</a> =&gt; <a href="#406a819cd9871eb1" class="i method">DoesProviderSupportShouldProcess</a>(<a href="#4b766612f0740480" class="i property">Path</a>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command Data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates the specified item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="3b1570807a810e1a" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#4b766612f0740480" class="i property">Path</a> == <b>null</b> || <a href="#4b766612f0740480" class="i property">Path</a>.<span class="i">Length</span> == 0)
            {
                <a href="#4b766612f0740480" class="i property">Path</a> = <b>new</b> <b>string</b>[] { <b>string</b>.<span class="i">Empty</span> };
            }
 
            <b>foreach</b> (<b>string</b> <span id="r107 rd" class="r107 r">path</span> <b>in</b> <a href="#4b766612f0740480" class="i property">Path</a>)
            {
                <b>try</b>
                {
                    <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">New</span>(<span class="r107 r">path</span>, <a href="#d7121d6084490d2e" class="i property">Name</a>, <a href="#0a54e63545f6f525" class="i property">ItemType</a>, <a href="#d19782d60675a73c" class="i property">Value</a>, <a href="#5ad1bfe4df30aef4" class="i property">CmdletProviderContext</a>);
                }
                <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r108 rd" class="r108 r">notSupported</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r108 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                            <span class="r108 r">notSupported</span>));
                }
                <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r109 rd" class="r109 r">driveNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r109 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r109 r">driveNotFound</span>));
                }
                <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r110 rd" class="r110 r">providerNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r110 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r110 r">providerNotFound</span>));
                }
                <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r111 rd" class="r111 r">pathNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r111 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r111 r">pathNotFound</span>));
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> NewItemCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> SetItemCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Sets the specified item using the namespace providers.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Set</span>, <span class="s">&quot;Item&quot;</span>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">DefaultParameterSetName</span> = <a href="#e84ad54f4a2363fe" class="i field">PathParameterSet</a>, <span class="i">SupportsTransactions</span> = <b>true</b>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2097055&quot;</span>)]
    <b>public class</b> <a id="ae60ecd46ea2c754" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="6c2c9edf10af5890">SetItemCommand</span></a> : <a href="#98633376814a5912" class="t t">CoreCommandWithCredentialsBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <b>private const string</b> <a id="e84ad54f4a2363fe" href="../../R/e84ad54f4a2363fe.html" target="n" data-glyph="10,1" class="i field">PathParameterSet</a> = <span class="s">&quot;Path&quot;</span>;
        <b>private const string</b> <a id="0d0b5e1444b21422" href="../../R/0d0b5e1444b21422.html" target="n" data-glyph="10,1" class="i field">LiteralPathParameterSet</a> = <span class="s">&quot;LiteralPath&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the path to item to set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#e84ad54f4a2363fe" class="i field">PathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="036b2660de555796" href="../../R/036b2660de555796.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> =&gt; <a href="#ee2c0b2e191c4360" class="i field">_paths</a>;
            <b>set</b> =&gt; <a href="#ee2c0b2e191c4360" class="i field">_paths</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the literal path parameter to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#0d0b5e1444b21422" class="i field">LiteralPathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>false</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b>[] <a id="9157b32e1b66e01a" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b> =&gt; <a href="#ee2c0b2e191c4360" class="i field">_paths</a>;
            <b>set</b>
            {
                <a href="#98633376814a5912" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
                <a href="#ee2c0b2e191c4360" class="i field">_paths</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the value of the item to be set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 1, <span class="i">ValueFromPipeline</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public object</b> <a id="4b0dc3364b2acb70" href="../../R/4b0dc3364b2acb70.html" target="n" data-glyph="102,1" class="i property">Value</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the force property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gives the provider guidance on how vigorous it should be about performing</span>
        <span class="c">///</span><span class="c"> the operation. If true, the provider should do everything possible to perform</span>
        <span class="c">///</span><span class="c"> the operation. If false, the provider should attempt the operation but allow</span>
        <span class="c">///</span><span class="c"> even simple errors to terminate the operation.</span>
        <span class="c">///</span><span class="c"> For example, if the user tries to copy a file to a path that already exists and</span>
        <span class="c">///</span><span class="c"> the destination is read-only, if force is true, the provider should copy over</span>
        <span class="c">///</span><span class="c"> the existing read-only file. If force is false, the provider should write an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override</b> <span class="i">SwitchParameter</span> <a id="af0140cb12c38e0a" href="../../R/af0140cb12c38e0a.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the pass through property which determines</span>
        <span class="c">///</span><span class="c"> if the object that is set should be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> Defaults to false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">SwitchParameter</span> <a id="c2d9f57a5e4a77a2" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">PassThru</a>
        {
            <b>get</b> =&gt; <a href="#2da138c2b196c1dc" class="i field">_passThrough</a>;
            <b>set</b> =&gt; <a href="#2da138c2b196c1dc" class="i field">_passThrough</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the filter property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b> <a id="a6a74fd45d5c7daa" href="../../R/a6a74fd45d5c7daa.html" target="n" data-glyph="102,1" class="i property">Filter</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the include property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="6728e1e2f27b118e" href="../../R/6728e1e2f27b118e.html" target="n" data-glyph="102,1" class="i property">Include</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the exclude property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="67d60357f6374801" href="../../R/67d60357f6374801.html" target="n" data-glyph="102,1" class="i property">Exclude</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the dynamic parameters for the set-item cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the command is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object representing the dynamic parameters for the cmdlet or null if there</span>
        <span class="c">///</span><span class="c"> are none.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override object</b> <a id="14d679bfae97285d" href="../../R/14d679bfae97285d.html" target="n" data-glyph="74,1" class="i method">GetDynamicParameters</a>(<span class="i">CmdletProviderContext</span> <span id="r112 rd" class="r112 r">context</span>)
        {
            <b>if</b> (<a href="#036b2660de555796" class="i property">Path</a> != <b>null</b> &amp;&amp; <a href="#036b2660de555796" class="i property">Path</a>.<span class="i">Length</span> &gt; 0)
            {
                <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">SetItemDynamicParameters</span>(<a href="#036b2660de555796" class="i property">Path</a>[0], <a href="#4b0dc3364b2acb70" class="i property">Value</a>, <span class="r112 r">context</span>);
            }
 
            <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">SetItemDynamicParameters</span>(<span class="s">&quot;.&quot;</span>, <a href="#4b0dc3364b2acb70" class="i property">Value</a>, <span class="r112 r">context</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the provider for the specified path supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="de5ee7580731f901" href="../../R/de5ee7580731f901.html" target="n" data-glyph="105,1" class="i property">ProviderSupportsShouldProcess</a> =&gt; <a href="#406a819cd9871eb1" class="i method">DoesProviderSupportShouldProcess</a>(<a href="#ee2c0b2e191c4360" class="i field">_paths</a>);
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path of the item to set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="ee2c0b2e191c4360" href="../../R/ee2c0b2e191c4360.html" target="n" data-glyph="46,1" class="i field">_paths</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the object being set should be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> Defaults to false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="2da138c2b196c1dc" href="../../R/2da138c2b196c1dc.html" target="n" data-glyph="46,1" class="i field">_passThrough</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the specified item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="d65d297c3dd604c2" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="c">// Default to the CmdletProviderContext that will direct output to</span>
            <span class="c">// the pipeline.</span>
 
            <span class="i">CmdletProviderContext</span> <span id="r113 rd" class="r113 r">currentCommandContext</span> = <a href="#5ad1bfe4df30aef4" class="i property">CmdletProviderContext</a>;
            <span class="r113 r">currentCommandContext</span>.<span class="i">PassThru</span> = <a href="#2da138c2b196c1dc" class="i field">_passThrough</a>;
 
            <b>foreach</b> (<b>string</b> <span id="r114 rd" class="r114 r">path</span> <b>in</b> <a href="#ee2c0b2e191c4360" class="i field">_paths</a>)
            {
                <b>try</b>
                {
                    <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">Set</span>(<span class="r114 r">path</span>, <a href="#4b0dc3364b2acb70" class="i property">Value</a>, <span class="r113 r">currentCommandContext</span>);
                }
                <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r115 rd" class="r115 r">notSupported</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r115 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                            <span class="r115 r">notSupported</span>));
                }
                <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r116 rd" class="r116 r">driveNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r116 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r116 r">driveNotFound</span>));
                }
                <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r117 rd" class="r117 r">providerNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r117 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r117 r">providerNotFound</span>));
                }
                <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r118 rd" class="r118 r">pathNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r118 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r118 r">pathNotFound</span>));
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> SetItemCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> RemoveItemCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Removes the specified item using the namespace providers.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Remove</span>, <span class="s">&quot;Item&quot;</span>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">DefaultParameterSetName</span> = <a href="#1037d9bf3ffb228b" class="i field">PathParameterSet</a>, <span class="i">SupportsTransactions</span> = <b>true</b>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2097103&quot;</span>)]
    <b>public class</b> <a id="428d457d08bc9aba" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="5480cd9d25f33146">RemoveItemCommand</span></a> : <a href="#98633376814a5912" class="t t">CoreCommandWithCredentialsBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <b>private const string</b> <a id="1037d9bf3ffb228b" href="../../R/1037d9bf3ffb228b.html" target="n" data-glyph="10,1" class="i field">PathParameterSet</a> = <span class="s">&quot;Path&quot;</span>;
        <b>private const string</b> <a id="82fd9b7f511daf82" href="../../R/82fd9b7f511daf82.html" target="n" data-glyph="10,1" class="i field">LiteralPathParameterSet</a> = <span class="s">&quot;LiteralPath&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#1037d9bf3ffb228b" class="i field">PathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="25377146da0c8423" href="../../R/25377146da0c8423.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> =&gt; <a href="#c438608febf56a3a" class="i field">_paths</a>;
            <b>set</b> =&gt; <a href="#c438608febf56a3a" class="i field">_paths</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the literal path parameter to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#82fd9b7f511daf82" class="i field">LiteralPathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>false</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b>[] <a id="0b565190b2cae345" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b> =&gt; <a href="#c438608febf56a3a" class="i field">_paths</a>;
            <b>set</b>
            {
                <a href="#98633376814a5912" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
                <a href="#c438608febf56a3a" class="i field">_paths</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the filter property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b> <a id="10c1c565e6f7e1f3" href="../../R/10c1c565e6f7e1f3.html" target="n" data-glyph="102,1" class="i property">Filter</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the include property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="33ac5d7f834c8b60" href="../../R/33ac5d7f834c8b60.html" target="n" data-glyph="102,1" class="i property">Include</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the exclude property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="69345d6b8f77a1e6" href="../../R/69345d6b8f77a1e6.html" target="n" data-glyph="102,1" class="i property">Exclude</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the recurse property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">SwitchParameter</span> <a id="cca4f04a7a08a8ad" href="../../R/cca4f04a7a08a8ad.html" target="n" data-glyph="102,1" class="i property">Recurse</a>
        {
            <b>get</b> =&gt; <a href="#46f955e237ab743c" class="i field">_recurse</a>;
            <b>set</b> =&gt; <a href="#46f955e237ab743c" class="i field">_recurse</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the force property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gives the provider guidance on how vigorous it should be about performing</span>
        <span class="c">///</span><span class="c"> the operation. If true, the provider should do everything possible to perform</span>
        <span class="c">///</span><span class="c"> the operation. If false, the provider should attempt the operation but allow</span>
        <span class="c">///</span><span class="c"> even simple errors to terminate the operation.</span>
        <span class="c">///</span><span class="c"> For example, if the user tries to copy a file to a path that already exists and</span>
        <span class="c">///</span><span class="c"> the destination is read-only, if force is true, the provider should copy over</span>
        <span class="c">///</span><span class="c"> the existing read-only file. If force is false, the provider should write an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override</b> <span class="i">SwitchParameter</span> <a id="0ac88d640648b480" href="../../R/0ac88d640648b480.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the dynamic parameters for the remove-item cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r119 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the command is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object representing the dynamic parameters for the cmdlet or null if there</span>
        <span class="c">///</span><span class="c"> are none.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override object</b> <a id="d058a5a747c5677b" href="../../R/d058a5a747c5677b.html" target="n" data-glyph="74,1" class="i method">GetDynamicParameters</a>(<span class="i">CmdletProviderContext</span> <span id="r119 rd" class="r119 r">context</span>)
        {
            <b>if</b> (<a href="#25377146da0c8423" class="i property">Path</a> != <b>null</b> &amp;&amp; <a href="#25377146da0c8423" class="i property">Path</a>.<span class="i">Length</span> &gt; 0)
            {
                <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">RemoveItemDynamicParameters</span>(<a href="#25377146da0c8423" class="i property">Path</a>[0], <a href="#cca4f04a7a08a8ad" class="i property">Recurse</a>, <span class="r119 r">context</span>);
            }
 
            <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">RemoveItemDynamicParameters</span>(<span class="s">&quot;.&quot;</span>, <a href="#cca4f04a7a08a8ad" class="i property">Recurse</a>, <span class="r119 r">context</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the provider for the specified path supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="a0e55e86c6b2d447" href="../../R/a0e55e86c6b2d447.html" target="n" data-glyph="105,1" class="i property">ProviderSupportsShouldProcess</a> =&gt; <a href="#406a819cd9871eb1" class="i method">DoesProviderSupportShouldProcess</a>(<a href="#c438608febf56a3a" class="i field">_paths</a>);
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path used when doing a delete.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="c438608febf56a3a" href="../../R/c438608febf56a3a.html" target="n" data-glyph="46,1" class="i field">_paths</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the remove command should recurse into</span>
        <span class="c">///</span><span class="c"> sub-containers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="46f955e237ab743c" href="../../R/46f955e237ab743c.html" target="n" data-glyph="46,1" class="i field">_recurse</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the specified items.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="b1b125f501f88d9d" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="i">CmdletProviderContext</span> <span id="r120 rd" class="r120 r">currentContext</span> = <a href="#5ad1bfe4df30aef4" class="i property">CmdletProviderContext</a>;
 
            <b>bool</b> <span id="r121 rd" class="r121 r">yesToAll</span> = <b>false</b>;
            <b>bool</b> <span id="r122 rd" class="r122 r">noToAll</span> = <b>false</b>;
 
            <b>foreach</b> (<b>string</b> <span id="r123 rd" class="r123 r">path</span> <b>in</b> <a href="#25377146da0c8423" class="i property">Path</a>)
            {
                <span class="c">// Resolve the path in case it contains any glob characters</span>
                <span class="i">Collection</span>&lt;<span class="i">PathInfo</span>&gt; <span id="r124 rd" class="r124 r">resolvedPSPaths</span> = <b>null</b>;
 
                <b>try</b>
                {
                    <span class="c">// Save the include and exclude filters so that we can ignore</span>
                    <span class="c">// them when doing recursion</span>
                    <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r125 rd" class="r125 r">include</span> = <span class="r120 r">currentContext</span>.<span class="i">Include</span>;
                    <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r126 rd" class="r126 r">exclude</span> = <span class="r120 r">currentContext</span>.<span class="i">Exclude</span>;
                    <b>string</b> <span id="r127 rd" class="r127 r">filter</span> = <span class="r120 r">currentContext</span>.<span class="i">Filter</span>;
 
                    <b>if</b> (<a href="#46f955e237ab743c" class="i field">_recurse</a>)
                    {
                        <span class="r120 r">currentContext</span>.<span class="i">SetFilters</span>(
                            <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(),
                            <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(),
                            <b>null</b>);
                    }
 
                    <b>try</b>
                    {
                        <span class="r124 r">resolvedPSPaths</span> = <span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">GetResolvedPSPathFromPSPath</span>(<span class="r123 r">path</span>, <span class="r120 r">currentContext</span>);
                        <b>if</b> (<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> == <b>true</b> &amp;&amp; <span class="r124 r">resolvedPSPaths</span>.<span class="i">Count</span> == 0)
                        {
                            <span class="i">ItemNotFoundException</span> <span id="r128 rd" class="r128 r">pathNotFound</span> =
                                <b>new</b>(
                                    <span class="r123 r">path</span>,
                                    <span class="s">&quot;PathNotFound&quot;</span>,
                                    <span class="i">SessionStateStrings</span>.<span class="i">PathNotFound</span>);
                            <span class="i">WriteError</span>(<b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r128 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r128 r">pathNotFound</span>));
                            <b>continue</b>;
                        }
                    }
                    <b>finally</b>
                    {
                        <span class="c">// Reset the include and exclude filters</span>
                        <span class="r120 r">currentContext</span>.<span class="i">SetFilters</span>(
                            <span class="r125 r">include</span>,
                            <span class="r126 r">exclude</span>,
                            <span class="r127 r">filter</span>);
                    }
                }
                <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r129 rd" class="r129 r">notSupported</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r129 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                            <span class="r129 r">notSupported</span>));
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r130 rd" class="r130 r">driveNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r130 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r130 r">driveNotFound</span>));
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r131 rd" class="r131 r">providerNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r131 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r131 r">providerNotFound</span>));
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r132 rd" class="r132 r">pathNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r132 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r132 r">pathNotFound</span>));
                    <b>continue</b>;
                }
 
                <b>foreach</b> (<span class="i">PathInfo</span> <span id="r133 rd" class="r133 r">resolvedPath</span> <b>in</b> <span class="r124 r">resolvedPSPaths</span>)
                {
                    <span class="c">// Check each path to make sure it isn&#39;t a parent of the current working location</span>
 
                    <b>bool</b> <span id="r134 rd" class="r134 r">isCurrentLocationOrAncestor</span> = <b>false</b>;
 
                    <b>try</b>
                    {
                        <span class="r134 r">isCurrentLocationOrAncestor</span> = <span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">IsCurrentLocationOrAncestor</span>(<span class="r133 r">resolvedPath</span>.<span class="i">Path</span>, <span class="r120 r">currentContext</span>);
                    }
                    <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r135 rd" class="r135 r">notSupported</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r135 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                                <span class="r135 r">notSupported</span>));
                        <b>continue</b>;
                    }
                    <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r136 rd" class="r136 r">driveNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r136 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r136 r">driveNotFound</span>));
                        <b>continue</b>;
                    }
                    <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r137 rd" class="r137 r">providerNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r137 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r137 r">providerNotFound</span>));
                        <b>continue</b>;
                    }
                    <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r138 rd" class="r138 r">pathNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r138 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r138 r">pathNotFound</span>));
                        <b>continue</b>;
                    }
 
                    <b>if</b> (<span class="r134 r">isCurrentLocationOrAncestor</span>)
                    {
                        <span class="i">PSInvalidOperationException</span> <span id="r139 rd" class="r139 r">invalidOperation</span> =
                            (<span class="i">PSInvalidOperationException</span>)<span class="i">PSTraceSource</span>.<span class="i">NewInvalidOperationException</span>(
                                <span class="i">NavigationResources</span>.<span class="i">RemoveItemInUse</span>,
                                <span class="r133 r">resolvedPath</span>.<span class="i">Path</span>);
 
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r139 r">invalidOperation</span>.<span class="i">ErrorRecord</span>,
                                <span class="r139 r">invalidOperation</span>));
                        <b>continue</b>;
                    }
 
                    <b>bool</b> <span id="r140 rd" class="r140 r">hasChildren</span> = <b>false</b>;
 
                    <b>string</b> <span id="r141 rd" class="r141 r">providerPath</span> = <span class="i">GetUnresolvedProviderPathFromPSPath</span>(<span class="r133 r">resolvedPath</span>.<span class="i">Path</span>);
 
                    <b>try</b>
                    {
                        <span class="r140 r">hasChildren</span> = <span class="i">SessionState</span>.<span class="i">Internal</span>.<span class="i">HasChildItems</span>(<span class="r133 r">resolvedPath</span>.<span class="i">Provider</span>.<span class="i">Name</span>, <span class="r141 r">providerPath</span>, <span class="r120 r">currentContext</span>);
 
                        <span class="r120 r">currentContext</span>.<span class="i">ThrowFirstErrorOrDoNothing</span>();
                    }
                    <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r142 rd" class="r142 r">notSupported</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r142 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                                <span class="r142 r">notSupported</span>));
                        <b>continue</b>;
                    }
                    <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r143 rd" class="r143 r">driveNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r143 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r143 r">driveNotFound</span>));
                        <b>continue</b>;
                    }
                    <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r144 rd" class="r144 r">providerNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r144 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r144 r">providerNotFound</span>));
                        <b>continue</b>;
                    }
                    <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r145 rd" class="r145 r">pathNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r145 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r145 r">pathNotFound</span>));
                        <b>continue</b>;
                    }
 
                    <b>bool</b> <span id="r146 rd" class="r146 r">shouldRecurse</span> = <a href="#cca4f04a7a08a8ad" class="i property">Recurse</a>;
                    <b>bool</b> <span id="r147 rd" class="r147 r">treatAsFile</span> = <b>false</b>;
 
                    <span class="c">// only check if path is a directory using DirectoryInfo if using FileSystemProvider</span>
                    <b>if</b> (<span class="r133 r">resolvedPath</span>.<span class="i">Provider</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="i">FileSystemProvider</span>.<span class="i">ProviderName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>try</b>
                        {
                            <span class="i">System</span>.<span class="i">IO</span>.<span class="i">DirectoryInfo</span> <span id="r148 rd" class="r148 r">di</span> = <b>new</b>(<span class="r141 r">providerPath</span>);
                            <b>if</b> (<span class="i">InternalSymbolicLinkLinkCodeMethods</span>.<span class="i">IsReparsePointLikeSymlink</span>(<span class="r148 r">di</span>))
                            {
                                <span class="r146 r">shouldRecurse</span> = <b>false</b>;
                                <span class="r147 r">treatAsFile</span> = <b>true</b>;
                            }
                        }
                        <b>catch</b> (<span class="i">System</span>.<span class="i">IO</span>.<span class="i">FileNotFoundException</span>)
                        {
                            <span class="c">// not a directory</span>
                        }
                    }
 
                    <b>if</b> (!<span class="r147 r">treatAsFile</span> &amp;&amp; !<a href="#cca4f04a7a08a8ad" class="i property">Recurse</a> &amp;&amp; <span class="r140 r">hasChildren</span>)
                    {
                        <span class="c">// Get the localized prompt string</span>
 
                        <b>string</b> <span id="r149 rd" class="r149 r">prompt</span> = <span class="i">StringUtil</span>.<span class="i">Format</span>(<span class="i">NavigationResources</span>.<span class="i">RemoveItemWithChildren</span>, <span class="r133 r">resolvedPath</span>.<span class="i">Path</span>);
 
                        <span class="c">// Confirm the user wants to remove all children and the item even if</span>
                        <span class="c">// they did not specify -recurse</span>
 
                        <b>if</b> (!<span class="i">ShouldContinue</span>(<span class="r149 r">prompt</span>, <b>null</b>, <b>ref</b> <span class="r121 r">yesToAll</span>, <b>ref</b> <span class="r122 r">noToAll</span>))
                        {
                            <b>continue</b>;
                        }
 
                        <span class="r146 r">shouldRecurse</span> = <b>true</b>;
                    }
 
                    <span class="c">// Now do the delete</span>
                    <span class="c">// This calls the internal method since it is more efficient</span>
                    <span class="c">// than trying to glob again.  It also will prevent problems</span>
                    <span class="c">// where globbing a second time may not have properly escaped</span>
                    <span class="c">// wildcard characters in the path.</span>
 
                    <b>try</b>
                    {
                        <span class="i">SessionState</span>.<span class="i">Internal</span>.<span class="i">RemoveItem</span>(
                            <span class="r133 r">resolvedPath</span>.<span class="i">Provider</span>.<span class="i">Name</span>,
                            <span class="r141 r">providerPath</span>,
                            <span class="r146 r">shouldRecurse</span>,
                            <span class="r120 r">currentContext</span>);
                    }
                    <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r150 rd" class="r150 r">notSupported</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r150 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                                <span class="r150 r">notSupported</span>));
                        <b>continue</b>;
                    }
                    <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r151 rd" class="r151 r">driveNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r151 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r151 r">driveNotFound</span>));
                        <b>continue</b>;
                    }
                    <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r152 rd" class="r152 r">providerNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r152 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r152 r">providerNotFound</span>));
                        <b>continue</b>;
                    }
                    <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r153 rd" class="r153 r">pathNotFound</span>)
                    {
                        <span class="i">WriteError</span>(
                            <b>new</b> <span class="i">ErrorRecord</span>(
                                <span class="r153 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                                <span class="r153 r">pathNotFound</span>));
                        <b>continue</b>;
                    }
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> RemoveItemCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> MoveItemCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Moves an item from the specified location to the specified destination using</span>
    <span class="c">///</span><span class="c"> the namespace providers.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Move</span>, <span class="s">&quot;Item&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#7088c1a8ff192d97" class="i field">PathParameterSet</a>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">SupportsTransactions</span> = <b>true</b>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096591&quot;</span>)]
    <b>public class</b> <a id="fda6592e1570789b" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="c8910747ea5b7c51">MoveItemCommand</span></a> : <a href="#98633376814a5912" class="t t">CoreCommandWithCredentialsBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <b>private const string</b> <a id="7088c1a8ff192d97" href="../../R/7088c1a8ff192d97.html" target="n" data-glyph="10,1" class="i field">PathParameterSet</a> = <span class="s">&quot;Path&quot;</span>;
        <b>private const string</b> <a id="51fc66c16d32749a" href="../../R/51fc66c16d32749a.html" target="n" data-glyph="10,1" class="i field">LiteralPathParameterSet</a> = <span class="s">&quot;LiteralPath&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#7088c1a8ff192d97" class="i field">PathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="d929b465c17e8088" href="../../R/d929b465c17e8088.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> =&gt; <a href="#45224b96bebe9c19" class="i field">_paths</a>;
            <b>set</b> =&gt; <a href="#45224b96bebe9c19" class="i field">_paths</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the literal path parameter to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#51fc66c16d32749a" class="i field">LiteralPathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>false</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b>[] <a id="065b6e50c5ac8741" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b> =&gt; <a href="#45224b96bebe9c19" class="i field">_paths</a>;
            <b>set</b>
            {
                <a href="#98633376814a5912" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
                <a href="#45224b96bebe9c19" class="i field">_paths</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the destination property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 1, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="ce8f6517839ceb6b" href="../../R/ce8f6517839ceb6b.html" target="n" data-glyph="102,1" class="i property">Destination</a> { <b>get</b>; <b>set</b>; } = <span class="s">&quot;.&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the force property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gives the provider guidance on how vigorous it should be about performing</span>
        <span class="c">///</span><span class="c"> the operation. If true, the provider should do everything possible to perform</span>
        <span class="c">///</span><span class="c"> the operation. If false, the provider should attempt the operation but allow</span>
        <span class="c">///</span><span class="c"> even simple errors to terminate the operation.</span>
        <span class="c">///</span><span class="c"> For example, if the user tries to copy a file to a path that already exists and</span>
        <span class="c">///</span><span class="c"> the destination is read-only, if force is true, the provider should copy over</span>
        <span class="c">///</span><span class="c"> the existing read-only file. If force is false, the provider should write an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override</b> <span class="i">SwitchParameter</span> <a id="269a28c647848212" href="../../R/269a28c647848212.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the filter property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b> <a id="ef584be0f01b482b" href="../../R/ef584be0f01b482b.html" target="n" data-glyph="102,1" class="i property">Filter</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the include property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="deda738f7aa8d441" href="../../R/deda738f7aa8d441.html" target="n" data-glyph="102,1" class="i property">Include</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the exclude property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="540896ac9028d9e3" href="../../R/540896ac9028d9e3.html" target="n" data-glyph="102,1" class="i property">Exclude</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the pass through property which determines</span>
        <span class="c">///</span><span class="c"> if the object that is set should be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> Defaults to false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">SwitchParameter</span> <a id="3197c210fc84ecea" href="../../R/3197c210fc84ecea.html" target="n" data-glyph="102,1" class="i property">PassThru</a>
        {
            <b>get</b> =&gt; <a href="#a30f60d259562c2e" class="i field">_passThrough</a>;
            <b>set</b> =&gt; <a href="#a30f60d259562c2e" class="i field">_passThrough</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the dynamic parameters for the move-item cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r154 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the command is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object representing the dynamic parameters for the cmdlet or null if there</span>
        <span class="c">///</span><span class="c"> are none.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override object</b> <a id="2815b2dc67f7c3f9" href="../../R/2815b2dc67f7c3f9.html" target="n" data-glyph="74,1" class="i method">GetDynamicParameters</a>(<span class="i">CmdletProviderContext</span> <span id="r154 rd" class="r154 r">context</span>)
        {
            <b>if</b> (<a href="#d929b465c17e8088" class="i property">Path</a> != <b>null</b> &amp;&amp; <a href="#d929b465c17e8088" class="i property">Path</a>.<span class="i">Length</span> &gt; 0)
            {
                <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">MoveItemDynamicParameters</span>(<a href="#d929b465c17e8088" class="i property">Path</a>[0], <a href="#ce8f6517839ceb6b" class="i property">Destination</a>, <span class="r154 r">context</span>);
            }
 
            <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">MoveItemDynamicParameters</span>(<span class="s">&quot;.&quot;</span>, <a href="#ce8f6517839ceb6b" class="i property">Destination</a>, <span class="r154 r">context</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the provider for the specified path supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="a1223bebd0c316eb" href="../../R/a1223bebd0c316eb.html" target="n" data-glyph="105,1" class="i property">ProviderSupportsShouldProcess</a> =&gt; <a href="#406a819cd9871eb1" class="i method">DoesProviderSupportShouldProcess</a>(<a href="#45224b96bebe9c19" class="i field">_paths</a>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path of the item to move. It is set or retrieved via</span>
        <span class="c">///</span><span class="c"> the Path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="45224b96bebe9c19" href="../../R/45224b96bebe9c19.html" target="n" data-glyph="46,1" class="i field">_paths</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the object being set should be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> Defaults to false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="a30f60d259562c2e" href="../../R/a30f60d259562c2e.html" target="n" data-glyph="46,1" class="i field">_passThrough</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <b>private</b> <span class="i">Collection</span>&lt;<span class="i">PathInfo</span>&gt; <a id="d698cb902552df2f" href="../../R/d698cb902552df2f.html" target="n" data-glyph="76,1" class="i method">GetResolvedPaths</a>(<b>string</b> <span id="r155 rd" class="r155 r">path</span>)
        {
            <span class="i">Collection</span>&lt;<span class="i">PathInfo</span>&gt; <span id="r156 rd" class="r156 r">results</span> = <b>new</b>();
            <b>try</b>
            {
                <span class="r156 r">results</span> = <span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">GetResolvedPSPathFromPSPath</span>(<span class="r155 r">path</span>, <a href="#5ad1bfe4df30aef4" class="i property">CmdletProviderContext</a>);
            }
            <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r157 rd" class="r157 r">notSupported</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r157 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                        <span class="r157 r">notSupported</span>));
            }
            <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r158 rd" class="r158 r">driveNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r158 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r158 r">driveNotFound</span>));
            }
            <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r159 rd" class="r159 r">providerNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r159 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r159 r">providerNotFound</span>));
            }
            <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r160 rd" class="r160 r">pathNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r160 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r160 r">pathNotFound</span>));
            }
 
            <b>return</b> <span class="r156 r">results</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Moves the specified item to the specified destination.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="93d1c7f86b717d8a" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>foreach</b> (<b>string</b> <span id="r161 rd" class="r161 r">path</span> <b>in</b> <a href="#d929b465c17e8088" class="i property">Path</a>)
            {
                <b>if</b> (<a href="#98633376814a5912" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a>)
                {
                    <a href="#75e174535e20b8cc" class="i method">MoveItem</a>(<span class="r161 r">path</span>, <span class="r162 r">literalPath</span>: <b>true</b>);
                }
                <b>else</b>
                {
                    <span class="i">Collection</span>&lt;<span class="i">PathInfo</span>&gt; <span id="r163 rd" class="r163 r">resolvedPaths</span> = <a href="#d698cb902552df2f" class="i method">GetResolvedPaths</a>(<span class="r161 r">path</span>);
 
                    <b>foreach</b> (<span class="i">PathInfo</span> <span id="r164 rd" class="r164 r">resolvedPathInfo</span> <b>in</b> <span class="r163 r">resolvedPaths</span>)
                    {
                        <b>string</b> <span id="r165 rd" class="r165 r">resolvedPath</span> = <span class="r164 r">resolvedPathInfo</span>.<span class="i">Path</span>;
                        <a href="#75e174535e20b8cc" class="i method">MoveItem</a>(<span class="r165 r">resolvedPath</span>, <span class="r162 r">literalPath</span>: <b>true</b>);
                    }
                }
            }
        }
 
        <b>private void</b> <a id="75e174535e20b8cc" href="../../R/75e174535e20b8cc.html" target="n" data-glyph="76,1" class="i method">MoveItem</a>(<b>string</b> <span id="r166 rd" class="r166 r">path</span>, <b>bool</b> <span id="r162 rd" class="r162 r">literalPath</span> = <b>false</b>)
        {
            <span class="i">CmdletProviderContext</span> <span id="r167 rd" class="r167 r">currentContext</span> = <a href="#5ad1bfe4df30aef4" class="i property">CmdletProviderContext</a>;
            <span class="r167 r">currentContext</span>.<span class="i">SuppressWildcardExpansion</span> = <span class="r162 r">literalPath</span>;
 
            <b>try</b>
            {
                <b>if</b> (!<span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">Exists</span>(<span class="r166 r">path</span>, <span class="r167 r">currentContext</span>))
                {
                    <span class="i">PSInvalidOperationException</span> <span id="r168 rd" class="r168 r">invalidOperation</span> =
                        (<span class="i">PSInvalidOperationException</span>)<span class="i">PSTraceSource</span>.<span class="i">NewInvalidOperationException</span>(
                            <span class="i">NavigationResources</span>.<span class="i">MoveItemDoesntExist</span>,
                            <span class="r166 r">path</span>);
 
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r168 r">invalidOperation</span>.<span class="i">ErrorRecord</span>,
                            <span class="r168 r">invalidOperation</span>));
                    <b>return</b>;
                }
            }
            <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r169 rd" class="r169 r">notSupported</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r169 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                        <span class="r169 r">notSupported</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r170 rd" class="r170 r">driveNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r170 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r170 r">driveNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r171 rd" class="r171 r">providerNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r171 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r171 r">providerNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r172 rd" class="r172 r">pathNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r172 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r172 r">pathNotFound</span>));
                <b>return</b>;
            }
 
            <span class="c">// See if the item to be moved is in use.</span>
            <b>bool</b> <span id="r173 rd" class="r173 r">isCurrentLocationOrAncestor</span> = <b>false</b>;
            <b>try</b>
            {
                <span class="r173 r">isCurrentLocationOrAncestor</span> = <span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">IsCurrentLocationOrAncestor</span>(<span class="r166 r">path</span>, <span class="r167 r">currentContext</span>);
            }
            <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r174 rd" class="r174 r">notSupported</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r174 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                        <span class="r174 r">notSupported</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r175 rd" class="r175 r">driveNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r175 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r175 r">driveNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r176 rd" class="r176 r">providerNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r176 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r176 r">providerNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r177 rd" class="r177 r">pathNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r177 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r177 r">pathNotFound</span>));
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r173 r">isCurrentLocationOrAncestor</span>)
            {
                <span class="i">PSInvalidOperationException</span> <span id="r178 rd" class="r178 r">invalidOperation</span> =
                    (<span class="i">PSInvalidOperationException</span>)<span class="i">PSTraceSource</span>.<span class="i">NewInvalidOperationException</span>(
                        <span class="i">NavigationResources</span>.<span class="i">MoveItemInUse</span>,
                        <span class="r166 r">path</span>);
 
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r178 r">invalidOperation</span>.<span class="i">ErrorRecord</span>,
                        <span class="r178 r">invalidOperation</span>));
                <b>return</b>;
            }
 
            <span class="c">// Default to the CmdletProviderContext that will direct output to</span>
            <span class="c">// the pipeline.</span>
 
            <span class="r167 r">currentContext</span>.<span class="i">PassThru</span> = <a href="#3197c210fc84ecea" class="i property">PassThru</a>;
 
            <a href="#3b36b44a7a5db63e" class="i field">tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Moving {0} to {1}&quot;</span>, <span class="r166 r">path</span>, <a href="#ce8f6517839ceb6b" class="i property">Destination</a>);
 
            <b>try</b>
            {
                <span class="c">// Now do the move</span>
                <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">Move</span>(<span class="r166 r">path</span>, <a href="#ce8f6517839ceb6b" class="i property">Destination</a>, <span class="r167 r">currentContext</span>);
            }
            <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r179 rd" class="r179 r">notSupported</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r179 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                        <span class="r179 r">notSupported</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r180 rd" class="r180 r">driveNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r180 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r180 r">driveNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r181 rd" class="r181 r">providerNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r181 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r181 r">providerNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r182 rd" class="r182 r">pathNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r182 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r182 r">pathNotFound</span>));
                <b>return</b>;
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
 
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> MoveItemCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> RenameItemCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Renames a specified item to a new name using the namespace providers.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Rename</span>, <span class="s">&quot;Item&quot;</span>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">SupportsTransactions</span> = <b>true</b>, <span class="i">DefaultParameterSetName</span> = <a href="#5637afee888113df" class="i field">ByPathParameterSet</a>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2097153&quot;</span>)]
    <b>public class</b> <a id="fc93f89ca194f2ff" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="75e7b90ca4c3c368">RenameItemCommand</span></a> : <a href="#98633376814a5912" class="t t">CoreCommandWithCredentialsBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <b>private const string</b> <a id="5637afee888113df" href="../../R/5637afee888113df.html" target="n" data-glyph="10,1" class="i field">ByPathParameterSet</a> = <span class="s">&quot;ByPath&quot;</span>;
        <b>private const string</b> <a id="7dd987ae3c3c8a5a" href="../../R/7dd987ae3c3c8a5a.html" target="n" data-glyph="10,1" class="i field">ByLiteralPathParameterSet</a> = <span class="s">&quot;ByLiteralPath&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>, <span class="i">ParameterSetName</span> = <a href="#5637afee888113df" class="i field">ByPathParameterSet</a>)]
        <b>public string</b> <a id="71a0d0214ee41b65" href="../../R/71a0d0214ee41b65.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> =&gt; <a href="#ead2c539f8b0f027" class="i field">_path</a>;
            <b>set</b> =&gt; <a href="#ead2c539f8b0f027" class="i field">_path</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the literal path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>, <span class="i">ParameterSetName</span> = <a href="#7dd987ae3c3c8a5a" class="i field">ByLiteralPathParameterSet</a>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b> <a id="1e52edd7e98db817" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b> =&gt; <a href="#ead2c539f8b0f027" class="i field">_path</a>;
            <b>set</b>
            {
                <a href="#ead2c539f8b0f027" class="i field">_path</a> = <b>value</b>;
                <a href="#98633376814a5912" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the newName property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 1, <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="4c1fd869e79a5158" href="../../R/4c1fd869e79a5158.html" target="n" data-glyph="102,1" class="i property">NewName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the force property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gives the provider guidance on how vigorous it should be about performing</span>
        <span class="c">///</span><span class="c"> the operation. If true, the provider should do everything possible to perform</span>
        <span class="c">///</span><span class="c"> the operation. If false, the provider should attempt the operation but allow</span>
        <span class="c">///</span><span class="c"> even simple errors to terminate the operation.</span>
        <span class="c">///</span><span class="c"> For example, if the user tries to copy a file to a path that already exists and</span>
        <span class="c">///</span><span class="c"> the destination is read-only, if force is true, the provider should copy over</span>
        <span class="c">///</span><span class="c"> the existing read-only file. If force is false, the provider should write an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override</b> <span class="i">SwitchParameter</span> <a id="3b3757466c08d043" href="../../R/3b3757466c08d043.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the pass through property which determines</span>
        <span class="c">///</span><span class="c"> if the object that is set should be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> Defaults to false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">SwitchParameter</span> <a id="00fde942ca58b67e" href="../../R/00fde942ca58b67e.html" target="n" data-glyph="102,1" class="i property">PassThru</a>
        {
            <b>get</b> =&gt; <a href="#6c955d7ea7d60b38" class="i field">_passThrough</a>;
            <b>set</b> =&gt; <a href="#6c955d7ea7d60b38" class="i field">_passThrough</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the dynamic parameters for the rename-item cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r183 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the command is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object representing the dynamic parameters for the cmdlet or null if there</span>
        <span class="c">///</span><span class="c"> are none.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override object</b> <a id="16ae88776dad96a4" href="../../R/16ae88776dad96a4.html" target="n" data-glyph="74,1" class="i method">GetDynamicParameters</a>(<span class="i">CmdletProviderContext</span> <span id="r183 rd" class="r183 r">context</span>)
        {
            <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">RenameItemDynamicParameters</span>(<a href="#71a0d0214ee41b65" class="i property">Path</a>, <a href="#4c1fd869e79a5158" class="i property">NewName</a>, <span class="r183 r">context</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the provider for the specified path supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="953e1bb42f250244" href="../../R/953e1bb42f250244.html" target="n" data-glyph="105,1" class="i property">ProviderSupportsShouldProcess</a> =&gt; <a href="#406a819cd9871eb1" class="i method">DoesProviderSupportShouldProcess</a>(<b>new</b> <b>string</b>[] { <a href="#ead2c539f8b0f027" class="i field">_path</a> });
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path of the item to rename. It is set or retrieved via</span>
        <span class="c">///</span><span class="c"> the Path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="ead2c539f8b0f027" href="../../R/ead2c539f8b0f027.html" target="n" data-glyph="46,1" class="i field">_path</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the object being set should be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> Defaults to false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="6c955d7ea7d60b38" href="../../R/6c955d7ea7d60b38.html" target="n" data-glyph="46,1" class="i field">_passThrough</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <b>private</b> <span class="i">Collection</span>&lt;<span class="i">PathInfo</span>&gt; <a id="a7b43f010c1dc1f9" href="../../R/a7b43f010c1dc1f9.html" target="n" data-glyph="76,1" class="i method">GetResolvedPaths</a>(<b>string</b> <span id="r184 rd" class="r184 r">path</span>)
        {
            <span class="i">Collection</span>&lt;<span class="i">PathInfo</span>&gt; <span id="r185 rd" class="r185 r">results</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r185 r">results</span> = <span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">GetResolvedPSPathFromPSPath</span>(<span class="r184 r">path</span>, <a href="#5ad1bfe4df30aef4" class="i property">CmdletProviderContext</a>);
            }
            <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r186 rd" class="r186 r">notSupported</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r186 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                        <span class="r186 r">notSupported</span>));
            }
            <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r187 rd" class="r187 r">driveNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r187 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r187 r">driveNotFound</span>));
            }
            <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r188 rd" class="r188 r">providerNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r188 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r188 r">providerNotFound</span>));
            }
            <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r189 rd" class="r189 r">pathNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r189 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r189 r">pathNotFound</span>));
            }
 
            <b>return</b> <span class="r185 r">results</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Moves the specified item to the specified destination.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="3aab40c254c90b76" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a>)
            {
                <a href="#24856f3e1dc81d95" class="i method">RenameItem</a>(<a href="#71a0d0214ee41b65" class="i property">Path</a>, <span class="r190 r">literalPath</span>: <b>true</b>);
                <b>return</b>;
            }
 
            <span class="i">Collection</span>&lt;<span class="i">PathInfo</span>&gt; <span id="r191 rd" class="r191 r">resolvedPaths</span> = <a href="#a7b43f010c1dc1f9" class="i method">GetResolvedPaths</a>(<a href="#71a0d0214ee41b65" class="i property">Path</a>);
            <b>if</b> (<span class="r191 r">resolvedPaths</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r191 r">resolvedPaths</span>.<span class="i">Count</span> == 1)
            {
                <span class="i">RenameItem</span>(<span class="r191 r">resolvedPaths</span>[0].<span class="i">Path</span>, <span class="i">literalPath</span>: <b>true</b>);
            }
            <b>else</b>
            {
                <span class="i">RenameItem</span>(<span class="i">WildcardPattern</span>.<span class="i">Unescape</span>(<a href="#71a0d0214ee41b65" class="i property">Path</a>), <span class="i">literalPath</span>: <b>true</b>);
            }
        }
 
        <b>private void</b> <a id="24856f3e1dc81d95" href="../../R/24856f3e1dc81d95.html" target="n" data-glyph="76,1" class="i method">RenameItem</a>(<b>string</b> <span id="r192 rd" class="r192 r">path</span>, <b>bool</b> <span id="r190 rd" class="r190 r">literalPath</span> = <b>false</b>)
        {
            <span class="i">CmdletProviderContext</span> <span id="r193 rd" class="r193 r">currentContext</span> = <a href="#5ad1bfe4df30aef4" class="i property">CmdletProviderContext</a>;
            <span class="r193 r">currentContext</span>.<span class="i">SuppressWildcardExpansion</span> = <span class="r190 r">literalPath</span>;
 
            <b>try</b>
            {
                <b>if</b> (!<span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">Exists</span>(<span class="r192 r">path</span>, <span class="r193 r">currentContext</span>))
                {
                    <span class="i">PSInvalidOperationException</span> <span id="r194 rd" class="r194 r">invalidOperation</span> =
                        (<span class="i">PSInvalidOperationException</span>)<span class="i">PSTraceSource</span>.<span class="i">NewInvalidOperationException</span>(
                            <span class="i">NavigationResources</span>.<span class="i">RenameItemDoesntExist</span>,
                            <span class="r192 r">path</span>);
 
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r194 r">invalidOperation</span>.<span class="i">ErrorRecord</span>,
                            <span class="r194 r">invalidOperation</span>));
                    <b>return</b>;
                }
            }
            <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r195 rd" class="r195 r">notSupported</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r195 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                        <span class="r195 r">notSupported</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r196 rd" class="r196 r">driveNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r196 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r196 r">driveNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r197 rd" class="r197 r">providerNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r197 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r197 r">providerNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r198 rd" class="r198 r">pathNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r198 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r198 r">pathNotFound</span>));
                <b>return</b>;
            }
 
            <span class="c">// See if the item to be moved is in use.</span>
            <b>bool</b> <span id="r199 rd" class="r199 r">isCurrentLocationOrAncestor</span> = <b>false</b>;
            <b>try</b>
            {
                <span class="r199 r">isCurrentLocationOrAncestor</span> = <span class="i">SessionState</span>.<span class="i">Path</span>.<span class="i">IsCurrentLocationOrAncestor</span>(<span class="r192 r">path</span>, <span class="r193 r">currentContext</span>);
            }
            <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r200 rd" class="r200 r">notSupported</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r200 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                        <span class="r200 r">notSupported</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r201 rd" class="r201 r">driveNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r201 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r201 r">driveNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r202 rd" class="r202 r">providerNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r202 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r202 r">providerNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r203 rd" class="r203 r">pathNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r203 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r203 r">pathNotFound</span>));
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r199 r">isCurrentLocationOrAncestor</span>)
            {
                <span class="i">PSInvalidOperationException</span> <span id="r204 rd" class="r204 r">invalidOperation</span> =
                    (<span class="i">PSInvalidOperationException</span>)<span class="i">PSTraceSource</span>.<span class="i">NewInvalidOperationException</span>(
                        <span class="i">NavigationResources</span>.<span class="i">RenamedItemInUse</span>,
                        <span class="r192 r">path</span>);
 
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r204 r">invalidOperation</span>.<span class="i">ErrorRecord</span>,
                        <span class="r204 r">invalidOperation</span>));
                <b>return</b>;
            }
 
            <span class="c">// Default to the CmdletProviderContext that will direct output to</span>
            <span class="c">// the pipeline.</span>
            <span class="r193 r">currentContext</span>.<span class="i">PassThru</span> = <a href="#00fde942ca58b67e" class="i property">PassThru</a>;
 
            <a href="#3b36b44a7a5db63e" class="i field">tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Rename {0} to {1}&quot;</span>, <span class="r192 r">path</span>, <a href="#4c1fd869e79a5158" class="i property">NewName</a>);
 
            <b>try</b>
            {
                <span class="c">// Now do the rename</span>
                <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">Rename</span>(<span class="r192 r">path</span>, <a href="#4c1fd869e79a5158" class="i property">NewName</a>, <span class="r193 r">currentContext</span>);
            }
            <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r205 rd" class="r205 r">notSupported</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r205 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                        <span class="r205 r">notSupported</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r206 rd" class="r206 r">driveNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r206 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r206 r">driveNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r207 rd" class="r207 r">providerNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r207 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r207 r">providerNotFound</span>));
                <b>return</b>;
            }
            <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r208 rd" class="r208 r">pathNotFound</span>)
            {
                <span class="i">WriteError</span>(
                    <b>new</b> <span class="i">ErrorRecord</span>(
                        <span class="r208 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                        <span class="r208 r">pathNotFound</span>));
                <b>return</b>;
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
 
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> RenameItemCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CopyItemCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Copies a specified item to a new location using the namespace providers.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Copy</span>, <span class="s">&quot;Item&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#31c6ecb8a888312c" class="i field">PathParameterSet</a>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">SupportsTransactions</span> = <b>true</b>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096990&quot;</span>)]
    <b>public class</b> <a id="313bb4e47942854c" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="af9e6f2b11ca505c">CopyItemCommand</span></a> : <a href="#98633376814a5912" class="t t">CoreCommandWithCredentialsBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <b>private const string</b> <a id="31c6ecb8a888312c" href="../../R/31c6ecb8a888312c.html" target="n" data-glyph="10,1" class="i field">PathParameterSet</a> = <span class="s">&quot;Path&quot;</span>;
        <b>private const string</b> <a id="e501e80832741857" href="../../R/e501e80832741857.html" target="n" data-glyph="10,1" class="i field">LiteralPathParameterSet</a> = <span class="s">&quot;LiteralPath&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#31c6ecb8a888312c" class="i field">PathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="87a8511def78572d" href="../../R/87a8511def78572d.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> =&gt; <a href="#b545c9a9bba88b0e" class="i field">_paths</a>;
            <b>set</b> =&gt; <a href="#b545c9a9bba88b0e" class="i field">_paths</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the literal path parameter to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#e501e80832741857" class="i field">LiteralPathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>false</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b>[] <a id="03076dcc97bf8166" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b> =&gt; <a href="#b545c9a9bba88b0e" class="i field">_paths</a>;
            <b>set</b>
            {
                <a href="#98633376814a5912" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
                <a href="#b545c9a9bba88b0e" class="i field">_paths</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the destination property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 1, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b> <a id="fdd410971b638f65" href="../../R/fdd410971b638f65.html" target="n" data-glyph="102,1" class="i property">Destination</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the container property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">SwitchParameter</span> <a id="3e8edd312e5a7e82" href="../../R/3e8edd312e5a7e82.html" target="n" data-glyph="102,1" class="i property">Container</a>
        {
            <b>get</b> =&gt; <a href="#c62b56806b80c242" class="i field">_container</a>;
            <b>set</b>
            {
                <a href="#07dae888b8455092" class="i field">_containerSpecified</a> = <b>true</b>;
                <a href="#c62b56806b80c242" class="i field">_container</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the force property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gives the provider guidance on how vigorous it should be about performing</span>
        <span class="c">///</span><span class="c"> the operation. If true, the provider should do everything possible to perform</span>
        <span class="c">///</span><span class="c"> the operation. If false, the provider should attempt the operation but allow</span>
        <span class="c">///</span><span class="c"> even simple errors to terminate the operation.</span>
        <span class="c">///</span><span class="c"> For example, if the user tries to copy a file to a path that already exists and</span>
        <span class="c">///</span><span class="c"> the destination is read-only, if force is true, the provider should copy over</span>
        <span class="c">///</span><span class="c"> the existing read-only file. If force is false, the provider should write an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override</b> <span class="i">SwitchParameter</span> <a id="2b4b642754ec374f" href="../../R/2b4b642754ec374f.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the filter property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b> <a id="5dc97348501dac0c" href="../../R/5dc97348501dac0c.html" target="n" data-glyph="102,1" class="i property">Filter</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the include property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="4b037479e798f91a" href="../../R/4b037479e798f91a.html" target="n" data-glyph="102,1" class="i property">Include</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the exclude property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="8ecabb42135b13a8" href="../../R/8ecabb42135b13a8.html" target="n" data-glyph="102,1" class="i property">Exclude</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the recurse property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">SwitchParameter</span> <a id="284e31c321977008" href="../../R/284e31c321977008.html" target="n" data-glyph="102,1" class="i property">Recurse</a>
        {
            <b>get</b> =&gt; <a href="#74adf33790724cd7" class="i field">_recurse</a>;
            <b>set</b>
            {
                <a href="#74adf33790724cd7" class="i field">_recurse</a> = <b>value</b>;
 
                <span class="c">// is, then -Container takes on the same value</span>
                <span class="c">// as -Recurse</span>
 
                <b>if</b> (!<a href="#07dae888b8455092" class="i field">_containerSpecified</a>)
                {
                    <a href="#c62b56806b80c242" class="i field">_container</a> = <a href="#74adf33790724cd7" class="i field">_recurse</a>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the pass through property which determines</span>
        <span class="c">///</span><span class="c"> if the object that is set should be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> Defaults to false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">SwitchParameter</span> <a id="ca43bdebbc518dc5" href="../../R/ca43bdebbc518dc5.html" target="n" data-glyph="102,1" class="i property">PassThru</a>
        {
            <b>get</b> =&gt; <a href="#7705128a7031644a" class="i field">_passThrough</a>;
            <b>set</b> =&gt; <a href="#7705128a7031644a" class="i field">_passThrough</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the dynamic parameters for the copy-item cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r209 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the command is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object representing the dynamic parameters for the cmdlet or null if there</span>
        <span class="c">///</span><span class="c"> are none.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override object</b> <a id="df78725248fb9fc4" href="../../R/df78725248fb9fc4.html" target="n" data-glyph="74,1" class="i method">GetDynamicParameters</a>(<span class="i">CmdletProviderContext</span> <span id="r209 rd" class="r209 r">context</span>)
        {
            <b>if</b> (<a href="#87a8511def78572d" class="i property">Path</a> != <b>null</b> &amp;&amp; <a href="#87a8511def78572d" class="i property">Path</a>.<span class="i">Length</span> &gt; 0)
            {
                <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">CopyItemDynamicParameters</span>(<a href="#87a8511def78572d" class="i property">Path</a>[0], <a href="#fdd410971b638f65" class="i property">Destination</a>, <a href="#284e31c321977008" class="i property">Recurse</a>, <span class="r209 r">context</span>);
            }
 
            <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">CopyItemDynamicParameters</span>(<span class="s">&quot;.&quot;</span>, <a href="#fdd410971b638f65" class="i property">Destination</a>, <a href="#284e31c321977008" class="i property">Recurse</a>, <span class="r209 r">context</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the provider for the specified path supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="2e29b105630654fd" href="../../R/2e29b105630654fd.html" target="n" data-glyph="105,1" class="i property">ProviderSupportsShouldProcess</a> =&gt; <a href="#406a819cd9871eb1" class="i method">DoesProviderSupportShouldProcess</a>(<a href="#b545c9a9bba88b0e" class="i field">_paths</a>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path of the item to copy. It is set or retrieved via</span>
        <span class="c">///</span><span class="c"> the Path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="b545c9a9bba88b0e" href="../../R/b545c9a9bba88b0e.html" target="n" data-glyph="46,1" class="i field">_paths</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the containers should be copied with the items or not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="c62b56806b80c242" href="../../R/c62b56806b80c242.html" target="n" data-glyph="46,1" class="i field">_container</a> = <b>true</b>;
        <b>private bool</b> <a id="07dae888b8455092" href="../../R/07dae888b8455092.html" target="n" data-glyph="46,1" class="i field">_containerSpecified</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the copy command should recurse into</span>
        <span class="c">///</span><span class="c"> sub-containers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="74adf33790724cd7" href="../../R/74adf33790724cd7.html" target="n" data-glyph="46,1" class="i field">_recurse</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the object being set should be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> Defaults to false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="7705128a7031644a" href="../../R/7705128a7031644a.html" target="n" data-glyph="46,1" class="i field">_passThrough</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Copies the specified item(s) to the specified destination.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="70b36ce6c7e5dc4b" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="i">CmdletProviderContext</span> <span id="r210 rd" class="r210 r">currentCommandContext</span> = <a href="#5ad1bfe4df30aef4" class="i property">CmdletProviderContext</a>;
            <span class="r210 r">currentCommandContext</span>.<span class="i">PassThru</span> = <a href="#ca43bdebbc518dc5" class="i property">PassThru</a>;
 
            <b>foreach</b> (<b>string</b> <span id="r211 rd" class="r211 r">path</span> <b>in</b> <a href="#b545c9a9bba88b0e" class="i field">_paths</a>)
            {
                <a href="#3b36b44a7a5db63e" class="i field">tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Copy {0} to {1}&quot;</span>, <span class="r211 r">path</span>, <a href="#fdd410971b638f65" class="i property">Destination</a>);
 
                <b>try</b>
                {
                    <span class="i">CopyContainers</span> <span id="r212 rd" class="r212 r">copyContainers</span> = (<a href="#3e8edd312e5a7e82" class="i property">Container</a>) ? <span class="i">CopyContainers</span>.<span class="i">CopyTargetContainer</span> : <span class="i">CopyContainers</span>.<span class="i">CopyChildrenOfTargetContainer</span>;
 
                    <span class="c">// Now do the copy</span>
                    <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">Copy</span>(<span class="r211 r">path</span>, <a href="#fdd410971b638f65" class="i property">Destination</a>, <a href="#284e31c321977008" class="i property">Recurse</a>, <span class="r212 r">copyContainers</span>, <span class="r210 r">currentCommandContext</span>);
                }
                <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r213 rd" class="r213 r">notSupported</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r213 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                            <span class="r213 r">notSupported</span>));
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r214 rd" class="r214 r">driveNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r214 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r214 r">driveNotFound</span>));
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r215 rd" class="r215 r">providerNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r215 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r215 r">providerNotFound</span>));
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r216 rd" class="r216 r">pathNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r216 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r216 r">pathNotFound</span>));
                    <b>continue</b>;
                }
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
 
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> CopyItemCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> ClearItemCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Clears an item at the specified location.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Clear</span>, <span class="s">&quot;Item&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#1775a74db4929dbd" class="i field">PathParameterSet</a>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">SupportsTransactions</span> = <b>true</b>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096491&quot;</span>)]
    <b>public class</b> <a id="1995b67c9f0d697d" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="2655203509af8819">ClearItemCommand</span></a> : <a href="#98633376814a5912" class="t t">CoreCommandWithCredentialsBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <b>private const string</b> <a id="1775a74db4929dbd" href="../../R/1775a74db4929dbd.html" target="n" data-glyph="10,1" class="i field">PathParameterSet</a> = <span class="s">&quot;Path&quot;</span>;
        <b>private const string</b> <a id="214586fba58fa2a3" href="../../R/214586fba58fa2a3.html" target="n" data-glyph="10,1" class="i field">LiteralPathParameterSet</a> = <span class="s">&quot;LiteralPath&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#1775a74db4929dbd" class="i field">PathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="4dd6dd007ae93991" href="../../R/4dd6dd007ae93991.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> =&gt; <a href="#08078407db3fa42b" class="i field">_paths</a>;
            <b>set</b> =&gt; <a href="#08078407db3fa42b" class="i field">_paths</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the literal path parameter to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#214586fba58fa2a3" class="i field">LiteralPathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>false</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b>[] <a id="36ecb228aafe985c" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b> =&gt; <a href="#08078407db3fa42b" class="i field">_paths</a>;
            <b>set</b>
            {
                <a href="#98633376814a5912" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
                <a href="#08078407db3fa42b" class="i field">_paths</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the force property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gives the provider guidance on how vigorous it should be about performing</span>
        <span class="c">///</span><span class="c"> the operation. If true, the provider should do everything possible to perform</span>
        <span class="c">///</span><span class="c"> the operation. If false, the provider should attempt the operation but allow</span>
        <span class="c">///</span><span class="c"> even simple errors to terminate the operation.</span>
        <span class="c">///</span><span class="c"> For example, if the user tries to copy a file to a path that already exists and</span>
        <span class="c">///</span><span class="c"> the destination is read-only, if force is true, the provider should copy over</span>
        <span class="c">///</span><span class="c"> the existing read-only file. If force is false, the provider should write an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override</b> <span class="i">SwitchParameter</span> <a id="d6129a98d2385d12" href="../../R/d6129a98d2385d12.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#e526073d49c1c7c1" class="i property">Force</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the filter property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b> <a id="28ef355be182408a" href="../../R/28ef355be182408a.html" target="n" data-glyph="102,1" class="i property">Filter</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the include property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="fbfdc26e8a62c7c2" href="../../R/fbfdc26e8a62c7c2.html" target="n" data-glyph="102,1" class="i property">Include</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the exclude property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="a30380204cdc1759" href="../../R/a30380204cdc1759.html" target="n" data-glyph="102,1" class="i property">Exclude</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the dynamic parameters for the clear-item cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r217 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the command is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object representing the dynamic parameters for the cmdlet or null if there</span>
        <span class="c">///</span><span class="c"> are none.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override object</b> <a id="b5568f3e911b0e0d" href="../../R/b5568f3e911b0e0d.html" target="n" data-glyph="74,1" class="i method">GetDynamicParameters</a>(<span class="i">CmdletProviderContext</span> <span id="r217 rd" class="r217 r">context</span>)
        {
            <b>if</b> (<a href="#4dd6dd007ae93991" class="i property">Path</a> != <b>null</b> &amp;&amp; <a href="#4dd6dd007ae93991" class="i property">Path</a>.<span class="i">Length</span> &gt; 0)
            {
                <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">ClearItemDynamicParameters</span>(<a href="#4dd6dd007ae93991" class="i property">Path</a>[0], <span class="r217 r">context</span>);
            }
 
            <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">ClearItemDynamicParameters</span>(<span class="s">&quot;.&quot;</span>, <span class="r217 r">context</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the provider for the specified path supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="0db89f69fee85480" href="../../R/0db89f69fee85480.html" target="n" data-glyph="105,1" class="i property">ProviderSupportsShouldProcess</a> =&gt; <a href="#406a819cd9871eb1" class="i method">DoesProviderSupportShouldProcess</a>(<a href="#08078407db3fa42b" class="i field">_paths</a>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path of the item to move. It is set or retrieved via</span>
        <span class="c">///</span><span class="c"> the Path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="08078407db3fa42b" href="../../R/08078407db3fa42b.html" target="n" data-glyph="46,1" class="i field">_paths</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Clears the specified item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="2d62fbbcad78f8d0" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="c">// Default to the CmdletProviderContext that will direct output to</span>
            <span class="c">// the pipeline.</span>
 
            <span class="i">CmdletProviderContext</span> <span id="r218 rd" class="r218 r">currentCommandContext</span> = <a href="#5ad1bfe4df30aef4" class="i property">CmdletProviderContext</a>;
            <span class="r218 r">currentCommandContext</span>.<span class="i">PassThru</span> = <b>false</b>;
 
            <b>foreach</b> (<b>string</b> <span id="r219 rd" class="r219 r">path</span> <b>in</b> <a href="#08078407db3fa42b" class="i field">_paths</a>)
            {
                <a href="#3b36b44a7a5db63e" class="i field">tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Clearing {0}&quot;</span>, <span class="r219 r">path</span>);
 
                <b>try</b>
                {
                    <span class="c">// Now do the move</span>
                    <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">Clear</span>(<span class="r219 r">path</span>, <span class="r218 r">currentCommandContext</span>);
                }
                <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r220 rd" class="r220 r">notSupported</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r220 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                            <span class="r220 r">notSupported</span>));
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r221 rd" class="r221 r">driveNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r221 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r221 r">driveNotFound</span>));
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r222 rd" class="r222 r">providerNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r222 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r222 r">providerNotFound</span>));
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r223 rd" class="r223 r">pathNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r223 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r223 r">pathNotFound</span>));
                    <b>continue</b>;
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ClearItemCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> InvokeItemCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Invokes an item at the specified location.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsLifecycle</span>.<span class="i">Invoke</span>, <span class="s">&quot;Item&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#0dbf31166098510e" class="i field">PathParameterSet</a>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">SupportsTransactions</span> = <b>true</b>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096590&quot;</span>)]
    <b>public class</b> <a id="4d4b3cfc489fae2c" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="5a5d9aa081c91dee">InvokeItemCommand</span></a> : <a href="#98633376814a5912" class="t t">CoreCommandWithCredentialsBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <b>private const string</b> <a id="0dbf31166098510e" href="../../R/0dbf31166098510e.html" target="n" data-glyph="10,1" class="i field">PathParameterSet</a> = <span class="s">&quot;Path&quot;</span>;
        <b>private const string</b> <a id="ac650ceb9773452e" href="../../R/ac650ceb9773452e.html" target="n" data-glyph="10,1" class="i field">LiteralPathParameterSet</a> = <span class="s">&quot;LiteralPath&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ParameterSetName</span> = <a href="#0dbf31166098510e" class="i field">PathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>true</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        <b>public string</b>[] <a id="5af386b380f47050" href="../../R/5af386b380f47050.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> =&gt; <a href="#8a277b7c815b29ba" class="i field">_paths</a>;
            <b>set</b> =&gt; <a href="#8a277b7c815b29ba" class="i field">_paths</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the literal path parameter to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">ParameterSetName</span> = <a href="#ac650ceb9773452e" class="i field">LiteralPathParameterSet</a>,
                   <span class="i">Mandatory</span> = <b>true</b>, <span class="i">ValueFromPipeline</span> = <b>false</b>, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b>[] <a id="0befc9b6d395ebcd" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b> =&gt; <a href="#8a277b7c815b29ba" class="i field">_paths</a>;
            <b>set</b>
            {
                <a href="#98633376814a5912" class="k">base</a>.<a href="#931307739450f618" class="i property">SuppressWildcardExpansion</a> = <b>true</b>;
                <a href="#8a277b7c815b29ba" class="i field">_paths</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the filter property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b> <a id="bbd5c7644bdcbb24" href="../../R/bbd5c7644bdcbb24.html" target="n" data-glyph="102,1" class="i property">Filter</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#044d90d664ea29d1" class="i property">Filter</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the include property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="af83615fc2b799c4" href="../../R/af83615fc2b799c4.html" target="n" data-glyph="102,1" class="i property">Include</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#953eaff5f53e6629" class="i property">Include</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the exclude property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public override string</b>[] <a id="6004f0c83c366576" href="../../R/6004f0c83c366576.html" target="n" data-glyph="102,1" class="i property">Exclude</a>
        {
            <b>get</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a>;
            <b>set</b> =&gt; <a href="#98633376814a5912" class="k">base</a>.<a href="#2121159277b72236" class="i property">Exclude</a> = <b>value</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the dynamic parameters for the invoke-item cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r224 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The context under which the command is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object representing the dynamic parameters for the cmdlet or null if there</span>
        <span class="c">///</span><span class="c"> are none.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override object</b> <a id="fb0a35b5bb578924" href="../../R/fb0a35b5bb578924.html" target="n" data-glyph="74,1" class="i method">GetDynamicParameters</a>(<span class="i">CmdletProviderContext</span> <span id="r224 rd" class="r224 r">context</span>)
        {
            <b>if</b> (<a href="#5af386b380f47050" class="i property">Path</a> != <b>null</b> &amp;&amp; <a href="#5af386b380f47050" class="i property">Path</a>.<span class="i">Length</span> &gt; 0)
            {
                <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">InvokeItemDynamicParameters</span>(<a href="#5af386b380f47050" class="i property">Path</a>[0], <span class="r224 r">context</span>);
            }
 
            <b>return</b> <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">InvokeItemDynamicParameters</span>(<span class="s">&quot;.&quot;</span>, <span class="r224 r">context</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the provider for the specified path supports ShouldProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="8c9e436759268384" href="../../R/8c9e436759268384.html" target="n" data-glyph="105,1" class="i property">ProviderSupportsShouldProcess</a> =&gt; <a href="#406a819cd9871eb1" class="i method">DoesProviderSupportShouldProcess</a>(<a href="#8a277b7c815b29ba" class="i field">_paths</a>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The path of the item to move. It is set or retrieved via</span>
        <span class="c">///</span><span class="c"> the Path property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="8a277b7c815b29ba" href="../../R/8a277b7c815b29ba.html" target="n" data-glyph="46,1" class="i field">_paths</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invokes the specified item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="971c01a5484511e8" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>foreach</b> (<b>string</b> <span id="r225 rd" class="r225 r">path</span> <b>in</b> <a href="#8a277b7c815b29ba" class="i field">_paths</a>)
            {
                <a href="#3b36b44a7a5db63e" class="i field">tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Invoking {0}&quot;</span>, <span class="r225 r">path</span>);
 
                <b>try</b>
                {
                    <span class="c">// Now invoke the action</span>
                    <span class="i">InvokeProvider</span>.<span class="i">Item</span>.<span class="i">Invoke</span>(<span class="r225 r">path</span>, <a href="#5ad1bfe4df30aef4" class="i property">CmdletProviderContext</a>);
                }
                <b>catch</b> (<span class="i">PSNotSupportedException</span> <span id="r226 rd" class="r226 r">notSupported</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r226 r">notSupported</span>.<span class="i">ErrorRecord</span>,
                            <span class="r226 r">notSupported</span>));
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">DriveNotFoundException</span> <span id="r227 rd" class="r227 r">driveNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r227 r">driveNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r227 r">driveNotFound</span>));
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r228 rd" class="r228 r">providerNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r228 r">providerNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r228 r">providerNotFound</span>));
                    <b>continue</b>;
                }
                <b>catch</b> (<span class="i">ItemNotFoundException</span> <span id="r229 rd" class="r229 r">pathNotFound</span>)
                {
                    <span class="i">WriteError</span>(
                        <b>new</b> <span class="i">ErrorRecord</span>(
                            <span class="r229 r">pathNotFound</span>.<span class="i">ErrorRecord</span>,
                            <span class="r229 r">pathNotFound</span>));
                    <b>continue</b>;
                }
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
 
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> InvokeItemCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Item commands
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Provider commands
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> GetProviderCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Gets a core command provider by name.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<span class="i">VerbsCommon</span>.<span class="i">Get</span>, <span class="s">&quot;PSProvider&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096816&quot;</span>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<span class="i">ProviderInfo</span>))]
    <b>public class</b> <a id="1943bb9d6f4a4b46" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="b7345bc6007d9526">GetPSProviderCommand</span></a> : <a href="#31745b2c942d5ae6" class="t t">CoreCommandBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the provider that will be removed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<span class="i">Position</span> = 0, <span class="i">ValueFromPipelineByPropertyName</span> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>()]
        <b>public string</b>[] <a id="57fdf43e6ba164db" href="../../R/57fdf43e6ba164db.html" target="n" data-glyph="102,1" class="i property">PSProvider</a>
        {
            <b>get</b> =&gt; <a href="#ce98fa761b6aa641" class="i field">_provider</a>;
            <b>set</b> =&gt; <a href="#ce98fa761b6aa641" class="i field">_provider</a> = <b>value</b> ?? <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command data
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The string ID of the provider to remove.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b>[] <a id="ce98fa761b6aa641" href="../../R/ce98fa761b6aa641.html" target="n" data-glyph="46,1" class="i field">_provider</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command data
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command code
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a provider from the core command namespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="574c6c7d25443905" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#57fdf43e6ba164db" class="i property">PSProvider</a> == <b>null</b> || <a href="#57fdf43e6ba164db" class="i property">PSProvider</a>.<span class="i">Length</span> == 0)
            {
                <span class="c">// Get all the providers</span>
 
                <span class="i">WriteObject</span>(<span class="i">SessionState</span>.<span class="i">Provider</span>.<span class="i">GetAll</span>(), <b>true</b>);
            }
            <b>else</b>
            {
                <b>foreach</b> (<b>string</b> <span id="r230 rd" class="r230 r">requestedProvider</span> <b>in</b> <a href="#57fdf43e6ba164db" class="i property">PSProvider</a>)
                {
                    <span class="i">PSSnapinQualifiedName</span> <span id="r231 rd" class="r231 r">pssnapinQualifiedProvider</span> = <span class="i">PSSnapinQualifiedName</span>.<span class="i">GetInstance</span>(<span class="r230 r">requestedProvider</span>);
 
                    <b>if</b> (<span class="r231 r">pssnapinQualifiedProvider</span> != <b>null</b> &amp;&amp; <span class="i">WildcardPattern</span>.<span class="i">ContainsWildcardCharacters</span>(<span class="r231 r">pssnapinQualifiedProvider</span>.<span class="i">ShortName</span>))
                    {
                        <span class="c">// The user entered a glob string so use the WildcardPattern to</span>
                        <span class="c">// compare the glob string to the provider names that exist</span>
                        <span class="c">// and write out any that match</span>
 
                        <span class="i">WildcardPattern</span> <span id="r232 rd" class="r232 r">matcher</span> =
                            <span class="i">WildcardPattern</span>.<span class="i">Get</span>(
                                <span class="r231 r">pssnapinQualifiedProvider</span>.<span class="i">ShortName</span>,
                                <span class="i">WildcardOptions</span>.<span class="i">IgnoreCase</span>);
 
                        <b>foreach</b> (<span class="i">ProviderInfo</span> <span id="r233 rd" class="r233 r">enumeratedProvider</span> <b>in</b> <span class="i">SessionState</span>.<span class="i">Provider</span>.<span class="i">GetAll</span>())
                        {
                            <span class="i">Dbg</span>.<span class="i">Diagnostics</span>.<span class="i">Assert</span>(
                                <span class="r233 r">enumeratedProvider</span> != <b>null</b>,
                                <span class="s">&quot;SessionState.Providers should return only ProviderInfo objects&quot;</span>);
 
                            <b>if</b> (<span class="r233 r">enumeratedProvider</span>.<span class="i">IsMatch</span>(<span class="r232 r">matcher</span>, <span class="r231 r">pssnapinQualifiedProvider</span>))
                            {
                                <span class="c">// A match was found</span>
 
                                <span class="i">WriteObject</span>(<span class="r233 r">enumeratedProvider</span>);
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <b>try</b>
                        {
                            <span class="i">Collection</span>&lt;<span class="i">ProviderInfo</span>&gt; <span id="r234 rd" class="r234 r">matchingProviders</span> =
                                <span class="i">SessionState</span>.<span class="i">Provider</span>.<span class="i">Get</span>(<span class="r230 r">requestedProvider</span>);
 
                            <span class="c">// The provider was found</span>
 
                            <span class="i">WriteObject</span>(<span class="r234 r">matchingProviders</span>, <b>true</b>);
                        }
                        <b>catch</b> (<span class="i">ProviderNotFoundException</span> <span id="r235 rd" class="r235 r">e</span>)
                        {
                            <span class="i">WriteError</span>(
                                <b>new</b> <span class="i">ErrorRecord</span>(
                                    <span class="r235 r">e</span>.<span class="i">ErrorRecord</span>,
                                    <span class="r235 r">e</span>));
                        }
                    }
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command code
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> GetProviderCommand
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Provider commands
}
</pre></td></tr></table></div></body></html>
