<!DOCTYPE html>
<html><head><title>CsvCommands.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(1831);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility/commands/utility/CsvCommands.cs" target="_top">commands\utility\CsvCommands.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility" target="_top">src\Microsoft.PowerShell.Commands.Utility\Microsoft.PowerShell.Commands.Utility.csproj</a> (Microsoft.PowerShell.Commands.Utility)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<span class="k preprocess">#</span><span class="k preprocess">pragma</span> <span class="k preprocess">warning</span> <span class="k preprocess">disable</span> 1634, 1691 <span class="c">// Stops compiler from warning about unknown warnings</span>
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> BaseCsvWritingCommand
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class implements the base for exportcsv and converttocsv commands.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="5dae970c61406dea" href="../../R/5dae970c61406dea.html" target="n" data-glyph="0,0" class="t t"><span id="ea933a69adecc2c9">BaseCsvWritingCommand</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Line Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property that sets delimiter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Delimiter&quot;</span>)]
        [<span class="i">ValidateNotNull</span>]
        <b>public char</b> <a id="3642997719d99218" href="../../R/3642997719d99218.html" target="n" data-glyph="102,1" class="i property">Delimiter</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">Culture switch for csv conversion</span>
        <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;UseCulture&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="b82e39569e4896bd" href="../../R/b82e39569e4896bd.html" target="n" data-glyph="102,1" class="i property">UseCulture</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Abstract Property - Input Object which is written in Csv format.</span>
        <span class="c">///</span><span class="c"> Derived as Different Attributes.In ConvertTo-CSV, This is a positional parameter. Export-CSV not a Positional behaviour.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="b8265244a4af46a2" href="../../R/b8265244a4af46a2.html" target="n" data-glyph="102,1" class="i property">InputObject</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IncludeTypeInformation : The #TYPE line should be generated. Default is false. Cannot specify with NoTypeInformation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;ITI&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="6f753712d32d4f6c" href="../../R/6f753712d32d4f6c.html" target="n" data-glyph="102,1" class="i property">IncludeTypeInformation</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> NoTypeInformation : The #TYPE line should not be generated. Default is true. Cannot specify with IncludeTypeInformation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#aece56bfac51ced8" class="i property">DontShow</a> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;NTI&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="a51ba6df63d953b7" href="../../R/a51ba6df63d953b7.html" target="n" data-glyph="102,1" class="i property">NoTypeInformation</a> { <b>get</b>; <b>set</b>; } = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets list of fields to quote in output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;QF&quot;</span>)]
        <b>public string</b>[] <a id="7b36160514830adb" href="../../R/7b36160514830adb.html" target="n" data-glyph="102,1" class="i property">QuoteFields</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets option to use or suppress quotes in output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;UQ&quot;</span>)]
        <b>public</b> <a href="#3e44bacdd60f45ac" class="t t">QuoteKind</a> <a id="b5cd60eddc5784e5" href="../../R/b5cd60eddc5784e5.html" target="n" data-glyph="102,1" class="i property">UseQuotes</a> { <b>get</b>; <b>set</b>; } = <a href="#3e44bacdd60f45ac" class="t t">QuoteKind</a>.<a href="#8e38fe69c2bdc526" class="i field">Always</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command Line Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Kind of output quoting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public enum</b> <a id="3e44bacdd60f45ac" href="../../R/3e44bacdd60f45ac.html" target="n" data-glyph="18,1" class="t t"><span id="a4a78d42c75c0d3f">QuoteKind</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Never quote output.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="20ce37e6636cac41" href="../../R/20ce37e6636cac41.html" target="n" data-glyph="24,2" class="i field">Never</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Always quote output.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="8e38fe69c2bdc526" href="../../R/8e38fe69c2bdc526.html" target="n" data-glyph="24,2" class="i field">Always</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Quote output as needed (a field contains used delimiter).</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="405c4029263722a0" href="../../R/405c4029263722a0.html" target="n" data-glyph="24,2" class="i field">AsNeeded</a>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write the string to a file or pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="119c9defac0177cf" href="../../R/119c9defac0177cf.html" target="n" data-glyph="72,1" class="i method">WriteCsvLine</a>(<b>string</b> <span id="r0 rd" class="r0 r">line</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> BeginProcessing override.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="776bb7f29aadac87" href="../../R/776bb7f29aadac87.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <b>if</b> (<a href="#5dae970c61406dea" class="k">this</a>.<a href="/System.Management.Automation/A.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="/System.Management.Automation/A.html#1927782a0117ff76" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<b>nameof</b>(<a href="#7b36160514830adb" class="i property">QuoteFields</a>)) &amp;&amp; <a href="#5dae970c61406dea" class="k">this</a>.<a href="/System.Management.Automation/A.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="/System.Management.Automation/A.html#1927782a0117ff76" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<b>nameof</b>(<a href="#b5cd60eddc5784e5" class="i property">UseQuotes</a>)))
            {
                <span class="i">InvalidOperationException</span> <span id="r1 rd" class="r1 r">exception</span> = <b>new</b>(<span class="i">CsvCommandStrings</span>.<span class="i">CannotSpecifyQuoteFieldsAndUseQuotes</span>);
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r2 rd" class="r2 r">errorRecord</span> = <b>new</b>(<span class="r1 r">exception</span>, <span class="s">&quot;CannotSpecifyQuoteFieldsAndUseQuotes&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#c855a7c43559f12f" class="i field">InvalidData</a>, <b>null</b>);
                <a href="#5dae970c61406dea" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="r2 r">errorRecord</span>);
            }
 
            <b>if</b> (<a href="#5dae970c61406dea" class="k">this</a>.<a href="/System.Management.Automation/A.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="/System.Management.Automation/A.html#1927782a0117ff76" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<b>nameof</b>(<a href="#6f753712d32d4f6c" class="i property">IncludeTypeInformation</a>)) &amp;&amp; <a href="#5dae970c61406dea" class="k">this</a>.<a href="/System.Management.Automation/A.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="/System.Management.Automation/A.html#1927782a0117ff76" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<b>nameof</b>(<a href="#a51ba6df63d953b7" class="i property">NoTypeInformation</a>)))
            {
                <span class="i">InvalidOperationException</span> <span id="r3 rd" class="r3 r">exception</span> = <b>new</b>(<span class="i">CsvCommandStrings</span>.<span class="i">CannotSpecifyIncludeTypeInformationAndNoTypeInformation</span>);
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r4 rd" class="r4 r">errorRecord</span> = <b>new</b>(<span class="r3 r">exception</span>, <span class="s">&quot;CannotSpecifyIncludeTypeInformationAndNoTypeInformation&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#c855a7c43559f12f" class="i field">InvalidData</a>, <b>null</b>);
                <a href="#5dae970c61406dea" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="r4 r">errorRecord</span>);
            }
 
            <b>if</b> (<a href="#5dae970c61406dea" class="k">this</a>.<a href="/System.Management.Automation/A.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="/System.Management.Automation/A.html#1927782a0117ff76" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<b>nameof</b>(<a href="#6f753712d32d4f6c" class="i property">IncludeTypeInformation</a>)))
            {
                <a href="#a51ba6df63d953b7" class="i property">NoTypeInformation</a> = !<a href="#6f753712d32d4f6c" class="i property">IncludeTypeInformation</a>;
            }
 
            <a href="#3642997719d99218" class="i property">Delimiter</a> = <a href="#05fe38acca3e7a22" class="t t">ImportExportCSVHelper</a>.<a href="#5756efbf6e169aeb" class="i method">SetDelimiter</a>(<a href="#5dae970c61406dea" class="k">this</a>, <a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>, <a href="#3642997719d99218" class="i property">Delimiter</a>, <a href="#b82e39569e4896bd" class="i property">UseCulture</a>);
        }
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Export-CSV Command
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implementation for the Export-Csv command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#ced47428947bccb7" class="t t">VerbsData</a>.<a href="/System.Management.Automation/A.html#b9aa6c12c628301b" class="i field">Export</a>, <span class="s">&quot;Csv&quot;</span>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;Delimiter&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096608&quot;</span>)]
    <b>public sealed class</b> <a id="62660063ab9b0221" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="b5d07fe0a58a8af7">ExportCsvCommand</span></a> : <a href="#5dae970c61406dea" class="t t">BaseCsvWritingCommand</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Line Parameters
 
        <span class="c">// If a Passthru parameter is added, the ShouldProcess</span>
        <span class="c">// implementation will need to be changed.</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Input Object for CSV Writing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        <b>public override</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="449c5577f7f85d75" href="../../R/449c5577f7f85d75.html" target="n" data-glyph="102,1" class="i property">InputObject</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Mandatory file name to write to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="958bf06d49aabf9c" href="../../R/958bf06d49aabf9c.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#fd7cf62075bf0c23" class="i field">_path</a>;
            }
 
            <b>set</b>
            {
                <a href="#fd7cf62075bf0c23" class="i field">_path</a> = <b>value</b>;
                <a href="#3508badf6398f711" class="i field">_specifiedPath</a> = <b>true</b>;
            }
        }
 
        <b>private string</b> <a id="fd7cf62075bf0c23" href="../../R/fd7cf62075bf0c23.html" target="n" data-glyph="46,1" class="i field">_path</a>;
        <b>private bool</b> <a id="3508badf6398f711" href="../../R/3508badf6398f711.html" target="n" data-glyph="46,1" class="i field">_specifiedPath</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The literal path of the mandatory file name to write to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b> <a id="1c400df52de31d21" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#fd7cf62075bf0c23" class="i field">_path</a>;
            }
 
            <b>set</b>
            {
                <a href="#fd7cf62075bf0c23" class="i field">_path</a> = <b>value</b>;
                <a href="#2ce1db8c47330517" class="i field">_isLiteralPath</a> = <b>true</b>;
            }
        }
 
        <b>private bool</b> <a id="2ce1db8c47330517" href="../../R/2ce1db8c47330517.html" target="n" data-glyph="46,1" class="i field">_isLiteralPath</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets property that sets force parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="23e79929d75c6077" href="../../R/23e79929d75c6077.html" target="n" data-glyph="102,1" class="i property">Force</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets property that prevents file overwrite.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;NoOverwrite&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="9ebf208d9ba5fad0" href="../../R/9ebf208d9ba5fad0.html" target="n" data-glyph="102,1" class="i property">NoClobber</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets encoding optional flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ArgumentToEncodingTransformationAttribute</span>]
        [<span class="i">ArgumentEncodingCompletionsAttribute</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Encoding</span> <a id="fb56a47d2cd7cad8" href="../../R/fb56a47d2cd7cad8.html" target="n" data-glyph="102,1" class="i property">Encoding</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#fc83f888abe24cbc" class="i field">_encoding</a>;
            }
 
            <b>set</b>
            {
                <span class="i">EncodingConversion</span>.<span class="i">WarnIfObsolete</span>(<a href="#62660063ab9b0221" class="k">this</a>, <b>value</b>);
                <a href="#fc83f888abe24cbc" class="i field">_encoding</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">Encoding</span> <a id="fc83f888abe24cbc" href="../../R/fc83f888abe24cbc.html" target="n" data-glyph="46,1" class="i field">_encoding</a> = <span class="i">ClrFacade</span>.<span class="i">GetDefaultEncoding</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets property that sets append parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="f45561ef46208295" href="../../R/f45561ef46208295.html" target="n" data-glyph="102,1" class="i property">Append</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">// true if Append=true AND the file written was not empty (or nonexistent) when the cmdlet was invoked</span>
        <b>private bool</b> <a id="8ca41dcaeb556242" href="../../R/8ca41dcaeb556242.html" target="n" data-glyph="46,1" class="i field">_isActuallyAppending</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <b>private bool</b> <a id="8427c6a2c9930957" href="../../R/8427c6a2c9930957.html" target="n" data-glyph="46,1" class="i field">_shouldProcess</a>;
        <b>private</b> <span class="i">IList</span>&lt;<b>string</b>&gt; <a id="3ae453c79984aec0" href="../../R/3ae453c79984aec0.html" target="n" data-glyph="46,1" class="i field">_propertyNames</a>;
        <b>private</b> <span class="i">IList</span>&lt;<b>string</b>&gt; <a id="58994fa8fee77519" href="../../R/58994fa8fee77519.html" target="n" data-glyph="46,1" class="i field">_preexistingPropertyNames</a>;
        <b>private</b> <a href="#19ccff9ab1640b37" class="t t">ExportCsvHelper</a> <a id="0ac896511f65f9f1" href="../../R/0ac896511f65f9f1.html" target="n" data-glyph="46,1" class="i field">_helper</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> BeginProcessing override.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="b5818f0634c02084" href="../../R/b5818f0634c02084.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="#5dae970c61406dea" class="k">base</a>.<a href="#776bb7f29aadac87" class="i method">BeginProcessing</a>();
 
            <span class="c">// Validate that they don&#39;t provide both Path and LiteralPath, but have provided at least one.</span>
            <b>if</b> (!(<a href="#3508badf6398f711" class="i field">_specifiedPath</a> ^ <a href="#2ce1db8c47330517" class="i field">_isLiteralPath</a>))
            {
                <span class="i">InvalidOperationException</span> <span id="r5 rd" class="r5 r">exception</span> = <b>new</b>(<span class="i">CsvCommandStrings</span>.<span class="i">CannotSpecifyPathAndLiteralPath</span>);
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r6 rd" class="r6 r">errorRecord</span> = <b>new</b>(<span class="r5 r">exception</span>, <span class="s">&quot;CannotSpecifyPathAndLiteralPath&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#c855a7c43559f12f" class="i field">InvalidData</a>, <b>null</b>);
                <a href="#62660063ab9b0221" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="r6 r">errorRecord</span>);
            }
 
            <a href="#8427c6a2c9930957" class="i field">_shouldProcess</a> = <span class="i">ShouldProcess</span>(<a href="#958bf06d49aabf9c" class="i property">Path</a>);
            <b>if</b> (!<a href="#8427c6a2c9930957" class="i field">_shouldProcess</a>)
            {
                <b>return</b>;
            }
 
            <a href="#370ade0c036fcf16" class="i method">CreateFileStream</a>();
 
            <a href="#0ac896511f65f9f1" class="i field">_helper</a> = <b>new</b> <a href="#d09f7d4bebf1ca1c" class="t constructor">ExportCsvHelper</a>(<a href="#5dae970c61406dea" class="k">base</a>.<a href="#3642997719d99218" class="i property">Delimiter</a>, <a href="#5dae970c61406dea" class="k">base</a>.<a href="#b5cd60eddc5784e5" class="i property">UseQuotes</a>, <a href="#5dae970c61406dea" class="k">base</a>.<a href="#7b36160514830adb" class="i property">QuoteFields</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert the current input object to Csv and write to file/WriteObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="4305ec7ec6e1ecb0" href="../../R/4305ec7ec6e1ecb0.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#449c5577f7f85d75" class="i property">InputObject</a> == <b>null</b> || <a href="#0c7fec5dfcffc7f8" class="i field">_sw</a> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (!<a href="#8427c6a2c9930957" class="i field">_shouldProcess</a>)
            {
                <b>return</b>;
            }
 
            <span class="c">// Process first object</span>
            <b>if</b> (<a href="#3ae453c79984aec0" class="i field">_propertyNames</a> == <b>null</b>)
            {
                <span class="c">// figure out the column names (and lock-in their order)</span>
                <a href="#3ae453c79984aec0" class="i field">_propertyNames</a> = <a href="#19ccff9ab1640b37" class="t t">ExportCsvHelper</a>.<a href="#9f488eb525649b65" class="i method">BuildPropertyNames</a>(<a href="#449c5577f7f85d75" class="i property">InputObject</a>, <a href="#3ae453c79984aec0" class="i field">_propertyNames</a>);
                <b>if</b> (<a href="#8ca41dcaeb556242" class="i field">_isActuallyAppending</a> &amp;&amp; <a href="#58994fa8fee77519" class="i field">_preexistingPropertyNames</a> != <b>null</b>)
                {
                    <a href="#62660063ab9b0221" class="k">this</a>.<a href="#c171b881f1ae4df4" class="i method">ReconcilePreexistingPropertyNames</a>();
                }
 
                <span class="c">// write headers (row1: typename + row2: column names)</span>
                <b>if</b> (!<a href="#8ca41dcaeb556242" class="i field">_isActuallyAppending</a>)
                {
                    <b>if</b> (<a href="#a51ba6df63d953b7" class="i property">NoTypeInformation</a> == <b>false</b>)
                    {
                        <a href="#8c2febefe96db544" class="i method">WriteCsvLine</a>(<a href="#19ccff9ab1640b37" class="t t">ExportCsvHelper</a>.<a href="#4b3865872848c855" class="i method">GetTypeString</a>(<a href="#449c5577f7f85d75" class="i property">InputObject</a>));
                    }
 
                    <a href="#8c2febefe96db544" class="i method">WriteCsvLine</a>(<a href="#0ac896511f65f9f1" class="i field">_helper</a>.<a href="#f56b2ec890d2b7e6" class="i method">ConvertPropertyNamesCSV</a>(<a href="#3ae453c79984aec0" class="i field">_propertyNames</a>));
                }
            }
 
            <b>string</b> <span id="r7 rd" class="r7 r">csv</span> = <a href="#0ac896511f65f9f1" class="i field">_helper</a>.<a href="#939c799e842c4659" class="i method">ConvertPSObjectToCSV</a>(<a href="#449c5577f7f85d75" class="i property">InputObject</a>, <a href="#3ae453c79984aec0" class="i field">_propertyNames</a>);
            <a href="#8c2febefe96db544" class="i method">WriteCsvLine</a>(<span class="r7 r">csv</span>);
            <a href="#0c7fec5dfcffc7f8" class="i field">_sw</a>.<span class="i">Flush</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> EndProcessing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="e4e4b3eb607d70bd" href="../../R/e4e4b3eb607d70bd.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <a href="#14212fa91fc781db" class="i method">CleanUp</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Overrides
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> file
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle to file stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">FileStream</span> <a id="c7c3432b4b9a8fe1" href="../../R/c7c3432b4b9a8fe1.html" target="n" data-glyph="46,1" class="i field">_fs</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stream writer used to write to file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">StreamWriter</span> <a id="0c7fec5dfcffc7f8" href="../../R/0c7fec5dfcffc7f8.html" target="n" data-glyph="46,1" class="i field">_sw</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle to file whose read-only attribute should be reset when we are done.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">FileInfo</span> <a id="1f14a4d6691446a3" href="../../R/1f14a4d6691446a3.html" target="n" data-glyph="46,1" class="i field">_readOnlyFileInfo</a> = <b>null</b>;
 
        <b>private void</b> <a id="370ade0c036fcf16" href="../../R/370ade0c036fcf16.html" target="n" data-glyph="76,1" class="i method">CreateFileStream</a>()
        {
            <b>if</b> (<a href="#fd7cf62075bf0c23" class="i field">_path</a> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">CsvCommandStrings</span>.<span class="i">FileNameIsAMandatoryParameter</span>);
            }
 
            <b>string</b> <span id="r8 rd" class="r8 r">resolvedFilePath</span> = <span class="i">PathUtils</span>.<span class="i">ResolveFilePath</span>(<a href="#62660063ab9b0221" class="k">this</a>.<a href="#958bf06d49aabf9c" class="i property">Path</a>, <a href="#62660063ab9b0221" class="k">this</a>, <a href="#2ce1db8c47330517" class="i field">_isLiteralPath</a>);
 
            <b>bool</b> <span id="r9 rd" class="r9 r">isCsvFileEmpty</span> = <b>true</b>;
 
            <b>if</b> (<a href="#62660063ab9b0221" class="k">this</a>.<a href="#f45561ef46208295" class="i property">Append</a> &amp;&amp; <span class="i">File</span>.<span class="i">Exists</span>(<span class="r8 r">resolvedFilePath</span>))
            {
                <b>using</b> (<span class="i">StreamReader</span> <span id="r10 rd" class="r10 r">streamReader</span> = <span class="i">PathUtils</span>.<span class="i">OpenStreamReader</span>(<a href="#62660063ab9b0221" class="k">this</a>, <a href="#62660063ab9b0221" class="k">this</a>.<a href="#958bf06d49aabf9c" class="i property">Path</a>, <a href="#fb56a47d2cd7cad8" class="i property">Encoding</a>, <a href="#2ce1db8c47330517" class="i field">_isLiteralPath</a>))
                {
                    <span class="r9 r">isCsvFileEmpty</span> = <span class="r10 r">streamReader</span>.<span class="i">Peek</span>() == -1;
                }
            }
 
            <span class="c">// If the csv file is empty then even append is treated as regular export (i.e., both header &amp; values are added to the CSV file).</span>
            <a href="#8ca41dcaeb556242" class="i field">_isActuallyAppending</a> = <a href="#62660063ab9b0221" class="k">this</a>.<a href="#f45561ef46208295" class="i property">Append</a> &amp;&amp; <span class="i">File</span>.<span class="i">Exists</span>(<span class="r8 r">resolvedFilePath</span>) &amp;&amp; !<span class="r9 r">isCsvFileEmpty</span>;
 
            <b>if</b> (<a href="#8ca41dcaeb556242" class="i field">_isActuallyAppending</a>)
            {
                <span class="i">Encoding</span> <span id="r11 rd" class="r11 r">encodingObject</span>;
 
                <b>using</b> (<span class="i">StreamReader</span> <span id="r12 rd" class="r12 r">streamReader</span> = <span class="i">PathUtils</span>.<span class="i">OpenStreamReader</span>(<a href="#62660063ab9b0221" class="k">this</a>, <a href="#62660063ab9b0221" class="k">this</a>.<a href="#958bf06d49aabf9c" class="i property">Path</a>, <a href="#fb56a47d2cd7cad8" class="i property">Encoding</a>, <a href="#2ce1db8c47330517" class="i field">_isLiteralPath</a>))
                {
                    <a href="#dc71e40708ad92d0" class="t t">ImportCsvHelper</a> <span id="r13 rd" class="r13 r">readingHelper</span> = <b>new</b>(
                        <a href="#62660063ab9b0221" class="k">this</a>, <a href="#62660063ab9b0221" class="k">this</a>.<a href="#3642997719d99218" class="i property">Delimiter</a>, <b>null</b> <span class="c">/* header */</span>, <b>null</b> <span class="c">/* typeName */</span>, <span class="r12 r">streamReader</span>);
                    <span class="r13 r">readingHelper</span>.<a href="#4d032d486c9700f7" class="i method">ReadHeader</a>();
                    <a href="#58994fa8fee77519" class="i field">_preexistingPropertyNames</a> = <span class="r13 r">readingHelper</span>.<a href="#398087147e85a043" class="i property">Header</a>;
 
                    <span class="r11 r">encodingObject</span> = <span class="r12 r">streamReader</span>.<span class="i">CurrentEncoding</span>;
                }
 
                <span class="i">PathUtils</span>.<span class="i">MasterStreamOpen</span>(
                    <a href="#62660063ab9b0221" class="k">this</a>,
                    <a href="#62660063ab9b0221" class="k">this</a>.<a href="#958bf06d49aabf9c" class="i property">Path</a>,
                    <span class="r11 r">encodingObject</span>,
                    <span class="i">defaultEncoding</span>: <b>false</b>,
                    <a href="#f45561ef46208295" class="i property">Append</a>,
                    <a href="#23e79929d75c6077" class="i property">Force</a>,
                    <a href="#9ebf208d9ba5fad0" class="i property">NoClobber</a>,
                    <b>out</b> <a href="#c7c3432b4b9a8fe1" class="i field">_fs</a>,
                    <b>out</b> <a href="#0c7fec5dfcffc7f8" class="i field">_sw</a>,
                    <b>out</b> <a href="#1f14a4d6691446a3" class="i field">_readOnlyFileInfo</a>,
                    <a href="#2ce1db8c47330517" class="i field">_isLiteralPath</a>);
            }
            <b>else</b>
            {
                <span class="i">PathUtils</span>.<span class="i">MasterStreamOpen</span>(
                    <a href="#62660063ab9b0221" class="k">this</a>,
                    <a href="#62660063ab9b0221" class="k">this</a>.<a href="#958bf06d49aabf9c" class="i property">Path</a>,
                    <a href="#fb56a47d2cd7cad8" class="i property">Encoding</a>,
                    <span class="i">defaultEncoding</span>: <b>false</b>,
                    <a href="#f45561ef46208295" class="i property">Append</a>,
                    <a href="#23e79929d75c6077" class="i property">Force</a>,
                    <a href="#9ebf208d9ba5fad0" class="i property">NoClobber</a>,
                    <b>out</b> <a href="#c7c3432b4b9a8fe1" class="i field">_fs</a>,
                    <b>out</b> <a href="#0c7fec5dfcffc7f8" class="i field">_sw</a>,
                    <b>out</b> <a href="#1f14a4d6691446a3" class="i field">_readOnlyFileInfo</a>,
                    <a href="#2ce1db8c47330517" class="i field">_isLiteralPath</a>);
            }
        }
 
        <b>private void</b> <a id="14212fa91fc781db" href="../../R/14212fa91fc781db.html" target="n" data-glyph="76,1" class="i method">CleanUp</a>()
        {
            <b>if</b> (<a href="#c7c3432b4b9a8fe1" class="i field">_fs</a> != <b>null</b>)
            {
                <b>if</b> (<a href="#0c7fec5dfcffc7f8" class="i field">_sw</a> != <b>null</b>)
                {
                    <a href="#0c7fec5dfcffc7f8" class="i field">_sw</a>.<span class="i">Flush</span>();
                    <a href="#0c7fec5dfcffc7f8" class="i field">_sw</a>.<span class="i">Dispose</span>();
                    <a href="#0c7fec5dfcffc7f8" class="i field">_sw</a> = <b>null</b>;
                }
 
                <a href="#c7c3432b4b9a8fe1" class="i field">_fs</a>.<span class="i">Dispose</span>();
                <a href="#c7c3432b4b9a8fe1" class="i field">_fs</a> = <b>null</b>;
 
                <span class="c">// reset the read-only attribute</span>
                <b>if</b> (<a href="#1f14a4d6691446a3" class="i field">_readOnlyFileInfo</a> != <b>null</b>)
                    <a href="#1f14a4d6691446a3" class="i field">_readOnlyFileInfo</a>.<span class="i">Attributes</span> |= <span class="i">FileAttributes</span>.<span class="i">ReadOnly</span>;
            }
 
            <b>if</b> (<a href="#0ac896511f65f9f1" class="i field">_helper</a> != <b>null</b>)
            {
                <a href="#0ac896511f65f9f1" class="i field">_helper</a>.<a href="#8834c4399d54f268" class="i method">Dispose</a>();
            }
        }
 
        <b>private void</b> <a id="c171b881f1ae4df4" href="../../R/c171b881f1ae4df4.html" target="n" data-glyph="76,1" class="i method">ReconcilePreexistingPropertyNames</a>()
        {
            <b>if</b> (!<a href="#8ca41dcaeb556242" class="i field">_isActuallyAppending</a>)
            {
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">CsvCommandStrings</span>.<span class="i">ReconcilePreexistingPropertyNamesMethodShouldOnlyGetCalledWhenAppending</span>);
            }
 
            <b>if</b> (<a href="#58994fa8fee77519" class="i field">_preexistingPropertyNames</a> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">CsvCommandStrings</span>.<span class="i">ReconcilePreexistingPropertyNamesMethodShouldOnlyGetCalledWhenPreexistingPropertyNamesHaveBeenReadSuccessfully</span>);
            }
 
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r14 rd" class="r14 r">appendedPropertyNames</span> = <b>new</b>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<b>string</b> <span id="r15 rd" class="r15 r">appendedPropertyName</span> <b>in</b> <a href="#3ae453c79984aec0" class="i field">_propertyNames</a>)
            {
                <span class="r14 r">appendedPropertyNames</span>.<span class="i">Add</span>(<span class="r15 r">appendedPropertyName</span>);
            }
 
            <b>foreach</b> (<b>string</b> <span id="r16 rd" class="r16 r">preexistingPropertyName</span> <b>in</b> <a href="#58994fa8fee77519" class="i field">_preexistingPropertyNames</a>)
            {
                <b>if</b> (!<span class="r14 r">appendedPropertyNames</span>.<span class="i">Contains</span>(<span class="r16 r">preexistingPropertyName</span>))
                {
                    <b>if</b> (!<a href="#23e79929d75c6077" class="i property">Force</a>)
                    {
                        <b>string</b> <span id="r17 rd" class="r17 r">errorMessage</span> = <b>string</b>.<span class="i">Format</span>(
                            <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="c">// property names and file names are culture invariant</span>
                            <span class="i">CsvCommandStrings</span>.<span class="i">CannotAppendCsvWithMismatchedPropertyNames</span>,
                            <span class="r16 r">preexistingPropertyName</span>,
                            <a href="#62660063ab9b0221" class="k">this</a>.<a href="#958bf06d49aabf9c" class="i property">Path</a>);
                        <span class="i">InvalidOperationException</span> <span id="r18 rd" class="r18 r">exception</span> = <b>new</b>(<span class="r17 r">errorMessage</span>);
                        <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r19 rd" class="r19 r">errorRecord</span> = <b>new</b>(<span class="r18 r">exception</span>, <span class="s">&quot;CannotAppendCsvWithMismatchedPropertyNames&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#c855a7c43559f12f" class="i field">InvalidData</a>, <span class="r16 r">preexistingPropertyName</span>);
                        <a href="#62660063ab9b0221" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="r19 r">errorRecord</span>);
                    }
                }
            }
 
            <a href="#3ae453c79984aec0" class="i field">_propertyNames</a> = <a href="#58994fa8fee77519" class="i field">_preexistingPropertyNames</a>;
            <a href="#58994fa8fee77519" class="i field">_preexistingPropertyNames</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write the csv line to file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Line to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="8c2febefe96db544" href="../../R/8c2febefe96db544.html" target="n" data-glyph="72,1" class="i method">WriteCsvLine</a>(<b>string</b> <span id="r20 rd" class="r20 r">line</span>)
        {
            <span class="c">// NTRAID#Windows Out Of Band Releases-915851-2005/09/13</span>
            <b>if</b> (<a href="#d96df54dd11609bf" class="i field">_disposed</a>)
            {
                <b>throw</b> <a href="/System.Management.Automation/A.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewObjectDisposedException</span>(<span class="s">&quot;ExportCsvCommand&quot;</span>);
            }
 
            <a href="#0c7fec5dfcffc7f8" class="i field">_sw</a>.<span class="i">WriteLine</span>(<span class="r20 r">line</span>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> file
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set to true when object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="d96df54dd11609bf" href="../../R/d96df54dd11609bf.html" target="n" data-glyph="46,1" class="i field">_disposed</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="41cda88dcc5689ff" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <b>if</b> (!<a href="#d96df54dd11609bf" class="i field">_disposed</a>)
            {
                <a href="#14212fa91fc781db" class="i method">CleanUp</a>();
            }
 
            <a href="#d96df54dd11609bf" class="i field">_disposed</a> = <b>true</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Members
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Export-CSV Command
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Import-CSV Command
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implements Import-Csv command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#ced47428947bccb7" class="t t">VerbsData</a>.<a href="/System.Management.Automation/A.html#7307de9a00fd0115" class="i field">Import</a>, <span class="s">&quot;Csv&quot;</span>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;DelimiterPath&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2097020&quot;</span>)]
    <b>public sealed class</b> <a id="e76cfa6247e0a1a2" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="16d0576383979297">ImportCsvCommand</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Line Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets property that sets delimiter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;DelimiterPath&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;DelimiterLiteralPath&quot;</span>)]
        [<span class="i">ValidateNotNull</span>]
        <b>public char</b> <a id="aba877319605806d" href="../../R/aba877319605806d.html" target="n" data-glyph="102,1" class="i property">Delimiter</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets mandatory file name to read from.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;DelimiterPath&quot;</span>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;CulturePath&quot;</span>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b>[] <a id="0aee8404559ac883" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#346495f0397e42e1" class="i field">_paths</a>;
            }
 
            <b>set</b>
            {
                <a href="#346495f0397e42e1" class="i field">_paths</a> = <b>value</b>;
                <a href="#73b248d5094343d6" class="i field">_specifiedPath</a> = <b>true</b>;
            }
        }
 
        <b>private string</b>[] <a id="346495f0397e42e1" href="../../R/346495f0397e42e1.html" target="n" data-glyph="46,1" class="i field">_paths</a>;
        <b>private bool</b> <a id="73b248d5094343d6" href="../../R/73b248d5094343d6.html" target="n" data-glyph="46,1" class="i field">_specifiedPath</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the literal path of the mandatory file name to read from.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;DelimiterLiteralPath&quot;</span>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;CultureLiteralPath&quot;</span>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="da9188e49f799ebb" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#346495f0397e42e1" class="i field">_paths</a>;
            }
 
            <b>set</b>
            {
                <a href="#346495f0397e42e1" class="i field">_paths</a> = <b>value</b>;
                <a href="#dbd55279125eccb2" class="i field">_isLiteralPath</a> = <b>true</b>;
            }
        }
 
        <b>private bool</b> <a id="dbd55279125eccb2" href="../../R/dbd55279125eccb2.html" target="n" data-glyph="46,1" class="i field">_isLiteralPath</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets property that sets UseCulture parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;CulturePath&quot;</span>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;CultureLiteralPath&quot;</span>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNull</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="45f00391cfef5514" href="../../R/45f00391cfef5514.html" target="n" data-glyph="102,1" class="i property">UseCulture</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets header property to customize the names.</span>
        <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>false</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="732882c278dee2db" href="../../R/732882c278dee2db.html" target="n" data-glyph="102,1" class="i property">Header</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets encoding optional flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ArgumentToEncodingTransformationAttribute</span>]
        [<span class="i">ArgumentEncodingCompletionsAttribute</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Encoding</span> <a id="c26d1ba5e62f0899" href="../../R/c26d1ba5e62f0899.html" target="n" data-glyph="102,1" class="i property">Encoding</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4adce819e598785c" class="i field">_encoding</a>;
            }
 
            <b>set</b>
            {
                <span class="i">EncodingConversion</span>.<span class="i">WarnIfObsolete</span>(<a href="#e76cfa6247e0a1a2" class="k">this</a>, <b>value</b>);
                <a href="#4adce819e598785c" class="i field">_encoding</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">Encoding</span> <a id="4adce819e598785c" href="../../R/4adce819e598785c.html" target="n" data-glyph="46,1" class="i field">_encoding</a> = <span class="i">ClrFacade</span>.<span class="i">GetDefaultEncoding</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Avoid writing out duplicate warning messages when there are one or more unspecified names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="79777c33e35d529e" href="../../R/79777c33e35d529e.html" target="n" data-glyph="46,1" class="i field">_alreadyWarnedUnspecifiedNames</a> = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command Line Parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Override Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> BeginProcessing override.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="69a656b1a80e6942" href="../../R/69a656b1a80e6942.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="#aba877319605806d" class="i property">Delimiter</a> = <a href="#05fe38acca3e7a22" class="t t">ImportExportCSVHelper</a>.<a href="#5756efbf6e169aeb" class="i method">SetDelimiter</a>(<a href="#e76cfa6247e0a1a2" class="k">this</a>, <a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>, <a href="#aba877319605806d" class="i property">Delimiter</a>, <a href="#45f00391cfef5514" class="i property">UseCulture</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProcessRecord overload.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="77f189970de1d8b1" href="../../R/77f189970de1d8b1.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="c">// Validate that they don&#39;t provide both Path and LiteralPath, but have provided at least one.</span>
            <b>if</b> (!(<a href="#73b248d5094343d6" class="i field">_specifiedPath</a> ^ <a href="#dbd55279125eccb2" class="i field">_isLiteralPath</a>))
            {
                <span class="i">InvalidOperationException</span> <span id="r21 rd" class="r21 r">exception</span> = <b>new</b>(<span class="i">CsvCommandStrings</span>.<span class="i">CannotSpecifyPathAndLiteralPath</span>);
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r22 rd" class="r22 r">errorRecord</span> = <b>new</b>(<span class="r21 r">exception</span>, <span class="s">&quot;CannotSpecifyPathAndLiteralPath&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#c855a7c43559f12f" class="i field">InvalidData</a>, <b>null</b>);
                <a href="#e76cfa6247e0a1a2" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="r22 r">errorRecord</span>);
            }
 
            <b>if</b> (<a href="#346495f0397e42e1" class="i field">_paths</a> != <b>null</b>)
            {
                <b>foreach</b> (<b>string</b> <span id="r23 rd" class="r23 r">path</span> <b>in</b> <a href="#346495f0397e42e1" class="i field">_paths</a>)
                {
                    <b>using</b> (<span class="i">StreamReader</span> <span id="r24 rd" class="r24 r">streamReader</span> = <span class="i">PathUtils</span>.<span class="i">OpenStreamReader</span>(<a href="#e76cfa6247e0a1a2" class="k">this</a>, <span class="r23 r">path</span>, <a href="#e76cfa6247e0a1a2" class="k">this</a>.<a href="#c26d1ba5e62f0899" class="i property">Encoding</a>, <a href="#dbd55279125eccb2" class="i field">_isLiteralPath</a>))
                    {
                        <a href="#dc71e40708ad92d0" class="t t">ImportCsvHelper</a> <span id="r25 rd" class="r25 r">helper</span> = <b>new</b>(<a href="#e76cfa6247e0a1a2" class="k">this</a>, <a href="#aba877319605806d" class="i property">Delimiter</a>, <a href="#732882c278dee2db" class="i property">Header</a>, <b>null</b> <span class="c">/* typeName */</span>, <span class="r24 r">streamReader</span>);
 
                        <b>try</b>
                        {
                            <span class="r25 r">helper</span>.<a href="#86028d894c14b282" class="i method">Import</a>(<b>ref</b> <a href="#79777c33e35d529e" class="i field">_alreadyWarnedUnspecifiedNames</a>);
                        }
                        <b>catch</b> (<a href="/System.Management.Automation/A.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a> <span id="r26 rd" class="r26 r">exception</span>)
                        {
                            <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r27 rd" class="r27 r">errorRecord</span> = <b>new</b>(<span class="r26 r">exception</span>, <span class="s">&quot;AlreadyPresentPSMemberInfoInternalCollectionAdd&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#707bbec7a1bb5ead" class="i field">NotSpecified</a>, <b>null</b>);
                            <a href="#e76cfa6247e0a1a2" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="r27 r">errorRecord</span>);
                        }
                    }
                }
            }
        }
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Override Methods
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Import-CSV Command
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> ConvertTo-CSV Command
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implements ConvertTo-Csv command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#ced47428947bccb7" class="t t">VerbsData</a>.<a href="/System.Management.Automation/A.html#2aa04ceb3568c2d5" class="i field">ConvertTo</a>, <span class="s">&quot;Csv&quot;</span>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;Delimiter&quot;</span>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096832&quot;</span>, <span class="i">RemotingCapability</span> = <a href="/System.Management.Automation/A.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="/System.Management.Automation/A.html#5111d4e307f1cb5a" class="i field">None</a>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<b>string</b>))]
    <b>public sealed class</b> <a id="a9a30c2540779720" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="5d4ec8382a09e58a">ConvertToCsvCommand</span></a> : <a href="#5dae970c61406dea" class="t t">BaseCsvWritingCommand</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameter
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Overrides Base InputObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        <b>public override</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="f13b5b509d7ec837" href="../../R/f13b5b509d7ec837.html" target="n" data-glyph="102,1" class="i property">InputObject</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Parameter
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stores Property Names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">IList</span>&lt;<b>string</b>&gt; <a id="2c28aaff1addd503" href="../../R/2c28aaff1addd503.html" target="n" data-glyph="46,1" class="i field">_propertyNames</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#19ccff9ab1640b37" class="t t">ExportCsvHelper</a> <a id="5918d36082c824a7" href="../../R/5918d36082c824a7.html" target="n" data-glyph="46,1" class="i field">_helper</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> BeginProcessing override.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="48302139913f6b1c" href="../../R/48302139913f6b1c.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="#5dae970c61406dea" class="k">base</a>.<a href="#776bb7f29aadac87" class="i method">BeginProcessing</a>();
            <a href="#5918d36082c824a7" class="i field">_helper</a> = <b>new</b> <a href="#d09f7d4bebf1ca1c" class="t constructor">ExportCsvHelper</a>(<a href="#5dae970c61406dea" class="k">base</a>.<a href="#3642997719d99218" class="i property">Delimiter</a>, <a href="#5dae970c61406dea" class="k">base</a>.<a href="#b5cd60eddc5784e5" class="i property">UseQuotes</a>, <a href="#5dae970c61406dea" class="k">base</a>.<a href="#7b36160514830adb" class="i property">QuoteFields</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert the current input object to Csv and write to stream/WriteObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="a3ed45bb28bca64c" href="../../R/a3ed45bb28bca64c.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#f13b5b509d7ec837" class="i property">InputObject</a> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <span class="c">// Process first object</span>
            <b>if</b> (<a href="#2c28aaff1addd503" class="i field">_propertyNames</a> == <b>null</b>)
            {
                <a href="#2c28aaff1addd503" class="i field">_propertyNames</a> = <a href="#19ccff9ab1640b37" class="t t">ExportCsvHelper</a>.<a href="#9f488eb525649b65" class="i method">BuildPropertyNames</a>(<a href="#f13b5b509d7ec837" class="i property">InputObject</a>, <a href="#2c28aaff1addd503" class="i field">_propertyNames</a>);
                <b>if</b> (<a href="#a51ba6df63d953b7" class="i property">NoTypeInformation</a> == <b>false</b>)
                {
                    <a href="#41e688f5dded61cd" class="i method">WriteCsvLine</a>(<a href="#19ccff9ab1640b37" class="t t">ExportCsvHelper</a>.<a href="#4b3865872848c855" class="i method">GetTypeString</a>(<a href="#f13b5b509d7ec837" class="i property">InputObject</a>));
                }
 
                <span class="c">// Write property information</span>
                <b>string</b> <span id="r28 rd" class="r28 r">properties</span> = <a href="#5918d36082c824a7" class="i field">_helper</a>.<a href="#f56b2ec890d2b7e6" class="i method">ConvertPropertyNamesCSV</a>(<a href="#2c28aaff1addd503" class="i field">_propertyNames</a>);
                <b>if</b> (!<span class="r28 r">properties</span>.<span class="i">Equals</span>(<b>string</b>.<span class="i">Empty</span>))
                {
                    <a href="#41e688f5dded61cd" class="i method">WriteCsvLine</a>(<span class="r28 r">properties</span>);
                }
            }
 
            <b>string</b> <span id="r29 rd" class="r29 r">csv</span> = <a href="#5918d36082c824a7" class="i field">_helper</a>.<a href="#939c799e842c4659" class="i method">ConvertPSObjectToCSV</a>(<a href="#f13b5b509d7ec837" class="i property">InputObject</a>, <a href="#2c28aaff1addd503" class="i field">_propertyNames</a>);
 
            <span class="c">// Write to the output stream</span>
            <b>if</b> (<span class="r29 r">csv</span> != <b>string</b>.<span class="i">Empty</span>)
            {
                <a href="#41e688f5dded61cd" class="i method">WriteCsvLine</a>(<span class="r29 r">csv</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Overrides
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> CSV conversion
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Write the line to output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Line to write.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="41e688f5dded61cd" href="../../R/41e688f5dded61cd.html" target="n" data-glyph="72,1" class="i method">WriteCsvLine</a>(<b>string</b> <span id="r30 rd" class="r30 r">line</span>)
        {
            <span class="i">WriteObject</span>(<span class="r30 r">line</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> CSV conversion
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ConvertTo-CSV Command
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> ConvertFrom-CSV Command
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implements ConvertFrom-Csv command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#ced47428947bccb7" class="t t">VerbsData</a>.<a href="/System.Management.Automation/A.html#37b438ebef33d0c8" class="i field">ConvertFrom</a>, <span class="s">&quot;Csv&quot;</span>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;Delimiter&quot;</span>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096830&quot;</span>, <span class="i">RemotingCapability</span> = <a href="/System.Management.Automation/A.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="/System.Management.Automation/A.html#5111d4e307f1cb5a" class="i field">None</a>)]
    <b>public sealed class</b> <a id="95937d13bde435a1" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="22d92e5431ef23a1">ConvertFromCsvCommand</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Line Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property that sets delimiter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Delimiter&quot;</span>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public char</b> <a id="14078cf1d106a59a" href="../../R/14078cf1d106a59a.html" target="n" data-glyph="102,1" class="i property">Delimiter</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">Culture switch for csv conversion</span>
        <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;UseCulture&quot;</span>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="1119c575feb22897" href="../../R/1119c575feb22897.html" target="n" data-glyph="102,1" class="i property">UseCulture</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets input object which is written in Csv format.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>[] <a id="998be58afb782656" href="../../R/998be58afb782656.html" target="n" data-glyph="102,1" class="i property">InputObject</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets header property to customize the names.</span>
        <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>false</b>)]
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="6c5d43fafc5ca1cc" href="../../R/6c5d43fafc5ca1cc.html" target="n" data-glyph="102,1" class="i property">Header</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Avoid writing out duplicate warning messages when there are one or more unspecified names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="6ce5528b58314571" href="../../R/6ce5528b58314571.html" target="n" data-glyph="46,1" class="i field">_alreadyWarnedUnspecifiedNames</a> = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command Line Parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> BeginProcessing override.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="c73dc4694ed99913" href="../../R/c73dc4694ed99913.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="#14078cf1d106a59a" class="i property">Delimiter</a> = <a href="#05fe38acca3e7a22" class="t t">ImportExportCSVHelper</a>.<a href="#5756efbf6e169aeb" class="i method">SetDelimiter</a>(<a href="#95937d13bde435a1" class="k">this</a>, <a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>, <a href="#14078cf1d106a59a" class="i property">Delimiter</a>, <a href="#1119c575feb22897" class="i property">UseCulture</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert the current input object to Csv and write to stream/WriteObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="da216fa34fe79d3c" href="../../R/da216fa34fe79d3c.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r31 rd" class="r31 r">inputObject</span> <b>in</b> <a href="#998be58afb782656" class="i property">InputObject</a>)
            {
                <b>using</b> (<span class="i">MemoryStream</span> <span id="r32 rd" class="r32 r">memoryStream</span> = <b>new</b>(<span class="i">Encoding</span>.<span class="i">Unicode</span>.<span class="i">GetBytes</span>(<span class="r31 r">inputObject</span>.<span class="i">ToString</span>())))
                <b>using</b> (<span class="i">StreamReader</span> <span id="r33 rd" class="r33 r">streamReader</span> = <b>new</b>(<span class="r32 r">memoryStream</span>, <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">Encoding</span>.<span class="i">Unicode</span>))
                {
                    <a href="#dc71e40708ad92d0" class="t t">ImportCsvHelper</a> <span id="r34 rd" class="r34 r">helper</span> = <b>new</b>(<a href="#95937d13bde435a1" class="k">this</a>, <a href="#14078cf1d106a59a" class="i property">Delimiter</a>, <a href="#6c5d43fafc5ca1cc" class="i property">Header</a>, <a href="#e3b632858f280d04" class="i field">_typeName</a>, <span class="r33 r">streamReader</span>);
 
                    <b>try</b>
                    {
                        <span class="r34 r">helper</span>.<a href="#86028d894c14b282" class="i method">Import</a>(<b>ref</b> <a href="#6ce5528b58314571" class="i field">_alreadyWarnedUnspecifiedNames</a>);
                    }
                    <b>catch</b> (<a href="/System.Management.Automation/A.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a> <span id="r35 rd" class="r35 r">exception</span>)
                    {
                        <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r36 rd" class="r36 r">errorRecord</span> = <b>new</b>(<span class="r35 r">exception</span>, <span class="s">&quot;AlreadyPresentPSMemberInfoInternalCollectionAdd&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#707bbec7a1bb5ead" class="i field">NotSpecified</a>, <b>null</b>);
                        <a href="#95937d13bde435a1" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="r36 r">errorRecord</span>);
                    }
 
                    <b>if</b> ((<a href="#6c5d43fafc5ca1cc" class="i property">Header</a> == <b>null</b>) &amp;&amp; (<span class="r34 r">helper</span>.<a href="#398087147e85a043" class="i property">Header</a> != <b>null</b>))
                    {
                        <a href="#6c5d43fafc5ca1cc" class="i property">Header</a> = <span class="r34 r">helper</span>.<a href="#398087147e85a043" class="i property">Header</a>.<span class="i">ToArray</span>();
                    }
 
                    <b>if</b> ((<a href="#e3b632858f280d04" class="i field">_typeName</a> == <b>null</b>) &amp;&amp; (<span class="r34 r">helper</span>.<a href="#3c8188cfb4f00bb3" class="i property">TypeName</a> != <b>null</b>))
                    {
                        <a href="#e3b632858f280d04" class="i field">_typeName</a> = <span class="r34 r">helper</span>.<a href="#3c8188cfb4f00bb3" class="i property">TypeName</a>;
                    }
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Overrides
 
        <b>private string</b> <a id="e3b632858f280d04" href="../../R/e3b632858f280d04.html" target="n" data-glyph="46,1" class="i field">_typeName</a>;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ConvertFrom-CSV Command
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CSV conversion
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> ExportHelperConversion
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Helper class for Export-Csv and ConvertTo-Csv.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="19ccff9ab1640b37" href="../../R/19ccff9ab1640b37.html" target="n" data-glyph="2,0" class="t t">ExportCsvHelper</a> : <span class="i">IDisposable</span>
    {
        <b>private readonly char</b> <a id="197e6d6469740f7b" href="../../R/197e6d6469740f7b.html" target="n" data-glyph="46,1" class="i field">_delimiter</a>;
        <b>private readonly</b> <a href="#5dae970c61406dea" class="t t">BaseCsvWritingCommand</a>.<a href="#3e44bacdd60f45ac" class="t t">QuoteKind</a> <a id="6f55bf0d9b6375e9" href="../../R/6f55bf0d9b6375e9.html" target="n" data-glyph="46,1" class="i field">_quoteKind</a>;
        <b>private readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="b03c1a78bd67114b" href="../../R/b03c1a78bd67114b.html" target="n" data-glyph="46,1" class="i field">_quoteFields</a>;
        <b>private readonly</b> <span class="i">StringBuilder</span> <a id="fcb0bcfee39e6ce5" href="../../R/fcb0bcfee39e6ce5.html" target="n" data-glyph="46,1" class="i field">_outputString</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#19ccff9ab1640b37" class="t t">ExportCsvHelper</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">delimiter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Delimiter char.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">quoteKind</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Kind of quoting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">quoteFields</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of fields to quote.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="d09f7d4bebf1ca1c" href="../../R/d09f7d4bebf1ca1c.html" target="n" data-glyph="74,1" class="t constructor">ExportCsvHelper</a>(<b>char</b> <span id="r37 rd" class="r37 r">delimiter</span>, <a href="#5dae970c61406dea" class="t t">BaseCsvWritingCommand</a>.<a href="#3e44bacdd60f45ac" class="t t">QuoteKind</a> <span id="r38 rd" class="r38 r">quoteKind</span>, <b>string</b>[] <span id="r39 rd" class="r39 r">quoteFields</span>)
        {
            <a href="#197e6d6469740f7b" class="i field">_delimiter</a> = <span class="r37 r">delimiter</span>;
            <a href="#6f55bf0d9b6375e9" class="i field">_quoteKind</a> = <span class="r38 r">quoteKind</span>;
            <a href="#b03c1a78bd67114b" class="i field">_quoteFields</a> = <span class="r39 r">quoteFields</span> == <b>null</b> ? <b>null</b> : <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="r39 r">quoteFields</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a> = <b>new</b> <span class="i">StringBuilder</span>(128);
        }
 
        <span class="c">// Name of properties to be written in CSV format</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the name of properties from source PSObject and add them to _propertyNames.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">IList</span>&lt;<b>string</b>&gt; <a id="9f488eb525649b65" href="../../R/9f488eb525649b65.html" target="n" data-glyph="74,1" class="i method">BuildPropertyNames</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r40 rd" class="r40 r">source</span>, <span class="i">IList</span>&lt;<b>string</b>&gt; <span id="r41 rd" class="r41 r">propertyNames</span>)
        {
            <b>if</b> (<span class="r41 r">propertyNames</span> != <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">CsvCommandStrings</span>.<span class="i">BuildPropertyNamesMethodShouldBeCalledOnlyOncePerCmdletInstance</span>);
            }
 
            <span class="r41 r">propertyNames</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
            <b>if</b> (<span class="r40 r">source</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <span class="i">IDictionary</span> <span id="r42 rd" class="r42 r">dictionary</span>)
            {
                <b>foreach</b> (<b>var</b> <span id="r43 rd" class="r43 r">key</span> <b>in</b> <span class="r42 r">dictionary</span>.<span class="i">Keys</span>)
                {
                    <span class="r41 r">propertyNames</span>.<span class="i">Add</span>(<a href="/System.Management.Automation/A.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>&lt;<b>string</b>&gt;(<span class="r43 r">key</span>));
                }
 
                <span class="c">// Add additional extended members added to the dictionary object, if any</span>
                <b>var</b> <span id="r44 rd" class="r44 r">propertiesToSearch</span> = <b>new</b> <span class="i">PSMemberInfoIntegratingCollection</span>&lt;<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;(
                    <span class="r40 r">source</span>,
                    <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">GetPropertyCollection</span>(<a href="/System.Management.Automation/A.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="/System.Management.Automation/A.html#9a5e7eb3c8a4bb72" class="i field">Extended</a>));
 
                <b>foreach</b> (<b>var</b> <span id="r45 rd" class="r45 r">prop</span> <b>in</b> <span class="r44 r">propertiesToSearch</span>)
                {
                    <span class="r41 r">propertyNames</span>.<span class="i">Add</span>(<span class="r45 r">prop</span>.<span class="i">Name</span>);
                }
            }
            <b>else</b>
            {
                <span class="c">// serialize only Extended and Adapted properties.</span>
                <a href="/System.Management.Automation/A.html#7dc9937a68c9af8c" class="t t">PSMemberInfoCollection</a>&lt;<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <span id="r46 rd" class="r46 r">srcPropertiesToSearch</span> =
                    <b>new</b> <span class="i">PSMemberInfoIntegratingCollection</span>&lt;<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt;(
                        <span class="r40 r">source</span>,
                        <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">GetPropertyCollection</span>(<a href="/System.Management.Automation/A.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="/System.Management.Automation/A.html#9a5e7eb3c8a4bb72" class="i field">Extended</a> | <a href="/System.Management.Automation/A.html#a6b111b024363c1f" class="t t">PSMemberViewTypes</a>.<a href="/System.Management.Automation/A.html#3c776c2dab2d739b" class="i field">Adapted</a>));
 
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r47 rd" class="r47 r">prop</span> <b>in</b> <span class="r46 r">srcPropertiesToSearch</span>)
                {
                    <span class="r41 r">propertyNames</span>.<span class="i">Add</span>(<span class="r47 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>);
                }
            }
 
            <b>return</b> <span class="r41 r">propertyNames</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts PropertyNames in to a CSV string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Converted string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="f56b2ec890d2b7e6" href="../../R/f56b2ec890d2b7e6.html" target="n" data-glyph="74,1" class="i method">ConvertPropertyNamesCSV</a>(<span class="i">IList</span>&lt;<b>string</b>&gt; <span id="r48 rd" class="r48 r">propertyNames</span>)
        {
            <b>if</b> (<span class="r48 r">propertyNames</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r48 r">propertyNames</span>));
            }
 
            <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>.<span class="i">Clear</span>();
            <b>bool</b> <span id="r49 rd" class="r49 r">first</span> = <b>true</b>;
 
            <b>foreach</b> (<b>string</b> <span id="r50 rd" class="r50 r">propertyName</span> <b>in</b> <span class="r48 r">propertyNames</span>)
            {
                <b>if</b> (<span class="r49 r">first</span>)
                {
                    <span class="r49 r">first</span> = <b>false</b>;
                }
                <b>else</b>
                {
                    <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>.<span class="i">Append</span>(<a href="#197e6d6469740f7b" class="i field">_delimiter</a>);
                }
 
                <b>if</b> (<a href="#b03c1a78bd67114b" class="i field">_quoteFields</a> != <b>null</b>)
                {
                    <b>if</b> (<a href="#b03c1a78bd67114b" class="i field">_quoteFields</a>.<span class="i">TryGetValue</span>(<span class="r50 r">propertyName</span>, <b>out _</b>))
                    {
                        <a href="#b006cc9cac560c7e" class="i method">AppendStringWithEscapeAlways</a>(<a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>, <span class="r50 r">propertyName</span>);
                    }
                    <b>else</b>
                    {
                        <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>.<span class="i">Append</span>(<span class="r50 r">propertyName</span>);
                    }
                }
                <b>else</b>
                {
                    <b>switch</b> (<a href="#6f55bf0d9b6375e9" class="i field">_quoteKind</a>)
                    {
                        <b>case</b> <a href="#5dae970c61406dea" class="t t">BaseCsvWritingCommand</a>.<a href="#3e44bacdd60f45ac" class="t t">QuoteKind</a>.<a href="#8e38fe69c2bdc526" class="i field">Always</a>:
                            <a href="#b006cc9cac560c7e" class="i method">AppendStringWithEscapeAlways</a>(<a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>, <span class="r50 r">propertyName</span>);
                            <b>break</b>;
                        <b>case</b> <a href="#5dae970c61406dea" class="t t">BaseCsvWritingCommand</a>.<a href="#3e44bacdd60f45ac" class="t t">QuoteKind</a>.<a href="#405c4029263722a0" class="i field">AsNeeded</a>:
                            
                            <b>if</b> (<span class="r50 r">propertyName</span>.<span class="i">AsSpan</span>().<span class="i">IndexOfAny</span>(<a href="#197e6d6469740f7b" class="i field">_delimiter</a>, <span class="s">&#39;\n&#39;</span>, <span class="s">&#39;&quot;&#39;</span>) != -1)
                            {
                                <a href="#b006cc9cac560c7e" class="i method">AppendStringWithEscapeAlways</a>(<a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>, <span class="r50 r">propertyName</span>);
                            }
                            <b>else</b>
                            {
                                <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>.<span class="i">Append</span>(<span class="r50 r">propertyName</span>);
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="#5dae970c61406dea" class="t t">BaseCsvWritingCommand</a>.<a href="#3e44bacdd60f45ac" class="t t">QuoteKind</a>.<a href="#20ce37e6636cac41" class="i field">Never</a>:
                            <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>.<span class="i">Append</span>(<span class="r50 r">propertyName</span>);
                            <b>break</b>;
                    }
                }
            }
 
            <b>return</b> <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Convert PSObject to CSV string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">mshObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSObject to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">propertyNames</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Property names.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="939c799e842c4659" href="../../R/939c799e842c4659.html" target="n" data-glyph="74,1" class="i method">ConvertPSObjectToCSV</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r51 rd" class="r51 r">mshObject</span>, <span class="i">IList</span>&lt;<b>string</b>&gt; <span id="r52 rd" class="r52 r">propertyNames</span>)
        {
            <b>if</b> (<span class="r52 r">propertyNames</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r52 r">propertyNames</span>));
            }
 
            <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>.<span class="i">Clear</span>();
            <b>bool</b> <span id="r53 rd" class="r53 r">first</span> = <b>true</b>;
 
            <b>foreach</b> (<b>string</b> <span id="r54 rd" class="r54 r">propertyName</span> <b>in</b> <span class="r52 r">propertyNames</span>)
            {
                <b>if</b> (<span class="r53 r">first</span>)
                {
                    <span class="r53 r">first</span> = <b>false</b>;
                }
                <b>else</b>
                {
                    <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>.<span class="i">Append</span>(<a href="#197e6d6469740f7b" class="i field">_delimiter</a>);
                }
 
                <b>string</b> <span id="r55 rd" class="r55 r">value</span> = <b>null</b>;
                <b>if</b> (<span class="r51 r">mshObject</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <span class="i">IDictionary</span> <span id="r56 rd" class="r56 r">dictionary</span>)
                {
                    <b>if</b> (<span class="r56 r">dictionary</span>.<span class="i">Contains</span>(<span class="r54 r">propertyName</span>))
                    {
                        <span class="r55 r">value</span> = <span class="r56 r">dictionary</span>[<span class="r54 r">propertyName</span>].<span class="i">ToString</span>();
                    }
                    <b>else</b> <b>if</b> (<span class="r51 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r54 r">propertyName</span>] <b>is</b> <a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r57 rd" class="r57 r">property</span>)
                    {
                        <span class="r55 r">value</span> = <a href="#2d8cb8bc97cdb3b2" class="i method">GetToStringValueForProperty</a>(<span class="r57 r">property</span>);
                    }
                }
                <b>else</b> <b>if</b> (<span class="r51 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r54 r">propertyName</span>] <b>is</b> <a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r58 rd" class="r58 r">property</span>)
                {
                    <span class="r55 r">value</span> = <a href="#2d8cb8bc97cdb3b2" class="i method">GetToStringValueForProperty</a>(<span class="r58 r">property</span>);
                }
 
                <span class="c">// If value is null, assume property is not present and skip it.</span>
                <b>if</b> (<span class="r55 r">value</span> != <b>null</b>)
                {
                    <b>if</b> (<a href="#b03c1a78bd67114b" class="i field">_quoteFields</a> != <b>null</b>)
                    {
                        <b>if</b> (<a href="#b03c1a78bd67114b" class="i field">_quoteFields</a>.<span class="i">TryGetValue</span>(<span class="r54 r">propertyName</span>, <b>out _</b>))
                        {
                            <a href="#b006cc9cac560c7e" class="i method">AppendStringWithEscapeAlways</a>(<a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>, <span class="r55 r">value</span>);
                        }
                        <b>else</b>
                        {
                            <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>.<span class="i">Append</span>(<span class="r55 r">value</span>);
                        }
                    }
                    <b>else</b>
                    {
                        <b>switch</b> (<a href="#6f55bf0d9b6375e9" class="i field">_quoteKind</a>)
                        {
                            <b>case</b> <a href="#5dae970c61406dea" class="t t">BaseCsvWritingCommand</a>.<a href="#3e44bacdd60f45ac" class="t t">QuoteKind</a>.<a href="#8e38fe69c2bdc526" class="i field">Always</a>:
                                <a href="#b006cc9cac560c7e" class="i method">AppendStringWithEscapeAlways</a>(<a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>, <span class="r55 r">value</span>);
                                <b>break</b>;
                            <b>case</b> <a href="#5dae970c61406dea" class="t t">BaseCsvWritingCommand</a>.<a href="#3e44bacdd60f45ac" class="t t">QuoteKind</a>.<a href="#405c4029263722a0" class="i field">AsNeeded</a>:
                                <b>if</b> (<span class="r55 r">value</span> != <b>null</b> &amp;&amp; <span class="r55 r">value</span>.<span class="i">AsSpan</span>().<span class="i">IndexOfAny</span>(<a href="#197e6d6469740f7b" class="i field">_delimiter</a>, <span class="s">&#39;\n&#39;</span>, <span class="s">&#39;&quot;&#39;</span>) != -1)
                                {
                                    <a href="#b006cc9cac560c7e" class="i method">AppendStringWithEscapeAlways</a>(<a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>, <span class="r55 r">value</span>);
                                }
                                <b>else</b>
                                {
                                    <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>.<span class="i">Append</span>(<span class="r55 r">value</span>);
                                }
 
                                <b>break</b>;
                            <b>case</b> <a href="#5dae970c61406dea" class="t t">BaseCsvWritingCommand</a>.<a href="#3e44bacdd60f45ac" class="t t">QuoteKind</a>.<a href="#20ce37e6636cac41" class="i field">Never</a>:
                                <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>.<span class="i">Append</span>(<span class="r55 r">value</span>);
                                <b>break</b>;
                            <b>default</b>:
                                <span class="i">Diagnostics</span>.<span class="i">Assert</span>(<b>false</b>, <span class="s">&quot;BaseCsvWritingCommand.QuoteKind has new item.&quot;</span>);
                                <b>break</b>;
                        }
                    }
                }
            }
 
            <b>return</b> <a href="#fcb0bcfee39e6ce5" class="i field">_outputString</a>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get value from property object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">property</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c"> Property to convert.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">ToString() value.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="2d8cb8bc97cdb3b2" href="../../R/2d8cb8bc97cdb3b2.html" target="n" data-glyph="74,1" class="i method">GetToStringValueForProperty</a>(<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r59 rd" class="r59 r">property</span>)
        {
            <b>if</b> (<span class="r59 r">property</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r59 r">property</span>));
            }
 
            <b>string</b> <span id="r60 rd" class="r60 r">value</span> = <b>null</b>;
            <b>try</b>
            {
                <b>object</b> <span id="r61 rd" class="r61 r">temp</span> = <span class="r59 r">property</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>;
                <b>if</b> (<span class="r61 r">temp</span> != <b>null</b>)
                {
                    <span class="r60 r">value</span> = <span class="r61 r">temp</span>.<span class="i">ToString</span>();
                }
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <span class="c">// If we cannot read some value, treat it as null.</span>
            }
 
            <b>return</b> <span class="r60 r">value</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Prepares string for writing type information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">source</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSObject whose type to determine.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">String with type information.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="4b3865872848c855" href="../../R/4b3865872848c855.html" target="n" data-glyph="74,1" class="i method">GetTypeString</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r62 rd" class="r62 r">source</span>)
        {
            <b>string</b> <span id="r63 rd" class="r63 r">type</span> = <b>null</b>;
 
            <span class="c">// get type of source</span>
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r64 rd" class="r64 r">tnh</span> = <span class="r62 r">source</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>;
            <b>if</b> (<span class="r64 r">tnh</span> == <b>null</b> || <span class="r64 r">tnh</span>.<span class="i">Count</span> == 0)
            {
                <span class="r63 r">type</span> = <span class="s">&quot;#TYPE&quot;</span>;
            }
            <b>else</b>
            {
                <b>if</b> (<span class="r64 r">tnh</span>[0] == <b>null</b>)
                {
                    <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">CsvCommandStrings</span>.<span class="i">TypeHierarchyShouldNotHaveNullValues</span>);
                }
 
                <b>string</b> <span id="r65 rd" class="r65 r">temp</span> = <span class="r64 r">tnh</span>[0];
 
                <span class="c">// If type starts with CSV: remove it. This would happen when you export</span>
                <span class="c">// an imported object. import-csv adds CSV. prefix to the type.</span>
                <b>if</b> (<span class="r65 r">temp</span>.<span class="i">StartsWith</span>(<a href="#05fe38acca3e7a22" class="t t">ImportExportCSVHelper</a>.<a href="#73322ecd3319aee1" class="i field">CSVTypePrefix</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r65 r">temp</span> = <span class="r65 r">temp</span>.<span class="i">Substring</span>(4);
                }
 
                <span class="r63 r">type</span> = <b>string</b>.<span class="i">Format</span>(<span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;#TYPE {0}&quot;</span>, <span class="r65 r">temp</span>);
            }
 
            <b>return</b> <span class="r63 r">type</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Escapes the &quot; in string if necessary.</span>
        <span class="c">///</span><span class="c"> Encloses the string in double quotes if necessary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="b006cc9cac560c7e" href="../../R/b006cc9cac560c7e.html" target="n" data-glyph="74,1" class="i method">AppendStringWithEscapeAlways</a>(<span class="i">StringBuilder</span> <span id="r66 rd" class="r66 r">dest</span>, <b>string</b> <span id="r67 rd" class="r67 r">source</span>)
        {
            <b>if</b> (<span class="r67 r">source</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <span class="c">// Adding Double quote to all strings</span>
            <span class="r66 r">dest</span>.<span class="i">Append</span>(<span class="s">&#39;&quot;&#39;</span>);
            <b>for</b> (<b>int</b> <span id="r68 rd" class="r68 r">i</span> = 0; <span class="r68 r">i</span> &lt; <span class="r67 r">source</span>.<span class="i">Length</span>; <span class="r68 r">i</span>++)
            {
                <b>char</b> <span id="r69 rd" class="r69 r">c</span> = <span class="r67 r">source</span>[<span class="r68 r">i</span>];
 
                <span class="c">// Double quote in the string is escaped with double quote</span>
                <b>if</b> (<span class="r69 r">c</span> == <span class="s">&#39;&quot;&#39;</span>)
                {
                    <span class="r66 r">dest</span>.<span class="i">Append</span>(<span class="s">&#39;&quot;&#39;</span>);
                }
 
                <span class="r66 r">dest</span>.<span class="i">Append</span>(<span class="r69 r">c</span>);
            }
 
            <span class="r66 r">dest</span>.<span class="i">Append</span>(<span class="s">&#39;&quot;&#39;</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set to true when object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="069d3d1d5cb03748" href="../../R/069d3d1d5cb03748.html" target="n" data-glyph="46,1" class="i field">_disposed</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="8834c4399d54f268" href="../../R/8834c4399d54f268.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <b>if</b> (!<a href="#069d3d1d5cb03748" class="i field">_disposed</a>)
            {
                <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#19ccff9ab1640b37" class="k">this</a>);
            }
 
            <a href="#069d3d1d5cb03748" class="i field">_disposed</a> = <b>true</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Members
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ExportHelperConversion
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> ImportHelperConversion
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Helper class to import single CSV file.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="dc71e40708ad92d0" href="../../R/dc71e40708ad92d0.html" target="n" data-glyph="2,0" class="t t">ImportCsvHelper</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reference to cmdlet which is using this helper class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <a id="9bf3930f3a011971" href="../../R/9bf3930f3a011971.html" target="n" data-glyph="46,1" class="i field">_cmdlet</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CSV delimiter (default is the &quot;comma&quot; / &quot;,&quot; character).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly char</b> <a id="72d53cbd071583dc" href="../../R/72d53cbd071583dc.html" target="n" data-glyph="46,1" class="i field">_delimiter</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use &quot;UnspecifiedName&quot; when the name is null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="bcbaf69c1683f590" href="../../R/bcbaf69c1683f590.html" target="n" data-glyph="10,1" class="i field">UnspecifiedName</a> = <span class="s">&quot;H&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Avoid writing out duplicate warning messages when there are one or more unspecified names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="6272cfffc40832bc" href="../../R/6272cfffc40832bc.html" target="n" data-glyph="46,1" class="i field">_alreadyWarnedUnspecifiedName</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets reference to header values.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IList</span>&lt;<b>string</b>&gt; <a id="398087147e85a043" href="../../R/398087147e85a043.html" target="n" data-glyph="104,1" class="i property">Header</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets ETS type name from the first line / comment in the CSV.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="3c8188cfb4f00bb3" href="../../R/3c8188cfb4f00bb3.html" target="n" data-glyph="104,1" class="i property">TypeName</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reader of the csv content.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">StreamReader</span> <a id="318b3a3f1f72088f" href="../../R/318b3a3f1f72088f.html" target="n" data-glyph="46,1" class="i field">_sr</a>;
 
        <span class="c">// Initial sizes of the value list and the line stringbuilder.</span>
        <span class="c">// Set to reasonable initial sizes. They may grow beyond these,</span>
        <span class="c">// but this will prevent a few reallocations.</span>
        <b>private const int</b> <a id="46bc64f1dfce09b1" href="../../R/46bc64f1dfce09b1.html" target="n" data-glyph="10,1" class="i field">ValueCountGuestimate</a> = 16;
        <b>private const int</b> <a id="221484fceec18347" href="../../R/221484fceec18347.html" target="n" data-glyph="10,1" class="i field">LineLengthGuestimate</a> = 256;
 
        <b>internal</b> <a id="00afd8eb4eac2bb0" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ImportCsvHelper</a>(<a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r70 rd" class="r70 r">cmdlet</span>, <b>char</b> <span id="r71 rd" class="r71 r">delimiter</span>, <span class="i">IList</span>&lt;<b>string</b>&gt; <span id="r72 rd" class="r72 r">header</span>, <b>string</b> <span id="r73 rd" class="r73 r">typeName</span>, <span class="i">StreamReader</span> <span id="r74 rd" class="r74 r">streamReader</span>)
        {
            <b>if</b> (<span class="r70 r">cmdlet</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r70 r">cmdlet</span>));
            }
 
            <b>if</b> (<span class="r74 r">streamReader</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r74 r">streamReader</span>));
            }
 
            <a href="#9bf3930f3a011971" class="i field">_cmdlet</a> = <span class="r70 r">cmdlet</span>;
            <a href="#72d53cbd071583dc" class="i field">_delimiter</a> = <span class="r71 r">delimiter</span>;
            <a href="#398087147e85a043" class="i property">Header</a> = <span class="r72 r">header</span>;
            <a href="#3c8188cfb4f00bb3" class="i property">TypeName</a> = <span class="r73 r">typeName</span>;
            <a href="#318b3a3f1f72088f" class="i field">_sr</a> = <span class="r74 r">streamReader</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> reading helpers
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is set to true when end of file is reached.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="5a576e5916ada9ff" href="../../R/5a576e5916ada9ff.html" target="n" data-glyph="106,1" class="i property">EOF</a> =&gt; <a href="#318b3a3f1f72088f" class="i field">_sr</a>.<span class="i">EndOfStream</span>;
 
        <b>private char</b> <a id="a72ec3889ac028e3" href="../../R/a72ec3889ac028e3.html" target="n" data-glyph="76,1" class="i method">ReadChar</a>()
        {
            <b>if</b> (<a href="#5a576e5916ada9ff" class="i property">EOF</a>)
            {
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="i">CsvCommandStrings</span>.<span class="i">EOFIsReached</span>);
            }
 
            <b>int</b> <span id="r75 rd" class="r75 r">i</span> = <a href="#318b3a3f1f72088f" class="i field">_sr</a>.<span class="i">Read</span>();
            <b>return</b> (<b>char</b>)<span class="r75 r">i</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Peeks the next character in the stream and returns true if it is same as passed in character.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">c</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="a6d4dae48e8c4094" href="../../R/a6d4dae48e8c4094.html" target="n" data-glyph="76,1" class="i method">PeekNextChar</a>(<b>char</b> <span id="r76 rd" class="r76 r">c</span>)
        {
            <b>int</b> <span id="r77 rd" class="r77 r">i</span> = <a href="#318b3a3f1f72088f" class="i field">_sr</a>.<span class="i">Peek</span>();
            <b>if</b> (<span class="r77 r">i</span> == -1)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <span class="r76 r">c</span> == (<b>char</b>)<span class="r77 r">i</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads a line from file. This consumes the end of line.</span>
        <span class="c">///</span><span class="c"> Only use it when end of line chars are not important.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Line from file.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="551a45d413e70ce9" href="../../R/551a45d413e70ce9.html" target="n" data-glyph="76,1" class="i method">ReadLine</a>() =&gt; <a href="#318b3a3f1f72088f" class="i field">_sr</a>.<span class="i">ReadLine</span>();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> reading helpers
 
        <b>internal void</b> <a id="4d032d486c9700f7" href="../../R/4d032d486c9700f7.html" target="n" data-glyph="74,1" class="i method">ReadHeader</a>()
        {
            <span class="c">// Read #Type record if available</span>
            <b>if</b> ((<a href="#3c8188cfb4f00bb3" class="i property">TypeName</a> == <b>null</b>) &amp;&amp; (!<a href="#dc71e40708ad92d0" class="k">this</a>.<a href="#5a576e5916ada9ff" class="i property">EOF</a>))
            {
                <a href="#3c8188cfb4f00bb3" class="i property">TypeName</a> = <a href="#0a42862f914864ee" class="i method">ReadTypeInformation</a>();
            }
 
            <b>var</b> <span id="r78 rd" class="r78 r">values</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(<a href="#46bc64f1dfce09b1" class="i field">ValueCountGuestimate</a>);
            <b>var</b> <span id="r79 rd" class="r79 r">builder</span> = <b>new</b> <span class="i">StringBuilder</span>(<a href="#221484fceec18347" class="i field">LineLengthGuestimate</a>);
            <b>while</b> ((<a href="#398087147e85a043" class="i property">Header</a> == <b>null</b>) &amp;&amp; (!<a href="#dc71e40708ad92d0" class="k">this</a>.<a href="#5a576e5916ada9ff" class="i property">EOF</a>))
            {
                <a href="#bbef0eaebdc568dd" class="i method">ParseNextRecord</a>(<span class="r78 r">values</span>, <span class="r79 r">builder</span>);
 
                <span class="c">// Trim all trailing blankspaces and delimiters ( single/multiple ).</span>
                <span class="c">// If there is only one element in the row and if its a blankspace we dont trim it.</span>
                <span class="c">// A trailing delimiter is represented as a blankspace while being added to result collection</span>
                <span class="c">// which is getting trimmed along with blankspaces supplied through the CSV in the below loop.</span>
                <b>while</b> (<span class="r78 r">values</span>.<span class="i">Count</span> &gt; 1 &amp;&amp; <span class="r78 r">values</span>[<span class="r78 r">values</span>.<span class="i">Count</span> - 1].<span class="i">Equals</span>(<b>string</b>.<span class="i">Empty</span>))
                {
                    <span class="r78 r">values</span>.<span class="i">RemoveAt</span>(<span class="r78 r">values</span>.<span class="i">Count</span> - 1);
                }
 
                <span class="c">// File starts with &#39;#&#39; and contains &#39;#Fields:&#39; is W3C Extended Log File Format</span>
                <b>if</b> (<span class="r78 r">values</span>.<span class="i">Count</span> != 0 &amp;&amp; <span class="r78 r">values</span>[0].<span class="i">StartsWith</span>(<span class="s">&quot;#Fields: &quot;</span>))
                {
                    <span class="r78 r">values</span>[0] = <span class="r78 r">values</span>[0].<span class="i">Substring</span>(9);
                    <a href="#398087147e85a043" class="i property">Header</a> = <span class="r78 r">values</span>;
                }
                <b>else</b> <b>if</b> (<span class="r78 r">values</span>.<span class="i">Count</span> != 0 &amp;&amp; <span class="r78 r">values</span>[0].<span class="i">StartsWith</span>(<span class="s">&#39;#&#39;</span>))
                {
                    <span class="c">// Skip all lines starting with &#39;#&#39;</span>
                }
                <b>else</b>
                {
                    <span class="c">// This is not W3C Extended Log File Format</span>
                    <span class="c">// By default first line is Header</span>
                    <a href="#398087147e85a043" class="i property">Header</a> = <span class="r78 r">values</span>;
                }
            }
 
            <b>if</b> (<a href="#398087147e85a043" class="i property">Header</a> != <b>null</b> &amp;&amp; <a href="#398087147e85a043" class="i property">Header</a>.<span class="i">Count</span> &gt; 0)
            {
                <a href="#da4383715df288c0" class="i method">ValidatePropertyNames</a>(<a href="#398087147e85a043" class="i property">Header</a>);
            }
        }
 
        <b>internal void</b> <a id="86028d894c14b282" href="../../R/86028d894c14b282.html" target="n" data-glyph="74,1" class="i method">Import</a>(<b>ref bool</b> <span id="r80 rd" class="r80 r">alreadyWriteOutWarning</span>)
        {
            <a href="#6272cfffc40832bc" class="i field">_alreadyWarnedUnspecifiedName</a> = <span class="r80 r">alreadyWriteOutWarning</span>;
            <a href="#4d032d486c9700f7" class="i method">ReadHeader</a>();
            <b>var</b> <span id="r81 rd" class="r81 r">prevalidated</span> = <b>false</b>;
            <b>var</b> <span id="r82 rd" class="r82 r">values</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(<a href="#46bc64f1dfce09b1" class="i field">ValueCountGuestimate</a>);
            <b>var</b> <span id="r83 rd" class="r83 r">builder</span> = <b>new</b> <span class="i">StringBuilder</span>(<a href="#221484fceec18347" class="i field">LineLengthGuestimate</a>);
            <b>while</b> (<b>true</b>)
            {
                <a href="#bbef0eaebdc568dd" class="i method">ParseNextRecord</a>(<span class="r82 r">values</span>, <span class="r83 r">builder</span>);
                <b>if</b> (<span class="r82 r">values</span>.<span class="i">Count</span> == 0)
                    <b>break</b>;
 
                <b>if</b> (<span class="r82 r">values</span>.<span class="i">Count</span> == 1 &amp;&amp; <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r82 r">values</span>[0]))
                {
                    <span class="c">// skip the blank lines</span>
                    <b>continue</b>;
                }
 
                <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r84 rd" class="r84 r">result</span> = <a href="#b125870dec3c89b1" class="i method">BuildMshobject</a>(<a href="#3c8188cfb4f00bb3" class="i property">TypeName</a>, <a href="#398087147e85a043" class="i property">Header</a>, <span class="r82 r">values</span>, <a href="#72d53cbd071583dc" class="i field">_delimiter</a>, <span class="r81 r">prevalidated</span>);
                <span class="r81 r">prevalidated</span> = <b>true</b>;
                <a href="#9bf3930f3a011971" class="i field">_cmdlet</a>.<span class="i">WriteObject</span>(<span class="r84 r">result</span>);
            }
 
            <span class="r80 r">alreadyWriteOutWarning</span> = <a href="#6272cfffc40832bc" class="i field">_alreadyWarnedUnspecifiedName</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validate the names of properties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r85 r">names</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="da4383715df288c0" href="../../R/da4383715df288c0.html" target="n" data-glyph="76,1" class="i method">ValidatePropertyNames</a>(<span class="i">IList</span>&lt;<b>string</b>&gt; <span id="r85 rd" class="r85 r">names</span>)
        {
            <b>if</b> (<span class="r85 r">names</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r85 r">names</span>.<span class="i">Count</span> == 0)
                {
                    <span class="c">// If there are no names, it is an error</span>
                }
                <b>else</b>
                {
                    <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r86 rd" class="r86 r">headers</span> = <b>new</b>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                    <b>foreach</b> (<b>string</b> <span id="r87 rd" class="r87 r">currentHeader</span> <b>in</b> <span class="r85 r">names</span>)
                    {
                        <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r87 r">currentHeader</span>))
                        {
                            <b>if</b> (!<span class="r86 r">headers</span>.<span class="i">Contains</span>(<span class="r87 r">currentHeader</span>))
                            {
                                <span class="r86 r">headers</span>.<span class="i">Add</span>(<span class="r87 r">currentHeader</span>);
                            }
                            <b>else</b>
                            {
                                <span class="c">// throw a terminating error as there are duplicate headers in the input.</span>
                                <b>string</b> <span id="r88 rd" class="r88 r">memberAlreadyPresentMsg</span> =
                                    <b>string</b>.<span class="i">Format</span>(
                                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                                        <span class="i">ExtendedTypeSystem</span>.<span class="i">MemberAlreadyPresent</span>,
                                        <span class="r87 r">currentHeader</span>);
 
                                <a href="/System.Management.Automation/A.html#288b83424f7afe8b" class="t t">ExtendedTypeSystemException</a> <span id="r89 rd" class="r89 r">exception</span> = <b>new</b>(<span class="r88 r">memberAlreadyPresentMsg</span>);
                                <b>throw</b> <span class="r89 r">exception</span>;
                            }
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Read the type information, if present.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Type string if present else null.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="0a42862f914864ee" href="../../R/0a42862f914864ee.html" target="n" data-glyph="76,1" class="i method">ReadTypeInformation</a>()
        {
            <b>string</b> <span id="r90 rd" class="r90 r">type</span> = <b>null</b>;
            <b>if</b> (<a href="#a6d4dae48e8c4094" class="i method">PeekNextChar</a>(<span class="s">&#39;#&#39;</span>))
            {
                <b>string</b> <span id="r91 rd" class="r91 r">temp</span> = <a href="#551a45d413e70ce9" class="i method">ReadLine</a>();
                <b>if</b> (<span class="r91 r">temp</span>.<span class="i">StartsWith</span>(<span class="s">&quot;#Type&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r90 r">type</span> = <span class="r91 r">temp</span>.<span class="i">Substring</span>(5);
                    <span class="r90 r">type</span> = <span class="r90 r">type</span>.<span class="i">Trim</span>();
                    <b>if</b> (<span class="r90 r">type</span>.<span class="i">Length</span> == 0)
                    {
                        <span class="r90 r">type</span> = <b>null</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r90 r">type</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads the next record from the file and returns parsed collection of string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parsed collection of strings.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private void</b> <a id="bbef0eaebdc568dd" href="../../R/bbef0eaebdc568dd.html" target="n" data-glyph="76,1" class="i method">ParseNextRecord</a>(<span class="i">List</span>&lt;<b>string</b>&gt; <span id="r92 rd" class="r92 r">result</span>, <span class="i">StringBuilder</span> <span id="r93 rd" class="r93 r">current</span>)
        {
            <span class="r92 r">result</span>.<span class="i">Clear</span>();
 
            <span class="c">// current string</span>
            <span class="r93 r">current</span>.<span class="i">Clear</span>();
 
            <b>bool</b> <span id="r94 rd" class="r94 r">seenBeginQuote</span> = <b>false</b>;
 
            <b>while</b> (!<a href="#5a576e5916ada9ff" class="i property">EOF</a>)
            {
                <span class="c">// Read the next character</span>
                <b>char</b> <span id="r95 rd" class="r95 r">ch</span> = <a href="#a72ec3889ac028e3" class="i method">ReadChar</a>();
 
                <b>if</b> (<span class="r95 r">ch</span> == <a href="#72d53cbd071583dc" class="i field">_delimiter</a>)
                {
                    <b>if</b> (<span class="r94 r">seenBeginQuote</span>)
                    {
                        <span class="c">// Delimiter inside double quotes is part of string.</span>
                        <span class="c">// Ex:</span>
                        <span class="c">// &quot;foo, bar&quot;</span>
                        <span class="c">// is parsed as</span>
                        <span class="c">// -&gt;foo, bar&lt;-</span>
                        <span class="r93 r">current</span>.<span class="i">Append</span>(<span class="r95 r">ch</span>);
                    }
                    <b>else</b>
                    {
                        <span class="c">// Delimiter outside quotes is end of current word.</span>
                        <span class="r92 r">result</span>.<span class="i">Add</span>(<span class="r93 r">current</span>.<span class="i">ToString</span>());
                        <span class="r93 r">current</span>.<span class="i">Remove</span>(0, <span class="r93 r">current</span>.<span class="i">Length</span>);
                    }
                }
                <b>else</b> <b>if</b> (<span class="r95 r">ch</span> == <span class="s">&#39;&quot;&#39;</span>)
                {
                    <b>if</b> (<span class="r94 r">seenBeginQuote</span>)
                    {
                        <b>if</b> (<a href="#a6d4dae48e8c4094" class="i method">PeekNextChar</a>(<span class="s">&#39;&quot;&#39;</span>))
                        {
                            <span class="c">// &quot;&quot; inside double quote are single quote</span>
                            <span class="c">// ex: &quot;foo&quot;&quot;bar&quot;</span>
                            <span class="c">// is read as</span>
                            <span class="c">// -&gt;foo&quot;bar&lt;-</span>
 
                            <span class="c">// PeekNextChar only peeks. Read the next char.</span>
                            <a href="#a72ec3889ac028e3" class="i method">ReadChar</a>();
                            <span class="r93 r">current</span>.<span class="i">Append</span>(<span class="s">&#39;&quot;&#39;</span>);
                        }
                        <b>else</b>
                        {
                            <span class="c">// We have seen a matching end quote.</span>
                            <span class="r94 r">seenBeginQuote</span> = <b>false</b>;
 
                            <span class="c">// Read</span>
                            <span class="c">// everything till we hit next delimiter.</span>
                            <span class="c">// In correct CSV,1) end quote is followed by delimiter</span>
                            <span class="c">// 2)end quote is followed some whitespaces and</span>
                            <span class="c">// then delimiter.</span>
                            <span class="c">// We eat the whitespaces seen after the ending quote.</span>
                            <span class="c">// However if there are other characters, we add all of them</span>
                            <span class="c">// to string.</span>
                            <span class="c">// Ex: -&gt;&quot;foo bar&quot;&lt;- is read as -&gt;foo bar&lt;-</span>
                            <span class="c">// -&gt;&quot;foo bar&quot;  &lt;- is read as -&gt;foo bar&lt;-</span>
                            <span class="c">// -&gt;&quot;foo bar&quot; ab &lt;- is read as -&gt;&quot;foo bar&quot; ab &lt;-</span>
                            <b>bool</b> <span id="r96 rd" class="r96 r">endofRecord</span> = <b>false</b>;
                            <a href="#264d9874df5a8cbc" class="i method">ReadTillNextDelimiter</a>(<span class="r93 r">current</span>, <b>ref</b> <span class="r96 r">endofRecord</span>, <b>true</b>);
                            <span class="r92 r">result</span>.<span class="i">Add</span>(<span class="r93 r">current</span>.<span class="i">ToString</span>());
                            <span class="r93 r">current</span>.<span class="i">Remove</span>(0, <span class="r93 r">current</span>.<span class="i">Length</span>);
                            <b>if</b> (<span class="r96 r">endofRecord</span>)
                                <b>break</b>;
                        }
                    }
                    <b>else</b> <b>if</b> (<span class="r93 r">current</span>.<span class="i">Length</span> == 0)
                    {
                        <span class="c">// We are at the beginning of a new word.</span>
                        <span class="c">// This quote is the first quote.</span>
                        <span class="r94 r">seenBeginQuote</span> = <b>true</b>;
                    }
                    <b>else</b>
                    {
                        <span class="c">// We are seeing a quote after the start of</span>
                        <span class="c">// the word. This is error, however we will be</span>
                        <span class="c">// lenient here and do what excel does:</span>
                        <span class="c">// Ex: foo &quot;ba,r&quot;</span>
                        <span class="c">// In above example word read is -&gt;foo &quot;ba&lt;-</span>
                        <span class="c">// Basically we read till next delimiter</span>
                        <b>bool</b> <span id="r97 rd" class="r97 r">endOfRecord</span> = <b>false</b>;
                        <span class="r93 r">current</span>.<span class="i">Append</span>(<span class="r95 r">ch</span>);
                        <a href="#264d9874df5a8cbc" class="i method">ReadTillNextDelimiter</a>(<span class="r93 r">current</span>, <b>ref</b> <span class="r97 r">endOfRecord</span>, <b>false</b>);
                        <span class="r92 r">result</span>.<span class="i">Add</span>(<span class="r93 r">current</span>.<span class="i">ToString</span>());
                        <span class="r93 r">current</span>.<span class="i">Remove</span>(0, <span class="r93 r">current</span>.<span class="i">Length</span>);
                        <b>if</b> (<span class="r97 r">endOfRecord</span>)
                            <b>break</b>;
                    }
                }
                <b>else</b> <b>if</b> (<span class="r95 r">ch</span> == <span class="s">&#39; &#39;</span> || <span class="r95 r">ch</span> == <span class="s">&#39;\t&#39;</span>)
                {
                    <b>if</b> (<span class="r94 r">seenBeginQuote</span>)
                    {
                        <span class="c">// Spaces in side quote are valid</span>
                        <span class="r93 r">current</span>.<span class="i">Append</span>(<span class="r95 r">ch</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="r93 r">current</span>.<span class="i">Length</span> == 0)
                    {
                        <span class="c">// ignore leading spaces</span>
                        <b>continue</b>;
                    }
                    <b>else</b>
                    {
                        <span class="c">// We are not in quote and we are not at the</span>
                        <span class="c">// beginning of a word. We should not be seeing</span>
                        <span class="c">// spaces here. This is an error condition, however</span>
                        <span class="c">// we will be lenient here and do what excel does,</span>
                        <span class="c">// that is read till next delimiter.</span>
                        <span class="c">// Ex: -&gt;foo &lt;- is read as -&gt;foo&lt;-</span>
                        <span class="c">// Ex: -&gt;foo bar&lt;- is read as -&gt;foo bar&lt;-</span>
                        <span class="c">// Ex: -&gt;foo bar &lt;- is read as -&gt;foo bar &lt;-</span>
                        <span class="c">// Ex: -&gt;foo bar &quot;er,ror&quot;&lt;- is read as -&gt;foo bar &quot;er&lt;-</span>
                        <b>bool</b> <span id="r98 rd" class="r98 r">endOfRecord</span> = <b>false</b>;
                        <span class="r93 r">current</span>.<span class="i">Append</span>(<span class="r95 r">ch</span>);
                        <a href="#264d9874df5a8cbc" class="i method">ReadTillNextDelimiter</a>(<span class="r93 r">current</span>, <b>ref</b> <span class="r98 r">endOfRecord</span>, <b>true</b>);
                        <span class="r92 r">result</span>.<span class="i">Add</span>(<span class="r93 r">current</span>.<span class="i">ToString</span>());
                        <span class="r93 r">current</span>.<span class="i">Remove</span>(0, <span class="r93 r">current</span>.<span class="i">Length</span>);
 
                        <b>if</b> (<span class="r98 r">endOfRecord</span>)
                        {
                            <b>break</b>;
                        }
                    }
                }
                <b>else</b> <b>if</b> (<a href="#06b7c0bc1f808e1d" class="i method">IsNewLine</a>(<span class="r95 r">ch</span>, <b>out string</b> <span id="r99 rd" class="r99 r">newLine</span>))
                {
                    <b>if</b> (<span class="r94 r">seenBeginQuote</span>)
                    {
                        <span class="c">// newline inside quote are valid</span>
                        <span class="r93 r">current</span>.<span class="i">Append</span>(<span class="r99 r">newLine</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r92 r">result</span>.<span class="i">Add</span>(<span class="r93 r">current</span>.<span class="i">ToString</span>());
                        <span class="r93 r">current</span>.<span class="i">Remove</span>(0, <span class="r93 r">current</span>.<span class="i">Length</span>);
 
                        <span class="c">// New line outside quote is end of word and end of record</span>
                        <b>break</b>;
                    }
                }
                <b>else</b>
                {
                    <span class="r93 r">current</span>.<span class="i">Append</span>(<span class="r95 r">ch</span>);
                }
            }
 
            <b>if</b> (<span class="r93 r">current</span>.<span class="i">Length</span> != 0)
            {
                <span class="r92 r">result</span>.<span class="i">Add</span>(<span class="r93 r">current</span>.<span class="i">ToString</span>());
            }
        }
 
        <span class="c">// If we detect a newline we return it as a string &quot;\r&quot;, &quot;\n&quot; or &quot;\r\n&quot;</span>
        <b>private bool</b> <a id="06b7c0bc1f808e1d" href="../../R/06b7c0bc1f808e1d.html" target="n" data-glyph="76,1" class="i method">IsNewLine</a>(<b>char</b> <span id="r100 rd" class="r100 r">ch</span>, <b>out string</b> <span id="r101 rd" class="r101 r">newLine</span>)
        {
            <span class="r101 r">newLine</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<span class="r100 r">ch</span> == <span class="s">&#39;\r&#39;</span>)
            {
                <b>if</b> (<a href="#a6d4dae48e8c4094" class="i method">PeekNextChar</a>(<span class="s">&#39;\n&#39;</span>))
                {
                    <a href="#a72ec3889ac028e3" class="i method">ReadChar</a>();
                    <span class="r101 r">newLine</span> = <span class="s">&quot;\r\n&quot;</span>;
                }
                <b>else</b>
                {
                    <span class="r101 r">newLine</span> = <span class="s">&quot;\r&quot;</span>;
                }
            }
            <b>else</b> <b>if</b> (<span class="r100 r">ch</span> == <span class="s">&#39;\n&#39;</span>)
            {
                <span class="r101 r">newLine</span> = <span class="s">&quot;\n&quot;</span>;
            }
 
            <b>return</b> <span class="r101 r">newLine</span> != <b>string</b>.<span class="i">Empty</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This function reads the characters till next delimiter and adds them to current.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">current</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">endOfRecord</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is true if end of record is reached</span>
        <span class="c">///</span><span class="c"> when delimiter is hit. This would be true if delimiter is NewLine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">eatTrailingBlanks</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If this is true, eat the trailing blanks. Note:if there are non</span>
        <span class="c">///</span><span class="c"> whitespace characters present, then trailing blanks are not consumed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="264d9874df5a8cbc" href="../../R/264d9874df5a8cbc.html" target="n" data-glyph="76,1" class="i method">ReadTillNextDelimiter</a>(<span class="i">StringBuilder</span> <span id="r102 rd" class="r102 r">current</span>, <b>ref bool</b> <span id="r103 rd" class="r103 r">endOfRecord</span>, <b>bool</b> <span id="r104 rd" class="r104 r">eatTrailingBlanks</span>)
        {
            <span class="i">StringBuilder</span> <span id="r105 rd" class="r105 r">temp</span> = <b>new</b>();
 
            <span class="c">// Did we see any non-whitespace character</span>
            <b>bool</b> <span id="r106 rd" class="r106 r">nonWhiteSpace</span> = <b>false</b>;
 
            <b>while</b> (<b>true</b>)
            {
                <b>if</b> (<a href="#5a576e5916ada9ff" class="i property">EOF</a>)
                {
                    <span class="r103 r">endOfRecord</span> = <b>true</b>;
                    <b>break</b>;
                }
 
                <b>char</b> <span id="r107 rd" class="r107 r">ch</span> = <a href="#a72ec3889ac028e3" class="i method">ReadChar</a>();
 
                <b>if</b> (<span class="r107 r">ch</span> == <a href="#72d53cbd071583dc" class="i field">_delimiter</a>)
                {
                    <b>break</b>;
                }
                <b>else</b> <b>if</b> (<a href="#06b7c0bc1f808e1d" class="i method">IsNewLine</a>(<span class="r107 r">ch</span>, <b>out string</b> <span id="r108 rd" class="r108 r">newLine</span>))
                {
                    <span class="r103 r">endOfRecord</span> = <b>true</b>;
                    <b>break</b>;
                }
                <b>else</b>
                {
                    <span class="r105 r">temp</span>.<span class="i">Append</span>(<span class="r107 r">ch</span>);
                    <b>if</b> (<span class="r107 r">ch</span> != <span class="s">&#39; &#39;</span> &amp;&amp; <span class="r107 r">ch</span> != <span class="s">&#39;\t&#39;</span>)
                    {
                        <span class="r106 r">nonWhiteSpace</span> = <b>true</b>;
                    }
                }
            }
 
            <b>if</b> (<span class="r104 r">eatTrailingBlanks</span> &amp;&amp; !<span class="r106 r">nonWhiteSpace</span>)
            {
                <b>string</b> <span id="r109 rd" class="r109 r">s</span> = <span class="r105 r">temp</span>.<span class="i">ToString</span>();
                <span class="r109 r">s</span> = <span class="r109 r">s</span>.<span class="i">Trim</span>();
                <span class="r102 r">current</span>.<span class="i">Append</span>(<span class="r109 r">s</span>);
            }
            <b>else</b>
            {
                <span class="r102 r">current</span>.<span class="i">Append</span>(<span class="r105 r">temp</span>);
            }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="b125870dec3c89b1" href="../../R/b125870dec3c89b1.html" target="n" data-glyph="76,1" class="i method">BuildMshobject</a>(<b>string</b> <span id="r110 rd" class="r110 r">type</span>, <span class="i">IList</span>&lt;<b>string</b>&gt; <span id="r111 rd" class="r111 r">names</span>, <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r112 rd" class="r112 r">values</span>, <b>char</b> <span id="r113 rd" class="r113 r">delimiter</span>, <b>bool</b> <span id="r114 rd" class="r114 r">preValidated</span> = <b>false</b>)
        {
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r115 rd" class="r115 r">result</span> = <b>new</b>(<span class="r111 r">names</span>.<span class="i">Count</span>);
            <b>char</b> <span id="r116 rd" class="r116 r">delimiterlocal</span> = <span class="r113 r">delimiter</span>;
            <b>int</b> <span id="r117 rd" class="r117 r">unspecifiedNameIndex</span> = 1;
            <b>for</b> (<b>int</b> <span id="r118 rd" class="r118 r">i</span> = 0; <span class="r118 r">i</span> &lt;= <span class="r111 r">names</span>.<span class="i">Count</span> - 1; <span class="r118 r">i</span>++)
            {
                <b>string</b> <span id="r119 rd" class="r119 r">name</span> = <span class="r111 r">names</span>[<span class="r118 r">i</span>];
                <b>string</b> <span id="r120 rd" class="r120 r">value</span> = <b>null</b>;
 
                <span class="c">// if name is null and delimiter is &#39;&quot;&#39;, use a default property name &#39;UnspecifiedName&#39;</span>
                <b>if</b> (<span class="r119 r">name</span>.<span class="i">Length</span> == 0 &amp;&amp; <span class="r116 r">delimiterlocal</span> == <span class="s">&#39;&quot;&#39;</span>)
                {
                    <span class="r119 r">name</span> = <a href="#bcbaf69c1683f590" class="i field">UnspecifiedName</a> + <span class="r117 r">unspecifiedNameIndex</span>;
                    <span class="r117 r">unspecifiedNameIndex</span>++;
                }
 
                <span class="c">// if name is null and delimiter is not &#39;&quot;&#39;, use a default property name &#39;UnspecifiedName&#39;</span>
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r119 r">name</span>))
                {
                    <span class="r119 r">name</span> = <a href="#bcbaf69c1683f590" class="i field">UnspecifiedName</a> + <span class="r117 r">unspecifiedNameIndex</span>;
                    <span class="r117 r">unspecifiedNameIndex</span>++;
                }
 
                <span class="c">// If no value was present in CSV file, we write null.</span>
                <b>if</b> (<span class="r118 r">i</span> &lt; <span class="r112 r">values</span>.<span class="i">Count</span>)
                {
                    <span class="r120 r">value</span> = <span class="r112 r">values</span>[<span class="r118 r">i</span>];
                }
 
                <span class="r115 r">result</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r119 r">name</span>, <span class="r120 r">value</span>), <span class="r114 r">preValidated</span>);
            }
 
            <b>if</b> (!<a href="#6272cfffc40832bc" class="i field">_alreadyWarnedUnspecifiedName</a> &amp;&amp; <span class="r117 r">unspecifiedNameIndex</span> != 1)
            {
                <a href="#9bf3930f3a011971" class="i field">_cmdlet</a>.<span class="i">WriteWarning</span>(<span class="i">CsvCommandStrings</span>.<span class="i">UseDefaultNameForUnspecifiedHeader</span>);
                <a href="#6272cfffc40832bc" class="i field">_alreadyWarnedUnspecifiedName</a> = <b>true</b>;
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r110 r">type</span>))
            {
                <span class="r115 r">result</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Clear</span>();
                <span class="r115 r">result</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<span class="r110 r">type</span>);
                <span class="r115 r">result</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Add</span>(<a href="#05fe38acca3e7a22" class="t t">ImportExportCSVHelper</a>.<a href="#73322ecd3319aee1" class="i field">CSVTypePrefix</a> + <span class="r110 r">type</span>);
            }
 
            <b>return</b> <span class="r115 r">result</span>;
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ImportHelperConversion
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> ExportImport Helper
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Helper class for CSV conversion.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="05fe38acca3e7a22" href="../../R/05fe38acca3e7a22.html" target="n" data-glyph="2,0" class="t t">ImportExportCSVHelper</a>
    {
        <b>internal const char</b> <a id="a33b8992742a31ae" href="../../R/a33b8992742a31ae.html" target="n" data-glyph="8,1" class="i field">CSVDelimiter</a> = <span class="s">&#39;,&#39;</span>;
        <b>internal const string</b> <a id="73322ecd3319aee1" href="../../R/73322ecd3319aee1.html" target="n" data-glyph="8,1" class="i field">CSVTypePrefix</a> = <span class="s">&quot;CSV:&quot;</span>;
 
        <b>internal static char</b> <a id="5756efbf6e169aeb" href="../../R/5756efbf6e169aeb.html" target="n" data-glyph="74,1" class="i method">SetDelimiter</a>(<a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r121 rd" class="r121 r">cmdlet</span>, <b>string</b> <span id="r122 rd" class="r122 r">parameterSetName</span>, <b>char</b> <span id="r123 rd" class="r123 r">explicitDelimiter</span>, <b>bool</b> <span id="r124 rd" class="r124 r">useCulture</span>)
        {
            <b>char</b> <span id="r125 rd" class="r125 r">delimiter</span> = <span class="r123 r">explicitDelimiter</span>;
            <b>switch</b> (<span class="r122 r">parameterSetName</span>)
            {
                <b>case</b> <span class="s">&quot;Delimiter&quot;</span>:
                <b>case</b> <span class="s">&quot;DelimiterPath&quot;</span>:
                <b>case</b> <span class="s">&quot;DelimiterLiteralPath&quot;</span>:
 
                    <span class="c">// if delimiter is not given, it should take , as value</span>
                    <b>if</b> (<span class="r123 r">explicitDelimiter</span> == <span class="s">&#39;\0&#39;</span>)
                    {
                        <span class="r125 r">delimiter</span> = <a href="#05fe38acca3e7a22" class="t t">ImportExportCSVHelper</a>.<a href="#a33b8992742a31ae" class="i field">CSVDelimiter</a>;
                    }
 
                    <b>break</b>;
                <b>case</b> <span class="s">&quot;UseCulture&quot;</span>:
                <b>case</b> <span class="s">&quot;CulturePath&quot;</span>:
                <b>case</b> <span class="s">&quot;CultureLiteralPath&quot;</span>:
                    <b>if</b> (<span class="r124 r">useCulture</span>)
                    {
                        <span class="c">// ListSeparator is apparently always a character even though the property returns a string, checked via:</span>
                        <span class="c">// [CultureInfo]::GetCultures(&quot;AllCultures&quot;) | % { ([CultureInfo]($_.Name)).TextInfo.ListSeparator } | ? Length -ne 1</span>
                        <span class="r125 r">delimiter</span> = <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>.<span class="i">TextInfo</span>.<span class="i">ListSeparator</span>[0];
                    }
 
                    <b>break</b>;
                <b>default</b>:
                    {
                        <span class="r125 r">delimiter</span> = <a href="#05fe38acca3e7a22" class="t t">ImportExportCSVHelper</a>.<a href="#a33b8992742a31ae" class="i field">CSVDelimiter</a>;
                    }
 
                    <b>break</b>;
            }
 
            <b>return</b> <span class="r125 r">delimiter</span>;
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ExportImport Helper
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> CSV conversion
}
</pre></td></tr></table></div></body></html>
