<!DOCTYPE html>
<html><head><title>ConvertTo-Html.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(768);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility/commands/utility/ConvertTo-Html.cs" target="_top">commands\utility\ConvertTo-Html.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility" target="_top">src\Microsoft.PowerShell.Commands.Utility\Microsoft.PowerShell.Commands.Utility.csproj</a> (Microsoft.PowerShell.Commands.Utility)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Net</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class comment.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#ced47428947bccb7" class="t t">VerbsData</a>.<a href="/System.Management.Automation/A.html#2aa04ceb3568c2d5" class="i field">ConvertTo</a>, <span class="s">&quot;Html&quot;</span>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;Page&quot;</span>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096595&quot;</span>, <span class="i">RemotingCapability</span> = <a href="/System.Management.Automation/A.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="/System.Management.Automation/A.html#5111d4e307f1cb5a" class="i field">None</a>)]
    <b>public sealed
    class</b> <a id="a8ef9169c4ea0bc5" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="7a6df21df05f673a">ConvertToHtmlCommand</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The incoming object</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="a170321ec85c2724" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">InputObject</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#d314992c5300b8aa" class="i field">_inputObject</a>;
            }
 
            <b>set</b>
            {
                <a href="#d314992c5300b8aa" class="i field">_inputObject</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="d314992c5300b8aa" href="../../R/d314992c5300b8aa.html" target="n" data-glyph="46,1" class="i field">_inputObject</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The list of properties to display.</span>
        <span class="c">///</span><span class="c"> These take the form of a PSPropertyExpression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        <b>public object</b>[] <a id="23b19c59e24e4571" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Property</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#6a7e25eccdd5081c" class="i field">_property</a>;
            }
 
            <b>set</b>
            {
                <a href="#6a7e25eccdd5081c" class="i field">_property</a> = <b>value</b>;
            }
        }
 
        <b>private object</b>[] <a id="6a7e25eccdd5081c" href="../../R/6a7e25eccdd5081c.html" target="n" data-glyph="46,1" class="i field">_property</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Text to go after the opening body tag and before the table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Page&quot;</span>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 3)]
        <b>public string</b>[] <a id="fcc16898090dfe74" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Body</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f4a990f40ecc8e50" class="i field">_body</a>;
            }
 
            <b>set</b>
            {
                <a href="#f4a990f40ecc8e50" class="i field">_body</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="f4a990f40ecc8e50" href="../../R/f4a990f40ecc8e50.html" target="n" data-glyph="46,1" class="i field">_body</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Text to go into the head section of the html doc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Page&quot;</span>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1)]
        <b>public string</b>[] <a id="7cb84e494f63289e" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Head</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#22a32399329d9303" class="i field">_head</a>;
            }
 
            <b>set</b>
            {
                <a href="#22a32399329d9303" class="i field">_head</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="22a32399329d9303" href="../../R/22a32399329d9303.html" target="n" data-glyph="46,1" class="i field">_head</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The string for the title tag</span>
        <span class="c">///</span><span class="c"> The title is also placed in the body of the document</span>
        <span class="c">///</span><span class="c"> before the table between h3 tags</span>
        <span class="c">///</span><span class="c"> If the -Head parameter is used, this parameter has no</span>
        <span class="c">///</span><span class="c"> effect.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Page&quot;</span>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 2)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="ddac87b68b049b05" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Title</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e4a54e0c4843ff2c" class="i field">_title</a>;
            }
 
            <b>set</b>
            {
                <a href="#e4a54e0c4843ff2c" class="i field">_title</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="e4a54e0c4843ff2c" href="../../R/e4a54e0c4843ff2c.html" target="n" data-glyph="46,1" class="i field">_title</a> = <span class="s">&quot;HTML TABLE&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This specifies whether the objects should</span>
        <span class="c">///</span><span class="c"> be rendered as an HTML TABLE or</span>
        <span class="c">///</span><span class="c"> HTML LIST.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">ValidateSet</span>(<span class="s">&quot;Table&quot;</span>, <span class="s">&quot;List&quot;</span>)]
        <b>public string</b> <a id="87c7432303fc0b24" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">As</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#10fc111b5a03e2c8" class="i field">_as</a>;
            }
 
            <b>set</b>
            {
                <a href="#10fc111b5a03e2c8" class="i field">_as</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="10fc111b5a03e2c8" href="../../R/10fc111b5a03e2c8.html" target="n" data-glyph="46,1" class="i field">_as</a> = <span class="s">&quot;Table&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This specifies a full or partial URI</span>
        <span class="c">///</span><span class="c"> for the CSS information.</span>
        <span class="c">///</span><span class="c"> The HTML should reference the CSS file specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Page&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;cu&quot;</span>, <span class="s">&quot;uri&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Uri</span> <a id="5c4b0d1549bf1119" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">CssUri</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#268342e6cb94a4b9" class="i field">_cssuri</a>;
            }
 
            <b>set</b>
            {
                <a href="#268342e6cb94a4b9" class="i field">_cssuri</a> = <b>value</b>;
                <a href="#083fe9778347494f" class="i field">_cssuriSpecified</a> = <b>true</b>;
            }
        }
 
        <b>private</b> <span class="i">Uri</span> <a id="268342e6cb94a4b9" href="../../R/268342e6cb94a4b9.html" target="n" data-glyph="46,1" class="i field">_cssuri</a>;
        <b>private bool</b> <a id="083fe9778347494f" href="../../R/083fe9778347494f.html" target="n" data-glyph="46,1" class="i field">_cssuriSpecified</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When this switch is specified generate only the</span>
        <span class="c">///</span><span class="c"> HTML representation of the incoming object</span>
        <span class="c">///</span><span class="c"> without the HTML,HEAD,TITLE,BODY,etc tags.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Fragment&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="7ce4776fe0ddc3ce" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Fragment</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4b7f4104abf58680" class="i field">_fragment</a>;
            }
 
            <b>set</b>
            {
                <a href="#4b7f4104abf58680" class="i field">_fragment</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="4b7f4104abf58680" href="../../R/4b7f4104abf58680.html" target="n" data-glyph="46,1" class="i field">_fragment</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the text to include prior the closing body tag of the HTML output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="957b9a53bc42e6f5" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">PostContent</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e438edf8950b0bf6" class="i field">_postContent</a>;
            }
 
            <b>set</b>
            {
                <a href="#e438edf8950b0bf6" class="i field">_postContent</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="e438edf8950b0bf6" href="../../R/e438edf8950b0bf6.html" target="n" data-glyph="46,1" class="i field">_postContent</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the text to include after the body tag of the HTML output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="ed7875cb36152230" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">PreContent</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9dc54977e41c0917" class="i field">_preContent</a>;
            }
 
            <b>set</b>
            {
                <a href="#9dc54977e41c0917" class="i field">_preContent</a> = <b>value</b>;
            }
        }
 
        <b>private string</b>[] <a id="9dc54977e41c0917" href="../../R/9dc54977e41c0917.html" target="n" data-glyph="46,1" class="i field">_preContent</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets and Gets the meta property of the HTML head.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Page&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Hashtable</span> <a id="682c42efe0cccbe4" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Meta</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#39665563cd1b97a1" class="i field">_meta</a>;
            }
 
            <b>set</b>
            {
                <a href="#39665563cd1b97a1" class="i field">_meta</a> = <b>value</b>;
                <a href="#6a8ecbdfb049ac54" class="i field">_metaSpecified</a> = <b>true</b>;
            }
        }
 
        <b>private</b> <span class="i">Hashtable</span> <a id="39665563cd1b97a1" href="../../R/39665563cd1b97a1.html" target="n" data-glyph="46,1" class="i field">_meta</a>;
        <b>private bool</b> <a id="6a8ecbdfb049ac54" href="../../R/6a8ecbdfb049ac54.html" target="n" data-glyph="46,1" class="i field">_metaSpecified</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the charset encoding for the HTML document.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Page&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">ValidatePattern</span>(<span class="s">&quot;^[A-Za-z0-9]\\w+\\S+[A-Za-z0-9]$&quot;</span>)]
        <b>public string</b> <a id="ed061c5a242d0f66" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Charset</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#61c8f595718a2da6" class="i field">_charset</a>;
            }
 
            <b>set</b>
            {
                <a href="#61c8f595718a2da6" class="i field">_charset</a> = <b>value</b>;
                <a href="#62136a1a9196c7c0" class="i field">_charsetSpecified</a> = <b>true</b>;
            }
        }
 
        <b>private string</b> <a id="61c8f595718a2da6" href="../../R/61c8f595718a2da6.html" target="n" data-glyph="46,1" class="i field">_charset</a>;
        <b>private bool</b> <a id="62136a1a9196c7c0" href="../../R/62136a1a9196c7c0.html" target="n" data-glyph="46,1" class="i field">_charsetSpecified</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When this switch statement is specified,</span>
        <span class="c">///</span><span class="c"> it will change the DOCTYPE to XHTML Transitional DTD.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Page&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="98f4f3b7fc272717" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Transitional</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#0f7d54dee785e314" class="i field">_transitional</a>;
            }
 
            <b>set</b>
            {
                <a href="#0f7d54dee785e314" class="i field">_transitional</a> = <b>true</b>;
            }
        }
 
        <b>private bool</b> <a id="0f7d54dee785e314" href="../../R/0f7d54dee785e314.html" target="n" data-glyph="46,1" class="i field">_transitional</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Definitions for hash table keys.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static class</b> <a id="c2525ecf9e515f8c" href="../../R/c2525ecf9e515f8c.html" target="n" data-glyph="2,1" class="t t">ConvertHTMLParameterDefinitionKeys</a>
        {
            <b>internal const string</b> <a id="812b5d9776ff96c0" href="../../R/812b5d9776ff96c0.html" target="n" data-glyph="8,2" class="i field">LabelEntryKey</a> = <span class="s">&quot;label&quot;</span>;
            <b>internal const string</b> <a id="22a1f73b57177357" href="../../R/22a1f73b57177357.html" target="n" data-glyph="8,2" class="i field">AlignmentEntryKey</a> = <span class="s">&quot;alignment&quot;</span>;
            <b>internal const string</b> <a id="76965e73c90c5562" href="../../R/76965e73c90c5562.html" target="n" data-glyph="8,2" class="i field">WidthEntryKey</a> = <span class="s">&quot;width&quot;</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This allows for @{e=&#39;foo&#39;;label=&#39;bar&#39;;alignment=&#39;center&#39;;width=&#39;20&#39;}.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal class</b> <a id="410f25d1c210e29a" href="../../R/../../0000000000.html" target="n" data-glyph="2,1" class="t t"><span id="2ae6b9fc54980f41">ConvertHTMLExpressionParameterDefinition</span></a> : <span class="i">CommandParameterDefinition</span>
        {
            <b>protected override void</b> <a id="6960746548d5fa1d" href="../../R/../../0000000000.html" target="n" data-glyph="75,2" class="i method">SetEntries</a>()
            {
                <a href="#410f25d1c210e29a" class="k">this</a>.<span class="i">hashEntries</span>.<span class="i">Add</span>(<b>new</b> <span class="i">ExpressionEntryDefinition</span>());
                <a href="#410f25d1c210e29a" class="k">this</a>.<span class="i">hashEntries</span>.<span class="i">Add</span>(<b>new</b> <span class="i">LabelEntryDefinition</span>());
                <a href="#410f25d1c210e29a" class="k">this</a>.<span class="i">hashEntries</span>.<span class="i">Add</span>(<b>new</b> <span class="i">HashtableEntryDefinition</span>(<a href="#c2525ecf9e515f8c" class="t t">ConvertHTMLParameterDefinitionKeys</a>.<a href="#22a1f73b57177357" class="i field">AlignmentEntryKey</a>, <b>new</b>[] { <b>typeof</b>(<b>string</b>) }));
 
                <span class="c">// Note: We accept &quot;width&quot; as either string or int.</span>
                <a href="#410f25d1c210e29a" class="k">this</a>.<span class="i">hashEntries</span>.<span class="i">Add</span>(<b>new</b> <span class="i">HashtableEntryDefinition</span>(<a href="#c2525ecf9e515f8c" class="t t">ConvertHTMLParameterDefinitionKeys</a>.<a href="#76965e73c90c5562" class="i field">WidthEntryKey</a>, <b>new</b>[] { <b>typeof</b>(<b>string</b>), <b>typeof</b>(<b>int</b>) }));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a list of MshParameter from properties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">properties</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Can be a string, ScriptBlock, or Hashtable.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <a id="9ecda894d29ac1f2" href="../../R/9ecda894d29ac1f2.html" target="n" data-glyph="76,1" class="i method">ProcessParameter</a>(<b>object</b>[] <span id="r0 rd" class="r0 r">properties</span>)
        {
            <span class="i">TerminatingErrorContext</span> <span id="r1 rd" class="r1 r">invocationContext</span> = <b>new</b>(<a href="#a8ef9169c4ea0bc5" class="k">this</a>);
            <span class="i">ParameterProcessor</span> <span id="r2 rd" class="r2 r">processor</span> =
                <b>new</b>(<b>new</b> <span class="t">ConvertHTMLExpressionParameterDefinition</span>());
            <b>if</b> (<span class="r0 r">properties</span> == <b>null</b>)
            {
                <span class="r0 r">properties</span> = <b>new</b> <b>object</b>[] { <span class="s">&quot;*&quot;</span> };
            }
 
            <b>return</b> <span class="r2 r">processor</span>.<span class="i">ProcessParameters</span>(<span class="r0 r">properties</span>, <span class="r1 r">invocationContext</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resolve all wildcards in user input Property into resolvedNameMshParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="fbefd552164f75b9" href="../../R/fbefd552164f75b9.html" target="n" data-glyph="76,1" class="i method">InitializeResolvedNameMshParameters</a>()
        {
            <span class="c">// temp list of properties with wildcards resolved</span>
            <b>var</b> <span id="r3 rd" class="r3 r">resolvedNameProperty</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
 
            <b>foreach</b> (<span class="i">MshParameter</span> <span id="r4 rd" class="r4 r">p</span> <b>in</b> <a href="#fc445d921bf7be05" class="i field">_propertyMshParameterList</a>)
            {
                <b>string</b> <span id="r5 rd" class="r5 r">label</span> = <span class="r4 r">p</span>.<span class="i">GetEntry</span>(<a href="#c2525ecf9e515f8c" class="t t">ConvertHTMLParameterDefinitionKeys</a>.<a href="#812b5d9776ff96c0" class="i field">LabelEntryKey</a>) <b>as string</b>;
                <b>string</b> <span id="r6 rd" class="r6 r">alignment</span> = <span class="r4 r">p</span>.<span class="i">GetEntry</span>(<a href="#c2525ecf9e515f8c" class="t t">ConvertHTMLParameterDefinitionKeys</a>.<a href="#22a1f73b57177357" class="i field">AlignmentEntryKey</a>) <b>as string</b>;
 
                <span class="c">// Accept the width both as a string and as an int.</span>
                <b>string</b> <span id="r7 rd" class="r7 r">width</span>;
                <b>int</b>? <span id="r8 rd" class="r8 r">widthNum</span> = <span class="r4 r">p</span>.<span class="i">GetEntry</span>(<a href="#c2525ecf9e515f8c" class="t t">ConvertHTMLParameterDefinitionKeys</a>.<a href="#76965e73c90c5562" class="i field">WidthEntryKey</a>) <b>as int</b>?;
                <span class="r7 r">width</span> = <span class="r8 r">widthNum</span> != <b>null</b> ? <span class="r8 r">widthNum</span>.<span class="i">Value</span>.<span class="i">ToString</span>() : <span class="r4 r">p</span>.<span class="i">GetEntry</span>(<a href="#c2525ecf9e515f8c" class="t t">ConvertHTMLParameterDefinitionKeys</a>.<a href="#76965e73c90c5562" class="i field">WidthEntryKey</a>) <b>as string</b>;
                <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r9 rd" class="r9 r">ex</span> = <span class="r4 r">p</span>.<span class="i">GetEntry</span>(<span class="i">FormatParameterDefinitionKeys</span>.<span class="i">ExpressionEntryKey</span>) <b>as</b> <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a>;
                <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a>&gt; <span id="r10 rd" class="r10 r">resolvedNames</span> = <span class="r9 r">ex</span>.<span class="i">ResolveNames</span>(<a href="#d314992c5300b8aa" class="i field">_inputObject</a>);
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r11 rd" class="r11 r">resolvedName</span> <b>in</b> <span class="r10 r">resolvedNames</span>)
                {
                    <span class="i">Hashtable</span> <span id="r12 rd" class="r12 r">ht</span> = <a href="#b62914ac99d48a79" class="i method">CreateAuxPropertyHT</a>(<span class="r5 r">label</span>, <span class="r6 r">alignment</span>, <span class="r7 r">width</span>);
                    <b>if</b> (<span class="r11 r">resolvedName</span>.<a href="/System.Management.Automation/A.html#6f162fe9a0652141" class="i property">Script</a> != <b>null</b>)
                    {
                        <span class="c">// The argument is a calculated property whose value is calculated by a script block.</span>
                        <span class="r12 r">ht</span>.<span class="i">Add</span>(<span class="i">FormatParameterDefinitionKeys</span>.<span class="i">ExpressionEntryKey</span>, <span class="r11 r">resolvedName</span>.<a href="/System.Management.Automation/A.html#6f162fe9a0652141" class="i property">Script</a>);
                    }
                    <b>else</b>
                    {
                        <span class="r12 r">ht</span>.<span class="i">Add</span>(<span class="i">FormatParameterDefinitionKeys</span>.<span class="i">ExpressionEntryKey</span>, <span class="r11 r">resolvedName</span>.<span class="i">ToString</span>());
                    }
                    <span class="r3 r">resolvedNameProperty</span>.<span class="i">Add</span>(<span class="r12 r">ht</span>);
                }
            }
 
            <a href="#e4d6286820fa1472" class="i field">_resolvedNameMshParameters</a> = <span class="i">ProcessParameter</span>(<span class="r3 r">resolvedNameProperty</span>.<span class="i">ToArray</span>());
        }
 
        <b>private static</b> <span class="i">Hashtable</span> <a id="b62914ac99d48a79" href="../../R/b62914ac99d48a79.html" target="n" data-glyph="76,1" class="i method">CreateAuxPropertyHT</a>(
            <b>string</b> <span id="r13 rd" class="r13 r">label</span>,
            <b>string</b> <span id="r14 rd" class="r14 r">alignment</span>,
            <b>string</b> <span id="r15 rd" class="r15 r">width</span>)
        {
            <span class="i">Hashtable</span> <span id="r16 rd" class="r16 r">ht</span> = <b>new</b>();
            <b>if</b> (<span class="r13 r">label</span> != <b>null</b>)
            {
                <span class="r16 r">ht</span>.<span class="i">Add</span>(<a href="#c2525ecf9e515f8c" class="t t">ConvertHTMLParameterDefinitionKeys</a>.<a href="#812b5d9776ff96c0" class="i field">LabelEntryKey</a>, <span class="r13 r">label</span>);
            }
 
            <b>if</b> (<span class="r14 r">alignment</span> != <b>null</b>)
            {
                <span class="r16 r">ht</span>.<span class="i">Add</span>(<a href="#c2525ecf9e515f8c" class="t t">ConvertHTMLParameterDefinitionKeys</a>.<a href="#22a1f73b57177357" class="i field">AlignmentEntryKey</a>, <span class="r14 r">alignment</span>);
            }
 
            <b>if</b> (<span class="r15 r">width</span> != <b>null</b>)
            {
                <span class="r16 r">ht</span>.<span class="i">Add</span>(<a href="#c2525ecf9e515f8c" class="t t">ConvertHTMLParameterDefinitionKeys</a>.<a href="#76965e73c90c5562" class="i field">WidthEntryKey</a>, <span class="r15 r">width</span>);
            }
 
            <b>return</b> <span class="r16 r">ht</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Calls ToString. If an exception occurs, eats it and return string.Empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">obj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="d7045c38286674b2" href="../../R/d7045c38286674b2.html" target="n" data-glyph="76,1" class="i method">SafeToString</a>(<b>object</b> <span id="r17 rd" class="r17 r">obj</span>)
        {
            <b>if</b> (<span class="r17 r">obj</span> == <b>null</b>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>try</b>
            {
                <b>return</b> <span class="r17 r">obj</span>.<span class="i">ToString</span>();
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <span class="c">// eats exception if safe</span>
            }
 
            <b>return</b> <b>string</b>.<span class="i">Empty</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="7e4abb57f5a85e86" href="../../R/7e4abb57f5a85e86.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <span class="c">// ValidateNotNullOrEmpty attribute is not working for System.Uri datatype, so handling it here</span>
            <b>if</b> ((<a href="#083fe9778347494f" class="i field">_cssuriSpecified</a>) &amp;&amp; (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#268342e6cb94a4b9" class="i field">_cssuri</a>.<span class="i">OriginalString</span>.<span class="i">Trim</span>())))
            {
                <span class="i">ArgumentException</span> <span id="r18 rd" class="r18 r">ex</span> = <b>new</b>(<span class="i">StringUtil</span>.<span class="i">Format</span>(<span class="i">UtilityCommonStrings</span>.<span class="i">EmptyCSSUri</span>, <span class="s">&quot;CSSUri&quot;</span>));
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r19 rd" class="r19 r">er</span> = <b>new</b>(<span class="r18 r">ex</span>, <span class="s">&quot;ArgumentException&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <span class="s">&quot;CSSUri&quot;</span>);
                <span class="i">ThrowTerminatingError</span>(<span class="r19 r">er</span>);
            }
 
            <a href="#fc445d921bf7be05" class="i field">_propertyMshParameterList</a> = <a href="#9ecda894d29ac1f2" class="i method">ProcessParameter</a>(<a href="#6a7e25eccdd5081c" class="i field">_property</a>);
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#e4a54e0c4843ff2c" class="i field">_title</a>))
            {
                <span class="i">WebUtility</span>.<span class="i">HtmlEncode</span>(<a href="#e4a54e0c4843ff2c" class="i field">_title</a>);
            }
 
            <span class="c">// This first line ensures w3c validation will succeed. However we are not specifying</span>
            <span class="c">// an encoding in the HTML because we don&#39;t know where the text will be written and</span>
            <span class="c">// if a particular encoding will be used.</span>
 
            <b>if</b> (!<a href="#4b7f4104abf58680" class="i field">_fragment</a>)
            {
                <b>if</b> (!<a href="#0f7d54dee785e314" class="i field">_transitional</a>)
                {
                    <span class="i">WriteObject</span>(<span class="s">&quot;&lt;!DOCTYPE html PUBLIC \&quot;-//W3C//DTD XHTML 1.0 Strict//EN\&quot;  \&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\&quot;&gt;&quot;</span>);
                }
                <b>else</b>
                {
                    <span class="i">WriteObject</span>(<span class="s">&quot;&lt;!DOCTYPE html PUBLIC \&quot;-//W3C//DTD XHTML 1.0 Transitional//EN\&quot;  \&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\&quot;&gt;&quot;</span>);
                }
 
                <span class="i">WriteObject</span>(<span class="s">&quot;&lt;html xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;&quot;</span>);
                <span class="i">WriteObject</span>(<span class="s">&quot;&lt;head&gt;&quot;</span>);
                <b>if</b> (<a href="#62136a1a9196c7c0" class="i field">_charsetSpecified</a>)
                {
                    <span class="i">WriteObject</span>(<span class="s">&quot;&lt;meta charset=\&quot;&quot;</span> + <a href="#61c8f595718a2da6" class="i field">_charset</a> + <span class="s">&quot;\&quot;&gt;&quot;</span>);
                }
 
                <b>if</b> (<a href="#6a8ecbdfb049ac54" class="i field">_metaSpecified</a>)
                {
                    <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r20 rd" class="r20 r">useditems</span> = <b>new</b>();
                    <b>foreach</b> (<b>string</b> <span id="r21 rd" class="r21 r">s</span> <b>in</b> <a href="#39665563cd1b97a1" class="i field">_meta</a>.<span class="i">Keys</span>)
                    {
                        <b>if</b> (!<span class="r20 r">useditems</span>.<span class="i">Contains</span>(<span class="r21 r">s</span>))
                        {
                            <b>switch</b> (<span class="r21 r">s</span>.<span class="i">ToLower</span>())
                            {
                                <b>case</b> <span class="s">&quot;content-type&quot;</span>:
                                <b>case</b> <span class="s">&quot;default-style&quot;</span>:
                                <b>case</b> <span class="s">&quot;x-ua-compatible&quot;</span>:
                                    <span class="i">WriteObject</span>(<span class="s">&quot;&lt;meta http-equiv=\&quot;&quot;</span> + <span class="r21 r">s</span> + <span class="s">&quot;\&quot; content=\&quot;&quot;</span> + <a href="#39665563cd1b97a1" class="i field">_meta</a>[<span class="r21 r">s</span>] + <span class="s">&quot;\&quot;&gt;&quot;</span>);
                                    <b>break</b>;
                                <b>case</b> <span class="s">&quot;application-name&quot;</span>:
                                <b>case</b> <span class="s">&quot;author&quot;</span>:
                                <b>case</b> <span class="s">&quot;description&quot;</span>:
                                <b>case</b> <span class="s">&quot;generator&quot;</span>:
                                <b>case</b> <span class="s">&quot;keywords&quot;</span>:
                                <b>case</b> <span class="s">&quot;viewport&quot;</span>:
                                    <span class="i">WriteObject</span>(<span class="s">&quot;&lt;meta name=\&quot;&quot;</span> + <span class="r21 r">s</span> + <span class="s">&quot;\&quot; content=\&quot;&quot;</span> + <a href="#39665563cd1b97a1" class="i field">_meta</a>[<span class="r21 r">s</span>] + <span class="s">&quot;\&quot;&gt;&quot;</span>);
                                    <b>break</b>;
                                <b>default</b>:
                                    <span class="i">MshCommandRuntime</span> <span id="r22 rd" class="r22 r">mshCommandRuntime</span> = <a href="#a8ef9169c4ea0bc5" class="k">this</a>.<a href="/System.Management.Automation/A.html#fa3830ca3ad4b256" class="i property">CommandRuntime</a> <b>as</b> <span class="i">MshCommandRuntime</span>;
                                    <b>string</b> <span id="r23 rd" class="r23 r">Message</span> = <span class="i">StringUtil</span>.<span class="i">Format</span>(<span class="i">ConvertHTMLStrings</span>.<span class="i">MetaPropertyNotFound</span>, <span class="r21 r">s</span>, <a href="#39665563cd1b97a1" class="i field">_meta</a>[<span class="r21 r">s</span>]);
                                    <a href="/System.Management.Automation/A.html#59cd69dde48b9557" class="t t">WarningRecord</a> <span id="r24 rd" class="r24 r">record</span> = <b>new</b>(<span class="r23 r">Message</span>);
                                    <a href="/System.Management.Automation/A.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r25 rd" class="r25 r">invocationInfo</span> = <span class="i">GetVariableValue</span>(<span class="i">SpecialVariables</span>.<span class="i">MyInvocation</span>) <b>as</b> <a href="/System.Management.Automation/A.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a>;
 
                                    <b>if</b> (<span class="r25 r">invocationInfo</span> != <b>null</b>)
                                    {
                                        <span class="r24 r">record</span>.<span class="i">SetInvocationInfo</span>(<span class="r25 r">invocationInfo</span>);
                                    }
 
                                    <span class="r22 r">mshCommandRuntime</span>.<span class="i">WriteWarning</span>(<span class="r24 r">record</span>);
                                    <span class="i">WriteObject</span>(<span class="s">&quot;&lt;meta name=\&quot;&quot;</span> + <span class="r21 r">s</span> + <span class="s">&quot;\&quot; content=\&quot;&quot;</span> + <a href="#39665563cd1b97a1" class="i field">_meta</a>[<span class="r21 r">s</span>] + <span class="s">&quot;\&quot;&gt;&quot;</span>);
                                    <b>break</b>;
                            }
 
                            <span class="r20 r">useditems</span>.<span class="i">Add</span>(<span class="r21 r">s</span>);
                        }
                    }
                }
 
                <span class="i">WriteObject</span>(<a href="#22a32399329d9303" class="i field">_head</a> ?? <b>new</b> <b>string</b>[] { <span class="s">&quot;&lt;title&gt;&quot;</span> + <a href="#e4a54e0c4843ff2c" class="i field">_title</a> + <span class="s">&quot;&lt;/title&gt;&quot;</span> }, <b>true</b>);
                <b>if</b> (<a href="#083fe9778347494f" class="i field">_cssuriSpecified</a>)
                {
                    <span class="i">WriteObject</span>(<span class="s">&quot;&lt;link rel=\&quot;stylesheet\&quot; type=\&quot;text/css\&quot; href=\&quot;&quot;</span> + <a href="#268342e6cb94a4b9" class="i field">_cssuri</a> + <span class="s">&quot;\&quot; /&gt;&quot;</span>);
                }
 
                <span class="i">WriteObject</span>(<span class="s">&quot;&lt;/head&gt;&lt;body&gt;&quot;</span>);
                <b>if</b> (<a href="#f4a990f40ecc8e50" class="i field">_body</a> != <b>null</b>)
                {
                    <span class="i">WriteObject</span>(<a href="#f4a990f40ecc8e50" class="i field">_body</a>, <b>true</b>);
                }
            }
 
            <b>if</b> (<a href="#9dc54977e41c0917" class="i field">_preContent</a> != <b>null</b>)
            {
                <span class="i">WriteObject</span>(<a href="#9dc54977e41c0917" class="i field">_preContent</a>, <b>true</b>);
            }
 
            <span class="i">WriteObject</span>(<span class="s">&quot;&lt;table&gt;&quot;</span>);
            <a href="#b1fb0df6950e373a" class="i field">_isTHWritten</a> = <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads Width and Alignment from Property and write Col tags.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">mshParams</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="1dfac408e40996ad" href="../../R/1dfac408e40996ad.html" target="n" data-glyph="76,1" class="i method">WriteColumns</a>(<span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <span id="r26 rd" class="r26 r">mshParams</span>)
        {
            <span class="i">StringBuilder</span> <span id="r27 rd" class="r27 r">COLTag</span> = <b>new</b>();
 
            <span class="r27 r">COLTag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;colgroup&gt;&quot;</span>);
            <b>foreach</b> (<span class="i">MshParameter</span> <span id="r28 rd" class="r28 r">p</span> <b>in</b> <span class="r26 r">mshParams</span>)
            {
                <span class="r27 r">COLTag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;col&quot;</span>);
                <b>string</b> <span id="r29 rd" class="r29 r">width</span> = <span class="r28 r">p</span>.<span class="i">GetEntry</span>(<a href="#c2525ecf9e515f8c" class="t t">ConvertHTMLParameterDefinitionKeys</a>.<a href="#76965e73c90c5562" class="i field">WidthEntryKey</a>) <b>as string</b>;
                <b>if</b> (<span class="r29 r">width</span> != <b>null</b>)
                {
                    <span class="r27 r">COLTag</span>.<span class="i">Append</span>(<span class="s">&quot; width = \&quot;&quot;</span>);
                    <span class="r27 r">COLTag</span>.<span class="i">Append</span>(<span class="r29 r">width</span>);
                    <span class="r27 r">COLTag</span>.<span class="i">Append</span>(<span class="s">&#39;&quot;&#39;</span>);
                }
 
                <b>string</b> <span id="r30 rd" class="r30 r">alignment</span> = <span class="r28 r">p</span>.<span class="i">GetEntry</span>(<a href="#c2525ecf9e515f8c" class="t t">ConvertHTMLParameterDefinitionKeys</a>.<a href="#22a1f73b57177357" class="i field">AlignmentEntryKey</a>) <b>as string</b>;
                <b>if</b> (<span class="r30 r">alignment</span> != <b>null</b>)
                {
                    <span class="r27 r">COLTag</span>.<span class="i">Append</span>(<span class="s">&quot; align = \&quot;&quot;</span>);
                    <span class="r27 r">COLTag</span>.<span class="i">Append</span>(<span class="r30 r">alignment</span>);
                    <span class="r27 r">COLTag</span>.<span class="i">Append</span>(<span class="s">&#39;&quot;&#39;</span>);
                }
 
                <span class="r27 r">COLTag</span>.<span class="i">Append</span>(<span class="s">&quot;/&gt;&quot;</span>);
            }
 
            <span class="r27 r">COLTag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/colgroup&gt;&quot;</span>);
 
            <span class="c">// The columngroup and col nodes will be printed in a single line.</span>
            <span class="i">WriteObject</span>(<span class="r27 r">COLTag</span>.<span class="i">ToString</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes the list entries when the As parameter has value List.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="58b0b2fa986b5b40" href="../../R/58b0b2fa986b5b40.html" target="n" data-glyph="76,1" class="i method">WriteListEntry</a>()
        {
            <b>foreach</b> (<span class="i">MshParameter</span> <span id="r31 rd" class="r31 r">p</span> <b>in</b> <a href="#e4d6286820fa1472" class="i field">_resolvedNameMshParameters</a>)
            {
                <span class="i">StringBuilder</span> <span id="r32 rd" class="r32 r">Listtag</span> = <b>new</b>();
                <span class="r32 r">Listtag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span>);
 
                <span class="c">// for writing the property name</span>
                <a href="#8c506f47a3d1f38e" class="i method">WritePropertyName</a>(<span class="r32 r">Listtag</span>, <span class="r31 r">p</span>);
                <span class="r32 r">Listtag</span>.<span class="i">Append</span>(<span class="s">&#39;:&#39;</span>);
                <span class="r32 r">Listtag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/td&gt;&quot;</span>);
 
                <span class="c">// for writing the property value</span>
                <span class="r32 r">Listtag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;td&gt;&quot;</span>);
                <a href="#310c542a9ef986c5" class="i method">WritePropertyValue</a>(<span class="r32 r">Listtag</span>, <span class="r31 r">p</span>);
                <span class="r32 r">Listtag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);
 
                <span class="i">WriteObject</span>(<span class="r32 r">Listtag</span>.<span class="i">ToString</span>());
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> To write the Property name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="8c506f47a3d1f38e" href="../../R/8c506f47a3d1f38e.html" target="n" data-glyph="76,1" class="i method">WritePropertyName</a>(<span class="i">StringBuilder</span> <span id="r33 rd" class="r33 r">Listtag</span>, <span class="i">MshParameter</span> <span id="r34 rd" class="r34 r">p</span>)
        {
            <span class="c">// for writing the property name</span>
            <b>string</b> <span id="r35 rd" class="r35 r">label</span> = <span class="r34 r">p</span>.<span class="i">GetEntry</span>(<a href="#c2525ecf9e515f8c" class="t t">ConvertHTMLParameterDefinitionKeys</a>.<a href="#812b5d9776ff96c0" class="i field">LabelEntryKey</a>) <b>as string</b>;
            <b>if</b> (<span class="r35 r">label</span> != <b>null</b>)
            {
                <span class="r33 r">Listtag</span>.<span class="i">Append</span>(<span class="r35 r">label</span>);
            }
            <b>else</b>
            {
                <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r36 rd" class="r36 r">ex</span> = <span class="r34 r">p</span>.<span class="i">GetEntry</span>(<span class="i">FormatParameterDefinitionKeys</span>.<span class="i">ExpressionEntryKey</span>) <b>as</b> <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a>;
                <span class="r33 r">Listtag</span>.<span class="i">Append</span>(<span class="r36 r">ex</span>.<span class="i">ToString</span>());
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> To write the Property value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="310c542a9ef986c5" href="../../R/310c542a9ef986c5.html" target="n" data-glyph="76,1" class="i method">WritePropertyValue</a>(<span class="i">StringBuilder</span> <span id="r37 rd" class="r37 r">Listtag</span>, <span class="i">MshParameter</span> <span id="r38 rd" class="r38 r">p</span>)
        {
            <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r39 rd" class="r39 r">exValue</span> = <span class="r38 r">p</span>.<span class="i">GetEntry</span>(<span class="i">FormatParameterDefinitionKeys</span>.<span class="i">ExpressionEntryKey</span>) <b>as</b> <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a>;
 
            <span class="c">// get the value of the property</span>
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#32098d49a681ff30" class="t t">PSPropertyExpressionResult</a>&gt; <span id="r40 rd" class="r40 r">resultList</span> = <span class="r39 r">exValue</span>.<span class="i">GetValues</span>(<a href="#d314992c5300b8aa" class="i field">_inputObject</a>);
            <b>foreach</b> (<a href="/System.Management.Automation/A.html#32098d49a681ff30" class="t t">PSPropertyExpressionResult</a> <span id="r41 rd" class="r41 r">result</span> <b>in</b> <span class="r40 r">resultList</span>)
            {
                <span class="c">// create comma sep list for multiple results</span>
                <b>if</b> (<span class="r41 r">result</span>.<a href="/System.Management.Automation/A.html#5ffe7f472d198e60" class="i property">Result</a> != <b>null</b>)
                {
                    <b>string</b> <span id="r42 rd" class="r42 r">htmlEncodedResult</span> = <span class="i">WebUtility</span>.<span class="i">HtmlEncode</span>(<a href="#d7045c38286674b2" class="i method">SafeToString</a>(<span class="r41 r">result</span>.<a href="/System.Management.Automation/A.html#5ffe7f472d198e60" class="i property">Result</a>));
                    <span class="r37 r">Listtag</span>.<span class="i">Append</span>(<span class="r42 r">htmlEncodedResult</span>);
                }
 
                <span class="r37 r">Listtag</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
            }
 
            <b>if</b> (<span class="r37 r">Listtag</span>.<span class="i">ToString</span>().<span class="i">EndsWith</span>(<span class="s">&quot;, &quot;</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
            {
                <span class="r37 r">Listtag</span>.<span class="i">Remove</span>(<span class="r37 r">Listtag</span>.<span class="i">Length</span> - 2, 2);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> To write the Table header for the object property names.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="68474bd12f74ff16" href="../../R/68474bd12f74ff16.html" target="n" data-glyph="76,1" class="i method">WriteTableHeader</a>(<span class="i">StringBuilder</span> <span id="r43 rd" class="r43 r">THtag</span>, <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <span id="r44 rd" class="r44 r">resolvedNameMshParameters</span>)
        {
            <span class="c">// write the property names</span>
            <b>foreach</b> (<span class="i">MshParameter</span> <span id="r45 rd" class="r45 r">p</span> <b>in</b> <span class="r44 r">resolvedNameMshParameters</span>)
            {
                <span class="r43 r">THtag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;th&gt;&quot;</span>);
                <a href="#8c506f47a3d1f38e" class="i method">WritePropertyName</a>(<span class="r43 r">THtag</span>, <span class="r45 r">p</span>);
                <span class="r43 r">THtag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/th&gt;&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> To write the Table row for the object property values.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="656f1b3b70b4a8a5" href="../../R/656f1b3b70b4a8a5.html" target="n" data-glyph="76,1" class="i method">WriteTableRow</a>(<span class="i">StringBuilder</span> <span id="r46 rd" class="r46 r">TRtag</span>, <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <span id="r47 rd" class="r47 r">resolvedNameMshParameters</span>)
        {
            <span class="c">// write the property values</span>
            <b>foreach</b> (<span class="i">MshParameter</span> <span id="r48 rd" class="r48 r">p</span> <b>in</b> <span class="r47 r">resolvedNameMshParameters</span>)
            {
                <span class="r46 r">TRtag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;td&gt;&quot;</span>);
                <a href="#310c542a9ef986c5" class="i method">WritePropertyValue</a>(<span class="r46 r">TRtag</span>, <span class="r48 r">p</span>);
                <span class="r46 r">TRtag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/td&gt;&quot;</span>);
            }
        }
 
        <span class="c">// count of the objects</span>
        <b>private int</b> <a id="222a7e785a957b2e" href="../../R/222a7e785a957b2e.html" target="n" data-glyph="46,1" class="i field">_numberObjects</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="f5158a0d1435406e" href="../../R/f5158a0d1435406e.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <span class="c">// writes the table headers</span>
            <span class="c">// it is not in BeginProcessing because the first inputObject is needed for</span>
            <span class="c">// the number of columns and column name</span>
            <b>if</b> (<a href="#d314992c5300b8aa" class="i field">_inputObject</a> == <b>null</b> || <a href="#d314992c5300b8aa" class="i field">_inputObject</a> == <a href="/System.Management.Automation/A.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="/System.Management.Automation/A.html#1cf7e193da582896" class="i property">Value</a>)
            {
                <b>return</b>;
            }
 
            <a href="#222a7e785a957b2e" class="i field">_numberObjects</a>++;
            <b>if</b> (!<a href="#b1fb0df6950e373a" class="i field">_isTHWritten</a>)
            {
                <a href="#fbefd552164f75b9" class="i method">InitializeResolvedNameMshParameters</a>();
                <b>if</b> (<a href="#e4d6286820fa1472" class="i field">_resolvedNameMshParameters</a> == <b>null</b> || <a href="#e4d6286820fa1472" class="i field">_resolvedNameMshParameters</a>.<span class="i">Count</span> == 0)
                {
                    <b>return</b>;
                }
 
                <span class="c">// if the As parameter is given as List</span>
                <b>if</b> (<a href="#10fc111b5a03e2c8" class="i field">_as</a>.<span class="i">Equals</span>(<span class="s">&quot;List&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="c">// if more than one object,write the horizontal rule to put visual separator</span>
                    <b>if</b> (<a href="#222a7e785a957b2e" class="i field">_numberObjects</a> &gt; 1)
                        <span class="i">WriteObject</span>(<span class="s">&quot;&lt;tr&gt;&lt;td&gt;&lt;hr&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);
                    <a href="#58b0b2fa986b5b40" class="i method">WriteListEntry</a>();
                }
                <b>else</b> <span class="c">// if the As parameter is Table, first we have to write the property names</span>
                {
                    <a href="#1dfac408e40996ad" class="i method">WriteColumns</a>(<a href="#e4d6286820fa1472" class="i field">_resolvedNameMshParameters</a>);
 
                    <span class="i">StringBuilder</span> <span id="r49 rd" class="r49 r">THtag</span> = <b>new</b>(<span class="s">&quot;&lt;tr&gt;&quot;</span>);
 
                    <span class="c">// write the table header</span>
                    <a href="#68474bd12f74ff16" class="i method">WriteTableHeader</a>(<span class="r49 r">THtag</span>, <a href="#e4d6286820fa1472" class="i field">_resolvedNameMshParameters</a>);
 
                    <span class="r49 r">THtag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/tr&gt;&quot;</span>);
                    <span class="i">WriteObject</span>(<span class="r49 r">THtag</span>.<span class="i">ToString</span>());
                    <a href="#b1fb0df6950e373a" class="i field">_isTHWritten</a> = <b>true</b>;
                }
            }
            <span class="c">// if the As parameter is Table, write the property values</span>
            <b>if</b> (<a href="#10fc111b5a03e2c8" class="i field">_as</a>.<span class="i">Equals</span>(<span class="s">&quot;Table&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="i">StringBuilder</span> <span id="r50 rd" class="r50 r">TRtag</span> = <b>new</b>(<span class="s">&quot;&lt;tr&gt;&quot;</span>);
 
                <span class="c">// write the table row</span>
                <a href="#656f1b3b70b4a8a5" class="i method">WriteTableRow</a>(<span class="r50 r">TRtag</span>, <a href="#e4d6286820fa1472" class="i field">_resolvedNameMshParameters</a>);
 
                <span class="r50 r">TRtag</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/tr&gt;&quot;</span>);
                <span class="i">WriteObject</span>(<span class="r50 r">TRtag</span>.<span class="i">ToString</span>());
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="447056ed8913b00e" href="../../R/447056ed8913b00e.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <span class="c">// if fragment,end with table</span>
            <span class="i">WriteObject</span>(<span class="s">&quot;&lt;/table&gt;&quot;</span>);
            <b>if</b> (<a href="#e438edf8950b0bf6" class="i field">_postContent</a> != <b>null</b>)
                <span class="i">WriteObject</span>(<a href="#e438edf8950b0bf6" class="i field">_postContent</a>, <b>true</b>);
 
            <span class="c">// if not fragment end with body and html also</span>
            <b>if</b> (!<a href="#4b7f4104abf58680" class="i field">_fragment</a>)
            {
                <span class="i">WriteObject</span>(<span class="s">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> List of incoming objects to compare.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="b1fb0df6950e373a" href="../../R/b1fb0df6950e373a.html" target="n" data-glyph="46,1" class="i field">_isTHWritten</a>;
        <b>private</b> <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <a id="fc445d921bf7be05" href="../../R/fc445d921bf7be05.html" target="n" data-glyph="46,1" class="i field">_propertyMshParameterList</a>;
        <b>private</b> <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <a id="e4d6286820fa1472" href="../../R/e4d6286820fa1472.html" target="n" data-glyph="46,1" class="i field">_resolvedNameMshParameters</a>;
        <span class="c">// private string ResourcesBaseName = &quot;ConvertHTMLStrings&quot;;</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private
    }
}
</pre></td></tr></table></div></body></html>
