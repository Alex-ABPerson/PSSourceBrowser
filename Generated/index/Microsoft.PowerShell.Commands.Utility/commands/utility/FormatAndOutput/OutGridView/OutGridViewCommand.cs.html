<!DOCTYPE html>
<html><head><title>OutGridViewCommand.cs</title><link rel="stylesheet" href="../../../../../styles.css"><script src="../../../../../scripts.js"></script></head>
<body class="cB" onload="i(497);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility/commands/utility/FormatAndOutput/OutGridView/OutGridViewCommand.cs" target="_top">commands\utility\FormatAndOutput\OutGridView\OutGridViewCommand.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility" target="_top">src\Microsoft.PowerShell.Commands.Utility\Microsoft.PowerShell.Commands.Utility.csproj</a> (Microsoft.PowerShell.Commands.Utility)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Enum for SelectionMode parameter.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="5d3c8ac3c5bbd0c2" href="../../../../R/5d3c8ac3c5bbd0c2.html" target="n" data-glyph="18,0" class="t t"><span id="e389f59379d5b867">OutputModeOption</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> None is the default and it means OK and Cancel will not be present</span>
        <span class="c">///</span><span class="c"> and no objects will be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> The selectionMode of the actual list will still be multiple.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="140683252405eb6c" href="../../../../R/140683252405eb6c.html" target="n" data-glyph="24,1" class="i field">None</a>,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Allow selection of one single item to be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9036d9c8a466b685" href="../../../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Single</a>,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">Allow select of multiple items to be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="01340ef7f570de88" href="../../../../R/01340ef7f570de88.html" target="n" data-glyph="24,1" class="i field">Multiple</a>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implementation for the Out-GridView command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#ced47428947bccb7" class="t t">VerbsData</a>.<a href="/System.Management.Automation/A.html#d2f455ddc4ea47e2" class="i field">Out</a>, <span class="s">&quot;GridView&quot;</span>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;PassThru&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2109378&quot;</span>)]
    <b>public class</b> <a id="0b77e7b1f350f3b7" href="../../../../R/0b77e7b1f350f3b7.html" target="n" data-glyph="0,0" class="t t">OutGridViewCommand</a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <b>private const string</b> <a id="654be68098423bce" href="../../../../R/654be68098423bce.html" target="n" data-glyph="10,1" class="i field">DataNotQualifiedForGridView</a> = <span class="s">&quot;DataNotQualifiedForGridView&quot;</span>;
        <b>private const string</b> <a id="07e6e81e8078ead1" href="../../../../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">RemotingNotSupported</a> = <span class="s">&quot;RemotingNotSupported&quot;</span>;
 
        <b>private</b> <span class="i">TypeInfoDataBase</span> <a id="847375cf941e6aa8" href="../../../../R/847375cf941e6aa8.html" target="n" data-glyph="46,1" class="i field">_typeInfoDataBase</a>;
        <b>private</b> <span class="i">PSPropertyExpressionFactory</span> <a id="75d844cec1bd2597" href="../../../../R/75d844cec1bd2597.html" target="n" data-glyph="46,1" class="i field">_expressionFactory</a>;
        <b>private</b> <a href="OutWindowProxy.cs.html#9e84da11dff68c01" class="t t">OutWindowProxy</a> <a id="6705ea1c52253842" href="../../../../R/6705ea1c52253842.html" target="n" data-glyph="46,1" class="i field">_windowProxy</a>;
        <b>private</b> <a href="#745e97bed1d98705" class="t t">GridHeader</a> <a id="5c3e36e50491f664" href="../../../../R/5c3e36e50491f664.html" target="n" data-glyph="46,1" class="i field">_gridHeader</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#0b77e7b1f350f3b7" class="t t">OutGridViewCommand</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="ed6d34964a6e1442" href="../../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">OutGridViewCommand</a>()
        {
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Input Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This parameter specifies the current pipeline object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="3f7645aa4a8aae3b" href="../../../../R/3f7645aa4a8aae3b.html" target="n" data-glyph="102,1" class="i property">InputObject</a> { <b>get</b>; <b>set</b>; } = <a href="/System.Management.Automation/A.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="/System.Management.Automation/A.html#1cf7e193da582896" class="i property">Value</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets/sets the title of the Out-GridView window.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="3c62f554d4e6b0fe" href="../../../../R/3c62f554d4e6b0fe.html" target="n" data-glyph="102,1" class="i property">Title</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get or sets a value indicating whether the cmdlet should wait for the window to be closed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Wait&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="6645f16456698d65" href="../../../../R/6645f16456698d65.html" target="n" data-glyph="102,1" class="i property">Wait</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get or sets a value indicating whether the selected items should be written to the pipeline</span>
        <span class="c">///</span><span class="c"> and if it should be possible to select multiple or single list items.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;OutputMode&quot;</span>)]
        <b>public</b> <a href="#5d3c8ac3c5bbd0c2" class="t t">OutputModeOption</a> <a id="f935304305c5c47a" href="../../../../R/f935304305c5c47a.html" target="n" data-glyph="102,1" class="i property">OutputMode</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating whether the selected items should be written to the pipeline.</span>
        <span class="c">///</span><span class="c"> Setting this to true is the same as setting the OutputMode to Multiple.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;PassThru&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="4ee33d25a162980b" href="../../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">PassThru</a>
        {
            <b>get</b> { <b>return</b> <a href="#f935304305c5c47a" class="i property">OutputMode</a> == <a href="#5d3c8ac3c5bbd0c2" class="t t">OutputModeOption</a>.<a href="#01340ef7f570de88" class="i field">Multiple</a> ? <b>new</b> <span class="t">SwitchParameter</span>(<b>true</b>) : <b>new</b> <span class="t">SwitchParameter</span>(<b>false</b>); }
 
            <b>set</b> { <a href="#0b77e7b1f350f3b7" class="k">this</a>.<a href="#f935304305c5c47a" class="i property">OutputMode</a> = <b>value</b>.<a href="/System.Management.Automation/A.html#e9c777a85700d3da" class="i property">IsPresent</a> ? <a href="#5d3c8ac3c5bbd0c2" class="t t">OutputModeOption</a>.<a href="#01340ef7f570de88" class="i field">Multiple</a> : <a href="#5d3c8ac3c5bbd0c2" class="t t">OutputModeOption</a>.<a href="#140683252405eb6c" class="i field">None</a>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Input Parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Provides a one-time, pre-processing functionality for the cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="03deae87a96d0283" href="../../../../R/03deae87a96d0283.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <span class="c">// Set up the ExpressionFactory</span>
            <a href="#75d844cec1bd2597" class="i field">_expressionFactory</a> = <b>new</b> <span class="i">PSPropertyExpressionFactory</span>();
 
            <span class="c">// If the value of the Title parameter is valid, use it as a window&#39;s title.</span>
            <b>if</b> (<a href="#0b77e7b1f350f3b7" class="k">this</a>.<a href="#3c62f554d4e6b0fe" class="i property">Title</a> != <b>null</b>)
            {
                <a href="#6705ea1c52253842" class="i field">_windowProxy</a> = <b>new</b> <a href="OutWindowProxy.cs.html#a05c24171fd01bdb" class="t constructor">OutWindowProxy</a>(<a href="#0b77e7b1f350f3b7" class="k">this</a>.<a href="#3c62f554d4e6b0fe" class="i property">Title</a>, <a href="#f935304305c5c47a" class="i property">OutputMode</a>, <a href="#0b77e7b1f350f3b7" class="k">this</a>);
            }
            <b>else</b>
            {
                <span class="c">// Using the command line as a title.</span>
                <a href="#6705ea1c52253842" class="i field">_windowProxy</a> = <b>new</b> <a href="OutWindowProxy.cs.html#a05c24171fd01bdb" class="t constructor">OutWindowProxy</a>(<a href="#0b77e7b1f350f3b7" class="k">this</a>.<a href="/System.Management.Automation/A.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="/System.Management.Automation/A.html#d8a2387de19e4425" class="i property">Line</a>, <a href="#f935304305c5c47a" class="i property">OutputMode</a>, <a href="#0b77e7b1f350f3b7" class="k">this</a>);
            }
 
            <span class="c">// Load the Type info database.</span>
            <a href="#847375cf941e6aa8" class="i field">_typeInfoDataBase</a> = <a href="#0b77e7b1f350f3b7" class="k">this</a>.<span class="i">Context</span>.<span class="i">FormatDBManager</span>.<span class="i">GetTypeInfoDataBase</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Blocks depending on the wait and selected.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="85644b30773209ca" href="../../../../R/85644b30773209ca.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="k">base</a>.<span class="i">EndProcessing</span>();
 
            <b>if</b> (<a href="#6705ea1c52253842" class="i field">_windowProxy</a> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <span class="c">// If -Wait is used or outputMode is not None we have to wait for the window to be closed</span>
            <span class="c">// The pipeline will be blocked while we don&#39;t return</span>
            <b>if</b> (<a href="#0b77e7b1f350f3b7" class="k">this</a>.<a href="#6645f16456698d65" class="i property">Wait</a> || <a href="#0b77e7b1f350f3b7" class="k">this</a>.<a href="#f935304305c5c47a" class="i property">OutputMode</a> != <a href="#5d3c8ac3c5bbd0c2" class="t t">OutputModeOption</a>.<a href="#140683252405eb6c" class="i field">None</a>)
            {
                <a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#4ce3f3c0c45ad1a9" class="i method">BlockUntillClosed</a>();
            }
 
            <span class="c">// Output selected items to pipeline.</span>
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r0 rd" class="r0 r">selectedItems</span> = <a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#9192d6b84099cf4d" class="i method">GetSelectedItems</a>();
            <b>if</b> (<a href="#0b77e7b1f350f3b7" class="k">this</a>.<a href="#f935304305c5c47a" class="i property">OutputMode</a> != <a href="#5d3c8ac3c5bbd0c2" class="t t">OutputModeOption</a>.<a href="#140683252405eb6c" class="i field">None</a> &amp;&amp; <span class="r0 r">selectedItems</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1 rd" class="r1 r">selectedItem</span> <b>in</b> <span class="r0 r">selectedItems</span>)
                {
                    <b>if</b> (<span class="r1 r">selectedItem</span> == <b>null</b>)
                    {
                        <b>continue</b>;
                    }
 
                    <a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r2 rd" class="r2 r">originalObjectProperty</span> = <span class="r1 r">selectedItem</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="OutWindowProxy.cs.html#9e84da11dff68c01" class="t t">OutWindowProxy</a>.<a href="OutWindowProxy.cs.html#40b6ce35a1bd13f2" class="i field">OriginalObjectPropertyName</a>];
                    <b>if</b> (<span class="r2 r">originalObjectProperty</span> == <b>null</b>)
                    {
                        <b>return</b>;
                    }
 
                    <a href="#0b77e7b1f350f3b7" class="k">this</a>.<span class="i">WriteObject</span>(<span class="r2 r">originalObjectProperty</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>, <b>false</b>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Provides a record-by-record processing functionality for the cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="57067db8b486dd44" href="../../../../R/57067db8b486dd44.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#3f7645aa4a8aae3b" class="i property">InputObject</a> == <b>null</b> || <a href="#3f7645aa4a8aae3b" class="i property">InputObject</a> == <a href="/System.Management.Automation/A.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="/System.Management.Automation/A.html#1cf7e193da582896" class="i property">Value</a>)
            {
                <b>return</b>;
            }
 
            <span class="i">IDictionary</span> <span id="r3 rd" class="r3 r">dictionary</span> = <a href="#3f7645aa4a8aae3b" class="i property">InputObject</a>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as</b> <span class="i">IDictionary</span>;
            <b>if</b> (<span class="r3 r">dictionary</span> != <b>null</b>)
            {
                <span class="c">// Dictionaries should be enumerated through because the pipeline does not enumerate through them.</span>
                <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r4 rd" class="r4 r">entry</span> <b>in</b> <span class="r3 r">dictionary</span>)
                {
                    <a href="#f704c3ce8df7adaa" class="i method">ProcessObject</a>(<span class="i">PSObjectHelper</span>.<span class="i">AsPSObject</span>(<span class="r4 r">entry</span>));
                }
            }
            <b>else</b>
            {
                <a href="#f704c3ce8df7adaa" class="i method">ProcessObject</a>(<a href="#3f7645aa4a8aae3b" class="i property">InputObject</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopProcessing is called close the window when Ctrl+C in the command prompt.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="46cc97d5b4a90f2a" href="../../../../R/46cc97d5b4a90f2a.html" target="n" data-glyph="75,1" class="i method">StopProcessing</a>()
        {
            <b>if</b> (<a href="#0b77e7b1f350f3b7" class="k">this</a>.<a href="#6645f16456698d65" class="i property">Wait</a> || <a href="#0b77e7b1f350f3b7" class="k">this</a>.<a href="#f935304305c5c47a" class="i property">OutputMode</a> != <a href="#5d3c8ac3c5bbd0c2" class="t t">OutputModeOption</a>.<a href="#140683252405eb6c" class="i field">None</a>)
            {
                <a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#8ccf431ab45e2915" class="i method">CloseWindow</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts the provided PSObject to a string preserving PowerShell formatting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">liveObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSObject to be converted to a string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="17918f31e60c7c1d" href="../../../../R/17918f31e60c7c1d.html" target="n" data-glyph="74,1" class="i method">ConvertToString</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r5 rd" class="r5 r">liveObject</span>)
        {
            <span class="i">StringFormatError</span> <span id="r6 rd" class="r6 r">formatErrorObject</span> = <b>new</b>();
            <b>string</b> <span id="r7 rd" class="r7 r">smartToString</span> = <span class="i">PSObjectHelper</span>.<span class="i">SmartToString</span>(<span class="r5 r">liveObject</span>,
                                                                <a href="#75d844cec1bd2597" class="i field">_expressionFactory</a>,
                                                                <span class="i">InnerFormatShapeCommand</span>.<span class="i">FormatEnumerationLimit</span>(),
                                                                <span class="r6 r">formatErrorObject</span>);
            <b>if</b> (<span class="r6 r">formatErrorObject</span>.<span class="i">exception</span> != <b>null</b>)
            {
                <span class="c">// There was a formatting error that should be sent to the console.</span>
                <a href="#0b77e7b1f350f3b7" class="k">this</a>.<span class="i">WriteError</span>(
                    <b>new</b> <span class="t">ErrorRecord</span>(
                        <span class="r6 r">formatErrorObject</span>.<span class="i">exception</span>,
                        <span class="s">&quot;ErrorFormattingType&quot;</span>,
                        <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#f33f25c3453e2e98" class="i field">InvalidResult</a>,
                        <span class="r5 r">liveObject</span>)
                    );
            }
 
            <b>return</b> <span class="r7 r">smartToString</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public Methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Execute formatting on a single object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">input</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="f704c3ce8df7adaa" href="../../../../R/f704c3ce8df7adaa.html" target="n" data-glyph="76,1" class="i method">ProcessObject</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r8 rd" class="r8 r">input</span>)
        {
            <span class="c">// Make sure the OGV window is not closed.</span>
            <b>if</b> (<a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#366ef7616bbe6e8d" class="i method">IsWindowClosed</a>())
            {
                <span class="i">LocalPipeline</span> <span id="r9 rd" class="r9 r">pipeline</span> = (<span class="i">LocalPipeline</span>)<a href="#0b77e7b1f350f3b7" class="k">this</a>.<span class="i">Context</span>.<span class="i">CurrentRunspace</span>.<span class="i">GetCurrentlyRunningPipeline</span>();
 
                <b>if</b> (<span class="r9 r">pipeline</span> != <b>null</b> &amp;&amp; !<span class="r9 r">pipeline</span>.<span class="i">IsStopping</span>)
                {
                    <span class="c">// Stop the pipeline cleanly.</span>
                    <span class="r9 r">pipeline</span>.<span class="i">StopAsync</span>();
                }
 
                <b>return</b>;
            }
 
            <b>object</b> <span id="r10 rd" class="r10 r">baseObject</span> = <span class="r8 r">input</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a>;
 
            <span class="c">// Throw a terminating error for types that are not supported.</span>
            <b>if</b> (<span class="r10 r">baseObject</span> <b>is</b> <a href="/System.Management.Automation/A.html#eea83b421baeaca4" class="t t">ScriptBlock</a> ||
                <span class="r10 r">baseObject</span> <b>is</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> ||
                <span class="r10 r">baseObject</span> <b>is</b> <a href="/System.Management.Automation/A.html#7363a2660b89f253" class="t t">PSReference</a> ||
                <span class="r10 r">baseObject</span> <b>is</b> <span class="i">FormatInfoData</span> ||
                <span class="r10 r">baseObject</span> <b>is</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r11 rd" class="r11 r">error</span> = <b>new</b>(
                    <b>new</b> <span class="i">FormatException</span>(<span class="i">StringUtil</span>.<span class="i">Format</span>(<span class="i">FormatAndOut_out_gridview</span>.<span class="i">DataNotQualifiedForGridView</span>)),
                    <a href="#654be68098423bce" class="i field">DataNotQualifiedForGridView</a>,
                    <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#d213d05331eaaec6" class="i field">InvalidType</a>,
                    <b>null</b>);
 
                <a href="#0b77e7b1f350f3b7" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="r11 r">error</span>);
            }
 
            <b>if</b> (<a href="#5c3e36e50491f664" class="i field">_gridHeader</a> == <b>null</b>)
            {
                <span class="c">// Columns have not been added yet; Start the main window and add columns.</span>
                <a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#1175f55d24976144" class="i method">ShowWindow</a>();
                <a href="#5c3e36e50491f664" class="i field">_gridHeader</a> = <a href="#745e97bed1d98705" class="t t">GridHeader</a>.<a href="#c0ac641e2f6fc9dc" class="i method">ConstructGridHeader</a>(<span class="r8 r">input</span>, <a href="#0b77e7b1f350f3b7" class="k">this</a>);
            }
            <b>else</b>
            {
                <a href="#5c3e36e50491f664" class="i field">_gridHeader</a>.<a href="#804b13becaab2642" class="i method">ProcessInputObject</a>(<span class="r8 r">input</span>);
            }
 
            <span class="c">// Some thread synchronization needed.</span>
            <span class="i">Exception</span> <span id="r12 rd" class="r12 r">exception</span> = <a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#7fdb426cb393e0e5" class="i method">GetLastException</a>();
            <b>if</b> (<span class="r12 r">exception</span> != <b>null</b>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r13 rd" class="r13 r">error</span> = <b>new</b>(
                    <span class="r12 r">exception</span>,
                    <span class="s">&quot;ManagementListInvocationException&quot;</span>,
                    <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#9aa2436d61de1f73" class="i field">OperationStopped</a>,
                    <b>null</b>);
 
                <a href="#0b77e7b1f350f3b7" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="r13 r">error</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Private Methods
 
        <b>internal abstract class</b> <a id="745e97bed1d98705" href="../../../../R/745e97bed1d98705.html" target="n" data-glyph="2,1" class="t t">GridHeader</a>
        {
            <b>protected</b> <a href="#0b77e7b1f350f3b7" class="t t">OutGridViewCommand</a> <a id="4102d1e53c889cdd" href="../../../../R/4102d1e53c889cdd.html" target="n" data-glyph="45,2" class="i field">parentCmd</a>;
 
            <b>internal</b> <a id="418d419e03ee4017" href="../../../../R/418d419e03ee4017.html" target="n" data-glyph="74,2" class="t constructor">GridHeader</a>(<a href="#0b77e7b1f350f3b7" class="t t">OutGridViewCommand</a> <span id="r14 rd" class="r14 r">parentCmd</span>)
            {
                <a href="#745e97bed1d98705" class="k">this</a>.<a href="#4102d1e53c889cdd" class="i field">parentCmd</a> = <span class="r14 r">parentCmd</span>;
            }
 
            <b>internal static</b> <a href="#745e97bed1d98705" class="t t">GridHeader</a> <a id="c0ac641e2f6fc9dc" href="../../../../R/c0ac641e2f6fc9dc.html" target="n" data-glyph="74,2" class="i method">ConstructGridHeader</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r15 rd" class="r15 r">input</span>, <a href="#0b77e7b1f350f3b7" class="t t">OutGridViewCommand</a> <span id="r16 rd" class="r16 r">parentCmd</span>)
            {
                <b>if</b> (<span class="i">DefaultScalarTypes</span>.<span class="i">IsTypeInList</span>(<span class="r15 r">input</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>) ||
                    !<span class="i">OutOfBandFormatViewManager</span>.<span class="i">HasNonRemotingProperties</span>(<span class="r15 r">input</span>))
                {
                    <b>return</b> <b>new</b> <a href="#682621c5d1219159" class="t constructor">ScalarTypeHeader</a>(<span class="r16 r">parentCmd</span>, <span class="r15 r">input</span>);
                }
 
                <b>return</b> <b>new</b> <a href="#63da9c19c605a7b8" class="t constructor">NonscalarTypeHeader</a>(<span class="r16 r">parentCmd</span>, <span class="r15 r">input</span>);
            }
 
            <b>internal abstract void</b> <a id="804b13becaab2642" href="../../../../R/804b13becaab2642.html" target="n" data-glyph="74,2" class="i method">ProcessInputObject</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r17 rd" class="r17 r">input</span>);
        }
 
        <b>internal class</b> <a id="79990e8d91035fd0" href="../../../../R/79990e8d91035fd0.html" target="n" data-glyph="2,1" class="t t">ScalarTypeHeader</a> : <a href="#745e97bed1d98705" class="t t">GridHeader</a>
        {
            <b>private readonly</b> <span class="i">Type</span> <a id="b6623d7f1cd26ecf" href="../../../../R/b6623d7f1cd26ecf.html" target="n" data-glyph="46,2" class="i field">_originalScalarType</a>;
 
            <b>internal</b> <a id="682621c5d1219159" href="../../../../R/682621c5d1219159.html" target="n" data-glyph="74,2" class="t constructor">ScalarTypeHeader</a>(<a href="#0b77e7b1f350f3b7" class="t t">OutGridViewCommand</a> <span id="r18 rd" class="r18 r">parentCmd</span>, <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r19 rd" class="r19 r">input</span>) : <a href="#418d419e03ee4017" class="k">base</a>(<span class="r18 r">parentCmd</span>)
            {
                <a href="#b6623d7f1cd26ecf" class="i field">_originalScalarType</a> = <span class="r19 r">input</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a>.<span class="i">GetType</span>();
 
                <span class="c">// On scalar types the type name is used as a column name.</span>
                <a href="#79990e8d91035fd0" class="k">this</a>.<a href="#4102d1e53c889cdd" class="i field">parentCmd</a>.<a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#92cbc7161bd92b40" class="i method">AddColumnsAndItem</a>(<span class="r19 r">input</span>);
            }
 
            <b>internal override void</b> <a id="dc3e3d1bc62b10a0" href="../../../../R/dc3e3d1bc62b10a0.html" target="n" data-glyph="74,2" class="i method">ProcessInputObject</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r20 rd" class="r20 r">input</span>)
            {
                <b>if</b> (!<a href="#b6623d7f1cd26ecf" class="i field">_originalScalarType</a>.<span class="i">Equals</span>(<span class="r20 r">input</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a>.<span class="i">GetType</span>()))
                {
                    <a href="#4102d1e53c889cdd" class="i field">parentCmd</a>.<a href="#5c3e36e50491f664" class="i field">_gridHeader</a> = <b>new</b> <a href="#16a3085f6583d45e" class="t constructor">HeteroTypeHeader</a>(<a href="#745e97bed1d98705" class="k">base</a>.<a href="#4102d1e53c889cdd" class="i field">parentCmd</a>, <span class="r20 r">input</span>);
                }
                <b>else</b>
                {
                    <span class="c">// Columns are already added; Add the input PSObject as an item to the underlying Management List.</span>
                    <a href="#745e97bed1d98705" class="k">base</a>.<a href="#4102d1e53c889cdd" class="i field">parentCmd</a>.<a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#a6958fa879c5723f" class="i method">AddItem</a>(<span class="r20 r">input</span>);
                }
            }
        }
 
        <b>internal class</b> <a id="e482204ca06447a8" href="../../../../R/e482204ca06447a8.html" target="n" data-glyph="2,1" class="t t">NonscalarTypeHeader</a> : <a href="#745e97bed1d98705" class="t t">GridHeader</a>
        {
            <b>private readonly</b> <span class="i">AppliesTo</span> <a id="10b8de7347811a3a" href="../../../../R/10b8de7347811a3a.html" target="n" data-glyph="46,2" class="i field">_appliesTo</a> = <b>null</b>;
 
            <b>internal</b> <a id="63da9c19c605a7b8" href="../../../../R/63da9c19c605a7b8.html" target="n" data-glyph="74,2" class="t constructor">NonscalarTypeHeader</a>(<a href="#0b77e7b1f350f3b7" class="t t">OutGridViewCommand</a> <span id="r21 rd" class="r21 r">parentCmd</span>, <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r22 rd" class="r22 r">input</span>) : <a href="#418d419e03ee4017" class="k">base</a>(<span class="r21 r">parentCmd</span>)
            {
                <span class="c">// Prepare a table view.</span>
                <a href="TableView.cs.html#3b22c5efb148409b" class="t t">TableView</a> <span id="r23 rd" class="r23 r">tableView</span> = <b>new</b>();
                <span class="r23 r">tableView</span>.<a href="TableView.cs.html#79a4e5441448133e" class="i method">Initialize</a>(<span class="r21 r">parentCmd</span>.<a href="#75d844cec1bd2597" class="i field">_expressionFactory</a>, <span class="r21 r">parentCmd</span>.<a href="#847375cf941e6aa8" class="i field">_typeInfoDataBase</a>);
 
                <span class="c">// Request a view definition from the type database.</span>
                <span class="i">ViewDefinition</span> <span id="r24 rd" class="r24 r">viewDefinition</span> = <span class="i">DisplayDataQuery</span>.<span class="i">GetViewByShapeAndType</span>(<span class="r21 r">parentCmd</span>.<a href="#75d844cec1bd2597" class="i field">_expressionFactory</a>, <span class="r21 r">parentCmd</span>.<a href="#847375cf941e6aa8" class="i field">_typeInfoDataBase</a>, <span class="i">FormatShape</span>.<span class="i">Table</span>, <span class="r22 r">input</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>, <b>null</b>);
                <b>if</b> (<span class="r24 r">viewDefinition</span> != <b>null</b>)
                {
                    <span class="c">// Create a header using a view definition provided by the types database.</span>
                    <span class="r21 r">parentCmd</span>.<a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#3db2c6751411635a" class="i method">AddColumnsAndItem</a>(<span class="r22 r">input</span>, <span class="r23 r">tableView</span>, (<span class="i">TableControlBody</span>)<span class="r24 r">viewDefinition</span>.<span class="i">mainControl</span>);
 
                    <span class="c">// Remember all type names and type groups the current view applies to.</span>
                    <a href="#10b8de7347811a3a" class="i field">_appliesTo</a> = <span class="r24 r">viewDefinition</span>.<span class="i">appliesTo</span>;
                }
                <b>else</b>
                {
                    <span class="c">// Create a header using only the input object&#39;s properties.</span>
                    <span class="r21 r">parentCmd</span>.<a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#90674090763840ce" class="i method">AddColumnsAndItem</a>(<span class="r22 r">input</span>, <span class="r23 r">tableView</span>);
                    <a href="#10b8de7347811a3a" class="i field">_appliesTo</a> = <b>new</b> <span class="i">AppliesTo</span>();
 
                    <span class="c">// Add all type names except for Object and MarshalByRefObject types because they are too generic.</span>
                    <span class="c">// Leave the Object type name if it is the only type name.</span>
                    <b>int</b> <span id="r25 rd" class="r25 r">index</span> = 0;
                    <b>foreach</b> (<b>string</b> <span id="r26 rd" class="r26 r">typeName</span> <b>in</b> <span class="r22 r">input</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>)
                    {
                        <b>if</b> (<span class="r25 r">index</span> &gt; 0 &amp;&amp; (<span class="r26 r">typeName</span>.<span class="i">Equals</span>(<b>typeof</b>(<b>object</b>).<span class="i">FullName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                            <span class="r26 r">typeName</span>.<span class="i">Equals</span>(<b>typeof</b>(<span class="i">MarshalByRefObject</span>).<span class="i">FullName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                        {
                            <b>break</b>;
                        }
 
                        <a href="#10b8de7347811a3a" class="i field">_appliesTo</a>.<span class="i">AddAppliesToType</span>(<span class="r26 r">typeName</span>);
                        <span class="r25 r">index</span>++;
                    }
                }
            }
 
            <b>internal override void</b> <a id="8562303626811ee9" href="../../../../R/8562303626811ee9.html" target="n" data-glyph="74,2" class="i method">ProcessInputObject</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r27 rd" class="r27 r">input</span>)
            {
                <span class="c">// Find out if the input has matching types in the this.appliesTo collection.</span>
                <b>foreach</b> (<span class="i">TypeOrGroupReference</span> <span id="r28 rd" class="r28 r">typeOrGroupRef</span> <b>in</b> <a href="#10b8de7347811a3a" class="i field">_appliesTo</a>.<span class="i">referenceList</span>)
                {
                    <b>if</b> (<span class="r28 r">typeOrGroupRef</span> <b>is</b> <span class="i">TypeReference</span>)
                    {
                        <span class="c">// Add deserialization prefix.</span>
                        <b>string</b> <span id="r29 rd" class="r29 r">deserializedTypeName</span> = <span class="r28 r">typeOrGroupRef</span>.<span class="i">name</span>;
                        <span class="i">Deserializer</span>.<span class="i">AddDeserializationPrefix</span>(<b>ref</b> <span class="r29 r">deserializedTypeName</span>);
 
                        <b>for</b> (<b>int</b> <span id="r30 rd" class="r30 r">i</span> = 0; <span class="r30 r">i</span> &lt; <span class="r27 r">input</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Count</span>; <span class="r30 r">i</span>++)
                        {
                            <b>if</b> (<span class="r28 r">typeOrGroupRef</span>.<span class="i">name</span>.<span class="i">Equals</span>(<span class="r27 r">input</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>[<span class="r30 r">i</span>], <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                                || <span class="r29 r">deserializedTypeName</span>.<span class="i">Equals</span>(<span class="r27 r">input</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>[<span class="r30 r">i</span>], <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="c">// Current view supports the input&#39;s Type;</span>
                                <span class="c">// Add the input PSObject as an item to the underlying Management List.</span>
                                <a href="#745e97bed1d98705" class="k">base</a>.<a href="#4102d1e53c889cdd" class="i field">parentCmd</a>.<a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#a6958fa879c5723f" class="i method">AddItem</a>(<span class="r27 r">input</span>);
                                <b>return</b>;
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <span class="c">// Find out if the input&#39;s Type belongs to the current TypeGroup.</span>
                        <span class="c">// TypeGroupReference has only a group&#39;s name, so use the database to get through all actual TypeGroup&#39;s.</span>
                        <span class="i">List</span>&lt;<span class="i">TypeGroupDefinition</span>&gt; <span id="r31 rd" class="r31 r">typeGroupList</span> = <a href="#745e97bed1d98705" class="k">base</a>.<a href="#4102d1e53c889cdd" class="i field">parentCmd</a>.<a href="#847375cf941e6aa8" class="i field">_typeInfoDataBase</a>.<span class="i">typeGroupSection</span>.<span class="i">typeGroupDefinitionList</span>;
                        <b>foreach</b> (<span class="i">TypeGroupDefinition</span> <span id="r32 rd" class="r32 r">typeGroup</span> <b>in</b> <span class="r31 r">typeGroupList</span>)
                        {
                            <b>if</b> (<span class="r32 r">typeGroup</span>.<span class="i">name</span>.<span class="i">Equals</span>(<span class="r28 r">typeOrGroupRef</span>.<span class="i">name</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="c">// A matching TypeGroup is found in the database.</span>
                                <span class="c">// Find out if the input&#39;s Type belongs to this TypeGroup.</span>
                                <b>foreach</b> (<span class="i">TypeReference</span> <span id="r33 rd" class="r33 r">typeRef</span> <b>in</b> <span class="r32 r">typeGroup</span>.<span class="i">typeReferenceList</span>)
                                {
                                    <span class="c">// Add deserialization prefix.</span>
                                    <b>string</b> <span id="r34 rd" class="r34 r">deserializedTypeName</span> = <span class="r33 r">typeRef</span>.<span class="i">name</span>;
                                    <span class="i">Deserializer</span>.<span class="i">AddDeserializationPrefix</span>(<b>ref</b> <span class="r34 r">deserializedTypeName</span>);
 
                                    <b>if</b> (<span class="r27 r">input</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Count</span> &gt; 0
                                        &amp;&amp; (<span class="r33 r">typeRef</span>.<span class="i">name</span>.<span class="i">Equals</span>(<span class="r27 r">input</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>[0], <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                                            || <span class="r34 r">deserializedTypeName</span>.<span class="i">Equals</span>(<span class="r27 r">input</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>[0], <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                                    {
                                        <span class="c">// Current view supports the input&#39;s Type;</span>
                                        <span class="c">// Add the input PSObject as an item to the underlying Management List.</span>
                                        <a href="#745e97bed1d98705" class="k">base</a>.<a href="#4102d1e53c889cdd" class="i field">parentCmd</a>.<a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#a6958fa879c5723f" class="i method">AddItem</a>(<span class="r27 r">input</span>);
                                        <b>return</b>;
                                    }
                                }
                            }
                        }
                    }
                }
 
                <span class="c">// The input&#39;s Type is not supported by the current view;</span>
                <span class="c">// Switch to the Hetero Type view.</span>
                <a href="#4102d1e53c889cdd" class="i field">parentCmd</a>.<a href="#5c3e36e50491f664" class="i field">_gridHeader</a> = <b>new</b> <a href="#16a3085f6583d45e" class="t constructor">HeteroTypeHeader</a>(<a href="#745e97bed1d98705" class="k">base</a>.<a href="#4102d1e53c889cdd" class="i field">parentCmd</a>, <span class="r27 r">input</span>);
            }
        }
 
        <b>internal class</b> <a id="baa9cc26b50c685e" href="../../../../R/baa9cc26b50c685e.html" target="n" data-glyph="2,1" class="t t">HeteroTypeHeader</a> : <a href="#745e97bed1d98705" class="t t">GridHeader</a>
        {
            <b>internal</b> <a id="16a3085f6583d45e" href="../../../../R/16a3085f6583d45e.html" target="n" data-glyph="74,2" class="t constructor">HeteroTypeHeader</a>(<a href="#0b77e7b1f350f3b7" class="t t">OutGridViewCommand</a> <span id="r35 rd" class="r35 r">parentCmd</span>, <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r36 rd" class="r36 r">input</span>) : <a href="#418d419e03ee4017" class="k">base</a>(<span class="r35 r">parentCmd</span>)
            {
                <span class="c">// Clear all existed columns and add Type and Value columns.</span>
                <a href="#baa9cc26b50c685e" class="k">this</a>.<a href="#4102d1e53c889cdd" class="i field">parentCmd</a>.<a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#24c338f44f526541" class="i method">AddHeteroViewColumnsAndItem</a>(<span class="r36 r">input</span>);
            }
 
            <b>internal override void</b> <a id="672b02f55d5b86cc" href="../../../../R/672b02f55d5b86cc.html" target="n" data-glyph="74,2" class="i method">ProcessInputObject</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r37 rd" class="r37 r">input</span>)
            {
                <a href="#baa9cc26b50c685e" class="k">this</a>.<a href="#4102d1e53c889cdd" class="i field">parentCmd</a>.<a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#84830a6f1a952440" class="i method">AddHeteroViewItem</a>(<span class="r37 r">input</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implements IDisposable logic.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">isDisposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if being called from Dispose.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="47da9807bfe22453" href="../../../../R/47da9807bfe22453.html" target="n" data-glyph="76,1" class="i method">Dispose</a>(<b>bool</b> <span id="r38 rd" class="r38 r">isDisposing</span>)
        {
            <b>if</b> (<span class="r38 r">isDisposing</span>)
            {
                <b>if</b> (<a href="#6705ea1c52253842" class="i field">_windowProxy</a> != <b>null</b>)
                {
                    <a href="#6705ea1c52253842" class="i field">_windowProxy</a>.<a href="OutWindowProxy.cs.html#08e53d435110d42b" class="i method">Dispose</a>();
                    <a href="#6705ea1c52253842" class="i field">_windowProxy</a> = <b>null</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose method in IDisposable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="c507941ab643b432" href="../../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#0b77e7b1f350f3b7" class="k">this</a>.<a href="#47da9807bfe22453" class="i method">Dispose</a>(<b>true</b>);
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#0b77e7b1f350f3b7" class="k">this</a>);
        }
    }
}
</pre></td></tr></table></div></body></html>
