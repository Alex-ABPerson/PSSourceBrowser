<!DOCTYPE html>
<html><head><title>XmlCommands.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(1236);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility/commands/utility/XmlCommands.cs" target="_top">commands\utility\XmlCommands.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility" target="_top">src\Microsoft.PowerShell.Commands.Utility\Microsoft.PowerShell.Commands.Utility.csproj</a> (Microsoft.PowerShell.Commands.Utility)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Xml</span>;
<b>using</b> <span class="i">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i">Diagnostics</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implementation for the Export-Clixml command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#ced47428947bccb7" class="t t">VerbsData</a>.<a href="/System.Management.Automation/A.html#b9aa6c12c628301b" class="i field">Export</a>, <span class="s">&quot;Clixml&quot;</span>, <span class="i">SupportsShouldProcess</span> = <b>true</b>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;ByPath&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096926&quot;</span>)]
    <b>public sealed class</b> <a id="aed440e39d7743c7" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="1c396459a45b946e">ExportClixmlCommand</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Line Parameters
 
        <span class="c">// If a Passthru parameter is added, the SupportsShouldProcess</span>
        <span class="c">// implementation will need to be modified.</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Depth of serialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateRange</span>(1, <b>int</b>.<span class="i">MaxValue</span>)]
        <b>public int</b> <a id="1e7aeea2edc99010" href="../../R/1e7aeea2edc99010.html" target="n" data-glyph="102,1" class="i property">Depth</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Mandatory file name to write to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ByPath&quot;</span>)]
        <b>public string</b> <a id="7151ad9f4ecc7caf" href="../../R/7151ad9f4ecc7caf.html" target="n" data-glyph="102,1" class="i property">Path</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Mandatory file name to write to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ByLiteralPath&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b> <a id="3a4d00e3b3776146" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#7151ad9f4ecc7caf" class="i property">Path</a>;
            }
 
            <b>set</b>
            {
                <a href="#7151ad9f4ecc7caf" class="i property">Path</a> = <b>value</b>;
                <a href="#cc632a86620d1774" class="i field">_isLiteralPath</a> = <b>true</b>;
            }
        }
 
        <b>private bool</b> <a id="cc632a86620d1774" href="../../R/cc632a86620d1774.html" target="n" data-glyph="46,1" class="i field">_isLiteralPath</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Input object to be exported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">AllowNull</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="b203fdead1ecb022" href="../../R/b203fdead1ecb022.html" target="n" data-glyph="102,1" class="i property">InputObject</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property that sets force parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="e76fe88cf00533e2" href="../../R/e76fe88cf00533e2.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ff8fde8a5d52de01" class="i field">_force</a>;
            }
 
            <b>set</b>
            {
                <a href="#ff8fde8a5d52de01" class="i field">_force</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b> <a id="ff8fde8a5d52de01" href="../../R/ff8fde8a5d52de01.html" target="n" data-glyph="46,1" class="i field">_force</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property that prevents file overwrite.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;NoOverwrite&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="7999b7a5d6ab9db0" href="../../R/7999b7a5d6ab9db0.html" target="n" data-glyph="102,1" class="i property">NoClobber</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a3090d1f63c1ec79" class="i field">_noclobber</a>;
            }
 
            <b>set</b>
            {
                <a href="#a3090d1f63c1ec79" class="i field">_noclobber</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b> <a id="a3090d1f63c1ec79" href="../../R/a3090d1f63c1ec79.html" target="n" data-glyph="46,1" class="i field">_noclobber</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Encoding optional flag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ArgumentToEncodingTransformationAttribute</span>()]
        [<span class="i">ArgumentEncodingCompletionsAttribute</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Encoding</span> <a id="bd73ab9118bfd59e" href="../../R/bd73ab9118bfd59e.html" target="n" data-glyph="102,1" class="i property">Encoding</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#38a6f6a09c49241c" class="i field">_encoding</a>;
            }
 
            <b>set</b>
            {
                <span class="i">EncodingConversion</span>.<span class="i">WarnIfObsolete</span>(<a href="#aed440e39d7743c7" class="k">this</a>, <b>value</b>);
                <a href="#38a6f6a09c49241c" class="i field">_encoding</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">Encoding</span> <a id="38a6f6a09c49241c" href="../../R/38a6f6a09c49241c.html" target="n" data-glyph="46,1" class="i field">_encoding</a> = <span class="i">ClrFacade</span>.<span class="i">GetDefaultEncoding</span>();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command Line Parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> BeginProcessing override.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override
        void</b>
        <a id="0f7739a1a1ab2eca" href="../../R/0f7739a1a1ab2eca.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="#5a3756e1be65e696" class="i method">CreateFileStream</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override
        void</b>
        <a id="07fb55d646d5c509" href="../../R/07fb55d646d5c509.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#86e97db32bf9aaf9" class="i field">_serializer</a> != <b>null</b>)
            {
                <a href="#86e97db32bf9aaf9" class="i field">_serializer</a>.<span class="i">Serialize</span>(<a href="#b203fdead1ecb022" class="i property">InputObject</a>);
                <a href="#dd4b56daa8ab3dda" class="i field">_xw</a>.<span class="i">Flush</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override
        void</b>
        <a id="9c531f1dce1a4dee" href="../../R/9c531f1dce1a4dee.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <b>if</b> (<a href="#86e97db32bf9aaf9" class="i field">_serializer</a> != <b>null</b>)
            {
                <a href="#86e97db32bf9aaf9" class="i field">_serializer</a>.<span class="i">Done</span>();
                <a href="#86e97db32bf9aaf9" class="i field">_serializer</a> = <b>null</b>;
            }
 
            <a href="#28aace381ec8dd9b" class="i method">CleanUp</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="8fdf5d7b7ccc4907" href="../../R/8fdf5d7b7ccc4907.html" target="n" data-glyph="75,1" class="i method">StopProcessing</a>()
        {
            <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="k">base</a>.<span class="i">StopProcessing</span>();
            <a href="#86e97db32bf9aaf9" class="i field">_serializer</a>.<span class="i">Stop</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Overrides
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> file
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle to file stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">FileStream</span> <a id="0843a0221cef29d3" href="../../R/0843a0221cef29d3.html" target="n" data-glyph="46,1" class="i field">_fs</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stream writer used to write to file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">XmlWriter</span> <a id="dd4b56daa8ab3dda" href="../../R/dd4b56daa8ab3dda.html" target="n" data-glyph="46,1" class="i field">_xw</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializer used for serialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Serializer</span> <a id="86e97db32bf9aaf9" href="../../R/86e97db32bf9aaf9.html" target="n" data-glyph="46,1" class="i field">_serializer</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> FileInfo of file to clear read-only flag when operation is complete.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">FileInfo</span> <a id="18e99e575e061a86" href="../../R/18e99e575e061a86.html" target="n" data-glyph="46,1" class="i field">_readOnlyFileInfo</a> = <b>null</b>;
 
        <b>private void</b> <a id="5a3756e1be65e696" href="../../R/5a3756e1be65e696.html" target="n" data-glyph="76,1" class="i method">CreateFileStream</a>()
        {
            <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<a href="#7151ad9f4ecc7caf" class="i property">Path</a> != <b>null</b>, <span class="s">&quot;FileName is mandatory parameter&quot;</span>);
 
            <b>if</b> (!<span class="i">ShouldProcess</span>(<a href="#7151ad9f4ecc7caf" class="i property">Path</a>)) <b>return</b>;
 
            <span class="i">StreamWriter</span> <span id="r0 rd" class="r0 r">sw</span>;
            <span class="i">PathUtils</span>.<span class="i">MasterStreamOpen</span>(
                <a href="#aed440e39d7743c7" class="k">this</a>,
                <a href="#aed440e39d7743c7" class="k">this</a>.<a href="#7151ad9f4ecc7caf" class="i property">Path</a>,
                <a href="#aed440e39d7743c7" class="k">this</a>.<a href="#bd73ab9118bfd59e" class="i property">Encoding</a>,
                <b>false</b>, <span class="c">// default encoding</span>
                <b>false</b>, <span class="c">// append</span>
                <a href="#aed440e39d7743c7" class="k">this</a>.<a href="#e76fe88cf00533e2" class="i property">Force</a>,
                <a href="#aed440e39d7743c7" class="k">this</a>.<a href="#7999b7a5d6ab9db0" class="i property">NoClobber</a>,
                <b>out</b> <a href="#0843a0221cef29d3" class="i field">_fs</a>,
                <b>out</b> <span class="r0 r">sw</span>,
                <b>out</b> <a href="#18e99e575e061a86" class="i field">_readOnlyFileInfo</a>,
                <a href="#cc632a86620d1774" class="i field">_isLiteralPath</a>
                );
 
            <span class="c">// create xml writer</span>
            <span class="i">XmlWriterSettings</span> <span id="r1 rd" class="r1 r">xmlSettings</span> = <b>new</b>();
            <span class="r1 r">xmlSettings</span>.<span class="i">CloseOutput</span> = <b>true</b>;
            <span class="r1 r">xmlSettings</span>.<span class="i">Encoding</span> = <span class="r0 r">sw</span>.<span class="i">Encoding</span>;
            <span class="r1 r">xmlSettings</span>.<span class="i">Indent</span> = <b>true</b>;
            <span class="r1 r">xmlSettings</span>.<span class="i">OmitXmlDeclaration</span> = <b>true</b>;
            <a href="#dd4b56daa8ab3dda" class="i field">_xw</a> = <span class="i">XmlWriter</span>.<span class="i">Create</span>(<span class="r0 r">sw</span>, <span class="r1 r">xmlSettings</span>);
            <b>if</b> (<a href="#1e7aeea2edc99010" class="i property">Depth</a> == 0)
            {
                <a href="#86e97db32bf9aaf9" class="i field">_serializer</a> = <b>new</b> <span class="i">Serializer</span>(<a href="#dd4b56daa8ab3dda" class="i field">_xw</a>);
            }
            <b>else</b>
            {
                <a href="#86e97db32bf9aaf9" class="i field">_serializer</a> = <b>new</b> <span class="i">Serializer</span>(<a href="#dd4b56daa8ab3dda" class="i field">_xw</a>, <a href="#1e7aeea2edc99010" class="i property">Depth</a>, <b>true</b>);
            }
        }
 
        <b>private
        void</b>
        <a id="28aace381ec8dd9b" href="../../R/28aace381ec8dd9b.html" target="n" data-glyph="76,1" class="i method">CleanUp</a>()
        {
            <b>if</b> (<a href="#0843a0221cef29d3" class="i field">_fs</a> != <b>null</b>)
            {
                <b>if</b> (<a href="#dd4b56daa8ab3dda" class="i field">_xw</a> != <b>null</b>)
                {
                    <a href="#dd4b56daa8ab3dda" class="i field">_xw</a>.<span class="i">Dispose</span>();
                    <a href="#dd4b56daa8ab3dda" class="i field">_xw</a> = <b>null</b>;
                }
 
                <a href="#0843a0221cef29d3" class="i field">_fs</a>.<span class="i">Dispose</span>();
                <a href="#0843a0221cef29d3" class="i field">_fs</a> = <b>null</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> file
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set to true when object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="bc2cfb8e3c8e943f" href="../../R/bc2cfb8e3c8e943f.html" target="n" data-glyph="46,1" class="i field">_disposed</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        void</b>
        <a id="a4c7655b9c96cbaf" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <b>if</b> (!<a href="#bc2cfb8e3c8e943f" class="i field">_disposed</a>)
            {
                <a href="#28aace381ec8dd9b" class="i method">CleanUp</a>();
            }
 
            <a href="#bc2cfb8e3c8e943f" class="i field">_disposed</a> = <b>true</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Members
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implements Import-Clixml command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#ced47428947bccb7" class="t t">VerbsData</a>.<a href="/System.Management.Automation/A.html#7307de9a00fd0115" class="i field">Import</a>, <span class="s">&quot;Clixml&quot;</span>, <span class="i">SupportsPaging</span> = <b>true</b>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;ByPath&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096618&quot;</span>)]
    <b>public sealed class</b> <a id="c13e47cff94abb65" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="5be1c9a3276e6bf9">ImportClixmlCommand</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Line Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Mandatory file name to read from.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ByPath&quot;</span>)]
        <b>public string</b>[] <a id="2a75d6ef57821aad" href="../../R/2a75d6ef57821aad.html" target="n" data-glyph="102,1" class="i property">Path</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Mandatory file name to read from.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ByLiteralPath&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b>[] <a id="7e44f189f15a74b1" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#2a75d6ef57821aad" class="i property">Path</a>;
            }
 
            <b>set</b>
            {
                <a href="#2a75d6ef57821aad" class="i property">Path</a> = <b>value</b>;
                <a href="#82a0c5776616cf92" class="i field">_isLiteralPath</a> = <b>true</b>;
            }
        }
 
        <b>private bool</b> <a id="82a0c5776616cf92" href="../../R/82a0c5776616cf92.html" target="n" data-glyph="46,1" class="i field">_isLiteralPath</a> = <b>false</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command Line Parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <b>private bool</b> <a id="de847591b2952ae3" href="../../R/de847591b2952ae3.html" target="n" data-glyph="46,1" class="i field">_disposed</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="4d58be1c8e4457e8" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <b>if</b> (!<a href="#de847591b2952ae3" class="i field">_disposed</a>)
            {
                <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#c13e47cff94abb65" class="k">this</a>);
                <b>if</b> (<a href="#36f00aea60a8de75" class="i field">_helper</a> != <b>null</b>)
                {
                    <a href="#36f00aea60a8de75" class="i field">_helper</a>.<a href="#35bdfaa1ea4363c0" class="i method">Dispose</a>();
                    <a href="#36f00aea60a8de75" class="i field">_helper</a> = <b>null</b>;
                }
 
                <a href="#de847591b2952ae3" class="i field">_disposed</a> = <b>true</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>private</b> <a href="#e16476ec4b09ca6d" class="t t">ImportXmlHelper</a> <a id="36f00aea60a8de75" href="../../R/36f00aea60a8de75.html" target="n" data-glyph="46,1" class="i field">_helper</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProcessRecord overload.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="6b72e86701153960" href="../../R/6b72e86701153960.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#2a75d6ef57821aad" class="i property">Path</a> != <b>null</b>)
            {
                <b>foreach</b> (<b>string</b> <span id="r2 rd" class="r2 r">path</span> <b>in</b> <a href="#2a75d6ef57821aad" class="i property">Path</a>)
                {
                    <a href="#36f00aea60a8de75" class="i field">_helper</a> = <b>new</b> <a href="#9963d28b690a832b" class="t constructor">ImportXmlHelper</a>(<span class="r2 r">path</span>, <a href="#c13e47cff94abb65" class="k">this</a>, <a href="#82a0c5776616cf92" class="i field">_isLiteralPath</a>);
                    <a href="#36f00aea60a8de75" class="i field">_helper</a>.<a href="#5946f7ef38c06c3b" class="i method">Import</a>();
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="5003d0ff4e4c0016" href="../../R/5003d0ff4e4c0016.html" target="n" data-glyph="75,1" class="i method">StopProcessing</a>()
        {
            <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="k">base</a>.<span class="i">StopProcessing</span>();
            <a href="#36f00aea60a8de75" class="i field">_helper</a>.<a href="#eb06995bedfca87b" class="i method">Stop</a>();
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Implementation for the convertto-xml command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#ced47428947bccb7" class="t t">VerbsData</a>.<a href="/System.Management.Automation/A.html#2aa04ceb3568c2d5" class="i field">ConvertTo</a>, <span class="s">&quot;Xml&quot;</span>, <span class="i">SupportsShouldProcess</span> = <b>false</b>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2096603&quot;</span>, <span class="i">RemotingCapability</span> = <a href="/System.Management.Automation/A.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="/System.Management.Automation/A.html#5111d4e307f1cb5a" class="i field">None</a>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<span class="i">XmlDocument</span>), <b>typeof</b>(<b>string</b>))]
    <b>public sealed class</b> <a id="df6490268c242044" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="871434002c240d97">ConvertToXmlCommand</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Line Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Depth of serialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#1ea1a618dbf069dc" class="i property">HelpMessage</a> = <span class="s">&quot;Specifies how many levels of contained objects should be included in the XML representation&quot;</span>)]
        [<span class="i">ValidateRange</span>(1, <b>int</b>.<span class="i">MaxValue</span>)]
        <b>public int</b> <a id="e6d8a92731865330" href="../../R/e6d8a92731865330.html" target="n" data-glyph="102,1" class="i property">Depth</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Input Object which is written to XML format.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">AllowNull</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="57cf930bbae19c29" href="../../R/57cf930bbae19c29.html" target="n" data-glyph="102,1" class="i property">InputObject</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property that sets NoTypeInformation parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#1ea1a618dbf069dc" class="i property">HelpMessage</a> = <span class="s">&quot;Specifies not to include the Type information in the XML representation&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="823c4ccfadadad08" href="../../R/823c4ccfadadad08.html" target="n" data-glyph="102,1" class="i property">NoTypeInformation</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#bac98e7e99b75aad" class="i field">_notypeinformation</a>;
            }
 
            <b>set</b>
            {
                <a href="#bac98e7e99b75aad" class="i field">_notypeinformation</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b> <a id="bac98e7e99b75aad" href="../../R/bac98e7e99b75aad.html" target="n" data-glyph="46,1" class="i field">_notypeinformation</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property that sets As parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">ValidateSet</span>(<span class="s">&quot;Stream&quot;</span>, <span class="s">&quot;String&quot;</span>, <span class="s">&quot;Document&quot;</span>)]
        <b>public string</b> <a id="fb113fb716aa1c71" href="../../R/fb113fb716aa1c71.html" target="n" data-glyph="102,1" class="i property">As</a> { <b>get</b>; <b>set</b>; } = <span class="s">&quot;Document&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command Line Parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> BeginProcessing override.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="713157bbe6f94c66" href="../../R/713157bbe6f94c66.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <b>if</b> (!<a href="#fb113fb716aa1c71" class="i property">As</a>.<span class="i">Equals</span>(<span class="s">&quot;Stream&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#d36b96c350a64ab7" class="i method">CreateMemoryStream</a>();
            }
            <b>else</b>
            {
                <span class="i">WriteObject</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;{0}\&quot;?&gt;&quot;</span>, <span class="i">Encoding</span>.<span class="i">UTF8</span>.<span class="i">WebName</span>));
                <span class="i">WriteObject</span>(<span class="s">&quot;&lt;Objects&gt;&quot;</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Override ProcessRecord.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="457e209f84a1d7f0" href="../../R/457e209f84a1d7f0.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#fb113fb716aa1c71" class="i property">As</a>.<span class="i">Equals</span>(<span class="s">&quot;Stream&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#d36b96c350a64ab7" class="i method">CreateMemoryStream</a>();
 
                <b>if</b> (<a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a> != <b>null</b>)
                    <a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a>.<a href="CustomSerialization.cs.html#906b63fec2e2ae30" class="i method">SerializeAsStream</a>(<a href="#57cf930bbae19c29" class="i property">InputObject</a>);
 
                <b>if</b> (<a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a> != <b>null</b>)
                {
                    <a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a>.<a href="CustomSerialization.cs.html#9da76a03690e2d3e" class="i method">DoneAsStream</a>();
                    <a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a> = <b>null</b>;
                }
                <span class="c">// Loading to the XML Document</span>
                <a href="#70cc767343f17e29" class="i field">_ms</a>.<span class="i">Position</span> = 0;
                <span class="i">StreamReader</span> <span id="r3 rd" class="r3 r">read</span> = <b>new</b>(<a href="#70cc767343f17e29" class="i field">_ms</a>);
                <b>string</b> <span id="r4 rd" class="r4 r">data</span> = <span class="r3 r">read</span>.<span class="i">ReadToEnd</span>();
                <span class="i">WriteObject</span>(<span class="r4 r">data</span>);
 
                <span class="c">// Cleanup</span>
                <a href="#07e6916969cd03ff" class="i method">CleanUp</a>();
            }
            <b>else</b>
            {
                <b>if</b> (<a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a> != <b>null</b>)
                    <a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a>.<a href="CustomSerialization.cs.html#6af152546daa81c4" class="i method">Serialize</a>(<a href="#57cf930bbae19c29" class="i property">InputObject</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="013824ab24d4a567" href="../../R/013824ab24d4a567.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <b>if</b> (<a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a> != <b>null</b>)
            {
                <a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a>.<a href="CustomSerialization.cs.html#bbbd27ced4c2a363" class="i method">Done</a>();
                <a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a> = <b>null</b>;
            }
 
            <b>if</b> (<a href="#fb113fb716aa1c71" class="i property">As</a>.<span class="i">Equals</span>(<span class="s">&quot;Stream&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="i">WriteObject</span>(<span class="s">&quot;&lt;/Objects&gt;&quot;</span>);
            }
            <b>else</b>
            {
                <span class="c">// Loading to the XML Document</span>
                <a href="#70cc767343f17e29" class="i field">_ms</a>.<span class="i">Position</span> = 0;
                <b>if</b> (<a href="#fb113fb716aa1c71" class="i property">As</a>.<span class="i">Equals</span>(<span class="s">&quot;Document&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="c">// this is a trusted xml doc - the cmdlet generated the doc into a private memory stream</span>
                    <span class="i">XmlDocument</span> <span id="r5 rd" class="r5 r">xmldoc</span> = <b>new</b>();
                    <span class="r5 r">xmldoc</span>.<span class="i">Load</span>(<a href="#70cc767343f17e29" class="i field">_ms</a>);
                    <span class="i">WriteObject</span>(<span class="r5 r">xmldoc</span>);
                }
                <b>else</b> <b>if</b> (<a href="#fb113fb716aa1c71" class="i property">As</a>.<span class="i">Equals</span>(<span class="s">&quot;String&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="i">StreamReader</span> <span id="r6 rd" class="r6 r">read</span> = <b>new</b>(<a href="#70cc767343f17e29" class="i field">_ms</a>);
                    <b>string</b> <span id="r7 rd" class="r7 r">data</span> = <span class="r6 r">read</span>.<span class="i">ReadToEnd</span>();
                    <span class="i">WriteObject</span>(<span class="r7 r">data</span>);
                }
            }
 
            <span class="c">// Cleaning up</span>
            <a href="#07e6916969cd03ff" class="i method">CleanUp</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopProcessing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="e558531ac623c948" href="../../R/e558531ac623c948.html" target="n" data-glyph="75,1" class="i method">StopProcessing</a>()
        {
            <a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a>.<a href="CustomSerialization.cs.html#03ae41b7a7632e46" class="i method">Stop</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Overrides
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> memory
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlText writer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">XmlWriter</span> <a id="5d339d01625714a4" href="../../R/5d339d01625714a4.html" target="n" data-glyph="46,1" class="i field">_xw</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Serializer used for serialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="CustomSerialization.cs.html#298d9c2eeba29ec2" class="t t">CustomSerialization</a> <a id="8bdf4b8fa58ed8c4" href="../../R/8bdf4b8fa58ed8c4.html" target="n" data-glyph="46,1" class="i field">_serializer</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Memory Stream used for serialization.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">MemoryStream</span> <a id="70cc767343f17e29" href="../../R/70cc767343f17e29.html" target="n" data-glyph="46,1" class="i field">_ms</a>;
 
        <b>private void</b> <a id="d36b96c350a64ab7" href="../../R/d36b96c350a64ab7.html" target="n" data-glyph="76,1" class="i method">CreateMemoryStream</a>()
        {
            <span class="c">// Memory Stream</span>
            <a href="#70cc767343f17e29" class="i field">_ms</a> = <b>new</b> <span class="i">MemoryStream</span>();
 
            <span class="c">// We use XmlTextWriter originally:</span>
            <span class="c">//     _xw = new XmlTextWriter(_ms, null);</span>
            <span class="c">//     _xw.Formatting = Formatting.Indented;</span>
            <span class="c">// This implies the following settings:</span>
            <span class="c">//  - Encoding is null -&gt; use the default encoding &#39;UTF-8&#39; when creating the writer from the stream;</span>
            <span class="c">//  - XmlTextWriter closes the underlying stream / writer when &#39;Close/Dispose&#39; is called on it;</span>
            <span class="c">//  - Use the default indentation setting -- two space characters.</span>
            <span class="c">//</span>
            <span class="c">// We configure the same settings in XmlWriterSettings when refactoring this code to use XmlWriter:</span>
            <span class="c">//  - The default encoding used by XmlWriterSettings is &#39;UTF-8&#39;, but we call it out explicitly anyway;</span>
            <span class="c">//  - Set CloseOutput to true;</span>
            <span class="c">//  - Set Indent to true, and by default, IndentChars is two space characters.</span>
            <span class="c">//</span>
            <span class="c">// We use XmlWriterSettings.OmitXmlDeclaration instead of XmlWriter.WriteStartDocument because the</span>
            <span class="c">// xml writer created by calling XmlWriter.Create(Stream, XmlWriterSettings) will write out the xml</span>
            <span class="c">// declaration even without calling WriteStartDocument().</span>
 
            <b>var</b> <span id="r8 rd" class="r8 r">xmlSettings</span> = <b>new</b> <span class="i">XmlWriterSettings</span>();
            <span class="r8 r">xmlSettings</span>.<span class="i">Encoding</span> = <span class="i">Encoding</span>.<span class="i">UTF8</span>;
            <span class="r8 r">xmlSettings</span>.<span class="i">CloseOutput</span> = <b>true</b>;
            <span class="r8 r">xmlSettings</span>.<span class="i">Indent</span> = <b>true</b>;
 
            <b>if</b> (<a href="#fb113fb716aa1c71" class="i property">As</a>.<span class="i">Equals</span>(<span class="s">&quot;Stream&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="c">// Omit xml declaration in this case because we will write out the declaration string in BeginProcess.</span>
                <span class="r8 r">xmlSettings</span>.<span class="i">OmitXmlDeclaration</span> = <b>true</b>;
            }
 
            <a href="#5d339d01625714a4" class="i field">_xw</a> = <span class="i">XmlWriter</span>.<span class="i">Create</span>(<a href="#70cc767343f17e29" class="i field">_ms</a>, <span class="r8 r">xmlSettings</span>);
 
            <b>if</b> (<a href="#e6d8a92731865330" class="i property">Depth</a> == 0)
            {
                <a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a> = <b>new</b> <a href="CustomSerialization.cs.html#e1f94130b54eac5c" class="t constructor">CustomSerialization</a>(<a href="#5d339d01625714a4" class="i field">_xw</a>, <a href="#823c4ccfadadad08" class="i property">NoTypeInformation</a>);
            }
            <b>else</b>
            {
                <a href="#8bdf4b8fa58ed8c4" class="i field">_serializer</a> = <b>new</b> <a href="CustomSerialization.cs.html#45582229d47642da" class="t constructor">CustomSerialization</a>(<a href="#5d339d01625714a4" class="i field">_xw</a>, <a href="#823c4ccfadadad08" class="i property">NoTypeInformation</a>, <a href="#e6d8a92731865330" class="i property">Depth</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">Cleaning up the MemoryStream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="07e6916969cd03ff" href="../../R/07e6916969cd03ff.html" target="n" data-glyph="76,1" class="i method">CleanUp</a>()
        {
            <b>if</b> (<a href="#70cc767343f17e29" class="i field">_ms</a> != <b>null</b>)
            {
                <b>if</b> (<a href="#5d339d01625714a4" class="i field">_xw</a> != <b>null</b>)
                {
                    <a href="#5d339d01625714a4" class="i field">_xw</a>.<span class="i">Dispose</span>();
                    <a href="#5d339d01625714a4" class="i field">_xw</a> = <b>null</b>;
                }
 
                <a href="#70cc767343f17e29" class="i field">_ms</a>.<span class="i">Dispose</span>();
                <a href="#70cc767343f17e29" class="i field">_ms</a> = <b>null</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> memory
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set to true when object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="1b44fcb27a38a2f6" href="../../R/1b44fcb27a38a2f6.html" target="n" data-glyph="46,1" class="i field">_disposed</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        void</b>
        <a id="68612c064aeeb47a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <b>if</b> (!<a href="#1b44fcb27a38a2f6" class="i field">_disposed</a>)
            {
                <a href="#07e6916969cd03ff" class="i method">CleanUp</a>();
            }
 
            <a href="#1b44fcb27a38a2f6" class="i field">_disposed</a> = <b>true</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Members
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Helper class to import single XML file.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="e16476ec4b09ca6d" href="../../R/e16476ec4b09ca6d.html" target="n" data-glyph="2,0" class="t t">ImportXmlHelper</a> : <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XML file to import.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly string</b> <a id="507183b54eb00e3d" href="../../R/507183b54eb00e3d.html" target="n" data-glyph="46,1" class="i field">_path</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reference to cmdlet which is using this helper class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <a id="ffcb19ada679e390" href="../../R/ffcb19ada679e390.html" target="n" data-glyph="46,1" class="i field">_cmdlet</a>;
        <b>private readonly bool</b> <a id="981dbb934d47cf9e" href="../../R/981dbb934d47cf9e.html" target="n" data-glyph="46,1" class="i field">_isLiteralPath</a>;
 
        <b>internal</b> <a id="9963d28b690a832b" href="../../R/9963d28b690a832b.html" target="n" data-glyph="74,1" class="t constructor">ImportXmlHelper</a>(<b>string</b> <span id="r9 rd" class="r9 r">fileName</span>, <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r10 rd" class="r10 r">cmdlet</span>, <b>bool</b> <span id="r11 rd" class="r11 r">isLiteralPath</span>)
        {
            <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<span class="r9 r">fileName</span> != <b>null</b>, <span class="s">&quot;filename is mandatory&quot;</span>);
            <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<span class="r10 r">cmdlet</span> != <b>null</b>, <span class="s">&quot;cmdlet is mandatory&quot;</span>);
            <a href="#507183b54eb00e3d" class="i field">_path</a> = <span class="r9 r">fileName</span>;
            <a href="#ffcb19ada679e390" class="i field">_cmdlet</a> = <span class="r10 r">cmdlet</span>;
            <a href="#981dbb934d47cf9e" class="i field">_isLiteralPath</a> = <span class="r11 r">isLiteralPath</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> file
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle to file stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">FileStream</span> <a id="b8337327dc028895" href="../../R/b8337327dc028895.html" target="n" data-glyph="44,1" class="i field">_fs</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XmlReader used to read file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">XmlReader</span> <a id="9b79c81be0e157ec" href="../../R/9b79c81be0e157ec.html" target="n" data-glyph="44,1" class="i field">_xr</a>;
 
        <b>private static</b> <span class="i">XmlReader</span> <a id="0149a074a55b7b3e" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CreateXmlReader</a>(<span class="i">Stream</span> <span id="r12 rd" class="r12 r">stream</span>)
        {
            <span class="i">TextReader</span> <span id="r13 rd" class="r13 r">textReader</span> = <b>new</b> <span class="i">StreamReader</span>(<span class="r12 r">stream</span>);
 
            <span class="c">// skip #&lt; CLIXML directive</span>
            <b>const string</b> <span id="r14 rd" class="r14 r">cliXmlDirective</span> = <span class="s">&quot;#&lt; CLIXML&quot;</span>;
            <b>if</b> (<span class="r13 r">textReader</span>.<span class="i">Peek</span>() == (<b>int</b>)<span class="r14 r">cliXmlDirective</span>[0])
            {
                <b>string</b> <span id="r15 rd" class="r15 r">line</span> = <span class="r13 r">textReader</span>.<span class="i">ReadLine</span>();
                <b>if</b> (!<span class="r15 r">line</span>.<span class="i">Equals</span>(<span class="r14 r">cliXmlDirective</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                {
                    <span class="r12 r">stream</span>.<span class="i">Seek</span>(0, <span class="i">SeekOrigin</span>.<span class="i">Begin</span>);
                }
            }
 
            <b>return</b> <span class="i">XmlReader</span>.<span class="i">Create</span>(<span class="r13 r">textReader</span>, <span class="i">InternalDeserializer</span>.<span class="i">XmlReaderSettingsForCliXml</span>);
        }
 
        <b>internal void</b> <a id="5189f7ded459d38c" href="../../R/5189f7ded459d38c.html" target="n" data-glyph="74,1" class="i method">CreateFileStream</a>()
        {
            <a href="#b8337327dc028895" class="i field">_fs</a> = <span class="i">PathUtils</span>.<span class="i">OpenFileStream</span>(<a href="#507183b54eb00e3d" class="i field">_path</a>, <a href="#ffcb19ada679e390" class="i field">_cmdlet</a>, <a href="#981dbb934d47cf9e" class="i field">_isLiteralPath</a>);
            <a href="#9b79c81be0e157ec" class="i field">_xr</a> = <span class="i">CreateXmlReader</span>(<a href="#b8337327dc028895" class="i field">_fs</a>);
        }
 
        <b>private void</b> <a id="427a62ddcdaa479b" href="../../R/427a62ddcdaa479b.html" target="n" data-glyph="76,1" class="i method">CleanUp</a>()
        {
            <b>if</b> (<a href="#b8337327dc028895" class="i field">_fs</a> != <b>null</b>)
            {
                <a href="#b8337327dc028895" class="i field">_fs</a>.<span class="i">Dispose</span>();
                <a href="#b8337327dc028895" class="i field">_fs</a> = <b>null</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> file
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set to true when object is disposed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="a0868fd80840d49f" href="../../R/a0868fd80840d49f.html" target="n" data-glyph="46,1" class="i field">_disposed</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="35bdfaa1ea4363c0" href="../../R/35bdfaa1ea4363c0.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <b>if</b> (!<a href="#a0868fd80840d49f" class="i field">_disposed</a>)
            {
                <a href="#427a62ddcdaa479b" class="i method">CleanUp</a>();
            }
 
            <a href="#a0868fd80840d49f" class="i field">_disposed</a> = <b>true</b>;
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#e16476ec4b09ca6d" class="k">this</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Members
 
        <b>private</b> <span class="i">Deserializer</span> <a id="c64f3d3149ee24fc" href="../../R/c64f3d3149ee24fc.html" target="n" data-glyph="46,1" class="i field">_deserializer</a>;
 
        <b>internal void</b> <a id="5946f7ef38c06c3b" href="../../R/5946f7ef38c06c3b.html" target="n" data-glyph="74,1" class="i method">Import</a>()
        {
            <a href="#5189f7ded459d38c" class="i method">CreateFileStream</a>();
            <a href="#c64f3d3149ee24fc" class="i field">_deserializer</a> = <b>new</b> <span class="i">Deserializer</span>(<a href="#9b79c81be0e157ec" class="i field">_xr</a>);
            <span class="c">// If total count has been requested, return a dummy object with zero confidence</span>
            <b>if</b> (<a href="#ffcb19ada679e390" class="i field">_cmdlet</a>.<a href="/System.Management.Automation/A.html#297f2fe60440b5d0" class="i property">PagingParameters</a>.<a href="/System.Management.Automation/A.html#0ab50ff25c31ebbe" class="i property">IncludeTotalCount</a>)
            {
                <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r16 rd" class="r16 r">totalCount</span> = <a href="#ffcb19ada679e390" class="i field">_cmdlet</a>.<a href="/System.Management.Automation/A.html#297f2fe60440b5d0" class="i property">PagingParameters</a>.<span class="i">NewTotalCount</span>(0, 0);
                <a href="#ffcb19ada679e390" class="i field">_cmdlet</a>.<span class="i">WriteObject</span>(<span class="r16 r">totalCount</span>);
            }
 
            <b>ulong</b> <span id="r17 rd" class="r17 r">skip</span> = <a href="#ffcb19ada679e390" class="i field">_cmdlet</a>.<a href="/System.Management.Automation/A.html#297f2fe60440b5d0" class="i property">PagingParameters</a>.<a href="/System.Management.Automation/A.html#234234cf7e57e764" class="i property">Skip</a>;
            <b>ulong</b> <span id="r18 rd" class="r18 r">first</span> = <a href="#ffcb19ada679e390" class="i field">_cmdlet</a>.<a href="/System.Management.Automation/A.html#297f2fe60440b5d0" class="i property">PagingParameters</a>.<a href="/System.Management.Automation/A.html#16fef2d78f0b9040" class="i property">First</a>;
 
            <span class="c">// if paging is not specified then keep the old V2 behavior</span>
            <b>if</b> (<span class="r17 r">skip</span> == 0 &amp;&amp; <span class="r18 r">first</span> == <b>ulong</b>.<span class="i">MaxValue</span>)
            {
                <b>while</b> (!<a href="#c64f3d3149ee24fc" class="i field">_deserializer</a>.<span class="i">Done</span>())
                {
                    <b>object</b> <span id="r19 rd" class="r19 r">result</span> = <a href="#c64f3d3149ee24fc" class="i field">_deserializer</a>.<span class="i">Deserialize</span>();
                    <a href="#ffcb19ada679e390" class="i field">_cmdlet</a>.<span class="i">WriteObject</span>(<span class="r19 r">result</span>);
                }
            }
            <span class="c">// else try to flatten the output if possible</span>
            <b>else</b>
            {
                <b>ulong</b> <span id="r20 rd" class="r20 r">skipped</span> = 0;
                <b>ulong</b> <span id="r21 rd" class="r21 r">count</span> = 0;
                <b>while</b> (!<a href="#c64f3d3149ee24fc" class="i field">_deserializer</a>.<span class="i">Done</span>() &amp;&amp; <span class="r21 r">count</span> &lt; <span class="r18 r">first</span>)
                {
                    <b>object</b> <span id="r22 rd" class="r22 r">result</span> = <a href="#c64f3d3149ee24fc" class="i field">_deserializer</a>.<span class="i">Deserialize</span>();
                    <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r23 rd" class="r23 r">psObject</span> = <span class="r22 r">result</span> <b>as</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
 
                    <b>if</b> (<span class="r23 r">psObject</span> != <b>null</b>)
                    {
                        <span class="i">ICollection</span> <span id="r24 rd" class="r24 r">c</span> = <span class="r23 r">psObject</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as</b> <span class="i">ICollection</span>;
                        <b>if</b> (<span class="r24 r">c</span> != <b>null</b>)
                        {
                            <b>foreach</b> (<b>object</b> <span id="r25 rd" class="r25 r">o</span> <b>in</b> <span class="r24 r">c</span>)
                            {
                                <b>if</b> (<span class="r21 r">count</span> &gt;= <span class="r18 r">first</span>)
                                    <b>break</b>;
 
                                <b>if</b> (<span class="r20 r">skipped</span>++ &gt;= <span class="r17 r">skip</span>)
                                {
                                    <span class="r21 r">count</span>++;
                                    <a href="#ffcb19ada679e390" class="i field">_cmdlet</a>.<span class="i">WriteObject</span>(<span class="r25 r">o</span>);
                                }
                            }
                        }
                        <b>else</b>
                        {
                            <b>if</b> (<span class="r20 r">skipped</span>++ &gt;= <span class="r17 r">skip</span>)
                            {
                                <span class="r21 r">count</span>++;
                                <a href="#ffcb19ada679e390" class="i field">_cmdlet</a>.<span class="i">WriteObject</span>(<span class="r22 r">result</span>);
                            }
                        }
                    }
                    <b>else</b> <b>if</b> (<span class="r20 r">skipped</span>++ &gt;= <span class="r17 r">skip</span>)
                    {
                        <span class="r21 r">count</span>++;
                        <a href="#ffcb19ada679e390" class="i field">_cmdlet</a>.<span class="i">WriteObject</span>(<span class="r22 r">result</span>);
                        <b>continue</b>;
                    }
                }
            }
        }
 
        <b>internal void</b> <a id="eb06995bedfca87b" href="../../R/eb06995bedfca87b.html" target="n" data-glyph="74,1" class="i method">Stop</a>()
        {
            <b>if</b> (<a href="#c64f3d3149ee24fc" class="i field">_deserializer</a> != <b>null</b>)
            {
                <a href="#c64f3d3149ee24fc" class="i field">_deserializer</a>.<span class="i">Stop</span>();
            }
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Select-Xml
    <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c">This cmdlet is used to search an xml document based on the XPath Query.</span>
    <span class="c">///</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="/System.Management.Automation/A.html#47463da255983cfa" class="i field">Select</a>, <span class="s">&quot;Xml&quot;</span>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;Xml&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2097031&quot;</span>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<a href="#6b3ac70128fad9e4" class="t t">SelectXmlInfo</a>))]
    <b>public class</b> <a id="eacff90695a2058d" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="c55a2f26fcc5d64b">SelectXmlCommand</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> parameters
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the path which contains the xml files. The default is the current user directory.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>,
                   <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Path&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b>[] <a id="688070be3abebf4b" href="../../R/688070be3abebf4b.html" target="n" data-glyph="102,1" class="i property">Path</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the literal path which contains the xml files. The default is the current user directory.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;LiteralPath&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b>[] <a id="338c2c376cad4579" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#688070be3abebf4b" class="i property">Path</a>;
            }
 
            <b>set</b>
            {
                <a href="#688070be3abebf4b" class="i property">Path</a> = <b>value</b>;
                <a href="#83bcccff465d5908" class="i field">_isLiteralPath</a> = <b>true</b>;
            }
        }
 
        <b>private bool</b> <a id="83bcccff465d5908" href="../../R/83bcccff465d5908.html" target="n" data-glyph="46,1" class="i field">_isLiteralPath</a> = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;XML&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies the xml Node.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>,
                   <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Xml&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;Node&quot;</span>)]
        <b>public</b> <span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlNode</span>[] <a id="61bd64450289336a" href="../../R/61bd64450289336a.html" target="n" data-glyph="102,1" class="i property">Xml</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter in string format.</span>
        <span class="c">///</span><span class="c"> Specifies the string format of a fully qualified xml.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>,
                   <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Content&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b>[] <a id="9712a9c0d63ca65b" href="../../R/9712a9c0d63ca65b.html" target="n" data-glyph="102,1" class="i property">Content</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Xpath&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies the String in XPath language syntax. The xml documents will be</span>
        <span class="c">///</span><span class="c"> searched for the nodes/values represented by this parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="6052163c5ad4df05" href="../../R/6052163c5ad4df05.html" target="n" data-glyph="102,1" class="i property">XPath</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following definition used to specify the NameSpace of xml.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Hashtable</span> <a id="f6cf1bc5981562d3" href="../../R/f6cf1bc5981562d3.html" target="n" data-glyph="102,1" class="i property">Namespace</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private
 
        <b>private void</b> <a id="4d168dc02f7047bb" href="../../R/4d168dc02f7047bb.html" target="n" data-glyph="76,1" class="i method">WriteResults</a>(<span class="i">XmlNodeList</span> <span id="r26 rd" class="r26 r">foundXmlNodes</span>, <b>string</b> <span id="r27 rd" class="r27 r">filePath</span>)
        {
            <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<span class="r26 r">foundXmlNodes</span> != <b>null</b>, <span class="s">&quot;Caller should verify foundNodes != null&quot;</span>);
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r28 rd" class="r28 r">foundXmlNode</span> <b>in</b> <span class="r26 r">foundXmlNodes</span>)
            {
                <a href="#6b3ac70128fad9e4" class="t t">SelectXmlInfo</a> <span id="r29 rd" class="r29 r">selectXmlInfo</span> = <b>new</b>();
                <span class="r29 r">selectXmlInfo</span>.<a href="#37e1a4756057ff2e" class="i property">Node</a> = <span class="r28 r">foundXmlNode</span>;
                <span class="r29 r">selectXmlInfo</span>.<a href="#4aeccba9c04e590b" class="i property">Pattern</a> = <a href="#6052163c5ad4df05" class="i property">XPath</a>;
                <span class="r29 r">selectXmlInfo</span>.<a href="#04e8dfe5ac53d865" class="i property">Path</a> = <span class="r27 r">filePath</span>;
 
                <a href="#eacff90695a2058d" class="k">this</a>.<span class="i">WriteObject</span>(<span class="r29 r">selectXmlInfo</span>);
            }
        }
 
        <b>private void</b> <a id="d2f7314c32e4c8ad" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ProcessXmlNode</a>(<span class="i">XmlNode</span> <span id="r30 rd" class="r30 r">xmlNode</span>, <b>string</b> <span id="r31 rd" class="r31 r">filePath</span>)
        {
            <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<span class="r30 r">xmlNode</span> != <b>null</b>, <span class="s">&quot;Caller should verify xmlNode != null&quot;</span>);
 
            <span class="i">XmlNodeList</span> <span id="r32 rd" class="r32 r">xList</span>;
            <b>if</b> (<a href="#f6cf1bc5981562d3" class="i property">Namespace</a> != <b>null</b>)
            {
                <span class="i">XmlNamespaceManager</span> <span id="r33 rd" class="r33 r">xmlns</span> = <a href="#6acc10e4317d1f22" class="i method">AddNameSpaceTable</a>(<a href="#eacff90695a2058d" class="k">this</a>.<a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>, <span class="r30 r">xmlNode</span> <b>as</b> <span class="i">XmlDocument</span>, <a href="#f6cf1bc5981562d3" class="i property">Namespace</a>);
                <span class="r32 r">xList</span> = <span class="r30 r">xmlNode</span>.<span class="i">SelectNodes</span>(<a href="#6052163c5ad4df05" class="i property">XPath</a>, <span class="r33 r">xmlns</span>);
            }
            <b>else</b>
            {
                <span class="r32 r">xList</span> = <span class="r30 r">xmlNode</span>.<span class="i">SelectNodes</span>(<a href="#6052163c5ad4df05" class="i property">XPath</a>);
            }
 
            <a href="#eacff90695a2058d" class="k">this</a>.<a href="#4d168dc02f7047bb" class="i method">WriteResults</a>(<span class="r32 r">xList</span>, <span class="r31 r">filePath</span>);
        }
 
        <b>private void</b> <a id="89d0365228501e80" href="../../R/89d0365228501e80.html" target="n" data-glyph="76,1" class="i method">ProcessXmlFile</a>(<b>string</b> <span id="r34 rd" class="r34 r">filePath</span>)
        {
            <span class="c">// Cannot use ImportXMLHelper because it will throw terminating error which will</span>
            <span class="c">// not be inline with Select-String</span>
            <span class="c">// So doing self processing of the file.</span>
            <b>try</b>
            {
                <span class="i">XmlDocument</span> <span id="r35 rd" class="r35 r">xmlDocument</span> = <span class="i">InternalDeserializer</span>.<span class="i">LoadUnsafeXmlDocument</span>(
                    <b>new</b> <span class="i">FileInfo</span>(<span class="r34 r">filePath</span>),
                    <b>true</b>, <span class="c">/* preserve whitespace, comments, etc. */</span>
                    <b>null</b>); <span class="c">/* default maxCharactersInDocument */</span>
 
                <a href="#eacff90695a2058d" class="k">this</a>.<span class="i">ProcessXmlNode</span>(<span class="r35 r">xmlDocument</span>, <span class="r34 r">filePath</span>);
            }
            <b>catch</b> (<span class="i">NotSupportedException</span> <span id="r36 rd" class="r36 r">notSupportedException</span>)
            {
                <a href="#eacff90695a2058d" class="k">this</a>.<span class="i">WriteFileReadError</span>(<span class="r34 r">filePath</span>, <span class="r36 r">notSupportedException</span>);
            }
            <b>catch</b> (<span class="i">IOException</span> <span id="r37 rd" class="r37 r">ioException</span>)
            {
                <a href="#eacff90695a2058d" class="k">this</a>.<span class="i">WriteFileReadError</span>(<span class="r34 r">filePath</span>, <span class="r37 r">ioException</span>);
            }
            <b>catch</b> (<span class="i">SecurityException</span> <span id="r38 rd" class="r38 r">securityException</span>)
            {
                <a href="#eacff90695a2058d" class="k">this</a>.<span class="i">WriteFileReadError</span>(<span class="r34 r">filePath</span>, <span class="r38 r">securityException</span>);
            }
            <b>catch</b> (<span class="i">UnauthorizedAccessException</span> <span id="r39 rd" class="r39 r">unauthorizedAccessException</span>)
            {
                <a href="#eacff90695a2058d" class="k">this</a>.<span class="i">WriteFileReadError</span>(<span class="r34 r">filePath</span>, <span class="r39 r">unauthorizedAccessException</span>);
            }
            <b>catch</b> (<span class="i">XmlException</span> <span id="r40 rd" class="r40 r">xmlException</span>)
            {
                <a href="#eacff90695a2058d" class="k">this</a>.<span class="i">WriteFileReadError</span>(<span class="r34 r">filePath</span>, <span class="r40 r">xmlException</span>);
            }
            <b>catch</b> (<span class="i">InvalidOperationException</span> <span id="r41 rd" class="r41 r">invalidOperationException</span>)
            {
                <a href="#eacff90695a2058d" class="k">this</a>.<span class="i">WriteFileReadError</span>(<span class="r34 r">filePath</span>, <span class="r41 r">invalidOperationException</span>);
            }
        }
 
        <b>private void</b> <a id="ee7741af00403a95" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">WriteFileReadError</a>(<b>string</b> <span id="r42 rd" class="r42 r">filePath</span>, <span class="i">Exception</span> <span id="r43 rd" class="r43 r">exception</span>)
        {
            <b>string</b> <span id="r44 rd" class="r44 r">errorMessage</span> = <b>string</b>.<span class="i">Format</span>(
                <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                <span class="c">// filePath is culture invariant, exception message is to be copied verbatim</span>
                <span class="i">UtilityCommonStrings</span>.<span class="i">FileReadError</span>,
                <span class="r42 r">filePath</span>,
                <span class="r43 r">exception</span>.<span class="i">Message</span>);
 
            <span class="i">ArgumentException</span> <span id="r45 rd" class="r45 r">argumentException</span> = <b>new</b>(<span class="r44 r">errorMessage</span>, <span class="r43 r">exception</span>);
            <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r46 rd" class="r46 r">errorRecord</span> = <b>new</b>(<span class="r45 r">argumentException</span>, <span class="s">&quot;ProcessingFile&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <span class="r42 r">filePath</span>);
 
            <a href="#eacff90695a2058d" class="k">this</a>.<span class="i">WriteError</span>(<span class="r46 r">errorRecord</span>);
        }
 
        <b>private</b> <span class="i">XmlNamespaceManager</span> <a id="6acc10e4317d1f22" href="../../R/6acc10e4317d1f22.html" target="n" data-glyph="76,1" class="i method">AddNameSpaceTable</a>(<b>string</b> <span id="r47 rd" class="r47 r">parametersetname</span>, <span class="i">XmlDocument</span> <span id="r48 rd" class="r48 r">xDoc</span>, <span class="i">Hashtable</span> <span id="r49 rd" class="r49 r">namespacetable</span>)
        {
            <span class="i">XmlNamespaceManager</span> <span id="r50 rd" class="r50 r">xmlns</span>;
            <b>if</b> (<span class="r47 r">parametersetname</span>.<span class="i">Equals</span>(<span class="s">&quot;Xml&quot;</span>))
            {
                <span class="i">XmlNameTable</span> <span id="r51 rd" class="r51 r">xmlnt</span> = <b>new</b> <span class="i">NameTable</span>();
                <span class="r50 r">xmlns</span> = <b>new</b> <span class="i">XmlNamespaceManager</span>(<span class="r51 r">xmlnt</span>);
            }
            <b>else</b>
            {
                <span class="r50 r">xmlns</span> = <b>new</b> <span class="i">XmlNamespaceManager</span>(<span class="r48 r">xDoc</span>.<span class="i">NameTable</span>);
            }
 
            <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r52 rd" class="r52 r">row</span> <b>in</b> <span class="r49 r">namespacetable</span>)
            {
                <b>try</b>
                {
                    <span class="r50 r">xmlns</span>.<span class="i">AddNamespace</span>(<span class="r52 r">row</span>.<span class="i">Key</span>.<span class="i">ToString</span>(), <span class="r52 r">row</span>.<span class="i">Value</span>.<span class="i">ToString</span>());
                }
                <b>catch</b> (<span class="i">NullReferenceException</span>)
                {
                    <b>string</b> <span id="r53 rd" class="r53 r">message</span> = <span class="i">StringUtil</span>.<span class="i">Format</span>(<span class="i">UtilityCommonStrings</span>.<span class="i">SearchXMLPrefixNullError</span>);
                    <span class="i">InvalidOperationException</span> <span id="r54 rd" class="r54 r">e</span> = <b>new</b>(<span class="r53 r">message</span>);
                    <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r55 rd" class="r55 r">er</span> = <b>new</b>(<span class="r54 r">e</span>, <span class="s">&quot;PrefixError&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <span class="r49 r">namespacetable</span>);
                    <span class="i">WriteError</span>(<span class="r55 r">er</span>);
                }
                <b>catch</b> (<span class="i">ArgumentNullException</span>)
                {
                    <b>string</b> <span id="r56 rd" class="r56 r">message</span> = <span class="i">StringUtil</span>.<span class="i">Format</span>(<span class="i">UtilityCommonStrings</span>.<span class="i">SearchXMLPrefixNullError</span>);
                    <span class="i">InvalidOperationException</span> <span id="r57 rd" class="r57 r">e</span> = <b>new</b>(<span class="r56 r">message</span>);
                    <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r58 rd" class="r58 r">er</span> = <b>new</b>(<span class="r57 r">e</span>, <span class="s">&quot;PrefixError&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <span class="r49 r">namespacetable</span>);
                    <span class="i">WriteError</span>(<span class="r58 r">er</span>);
                }
            }
 
            <b>return</b> <span class="r50 r">xmlns</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> override
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProcessRecord method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="586541b71c898a35" href="../../R/586541b71c898a35.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<span class="s">&quot;Xml&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>foreach</b> (<span class="i">XmlNode</span> <span id="r59 rd" class="r59 r">xmlNode</span> <b>in</b> <a href="#eacff90695a2058d" class="k">this</a>.<a href="#61bd64450289336a" class="i property">Xml</a>)
                {
                    <span class="i">ProcessXmlNode</span>(<span class="r59 r">xmlNode</span>, <b>string</b>.<span class="i">Empty</span>);
                }
            }
            <b>else</b> <b>if</b> (
                (<a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<span class="s">&quot;Path&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                (<a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<span class="s">&quot;LiteralPath&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))))
            {
                <span class="c">// If any file not resolved, execution stops. this is to make consistent with select-string.</span>
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r60 rd" class="r60 r">fullresolvedPaths</span> = <b>new</b>();
                <b>foreach</b> (<b>string</b> <span id="r61 rd" class="r61 r">fpath</span> <b>in</b> <a href="#688070be3abebf4b" class="i property">Path</a>)
                {
                    <b>if</b> (<a href="#83bcccff465d5908" class="i field">_isLiteralPath</a>)
                    {
                        <b>string</b> <span id="r62 rd" class="r62 r">resolvedPath</span> = <span class="i">GetUnresolvedProviderPathFromPSPath</span>(<span class="r61 r">fpath</span>);
                        <span class="r60 r">fullresolvedPaths</span>.<span class="i">Add</span>(<span class="r62 r">resolvedPath</span>);
                    }
                    <b>else</b>
                    {
                        <a href="/System.Management.Automation/A.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r63 rd" class="r63 r">provider</span>;
                        <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r64 rd" class="r64 r">resolvedPaths</span> = <span class="i">GetResolvedProviderPathFromPSPath</span>(<span class="r61 r">fpath</span>, <b>out</b> <span class="r63 r">provider</span>);
                        <b>if</b> (!<span class="r63 r">provider</span>.<span class="i">NameEquals</span>(<a href="#eacff90695a2058d" class="k">this</a>.<span class="i">Context</span>.<span class="i">ProviderNames</span>.<span class="i">FileSystem</span>))
                        {
                            <span class="c">// Cannot open File error</span>
                            <b>string</b> <span id="r65 rd" class="r65 r">message</span> = <span class="i">StringUtil</span>.<span class="i">Format</span>(<span class="i">UtilityCommonStrings</span>.<span class="i">FileOpenError</span>, <span class="r63 r">provider</span>.<span class="i">FullName</span>);
                            <span class="i">InvalidOperationException</span> <span id="r66 rd" class="r66 r">e</span> = <b>new</b>(<span class="r65 r">message</span>);
                            <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r67 rd" class="r67 r">er</span> = <b>new</b>(<span class="r66 r">e</span>, <span class="s">&quot;ProcessingFile&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <span class="r61 r">fpath</span>);
                            <span class="i">WriteError</span>(<span class="r67 r">er</span>);
                            <b>continue</b>;
                        }
 
                        <span class="r60 r">fullresolvedPaths</span>.<span class="i">AddRange</span>(<span class="r64 r">resolvedPaths</span>);
                    }
                }
 
                <b>foreach</b> (<b>string</b> <span id="r68 rd" class="r68 r">file</span> <b>in</b> <span class="r60 r">fullresolvedPaths</span>)
                {
                    <a href="#89d0365228501e80" class="i method">ProcessXmlFile</a>(<span class="r68 r">file</span>);
                }
            }
            <b>else</b> <b>if</b> (<a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<span class="s">&quot;Content&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>foreach</b> (<b>string</b> <span id="r69 rd" class="r69 r">xmlstring</span> <b>in</b> <a href="#9712a9c0d63ca65b" class="i property">Content</a>)
                {
                    <span class="i">XmlDocument</span> <span id="r70 rd" class="r70 r">xmlDocument</span>;
                    <b>try</b>
                    {
                        <span class="r70 r">xmlDocument</span> = (<span class="i">XmlDocument</span>)<a href="/System.Management.Automation/A.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r69 r">xmlstring</span>, <b>typeof</b>(<span class="i">XmlDocument</span>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                    }
                    <b>catch</b> (<a href="/System.Management.Automation/A.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a> <span id="r71 rd" class="r71 r">invalidCastException</span>)
                    {
                        <a href="#eacff90695a2058d" class="k">this</a>.<span class="i">WriteError</span>(<span class="r71 r">invalidCastException</span>.<a href="/System.Management.Automation/A.html#d0b45c5847239f5b" class="i property">ErrorRecord</a>);
                        <b>continue</b>;
                    }
 
                    <a href="#eacff90695a2058d" class="k">this</a>.<span class="i">ProcessXmlNode</span>(<span class="r70 r">xmlDocument</span>, <b>string</b>.<span class="i">Empty</span>);
                }
            }
            <b>else</b>
            {
                <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(<b>false</b>, <span class="s">&quot;Unrecognized parameterset&quot;</span>);
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> overrides
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The object returned by Select-Xml representing the result of a match.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="6b3ac70128fad9e4" href="../../R/6b3ac70128fad9e4.html" target="n" data-glyph="0,0" class="t t"><span id="f52cdbb3dbe35c0f">SelectXmlInfo</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the object is InputObject, Input Stream is used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="801b566dd2710666" href="../../R/801b566dd2710666.html" target="n" data-glyph="10,1" class="i field">inputStream</a> = <span class="s">&quot;InputStream&quot;</span>;
        <b>private const string</b> <a id="1cd3c06bf8081279" href="../../R/1cd3c06bf8081279.html" target="n" data-glyph="10,1" class="i field">MatchFormat</a> = <span class="s">&quot;{0}:{1}&quot;</span>;
        <b>private const string</b> <a id="382f0b8fdde18d9e" href="../../R/382f0b8fdde18d9e.html" target="n" data-glyph="10,1" class="i field">SimpleFormat</a> = <span class="s">&quot;{0}&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The XmlNode that matches search.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">XmlNode</span> <a id="37e1a4756057ff2e" href="../../R/37e1a4756057ff2e.html" target="n" data-glyph="102,1" class="i property">Node</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The FileName from which the match is found.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="04e8dfe5ac53d865" href="../../R/04e8dfe5ac53d865.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9508d83f1f1218c1" class="i field">_path</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<b>value</b>))
                {
                    <a href="#9508d83f1f1218c1" class="i field">_path</a> = <a href="#801b566dd2710666" class="i field">inputStream</a>;
                }
                <b>else</b>
                {
                    <a href="#9508d83f1f1218c1" class="i field">_path</a> = <b>value</b>;
                }
            }
        }
 
        <b>private string</b> <a id="9508d83f1f1218c1" href="../../R/9508d83f1f1218c1.html" target="n" data-glyph="46,1" class="i field">_path</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pattern used to search.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="4aeccba9c04e590b" href="../../R/4aeccba9c04e590b.html" target="n" data-glyph="102,1" class="i property">Pattern</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of this object. The format</span>
        <span class="c">///</span><span class="c"> depends on whether a path has been set for this object or not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="4b2f0510dc5bd2ab" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#6a54e81d3e749500" class="i method">ToString</a>(<b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return String representation of the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">directory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="6a54e81d3e749500" href="../../R/6a54e81d3e749500.html" target="n" data-glyph="76,1" class="i method">ToString</a>(<b>string</b> <span id="r72 rd" class="r72 r">directory</span>)
        {
            <b>string</b> <span id="r73 rd" class="r73 r">displayPath</span> = (<span class="r72 r">directory</span> != <b>null</b>) ? <a href="#77116309d749a376" class="i method">RelativePath</a>(<span class="r72 r">directory</span>) : <a href="#9508d83f1f1218c1" class="i field">_path</a>;
            <b>return</b> <a href="#277a76fb649b4a1f" class="i method">FormatLine</a>(<a href="#ac2284f683a1e92d" class="i method">GetNodeText</a>(), <span class="r73 r">displayPath</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the XmlNode Value or InnerXml.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="ac2284f683a1e92d" href="../../R/ac2284f683a1e92d.html" target="n" data-glyph="74,1" class="i method">GetNodeText</a>()
        {
            <b>string</b> <span id="r74 rd" class="r74 r">nodeText</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<a href="#37e1a4756057ff2e" class="i property">Node</a> != <b>null</b>)
            {
                <b>if</b> (<a href="#37e1a4756057ff2e" class="i property">Node</a>.<span class="i">Value</span> != <b>null</b>)
                {
                    <span class="r74 r">nodeText</span> = <a href="#37e1a4756057ff2e" class="i property">Node</a>.<span class="i">Value</span>.<span class="i">Trim</span>();
                }
                <b>else</b>
                {
                    <span class="r74 r">nodeText</span> = <a href="#37e1a4756057ff2e" class="i property">Node</a>.<span class="i">InnerXml</span>.<span class="i">Trim</span>();
                }
            }
 
            <b>return</b> <span class="r74 r">nodeText</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the path of the matching file truncated relative to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">directory</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For example, if the matching path was c:\foo\bar\baz.c and the directory argument was c:\foo</span>
        <span class="c">///</span><span class="c"> the routine would return bar\baz.c</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">directory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The directory base the truncation on.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The relative path that was produced.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="77116309d749a376" href="../../R/77116309d749a376.html" target="n" data-glyph="76,1" class="i method">RelativePath</a>(<b>string</b> <span id="r75 rd" class="r75 r">directory</span>)
        {
            <b>string</b> <span id="r76 rd" class="r76 r">relPath</span> = <a href="#9508d83f1f1218c1" class="i field">_path</a>;
            <b>if</b> (!<span class="r76 r">relPath</span>.<span class="i">Equals</span>(<a href="#801b566dd2710666" class="i field">inputStream</a>))
            {
                <b>if</b> (<span class="r76 r">relPath</span>.<span class="i">StartsWith</span>(<span class="r75 r">directory</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>int</b> <span id="r77 rd" class="r77 r">offset</span> = <span class="r75 r">directory</span>.<span class="i">Length</span>;
                    <b>if</b> (<span class="r77 r">offset</span> &lt; <span class="r76 r">relPath</span>.<span class="i">Length</span>)
                    {
                        <b>if</b> (<span class="r75 r">directory</span>[<span class="r77 r">offset</span> - 1] == <span class="s">&#39;\\&#39;</span> || <span class="r75 r">directory</span>[<span class="r77 r">offset</span> - 1] == <span class="s">&#39;/&#39;</span>)
                            <span class="r76 r">relPath</span> = <span class="r76 r">relPath</span>.<span class="i">Substring</span>(<span class="r77 r">offset</span>);
                        <b>else</b> <b>if</b> (<span class="r76 r">relPath</span>[<span class="r77 r">offset</span>] == <span class="s">&#39;\\&#39;</span> || <span class="r76 r">relPath</span>[<span class="r77 r">offset</span>] == <span class="s">&#39;/&#39;</span>)
                            <span class="r76 r">relPath</span> = <span class="r76 r">relPath</span>.<span class="i">Substring</span>(<span class="r77 r">offset</span> + 1);
                    }
                }
            }
 
            <b>return</b> <span class="r76 r">relPath</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Formats a line for use in ToString.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">text</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r79 r">displaypath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="277a76fb649b4a1f" href="../../R/277a76fb649b4a1f.html" target="n" data-glyph="76,1" class="i method">FormatLine</a>(<b>string</b> <span id="r78 rd" class="r78 r">text</span>, <b>string</b> <span id="r79 rd" class="r79 r">displaypath</span>)
        {
            <b>if</b> (<a href="#9508d83f1f1218c1" class="i field">_path</a>.<span class="i">Equals</span>(<a href="#801b566dd2710666" class="i field">inputStream</a>))
            {
                <b>return</b> <span class="i">StringUtil</span>.<span class="i">Format</span>(<a href="#382f0b8fdde18d9e" class="i field">SimpleFormat</a>, <span class="r78 r">text</span>);
            }
            <b>else</b>
            {
                <b>return</b> <span class="i">StringUtil</span>.<span class="i">Format</span>(<a href="#1cd3c06bf8081279" class="i field">MatchFormat</a>, <span class="r78 r">text</span>, <span class="r79 r">displaypath</span>);
            }
        }
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Select-Xml
}
</pre></td></tr></table></div></body></html>
