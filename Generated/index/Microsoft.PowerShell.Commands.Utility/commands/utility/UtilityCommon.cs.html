<!DOCTYPE html>
<html><head><title>UtilityCommon.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(382);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility/commands/utility/UtilityCommon.cs" target="_top">commands\utility\UtilityCommon.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility" target="_top">src\Microsoft.PowerShell.Commands.Utility\Microsoft.PowerShell.Commands.Utility.csproj</a> (Microsoft.PowerShell.Commands.Utility)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
[<b>module</b>: <span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1711:IdentifiersShouldNotHaveIncorrectSuffix&quot;</span>, <span class="i">Scope</span> = <span class="s">&quot;type&quot;</span>, <span class="i">Target</span> = <span class="s">&quot;~T:Microsoft.PowerShell.Commands.ByteCollection&quot;</span>)]
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Don&#39;t use! The API is obsolete!.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Obsolete</span>(<span class="s">&quot;This class is included in this SDK for completeness only. The members of this class cannot be used directly, nor should this class be used to derive other classes.&quot;</span>, <b>true</b>)]
    <b>public enum</b> <a id="5e3dbcef7afb4c0d" href="../../R/../../0000000000.html" target="n" data-glyph="18,0" class="t t"><span id="2d9d48bd85719e8d">TextEncodingType</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> No encoding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="4087030e3eeadc30" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Unknown</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unicode encoding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="1df223f0dc8d6fe1" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">String</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unicode encoding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="8fdf6ec9ea5c2b77" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Unicode</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Byte encoding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="d2473ec72053f5d8" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Byte</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Big Endian Unicode encoding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="66f08d1d1c284146" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">BigEndianUnicode</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Big Endian UTF32 encoding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="ea7bd4335d8790fb" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">BigEndianUTF32</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> UTF8 encoding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="5cf96e524a3d1b8b" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Utf8</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> UTF7 encoding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="f03c4eef09e9a3bc" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Utf7</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ASCII encoding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="83078dbd19c7f3ff" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Ascii</a>,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Utility class to contain resources for the Microsoft.PowerShell.Utility module.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Obsolete</span>(<span class="s">&quot;This class is obsolete&quot;</span>, <b>true</b>)]
    <b>public static class</b> <a id="188d714808fa5ecf" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">UtilityResources</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="745343acde033f90" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">PathDoesNotExist</a> { <b>get</b> { <b>return</b> <span class="i">UtilityCommonStrings</span>.<span class="i">PathDoesNotExist</span>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="5fcb649f488fb861" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">FileReadError</a> { <b>get</b> { <b>return</b> <span class="i">UtilityCommonStrings</span>.<span class="i">FileReadError</span>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The resource string used to indicate &#39;PATH:&#39; in the formatting header.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="6b95b1bfb3710457" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">FormatHexPathPrefix</a> { <b>get</b> { <b>return</b> <span class="i">UtilityCommonStrings</span>.<span class="i">FormatHexPathPrefix</span>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Error message to indicate that requested algorithm is not supported on the target platform.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="1d442c9b8b40e1cd" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">AlgorithmTypeNotSupported</a> { <b>get</b> { <b>return</b> <span class="i">UtilityCommonStrings</span>.<span class="i">AlgorithmTypeNotSupported</span>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The file &#39;{0}&#39; could not be parsed as a PowerShell Data File.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static string</b> <a id="8b28fc81ff948375" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">CouldNotParseAsPowerShellDataFile</a> { <b>get</b> { <b>return</b> <span class="i">UtilityCommonStrings</span>.<span class="i">CouldNotParseAsPowerShellDataFile</span>; } }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> ByteCollection is used as a wrapper class for the collection of bytes.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="b845c9459e65107b" href="../../R/b845c9459e65107b.html" target="n" data-glyph="0,0" class="t t">ByteCollection</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b845c9459e65107b" class="t t">ByteCollection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">offset</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Offset address to be used while displaying the bytes in the collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Underlying bytes stored in the collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicates the path of the file whose contents are wrapped in the ByteCollection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">Obsolete</span>(<span class="s">&quot;The constructor is deprecated.&quot;</span>, <b>true</b>)]
        <b>public</b> <a id="50dcfa2a6c81c174" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ByteCollection</a>(<b>uint</b> <span id="r0 rd" class="r0 r">offset</span>, <b>byte</b>[] <span id="r1 rd" class="r1 r">value</span>, <b>string</b> <span id="r2 rd" class="r2 r">path</span>)
            : <a href="#07d070e8d1d05b13" class="k">this</a>((<b>ulong</b>)<span class="r0 r">offset</span>, <span class="r1 r">value</span>, <span class="r2 r">path</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b845c9459e65107b" class="t t">ByteCollection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">offset</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Offset address to be used while displaying the bytes in the collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Underlying bytes stored in the collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicates the path of the file whose contents are wrapped in the ByteCollection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="07d070e8d1d05b13" href="../../R/07d070e8d1d05b13.html" target="n" data-glyph="72,1" class="t constructor">ByteCollection</a>(<b>ulong</b> <span id="r3 rd" class="r3 r">offset</span>, <b>byte</b>[] <span id="r4 rd" class="r4 r">value</span>, <b>string</b> <span id="r5 rd" class="r5 r">path</span>)
        {
            <b>if</b> (<span class="r4 r">value</span> == <b>null</b>)
            {
                <b>throw</b> <a href="/System.Management.Automation/A.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentNullException</span>(<b>nameof</b>(<span class="r4 r">value</span>));
            }
 
            <a href="#697ad65d71ee561e" class="i property">Offset64</a> = <span class="r3 r">offset</span>;
            <a href="#e024aed3b6c89eaf" class="i property">Bytes</a> = <span class="r4 r">value</span>;
            <a href="#ab0a12285544f260" class="i property">Path</a> = <span class="r5 r">path</span>;
            <a href="#344ee0d0de3233d2" class="i property">Label</a> = <span class="r5 r">path</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b845c9459e65107b" class="t t">ByteCollection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">offset</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Offset address to be used while displaying the bytes in the collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Underlying bytes stored in the collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">Obsolete</span>(<span class="s">&quot;The constructor is deprecated.&quot;</span>, <b>true</b>)]
        <b>public</b> <a id="1b2eeb7b00372725" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ByteCollection</a>(<b>uint</b> <span id="r6 rd" class="r6 r">offset</span>, <b>byte</b>[] <span id="r7 rd" class="r7 r">value</span>)
            : <a href="#cae4b7d35e26cecd" class="k">this</a>((<b>ulong</b>)<span class="r6 r">offset</span>, <span class="r7 r">value</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b845c9459e65107b" class="t t">ByteCollection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">offset</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Offset address to be used while displaying the bytes in the collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Underlying bytes stored in the collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="cae4b7d35e26cecd" href="../../R/cae4b7d35e26cecd.html" target="n" data-glyph="72,1" class="t constructor">ByteCollection</a>(<b>ulong</b> <span id="r8 rd" class="r8 r">offset</span>, <b>byte</b>[] <span id="r9 rd" class="r9 r">value</span>)
        {
            <b>if</b> (<span class="r9 r">value</span> == <b>null</b>)
            {
                <b>throw</b> <a href="/System.Management.Automation/A.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentNullException</span>(<b>nameof</b>(<span class="r9 r">value</span>));
            }
 
            <a href="#697ad65d71ee561e" class="i property">Offset64</a> = <span class="r8 r">offset</span>;
            <a href="#e024aed3b6c89eaf" class="i property">Bytes</a> = <span class="r9 r">value</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b845c9459e65107b" class="t t">ByteCollection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">offset</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Offset address to be used while displaying the bytes in the collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The label for the byte group. This may be a file path or a formatted identifying string for the group.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Underlying bytes stored in the collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="32a4fca5dd6364f8" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ByteCollection</a>(<b>ulong</b> <span id="r10 rd" class="r10 r">offset</span>, <b>string</b> <span id="r11 rd" class="r11 r">label</span>, <b>byte</b>[] <span id="r12 rd" class="r12 r">value</span>)
            : <a href="#cae4b7d35e26cecd" class="k">this</a>(<span class="r10 r">offset</span>, <span class="r12 r">value</span>)
        {
            <a href="#344ee0d0de3233d2" class="i property">Label</a> = <span class="r11 r">label</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b845c9459e65107b" class="t t">ByteCollection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Underlying bytes stored in the collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="0252991c2c688d73" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">ByteCollection</a>(<b>byte</b>[] <span id="r13 rd" class="r13 r">value</span>)
        {
            <b>if</b> (<span class="r13 r">value</span> == <b>null</b>)
            {
                <b>throw</b> <a href="/System.Management.Automation/A.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentNullException</span>(<b>nameof</b>(<span class="r13 r">value</span>));
            }
 
            <a href="#e024aed3b6c89eaf" class="i property">Bytes</a> = <span class="r13 r">value</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the Offset address to be used while displaying the bytes in the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Obsolete</span>(<span class="s">&quot;The property is deprecated, please use Offset64 instead.&quot;</span>, <b>true</b>)]
        <b>public uint</b> <a id="0aa964b47f42054f" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Offset</a>
        {
            <b>get</b>
            {
                <b>return</b> (<b>uint</b>)<a href="#697ad65d71ee561e" class="i property">Offset64</a>;
            }
 
            <b>private set</b>
            {
                <a href="#697ad65d71ee561e" class="i property">Offset64</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the Offset address to be used while displaying the bytes in the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public ulong</b> <a id="697ad65d71ee561e" href="../../R/697ad65d71ee561e.html" target="n" data-glyph="102,1" class="i property">Offset64</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets underlying bytes stored in the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public byte</b>[] <a id="e024aed3b6c89eaf" href="../../R/e024aed3b6c89eaf.html" target="n" data-glyph="102,1" class="i property">Bytes</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the path of the file whose contents are wrapped in the ByteCollection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ab0a12285544f260" href="../../R/ab0a12285544f260.html" target="n" data-glyph="102,1" class="i property">Path</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the hexadecimal representation of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#697ad65d71ee561e" class="i property">Offset64</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="5cdca70288437e8a" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">HexOffset</a> { <b>get</b> =&gt; <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="s">&quot;{0:X16}&quot;</span>, <a href="#697ad65d71ee561e" class="i property">Offset64</a>); }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the type of the input objects used to create the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b845c9459e65107b" class="t t">ByteCollection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="344ee0d0de3233d2" href="../../R/344ee0d0de3233d2.html" target="n" data-glyph="102,1" class="i property">Label</a> { <b>get</b>; }
 
        <b>private const int</b> <a id="97d5831a166f5827" href="../../R/97d5831a166f5827.html" target="n" data-glyph="10,1" class="i field">BytesPerLine</a> = 16;
 
        <b>private string</b> <a id="98d87a0b99d4858d" href="../../R/98d87a0b99d4858d.html" target="n" data-glyph="46,1" class="i field">_hexBytes</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets a space-delimited string of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e024aed3b6c89eaf" class="i property">Bytes</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> in this </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b845c9459e65107b" class="t t">ByteCollection</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> in hexadecimal format.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="406f7df483e81ac9" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">HexBytes</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#98d87a0b99d4858d" class="i field">_hexBytes</a> == <b>string</b>.<span class="i">Empty</span>)
                {
                    <span class="i">StringBuilder</span> <span id="r14 rd" class="r14 r">line</span> = <b>new</b>(<a href="#97d5831a166f5827" class="i field">BytesPerLine</a> * 3);
 
                    <b>foreach</b> (<b>var</b> <span id="r15 rd" class="r15 r">currentByte</span> <b>in</b> <a href="#e024aed3b6c89eaf" class="i property">Bytes</a>)
                    {
                        <span class="r14 r">line</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="s">&quot;{0:X2} &quot;</span>, <span class="r15 r">currentByte</span>);
                    }
 
                    <a href="#98d87a0b99d4858d" class="i field">_hexBytes</a> = <span class="r14 r">line</span>.<span class="i">ToString</span>().<span class="i">Trim</span>();
                }
 
                <b>return</b> <a href="#98d87a0b99d4858d" class="i field">_hexBytes</a>;
            }
        }
 
        <b>private string</b> <a id="a776816d1df81162" href="../../R/a776816d1df81162.html" target="n" data-glyph="46,1" class="i field">_ascii</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the ASCII string representation of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e024aed3b6c89eaf" class="i property">Bytes</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> in this </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b845c9459e65107b" class="t t">ByteCollection</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public string</b> <a id="a1983cfda87609c7" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Ascii</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#a776816d1df81162" class="i field">_ascii</a> == <b>string</b>.<span class="i">Empty</span>)
                {
                    <span class="i">StringBuilder</span> <span id="r16 rd" class="r16 r">ascii</span> = <b>new</b>(<a href="#97d5831a166f5827" class="i field">BytesPerLine</a>);
 
                    <b>foreach</b> (<b>var</b> <span id="r17 rd" class="r17 r">currentByte</span> <b>in</b> <a href="#e024aed3b6c89eaf" class="i property">Bytes</a>)
                    {
                        <b>var</b> <span id="r18 rd" class="r18 r">currentChar</span> = (<b>char</b>)<span class="r17 r">currentByte</span>;
                        <b>if</b> (<span class="r18 r">currentChar</span> == 0x0)
                        {
                            <span class="r16 r">ascii</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>);
                        }
                        <b>else</b> <b>if</b> (<b>char</b>.<span class="i">IsControl</span>(<span class="r18 r">currentChar</span>))
                        {
                            <span class="r16 r">ascii</span>.<span class="i">Append</span>((<b>char</b>)0xFFFD);
                        }
                        <b>else</b>
                        {
                            <span class="r16 r">ascii</span>.<span class="i">Append</span>(<span class="r18 r">currentChar</span>);
                        }
                    }
 
                    <a href="#a776816d1df81162" class="i field">_ascii</a> = <span class="r16 r">ascii</span>.<span class="i">ToString</span>();
                }
 
                <b>return</b> <a href="#a776816d1df81162" class="i field">_ascii</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Displays the hexadecimal format of the bytes stored in the collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="9c3a6da66afb47aa" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>const int</b> <span id="r19 rd" class="r19 r">BytesPerLine</span> = 16;
            <b>const string</b> <span id="r20 rd" class="r20 r">LineFormat</span> = <span class="s">&quot;{0:X16}   &quot;</span>;
 
            <span class="c">// &#39;16 + 3&#39; comes from format &quot;{0:X16}   &quot;.</span>
            <span class="c">// &#39;16&#39; comes from &#39;[Uint64]::MaxValue.ToString(&quot;X&quot;).Length&#39;.</span>
            <span class="i">StringBuilder</span> <span id="r21 rd" class="r21 r">nextLine</span> = <b>new</b>(16 + 3 + (<span class="r19 r">BytesPerLine</span> * 3));
            <span class="i">StringBuilder</span> <span id="r22 rd" class="r22 r">asciiEnd</span> = <b>new</b>(<span class="r19 r">BytesPerLine</span>);
 
            <span class="c">// &#39;+1&#39; comes from &#39;result.Append(nextLine.ToString() + &quot; &quot; + asciiEnd.ToString());&#39; below.</span>
            <span class="i">StringBuilder</span> <span id="r23 rd" class="r23 r">result</span> = <b>new</b>(<span class="r21 r">nextLine</span>.<span class="i">Capacity</span> + <span class="r22 r">asciiEnd</span>.<span class="i">Capacity</span> + 1);
 
            <b>if</b> (<a href="#e024aed3b6c89eaf" class="i property">Bytes</a>.<span class="i">Length</span> &gt; 0)
            {
                <b>long</b> <span id="r24 rd" class="r24 r">charCounter</span> = 0;
 
                <b>var</b> <span id="r25 rd" class="r25 r">currentOffset</span> = <a href="#697ad65d71ee561e" class="i property">Offset64</a>;
 
                <span class="r21 r">nextLine</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="r20 r">LineFormat</span>, <span class="r25 r">currentOffset</span>);
 
                <b>foreach</b> (<b>byte</b> <span id="r26 rd" class="r26 r">currentByte</span> <b>in</b> <a href="#e024aed3b6c89eaf" class="i property">Bytes</a>)
                {
                    <span class="c">// Display each byte, in 2-digit hexadecimal, and add that to the left-hand side.</span>
                    <span class="r21 r">nextLine</span>.<span class="i">AppendFormat</span>(<span class="s">&quot;{0:X2} &quot;</span>, <span class="r26 r">currentByte</span>);
 
                    <span class="c">// If the character is printable, add its ascii representation to</span>
                    <span class="c">// the right-hand side.  Otherwise, add a dot to the right hand side.</span>
                    <b>var</b> <span id="r27 rd" class="r27 r">currentChar</span> = (<b>char</b>)<span class="r26 r">currentByte</span>;
                    <b>if</b> (<span class="r27 r">currentChar</span> == 0x0)
                    {
                        <span class="r22 r">asciiEnd</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>);
                    }
                    <b>else</b> <b>if</b> (<b>char</b>.<span class="i">IsControl</span>(<span class="r27 r">currentChar</span>))
                    {
                        <span class="r22 r">asciiEnd</span>.<span class="i">Append</span>((<b>char</b>)0xFFFD);
                    }
                    <b>else</b>
                    {
                        <span class="r22 r">asciiEnd</span>.<span class="i">Append</span>(<span class="r27 r">currentChar</span>);
                    }
 
                    <span class="r24 r">charCounter</span>++;
 
                    <span class="c">// If we&#39;ve hit the end of a line, combine the right half with the</span>
                    <span class="c">// left half, and start a new line.</span>
                    <b>if</b> ((<span class="r24 r">charCounter</span> % <span class="r19 r">BytesPerLine</span>) == 0)
                    {
                        <span class="r23 r">result</span>.<span class="i">Append</span>(<span class="r21 r">nextLine</span>).<span class="i">Append</span>(<span class="s">&#39; &#39;</span>).<span class="i">Append</span>(<span class="r22 r">asciiEnd</span>);
                        <span class="r21 r">nextLine</span>.<span class="i">Clear</span>();
                        <span class="r22 r">asciiEnd</span>.<span class="i">Clear</span>();
                        <span class="r25 r">currentOffset</span> += <span class="r19 r">BytesPerLine</span>;
                        <span class="r21 r">nextLine</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="r20 r">LineFormat</span>, <span class="r25 r">currentOffset</span>);
 
                        <span class="c">// Adding a newline to support long inputs strings flowing through InputObject parameterset.</span>
                        <b>if</b> ((<span class="r24 r">charCounter</span> &lt;= <a href="#e024aed3b6c89eaf" class="i property">Bytes</a>.<span class="i">Length</span>) &amp;&amp; <b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#ab0a12285544f260" class="i property">Path</a>))
                        {
                            <span class="r23 r">result</span>.<span class="i">AppendLine</span>();
                        }
                    }
                }
 
                <span class="c">// At the end of the file, we might not have had the chance to output</span>
                <span class="c">// the end of the line yet. Only do this if we didn&#39;t exit on the 16-byte</span>
                <span class="c">// boundary, though.</span>
                <b>if</b> ((<span class="r24 r">charCounter</span> % 16) != 0)
                {
                    <b>while</b> ((<span class="r24 r">charCounter</span> % 16) != 0)
                    {
                        <span class="r21 r">nextLine</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>, 3);
                        <span class="r22 r">asciiEnd</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>);
                        <span class="r24 r">charCounter</span>++;
                    }
 
                    <span class="r23 r">result</span>.<span class="i">Append</span>(<span class="r21 r">nextLine</span>).<span class="i">Append</span>(<span class="s">&#39; &#39;</span>).<span class="i">Append</span>(<span class="r22 r">asciiEnd</span>);
                }
            }
 
            <b>return</b> <span class="r23 r">result</span>.<span class="i">ToString</span>();
        }
    }
}
</pre></td></tr></table></div></body></html>
