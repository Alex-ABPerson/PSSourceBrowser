<!DOCTYPE html>
<html><head><title>OrderObjectBase.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(734);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility/commands/utility/OrderObjectBase.cs" target="_top">commands\utility\OrderObjectBase.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility" target="_top">src\Microsoft.PowerShell.Commands.Utility\Microsoft.PowerShell.Commands.Utility.csproj</a> (Microsoft.PowerShell.Commands.Utility)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Definitions for hash table keys.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="5d4c494ae1f45a26" href="../../R/5d4c494ae1f45a26.html" target="n" data-glyph="2,0" class="t t">SortObjectParameterDefinitionKeys</a>
    {
        <b>internal const string</b> <a id="5586e831e7f66cc2" href="../../R/5586e831e7f66cc2.html" target="n" data-glyph="8,1" class="i field">AscendingEntryKey</a> = <span class="s">&quot;ascending&quot;</span>;
        <b>internal const string</b> <a id="7693b43e7c69a500" href="../../R/7693b43e7c69a500.html" target="n" data-glyph="8,1" class="i field">DescendingEntryKey</a> = <span class="s">&quot;descending&quot;</span>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="6d41071a2148e52a" href="../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="e6709b15ca7399d4">SortObjectExpressionParameterDefinition</span></a> : <span class="i">CommandParameterDefinition</span>
    {
        <b>protected override void</b> <a id="a129741be8c4b52d" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">SetEntries</a>()
        {
            <a href="#6d41071a2148e52a" class="k">this</a>.<span class="i">hashEntries</span>.<span class="i">Add</span>(<b>new</b> <span class="i">ExpressionEntryDefinition</span>(<b>false</b>));
            <a href="#6d41071a2148e52a" class="k">this</a>.<span class="i">hashEntries</span>.<span class="i">Add</span>(<b>new</b> <span class="i">BooleanEntryDefinition</span>(<a href="#5d4c494ae1f45a26" class="t t">SortObjectParameterDefinitionKeys</a>.<a href="#5586e831e7f66cc2" class="i field">AscendingEntryKey</a>));
            <a href="#6d41071a2148e52a" class="k">this</a>.<span class="i">hashEntries</span>.<span class="i">Add</span>(<b>new</b> <span class="i">BooleanEntryDefinition</span>(<a href="#5d4c494ae1f45a26" class="t t">SortObjectParameterDefinitionKeys</a>.<a href="#7693b43e7c69a500" class="i field">DescendingEntryKey</a>));
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="17574083c9e46b00" href="../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="1683465a65e03056">GroupObjectExpressionParameterDefinition</span></a> : <span class="i">CommandParameterDefinition</span>
    {
        <b>protected override void</b> <a id="9d87753db9d9159d" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">SetEntries</a>()
        {
            <a href="#17574083c9e46b00" class="k">this</a>.<span class="i">hashEntries</span>.<span class="i">Add</span>(<b>new</b> <span class="i">ExpressionEntryDefinition</span>(<b>true</b>));
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base Cmdlet for cmdlets which deal with raw objects.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="621ebc8dc53a04cd" href="../../R/621ebc8dc53a04cd.html" target="n" data-glyph="0,0" class="t t"><span id="e42f8f1d33175ea5">ObjectCmdletBase</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i n">System</span>.<span class="i">Diagnostics</span>.<span class="i">CodeAnalysis</span>.<span class="i">SuppressMessage</span>(<span class="s">&quot;GoldMan&quot;</span>, <span class="s">&quot;#pw17903:UseOfLCID&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;The CultureNumber is only used if the property has been set with a hex string starting with 0x&quot;</span>)]
        <b>public string</b> <a id="3ebd7dfce8d6cb09" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Culture</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#dce766f286e370b0" class="i field">_cultureInfo</a>?.<span class="i">ToString</span>();
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<b>value</b>))
                {
                    <a href="#dce766f286e370b0" class="i field">_cultureInfo</a> = <b>null</b>;
                    <b>return</b>;
                }
 
                <b>int</b> <span id="r0 rd" class="r0 r">cultureNumber</span>;
                <b>string</b> <span id="r1 rd" class="r1 r">trimmedValue</span> = <b>value</b>.<span class="i">Trim</span>();
                <b>if</b> (<span class="r1 r">trimmedValue</span>.<span class="i">StartsWith</span>(<span class="s">&quot;0x&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>if</b> ((<span class="r1 r">trimmedValue</span>.<span class="i">Length</span> &gt; 2) &amp;&amp;
                        <b>int</b>.<span class="i">TryParse</span>(<span class="r1 r">trimmedValue</span>.<span class="i">AsSpan</span>(2), <span class="i">NumberStyles</span>.<span class="i">AllowHexSpecifier</span>,
                                  <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <b>out</b> <span class="r0 r">cultureNumber</span>))
                    {
                        <a href="#dce766f286e370b0" class="i field">_cultureInfo</a> = <b>new</b> <span class="i">CultureInfo</span>(<span class="r0 r">cultureNumber</span>);
                        <b>return</b>;
                    }
                }
                <b>else</b> <b>if</b> (<b>int</b>.<span class="i">TryParse</span>(<span class="r1 r">trimmedValue</span>, <span class="i">NumberStyles</span>.<span class="i">AllowThousands</span>,
                                 <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <b>out</b> <span class="r0 r">cultureNumber</span>))
                {
                    <a href="#dce766f286e370b0" class="i field">_cultureInfo</a> = <b>new</b> <span class="i">CultureInfo</span>(<span class="r0 r">cultureNumber</span>);
                    <b>return</b>;
                }
 
                <a href="#dce766f286e370b0" class="i field">_cultureInfo</a> = <b>new</b> <span class="i">CultureInfo</span>(<b>value</b>);
            }
        }
 
        <b>internal</b> <span class="i">CultureInfo</span> <a id="dce766f286e370b0" href="../../R/dce766f286e370b0.html" target="n" data-glyph="44,1" class="i field">_cultureInfo</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="cc354046988a4b22" href="../../R/cc354046988a4b22.html" target="n" data-glyph="102,1" class="i property">CaseSensitive</a>
        {
            <b>get</b> { <b>return</b> <a href="#3143569452817320" class="i field">_caseSensitive</a>; }
 
            <b>set</b> { <a href="#3143569452817320" class="i field">_caseSensitive</a> = <b>value</b>; }
        }
 
        <b>private bool</b> <a id="3143569452817320" href="../../R/3143569452817320.html" target="n" data-glyph="46,1" class="i field">_caseSensitive</a>;
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Parameters
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base Cmdlet for object cmdlets that deal with Grouping, Sorting and Comparison.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="c764b4903e6e2453" href="../../R/c764b4903e6e2453.html" target="n" data-glyph="0,0" class="t t"><span id="affecd925ede4a95">ObjectBase</span></a> : <a href="#621ebc8dc53a04cd" class="t t">ObjectCmdletBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="5001d7bd9f0b9c5c" href="../../R/5001d7bd9f0b9c5c.html" target="n" data-glyph="102,1" class="i property">InputObject</a> { <b>get</b>; <b>set</b>; } = <a href="/System.Management.Automation/A.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="/System.Management.Automation/A.html#1cf7e193da582896" class="i property">Value</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or Sets the Properties that would be used for Grouping, Sorting and Comparison.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public object</b>[] <a id="02b319af379776ac" href="../../R/02b319af379776ac.html" target="n" data-glyph="102,1" class="i property">Property</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Parameters
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base Cmdlet for object cmdlets that deal with Ordering and Comparison.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="30d1515f54d45949" href="../../R/30d1515f54d45949.html" target="n" data-glyph="0,0" class="t t"><span id="a7a5fdef882a015b">OrderObjectBase</span></a> : <a href="#c764b4903e6e2453" class="t t">ObjectBase</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies sorting order.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="56a4e3993a205953" href="../../R/56a4e3993a205953.html" target="n" data-glyph="104,1" class="i property">DescendingOrder</a>
        {
            <b>get</b> { <b>return</b> !<a href="#c533529a4dfc78d6" class="i field">_ascending</a>; }
 
            <b>set</b> { <a href="#c533529a4dfc78d6" class="i field">_ascending</a> = !<b>value</b>; }
        }
 
        <b>private bool</b> <a id="c533529a4dfc78d6" href="../../R/c533529a4dfc78d6.html" target="n" data-glyph="46,1" class="i field">_ascending</a> = <b>true</b>;
 
        <b>internal</b> <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="224d85002d7ee013" href="../../R/224d85002d7ee013.html" target="n" data-glyph="104,1" class="i property">InputObjects</a> { <b>get</b>; } = <b>new</b> <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> CultureInfo converted from the Culture Cmdlet parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">CultureInfo</span> <a id="d5cf1f42802a4e0d" href="../../R/d5cf1f42802a4e0d.html" target="n" data-glyph="104,1" class="i property">ConvertedCulture</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#dce766f286e370b0" class="i field">_cultureInfo</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Simply accumulates the incoming objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="dbcd3125ebc5050e" href="../../R/dbcd3125ebc5050e.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#5001d7bd9f0b9c5c" class="i property">InputObject</a> != <b>null</b> &amp;&amp; <a href="#5001d7bd9f0b9c5c" class="i property">InputObject</a> != <a href="/System.Management.Automation/A.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="/System.Management.Automation/A.html#1cf7e193da582896" class="i property">Value</a>)
            {
                <a href="#224d85002d7ee013" class="i property">InputObjects</a>.<span class="i">Add</span>(<a href="#5001d7bd9f0b9c5c" class="i property">InputObject</a>);
            }
        }
    }
 
    <b>internal sealed class</b> <a id="fb7a401bf9218a2c" href="../../R/fb7a401bf9218a2c.html" target="n" data-glyph="2,0" class="t t">OrderByProperty</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A logical matrix where each row is an input object and its property values specified by Properties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a>&gt; <a id="84955dfc4735f551" href="../../R/84955dfc4735f551.html" target="n" data-glyph="104,1" class="i property">OrderMatrix</a> { <b>get</b>; }
 
        <b>internal</b> <a href="#c3c5b617b6c8cced" class="t t">OrderByPropertyComparer</a> <a id="43bbfc5a86b212de" href="../../R/43bbfc5a86b212de.html" target="n" data-glyph="104,1" class="i property">Comparer</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <a id="22b28e2c72a17824" href="../../R/22b28e2c72a17824.html" target="n" data-glyph="104,1" class="i property">MshParameterList</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#36f585f104110ee6" class="i field">_mshParameterList</a>;
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Utils
        <span class="c">// These are made static for Measure-Object&#39;s GroupBy parameter that measure the outputs of Group-Object</span>
        <span class="c">// However, Measure-Object differs from Group-Object and Sort-Object considerably that it should not</span>
        <span class="c">// be built on the same base class, i.e., this class. Moreover, Measure-Object&#39;s Property parameter is</span>
        <span class="c">// a string array and allows wildcard.</span>
        <span class="c">// Yes, the Cmdlet is needed. It&#39;s used to get the TerminatingErrorContext, WriteError and WriteDebug.</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> process PSPropertyExpression and MshParameter
 
        <b>private static void</b> <a id="3b37289c01bb3319" href="../../R/3b37289c01bb3319.html" target="n" data-glyph="76,1" class="i method">ProcessExpressionParameter</a>(
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r2 rd" class="r2 r">inputObjects</span>,
            <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r3 rd" class="r3 r">cmdlet</span>,
            <b>object</b>[] <span id="r4 rd" class="r4 r">expr</span>,
            <b>out</b> <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <span id="r5 rd" class="r5 r">mshParameterList</span>)
        {
            <span class="r5 r">mshParameterList</span> = <b>null</b>;
            <span class="i">TerminatingErrorContext</span> <span id="r6 rd" class="r6 r">invocationContext</span> = <b>new</b>(<span class="r3 r">cmdlet</span>);
            <span class="c">// compare-object and group-object use the same definition here</span>
            <span class="i">ParameterProcessor</span> <span id="r7 rd" class="r7 r">processor</span> = <span class="r3 r">cmdlet</span> <b>is</b> <a href="Sort-Object.cs.html#a07572f6739fd343" class="t t">SortObjectCommand</a> ?
                <b>new</b> <span class="i">ParameterProcessor</span>(<b>new</b> <span class="t">SortObjectExpressionParameterDefinition</span>()) :
                <b>new</b> <span class="i">ParameterProcessor</span>(<b>new</b> <span class="t">GroupObjectExpressionParameterDefinition</span>());
 
            <b>if</b> (<span class="r4 r">expr</span> == <b>null</b> &amp;&amp; <span class="r2 r">inputObjects</span> != <b>null</b> &amp;&amp; <span class="r2 r">inputObjects</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r4 r">expr</span> = <span class="i">GetDefaultKeyPropertySet</span>(<span class="r2 r">inputObjects</span>[0]);
            }
 
            <b>if</b> (<span class="r4 r">expr</span> != <b>null</b>)
            {
                <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <span id="r8 rd" class="r8 r">unexpandedParameterList</span> = <span class="r7 r">processor</span>.<span class="i">ProcessParameters</span>(<span class="r4 r">expr</span>, <span class="r6 r">invocationContext</span>);
                <span class="r5 r">mshParameterList</span> = <a href="#febc11701fccae33" class="i method">ExpandExpressions</a>(<span class="r2 r">inputObjects</span>, <span class="r8 r">unexpandedParameterList</span>);
            }
            <span class="c">// NOTE: if no parameters are passed, we will look at the default keys of the first</span>
            <span class="c">// incoming object</span>
        }
 
        <b>internal void</b> <a id="5a5ab8cf1565d40d" href="../../R/5a5ab8cf1565d40d.html" target="n" data-glyph="74,1" class="i method">ProcessExpressionParameter</a>(
            <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r9 rd" class="r9 r">cmdlet</span>,
            <b>object</b>[] <span id="r10 rd" class="r10 r">expr</span>)
        {
            <span class="i">TerminatingErrorContext</span> <span id="r11 rd" class="r11 r">invocationContext</span> = <b>new</b>(<span class="r9 r">cmdlet</span>);
            <span class="c">// compare-object and group-object use the same definition here</span>
            <span class="i">ParameterProcessor</span> <span id="r12 rd" class="r12 r">processor</span> = <span class="r9 r">cmdlet</span> <b>is</b> <a href="Sort-Object.cs.html#a07572f6739fd343" class="t t">SortObjectCommand</a> ?
                <b>new</b> <span class="i">ParameterProcessor</span>(<b>new</b> <span class="t">SortObjectExpressionParameterDefinition</span>()) :
                <b>new</b> <span class="i">ParameterProcessor</span>(<b>new</b> <span class="t">GroupObjectExpressionParameterDefinition</span>());
 
            <b>if</b> (<span class="r10 r">expr</span> != <b>null</b>)
            {
                <b>if</b> (<a href="#9935fd880fe10ff3" class="i field">_unexpandedParameterList</a> == <b>null</b>)
                {
                    <a href="#9935fd880fe10ff3" class="i field">_unexpandedParameterList</a> = <span class="r12 r">processor</span>.<span class="i">ProcessParameters</span>(<span class="r10 r">expr</span>, <span class="r11 r">invocationContext</span>);
 
                    <b>foreach</b> (<span class="i">MshParameter</span> <span id="r13 rd" class="r13 r">unexpandedParameter</span> <b>in</b> <a href="#9935fd880fe10ff3" class="i field">_unexpandedParameterList</a>)
                    {
                        <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r14 rd" class="r14 r">mshExpression</span> = (<a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a>)<span class="r13 r">unexpandedParameter</span>.<span class="i">GetEntry</span>(<span class="i">FormatParameterDefinitionKeys</span>.<span class="i">ExpressionEntryKey</span>);
                        <b>if</b> (!<span class="r14 r">mshExpression</span>.<a href="/System.Management.Automation/A.html#64da33e9633799a8" class="i property">HasWildCardCharacters</a>) <span class="c">// this special cases 1) script blocks and 2) wildcard-less strings</span>
                        {
                            <a href="#36f585f104110ee6" class="i field">_mshParameterList</a>.<span class="i">Add</span>(<span class="r13 r">unexpandedParameter</span>);
                        }
                        <b>else</b>
                        {
                            <b>if</b> (<a href="#686eeb0e6cbaac13" class="i field">_unExpandedParametersWithWildCardPattern</a> == <b>null</b>)
                            {
                                <a href="#686eeb0e6cbaac13" class="i field">_unExpandedParametersWithWildCardPattern</a> = <b>new</b> <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt;();
                            }
 
                            <a href="#686eeb0e6cbaac13" class="i field">_unExpandedParametersWithWildCardPattern</a>.<span class="i">Add</span>(<span class="r13 r">unexpandedParameter</span>);
                        }
                    }
                }
            }
        }
 
        <span class="c">// Expand a list of (possibly wildcarded) expressions into resolved expressions that</span>
        <span class="c">// match property names on the incoming objects.</span>
        <b>private static</b> <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <a id="febc11701fccae33" href="../../R/febc11701fccae33.html" target="n" data-glyph="76,1" class="i method">ExpandExpressions</a>(<span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r15 rd" class="r15 r">inputObjects</span>, <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <span id="r16 rd" class="r16 r">unexpandedParameterList</span>)
        {
            <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <span id="r17 rd" class="r17 r">expandedParameterList</span> = <b>new</b>();
 
            <b>if</b> (<span class="r16 r">unexpandedParameterList</span> != <b>null</b>)
            {
                <b>foreach</b> (<span class="i">MshParameter</span> <span id="r18 rd" class="r18 r">unexpandedParameter</span> <b>in</b> <span class="r16 r">unexpandedParameterList</span>)
                {
                    <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r19 rd" class="r19 r">ex</span> = (<a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a>)<span class="r18 r">unexpandedParameter</span>.<span class="i">GetEntry</span>(<span class="i">FormatParameterDefinitionKeys</span>.<span class="i">ExpressionEntryKey</span>);
                    <b>if</b> (!<span class="r19 r">ex</span>.<a href="/System.Management.Automation/A.html#64da33e9633799a8" class="i property">HasWildCardCharacters</a>) <span class="c">// this special cases 1) script blocks and 2) wildcard-less strings</span>
                    {
                        <span class="r17 r">expandedParameterList</span>.<span class="i">Add</span>(<span class="r18 r">unexpandedParameter</span>);
                    }
                    <b>else</b>
                    {
                        <span class="i">SortedDictionary</span>&lt;<b>string</b>, <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a>&gt; <span id="r20 rd" class="r20 r">expandedPropertyNames</span> = <b>new</b>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                        <b>if</b> (<span class="r15 r">inputObjects</span> != <b>null</b>)
                        {
                            <b>foreach</b> (<b>object</b> <span id="r21 rd" class="r21 r">inputObject</span> <b>in</b> <span class="r15 r">inputObjects</span>)
                            {
                                <b>if</b> (<span class="r21 r">inputObject</span> == <b>null</b>)
                                {
                                    <b>continue</b>;
                                }
 
                                <b>foreach</b> (<a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r22 rd" class="r22 r">resolvedName</span> <b>in</b> <span class="r19 r">ex</span>.<span class="i">ResolveNames</span>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">AsPSObject</span>(<span class="r21 r">inputObject</span>)))
                                {
                                    <span class="r20 r">expandedPropertyNames</span>[<span class="r22 r">resolvedName</span>.<span class="i">ToString</span>()] = <span class="r22 r">resolvedName</span>;
                                }
                            }
                        }
 
                        <b>foreach</b> (<a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r23 rd" class="r23 r">expandedExpression</span> <b>in</b> <span class="r20 r">expandedPropertyNames</span>.<span class="i">Values</span>)
                        {
                            <span class="i">MshParameter</span> <span id="r24 rd" class="r24 r">expandedParameter</span> = <b>new</b>();
                            <span class="r24 r">expandedParameter</span>.<span class="i">hash</span> = (<span class="i">Hashtable</span>)<span class="r18 r">unexpandedParameter</span>.<span class="i">hash</span>.<span class="i">Clone</span>();
                            <span class="r24 r">expandedParameter</span>.<span class="i">hash</span>[<span class="i">FormatParameterDefinitionKeys</span>.<span class="i">ExpressionEntryKey</span>] = <span class="r23 r">expandedExpression</span>;
 
                            <span class="r17 r">expandedParameterList</span>.<span class="i">Add</span>(<span class="r24 r">expandedParameter</span>);
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r17 r">expandedParameterList</span>;
        }
 
        <span class="c">// Expand a list of (possibly wildcarded) expressions into resolved expressions that</span>
        <span class="c">// match property names on the incoming objects.</span>
        <b>private static void</b> <a id="00b9cb7fd92450e1" href="../../R/00b9cb7fd92450e1.html" target="n" data-glyph="76,1" class="i method">ExpandExpressions</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r25 rd" class="r25 r">inputObject</span>, <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <span id="r26 rd" class="r26 r">UnexpandedParametersWithWildCardPattern</span>, <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <span id="r27 rd" class="r27 r">expandedParameterList</span>)
        {
            <b>if</b> (<span class="r26 r">UnexpandedParametersWithWildCardPattern</span> != <b>null</b>)
            {
                <b>foreach</b> (<span class="i">MshParameter</span> <span id="r28 rd" class="r28 r">unexpandedParameter</span> <b>in</b> <span class="r26 r">UnexpandedParametersWithWildCardPattern</span>)
                {
                    <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r29 rd" class="r29 r">ex</span> = (<a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a>)<span class="r28 r">unexpandedParameter</span>.<span class="i">GetEntry</span>(<span class="i">FormatParameterDefinitionKeys</span>.<span class="i">ExpressionEntryKey</span>);
 
                    <span class="i">SortedDictionary</span>&lt;<b>string</b>, <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a>&gt; <span id="r30 rd" class="r30 r">expandedPropertyNames</span> = <b>new</b>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                    <b>if</b> (<span class="r25 r">inputObject</span> == <b>null</b>)
                    {
                        <b>continue</b>;
                    }
 
                    <b>foreach</b> (<a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r31 rd" class="r31 r">resolvedName</span> <b>in</b> <span class="r29 r">ex</span>.<span class="i">ResolveNames</span>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">AsPSObject</span>(<span class="r25 r">inputObject</span>)))
                    {
                        <span class="r30 r">expandedPropertyNames</span>[<span class="r31 r">resolvedName</span>.<span class="i">ToString</span>()] = <span class="r31 r">resolvedName</span>;
                    }
 
                    <b>foreach</b> (<a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r32 rd" class="r32 r">expandedExpression</span> <b>in</b> <span class="r30 r">expandedPropertyNames</span>.<span class="i">Values</span>)
                    {
                        <span class="i">MshParameter</span> <span id="r33 rd" class="r33 r">expandedParameter</span> = <b>new</b>();
                        <span class="r33 r">expandedParameter</span>.<span class="i">hash</span> = (<span class="i">Hashtable</span>)<span class="r28 r">unexpandedParameter</span>.<span class="i">hash</span>.<span class="i">Clone</span>();
                        <span class="r33 r">expandedParameter</span>.<span class="i">hash</span>[<span class="i">FormatParameterDefinitionKeys</span>.<span class="i">ExpressionEntryKey</span>] = <span class="r32 r">expandedExpression</span>;
 
                        <span class="r27 r">expandedParameterList</span>.<span class="i">Add</span>(<span class="r33 r">expandedParameter</span>);
                    }
                }
            }
        }
 
        <b>internal static string</b>[] <a id="e2d08031bf8948e5" href="../../R/e2d08031bf8948e5.html" target="n" data-glyph="74,1" class="i method">GetDefaultKeyPropertySet</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r34 rd" class="r34 r">mshObj</span>)
        {
            <a href="/System.Management.Automation/A.html#c0aa7acbc9a4a567" class="t t">PSMemberSet</a> <span id="r35 rd" class="r35 r">standardNames</span> = <span class="r34 r">mshObj</span>.<span class="i">PSStandardMembers</span>;
            <b>if</b> (<span class="r35 r">standardNames</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (!(<span class="r35 r">standardNames</span>.<a href="/System.Management.Automation/A.html#23ba75fd4c58af6c" class="i property">Members</a>[<span class="s">&quot;DefaultKeyPropertySet&quot;</span>] <b>is</b> <a href="/System.Management.Automation/A.html#c31cdd74ab6aa669" class="t t">PSPropertySet</a> <span id="r36 rd" class="r36 r">defaultKeys</span>))
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>string</b>[] <span id="r37 rd" class="r37 r">props</span> = <b>new</b> <b>string</b>[<span class="r36 r">defaultKeys</span>.<a href="/System.Management.Automation/A.html#0928c39b9a095520" class="i property">ReferencedPropertyNames</a>.<span class="i">Count</span>];
            <span class="r36 r">defaultKeys</span>.<a href="/System.Management.Automation/A.html#0928c39b9a095520" class="i property">ReferencedPropertyNames</a>.<span class="i">CopyTo</span>(<span class="r37 r">props</span>, 0);
            <b>return</b> <span class="r37 r">props</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> process PSPropertyExpression and MshParameter
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a>&gt; <a id="1251f801ed09d9f7" href="../../R/1251f801ed09d9f7.html" target="n" data-glyph="74,1" class="i method">CreateOrderMatrix</a>(
            <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r38 rd" class="r38 r">cmdlet</span>,
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r39 rd" class="r39 r">inputObjects</span>,
            <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <span id="r40 rd" class="r40 r">mshParameterList</span>
            )
        {
            <span class="i">List</span>&lt;<a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a>&gt; <span id="r41 rd" class="r41 r">orderMatrixToCreate</span> = <b>new</b>();
            <b>for</b> (<b>int</b> <span id="r42 rd" class="r42 r">index</span> = 0; <span class="r42 r">index</span> &lt; <span class="r39 r">inputObjects</span>.<span class="i">Count</span>; <span class="r42 r">index</span>++)
            {
                <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r43 rd" class="r43 r">so</span> = <span class="r39 r">inputObjects</span>[<span class="r42 r">index</span>];
                <b>if</b> (<span class="r43 r">so</span> == <b>null</b> || <span class="r43 r">so</span> == <a href="/System.Management.Automation/A.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="/System.Management.Automation/A.html#1cf7e193da582896" class="i property">Value</a>)
                    <b>continue</b>;
                <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r44 rd" class="r44 r">evaluationErrors</span> = <b>new</b>();
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r45 rd" class="r45 r">propertyNotFoundMsgs</span> = <b>new</b>();
                <a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a> <span id="r46 rd" class="r46 r">result</span> =
                    <a href="#49b60a6697d4879f" class="t t">OrderByPropertyEntryEvaluationHelper</a>.<a href="#87f8a747a03c6f2e" class="i method">ProcessObject</a>(<span class="r43 r">so</span>, <span class="r40 r">mshParameterList</span>, <span class="r44 r">evaluationErrors</span>, <span class="r45 r">propertyNotFoundMsgs</span>, <span class="r47 r">originalIndex</span>: <span class="r42 r">index</span>);
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r48 rd" class="r48 r">err</span> <b>in</b> <span class="r44 r">evaluationErrors</span>)
                {
                    <span class="r38 r">cmdlet</span>.<span class="i">WriteError</span>(<span class="r48 r">err</span>);
                }
 
                <b>foreach</b> (<b>string</b> <span id="r49 rd" class="r49 r">debugMsg</span> <b>in</b> <span class="r45 r">propertyNotFoundMsgs</span>)
                {
                    <span class="r38 r">cmdlet</span>.<span class="i">WriteDebug</span>(<span class="r49 r">debugMsg</span>);
                }
 
                <span class="r41 r">orderMatrixToCreate</span>.<span class="i">Add</span>(<span class="r46 r">result</span>);
            }
 
            <b>return</b> <span class="r41 r">orderMatrixToCreate</span>;
        }
 
        <b>private static bool</b> <a id="6872efb742476fb2" href="../../R/6872efb742476fb2.html" target="n" data-glyph="76,1" class="i method">isOrderEntryKeyDefined</a>(<b>object</b> <span id="r50 rd" class="r50 r">orderEntryKey</span>)
        {
            <b>return</b> <span class="r50 r">orderEntryKey</span> != <b>null</b> &amp;&amp; <span class="r50 r">orderEntryKey</span> != <a href="/System.Management.Automation/A.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="/System.Management.Automation/A.html#1cf7e193da582896" class="i property">Value</a>;
        }
 
        <b>private static</b> <a href="#c3c5b617b6c8cced" class="t t">OrderByPropertyComparer</a> <a id="64f7cecaa8d64310" href="../../R/64f7cecaa8d64310.html" target="n" data-glyph="76,1" class="i method">CreateComparer</a>(
            <span class="i">List</span>&lt;<a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a>&gt; <span id="r51 rd" class="r51 r">orderMatrix</span>,
            <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <span id="r52 rd" class="r52 r">mshParameterList</span>,
            <b>bool</b> <span id="r53 rd" class="r53 r">ascending</span>,
            <span class="i">CultureInfo</span> <span id="r54 rd" class="r54 r">cultureInfo</span>,
            <b>bool</b> <span id="r55 rd" class="r55 r">caseSensitive</span>)
        {
            <b>if</b> (<span class="r51 r">orderMatrix</span> == <b>null</b> || <span class="r51 r">orderMatrix</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>bool</b>?[] <span id="r56 rd" class="r56 r">ascendingOverrides</span> = <b>null</b>;
            <b>if</b> (<span class="r52 r">mshParameterList</span> != <b>null</b> &amp;&amp; <span class="r52 r">mshParameterList</span>.<span class="i">Count</span> != 0)
            {
                <span class="r56 r">ascendingOverrides</span> = <b>new</b> <b>bool</b>?[<span class="r52 r">mshParameterList</span>.<span class="i">Count</span>];
                <b>for</b> (<b>int</b> <span id="r57 rd" class="r57 r">k</span> = 0; <span class="r57 r">k</span> &lt; <span class="r56 r">ascendingOverrides</span>.<span class="i">Length</span>; <span class="r57 r">k</span>++)
                {
                    <b>object</b> <span id="r58 rd" class="r58 r">ascendingVal</span> = <span class="r52 r">mshParameterList</span>[<span class="r57 r">k</span>].<span class="i">GetEntry</span>(
                        <a href="#5d4c494ae1f45a26" class="t t">SortObjectParameterDefinitionKeys</a>.<a href="#5586e831e7f66cc2" class="i field">AscendingEntryKey</a>);
                    <b>object</b> <span id="r59 rd" class="r59 r">descendingVal</span> = <span class="r52 r">mshParameterList</span>[<span class="r57 r">k</span>].<span class="i">GetEntry</span>(
                        <a href="#5d4c494ae1f45a26" class="t t">SortObjectParameterDefinitionKeys</a>.<a href="#7693b43e7c69a500" class="i field">DescendingEntryKey</a>);
                    <b>bool</b> <span id="r60 rd" class="r60 r">isAscendingDefined</span> = <a href="#6872efb742476fb2" class="i method">isOrderEntryKeyDefined</a>(<span class="r58 r">ascendingVal</span>);
                    <b>bool</b> <span id="r61 rd" class="r61 r">isDescendingDefined</span> = <a href="#6872efb742476fb2" class="i method">isOrderEntryKeyDefined</a>(<span class="r59 r">descendingVal</span>);
                    <b>if</b> (!<span class="r60 r">isAscendingDefined</span> &amp;&amp; !<span class="r61 r">isDescendingDefined</span>)
                    {
                        <span class="c">// if neither ascending nor descending is defined</span>
                        <span class="r56 r">ascendingOverrides</span>[<span class="r57 r">k</span>] = <b>null</b>;
                    }
                    <b>else</b> <b>if</b> (<span class="r60 r">isAscendingDefined</span> &amp;&amp; <span class="r61 r">isDescendingDefined</span> &amp;&amp;
                        (<b>bool</b>)<span class="r58 r">ascendingVal</span> == (<b>bool</b>)<span class="r59 r">descendingVal</span>)
                    {
                        <span class="c">// if both ascending and descending defined but their values conflict</span>
                        <span class="c">// they are ignored.</span>
                        <span class="r56 r">ascendingOverrides</span>[<span class="r57 r">k</span>] = <b>null</b>;
                    }
                    <b>else</b> <b>if</b> (<span class="r60 r">isAscendingDefined</span>)
                    {
                        <span class="r56 r">ascendingOverrides</span>[<span class="r57 r">k</span>] = (<b>bool</b>)<span class="r58 r">ascendingVal</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r56 r">ascendingOverrides</span>[<span class="r57 r">k</span>] = !(<b>bool</b>)<span class="r59 r">descendingVal</span>;
                    }
                }
            }
 
            <a href="#c3c5b617b6c8cced" class="t t">OrderByPropertyComparer</a> <span id="r62 rd" class="r62 r">comparer</span> =
                <a href="#c3c5b617b6c8cced" class="t t">OrderByPropertyComparer</a>.<a href="#7997e9ff6138eeff" class="i method">CreateComparer</a>(<span class="r51 r">orderMatrix</span>, <span class="r53 r">ascending</span>,
                <span class="r56 r">ascendingOverrides</span>, <span class="r54 r">cultureInfo</span>, <span class="r55 r">caseSensitive</span>);
 
            <b>return</b> <span class="r62 r">comparer</span>;
        }
 
        <b>internal</b> <a id="dd35f1d7e06cf58c" href="../../R/dd35f1d7e06cf58c.html" target="n" data-glyph="74,1" class="t constructor">OrderByProperty</a>(
            <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r63 rd" class="r63 r">cmdlet</span>,
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r64 rd" class="r64 r">inputObjects</span>,
            <b>object</b>[] <span id="r65 rd" class="r65 r">expr</span>,
            <b>bool</b> <span id="r66 rd" class="r66 r">ascending</span>,
            <span class="i">CultureInfo</span> <span id="r67 rd" class="r67 r">cultureInfo</span>,
            <b>bool</b> <span id="r68 rd" class="r68 r">caseSensitive</span>
            )
        {
            <span class="i">Diagnostics</span>.<span class="i">Assert</span>(<span class="r63 r">cmdlet</span> != <b>null</b>, <span class="s">&quot;cmdlet must be an instance&quot;</span>);
 
            <a href="#3b37289c01bb3319" class="i method">ProcessExpressionParameter</a>(<span class="r64 r">inputObjects</span>, <span class="r63 r">cmdlet</span>, <span class="r65 r">expr</span>, <b>out</b> <a href="#36f585f104110ee6" class="i field">_mshParameterList</a>);
            <a href="#84955dfc4735f551" class="i property">OrderMatrix</a> = <a href="#1251f801ed09d9f7" class="i method">CreateOrderMatrix</a>(<span class="r63 r">cmdlet</span>, <span class="r64 r">inputObjects</span>, <a href="#36f585f104110ee6" class="i field">_mshParameterList</a>);
            <a href="#43bbfc5a86b212de" class="i property">Comparer</a> = <a href="#64f7cecaa8d64310" class="i method">CreateComparer</a>(<a href="#84955dfc4735f551" class="i property">OrderMatrix</a>, <a href="#36f585f104110ee6" class="i field">_mshParameterList</a>, <span class="r66 r">ascending</span>, <span class="r67 r">cultureInfo</span>, <span class="r68 r">caseSensitive</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#fb7a401bf9218a2c" class="t t">OrderByProperty</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="e973ced46cc75fda" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">OrderByProperty</a>()
        {
            <a href="#36f585f104110ee6" class="i field">_mshParameterList</a> = <b>new</b> <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt;();
            <a href="#84955dfc4735f551" class="i property">OrderMatrix</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a>&gt;();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Utility function used to create OrderByPropertyEntry for the supplied input object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">cmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSCmdlet.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">inputObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Input Object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">isCaseSensitive</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicates if the Property value comparisons need to be case sensitive or not.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">cultureInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Culture Info that needs to be used for comparison.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">OrderByPropertyEntry for the supplied InputObject.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a> <a id="6b652d1bae505130" href="../../R/6b652d1bae505130.html" target="n" data-glyph="74,1" class="i method">CreateOrderByPropertyEntry</a>(
            <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a> <span id="r69 rd" class="r69 r">cmdlet</span>,
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r70 rd" class="r70 r">inputObject</span>,
            <b>bool</b> <span id="r71 rd" class="r71 r">isCaseSensitive</span>,
            <span class="i">CultureInfo</span> <span id="r72 rd" class="r72 r">cultureInfo</span>)
        {
            <span class="i">Diagnostics</span>.<span class="i">Assert</span>(<span class="r69 r">cmdlet</span> != <b>null</b>, <span class="s">&quot;cmdlet must be an instance&quot;</span>);
 
            <b>if</b> (<a href="#686eeb0e6cbaac13" class="i field">_unExpandedParametersWithWildCardPattern</a> != <b>null</b>)
            {
                <a href="#00b9cb7fd92450e1" class="i method">ExpandExpressions</a>(<span class="r70 r">inputObject</span>, <a href="#686eeb0e6cbaac13" class="i field">_unExpandedParametersWithWildCardPattern</a>, <a href="#36f585f104110ee6" class="i field">_mshParameterList</a>);
            }
 
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r73 rd" class="r73 r">evaluationErrors</span> = <b>new</b>();
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r74 rd" class="r74 r">propertyNotFoundMsgs</span> = <b>new</b>();
            <a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a> <span id="r75 rd" class="r75 r">result</span> =
                <a href="#49b60a6697d4879f" class="t t">OrderByPropertyEntryEvaluationHelper</a>.<a href="#87f8a747a03c6f2e" class="i method">ProcessObject</a>(<span class="r70 r">inputObject</span>, <a href="#36f585f104110ee6" class="i field">_mshParameterList</a>, <span class="r73 r">evaluationErrors</span>, <span class="r74 r">propertyNotFoundMsgs</span>, <span class="r71 r">isCaseSensitive</span>, <span class="r72 r">cultureInfo</span>);
            <b>foreach</b> (<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r76 rd" class="r76 r">err</span> <b>in</b> <span class="r73 r">evaluationErrors</span>)
            {
                <span class="r69 r">cmdlet</span>.<span class="i">WriteError</span>(<span class="r76 r">err</span>);
            }
 
            <b>foreach</b> (<b>string</b> <span id="r77 rd" class="r77 r">debugMsg</span> <b>in</b> <span class="r74 r">propertyNotFoundMsgs</span>)
            {
                <span class="r69 r">cmdlet</span>.<span class="i">WriteDebug</span>(<span class="r77 r">debugMsg</span>);
            }
 
            <b>return</b> <span class="r75 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Utils
 
        <span class="c">// list of processed parameters obtained from the Expression array</span>
        <b>private readonly</b> <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <a id="36f585f104110ee6" href="../../R/36f585f104110ee6.html" target="n" data-glyph="46,1" class="i field">_mshParameterList</a> = <b>null</b>;
 
        <span class="c">// list of unprocessed parameters obtained from the Expression array.</span>
        <b>private</b> <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <a id="9935fd880fe10ff3" href="../../R/9935fd880fe10ff3.html" target="n" data-glyph="46,1" class="i field">_unexpandedParameterList</a> = <b>null</b>;
 
        <span class="c">// list of unprocessed parameters with wild card patterns.</span>
        <b>private</b> <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <a id="686eeb0e6cbaac13" href="../../R/686eeb0e6cbaac13.html" target="n" data-glyph="46,1" class="i field">_unExpandedParametersWithWildCardPattern</a> = <b>null</b>;
    }
 
    <b>internal static class</b> <a id="49b60a6697d4879f" href="../../R/49b60a6697d4879f.html" target="n" data-glyph="2,0" class="t t">OrderByPropertyEntryEvaluationHelper</a>
    {
        <b>internal static</b> <a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a> <a id="87f8a747a03c6f2e" href="../../R/87f8a747a03c6f2e.html" target="n" data-glyph="74,1" class="i method">ProcessObject</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r78 rd" class="r78 r">inputObject</span>, <span class="i">List</span>&lt;<span class="i">MshParameter</span>&gt; <span id="r79 rd" class="r79 r">mshParameterList</span>,
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r80 rd" class="r80 r">errors</span>, <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r81 rd" class="r81 r">propertyNotFoundMsgs</span>, <b>bool</b> <span id="r82 rd" class="r82 r">isCaseSensitive</span> = <b>false</b>, <span class="i">CultureInfo</span> <span id="r83 rd" class="r83 r">cultureInfo</span> = <b>null</b>, <b>int</b> <span id="r47 rd" class="r47 r">originalIndex</span> = -1)
        {
            <span class="i">Diagnostics</span>.<span class="i">Assert</span>(<span class="r80 r">errors</span> != <b>null</b>, <span class="s">&quot;errors cannot be null!&quot;</span>);
            <span class="i">Diagnostics</span>.<span class="i">Assert</span>(<span class="r81 r">propertyNotFoundMsgs</span> != <b>null</b>, <span class="s">&quot;propertyNotFoundMsgs cannot be null!&quot;</span>);
            <a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a> <span id="r84 rd" class="r84 r">entry</span> = <b>new</b>();
            <span class="r84 r">entry</span>.<a href="#a5be6beb61d7a005" class="i field">inputObject</a> = <span class="r78 r">inputObject</span>;
            <span class="r84 r">entry</span>.<a href="#50199c0f773f431a" class="i field">originalIndex</a> = <span class="r47 r">originalIndex</span>;
 
            <b>if</b> (<span class="r79 r">mshParameterList</span> == <b>null</b> || <span class="r79 r">mshParameterList</span>.<span class="i">Count</span> == 0)
            {
                <span class="c">// we do not have a property to evaluate, we sort on $_</span>
                <span class="r84 r">entry</span>.<a href="#2a0292c8c6670757" class="i field">orderValues</a>.<span class="i">Add</span>(<b>new</b> <a href="ObjectCommandComparer.cs.html#f4354ce8249d9a0a" class="t constructor">ObjectCommandPropertyValue</a>(<span class="r78 r">inputObject</span>, <span class="r82 r">isCaseSensitive</span>, <span class="r83 r">cultureInfo</span>));
                <span class="r84 r">entry</span>.<a href="#3ad32c1a93104565" class="i field">comparable</a> = <b>true</b>;
                <b>return</b> <span class="r84 r">entry</span>;
            }
 
            <span class="c">// we need to compute the properties</span>
            <b>foreach</b> (<span class="i">MshParameter</span> <span id="r85 rd" class="r85 r">p</span> <b>in</b> <span class="r79 r">mshParameterList</span>)
            {
                <b>string</b> <span id="r86 rd" class="r86 r">propertyNotFoundMsg</span> = <b>null</b>;
                <a href="#25db772f15c48798" class="i method">EvaluateSortingExpression</a>(<span class="r85 r">p</span>, <span class="r78 r">inputObject</span>, <span class="r84 r">entry</span>.<a href="#2a0292c8c6670757" class="i field">orderValues</a>, <span class="r80 r">errors</span>, <b>out</b> <span class="r86 r">propertyNotFoundMsg</span>, <b>ref</b> <span class="r84 r">entry</span>.<a href="#3ad32c1a93104565" class="i field">comparable</a>);
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r86 r">propertyNotFoundMsg</span>))
                {
                    <span class="r81 r">propertyNotFoundMsgs</span>.<span class="i">Add</span>(<span class="r86 r">propertyNotFoundMsg</span>);
                }
            }
 
            <b>return</b> <span class="r84 r">entry</span>;
        }
 
        <b>private static void</b> <a id="25db772f15c48798" href="../../R/25db772f15c48798.html" target="n" data-glyph="76,1" class="i method">EvaluateSortingExpression</a>(
            <span class="i">MshParameter</span> <span id="r87 rd" class="r87 r">p</span>,
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r88 rd" class="r88 r">inputObject</span>,
            <span class="i">List</span>&lt;<a href="ObjectCommandComparer.cs.html#fb50997d5096553a" class="t t">ObjectCommandPropertyValue</a>&gt; <span id="r89 rd" class="r89 r">orderValues</span>,
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <span id="r90 rd" class="r90 r">errors</span>,
            <b>out string</b> <span id="r91 rd" class="r91 r">propertyNotFoundMsg</span>,
            <b>ref bool</b> <span id="r92 rd" class="r92 r">comparable</span>)
        {
            <span class="c">// NOTE: we assume globbing was not allowed in input</span>
            <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a> <span id="r93 rd" class="r93 r">ex</span> = <span class="r87 r">p</span>.<span class="i">GetEntry</span>(<span class="i">FormatParameterDefinitionKeys</span>.<span class="i">ExpressionEntryKey</span>) <b>as</b> <a href="/System.Management.Automation/A.html#52be71f6c3a4a3d9" class="t t">PSPropertyExpression</a>;
 
            <span class="c">// get the values, but do not expand aliases</span>
            <span class="i">List</span>&lt;<a href="/System.Management.Automation/A.html#32098d49a681ff30" class="t t">PSPropertyExpressionResult</a>&gt; <span id="r94 rd" class="r94 r">expressionResults</span> = <span class="r93 r">ex</span>.<span class="i">GetValues</span>(<span class="r88 r">inputObject</span>, <b>false</b>, <b>true</b>);
 
            <b>if</b> (<span class="r94 r">expressionResults</span>.<span class="i">Count</span> == 0)
            {
                <span class="c">// we did not get any result out of the expression:</span>
                <span class="c">// we enter a null as a place holder</span>
                <span class="r89 r">orderValues</span>.<span class="i">Add</span>(<a href="ObjectCommandComparer.cs.html#fb50997d5096553a" class="t t">ObjectCommandPropertyValue</a>.<a href="ObjectCommandComparer.cs.html#c6d9ab30e9e6bb76" class="i field">NonExistingProperty</a>);
                <span class="r91 r">propertyNotFoundMsg</span> = <span class="i">StringUtil</span>.<span class="i">Format</span>(<span class="i">SortObjectStrings</span>.<span class="i">PropertyNotFound</span>, <span class="r93 r">ex</span>.<span class="i">ToString</span>());
                <b>return</b>;
            }
 
            <span class="r91 r">propertyNotFoundMsg</span> = <b>null</b>;
            <span class="c">// we obtained some results, enter them into the list</span>
            <b>foreach</b> (<a href="/System.Management.Automation/A.html#32098d49a681ff30" class="t t">PSPropertyExpressionResult</a> <span id="r95 rd" class="r95 r">r</span> <b>in</b> <span class="r94 r">expressionResults</span>)
            {
                <b>if</b> (<span class="r95 r">r</span>.<a href="/System.Management.Automation/A.html#a35b9dec64c079ad" class="i property">Exception</a> == <b>null</b>)
                {
                    <span class="r89 r">orderValues</span>.<span class="i">Add</span>(<b>new</b> <a href="ObjectCommandComparer.cs.html#c51350afff65fc0e" class="t constructor">ObjectCommandPropertyValue</a>(<span class="r95 r">r</span>.<a href="/System.Management.Automation/A.html#5ffe7f472d198e60" class="i property">Result</a>));
                }
                <b>else</b>
                {
                    <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r96 rd" class="r96 r">errorRecord</span> = <b>new</b>(
                        <span class="r95 r">r</span>.<a href="/System.Management.Automation/A.html#a35b9dec64c079ad" class="i property">Exception</a>,
                        <span class="s">&quot;ExpressionEvaluation&quot;</span>,
                        <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#f33f25c3453e2e98" class="i field">InvalidResult</a>,
                        <span class="r88 r">inputObject</span>);
                    <span class="r90 r">errors</span>.<span class="i">Add</span>(<span class="r96 r">errorRecord</span>);
                    <span class="r89 r">orderValues</span>.<span class="i">Add</span>(<a href="ObjectCommandComparer.cs.html#fb50997d5096553a" class="t t">ObjectCommandPropertyValue</a>.<a href="ObjectCommandComparer.cs.html#d838c491343a54fc" class="i field">ExistingNullProperty</a>);
                }
 
                <span class="r92 r">comparable</span> = <b>true</b>;
            }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This is the row of the OrderMatrix.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="18901baf821e49cd" href="../../R/18901baf821e49cd.html" target="n" data-glyph="2,0" class="t t"><span id="ed3e33e63f565a9f">OrderByPropertyEntry</span></a>
    {
        <b>internal</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="a5be6beb61d7a005" href="../../R/a5be6beb61d7a005.html" target="n" data-glyph="44,1" class="i field">inputObject</a> = <b>null</b>;
        <b>internal</b> <span class="i">List</span>&lt;<a href="ObjectCommandComparer.cs.html#fb50997d5096553a" class="t t">ObjectCommandPropertyValue</a>&gt; <a id="2a0292c8c6670757" href="../../R/2a0292c8c6670757.html" target="n" data-glyph="44,1" class="i field">orderValues</a> = <b>new</b>();
        <span class="c">// The originalIndex field was added to enable stable heap-sorts (Top N/Bottom N)</span>
        <b>internal int</b> <a id="50199c0f773f431a" href="../../R/50199c0f773f431a.html" target="n" data-glyph="44,1" class="i field">originalIndex</a> = -1;
 
        <span class="c">// The comparable field enables faster identification of uncomparable data</span>
        <b>internal bool</b> <a id="3ad32c1a93104565" href="../../R/3ad32c1a93104565.html" target="n" data-glyph="44,1" class="i field">comparable</a> = <b>false</b>;
    }
 
    <b>internal class</b> <a id="c3c5b617b6c8cced" href="../../R/c3c5b617b6c8cced.html" target="n" data-glyph="2,0" class="t t">OrderByPropertyComparer</a> : <span class="i">IComparer</span>&lt;<a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a>&gt;
    {
        <b>internal</b> <a id="10f0c9ff97884598" href="../../R/10f0c9ff97884598.html" target="n" data-glyph="74,1" class="t constructor">OrderByPropertyComparer</a>(<b>bool</b>[] <span id="r97 rd" class="r97 r">ascending</span>, <span class="i">CultureInfo</span> <span id="r98 rd" class="r98 r">cultureInfo</span>, <b>bool</b> <span id="r99 rd" class="r99 r">caseSensitive</span>)
        {
            <a href="#75349b669449e4fe" class="i field">_propertyComparers</a> = <b>new</b> <a href="ObjectCommandComparer.cs.html#5cf1141dfe247f39" class="t t">ObjectCommandComparer</a>[<span class="r97 r">ascending</span>.<span class="i">Length</span>];
            <b>for</b> (<b>int</b> <span id="r100 rd" class="r100 r">k</span> = 0; <span class="r100 r">k</span> &lt; <span class="r97 r">ascending</span>.<span class="i">Length</span>; <span class="r100 r">k</span>++)
            {
                <a href="#75349b669449e4fe" class="i field">_propertyComparers</a>[<span class="r100 r">k</span>] = <b>new</b> <a href="ObjectCommandComparer.cs.html#b682b6317142088c" class="t constructor">ObjectCommandComparer</a>(<span class="r97 r">ascending</span>[<span class="r100 r">k</span>], <span class="r98 r">cultureInfo</span>, <span class="r99 r">caseSensitive</span>);
            }
        }
 
        <b>public int</b> <a id="e598ac6caf3bbcf5" href="../../R/e598ac6caf3bbcf5.html" target="n" data-glyph="72,1" class="i method">Compare</a>(<a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a> <span id="r101 rd" class="r101 r">firstEntry</span>, <a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a> <span id="r102 rd" class="r102 r">secondEntry</span>)
        {
            <span class="c">// we have to take into consideration that some vectors</span>
            <span class="c">// might be shorter than others</span>
            <b>int</b> <span id="r103 rd" class="r103 r">order</span> = 0;
            <b>for</b> (<b>int</b> <span id="r104 rd" class="r104 r">k</span> = 0; <span class="r104 r">k</span> &lt; <a href="#75349b669449e4fe" class="i field">_propertyComparers</a>.<span class="i">Length</span>; <span class="r104 r">k</span>++)
            {
                <a href="ObjectCommandComparer.cs.html#fb50997d5096553a" class="t t">ObjectCommandPropertyValue</a> <span id="r105 rd" class="r105 r">firstValue</span> = (<span class="r104 r">k</span> &lt; <span class="r101 r">firstEntry</span>.<a href="#2a0292c8c6670757" class="i field">orderValues</a>.<span class="i">Count</span>) ?
                    <span class="r101 r">firstEntry</span>.<a href="#2a0292c8c6670757" class="i field">orderValues</a>[<span class="r104 r">k</span>] : <a href="ObjectCommandComparer.cs.html#fb50997d5096553a" class="t t">ObjectCommandPropertyValue</a>.<a href="ObjectCommandComparer.cs.html#c6d9ab30e9e6bb76" class="i field">NonExistingProperty</a>;
                <a href="ObjectCommandComparer.cs.html#fb50997d5096553a" class="t t">ObjectCommandPropertyValue</a> <span id="r106 rd" class="r106 r">secondValue</span> = (<span class="r104 r">k</span> &lt; <span class="r102 r">secondEntry</span>.<a href="#2a0292c8c6670757" class="i field">orderValues</a>.<span class="i">Count</span>) ?
                    <span class="r102 r">secondEntry</span>.<a href="#2a0292c8c6670757" class="i field">orderValues</a>[<span class="r104 r">k</span>] : <a href="ObjectCommandComparer.cs.html#fb50997d5096553a" class="t t">ObjectCommandPropertyValue</a>.<a href="ObjectCommandComparer.cs.html#c6d9ab30e9e6bb76" class="i field">NonExistingProperty</a>;
                <span class="r103 r">order</span> = <a href="#75349b669449e4fe" class="i field">_propertyComparers</a>[<span class="r104 r">k</span>].<a href="ObjectCommandComparer.cs.html#c5306564df7b2b31" class="i method">Compare</a>(<span class="r105 r">firstValue</span>, <span class="r106 r">secondValue</span>);
 
                <b>if</b> (<span class="r103 r">order</span> != 0)
                    <b>return</b> <span class="r103 r">order</span>;
            }
 
            <b>return</b> <span class="r103 r">order</span>;
        }
 
        <b>internal static</b> <a href="#c3c5b617b6c8cced" class="t t">OrderByPropertyComparer</a> <a id="7997e9ff6138eeff" href="../../R/7997e9ff6138eeff.html" target="n" data-glyph="74,1" class="i method">CreateComparer</a>(<span class="i">List</span>&lt;<a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a>&gt; <span id="r107 rd" class="r107 r">orderMatrix</span>, <b>bool</b> <span id="r108 rd" class="r108 r">ascendingFlag</span>, <b>bool</b>?[] <span id="r109 rd" class="r109 r">ascendingOverrides</span>, <span class="i">CultureInfo</span> <span id="r110 rd" class="r110 r">cultureInfo</span>, <b>bool</b> <span id="r111 rd" class="r111 r">caseSensitive</span>)
        {
            <b>if</b> (<span class="r107 r">orderMatrix</span>.<span class="i">Count</span> == 0)
                <b>return</b> <b>null</b>;
 
            <span class="c">// create a comparer able to handle a vector of N entries,</span>
            <span class="c">// where N is the max number of entries</span>
            <b>int</b> <span id="r112 rd" class="r112 r">maxEntries</span> = 0;
            <b>foreach</b> (<a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a> <span id="r113 rd" class="r113 r">entry</span> <b>in</b> <span class="r107 r">orderMatrix</span>)
            {
                <b>if</b> (<span class="r113 r">entry</span>.<a href="#2a0292c8c6670757" class="i field">orderValues</a>.<span class="i">Count</span> &gt; <span class="r112 r">maxEntries</span>)
                    <span class="r112 r">maxEntries</span> = <span class="r113 r">entry</span>.<a href="#2a0292c8c6670757" class="i field">orderValues</a>.<span class="i">Count</span>;
            }
 
            <b>if</b> (<span class="r112 r">maxEntries</span> == 0)
                <b>return</b> <b>null</b>;
 
            <b>bool</b>[] <span id="r114 rd" class="r114 r">ascending</span> = <b>new</b> <b>bool</b>[<span class="r112 r">maxEntries</span>];
            <b>for</b> (<b>int</b> <span id="r115 rd" class="r115 r">k</span> = 0; <span class="r115 r">k</span> &lt; <span class="r112 r">maxEntries</span>; <span class="r115 r">k</span>++)
            {
                <b>if</b> (<span class="r109 r">ascendingOverrides</span> != <b>null</b> &amp;&amp; <span class="r109 r">ascendingOverrides</span>[<span class="r115 r">k</span>].<span class="i">HasValue</span>)
                {
                    <span class="r114 r">ascending</span>[<span class="r115 r">k</span>] = <span class="r109 r">ascendingOverrides</span>[<span class="r115 r">k</span>].<span class="i">Value</span>;
                }
                <b>else</b>
                {
                    <span class="r114 r">ascending</span>[<span class="r115 r">k</span>] = <span class="r108 r">ascendingFlag</span>;
                }
            }
 
            <span class="c">// NOTE: the size of the boolean array will determine the max width of the</span>
            <span class="c">// vectors to check</span>
            <b>return</b> <b>new</b> <a href="#10f0c9ff97884598" class="t constructor">OrderByPropertyComparer</a>(<span class="r114 r">ascending</span>, <span class="r110 r">cultureInfo</span>, <span class="r111 r">caseSensitive</span>);
        }
 
        <b>private readonly</b> <a href="ObjectCommandComparer.cs.html#5cf1141dfe247f39" class="t t">ObjectCommandComparer</a>[] <a id="75349b669449e4fe" href="../../R/75349b669449e4fe.html" target="n" data-glyph="46,1" class="i field">_propertyComparers</a> = <b>null</b>;
    }
 
    <b>internal class</b> <a id="c8392078c1165c5f" href="../../R/c8392078c1165c5f.html" target="n" data-glyph="2,0" class="t t">IndexedOrderByPropertyComparer</a> : <span class="i">IComparer</span>&lt;<a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a>&gt;
    {
        <b>internal</b> <a id="99d692f6b1c0ef70" href="../../R/99d692f6b1c0ef70.html" target="n" data-glyph="74,1" class="t constructor">IndexedOrderByPropertyComparer</a>(<a href="#c3c5b617b6c8cced" class="t t">OrderByPropertyComparer</a> <span id="r116 rd" class="r116 r">orderByPropertyComparer</span>)
        {
            <a href="#fb989a821d2f2be1" class="i field">_orderByPropertyComparer</a> = <span class="r116 r">orderByPropertyComparer</span>;
        }
 
        <b>public int</b> <a id="7d22ae5d86e4a351" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Compare</a>(<a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a> <span id="r117 rd" class="r117 r">lhs</span>, <a href="#18901baf821e49cd" class="t t">OrderByPropertyEntry</a> <span id="r118 rd" class="r118 r">rhs</span>)
        {
            <span class="c">// Non-comparable items always fall after comparable items</span>
            <b>if</b> (<span class="r117 r">lhs</span>.<a href="#3ad32c1a93104565" class="i field">comparable</a> != <span class="r118 r">rhs</span>.<a href="#3ad32c1a93104565" class="i field">comparable</a>)
            {
                <b>return</b> <span class="r117 r">lhs</span>.<a href="#3ad32c1a93104565" class="i field">comparable</a>.<span class="i">CompareTo</span>(<span class="r118 r">rhs</span>.<a href="#3ad32c1a93104565" class="i field">comparable</a>) * -1;
            }
 
            <b>int</b> <span id="r119 rd" class="r119 r">result</span> = <a href="#fb989a821d2f2be1" class="i field">_orderByPropertyComparer</a>.<a href="#e598ac6caf3bbcf5" class="i method">Compare</a>(<span class="r117 r">lhs</span>, <span class="r118 r">rhs</span>);
            <span class="c">// When items are identical according to the internal comparison, compare by index</span>
            <span class="c">// to preserve the original order</span>
            <b>if</b> (<span class="r119 r">result</span> == 0)
            {
                <b>return</b> <span class="r117 r">lhs</span>.<a href="#50199c0f773f431a" class="i field">originalIndex</a>.<span class="i">CompareTo</span>(<span class="r118 r">rhs</span>.<a href="#50199c0f773f431a" class="i field">originalIndex</a>);
            }
            <span class="c">// Otherwise, return the default comparison results</span>
            <b>return</b> <span class="r119 r">result</span>;
        }
 
        <b>private readonly</b> <a href="#c3c5b617b6c8cced" class="t t">OrderByPropertyComparer</a> <a id="fb989a821d2f2be1" href="../../R/fb989a821d2f2be1.html" target="n" data-glyph="46,1" class="i field">_orderByPropertyComparer</a> = <b>null</b>;
    }
}
</pre></td></tr></table></div></body></html>
