<!DOCTYPE html>
<html><head><title>GetRandomCommand.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(734);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility/commands/utility/GetRandomCommand.cs" target="_top">commands\utility\GetRandomCommand.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility" target="_top">src\Microsoft.PowerShell.Commands.Utility\Microsoft.PowerShell.Commands.Utility.csproj</a> (Microsoft.PowerShell.Commands.Utility)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Numerics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>.<span class="i">Cryptography</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="i">Debug</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i">Diagnostics</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class implements get-random cmdlet.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span><span class="c"> author: LukaszA </span><span class="c">--&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="/System.Management.Automation/A.html#7ee9f5441476f642" class="i field">Get</a>, <span class="s">&quot;Random&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#fd74cd78f04fc2ed" class="i field">RandomNumberParameterSet</a>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2097016&quot;</span>, <span class="i">RemotingCapability</span> = <a href="/System.Management.Automation/A.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="/System.Management.Automation/A.html#5111d4e307f1cb5a" class="i field">None</a>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<b>int</b>), <b>typeof</b>(<b>long</b>), <b>typeof</b>(<b>double</b>))]
    <b>public class</b> <a id="5ab90dc53f591a97" href="../../R/5ab90dc53f591a97.html" target="n" data-glyph="0,0" class="t t"><span id="b5d80115249595f9">GetRandomCommand</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameter set handling
 
        <b>private const string</b> <a id="fd74cd78f04fc2ed" href="../../R/fd74cd78f04fc2ed.html" target="n" data-glyph="10,1" class="i field">RandomNumberParameterSet</a> = <span class="s">&quot;RandomNumberParameterSet&quot;</span>;
        <b>private const string</b> <a id="0a1b7ed03949cbfb" href="../../R/0a1b7ed03949cbfb.html" target="n" data-glyph="10,1" class="i field">RandomListItemParameterSet</a> = <span class="s">&quot;RandomListItemParameterSet&quot;</span>;
        <b>private const string</b> <a id="bcc50ff363a20c40" href="../../R/bcc50ff363a20c40.html" target="n" data-glyph="10,1" class="i field">ShuffleParameterSet</a> = <span class="s">&quot;ShuffleParameterSet&quot;</span>;
 
        <b>private static readonly object</b>[] <a id="e085920e99a6a816" href="../../R/e085920e99a6a816.html" target="n" data-glyph="46,1" class="i field">_nullInArray</a> = <b>new</b> <b>object</b>[] { <b>null</b> };
 
        <b>private enum</b> <a id="075f0b0ec3701db0" href="../../R/075f0b0ec3701db0.html" target="n" data-glyph="22,1" class="t t"><span id="5e77343079d3eea9">MyParameterSet</span></a>
        {
            <a id="7235f5321f6b81b2" href="../../R/7235f5321f6b81b2.html" target="n" data-glyph="24,2" class="i field">Unknown</a>,
            <a id="7076d647a7f6e168" href="../../R/7076d647a7f6e168.html" target="n" data-glyph="24,2" class="i field">RandomNumber</a>,
            <a id="a94b6a9e4d4c152f" href="../../R/a94b6a9e4d4c152f.html" target="n" data-glyph="24,2" class="i field">RandomListItem</a>
        }
 
        <b>private</b> <a href="#075f0b0ec3701db0" class="t t">MyParameterSet</a> <a id="097ab5cee593bbf1" href="../../R/097ab5cee593bbf1.html" target="n" data-glyph="46,1" class="i field">_effectiveParameterSet</a>;
 
        <b>private</b> <a href="#075f0b0ec3701db0" class="t t">MyParameterSet</a> <a id="58624c2c1edcbc05" href="../../R/58624c2c1edcbc05.html" target="n" data-glyph="106,1" class="i property">EffectiveParameterSet</a>
        {
            <b>get</b>
            {
                <span class="c">// cache MyParameterSet enum instead of doing string comparison every time</span>
                <b>if</b> (<a href="#097ab5cee593bbf1" class="i field">_effectiveParameterSet</a> == <a href="#075f0b0ec3701db0" class="t t">MyParameterSet</a>.<a href="#7235f5321f6b81b2" class="i field">Unknown</a>)
                {
                    <b>if</b> ((<a href="/System.Management.Automation/A.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="/System.Management.Automation/A.html#9a1646f37a942067" class="i property">ExpectingInput</a>) &amp;&amp; (<a href="#72a56bad76894561" class="i property">Maximum</a> == <b>null</b>) &amp;&amp; (<a href="#78cfca48cffaa4e0" class="i property">Minimum</a> == <b>null</b>))
                    {
                        <a href="#097ab5cee593bbf1" class="i field">_effectiveParameterSet</a> = <a href="#075f0b0ec3701db0" class="t t">MyParameterSet</a>.<a href="#a94b6a9e4d4c152f" class="i field">RandomListItem</a>;
                    }
                    <b>else</b> <b>if</b> (<a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#0a1b7ed03949cbfb" class="i field">RandomListItemParameterSet</a>
                        || <a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#bcc50ff363a20c40" class="i field">ShuffleParameterSet</a>)
                    {
                        <a href="#097ab5cee593bbf1" class="i field">_effectiveParameterSet</a> = <a href="#075f0b0ec3701db0" class="t t">MyParameterSet</a>.<a href="#a94b6a9e4d4c152f" class="i field">RandomListItem</a>;
                    }
                    <b>else</b> <b>if</b> (<a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(<a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#fd74cd78f04fc2ed" class="i field">RandomNumberParameterSet</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>if</b> ((<a href="#72a56bad76894561" class="i property">Maximum</a> != <b>null</b>) &amp;&amp; (<a href="#72a56bad76894561" class="i property">Maximum</a>.<span class="i">GetType</span>().<span class="i">IsArray</span>))
                        {
                            <a href="#7aa011f5e3ef3945" class="i property">InputObject</a> = (<b>object</b>[])<a href="#72a56bad76894561" class="i property">Maximum</a>;
                            <a href="#097ab5cee593bbf1" class="i field">_effectiveParameterSet</a> = <a href="#075f0b0ec3701db0" class="t t">MyParameterSet</a>.<a href="#a94b6a9e4d4c152f" class="i field">RandomListItem</a>;
                        }
                        <b>else</b>
                        {
                            <a href="#097ab5cee593bbf1" class="i field">_effectiveParameterSet</a> = <a href="#075f0b0ec3701db0" class="t t">MyParameterSet</a>.<a href="#7076d647a7f6e168" class="i field">RandomNumber</a>;
                        }
                    }
                    <b>else</b>
                    {
                        <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Debug</a>.<span class="i">Assert</span>(<b>false</b>, <span class="s">&quot;Unrecognized parameter set&quot;</span>);
                    }
                }
 
                <b>return</b> <a href="#097ab5cee593bbf1" class="i field">_effectiveParameterSet</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Parameter set handling
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Error handling
 
        <b>private void</b> <a id="431ef1275b2c1a13" href="../../R/431ef1275b2c1a13.html" target="n" data-glyph="76,1" class="i method">ThrowMinGreaterThanOrEqualMax</a>(<b>object</b> <span id="r0 rd" class="r0 r">minValue</span>, <b>object</b> <span id="r1 rd" class="r1 r">maxValue</span>)
        {
            <b>if</b> (<span class="r0 r">minValue</span> == <b>null</b>)
            {
                <b>throw</b> <a href="/System.Management.Automation/A.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentNullException</span>(<span class="s">&quot;min&quot;</span>);
            }
 
            <b>if</b> (<span class="r1 r">maxValue</span> == <b>null</b>)
            {
                <b>throw</b> <a href="/System.Management.Automation/A.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentNullException</span>(<span class="s">&quot;max&quot;</span>);
            }
 
            <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r2 rd" class="r2 r">errorRecord</span> = <b>new</b>(
                <b>new</b> <span class="i">ArgumentException</span>(<b>string</b>.<span class="i">Format</span>(
                    <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="i">GetRandomCommandStrings</span>.<span class="i">MinGreaterThanOrEqualMax</span>, <span class="r0 r">minValue</span>, <span class="r1 r">maxValue</span>)),
                <span class="s">&quot;MinGreaterThanOrEqualMax&quot;</span>,
                <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                <b>null</b>);
 
            <span class="i">ThrowTerminatingError</span>(<span class="r2 r">errorRecord</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Random generator state
 
        <b>private static readonly</b> <span class="i">ReaderWriterLockSlim</span> <a id="33369e43cd25b9f7" href="../../R/33369e43cd25b9f7.html" target="n" data-glyph="46,1" class="i field">s_runspaceGeneratorMapLock</a> = <b>new</b>();
 
        <span class="c">// 1-to-1 mapping of runspaces and random number generators</span>
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="#f5045d4761430145" class="t t">PolymorphicRandomNumberGenerator</a>&gt; <a id="34b90c33c158bab8" href="../../R/34b90c33c158bab8.html" target="n" data-glyph="46,1" class="i field">s_runspaceGeneratorMap</a> = <b>new</b>();
 
        <b>private static void</b> <a id="56191c9258a5bf00" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CurrentRunspace_StateChanged</a>(<b>object</b> <span id="r3 rd" class="r3 r">sender</span>, <a href="/System.Management.Automation/A.html#24ce8f9c69bf1c4a" class="t t">RunspaceStateEventArgs</a> <span id="r4 rd" class="r4 r">e</span>)
        {
            <b>switch</b> (<span class="r4 r">e</span>.<a href="/System.Management.Automation/A.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="/System.Management.Automation/A.html#41627f067662d11c" class="i property">State</a>)
            {
                <b>case</b> <a href="/System.Management.Automation/A.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="/System.Management.Automation/A.html#e4c76740d99e58bd" class="i field">Broken</a>:
                <b>case</b> <a href="/System.Management.Automation/A.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="/System.Management.Automation/A.html#45de84b67ba18f3f" class="i field">Closed</a>:
                    <b>try</b>
                    {
                        <a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#33369e43cd25b9f7" class="i field">s_runspaceGeneratorMapLock</a>.<span class="i">EnterWriteLock</span>();
                        <a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#34b90c33c158bab8" class="i field">s_runspaceGeneratorMap</a>.<span class="i">Remove</span>(((<a href="/System.Management.Automation/A.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>)<span class="r3 r">sender</span>).<a href="/System.Management.Automation/A.html#af7b715fe8b1bee2" class="i property">InstanceId</a>);
                    }
                    <b>finally</b>
                    {
                        <a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#33369e43cd25b9f7" class="i field">s_runspaceGeneratorMapLock</a>.<span class="i">ExitWriteLock</span>();
                    }
 
                    <b>break</b>;
            }
        }
 
        <b>private</b> <a href="#f5045d4761430145" class="t t">PolymorphicRandomNumberGenerator</a> <a id="ee2074278adecd89" href="../../R/ee2074278adecd89.html" target="n" data-glyph="46,1" class="i field">_generator</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets generator associated with the current runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#f5045d4761430145" class="t t">PolymorphicRandomNumberGenerator</a> <a id="dd1c8a96f156f065" href="../../R/dd1c8a96f156f065.html" target="n" data-glyph="106,1" class="i property">Generator</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#ee2074278adecd89" class="i field">_generator</a> == <b>null</b>)
                {
                    <span class="i">Guid</span> <span id="r5 rd" class="r5 r">runspaceId</span> = <span class="i">Context</span>.<span class="i">CurrentRunspace</span>.<span class="i">InstanceId</span>;
 
                    <b>bool</b> <span id="r6 rd" class="r6 r">needToInitialize</span> = <b>false</b>;
                    <b>try</b>
                    {
                        <a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#33369e43cd25b9f7" class="i field">s_runspaceGeneratorMapLock</a>.<span class="i">EnterReadLock</span>();
                        <span class="r6 r">needToInitialize</span> = !<a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#34b90c33c158bab8" class="i field">s_runspaceGeneratorMap</a>.<span class="i">TryGetValue</span>(<span class="r5 r">runspaceId</span>, <b>out</b> <a href="#ee2074278adecd89" class="i field">_generator</a>);
                    }
                    <b>finally</b>
                    {
                        <a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#33369e43cd25b9f7" class="i field">s_runspaceGeneratorMapLock</a>.<span class="i">ExitReadLock</span>();
                    }
 
                    <b>if</b> (<span class="r6 r">needToInitialize</span>)
                    {
                        <a href="#dd1c8a96f156f065" class="i property">Generator</a> = <b>new</b> <a href="#9dcc7dee7890ac18" class="t constructor">PolymorphicRandomNumberGenerator</a>();
                    }
                }
 
                <b>return</b> <a href="#ee2074278adecd89" class="i field">_generator</a>;
            }
 
            <b>set</b>
            {
                <a href="#ee2074278adecd89" class="i field">_generator</a> = <b>value</b>;
                <a href="/System.Management.Automation/A.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r7 rd" class="r7 r">myRunspace</span> = <span class="i">Context</span>.<span class="i">CurrentRunspace</span>;
 
                <b>try</b>
                {
                    <a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#33369e43cd25b9f7" class="i field">s_runspaceGeneratorMapLock</a>.<span class="i">EnterWriteLock</span>();
                    <b>if</b> (!<a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#34b90c33c158bab8" class="i field">s_runspaceGeneratorMap</a>.<span class="i">ContainsKey</span>(<span class="r7 r">myRunspace</span>.<a href="/System.Management.Automation/A.html#af7b715fe8b1bee2" class="i property">InstanceId</a>))
                    {
                        <span class="c">// make sure we won&#39;t leave the generator around after runspace exits</span>
                        <span class="r7 r">myRunspace</span>.<a href="/System.Management.Automation/A.html#6866e88f64eb13d6" class="i">StateChanged</a> += <span class="i">CurrentRunspace_StateChanged</span>;
                    }
 
                    <a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#34b90c33c158bab8" class="i field">s_runspaceGeneratorMap</a>[<span class="r7 r">myRunspace</span>.<a href="/System.Management.Automation/A.html#af7b715fe8b1bee2" class="i property">InstanceId</a>] = <a href="#ee2074278adecd89" class="i field">_generator</a>;
                }
                <b>finally</b>
                {
                    <a href="#5ab90dc53f591a97" class="t t">GetRandomCommand</a>.<a href="#33369e43cd25b9f7" class="i field">s_runspaceGeneratorMapLock</a>.<span class="i">ExitWriteLock</span>();
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Common parameters
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Seed used to reinitialize random numbers generator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNull</span>]
        <b>public int</b>? <a id="132bd04dd6c1ed32" href="../../R/132bd04dd6c1ed32.html" target="n" data-glyph="102,1" class="i property">SetSeed</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Common parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters for RandomNumberParameterSet
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Maximum number to generate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#fd74cd78f04fc2ed" class="i field">RandomNumberParameterSet</a>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        <b>public object</b> <a id="72a56bad76894561" href="../../R/72a56bad76894561.html" target="n" data-glyph="102,1" class="i property">Maximum</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Minimum number to generate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#fd74cd78f04fc2ed" class="i field">RandomNumberParameterSet</a>)]
        <b>public object</b> <a id="78cfca48cffaa4e0" href="../../R/78cfca48cffaa4e0.html" target="n" data-glyph="102,1" class="i property">Minimum</a> { <b>get</b>; <b>set</b>; }
 
        <b>private static bool</b> <a id="d4d3d8c3c3ac1356" href="../../R/d4d3d8c3c3ac1356.html" target="n" data-glyph="76,1" class="i method">IsInt</a>(<b>object</b> <span id="r8 rd" class="r8 r">o</span>)
        {
            <b>if</b> (<span class="r8 r">o</span> == <b>null</b> || <span class="r8 r">o</span> <b>is int</b>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private static bool</b> <a id="653b7f89823c8f8f" href="../../R/653b7f89823c8f8f.html" target="n" data-glyph="76,1" class="i method">IsInt64</a>(<b>object</b> <span id="r9 rd" class="r9 r">o</span>)
        {
            <b>if</b> (<span class="r9 r">o</span> == <b>null</b> || <span class="r9 r">o</span> <b>is long</b>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private static object</b> <a id="570d3d0494f0cd9b" href="../../R/570d3d0494f0cd9b.html" target="n" data-glyph="76,1" class="i method">ProcessOperand</a>(<b>object</b> <span id="r10 rd" class="r10 r">o</span>)
        {
            <b>if</b> (<span class="r10 r">o</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r11 rd" class="r11 r">pso</span> = <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">AsPSObject</span>(<span class="r10 r">o</span>);
            <b>object</b> <span id="r12 rd" class="r12 r">baseObject</span> = <span class="r11 r">pso</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a>;
 
            <b>if</b> (<span class="r12 r">baseObject</span> <b>is string</b>)
            {
                <span class="c">// The type argument passed in does not decide the number type we want to convert to. ScanNumber will return</span>
                <span class="c">// int/long/double based on the string form number passed in.</span>
                <span class="r12 r">baseObject</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>.<a href="/System.Management.Automation/A.html#bbf5e856fb3215c5" class="t t">Parser</a>.<span class="i">ScanNumber</span>((<b>string</b>)<span class="r12 r">baseObject</span>, <b>typeof</b>(<b>int</b>));
            }
 
            <b>return</b> <span class="r12 r">baseObject</span>;
        }
 
        <b>private static double</b> <a id="1fdfc220044068a8" href="../../R/1fdfc220044068a8.html" target="n" data-glyph="76,1" class="i method">ConvertToDouble</a>(<b>object</b> <span id="r13 rd" class="r13 r">o</span>, <b>double</b> <span id="r14 rd" class="r14 r">defaultIfNull</span>)
        {
            <b>if</b> (<span class="r13 r">o</span> == <b>null</b>)
            {
                <b>return</b> <span class="r14 r">defaultIfNull</span>;
            }
 
            <b>double</b> <span id="r15 rd" class="r15 r">result</span> = (<b>double</b>)<a href="/System.Management.Automation/A.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r13 r">o</span>, <b>typeof</b>(<b>double</b>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            <b>return</b> <span class="r15 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters and variables for RandomListItemParameterSet
 
        <b>private</b> <span class="i">List</span>&lt;<b>object</b>&gt; <a id="d842c1f0e7af4ae8" href="../../R/d842c1f0e7af4ae8.html" target="n" data-glyph="46,1" class="i field">_chosenListItems</a>;
        <b>private int</b> <a id="cbf3afa531d1d5d8" href="../../R/cbf3afa531d1d5d8.html" target="n" data-glyph="46,1" class="i field">_numberOfProcessedListItems</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> List from which random elements are chosen.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#0a1b7ed03949cbfb" class="i field">RandomListItemParameterSet</a>, <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#bcc50ff363a20c40" class="i field">ShuffleParameterSet</a>, <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i">AllowNull</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public object</b>[] <a id="7aa011f5e3ef3945" href="../../R/7aa011f5e3ef3945.html" target="n" data-glyph="102,1" class="i property">InputObject</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Number of items to output (number of list items or of numbers).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#fd74cd78f04fc2ed" class="i field">RandomNumberParameterSet</a>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#0a1b7ed03949cbfb" class="i field">RandomListItemParameterSet</a>)]
        [<span class="i">ValidateRange</span>(1, <b>int</b>.<span class="i">MaxValue</span>)]
        <b>public int</b> <a id="611c58b4a811d635" href="../../R/611c58b4a811d635.html" target="n" data-glyph="102,1" class="i property">Count</a> { <b>get</b>; <b>set</b>; } = 1;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Shuffle parameter
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets whether the command should return all input objects in randomized order.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#bcc50ff363a20c40" class="i field">ShuffleParameterSet</a>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="d6f873cf2ea3be07" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Shuffle</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Cmdlet processing methods
 
        <b>private double</b> <a id="a1366f72b68e5093" href="../../R/a1366f72b68e5093.html" target="n" data-glyph="76,1" class="i method">GetRandomDouble</a>(<b>double</b> <span id="r16 rd" class="r16 r">minValue</span>, <b>double</b> <span id="r17 rd" class="r17 r">maxValue</span>)
        {
            <b>double</b> <span id="r18 rd" class="r18 r">randomNumber</span>;
            <b>double</b> <span id="r19 rd" class="r19 r">diff</span> = <span class="r17 r">maxValue</span> - <span class="r16 r">minValue</span>;
 
            <span class="c">// I couldn&#39;t find a better fix for bug #216893 then</span>
            <span class="c">// to test and retry if a random number falls outside the bounds</span>
            <span class="c">// because of floating-point-arithmetic inaccuracies.</span>
            <span class="c">//</span>
            <span class="c">// Performance in the normal case is not impacted much.</span>
            <span class="c">// In low-precision situations we should converge to a solution quickly</span>
            <span class="c">// (diff gets smaller at a quick pace).</span>
 
            <b>if</b> (<b>double</b>.<span class="i">IsInfinity</span>(<span class="r19 r">diff</span>))
            {
                <b>do</b>
                {
                    <b>double</b> <span id="r20 rd" class="r20 r">r</span> = <a href="#dd1c8a96f156f065" class="i property">Generator</a>.<a href="#970914d58fcaac13" class="i method">NextDouble</a>();
                    <span class="r18 r">randomNumber</span> = <span class="r16 r">minValue</span> + <span class="r20 r">r</span> * <span class="r17 r">maxValue</span> - <span class="r20 r">r</span> * <span class="r16 r">minValue</span>;
                }
                <b>while</b> (<span class="r18 r">randomNumber</span> &gt;= <span class="r17 r">maxValue</span>);
            }
            <b>else</b>
            {
                <b>do</b>
                {
                    <b>double</b> <span id="r21 rd" class="r21 r">r</span> = <a href="#dd1c8a96f156f065" class="i property">Generator</a>.<a href="#970914d58fcaac13" class="i method">NextDouble</a>();
                    <span class="r18 r">randomNumber</span> = <span class="r16 r">minValue</span> + <span class="r21 r">r</span> * <span class="r19 r">diff</span>;
                    <span class="r19 r">diff</span> *= <span class="r21 r">r</span>;
                }
                <b>while</b> (<span class="r18 r">randomNumber</span> &gt;= <span class="r17 r">maxValue</span>);
            }
 
            <b>return</b> <span class="r18 r">randomNumber</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a random Int64 type number.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">minValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">maxValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private long</b> <a id="1d04f6a452e80d56" href="../../R/1d04f6a452e80d56.html" target="n" data-glyph="76,1" class="i method">GetRandomInt64</a>(<b>long</b> <span id="r22 rd" class="r22 r">minValue</span>, <b>long</b> <span id="r23 rd" class="r23 r">maxValue</span>)
        {
            <span class="c">// Randomly generate eight bytes and convert the byte array to UInt64</span>
            <b>var</b> <span id="r24 rd" class="r24 r">buffer</span> = <b>new</b> <b>byte</b>[<b>sizeof</b>(<b>ulong</b>)];
            <b>ulong</b> <span id="r25 rd" class="r25 r">randomUint64</span>;
 
            <span class="i">BigInteger</span> <span id="r26 rd" class="r26 r">bigIntegerDiff</span> = (<span class="i">BigInteger</span>)<span class="r23 r">maxValue</span> - (<span class="i">BigInteger</span>)<span class="r22 r">minValue</span>;
 
            <span class="c">// When the difference is less than int.MaxValue, use Random.Next(int, int)</span>
            <b>if</b> (<span class="r26 r">bigIntegerDiff</span> &lt;= <b>int</b>.<span class="i">MaxValue</span>)
            {
                <b>int</b> <span id="r27 rd" class="r27 r">randomDiff</span> = <a href="#dd1c8a96f156f065" class="i property">Generator</a>.<a href="#2e096e36a76f5175" class="i method">Next</a>(0, (<b>int</b>)(<span class="r23 r">maxValue</span> - <span class="r22 r">minValue</span>));
                <b>return</b> <span class="r22 r">minValue</span> + <span class="r27 r">randomDiff</span>;
            }
 
            <span class="c">// The difference of two Int64 numbers would not exceed UInt64.MaxValue, so it can be represented by a UInt64 number.</span>
            <b>ulong</b> <span id="r28 rd" class="r28 r">uint64Diff</span> = (<b>ulong</b>)<span class="r26 r">bigIntegerDiff</span>;
 
            <span class="c">// Calculate the number of bits to represent the diff in type UInt64</span>
            <b>int</b> <span id="r29 rd" class="r29 r">bitsToRepresentDiff</span> = 0;
            <b>ulong</b> <span id="r30 rd" class="r30 r">diffCopy</span> = <span class="r28 r">uint64Diff</span>;
            <b>for</b> (; <span class="r30 r">diffCopy</span> != 0; <span class="r29 r">bitsToRepresentDiff</span>++)
            {
                <span class="r30 r">diffCopy</span> &gt;&gt;= 1;
            }
            <span class="c">// Get the mask for the number of bits</span>
            <b>ulong</b> <span id="r31 rd" class="r31 r">mask</span> = (0xffffffffffffffff &gt;&gt; (64 - <span class="r29 r">bitsToRepresentDiff</span>));
            <b>do</b>
            {
                <span class="c">// Randomly fill the buffer</span>
                <a href="#dd1c8a96f156f065" class="i property">Generator</a>.<a href="#3e2be4a06b5b59f6" class="i method">NextBytes</a>(<span class="r24 r">buffer</span>);
                <span class="r25 r">randomUint64</span> = <span class="i">BitConverter</span>.<span class="i">ToUInt64</span>(<span class="r24 r">buffer</span>, 0);
 
                <span class="c">// Get the last &#39;bitsToRepresentDiff&#39; number of random bits</span>
                <span class="r25 r">randomUint64</span> &amp;= <span class="r31 r">mask</span>;
            } <b>while</b> (<span class="r28 r">uint64Diff</span> &lt;= <span class="r25 r">randomUint64</span>);
 
            <b>double</b> <span id="r32 rd" class="r32 r">randomNumber</span> = <span class="r22 r">minValue</span> * 1.0 + <span class="r25 r">randomUint64</span> * 1.0;
            <b>return</b> (<b>long</b>)<span class="r32 r">randomNumber</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method implements the BeginProcessing method for get-random command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="d8f78b6feca290c6" href="../../R/d8f78b6feca290c6.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <b>if</b> (<a href="#132bd04dd6c1ed32" class="i property">SetSeed</a>.<span class="i">HasValue</span>)
            {
                <a href="#dd1c8a96f156f065" class="i property">Generator</a> = <b>new</b> <span class="t">PolymorphicRandomNumberGenerator</span>(<a href="#132bd04dd6c1ed32" class="i property">SetSeed</a>.<span class="i">Value</span>);
            }
 
            <b>if</b> (<a href="#58624c2c1edcbc05" class="i property">EffectiveParameterSet</a> == <a href="#075f0b0ec3701db0" class="t t">MyParameterSet</a>.<a href="#7076d647a7f6e168" class="i field">RandomNumber</a>)
            {
                <b>object</b> <span id="r33 rd" class="r33 r">maxOperand</span> = <a href="#570d3d0494f0cd9b" class="i method">ProcessOperand</a>(<a href="#72a56bad76894561" class="i property">Maximum</a>);
                <b>object</b> <span id="r34 rd" class="r34 r">minOperand</span> = <a href="#570d3d0494f0cd9b" class="i method">ProcessOperand</a>(<a href="#78cfca48cffaa4e0" class="i property">Minimum</a>);
 
                <b>if</b> (<a href="#d4d3d8c3c3ac1356" class="i method">IsInt</a>(<span class="r33 r">maxOperand</span>) &amp;&amp; <a href="#d4d3d8c3c3ac1356" class="i method">IsInt</a>(<span class="r34 r">minOperand</span>))
                {
                    <b>int</b> <span id="r35 rd" class="r35 r">minValue</span> = <span class="r34 r">minOperand</span> != <b>null</b> ? (<b>int</b>)<span class="r34 r">minOperand</span> : 0;
                    <b>int</b> <span id="r36 rd" class="r36 r">maxValue</span> = <span class="r33 r">maxOperand</span> != <b>null</b> ? (<b>int</b>)<span class="r33 r">maxOperand</span> : <b>int</b>.<span class="i">MaxValue</span>;
 
                    <b>if</b> (<span class="r35 r">minValue</span> &gt;= <span class="r36 r">maxValue</span>)
                    {
                        <a href="#431ef1275b2c1a13" class="i method">ThrowMinGreaterThanOrEqualMax</a>(<span class="r35 r">minValue</span>, <span class="r36 r">maxValue</span>);
                    }
 
                    <b>for</b> (<b>int</b> <span id="r37 rd" class="r37 r">i</span> = 0; <span class="r37 r">i</span> &lt; <a href="#611c58b4a811d635" class="i property">Count</a>; <span class="r37 r">i</span>++)
                    {
                        <b>int</b> <span id="r38 rd" class="r38 r">randomNumber</span> = <a href="#dd1c8a96f156f065" class="i property">Generator</a>.<a href="#2e096e36a76f5175" class="i method">Next</a>(<span class="r35 r">minValue</span>, <span class="r36 r">maxValue</span>);
                        <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Debug</a>.<span class="i">Assert</span>(<span class="r35 r">minValue</span> &lt;= <span class="r38 r">randomNumber</span>, <span class="s">&quot;lower bound &lt;= random number&quot;</span>);
                        <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Debug</a>.<span class="i">Assert</span>(<span class="r38 r">randomNumber</span> &lt; <span class="r36 r">maxValue</span>, <span class="s">&quot;random number &lt; upper bound&quot;</span>);
 
                        <span class="i">WriteObject</span>(<span class="r38 r">randomNumber</span>);
                    }
                }
                <b>else</b> <b>if</b> ((<a href="#653b7f89823c8f8f" class="i method">IsInt64</a>(<span class="r33 r">maxOperand</span>) || <a href="#d4d3d8c3c3ac1356" class="i method">IsInt</a>(<span class="r33 r">maxOperand</span>)) &amp;&amp; (<a href="#653b7f89823c8f8f" class="i method">IsInt64</a>(<span class="r34 r">minOperand</span>) || <a href="#d4d3d8c3c3ac1356" class="i method">IsInt</a>(<span class="r34 r">minOperand</span>)))
                {
                    <b>long</b> <span id="r39 rd" class="r39 r">minValue</span> = <span class="r34 r">minOperand</span> != <b>null</b> ? ((<span class="r34 r">minOperand</span> <b>is long</b>) ? (<b>long</b>)<span class="r34 r">minOperand</span> : (<b>int</b>)<span class="r34 r">minOperand</span>) : 0;
                    <b>long</b> <span id="r40 rd" class="r40 r">maxValue</span> = <span class="r33 r">maxOperand</span> != <b>null</b> ? ((<span class="r33 r">maxOperand</span> <b>is long</b>) ? (<b>long</b>)<span class="r33 r">maxOperand</span> : (<b>int</b>)<span class="r33 r">maxOperand</span>) : <b>long</b>.<span class="i">MaxValue</span>;
 
                    <b>if</b> (<span class="r39 r">minValue</span> &gt;= <span class="r40 r">maxValue</span>)
                    {
                        <a href="#431ef1275b2c1a13" class="i method">ThrowMinGreaterThanOrEqualMax</a>(<span class="r39 r">minValue</span>, <span class="r40 r">maxValue</span>);
                    }
 
                    <b>for</b> (<b>int</b> <span id="r41 rd" class="r41 r">i</span> = 0; <span class="r41 r">i</span> &lt; <a href="#611c58b4a811d635" class="i property">Count</a>; <span class="r41 r">i</span>++)
                    {
                        <b>long</b> <span id="r42 rd" class="r42 r">randomNumber</span> = <a href="#1d04f6a452e80d56" class="i method">GetRandomInt64</a>(<span class="r39 r">minValue</span>, <span class="r40 r">maxValue</span>);
                        <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Debug</a>.<span class="i">Assert</span>(<span class="r39 r">minValue</span> &lt;= <span class="r42 r">randomNumber</span>, <span class="s">&quot;lower bound &lt;= random number&quot;</span>);
                        <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Debug</a>.<span class="i">Assert</span>(<span class="r42 r">randomNumber</span> &lt; <span class="r40 r">maxValue</span>, <span class="s">&quot;random number &lt; upper bound&quot;</span>);
 
                        <span class="i">WriteObject</span>(<span class="r42 r">randomNumber</span>);
                    }
                }
                <b>else</b>
                {
                    <b>double</b> <span id="r43 rd" class="r43 r">minValue</span> = (<span class="r34 r">minOperand</span> <b>is double</b>) ? (<b>double</b>)<span class="r34 r">minOperand</span> : <a href="#1fdfc220044068a8" class="i method">ConvertToDouble</a>(<a href="#78cfca48cffaa4e0" class="i property">Minimum</a>, 0.0);
                    <b>double</b> <span id="r44 rd" class="r44 r">maxValue</span> = (<span class="r33 r">maxOperand</span> <b>is double</b>) ? (<b>double</b>)<span class="r33 r">maxOperand</span> : <span class="i">ConvertToDouble</span>(<a href="#72a56bad76894561" class="i property">Maximum</a>, <b>double</b>.<span class="i">MaxValue</span>);
 
                    <b>if</b> (<span class="r43 r">minValue</span> &gt;= <span class="r44 r">maxValue</span>)
                    {
                        <a href="#431ef1275b2c1a13" class="i method">ThrowMinGreaterThanOrEqualMax</a>(<span class="r43 r">minValue</span>, <span class="r44 r">maxValue</span>);
                    }
 
                    <b>for</b> (<b>int</b> <span id="r45 rd" class="r45 r">i</span> = 0; <span class="r45 r">i</span> &lt; <a href="#611c58b4a811d635" class="i property">Count</a>; <span class="r45 r">i</span>++)
                    {
                        <b>double</b> <span id="r46 rd" class="r46 r">randomNumber</span> = <a href="#a1366f72b68e5093" class="i method">GetRandomDouble</a>(<span class="r43 r">minValue</span>, <span class="r44 r">maxValue</span>);
                        <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Debug</a>.<span class="i">Assert</span>(<span class="r43 r">minValue</span> &lt;= <span class="r46 r">randomNumber</span>, <span class="s">&quot;lower bound &lt;= random number&quot;</span>);
                        <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Debug</a>.<span class="i">Assert</span>(<span class="r46 r">randomNumber</span> &lt; <span class="r44 r">maxValue</span>, <span class="s">&quot;random number &lt; upper bound&quot;</span>);
 
                        <span class="i">WriteObject</span>(<span class="r46 r">randomNumber</span>);
                    }
                }
            }
            <b>else</b> <b>if</b> (<a href="#58624c2c1edcbc05" class="i property">EffectiveParameterSet</a> == <a href="#075f0b0ec3701db0" class="t t">MyParameterSet</a>.<a href="#a94b6a9e4d4c152f" class="i field">RandomListItem</a>)
            {
                <a href="#d842c1f0e7af4ae8" class="i field">_chosenListItems</a> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
                <a href="#cbf3afa531d1d5d8" class="i field">_numberOfProcessedListItems</a> = 0;
            }
        }
 
        <span class="c">// rough proof that when choosing random K items out of N items</span>
        <span class="c">// each item has got K/N probability of being included in the final list</span>
        <span class="c">//</span>
        <span class="c">// probability that a particular item in chosenListItems is NOT going to be replaced</span>
        <span class="c">// when processing I-th input item [assumes I &gt; K]:</span>
        <span class="c">// P_one_step(I) = 1 - ((K / I) * ((K - 1) / K) + ((I - K) / I) = (I - 1) / I</span>
        <span class="c">//                      &lt;--A--&gt;   &lt;-----B-----&gt;   &lt;-----C-----&gt;</span>
        <span class="c">// A - probability that I-th element is going to be replacing an element from chosenListItems</span>
        <span class="c">//     (see (1) in the code below)</span>
        <span class="c">// B - probability that a particular element from chosenListItems is NOT going to be replaced</span>
        <span class="c">//     (see (2) in the code below)</span>
        <span class="c">// C - probability that I-th element is NOT going to be replacing an element from chosenListItems</span>
        <span class="c">//     (see (1) in the code below)</span>
        <span class="c">//</span>
        <span class="c">// probability that a particular item in chosenListItems is NOT going to be replaced</span>
        <span class="c">// when processing input items J through N [assumes J &gt; K]</span>
        <span class="c">// P_removal(J) = Multiply(for I = J to N) P(I) =</span>
        <span class="c">//              = ((J - 1) / J) * (J / (J + 1)) * ... * ((N - 2) / (N - 1)) * ((N - 1) / N) =</span>
        <span class="c">//              = (J - 1) / N</span>
        <span class="c">//</span>
        <span class="c">// probability that when processing an element it is going to be put into chosenListItems</span>
        <span class="c">// P_insertion(I) = 1.0 when I &lt;= K - see (3) in the code below</span>
        <span class="c">// P_insertion(I) = K/N otherwise - see (1) in the code below</span>
        <span class="c">//</span>
        <span class="c">// probability that a given element is going to be a part of the final list</span>
        <span class="c">// P_final(I)   = P_insertion(I) * P_removal(max(I + 1, K + 1))</span>
        <span class="c">// [for I &lt;= K] = 1.0 * ((K + 1) - 1) / N = K / N</span>
        <span class="c">// [otherwise]  = (K / I) * ((I + 1) - 1) / N = K / N</span>
        <span class="c">//</span>
        <span class="c">// which proves that P_final(I) = K / N for all values of I.  QED.</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method implements the ProcessRecord method for get-random command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="f068bb8bd11cfdb8" href="../../R/f068bb8bd11cfdb8.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#58624c2c1edcbc05" class="i property">EffectiveParameterSet</a> == <a href="#075f0b0ec3701db0" class="t t">MyParameterSet</a>.<a href="#a94b6a9e4d4c152f" class="i field">RandomListItem</a>)
            {
                <b>if</b> (<a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#bcc50ff363a20c40" class="i field">ShuffleParameterSet</a>)
                {
                    <span class="c">// this allows for $null to be in an array passed to InputObject</span>
                    <b>foreach</b> (<b>object</b> <span id="r47 rd" class="r47 r">item</span> <b>in</b> <a href="#7aa011f5e3ef3945" class="i property">InputObject</a> ?? <a href="#e085920e99a6a816" class="i field">_nullInArray</a>)
                    {
                        <a href="#d842c1f0e7af4ae8" class="i field">_chosenListItems</a>.<span class="i">Add</span>(<span class="r47 r">item</span>);
                    }
                }
                <b>else</b>
                {
                    <b>foreach</b> (<b>object</b> <span id="r48 rd" class="r48 r">item</span> <b>in</b> <a href="#7aa011f5e3ef3945" class="i property">InputObject</a> ?? <a href="#e085920e99a6a816" class="i field">_nullInArray</a>)
                    {
                        <span class="c">// (3)</span>
                        <b>if</b> (<a href="#cbf3afa531d1d5d8" class="i field">_numberOfProcessedListItems</a> &lt; <a href="#611c58b4a811d635" class="i property">Count</a>)
                        {
                            <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Debug</a>.<span class="i">Assert</span>(<a href="#d842c1f0e7af4ae8" class="i field">_chosenListItems</a>.<span class="i">Count</span> == <a href="#cbf3afa531d1d5d8" class="i field">_numberOfProcessedListItems</a>, <span class="s">&quot;Initial K elements should all be included in chosenListItems&quot;</span>);
                            <a href="#d842c1f0e7af4ae8" class="i field">_chosenListItems</a>.<span class="i">Add</span>(<span class="r48 r">item</span>);
                        }
                        <b>else</b>
                        {
                            <a href="/System.Management.Automation/A.html#c04955255430d32f" class="t t">Debug</a>.<span class="i">Assert</span>(<a href="#d842c1f0e7af4ae8" class="i field">_chosenListItems</a>.<span class="i">Count</span> == <a href="#611c58b4a811d635" class="i property">Count</a>, <span class="s">&quot;After processing K initial elements, the length of chosenItems should stay equal to K&quot;</span>);
 
                            <span class="c">// (1)</span>
                            <b>if</b> (<a href="#dd1c8a96f156f065" class="i property">Generator</a>.<span class="i">Next</span>(<a href="#cbf3afa531d1d5d8" class="i field">_numberOfProcessedListItems</a> + 1) &lt; <a href="#611c58b4a811d635" class="i property">Count</a>)
                            {
                                <span class="c">// (2)</span>
                                <b>int</b> <span id="r49 rd" class="r49 r">indexToReplace</span> = <a href="#dd1c8a96f156f065" class="i property">Generator</a>.<span class="i">Next</span>(<a href="#d842c1f0e7af4ae8" class="i field">_chosenListItems</a>.<span class="i">Count</span>);
                                <a href="#d842c1f0e7af4ae8" class="i field">_chosenListItems</a>[<span class="r49 r">indexToReplace</span>] = <span class="r48 r">item</span>;
                            }
                        }
 
                        <a href="#cbf3afa531d1d5d8" class="i field">_numberOfProcessedListItems</a>++;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method implements the EndProcessing method for get-random command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="827486a41f5d118a" href="../../R/827486a41f5d118a.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <b>if</b> (<a href="#58624c2c1edcbc05" class="i property">EffectiveParameterSet</a> == <a href="#075f0b0ec3701db0" class="t t">MyParameterSet</a>.<a href="#a94b6a9e4d4c152f" class="i field">RandomListItem</a>)
            {
                <span class="c">// make sure the order is truly random</span>
                <span class="c">// (all permutations with the same probability)</span>
                <span class="c">// O(n) time</span>
                <b>int</b> <span id="r50 rd" class="r50 r">n</span> = <a href="#d842c1f0e7af4ae8" class="i field">_chosenListItems</a>.<span class="i">Count</span>;
                <b>for</b> (<b>int</b> <span id="r51 rd" class="r51 r">i</span> = 0; <span class="r51 r">i</span> &lt; <span class="r50 r">n</span>; <span class="r51 r">i</span>++)
                {
                    <span class="c">// randomly choose j from [i...n)</span>
                    <b>int</b> <span id="r52 rd" class="r52 r">j</span> = <a href="#dd1c8a96f156f065" class="i property">Generator</a>.<a href="#2e096e36a76f5175" class="i method">Next</a>(<span class="r51 r">i</span>, <span class="r50 r">n</span>);
 
                    <span class="i">WriteObject</span>(<a href="#d842c1f0e7af4ae8" class="i field">_chosenListItems</a>[<span class="r52 r">j</span>]);
 
                    <span class="c">// remove the output object from consideration in the next iteration.</span>
                    <b>if</b> (<span class="r51 r">i</span> != <span class="r52 r">j</span>)
                    {
                        <a href="#d842c1f0e7af4ae8" class="i field">_chosenListItems</a>[<span class="r52 r">j</span>] = <a href="#d842c1f0e7af4ae8" class="i field">_chosenListItems</a>[<span class="r51 r">i</span>];
                    }
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Processing methods
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Provides an adapter API for random numbers that may be either cryptographically random, or</span>
    <span class="c">///</span><span class="c"> generated with the regular pseudo-random number generator. Re-implementations of</span>
    <span class="c">///</span><span class="c"> methods using the NextBytes() primitive based on the CLR implementation:</span>
    <span class="c">///</span><span class="c">     https://referencesource.microsoft.com/#mscorlib/system/random.cs.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="f5045d4761430145" href="../../R/f5045d4761430145.html" target="n" data-glyph="2,0" class="t t">PolymorphicRandomNumberGenerator</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#f5045d4761430145" class="t t">PolymorphicRandomNumberGenerator</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="9dcc7dee7890ac18" href="../../R/9dcc7dee7890ac18.html" target="n" data-glyph="72,1" class="t constructor">PolymorphicRandomNumberGenerator</a>()
        {
            <a href="#b25197a9567ed0b8" class="i field">_cryptographicGenerator</a> = <span class="i">RandomNumberGenerator</span>.<span class="i">Create</span>();
            <a href="#7fc7dd23b1f7878b" class="i field">_pseudoGenerator</a> = <b>null</b>;
        }
 
        <b>internal</b> <a id="7881d06f11879509" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">PolymorphicRandomNumberGenerator</a>(<b>int</b> <span id="r53 rd" class="r53 r">seed</span>)
        {
            <a href="#b25197a9567ed0b8" class="i field">_cryptographicGenerator</a> = <b>null</b>;
            <a href="#7fc7dd23b1f7878b" class="i field">_pseudoGenerator</a> = <b>new</b> <span class="i">Random</span>(<span class="r53 r">seed</span>);
        }
 
        <b>private readonly</b> <span class="i">Random</span> <a id="7fc7dd23b1f7878b" href="../../R/7fc7dd23b1f7878b.html" target="n" data-glyph="46,1" class="i field">_pseudoGenerator</a> = <b>null</b>;
        <b>private readonly</b> <span class="i">RandomNumberGenerator</span> <a id="b25197a9567ed0b8" href="../../R/b25197a9567ed0b8.html" target="n" data-glyph="46,1" class="i field">_cryptographicGenerator</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generates a random floating-point number that is greater than or equal to 0.0, and less than 1.0.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A random floating-point number that is greater than or equal to 0.0, and less than 1.0.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal double</b> <a id="970914d58fcaac13" href="../../R/970914d58fcaac13.html" target="n" data-glyph="74,1" class="i method">NextDouble</a>()
        {
            <span class="c">// According to the CLR source:</span>
            <span class="c">//     &quot;Including this division at the end gives us significantly improved random number distribution.&quot;</span>
            <b>return</b> <a href="#5355edd3989b2770" class="i method">Next</a>() * (1.0 / <b>int</b>.<span class="i">MaxValue</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generates a non-negative random integer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A non-negative random integer.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="5355edd3989b2770" href="../../R/5355edd3989b2770.html" target="n" data-glyph="74,1" class="i method">Next</a>()
        {
            <b>int</b> <span id="r54 rd" class="r54 r">randomNumber</span>;
 
            <span class="c">// The CLR implementation just fudges</span>
            <span class="c">// Int32.MaxValue down to (Int32.MaxValue - 1). This implementation</span>
            <span class="c">// errs on the side of correctness.</span>
            <b>do</b>
            {
                <span class="r54 r">randomNumber</span> = <a href="#3714cddc2f30faf5" class="i method">InternalSample</a>();
            }
            <b>while</b> (<span class="r54 r">randomNumber</span> == <b>int</b>.<span class="i">MaxValue</span>);
 
            <b>if</b> (<span class="r54 r">randomNumber</span> &lt; 0)
            {
                <span class="r54 r">randomNumber</span> += <b>int</b>.<span class="i">MaxValue</span>;
            }
 
            <b>return</b> <span class="r54 r">randomNumber</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a random integer that is within a specified range.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">maxValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The exclusive upper bound of the random number returned.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="d0a9dbc0823af313" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">Next</a>(<b>int</b> <span id="r55 rd" class="r55 r">maxValue</span>)
        {
            <b>if</b> (<span class="r55 r">maxValue</span> &lt; 0)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentOutOfRangeException</span>(<b>nameof</b>(<span class="r55 r">maxValue</span>), <span class="i">GetRandomCommandStrings</span>.<span class="i">MaxMustBeGreaterThanZeroApi</span>);
            }
 
            <b>return</b> <a href="#2e096e36a76f5175" class="i method">Next</a>(0, <span class="r55 r">maxValue</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a random integer that is within a specified range.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">minValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The inclusive lower bound of the random number returned.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">maxValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The exclusive upper bound of the random number returned. maxValue must be greater than or equal to minValue.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public int</b> <a id="2e096e36a76f5175" href="../../R/2e096e36a76f5175.html" target="n" data-glyph="72,1" class="i method">Next</a>(<b>int</b> <span id="r56 rd" class="r56 r">minValue</span>, <b>int</b> <span id="r57 rd" class="r57 r">maxValue</span>)
        {
            <b>if</b> (<span class="r56 r">minValue</span> &gt; <span class="r57 r">maxValue</span>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentOutOfRangeException</span>(<b>nameof</b>(<span class="r56 r">minValue</span>), <span class="i">GetRandomCommandStrings</span>.<span class="i">MinGreaterThanOrEqualMaxApi</span>);
            }
 
            <b>int</b> <span id="r58 rd" class="r58 r">randomNumber</span> = 0;
 
            <b>long</b> <span id="r59 rd" class="r59 r">range</span> = (<b>long</b>)<span class="r57 r">maxValue</span> - (<b>long</b>)<span class="r56 r">minValue</span>;
            <b>if</b> (<span class="r59 r">range</span> &lt;= <b>int</b>.<span class="i">MaxValue</span>)
            {
                <span class="r58 r">randomNumber</span> = ((<b>int</b>)(<a href="#970914d58fcaac13" class="i method">NextDouble</a>() * <span class="r59 r">range</span>) + <span class="r56 r">minValue</span>);
            }
            <b>else</b>
            {
                <b>double</b> <span id="r60 rd" class="r60 r">largeSample</span> = <a href="#86076d15bf4e644f" class="i method">InternalSampleLargeRange</a>() * (1.0 / (2 * ((<b>uint</b>)<b>int</b>.<span class="i">MaxValue</span>)));
                <span class="r58 r">randomNumber</span> = (<b>int</b>)((<b>long</b>)(<span class="r60 r">largeSample</span> * <span class="r59 r">range</span>) + <span class="r56 r">minValue</span>);
            }
 
            <b>return</b> <span class="r58 r">randomNumber</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Fills the elements of a specified array of bytes with random numbers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">buffer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The array to be filled.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="3e2be4a06b5b59f6" href="../../R/3e2be4a06b5b59f6.html" target="n" data-glyph="74,1" class="i method">NextBytes</a>(<b>byte</b>[] <span id="r61 rd" class="r61 r">buffer</span>)
        {
            <b>if</b> (<a href="#b25197a9567ed0b8" class="i field">_cryptographicGenerator</a> != <b>null</b>)
            {
                <a href="#b25197a9567ed0b8" class="i field">_cryptographicGenerator</a>.<span class="i">GetBytes</span>(<span class="r61 r">buffer</span>);
            }
            <b>else</b>
            {
                <a href="#7fc7dd23b1f7878b" class="i field">_pseudoGenerator</a>.<span class="i">NextBytes</span>(<span class="r61 r">buffer</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Samples a random integer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A random integer, using the full range of Int32.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private int</b> <a id="3714cddc2f30faf5" href="../../R/3714cddc2f30faf5.html" target="n" data-glyph="76,1" class="i method">InternalSample</a>()
        {
            <b>int</b> <span id="r62 rd" class="r62 r">randomNumber</span>;
            <b>byte</b>[] <span id="r63 rd" class="r63 r">data</span> = <b>new</b> <b>byte</b>[<b>sizeof</b>(<b>int</b>)];
 
            <a href="#3e2be4a06b5b59f6" class="i method">NextBytes</a>(<span class="r63 r">data</span>);
            <span class="r62 r">randomNumber</span> = <span class="i">BitConverter</span>.<span class="i">ToInt32</span>(<span class="r63 r">data</span>, 0);
 
            <b>return</b> <span class="r62 r">randomNumber</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Samples a random int when the range is large. This does</span>
        <span class="c">///</span><span class="c"> not need to be in the range of -Double.MaxValue .. Double.MaxValue,</span>
        <span class="c">///</span><span class="c"> just 0.. (2 * Int32.MaxValue) - 1 .</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private double</b> <a id="86076d15bf4e644f" href="../../R/86076d15bf4e644f.html" target="n" data-glyph="76,1" class="i method">InternalSampleLargeRange</a>()
        {
            <b>double</b> <span id="r64 rd" class="r64 r">randomNumber</span>;
 
            <b>do</b>
            {
                <span class="r64 r">randomNumber</span> = <a href="#3714cddc2f30faf5" class="i method">InternalSample</a>();
            } <b>while</b> (<span class="r64 r">randomNumber</span> == <b>int</b>.<span class="i">MaxValue</span>);
 
            <span class="r64 r">randomNumber</span> += <b>int</b>.<span class="i">MaxValue</span>;
            <b>return</b> <span class="r64 r">randomNumber</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
