<!DOCTYPE html>
<html><head><title>ShowCommandProxy.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(191);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility/commands/utility/ShowCommand/ShowCommandProxy.cs" target="_top">commands\utility\ShowCommand\ShowCommandProxy.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility" target="_top">src\Microsoft.PowerShell.Commands.Utility\Microsoft.PowerShell.Commands.Utility.csproj</a> (Microsoft.PowerShell.Commands.Utility)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">ShowCommandExtension</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Help show-command create WPF object and invoke WPF windows with the</span>
    <span class="c">///</span><span class="c"> Microsoft.PowerShell.Commands.ShowCommandInternal.ShowCommandHelperhelp type defined in Microsoft.PowerShell.GraphicalHost.dll.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="04d165ad86a001eb" href="../../../R/04d165ad86a001eb.html" target="n" data-glyph="2,0" class="t t">ShowCommandProxy</a>
    {
        <b>private const string</b> <a id="0c49b5726a809f61" href="../../../R/0c49b5726a809f61.html" target="n" data-glyph="10,1" class="i field">ShowCommandHelperName</a> = <span class="s">&quot;Microsoft.PowerShell.Commands.ShowCommandInternal.ShowCommandHelper&quot;</span>;
 
        <b>private readonly</b> <a href="ShowCommand.cs.html#a3a108671b8e01a8" class="t t">ShowCommandCommand</a> <a id="78e2770f04f4729b" href="../../../R/78e2770f04f4729b.html" target="n" data-glyph="46,1" class="i field">_cmdlet</a>;
 
        <b>private readonly</b> <span class="i">GraphicalHostReflectionWrapper</span> <a id="3346061d04848597" href="../../../R/3346061d04848597.html" target="n" data-glyph="46,1" class="i field">_graphicalHostReflectionWrapper</a>;
 
        <b>internal</b> <a id="fcba898d9318f101" href="../../../R/fcba898d9318f101.html" target="n" data-glyph="74,1" class="t constructor">ShowCommandProxy</a>(<a href="ShowCommand.cs.html#a3a108671b8e01a8" class="t t">ShowCommandCommand</a> <span id="r0 rd" class="r0 r">cmdlet</span>)
        {
            <a href="#78e2770f04f4729b" class="i field">_cmdlet</a> = <span class="r0 r">cmdlet</span>;
            <a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a> = <span class="i">GraphicalHostReflectionWrapper</span>.<span class="i">GetGraphicalHostReflectionWrapper</span>(<span class="r0 r">cmdlet</span>, <a href="#04d165ad86a001eb" class="t t">ShowCommandProxy</a>.<a href="#0c49b5726a809f61" class="i field">ShowCommandHelperName</a>);
        }
 
        <b>internal void</b> <a id="a2165bdb6aea5ff3" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ShowAllModulesWindow</a>(<span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ShowCommandModuleInfo.cs.html#94e8e395bca1945e" class="t t">ShowCommandModuleInfo</a>&gt; <span id="r1 rd" class="r1 r">importedModules</span>, <span class="i">IEnumerable</span>&lt;<a href="ShowCommandCommandInfo.cs.html#51715a8e99992426" class="t t">ShowCommandCommandInfo</a>&gt; <span id="r2 rd" class="r2 r">commands</span>, <b>bool</b> <span id="r3 rd" class="r3 r">noCommonParameter</span>, <b>bool</b> <span id="r4 rd" class="r4 r">passThrough</span>)
        {
            <a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallMethod</span>(<span class="s">&quot;ShowAllModulesWindow&quot;</span>, <a href="#78e2770f04f4729b" class="i field">_cmdlet</a>, <span class="r1 r">importedModules</span>, <span class="r2 r">commands</span>, <span class="r3 r">noCommonParameter</span>, <a href="#78e2770f04f4729b" class="i field">_cmdlet</a>.<a href="ShowCommand.cs.html#33b9d87141ee823a" class="i property">Width</a>, <a href="#78e2770f04f4729b" class="i field">_cmdlet</a>.<a href="ShowCommand.cs.html#3849c1a23eb42fda" class="i property">Height</a>, <span class="r4 r">passThrough</span>);
        }
 
        <b>internal void</b> <a id="85a930787ec7652e" href="../../../R/85a930787ec7652e.html" target="n" data-glyph="74,1" class="i method">ShowCommandWindow</a>(<b>object</b> <span id="r5 rd" class="r5 r">commandViewModelObj</span>, <b>bool</b> <span id="r6 rd" class="r6 r">passThrough</span>)
        {
            <a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallMethod</span>(<span class="s">&quot;ShowCommandWindow&quot;</span>, <a href="#78e2770f04f4729b" class="i field">_cmdlet</a>, <span class="r5 r">commandViewModelObj</span>, <a href="#78e2770f04f4729b" class="i field">_cmdlet</a>.<a href="ShowCommand.cs.html#33b9d87141ee823a" class="i property">Width</a>, <a href="#78e2770f04f4729b" class="i field">_cmdlet</a>.<a href="ShowCommand.cs.html#3849c1a23eb42fda" class="i property">Height</a>, <span class="r6 r">passThrough</span>);
        }
 
        <b>internal void</b> <a id="9e1c66ce8d0c5461" href="../../../R/9e1c66ce8d0c5461.html" target="n" data-glyph="74,1" class="i method">CloseWindow</a>()
        {
            <a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallMethod</span>(<span class="s">&quot;CloseWindow&quot;</span>);
        }
 
        <b>internal string</b> <a id="3f55d591dfa3a369" href="../../../R/3f55d591dfa3a369.html" target="n" data-glyph="74,1" class="i method">GetScript</a>()
        {
            <b>return</b> (<b>string</b>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallMethod</span>(<span class="s">&quot;GetScript&quot;</span>);
        }
 
        <b>internal void</b> <a id="2e6d4e840c767129" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ShowErrorString</a>(<b>string</b> <span id="r7 rd" class="r7 r">error</span>)
        {
            <a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallMethod</span>(<span class="s">&quot;ShowErrorString&quot;</span>, <span class="r7 r">error</span>);
        }
 
        <b>internal bool</b> <a id="bf0a47798292f965" href="../../../R/bf0a47798292f965.html" target="n" data-glyph="74,1" class="i method">SetPendingISECommand</a>(<b>string</b> <span id="r8 rd" class="r8 r">command</span>)
        {
            <b>return</b> (<b>bool</b>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallMethod</span>(<span class="s">&quot;SetPendingISECommand&quot;</span>, <span class="r8 r">command</span>);
        }
 
        <b>internal object</b> <a id="a9d835add6c91803" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetCommandViewModel</a>(<a href="ShowCommandCommandInfo.cs.html#51715a8e99992426" class="t t">ShowCommandCommandInfo</a> <span id="r9 rd" class="r9 r">command</span>, <b>bool</b> <span id="r10 rd" class="r10 r">noCommonParameter</span>, <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ShowCommandModuleInfo.cs.html#94e8e395bca1945e" class="t t">ShowCommandModuleInfo</a>&gt; <span id="r11 rd" class="r11 r">importedModules</span>, <b>bool</b> <span id="r12 rd" class="r12 r">moduleQualify</span>)
        {
            <b>return</b> <a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallStaticMethod</span>(<span class="s">&quot;GetCommandViewModel&quot;</span>, <span class="r9 r">command</span>, <span class="r10 r">noCommonParameter</span>, <span class="r11 r">importedModules</span>, <span class="r12 r">moduleQualify</span>);
        }
 
        <b>internal string</b> <a id="e372e306df439f1e" href="../../../R/e372e306df439f1e.html" target="n" data-glyph="74,1" class="i method">GetShowCommandCommand</a>(<b>string</b> <span id="r13 rd" class="r13 r">commandName</span>, <b>bool</b> <span id="r14 rd" class="r14 r">includeAliasAndModules</span>)
        {
            <b>return</b> (<b>string</b>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallStaticMethod</span>(<span class="s">&quot;GetShowCommandCommand&quot;</span>, <span class="r13 r">commandName</span>, <span class="r14 r">includeAliasAndModules</span>);
        }
 
        <b>internal string</b> <a id="2e090a9af1233e7d" href="../../../R/2e090a9af1233e7d.html" target="n" data-glyph="74,1" class="i method">GetShowAllModulesCommand</a>()
        {
            <b>return</b> (<b>string</b>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallStaticMethod</span>(<span class="s">&quot;GetShowAllModulesCommand&quot;</span>, <b>false</b>, <b>true</b>);
        }
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ShowCommandModuleInfo.cs.html#94e8e395bca1945e" class="t t">ShowCommandModuleInfo</a>&gt; <a id="411c43573744e14a" href="../../../R/411c43573744e14a.html" target="n" data-glyph="74,1" class="i method">GetImportedModulesDictionary</a>(<b>object</b>[] <span id="r15 rd" class="r15 r">moduleObjects</span>)
        {
            <b>return</b> (<span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ShowCommandModuleInfo.cs.html#94e8e395bca1945e" class="t t">ShowCommandModuleInfo</a>&gt;)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallStaticMethod</span>(<span class="s">&quot;GetImportedModulesDictionary&quot;</span>, <b>new</b> <b>object</b>[] { <span class="r15 r">moduleObjects</span> });
        }
 
        <b>internal</b> <span class="i">List</span>&lt;<a href="ShowCommandCommandInfo.cs.html#51715a8e99992426" class="t t">ShowCommandCommandInfo</a>&gt; <a id="d89401ca335cbfec" href="../../../R/d89401ca335cbfec.html" target="n" data-glyph="74,1" class="i method">GetCommandList</a>(<b>object</b>[] <span id="r16 rd" class="r16 r">commandObjects</span>)
        {
            <b>return</b> (<span class="i">List</span>&lt;<a href="ShowCommandCommandInfo.cs.html#51715a8e99992426" class="t t">ShowCommandCommandInfo</a>&gt;)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallStaticMethod</span>(<span class="s">&quot;GetCommandList&quot;</span>, <b>new</b> <b>object</b>[] { <span class="r16 r">commandObjects</span> });
        }
 
        <b>internal bool</b> <a id="48c1213c8fb1380b" href="../../../R/48c1213c8fb1380b.html" target="n" data-glyph="104,1" class="i property">HasHostWindow</a>
        {
            <b>get</b>
            {
                <b>return</b> (<b>bool</b>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">GetPropertyValue</span>(<span class="s">&quot;HasHostWindow&quot;</span>);
            }
        }
 
        <b>internal</b> <span class="i">AutoResetEvent</span> <a id="ab5696727083cfcb" href="../../../R/ab5696727083cfcb.html" target="n" data-glyph="104,1" class="i property">WindowClosed</a>
        {
            <b>get</b>
            {
                <b>return</b> (<span class="i">AutoResetEvent</span>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">GetPropertyValue</span>(<span class="s">&quot;WindowClosed&quot;</span>);
            }
        }
 
        <b>internal</b> <span class="i">AutoResetEvent</span> <a id="788680fd12d29813" href="../../../R/788680fd12d29813.html" target="n" data-glyph="104,1" class="i property">HelpNeeded</a>
        {
            <b>get</b>
            {
                <b>return</b> (<span class="i">AutoResetEvent</span>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">GetPropertyValue</span>(<span class="s">&quot;HelpNeeded&quot;</span>);
            }
        }
 
        <b>internal</b> <span class="i">AutoResetEvent</span> <a id="75608d4eb6396275" href="../../../R/75608d4eb6396275.html" target="n" data-glyph="104,1" class="i property">ImportModuleNeeded</a>
        {
            <b>get</b>
            {
                <b>return</b> (<span class="i">AutoResetEvent</span>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">GetPropertyValue</span>(<span class="s">&quot;ImportModuleNeeded&quot;</span>);
            }
        }
 
        <b>internal</b> <span class="i">AutoResetEvent</span> <a id="f9248703cd97c81e" href="../../../R/f9248703cd97c81e.html" target="n" data-glyph="104,1" class="i property">WindowLoaded</a>
        {
            <b>get</b>
            {
                <b>return</b> (<span class="i">AutoResetEvent</span>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">GetPropertyValue</span>(<span class="s">&quot;WindowLoaded&quot;</span>);
            }
        }
 
        <b>internal string</b> <a id="10139f7421e7ff2d" href="../../../R/10139f7421e7ff2d.html" target="n" data-glyph="104,1" class="i property">CommandNeedingHelp</a>
        {
            <b>get</b>
            {
                <b>return</b> (<b>string</b>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">GetPropertyValue</span>(<span class="s">&quot;CommandNeedingHelp&quot;</span>);
            }
        }
 
        <b>internal string</b> <a id="fa76cd958fcc6fff" href="../../../R/fa76cd958fcc6fff.html" target="n" data-glyph="104,1" class="i property">ParentModuleNeedingImportModule</a>
        {
            <b>get</b>
            {
                <b>return</b> (<b>string</b>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">GetPropertyValue</span>(<span class="s">&quot;ParentModuleNeedingImportModule&quot;</span>);
            }
        }
 
        <b>internal void</b> <a id="073cf0a09525cc30" href="../../../R/073cf0a09525cc30.html" target="n" data-glyph="74,1" class="i method">DisplayHelp</a>(<span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r17 rd" class="r17 r">helpResults</span>)
        {
            <a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallMethod</span>(<span class="s">&quot;DisplayHelp&quot;</span>, <span class="r17 r">helpResults</span>);
        }
 
        <b>internal string</b> <a id="054e7c00ccde2601" href="../../../R/054e7c00ccde2601.html" target="n" data-glyph="74,1" class="i method">GetImportModuleCommand</a>(<b>string</b> <span id="r18 rd" class="r18 r">module</span>)
        {
            <b>return</b> (<b>string</b>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallStaticMethod</span>(<span class="s">&quot;GetImportModuleCommand&quot;</span>, <span class="r18 r">module</span>, <b>false</b>, <b>true</b>);
        }
 
        <b>internal string</b> <a id="09bb8d53279f84e6" href="../../../R/09bb8d53279f84e6.html" target="n" data-glyph="74,1" class="i method">GetHelpCommand</a>(<b>string</b> <span id="r19 rd" class="r19 r">command</span>)
        {
            <b>return</b> (<b>string</b>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallStaticMethod</span>(<span class="s">&quot;GetHelpCommand&quot;</span>, <span class="r19 r">command</span>);
        }
 
        <b>internal void</b> <a id="7acb0b1d8d32217a" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ImportModuleDone</a>(<span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ShowCommandModuleInfo.cs.html#94e8e395bca1945e" class="t t">ShowCommandModuleInfo</a>&gt; <span id="r20 rd" class="r20 r">importedModules</span>, <span class="i">IEnumerable</span>&lt;<a href="ShowCommandCommandInfo.cs.html#51715a8e99992426" class="t t">ShowCommandCommandInfo</a>&gt; <span id="r21 rd" class="r21 r">commands</span>)
        {
            <a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallMethod</span>(<span class="s">&quot;ImportModuleDone&quot;</span>, <span class="r20 r">importedModules</span>, <span class="r21 r">commands</span>);
        }
 
        <b>internal void</b> <a id="9233fbf28495be7c" href="../../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ImportModuleFailed</a>(<span class="i">Exception</span> <span id="r22 rd" class="r22 r">reason</span>)
        {
            <a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallMethod</span>(<span class="s">&quot;ImportModuleFailed&quot;</span>, <span class="r22 r">reason</span>);
        }
 
        <b>internal void</b> <a id="9f7c41d673f45a68" href="../../../R/9f7c41d673f45a68.html" target="n" data-glyph="74,1" class="i method">ActivateWindow</a>()
        {
            <a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">CallMethod</span>(<span class="s">&quot;ActivateWindow&quot;</span>);
        }
 
        <b>internal double</b> <a id="38c58735143d8cb4" href="../../../R/38c58735143d8cb4.html" target="n" data-glyph="104,1" class="i property">ScreenWidth</a>
        {
            <b>get</b>
            {
                <b>return</b> (<b>double</b>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">GetStaticPropertyValue</span>(<span class="s">&quot;ScreenWidth&quot;</span>);
            }
        }
 
        <b>internal double</b> <a id="c138c905ae663eb5" href="../../../R/c138c905ae663eb5.html" target="n" data-glyph="104,1" class="i property">ScreenHeight</a>
        {
            <b>get</b>
            {
                <b>return</b> (<b>double</b>)<a href="#3346061d04848597" class="i field">_graphicalHostReflectionWrapper</a>.<span class="i">GetStaticPropertyValue</span>(<span class="s">&quot;ScreenHeight&quot;</span>);
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
