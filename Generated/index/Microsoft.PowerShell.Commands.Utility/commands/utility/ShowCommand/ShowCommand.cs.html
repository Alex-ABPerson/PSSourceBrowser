<!DOCTYPE html>
<html><head><title>ShowCommand.cs</title><link rel="stylesheet" href="../../../../styles.css"><script src="../../../../scripts.js"></script></head>
<body class="cB" onload="i(645);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility/commands/utility/ShowCommand/ShowCommand.cs" target="_top">commands\utility\ShowCommand\ShowCommand.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility" target="_top">src\Microsoft.PowerShell.Commands.Utility\Microsoft.PowerShell.Commands.Utility.csproj</a> (Microsoft.PowerShell.Commands.Utility)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">ShowCommandExtension</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Show-Command displays a GUI for a cmdlet, or for all cmdlets if no specific cmdlet is specified.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="/System.Management.Automation/A.html#2a7064bf93e98a48" class="i field">Show</a>, <span class="s">&quot;Command&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2109589&quot;</span>)]
    <b>public class</b> <a id="a3a108671b8e01a8" href="../../../R/a3a108671b8e01a8.html" target="n" data-glyph="0,0" class="t t"><span id="8943611c6b3a9009">ShowCommandCommand</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Fields
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set to true when ProcessRecord is reached, since it will always open a window.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="27608e86bbd28e2d" href="../../../R/27608e86bbd28e2d.html" target="n" data-glyph="46,1" class="i field">_hasOpenedWindow</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the command should be sent to the pipeline as a string instead of run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="3671724d182d5c72" href="../../../R/3671724d182d5c72.html" target="n" data-glyph="46,1" class="i field">_passThrough</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Uses ShowCommandProxy to invoke WPF GUI object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="ShowCommandProxy.cs.html#04d165ad86a001eb" class="t t">ShowCommandProxy</a> <a id="e32f3f6cdcfe231b" href="../../../R/e32f3f6cdcfe231b.html" target="n" data-glyph="46,1" class="i field">_showCommandProxy</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Data container for all cmdlets. This is populated when show-command is called with no command name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">List</span>&lt;<a href="ShowCommandCommandInfo.cs.html#51715a8e99992426" class="t t">ShowCommandCommandInfo</a>&gt; <a id="cb762be3ba750651" href="../../../R/cb762be3ba750651.html" target="n" data-glyph="46,1" class="i field">_commands</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> List of modules that have been loaded indexed by module name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ShowCommandModuleInfo.cs.html#94e8e395bca1945e" class="t t">ShowCommandModuleInfo</a>&gt; <a id="6f8887e2e94623e3" href="../../../R/6f8887e2e94623e3.html" target="n" data-glyph="46,1" class="i field">_importedModules</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Record the EndProcessing error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="/System.Management.Automation/A.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt; <a id="4e6b23e6d803dcb0" href="../../../R/4e6b23e6d803dcb0.html" target="n" data-glyph="46,1" class="i field">_errors</a> = <b>new</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Field used for the NoCommonParameter parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="363cdffb4ff59f20" href="../../../R/363cdffb4ff59f20.html" target="n" data-glyph="46,1" class="i field">_noCommonParameter</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object used for ShowCommand with a command name that holds the view model created for the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private object</b> <a id="1202b39ba5db8db8" href="../../../R/1202b39ba5db8db8.html" target="n" data-glyph="46,1" class="i field">_commandViewModelObj</a>;
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Input Cmdlet Parameter
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the command name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        [<span class="i">Alias</span>(<span class="s">&quot;CommandName&quot;</span>)]
        <b>public string</b> <a id="517f38dbdf24cea6" href="../../../R/517f38dbdf24cea6.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the Width.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateRange</span>(300, <b>int</b>.<span class="i">MaxValue</span>)]
        <b>public double</b> <a id="3849c1a23eb42fda" href="../../../R/3849c1a23eb42fda.html" target="n" data-glyph="102,1" class="i property">Height</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the Width.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateRange</span>(300, <b>int</b>.<span class="i">MaxValue</span>)]
        <b>public double</b> <a id="33b9d87141ee823a" href="../../../R/33b9d87141ee823a.html" target="n" data-glyph="102,1" class="i property">Width</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating Common Parameters should not be displayed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="65ecaa02ccbf1e33" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">NoCommonParameter</a>
        {
            <b>get</b> { <b>return</b> <a href="#363cdffb4ff59f20" class="i field">_noCommonParameter</a>; }
 
            <b>set</b> { <a href="#363cdffb4ff59f20" class="i field">_noCommonParameter</a> = <b>value</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating errors should not cause a message window to be displayed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="7f05b51889f52019" href="../../../R/7f05b51889f52019.html" target="n" data-glyph="102,1" class="i property">ErrorPopup</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating the command should be sent to the pipeline as a string instead of run.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="e0764a814d8b7812" href="../../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">PassThru</a>
        {
            <b>get</b> { <b>return</b> <a href="#3671724d182d5c72" class="i field">_passThrough</a>; }
 
            <b>set</b> { <a href="#3671724d182d5c72" class="i field">_passThrough</a> = <b>value</b>; }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public and Protected Methods
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Executes a PowerShell script, writing the output objects to the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">script</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Script to execute.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="ca901da235e46ed4" href="../../../R/ca901da235e46ed4.html" target="n" data-glyph="72,1" class="i method">RunScript</a>(<b>string</b> <span id="r0 rd" class="r0 r">script</span>)
        {
            <b>if</b> (<a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a> == <b>null</b> || <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r0 r">script</span>))
            {
                <b>return</b>;
            }
 
            <b>if</b> (<a href="#3671724d182d5c72" class="i field">_passThrough</a>)
            {
                <a href="#a3a108671b8e01a8" class="k">this</a>.<span class="i">WriteObject</span>(<span class="r0 r">script</span>);
                <b>return</b>;
            }
 
            <b>if</b> (<a href="#7f05b51889f52019" class="i property">ErrorPopup</a>)
            {
                <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#8a9302d575d45689" class="i method">RunScriptSilentlyAndWithErrorHookup</a>(<span class="r0 r">script</span>);
                <b>return</b>;
            }
 
            <b>if</b> (<a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#48c1213c8fb1380b" class="i property">HasHostWindow</a>)
            {
                <b>if</b> (!<a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#bf0a47798292f965" class="i method">SetPendingISECommand</a>(<span class="r0 r">script</span>))
                {
                    <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#8a9302d575d45689" class="i method">RunScriptSilentlyAndWithErrorHookup</a>(<span class="r0 r">script</span>);
                }
 
                <b>return</b>;
            }
 
            <span class="c">// Don&#39;t send newline at end as PSReadLine shows it rather than executing</span>
            <b>if</b> (!<a href="#05f96bf1a3996b30" class="t t">ConsoleInputWithNativeMethods</a>.<a href="#c0b1692e0565b406" class="i method">AddToConsoleInputBuffer</a>(<span class="r0 r">script</span>, <span class="r1 r">newLine</span>: <b>false</b>))
            {
                <a href="#a3a108671b8e01a8" class="k">this</a>.<span class="i">WriteDebug</span>(<span class="i">FormatAndOut_out_gridview</span>.<span class="i">CannotWriteToConsoleInputBuffer</span>);
                <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#8a9302d575d45689" class="i method">RunScriptSilentlyAndWithErrorHookup</a>(<span class="r0 r">script</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose method in IDisposable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="c7d63a00f48076db" href="../../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#da18196591d8a20b" class="i method">Dispose</a>(<b>true</b>);
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#a3a108671b8e01a8" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize a proxy instance for show-command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="16ce8901aa191cf2" href="../../../R/16ce8901aa191cf2.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a> = <b>new</b> <a href="ShowCommandProxy.cs.html#fcba898d9318f101" class="t constructor">ShowCommandProxy</a>(<a href="#a3a108671b8e01a8" class="k">this</a>);
 
            <b>if</b> (<a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#c138c905ae663eb5" class="i property">ScreenHeight</a> &lt; <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#3849c1a23eb42fda" class="i property">Height</a>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r2 rd" class="r2 r">error</span> = <b>new</b>(
                                    <b>new</b> <span class="i">NotSupportedException</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="i">FormatAndOut_out_gridview</span>.<span class="i">PropertyValidate</span>, <span class="s">&quot;Height&quot;</span>, <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#c138c905ae663eb5" class="i property">ScreenHeight</a>)),
                                    <span class="s">&quot;PARAMETER_DATA_ERROR&quot;</span>,
                                    <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#c855a7c43559f12f" class="i field">InvalidData</a>,
                                    <b>null</b>);
                <a href="#a3a108671b8e01a8" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="r2 r">error</span>);
            }
 
            <b>if</b> (<a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#38c58735143d8cb4" class="i property">ScreenWidth</a> &lt; <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#33b9d87141ee823a" class="i property">Width</a>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r3 rd" class="r3 r">error</span> = <b>new</b>(
                                    <b>new</b> <span class="i">NotSupportedException</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <span class="i">FormatAndOut_out_gridview</span>.<span class="i">PropertyValidate</span>, <span class="s">&quot;Width&quot;</span>, <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#38c58735143d8cb4" class="i property">ScreenWidth</a>)),
                                    <span class="s">&quot;PARAMETER_DATA_ERROR&quot;</span>,
                                    <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#c855a7c43559f12f" class="i field">InvalidData</a>,
                                    <b>null</b>);
                <a href="#a3a108671b8e01a8" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="r3 r">error</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProcessRecord with or without CommandName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="0a08e95f5654c420" href="../../../R/0a08e95f5654c420.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#517f38dbdf24cea6" class="i property">Name</a> == <b>null</b>)
            {
                <a href="#27608e86bbd28e2d" class="i field">_hasOpenedWindow</a> = <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#2302de3424a757b2" class="i method">CanProcessRecordForAllCommands</a>();
            }
            <b>else</b>
            {
                <a href="#27608e86bbd28e2d" class="i field">_hasOpenedWindow</a> = <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#a05c399ac3ebde27" class="i method">CanProcessRecordForOneCommand</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Optionally displays errors in a message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="4d8db4b1c0975495" href="../../../R/4d8db4b1c0975495.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <b>if</b> (!<a href="#27608e86bbd28e2d" class="i field">_hasOpenedWindow</a>)
            {
                <b>return</b>;
            }
 
            <span class="c">// We wait until the window is loaded and then activate it</span>
            <span class="c">// to work around the console window gaining activation somewhere</span>
            <span class="c">// in the end of ProcessRecord, which causes the keyboard focus</span>
            <span class="c">// (and use oif tab key to focus controls) to go away from the window</span>
            <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#f9248703cd97c81e" class="i property">WindowLoaded</a>.<span class="i">WaitOne</span>();
            <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#9f7c41d673f45a68" class="i method">ActivateWindow</a>();
 
            <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#67c4c7d4fc331460" class="i method">WaitForWindowClosedOrHelpNeeded</a>();
            <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#ca901da235e46ed4" class="i method">RunScript</a>(<a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#3f55d591dfa3a369" class="i method">GetScript</a>());
 
            <b>if</b> (<a href="#4e6b23e6d803dcb0" class="i field">_errors</a>.<a href="/System.Management.Automation/A.html#e7cb43bbebbb4aca" class="i property">Count</a> == 0 || !<a href="#7f05b51889f52019" class="i property">ErrorPopup</a>)
            {
                <b>return</b>;
            }
 
            <span class="i">StringBuilder</span> <span id="r4 rd" class="r4 r">errorString</span> = <b>new</b>();
 
            <b>for</b> (<b>int</b> <span id="r5 rd" class="r5 r">i</span> = 0; <span class="r5 r">i</span> &lt; <a href="#4e6b23e6d803dcb0" class="i field">_errors</a>.<a href="/System.Management.Automation/A.html#e7cb43bbebbb4aca" class="i property">Count</a>; <span class="r5 r">i</span>++)
            {
                <b>if</b> (<span class="r5 r">i</span> != 0)
                {
                    <span class="r4 r">errorString</span>.<span class="i">AppendLine</span>();
                }
 
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r6 rd" class="r6 r">error</span> = <a href="#4e6b23e6d803dcb0" class="i field">_errors</a>[<span class="r5 r">i</span>];
                <span class="r4 r">errorString</span>.<span class="i">Append</span>(<span class="r6 r">error</span>.<a href="/System.Management.Automation/A.html#2c2498db91e737eb" class="i property">Exception</a>.<span class="i">Message</span>);
            }
 
            <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<span class="i">ShowErrorString</span>(<span class="r4 r">errorString</span>.<span class="i">ToString</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopProcessing is called close the window when user press Ctrl+C in the command prompt.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="02f3b75fda27d7da" href="../../../R/02f3b75fda27d7da.html" target="n" data-glyph="75,1" class="i method">StopProcessing</a>()
        {
            <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#9e1c66ce8d0c5461" class="i method">CloseWindow</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runs the script in a new PowerShell instance and hooks up error stream to potentially display error popup.</span>
        <span class="c">///</span><span class="c"> This method has the inconvenience of not showing to the console user the script being executed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">script</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Script to be run.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="8a9302d575d45689" href="../../../R/8a9302d575d45689.html" target="n" data-glyph="76,1" class="i method">RunScriptSilentlyAndWithErrorHookup</a>(<b>string</b> <span id="r7 rd" class="r7 r">script</span>)
        {
            <span class="c">// errors are not created here, because there is a field for it used in the final pop up</span>
            <a href="/System.Management.Automation/A.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<b>object</b>&gt; <span id="r8 rd" class="r8 r">output</span> = <b>new</b>();
 
            <span class="r8 r">output</span>.<a href="/System.Management.Automation/A.html#de98d172ff9dac86" class="i">DataAdded</a> += <a href="#a3a108671b8e01a8" class="k">this</a>.<span class="i">Output_DataAdded</span>;
            <a href="#4e6b23e6d803dcb0" class="i field">_errors</a>.<a href="/System.Management.Automation/A.html#de98d172ff9dac86" class="i">DataAdded</a> += <a href="#a3a108671b8e01a8" class="k">this</a>.<span class="i">Error_DataAdded</span>;
 
            <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="/System.Management.Automation/A.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r9 rd" class="r9 r">ps</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="/System.Management.Automation/A.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="/System.Management.Automation/A.html#1c6a51d3c837bb4d" class="i method">Create</a>(<a href="/System.Management.Automation/A.html#c3c0f0e5e0b337ff" class="t t">RunspaceMode</a>.<a href="/System.Management.Automation/A.html#75d224de5df87e75" class="i field">CurrentRunspace</a>);
            <span class="r9 r">ps</span>.<a href="/System.Management.Automation/A.html#622ebeade9b6ada7" class="i property">Streams</a>.<span class="i">Error</span> = <a href="#4e6b23e6d803dcb0" class="i field">_errors</a>;
 
            <span class="r9 r">ps</span>.<a href="/System.Management.Automation/A.html#7bde27452e045465" class="i property">Commands</a>.<span class="i">AddScript</span>(<span class="r7 r">script</span>);
 
            <span class="r9 r">ps</span>.<span class="i">Invoke</span>(<b>null</b>, <span class="r8 r">output</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Issues an error when this.commandName was not found.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="f23ba395a7c7818d" href="../../../R/f23ba395a7c7818d.html" target="n" data-glyph="76,1" class="i method">IssueErrorForNoCommand</a>()
        {
            <span class="i">InvalidOperationException</span> <span id="r10 rd" class="r10 r">errorException</span> = <b>new</b>(
                <b>string</b>.<span class="i">Format</span>(
                    <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>,
                    <span class="i">FormatAndOut_out_gridview</span>.<span class="i">CommandNotFound</span>,
                    <a href="#517f38dbdf24cea6" class="i property">Name</a>));
            <a href="#a3a108671b8e01a8" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r10 r">errorException</span>, <span class="s">&quot;NoCommand&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <a href="#517f38dbdf24cea6" class="i property">Name</a>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Issues an error when there is more than one command matching this.commandName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b82edaa7be3a380c" href="../../../R/b82edaa7be3a380c.html" target="n" data-glyph="76,1" class="i method">IssueErrorForMoreThanOneCommand</a>()
        {
            <span class="i">InvalidOperationException</span> <span id="r11 rd" class="r11 r">errorException</span> = <b>new</b>(
                <b>string</b>.<span class="i">Format</span>(
                    <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>,
                    <span class="i">FormatAndOut_out_gridview</span>.<span class="i">MoreThanOneCommand</span>,
                    <a href="#517f38dbdf24cea6" class="i property">Name</a>,
                    <span class="s">&quot;Show-Command&quot;</span>));
            <a href="#a3a108671b8e01a8" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r11 r">errorException</span>, <span class="s">&quot;MoreThanOneCommand&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <a href="#517f38dbdf24cea6" class="i property">Name</a>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called from CommandProcessRecord to run the command that will get the CommandInfo and list of modules.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command to be retrieved.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">modules</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of loaded modules.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="e4d22c916137bcad" href="../../../R/e4d22c916137bcad.html" target="n" data-glyph="76,1" class="i method">GetCommandInfoAndModules</a>(<b>out</b> <a href="/System.Management.Automation/A.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r12 rd" class="r12 r">command</span>, <b>out</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ShowCommandModuleInfo.cs.html#94e8e395bca1945e" class="t t">ShowCommandModuleInfo</a>&gt; <span id="r13 rd" class="r13 r">modules</span>)
        {
            <span class="r12 r">command</span> = <b>null</b>;
            <span class="r13 r">modules</span> = <b>null</b>;
            <b>string</b> <span id="r14 rd" class="r14 r">commandText</span> = <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#e372e306df439f1e" class="i method">GetShowCommandCommand</a>(<a href="#517f38dbdf24cea6" class="i property">Name</a>, <b>true</b>);
 
            <span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r15 rd" class="r15 r">commandResults</span> = <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="/System.Management.Automation/A.html#515d359906da8f3d" class="i property">InvokeCommand</a>.<span class="i">InvokeScript</span>(<span class="r14 r">commandText</span>);
 
            <b>object</b>[] <span id="r16 rd" class="r16 r">commandObjects</span> = (<b>object</b>[])<span class="r15 r">commandResults</span>[0].<span class="i">BaseObject</span>;
            <b>object</b>[] <span id="r17 rd" class="r17 r">moduleObjects</span> = (<b>object</b>[])<span class="r15 r">commandResults</span>[1].<span class="i">BaseObject</span>;
            <b>if</b> (<span class="r15 r">commandResults</span> == <b>null</b> || <span class="r17 r">moduleObjects</span> == <b>null</b> || <span class="r16 r">commandObjects</span>.<span class="i">Length</span> == 0)
            {
                <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#f23ba395a7c7818d" class="i method">IssueErrorForNoCommand</a>();
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r16 r">commandObjects</span>.<span class="i">Length</span> &gt; 1)
            {
                <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#b82edaa7be3a380c" class="i method">IssueErrorForMoreThanOneCommand</a>();
            }
 
            <span class="r12 r">command</span> = ((<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r16 r">commandObjects</span>[0]).<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as</b> <a href="/System.Management.Automation/A.html#71babe57a99ca852" class="t t">CommandInfo</a>;
            <b>if</b> (<span class="r12 r">command</span> == <b>null</b>)
            {
                <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#f23ba395a7c7818d" class="i method">IssueErrorForNoCommand</a>();
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r12 r">command</span>.<a href="/System.Management.Automation/A.html#1aa74ca244a39308" class="i property">CommandType</a> == <a href="/System.Management.Automation/A.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="/System.Management.Automation/A.html#83aa5e1f88cb9bf5" class="i field">Alias</a>)
            {
                <span class="r14 r">commandText</span> = <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#e372e306df439f1e" class="i method">GetShowCommandCommand</a>(<span class="r12 r">command</span>.<a href="/System.Management.Automation/A.html#a887e8cd226475a7" class="i property">Definition</a>, <b>false</b>);
                <span class="r15 r">commandResults</span> = <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="/System.Management.Automation/A.html#515d359906da8f3d" class="i property">InvokeCommand</a>.<span class="i">InvokeScript</span>(<span class="r14 r">commandText</span>);
                <b>if</b> (<span class="r15 r">commandResults</span> == <b>null</b> || <span class="r15 r">commandResults</span>.<span class="i">Count</span> != 1)
                {
                    <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#f23ba395a7c7818d" class="i method">IssueErrorForNoCommand</a>();
                    <b>return</b>;
                }
 
                <span class="r12 r">command</span> = (<a href="/System.Management.Automation/A.html#71babe57a99ca852" class="t t">CommandInfo</a>)<span class="r15 r">commandResults</span>[0].<span class="i">BaseObject</span>;
            }
 
            <span class="r13 r">modules</span> = <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#411c43573744e14a" class="i method">GetImportedModulesDictionary</a>(<span class="r17 r">moduleObjects</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProcessRecord when a command name is specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if there was no exception processing this record.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="a05c399ac3ebde27" href="../../../R/a05c399ac3ebde27.html" target="n" data-glyph="76,1" class="i method">CanProcessRecordForOneCommand</a>()
        {
            <a href="/System.Management.Automation/A.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r18 rd" class="r18 r">commandInfo</span>;
            <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#e4d22c916137bcad" class="i method">GetCommandInfoAndModules</a>(<b>out</b> <span class="r18 r">commandInfo</span>, <b>out</b> <a href="#6f8887e2e94623e3" class="i field">_importedModules</a>);
            <span class="i">Diagnostics</span>.<span class="i">Assert</span>(<span class="r18 r">commandInfo</span> != <b>null</b>, <span class="s">&quot;GetCommandInfoAndModules would throw a terminating error/exception&quot;</span>);
 
            <b>try</b>
            {
                <a href="#1202b39ba5db8db8" class="i field">_commandViewModelObj</a> = <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<span class="i">GetCommandViewModel</span>(<b>new</b> <a href="ShowCommandCommandInfo.cs.html#72c56324c2e1717c" class="t constructor">ShowCommandCommandInfo</a>(<span class="r18 r">commandInfo</span>), <a href="#363cdffb4ff59f20" class="i field">_noCommonParameter</a>.<span class="i">ToBool</span>(), <a href="#6f8887e2e94623e3" class="i field">_importedModules</a>, <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="#517f38dbdf24cea6" class="i property">Name</a>.<span class="i">Contains</span>(<span class="s">&#39;\\&#39;</span>));
                <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#85a930787ec7652e" class="i method">ShowCommandWindow</a>(<a href="#1202b39ba5db8db8" class="i field">_commandViewModelObj</a>, <a href="#3671724d182d5c72" class="i field">_passThrough</a>);
            }
            <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r19 rd" class="r19 r">ti</span>)
            {
                <a href="#a3a108671b8e01a8" class="k">this</a>.<span class="i">WriteError</span>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r19 r">ti</span>.<span class="i">InnerException</span>, <span class="s">&quot;CannotProcessRecordForOneCommand&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <a href="#517f38dbdf24cea6" class="i property">Name</a>));
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProcessRecord when a command name is not specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if there was no exception processing this record.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="2302de3424a757b2" href="../../../R/2302de3424a757b2.html" target="n" data-glyph="76,1" class="i method">CanProcessRecordForAllCommands</a>()
        {
            <span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r20 rd" class="r20 r">rawCommands</span> = <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="/System.Management.Automation/A.html#515d359906da8f3d" class="i property">InvokeCommand</a>.<span class="i">InvokeScript</span>(<a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#2e090a9af1233e7d" class="i method">GetShowAllModulesCommand</a>());
 
            <a href="#cb762be3ba750651" class="i field">_commands</a> = <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#d89401ca335cbfec" class="i method">GetCommandList</a>((<b>object</b>[])<span class="r20 r">rawCommands</span>[0].<span class="i">BaseObject</span>);
            <a href="#6f8887e2e94623e3" class="i field">_importedModules</a> = <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#411c43573744e14a" class="i method">GetImportedModulesDictionary</a>((<b>object</b>[])<span class="r20 r">rawCommands</span>[1].<span class="i">BaseObject</span>);
 
            <b>try</b>
            {
                <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<span class="i">ShowAllModulesWindow</span>(<a href="#6f8887e2e94623e3" class="i field">_importedModules</a>, <a href="#cb762be3ba750651" class="i field">_commands</a>, <a href="#363cdffb4ff59f20" class="i field">_noCommonParameter</a>.<span class="i">ToBool</span>(), <a href="#3671724d182d5c72" class="i field">_passThrough</a>);
            }
            <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r21 rd" class="r21 r">ti</span>)
            {
                <a href="#a3a108671b8e01a8" class="k">this</a>.<span class="i">WriteError</span>(<b>new</b> <span class="t">ErrorRecord</span>(<span class="r21 r">ti</span>.<span class="i">InnerException</span>, <span class="s">&quot;CannotProcessRecordForAllCommands&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <a href="#517f38dbdf24cea6" class="i property">Name</a>));
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Waits until the window has been closed answering HelpNeeded events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="67c4c7d4fc331460" href="../../../R/67c4c7d4fc331460.html" target="n" data-glyph="76,1" class="i method">WaitForWindowClosedOrHelpNeeded</a>()
        {
            <b>while</b> (<b>true</b>)
            {
                <b>int</b> <span id="r22 rd" class="r22 r">which</span> = <span class="i">WaitHandle</span>.<span class="i">WaitAny</span>(<b>new</b> <span class="i">WaitHandle</span>[] { <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#ab5696727083cfcb" class="i property">WindowClosed</a>, <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#788680fd12d29813" class="i property">HelpNeeded</a>, <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#75608d4eb6396275" class="i property">ImportModuleNeeded</a> });
 
                <b>if</b> (<span class="r22 r">which</span> == 0)
                {
                    <b>break</b>;
                }
 
                <b>if</b> (<span class="r22 r">which</span> == 1)
                {
                    <span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r23 rd" class="r23 r">helpResults</span> = <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="/System.Management.Automation/A.html#515d359906da8f3d" class="i property">InvokeCommand</a>.<span class="i">InvokeScript</span>(<a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#09bb8d53279f84e6" class="i method">GetHelpCommand</a>(<a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#10139f7421e7ff2d" class="i property">CommandNeedingHelp</a>));
                    <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#073cf0a09525cc30" class="i method">DisplayHelp</a>(<span class="r23 r">helpResults</span>);
                    <b>continue</b>;
                }
 
                <span class="i">Diagnostics</span>.<span class="i">Assert</span>(<span class="r22 r">which</span> == 2, <span class="s">&quot;which is 0,1 or 2 and 0 and 1 have been eliminated in the ifs above&quot;</span>);
                <b>string</b> <span id="r24 rd" class="r24 r">commandToRun</span> = <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#054e7c00ccde2601" class="i method">GetImportModuleCommand</a>(<a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#fa76cd958fcc6fff" class="i property">ParentModuleNeedingImportModule</a>);
                <span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r25 rd" class="r25 r">rawCommands</span>;
                <b>try</b>
                {
                    <span class="r25 r">rawCommands</span> = <a href="#a3a108671b8e01a8" class="k">this</a>.<a href="/System.Management.Automation/A.html#515d359906da8f3d" class="i property">InvokeCommand</a>.<span class="i">InvokeScript</span>(<span class="r24 r">commandToRun</span>);
                }
                <b>catch</b> (<a href="/System.Management.Automation/A.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r26 rd" class="r26 r">e</span>)
                {
                    <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<span class="i">ImportModuleFailed</span>(<span class="r26 r">e</span>);
                    <b>continue</b>;
                }
 
                <a href="#cb762be3ba750651" class="i field">_commands</a> = <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#d89401ca335cbfec" class="i method">GetCommandList</a>((<b>object</b>[])<span class="r25 r">rawCommands</span>[0].<span class="i">BaseObject</span>);
                <a href="#6f8887e2e94623e3" class="i field">_importedModules</a> = <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<a href="ShowCommandProxy.cs.html#411c43573744e14a" class="i method">GetImportedModulesDictionary</a>((<b>object</b>[])<span class="r25 r">rawCommands</span>[1].<span class="i">BaseObject</span>);
                <a href="#e32f3f6cdcfe231b" class="i field">_showCommandProxy</a>.<span class="i">ImportModuleDone</span>(<a href="#6f8887e2e94623e3" class="i field">_importedModules</a>, <a href="#cb762be3ba750651" class="i field">_commands</a>);
                <b>continue</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes the output of a script being run into the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Output collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Output event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="9a1be9b7a6eb28d6" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">Output_DataAdded</a>(<b>object</b> <span id="r27 rd" class="r27 r">sender</span>, <a href="/System.Management.Automation/A.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r28 rd" class="r28 r">e</span>)
        {
            <a href="#a3a108671b8e01a8" class="k">this</a>.<span class="i">WriteObject</span>(((<a href="/System.Management.Automation/A.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<b>object</b>&gt;)<span class="r27 r">sender</span>)[<span class="r28 r">e</span>.<a href="/System.Management.Automation/A.html#0ed8637c462f29c7" class="i property">Index</a>]);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Writes the errors of a script being run into the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">sender</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Error collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Error event.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="8c193c8784c5d0dd" href="../../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">Error_DataAdded</a>(<b>object</b> <span id="r29 rd" class="r29 r">sender</span>, <a href="/System.Management.Automation/A.html#7044b5d8986ab72f" class="t t">DataAddedEventArgs</a> <span id="r30 rd" class="r30 r">e</span>)
        {
            <a href="#a3a108671b8e01a8" class="k">this</a>.<span class="i">WriteError</span>(((<a href="/System.Management.Automation/A.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a>&gt;)<span class="r29 r">sender</span>)[<span class="r30 r">e</span>.<a href="/System.Management.Automation/A.html#0ed8637c462f29c7" class="i property">Index</a>]);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Implements IDisposable logic.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">isDisposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if being called from Dispose.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="da18196591d8a20b" href="../../../R/da18196591d8a20b.html" target="n" data-glyph="76,1" class="i method">Dispose</a>(<b>bool</b> <span id="r31 rd" class="r31 r">isDisposing</span>)
        {
            <b>if</b> (<span class="r31 r">isDisposing</span>)
            {
                <b>if</b> (<a href="#4e6b23e6d803dcb0" class="i field">_errors</a> != <b>null</b>)
                {
                    <a href="#4e6b23e6d803dcb0" class="i field">_errors</a>.<span class="i">Dispose</span>();
                    <a href="#4e6b23e6d803dcb0" class="i field">_errors</a> = <b>null</b>;
                }
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wraps interop code for console input buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static class</b> <a id="05f96bf1a3996b30" href="../../../R/05f96bf1a3996b30.html" target="n" data-glyph="2,1" class="t t">ConsoleInputWithNativeMethods</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Constant used in calls to GetStdHandle.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal const int</b> <a id="054482d61065dcf1" href="../../../R/054482d61065dcf1.html" target="n" data-glyph="8,2" class="i field">STD_INPUT_HANDLE</a> = -10;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Adds a string to the console input buffer.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">str</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">String to add to console input buffer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">newLine</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True to add Enter after the string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if it was successful in adding all characters to console input buffer.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>internal static bool</b> <a id="c0b1692e0565b406" href="../../../R/c0b1692e0565b406.html" target="n" data-glyph="74,2" class="i method">AddToConsoleInputBuffer</a>(<b>string</b> <span id="r32 rd" class="r32 r">str</span>, <b>bool</b> <span id="r1 rd" class="r1 r">newLine</span>)
            {
                <span class="i">IntPtr</span> <span id="r33 rd" class="r33 r">handle</span> = <a href="#05f96bf1a3996b30" class="t t">ConsoleInputWithNativeMethods</a>.<a href="#c013cb89adbaf01f" class="i method">GetStdHandle</a>(<a href="#05f96bf1a3996b30" class="t t">ConsoleInputWithNativeMethods</a>.<a href="#054482d61065dcf1" class="i field">STD_INPUT_HANDLE</a>);
                <b>if</b> (<span class="r33 r">handle</span> == <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <b>return</b> <b>false</b>;
                }
 
                <b>uint</b> <span id="r34 rd" class="r34 r">strLen</span> = (<b>uint</b>)<span class="r32 r">str</span>.<span class="i">Length</span>;
 
                <a href="#05f96bf1a3996b30" class="t t">ConsoleInputWithNativeMethods</a>.<a href="#0c1b6f2236161bc1" class="t t">INPUT_RECORD</a>[] <span id="r35 rd" class="r35 r">records</span> = <b>new</b> <a href="#05f96bf1a3996b30" class="t t">ConsoleInputWithNativeMethods</a>.<a href="#0c1b6f2236161bc1" class="t t">INPUT_RECORD</a>[<span class="r34 r">strLen</span> + (<span class="r1 r">newLine</span> ? 1 : 0)];
 
                <b>for</b> (<b>int</b> <span id="r36 rd" class="r36 r">i</span> = 0; <span class="r36 r">i</span> &lt; <span class="r34 r">strLen</span>; <span class="r36 r">i</span>++)
                {
                    <a href="#05f96bf1a3996b30" class="t t">ConsoleInputWithNativeMethods</a>.<a href="#0c1b6f2236161bc1" class="t t">INPUT_RECORD</a>.<span class="i">SetInputRecord</span>(<b>ref</b> <span class="r35 r">records</span>[<span class="r36 r">i</span>], <span class="r32 r">str</span>[<span class="r36 r">i</span>]);
                }
 
                <b>uint</b> <span id="r37 rd" class="r37 r">written</span>;
                <b>if</b> (!<a href="#05f96bf1a3996b30" class="t t">ConsoleInputWithNativeMethods</a>.<a href="#c0d2f723b9237cba" class="i method">WriteConsoleInput</a>(<span class="r33 r">handle</span>, <span class="r35 r">records</span>, <span class="r34 r">strLen</span>, <b>out</b> <span class="r37 r">written</span>) || <span class="r37 r">written</span> != <span class="r34 r">strLen</span>)
                {
                    <span class="c">// I do not know of a case where written is not going to be strlen. Maybe for some character that</span>
                    <span class="c">// is not supported in the console. The API suggests this can happen,</span>
                    <span class="c">// so we handle it by returning false</span>
                    <b>return</b> <b>false</b>;
                }
 
                <span class="c">// Enter is written separately, because if this is a command, and one of the characters in the command was not written</span>
                <span class="c">// (written != strLen) it is desireable to fail (return false) before typing enter and running the command</span>
                <b>if</b> (<span class="r1 r">newLine</span>)
                {
                    <a href="#05f96bf1a3996b30" class="t t">ConsoleInputWithNativeMethods</a>.<a href="#0c1b6f2236161bc1" class="t t">INPUT_RECORD</a>[] <span id="r38 rd" class="r38 r">enterArray</span> = <b>new</b> <a href="#05f96bf1a3996b30" class="t t">ConsoleInputWithNativeMethods</a>.<a href="#0c1b6f2236161bc1" class="t t">INPUT_RECORD</a>[1];
                    <a href="#05f96bf1a3996b30" class="t t">ConsoleInputWithNativeMethods</a>.<a href="#0c1b6f2236161bc1" class="t t">INPUT_RECORD</a>.<a href="#ffc19bfc113d6f69" class="i method">SetInputRecord</a>(<b>ref</b> <span class="r38 r">enterArray</span>[0], (<b>char</b>)13);
 
                    <span class="r37 r">written</span> = 0;
                    <b>if</b> (!<a href="#05f96bf1a3996b30" class="t t">ConsoleInputWithNativeMethods</a>.<a href="#c0d2f723b9237cba" class="i method">WriteConsoleInput</a>(<span class="r33 r">handle</span>, <span class="r38 r">enterArray</span>, 1, <b>out</b> <span class="r37 r">written</span>))
                    {
                        <span class="c">// I don&#39;t think this will happen</span>
                        <b>return</b> <b>false</b>;
                    }
 
                    <span class="i">Diagnostics</span>.<span class="i">Assert</span>(<span class="r37 r">written</span> == 1, <span class="s">&quot;only Enter is being added and it is a supported character&quot;</span>);
                }
 
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Gets the console handle.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">nStdHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Which console handle to get.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The console handle.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            [<span class="i">DllImport</span>(<span class="s">&quot;kernel32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>)]
            <b>internal static extern</b> <span class="i">IntPtr</span> <a id="c013cb89adbaf01f" href="../../../R/c013cb89adbaf01f.html" target="n" data-glyph="74,2" class="i method">GetStdHandle</a>(<b>int</b> <span id="r39 rd" class="r39 r">nStdHandle</span>);
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Writes to the console input buffer.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">hConsoleInput</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Console handle.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">lpBuffer</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Inputs to be written.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">nLength</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Number of inputs to be written.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">lpNumberOfEventsWritten</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Returned number of inputs actually written.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">0 if the function fails.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            [<span class="i">DllImport</span>(<span class="s">&quot;kernel32.dll&quot;</span>, <span class="i">SetLastError</span> = <b>true</b>)]
            [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
            <b>internal static extern bool</b> <a id="c0d2f723b9237cba" href="../../../R/c0d2f723b9237cba.html" target="n" data-glyph="74,2" class="i method">WriteConsoleInput</a>(
                <span class="i">IntPtr</span> <span id="r40 rd" class="r40 r">hConsoleInput</span>,
                <a href="#0c1b6f2236161bc1" class="t t">INPUT_RECORD</a>[] <span id="r41 rd" class="r41 r">lpBuffer</span>,
                <b>uint</b> <span id="r42 rd" class="r42 r">nLength</span>,
                <b>out uint</b> <span id="r43 rd" class="r43 r">lpNumberOfEventsWritten</span>);
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> A record to be added to the console buffer.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal struct</b> <a id="0c1b6f2236161bc1" href="../../../R/0c1b6f2236161bc1.html" target="n" data-glyph="110,2" class="t t"><span id="bdcf136aeb6e2d79">INPUT_RECORD</span></a>
            {
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> The proper event type for a KeyEvent KEY_EVENT_RECORD.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal const int</b> <a id="4ec180304e37411b" href="../../../R/4ec180304e37411b.html" target="n" data-glyph="8,3" class="i field">KEY_EVENT</a> = 0x0001;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Input buffer event type.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal ushort</b> <a id="12d620f65ce053fa" href="../../../R/12d620f65ce053fa.html" target="n" data-glyph="44,3" class="i field">EventType</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> The actual event. The original structure is a union of many others, but this is the largest of them.</span>
                <span class="c">///</span><span class="c"> And we don&#39;t need other kinds of events.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal</b> <a href="#23ff68cdc60f124d" class="t t">KEY_EVENT_RECORD</a> <a id="b15192b71784e639" href="../../../R/b15192b71784e639.html" target="n" data-glyph="44,3" class="i field">KeyEvent</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Sets the necessary fields of </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">inputRecord</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> for a KeyDown event for the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">character</span><span class="c">&quot;</span><span class="c">/&gt;</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">inputRecord</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Input record to be set.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">character</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Character to set the record with.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
                <b>internal static void</b> <a id="ffc19bfc113d6f69" href="../../../R/ffc19bfc113d6f69.html" target="n" data-glyph="74,3" class="i method">SetInputRecord</a>(<b>ref</b> <a href="#0c1b6f2236161bc1" class="t t">INPUT_RECORD</a> <span id="r44 rd" class="r44 r">inputRecord</span>, <b>char</b> <span id="r45 rd" class="r45 r">character</span>)
                {
                    <span class="r44 r">inputRecord</span>.<a href="#12d620f65ce053fa" class="i field">EventType</a> = <a href="#0c1b6f2236161bc1" class="t t">INPUT_RECORD</a>.<a href="#4ec180304e37411b" class="i field">KEY_EVENT</a>;
                    <span class="r44 r">inputRecord</span>.<a href="#b15192b71784e639" class="i field">KeyEvent</a>.<a href="#799a3b0170f97c77" class="i field">bKeyDown</a> = <b>true</b>;
                    <span class="r44 r">inputRecord</span>.<a href="#b15192b71784e639" class="i field">KeyEvent</a>.<a href="#f5ecf48454fdc83a" class="i field">UnicodeChar</a> = <span class="r45 r">character</span>;
                }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Type of INPUT_RECORD which is a key.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
            <b>internal struct</b> <a id="23ff68cdc60f124d" href="../../../R/23ff68cdc60f124d.html" target="n" data-glyph="110,2" class="t t"><span id="079d95cc29b81ce2">KEY_EVENT_RECORD</span></a>
            {
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> True for key down and false for key up, but only needed if wVirtualKeyCode is used.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal bool</b> <a id="799a3b0170f97c77" href="../../../R/799a3b0170f97c77.html" target="n" data-glyph="44,3" class="i field">bKeyDown</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Repeat count.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal ushort</b> <a id="f3e9c984cd5f4042" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">wRepeatCount</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Virtual key code.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal ushort</b> <a id="82bd80b354755ce1" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">wVirtualKeyCode</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Virtual key scan code.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal ushort</b> <a id="5299ee950e54735e" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">wVirtualScanCode</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> Character in input. If this is specified, wVirtualKeyCode, and others don&#39;t need to be.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal char</b> <a id="f5ecf48454fdc83a" href="../../../R/f5ecf48454fdc83a.html" target="n" data-glyph="44,3" class="i field">UnicodeChar</a>;
 
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
                <span class="c">///</span><span class="c"> State of keys like Shift and control.</span>
                <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
                <b>internal uint</b> <a id="25585f33f0df47d1" href="../../../R/../../0000000000.html" target="n" data-glyph="44,3" class="i field">dwControlKeyState</a>;
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
