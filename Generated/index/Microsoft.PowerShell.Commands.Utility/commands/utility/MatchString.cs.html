<!DOCTYPE html>
<html><head><title>MatchString.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(2116);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility/commands/utility/MatchString.cs" target="_top">commands\utility\MatchString.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility" target="_top">src\Microsoft.PowerShell.Commands.Utility\Microsoft.PowerShell.Commands.Utility.csproj</a> (Microsoft.PowerShell.Commands.Utility)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">RegularExpressions</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Context information about a match.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="8bc633da0745cf9a" href="../../R/8bc633da0745cf9a.html" target="n" data-glyph="0,0" class="t t">MatchInfoContext</a> : <span class="i">ICloneable</span>
    {
        <b>internal</b> <a id="a42239dc05d84e44" href="../../R/a42239dc05d84e44.html" target="n" data-glyph="74,1" class="t constructor">MatchInfoContext</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the lines found before a match.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b>[] <a id="9ffef6afab5e8998" href="../../R/9ffef6afab5e8998.html" target="n" data-glyph="102,1" class="i property">PreContext</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the lines found after a match.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b>[] <a id="40a9f668be7538fe" href="../../R/40a9f668be7538fe.html" target="n" data-glyph="102,1" class="i property">PostContext</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the lines found before a match. Does not include</span>
        <span class="c">///</span><span class="c"> overlapping context and thus can be used to</span>
        <span class="c">///</span><span class="c"> display contiguous match regions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b>[] <a id="4dbca262af59f815" href="../../R/4dbca262af59f815.html" target="n" data-glyph="102,1" class="i property">DisplayPreContext</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the lines found after a match. Does not include</span>
        <span class="c">///</span><span class="c"> overlapping context and thus can be used to</span>
        <span class="c">///</span><span class="c"> display contiguous match regions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b>[] <a id="9805fdc40236ed96" href="../../R/9805fdc40236ed96.html" target="n" data-glyph="102,1" class="i property">DisplayPostContext</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Produce a deep copy of this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A new object that is a copy of this instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public object</b> <a id="1b79e7be9425d1ba" href="../../R/1b79e7be9425d1ba.html" target="n" data-glyph="72,1" class="i method">Clone</a>()
        {
            <b>return</b> <b>new</b> <a href="#a42239dc05d84e44" class="t constructor">MatchInfoContext</a>()
            {
                <a href="#9ffef6afab5e8998" class="i property">PreContext</a> = (<b>string</b>[])<a href="#9ffef6afab5e8998" class="i property">PreContext</a>?.<span class="i">Clone</span>(),
                <a href="#40a9f668be7538fe" class="i property">PostContext</a> = (<b>string</b>[])<a href="#40a9f668be7538fe" class="i property">PostContext</a>?.<span class="i">Clone</span>(),
                <a href="#4dbca262af59f815" class="i property">DisplayPreContext</a> = (<b>string</b>[])<a href="#4dbca262af59f815" class="i property">DisplayPreContext</a>?.<span class="i">Clone</span>(),
                <a href="#9805fdc40236ed96" class="i property">DisplayPostContext</a> = (<b>string</b>[])<a href="#9805fdc40236ed96" class="i property">DisplayPostContext</a>?.<span class="i">Clone</span>()
            };
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The object returned by select-string representing the result of a match.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="ecfd8061bec2ec5a" href="../../R/ecfd8061bec2ec5a.html" target="n" data-glyph="0,0" class="t t">MatchInfo</a>
    {
        <b>private static readonly string</b> <a id="669a525e4bba8399" href="../../R/669a525e4bba8399.html" target="n" data-glyph="46,1" class="i field">s_inputStream</a> = <span class="s">&quot;InputStream&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating whether the match was done ignoring case.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">True if case was ignored.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="4d58edc0930cae89" href="../../R/4d58edc0930cae89.html" target="n" data-glyph="102,1" class="i property">IgnoreCase</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the number of the matching line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The number of the matching line.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public int</b> <a id="d2a37f2623812bc0" href="../../R/d2a37f2623812bc0.html" target="n" data-glyph="102,1" class="i property">LineNumber</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the text of the matching line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The text of the matching line.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public string</b> <a id="df1b0dad44591830" href="../../R/df1b0dad44591830.html" target="n" data-glyph="102,1" class="i property">Line</a> { <b>get</b>; <b>set</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating whether the matched portion of the string is highlighted.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">Whether the matched portion of the string is highlighted with the negative VT sequence.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>private readonly bool</b> <a id="14b203ac7666be09" href="../../R/14b203ac7666be09.html" target="n" data-glyph="46,1" class="i field">_emphasize</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stores the starting index of each match within the line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">IReadOnlyList</span>&lt;<b>int</b>&gt; <a id="9cf3a043f4c57890" href="../../R/9cf3a043f4c57890.html" target="n" data-glyph="46,1" class="i field">_matchIndexes</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stores the length of each match within the line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">IReadOnlyList</span>&lt;<b>int</b>&gt; <a id="fa271a6c21f26557" href="../../R/fa271a6c21f26557.html" target="n" data-glyph="46,1" class="i field">_matchLengths</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class with emphasis disabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="3f1fd1441b84994a" href="../../R/3f1fd1441b84994a.html" target="n" data-glyph="72,1" class="t constructor">MatchInfo</a>()
        {
            <a href="#ecfd8061bec2ec5a" class="k">this</a>.<a href="#14b203ac7666be09" class="i field">_emphasize</a> = <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class with emphasized matched text.</span>
        <span class="c">///</span><span class="c"> Used when virtual terminal sequences are supported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">matchIndexes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sets the matchIndexes.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">matchLengths</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Sets the matchLengths.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="0c50e525264c3102" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">MatchInfo</a>(<span class="i">IReadOnlyList</span>&lt;<b>int</b>&gt; <span id="r0 rd" class="r0 r">matchIndexes</span>, <span class="i">IReadOnlyList</span>&lt;<b>int</b>&gt; <span id="r1 rd" class="r1 r">matchLengths</span>)
        {
            <a href="#ecfd8061bec2ec5a" class="k">this</a>.<a href="#14b203ac7666be09" class="i field">_emphasize</a> = <b>true</b>;
            <a href="#ecfd8061bec2ec5a" class="k">this</a>.<a href="#9cf3a043f4c57890" class="i field">_matchIndexes</a> = <span class="r0 r">matchIndexes</span>;
            <a href="#ecfd8061bec2ec5a" class="k">this</a>.<a href="#fa271a6c21f26557" class="i field">_matchLengths</a> = <span class="r1 r">matchLengths</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the base name of the file containing the matching line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It will be the string &quot;InputStream&quot; if the object came from the input stream.</span>
        <span class="c">///</span><span class="c"> This is a readonly property calculated from the path </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#1b32ea13e3342ad9" class="i property">Path</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The file name.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public string</b> <a id="dd379556f793b723" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Filename</a>
        {
            <b>get</b>
            {
                <b>if</b> (!<a href="#e0c40fce32950c6b" class="i field">_pathSet</a>)
                {
                    <b>return</b> <a href="#669a525e4bba8399" class="i field">s_inputStream</a>;
                }
 
                <b>return</b> <a href="#9a4a974b92c3c89c" class="i field">_filename</a> ??= <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetFileName</span>(<a href="#1f5b5fc5c48a62b9" class="i field">_path</a>);
            }
        }
 
        <b>private string</b> <a id="9a4a974b92c3c89c" href="../../R/9a4a974b92c3c89c.html" target="n" data-glyph="46,1" class="i field">_filename</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the full path of the file containing the matching line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> It will be &quot;InputStream&quot; if the object came from the input stream.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The path name.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public string</b> <a id="1b32ea13e3342ad9" href="../../R/1b32ea13e3342ad9.html" target="n" data-glyph="102,1" class="i property">Path</a>
        {
            <b>get</b> =&gt; <a href="#e0c40fce32950c6b" class="i field">_pathSet</a> ? <a href="#1f5b5fc5c48a62b9" class="i field">_path</a> : <a href="#669a525e4bba8399" class="i field">s_inputStream</a>;
            <b>set</b>
            {
                <a href="#1f5b5fc5c48a62b9" class="i field">_path</a> = <b>value</b>;
                <a href="#e0c40fce32950c6b" class="i field">_pathSet</a> = <b>true</b>;
            }
        }
 
        <b>private string</b> <a id="1f5b5fc5c48a62b9" href="../../R/1f5b5fc5c48a62b9.html" target="n" data-glyph="46,1" class="i field">_path</a> = <a href="#669a525e4bba8399" class="i field">s_inputStream</a>;
 
        <b>private bool</b> <a id="e0c40fce32950c6b" href="../../R/e0c40fce32950c6b.html" target="n" data-glyph="46,1" class="i field">_pathSet</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the pattern that was used in the match.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">The pattern string.</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>public string</b> <a id="0bf851bc862e6e05" href="../../R/0bf851bc862e6e05.html" target="n" data-glyph="102,1" class="i property">Pattern</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets context for the match, or null if -context was not specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#8bc633da0745cf9a" class="t t">MatchInfoContext</a> <a id="e390961f551a3a9b" href="../../R/e390961f551a3a9b.html" target="n" data-glyph="102,1" class="i property">Context</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the path of the matching file truncated relative to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">directory</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For example, if the matching path was c:\foo\bar\baz.c and the directory argument was c:\foo</span>
        <span class="c">///</span><span class="c"> the routine would return bar\baz.c .</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">directory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The directory base the truncation on.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The relative path that was produced.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public string</b> <a id="0b21ee191a472f4f" href="../../R/0b21ee191a472f4f.html" target="n" data-glyph="72,1" class="i method">RelativePath</a>(<b>string</b> <span id="r2 rd" class="r2 r">directory</span>)
        {
            <b>if</b> (!<a href="#e0c40fce32950c6b" class="i field">_pathSet</a>)
            {
                <b>return</b> <a href="#ecfd8061bec2ec5a" class="k">this</a>.<a href="#1b32ea13e3342ad9" class="i property">Path</a>;
            }
 
            <b>string</b> <span id="r3 rd" class="r3 r">relPath</span> = <a href="#1f5b5fc5c48a62b9" class="i field">_path</a>;
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r2 r">directory</span>))
            {
                <b>if</b> (<span class="r3 r">relPath</span>.<span class="i">StartsWith</span>(<span class="r2 r">directory</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>int</b> <span id="r4 rd" class="r4 r">offset</span> = <span class="r2 r">directory</span>.<span class="i">Length</span>;
                    <b>if</b> (<span class="r4 r">offset</span> &lt; <span class="r3 r">relPath</span>.<span class="i">Length</span>)
                    {
                        <b>if</b> (<span class="r2 r">directory</span>[<span class="r4 r">offset</span> - 1] == <span class="s">&#39;\\&#39;</span> || <span class="r2 r">directory</span>[<span class="r4 r">offset</span> - 1] == <span class="s">&#39;/&#39;</span>)
                        {
                            <span class="r3 r">relPath</span> = <span class="r3 r">relPath</span>.<span class="i">Substring</span>(<span class="r4 r">offset</span>);
                        }
                        <b>else</b> <b>if</b> (<span class="r3 r">relPath</span>[<span class="r4 r">offset</span>] == <span class="s">&#39;\\&#39;</span> || <span class="r3 r">relPath</span>[<span class="r4 r">offset</span>] == <span class="s">&#39;/&#39;</span>)
                        {
                            <span class="r3 r">relPath</span> = <span class="r3 r">relPath</span>.<span class="i">Substring</span>(<span class="r4 r">offset</span> + 1);
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r3 r">relPath</span>;
        }
 
        <b>private const string</b> <a id="8fbaa7215dd7f00f" href="../../R/8fbaa7215dd7f00f.html" target="n" data-glyph="10,1" class="i field">MatchFormat</a> = <span class="s">&quot;{0}{1}:{2}:{3}&quot;</span>;
        <b>private const string</b> <a id="745b1ff303660690" href="../../R/745b1ff303660690.html" target="n" data-glyph="10,1" class="i field">SimpleFormat</a> = <span class="s">&quot;{0}{1}&quot;</span>;
 
        <span class="c">// Prefixes used by formatting: Match and Context prefixes</span>
        <span class="c">// are used when context-tracking is enabled, otherwise</span>
        <span class="c">// the empty prefix is used.</span>
        <b>private const string</b> <a id="057c64211aca5c99" href="../../R/057c64211aca5c99.html" target="n" data-glyph="10,1" class="i field">MatchPrefix</a> = <span class="s">&quot;&gt; &quot;</span>;
        <b>private const string</b> <a id="0e855eddb15c18e8" href="../../R/0e855eddb15c18e8.html" target="n" data-glyph="10,1" class="i field">ContextPrefix</a> = <span class="s">&quot;  &quot;</span>;
        <b>private const string</b> <a id="cd810793c06a25b7" href="../../R/cd810793c06a25b7.html" target="n" data-glyph="10,1" class="i field">EmptyPrefix</a> = <span class="s">&quot;&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of this object. The format</span>
        <span class="c">///</span><span class="c"> depends on whether a path has been set for this object or not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the path component is set, as would be the case when matching</span>
        <span class="c">///</span><span class="c"> in a file, ToString() would return the path, line number and line text.</span>
        <span class="c">///</span><span class="c"> If path is not set, then just the line text is presented.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation of the match object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="a49e026391cb2d78" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#c0f9b5851e2d06bb" class="i method">ToString</a>(<b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of the match object same format as ToString()</span>
        <span class="c">///</span><span class="c"> but trims the path to be relative to the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">directory</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">directory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Directory to use as the root when calculating the relative path.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation of the match object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public string</b> <a id="c0f9b5851e2d06bb" href="../../R/c0f9b5851e2d06bb.html" target="n" data-glyph="72,1" class="i method">ToString</a>(<b>string</b> <span id="r5 rd" class="r5 r">directory</span>)
        {
            <b>return</b> <a href="#51e7b56b0eb2a85e" class="i method">ToString</a>(<span class="r5 r">directory</span>, <a href="#df1b0dad44591830" class="i property">Line</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of the match object with the matched line passed</span>
        <span class="c">///</span><span class="c"> in as </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">line</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> and trims the path to be relative to</span>
        <span class="c">///</span><span class="c"> the</span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">directory</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">directory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Directory to use as the root when calculating the relative path.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Line that the match occurs in.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation of the match object.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="51e7b56b0eb2a85e" href="../../R/51e7b56b0eb2a85e.html" target="n" data-glyph="76,1" class="i method">ToString</a>(<b>string</b> <span id="r7 rd" class="r7 r">directory</span>, <b>string</b> <span id="r6 rd" class="r6 r">line</span>)
        {
            <b>string</b> <span id="r8 rd" class="r8 r">displayPath</span> = (<span class="r7 r">directory</span> != <b>null</b>) ? <a href="#0b21ee191a472f4f" class="i method">RelativePath</a>(<span class="r7 r">directory</span>) : <a href="#1f5b5fc5c48a62b9" class="i field">_path</a>;
 
            <span class="c">// Just return a single line if the user didn&#39;t</span>
            <span class="c">// enable context-tracking.</span>
            <b>if</b> (<a href="#e390961f551a3a9b" class="i property">Context</a> == <b>null</b>)
            {
                <b>return</b> <a href="#c81e7599114d945c" class="i method">FormatLine</a>(<span class="r6 r">line</span>, <a href="#ecfd8061bec2ec5a" class="k">this</a>.<a href="#d2a37f2623812bc0" class="i property">LineNumber</a>, <span class="r8 r">displayPath</span>, <a href="#cd810793c06a25b7" class="i field">EmptyPrefix</a>);
            }
 
            <span class="c">// Otherwise, render the full context.</span>
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r9 rd" class="r9 r">lines</span> = <b>new</b>(<a href="#e390961f551a3a9b" class="i property">Context</a>.<a href="#4dbca262af59f815" class="i property">DisplayPreContext</a>.<span class="i">Length</span> + <a href="#e390961f551a3a9b" class="i property">Context</a>.<a href="#9805fdc40236ed96" class="i property">DisplayPostContext</a>.<span class="i">Length</span> + 1);
 
            <b>int</b> <span id="r10 rd" class="r10 r">displayLineNumber</span> = <a href="#ecfd8061bec2ec5a" class="k">this</a>.<a href="#d2a37f2623812bc0" class="i property">LineNumber</a> - <a href="#e390961f551a3a9b" class="i property">Context</a>.<a href="#4dbca262af59f815" class="i property">DisplayPreContext</a>.<span class="i">Length</span>;
            <b>foreach</b> (<b>string</b> <span id="r11 rd" class="r11 r">contextLine</span> <b>in</b> <a href="#e390961f551a3a9b" class="i property">Context</a>.<a href="#4dbca262af59f815" class="i property">DisplayPreContext</a>)
            {
                <span class="r9 r">lines</span>.<span class="i">Add</span>(<span class="i">FormatLine</span>(<span class="r11 r">contextLine</span>, <span class="r10 r">displayLineNumber</span>++, <span class="r8 r">displayPath</span>, <a href="#0e855eddb15c18e8" class="i field">ContextPrefix</a>));
            }
 
            <span class="r9 r">lines</span>.<span class="i">Add</span>(<span class="i">FormatLine</span>(<span class="r6 r">line</span>, <span class="r10 r">displayLineNumber</span>++, <span class="r8 r">displayPath</span>, <a href="#057c64211aca5c99" class="i field">MatchPrefix</a>));
 
            <b>foreach</b> (<b>string</b> <span id="r12 rd" class="r12 r">contextLine</span> <b>in</b> <a href="#e390961f551a3a9b" class="i property">Context</a>.<a href="#9805fdc40236ed96" class="i property">DisplayPostContext</a>)
            {
                <span class="r9 r">lines</span>.<span class="i">Add</span>(<span class="i">FormatLine</span>(<span class="r12 r">contextLine</span>, <span class="r10 r">displayLineNumber</span>++, <span class="r8 r">displayPath</span>, <a href="#0e855eddb15c18e8" class="i field">ContextPrefix</a>));
            }
 
            <b>return</b> <b>string</b>.<span class="i">Join</span>(<span class="i n">System</span>.<span class="i">Environment</span>.<span class="i">NewLine</span>, <span class="r9 r">lines</span>.<span class="i">ToArray</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the string representation of the match object same format as ToString()</span>
        <span class="c">///</span><span class="c"> and inverts the color of the matched text if virtual terminal is supported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">directory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Directory to use as the root when calculating the relative path.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The string representation of the match object with matched text inverted.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public string</b> <a id="37dc34f5ba6418f6" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToEmphasizedString</a>(<b>string</b> <span id="r13 rd" class="r13 r">directory</span>)
        {
            <b>if</b> (!<a href="#14b203ac7666be09" class="i field">_emphasize</a>)
            {
                <b>return</b> <a href="#c0f9b5851e2d06bb" class="i method">ToString</a>(<span class="r13 r">directory</span>);
            }
 
            <b>return</b> <a href="#51e7b56b0eb2a85e" class="i method">ToString</a>(<span class="r13 r">directory</span>, <a href="#7ca95cb307cddc2b" class="i method">EmphasizeLine</a>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Surrounds the matched text with virtual terminal sequences to invert it&#39;s color. Used in ToEmphasizedString.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The matched line with matched text inverted.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="7ca95cb307cddc2b" href="../../R/7ca95cb307cddc2b.html" target="n" data-glyph="76,1" class="i method">EmphasizeLine</a>()
        {
            <b>string</b> <span id="r14 rd" class="r14 r">invertColorsVT100</span> = <a href="/System.Management.Automation/A.html#35c0bac9be15d2f5" class="t t">VTUtility</a>.<span class="i">GetEscapeSequence</span>(<a href="/System.Management.Automation/A.html#35c0bac9be15d2f5" class="t t">VTUtility</a>.<a href="/System.Management.Automation/A.html#35074b6bed926f9d" class="t t">VT</a>.<a href="/System.Management.Automation/A.html#bcef0b436d4539e4" class="i field">Inverse</a>);
            <b>string</b> <span id="r15 rd" class="r15 r">resetVT100</span> = <a href="/System.Management.Automation/A.html#35c0bac9be15d2f5" class="t t">VTUtility</a>.<span class="i">GetEscapeSequence</span>(<a href="/System.Management.Automation/A.html#35c0bac9be15d2f5" class="t t">VTUtility</a>.<a href="/System.Management.Automation/A.html#35074b6bed926f9d" class="t t">VT</a>.<a href="/System.Management.Automation/A.html#48009cf247d8f0a2" class="i field">Reset</a>);
 
            <b>char</b>[] <span id="r16 rd" class="r16 r">chars</span> = <b>new</b> <b>char</b>[(<a href="#9cf3a043f4c57890" class="i field">_matchIndexes</a>.<span class="i">Count</span> * (<span class="r14 r">invertColorsVT100</span>.<span class="i">Length</span> + <span class="r15 r">resetVT100</span>.<span class="i">Length</span>)) + <a href="#df1b0dad44591830" class="i property">Line</a>.<span class="i">Length</span>];
            <b>int</b> <span id="r17 rd" class="r17 r">lineIndex</span> = 0;
            <b>int</b> <span id="r18 rd" class="r18 r">charsIndex</span> = 0;
            <b>for</b> (<b>int</b> <span id="r19 rd" class="r19 r">i</span> = 0; <span class="r19 r">i</span> &lt; <a href="#9cf3a043f4c57890" class="i field">_matchIndexes</a>.<span class="i">Count</span>; <span class="r19 r">i</span>++)
            {
                <span class="c">// Adds characters before match</span>
                <a href="#df1b0dad44591830" class="i property">Line</a>.<span class="i">CopyTo</span>(<span class="r17 r">lineIndex</span>, <span class="r16 r">chars</span>, <span class="r18 r">charsIndex</span>, <a href="#9cf3a043f4c57890" class="i field">_matchIndexes</a>[<span class="r19 r">i</span>] - <span class="r17 r">lineIndex</span>);
                <span class="r18 r">charsIndex</span> += <a href="#9cf3a043f4c57890" class="i field">_matchIndexes</a>[<span class="r19 r">i</span>] - <span class="r17 r">lineIndex</span>;
                <span class="r17 r">lineIndex</span> = <a href="#9cf3a043f4c57890" class="i field">_matchIndexes</a>[<span class="r19 r">i</span>];
 
                <span class="c">// Adds opening vt sequence</span>
                <span class="r14 r">invertColorsVT100</span>.<span class="i">CopyTo</span>(0, <span class="r16 r">chars</span>, <span class="r18 r">charsIndex</span>, <span class="r14 r">invertColorsVT100</span>.<span class="i">Length</span>);
                <span class="r18 r">charsIndex</span> += <span class="r14 r">invertColorsVT100</span>.<span class="i">Length</span>;
 
                <span class="c">// Adds characters being emphasized</span>
                <a href="#df1b0dad44591830" class="i property">Line</a>.<span class="i">CopyTo</span>(<span class="r17 r">lineIndex</span>, <span class="r16 r">chars</span>, <span class="r18 r">charsIndex</span>, <a href="#fa271a6c21f26557" class="i field">_matchLengths</a>[<span class="r19 r">i</span>]);
                <span class="r17 r">lineIndex</span> += <a href="#fa271a6c21f26557" class="i field">_matchLengths</a>[<span class="r19 r">i</span>];
                <span class="r18 r">charsIndex</span> += <a href="#fa271a6c21f26557" class="i field">_matchLengths</a>[<span class="r19 r">i</span>];
 
                <span class="c">// Adds closing vt sequence</span>
                <span class="r15 r">resetVT100</span>.<span class="i">CopyTo</span>(0, <span class="r16 r">chars</span>, <span class="r18 r">charsIndex</span>, <span class="r15 r">resetVT100</span>.<span class="i">Length</span>);
                <span class="r18 r">charsIndex</span> += <span class="r15 r">resetVT100</span>.<span class="i">Length</span>;
            }
 
            <span class="c">// Adds remaining characters in line</span>
            <a href="#df1b0dad44591830" class="i property">Line</a>.<span class="i">CopyTo</span>(<span class="r17 r">lineIndex</span>, <span class="r16 r">chars</span>, <span class="r18 r">charsIndex</span>, <a href="#df1b0dad44591830" class="i property">Line</a>.<span class="i">Length</span> - <span class="r17 r">lineIndex</span>);
 
            <b>return</b> <b>new</b> <b>string</b>(<span class="r16 r">chars</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Formats a line for use in ToString.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">lineStr</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The line to format.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">displayLineNumber</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The line number to display.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">displayPath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The file path, formatted for display.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">prefix</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The match prefix.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The formatted line as a string.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="c81e7599114d945c" href="../../R/c81e7599114d945c.html" target="n" data-glyph="76,1" class="i method">FormatLine</a>(<b>string</b> <span id="r20 rd" class="r20 r">lineStr</span>, <b>int</b> <span id="r21 rd" class="r21 r">displayLineNumber</span>, <b>string</b> <span id="r22 rd" class="r22 r">displayPath</span>, <b>string</b> <span id="r23 rd" class="r23 r">prefix</span>)
        {
            <b>return</b> <a href="#e0c40fce32950c6b" class="i field">_pathSet</a>
                       ? <span class="i">StringUtil</span>.<span class="i">Format</span>(<a href="#8fbaa7215dd7f00f" class="i field">MatchFormat</a>, <span class="r23 r">prefix</span>, <span class="r22 r">displayPath</span>, <span class="r21 r">displayLineNumber</span>, <span class="r20 r">lineStr</span>)
                       : <span class="i">StringUtil</span>.<span class="i">Format</span>(<a href="#745b1ff303660690" class="i field">SimpleFormat</a>, <span class="r23 r">prefix</span>, <span class="r20 r">lineStr</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a list of all Regex matches on the matching line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Match</span>[] <a id="5784cd2209db4b55" href="../../R/5784cd2209db4b55.html" target="n" data-glyph="102,1" class="i property">Matches</a> { <b>get</b>; <b>set</b>; } = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<span class="i">Match</span>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Create a deep copy of this MatchInfo instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A new object that is a copy of this instance.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <a id="17204eae75043065" href="../../R/17204eae75043065.html" target="n" data-glyph="74,1" class="i method">Clone</a>()
        {
            <span class="c">// Just do a shallow copy and then deep-copy the</span>
            <span class="c">// fields that need it.</span>
            <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r24 rd" class="r24 r">clone</span> = (<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>)<a href="#ecfd8061bec2ec5a" class="k">this</a>.<span class="i">MemberwiseClone</span>();
 
            <b>if</b> (<span class="r24 r">clone</span>.<a href="#e390961f551a3a9b" class="i property">Context</a> != <b>null</b>)
            {
                <span class="r24 r">clone</span>.<a href="#e390961f551a3a9b" class="i property">Context</a> = (<a href="#8bc633da0745cf9a" class="t t">MatchInfoContext</a>)<span class="r24 r">clone</span>.<a href="#e390961f551a3a9b" class="i property">Context</a>.<a href="#1b79e7be9425d1ba" class="i method">Clone</a>();
            }
 
            <span class="c">// Regex match objects are immutable, so we can get away</span>
            <span class="c">// with just copying the array.</span>
            <span class="r24 r">clone</span>.<a href="#5784cd2209db4b55" class="i property">Matches</a> = (<span class="i">Match</span>[])<span class="r24 r">clone</span>.<a href="#5784cd2209db4b55" class="i property">Matches</a>.<span class="i">Clone</span>();
 
            <b>return</b> <span class="r24 r">clone</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A cmdlet to search through strings and files for particular patterns.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="/System.Management.Automation/A.html#47463da255983cfa" class="i field">Select</a>, <span class="s">&quot;String&quot;</span>, <span class="i">DefaultParameterSetName</span> = <a href="#4f089cd78f9ed8df" class="i field">ParameterSetFile</a>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2097119&quot;</span>)]
    [<span class="i">OutputType</span>(<b>typeof</b>(<b>bool</b>), <b>typeof</b>(<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>), <a href="/System.Management.Automation/A.html#0f118c29e97e12b3" class="i property">ParameterSetName</a> = <b>new</b>[] { <a href="#4f089cd78f9ed8df" class="i field">ParameterSetFile</a>, <a href="#3b8dbf1d211f8e2e" class="i field">ParameterSetObject</a>, <a href="#262ad54e1763ab13" class="i field">ParameterSetLiteralFile</a> })]
    [<span class="i">OutputType</span>(<b>typeof</b>(<b>string</b>), <a href="/System.Management.Automation/A.html#0f118c29e97e12b3" class="i property">ParameterSetName</a> = <b>new</b>[] { <a href="#4b4d4c8fb232809b" class="i field">ParameterSetFileRaw</a>, <a href="#6e50968884129e4e" class="i field">ParameterSetObjectRaw</a>, <a href="#94f8a939019b0daf" class="i field">ParameterSetLiteralFileRaw</a> })]
    <b>public sealed class</b> <a id="730ac6500e48376f" href="../../R/730ac6500e48376f.html" target="n" data-glyph="0,0" class="t t"><span id="95f71f7eefd3eca3">SelectStringCommand</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <b>private const string</b> <a id="4f089cd78f9ed8df" href="../../R/4f089cd78f9ed8df.html" target="n" data-glyph="10,1" class="i field">ParameterSetFile</a> = <span class="s">&quot;File&quot;</span>;
        <b>private const string</b> <a id="4b4d4c8fb232809b" href="../../R/4b4d4c8fb232809b.html" target="n" data-glyph="10,1" class="i field">ParameterSetFileRaw</a> = <span class="s">&quot;FileRaw&quot;</span>;
        <b>private const string</b> <a id="3b8dbf1d211f8e2e" href="../../R/3b8dbf1d211f8e2e.html" target="n" data-glyph="10,1" class="i field">ParameterSetObject</a> = <span class="s">&quot;Object&quot;</span>;
        <b>private const string</b> <a id="6e50968884129e4e" href="../../R/6e50968884129e4e.html" target="n" data-glyph="10,1" class="i field">ParameterSetObjectRaw</a> = <span class="s">&quot;ObjectRaw&quot;</span>;
        <b>private const string</b> <a id="262ad54e1763ab13" href="../../R/262ad54e1763ab13.html" target="n" data-glyph="10,1" class="i field">ParameterSetLiteralFile</a> = <span class="s">&quot;LiteralFile&quot;</span>;
        <b>private const string</b> <a id="94f8a939019b0daf" href="../../R/94f8a939019b0daf.html" target="n" data-glyph="10,1" class="i field">ParameterSetLiteralFileRaw</a> = <span class="s">&quot;LiteralFileRaw&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A generic circular buffer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">typeparam</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r t">T</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type of items that are buffered.</span><span class="c">&lt;/</span><span class="c">typeparam</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="30743d7ff594182b" href="../../R/30743d7ff594182b.html" target="n" data-glyph="4,1" class="t t">CircularBuffer</a>&lt;<span id="r25 rd t" class="r25 r t">T</span>&gt; : <span class="i">ICollection</span>&lt;<span class="r25 r t">T</span>&gt;
        {
            <span class="c">// Ring of items</span>
            <b>private readonly</b> <span class="r25 r t">T</span>[] <a id="a54632f86c45ca56" href="../../R/a54632f86c45ca56.html" target="n" data-glyph="46,2" class="i field">_items</a>;
 
            <span class="c">// Current length, as opposed to the total capacity</span>
            <span class="c">// Current start of the list. Starts at 0, but may</span>
            <span class="c">// move forwards or wrap around back to 0 due to</span>
            <span class="c">// rotation.</span>
            <b>private int</b> <a id="66e0ad845481eefa" href="../../R/66e0ad845481eefa.html" target="n" data-glyph="46,2" class="i field">_firstIndex</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#30743d7ff594182b" class="t t">CircularBuffer</a>{<span class="r26 r t">T</span>}<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">capacity</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The maximum capacity of the buffer.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">capacity</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is negative.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
            <b>public</b> <a id="4802e8d914d045a8" href="../../R/4802e8d914d045a8.html" target="n" data-glyph="72,2" class="t constructor">CircularBuffer</a>(<b>int</b> <span id="r27 rd" class="r27 r">capacity</span>)
            {
                <b>if</b> (<span class="r27 r">capacity</span> &lt; 0)
                {
                    <b>throw</b> <b>new</b> <span class="i">ArgumentOutOfRangeException</span>(<b>nameof</b>(<span class="r27 r">capacity</span>));
                }
 
                <a href="#a54632f86c45ca56" class="i field">_items</a> = <b>new</b> <span class="r25 r t">T</span>[<span class="r27 r">capacity</span>];
                <a href="#5bb7a15c34394ddc" class="i method">Clear</a>();
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Gets the maximum capacity of the buffer. If more items</span>
            <span class="c">///</span><span class="c"> are added than the buffer has capacity for, then</span>
            <span class="c">///</span><span class="c"> older items will be removed from the buffer with</span>
            <span class="c">///</span><span class="c"> a first-in, first-out policy.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public int</b> <a id="870dac744b1cda9c" href="../../R/870dac744b1cda9c.html" target="n" data-glyph="102,2" class="i property">Capacity</a> =&gt; <a href="#a54632f86c45ca56" class="i field">_items</a>.<span class="i">Length</span>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Whether or not the buffer is at capacity.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public bool</b> <a id="fbec8df91f830037" href="../../R/fbec8df91f830037.html" target="n" data-glyph="102,2" class="i property">IsFull</a> =&gt; <a href="#a7e323c2a77f8dad" class="i property">Count</a> == <a href="#870dac744b1cda9c" class="i property">Capacity</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Convert from a 0-based index to a buffer index which</span>
            <span class="c">///</span><span class="c"> has been properly offset and wrapped.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">zeroBasedIndex</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The index to wrap.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">zeroBasedIndex</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is out of range.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The actual index that </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">zeroBasedIndex</span><span class="c">&quot;</span><span class="c">/&gt;</span>
            <span class="c">///</span><span class="c"> maps to.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>private int</b> <a id="d91b975fc7768e86" href="../../R/d91b975fc7768e86.html" target="n" data-glyph="76,2" class="i method">WrapIndex</a>(<b>int</b> <span id="r28 rd" class="r28 r">zeroBasedIndex</span>)
            {
                <b>if</b> (<a href="#870dac744b1cda9c" class="i property">Capacity</a> == 0 || <span class="r28 r">zeroBasedIndex</span> &lt; 0)
                {
                    <b>throw</b> <b>new</b> <span class="i">ArgumentOutOfRangeException</span>(<b>nameof</b>(<span class="r28 r">zeroBasedIndex</span>));
                }
 
                <b>return</b> (<span class="r28 r">zeroBasedIndex</span> + <a href="#66e0ad845481eefa" class="i field">_firstIndex</a>) % <a href="#870dac744b1cda9c" class="i property">Capacity</a>;
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> IEnumerable&lt;T&gt; implementation.
            <b>public</b> <span class="i">IEnumerator</span>&lt;<span class="r25 r t">T</span>&gt; <a id="3c7c6c65e8e82922" href="../../R/3c7c6c65e8e82922.html" target="n" data-glyph="72,2" class="i method">GetEnumerator</a>()
            {
                <b>for</b> (<b>int</b> <span id="r29 rd" class="r29 r">i</span> = 0; <span class="r29 r">i</span> &lt; <a href="#a7e323c2a77f8dad" class="i property">Count</a>; <span class="r29 r">i</span>++)
                {
                    <b>yield</b> <b>return</b> <a href="#a54632f86c45ca56" class="i field">_items</a>[<a href="#d91b975fc7768e86" class="i method">WrapIndex</a>(<span class="r29 r">i</span>)];
                }
            }
 
            <span class="i">IEnumerator</span> <span class="i">IEnumerable</span>.<a id="d51b6456d8b6ce31" href="../../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">GetEnumerator</a>()
            {
                <b>return</b> (<span class="i">IEnumerator</span>)<a href="#3c7c6c65e8e82922" class="i method">GetEnumerator</a>();
            }
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> ICollection&lt;T&gt; implementation
            <b>public int</b> <a id="a7e323c2a77f8dad" href="../../R/a7e323c2a77f8dad.html" target="n" data-glyph="102,2" class="i property">Count</a> { <b>get</b>; <b>private set</b>; }
 
            <b>public bool</b> <a id="981f1778ed2882ff" href="../../R/../../0000000000.html" target="n" data-glyph="102,2" class="i property">IsReadOnly</a> =&gt; <b>false</b>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Adds an item to the buffer. If the buffer is already</span>
            <span class="c">///</span><span class="c"> full, the oldest item in the list will be removed,</span>
            <span class="c">///</span><span class="c"> and the new item added at the logical end of the list.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">item</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The item to add.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>public void</b> <a id="77727c774b65d4f3" href="../../R/77727c774b65d4f3.html" target="n" data-glyph="72,2" class="i method">Add</a>(<span class="r25 r t">T</span> <span id="r30 rd" class="r30 r">item</span>)
            {
                <b>if</b> (<a href="#870dac744b1cda9c" class="i property">Capacity</a> == 0)
                {
                    <b>return</b>;
                }
 
                <b>int</b> <span id="r31 rd" class="r31 r">itemIndex</span>;
 
                <b>if</b> (<a href="#fbec8df91f830037" class="i property">IsFull</a>)
                {
                    <span class="r31 r">itemIndex</span> = <a href="#66e0ad845481eefa" class="i field">_firstIndex</a>;
                    <a href="#66e0ad845481eefa" class="i field">_firstIndex</a> = (<a href="#66e0ad845481eefa" class="i field">_firstIndex</a> + 1) % <a href="#870dac744b1cda9c" class="i property">Capacity</a>;
                }
                <b>else</b>
                {
                    <span class="r31 r">itemIndex</span> = <a href="#66e0ad845481eefa" class="i field">_firstIndex</a> + <a href="#a7e323c2a77f8dad" class="i property">Count</a>;
                    <a href="#a7e323c2a77f8dad" class="i property">Count</a>++;
                }
 
                <a href="#a54632f86c45ca56" class="i field">_items</a>[<span class="r31 r">itemIndex</span>] = <span class="r30 r">item</span>;
            }
 
            <b>public void</b> <a id="5bb7a15c34394ddc" href="../../R/5bb7a15c34394ddc.html" target="n" data-glyph="72,2" class="i method">Clear</a>()
            {
                <a href="#66e0ad845481eefa" class="i field">_firstIndex</a> = 0;
                <a href="#a7e323c2a77f8dad" class="i property">Count</a> = 0;
            }
 
            <b>public bool</b> <a id="b572661b675cec01" href="../../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Contains</a>(<span class="r25 r t">T</span> <span id="r32 rd" class="r32 r">item</span>)
            {
                <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
            }
 
            <b>public void</b> <a id="f8cfef3a303275b0" href="../../R/f8cfef3a303275b0.html" target="n" data-glyph="72,2" class="i method">CopyTo</a>(<span class="r25 r t">T</span>[] <span id="r33 rd" class="r33 r">array</span>, <b>int</b> <span id="r34 rd" class="r34 r">arrayIndex</span>)
            {
                <b>if</b> (<span class="r33 r">array</span> == <b>null</b>)
                {
                    <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r33 r">array</span>));
                }
 
                <b>if</b> (<span class="r34 r">arrayIndex</span> &lt; 0)
                {
                    <b>throw</b> <b>new</b> <span class="i">ArgumentOutOfRangeException</span>(<b>nameof</b>(<span class="r34 r">arrayIndex</span>));
                }
 
                <b>if</b> (<a href="#a7e323c2a77f8dad" class="i property">Count</a> &gt; (<span class="r33 r">array</span>.<span class="i">Length</span> - <span class="r34 r">arrayIndex</span>))
                {
                    <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="s">&quot;arrayIndex&quot;</span>);
                }
 
                <span class="c">// Iterate through the buffer in correct order.</span>
                <b>foreach</b> (<span class="r25 r t">T</span> <span id="r35 rd" class="r35 r">item</span> <b>in</b> <a href="#30743d7ff594182b" class="k">this</a>)
                {
                    <span class="r33 r">array</span>[<span class="r34 r">arrayIndex</span>++] = <span class="r35 r">item</span>;
                }
            }
 
            <b>public bool</b> <a id="ed6c5874dcca9e7a" href="../../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Remove</a>(<span class="r25 r t">T</span> <span id="r36 rd" class="r36 r">item</span>)
            {
                <b>throw</b> <b>new</b> <span class="i">NotImplementedException</span>();
            }
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Create an array of the items in the buffer. Items</span>
            <span class="c">///</span><span class="c"> will be in the same order they were added.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The new array.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public</b> <span class="r25 r t">T</span>[] <a id="e9534115967cf1dc" href="../../R/e9534115967cf1dc.html" target="n" data-glyph="72,2" class="i method">ToArray</a>()
            {
                <span class="r25 r t">T</span>[] <span id="r37 rd" class="r37 r">result</span> = <b>new</b> <span class="r25 r t">T</span>[<a href="#a7e323c2a77f8dad" class="i property">Count</a>];
                <a href="#f8cfef3a303275b0" class="i method">CopyTo</a>(<span class="r37 r">result</span>, 0);
                <b>return</b> <span class="r37 r">result</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Access an item in the buffer. Indexing is based off</span>
            <span class="c">///</span><span class="c"> of the order items were added, rather than any</span>
            <span class="c">///</span><span class="c"> internal ordering the buffer may be maintaining.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The index of the item to access.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The buffered item at index </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">index</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>public</b> <span class="r25 r t">T</span> <a id="2c036c53446588d5" href="../../R/2c036c53446588d5.html" target="n" data-glyph="102,2" class="k">this</a>[<b>int</b> <span id="r38 rd" class="r38 r">index</span>]
            {
                <b>get</b>
                {
                    <b>if</b> (!(<span class="r38 r">index</span> &gt;= 0 &amp;&amp; <span class="r38 r">index</span> &lt; <a href="#a7e323c2a77f8dad" class="i property">Count</a>))
                    {
                        <b>throw</b> <b>new</b> <span class="i">ArgumentOutOfRangeException</span>(<b>nameof</b>(<span class="r38 r">index</span>));
                    }
 
                    <b>return</b> <a href="#a54632f86c45ca56" class="i field">_items</a>[<a href="#d91b975fc7768e86" class="i method">WrapIndex</a>(<span class="r38 r">index</span>)];
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An interface to a context tracking algorithm.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private interface</b> <a id="9915001f7a00123d" href="../../R/9915001f7a00123d.html" target="n" data-glyph="52,1" class="t t">IContextTracker</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Gets matches with completed context information</span>
            <span class="c">///</span><span class="c"> that are ready to be emitted into the pipeline.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="i">IList</span>&lt;<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>&gt; <a id="94bb214f300f57ef" href="../../R/94bb214f300f57ef.html" target="n" data-glyph="102,2" class="i property">EmitQueue</a> { <b>get</b>; }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Track a non-matching line for context.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The line to track.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>void</b> <a id="5f028f596d3d151f" href="../../R/5f028f596d3d151f.html" target="n" data-glyph="72,2" class="i method">TrackLine</a>(<b>string</b> <span id="r39 rd" class="r39 r">line</span>);
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Track a matching line.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">match</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The line to track.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>void</b> <a id="916869dc1db8021f" href="../../R/916869dc1db8021f.html" target="n" data-glyph="72,2" class="i method">TrackMatch</a>(<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r40 rd" class="r40 r">match</span>);
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Track having reached the end of the file,</span>
            <span class="c">///</span><span class="c"> giving the tracker a chance to process matches with</span>
            <span class="c">///</span><span class="c"> incomplete context information.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>void</b> <a id="3c221ca5691ce303" href="../../R/3c221ca5691ce303.html" target="n" data-glyph="72,2" class="i method">TrackEOF</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A state machine to track display context for each match.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="21d145eaacfc6ebe" href="../../R/21d145eaacfc6ebe.html" target="n" data-glyph="4,1" class="t t">DisplayContextTracker</a> : <a href="#9915001f7a00123d" class="t t">IContextTracker</a>
        {
            <b>private enum</b> <a id="10d706f64580fe10" href="../../R/10d706f64580fe10.html" target="n" data-glyph="22,2" class="t t"><span id="26c5ffbc874afb10">ContextState</span></a>
            {
                <a id="f793205d76975953" href="../../R/f793205d76975953.html" target="n" data-glyph="24,3" class="i field">InitialState</a>,
                <a id="d6ae3432a1c4afd1" href="../../R/d6ae3432a1c4afd1.html" target="n" data-glyph="24,3" class="i field">CollectPre</a>,
                <a id="e83a3dbb233c9aa4" href="../../R/e83a3dbb233c9aa4.html" target="n" data-glyph="24,3" class="i field">CollectPost</a>,
            }
 
            <b>private</b> <a href="#10d706f64580fe10" class="t t">ContextState</a> <a id="623d34f2f0bcf5b0" href="../../R/623d34f2f0bcf5b0.html" target="n" data-glyph="46,2" class="i field">_contextState</a> = <a href="#10d706f64580fe10" class="t t">ContextState</a>.<a href="#f793205d76975953" class="i field">InitialState</a>;
            <b>private readonly int</b> <a id="a471d08ff79f66d2" href="../../R/a471d08ff79f66d2.html" target="n" data-glyph="46,2" class="i field">_preContext</a>;
            <b>private readonly int</b> <a id="28604e08ef22cf31" href="../../R/28604e08ef22cf31.html" target="n" data-glyph="46,2" class="i field">_postContext</a>;
 
            <span class="c">// The context leading up to the match.</span>
            <b>private readonly</b> <a href="#30743d7ff594182b" class="t t">CircularBuffer</a>&lt;<b>string</b>&gt; <a id="1e131b69b8a01443" href="../../R/1e131b69b8a01443.html" target="n" data-glyph="46,2" class="i field">_collectedPreContext</a>;
 
            <span class="c">// The context after the match.</span>
            <b>private readonly</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="058410176968b7fe" href="../../R/058410176968b7fe.html" target="n" data-glyph="46,2" class="i field">_collectedPostContext</a>;
 
            <span class="c">// Current match info we are tracking postcontext for.</span>
            <span class="c">// At any given time, if set, this value will not be</span>
            <span class="c">// in the emitQueue but will be the next to be added.</span>
            <b>private</b> <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <a id="6fe46cdaee128454" href="../../R/6fe46cdaee128454.html" target="n" data-glyph="46,2" class="i field">_matchInfo</a> = <b>null</b>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#21d145eaacfc6ebe" class="t t">DisplayContextTracker</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">preContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">How much preContext to collect at most.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">postContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">How much postContext to collect at most.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>public</b> <a id="d79ee03d04586409" href="../../R/d79ee03d04586409.html" target="n" data-glyph="72,2" class="t constructor">DisplayContextTracker</a>(<b>int</b> <span id="r41 rd" class="r41 r">preContext</span>, <b>int</b> <span id="r42 rd" class="r42 r">postContext</span>)
            {
                <a href="#a471d08ff79f66d2" class="i field">_preContext</a> = <span class="r41 r">preContext</span>;
                <a href="#28604e08ef22cf31" class="i field">_postContext</a> = <span class="r42 r">postContext</span>;
 
                <a href="#1e131b69b8a01443" class="i field">_collectedPreContext</a> = <b>new</b> <a href="#4802e8d914d045a8" class="t constructor">CircularBuffer</a>&lt;<b>string</b>&gt;(<span class="r41 r">preContext</span>);
                <a href="#058410176968b7fe" class="i field">_collectedPostContext</a> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(<span class="r42 r">postContext</span>);
                <a href="#635ceb872a4214ed" class="i field">_emitQueue</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>&gt;();
                <a href="#efedfc3743d0ac74" class="i method">Reset</a>();
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> IContextTracker implementation
            <b>public</b> <span class="i">IList</span>&lt;<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>&gt; <a id="858379f534574a4b" href="../../R/858379f534574a4b.html" target="n" data-glyph="102,2" class="i property">EmitQueue</a> =&gt; <a href="#635ceb872a4214ed" class="i field">_emitQueue</a>;
 
            <b>private readonly</b> <span class="i">List</span>&lt;<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>&gt; <a id="635ceb872a4214ed" href="../../R/635ceb872a4214ed.html" target="n" data-glyph="46,2" class="i field">_emitQueue</a>;
 
            <span class="c">// Track non-matching line</span>
            <b>public void</b> <a id="77f035d503883fbf" href="../../R/77f035d503883fbf.html" target="n" data-glyph="72,2" class="i method">TrackLine</a>(<b>string</b> <span id="r43 rd" class="r43 r">line</span>)
            {
                <b>switch</b> (<a href="#623d34f2f0bcf5b0" class="i field">_contextState</a>)
                {
                    <b>case</b> <a href="#10d706f64580fe10" class="t t">ContextState</a>.<a href="#f793205d76975953" class="i field">InitialState</a>:
                        <b>break</b>;
                    <b>case</b> <a href="#10d706f64580fe10" class="t t">ContextState</a>.<a href="#d6ae3432a1c4afd1" class="i field">CollectPre</a>:
                        <a href="#1e131b69b8a01443" class="i field">_collectedPreContext</a>.<a href="#77727c774b65d4f3" class="i method">Add</a>(<span class="r43 r">line</span>);
                        <b>break</b>;
                    <b>case</b> <a href="#10d706f64580fe10" class="t t">ContextState</a>.<a href="#e83a3dbb233c9aa4" class="i field">CollectPost</a>:
                        <span class="c">// We&#39;re not done collecting post-context.</span>
                        <a href="#058410176968b7fe" class="i field">_collectedPostContext</a>.<span class="i">Add</span>(<span class="r43 r">line</span>);
 
                        <b>if</b> (<a href="#058410176968b7fe" class="i field">_collectedPostContext</a>.<span class="i">Count</span> &gt;= <a href="#28604e08ef22cf31" class="i field">_postContext</a>)
                        {
                            <span class="c">// Now we&#39;re done.</span>
                            <a href="#7c1e4e606a5d0638" class="i method">UpdateQueue</a>();
                        }
 
                        <b>break</b>;
                }
            }
 
            <span class="c">// Track matching line</span>
            <b>public void</b> <a id="1caaecedd62e5c6f" href="../../R/1caaecedd62e5c6f.html" target="n" data-glyph="72,2" class="i method">TrackMatch</a>(<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r44 rd" class="r44 r">match</span>)
            {
                <span class="c">// Update the queue in case we were in the middle</span>
                <span class="c">// of collecting postcontext for an older match...</span>
                <b>if</b> (<a href="#623d34f2f0bcf5b0" class="i field">_contextState</a> == <a href="#10d706f64580fe10" class="t t">ContextState</a>.<a href="#e83a3dbb233c9aa4" class="i field">CollectPost</a>)
                {
                    <a href="#7c1e4e606a5d0638" class="i method">UpdateQueue</a>();
                }
 
                <span class="c">// Update the current matchInfo.</span>
                <a href="#6fe46cdaee128454" class="i field">_matchInfo</a> = <span class="r44 r">match</span>;
 
                <span class="c">// If postContext is set, then we need to hold</span>
                <span class="c">// onto the match for a while and gather context.</span>
                <span class="c">// Otherwise, immediately move the match onto the queue</span>
                <span class="c">// and let UpdateQueue update our state instead.</span>
                <b>if</b> (<a href="#28604e08ef22cf31" class="i field">_postContext</a> &gt; 0)
                {
                    <a href="#623d34f2f0bcf5b0" class="i field">_contextState</a> = <a href="#10d706f64580fe10" class="t t">ContextState</a>.<a href="#e83a3dbb233c9aa4" class="i field">CollectPost</a>;
                }
                <b>else</b>
                {
                    <a href="#7c1e4e606a5d0638" class="i method">UpdateQueue</a>();
                }
            }
 
            <span class="c">// Track having reached the end of the file.</span>
            <b>public void</b> <a id="d230aef69d567982" href="../../R/d230aef69d567982.html" target="n" data-glyph="72,2" class="i method">TrackEOF</a>()
            {
                <span class="c">// If we&#39;re in the middle of collecting postcontext, we</span>
                <span class="c">// already have a match and it&#39;s okay to queue it up</span>
                <span class="c">// early since there are no more lines to track context</span>
                <span class="c">// for.</span>
                <b>if</b> (<a href="#623d34f2f0bcf5b0" class="i field">_contextState</a> == <a href="#10d706f64580fe10" class="t t">ContextState</a>.<a href="#e83a3dbb233c9aa4" class="i field">CollectPost</a>)
                {
                    <a href="#7c1e4e606a5d0638" class="i method">UpdateQueue</a>();
                }
            }
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Moves matchInfo, if set, to the emitQueue and</span>
            <span class="c">///</span><span class="c"> resets the tracking state.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>private void</b> <a id="7c1e4e606a5d0638" href="../../R/7c1e4e606a5d0638.html" target="n" data-glyph="76,2" class="i method">UpdateQueue</a>()
            {
                <b>if</b> (<a href="#6fe46cdaee128454" class="i field">_matchInfo</a> != <b>null</b>)
                {
                    <a href="#635ceb872a4214ed" class="i field">_emitQueue</a>.<span class="i">Add</span>(<a href="#6fe46cdaee128454" class="i field">_matchInfo</a>);
 
                    <b>if</b> (<a href="#6fe46cdaee128454" class="i field">_matchInfo</a>.<a href="#e390961f551a3a9b" class="i property">Context</a> != <b>null</b>)
                    {
                        <a href="#6fe46cdaee128454" class="i field">_matchInfo</a>.<a href="#e390961f551a3a9b" class="i property">Context</a>.<a href="#4dbca262af59f815" class="i property">DisplayPreContext</a> = <a href="#1e131b69b8a01443" class="i field">_collectedPreContext</a>.<a href="#e9534115967cf1dc" class="i method">ToArray</a>();
                        <a href="#6fe46cdaee128454" class="i field">_matchInfo</a>.<a href="#e390961f551a3a9b" class="i property">Context</a>.<a href="#9805fdc40236ed96" class="i property">DisplayPostContext</a> = <a href="#058410176968b7fe" class="i field">_collectedPostContext</a>.<span class="i">ToArray</span>();
                    }
 
                    <a href="#efedfc3743d0ac74" class="i method">Reset</a>();
                }
            }
 
            <span class="c">// Reset tracking state. Does not reset the emit queue.</span>
            <b>private void</b> <a id="efedfc3743d0ac74" href="../../R/efedfc3743d0ac74.html" target="n" data-glyph="76,2" class="i method">Reset</a>()
            {
                <a href="#623d34f2f0bcf5b0" class="i field">_contextState</a> = (<a href="#a471d08ff79f66d2" class="i field">_preContext</a> &gt; 0)
                               ? <a href="#10d706f64580fe10" class="t t">ContextState</a>.<a href="#d6ae3432a1c4afd1" class="i field">CollectPre</a>
                               : <a href="#10d706f64580fe10" class="t t">ContextState</a>.<a href="#f793205d76975953" class="i field">InitialState</a>;
                <a href="#1e131b69b8a01443" class="i field">_collectedPreContext</a>.<a href="#5bb7a15c34394ddc" class="i method">Clear</a>();
                <a href="#058410176968b7fe" class="i field">_collectedPostContext</a>.<span class="i">Clear</span>();
                <a href="#6fe46cdaee128454" class="i field">_matchInfo</a> = <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A class to track logical context for each match.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The difference between logical and display context is</span>
        <span class="c">///</span><span class="c"> that logical context includes as many context lines</span>
        <span class="c">///</span><span class="c"> as possible for a given match, up to the specified</span>
        <span class="c">///</span><span class="c"> limit, including context lines which overlap between</span>
        <span class="c">///</span><span class="c"> matches and other matching lines themselves. Display</span>
        <span class="c">///</span><span class="c"> context, on the other hand, is designed to display</span>
        <span class="c">///</span><span class="c"> a possibly-continuous set of matches by excluding</span>
        <span class="c">///</span><span class="c"> overlapping context (lines will only appear once)</span>
        <span class="c">///</span><span class="c"> and other matching lines (since they will appear</span>
        <span class="c">///</span><span class="c"> as their own match entries.).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="662dfe6c38e8fc76" href="../../R/662dfe6c38e8fc76.html" target="n" data-glyph="4,1" class="t t">LogicalContextTracker</a> : <a href="#9915001f7a00123d" class="t t">IContextTracker</a>
        {
            <span class="c">// A union: string | MatchInfo. Needed since</span>
            <span class="c">// context lines could be either proper matches</span>
            <span class="c">// or non-matching lines.</span>
            <b>private sealed class</b> <a id="9aeed0fc94806ef8" href="../../R/9aeed0fc94806ef8.html" target="n" data-glyph="4,2" class="t t">ContextEntry</a>
            {
                <b>public readonly string</b> <a id="4e40547ab93f7468" href="../../R/4e40547ab93f7468.html" target="n" data-glyph="42,3" class="i field">Line</a>;
                <b>public readonly</b> <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <a id="751cd6c7740ac2c9" href="../../R/751cd6c7740ac2c9.html" target="n" data-glyph="42,3" class="i field">Match</a>;
 
                <b>public</b> <a id="d3e799b806d441fb" href="../../R/../../0000000000.html" target="n" data-glyph="72,3" class="t constructor">ContextEntry</a>(<b>string</b> <span id="r45 rd" class="r45 r">line</span>)
                {
                    <a href="#4e40547ab93f7468" class="i field">Line</a> = <span class="r45 r">line</span>;
                }
 
                <b>public</b> <a id="da2a76079b5320f0" href="../../R/../../0000000000.html" target="n" data-glyph="72,3" class="t constructor">ContextEntry</a>(<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r46 rd" class="r46 r">match</span>)
                {
                    <a href="#751cd6c7740ac2c9" class="i field">Match</a> = <span class="r46 r">match</span>;
                }
 
                <b>public override string</b> <a id="a9eccdde151b1553" href="../../R/a9eccdde151b1553.html" target="n" data-glyph="72,3" class="i method">ToString</a>() =&gt; <a href="#751cd6c7740ac2c9" class="i field">Match</a>?.<a href="#df1b0dad44591830" class="i property">Line</a> ?? <a href="#4e40547ab93f7468" class="i field">Line</a>;
            }
 
            <span class="c">// Whether or not early entries found</span>
            <span class="c">// while still filling up the context buffer</span>
            <span class="c">// have been added to the emit queue.</span>
            <span class="c">// Used by UpdateQueue.</span>
            <b>private bool</b> <a id="1b5784ca2b073673" href="../../R/1b5784ca2b073673.html" target="n" data-glyph="46,2" class="i field">_hasProcessedPreEntries</a>;
 
            <b>private readonly int</b> <a id="a831b3479058286e" href="../../R/a831b3479058286e.html" target="n" data-glyph="46,2" class="i field">_preContext</a>;
            <b>private readonly int</b> <a id="eb6e78f0b3bf8f7e" href="../../R/eb6e78f0b3bf8f7e.html" target="n" data-glyph="46,2" class="i field">_postContext</a>;
 
            <span class="c">// A circular buffer tracking both precontext and postcontext.</span>
            <span class="c">//</span>
            <span class="c">// Essentially, the buffer is separated into regions:</span>
            <span class="c">// | prectxt region  (older entries, length = precontext)  |</span>
            <span class="c">// | match region    (length = 1)                          |</span>
            <span class="c">// | postctxt region (newer entries, length = postcontext) |</span>
            <span class="c">//</span>
            <span class="c">// When context entries containing a match reach the &quot;middle&quot;</span>
            <span class="c">// (the position between the pre/post context regions)</span>
            <span class="c">// of this buffer, and the buffer is full, we will know</span>
            <span class="c">// enough context to populate the Context properties of the</span>
            <span class="c">// match. At that point, we will add the match object</span>
            <span class="c">// to the emit queue.</span>
            <b>private readonly</b> <a href="#30743d7ff594182b" class="t t">CircularBuffer</a>&lt;<a href="#9aeed0fc94806ef8" class="t t">ContextEntry</a>&gt; <a id="9f22becce19c79b2" href="../../R/9f22becce19c79b2.html" target="n" data-glyph="46,2" class="i field">_collectedContext</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#662dfe6c38e8fc76" class="t t">LogicalContextTracker</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">preContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">How much preContext to collect at most.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">postContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">How much postContext to collect at most.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>public</b> <a id="b8f74a8781740f9d" href="../../R/b8f74a8781740f9d.html" target="n" data-glyph="72,2" class="t constructor">LogicalContextTracker</a>(<b>int</b> <span id="r47 rd" class="r47 r">preContext</span>, <b>int</b> <span id="r48 rd" class="r48 r">postContext</span>)
            {
                <a href="#a831b3479058286e" class="i field">_preContext</a> = <span class="r47 r">preContext</span>;
                <a href="#eb6e78f0b3bf8f7e" class="i field">_postContext</a> = <span class="r48 r">postContext</span>;
                <a href="#9f22becce19c79b2" class="i field">_collectedContext</a> = <b>new</b> <span class="t">CircularBuffer</span>&lt;<a href="#9aeed0fc94806ef8" class="t t">ContextEntry</a>&gt;(<span class="r47 r">preContext</span> + <span class="r48 r">postContext</span> + 1);
                <a href="#636879406611ffe0" class="i field">_emitQueue</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>&gt;();
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> IContextTracker implementation
            <b>public</b> <span class="i">IList</span>&lt;<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>&gt; <a id="ff3a0a57d4a713dc" href="../../R/ff3a0a57d4a713dc.html" target="n" data-glyph="102,2" class="i property">EmitQueue</a> =&gt; <a href="#636879406611ffe0" class="i field">_emitQueue</a>;
 
            <b>private readonly</b> <span class="i">List</span>&lt;<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>&gt; <a id="636879406611ffe0" href="../../R/636879406611ffe0.html" target="n" data-glyph="46,2" class="i field">_emitQueue</a>;
 
            <b>public void</b> <a id="77728e6d058f147f" href="../../R/77728e6d058f147f.html" target="n" data-glyph="72,2" class="i method">TrackLine</a>(<b>string</b> <span id="r49 rd" class="r49 r">line</span>)
            {
                <a href="#9aeed0fc94806ef8" class="t t">ContextEntry</a> <span id="r50 rd" class="r50 r">entry</span> = <b>new</b>(<span class="r49 r">line</span>);
                <a href="#9f22becce19c79b2" class="i field">_collectedContext</a>.<a href="#77727c774b65d4f3" class="i method">Add</a>(<span class="r50 r">entry</span>);
                <a href="#e46de5685858fa5f" class="i method">UpdateQueue</a>();
            }
 
            <b>public void</b> <a id="dc97d7c913341aae" href="../../R/dc97d7c913341aae.html" target="n" data-glyph="72,2" class="i method">TrackMatch</a>(<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r51 rd" class="r51 r">match</span>)
            {
                <a href="#9aeed0fc94806ef8" class="t t">ContextEntry</a> <span id="r52 rd" class="r52 r">entry</span> = <b>new</b>(<span class="r51 r">match</span>);
                <a href="#9f22becce19c79b2" class="i field">_collectedContext</a>.<a href="#77727c774b65d4f3" class="i method">Add</a>(<span class="r52 r">entry</span>);
                <a href="#e46de5685858fa5f" class="i method">UpdateQueue</a>();
            }
 
            <b>public void</b> <a id="10dacc16358bc6bb" href="../../R/10dacc16358bc6bb.html" target="n" data-glyph="72,2" class="i method">TrackEOF</a>()
            {
                <span class="c">// If the buffer is already full,</span>
                <span class="c">// check for any matches with incomplete</span>
                <span class="c">// postcontext and add them to the emit queue.</span>
                <span class="c">// These matches can be identified by being past</span>
                <span class="c">// the &quot;middle&quot; of the context buffer (still in</span>
                <span class="c">// the postcontext region.</span>
                <span class="c">//</span>
                <span class="c">// If the buffer isn&#39;t full, then nothing will have</span>
                <span class="c">// ever been emitted and everything is still waiting</span>
                <span class="c">// on postcontext. So process the whole buffer.</span>
                <b>int</b> <span id="r53 rd" class="r53 r">startIndex</span> = <a href="#9f22becce19c79b2" class="i field">_collectedContext</a>.<a href="#fbec8df91f830037" class="i property">IsFull</a> ? <a href="#a831b3479058286e" class="i field">_preContext</a> + 1 : 0;
                <span class="i">EmitAllInRange</span>(<span class="r53 r">startIndex</span>, <a href="#9f22becce19c79b2" class="i field">_collectedContext</a>.<a href="#a7e323c2a77f8dad" class="i property">Count</a> - 1);
            }
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Add all matches found in the specified range</span>
            <span class="c">///</span><span class="c"> to the emit queue, collecting as much context</span>
            <span class="c">///</span><span class="c"> as possible up to the limits specified in the constructor.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The range is inclusive; the entries at</span>
            <span class="c">///</span><span class="c"> startIndex and endIndex will both be checked.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">startIndex</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The beginning of the match range.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">endIndex</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The ending of the match range.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>private void</b> <a id="5222541a8d4c131a" href="../../R/5222541a8d4c131a.html" target="n" data-glyph="76,2" class="i method">EmitAllInRange</a>(<b>int</b> <span id="r54 rd" class="r54 r">startIndex</span>, <b>int</b> <span id="r55 rd" class="r55 r">endIndex</span>)
            {
                <b>for</b> (<b>int</b> <span id="r56 rd" class="r56 r">i</span> = <span class="r54 r">startIndex</span>; <span class="r56 r">i</span> &lt;= <span class="r55 r">endIndex</span>; <span class="r56 r">i</span>++)
                {
                    <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r57 rd" class="r57 r">match</span> = <a href="#9f22becce19c79b2" class="i field">_collectedContext</a><a href="#2c036c53446588d5">[</a><span class="r56 r">i</span>].<a href="#751cd6c7740ac2c9" class="i field">Match</a>;
                    <b>if</b> (<span class="r57 r">match</span> != <b>null</b>)
                    {
                        <b>int</b> <span id="r58 rd" class="r58 r">preStart</span> = <span class="i">Math</span>.<span class="i">Max</span>(<span class="r56 r">i</span> - <a href="#a831b3479058286e" class="i field">_preContext</a>, 0);
                        <b>int</b> <span id="r59 rd" class="r59 r">postLength</span> = <span class="i">Math</span>.<span class="i">Min</span>(<a href="#eb6e78f0b3bf8f7e" class="i field">_postContext</a>, <a href="#9f22becce19c79b2" class="i field">_collectedContext</a>.<a href="#a7e323c2a77f8dad" class="i property">Count</a> - <span class="r56 r">i</span> - 1);
                        <span class="i">Emit</span>(<span class="r57 r">match</span>, <span class="r58 r">preStart</span>, <span class="r56 r">i</span> - <span class="r58 r">preStart</span>, <span class="r56 r">i</span> + 1, <span class="r59 r">postLength</span>);
                    }
                }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Add match(es) found in the match region to the</span>
            <span class="c">///</span><span class="c"> emit queue. Should be called every time an entry</span>
            <span class="c">///</span><span class="c"> is added to the context buffer.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>private void</b> <a id="e46de5685858fa5f" href="../../R/e46de5685858fa5f.html" target="n" data-glyph="76,2" class="i method">UpdateQueue</a>()
            {
                <span class="c">// Are we at capacity and thus have enough postcontext?</span>
                <span class="c">// Is there a match in the &quot;middle&quot; of the buffer</span>
                <span class="c">// that we know the pre/post context for?</span>
                <span class="c">//</span>
                <span class="c">// If this is the first time we&#39;ve reached full capacity,</span>
                <span class="c">// hasProcessedPreEntries will not be set, and we</span>
                <span class="c">// should go through the entire context, because it might</span>
                <span class="c">// have entries that never collected enough</span>
                <span class="c">// precontext. Otherwise, we should just look at the</span>
                <span class="c">// middle region.</span>
                <b>if</b> (<a href="#9f22becce19c79b2" class="i field">_collectedContext</a>.<a href="#fbec8df91f830037" class="i property">IsFull</a>)
                {
                    <b>if</b> (<a href="#1b5784ca2b073673" class="i field">_hasProcessedPreEntries</a>)
                    {
                        <span class="c">// Only process a potential match with exactly</span>
                        <span class="c">// enough pre and post-context.</span>
                        <a href="#5222541a8d4c131a" class="i method">EmitAllInRange</a>(<a href="#a831b3479058286e" class="i field">_preContext</a>, <a href="#a831b3479058286e" class="i field">_preContext</a>);
                    }
                    <b>else</b>
                    {
                        <span class="c">// Some of our early entries may not</span>
                        <span class="c">// have enough precontext. Process them too.</span>
                        <a href="#5222541a8d4c131a" class="i method">EmitAllInRange</a>(0, <a href="#a831b3479058286e" class="i field">_preContext</a>);
                        <a href="#1b5784ca2b073673" class="i field">_hasProcessedPreEntries</a> = <b>true</b>;
                    }
                }
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Collects context from the specified ranges. Populates</span>
            <span class="c">///</span><span class="c"> the specified match with the collected context</span>
            <span class="c">///</span><span class="c"> and adds it to the emit queue.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Context ranges must be within the bounds of the context buffer.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">match</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The match to operate on.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">preStartIndex</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The start index of the preContext range.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">preLength</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The length of the preContext range.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">postStartIndex</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The start index of the postContext range.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r64 r">postLength</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The length of the postContext range.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>private void</b> <a id="9c29346fb1acd410" href="../../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">Emit</a>(<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r60 rd" class="r60 r">match</span>, <b>int</b> <span id="r61 rd" class="r61 r">preStartIndex</span>, <b>int</b> <span id="r62 rd" class="r62 r">preLength</span>, <b>int</b> <span id="r63 rd" class="r63 r">postStartIndex</span>, <b>int</b> <span id="r64 rd" class="r64 r">postLength</span>)
            {
                <b>if</b> (<span class="r60 r">match</span>.<a href="#e390961f551a3a9b" class="i property">Context</a> != <b>null</b>)
                {
                    <span class="r60 r">match</span>.<a href="#e390961f551a3a9b" class="i property">Context</a>.<a href="#9ffef6afab5e8998" class="i property">PreContext</a> = <a href="#d9dbe520c4664121" class="i method">CopyContext</a>(<span class="r61 r">preStartIndex</span>, <span class="r62 r">preLength</span>);
                    <span class="r60 r">match</span>.<a href="#e390961f551a3a9b" class="i property">Context</a>.<a href="#40a9f668be7538fe" class="i property">PostContext</a> = <a href="#d9dbe520c4664121" class="i method">CopyContext</a>(<span class="r63 r">postStartIndex</span>, <span class="r64 r">postLength</span>);
                }
 
                <a href="#636879406611ffe0" class="i field">_emitQueue</a>.<span class="i">Add</span>(<span class="r60 r">match</span>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Collects context from the specified ranges.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The range must be within the bounds of the context buffer.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">startIndex</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The index to start at.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">length</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The length of the range.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">String representation of the collected context at the specified range.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
            <b>private string</b>[] <a id="d9dbe520c4664121" href="../../R/d9dbe520c4664121.html" target="n" data-glyph="76,2" class="i method">CopyContext</a>(<b>int</b> <span id="r65 rd" class="r65 r">startIndex</span>, <b>int</b> <span id="r66 rd" class="r66 r">length</span>)
            {
                <b>string</b>[] <span id="r67 rd" class="r67 r">result</span> = <b>new</b> <b>string</b>[<span class="r66 r">length</span>];
 
                <b>for</b> (<b>int</b> <span id="r68 rd" class="r68 r">i</span> = 0; <span class="r68 r">i</span> &lt; <span class="r66 r">length</span>; <span class="r68 r">i</span>++)
                {
                    <span class="r67 r">result</span>[<span class="r68 r">i</span>] = <a href="#9f22becce19c79b2" class="i field">_collectedContext</a>[<span class="r65 r">startIndex</span> + <span class="r68 r">i</span>].<a href="#a9eccdde151b1553" class="i method">ToString</a>();
                }
 
                <b>return</b> <span class="r67 r">result</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A class to track both logical and display contexts.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="e55350feb124f396" href="../../R/e55350feb124f396.html" target="n" data-glyph="4,1" class="t t">ContextTracker</a> : <a href="#9915001f7a00123d" class="t t">IContextTracker</a>
        {
            <b>private readonly</b> <a href="#9915001f7a00123d" class="t t">IContextTracker</a> <a id="12ad86de560c95f3" href="../../R/12ad86de560c95f3.html" target="n" data-glyph="46,2" class="i field">_displayTracker</a>;
            <b>private readonly</b> <a href="#9915001f7a00123d" class="t t">IContextTracker</a> <a id="d7b42a92963c4a2c" href="../../R/d7b42a92963c4a2c.html" target="n" data-glyph="46,2" class="i field">_logicalTracker</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e55350feb124f396" class="t t">ContextTracker</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">preContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">How much preContext to collect at most.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">postContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">How much postContext to collect at most.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>public</b> <a id="71843497cb0c1172" href="../../R/71843497cb0c1172.html" target="n" data-glyph="72,2" class="t constructor">ContextTracker</a>(<b>int</b> <span id="r69 rd" class="r69 r">preContext</span>, <b>int</b> <span id="r70 rd" class="r70 r">postContext</span>)
            {
                <a href="#12ad86de560c95f3" class="i field">_displayTracker</a> = <b>new</b> <a href="#d79ee03d04586409" class="t constructor">DisplayContextTracker</a>(<span class="r69 r">preContext</span>, <span class="r70 r">postContext</span>);
                <a href="#d7b42a92963c4a2c" class="i field">_logicalTracker</a> = <b>new</b> <a href="#b8f74a8781740f9d" class="t constructor">LogicalContextTracker</a>(<span class="r69 r">preContext</span>, <span class="r70 r">postContext</span>);
                <a href="#8ccad651952fccb4" class="i property">EmitQueue</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>&gt;();
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> IContextTracker implementation
            <b>public</b> <span class="i">IList</span>&lt;<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>&gt; <a id="8ccad651952fccb4" href="../../R/8ccad651952fccb4.html" target="n" data-glyph="102,2" class="i property">EmitQueue</a> { <b>get</b>; }
 
            <b>public void</b> <a id="117f4dbc1d332342" href="../../R/117f4dbc1d332342.html" target="n" data-glyph="72,2" class="i method">TrackLine</a>(<b>string</b> <span id="r71 rd" class="r71 r">line</span>)
            {
                <a href="#12ad86de560c95f3" class="i field">_displayTracker</a>.<a href="#5f028f596d3d151f" class="i method">TrackLine</a>(<span class="r71 r">line</span>);
                <a href="#d7b42a92963c4a2c" class="i field">_logicalTracker</a>.<a href="#5f028f596d3d151f" class="i method">TrackLine</a>(<span class="r71 r">line</span>);
                <a href="#1bf6f741c7adeedd" class="i method">UpdateQueue</a>();
            }
 
            <b>public void</b> <a id="0d7d661105113b63" href="../../R/0d7d661105113b63.html" target="n" data-glyph="72,2" class="i method">TrackMatch</a>(<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r72 rd" class="r72 r">match</span>)
            {
                <a href="#12ad86de560c95f3" class="i field">_displayTracker</a>.<a href="#916869dc1db8021f" class="i method">TrackMatch</a>(<span class="r72 r">match</span>);
                <a href="#d7b42a92963c4a2c" class="i field">_logicalTracker</a>.<a href="#916869dc1db8021f" class="i method">TrackMatch</a>(<span class="r72 r">match</span>);
                <a href="#1bf6f741c7adeedd" class="i method">UpdateQueue</a>();
            }
 
            <b>public void</b> <a id="c2d99550137ab8a6" href="../../R/c2d99550137ab8a6.html" target="n" data-glyph="72,2" class="i method">TrackEOF</a>()
            {
                <a href="#12ad86de560c95f3" class="i field">_displayTracker</a>.<a href="#3c221ca5691ce303" class="i method">TrackEOF</a>();
                <a href="#d7b42a92963c4a2c" class="i field">_logicalTracker</a>.<a href="#3c221ca5691ce303" class="i method">TrackEOF</a>();
                <a href="#1bf6f741c7adeedd" class="i method">UpdateQueue</a>();
            }
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Update the emit queue based on the wrapped trackers.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>private void</b> <a id="1bf6f741c7adeedd" href="../../R/1bf6f741c7adeedd.html" target="n" data-glyph="76,2" class="i method">UpdateQueue</a>()
            {
                <span class="c">// Look for completed matches in the logical</span>
                <span class="c">// tracker&#39;s queue. Since the logical tracker</span>
                <span class="c">// will try to collect as much context as</span>
                <span class="c">// possible, the display tracker will have either</span>
                <span class="c">// already finished collecting its context for the</span>
                <span class="c">// match or will have completed it at the same</span>
                <span class="c">// time as the logical tracker, so we can</span>
                <span class="c">// be sure the matches will have both logical</span>
                <span class="c">// and display context already populated.</span>
                <b>foreach</b> (<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r73 rd" class="r73 r">match</span> <b>in</b> <a href="#d7b42a92963c4a2c" class="i field">_logicalTracker</a>.<a href="#94bb214f300f57ef" class="i property">EmitQueue</a>)
                {
                    <a href="#8ccad651952fccb4" class="i property">EmitQueue</a>.<span class="i">Add</span>(<span class="r73 r">match</span>);
                }
 
                <a href="#d7b42a92963c4a2c" class="i field">_logicalTracker</a>.<a href="#94bb214f300f57ef" class="i property">EmitQueue</a>.<span class="i">Clear</span>();
                <a href="#12ad86de560c95f3" class="i field">_displayTracker</a>.<a href="#94bb214f300f57ef" class="i property">EmitQueue</a>.<span class="i">Clear</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ContextTracker that does not work for the case when pre- and post context is 0.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="b45584263c35d7db" href="../../R/../../0000000000.html" target="n" data-glyph="4,1" class="t t"><span id="653abec8f846f277">NoContextTracker</span></a> : <a href="#9915001f7a00123d" class="t t">IContextTracker</a>
        {
            <b>private readonly</b> <span class="i">IList</span>&lt;<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>&gt; <a id="1a3f1abd75cc5aef" href="../../R/1a3f1abd75cc5aef.html" target="n" data-glyph="46,2" class="i field">_matches</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>&gt;(1);
 
            <span class="i">IList</span>&lt;<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>&gt; <a href="#9915001f7a00123d" class="t t">IContextTracker</a>.<a href="#94bb214f300f57ef" class="i property">EmitQueue</a> =&gt; <a href="#1a3f1abd75cc5aef" class="i field">_matches</a>;
 
            <b>void</b> <a href="#9915001f7a00123d" class="t t">IContextTracker</a>.<a href="#5f028f596d3d151f" class="i method">TrackLine</a>(<b>string</b> <span id="r74 rd" class="r74 r">line</span>)
            {
            }
 
            <b>void</b> <a href="#9915001f7a00123d" class="t t">IContextTracker</a>.<a href="#916869dc1db8021f" class="i method">TrackMatch</a>(<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r75 rd" class="r75 r">match</span>) =&gt; <a href="#1a3f1abd75cc5aef" class="i field">_matches</a>.<span class="i">Add</span>(<span class="r75 r">match</span>);
 
            <b>void</b> <a href="#9915001f7a00123d" class="t t">IContextTracker</a>.<a href="#3c221ca5691ce303" class="i method">TrackEOF</a>()
            {
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a culture name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateSet</span>(<b>typeof</b>(<a href="#4081ae4947e86c05" class="t t">ValidateMatchStringCultureNamesGenerator</a>))]
        [<span class="i">ValidateNotNull</span>]
        <b>public string</b> <a id="8cf08e59fe194948" href="../../R/8cf08e59fe194948.html" target="n" data-glyph="102,1" class="i property">Culture</a>
        {
            <b>get</b>
            {
                <b>switch</b> (<a href="#53d3c400c8e30b3a" class="i field">_stringComparison</a>)
                {
                    <b>case</b> <span class="i">StringComparison</span>.<span class="i">Ordinal</span>:
                    <b>case</b> <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>:
                        {
                            <b>return</b> <a href="#8b79e299e70919cd" class="i field">OrdinalCultureName</a>;
                        }
 
                    <b>case</b> <span class="i">StringComparison</span>.<span class="i">InvariantCulture</span>:
                    <b>case</b> <span class="i">StringComparison</span>.<span class="i">InvariantCultureIgnoreCase</span>:
                        {
                            <b>return</b> <a href="#807910e8b2fb97ab" class="i field">InvariantCultureName</a>;
                        }
 
                    <b>case</b> <span class="i">StringComparison</span>.<span class="i">CurrentCulture</span>:
                    <b>case</b> <span class="i">StringComparison</span>.<span class="i">CurrentCultureIgnoreCase</span>:
                        {
                            <b>return</b> <a href="#36735f1481ddf924" class="i field">CurrentCultureName</a>;
                        }
 
                    <b>default</b>:
                        {
                            <b>break</b>;
                        }
                }
 
                <b>return</b> <a href="#8653a00e6e4406aa" class="i field">_cultureName</a>;
            }
 
            <b>set</b>
            {
                <a href="#8653a00e6e4406aa" class="i field">_cultureName</a> = <b>value</b>;
                <a href="#6b84cd6c20ae857a" class="i method">InitCulture</a>();
            }
        }
 
        <b>internal const string</b> <a id="8b79e299e70919cd" href="../../R/8b79e299e70919cd.html" target="n" data-glyph="8,1" class="i field">OrdinalCultureName</a> = <span class="s">&quot;Ordinal&quot;</span>;
        <b>internal const string</b> <a id="807910e8b2fb97ab" href="../../R/807910e8b2fb97ab.html" target="n" data-glyph="8,1" class="i field">InvariantCultureName</a> = <span class="s">&quot;Invariant&quot;</span>;
        <b>internal const string</b> <a id="36735f1481ddf924" href="../../R/36735f1481ddf924.html" target="n" data-glyph="8,1" class="i field">CurrentCultureName</a> = <span class="s">&quot;Current&quot;</span>;
 
        <b>private string</b> <a id="8653a00e6e4406aa" href="../../R/8653a00e6e4406aa.html" target="n" data-glyph="46,1" class="i field">_cultureName</a> = <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>.<span class="i">Name</span>;
        <b>private</b> <span class="i">StringComparison</span> <a id="53d3c400c8e30b3a" href="../../R/53d3c400c8e30b3a.html" target="n" data-glyph="46,1" class="i field">_stringComparison</a> = <span class="i">StringComparison</span>.<span class="i">CurrentCultureIgnoreCase</span>;
        <b>private</b> <span class="i">CompareOptions</span> <a id="c58a1847e8413d79" href="../../R/c58a1847e8413d79.html" target="n" data-glyph="46,1" class="i field">_compareOptions</a> = <span class="i">CompareOptions</span>.<span class="i">IgnoreCase</span>;
 
        <b>private delegate int</b> <a id="5d4204f8dbd1ef28" href="../../R/5d4204f8dbd1ef28.html" target="n" data-glyph="16,1" class="t t"><span id="733c61c4e7e5d3de">CultureInfoIndexOf</span></a>(<b>string</b> <span id="r76 rd" class="r76 r">source</span>, <b>string</b> <span id="r77 rd" class="r77 r">value</span>, <b>int</b> <span id="r78 rd" class="r78 r">startIndex</span>, <b>int</b> <span id="r79 rd" class="r79 r">count</span>, <span class="i">CompareOptions</span> <span id="r80 rd" class="r80 r">options</span>);
 
        <b>private</b> <a href="#5d4204f8dbd1ef28" class="t t">CultureInfoIndexOf</a> <a id="4c3e49151444671d" href="../../R/4c3e49151444671d.html" target="n" data-glyph="46,1" class="i field">_cultureInfoIndexOf</a> = <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>.<span class="i">CompareInfo</span>.<span class="i">IndexOf</span>;
 
        <b>private void</b> <a id="6b84cd6c20ae857a" href="../../R/6b84cd6c20ae857a.html" target="n" data-glyph="76,1" class="i method">InitCulture</a>()
        {
            <a href="#53d3c400c8e30b3a" class="i field">_stringComparison</a> = <b>default</b>;
 
            <b>switch</b> (<a href="#8653a00e6e4406aa" class="i field">_cultureName</a>)
            {
                <b>case</b> <a href="#8b79e299e70919cd" class="i field">OrdinalCultureName</a>:
                    {
                        <a href="#53d3c400c8e30b3a" class="i field">_stringComparison</a> = <a href="#ffe8d329cff3d980" class="i property">CaseSensitive</a> ? <span class="i">StringComparison</span>.<span class="i">Ordinal</span> : <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>;
                        <a href="#c58a1847e8413d79" class="i field">_compareOptions</a> = <a href="#ffe8d329cff3d980" class="i property">CaseSensitive</a> ? <span class="i">CompareOptions</span>.<span class="i">Ordinal</span> : <span class="i">CompareOptions</span>.<span class="i">OrdinalIgnoreCase</span>;
                        <a href="#4c3e49151444671d" class="i field">_cultureInfoIndexOf</a> = <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>.<span class="i">CompareInfo</span>.<span class="i">IndexOf</span>;
                        <b>break</b>;
                    }
 
                <b>case</b> <a href="#807910e8b2fb97ab" class="i field">InvariantCultureName</a>:
                    {
                        <a href="#53d3c400c8e30b3a" class="i field">_stringComparison</a> = <a href="#ffe8d329cff3d980" class="i property">CaseSensitive</a> ? <span class="i">StringComparison</span>.<span class="i">InvariantCulture</span> : <span class="i">StringComparison</span>.<span class="i">InvariantCultureIgnoreCase</span>;
                        <a href="#c58a1847e8413d79" class="i field">_compareOptions</a> = <a href="#ffe8d329cff3d980" class="i property">CaseSensitive</a> ? <span class="i">CompareOptions</span>.<span class="i">None</span> : <span class="i">CompareOptions</span>.<span class="i">IgnoreCase</span>;
                        <a href="#4c3e49151444671d" class="i field">_cultureInfoIndexOf</a> = <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>.<span class="i">CompareInfo</span>.<span class="i">IndexOf</span>;
                        <b>break</b>;
                    }
 
                <b>case</b> <a href="#36735f1481ddf924" class="i field">CurrentCultureName</a>:
                    {
                        <a href="#53d3c400c8e30b3a" class="i field">_stringComparison</a> = <a href="#ffe8d329cff3d980" class="i property">CaseSensitive</a> ? <span class="i">StringComparison</span>.<span class="i">CurrentCulture</span> : <span class="i">StringComparison</span>.<span class="i">CurrentCultureIgnoreCase</span>;
                        <a href="#c58a1847e8413d79" class="i field">_compareOptions</a> = <a href="#ffe8d329cff3d980" class="i property">CaseSensitive</a> ? <span class="i">CompareOptions</span>.<span class="i">None</span> : <span class="i">CompareOptions</span>.<span class="i">IgnoreCase</span>;
                        <a href="#4c3e49151444671d" class="i field">_cultureInfoIndexOf</a> = <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>.<span class="i">CompareInfo</span>.<span class="i">IndexOf</span>;
                        <b>break</b>;
                    }
 
                <b>default</b>:
                    {
                        <b>var</b> <span id="r81 rd" class="r81 r">_cultureInfo</span> = <span class="i">CultureInfo</span>.<span class="i">GetCultureInfo</span>(<a href="#8653a00e6e4406aa" class="i field">_cultureName</a>);
                        <a href="#c58a1847e8413d79" class="i field">_compareOptions</a> = <a href="#ffe8d329cff3d980" class="i property">CaseSensitive</a> ? <span class="i">CompareOptions</span>.<span class="i">None</span> : <span class="i">CompareOptions</span>.<span class="i">IgnoreCase</span>;
                        <a href="#4c3e49151444671d" class="i field">_cultureInfoIndexOf</a> = <span class="r81 r">_cultureInfo</span>.<span class="i">CompareInfo</span>.<span class="i">IndexOf</span>;
                        <b>break</b>;
                    }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the current pipeline object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b8dbf1d211f8e2e" class="i field">ParameterSetObject</a>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#6e50968884129e4e" class="i field">ParameterSetObjectRaw</a>)]
        [<span class="i">AllowNull</span>]
        [<span class="i">AllowEmptyString</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="6a2d1ad4e7ee1bbe" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">InputObject</a>
        {
            <b>get</b> =&gt; <a href="#36dcaa264620e24e" class="i field">_inputObject</a>;
            <b>set</b> =&gt; <a href="#36dcaa264620e24e" class="i field">_inputObject</a> = <a href="/System.Management.Automation/A.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">IsNull</span>(<b>value</b>) ? <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">AsPSObject</span>(<b>string</b>.<span class="i">Empty</span>) : <b>value</b>;
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="36dcaa264620e24e" href="../../R/36dcaa264620e24e.html" target="n" data-glyph="46,1" class="i field">_inputObject</a> = <a href="/System.Management.Automation/A.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="/System.Management.Automation/A.html#1cf7e193da582896" class="i property">Value</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the patterns to find.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        <b>public string</b>[] <a id="d0d38b45d942d4c7" href="../../R/d0d38b45d942d4c7.html" target="n" data-glyph="102,1" class="i property">Pattern</a> { <b>get</b>; <b>set</b>; }
 
        <b>private</b> <span class="i">Regex</span>[] <a id="5892e3f7fd3098a8" href="../../R/5892e3f7fd3098a8.html" target="n" data-glyph="46,1" class="i field">_regexPattern</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets files to read from.</span>
        <span class="c">///</span><span class="c"> Globbing is done on these.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#4f089cd78f9ed8df" class="i field">ParameterSetFile</a>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#4b4d4c8fb232809b" class="i field">ParameterSetFileRaw</a>)]
        [<span class="i">FileinfoToString</span>]
        <b>public string</b>[] <a id="3c55368f62a1d181" href="../../R/3c55368f62a1d181.html" target="n" data-glyph="102,1" class="i property">Path</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets literal files to read from.</span>
        <span class="c">///</span><span class="c"> Globbing is not done on these.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#262ad54e1763ab13" class="i field">ParameterSetLiteralFile</a>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#94f8a939019b0daf" class="i field">ParameterSetLiteralFileRaw</a>)]
        [<span class="i">FileinfoToString</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;PSPath&quot;</span>, <span class="s">&quot;LP&quot;</span>)]
        <b>public string</b>[] <a id="eacd8be33f7a4e8c" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">LiteralPath</a>
        {
            <b>get</b> =&gt; <a href="#3c55368f62a1d181" class="i property">Path</a>;
            <b>set</b>
            {
                <a href="#3c55368f62a1d181" class="i property">Path</a> = <b>value</b>;
                <a href="#b7c801db4b8fe527" class="i field">_isLiteralPath</a> = <b>true</b>;
            }
        }
 
        <b>private bool</b> <a id="b7c801db4b8fe527" href="../../R/b7c801db4b8fe527.html" target="n" data-glyph="46,1" class="i field">_isLiteralPath</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating if only string values containing matched lines should be returned.</span>
        <span class="c">///</span><span class="c"> If not (default) return MatchInfo (or bool objects, when Quiet is passed).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#6e50968884129e4e" class="i field">ParameterSetObjectRaw</a>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#4b4d4c8fb232809b" class="i field">ParameterSetFileRaw</a>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#94f8a939019b0daf" class="i field">ParameterSetLiteralFileRaw</a>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="0f3367f0218ae5d1" href="../../R/0f3367f0218ae5d1.html" target="n" data-glyph="102,1" class="i property">Raw</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating if a pattern string should be matched literally.</span>
        <span class="c">///</span><span class="c"> If not (default) search using pattern as a Regular Expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="9a9c161722d115ee" href="../../R/9a9c161722d115ee.html" target="n" data-glyph="102,1" class="i property">SimpleMatch</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating if the search is case sensitive.If true, then do case-sensitive searches.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="ffe8d329cff3d980" href="../../R/ffe8d329cff3d980.html" target="n" data-glyph="102,1" class="i property">CaseSensitive</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating if the cmdlet will stop processing at the first successful match and</span>
        <span class="c">///</span><span class="c"> return true.  If both List and Quiet parameters are given, an exception is thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#3b8dbf1d211f8e2e" class="i field">ParameterSetObject</a>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#4f089cd78f9ed8df" class="i field">ParameterSetFile</a>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#262ad54e1763ab13" class="i field">ParameterSetLiteralFile</a>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="8093aff4730de76f" href="../../R/8093aff4730de76f.html" target="n" data-glyph="102,1" class="i property">Quiet</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating if matching files should be listed.</span>
        <span class="c">///</span><span class="c"> This is the Unix functionality this switch is intended to mimic;</span>
        <span class="c">///</span><span class="c"> the actual action of this option is to stop after the first match</span>
        <span class="c">///</span><span class="c"> is found and returned from any particular file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="f06692413bc12087" href="../../R/f06692413bc12087.html" target="n" data-glyph="102,1" class="i property">List</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating if highlighting should be disabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="11606e8ee3902d11" href="../../R/11606e8ee3902d11.html" target="n" data-glyph="102,1" class="i property">NoEmphasis</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets files to include. Files matching</span>
        <span class="c">///</span><span class="c"> one of these (if specified) are included.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="/System.Management.Automation/A.html#6b04631ee3f3c396" class="t t">WildcardPatternException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Invalid wildcard pattern was specified.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b>[] <a id="5de0eed48e7123a3" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Include</a>
        {
            <b>get</b> =&gt; <a href="#cd4d3da2e4af2d75" class="i field">_includeStrings</a>;
            <b>set</b>
            {
                <span class="c">// null check is not needed (because of ValidateNotNullOrEmpty),</span>
                <span class="c">// but we have to include it to silence OACR</span>
                <a href="#cd4d3da2e4af2d75" class="i field">_includeStrings</a> = <b>value</b> ?? <b>throw</b> <a href="/System.Management.Automation/A.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentNullException</span>(<b>nameof</b>(<b>value</b>));
 
                <a href="#048b30740252d8a8" class="i field">_include</a> = <b>new</b> <a href="/System.Management.Automation/A.html#d450e739ff28e660" class="t t">WildcardPattern</a>[<a href="#cd4d3da2e4af2d75" class="i field">_includeStrings</a>.<span class="i">Length</span>];
                <b>for</b> (<b>int</b> <span id="r82 rd" class="r82 r">i</span> = 0; <span class="r82 r">i</span> &lt; <a href="#cd4d3da2e4af2d75" class="i field">_includeStrings</a>.<span class="i">Length</span>; <span class="r82 r">i</span>++)
                {
                    <a href="#048b30740252d8a8" class="i field">_include</a>[<span class="r82 r">i</span>] = <a href="/System.Management.Automation/A.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<a href="#cd4d3da2e4af2d75" class="i field">_includeStrings</a>[<span class="r82 r">i</span>], <a href="/System.Management.Automation/A.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="/System.Management.Automation/A.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                }
            }
        }
 
        <b>private string</b>[] <a id="cd4d3da2e4af2d75" href="../../R/cd4d3da2e4af2d75.html" target="n" data-glyph="46,1" class="i field">_includeStrings</a>;
 
        <b>private</b> <a href="/System.Management.Automation/A.html#d450e739ff28e660" class="t t">WildcardPattern</a>[] <a id="048b30740252d8a8" href="../../R/048b30740252d8a8.html" target="n" data-glyph="46,1" class="i field">_include</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets files to exclude. Files matching</span>
        <span class="c">///</span><span class="c"> one of these (if specified) are excluded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b>[] <a id="890f39ca378d8ec3" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Exclude</a>
        {
            <b>get</b> =&gt; <a href="#5bbab3d4ea72456c" class="i field">_excludeStrings</a>;
            <b>set</b>
            {
                <span class="c">// null check is not needed (because of ValidateNotNullOrEmpty),</span>
                <span class="c">// but we have to include it to silence OACR</span>
                <a href="#5bbab3d4ea72456c" class="i field">_excludeStrings</a> = <b>value</b> ?? <b>throw</b> <a href="/System.Management.Automation/A.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentNullException</span>(<span class="s">&quot;value&quot;</span>);
 
                <a href="#0a453c5922563b7f" class="i field">_exclude</a> = <b>new</b> <a href="/System.Management.Automation/A.html#d450e739ff28e660" class="t t">WildcardPattern</a>[<a href="#5bbab3d4ea72456c" class="i field">_excludeStrings</a>.<span class="i">Length</span>];
                <b>for</b> (<b>int</b> <span id="r83 rd" class="r83 r">i</span> = 0; <span class="r83 r">i</span> &lt; <a href="#5bbab3d4ea72456c" class="i field">_excludeStrings</a>.<span class="i">Length</span>; <span class="r83 r">i</span>++)
                {
                    <a href="#0a453c5922563b7f" class="i field">_exclude</a>[<span class="r83 r">i</span>] = <a href="/System.Management.Automation/A.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<a href="#5bbab3d4ea72456c" class="i field">_excludeStrings</a>[<span class="r83 r">i</span>], <a href="/System.Management.Automation/A.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="/System.Management.Automation/A.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                }
            }
        }
 
        <b>private string</b>[] <a id="5bbab3d4ea72456c" href="../../R/5bbab3d4ea72456c.html" target="n" data-glyph="46,1" class="i field">_excludeStrings</a>;
 
        <b>private</b> <a href="/System.Management.Automation/A.html#d450e739ff28e660" class="t t">WildcardPattern</a>[] <a id="0a453c5922563b7f" href="../../R/0a453c5922563b7f.html" target="n" data-glyph="46,1" class="i field">_exclude</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating whether to only show lines which do not match.</span>
        <span class="c">///</span><span class="c"> Equivalent to grep -v/findstr -v.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="8d62ef237df7a20a" href="../../R/8d62ef237df7a20a.html" target="n" data-glyph="102,1" class="i property">NotMatch</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets a value indicating whether the Matches property of MatchInfo should be set</span>
        <span class="c">///</span><span class="c"> to the result of calling System.Text.RegularExpressions.Regex.Matches() on</span>
        <span class="c">///</span><span class="c"> the corresponding line.</span>
        <span class="c">///</span><span class="c"> Has no effect if -SimpleMatch is also specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="24baac8e5664e5c2" href="../../R/24baac8e5664e5c2.html" target="n" data-glyph="102,1" class="i property">AllMatches</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the text encoding to process each file as.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ArgumentToEncodingTransformationAttribute</span>()]
        [<span class="i">ArgumentEncodingCompletionsAttribute</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Encoding</span> <a id="b75da3cd5fdd5a4f" href="../../R/b75da3cd5fdd5a4f.html" target="n" data-glyph="102,1" class="i property">Encoding</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#3046b246ad24b6e8" class="i field">_encoding</a>;
            }
 
            <b>set</b>
            {
                <span class="i">EncodingConversion</span>.<span class="i">WarnIfObsolete</span>(<a href="#730ac6500e48376f" class="k">this</a>, <b>value</b>);
                <a href="#3046b246ad24b6e8" class="i field">_encoding</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">Encoding</span> <a id="3046b246ad24b6e8" href="../../R/3046b246ad24b6e8.html" target="n" data-glyph="46,1" class="i field">_encoding</a> = <span class="i">ClrFacade</span>.<span class="i">GetDefaultEncoding</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the number of context lines to collect. If set to a</span>
        <span class="c">///</span><span class="c"> single integer value N, collects N lines each of pre-</span>
        <span class="c">///</span><span class="c"> and post- context. If set to a 2-tuple B,A, collects B</span>
        <span class="c">///</span><span class="c"> lines of pre- and A lines of post- context.</span>
        <span class="c">///</span><span class="c"> If set to a list with more than 2 elements, the</span>
        <span class="c">///</span><span class="c"> excess elements are ignored.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">ValidateCount</span>(1, 2)]
        [<span class="i">ValidateRange</span>(0, <b>int</b>.<span class="i">MaxValue</span>)]
        <b>public</b> <b>new</b> <b>int</b>[] <a id="2b447bed838225d1" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Context</a>
        {
            <b>get</b> =&gt; <a href="#78a985e0cdc7de00" class="i field">_context</a>;
            <b>set</b>
            {
                <span class="c">// null check is not needed (because of ValidateNotNullOrEmpty),</span>
                <span class="c">// but we have to include it to silence OACR</span>
                <a href="#78a985e0cdc7de00" class="i field">_context</a> = <b>value</b> ?? <b>throw</b> <a href="/System.Management.Automation/A.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentNullException</span>(<span class="s">&quot;value&quot;</span>);
 
                <b>if</b> (<a href="#78a985e0cdc7de00" class="i field">_context</a>.<span class="i">Length</span> == 1)
                {
                    <a href="#4fd550c78b125bd3" class="i field">_preContext</a> = <a href="#78a985e0cdc7de00" class="i field">_context</a>[0];
                    <a href="#465f2cee1b966c53" class="i field">_postContext</a> = <a href="#78a985e0cdc7de00" class="i field">_context</a>[0];
                }
                <b>else</b> <b>if</b> (<a href="#78a985e0cdc7de00" class="i field">_context</a>.<span class="i">Length</span> &gt;= 2)
                {
                    <a href="#4fd550c78b125bd3" class="i field">_preContext</a> = <a href="#78a985e0cdc7de00" class="i field">_context</a>[0];
                    <a href="#465f2cee1b966c53" class="i field">_postContext</a> = <a href="#78a985e0cdc7de00" class="i field">_context</a>[1];
                }
            }
        }
 
        <b>private int</b>[] <a id="78a985e0cdc7de00" href="../../R/78a985e0cdc7de00.html" target="n" data-glyph="46,1" class="i field">_context</a>;
 
        <b>private int</b> <a id="4fd550c78b125bd3" href="../../R/4fd550c78b125bd3.html" target="n" data-glyph="46,1" class="i field">_preContext</a> = 0;
 
        <b>private int</b> <a id="465f2cee1b966c53" href="../../R/465f2cee1b966c53.html" target="n" data-glyph="46,1" class="i field">_postContext</a> = 0;
 
        <span class="c">// When we are in Raw mode or pre- and postcontext are zero, use the _noContextTracker, since we will not be needing trackedLines.</span>
        <b>private</b> <a href="#9915001f7a00123d" class="t t">IContextTracker</a> <a id="68b95ce1e3b4dee3" href="../../R/68b95ce1e3b4dee3.html" target="n" data-glyph="76,1" class="i method">GetContextTracker</a>() =&gt; (<a href="#0f3367f0218ae5d1" class="i property">Raw</a> || (<a href="#4fd550c78b125bd3" class="i field">_preContext</a> == 0 &amp;&amp; <a href="#465f2cee1b966c53" class="i field">_postContext</a> == 0))
            ? <a href="#ce4835dee1534cdf" class="i field">_noContextTracker</a>
            : <b>new</b> <a href="#71843497cb0c1172" class="t constructor">ContextTracker</a>(<a href="#4fd550c78b125bd3" class="i field">_preContext</a>, <a href="#465f2cee1b966c53" class="i field">_postContext</a>);
 
        <span class="c">// This context tracker is only used for strings which are piped</span>
        <span class="c">// directly into the cmdlet. File processing doesn&#39;t need</span>
        <span class="c">// to track state between calls to ProcessRecord, and so</span>
        <span class="c">// allocates its own tracker. The reason we can&#39;t</span>
        <span class="c">// use a single global tracker for both is that in the case of</span>
        <span class="c">// a mixed list of strings and FileInfo, the context tracker</span>
        <span class="c">// would get reset after each file.</span>
        <b>private</b> <a href="#9915001f7a00123d" class="t t">IContextTracker</a> <a id="9d779ab2ddd52583" href="../../R/9d779ab2ddd52583.html" target="n" data-glyph="46,1" class="i field">_globalContextTracker</a>;
 
        <b>private</b> <a href="#9915001f7a00123d" class="t t">IContextTracker</a> <a id="ce4835dee1534cdf" href="../../R/ce4835dee1534cdf.html" target="n" data-glyph="46,1" class="i field">_noContextTracker</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is used to handle the case were we&#39;re done processing input objects.</span>
        <span class="c">///</span><span class="c"> If true, process record will just return.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="c11c7e1ae82b898a" href="../../R/c11c7e1ae82b898a.html" target="n" data-glyph="46,1" class="i field">_doneProcessing</a>;
 
        <b>private int</b> <a id="468b8eef2797ccce" href="../../R/468b8eef2797ccce.html" target="n" data-glyph="46,1" class="i field">_inputRecordNumber</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Read command line parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="f6210c39f4a2c275" href="../../R/f6210c39f4a2c275.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <b>if</b> (<a href="#730ac6500e48376f" class="k">this</a>.<a href="/System.Management.Automation/A.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="/System.Management.Automation/A.html#1927782a0117ff76" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<b>nameof</b>(<a href="#8cf08e59fe194948" class="i property">Culture</a>)) &amp;&amp; !<a href="#730ac6500e48376f" class="k">this</a>.<a href="/System.Management.Automation/A.html#92387ec2f33e4d8f" class="i property">MyInvocation</a>.<a href="/System.Management.Automation/A.html#1927782a0117ff76" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<b>nameof</b>(<a href="#9a9c161722d115ee" class="i property">SimpleMatch</a>)))
            {
                <span class="i">InvalidOperationException</span> <span id="r84 rd" class="r84 r">exception</span> = <b>new</b>(<span class="i">MatchStringStrings</span>.<span class="i">CannotSpecifyCultureWithoutSimpleMatch</span>);
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r85 rd" class="r85 r">errorRecord</span> = <b>new</b>(<span class="r84 r">exception</span>, <span class="s">&quot;CannotSpecifyCultureWithoutSimpleMatch&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#c855a7c43559f12f" class="i field">InvalidData</a>, <b>null</b>);
                <a href="#730ac6500e48376f" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="r85 r">errorRecord</span>);
            }
 
            <a href="#6b84cd6c20ae857a" class="i method">InitCulture</a>();
 
            <b>string</b> <span id="r86 rd" class="r86 r">suppressVt</span> = <span class="i">Environment</span>.<span class="i">GetEnvironmentVariable</span>(<span class="s">&quot;__SuppressAnsiEscapeSequences&quot;</span>);
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r86 r">suppressVt</span>))
            {
                <a href="#11606e8ee3902d11" class="i property">NoEmphasis</a> = <b>true</b>;
            }
 
            <b>if</b> (!<a href="#9a9c161722d115ee" class="i property">SimpleMatch</a>)
            {
                <span class="i">RegexOptions</span> <span id="r87 rd" class="r87 r">regexOptions</span> = <a href="#ffe8d329cff3d980" class="i property">CaseSensitive</a> ? <span class="i">RegexOptions</span>.<span class="i">None</span> : <span class="i">RegexOptions</span>.<span class="i">IgnoreCase</span>;
                <a href="#5892e3f7fd3098a8" class="i field">_regexPattern</a> = <b>new</b> <span class="i">Regex</span>[<a href="#d0d38b45d942d4c7" class="i property">Pattern</a>.<span class="i">Length</span>];
                <b>for</b> (<b>int</b> <span id="r88 rd" class="r88 r">i</span> = 0; <span class="r88 r">i</span> &lt; <a href="#d0d38b45d942d4c7" class="i property">Pattern</a>.<span class="i">Length</span>; <span class="r88 r">i</span>++)
                {
                    <b>try</b>
                    {
                        <a href="#5892e3f7fd3098a8" class="i field">_regexPattern</a>[<span class="r88 r">i</span>] = <b>new</b> <span class="i">Regex</span>(<a href="#d0d38b45d942d4c7" class="i property">Pattern</a>[<span class="r88 r">i</span>], <span class="r87 r">regexOptions</span>);
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r89 rd" class="r89 r">e</span>)
                    {
                        <a href="#730ac6500e48376f" class="k">this</a>.<span class="i">ThrowTerminatingError</span>(<span class="i">BuildErrorRecord</span>(<span class="i">MatchStringStrings</span>.<span class="i">InvalidRegex</span>, <a href="#d0d38b45d942d4c7" class="i property">Pattern</a>[<span class="r88 r">i</span>], <span class="r89 r">e</span>.<span class="i">Message</span>, <span class="s">&quot;InvalidRegex&quot;</span>, <span class="r89 r">e</span>));
                        <b>throw</b>;
                    }
                }
            }
 
            <a href="#ce4835dee1534cdf" class="i field">_noContextTracker</a> = <b>new</b> <span class="t">NoContextTracker</span>();
            <a href="#9d779ab2ddd52583" class="i field">_globalContextTracker</a> = <a href="#68b95ce1e3b4dee3" class="i method">GetContextTracker</a>();
        }
 
        <b>private readonly</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="966e2c84b26e6e50" href="../../R/966e2c84b26e6e50.html" target="n" data-glyph="46,1" class="i field">_inputObjectFileList</a> = <b>new</b>(1) { <b>string</b>.<span class="i">Empty</span> };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process the input.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Regular expression parsing error, path error.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">FileNotFoundException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A file cannot be found.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">DirectoryNotFoundException</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A file cannot be found.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="5d55b5919ffba218" href="../../R/5d55b5919ffba218.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#c11c7e1ae82b898a" class="i field">_doneProcessing</a>)
            {
                <b>return</b>;
            }
 
            <span class="c">// We may only have directories when we have resolved wildcards</span>
            <b>var</b> <span id="r90 rd" class="r90 r">expandedPathsMaybeDirectory</span> = <b>false</b>;
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r91 rd" class="r91 r">expandedPaths</span> = <b>null</b>;
            <b>if</b> (<a href="#3c55368f62a1d181" class="i property">Path</a> != <b>null</b>)
            {
                <span class="r91 r">expandedPaths</span> = <a href="#adbc15b647735efe" class="i method">ResolveFilePaths</a>(<a href="#3c55368f62a1d181" class="i property">Path</a>, <a href="#b7c801db4b8fe527" class="i field">_isLiteralPath</a>);
                <b>if</b> (<span class="r91 r">expandedPaths</span> == <b>null</b>)
                {
                    <b>return</b>;
                }
 
                <span class="r90 r">expandedPathsMaybeDirectory</span> = <b>true</b>;
            }
            <b>else</b>
            {
                <b>if</b> (<a href="#36dcaa264620e24e" class="i field">_inputObject</a>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <span class="i">FileInfo</span> <span id="r92 rd" class="r92 r">fileInfo</span>)
                {
                    <a href="#966e2c84b26e6e50" class="i field">_inputObjectFileList</a>[0] = <span class="r92 r">fileInfo</span>.<span class="i">FullName</span>;
                    <span class="r91 r">expandedPaths</span> = <a href="#966e2c84b26e6e50" class="i field">_inputObjectFileList</a>;
                }
            }
 
            <b>if</b> (<span class="r91 r">expandedPaths</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>var</b> <span id="r93 rd" class="r93 r">filename</span> <b>in</b> <span class="r91 r">expandedPaths</span>)
                {
                    <b>if</b> (<span class="r90 r">expandedPathsMaybeDirectory</span> &amp;&amp; <span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r93 r">filename</span>))
                    {
                        <b>continue</b>;
                    }
 
                    <b>var</b> <span id="r94 rd" class="r94 r">foundMatch</span> = <span class="i">ProcessFile</span>(<span class="r93 r">filename</span>);
                    <b>if</b> (<a href="#8093aff4730de76f" class="i property">Quiet</a> &amp;&amp; <span class="r94 r">foundMatch</span>)
                    {
                        <b>return</b>;
                    }
                }
 
                <span class="c">// No results in any files.</span>
                <b>if</b> (<a href="#8093aff4730de76f" class="i property">Quiet</a>)
                {
                    <b>var</b> <span id="r95 rd" class="r95 r">res</span> = <a href="#f06692413bc12087" class="i property">List</a> ? <b>null</b> : <span class="i">Boxed</span>.<span class="i">False</span>;
                    <span class="i">WriteObject</span>(<span class="r95 r">res</span>);
                }
            }
            <b>else</b>
            {
                <span class="c">// Set the line number in the matched object to be the record number</span>
                <a href="#468b8eef2797ccce" class="i field">_inputRecordNumber</a>++;
 
                <b>bool</b> <span id="r96 rd" class="r96 r">matched</span>;
                <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r97 rd" class="r97 r">result</span>;
                <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r98 rd" class="r98 r">matchInfo</span> = <b>null</b>;
                <b>if</b> (<a href="#36dcaa264620e24e" class="i field">_inputObject</a>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is string</b> <span id="r99 rd" class="r99 r">line</span>)
                {
                    <span class="r96 r">matched</span> = <a href="#be50445a8a0237d5" class="i method">DoMatch</a>(<span class="r99 r">line</span>, <b>out</b> <span class="r97 r">result</span>);
                }
                <b>else</b>
                {
                    <span class="r98 r">matchInfo</span> = <a href="#36dcaa264620e24e" class="i field">_inputObject</a>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as</b> <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>;
                    <b>object</b> <span id="r100 rd" class="r100 r">objectToCheck</span> = <span class="r98 r">matchInfo</span> ?? (<b>object</b>)<a href="#36dcaa264620e24e" class="i field">_inputObject</a>;
                    <span class="r96 r">matched</span> = <a href="#6bf147b38b5d2cf7" class="i method">DoMatch</a>(<span class="r100 r">objectToCheck</span>, <b>out</b> <span class="r97 r">result</span>, <b>out</b> <span class="r99 r">line</span>);
                }
 
                <b>if</b> (<span class="r96 r">matched</span>)
                {
                    <span class="c">// Don&#39;t re-write the line number if it was already set...</span>
                    <b>if</b> (<span class="r98 r">matchInfo</span> == <b>null</b>)
                    {
                        <span class="r97 r">result</span>.<a href="#d2a37f2623812bc0" class="i property">LineNumber</a> = <a href="#468b8eef2797ccce" class="i field">_inputRecordNumber</a>;
                    }
 
                    <span class="c">// doMatch will have already set the pattern and line text...</span>
                    <a href="#9d779ab2ddd52583" class="i field">_globalContextTracker</a>.<a href="#916869dc1db8021f" class="i method">TrackMatch</a>(<span class="r97 r">result</span>);
                }
                <b>else</b>
                {
                    <a href="#9d779ab2ddd52583" class="i field">_globalContextTracker</a>.<a href="#5f028f596d3d151f" class="i method">TrackLine</a>(<span class="r99 r">line</span>);
                }
 
                <span class="c">// Emit any queued up objects...</span>
                <b>if</b> (<a href="#f081599bef877413" class="i method">FlushTrackerQueue</a>(<a href="#9d779ab2ddd52583" class="i field">_globalContextTracker</a>))
                {
                    <span class="c">// If we&#39;re in quiet mode, go ahead and stop processing</span>
                    <span class="c">// now.</span>
                    <b>if</b> (<a href="#8093aff4730de76f" class="i property">Quiet</a>)
                    {
                        <a href="#c11c7e1ae82b898a" class="i field">_doneProcessing</a> = <b>true</b>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process a file which was either specified on the</span>
        <span class="c">///</span><span class="c"> command line or passed in as a FileInfo object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r101 r">filename</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The file to process.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if a match was found; otherwise false.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="084a7d612e1d409b" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ProcessFile</a>(<b>string</b> <span id="r101 rd" class="r101 r">filename</span>)
        {
            <a href="#9915001f7a00123d" class="k">var</a> <span id="r102 rd" class="r102 r">contextTracker</span> = <a href="#68b95ce1e3b4dee3" class="i method">GetContextTracker</a>();
 
            <b>bool</b> <span id="r103 rd" class="r103 r">foundMatch</span> = <b>false</b>;
 
            <span class="c">// Read the file one line at a time...</span>
            <b>try</b>
            {
                <span class="c">// see if the file is one the include exclude list...</span>
                <b>if</b> (!<a href="#1eefb781504042db" class="i method">MeetsIncludeExcludeCriteria</a>(<span class="r101 r">filename</span>))
                {
                    <b>return</b> <b>false</b>;
                }
 
                <b>using</b> (<span class="i">FileStream</span> <span id="r104 rd" class="r104 r">fs</span> = <b>new</b>(<span class="r101 r">filename</span>, <span class="i">FileMode</span>.<span class="i">Open</span>, <span class="i">FileAccess</span>.<span class="i">Read</span>, <span class="i">FileShare</span>.<span class="i">ReadWrite</span>))
                {
                    <b>using</b> (<span class="i">StreamReader</span> <span id="r105 rd" class="r105 r">sr</span> = <b>new</b>(<span class="r104 r">fs</span>, <a href="#b75da3cd5fdd5a4f" class="i property">Encoding</a>))
                    {
                        <b>string</b> <span id="r106 rd" class="r106 r">line</span>;
                        <b>int</b> <span id="r107 rd" class="r107 r">lineNo</span> = 0;
 
                        <span class="c">// Read and display lines from the file until the end of</span>
                        <span class="c">// the file is reached.</span>
                        <b>while</b> ((<span class="r106 r">line</span> = <span class="r105 r">sr</span>.<span class="i">ReadLine</span>()) != <b>null</b>)
                        {
                            <span class="r107 r">lineNo</span>++;
 
                            <b>if</b> (<a href="#be50445a8a0237d5" class="i method">DoMatch</a>(<span class="r106 r">line</span>, <b>out</b> <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r108 rd" class="r108 r">result</span>))
                            {
                                <span class="r108 r">result</span>.<a href="#1b32ea13e3342ad9" class="i property">Path</a> = <span class="r101 r">filename</span>;
                                <span class="r108 r">result</span>.<a href="#d2a37f2623812bc0" class="i property">LineNumber</a> = <span class="r107 r">lineNo</span>;
                                <span class="r102 r">contextTracker</span>.<a href="#916869dc1db8021f" class="i method">TrackMatch</a>(<span class="r108 r">result</span>);
                            }
                            <b>else</b>
                            {
                                <span class="r102 r">contextTracker</span>.<a href="#5f028f596d3d151f" class="i method">TrackLine</a>(<span class="r106 r">line</span>);
                            }
 
                            <span class="c">// Flush queue of matches to emit.</span>
                            <b>if</b> (<span class="r102 r">contextTracker</span>.<a href="#94bb214f300f57ef" class="i property">EmitQueue</a>.<span class="i">Count</span> &gt; 0)
                            {
                                <span class="r103 r">foundMatch</span> = <b>true</b>;
 
                                <span class="c">// If -list or -quiet was specified, we only want to emit the first match</span>
                                <span class="c">// for each file so record the object to emit and stop processing</span>
                                <span class="c">// this file. It&#39;s done this way so the file is closed before emitting</span>
                                <span class="c">// the result so the downstream cmdlet can actually manipulate the file</span>
                                <span class="c">// that was found.</span>
                                <b>if</b> (<a href="#8093aff4730de76f" class="i property">Quiet</a> || <a href="#f06692413bc12087" class="i property">List</a>)
                                {
                                    <b>break</b>;
                                }
 
                                <a href="#f081599bef877413" class="i method">FlushTrackerQueue</a>(<span class="r102 r">contextTracker</span>);
                            }
                        }
                    }
                }
 
                <span class="c">// Check for any remaining matches. This could be caused</span>
                <span class="c">// by breaking out of the loop early for quiet or list</span>
                <span class="c">// mode, or by reaching EOF before we collected all</span>
                <span class="c">// our postcontext.</span>
                <span class="r102 r">contextTracker</span>.<a href="#3c221ca5691ce303" class="i method">TrackEOF</a>();
                <b>if</b> (<a href="#f081599bef877413" class="i method">FlushTrackerQueue</a>(<span class="r102 r">contextTracker</span>))
                {
                    <span class="r103 r">foundMatch</span> = <b>true</b>;
                }
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">NotSupportedException</span> <span id="r109 rd" class="r109 r">nse</span>)
            {
                <span class="i">WriteError</span>(<span class="i">BuildErrorRecord</span>(<span class="i">MatchStringStrings</span>.<span class="i">FileReadError</span>, <span class="r101 r">filename</span>, <span class="r109 r">nse</span>.<span class="i">Message</span>, <span class="s">&quot;ProcessingFile&quot;</span>, <span class="r109 r">nse</span>));
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">IO</span>.<span class="i">IOException</span> <span id="r110 rd" class="r110 r">ioe</span>)
            {
                <span class="i">WriteError</span>(<span class="i">BuildErrorRecord</span>(<span class="i">MatchStringStrings</span>.<span class="i">FileReadError</span>, <span class="r101 r">filename</span>, <span class="r110 r">ioe</span>.<span class="i">Message</span>, <span class="s">&quot;ProcessingFile&quot;</span>, <span class="r110 r">ioe</span>));
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityException</span> <span id="r111 rd" class="r111 r">se</span>)
            {
                <span class="i">WriteError</span>(<span class="i">BuildErrorRecord</span>(<span class="i">MatchStringStrings</span>.<span class="i">FileReadError</span>, <span class="r101 r">filename</span>, <span class="r111 r">se</span>.<span class="i">Message</span>, <span class="s">&quot;ProcessingFile&quot;</span>, <span class="r111 r">se</span>));
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">UnauthorizedAccessException</span> <span id="r112 rd" class="r112 r">uae</span>)
            {
                <span class="i">WriteError</span>(<span class="i">BuildErrorRecord</span>(<span class="i">MatchStringStrings</span>.<span class="i">FileReadError</span>, <span class="r101 r">filename</span>, <span class="r112 r">uae</span>.<span class="i">Message</span>, <span class="s">&quot;ProcessingFile&quot;</span>, <span class="r112 r">uae</span>));
            }
 
            <b>return</b> <span class="r103 r">foundMatch</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Emit any objects which have been queued up, and clear the queue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r">contextTracker</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The context tracker to operate on.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Whether or not any objects were emitted.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="f081599bef877413" href="../../R/f081599bef877413.html" target="n" data-glyph="76,1" class="i method">FlushTrackerQueue</a>(<a href="#9915001f7a00123d" class="t t">IContextTracker</a> <span id="r113 rd" class="r113 r">contextTracker</span>)
        {
            <span class="c">// Do we even have any matches to emit?</span>
            <b>if</b> (<span class="r113 r">contextTracker</span>.<a href="#94bb214f300f57ef" class="i property">EmitQueue</a>.<span class="i">Count</span> &lt; 1)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<a href="#0f3367f0218ae5d1" class="i property">Raw</a>)
            {
                <b>foreach</b> (<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r114 rd" class="r114 r">match</span> <b>in</b> <span class="r113 r">contextTracker</span>.<a href="#94bb214f300f57ef" class="i property">EmitQueue</a>)
                {
                    <span class="i">WriteObject</span>(<span class="r114 r">match</span>.<a href="#df1b0dad44591830" class="i property">Line</a>);
                }
            }
            <b>else</b> <b>if</b> (<a href="#8093aff4730de76f" class="i property">Quiet</a> &amp;&amp; !<a href="#f06692413bc12087" class="i property">List</a>)
            {
                <span class="i">WriteObject</span>(<b>true</b>);
            }
            <b>else</b> <b>if</b> (<a href="#f06692413bc12087" class="i property">List</a>)
            {
                <span class="i">WriteObject</span>(<span class="r113 r">contextTracker</span>.<a href="#94bb214f300f57ef" class="i property">EmitQueue</a>[0]);
            }
            <b>else</b>
            {
                <b>foreach</b> (<a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r115 rd" class="r115 r">match</span> <b>in</b> <span class="r113 r">contextTracker</span>.<a href="#94bb214f300f57ef" class="i property">EmitQueue</a>)
                {
                    <span class="i">WriteObject</span>(<span class="r115 r">match</span>);
                }
            }
 
            <span class="r113 r">contextTracker</span>.<a href="#94bb214f300f57ef" class="i property">EmitQueue</a>.<span class="i">Clear</span>();
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Complete processing. Emits any objects which have been queued up</span>
        <span class="c">///</span><span class="c"> due to -context tracking.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="b6d16ad313f900b7" href="../../R/b6d16ad313f900b7.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <span class="c">// Check for a leftover match that was still tracking context.</span>
            <a href="#9d779ab2ddd52583" class="i field">_globalContextTracker</a>.<a href="#3c221ca5691ce303" class="i method">TrackEOF</a>();
            <b>if</b> (!<a href="#c11c7e1ae82b898a" class="i field">_doneProcessing</a>)
            {
                <a href="#f081599bef877413" class="i method">FlushTrackerQueue</a>(<a href="#9d779ab2ddd52583" class="i field">_globalContextTracker</a>);
            }
        }
 
        <b>private bool</b> <a id="be50445a8a0237d5" href="../../R/be50445a8a0237d5.html" target="n" data-glyph="76,1" class="i method">DoMatch</a>(<b>string</b> <span id="r116 rd" class="r116 r">operandString</span>, <b>out</b> <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r117 rd" class="r117 r">matchResult</span>)
        {
            <b>return</b> <a href="#5e73935bcef107ff" class="i method">DoMatchWorker</a>(<span class="r116 r">operandString</span>, <b>null</b>, <b>out</b> <span class="r117 r">matchResult</span>);
        }
 
        <b>private bool</b> <a id="6bf147b38b5d2cf7" href="../../R/6bf147b38b5d2cf7.html" target="n" data-glyph="76,1" class="i method">DoMatch</a>(<b>object</b> <span id="r118 rd" class="r118 r">operand</span>, <b>out</b> <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r119 rd" class="r119 r">matchResult</span>, <b>out string</b> <span id="r120 rd" class="r120 r">operandString</span>)
        {
            <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r121 rd" class="r121 r">matchInfo</span> = <span class="r118 r">operand</span> <b>as</b> <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a>;
            <b>if</b> (<span class="r121 r">matchInfo</span> != <b>null</b>)
            {
                <span class="c">// We&#39;re operating in filter mode. Match</span>
                <span class="c">// against the provided MatchInfo&#39;s line.</span>
                <span class="c">// If the user has specified context tracking,</span>
                <span class="c">// inform them that it is not allowed in filter</span>
                <span class="c">// mode and disable it. Also, reset the global</span>
                <span class="c">// context tracker used for processing pipeline</span>
                <span class="c">// objects to use the new settings.</span>
                <span class="r120 r">operandString</span> = <span class="r121 r">matchInfo</span>.<a href="#df1b0dad44591830" class="i property">Line</a>;
 
                <b>if</b> (<a href="#4fd550c78b125bd3" class="i field">_preContext</a> &gt; 0 || <a href="#465f2cee1b966c53" class="i field">_postContext</a> &gt; 0)
                {
                    <a href="#4fd550c78b125bd3" class="i field">_preContext</a> = 0;
                    <a href="#465f2cee1b966c53" class="i field">_postContext</a> = 0;
                    <a href="#9d779ab2ddd52583" class="i field">_globalContextTracker</a> = <b>new</b> <a href="#71843497cb0c1172" class="t constructor">ContextTracker</a>(<a href="#4fd550c78b125bd3" class="i field">_preContext</a>, <a href="#465f2cee1b966c53" class="i field">_postContext</a>);
                    <a href="#f5ae6afaa3996cec" class="i method">WarnFilterContext</a>();
                }
            }
            <b>else</b>
            {
                <span class="r120 r">operandString</span> = (<b>string</b>)<a href="/System.Management.Automation/A.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r118 r">operand</span>, <b>typeof</b>(<b>string</b>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
 
            <b>return</b> <a href="#5e73935bcef107ff" class="i method">DoMatchWorker</a>(<span class="r120 r">operandString</span>, <span class="r121 r">matchInfo</span>, <b>out</b> <span class="r119 r">matchResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check the operand and see if it matches, if this.quiet is not set, then</span>
        <span class="c">///</span><span class="c"> return a partially populated MatchInfo object with Line, Pattern, IgnoreCase set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r122 r">operandString</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The result of converting operand to a string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r123 r">matchInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The input object in filter mode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r124 r">matchResult</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The match info object - this will be null if this.quiet is set.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the input object matched.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="5e73935bcef107ff" href="../../R/5e73935bcef107ff.html" target="n" data-glyph="76,1" class="i method">DoMatchWorker</a>(<b>string</b> <span id="r122 rd" class="r122 r">operandString</span>, <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r123 rd" class="r123 r">matchInfo</span>, <b>out</b> <a href="#ecfd8061bec2ec5a" class="t t">MatchInfo</a> <span id="r124 rd" class="r124 r">matchResult</span>)
        {
            <b>bool</b> <span id="r125 rd" class="r125 r">gotMatch</span> = <b>false</b>;
            <span class="i">Match</span>[] <span id="r126 rd" class="r126 r">matches</span> = <b>null</b>;
            <b>int</b> <span id="r127 rd" class="r127 r">patternIndex</span> = 0;
            <span class="r124 r">matchResult</span> = <b>null</b>;
 
            <span class="i">List</span>&lt;<b>int</b>&gt; <span id="r128 rd" class="r128 r">indexes</span> = <b>null</b>;
            <span class="i">List</span>&lt;<b>int</b>&gt; <span id="r129 rd" class="r129 r">lengths</span> = <b>null</b>;
 
            <b>bool</b> <span id="r130 rd" class="r130 r">shouldEmphasize</span> = !<a href="#11606e8ee3902d11" class="i property">NoEmphasis</a> &amp;&amp; <a href="/System.Management.Automation/A.html#01105ebe2065fe1b" class="i property">Host</a>.<a href="/System.Management.Automation/A.html#f3c3c89a5e9dd42a" class="i property">UI</a>.<a href="/System.Management.Automation/A.html#db1bed8dd5c8b0b2" class="i property">SupportsVirtualTerminal</a>;
 
            <span class="c">// If Emphasize is set and VT is supported,</span>
            <span class="c">// the lengths and starting indexes of regex matches</span>
            <span class="c">// need to be passed in to the matchInfo object.</span>
            <b>if</b> (<span class="r130 r">shouldEmphasize</span>)
            {
                <span class="r128 r">indexes</span> = <b>new</b> <span class="i">List</span>&lt;<b>int</b>&gt;();
                <span class="r129 r">lengths</span> = <b>new</b> <span class="i">List</span>&lt;<b>int</b>&gt;();
            }
 
            <b>if</b> (!<a href="#9a9c161722d115ee" class="i property">SimpleMatch</a>)
            {
                <b>while</b> (<span class="r127 r">patternIndex</span> &lt; <a href="#d0d38b45d942d4c7" class="i property">Pattern</a>.<span class="i">Length</span>)
                {
                    <span class="i">Regex</span> <span id="r131 rd" class="r131 r">r</span> = <a href="#5892e3f7fd3098a8" class="i field">_regexPattern</a>[<span class="r127 r">patternIndex</span>];
 
                    <span class="c">// Only honor allMatches if notMatch is not set,</span>
                    <span class="c">// since it&#39;s a fairly expensive operation and</span>
                    <span class="c">// notMatch takes precedent over allMatch.</span>
                    <b>if</b> (<a href="#24baac8e5664e5c2" class="i property">AllMatches</a> &amp;&amp; !<a href="#8d62ef237df7a20a" class="i property">NotMatch</a>)
                    {
                        <span class="i">MatchCollection</span> <span id="r132 rd" class="r132 r">mc</span> = <span class="r131 r">r</span>.<span class="i">Matches</span>(<span class="r122 r">operandString</span>);
                        <b>if</b> (<span class="r132 r">mc</span>.<span class="i">Count</span> &gt; 0)
                        {
                            <span class="r126 r">matches</span> = <b>new</b> <span class="i">Match</span>[<span class="r132 r">mc</span>.<span class="i">Count</span>];
                            ((<span class="i">ICollection</span>)<span class="r132 r">mc</span>).<span class="i">CopyTo</span>(<span class="r126 r">matches</span>, 0);
 
                            <b>if</b> (<span class="r130 r">shouldEmphasize</span>)
                            {
                                <b>foreach</b> (<span class="i">Match</span> <span id="r133 rd" class="r133 r">match</span> <b>in</b> <span class="r126 r">matches</span>)
                                {
                                    <span class="r128 r">indexes</span>.<span class="i">Add</span>(<span class="r133 r">match</span>.<span class="i">Index</span>);
                                    <span class="r129 r">lengths</span>.<span class="i">Add</span>(<span class="r133 r">match</span>.<span class="i">Length</span>);
                                }
                            }
 
                            <span class="r125 r">gotMatch</span> = <b>true</b>;
                        }
                    }
                    <b>else</b>
                    {
                        <span class="i">Match</span> <span id="r134 rd" class="r134 r">match</span> = <span class="r131 r">r</span>.<span class="i">Match</span>(<span class="r122 r">operandString</span>);
                        <span class="r125 r">gotMatch</span> = <span class="r134 r">match</span>.<span class="i">Success</span>;
 
                        <b>if</b> (<span class="r134 r">match</span>.<span class="i">Success</span>)
                        {
                            <b>if</b> (<span class="r130 r">shouldEmphasize</span>)
                            {
                                <span class="r128 r">indexes</span>.<span class="i">Add</span>(<span class="r134 r">match</span>.<span class="i">Index</span>);
                                <span class="r129 r">lengths</span>.<span class="i">Add</span>(<span class="r134 r">match</span>.<span class="i">Length</span>);
                            }
 
                            <span class="r126 r">matches</span> = <b>new</b> <span class="i">Match</span>[] { <span class="r134 r">match</span> };
                        }
                    }
 
                    <b>if</b> (<span class="r125 r">gotMatch</span>)
                    {
                        <b>break</b>;
                    }
 
                    <span class="r127 r">patternIndex</span>++;
                }
            }
            <b>else</b>
            {
                <b>while</b> (<span class="r127 r">patternIndex</span> &lt; <a href="#d0d38b45d942d4c7" class="i property">Pattern</a>.<span class="i">Length</span>)
                {
                    <b>string</b> <span id="r135 rd" class="r135 r">pat</span> = <a href="#d0d38b45d942d4c7" class="i property">Pattern</a>[<span class="r127 r">patternIndex</span>];
 
                    <b>int</b> <span id="r136 rd" class="r136 r">index</span> = <a href="#4c3e49151444671d" class="i field">_cultureInfoIndexOf</a>(<span class="r122 r">operandString</span>, <span class="r135 r">pat</span>, 0, <span class="r122 r">operandString</span>.<span class="i">Length</span>, <a href="#c58a1847e8413d79" class="i field">_compareOptions</a>);
                    <b>if</b> (<span class="r136 r">index</span> &gt;= 0)
                    {
                        <b>if</b> (<span class="r130 r">shouldEmphasize</span>)
                        {
                            <span class="r128 r">indexes</span>.<span class="i">Add</span>(<span class="r136 r">index</span>);
                            <span class="r129 r">lengths</span>.<span class="i">Add</span>(<span class="r135 r">pat</span>.<span class="i">Length</span>);
                        }
 
                        <span class="r125 r">gotMatch</span> = <b>true</b>;
                        <b>break</b>;
                    }
 
                    <span class="r127 r">patternIndex</span>++;
                }
            }
 
            <b>if</b> (<a href="#8d62ef237df7a20a" class="i property">NotMatch</a>)
            {
                <span class="r125 r">gotMatch</span> = !<span class="r125 r">gotMatch</span>;
 
                <span class="c">// If notMatch was specified with multiple</span>
                <span class="c">// patterns, then *none* of the patterns</span>
                <span class="c">// matched and any pattern could be picked</span>
                <span class="c">// to report in MatchInfo. However, that also</span>
                <span class="c">// means that patternIndex will have been</span>
                <span class="c">// incremented past the end of the pattern array.</span>
                <span class="c">// So reset it to select the first pattern.</span>
                <span class="r127 r">patternIndex</span> = 0;
            }
 
            <b>if</b> (<span class="r125 r">gotMatch</span>)
            {
                <span class="c">// if we were passed a MatchInfo object as the operand,</span>
                <span class="c">// we&#39;re operating in filter mode.</span>
                <b>if</b> (<span class="r123 r">matchInfo</span> != <b>null</b>)
                {
                    <span class="c">// If the original MatchInfo was tracking context,</span>
                    <span class="c">// we need to copy it and disable display context,</span>
                    <span class="c">// since we can&#39;t guarantee it will be displayed</span>
                    <span class="c">// correctly when filtered.</span>
                    <b>if</b> (<span class="r123 r">matchInfo</span>.<a href="#e390961f551a3a9b" class="i property">Context</a> != <b>null</b>)
                    {
                        <span class="r124 r">matchResult</span> = <span class="r123 r">matchInfo</span>.<a href="#17204eae75043065" class="i method">Clone</a>();
                        <span class="r124 r">matchResult</span>.<a href="#e390961f551a3a9b" class="i property">Context</a>.<a href="#4dbca262af59f815" class="i property">DisplayPreContext</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
                        <span class="r124 r">matchResult</span>.<a href="#e390961f551a3a9b" class="i property">Context</a>.<a href="#9805fdc40236ed96" class="i property">DisplayPostContext</a> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;();
                    }
                    <b>else</b>
                    {
                        <span class="c">// Otherwise, just pass the object as is.</span>
                        <span class="r124 r">matchResult</span> = <span class="r123 r">matchInfo</span>;
                    }
 
                    <b>return</b> <b>true</b>;
                }
 
                <span class="c">// otherwise construct and populate a new MatchInfo object</span>
                <span class="r124 r">matchResult</span> = <span class="r130 r">shouldEmphasize</span>
                    ? <b>new</b> <span class="t">MatchInfo</span>(<span class="r128 r">indexes</span>, <span class="r129 r">lengths</span>)
                    : <b>new</b> <a href="#3f1fd1441b84994a" class="t constructor">MatchInfo</a>();
                <span class="r124 r">matchResult</span>.<a href="#4d58edc0930cae89" class="i property">IgnoreCase</a> = !<a href="#ffe8d329cff3d980" class="i property">CaseSensitive</a>;
                <span class="r124 r">matchResult</span>.<a href="#df1b0dad44591830" class="i property">Line</a> = <span class="r122 r">operandString</span>;
                <span class="r124 r">matchResult</span>.<a href="#0bf851bc862e6e05" class="i property">Pattern</a> = <a href="#d0d38b45d942d4c7" class="i property">Pattern</a>[<span class="r127 r">patternIndex</span>];
 
                <b>if</b> (<a href="#4fd550c78b125bd3" class="i field">_preContext</a> &gt; 0 || <a href="#465f2cee1b966c53" class="i field">_postContext</a> &gt; 0)
                {
                    <span class="r124 r">matchResult</span>.<a href="#e390961f551a3a9b" class="i property">Context</a> = <b>new</b> <a href="#a42239dc05d84e44" class="t constructor">MatchInfoContext</a>();
                }
 
                <span class="c">// Matches should be an empty list, rather than null,</span>
                <span class="c">// in the cases of notMatch and simpleMatch.</span>
                <span class="r124 r">matchResult</span>.<a href="#5784cd2209db4b55" class="i property">Matches</a> = <span class="r126 r">matches</span> ?? <span class="i">Array</span>.<span class="i">Empty</span>&lt;<span class="i">Match</span>&gt;();
 
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a list or resolved file paths.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r137 r">filePaths</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The filePaths to resolve.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r138 r">isLiteralPath</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the wildcard resolution should not be attempted.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The resolved (absolute) paths.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="adbc15b647735efe" href="../../R/adbc15b647735efe.html" target="n" data-glyph="76,1" class="i method">ResolveFilePaths</a>(<b>string</b>[] <span id="r137 rd" class="r137 r">filePaths</span>, <b>bool</b> <span id="r138 rd" class="r138 r">isLiteralPath</span>)
        {
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r139 rd" class="r139 r">allPaths</span> = <b>new</b>();
 
            <b>foreach</b> (<b>string</b> <span id="r140 rd" class="r140 r">path</span> <b>in</b> <span class="r137 r">filePaths</span>)
            {
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r141 rd" class="r141 r">resolvedPaths</span>;
                <a href="/System.Management.Automation/A.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r142 rd" class="r142 r">provider</span>;
                <b>if</b> (<span class="r138 r">isLiteralPath</span>)
                {
                    <span class="r141 r">resolvedPaths</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
                    <b>string</b> <span id="r143 rd" class="r143 r">resolvedPath</span> = <a href="/System.Management.Automation/A.html#5078d443148de142" class="i property">SessionState</a>.<a href="/System.Management.Automation/A.html#3390cfbbdcffb036" class="i property">Path</a>.<span class="i">GetUnresolvedProviderPathFromPSPath</span>(<span class="r140 r">path</span>, <b>out</b> <span class="r142 r">provider</span>, <b>out _</b>);
                    <span class="r141 r">resolvedPaths</span>.<span class="i">Add</span>(<span class="r143 r">resolvedPath</span>);
                }
                <b>else</b>
                {
                    <span class="r141 r">resolvedPaths</span> = <span class="i">GetResolvedProviderPathFromPSPath</span>(<span class="r140 r">path</span>, <b>out</b> <span class="r142 r">provider</span>);
                }
 
                <b>if</b> (!<span class="r142 r">provider</span>.<span class="i">NameEquals</span>(<a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="k">base</a>.<span class="i">Context</span>.<span class="i">ProviderNames</span>.<span class="i">FileSystem</span>))
                {
                    <span class="c">// &quot;The current provider ({0}) cannot open a file&quot;</span>
                    <span class="i">WriteError</span>(<span class="i">BuildErrorRecord</span>(<span class="i">MatchStringStrings</span>.<span class="i">FileOpenError</span>, <span class="r142 r">provider</span>.<span class="i">FullName</span>, <span class="s">&quot;ProcessingFile&quot;</span>, <b>null</b>));
                    <b>continue</b>;
                }
 
                <span class="r139 r">allPaths</span>.<span class="i">AddRange</span>(<span class="r141 r">resolvedPaths</span>);
            }
 
            <b>return</b> <span class="r139 r">allPaths</span>;
        }
 
        <b>private static</b> <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="02178591a1de5e2c" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">BuildErrorRecord</a>(<b>string</b> <span id="r144 rd" class="r144 r">messageId</span>, <b>string</b> <span id="r145 rd" class="r145 r">argument</span>, <b>string</b> <span id="r146 rd" class="r146 r">errorId</span>, <span class="i">Exception</span> <span id="r147 rd" class="r147 r">innerException</span>)
        {
            <b>return</b> <a href="#cc3cd520b7c227d2" class="i method">BuildErrorRecord</a>(<span class="r144 r">messageId</span>, <b>new</b> <b>object</b>[] { <span class="r145 r">argument</span> }, <span class="r146 r">errorId</span>, <span class="r147 r">innerException</span>);
        }
 
        <b>private static</b> <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="e19ad872f77281ac" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">BuildErrorRecord</a>(<b>string</b> <span id="r148 rd" class="r148 r">messageId</span>, <b>string</b> <span id="r149 rd" class="r149 r">arg0</span>, <b>string</b> <span id="r150 rd" class="r150 r">arg1</span>, <b>string</b> <span id="r151 rd" class="r151 r">errorId</span>, <span class="i">Exception</span> <span id="r152 rd" class="r152 r">innerException</span>)
        {
            <b>return</b> <a href="#cc3cd520b7c227d2" class="i method">BuildErrorRecord</a>(<span class="r148 r">messageId</span>, <b>new</b> <b>object</b>[] { <span class="r149 r">arg0</span>, <span class="r150 r">arg1</span> }, <span class="r151 r">errorId</span>, <span class="r152 r">innerException</span>);
        }
 
        <b>private static</b> <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="cc3cd520b7c227d2" href="../../R/cc3cd520b7c227d2.html" target="n" data-glyph="76,1" class="i method">BuildErrorRecord</a>(<b>string</b> <span id="r153 rd" class="r153 r">messageId</span>, <b>object</b>[] <span id="r154 rd" class="r154 r">arguments</span>, <b>string</b> <span id="r155 rd" class="r155 r">errorId</span>, <span class="i">Exception</span> <span id="r156 rd" class="r156 r">innerException</span>)
        {
            <b>string</b> <span id="r157 rd" class="r157 r">fmtedMsg</span> = <span class="i">StringUtil</span>.<span class="i">Format</span>(<span class="r153 r">messageId</span>, <span class="r154 r">arguments</span>);
            <span class="i">ArgumentException</span> <span id="r158 rd" class="r158 r">e</span> = <b>new</b>(<span class="r157 r">fmtedMsg</span>, <span class="r156 r">innerException</span>);
            <b>return</b> <b>new</b> <span class="t">ErrorRecord</span>(<span class="r158 r">e</span>, <span class="r155 r">errorId</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <b>null</b>);
        }
 
        <b>private void</b> <a id="f5ae6afaa3996cec" href="../../R/f5ae6afaa3996cec.html" target="n" data-glyph="76,1" class="i method">WarnFilterContext</a>()
        {
            <b>string</b> <span id="r159 rd" class="r159 r">msg</span> = <span class="i">MatchStringStrings</span>.<span class="i">FilterContextWarning</span>;
            <span class="i">WriteWarning</span>(<span class="r159 r">msg</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Magic class that works around the limitations on ToString() for FileInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="44b67b40561d8fbe" href="../../R/../../0000000000.html" target="n" data-glyph="4,1" class="t t"><span id="40db1d20bed4511e">FileinfoToStringAttribute</span></a> : <a href="/System.Management.Automation/A.html#80472519ecf33cf1" class="t t">ArgumentTransformationAttribute</a>
        {
            <b>public override object</b> <a id="8c7a90a23977b5f0" href="../../R/8c7a90a23977b5f0.html" target="n" data-glyph="72,2" class="i method">Transform</a>(<a href="/System.Management.Automation/A.html#e9f6dd7d61246066" class="t t">EngineIntrinsics</a> <span id="r160 rd" class="r160 r">engineIntrinsics</span>, <b>object</b> <span id="r161 rd" class="r161 r">inputData</span>)
            {
                <b>object</b> <span id="r162 rd" class="r162 r">result</span> = <span class="r161 r">inputData</span>;
 
                <b>if</b> (<span class="r162 r">result</span> <b>is</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r163 rd" class="r163 r">mso</span>)
                {
                    <span class="r162 r">result</span> = <span class="r163 r">mso</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a>;
                }
 
                <span class="i">FileInfo</span> <span id="r164 rd" class="r164 r">fileInfo</span>;
 
                <span class="c">// Handle an array of elements...</span>
                <b>if</b> (<span class="r162 r">result</span> <b>is</b> <span class="i">IList</span> <span id="r165 rd" class="r165 r">argList</span>)
                {
                    <b>object</b>[] <span id="r166 rd" class="r166 r">resultList</span> = <b>new</b> <b>object</b>[<span class="r165 r">argList</span>.<span class="i">Count</span>];
 
                    <b>for</b> (<b>int</b> <span id="r167 rd" class="r167 r">i</span> = 0; <span class="r167 r">i</span> &lt; <span class="r165 r">argList</span>.<span class="i">Count</span>; <span class="r167 r">i</span>++)
                    {
                        <b>object</b> <span id="r168 rd" class="r168 r">element</span> = <span class="r165 r">argList</span>[<span class="r167 r">i</span>];
 
                        <span class="r163 r">mso</span> = <span class="r168 r">element</span> <b>as</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
                        <b>if</b> (<span class="r163 r">mso</span> != <b>null</b>)
                        {
                            <span class="r168 r">element</span> = <span class="r163 r">mso</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a>;
                        }
 
                        <span class="r164 r">fileInfo</span> = <span class="r168 r">element</span> <b>as</b> <span class="i">FileInfo</span>;
                        <span class="r166 r">resultList</span>[<span class="r167 r">i</span>] = <span class="r164 r">fileInfo</span>?.<span class="i">FullName</span> ?? <span class="r168 r">element</span>;
                    }
 
                    <b>return</b> <span class="r166 r">resultList</span>;
                }
 
                <span class="c">// Handle the singleton case...</span>
                <span class="r164 r">fileInfo</span> = <span class="r162 r">result</span> <b>as</b> <span class="i">FileInfo</span>;
                <b>if</b> (<span class="r164 r">fileInfo</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r164 r">fileInfo</span>.<span class="i">FullName</span>;
                }
 
                <b>return</b> <span class="r161 r">inputData</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check whether the supplied name meets the include/exclude criteria.</span>
        <span class="c">///</span><span class="c"> That is - it&#39;s on the include list if there is one and not on</span>
        <span class="c">///</span><span class="c"> the exclude list if there was one of those.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r169 r">filename</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The filename to test.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the filename is acceptable.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="1eefb781504042db" href="../../R/1eefb781504042db.html" target="n" data-glyph="76,1" class="i method">MeetsIncludeExcludeCriteria</a>(<b>string</b> <span id="r169 rd" class="r169 r">filename</span>)
        {
            <b>bool</b> <span id="r170 rd" class="r170 r">ok</span> = <b>false</b>;
 
            <span class="c">// see if the file is on the include list...</span>
            <b>if</b> (<a href="#048b30740252d8a8" class="i field">_include</a> != <b>null</b>)
            {
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r171 rd" class="r171 r">patternItem</span> <b>in</b> <a href="#048b30740252d8a8" class="i field">_include</a>)
                {
                    <b>if</b> (<span class="r171 r">patternItem</span>.<span class="i">IsMatch</span>(<span class="r169 r">filename</span>))
                    {
                        <span class="r170 r">ok</span> = <b>true</b>;
                        <b>break</b>;
                    }
                }
            }
            <b>else</b>
            {
                <span class="r170 r">ok</span> = <b>true</b>;
            }
 
            <b>if</b> (!<span class="r170 r">ok</span>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// now see if it&#39;s on the exclude list...</span>
            <b>if</b> (<a href="#0a453c5922563b7f" class="i field">_exclude</a> != <b>null</b>)
            {
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r172 rd" class="r172 r">patternItem</span> <b>in</b> <a href="#0a453c5922563b7f" class="i field">_exclude</a>)
                {
                    <b>if</b> (<span class="r172 r">patternItem</span>.<span class="i">IsMatch</span>(<span class="r169 r">filename</span>))
                    {
                        <span class="r170 r">ok</span> = <b>false</b>;
                        <b>break</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r170 r">ok</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Get list of valid culture names for ValidateSet attribute.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="4081ae4947e86c05" href="../../R/4081ae4947e86c05.html" target="n" data-glyph="0,0" class="t t"><span id="5c10afac4a87708d">ValidateMatchStringCultureNamesGenerator</span></a> : <a href="/System.Management.Automation/A.html#261d29581b0d1a37" class="t t">IValidateSetValuesGenerator</a>
    {
        <b>string</b>[] <a href="/System.Management.Automation/A.html#261d29581b0d1a37" class="t t">IValidateSetValuesGenerator</a>.<a href="/System.Management.Automation/A.html#c18da8b9d383a816" class="i method">GetValidValues</a>()
        {
            <b>var</b> <span id="r173 rd" class="r173 r">cultures</span> = <span class="i">CultureInfo</span>.<span class="i">GetCultures</span>(<span class="i">CultureTypes</span>.<span class="i">AllCultures</span>);
            <b>var</b> <span id="r174 rd" class="r174 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(<span class="r173 r">cultures</span>.<span class="i">Length</span> + 3);
            <span class="r174 r">result</span>.<span class="i">Add</span>(<a href="#730ac6500e48376f" class="t t">SelectStringCommand</a>.<a href="#8b79e299e70919cd" class="i field">OrdinalCultureName</a>);
            <span class="r174 r">result</span>.<span class="i">Add</span>(<a href="#730ac6500e48376f" class="t t">SelectStringCommand</a>.<a href="#807910e8b2fb97ab" class="i field">InvariantCultureName</a>);
            <span class="r174 r">result</span>.<span class="i">Add</span>(<a href="#730ac6500e48376f" class="t t">SelectStringCommand</a>.<a href="#36735f1481ddf924" class="i field">CurrentCultureName</a>);
            <b>foreach</b> (<b>var</b> <span id="r175 rd" class="r175 r">cultureInfo</span> <b>in</b> <span class="r173 r">cultures</span>)
            {
                <span class="r174 r">result</span>.<span class="i">Add</span>(<span class="r175 r">cultureInfo</span>.<span class="i">Name</span>);
            }
 
            <b>return</b> <span class="r174 r">result</span>.<span class="i">ToArray</span>();
        }
    }
}
</pre></td></tr></table></div></body></html>
