<!DOCTYPE html>
<html><head><title>AddMember.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(602);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility/commands/utility/AddMember.cs" target="_top">commands\utility\AddMember.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.PowerShell.Commands.Utility" target="_top">src\Microsoft.PowerShell.Commands.Utility\Microsoft.PowerShell.Commands.Utility.csproj</a> (Microsoft.PowerShell.Commands.Utility)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class implements get-member command.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="/System.Management.Automation/A.html#ae1744bf7bfad73f" class="i field">Add</a>, <span class="s">&quot;Member&quot;</span>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;TypeNameSet&quot;</span>,
        <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkID=2097109&quot;</span>, <span class="i">RemotingCapability</span> = <a href="/System.Management.Automation/A.html#59e8ed9184274cab" class="t t">RemotingCapability</a>.<a href="/System.Management.Automation/A.html#5111d4e307f1cb5a" class="i field">None</a>)]
    <b>public class</b> <a id="1610f2f825d7378e" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="5ab1ced8bc0a49cd">AddMemberCommand</span></a> : <a href="/System.Management.Automation/A.html#30543a6971fed1fc" class="t t">PSCmdlet</a>
    {
        <b>private static readonly object</b> <a id="726094dc4749c352" href="../../R/726094dc4749c352.html" target="n" data-glyph="46,1" class="i field">s_notSpecified</a> = <b>new</b>();
 
        <b>private static bool</b> <a id="d874188be6c51186" href="../../R/d874188be6c51186.html" target="n" data-glyph="76,1" class="i method">HasBeenSpecified</a>(<b>object</b> <span id="r0 rd" class="r0 r">obj</span>)
        {
            <b>return</b> !<span class="i n">System</span>.<span class="i">Object</span>.<span class="i">ReferenceEquals</span>(<span class="r0 r">obj</span>, <a href="#726094dc4749c352" class="i field">s_notSpecified</a>);
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="7991cd3911eed905" href="../../R/7991cd3911eed905.html" target="n" data-glyph="46,1" class="i field">_inputObject</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to add a member to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;MemberSet&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;TypeNameSet&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#16e38e140c598893" class="i field">NotePropertySingleMemberSet</a>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#09cab67706d8553c" class="i field">NotePropertyMultiMemberSet</a>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="008391e6ccf12858" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">InputObject</a>
        {
            <b>get</b> { <b>return</b> <a href="#7991cd3911eed905" class="i field">_inputObject</a>; }
 
            <b>set</b> { <a href="#7991cd3911eed905" class="i field">_inputObject</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a> <a id="1edfa315891a9936" href="../../R/1edfa315891a9936.html" target="n" data-glyph="46,1" class="i field">_memberType</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The member type of to be added.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;MemberSet&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;Type&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a> <a id="1451b55826156b58" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">MemberType</a>
        {
            <b>get</b> { <b>return</b> <a href="#1edfa315891a9936" class="i field">_memberType</a>; }
 
            <b>set</b> { <a href="#1edfa315891a9936" class="i field">_memberType</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="74b5dc3adf61e3d1" href="../../R/74b5dc3adf61e3d1.html" target="n" data-glyph="46,1" class="i field">_memberName</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the new member.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;MemberSet&quot;</span>)]
        <b>public string</b> <a id="a702cb82d03d14db" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b> { <b>return</b> <a href="#74b5dc3adf61e3d1" class="i field">_memberName</a>; }
 
            <b>set</b> { <a href="#74b5dc3adf61e3d1" class="i field">_memberName</a> = <b>value</b>; }
        }
 
        <b>private object</b> <a id="68e6dd1e5eff34e9" href="../../R/68e6dd1e5eff34e9.html" target="n" data-glyph="46,1" class="i field">_value1</a> = <a href="#726094dc4749c352" class="i field">s_notSpecified</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> First value of the new member. The meaning of this value changes according to the member type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 2, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;MemberSet&quot;</span>)]
        <b>public object</b> <a id="65e4d0eb8f8cec51" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Value</a>
        {
            <b>get</b> { <b>return</b> <a href="#68e6dd1e5eff34e9" class="i field">_value1</a>; }
 
            <b>set</b> { <a href="#68e6dd1e5eff34e9" class="i field">_value1</a> = <b>value</b>; }
        }
 
        <b>private object</b> <a id="1590ab61adc4d40e" href="../../R/1590ab61adc4d40e.html" target="n" data-glyph="46,1" class="i field">_value2</a> = <a href="#726094dc4749c352" class="i field">s_notSpecified</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Second value of the new member. The meaning of this value changes according to the member type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 3, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;MemberSet&quot;</span>)]
        <b>public object</b> <a id="f315202501288465" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SecondValue</a>
        {
            <b>get</b> { <b>return</b> <a href="#1590ab61adc4d40e" class="i field">_value2</a>; }
 
            <b>set</b> { <a href="#1590ab61adc4d40e" class="i field">_value2</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="1047227c544731cb" href="../../R/1047227c544731cb.html" target="n" data-glyph="46,1" class="i field">_typeName</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add new type name to the specified object for TypeNameSet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;TypeNameSet&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;MemberSet&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#16e38e140c598893" class="i field">NotePropertySingleMemberSet</a>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#09cab67706d8553c" class="i field">NotePropertyMultiMemberSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="441e1cae1d330c5a" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">TypeName</a>
        {
            <b>get</b> { <b>return</b> <a href="#1047227c544731cb" class="i field">_typeName</a>; }
 
            <b>set</b> { <a href="#1047227c544731cb" class="i field">_typeName</a> = <b>value</b>; }
        }
 
        <b>private bool</b> <a id="b79117a23ade2535" href="../../R/b79117a23ade2535.html" target="n" data-glyph="46,1" class="i field">_force</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if we should overwrite a possibly existing member.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;MemberSet&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#16e38e140c598893" class="i field">NotePropertySingleMemberSet</a>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#09cab67706d8553c" class="i field">NotePropertyMultiMemberSet</a>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="34bc54a8ae3e7c57" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Force</a>
        {
            <b>get</b> { <b>return</b> <a href="#b79117a23ade2535" class="i field">_force</a>; }
 
            <b>set</b> { <a href="#b79117a23ade2535" class="i field">_force</a> = <b>value</b>; }
        }
 
        <b>private bool</b> <a id="60a66358929a4e7e" href="../../R/60a66358929a4e7e.html" target="n" data-glyph="46,1" class="i field">_passThru</a> <span class="c">/* = false */</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the parameter -passThru which states output from the command should be placed in the pipeline.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;MemberSet&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;TypeNameSet&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#16e38e140c598893" class="i field">NotePropertySingleMemberSet</a>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#09cab67706d8553c" class="i field">NotePropertyMultiMemberSet</a>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="86f481386ccbb811" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">PassThru</a>
        {
            <b>get</b> { <b>return</b> <a href="#60a66358929a4e7e" class="i field">_passThru</a>; }
 
            <b>set</b> { <a href="#60a66358929a4e7e" class="i field">_passThru</a> = <b>value</b>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Simplifying NoteProperty Declaration
 
        <b>private const string</b> <a id="16e38e140c598893" href="../../R/16e38e140c598893.html" target="n" data-glyph="10,1" class="i field">NotePropertySingleMemberSet</a> = <span class="s">&quot;NotePropertySingleMemberSet&quot;</span>;
        <b>private const string</b> <a id="09cab67706d8553c" href="../../R/09cab67706d8553c.html" target="n" data-glyph="10,1" class="i field">NotePropertyMultiMemberSet</a> = <span class="s">&quot;NotePropertyMultiMemberSet&quot;</span>;
 
        <b>private string</b> <a id="36b8f658e44d49a6" href="../../R/36b8f658e44d49a6.html" target="n" data-glyph="46,1" class="i field">_notePropertyName</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the new NoteProperty member.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#16e38e140c598893" class="i field">NotePropertySingleMemberSet</a>)]
        [<span class="i">ValidateNotePropertyNameAttribute</span>()]
        [<span class="i">NotePropertyTransformationAttribute</span>()]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="fe6ef1ac1d8c065e" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">NotePropertyName</a>
        {
            <b>get</b> { <b>return</b> <a href="#36b8f658e44d49a6" class="i field">_notePropertyName</a>; }
 
            <b>set</b> { <a href="#36b8f658e44d49a6" class="i field">_notePropertyName</a> = <b>value</b>; }
        }
 
        <b>private object</b> <a id="90894a73d87d76cb" href="../../R/90894a73d87d76cb.html" target="n" data-glyph="46,1" class="i field">_notePropertyValue</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value of the new NoteProperty member.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#16e38e140c598893" class="i field">NotePropertySingleMemberSet</a>)]
        [<span class="i">AllowNull</span>]
        <b>public object</b> <a id="29b8513975248b10" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">NotePropertyValue</a>
        {
            <b>get</b> { <b>return</b> <a href="#90894a73d87d76cb" class="i field">_notePropertyValue</a>; }
 
            <b>set</b> { <a href="#90894a73d87d76cb" class="i field">_notePropertyValue</a> = <b>value</b>; }
        }
 
        <span class="c">// Use IDictionary to support both Hashtable and OrderedHashtable</span>
        <b>private</b> <span class="i">IDictionary</span> <a id="ae6e4eff89add6ca" href="../../R/ae6e4eff89add6ca.html" target="n" data-glyph="46,1" class="i field">_property</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The NoteProperty members to be set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#09cab67706d8553c" class="i field">NotePropertyMultiMemberSet</a>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">IDictionary</span> <a id="22ed556615b1b53f" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">NotePropertyMembers</a>
        {
            <b>get</b> { <b>return</b> <a href="#ae6e4eff89add6ca" class="i field">_property</a>; }
 
            <b>set</b> { <a href="#ae6e4eff89add6ca" class="i field">_property</a> = <b>value</b>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Simplifying NoteProperty Declaration
 
        <b>private static object</b> <a id="df2378aa942b3f17" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetParameterType</a>(<b>object</b> <span id="r1 rd" class="r1 r">sourceValue</span>, <span class="i">Type</span> <span id="r2 rd" class="r2 r">destinationType</span>)
        {
            <b>return</b> <a href="/System.Management.Automation/A.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r1 r">sourceValue</span>, <span class="r2 r">destinationType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
        }
 
        <b>private void</b> <a id="b6942ad7684dc839" href="../../R/b6942ad7684dc839.html" target="n" data-glyph="76,1" class="i method">EnsureValue1AndValue2AreNotBothNull</a>()
        {
            <b>if</b> (<a href="#68e6dd1e5eff34e9" class="i field">_value1</a> == <b>null</b> &amp;&amp;
               (<a href="#1590ab61adc4d40e" class="i field">_value2</a> == <b>null</b> || !<a href="#d874188be6c51186" class="i method">HasBeenSpecified</a>(<a href="#1590ab61adc4d40e" class="i field">_value2</a>)))
            {
                <span class="i">ThrowTerminatingError</span>(<span class="i">NewError</span>(<span class="s">&quot;Value1AndValue2AreNotBothNull&quot;</span>, <span class="s">&quot;Value1AndValue2AreNotBothNull&quot;</span>, <b>null</b>, <a href="#1edfa315891a9936" class="i field">_memberType</a>));
            }
        }
 
        <b>private void</b> <a id="809ad5e45154b688" href="../../R/809ad5e45154b688.html" target="n" data-glyph="76,1" class="i method">EnsureValue1IsNotNull</a>()
        {
            <b>if</b> (<a href="#68e6dd1e5eff34e9" class="i field">_value1</a> == <b>null</b>)
            {
                <span class="i">ThrowTerminatingError</span>(<span class="i">NewError</span>(<span class="s">&quot;Value1ShouldNotBeNull&quot;</span>, <span class="s">&quot;Value1ShouldNotBeNull&quot;</span>, <b>null</b>, <a href="#1edfa315891a9936" class="i field">_memberType</a>));
            }
        }
 
        <b>private void</b> <a id="f6cfb2f89fa2c1d7" href="../../R/f6cfb2f89fa2c1d7.html" target="n" data-glyph="76,1" class="i method">EnsureValue2IsNotNull</a>()
        {
            <b>if</b> (<a href="#1590ab61adc4d40e" class="i field">_value2</a> == <b>null</b>)
            {
                <span class="i">ThrowTerminatingError</span>(<span class="i">NewError</span>(<span class="s">&quot;Value2ShouldNotBeNull&quot;</span>, <span class="s">&quot;Value2ShouldNotBeNull&quot;</span>, <b>null</b>, <a href="#1edfa315891a9936" class="i field">_memberType</a>));
            }
        }
 
        <b>private void</b> <a id="338066567e6757d0" href="../../R/338066567e6757d0.html" target="n" data-glyph="76,1" class="i method">EnsureValue1HasBeenSpecified</a>()
        {
            <b>if</b> (!<a href="#d874188be6c51186" class="i method">HasBeenSpecified</a>(<a href="#68e6dd1e5eff34e9" class="i field">_value1</a>))
            {
                <span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#604dc47cb14e8ae1" class="t t">FieldDescription</a>&gt; <span id="r3 rd" class="r3 r">fdc</span> = <b>new</b>();
                <span class="r3 r">fdc</span>.<span class="i">Add</span>(<b>new</b> <span class="t">FieldDescription</span>(<span class="s">&quot;Value&quot;</span>));
                <b>string</b> <span id="r4 rd" class="r4 r">prompt</span> = <span class="i">StringUtil</span>.<span class="i">Format</span>(<span class="i">AddMember</span>.<span class="i">Value1Prompt</span>, <a href="#1edfa315891a9936" class="i field">_memberType</a>);
                <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r5 rd" class="r5 r">result</span> = <a href="#1610f2f825d7378e" class="k">this</a>.<a href="/System.Management.Automation/A.html#01105ebe2065fe1b" class="i property">Host</a>.<a href="/System.Management.Automation/A.html#f3c3c89a5e9dd42a" class="i property">UI</a>.<span class="i">Prompt</span>(<span class="r4 r">prompt</span>, <b>null</b>, <span class="r3 r">fdc</span>);
                <b>if</b> (<span class="r5 r">result</span> != <b>null</b>)
                {
                    <a href="#68e6dd1e5eff34e9" class="i field">_value1</a> = <span class="r5 r">result</span>[<span class="s">&quot;Value&quot;</span>].<span class="i">BaseObject</span>;
                }
            }
        }
 
        <b>private void</b> <a id="cb665cfc0387cdf4" href="../../R/cb665cfc0387cdf4.html" target="n" data-glyph="76,1" class="i method">EnsureValue2HasNotBeenSpecified</a>()
        {
            <b>if</b> (<a href="#d874188be6c51186" class="i method">HasBeenSpecified</a>(<a href="#1590ab61adc4d40e" class="i field">_value2</a>))
            {
                <span class="i">ThrowTerminatingError</span>(<span class="i">NewError</span>(<span class="s">&quot;Value2ShouldNotBeSpecified&quot;</span>, <span class="s">&quot;Value2ShouldNotBeSpecified&quot;</span>, <b>null</b>, <a href="#1edfa315891a9936" class="i field">_memberType</a>));
            }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <a id="bda38e4c7693d892" href="../../R/bda38e4c7693d892.html" target="n" data-glyph="76,1" class="i method">GetAliasProperty</a>()
        {
            <a href="#338066567e6757d0" class="i method">EnsureValue1HasBeenSpecified</a>();
            <a href="#809ad5e45154b688" class="i method">EnsureValue1IsNotNull</a>();
 
            <b>string</b> <span id="r6 rd" class="r6 r">value1Str</span> = (<b>string</b>)<span class="i">GetParameterType</span>(<a href="#68e6dd1e5eff34e9" class="i field">_value1</a>, <b>typeof</b>(<b>string</b>));
            <b>if</b> (<a href="#d874188be6c51186" class="i method">HasBeenSpecified</a>(<a href="#1590ab61adc4d40e" class="i field">_value2</a>))
            {
                <a href="#f6cfb2f89fa2c1d7" class="i method">EnsureValue2IsNotNull</a>();
                <span class="i">Type</span> <span id="r7 rd" class="r7 r">value2Type</span> = (<span class="i">Type</span>)<span class="i">GetParameterType</span>(<a href="#1590ab61adc4d40e" class="i field">_value2</a>, <b>typeof</b>(<span class="i">Type</span>));
                <b>return</b> <b>new</b> <span class="t">PSAliasProperty</span>(<a href="#74b5dc3adf61e3d1" class="i field">_memberName</a>, <span class="r6 r">value1Str</span>, <span class="r7 r">value2Type</span>);
            }
 
            <b>return</b> <b>new</b> <span class="t">PSAliasProperty</span>(<a href="#74b5dc3adf61e3d1" class="i field">_memberName</a>, <span class="r6 r">value1Str</span>);
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <a id="b765953238307d8b" href="../../R/b765953238307d8b.html" target="n" data-glyph="76,1" class="i method">GetCodeMethod</a>()
        {
            <a href="#338066567e6757d0" class="i method">EnsureValue1HasBeenSpecified</a>();
            <a href="#809ad5e45154b688" class="i method">EnsureValue1IsNotNull</a>();
            <a href="#cb665cfc0387cdf4" class="i method">EnsureValue2HasNotBeenSpecified</a>();
            <span class="i">MethodInfo</span> <span id="r8 rd" class="r8 r">value1MethodInfo</span> = (<span class="i">MethodInfo</span>)<span class="i">GetParameterType</span>(<a href="#68e6dd1e5eff34e9" class="i field">_value1</a>, <b>typeof</b>(<span class="i">MethodInfo</span>));
            <b>return</b> <b>new</b> <span class="t">PSCodeMethod</span>(<a href="#74b5dc3adf61e3d1" class="i field">_memberName</a>, <span class="r8 r">value1MethodInfo</span>);
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <a id="70ed386653611f87" href="../../R/70ed386653611f87.html" target="n" data-glyph="76,1" class="i method">GetCodeProperty</a>()
        {
            <a href="#338066567e6757d0" class="i method">EnsureValue1HasBeenSpecified</a>();
            <a href="#b6942ad7684dc839" class="i method">EnsureValue1AndValue2AreNotBothNull</a>();
 
            <span class="i">MethodInfo</span> <span id="r9 rd" class="r9 r">value1MethodInfo</span> = <b>null</b>;
            <b>if</b> (<a href="#d874188be6c51186" class="i method">HasBeenSpecified</a>(<a href="#68e6dd1e5eff34e9" class="i field">_value1</a>))
            {
                <span class="r9 r">value1MethodInfo</span> = (<span class="i">MethodInfo</span>)<span class="i">GetParameterType</span>(<a href="#68e6dd1e5eff34e9" class="i field">_value1</a>, <b>typeof</b>(<span class="i">MethodInfo</span>));
            }
 
            <span class="i">MethodInfo</span> <span id="r10 rd" class="r10 r">value2MethodInfo</span> = <b>null</b>;
            <b>if</b> (<a href="#d874188be6c51186" class="i method">HasBeenSpecified</a>(<a href="#1590ab61adc4d40e" class="i field">_value2</a>))
            {
                <span class="r10 r">value2MethodInfo</span> = (<span class="i">MethodInfo</span>)<span class="i">GetParameterType</span>(<a href="#1590ab61adc4d40e" class="i field">_value2</a>, <b>typeof</b>(<span class="i">MethodInfo</span>));
            }
 
            <b>return</b> <b>new</b> <span class="t">PSCodeProperty</span>(<a href="#74b5dc3adf61e3d1" class="i field">_memberName</a>, <span class="r9 r">value1MethodInfo</span>, <span class="r10 r">value2MethodInfo</span>);
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <a id="daf24f9cf7101c4c" href="../../R/daf24f9cf7101c4c.html" target="n" data-glyph="76,1" class="i method">GetMemberSet</a>()
        {
            <a href="#cb665cfc0387cdf4" class="i method">EnsureValue2HasNotBeenSpecified</a>();
            <b>if</b> (<a href="#68e6dd1e5eff34e9" class="i field">_value1</a> == <b>null</b> || !<a href="#d874188be6c51186" class="i method">HasBeenSpecified</a>(<a href="#68e6dd1e5eff34e9" class="i field">_value1</a>))
            {
                <b>return</b> <b>new</b> <span class="t">PSMemberSet</span>(<a href="#74b5dc3adf61e3d1" class="i field">_memberName</a>);
            }
 
            <span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt; <span id="r11 rd" class="r11 r">value1Collection</span> =
                (<span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;)<span class="i">GetParameterType</span>(<a href="#68e6dd1e5eff34e9" class="i field">_value1</a>, <b>typeof</b>(<span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;));
            <b>return</b> <b>new</b> <span class="t">PSMemberSet</span>(<a href="#74b5dc3adf61e3d1" class="i field">_memberName</a>, <span class="r11 r">value1Collection</span>);
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <a id="c11992ae568cd18c" href="../../R/c11992ae568cd18c.html" target="n" data-glyph="76,1" class="i method">GetNoteProperty</a>()
        {
            <a href="#338066567e6757d0" class="i method">EnsureValue1HasBeenSpecified</a>();
            <a href="#cb665cfc0387cdf4" class="i method">EnsureValue2HasNotBeenSpecified</a>();
            <b>return</b> <b>new</b> <span class="t">PSNoteProperty</span>(<a href="#74b5dc3adf61e3d1" class="i field">_memberName</a>, <a href="#68e6dd1e5eff34e9" class="i field">_value1</a>);
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <a id="3e4b40556173a242" href="../../R/3e4b40556173a242.html" target="n" data-glyph="76,1" class="i method">GetPropertySet</a>()
        {
            <a href="#cb665cfc0387cdf4" class="i method">EnsureValue2HasNotBeenSpecified</a>();
            <a href="#338066567e6757d0" class="i method">EnsureValue1HasBeenSpecified</a>();
            <a href="#809ad5e45154b688" class="i method">EnsureValue1IsNotNull</a>();
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r12 rd" class="r12 r">value1Collection</span> =
                (<span class="i">Collection</span>&lt;<b>string</b>&gt;)<span class="i">GetParameterType</span>(<a href="#68e6dd1e5eff34e9" class="i field">_value1</a>, <b>typeof</b>(<span class="i">Collection</span>&lt;<b>string</b>&gt;));
            <b>return</b> <b>new</b> <span class="t">PSPropertySet</span>(<a href="#74b5dc3adf61e3d1" class="i field">_memberName</a>, <span class="r12 r">value1Collection</span>);
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <a id="681a54459db408e4" href="../../R/681a54459db408e4.html" target="n" data-glyph="76,1" class="i method">GetScriptMethod</a>()
        {
            <a href="#cb665cfc0387cdf4" class="i method">EnsureValue2HasNotBeenSpecified</a>();
            <a href="#338066567e6757d0" class="i method">EnsureValue1HasBeenSpecified</a>();
            <a href="#809ad5e45154b688" class="i method">EnsureValue1IsNotNull</a>();
            <a href="/System.Management.Automation/A.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r13 rd" class="r13 r">value1ScriptBlock</span> = (<a href="/System.Management.Automation/A.html#eea83b421baeaca4" class="t t">ScriptBlock</a>)<span class="i">GetParameterType</span>(<a href="#68e6dd1e5eff34e9" class="i field">_value1</a>, <b>typeof</b>(<a href="/System.Management.Automation/A.html#eea83b421baeaca4" class="t t">ScriptBlock</a>));
            <b>return</b> <b>new</b> <span class="t">PSScriptMethod</span>(<a href="#74b5dc3adf61e3d1" class="i field">_memberName</a>, <span class="r13 r">value1ScriptBlock</span>);
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <a id="8b5b9089db5ee1f4" href="../../R/8b5b9089db5ee1f4.html" target="n" data-glyph="76,1" class="i method">GetScriptProperty</a>()
        {
            <a href="#338066567e6757d0" class="i method">EnsureValue1HasBeenSpecified</a>();
            <a href="#b6942ad7684dc839" class="i method">EnsureValue1AndValue2AreNotBothNull</a>();
 
            <a href="/System.Management.Automation/A.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r14 rd" class="r14 r">value1ScriptBlock</span> = <b>null</b>;
            <b>if</b> (<a href="#d874188be6c51186" class="i method">HasBeenSpecified</a>(<a href="#68e6dd1e5eff34e9" class="i field">_value1</a>))
            {
                <span class="r14 r">value1ScriptBlock</span> = (<a href="/System.Management.Automation/A.html#eea83b421baeaca4" class="t t">ScriptBlock</a>)<span class="i">GetParameterType</span>(<a href="#68e6dd1e5eff34e9" class="i field">_value1</a>, <b>typeof</b>(<a href="/System.Management.Automation/A.html#eea83b421baeaca4" class="t t">ScriptBlock</a>));
            }
 
            <a href="/System.Management.Automation/A.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r15 rd" class="r15 r">value2ScriptBlock</span> = <b>null</b>;
            <b>if</b> (<a href="#d874188be6c51186" class="i method">HasBeenSpecified</a>(<a href="#1590ab61adc4d40e" class="i field">_value2</a>))
            {
                <span class="r15 r">value2ScriptBlock</span> = (<a href="/System.Management.Automation/A.html#eea83b421baeaca4" class="t t">ScriptBlock</a>)<span class="i">GetParameterType</span>(<a href="#1590ab61adc4d40e" class="i field">_value2</a>, <b>typeof</b>(<a href="/System.Management.Automation/A.html#eea83b421baeaca4" class="t t">ScriptBlock</a>));
            }
 
            <b>return</b> <b>new</b> <span class="t">PSScriptProperty</span>(<a href="#74b5dc3adf61e3d1" class="i field">_memberName</a>, <span class="r14 r">value1ScriptBlock</span>, <span class="r15 r">value2ScriptBlock</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method implements the ProcessRecord method for add-member command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="1531d505dda3b35d" href="../../R/1531d505dda3b35d.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>if</b> (<a href="#1047227c544731cb" class="i field">_typeName</a> != <b>null</b> &amp;&amp; <b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<a href="#1047227c544731cb" class="i field">_typeName</a>))
            {
                <span class="i">ThrowTerminatingError</span>(<a href="#c8267cc6ee7893d8" class="i method">NewError</a>(<span class="s">&quot;TypeNameShouldNotBeEmpty&quot;</span>, <span class="s">&quot;TypeNameShouldNotBeEmpty&quot;</span>, <a href="#1047227c544731cb" class="i field">_typeName</a>));
            }
 
            <b>if</b> (<a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <span class="s">&quot;TypeNameSet&quot;</span>)
            {
                <a href="#38c0afa659c0e377" class="i method">UpdateTypeNames</a>();
 
                <b>if</b> (<a href="#60a66358929a4e7e" class="i field">_passThru</a>)
                {
                    <span class="i">WriteObject</span>(<a href="#7991cd3911eed905" class="i field">_inputObject</a>);
                }
 
                <b>return</b>;
            }
 
            <b>if</b> (<a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#09cab67706d8553c" class="i field">NotePropertyMultiMemberSet</a>)
            {
                <a href="#916a8febe3766d81" class="i method">ProcessNotePropertyMultiMemberSet</a>();
                <b>return</b>;
            }
 
            <a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r16 rd" class="r16 r">member</span> = <b>null</b>;
            <b>if</b> (<a href="/System.Management.Automation/A.html#f1ecb7c30328d049" class="i property">ParameterSetName</a> == <a href="#16e38e140c598893" class="i field">NotePropertySingleMemberSet</a>)
            {
                <span class="r16 r">member</span> = <b>new</b> <span class="t">PSNoteProperty</span>(<a href="#36b8f658e44d49a6" class="i field">_notePropertyName</a>, <a href="#90894a73d87d76cb" class="i field">_notePropertyValue</a>);
            }
            <b>else</b>
            {
                <b>int</b> <span id="r17 rd" class="r17 r">memberCountHelper</span> = (<b>int</b>)<a href="#1edfa315891a9936" class="i field">_memberType</a>;
                <b>int</b> <span id="r18 rd" class="r18 r">memberCount</span> = 0;
                <b>while</b> (<span class="r17 r">memberCountHelper</span> != 0)
                {
                    <b>if</b> ((<span class="r17 r">memberCountHelper</span> &amp; 1) != 0)
                    {
                        <span class="r18 r">memberCount</span>++;
                    }
 
                    <span class="r17 r">memberCountHelper</span> &gt;&gt;= 1;
                }
 
                <b>if</b> (<span class="r18 r">memberCount</span> != 1)
                {
                    <span class="i">ThrowTerminatingError</span>(<span class="i">NewError</span>(<span class="s">&quot;WrongMemberCount&quot;</span>, <span class="s">&quot;WrongMemberCount&quot;</span>, <b>null</b>, <a href="#1edfa315891a9936" class="i field">_memberType</a>.<span class="i">ToString</span>()));
                    <b>return</b>;
                }
 
                <b>switch</b> (<a href="#1edfa315891a9936" class="i field">_memberType</a>)
                {
                    <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#07a4ea8fc349cf09" class="i field">AliasProperty</a>:
                        <span class="r16 r">member</span> = <a href="#bda38e4c7693d892" class="i method">GetAliasProperty</a>();
                        <b>break</b>;
                    <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#d7edf3c05843859f" class="i field">CodeMethod</a>:
                        <span class="r16 r">member</span> = <a href="#b765953238307d8b" class="i method">GetCodeMethod</a>();
                        <b>break</b>;
                    <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#f7f2d076260cbe00" class="i field">CodeProperty</a>:
                        <span class="r16 r">member</span> = <a href="#70ed386653611f87" class="i method">GetCodeProperty</a>();
                        <b>break</b>;
                    <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#13dbf4d3444210a7" class="i field">MemberSet</a>:
                        <span class="r16 r">member</span> = <a href="#daf24f9cf7101c4c" class="i method">GetMemberSet</a>();
                        <b>break</b>;
                    <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#9265b28353caf0e3" class="i field">NoteProperty</a>:
                        <span class="r16 r">member</span> = <a href="#c11992ae568cd18c" class="i method">GetNoteProperty</a>();
                        <b>break</b>;
                    <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#5d1f01e046fd94a7" class="i field">PropertySet</a>:
                        <span class="r16 r">member</span> = <a href="#3e4b40556173a242" class="i method">GetPropertySet</a>();
                        <b>break</b>;
                    <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#1e09996531b10b1b" class="i field">ScriptMethod</a>:
                        <span class="r16 r">member</span> = <a href="#681a54459db408e4" class="i method">GetScriptMethod</a>();
                        <b>break</b>;
                    <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#edccd46335cdba98" class="i field">ScriptProperty</a>:
                        <span class="r16 r">member</span> = <a href="#8b5b9089db5ee1f4" class="i method">GetScriptProperty</a>();
                        <b>break</b>;
                    <b>default</b>:
                        <span class="i">ThrowTerminatingError</span>(<span class="i">NewError</span>(<span class="s">&quot;CannotAddMemberType&quot;</span>, <span class="s">&quot;CannotAddMemberType&quot;</span>, <b>null</b>, <a href="#1edfa315891a9936" class="i field">_memberType</a>.<span class="i">ToString</span>()));
                        <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r16 r">member</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (!<a href="#5605be6a6cad1822" class="i method">AddMemberToTarget</a>(<span class="r16 r">member</span>))
                <b>return</b>;
 
            <b>if</b> (<a href="#1047227c544731cb" class="i field">_typeName</a> != <b>null</b>)
            {
                <a href="#38c0afa659c0e377" class="i method">UpdateTypeNames</a>();
            }
 
            <b>if</b> (<a href="#60a66358929a4e7e" class="i field">_passThru</a>)
            {
                <span class="i">WriteObject</span>(<a href="#7991cd3911eed905" class="i field">_inputObject</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add the member to the target object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">member</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="5605be6a6cad1822" href="../../R/5605be6a6cad1822.html" target="n" data-glyph="76,1" class="i method">AddMemberToTarget</a>(<a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r19 rd" class="r19 r">member</span>)
        {
            <a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r20 rd" class="r20 r">previousMember</span> = <a href="#7991cd3911eed905" class="i field">_inputObject</a>.<a href="/System.Management.Automation/A.html#56bc82b240e4291b" class="i property">Members</a>[<span class="r19 r">member</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>];
            <b>if</b> (<span class="r20 r">previousMember</span> != <b>null</b>)
            {
                <b>if</b> (!<a href="#b79117a23ade2535" class="i field">_force</a>)
                {
                    <span class="i">WriteError</span>(<a href="#c8267cc6ee7893d8" class="i method">NewError</a>(<span class="s">&quot;MemberAlreadyExists&quot;</span>,
                        <span class="s">&quot;MemberAlreadyExists&quot;</span>,
                        <a href="#7991cd3911eed905" class="i field">_inputObject</a>, <span class="r19 r">member</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>));
                    <b>return</b> <b>false</b>;
                }
                <b>else</b>
                {
                    <b>if</b> (<span class="r20 r">previousMember</span>.<a href="/System.Management.Automation/A.html#8a7c2cbc9d911d41" class="i property">IsInstance</a>)
                    {
                        <a href="#7991cd3911eed905" class="i field">_inputObject</a>.<a href="/System.Management.Automation/A.html#56bc82b240e4291b" class="i property">Members</a>.<span class="i">Remove</span>(<span class="r19 r">member</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>);
                    }
                    <b>else</b>
                    {
                        <span class="i">WriteError</span>(<span class="i">NewError</span>(<span class="s">&quot;CannotRemoveTypeDataMember&quot;</span>,
                            <span class="s">&quot;CannotRemoveTypeDataMember&quot;</span>,
                            <a href="#7991cd3911eed905" class="i field">_inputObject</a>, <span class="r19 r">member</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r20 r">previousMember</span>.<a href="/System.Management.Automation/A.html#96599175ac2fa1f6" class="i property">MemberType</a>));
                        <b>return</b> <b>false</b>;
                    }
                }
            }
 
            <a href="#7991cd3911eed905" class="i field">_inputObject</a>.<a href="/System.Management.Automation/A.html#56bc82b240e4291b" class="i property">Members</a>.<span class="i">Add</span>(<span class="r19 r">member</span>);
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process the &#39;NotePropertyMultiMemberSet&#39; parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="916a8febe3766d81" href="../../R/916a8febe3766d81.html" target="n" data-glyph="76,1" class="i method">ProcessNotePropertyMultiMemberSet</a>()
        {
            <b>bool</b> <span id="r21 rd" class="r21 r">result</span> = <b>false</b>;
            <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r22 rd" class="r22 r">prop</span> <b>in</b> <a href="#ae6e4eff89add6ca" class="i field">_property</a>)
            {
                <b>string</b> <span id="r23 rd" class="r23 r">noteName</span> = <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">ToStringParser</span>(<a href="#1610f2f825d7378e" class="k">this</a>.<span class="i">Context</span>, <span class="r22 r">prop</span>.<span class="i">Key</span>);
                <b>object</b> <span id="r24 rd" class="r24 r">noteValue</span> = <span class="r22 r">prop</span>.<span class="i">Value</span>;
 
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r23 r">noteName</span>))
                {
                    <span class="i">WriteError</span>(<a href="#c8267cc6ee7893d8" class="i method">NewError</a>(<span class="s">&quot;NotePropertyNameShouldNotBeNull&quot;</span>,
                        <span class="s">&quot;NotePropertyNameShouldNotBeNull&quot;</span>, <span class="r23 r">noteName</span>));
                    <b>continue</b>;
                }
 
                <a href="/System.Management.Automation/A.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r25 rd" class="r25 r">member</span> = <b>new</b> <span class="t">PSNoteProperty</span>(<span class="r23 r">noteName</span>, <span class="r24 r">noteValue</span>);
                <b>if</b> (<a href="#5605be6a6cad1822" class="i method">AddMemberToTarget</a>(<span class="r25 r">member</span>) &amp;&amp; !<span class="r21 r">result</span>)
                    <span class="r21 r">result</span> = <b>true</b>;
            }
 
            <b>if</b> (<span class="r21 r">result</span> &amp;&amp; <a href="#1047227c544731cb" class="i field">_typeName</a> != <b>null</b>)
            {
                <a href="#38c0afa659c0e377" class="i method">UpdateTypeNames</a>();
            }
 
            <b>if</b> (<span class="r21 r">result</span> &amp;&amp; <a href="#60a66358929a4e7e" class="i field">_passThru</a>)
            {
                <span class="i">WriteObject</span>(<a href="#7991cd3911eed905" class="i field">_inputObject</a>);
            }
        }
 
        <b>private void</b> <a id="38c0afa659c0e377" href="../../R/38c0afa659c0e377.html" target="n" data-glyph="76,1" class="i method">UpdateTypeNames</a>()
        {
            <span class="c">// Respect the type shortcut</span>
            <span class="i">Type</span> <span id="r26 rd" class="r26 r">type</span>;
            <b>string</b> <span id="r27 rd" class="r27 r">typeNameInUse</span> = <a href="#1047227c544731cb" class="i field">_typeName</a>;
            <b>if</b> (<a href="/System.Management.Automation/A.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>(<a href="#1047227c544731cb" class="i field">_typeName</a>, <b>out</b> <span class="r26 r">type</span>)) { <span class="r27 r">typeNameInUse</span> = <span class="r26 r">type</span>.<span class="i">FullName</span>; }
 
            <a href="#7991cd3911eed905" class="i field">_inputObject</a>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Insert</span>(0, <span class="r27 r">typeNameInUse</span>);
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <a id="c8267cc6ee7893d8" href="../../R/c8267cc6ee7893d8.html" target="n" data-glyph="76,1" class="i method">NewError</a>(<b>string</b> <span id="r28 rd" class="r28 r">errorId</span>, <b>string</b> <span id="r29 rd" class="r29 r">resourceId</span>, <b>object</b> <span id="r30 rd" class="r30 r">targetObject</span>, <b>params object</b>[] <span id="r31 rd" class="r31 r">args</span>)
        {
            <a href="/System.Management.Automation/A.html#d882fa1d2308673f" class="t t">ErrorDetails</a> <span id="r32 rd" class="r32 r">details</span> = <b>new</b>(<a href="#1610f2f825d7378e" class="k">this</a>.<span class="i">GetType</span>().<span class="i">GetTypeInfo</span>().<span class="i">Assembly</span>,
                <span class="s">&quot;Microsoft.PowerShell.Commands.Utility.resources.AddMember&quot;</span>, <span class="r29 r">resourceId</span>, <span class="r31 r">args</span>);
            <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r33 rd" class="r33 r">errorRecord</span> = <b>new</b>(
                <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r32 r">details</span>.<a href="/System.Management.Automation/A.html#589bef4648ccf37a" class="i property">Message</a>),
                <span class="r28 r">errorId</span>,
                <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                <span class="r30 r">targetObject</span>);
            <b>return</b> <span class="r33 r">errorRecord</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This ValidateArgumentsAttribute is used to guarantee the argument to be bound to</span>
        <span class="c">///</span><span class="c"> -NotePropertyName parameter cannot be converted to the enum type PSMemberTypes.</span>
        <span class="c">///</span><span class="c"> So when given a string or a number that can be converted, we make sure it gets</span>
        <span class="c">///</span><span class="c"> bound to -MemberType, instead of -NotePropertyName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This exception will be hidden in the positional binding phase. So we make sure</span>
        <span class="c">///</span><span class="c"> if the argument can be converted to PSMemberTypes, it gets bound to the -MemberType</span>
        <span class="c">///</span><span class="c"> parameter. We are sure that when this exception is thrown, the current positional</span>
        <span class="c">///</span><span class="c"> argument can be successfully bound to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="199a5278194b64e4" href="../../R/../../0000000000.html" target="n" data-glyph="4,1" class="t t"><span id="af9ff81e7996eb35">ValidateNotePropertyNameAttribute</span></a> : <a href="/System.Management.Automation/A.html#f182d3d1083583da" class="t t">ValidateArgumentsAttribute</a>
        {
            <b>protected override void</b> <a id="6e7d6c6fda6b752d" href="../../R/6e7d6c6fda6b752d.html" target="n" data-glyph="75,2" class="i method">Validate</a>(<b>object</b> <span id="r34 rd" class="r34 r">arguments</span>, <a href="/System.Management.Automation/A.html#e9f6dd7d61246066" class="t t">EngineIntrinsics</a> <span id="r35 rd" class="r35 r">engineIntrinsics</span>)
            {
                <b>string</b> <span id="r36 rd" class="r36 r">notePropertyName</span> = <span class="r34 r">arguments</span> <b>as string</b>;
                <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a> <span id="r37 rd" class="r37 r">memberType</span>;
                <b>if</b> (<span class="r36 r">notePropertyName</span> != <b>null</b> &amp;&amp; <a href="/System.Management.Automation/A.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>&lt;<a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>&gt;(<span class="r36 r">notePropertyName</span>, <b>out</b> <span class="r37 r">memberType</span>))
                {
                    <b>switch</b> (<span class="r37 r">memberType</span>)
                    {
                        <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#07a4ea8fc349cf09" class="i field">AliasProperty</a>:
                        <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#d7edf3c05843859f" class="i field">CodeMethod</a>:
                        <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#f7f2d076260cbe00" class="i field">CodeProperty</a>:
                        <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#13dbf4d3444210a7" class="i field">MemberSet</a>:
                        <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#9265b28353caf0e3" class="i field">NoteProperty</a>:
                        <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#5d1f01e046fd94a7" class="i field">PropertySet</a>:
                        <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#1e09996531b10b1b" class="i field">ScriptMethod</a>:
                        <b>case</b> <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#edccd46335cdba98" class="i field">ScriptProperty</a>:
                            <b>string</b> <span id="r38 rd" class="r38 r">errMsg</span> = <span class="i">StringUtil</span>.<span class="i">Format</span>(<span class="i">AddMember</span>.<span class="i">InvalidValueForNotePropertyName</span>, <b>typeof</b>(<a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>).<span class="i">FullName</span>);
                            <b>throw</b> <b>new</b> <span class="t">ValidationMetadataException</span>(<span class="r38 r">errMsg</span>, <b>true</b>);
                        <b>default</b>:
                            <b>break</b>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Transform the integer arguments to strings for the parameter NotePropertyName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal sealed class</b> <a id="e65a58c274269b34" href="../../R/../../0000000000.html" target="n" data-glyph="2,1" class="t t"><span id="2d3bca3c04292604">NotePropertyTransformationAttribute</span></a> : <a href="/System.Management.Automation/A.html#80472519ecf33cf1" class="t t">ArgumentTransformationAttribute</a>
        {
            <b>public override object</b> <a id="1f337e7a18f41145" href="../../R/1f337e7a18f41145.html" target="n" data-glyph="72,2" class="i method">Transform</a>(<a href="/System.Management.Automation/A.html#e9f6dd7d61246066" class="t t">EngineIntrinsics</a> <span id="r39 rd" class="r39 r">engineIntrinsics</span>, <b>object</b> <span id="r40 rd" class="r40 r">inputData</span>)
            {
                <b>object</b> <span id="r41 rd" class="r41 r">target</span> = <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">Base</span>(<span class="r40 r">inputData</span>);
                <b>if</b> (<span class="r41 r">target</span> != <b>null</b> &amp;&amp; <span class="r41 r">target</span>.<span class="i">GetType</span>().<span class="i">IsNumeric</span>())
                {
                    <b>var</b> <span id="r42 rd" class="r42 r">result</span> = <a href="/System.Management.Automation/A.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>&lt;<b>string</b>&gt;(<span class="r41 r">target</span>);
                    <b>return</b> <span class="r42 r">result</span>;
                }
 
                <b>return</b> <span class="r40 r">inputData</span>;
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
