<!DOCTYPE html>
<html><head><title>WSManInstance.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(1636);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.WSMan.Management/WSManInstance.cs" target="_top">WSManInstance.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.WSMan.Management" target="_top">src\Microsoft.WSMan.Management\Microsoft.WSMan.Management.csproj</a> (Microsoft.WSMan.Management)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Provider</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Xml</span>;
 
<b>using</b> <span class="i">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">WSMan</span>.<span class="i n">Management</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Get-WSManInstance
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Executes action on a target object specified by RESOURCE_URI, where</span>
    <span class="c">///</span><span class="c"> parameters are specified by key value pairs.</span>
    <span class="c">///</span><span class="c"> eg., Call StartService method on the spooler service</span>
    <span class="c">///</span><span class="c"> Invoke-WSManAction -Action StartService -ResourceURI wmicimv2/Win32_Service</span>
    <span class="c">///</span><span class="c"> -SelectorSet {Name=Spooler}</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="/System.Management.Automation/A.html#7ee9f5441476f642" class="i field">Get</a>, <span class="s">&quot;WSManInstance&quot;</span>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;GetInstance&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkId=2096627&quot;</span>)]
    <b>public class</b> <a id="2dc2bd00cb2553bd" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="d64c0d04422c4a94">GetWSManInstanceCommand</span></a> : <a href="WSManConnections.cs.html#9bb07ec48336aa1e" class="t t">AuthenticatingWSManCommand</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> parameter
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ApplicationName&quot;.</span>
        <span class="c">///</span><span class="c"> ApplicationName identifies the remote endpoint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;GetInstance&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Enumerate&quot;</span>)]
        <b>public string</b> <a id="8cac0a48c3502b3c" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ApplicationName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#52c725c9438c1c89" class="i field">applicationname</a>;
            }
 
            <b>set</b>
            {
                { <a href="#52c725c9438c1c89" class="i field">applicationname</a> = <b>value</b>; }
            }
        }
 
        <b>private string</b> <a id="52c725c9438c1c89" href="R/52c725c9438c1c89.html" target="n" data-glyph="46,1" class="i field">applicationname</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;BasePropertiesOnly&quot;.</span>
        <span class="c">///</span><span class="c"> Enumerate only those properties that are part of the base class</span>
        <span class="c">///</span><span class="c"> specification in the Resource URI. When</span>
        <span class="c">///</span><span class="c"> Shallow is specified then this flag has no effect.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Enumerate&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;UBPO&quot;</span>, <span class="s">&quot;Base&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="b532559353f74860" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">BasePropertiesOnly</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f937dc1655d0ff77" class="i field">basepropertiesonly</a>;
            }
 
            <b>set</b>
            {
                { <a href="#f937dc1655d0ff77" class="i field">basepropertiesonly</a> = <b>value</b>; }
            }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="f937dc1655d0ff77" href="R/f937dc1655d0ff77.html" target="n" data-glyph="46,1" class="i field">basepropertiesonly</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ComputerName&quot;.</span>
        <span class="c">///</span><span class="c"> Executes the management operation on the specified computer(s). The default</span>
        <span class="c">///</span><span class="c"> is the local computer. Type the fully qualified domain name, NETBIOS name or</span>
        <span class="c">///</span><span class="c"> IP address to indicate the remote host(s)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;GetInstance&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Enumerate&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;CN&quot;</span>)]
        <b>public string</b> <a id="0dce766deb3c98b3" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ComputerName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#646549cc5a96cc94" class="i field">computername</a>;
            }
 
            <b>set</b>
            {
                <a href="#646549cc5a96cc94" class="i field">computername</a> = <b>value</b>;
                <b>if</b> ((<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#646549cc5a96cc94" class="i field">computername</a>)) || (<a href="#646549cc5a96cc94" class="i field">computername</a>.<span class="i">Equals</span>(<span class="s">&quot;.&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                {
                    <a href="#646549cc5a96cc94" class="i field">computername</a> = <span class="s">&quot;localhost&quot;</span>;
                }
            }
        }
 
        <b>private string</b> <a id="646549cc5a96cc94" href="R/646549cc5a96cc94.html" target="n" data-glyph="46,1" class="i field">computername</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ConnectionURI&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies the transport, server, port, and Prefix, needed to connect to the</span>
        <span class="c">///</span><span class="c"> remote machine. The format of this string is:</span>
        <span class="c">///</span><span class="c"> transport://server:port/Prefix.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(
                  <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;GetInstance&quot;</span>)]
        [<span class="i">Parameter</span>(
                  <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Enumerate&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;CURI&quot;</span>, <span class="s">&quot;CU&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;URI&quot;</span>)]
        <b>public</b> <span class="i">Uri</span> <a id="ed6c600597d173c7" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ConnectionURI</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#6ab0c3d31ec485fc" class="i field">connectionuri</a>;
            }
 
            <b>set</b>
            {
                { <a href="#6ab0c3d31ec485fc" class="i field">connectionuri</a> = <b>value</b>; }
            }
        }
 
        <b>private</b> <span class="i">Uri</span> <a id="6ab0c3d31ec485fc" href="R/6ab0c3d31ec485fc.html" target="n" data-glyph="46,1" class="i field">connectionuri</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Dialect&quot;.</span>
        <span class="c">///</span><span class="c"> Defines the dialect for the filter predicate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public</b> <span class="i">Uri</span> <a id="70b49131afcd639a" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Dialect</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e790cf338b51f0b9" class="i field">dialect</a>;
            }
 
            <b>set</b>
            {
                { <a href="#e790cf338b51f0b9" class="i field">dialect</a> = <b>value</b>; }
            }
        }
 
        <b>private</b> <span class="i">Uri</span> <a id="e790cf338b51f0b9" href="R/e790cf338b51f0b9.html" target="n" data-glyph="46,1" class="i field">dialect</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Enumerate&quot;.</span>
        <span class="c">///</span><span class="c"> Switch indicates list all instances of a management resource. Equivalent to</span>
        <span class="c">///</span><span class="c"> WSManagement Enumerate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                  <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Enumerate&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="9e92cf3014d65143" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Enumerate</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#51d3bf7b0ce2c9fe" class="i field">enumerate</a>;
            }
 
            <b>set</b>
            {
                { <a href="#51d3bf7b0ce2c9fe" class="i field">enumerate</a> = <b>value</b>; }
            }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="51d3bf7b0ce2c9fe" href="R/51d3bf7b0ce2c9fe.html" target="n" data-glyph="46,1" class="i field">enumerate</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Filter&quot;.</span>
        <span class="c">///</span><span class="c"> Indicates the filter expression for the enumeration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Enumerate&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="5b7680948ab73b3f" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Filter</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ae60b259d387257e" class="i field">filter</a>;
            }
 
            <b>set</b>
            {
                { <a href="#ae60b259d387257e" class="i field">filter</a> = <b>value</b>; }
            }
        }
 
        <b>private string</b> <a id="ae60b259d387257e" href="R/ae60b259d387257e.html" target="n" data-glyph="46,1" class="i field">filter</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Fragment&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies a section inside the instance that is to be updated or retrieved</span>
        <span class="c">///</span><span class="c"> for the given operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;GetInstance&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="7142b99545fc9745" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Fragment</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#2988c3d0a0121f43" class="i field">fragment</a>;
            }
 
            <b>set</b>
            {
                { <a href="#2988c3d0a0121f43" class="i field">fragment</a> = <b>value</b>; }
            }
        }
 
        <b>private string</b> <a id="2988c3d0a0121f43" href="R/2988c3d0a0121f43.html" target="n" data-glyph="46,1" class="i field">fragment</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;OptionSet&quot;.</span>
        <span class="c">///</span><span class="c"> OptionSet is a hashtable and is used to pass a set of switches to the</span>
        <span class="c">///</span><span class="c"> service to modify or refine the nature of the request.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>,
                   <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;OS&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <span class="i">Hashtable</span> <a id="9e9155cb5a0941cb" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">OptionSet</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#61dc92ee6a742e0a" class="i field">optionset</a>;
            }
 
            <b>set</b>
            {
                { <a href="#61dc92ee6a742e0a" class="i field">optionset</a> = <b>value</b>; }
            }
        }
 
        <b>private</b> <span class="i">Hashtable</span> <a id="61dc92ee6a742e0a" href="R/61dc92ee6a742e0a.html" target="n" data-glyph="46,1" class="i field">optionset</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Port&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies the port to be used when connecting to the ws management service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Enumerate&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;GetInstance&quot;</span>)]
        <b>public int</b> <a id="c8d4efacff5d3c95" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Port</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#0885aff075dbfc86" class="i field">port</a>;
            }
 
            <b>set</b>
            {
                { <a href="#0885aff075dbfc86" class="i field">port</a> = <b>value</b>; }
            }
        }
 
        <b>private int</b> <a id="0885aff075dbfc86" href="R/0885aff075dbfc86.html" target="n" data-glyph="46,1" class="i field">port</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Associations&quot;.</span>
        <span class="c">///</span><span class="c"> Associations indicates retrieval of association instances as opposed to</span>
        <span class="c">///</span><span class="c"> associated instances. This can only be used when specifying the Dialect as</span>
        <span class="c">///</span><span class="c"> Association.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Enumerate&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="1e3de61866d23c7d" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Associations</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#d378eac676bd592f" class="i field">associations</a>;
            }
 
            <b>set</b>
            {
                { <a href="#d378eac676bd592f" class="i field">associations</a> = <b>value</b>; }
            }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="d378eac676bd592f" href="R/d378eac676bd592f.html" target="n" data-glyph="46,1" class="i field">associations</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ResourceURI&quot;.</span>
        <span class="c">///</span><span class="c"> URI of the resource class/instance representation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0,
                   <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>,
                   <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;URI&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;RURI&quot;</span>)]
        <b>public</b> <span class="i">Uri</span> <a id="db9be4e6bf96d14a" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ResourceURI</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#87ddc569eaa50a90" class="i field">resourceuri</a>;
            }
 
            <b>set</b>
            {
                { <a href="#87ddc569eaa50a90" class="i field">resourceuri</a> = <b>value</b>; }
            }
        }
 
        <b>private</b> <span class="i">Uri</span> <a id="87ddc569eaa50a90" href="R/87ddc569eaa50a90.html" target="n" data-glyph="46,1" class="i field">resourceuri</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ReturnType&quot;.</span>
        <span class="c">///</span><span class="c"> Indicates the type of data returned. Possible options are &#39;Object&#39;, &#39;EPR&#39;,</span>
        <span class="c">///</span><span class="c"> and &#39;ObjectAndEPR&#39;. Default is Object.</span>
        <span class="c">///</span><span class="c"> If Object is specified or if this parameter is absent then only the objects</span>
        <span class="c">///</span><span class="c"> are returned</span>
        <span class="c">///</span><span class="c"> If EPR is specified then only the EPRs of the objects</span>
        <span class="c">///</span><span class="c"> are returned. EPRs contain information about the Resource URI and selectors</span>
        <span class="c">///</span><span class="c"> for the instance</span>
        <span class="c">///</span><span class="c"> If ObjectAndEPR is specified, then both the object and the associated EPRs</span>
        <span class="c">///</span><span class="c"> are returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Enumerate&quot;</span>)]
 
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">ValidateSetAttribute</span>(<b>new</b> <b>string</b>[] { <span class="s">&quot;object&quot;</span>, <span class="s">&quot;epr&quot;</span>, <span class="s">&quot;objectandepr&quot;</span> })]
        [<span class="i">Alias</span>(<span class="s">&quot;RT&quot;</span>)]
        <b>public string</b> <a id="de48e131d15ab262" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ReturnType</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a392ac13d3094334" class="i field">returntype</a>;
            }
 
            <b>set</b>
            {
                { <a href="#a392ac13d3094334" class="i field">returntype</a> = <b>value</b>; }
            }
        }
 
        <b>private string</b> <a id="a392ac13d3094334" href="R/a392ac13d3094334.html" target="n" data-glyph="46,1" class="i field">returntype</a> = <span class="s">&quot;object&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;SelectorSet&quot;.</span>
        <span class="c">///</span><span class="c"> SelectorSet is a hash table which helps in identify an instance of the</span>
        <span class="c">///</span><span class="c"> management resource if there are more than 1 instance of the resource</span>
        <span class="c">///</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(
                   <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;GetInstance&quot;</span>)]
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <span class="i">Hashtable</span> <a id="74bddbcdc277f776" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SelectorSet</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#d5af16d552b7ec6d" class="i field">selectorset</a>;
            }
 
            <b>set</b>
            {
                { <a href="#d5af16d552b7ec6d" class="i field">selectorset</a> = <b>value</b>; }
            }
        }
 
        <b>private</b> <span class="i">Hashtable</span> <a id="d5af16d552b7ec6d" href="R/d5af16d552b7ec6d.html" target="n" data-glyph="46,1" class="i field">selectorset</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;SessionOption&quot;.</span>
        <span class="c">///</span><span class="c"> Defines a set of extended options for the WSMan session.  This can be</span>
        <span class="c">///</span><span class="c"> created by using the cmdlet New-WSManSessionOption.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;SO&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <a href="/Microsoft.WSMan.Runtime/A.html#0ae1495c5b1dc50e" class="t t">SessionOption</a> <a id="58fa9abc4cc25bec" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SessionOption</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f8ebdba6b56cbbbc" class="i field">sessionoption</a>;
            }
 
            <b>set</b>
            {
                { <a href="#f8ebdba6b56cbbbc" class="i field">sessionoption</a> = <b>value</b>; }
            }
        }
 
        <b>private</b> <a href="/Microsoft.WSMan.Runtime/A.html#0ae1495c5b1dc50e" class="t t">SessionOption</a> <a id="f8ebdba6b56cbbbc" href="R/f8ebdba6b56cbbbc.html" target="n" data-glyph="46,1" class="i field">sessionoption</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Shallow&quot;.</span>
        <span class="c">///</span><span class="c"> Enumerate only instances of the base class specified in the resource URI. If</span>
        <span class="c">///</span><span class="c"> this flag is not specified, instances of the base class specified in the URI</span>
        <span class="c">///</span><span class="c"> and all its derived classes are returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Enumerate&quot;</span>)]
 
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="4f82dd1f76796918" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Shallow</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#2844e25dc96f9c51" class="i field">shallow</a>;
            }
 
            <b>set</b>
            {
                { <a href="#2844e25dc96f9c51" class="i field">shallow</a> = <b>value</b>; }
            }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="2844e25dc96f9c51" href="R/2844e25dc96f9c51.html" target="n" data-glyph="46,1" class="i field">shallow</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;UseSSL&quot;.</span>
        <span class="c">///</span><span class="c"> Uses the Secure Sockets Layer (SSL) protocol to establish a connection to</span>
        <span class="c">///</span><span class="c"> the remote computer. If SSL is not available on the port specified by the</span>
        <span class="c">///</span><span class="c"> Port parameter, the command fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;GetInstance&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;Enumerate&quot;</span>)]
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;SSL&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;SSL&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="f6e88a2470ae6213" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">UseSSL</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#895332431b5e5c11" class="i field">usessl</a>;
            }
 
            <b>set</b>
            {
                { <a href="#895332431b5e5c11" class="i field">usessl</a> = <b>value</b>; }
            }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="895332431b5e5c11" href="R/895332431b5e5c11.html" target="n" data-glyph="46,1" class="i field">usessl</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> parameter
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private
        <b>private</b> <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a> <a id="f1d3cb6f040b2638" href="R/f1d3cb6f040b2638.html" target="n" data-glyph="46,1" class="i field">helper</a>;
 
        <b>private string</b> <a id="6f2635fbae254eae" href="R/6f2635fbae254eae.html" target="n" data-glyph="76,1" class="i method">GetFilter</a>()
        {
            <b>string</b> <span id="r0 rd" class="r0 r">name</span>;
            <b>string</b> <span id="r1 rd" class="r1 r">value</span>;
            <b>string</b>[] <span id="r2 rd" class="r2 r">Split</span> = <a href="#ae60b259d387257e" class="i field">filter</a>.<span class="i">Trim</span>().<span class="i">Split</span>(<b>new</b> <b>char</b>[] { <span class="s">&#39;=&#39;</span>, <span class="s">&#39;;&#39;</span> });
            <b>if</b> ((<span class="r2 r">Split</span>.<span class="i">Length</span>) % 2 != 0)
            {
                <span class="c">// mismatched property name/value pair</span>
                <b>return</b> <b>null</b>;
            }
 
            <a href="#ae60b259d387257e" class="i field">filter</a> = <span class="s">&quot;&lt;wsman:SelectorSet xmlns:wsman=&#39;http://schemas.dmtf.org/wbem/wsman/1/wsman.xsd&#39;&gt;&quot;</span>;
            <b>for</b> (<b>int</b> <span id="r3 rd" class="r3 r">i</span> = 0; <span class="r3 r">i</span> &lt; <span class="r2 r">Split</span>.<span class="i">Length</span>; <span class="r3 r">i</span> += 2)
            {
                <span class="r1 r">value</span> = <span class="r2 r">Split</span>[<span class="r3 r">i</span> + 1].<span class="i">Substring</span>(1, <span class="r2 r">Split</span>[<span class="r3 r">i</span> + 1].<span class="i">Length</span> - 2);
                <span class="r0 r">name</span> = <span class="r2 r">Split</span>[<span class="r3 r">i</span>];
                <a href="#ae60b259d387257e" class="i field">filter</a> = <a href="#ae60b259d387257e" class="i field">filter</a> + <span class="s">&quot;&lt;wsman:Selector Name=&#39;&quot;</span> + <span class="r0 r">name</span> + <span class="s">&quot;&#39;&gt;&quot;</span> + <span class="r1 r">value</span> + <span class="s">&quot;&lt;/wsman:Selector&gt;&quot;</span>;
            }
 
            <a href="#ae60b259d387257e" class="i field">filter</a> += <span class="s">&quot;&lt;/wsman:SelectorSet&gt;&quot;</span>;
            <b>return</b> (<a href="#ae60b259d387257e" class="i field">filter</a>);
        }
 
        <b>private void</b> <a id="6acd627b54d76911" href="R/6acd627b54d76911.html" target="n" data-glyph="76,1" class="i method">ReturnEnumeration</a>(<a href="Interop.cs.html#3aa0212e531a5219" class="t t">IWSManEx</a> <span id="r4 rd" class="r4 r">wsmanObject</span>, <a href="Interop.cs.html#7e09d5780a7d0f62" class="t t">IWSManResourceLocator</a> <span id="r5 rd" class="r5 r">wsmanResourceLocator</span>, <a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a> <span id="r6 rd" class="r6 r">wsmanSession</span>)
        {
            <b>string</b> <span id="r7 rd" class="r7 r">fragment</span>;
            <b>try</b>
            {
                <b>int</b> <span id="r8 rd" class="r8 r">flags</span> = 0;
                <a href="Interop.cs.html#498ef0191bb84ab7" class="t t">IWSManEnumerator</a> <span id="r9 rd" class="r9 r">obj</span>;
                <b>if</b> (<a href="#a392ac13d3094334" class="i field">returntype</a> != <b>null</b>)
                {
                    <b>if</b> (<a href="#a392ac13d3094334" class="i field">returntype</a>.<span class="i">Equals</span>(<span class="s">&quot;object&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r8 r">flags</span> = <span class="r4 r">wsmanObject</span>.<a href="Interop.cs.html#c91e518594f9538f" class="i method">EnumerationFlagReturnObject</a>();
                    }
                    <b>else</b> <b>if</b> (<a href="#a392ac13d3094334" class="i field">returntype</a>.<span class="i">Equals</span>(<span class="s">&quot;epr&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r8 r">flags</span> = <span class="r4 r">wsmanObject</span>.<a href="Interop.cs.html#ec62685043c76df1" class="i method">EnumerationFlagReturnEPR</a>();
                    }
                    <b>else</b>
                    {
                        <span class="r8 r">flags</span> = <span class="r4 r">wsmanObject</span>.<a href="Interop.cs.html#a729252923a91802" class="i method">EnumerationFlagReturnObjectAndEPR</a>();
                    }
                }
 
                <b>if</b> (<a href="#2844e25dc96f9c51" class="i field">shallow</a>)
                {
                    <span class="r8 r">flags</span> |= <span class="r4 r">wsmanObject</span>.<a href="Interop.cs.html#72ec6e6871a7449c" class="i method">EnumerationFlagHierarchyShallow</a>();
                }
                <b>else</b> <b>if</b> (<a href="#f937dc1655d0ff77" class="i field">basepropertiesonly</a>)
                {
                    <span class="r8 r">flags</span> |= <span class="r4 r">wsmanObject</span>.<a href="Interop.cs.html#3b0faa3aff02fa33" class="i method">EnumerationFlagHierarchyDeepBasePropsOnly</a>();
                }
                <b>else</b>
                {
                    <span class="r8 r">flags</span> |= <span class="r4 r">wsmanObject</span>.<a href="Interop.cs.html#fb826374e48232c4" class="i method">EnumerationFlagHierarchyDeep</a>();
                }
 
                <b>if</b> (<a href="#e790cf338b51f0b9" class="i field">dialect</a> != <b>null</b> &amp;&amp; <a href="#ae60b259d387257e" class="i field">filter</a> != <b>null</b>)
                {
                    <b>if</b> (<a href="#e790cf338b51f0b9" class="i field">dialect</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#053ec5d04bec9ba3" class="i field">ALIAS_WQL</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || <a href="#e790cf338b51f0b9" class="i field">dialect</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#1469140f964b815c" class="i field">URI_WQL_DIALECT</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r7 r">fragment</span> = <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#1469140f964b815c" class="i field">URI_WQL_DIALECT</a>;
                        <a href="#e790cf338b51f0b9" class="i field">dialect</a> = <b>new</b> <span class="i">Uri</span>(<span class="r7 r">fragment</span>);
                    }
                    <b>else</b> <b>if</b> (<a href="#e790cf338b51f0b9" class="i field">dialect</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#8acf6519c578b798" class="i field">ALIAS_ASSOCIATION</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || <a href="#e790cf338b51f0b9" class="i field">dialect</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#c226a500c814138b" class="i field">URI_ASSOCIATION_DIALECT</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>if</b> (<a href="#d378eac676bd592f" class="i field">associations</a>)
                        {
                            <span class="r8 r">flags</span> |= <span class="r4 r">wsmanObject</span>.<a href="Interop.cs.html#98a12e8dbdc6a994" class="i method">EnumerationFlagAssociationInstance</a>();
                        }
                        <b>else</b>
                        {
                            <span class="r8 r">flags</span> |= <span class="r4 r">wsmanObject</span>.<a href="Interop.cs.html#31e058dfb9472714" class="i method">EnumerationFlagAssociatedInstance</a>();
                        }
 
                        <span class="r7 r">fragment</span> = <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#c226a500c814138b" class="i field">URI_ASSOCIATION_DIALECT</a>;
                        <a href="#e790cf338b51f0b9" class="i field">dialect</a> = <b>new</b> <span class="i">Uri</span>(<span class="r7 r">fragment</span>);
                    }
                    <b>else</b> <b>if</b> (<a href="#e790cf338b51f0b9" class="i field">dialect</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#7d812aedd232ec12" class="i field">ALIAS_SELECTOR</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || <a href="#e790cf338b51f0b9" class="i field">dialect</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#c30c4c5e83aad66b" class="i field">URI_SELECTOR_DIALECT</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <a href="#ae60b259d387257e" class="i field">filter</a> = <a href="#6f2635fbae254eae" class="i method">GetFilter</a>();
                        <span class="r7 r">fragment</span> = <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#c30c4c5e83aad66b" class="i field">URI_SELECTOR_DIALECT</a>;
                        <a href="#e790cf338b51f0b9" class="i field">dialect</a> = <b>new</b> <span class="i">Uri</span>(<span class="r7 r">fragment</span>);
                    }
 
                    <span class="r9 r">obj</span> = (<a href="Interop.cs.html#498ef0191bb84ab7" class="t t">IWSManEnumerator</a>)<span class="r6 r">wsmanSession</span>.<span class="i">Enumerate</span>(<span class="r5 r">wsmanResourceLocator</span>, <a href="#ae60b259d387257e" class="i field">filter</a>, <a href="#e790cf338b51f0b9" class="i field">dialect</a>.<span class="i">ToString</span>(), <span class="r8 r">flags</span>);
                }
                <b>else</b> <b>if</b> (<a href="#ae60b259d387257e" class="i field">filter</a> != <b>null</b>)
                {
                    <span class="r7 r">fragment</span> = <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#1469140f964b815c" class="i field">URI_WQL_DIALECT</a>;
                    <a href="#e790cf338b51f0b9" class="i field">dialect</a> = <b>new</b> <span class="i">Uri</span>(<span class="r7 r">fragment</span>);
                    <span class="r9 r">obj</span> = (<a href="Interop.cs.html#498ef0191bb84ab7" class="t t">IWSManEnumerator</a>)<span class="r6 r">wsmanSession</span>.<span class="i">Enumerate</span>(<span class="r5 r">wsmanResourceLocator</span>, <a href="#ae60b259d387257e" class="i field">filter</a>, <a href="#e790cf338b51f0b9" class="i field">dialect</a>.<span class="i">ToString</span>(), <span class="r8 r">flags</span>);
                }
                <b>else</b>
                {
                    <span class="r9 r">obj</span> = (<a href="Interop.cs.html#498ef0191bb84ab7" class="t t">IWSManEnumerator</a>)<span class="r6 r">wsmanSession</span>.<a href="Interop.cs.html#c9f67d876530b5e6" class="i method">Enumerate</a>(<span class="r5 r">wsmanResourceLocator</span>, <a href="#ae60b259d387257e" class="i field">filter</a>, <b>null</b>, <span class="r8 r">flags</span>);
                }
                <b>while</b> (!<span class="r9 r">obj</span>.<a href="Interop.cs.html#8ba03f47e77a0e4a" class="i property">AtEndOfStream</a>)
                {
                    <span class="i">XmlDocument</span> <span id="r10 rd" class="r10 r">xmldoc</span> = <b>new</b> <span class="i">XmlDocument</span>();
                    <span class="r10 r">xmldoc</span>.<span class="i">LoadXml</span>(<span class="r9 r">obj</span>.<a href="Interop.cs.html#d936b539122b186c" class="i method">ReadItem</a>());
                    <span class="i">WriteObject</span>(<span class="r10 r">xmldoc</span>.<span class="i">FirstChild</span>);
                }
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r11 rd" class="r11 r">ex</span>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r12 rd" class="r12 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r11 r">ex</span>, <span class="s">&quot;Exception&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                <span class="i">WriteError</span>(<span class="r12 r">er</span>);
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private
        <span class="k preprocess">#</span><span class="k preprocess">region</span> override
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProcessRecord method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="49d1b822f6c75734" href="R/49d1b822f6c75734.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a> <span id="r13 rd" class="r13 r">m_session</span> = <b>null</b>;
            <a href="Interop.cs.html#3aa0212e531a5219" class="t t">IWSManEx</a> <span id="r14 rd" class="r14 r">m_wsmanObject</span> = (<a href="Interop.cs.html#3aa0212e531a5219" class="t t">IWSManEx</a>)<b>new</b> <span class="t">WSManClass</span>();
            <a href="#f1d3cb6f040b2638" class="i field">helper</a> = <b>new</b> <a href="WsManHelper.cs.html#09f36afec28954d1" class="t constructor">WSManHelper</a>(<a href="#2dc2bd00cb2553bd" class="k">this</a>);
            <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#83a20760bb0c912e" class="i field">WSManOp</a> = <span class="s">&quot;Get&quot;</span>;
            <b>string</b> <span id="r15 rd" class="r15 r">connectionStr</span> = <b>null</b>;
            <span class="r15 r">connectionStr</span> = <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#f6d1a48cb95ecd54" class="i method">CreateConnectionString</a>(<a href="#6ab0c3d31ec485fc" class="i field">connectionuri</a>, <a href="#0885aff075dbfc86" class="i field">port</a>, <a href="#646549cc5a96cc94" class="i field">computername</a>, <a href="#52c725c9438c1c89" class="i field">applicationname</a>);
            <b>if</b> (<a href="#6ab0c3d31ec485fc" class="i field">connectionuri</a> != <b>null</b>)
            {
                <b>try</b>
                {
                    <span class="c">// in the format http(s)://server[:port/applicationname]</span>
                    <b>string</b>[] <span id="r16 rd" class="r16 r">constrsplit</span> = <a href="#6ab0c3d31ec485fc" class="i field">connectionuri</a>.<span class="i">OriginalString</span>.<span class="i">Split</span>(<span class="s">&quot;:&quot;</span> + <a href="#0885aff075dbfc86" class="i field">port</a> + <span class="s">&quot;/&quot;</span> + <a href="#52c725c9438c1c89" class="i field">applicationname</a>, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
                    <b>string</b>[] <span id="r17 rd" class="r17 r">constrsplit1</span> = <span class="r16 r">constrsplit</span>[0].<span class="i">Split</span>(<span class="s">&quot;//&quot;</span>, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
                    <a href="#646549cc5a96cc94" class="i field">computername</a> = <span class="r17 r">constrsplit1</span>[1].<span class="i">Trim</span>();
                }
                <b>catch</b> (<span class="i">IndexOutOfRangeException</span>)
                {
                    <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<span class="i">AssertError</span>(<a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NotProperURI&quot;</span>), <b>false</b>, <a href="#6ab0c3d31ec485fc" class="i field">connectionuri</a>);
                }
            }
 
            <b>try</b>
            {
                <a href="Interop.cs.html#7e09d5780a7d0f62" class="t t">IWSManResourceLocator</a> <span id="r18 rd" class="r18 r">m_resource</span> = <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#e0946b5fc0c058d5" class="i method">InitializeResourceLocator</a>(<a href="#61dc92ee6a742e0a" class="i field">optionset</a>, <a href="#d5af16d552b7ec6d" class="i field">selectorset</a>, <a href="#2988c3d0a0121f43" class="i field">fragment</a>, <a href="#e790cf338b51f0b9" class="i field">dialect</a>, <span class="r14 r">m_wsmanObject</span>, <a href="#87ddc569eaa50a90" class="i field">resourceuri</a>);
                <span class="r13 r">m_session</span> = <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#33c6c03a0959c643" class="i method">CreateSessionObject</a>(<span class="r14 r">m_wsmanObject</span>, <a href="WSManConnections.cs.html#c362b69850e25712" class="i property">Authentication</a>, <a href="#f8ebdba6b56cbbbc" class="i field">sessionoption</a>, <a href="WSManConnections.cs.html#f480b162d714220d" class="i property">Credential</a>, <span class="r15 r">connectionStr</span>, <a href="WSManConnections.cs.html#7d6e32885c5e17b8" class="i property">CertificateThumbprint</a>, <a href="#895332431b5e5c11" class="i field">usessl</a>.<a href="/System.Management.Automation/A.html#e9c777a85700d3da" class="i property">IsPresent</a>);
 
                <b>if</b> (!<a href="#51d3bf7b0ce2c9fe" class="i field">enumerate</a>)
                {
                    <span class="i">XmlDocument</span> <span id="r19 rd" class="r19 r">xmldoc</span> = <b>new</b> <span class="i">XmlDocument</span>();
                    <b>try</b>
                    {
                        <span class="r19 r">xmldoc</span>.<span class="i">LoadXml</span>(<span class="r13 r">m_session</span>.<a href="Interop.cs.html#8322aafdaa3fcc2e" class="i method">Get</a>(<span class="r18 r">m_resource</span>, 0));
                    }
                    <b>catch</b> (<span class="i">XmlException</span> <span id="r20 rd" class="r20 r">ex</span>)
                    {
                        <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<span class="i">AssertError</span>(<span class="r20 r">ex</span>.<span class="i">Message</span>, <b>false</b>, <a href="#646549cc5a96cc94" class="i field">computername</a>);
                    }
 
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#2988c3d0a0121f43" class="i field">fragment</a>))
                    {
                        <span class="i">WriteObject</span>(<span class="r19 r">xmldoc</span>.<span class="i">FirstChild</span>.<span class="i">LocalName</span> + <span class="s">&quot;=&quot;</span> + <span class="r19 r">xmldoc</span>.<span class="i">FirstChild</span>.<span class="i">InnerText</span>);
                    }
                    <b>else</b>
                    {
                        <span class="i">WriteObject</span>(<span class="r19 r">xmldoc</span>.<span class="i">FirstChild</span>);
                    }
                }
                <b>else</b>
                {
                    <b>try</b>
                    {
                        <a href="#6acd627b54d76911" class="i method">ReturnEnumeration</a>(<span class="r14 r">m_wsmanObject</span>, <span class="r18 r">m_resource</span>, <span class="r13 r">m_session</span>);
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r21 rd" class="r21 r">ex</span>)
                    {
                        <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<span class="i">AssertError</span>(<span class="r21 r">ex</span>.<span class="i">Message</span>, <b>false</b>, <a href="#646549cc5a96cc94" class="i field">computername</a>);
                    }
                }
            }
            <b>finally</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r14 r">m_wsmanObject</span>.<a href="Interop.cs.html#adbb246bea676e48" class="i property">Error</a>))
                {
                    <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<span class="i">AssertError</span>(<span class="r14 r">m_wsmanObject</span>.<a href="Interop.cs.html#adbb246bea676e48" class="i property">Error</a>, <b>true</b>, <a href="#87ddc569eaa50a90" class="i field">resourceuri</a>);
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r13 r">m_session</span>.<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>))
                {
                    <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<span class="i">AssertError</span>(<span class="r13 r">m_session</span>.<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>, <b>true</b>, <a href="#87ddc569eaa50a90" class="i field">resourceuri</a>);
                }
 
                <b>if</b> (<span class="r13 r">m_session</span> != <b>null</b>)
                    <a href="#bef3a15fb231e731" class="i method">Dispose</a>(<span class="r13 r">m_session</span>);
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> override
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        void</b>
        <a id="8522ae2205160019" href="R/8522ae2205160019.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <span class="c">// CleanUp();</span>
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#2dc2bd00cb2553bd" class="k">this</a>);
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        void</b>
        <a id="bef3a15fb231e731" href="R/bef3a15fb231e731.html" target="n" data-glyph="72,1" class="i method">Dispose</a>(<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a> <span id="r22 rd" class="r22 r">sessionObject</span>)
        {
            <span class="r22 r">sessionObject</span> = <b>null</b>;
            <a href="#2dc2bd00cb2553bd" class="k">this</a>.<a href="#8522ae2205160019" class="i method">Dispose</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> BeginProcessing method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="4964a29a37605c1c" href="R/4964a29a37605c1c.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <a href="#f1d3cb6f040b2638" class="i field">helper</a>.<a href="WsManHelper.cs.html#433651e64d8d5f3a" class="i method">CleanUp</a>();
        }
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Set-WsManInstance
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Executes action on a target object specified by RESOURCE_URI, where</span>
    <span class="c">///</span><span class="c"> parameters are specified by key value pairs.</span>
    <span class="c">///</span><span class="c"> eg., Call StartService method on the spooler service</span>
    <span class="c">///</span><span class="c"> Set-WSManInstance -Action StartService -ResourceURI wmicimv2/Win32_Service</span>
    <span class="c">///</span><span class="c"> -SelectorSet {Name=Spooler}</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="/System.Management.Automation/A.html#d881191bd45d8eb9" class="i field">Set</a>, <span class="s">&quot;WSManInstance&quot;</span>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;ComputerName&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkId=2096937&quot;</span>)]
    <b>public class</b> <a id="af75cb53a8d14a2d" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="ae89131cb5fcd662">SetWSManInstanceCommand</span></a> : <a href="WSManConnections.cs.html#9bb07ec48336aa1e" class="t t">AuthenticatingWSManCommand</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ApplicationName&quot;.</span>
        <span class="c">///</span><span class="c"> ApplicationName identifies the remote endpoint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="87ebe3c41cd0cf77" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ApplicationName</a>
        {
            <b>get</b> { <b>return</b> <a href="#6afa9649bedaff01" class="i field">applicationname</a>; }
 
            <b>set</b> { <a href="#6afa9649bedaff01" class="i field">applicationname</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="6afa9649bedaff01" href="R/6afa9649bedaff01.html" target="n" data-glyph="46,1" class="i field">applicationname</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ComputerName&quot;.</span>
        <span class="c">///</span><span class="c"> Executes the management operation on the specified computer(s). The default</span>
        <span class="c">///</span><span class="c"> is the local computer. Type the fully qualified domain name, NETBIOS name or</span>
        <span class="c">///</span><span class="c"> IP address to indicate the remote host(s)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;cn&quot;</span>)]
        <b>public string</b> <a id="06e0f360e38ad26d" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ComputerName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#3a1d484818c2a4ef" class="i field">computername</a>;
            }
 
            <b>set</b>
            {
                <a href="#3a1d484818c2a4ef" class="i field">computername</a> = <b>value</b>;
                <b>if</b> ((<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#3a1d484818c2a4ef" class="i field">computername</a>)) || (<a href="#3a1d484818c2a4ef" class="i field">computername</a>.<span class="i">Equals</span>(<span class="s">&quot;.&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                {
                    <a href="#3a1d484818c2a4ef" class="i field">computername</a> = <span class="s">&quot;localhost&quot;</span>;
                }
            }
        }
 
        <b>private string</b> <a id="3a1d484818c2a4ef" href="R/3a1d484818c2a4ef.html" target="n" data-glyph="46,1" class="i field">computername</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ConnectionURI&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies the transport, server, port, and ApplicationName of the new</span>
        <span class="c">///</span><span class="c"> runspace. The format of this string is:</span>
        <span class="c">///</span><span class="c"> transport://server:port/ApplicationName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;URI&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;URI&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Uri</span> <a id="9a31cdeb1c29459a" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ConnectionURI</a>
        {
            <b>get</b> { <b>return</b> <a href="#a2550d971dd00fec" class="i field">connectionuri</a>; }
 
            <b>set</b> { <a href="#a2550d971dd00fec" class="i field">connectionuri</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Uri</span> <a id="a2550d971dd00fec" href="R/a2550d971dd00fec.html" target="n" data-glyph="46,1" class="i field">connectionuri</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Dialect&quot;.</span>
        <span class="c">///</span><span class="c"> Defines the dialect for the filter predicate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Uri</span> <a id="8e3a110830aa1705" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Dialect</a>
        {
            <b>get</b> { <b>return</b> <a href="#37ccb8efe0cf94a8" class="i field">dialect</a>; }
 
            <b>set</b> { <a href="#37ccb8efe0cf94a8" class="i field">dialect</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Uri</span> <a id="37ccb8efe0cf94a8" href="R/37ccb8efe0cf94a8.html" target="n" data-glyph="46,1" class="i field">dialect</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;FilePath&quot;.</span>
        <span class="c">///</span><span class="c"> Updates the management resource specified by the ResourceURI and SelectorSet</span>
        <span class="c">///</span><span class="c"> via this input file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">Alias</span>(<span class="s">&quot;Path&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="cb3913c00c391f5f" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">FilePath</a>
        {
            <b>get</b> { <b>return</b> <a href="#c49ceb818dea20cb" class="i field">filepath</a>; }
 
            <b>set</b> { <a href="#c49ceb818dea20cb" class="i field">filepath</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="c49ceb818dea20cb" href="R/c49ceb818dea20cb.html" target="n" data-glyph="46,1" class="i field">filepath</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Fragment&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies a section inside the instance that is to be updated or retrieved</span>
        <span class="c">///</span><span class="c"> for the given operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;URI&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="90040c9eda71a42e" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Fragment</a>
        {
            <b>get</b> { <b>return</b> <a href="#f28dbc73055781eb" class="i field">fragment</a>; }
 
            <b>set</b> { <a href="#f28dbc73055781eb" class="i field">fragment</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="f28dbc73055781eb" href="R/f28dbc73055781eb.html" target="n" data-glyph="46,1" class="i field">fragment</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;OptionSet&quot;.</span>
        <span class="c">///</span><span class="c"> OptionSet is a hahs table which help modify or refine the nature of the</span>
        <span class="c">///</span><span class="c"> request. These are similar to switches used in command line shells in that</span>
        <span class="c">///</span><span class="c"> they are service-specific.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;os&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Hashtable</span> <a id="435abb0ed0c7cdf0" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">OptionSet</a>
        {
            <b>get</b> { <b>return</b> <a href="#7eedab8d1c47326a" class="i field">optionset</a>; }
 
            <b>set</b> { <a href="#7eedab8d1c47326a" class="i field">optionset</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Hashtable</span> <a id="7eedab8d1c47326a" href="R/7eedab8d1c47326a.html" target="n" data-glyph="46,1" class="i field">optionset</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Port&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies the port to be used when connecting to the ws management service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">ValidateRange</span>(1, <b>int</b>.<span class="i">MaxValue</span>)]
        <b>public int</b> <a id="bc89deddd6b38864" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Port</a>
        {
            <b>get</b> { <b>return</b> <a href="#cd000a30c5269062" class="i field">port</a>; }
 
            <b>set</b> { <a href="#cd000a30c5269062" class="i field">port</a> = <b>value</b>; }
        }
 
        <b>private int</b> <a id="cd000a30c5269062" href="R/cd000a30c5269062.html" target="n" data-glyph="46,1" class="i field">port</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ResourceURI&quot;.</span>
        <span class="c">///</span><span class="c"> URI of the resource class/instance representation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;URI&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Resourceuri&quot;</span>)]
 
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        [<span class="i">Alias</span>(<span class="s">&quot;ruri&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Uri</span> <a id="8d0284c2288ba355" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ResourceURI</a>
        {
            <b>get</b> { <b>return</b> <a href="#8e1d5729be2e7b37" class="i field">resourceuri</a>; }
 
            <b>set</b> { <a href="#8e1d5729be2e7b37" class="i field">resourceuri</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Uri</span> <a id="8e1d5729be2e7b37" href="R/8e1d5729be2e7b37.html" target="n" data-glyph="46,1" class="i field">resourceuri</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;SelectorSet&quot;.</span>
        <span class="c">///</span><span class="c"> SelectorSet is a hash table which helps in identify an instance of the</span>
        <span class="c">///</span><span class="c"> management resource if there are more than 1 instance of the resource</span>
        <span class="c">///</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>,
                   <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Hashtable</span> <a id="e7e0d369f1dfb426" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SelectorSet</a>
        {
            <b>get</b> { <b>return</b> <a href="#60fecf700c6ec24a" class="i field">selectorset</a>; }
 
            <b>set</b> { <a href="#60fecf700c6ec24a" class="i field">selectorset</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Hashtable</span> <a id="60fecf700c6ec24a" href="R/60fecf700c6ec24a.html" target="n" data-glyph="46,1" class="i field">selectorset</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;SessionOption&quot;.</span>
        <span class="c">///</span><span class="c"> Defines a set of extended options for the WSMan session. This can be created</span>
        <span class="c">///</span><span class="c"> by using the cmdlet New-WSManSessionOption.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;so&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <a href="/Microsoft.WSMan.Runtime/A.html#0ae1495c5b1dc50e" class="t t">SessionOption</a> <a id="01877d4538a39a49" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SessionOption</a>
        {
            <b>get</b> { <b>return</b> <a href="#a2c4e51c69c91636" class="i field">sessionoption</a>; }
 
            <b>set</b> { <a href="#a2c4e51c69c91636" class="i field">sessionoption</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="/Microsoft.WSMan.Runtime/A.html#0ae1495c5b1dc50e" class="t t">SessionOption</a> <a id="a2c4e51c69c91636" href="R/a2c4e51c69c91636.html" target="n" data-glyph="46,1" class="i field">sessionoption</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;UseSSL&quot;.</span>
        <span class="c">///</span><span class="c"> Uses the Secure Sockets Layer (SSL) protocol to establish a connection to</span>
        <span class="c">///</span><span class="c"> the remote computer. If SSL is not available on the port specified by the</span>
        <span class="c">///</span><span class="c"> Port parameter, the command fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;SSL&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;ssl&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="58e6c0570e2c229f" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">UseSSL</a>
        {
            <b>get</b> { <b>return</b> <a href="#bf3e3ece717faa9c" class="i field">usessl</a>; }
 
            <b>set</b> { <a href="#bf3e3ece717faa9c" class="i field">usessl</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="bf3e3ece717faa9c" href="R/bf3e3ece717faa9c.html" target="n" data-glyph="46,1" class="i field">usessl</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ValueSet&quot;.</span>
        <span class="c">///</span><span class="c"> ValueSet is a hash table which helps to modify resource represented by the</span>
        <span class="c">///</span><span class="c"> ResourceURI and SelectorSet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Hashtable</span> <a id="9a9be5c6a2247fe5" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ValueSet</a>
        {
            <b>get</b> { <b>return</b> <a href="#4c8d86409d9962aa" class="i field">valueset</a>; }
 
            <b>set</b> { <a href="#4c8d86409d9962aa" class="i field">valueset</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Hashtable</span> <a id="4c8d86409d9962aa" href="R/4c8d86409d9962aa.html" target="n" data-glyph="46,1" class="i field">valueset</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>private</b> <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a> <a id="50d973f6b9381bdf" href="R/50d973f6b9381bdf.html" target="n" data-glyph="46,1" class="i field">helper</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProcessRecord method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="cc70b97788b669e3" href="R/cc70b97788b669e3.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <a href="Interop.cs.html#3aa0212e531a5219" class="t t">IWSManEx</a> <span id="r23 rd" class="r23 r">m_wsmanObject</span> = (<a href="Interop.cs.html#3aa0212e531a5219" class="t t">IWSManEx</a>)<b>new</b> <span class="t">WSManClass</span>();
            <a href="#50d973f6b9381bdf" class="i field">helper</a> = <b>new</b> <a href="WsManHelper.cs.html#09f36afec28954d1" class="t constructor">WSManHelper</a>(<a href="#af75cb53a8d14a2d" class="k">this</a>);
            <a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#83a20760bb0c912e" class="i field">WSManOp</a> = <span class="s">&quot;set&quot;</span>;
            <a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a> <span id="r24 rd" class="r24 r">m_session</span> = <b>null</b>;
 
            <b>if</b> (<a href="#37ccb8efe0cf94a8" class="i field">dialect</a> != <b>null</b>)
            {
                <b>if</b> (<a href="#37ccb8efe0cf94a8" class="i field">dialect</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#053ec5d04bec9ba3" class="i field">ALIAS_WQL</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    <a href="#37ccb8efe0cf94a8" class="i field">dialect</a> = <b>new</b> <span class="i">Uri</span>(<a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#1469140f964b815c" class="i field">URI_WQL_DIALECT</a>);
                <b>if</b> (<a href="#37ccb8efe0cf94a8" class="i field">dialect</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#7d812aedd232ec12" class="i field">ALIAS_SELECTOR</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    <a href="#37ccb8efe0cf94a8" class="i field">dialect</a> = <b>new</b> <span class="i">Uri</span>(<a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#c30c4c5e83aad66b" class="i field">URI_SELECTOR_DIALECT</a>);
                <b>if</b> (<a href="#37ccb8efe0cf94a8" class="i field">dialect</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#8acf6519c578b798" class="i field">ALIAS_ASSOCIATION</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    <a href="#37ccb8efe0cf94a8" class="i field">dialect</a> = <b>new</b> <span class="i">Uri</span>(<a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#c226a500c814138b" class="i field">URI_ASSOCIATION_DIALECT</a>);
            }
 
            <b>try</b>
            {
                <b>string</b> <span id="r25 rd" class="r25 r">connectionStr</span> = <b>string</b>.<span class="i">Empty</span>;
                <span class="r25 r">connectionStr</span> = <a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#f6d1a48cb95ecd54" class="i method">CreateConnectionString</a>(<a href="#a2550d971dd00fec" class="i field">connectionuri</a>, <a href="#cd000a30c5269062" class="i field">port</a>, <a href="#3a1d484818c2a4ef" class="i field">computername</a>, <a href="#6afa9649bedaff01" class="i field">applicationname</a>);
                <b>if</b> (<a href="#a2550d971dd00fec" class="i field">connectionuri</a> != <b>null</b>)
                {
                    <b>try</b>
                    {
                        <span class="c">// in the format http(s)://server[:port/applicationname]</span>
                        <b>string</b>[] <span id="r26 rd" class="r26 r">constrsplit</span> = <a href="#a2550d971dd00fec" class="i field">connectionuri</a>.<span class="i">OriginalString</span>.<span class="i">Split</span>(<span class="s">&quot;:&quot;</span> + <a href="#cd000a30c5269062" class="i field">port</a> + <span class="s">&quot;/&quot;</span> + <a href="#6afa9649bedaff01" class="i field">applicationname</a>, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
                        <b>string</b>[] <span id="r27 rd" class="r27 r">constrsplit1</span> = <span class="r26 r">constrsplit</span>[0].<span class="i">Split</span>(<span class="s">&quot;//&quot;</span>, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
                        <a href="#3a1d484818c2a4ef" class="i field">computername</a> = <span class="r27 r">constrsplit1</span>[1].<span class="i">Trim</span>();
                    }
                    <b>catch</b> (<span class="i">IndexOutOfRangeException</span>)
                    {
                        <a href="#50d973f6b9381bdf" class="i field">helper</a>.<span class="i">AssertError</span>(<a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NotProperURI&quot;</span>), <b>false</b>, <a href="#a2550d971dd00fec" class="i field">connectionuri</a>);
                    }
                }
 
                <a href="Interop.cs.html#7e09d5780a7d0f62" class="t t">IWSManResourceLocator</a> <span id="r28 rd" class="r28 r">m_resource</span> = <a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#e0946b5fc0c058d5" class="i method">InitializeResourceLocator</a>(<a href="#7eedab8d1c47326a" class="i field">optionset</a>, <a href="#60fecf700c6ec24a" class="i field">selectorset</a>, <a href="#f28dbc73055781eb" class="i field">fragment</a>, <a href="#37ccb8efe0cf94a8" class="i field">dialect</a>, <span class="r23 r">m_wsmanObject</span>, <a href="#8e1d5729be2e7b37" class="i field">resourceuri</a>);
                <span class="r24 r">m_session</span> = <a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#33c6c03a0959c643" class="i method">CreateSessionObject</a>(<span class="r23 r">m_wsmanObject</span>, <a href="WSManConnections.cs.html#c362b69850e25712" class="i property">Authentication</a>, <a href="#a2c4e51c69c91636" class="i field">sessionoption</a>, <a href="WSManConnections.cs.html#f480b162d714220d" class="i property">Credential</a>, <span class="r25 r">connectionStr</span>, <a href="WSManConnections.cs.html#7d6e32885c5e17b8" class="i property">CertificateThumbprint</a>, <a href="#bf3e3ece717faa9c" class="i field">usessl</a>.<a href="/System.Management.Automation/A.html#e9c777a85700d3da" class="i property">IsPresent</a>);
                <b>string</b> <span id="r29 rd" class="r29 r">rootNode</span> = <a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#aa93c350039de0ce" class="i method">GetRootNodeName</a>(<a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#83a20760bb0c912e" class="i field">WSManOp</a>, <span class="r28 r">m_resource</span>.<a href="Interop.cs.html#8892f6eb879fff0d" class="i property">ResourceUri</a>, <b>null</b>);
                <b>string</b> <span id="r30 rd" class="r30 r">input</span> = <a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#b13fdb391f52b5a3" class="i method">ProcessInput</a>(<span class="r23 r">m_wsmanObject</span>, <a href="#c49ceb818dea20cb" class="i field">filepath</a>, <a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#83a20760bb0c912e" class="i field">WSManOp</a>, <span class="r29 r">rootNode</span>, <a href="#4c8d86409d9962aa" class="i field">valueset</a>, <span class="r28 r">m_resource</span>, <span class="r24 r">m_session</span>);
 
                <span class="i">XmlDocument</span> <span id="r31 rd" class="r31 r">xmldoc</span> = <b>new</b> <span class="i">XmlDocument</span>();
                <b>try</b>
                {
                    <span class="r31 r">xmldoc</span>.<span class="i">LoadXml</span>(<span class="r24 r">m_session</span>.<a href="Interop.cs.html#66ae9ead212ac68c" class="i method">Put</a>(<span class="r28 r">m_resource</span>, <span class="r30 r">input</span>, 0));
                }
                <b>catch</b> (<span class="i">XmlException</span> <span id="r32 rd" class="r32 r">ex</span>)
                {
                    <a href="#50d973f6b9381bdf" class="i field">helper</a>.<span class="i">AssertError</span>(<span class="r32 r">ex</span>.<span class="i">Message</span>, <b>false</b>, <a href="#3a1d484818c2a4ef" class="i field">computername</a>);
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#f28dbc73055781eb" class="i field">fragment</a>))
                {
                    <b>if</b> (<span class="r31 r">xmldoc</span>.<span class="i">DocumentElement</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <b>foreach</b> (<span class="i">XmlNode</span> <span id="r33 rd" class="r33 r">node</span> <b>in</b> <span class="r31 r">xmldoc</span>.<span class="i">DocumentElement</span>.<span class="i">ChildNodes</span>)
                        {
                            <b>if</b> (<span class="r33 r">node</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<a href="#f28dbc73055781eb" class="i field">fragment</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                <span class="i">WriteObject</span>(<span class="r33 r">node</span>.<span class="i">Name</span> + <span class="s">&quot; = &quot;</span> + <span class="r33 r">node</span>.<span class="i">InnerText</span>);
                        }
                    }
                }
                <b>else</b>
                    <span class="i">WriteObject</span>(<span class="r31 r">xmldoc</span>.<span class="i">DocumentElement</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r23 r">m_wsmanObject</span>.<a href="Interop.cs.html#adbb246bea676e48" class="i property">Error</a>))
                {
                    <a href="#50d973f6b9381bdf" class="i field">helper</a>.<span class="i">AssertError</span>(<span class="r23 r">m_wsmanObject</span>.<a href="Interop.cs.html#adbb246bea676e48" class="i property">Error</a>, <b>true</b>, <a href="#8e1d5729be2e7b37" class="i field">resourceuri</a>);
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r24 r">m_session</span>.<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>))
                {
                    <a href="#50d973f6b9381bdf" class="i field">helper</a>.<span class="i">AssertError</span>(<span class="r24 r">m_session</span>.<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>, <b>true</b>, <a href="#8e1d5729be2e7b37" class="i field">resourceuri</a>);
                }
 
                <b>if</b> (<span class="r24 r">m_session</span> != <b>null</b>)
                    <a href="#4c35d27c837d0572" class="i method">Dispose</a>(<span class="r24 r">m_session</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        void</b>
        <a id="73d59546f24bc340" href="R/73d59546f24bc340.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <span class="c">// CleanUp();</span>
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#af75cb53a8d14a2d" class="k">this</a>);
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        void</b>
        <a id="4c35d27c837d0572" href="R/4c35d27c837d0572.html" target="n" data-glyph="72,1" class="i method">Dispose</a>(<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a> <span id="r34 rd" class="r34 r">sessionObject</span>)
        {
            <span class="r34 r">sessionObject</span> = <b>null</b>;
            <a href="#af75cb53a8d14a2d" class="k">this</a>.<a href="#73d59546f24bc340" class="i method">Dispose</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> BeginProcessing method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="ded6bef230879303" href="R/ded6bef230879303.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <a href="#50d973f6b9381bdf" class="i field">helper</a>.<a href="WsManHelper.cs.html#433651e64d8d5f3a" class="i method">CleanUp</a>();
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Remove-WsManInstance
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Executes action on a target object specified by RESOURCE_URI, where</span>
    <span class="c">///</span><span class="c"> parameters are specified by key value pairs.</span>
    <span class="c">///</span><span class="c"> eg., Call StartService method on the spooler service</span>
    <span class="c">///</span><span class="c"> Set-WSManInstance -Action StartService -ResourceURI wmicimv2/Win32_Service</span>
    <span class="c">///</span><span class="c"> -SelectorSet {Name=Spooler}</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="/System.Management.Automation/A.html#ac76dfa67303c925" class="i field">Remove</a>, <span class="s">&quot;WSManInstance&quot;</span>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;ComputerName&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkId=2096721&quot;</span>)]
    <b>public class</b> <a id="a919c8a262449c12" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="c4df00878123817d">RemoveWSManInstanceCommand</span></a> : <a href="WSManConnections.cs.html#9bb07ec48336aa1e" class="t t">AuthenticatingWSManCommand</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameters
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ApplicationName&quot;.</span>
        <span class="c">///</span><span class="c"> ApplicationName identifies the remote endpoint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="d9f7198878ba3e7f" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ApplicationName</a>
        {
            <b>get</b> { <b>return</b> <a href="#19955ca1e431eb2c" class="i field">applicationname</a>; }
 
            <b>set</b> { <a href="#19955ca1e431eb2c" class="i field">applicationname</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="19955ca1e431eb2c" href="R/19955ca1e431eb2c.html" target="n" data-glyph="46,1" class="i field">applicationname</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ComputerName&quot;.</span>
        <span class="c">///</span><span class="c"> Executes the management operation on the specified computer(s). The default</span>
        <span class="c">///</span><span class="c"> is the local computer. Type the fully qualified domain name, NETBIOS name or</span>
        <span class="c">///</span><span class="c"> IP address to indicate the remote host(s)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;cn&quot;</span>)]
        <b>public string</b> <a id="429b80db35d5000b" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ComputerName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#ce3395d6cde90a47" class="i field">computername</a>;
            }
 
            <b>set</b>
            {
                <a href="#ce3395d6cde90a47" class="i field">computername</a> = <b>value</b>;
                <b>if</b> ((<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#ce3395d6cde90a47" class="i field">computername</a>)) || (<a href="#ce3395d6cde90a47" class="i field">computername</a>.<span class="i">Equals</span>(<span class="s">&quot;.&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                {
                    <a href="#ce3395d6cde90a47" class="i field">computername</a> = <span class="s">&quot;localhost&quot;</span>;
                }
            }
        }
 
        <b>private string</b> <a id="ce3395d6cde90a47" href="R/ce3395d6cde90a47.html" target="n" data-glyph="46,1" class="i field">computername</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ConnectionURI&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies the transport, server, port, and ApplicationName of the new</span>
        <span class="c">///</span><span class="c"> runspace. The format of this string is:</span>
        <span class="c">///</span><span class="c"> transport://server:port/ApplicationName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;URI&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;URI&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Uri</span> <a id="24fd7f9afa8bcd26" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ConnectionURI</a>
        {
            <b>get</b> { <b>return</b> <a href="#56e0855605857e82" class="i field">connectionuri</a>; }
 
            <b>set</b> { <a href="#56e0855605857e82" class="i field">connectionuri</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Uri</span> <a id="56e0855605857e82" href="R/56e0855605857e82.html" target="n" data-glyph="46,1" class="i field">connectionuri</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;OptionSet&quot;.</span>
        <span class="c">///</span><span class="c"> OptionSet is a hahs table which help modify or refine the nature of the</span>
        <span class="c">///</span><span class="c"> request. These are similar to switches used in command line shells in that</span>
        <span class="c">///</span><span class="c"> they are service-specific.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;os&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Hashtable</span> <a id="80136ef9b56dd777" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">OptionSet</a>
        {
            <b>get</b> { <b>return</b> <a href="#656deca9236c5a6a" class="i field">optionset</a>; }
 
            <b>set</b> { <a href="#656deca9236c5a6a" class="i field">optionset</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Hashtable</span> <a id="656deca9236c5a6a" href="R/656deca9236c5a6a.html" target="n" data-glyph="46,1" class="i field">optionset</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Port&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies the port to be used when connecting to the ws management service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">ValidateRange</span>(1, <b>int</b>.<span class="i">MaxValue</span>)]
        <b>public int</b> <a id="965a53b0327ee06e" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Port</a>
        {
            <b>get</b> { <b>return</b> <a href="#db3ec1597961b786" class="i field">port</a>; }
 
            <b>set</b> { <a href="#db3ec1597961b786" class="i field">port</a> = <b>value</b>; }
        }
 
        <b>private int</b> <a id="db3ec1597961b786" href="R/db3ec1597961b786.html" target="n" data-glyph="46,1" class="i field">port</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ResourceURI&quot;.</span>
        <span class="c">///</span><span class="c"> URI of the resource class/instance representation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;URI&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Resourceuri&quot;</span>)]
 
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        [<span class="i">Alias</span>(<span class="s">&quot;ruri&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Uri</span> <a id="50540f3e66a63f61" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ResourceURI</a>
        {
            <b>get</b> { <b>return</b> <a href="#5398b95afb5d9563" class="i field">resourceuri</a>; }
 
            <b>set</b> { <a href="#5398b95afb5d9563" class="i field">resourceuri</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Uri</span> <a id="5398b95afb5d9563" href="R/5398b95afb5d9563.html" target="n" data-glyph="46,1" class="i field">resourceuri</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;SelectorSet&quot;.</span>
        <span class="c">///</span><span class="c"> SelectorSet is a hash table which helps in identify an instance of the</span>
        <span class="c">///</span><span class="c"> management resource if there are more than 1 instance of the resource</span>
        <span class="c">///</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>,
                   <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>,
                   <a href="/System.Management.Automation/A.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <b>true</b>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i">Hashtable</span> <a id="87f727f9820d74c8" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SelectorSet</a>
        {
            <b>get</b> { <b>return</b> <a href="#488531294ea49e9f" class="i field">selectorset</a>; }
 
            <b>set</b> { <a href="#488531294ea49e9f" class="i field">selectorset</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Hashtable</span> <a id="488531294ea49e9f" href="R/488531294ea49e9f.html" target="n" data-glyph="46,1" class="i field">selectorset</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;SessionOption&quot;.</span>
        <span class="c">///</span><span class="c"> Defines a set of extended options for the WSMan session. This can be created</span>
        <span class="c">///</span><span class="c"> by using the cmdlet New-WSManSessionOption.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;so&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <a href="/Microsoft.WSMan.Runtime/A.html#0ae1495c5b1dc50e" class="t t">SessionOption</a> <a id="3b6c8b957aeef7cf" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SessionOption</a>
        {
            <b>get</b> { <b>return</b> <a href="#4232574ba3e7e014" class="i field">sessionoption</a>; }
 
            <b>set</b> { <a href="#4232574ba3e7e014" class="i field">sessionoption</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="/Microsoft.WSMan.Runtime/A.html#0ae1495c5b1dc50e" class="t t">SessionOption</a> <a id="4232574ba3e7e014" href="R/4232574ba3e7e014.html" target="n" data-glyph="46,1" class="i field">sessionoption</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;UseSSL&quot;.</span>
        <span class="c">///</span><span class="c"> Uses the Secure Sockets Layer (SSL) protocol to establish a connection to</span>
        <span class="c">///</span><span class="c"> the remote computer. If SSL is not available on the port specified by the</span>
        <span class="c">///</span><span class="c"> Port parameter, the command fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;SSL&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;ssl&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="a2439fac2b13154c" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">UseSSL</a>
        {
            <b>get</b> { <b>return</b> <a href="#4685128139d9d8ef" class="i field">usessl</a>; }
 
            <b>set</b> { <a href="#4685128139d9d8ef" class="i field">usessl</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="4685128139d9d8ef" href="R/4685128139d9d8ef.html" target="n" data-glyph="46,1" class="i field">usessl</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProcessRecord method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="1cd9735dadffd05a" href="R/1cd9735dadffd05a.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a> <span id="r35 rd" class="r35 r">helper</span> = <b>new</b> <a href="WsManHelper.cs.html#09f36afec28954d1" class="t constructor">WSManHelper</a>(<a href="#a919c8a262449c12" class="k">this</a>);
            <a href="Interop.cs.html#3aa0212e531a5219" class="t t">IWSManEx</a> <span id="r36 rd" class="r36 r">m_wsmanObject</span> = (<a href="Interop.cs.html#3aa0212e531a5219" class="t t">IWSManEx</a>)<b>new</b> <span class="t">WSManClass</span>();
            <span class="r35 r">helper</span>.<a href="WsManHelper.cs.html#83a20760bb0c912e" class="i field">WSManOp</a> = <span class="s">&quot;remove&quot;</span>;
            <a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a> <span id="r37 rd" class="r37 r">m_session</span> = <b>null</b>;
            <b>try</b>
            {
                <b>string</b> <span id="r38 rd" class="r38 r">connectionStr</span> = <b>string</b>.<span class="i">Empty</span>;
                <span class="r38 r">connectionStr</span> = <span class="r35 r">helper</span>.<a href="WsManHelper.cs.html#f6d1a48cb95ecd54" class="i method">CreateConnectionString</a>(<a href="#56e0855605857e82" class="i field">connectionuri</a>, <a href="#db3ec1597961b786" class="i field">port</a>, <a href="#ce3395d6cde90a47" class="i field">computername</a>, <a href="#19955ca1e431eb2c" class="i field">applicationname</a>);
                <b>if</b> (<a href="#56e0855605857e82" class="i field">connectionuri</a> != <b>null</b>)
                {
                    <b>try</b>
                    {
                        <span class="c">// in the format http(s)://server[:port/applicationname]</span>
                        <b>string</b>[] <span id="r39 rd" class="r39 r">constrsplit</span> = <a href="#56e0855605857e82" class="i field">connectionuri</a>.<span class="i">OriginalString</span>.<span class="i">Split</span>(<span class="s">&quot;:&quot;</span> + <a href="#db3ec1597961b786" class="i field">port</a> + <span class="s">&quot;/&quot;</span> + <a href="#19955ca1e431eb2c" class="i field">applicationname</a>, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
                        <b>string</b>[] <span id="r40 rd" class="r40 r">constrsplit1</span> = <span class="r39 r">constrsplit</span>[0].<span class="i">Split</span>(<span class="s">&quot;//&quot;</span>, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
                        <a href="#ce3395d6cde90a47" class="i field">computername</a> = <span class="r40 r">constrsplit1</span>[1].<span class="i">Trim</span>();
                    }
                    <b>catch</b> (<span class="i">IndexOutOfRangeException</span>)
                    {
                        <span class="r35 r">helper</span>.<span class="i">AssertError</span>(<span class="r35 r">helper</span>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NotProperURI&quot;</span>), <b>false</b>, <a href="#56e0855605857e82" class="i field">connectionuri</a>);
                    }
                }
 
                <a href="Interop.cs.html#7e09d5780a7d0f62" class="t t">IWSManResourceLocator</a> <span id="r41 rd" class="r41 r">m_resource</span> = <span class="r35 r">helper</span>.<a href="WsManHelper.cs.html#e0946b5fc0c058d5" class="i method">InitializeResourceLocator</a>(<a href="#656deca9236c5a6a" class="i field">optionset</a>, <a href="#488531294ea49e9f" class="i field">selectorset</a>, <b>null</b>, <b>null</b>, <span class="r36 r">m_wsmanObject</span>, <a href="#5398b95afb5d9563" class="i field">resourceuri</a>);
                <span class="r37 r">m_session</span> = <span class="r35 r">helper</span>.<a href="WsManHelper.cs.html#33c6c03a0959c643" class="i method">CreateSessionObject</a>(<span class="r36 r">m_wsmanObject</span>, <a href="WSManConnections.cs.html#c362b69850e25712" class="i property">Authentication</a>, <a href="#4232574ba3e7e014" class="i field">sessionoption</a>, <a href="WSManConnections.cs.html#f480b162d714220d" class="i property">Credential</a>, <span class="r38 r">connectionStr</span>, <a href="WSManConnections.cs.html#7d6e32885c5e17b8" class="i property">CertificateThumbprint</a>, <a href="#4685128139d9d8ef" class="i field">usessl</a>.<a href="/System.Management.Automation/A.html#e9c777a85700d3da" class="i property">IsPresent</a>);
                <b>string</b> <span id="r42 rd" class="r42 r">ResourceURI</span> = <span class="r35 r">helper</span>.<span class="i">GetURIWithFilter</span>(<a href="#5398b95afb5d9563" class="i field">resourceuri</a>.<span class="i">ToString</span>(), <b>null</b>, <a href="#488531294ea49e9f" class="i field">selectorset</a>, <span class="r35 r">helper</span>.<a href="WsManHelper.cs.html#83a20760bb0c912e" class="i field">WSManOp</a>);
                <b>try</b>
                {
                    ((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r37 r">m_session</span>).<a href="Interop.cs.html#2b0a2c44ae3a3303" class="i method">Delete</a>(<span class="r42 r">ResourceURI</span>, 0);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r43 rd" class="r43 r">ex</span>)
                {
                    <span class="r35 r">helper</span>.<span class="i">AssertError</span>(<span class="r43 r">ex</span>.<span class="i">Message</span>, <b>false</b>, <a href="#ce3395d6cde90a47" class="i field">computername</a>);
                }
            }
            <b>finally</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r37 r">m_session</span>.<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>))
                {
                    <span class="r35 r">helper</span>.<span class="i">AssertError</span>(<span class="r37 r">m_session</span>.<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>, <b>true</b>, <a href="#5398b95afb5d9563" class="i field">resourceuri</a>);
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r36 r">m_wsmanObject</span>.<a href="Interop.cs.html#adbb246bea676e48" class="i property">Error</a>))
                {
                    <span class="r35 r">helper</span>.<span class="i">AssertError</span>(<span class="r36 r">m_wsmanObject</span>.<a href="Interop.cs.html#adbb246bea676e48" class="i property">Error</a>, <b>true</b>, <a href="#5398b95afb5d9563" class="i field">resourceuri</a>);
                }
 
                <b>if</b> (<span class="r37 r">m_session</span> != <b>null</b>)
                    <a href="#86f322d5edf1ff4d" class="i method">Dispose</a>(<span class="r37 r">m_session</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        void</b>
        <a id="ceee73ccbd4c3699" href="R/ceee73ccbd4c3699.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <span class="c">// CleanUp();</span>
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#a919c8a262449c12" class="k">this</a>);
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        void</b>
        <a id="86f322d5edf1ff4d" href="R/86f322d5edf1ff4d.html" target="n" data-glyph="72,1" class="i method">Dispose</a>(<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a> <span id="r44 rd" class="r44 r">sessionObject</span>)
        {
            <span class="r44 r">sessionObject</span> = <b>null</b>;
            <a href="#a919c8a262449c12" class="k">this</a>.<a href="#ceee73ccbd4c3699" class="i method">Dispose</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Members
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> New-WsManInstance
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Creates an instance of a management resource identified by the resource URI</span>
    <span class="c">///</span><span class="c"> using specified ValueSet or input File.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Cmdlet</span>(<a href="/System.Management.Automation/A.html#d056c4b8c99405e5" class="t t">VerbsCommon</a>.<a href="/System.Management.Automation/A.html#275f319554270c33" class="i field">New</a>, <span class="s">&quot;WSManInstance&quot;</span>, <span class="i">DefaultParameterSetName</span> = <span class="s">&quot;ComputerName&quot;</span>, <span class="i">HelpUri</span> = <span class="s">&quot;https://go.microsoft.com/fwlink/?LinkId=2096933&quot;</span>)]
    <b>public class</b> <a id="7680a3dd8ac88700" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="9ece93acf04f1bc0">NewWSManInstanceCommand</span></a> : <a href="WSManConnections.cs.html#9bb07ec48336aa1e" class="t t">AuthenticatingWSManCommand</a>, <span class="i">IDisposable</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ApplicationName&quot;.</span>
        <span class="c">///</span><span class="c"> ApplicationName identifies the remote endpoint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="4e512166311f92c8" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ApplicationName</a>
        {
            <b>get</b> { <b>return</b> <a href="#b7d406bf466eb30e" class="i field">applicationname</a>; }
 
            <b>set</b> { <a href="#b7d406bf466eb30e" class="i field">applicationname</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="b7d406bf466eb30e" href="R/b7d406bf466eb30e.html" target="n" data-glyph="46,1" class="i field">applicationname</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ComputerName&quot;.</span>
        <span class="c">///</span><span class="c"> Executes the management operation on the specified computer(s). The default</span>
        <span class="c">///</span><span class="c"> is the local computer. Type the fully qualified domain name, NETBIOS name or</span>
        <span class="c">///</span><span class="c"> IP address to indicate the remote host(s)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;cn&quot;</span>)]
        <b>public string</b> <a id="204497dbb6ff1874" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ComputerName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#359eea9d685a706c" class="i field">computername</a>;
            }
 
            <b>set</b>
            {
                <a href="#359eea9d685a706c" class="i field">computername</a> = <b>value</b>;
                <b>if</b> ((<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#359eea9d685a706c" class="i field">computername</a>)) || (<a href="#359eea9d685a706c" class="i field">computername</a>.<span class="i">Equals</span>(<span class="s">&quot;.&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                {
                    <a href="#359eea9d685a706c" class="i field">computername</a> = <span class="s">&quot;localhost&quot;</span>;
                }
            }
        }
 
        <b>private string</b> <a id="359eea9d685a706c" href="R/359eea9d685a706c.html" target="n" data-glyph="46,1" class="i field">computername</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ConnectionURI&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies the transport, server, port, and ApplicationName of the new</span>
        <span class="c">///</span><span class="c"> runspace. The format of this string is:</span>
        <span class="c">///</span><span class="c"> transport://server:port/ApplicationName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;URI&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;CURI&quot;</span>, <span class="s">&quot;CU&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;URI&quot;</span>)]
        <b>public</b> <span class="i">Uri</span> <a id="c8d0815c43205566" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ConnectionURI</a>
        {
            <b>get</b> { <b>return</b> <a href="#7fd07fd1bb348f3a" class="i field">connectionuri</a>; }
 
            <b>set</b> { <a href="#7fd07fd1bb348f3a" class="i field">connectionuri</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Uri</span> <a id="7fd07fd1bb348f3a" href="R/7fd07fd1bb348f3a.html" target="n" data-glyph="46,1" class="i field">connectionuri</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;FilePath&quot;.</span>
        <span class="c">///</span><span class="c"> Updates the management resource specified by the ResourceURI and SelectorSet</span>
        <span class="c">///</span><span class="c"> via this input file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;Path&quot;</span>)]
        <b>public string</b> <a id="c258c3a3a9e01735" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">FilePath</a>
        {
            <b>get</b> { <b>return</b> <a href="#ae8751a305357ce8" class="i field">filepath</a>; }
 
            <b>set</b> { <a href="#ae8751a305357ce8" class="i field">filepath</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="ae8751a305357ce8" href="R/ae8751a305357ce8.html" target="n" data-glyph="46,1" class="i field">filepath</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;OptionSet&quot;.</span>
        <span class="c">///</span><span class="c"> OptionSet is a hash table and is used to pass a set of switches to the</span>
        <span class="c">///</span><span class="c"> service to modify or refine the nature of the request.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;os&quot;</span>)]
        <b>public</b> <span class="i">Hashtable</span> <a id="69a5b3d9864237e2" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">OptionSet</a>
        {
            <b>get</b> { <b>return</b> <a href="#3c00e27b0c6bbe7c" class="i field">optionset</a>; }
 
            <b>set</b> { <a href="#3c00e27b0c6bbe7c" class="i field">optionset</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Hashtable</span> <a id="3c00e27b0c6bbe7c" href="R/3c00e27b0c6bbe7c.html" target="n" data-glyph="46,1" class="i field">optionset</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Port&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies the port to be used when connecting to the ws management service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">ValidateRange</span>(1, <b>int</b>.<span class="i">MaxValue</span>)]
        <b>public int</b> <a id="716ef8122f1d57d5" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Port</a>
        {
            <b>get</b> { <b>return</b> <a href="#b93f25c7f40100ba" class="i field">port</a>; }
 
            <b>set</b> { <a href="#b93f25c7f40100ba" class="i field">port</a> = <b>value</b>; }
        }
 
        <b>private int</b> <a id="b93f25c7f40100ba" href="R/b93f25c7f40100ba.html" target="n" data-glyph="46,1" class="i field">port</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ResourceURI&quot;.</span>
        <span class="c">///</span><span class="c"> URI of the resource class/instance representation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;ruri&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;URI&quot;</span>)]
        <b>public</b> <span class="i">Uri</span> <a id="4478f1825150f750" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ResourceURI</a>
        {
            <b>get</b> { <b>return</b> <a href="#a59cebab9d634cb1" class="i field">resourceuri</a>; }
 
            <b>set</b> { <a href="#a59cebab9d634cb1" class="i field">resourceuri</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Uri</span> <a id="a59cebab9d634cb1" href="R/a59cebab9d634cb1.html" target="n" data-glyph="46,1" class="i field">resourceuri</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;SelectorSet&quot;.</span>
        <span class="c">///</span><span class="c"> SelectorSet is a hash table which helps in identify an instance of the</span>
        <span class="c">///</span><span class="c"> management resource if there are more than 1 instance of the resource</span>
        <span class="c">///</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1,
                   <a href="/System.Management.Automation/A.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <span class="i">Hashtable</span> <a id="d829074d7ac97efc" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SelectorSet</a>
        {
            <b>get</b> { <b>return</b> <a href="#8e7646221fd68972" class="i field">selectorset</a>; }
 
            <b>set</b> { <a href="#8e7646221fd68972" class="i field">selectorset</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Hashtable</span> <a id="8e7646221fd68972" href="R/8e7646221fd68972.html" target="n" data-glyph="46,1" class="i field">selectorset</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;SessionOption&quot;.</span>
        <span class="c">///</span><span class="c"> Defines a set of extended options for the WSMan session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        [<span class="i">Alias</span>(<span class="s">&quot;so&quot;</span>)]
        <b>public</b> <a href="/Microsoft.WSMan.Runtime/A.html#0ae1495c5b1dc50e" class="t t">SessionOption</a> <a id="34faead66513e0d5" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SessionOption</a>
        {
            <b>get</b> { <b>return</b> <a href="#739867979a6954e8" class="i field">sessionoption</a>; }
 
            <b>set</b> { <a href="#739867979a6954e8" class="i field">sessionoption</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="/Microsoft.WSMan.Runtime/A.html#0ae1495c5b1dc50e" class="t t">SessionOption</a> <a id="739867979a6954e8" href="R/739867979a6954e8.html" target="n" data-glyph="46,1" class="i field">sessionoption</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;UseSSL&quot;.</span>
        <span class="c">///</span><span class="c"> Uses the Secure Sockets Layer (SSL) protocol to establish a connection to</span>
        <span class="c">///</span><span class="c"> the remote computer. If SSL is not available on the port specified by the</span>
        <span class="c">///</span><span class="c"> Port parameter, the command fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;ComputerName&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;SSL&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="e081c93e05da4f05" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">UseSSL</a>
        {
            <b>get</b> { <b>return</b> <a href="#2b81ec26cd34a259" class="i field">usessl</a>; }
 
            <b>set</b> { <a href="#2b81ec26cd34a259" class="i field">usessl</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="2b81ec26cd34a259" href="R/2b81ec26cd34a259.html" target="n" data-glyph="46,1" class="i field">usessl</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ValueSet&quot;.</span>
        <span class="c">///</span><span class="c"> ValueSet is a hash table which helps to modify resource represented by the</span>
        <span class="c">///</span><span class="c"> ResourceURI and SelectorSet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <span class="i">Hashtable</span> <a id="c5150ebd50185c65" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ValueSet</a>
        {
            <b>get</b> { <b>return</b> <a href="#127e6e893de6e803" class="i field">valueset</a>; }
 
            <b>set</b> { <a href="#127e6e893de6e803" class="i field">valueset</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Hashtable</span> <a id="127e6e893de6e803" href="R/127e6e893de6e803.html" target="n" data-glyph="46,1" class="i field">valueset</a>;
 
        <b>private</b> <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a> <a id="f634d2fbd4978c3c" href="R/f634d2fbd4978c3c.html" target="n" data-glyph="46,1" class="i field">helper</a>;
        <b>private readonly</b> <a href="Interop.cs.html#3aa0212e531a5219" class="t t">IWSManEx</a> <a id="d0d91d484f6ea016" href="R/d0d91d484f6ea016.html" target="n" data-glyph="46,1" class="i field">m_wsmanObject</a> = (<a href="Interop.cs.html#3aa0212e531a5219" class="t t">IWSManEx</a>)<b>new</b> <span class="t">WSManClass</span>();
        <b>private</b> <a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a> <a id="97fcad54e5bccf92" href="R/97fcad54e5bccf92.html" target="n" data-glyph="46,1" class="i field">m_session</a> = <b>null</b>;
        <b>private string</b> <a id="dd39aeda1fd1405b" href="R/dd39aeda1fd1405b.html" target="n" data-glyph="46,1" class="i field">connectionStr</a> = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> BeginProcessing method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="70d7f95b55c91665" href="R/70d7f95b55c91665.html" target="n" data-glyph="75,1" class="i method">BeginProcessing</a>()
        {
            <a href="#f634d2fbd4978c3c" class="i field">helper</a> = <b>new</b> <a href="WsManHelper.cs.html#09f36afec28954d1" class="t constructor">WSManHelper</a>(<a href="#7680a3dd8ac88700" class="k">this</a>);
            <a href="#f634d2fbd4978c3c" class="i field">helper</a>.<a href="WsManHelper.cs.html#83a20760bb0c912e" class="i field">WSManOp</a> = <span class="s">&quot;new&quot;</span>;
            <a href="#dd39aeda1fd1405b" class="i field">connectionStr</a> = <a href="#f634d2fbd4978c3c" class="i field">helper</a>.<a href="WsManHelper.cs.html#f6d1a48cb95ecd54" class="i method">CreateConnectionString</a>(<a href="#7fd07fd1bb348f3a" class="i field">connectionuri</a>, <a href="#b93f25c7f40100ba" class="i field">port</a>, <a href="#359eea9d685a706c" class="i field">computername</a>, <a href="#b7d406bf466eb30e" class="i field">applicationname</a>);
            <b>if</b> (<a href="#7fd07fd1bb348f3a" class="i field">connectionuri</a> != <b>null</b>)
            {
                <b>try</b>
                {
                    <span class="c">// in the format http(s)://server[:port/applicationname]</span>
                    <b>string</b>[] <span id="r45 rd" class="r45 r">constrsplit</span> = <a href="#7fd07fd1bb348f3a" class="i field">connectionuri</a>.<span class="i">OriginalString</span>.<span class="i">Split</span>(<span class="s">&quot;:&quot;</span> + <a href="#b93f25c7f40100ba" class="i field">port</a> + <span class="s">&quot;/&quot;</span> + <a href="#b7d406bf466eb30e" class="i field">applicationname</a>, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
                    <b>string</b>[] <span id="r46 rd" class="r46 r">constrsplit1</span> = <span class="r45 r">constrsplit</span>[0].<span class="i">Split</span>(<span class="s">&quot;//&quot;</span>, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
                    <a href="#359eea9d685a706c" class="i field">computername</a> = <span class="r46 r">constrsplit1</span>[1].<span class="i">Trim</span>();
                }
                <b>catch</b> (<span class="i">IndexOutOfRangeException</span>)
                {
                    <a href="#f634d2fbd4978c3c" class="i field">helper</a>.<span class="i">AssertError</span>(<a href="#f634d2fbd4978c3c" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NotProperURI&quot;</span>), <b>false</b>, <a href="#7fd07fd1bb348f3a" class="i field">connectionuri</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProcessRecord method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="12e92d1d1ea7623a" href="R/12e92d1d1ea7623a.html" target="n" data-glyph="75,1" class="i method">ProcessRecord</a>()
        {
            <b>try</b>
            {
                <a href="Interop.cs.html#7e09d5780a7d0f62" class="t t">IWSManResourceLocator</a> <span id="r47 rd" class="r47 r">m_resource</span> = <a href="#f634d2fbd4978c3c" class="i field">helper</a>.<a href="WsManHelper.cs.html#e0946b5fc0c058d5" class="i method">InitializeResourceLocator</a>(<a href="#3c00e27b0c6bbe7c" class="i field">optionset</a>, <a href="#8e7646221fd68972" class="i field">selectorset</a>, <b>null</b>, <b>null</b>, <a href="#d0d91d484f6ea016" class="i field">m_wsmanObject</a>, <a href="#a59cebab9d634cb1" class="i field">resourceuri</a>);
                <span class="c">// create the session object</span>
                <a href="#97fcad54e5bccf92" class="i field">m_session</a> = <a href="#f634d2fbd4978c3c" class="i field">helper</a>.<a href="WsManHelper.cs.html#33c6c03a0959c643" class="i method">CreateSessionObject</a>(<a href="#d0d91d484f6ea016" class="i field">m_wsmanObject</a>, <a href="WSManConnections.cs.html#c362b69850e25712" class="i property">Authentication</a>, <a href="#739867979a6954e8" class="i field">sessionoption</a>, <a href="WSManConnections.cs.html#f480b162d714220d" class="i property">Credential</a>, <a href="#dd39aeda1fd1405b" class="i field">connectionStr</a>, <a href="WSManConnections.cs.html#7d6e32885c5e17b8" class="i property">CertificateThumbprint</a>, <a href="#2b81ec26cd34a259" class="i field">usessl</a>.<a href="/System.Management.Automation/A.html#e9c777a85700d3da" class="i property">IsPresent</a>);
                <b>string</b> <span id="r48 rd" class="r48 r">rootNode</span> = <a href="#f634d2fbd4978c3c" class="i field">helper</a>.<a href="WsManHelper.cs.html#aa93c350039de0ce" class="i method">GetRootNodeName</a>(<a href="#f634d2fbd4978c3c" class="i field">helper</a>.<a href="WsManHelper.cs.html#83a20760bb0c912e" class="i field">WSManOp</a>, <span class="r47 r">m_resource</span>.<a href="Interop.cs.html#8892f6eb879fff0d" class="i property">ResourceUri</a>, <b>null</b>);
                <b>string</b> <span id="r49 rd" class="r49 r">input</span> = <a href="#f634d2fbd4978c3c" class="i field">helper</a>.<a href="WsManHelper.cs.html#b13fdb391f52b5a3" class="i method">ProcessInput</a>(<a href="#d0d91d484f6ea016" class="i field">m_wsmanObject</a>, <a href="#ae8751a305357ce8" class="i field">filepath</a>, <a href="#f634d2fbd4978c3c" class="i field">helper</a>.<a href="WsManHelper.cs.html#83a20760bb0c912e" class="i field">WSManOp</a>, <span class="r48 r">rootNode</span>, <a href="#127e6e893de6e803" class="i field">valueset</a>, <span class="r47 r">m_resource</span>, <a href="#97fcad54e5bccf92" class="i field">m_session</a>);
 
                <b>try</b>
                {
                    <b>string</b> <span id="r50 rd" class="r50 r">resultXml</span> = <a href="#97fcad54e5bccf92" class="i field">m_session</a>.<a href="Interop.cs.html#7ae0beaa00c8c5fb" class="i method">Create</a>(<span class="r47 r">m_resource</span>, <span class="r49 r">input</span>, 0);
                    <span class="i">XmlDocument</span> <span id="r51 rd" class="r51 r">xmldoc</span> = <b>new</b> <span class="i">XmlDocument</span>();
                    <span class="r51 r">xmldoc</span>.<span class="i">LoadXml</span>(<span class="r50 r">resultXml</span>);
                    <span class="i">WriteObject</span>(<span class="r51 r">xmldoc</span>.<span class="i">DocumentElement</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r52 rd" class="r52 r">ex</span>)
                {
                    <a href="#f634d2fbd4978c3c" class="i field">helper</a>.<span class="i">AssertError</span>(<span class="r52 r">ex</span>.<span class="i">Message</span>, <b>false</b>, <a href="#359eea9d685a706c" class="i field">computername</a>);
                }
            }
            <b>finally</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#d0d91d484f6ea016" class="i field">m_wsmanObject</a>.<a href="Interop.cs.html#adbb246bea676e48" class="i property">Error</a>))
                {
                    <a href="#f634d2fbd4978c3c" class="i field">helper</a>.<span class="i">AssertError</span>(<a href="#d0d91d484f6ea016" class="i field">m_wsmanObject</a>.<a href="Interop.cs.html#adbb246bea676e48" class="i property">Error</a>, <b>true</b>, <a href="#a59cebab9d634cb1" class="i field">resourceuri</a>);
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#97fcad54e5bccf92" class="i field">m_session</a>.<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>))
                {
                    <a href="#f634d2fbd4978c3c" class="i field">helper</a>.<span class="i">AssertError</span>(<a href="#97fcad54e5bccf92" class="i field">m_session</a>.<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>, <b>true</b>, <a href="#a59cebab9d634cb1" class="i field">resourceuri</a>);
                }
 
                <b>if</b> (<a href="#97fcad54e5bccf92" class="i field">m_session</a> != <b>null</b>)
                {
                    <a href="#7d63d126efae070f" class="i method">Dispose</a>(<a href="#97fcad54e5bccf92" class="i field">m_session</a>);
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        void</b>
        <a id="09993ec1925bb0ae" href="R/09993ec1925bb0ae.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <span class="c">// CleanUp();</span>
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#7680a3dd8ac88700" class="k">this</a>);
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Public dispose method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        void</b>
        <a id="7d63d126efae070f" href="R/7d63d126efae070f.html" target="n" data-glyph="72,1" class="i method">Dispose</a>(<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a> <span id="r53 rd" class="r53 r">sessionObject</span>)
        {
            <span class="r53 r">sessionObject</span> = <b>null</b>;
            <a href="#7680a3dd8ac88700" class="k">this</a>.<a href="#09993ec1925bb0ae" class="i method">Dispose</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> IDisposable Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> EndProcessing method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="176576213aa83abd" href="R/176576213aa83abd.html" target="n" data-glyph="75,1" class="i method">EndProcessing</a>()
        {
            <a href="#f634d2fbd4978c3c" class="i field">helper</a>.<a href="WsManHelper.cs.html#433651e64d8d5f3a" class="i method">CleanUp</a>();
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
}
</pre></td></tr></table></div></body></html>
