<!DOCTYPE html>
<html><head><title>ConfigProvider.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(6588);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Microsoft.WSMan.Management/ConfigProvider.cs" target="_top">ConfigProvider.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Microsoft.WSMan.Management" target="_top">src\Microsoft.WSMan.Management\Microsoft.WSMan.Management.csproj</a> (Microsoft.WSMan.Management)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Provider</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">ServiceProcess</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">RegularExpressions</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Xml</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XPath</span>;
 
<b>namespace</b> <span class="i n">Microsoft</span>.<span class="i n">WSMan</span>.<span class="i n">Management</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> WsMan Provider.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">CmdletProvider</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b9823ecab71df44a" class="i field">ProviderName</a>, <a href="/System.Management.Automation/A.html#a29c0c50418632fb" class="t t">ProviderCapabilities</a>.<a href="/System.Management.Automation/A.html#8969d2fbdec34d82" class="i field">Credentials</a>)]
    <b>public sealed class</b> <a id="959910a828c6b791" href="R/../../0000000000.html" target="n" data-glyph="0,0" class="t t"><span id="72564e546c3ed1d9">WSManConfigProvider</span></a> : <a href="/System.Management.Automation/A.html#7d31476313596b0b" class="t t">NavigationCmdletProvider</a>, <a href="/System.Management.Automation/A.html#3e872a90de02a9b2" class="t t">ICmdletProviderSupportsHelp</a>
    {
        <span class="c">// Plugin Name Storage</span>
        <b>private</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="7be9fa29345270fd" href="R/7be9fa29345270fd.html" target="n" data-glyph="46,1" class="i field">objPluginNames</a> = <b>null</b>;
 
        <b>private</b> <span class="i">ServiceController</span> <a id="961aacbd20eee20c" href="R/961aacbd20eee20c.html" target="n" data-glyph="46,1" class="i field">winrmServiceController</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if Set-Item user input type validation is required or not.</span>
        <span class="c">///</span><span class="c"> It is True by default, Clear-Item will set it to false so that it can</span>
        <span class="c">///</span><span class="c"> pass Empty string as value for Set-Item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="7a6ae657f181fce0" href="R/7a6ae657f181fce0.html" target="n" data-glyph="46,1" class="i field">clearItemIsCalled</a> = <b>false</b>;
 
        <b>private</b> <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a> <a id="1ecc2fce85e48c9a" href="R/1ecc2fce85e48c9a.html" target="n" data-glyph="46,1" class="i field">helper</a> = <b>new</b> <a href="WsManHelper.cs.html#fe9af43430a42abf" class="t constructor">WSManHelper</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Object contains the cache of the enumerate results for the cmdlet to execute.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">XmlDocument</span>&gt; <a id="855f97a7f17d8873" href="R/855f97a7f17d8873.html" target="n" data-glyph="46,1" class="i field">enumerateMapping</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">XmlDocument</span>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Mapping of ResourceURI with the XML returned by the Get call.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="d1f0d7f75d561b30" href="R/d1f0d7f75d561b30.html" target="n" data-glyph="46,1" class="i field">getMapping</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;();
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ICmdletProviderSupportsHelp Members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">   This implements Get-Help for config provider custom path.</span>
        <span class="c">///</span><span class="c">   When user calls &quot;Get-Help new-item&quot; in our config provider path, this function will get called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">helpItemName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>string</b> <a href="/System.Management.Automation/A.html#3e872a90de02a9b2" class="t t">ICmdletProviderSupportsHelp</a>.<a href="/System.Management.Automation/A.html#bc871a17c337a439" class="i method">GetHelpMaml</a>(<b>string</b> <span id="r0 rd" class="r0 r">helpItemName</span>, <b>string</b> <span id="r1 rd" class="r1 r">path</span>)
        {
            <span class="c">// Get the leaf node from the path for which help is requested.</span>
            <b>int</b> <span id="r2 rd" class="r2 r">ChildIndex</span> = <span class="r1 r">path</span>.<span class="i">LastIndexOf</span>(<span class="s">&quot;\\&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>if</b> (<span class="r2 r">ChildIndex</span> == -1)
            {
                <span class="c">// Means we are at host level, where no new-item is supported. Return empty string.</span>
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>string</b> <span id="r3 rd" class="r3 r">child</span> = <span class="r1 r">path</span>.<span class="i">Substring</span>(<span class="r2 r">ChildIndex</span> + 1);
 
            <span class="c">// We only return help for the below set of 5 commands, not for any other case.</span>
            <b>switch</b> (<span class="r0 r">helpItemName</span>)
            {
                <b>case</b> <span class="s">&quot;New-Item&quot;</span>:
                <b>case</b> <span class="s">&quot;Get-Item&quot;</span>:
                <b>case</b> <span class="s">&quot;Set-Item&quot;</span>:
                <b>case</b> <span class="s">&quot;Clear-Item&quot;</span>:
                <b>case</b> <span class="s">&quot;Remove-Item&quot;</span>:
                    <b>break</b>;
                <b>default</b>:
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <span class="c">// Load the help file from the current UI culture subfolder of the module&#39;s root folder</span>
            <span class="i">XmlDocument</span> <span id="r4 rd" class="r4 r">document</span> = <b>new</b> <span class="i">XmlDocument</span>();
            <span class="i">CultureInfo</span> <span id="r5 rd" class="r5 r">culture</span> = <a href="/System.Management.Automation/A.html#be8557754a3bdef0" class="i property">Host</a>.<a href="/System.Management.Automation/A.html#0aea5ccb4133325b" class="i property">CurrentUICulture</a>;
            <b>string</b> <span id="r6 rd" class="r6 r">providerBase</span> = <a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#6129ef83671ead76" class="i property">ProviderInfo</a>.<a href="/System.Management.Automation/A.html#d188d4dbe198a219" class="i property">PSSnapIn</a> != <b>null</b> ? <a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#6129ef83671ead76" class="i property">ProviderInfo</a>.<a href="/System.Management.Automation/A.html#d188d4dbe198a219" class="i property">PSSnapIn</a>.<a href="/System.Management.Automation/A.html#dc0461df9f1a5d5a" class="i property">ApplicationBase</a> : <a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#6129ef83671ead76" class="i property">ProviderInfo</a>.<a href="/System.Management.Automation/A.html#f736cdfc2ade06bf" class="i property">Module</a>.<a href="/System.Management.Automation/A.html#3c412fbb7362d7c7" class="i property">ModuleBase</a>;  <span class="c">// &quot;\windows\system32\WindowsPowerShell\v1.0&quot;</span>
            <b>string</b> <span id="r7 rd" class="r7 r">helpFile</span> = <b>null</b>;
 
            <b>do</b>
            {
                <b>string</b> <span id="r8 rd" class="r8 r">muiDirectory</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r6 r">providerBase</span>, <span class="r5 r">culture</span>.<span class="i">Name</span>);
                <b>if</b> (<span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r8 r">muiDirectory</span>))
                {
                    <b>string</b> <span id="r9 rd" class="r9 r">supposedHelpFile</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r8 r">muiDirectory</span>, <a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#6129ef83671ead76" class="i property">ProviderInfo</a>.<a href="/System.Management.Automation/A.html#f3d7084f8a70f287" class="i property">HelpFile</a>);
                    <b>if</b> (<span class="i">File</span>.<span class="i">Exists</span>(<span class="r9 r">supposedHelpFile</span>))
                    {
                        <span class="r7 r">helpFile</span> = <span class="r9 r">supposedHelpFile</span>;
                        <b>break</b>;
                    }
                }
 
                <span class="r5 r">culture</span> = <span class="r5 r">culture</span>.<span class="i">Parent</span>;
            } <b>while</b> (<span class="r5 r">culture</span> != <span class="r5 r">culture</span>.<span class="i">Parent</span>);
 
            <b>if</b> (<span class="r7 r">helpFile</span> == <b>null</b>)
            {
                <span class="c">// Can&#39;t find help file. Return empty string</span>
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>try</b>
            {
                <span class="i">XmlReaderSettings</span> <span id="r10 rd" class="r10 r">readerSettings</span> = <b>new</b> <span class="i">XmlReaderSettings</span>();
                <span class="r10 r">readerSettings</span>.<span class="i">XmlResolver</span> = <b>null</b>;
                <b>using</b> (<span class="i">XmlReader</span> <span id="r11 rd" class="r11 r">reader</span> = <span class="i">XmlReader</span>.<span class="i">Create</span>(<span class="r7 r">helpFile</span>, <span class="r10 r">readerSettings</span>))
                {
                    <span class="r4 r">document</span>.<span class="i">Load</span>(<span class="r11 r">reader</span>);
                }
            }
            <b>catch</b> (<span class="i">XmlException</span>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
            <b>catch</b> (<span class="i">PathTooLongException</span>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
            <b>catch</b> (<span class="i">IOException</span>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
            <b>catch</b> (<span class="i">UnauthorizedAccessException</span>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
            <b>catch</b> (<span class="i">NotSupportedException</span>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
            <b>catch</b> (<span class="i">SecurityException</span>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <span class="c">// Add the &quot;msh&quot; and &quot;command&quot; namespaces from the MAML schema</span>
            <span class="i">XmlNamespaceManager</span> <span id="r12 rd" class="r12 r">nsMgr</span> = <b>new</b> <span class="i">XmlNamespaceManager</span>(<span class="r4 r">document</span>.<span class="i">NameTable</span>);
            <span class="c">// XPath 1.0 associates empty prefix with &quot;null&quot; namespace; must use non-empty prefix for default namespace.</span>
            <span class="c">// This will not work: nsMgr.AddNamespace(string.Empty, &quot;http://msh&quot;);</span>
            <span class="r12 r">nsMgr</span>.<span class="i">AddNamespace</span>(<span class="s">&quot;msh&quot;</span>, <span class="s">&quot;http://msh&quot;</span>);
            <span class="r12 r">nsMgr</span>.<span class="i">AddNamespace</span>(<span class="s">&quot;command&quot;</span>, <span class="s">&quot;http://schemas.microsoft.com/maml/dev/command/2004/10&quot;</span>);
 
            <span class="c">// Split the help item name into verb and noun</span>
            <b>string</b> <span id="r13 rd" class="r13 r">verb</span> = <span class="r0 r">helpItemName</span>.<span class="i">Split</span>(<span class="s">&#39;-&#39;</span>)[0];
            <b>string</b> <span id="r14 rd" class="r14 r">noun</span> = <span class="r0 r">helpItemName</span>.<span class="i">Substring</span>(<span class="r0 r">helpItemName</span>.<span class="i">IndexOf</span>(<span class="s">&#39;-&#39;</span>) + 1);
 
            <span class="c">// Compose XPath query to select the appropriate node based on the verb, noun and id</span>
            <b>string</b> <span id="r15 rd" class="r15 r">xpathQuery</span> = <span class="s">&quot;/msh:helpItems/msh:providerHelp/msh:CmdletHelpPaths/msh:CmdletHelpPath[@id=&#39;&quot;</span> + <span class="r3 r">child</span> + <span class="s">&quot;&#39; or @ID=&#39;&quot;</span> + <span class="r3 r">child</span> + <span class="s">&quot;&#39;]/command:command/command:details[command:verb=&#39;&quot;</span> + <span class="r13 r">verb</span> + <span class="s">&quot;&#39; and command:noun=&#39;&quot;</span> + <span class="r14 r">noun</span> + <span class="s">&quot;&#39;]&quot;</span>;
 
            <span class="c">// Execute the XPath query and if the command was found, return its MAML snippet</span>
            <span class="i">XmlNode</span> <span id="r16 rd" class="r16 r">result</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r16 r">result</span> = <span class="r4 r">document</span>.<span class="i">SelectSingleNode</span>(<span class="r15 r">xpathQuery</span>, <span class="r12 r">nsMgr</span>);
            }
            <b>catch</b> (<span class="i">XPathException</span>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>if</b> (<span class="r16 r">result</span> != <b>null</b>)
            {
                <b>return</b> <span class="r16 r">result</span>.<span class="i">ParentNode</span>.<span class="i">OuterXml</span>;
            }
 
            <b>return</b> <b>string</b>.<span class="i">Empty</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> DriveCmdletProvider
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">drive</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <a href="/System.Management.Automation/A.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <a id="8d51300e7514e2cd" href="R/8d51300e7514e2cd.html" target="n" data-glyph="75,1" class="i method">NewDrive</a>(<a href="/System.Management.Automation/A.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r17 rd" class="r17 r">drive</span>)
        {
            <b>if</b> (<span class="r17 r">drive</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r17 r">drive</span>.<a href="/System.Management.Automation/A.html#6c8f4db73167e8f9" class="i property">Root</a>))
            {
                <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NewDriveRootDoesNotExist&quot;</span>), <b>false</b>);
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <span class="r17 r">drive</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the required drive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <a id="7c499a4eec7617bb" href="R/7c499a4eec7617bb.html" target="n" data-glyph="75,1" class="i method">InitializeDefaultDrives</a>()
        {
            <span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt; <span id="r18 rd" class="r18 r">drives</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>&gt;();
            <span class="r18 r">drives</span>.<span class="i">Add</span>(<b>new</b> <span class="t">PSDriveInfo</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ff28b0893dfbf7d2" class="i field">rootpath</a>, <a href="/System.Management.Automation/A.html#6129ef83671ead76" class="i property">ProviderInfo</a>, <b>string</b>.<span class="i">Empty</span>,
                        <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;ConfigStorage&quot;</span>), <b>null</b>));
            <b>return</b> <span class="r18 r">drives</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the required drive.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override</b> <a href="/System.Management.Automation/A.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <a id="ef0210a0998e6113" href="R/ef0210a0998e6113.html" target="n" data-glyph="75,1" class="i method">RemoveDrive</a>(<a href="/System.Management.Automation/A.html#2d16b26a541ba185" class="t t">PSDriveInfo</a> <span id="r19 rd" class="r19 r">drive</span>)
        {
            <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#c4782251221c7f4d" class="i method">ReleaseSessions</a>();
            <b>return</b> <span class="r19 r">drive</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ItemCmdletProvider
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a Child Name. This method is called from MakePath method.</span>
        <span class="c">///</span><span class="c"> This Method helps in getting the correct case of particular element in the provider path.</span>
        <span class="c">///</span><span class="c"> XML is case sensitive but Powershell is not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override string</b> <a id="6908f0575ffd28fa" href="R/6908f0575ffd28fa.html" target="n" data-glyph="75,1" class="i method">GetChildName</a>(<b>string</b> <span id="r20 rd" class="r20 r">path</span>)
        {
            <b>string</b> <span id="r21 rd" class="r21 r">result</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>int</b> <span id="r22 rd" class="r22 r">separatorIndex</span> = <span class="r20 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>);
            <b>string</b> <span id="r23 rd" class="r23 r">hostname</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<span class="r22 r">separatorIndex</span> == -1)
            {
                <span class="r21 r">result</span> = <span class="r20 r">path</span>;
                <span class="r23 r">hostname</span> = <span class="r20 r">path</span>;
            }
            <b>else</b>
            {
                <span class="r21 r">result</span> = <span class="r20 r">path</span>.<span class="i">Substring</span>(<span class="r22 r">separatorIndex</span> + 1);
                <span class="r23 r">hostname</span> = <a href="#660b53b524868f2c" class="i method">GetHostName</a>(<span class="r20 r">path</span>);
            }
 
            <b>return</b> <a href="#a21b299ded214582" class="i method">GetCorrectCaseOfName</a>(<span class="r21 r">result</span>, <span class="r23 r">hostname</span>, <span class="r20 r">path</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is provided by the Provider infrastructure. This method is called in all actions done</span>
        <span class="c">///</span><span class="c"> by the provider to get the resolved path. Internally Resolve-Path is called.</span>
        <span class="c">///</span><span class="c"> Since Root is empty for WsMan Provider the default path generated by Makepath is not correct.</span>
        <span class="c">///</span><span class="c"> So we have made the tweaks in this method to return the correct resolved path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">parent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">child</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override string</b> <a id="a05ef7af1854b4d6" href="R/a05ef7af1854b4d6.html" target="n" data-glyph="75,1" class="i method">MakePath</a>(<b>string</b> <span id="r24 rd" class="r24 r">parent</span>, <b>string</b> <span id="r25 rd" class="r25 r">child</span>)
        {
            <b>if</b> (<span class="r25 r">child</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r25 r">child</span> = <span class="r25 r">child</span>.<span class="i">Remove</span>(<span class="r25 r">child</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
            }
 
            <span class="c">// For Listeners only ... should remove Listener from listener\listener but not from listener_[Hashcode]</span>
            <b>if</b> (<span class="r24 r">parent</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp; <span class="r25 r">child</span>.<span class="i">StartsWith</span>(<span class="r24 r">parent</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (!<span class="r25 r">child</span>.<span class="i">StartsWith</span>(<span class="r24 r">parent</span> + <span class="s">&quot;_&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r25 r">child</span> = <span class="r25 r">child</span>.<span class="i">Remove</span>(0, <span class="r24 r">parent</span>.<span class="i">Length</span>);
                }
            }
 
            <b>string</b> <span id="r26 rd" class="r26 r">path</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>string</b> <span id="r27 rd" class="r27 r">ChildName</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>string</b> <span id="r28 rd" class="r28 r">CorrectCaseChildName</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<span class="r24 r">parent</span>.<span class="i">Length</span> != 0)
            {
                <span class="r26 r">path</span> = <span class="r24 r">parent</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r25 r">child</span>;
            }
            <b>else</b>
            {
                <span class="r26 r">path</span> = <span class="r25 r">child</span>;
            }
 
            <b>if</b> (<span class="r26 r">path</span>.<span class="i">Length</span> != 0)
            {
                <span class="r27 r">ChildName</span> = <span class="r26 r">path</span>.<span class="i">Substring</span>(<span class="r26 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1);
                <span class="r28 r">CorrectCaseChildName</span> = <a href="#6908f0575ffd28fa" class="i method">GetChildName</a>(<span class="r26 r">path</span>);
            }
 
            <b>if</b> (<span class="r27 r">ChildName</span>.<span class="i">Equals</span>(<span class="r28 r">CorrectCaseChildName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<span class="r25 r">child</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>()))
                {
                    <span class="r25 r">child</span> = <span class="r25 r">child</span>.<span class="i">Substring</span>(0, <span class="r25 r">child</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
                    <span class="r25 r">child</span> = <span class="r25 r">child</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r28 r">CorrectCaseChildName</span>;
                }
                <b>else</b>
                {
                    <span class="r25 r">child</span> = <span class="r28 r">CorrectCaseChildName</span>;
                }
            }
 
            <b>string</b> <span id="r29 rd" class="r29 r">basepath</span> = <a href="/System.Management.Automation/A.html#7d31476313596b0b" class="k">base</a>.<span class="i">MakePath</span>(<span class="r24 r">parent</span>, <span class="r25 r">child</span>);
            <b>return</b> <a href="#431b62c6874cf93e" class="i method">GetCorrectCaseOfPath</a>(<span class="r29 r">basepath</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks whether the path is Valid.</span>
        <span class="c">///</span><span class="c"> eg. winrm/config/client.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="e2dfa91eb80fb06f" href="R/e2dfa91eb80fb06f.html" target="n" data-glyph="75,1" class="i method">IsValidPath</a>(<b>string</b> <span id="r30 rd" class="r30 r">path</span>)
        {
            <b>bool</b> <span id="r31 rd" class="r31 r">result</span> = <b>false</b>;
            <span class="r31 r">result</span> = <a href="#08196698077b587f" class="i method">CheckValidContainerOrPath</a>(<span class="r30 r">path</span>);
            <b>return</b> <span class="r31 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check whether an Item Exist in the winrm configuration.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="427c1a8b17b4288c" href="R/427c1a8b17b4288c.html" target="n" data-glyph="75,1" class="i method">ItemExists</a>(<b>string</b> <span id="r32 rd" class="r32 r">path</span>)
        {
            <b>bool</b> <span id="r33 rd" class="r33 r">result</span> = <b>false</b>;
            <span class="r33 r">result</span> = <a href="#08196698077b587f" class="i method">CheckValidContainerOrPath</a>(<span class="r32 r">path</span>);
            <b>return</b> <span class="r33 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks whether the given path has got child items.</span>
        <span class="c">///</span><span class="c"> e.g: This is called by Provider infrastructure when we do a Remove-Item and prompts user</span>
        <span class="c">///</span><span class="c"> if child items are present.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="4ccc6387ffab120b" href="R/4ccc6387ffab120b.html" target="n" data-glyph="75,1" class="i method">HasChildItems</a>(<b>string</b> <span id="r34 rd" class="r34 r">path</span>)
        {
            <b>string</b> <span id="r35 rd" class="r35 r">childname</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>string</b> <span id="r36 rd" class="r36 r">strPathCheck</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<span class="r34 r">path</span>.<span class="i">Length</span> == 0 &amp;&amp; <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r35 r">childname</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// if endswith &#39;\&#39;, removes it.</span>
            <b>if</b> (<span class="r34 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r34 r">path</span> = <span class="r34 r">path</span>.<span class="i">Remove</span>(<span class="r34 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
            }
 
            <b>if</b> (<span class="r34 r">path</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>()))
            {
                <span class="c">// Get the ChildName</span>
                <span class="r35 r">childname</span> = <span class="r34 r">path</span>.<span class="i">Substring</span>(<span class="r34 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1);
            }
 
            <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r37 rd" class="r37 r">SessionObjCache</span> = <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2b29be8459e983a7" class="i method">GetSessionObjCache</a>();
            <b>if</b> (<span class="r37 r">SessionObjCache</span>.<span class="i">ContainsKey</span>(<span class="r34 r">path</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// Get the wsman host name to find the session object</span>
            <b>string</b> <span id="r38 rd" class="r38 r">host</span> = <a href="#660b53b524868f2c" class="i method">GetHostName</a>(<span class="r34 r">path</span>);
 
            <span class="c">// Chks the WinRM Service</span>
            <b>if</b> (<a href="#f48e279095b5a8c1" class="i method">IsPathLocalMachine</a>(<span class="r38 r">host</span>))
            {
                <b>if</b> (!<a href="#049952faaf766e5b" class="i method">IsWSManServiceRunning</a>())
                {
                    <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#e53fd23e593153ef" class="i method">ThrowIfNotAdministrator</a>();
                    <a href="#76311111d1d2f1b2" class="i method">StartWSManService</a>(<a href="/System.Management.Automation/A.html#e3c4d51f13fbfcaa" class="i property">Force</a>);
                }
            }
 
            <b>string</b> <span id="r39 rd" class="r39 r">WsManURI</span> = <a href="#103267db7d6cc518" class="i method">NormalizePath</a>(<span class="r34 r">path</span>, <span class="r38 r">host</span>);
 
            <b>lock</b> (<a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2a23b1e8c34cc740" class="i field">AutoSession</a>)
            {
                <span class="c">// Gets the session object from the cache.</span>
                <b>object</b> <span id="r40 rd" class="r40 r">sessionobj</span>;
                <span class="r37 r">SessionObjCache</span>.<span class="i">TryGetValue</span>(<span class="r38 r">host</span>, <b>out</b> <span class="r40 r">sessionobj</span>);
 
                <span class="c">/*
                WsMan Config Can be divided in to Four Fixed Regions to Check Whether it has Child Items.
 
                 * 1. Branch in to Listeners (winrm/config/listener)
                 * 2. Branch in to CertMapping (winrm/config/service/certmapping)
                 * 3. Branch in to Plugin (winrm/config/plugin) - Plugin is subdivided in Resources,Security &amp; InitParams
                 * 4. Rest all the branches like Client, Shell(WinRS) ,Service
 
                */</span>
 
                <span class="c">// 1. Listener Checks</span>
                <span class="r36 r">strPathCheck</span> = <span class="r38 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                <b>if</b> (<span class="r39 r">WsManURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>))
                {
                    <span class="i">XmlDocument</span> <span id="r41 rd" class="r41 r">xmlListeners</span> = <a href="#be8ef6f2909993fb" class="i method">EnumerateResourceValue</a>(<span class="r40 r">sessionobj</span>, <span class="r39 r">WsManURI</span>);
                    <b>if</b> (<span class="r41 r">xmlListeners</span> != <b>null</b>)
                    {
                        <span class="i">Hashtable</span> <span id="r42 rd" class="r42 r">KeyCache</span>, <span id="r43 rd" class="r43 r">ListenerObjCache</span>;
                        <a href="#52d9ca2566594c0d" class="i method">ProcessListenerObjects</a>(<span class="r41 r">xmlListeners</span>, <b>out</b> <span class="r43 r">ListenerObjCache</span>, <b>out</b> <span class="r42 r">KeyCache</span>);
                        <b>if</b> (<span class="r43 r">ListenerObjCache</span>.<span class="i">Count</span> &gt; 0)
                        {
                            <b>return</b> <b>true</b>;
                        }
                    }
                }
                <span class="c">// 2. Client Certificate Checks</span>
                <b>else</b> <b>if</b> (<span class="r39 r">WsManURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#22940af130242689" class="i field">containerCertMapping</a>))
                {
                    <span class="i">XmlDocument</span> <span id="r44 rd" class="r44 r">xmlCertificates</span> = <a href="#be8ef6f2909993fb" class="i method">EnumerateResourceValue</a>(<span class="r40 r">sessionobj</span>, <span class="r39 r">WsManURI</span>);
                    <span class="i">Hashtable</span> <span id="r45 rd" class="r45 r">KeyCache</span>, <span id="r46 rd" class="r46 r">CertificatesObjCache</span>;
                    <b>if</b> (<span class="r44 r">xmlCertificates</span> == <b>null</b>)
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <a href="#01a3c58ac8787b59" class="i method">ProcessCertMappingObjects</a>(<span class="r44 r">xmlCertificates</span>, <b>out</b> <span class="r46 r">CertificatesObjCache</span>, <b>out</b> <span class="r45 r">KeyCache</span>);
                    <b>if</b> (<span class="r46 r">CertificatesObjCache</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <b>return</b> <b>true</b>;
                    }
                }
                <span class="c">// 3. Plugin and its internal structure Checks</span>
                <b>else</b> <b>if</b> (<span class="r39 r">WsManURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>))
                {
                    <span class="r36 r">strPathCheck</span> += <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>;
                    <span class="c">// Check for Plugin path</span>
                    <span class="i">XmlDocument</span> <span id="r47 rd" class="r47 r">xmlPlugins</span> = <a href="#14c3c20542e6ba32" class="i method">FindResourceValue</a>(<span class="r40 r">sessionobj</span>, <span class="r39 r">WsManURI</span>, <b>null</b>);
                    <b>string</b> <span id="r48 rd" class="r48 r">currentpluginname</span> = <b>string</b>.<span class="i">Empty</span>;
                    <b>int</b> <span id="r49 rd" class="r49 r">PluginCount</span> = <a href="#652b1bae7a230230" class="i method">GetPluginNames</a>(<span class="r47 r">xmlPlugins</span>, <b>out</b> <a href="#7be9fa29345270fd" class="i field">objPluginNames</a>, <b>out</b> <span class="r48 r">currentpluginname</span>, <span class="r34 r">path</span>);
                    <b>if</b> (<span class="r34 r">path</span>.<span class="i">Equals</span>(<span class="r36 r">strPathCheck</span>))
                    {
                        <b>if</b> (<span class="r49 r">PluginCount</span> &gt; 0)
                        {
                            <b>return</b> <b>true</b>;
                        }
                        <b>else</b>
                        {
                            <b>return</b> <b>false</b>;
                        }
                    }
 
                    <span class="r36 r">strPathCheck</span> = <span class="r36 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r48 r">currentpluginname</span>;
                    <b>if</b> (<span class="r34 r">path</span>.<span class="i">EndsWith</span>(<span class="r36 r">strPathCheck</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>if</b> (<a href="#7be9fa29345270fd" class="i field">objPluginNames</a> != <b>null</b>)
                        {
                            <b>if</b> (<a href="#7be9fa29345270fd" class="i field">objPluginNames</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Match</span>(<span class="r48 r">currentpluginname</span>).<a href="/System.Management.Automation/A.html#4fcb958a2e493168" class="i property">Count</a> &gt; 0)
                            {
                                <b>return</b> <b>true</b>;
                            }
                            <b>else</b>
                            {
                                <b>return</b> <b>false</b>;
                            }
                        }
                    }
 
                    <b>string</b> <span id="r50 rd" class="r50 r">filter</span> = <span class="r39 r">WsManURI</span> + <span class="s">&quot;?Name=&quot;</span> + <span class="r48 r">currentpluginname</span>;
                    <span class="i">XmlDocument</span> <span id="r51 rd" class="r51 r">CurrentPluginXML</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r40 r">sessionobj</span>, <span class="r50 r">filter</span>, <b>null</b>);
                    <span class="i">ArrayList</span> <span id="r52 rd" class="r52 r">arrSecurities</span> = <b>null</b>;
                    <span class="i">ArrayList</span> <span id="r53 rd" class="r53 r">arrResources</span> = <a href="#9fc4301cb03b79b7" class="i method">ProcessPluginResourceLevel</a>(<span class="r51 r">CurrentPluginXML</span>, <b>out</b> <span class="r52 r">arrSecurities</span>);
                    <span class="i">ArrayList</span> <span id="r54 rd" class="r54 r">arrInitParams</span> = <a href="#0f58ba5254c3d7ba" class="i method">ProcessPluginInitParamLevel</a>(<span class="r51 r">CurrentPluginXML</span>);
                    <span class="r36 r">strPathCheck</span> += <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                    <b>if</b> (<span class="r34 r">path</span>.<span class="i">EndsWith</span>(<span class="r36 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>if</b> (<span class="r53 r">arrResources</span> != <b>null</b> &amp;&amp; <span class="r53 r">arrResources</span>.<span class="i">Count</span> &gt; 0)
                        {
                            <b>return</b> <b>true</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r34 r">path</span>.<span class="i">EndsWith</span>(<span class="r36 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>if</b> (<span class="r54 r">arrInitParams</span> != <b>null</b> &amp;&amp; <span class="r54 r">arrInitParams</span>.<span class="i">Count</span> &gt; 0)
                        {
                            <b>return</b> <b>true</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r34 r">path</span>.<span class="i">EndsWith</span>(<span class="r36 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="i">XmlNodeList</span> <span id="r55 rd" class="r55 r">nodeListForQuotas</span> = <span class="r51 r">CurrentPluginXML</span>.<span class="i">GetElementsByTagName</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>);
                        <b>if</b> (<span class="r55 r">nodeListForQuotas</span>.<span class="i">Count</span> &gt; 0)
                        {
                            <span class="i">XmlNode</span> <span id="r56 rd" class="r56 r">pluginQuotas</span> = <span class="r55 r">nodeListForQuotas</span>[0];
                            <b>return</b> <span class="r56 r">pluginQuotas</span>.<span class="i">Attributes</span>.<span class="i">Count</span> &gt; 0;
                        }
 
                        <b>return</b> <b>false</b>;
                    }
 
                    <b>if</b> (<span class="r53 r">arrResources</span> != <b>null</b>)
                    {
                        <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r57 rd" class="r57 r">objresource</span> <b>in</b> <span class="r53 r">arrResources</span>)
                        {
                            <b>string</b> <span id="r58 rd" class="r58 r">sResourceDirName</span> = <span class="r57 r">objresource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                            <b>if</b> (<span class="r34 r">path</span>.<span class="i">Contains</span>(<span class="r58 r">sResourceDirName</span>))
                            {
                                <span class="r36 r">strPathCheck</span> = <span class="r36 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                                <b>if</b> (<span class="r34 r">path</span>.<span class="i">EndsWith</span>(<span class="r36 r">strPathCheck</span> + <span class="r58 r">sResourceDirName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <b>return</b> <b>true</b>;
                                }
 
                                <span class="r36 r">strPathCheck</span> = <span class="r36 r">strPathCheck</span> + <span class="r58 r">sResourceDirName</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                                <b>if</b> (<span class="r34 r">path</span>.<span class="i">Contains</span>(<span class="r36 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>))
                                {
                                    <b>if</b> (<span class="r34 r">path</span>.<span class="i">EndsWith</span>(<span class="r36 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <b>if</b> (<span class="r52 r">arrSecurities</span> != <b>null</b> &amp;&amp; <span class="r52 r">arrSecurities</span>.<span class="i">Count</span> &gt; 0)
                                        {
                                            <b>return</b> <b>true</b>;
                                        }
                                    }
 
                                    <span class="r36 r">strPathCheck</span> = <span class="r36 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                                    <b>if</b> (<span class="r34 r">path</span>.<span class="i">Contains</span>(<span class="r36 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a> + <span class="s">&quot;_&quot;</span>))
                                    {
                                        <b>if</b> (<span class="r52 r">arrSecurities</span> == <b>null</b>)
                                        {
                                            <b>return</b> <b>false</b>;
                                        }
 
                                        <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r59 rd" class="r59 r">security</span> <b>in</b> <span class="r52 r">arrSecurities</span>)
                                        {
                                            <b>string</b> <span id="r60 rd" class="r60 r">sSecurity</span> = <span class="r59 r">security</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;SecurityDIR&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                                            <b>if</b> (<span class="r34 r">path</span>.<span class="i">EndsWith</span>(<span class="r60 r">sSecurity</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                                <b>return</b> <b>true</b>;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                <b>else</b>
                <span class="c">// 4. All Other Item Checks</span>
                {
                    <b>string</b> <span id="r61 rd" class="r61 r">getXml</span> = <a href="#959910a828c6b791" class="k">this</a>.<a href="#db35803629c6844f" class="i method">GetResourceValueInXml</a>(<span class="r40 r">sessionobj</span>, <span class="r39 r">WsManURI</span>, <b>null</b>);
                    <span class="i">XmlDocument</span> <span id="r62 rd" class="r62 r">xmlResourceValues</span> = <b>new</b> <span class="i">XmlDocument</span>();
                    <span class="r62 r">xmlResourceValues</span>.<span class="i">LoadXml</span>(<span class="r61 r">getXml</span>.<span class="i">ToLowerInvariant</span>());
                    <span class="i">XmlNodeList</span> <span id="r63 rd" class="r63 r">nodes</span> = <a href="#22e74b26a07bdcc0" class="i method">SearchXml</a>(<span class="r62 r">xmlResourceValues</span>, <span class="r35 r">childname</span>, <span class="r39 r">WsManURI</span>, <span class="r34 r">path</span>, <span class="r38 r">host</span>);
                    <b>if</b> (<span class="r63 r">nodes</span> != <b>null</b>)
                    {
                        <b>return</b> <a href="#f20176e1b52f02e0" class="i method">IsItemContainer</a>(<span class="r63 r">nodes</span>);
                    }
                }
 
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This cmdlet is used to get a particular item.</span>
        <span class="c">///</span><span class="c"> cd wsman:\localhost\client&gt; Get-Item .\Auth.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r64 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Maintainability&quot;</span>, <span class="s">&quot;CA1505:AvoidUnmaintainableCode&quot;</span>)]
        <b>protected override void</b> <a id="d9734c0c3467004f" href="R/d9734c0c3467004f.html" target="n" data-glyph="75,1" class="i method">GetItem</a>(<b>string</b> <span id="r64 rd" class="r64 r">path</span>)
        {
            <b>string</b> <span id="r65 rd" class="r65 r">childname</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<span class="r64 r">path</span>.<span class="i">Length</span> == 0 &amp;&amp; <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r65 r">childname</span>))
            {
                <span class="i">WriteItemObject</span>(<a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ff28b0893dfbf7d2" class="i field">rootpath</a>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>, <b>null</b>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#ed8179c5c4307879" class="i field">WSManConfigElement</a>), <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ff28b0893dfbf7d2" class="i field">rootpath</a>, <b>true</b>);
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r64 r">path</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>()))
            {
                <span class="c">// Get the ChildName</span>
                <span class="r65 r">childname</span> = <span class="r64 r">path</span>.<span class="i">Substring</span>(<span class="r64 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1);
            }
            <b>else</b>
            {
                <span class="r65 r">childname</span> = <span class="r64 r">path</span>;
            }
 
            <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r66 rd" class="r66 r">SessionObjCache</span> = <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2b29be8459e983a7" class="i method">GetSessionObjCache</a>();
            <b>if</b> (<span class="r65 r">childname</span>.<span class="i">Equals</span>(<span class="r64 r">path</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<span class="r66 r">SessionObjCache</span>.<span class="i">ContainsKey</span>(<span class="r65 r">childname</span>))
                {
                    <span class="i">WriteItemObject</span>(<a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(<span class="r65 r">childname</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>, <b>null</b>, <b>null</b>, <span class="s">&quot;ComputerLevel&quot;</span>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>), <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ff28b0893dfbf7d2" class="i field">rootpath</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r65 r">childname</span>, <b>true</b>);
                }
 
                <b>return</b>;
            }
 
            <span class="r64 r">path</span> = <span class="r64 r">path</span>.<span class="i">Substring</span>(0, <span class="r64 r">path</span>.<span class="i">LastIndexOf</span>(<span class="r65 r">childname</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
 
            <span class="c">// Get the wsman host name to find the session object</span>
            <b>string</b> <span id="r67 rd" class="r67 r">host</span> = <a href="#660b53b524868f2c" class="i method">GetHostName</a>(<span class="r64 r">path</span>);
            <b>string</b> <span id="r68 rd" class="r68 r">uri</span> = <a href="#103267db7d6cc518" class="i method">NormalizePath</a>(<span class="r64 r">path</span>, <span class="r67 r">host</span>);
 
            <b>lock</b> (<a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2a23b1e8c34cc740" class="i field">AutoSession</a>)
            {
                <span class="c">// Gets the session object from the cache.</span>
                <b>object</b> <span id="r69 rd" class="r69 r">sessionobj</span>;
                <span class="r66 r">SessionObjCache</span>.<span class="i">TryGetValue</span>(<span class="r67 r">host</span>, <b>out</b> <span class="r69 r">sessionobj</span>);
 
                <span class="i">XmlDocument</span> <span id="r70 rd" class="r70 r">xmlResource</span> = <a href="#14c3c20542e6ba32" class="i method">FindResourceValue</a>(<span class="r69 r">sessionobj</span>, <span class="r68 r">uri</span>, <b>null</b>);
                <b>if</b> (<span class="r70 r">xmlResource</span> == <b>null</b>) { <b>return</b>; }
 
                <span class="c">// if endswith &#39;\&#39;, removes it.</span>
                <b>if</b> (<span class="r64 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r64 r">path</span> = <span class="r64 r">path</span>.<span class="i">Remove</span>(<span class="r64 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
                }
 
                <b>string</b> <span id="r71 rd" class="r71 r">strPathChk</span> = <span class="r67 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
 
                <b>if</b> (<span class="r64 r">path</span>.<span class="i">Contains</span>(<span class="r71 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>))
                {
                    <a href="#f96dda287a4b2b55" class="i method">GetItemListenerOrCertMapping</a>(<span class="r64 r">path</span>, <span class="r70 r">xmlResource</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="r65 r">childname</span>, <span class="r67 r">host</span>);
                }
                <b>else</b> <b>if</b> (<span class="r64 r">path</span>.<span class="i">Contains</span>(<span class="r71 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>))
                {
                    <a href="#f96dda287a4b2b55" class="i method">GetItemListenerOrCertMapping</a>(<span class="r64 r">path</span>, <span class="r70 r">xmlResource</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="r65 r">childname</span>, <span class="r67 r">host</span>);
                }
                <b>else</b> <b>if</b> (<span class="r64 r">path</span>.<span class="i">Contains</span>(<span class="r71 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>))
                {
                    <b>string</b> <span id="r72 rd" class="r72 r">currentpluginname</span> = <b>string</b>.<span class="i">Empty</span>;
                    <a href="#652b1bae7a230230" class="i method">GetPluginNames</a>(<span class="r70 r">xmlResource</span>, <b>out</b> <a href="#7be9fa29345270fd" class="i field">objPluginNames</a>, <b>out</b> <span class="r72 r">currentpluginname</span>, <span class="r64 r">path</span>);
 
                    <b>if</b> (<span class="r64 r">path</span>.<span class="i">EndsWith</span>(<span class="r71 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>try</b>
                        {
                            <span class="i">WriteItemObject</span>(<span class="i">GetItemPSObjectWithTypeName</span>(<a href="#7be9fa29345270fd" class="i field">objPluginNames</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <a href="#7be9fa29345270fd" class="i field">objPluginNames</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <b>null</b>, <b>new</b> <b>string</b>[] { <span class="s">&quot;Name=&quot;</span> + <a href="#7be9fa29345270fd" class="i field">objPluginNames</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a> }, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>), <span class="r64 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r65 r">childname</span>, <b>true</b>);
                        }
                        <b>catch</b> (<a href="/System.Management.Automation/A.html#efa3789145f41301" class="t t">PSArgumentNullException</a>) { <b>return</b>; }
                        <b>catch</b> (<span class="i">NullReferenceException</span>) { <b>return</b>; }
                    }
                    <b>else</b>
                    {
                        <span class="r71 r">strPathChk</span> = <span class="r71 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                        <b>string</b> <span id="r73 rd" class="r73 r">filter</span> = <span class="r68 r">uri</span> + <span class="s">&quot;?Name=&quot;</span> + <span class="r72 r">currentpluginname</span>;
                        <span class="i">XmlDocument</span> <span id="r74 rd" class="r74 r">CurrentPluginXML</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r69 r">sessionobj</span>, <span class="r73 r">filter</span>, <b>null</b>);
                        <b>if</b> (<span class="r74 r">CurrentPluginXML</span> == <b>null</b>)
                        {
                            <b>return</b>;
                        }
 
                        <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r75 rd" class="r75 r">objPluginlevel</span> = <a href="#d773ffd607e22121" class="i method">ProcessPluginConfigurationLevel</a>(<span class="r74 r">CurrentPluginXML</span>, <b>true</b>);
                        <span class="i">ArrayList</span> <span id="r76 rd" class="r76 r">arrSecurity</span> = <b>null</b>;
                        <span class="i">ArrayList</span> <span id="r77 rd" class="r77 r">arrResources</span> = <a href="#9fc4301cb03b79b7" class="i method">ProcessPluginResourceLevel</a>(<span class="r74 r">CurrentPluginXML</span>, <b>out</b> <span class="r76 r">arrSecurity</span>);
                        <span class="i">ArrayList</span> <span id="r78 rd" class="r78 r">arrInitParams</span> = <a href="#0f58ba5254c3d7ba" class="i method">ProcessPluginInitParamLevel</a>(<span class="r74 r">CurrentPluginXML</span>);
                        <b>try</b>
                        {
                            <b>if</b> (<span class="r64 r">path</span>.<span class="i">Contains</span>(<span class="r71 r">strPathChk</span> + <span class="r72 r">currentpluginname</span>))
                            {
                                <b>if</b> (<span class="r64 r">path</span>.<span class="i">EndsWith</span>(<span class="r71 r">strPathChk</span> + <span class="r72 r">currentpluginname</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <b>if</b> (!<span class="r75 r">objPluginlevel</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>))
                                    {
                                        <span class="i">WriteItemObject</span>(<a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(<span class="r75 r">objPluginlevel</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r75 r">objPluginlevel</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#af662506826a4d3d" class="i property">TypeNameOfValue</a>, <span class="r75 r">objPluginlevel</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>), <span class="r64 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r75 r">objPluginlevel</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <b>false</b>);
                                    }
                                    <b>else</b>
                                    {
                                        <span class="i">WriteItemObject</span>(<span class="i">GetItemPSObjectWithTypeName</span>(<span class="r75 r">objPluginlevel</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r75 r">objPluginlevel</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <b>null</b>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>), <span class="r64 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r75 r">objPluginlevel</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <b>true</b>);
                                    }
                                }
 
                                <span class="r71 r">strPathChk</span> = <span class="r71 r">strPathChk</span> + <span class="r72 r">currentpluginname</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                                <b>if</b> (<span class="r64 r">path</span>.<span class="i">Contains</span>(<span class="r71 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>))
                                {
                                    <b>if</b> (<span class="r77 r">arrResources</span> == <b>null</b>)
                                    {
                                        <b>return</b>;
                                    }
 
                                    <b>if</b> (<span class="r64 r">path</span>.<span class="i">EndsWith</span>(<span class="r71 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r79 rd" class="r79 r">p</span> <b>in</b> <span class="r77 r">arrResources</span>)
                                        {
                                            <b>if</b> (<span class="r79 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<span class="r65 r">childname</span>))
                                            {
                                                <span class="i">WriteItemObject</span>(<a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(<span class="r65 r">childname</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>, <b>null</b>, <b>new</b> <b>string</b>[] { <span class="s">&quot;ResourceURI=&quot;</span> + <span class="r79 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceUri&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>() }, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>), <span class="r64 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r65 r">childname</span>, <b>true</b>);
                                            }
                                        }
 
                                        <b>return</b>;
                                    }
 
                                    <span class="r71 r">strPathChk</span> = <span class="r71 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                                    <b>int</b> <span id="r80 rd" class="r80 r">Sepindex</span> = <span class="r64 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r71 r">strPathChk</span>.<span class="i">Length</span>);
                                    <b>string</b> <span id="r81 rd" class="r81 r">sResourceDirName</span> = <b>string</b>.<span class="i">Empty</span>;
                                    <b>if</b> (<span class="r80 r">Sepindex</span> == -1)
                                    {
                                        <span class="r81 r">sResourceDirName</span> = <span class="r64 r">path</span>.<span class="i">Substring</span>(<span class="r71 r">strPathChk</span>.<span class="i">Length</span>);
                                    }
                                    <b>else</b>
                                    {
                                        <span class="r81 r">sResourceDirName</span> = <span class="r64 r">path</span>.<span class="i">Substring</span>(<span class="r71 r">strPathChk</span>.<span class="i">Length</span>, <span class="r64 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r71 r">strPathChk</span>.<span class="i">Length</span>) - (<span class="r71 r">strPathChk</span>.<span class="i">Length</span>));
                                    }
 
                                    <b>if</b> (<span class="r64 r">path</span>.<span class="i">Contains</span>(<span class="r71 r">strPathChk</span> + <span class="r81 r">sResourceDirName</span>))
                                    {
                                        <b>if</b> (<span class="r64 r">path</span>.<span class="i">EndsWith</span>(<span class="r71 r">strPathChk</span> + <span class="r81 r">sResourceDirName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                        {
                                            <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r82 rd" class="r82 r">p</span> <b>in</b> <span class="r77 r">arrResources</span>)
                                            {
                                                <b>if</b> (<span class="r81 r">sResourceDirName</span>.<span class="i">Equals</span>(<span class="r82 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                                {
                                                    <span class="r82 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Remove</span>(<span class="s">&quot;ResourceDir&quot;</span>);
                                                    <b>if</b> (<span class="r82 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>))
                                                    {
                                                        <span class="i">WriteItemObject</span>(<span class="i">GetItemPSObjectWithTypeName</span>(<span class="r82 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r82 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <b>null</b>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>), <span class="r64 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r82 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <b>true</b>);
                                                    }
                                                    <b>else</b>
                                                    {
                                                        <span class="i">WriteItemObject</span>(<a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(<span class="r82 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r82 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#af662506826a4d3d" class="i property">TypeNameOfValue</a>, <span class="r82 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>), <span class="r64 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r82 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <b>false</b>);
                                                    }
 
                                                    <b>break</b>;
                                                }
                                            }
 
                                            <b>return</b>;
                                        }
 
                                        <span class="r71 r">strPathChk</span> = <span class="r71 r">strPathChk</span> + <span class="r81 r">sResourceDirName</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                                        <b>if</b> (<span class="r64 r">path</span>.<span class="i">Contains</span>(<span class="r71 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>))
                                        {
                                            <b>if</b> (<span class="r76 r">arrSecurity</span> == <b>null</b>)
                                            {
                                                <b>return</b>;
                                            }
 
                                            <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r83 rd" class="r83 r">p</span> <b>in</b> <span class="r76 r">arrSecurity</span>)
                                            {
                                                <b>if</b> (<span class="r64 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                                {
                                                    <span class="i">WriteItemObject</span>(<span class="i">GetItemPSObjectWithTypeName</span>(<span class="r83 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;SecurityDIR&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>, <b>null</b>, <b>new</b> <b>string</b>[] { <span class="s">&quot;Uri=&quot;</span> + <span class="r83 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;Uri&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>() }, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>), <span class="r64 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r83 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;SecurityDIR&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <b>true</b>);
                                                }
                                                <b>else</b>
                                                {
                                                    <b>string</b> <span id="r84 rd" class="r84 r">sSecurityDirName</span> = <span class="r64 r">path</span>.<span class="i">Substring</span>(<span class="r64 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1, <span class="r64 r">path</span>.<span class="i">Length</span> - (<span class="r64 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1));
                                                    <b>if</b> (<span class="r84 r">sSecurityDirName</span>.<span class="i">Equals</span>(<span class="r83 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;SecurityDIR&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>()))
                                                    {
                                                        <span class="r83 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Remove</span>(<span class="s">&quot;SecurityDIR&quot;</span>);
                                                        <span class="i">WriteItemObject</span>(<a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(<span class="r83 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r83 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#af662506826a4d3d" class="i property">TypeNameOfValue</a>, <span class="r83 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>), <span class="r64 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r83 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <b>false</b>);
                                                        <b>break</b>;
                                                    }
                                                }
                                            }
 
                                            <b>return</b>;
                                        }
                                    }
                                }
                                <b>else</b> <b>if</b> (<span class="r64 r">path</span>.<span class="i">EndsWith</span>(<span class="r67 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r72 r">currentpluginname</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <b>if</b> (<span class="r78 r">arrInitParams</span> != <b>null</b>)
                                    {
                                        <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r85 rd" class="r85 r">p</span> <b>in</b> <span class="r78 r">arrInitParams</span>)
                                        {
                                            <b>if</b> (<span class="r85 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Match</span>(<span class="r65 r">childname</span>, <a href="/System.Management.Automation/A.html#eea11a22a8defd3e" class="t t">PSMemberTypes</a>.<a href="/System.Management.Automation/A.html#9265b28353caf0e3" class="i field">NoteProperty</a>).<a href="/System.Management.Automation/A.html#4fcb958a2e493168" class="i property">Count</a> &gt; 0)
                                                <span class="i">WriteItemObject</span>(<a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(<span class="r85 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r85 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#af662506826a4d3d" class="i property">TypeNameOfValue</a>, <span class="r85 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>, <b>null</b>, <span class="s">&quot;InitParams&quot;</span>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>), <span class="r64 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r85 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <b>false</b>);
                                        }
                                    }
                                }
                                <b>else</b> <b>if</b> (<span class="r64 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <span class="c">// Get the Quotas element from the config XML.</span>
                                    <span class="i">XmlNodeList</span> <span id="r86 rd" class="r86 r">nodeListForQuotas</span> = <span class="r74 r">CurrentPluginXML</span>.<span class="i">GetElementsByTagName</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>);
                                    <b>if</b> (<span class="r86 r">nodeListForQuotas</span>.<span class="i">Count</span> &gt; 0)
                                    {
                                        <span class="i">XmlNode</span> <span id="r87 rd" class="r87 r">pluginQuotas</span> = <span class="r86 r">nodeListForQuotas</span>[0];
                                        <b>foreach</b> (<span class="i">XmlAttribute</span> <span id="r88 rd" class="r88 r">attrOfQuotas</span> <b>in</b> <span class="r87 r">pluginQuotas</span>.<span class="i">Attributes</span>)
                                        {
                                            <b>if</b> (<span class="r65 r">childname</span>.<span class="i">Equals</span>(<span class="r88 r">attrOfQuotas</span>.<span class="i">Name</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                            {
                                                <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r89 rd" class="r89 r">objectToAdd</span> =
                                                    <span class="i">GetItemPSObjectWithTypeName</span>(
                                                        <span class="r88 r">attrOfQuotas</span>.<span class="i">Name</span>,
                                                        <span class="r88 r">attrOfQuotas</span>.<span class="i">Value</span>.<span class="i">GetType</span>().<span class="i">ToString</span>(),
                                                        <span class="r88 r">attrOfQuotas</span>.<span class="i">Value</span>,
                                                        <b>null</b>,
                                                        <b>null</b>,
                                                        <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>);
 
                                                <b>string</b> <span id="r90 rd" class="r90 r">pathToAdd</span> =
                                                    <b>string</b>.<span class="i">Format</span>(
                                                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                                                        <span class="s">&quot;{0}{1}{2}&quot;</span>,
                                                        <span class="r64 r">path</span>,
                                                        <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>,
                                                        <span class="r88 r">attrOfQuotas</span>.<span class="i">Name</span>);
 
                                                <span class="i">WriteItemObject</span>(<span class="r89 r">objectToAdd</span>, <span class="r90 r">pathToAdd</span>, <b>false</b>);
                                                <b>break</b>;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        <b>catch</b> (<a href="/System.Management.Automation/A.html#efa3789145f41301" class="t t">PSArgumentNullException</a>) { <b>return</b>; }
                        <b>catch</b> (<span class="i">NullReferenceException</span>) { <b>return</b>; }
                    }
                }
                <b>else</b>
                {
                    <b>try</b>
                    {
                        <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r91 rd" class="r91 r">mshObject</span> = <b>null</b>;
                        <b>if</b> (!<span class="r68 r">uri</span>.<span class="i">Equals</span>(<a href="#b34112b4f6fb44e7" class="i field">WinrmRootName</a>[0], <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r92 rd" class="r92 r">innerResourceNodes</span> <b>in</b> <span class="r70 r">xmlResource</span>.<span class="i">ChildNodes</span>)
                            {
                                <span class="r91 r">mshObject</span> = <a href="#edd1bbc7452c8ae2" class="i method">ConvertToPSObject</a>(<span class="r92 r">innerResourceNodes</span>);
                            }
                        }
                        <b>else</b>
                        {
                            <span class="r91 r">mshObject</span> = <a href="#95ab8fd9493f109a" class="i method">BuildHostLevelPSObjectArrayList</a>(<span class="r69 r">sessionobj</span>, <span class="r68 r">uri</span>, <b>false</b>);
                        }
 
                        <b>if</b> (<span class="r91 r">mshObject</span> != <b>null</b>)
                        {
                            <b>if</b> (<span class="r91 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>))
                            {
                                <span class="i">WriteItemObject</span>(<span class="i">GetItemPSObjectWithTypeName</span>(<span class="r91 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r91 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <b>null</b>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>), <span class="r64 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r91 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <b>true</b>);
                            }
                            <b>else</b>
                            {
                                <span class="i">WriteItemObject</span>(
                                    <a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(
                                        <span class="r91 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>,
                                        <span class="r91 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#af662506826a4d3d" class="i property">TypeNameOfValue</a>,
                                        <span class="r91 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>,
                                        <b>null</b>, <b>null</b>,
                                        <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>,
                                        <span class="r91 r">mshObject</span>),
                                    <span class="r64 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r91 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r65 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>,
                                    <b>false</b>);
                            }
                        }
                    }
                    <b>catch</b> (<a href="/System.Management.Automation/A.html#efa3789145f41301" class="t t">PSArgumentNullException</a>) { <b>return</b>; <span class="c">/*Leaving this known exception for no value found. Not Throwing error.*/</span>}
                    <b>catch</b> (<span class="i">NullReferenceException</span>) { <b>return</b>; <span class="c">/*Leaving this known exception for no value found. Not Throwing error.*/</span>}
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This cmdlet is used to set the value of a particular item.</span>
        <span class="c">///</span><span class="c"> cd wsman:\localhost\client&gt; Set-Item .\TrustedHosts -value &quot;*&quot;</span>
        <span class="c">///</span><span class="c"> This has one dynamic parameter. It is used with TrustedHost only.</span>
        <span class="c">///</span><span class="c"> The parameter is -Concatenate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Maintainability&quot;</span>, <span class="s">&quot;CA1505:AvoidUnmaintainableCode&quot;</span>)]
        <b>protected override void</b> <a id="6917948d427691c9" href="R/6917948d427691c9.html" target="n" data-glyph="75,1" class="i method">SetItem</a>(<b>string</b> <span id="r93 rd" class="r93 r">path</span>, <b>object</b> <span id="r94 rd" class="r94 r">value</span>)
        {
            <b>if</b> (<span class="r94 r">value</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;value&quot;</span>));
            }
 
            <b>string</b> <span id="r95 rd" class="r95 r">ChildName</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<span class="r93 r">path</span>.<span class="i">Length</span> == 0 &amp;&amp; <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r95 r">ChildName</span>))
            {
                <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemNotSupported&quot;</span>), <b>false</b>);
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r93 r">path</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>()))
            {
                <span class="c">// Get the ChildName</span>
                <span class="r95 r">ChildName</span> = <span class="r93 r">path</span>.<span class="i">Substring</span>(<span class="r93 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1);
            }
            <b>else</b>
            {
                <span class="r95 r">ChildName</span> = <span class="r93 r">path</span>;
            }
 
            <b>if</b> (<span class="r95 r">ChildName</span>.<span class="i">Equals</span>(<span class="r93 r">path</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemNotSupported&quot;</span>), <b>false</b>);
                <b>return</b>;
            }
 
            <b>if</b> (!<a href="#959910a828c6b791" class="k">this</a>.<a href="#7a6ae657f181fce0" class="i field">clearItemIsCalled</a>)
            {
                <span class="r94 r">value</span> = <a href="#959910a828c6b791" class="k">this</a>.<a href="#18219680bd3b8f96" class="i method">ValidateAndGetUserObject</a>(<span class="r95 r">ChildName</span>, <span class="r94 r">value</span>);
 
                <span class="c">// The value will be Null only if the object provided by User is not of accepted type.</span>
                <span class="c">// As of now, this can only happen in case of RunAsUserName and RunAsPassword</span>
                <b>if</b> (<span class="r94 r">value</span> == <b>null</b>)
                {
                    <b>return</b>;
                }
            }
            <b>else</b>
            {
                <span class="c">// If validation is not required, that means Clear-Item cmdlet is called.</span>
                <span class="c">// Clear-Item is not allowed on RunAsPassword, Admin should call Clear-Item RunAsUser</span>
                <span class="c">// if he intends to disable RunAs on the Plugin.</span>
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r95 r">ChildName</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e21ec3eff0232026" class="i field">ConfigRunAsPasswordName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;ClearItemOnRunAsPassword&quot;</span>), <b>false</b>);
                    <b>return</b>;
                }
            }
 
            <b>string</b> <span id="r96 rd" class="r96 r">whatIfMessage</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>, <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemWhatIfAndConfirmText&quot;</span>), <span class="r93 r">path</span>, <span class="r94 r">value</span>);
            <b>if</b> (!<span class="i">ShouldProcess</span>(<span class="r96 r">whatIfMessage</span>, <b>string</b>.<span class="i">Empty</span>, <b>string</b>.<span class="i">Empty</span>))
            {
                <b>return</b>;
            }
 
            <span class="r93 r">path</span> = <span class="r93 r">path</span>.<span class="i">Substring</span>(0, <span class="r93 r">path</span>.<span class="i">LastIndexOf</span>(<span class="r95 r">ChildName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
 
            <span class="c">// Get the wsman host name to find the session object</span>
            <b>string</b> <span id="r97 rd" class="r97 r">host</span> = <a href="#660b53b524868f2c" class="i method">GetHostName</a>(<span class="r93 r">path</span>);
            <b>string</b> <span id="r98 rd" class="r98 r">uri</span> = <a href="#103267db7d6cc518" class="i method">NormalizePath</a>(<span class="r93 r">path</span>, <span class="r97 r">host</span>);
 
            <span class="c">// Chk for Winrm Service</span>
            <b>if</b> (<a href="#f48e279095b5a8c1" class="i method">IsPathLocalMachine</a>(<span class="r97 r">host</span>))
            {
                <b>if</b> (!<a href="#049952faaf766e5b" class="i method">IsWSManServiceRunning</a>())
                {
                    <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#e53fd23e593153ef" class="i method">ThrowIfNotAdministrator</a>();
                    <a href="#76311111d1d2f1b2" class="i method">StartWSManService</a>(<a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#e3c4d51f13fbfcaa" class="i property">Force</a>);
                }
            }
 
            <b>bool</b> <span id="r99 rd" class="r99 r">settingPickedUpDynamically</span> = <b>false</b>;
 
            <b>lock</b> (<a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2a23b1e8c34cc740" class="i field">AutoSession</a>)
            {
                <span class="c">// Gets the session object from the cache.</span>
                <b>object</b> <span id="r100 rd" class="r100 r">sessionobj</span>;
                <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r101 rd" class="r101 r">SessionObjCache</span> = <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2b29be8459e983a7" class="i method">GetSessionObjCache</a>();
                <span class="r101 r">SessionObjCache</span>.<span class="i">TryGetValue</span>(<span class="r97 r">host</span>, <b>out</b> <span class="r100 r">sessionobj</span>);
 
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r102 rd" class="r102 r">warningMessage</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
                <span class="c">// if endswith &#39;\&#39;, removes it.</span>
                <b>if</b> (<span class="r93 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r93 r">path</span> = <span class="r93 r">path</span>.<span class="i">Remove</span>(<span class="r93 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
                }
 
                <b>string</b> <span id="r103 rd" class="r103 r">strPathChk</span> = <span class="r97 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                <b>if</b> (<span class="r93 r">path</span>.<span class="i">Contains</span>(<span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>))
                {
                    <a href="#cd7ef30db324111a" class="i method">SetItemListenerOrClientCertificate</a>(<span class="r100 r">sessionobj</span>, <span class="r98 r">uri</span>, <a href="#d26439e8d1643cad" class="i field">PKeyListener</a>, <span class="r95 r">ChildName</span>, <span class="r94 r">value</span>, <span class="r93 r">path</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="r97 r">host</span>);
                }
                <b>else</b> <b>if</b> (<span class="r93 r">path</span>.<span class="i">Contains</span>(<span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>))
                {
                    <a href="#cd7ef30db324111a" class="i method">SetItemListenerOrClientCertificate</a>(<span class="r100 r">sessionobj</span>, <span class="r98 r">uri</span>, <a href="#aee208c83944c3af" class="i field">PKeyCertMapping</a>, <span class="r95 r">ChildName</span>, <span class="r94 r">value</span>, <span class="r93 r">path</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="r97 r">host</span>);
                }
                <b>else</b> <b>if</b> (<span class="r93 r">path</span>.<span class="i">Contains</span>(<span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>))
                {
                    <b>if</b> (<span class="r93 r">path</span>.<span class="i">EndsWith</span>(<span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemNotSupported&quot;</span>), <b>false</b>);
                    }
 
                    <b>try</b>
                    {
                        <span class="i">XmlDocument</span> <span id="r104 rd" class="r104 r">xmlPlugins</span> = <a href="#14c3c20542e6ba32" class="i method">FindResourceValue</a>(<span class="r100 r">sessionobj</span>, <span class="r98 r">uri</span>, <b>null</b>);
                        <b>string</b> <span id="r105 rd" class="r105 r">currentpluginname</span> = <b>string</b>.<span class="i">Empty</span>;
                        <a href="#652b1bae7a230230" class="i method">GetPluginNames</a>(<span class="r104 r">xmlPlugins</span>, <b>out</b> <a href="#7be9fa29345270fd" class="i field">objPluginNames</a>, <b>out</b> <span class="r105 r">currentpluginname</span>, <span class="r93 r">path</span>);
                        <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r105 r">currentpluginname</span>))
                        {
                            <b>if</b> (!<a href="#959910a828c6b791" class="k">this</a>.<a href="#7a6ae657f181fce0" class="i field">clearItemIsCalled</a>)
                            {
                                <span class="c">// Don&#39;t need an error if ClearItem is called.</span>
                                <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;ItemDoesNotExist&quot;</span>), <b>false</b>);
                            }
 
                            <b>return</b>;
                        }
 
                        <b>string</b> <span id="r106 rd" class="r106 r">filter</span> = <span class="r98 r">uri</span> + <span class="s">&quot;?Name=&quot;</span> + <span class="r105 r">currentpluginname</span>;
 
                        <a href="CurrentConfigurations.cs.html#c913eeff994d9e83" class="t t">CurrentConfigurations</a> <span id="r107 rd" class="r107 r">pluginConfiguration</span> = <b>new</b> <a href="CurrentConfigurations.cs.html#586f961bc0674537" class="t constructor">CurrentConfigurations</a>((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r100 r">sessionobj</span>);
 
                        <b>string</b> <span id="r108 rd" class="r108 r">pluginXML</span> = <a href="#959910a828c6b791" class="k">this</a>.<a href="#db35803629c6844f" class="i method">GetResourceValueInXml</a>((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r100 r">sessionobj</span>, <span class="r106 r">filter</span>, <b>null</b>);
                        <span class="r107 r">pluginConfiguration</span>.<a href="CurrentConfigurations.cs.html#f5454ff2500cb1f5" class="i method">RefreshCurrentConfiguration</a>(<span class="r108 r">pluginXML</span>);
 
                        <span class="i">XmlDocument</span> <span id="r109 rd" class="r109 r">CurrentPluginXML</span> = <span class="r107 r">pluginConfiguration</span>.<a href="CurrentConfigurations.cs.html#75e160097015d5d9" class="i property">RootDocument</a>;
 
                        <span class="i">ArrayList</span> <span id="r110 rd" class="r110 r">arrSecurity</span> = <b>null</b>;
                        <span class="i">ArrayList</span> <span id="r111 rd" class="r111 r">arrResources</span> = <a href="#9fc4301cb03b79b7" class="i method">ProcessPluginResourceLevel</a>(<span class="r109 r">CurrentPluginXML</span>, <b>out</b> <span class="r110 r">arrSecurity</span>);
                        <span class="i">ArrayList</span> <span id="r112 rd" class="r112 r">arrInitParams</span> = <a href="#0f58ba5254c3d7ba" class="i method">ProcessPluginInitParamLevel</a>(<span class="r109 r">CurrentPluginXML</span>);
 
                        <b>try</b>
                        {
                            <span class="c">// Remove XML:LANG attribute if present.</span>
                            <span class="c">// If not present ignore the exception.</span>
                            <span class="r107 r">pluginConfiguration</span>.<a href="CurrentConfigurations.cs.html#c310dfb4daa3ead8" class="i method">RemoveOneConfiguration</a>(<span class="s">&quot;./attribute::xml:lang&quot;</span>);
                        }
                        <b>catch</b> (<span class="i">ArgumentException</span>)
                        { }
 
                        <span class="r103 r">strPathChk</span> = <span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                        <b>if</b> (<span class="r93 r">path</span>.<span class="i">EndsWith</span>(<span class="r103 r">strPathChk</span> + <span class="r105 r">currentpluginname</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>if</b> (<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e67a384d08cc8860" class="i field">ConfigRunAsUserName</a>.<span class="i">Equals</span>(<span class="r95 r">ChildName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <a href="/System.Management.Automation/A.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r113 rd" class="r113 r">runAsCredentials</span> = <span class="r94 r">value</span> <b>as</b> <a href="/System.Management.Automation/A.html#6245dc122e2f1916" class="t t">PSCredential</a>;
 
                                <b>if</b> (<span class="r113 r">runAsCredentials</span> != <b>null</b>)
                                {
                                    <span class="c">// UserName</span>
                                    <span class="r94 r">value</span> = <span class="r113 r">runAsCredentials</span>.<a href="/System.Management.Automation/A.html#3fca673651eaeaff" class="i property">UserName</a>;
 
                                    <span class="r107 r">pluginConfiguration</span>.<a href="CurrentConfigurations.cs.html#0d80e9ee3e95876b" class="i method">UpdateOneConfiguration</a>(
                                        <span class="s">&quot;.&quot;</span>,
                                        <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e21ec3eff0232026" class="i field">ConfigRunAsPasswordName</a>,
                                        <span class="i">GetStringFromSecureString</span>(<span class="r113 r">runAsCredentials</span>.<a href="/System.Management.Automation/A.html#828d5fa008f1755c" class="i property">Password</a>));
                                }
                            }
 
                            <b>if</b> (<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e21ec3eff0232026" class="i field">ConfigRunAsPasswordName</a>.<span class="i">Equals</span>(<span class="r95 r">ChildName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(
                                    <span class="r107 r">pluginConfiguration</span>.<span class="i">GetOneConfiguration</span>(
                                        <b>string</b>.<span class="i">Format</span>(
                                            <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                                            <span class="s">&quot;./attribute::{0}&quot;</span>,
                                            <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e67a384d08cc8860" class="i field">ConfigRunAsUserName</a>))))
                                {
                                    <span class="c">// User Cannot set RunAsPassword if, RunAsUser is not present.</span>
                                    <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemOnRunAsPasswordNoRunAsUser&quot;</span>), <b>false</b>);
                                }
 
                                <span class="r94 r">value</span> = <a href="#acc5197a7371fd28" class="i method">GetStringFromSecureString</a>(<span class="r94 r">value</span>);
                            }
 
                            <span class="r107 r">pluginConfiguration</span>.<span class="i">UpdateOneConfiguration</span>(<span class="s">&quot;.&quot;</span>, <span class="r95 r">ChildName</span>, <span class="r94 r">value</span>.<span class="i">ToString</span>());
                        }
 
                        <span class="r103 r">strPathChk</span> = <span class="r103 r">strPathChk</span> + <span class="r105 r">currentpluginname</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                        <b>if</b> (<span class="r93 r">path</span>.<span class="i">Contains</span>(<span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>))
                        {
                            <b>if</b> (<span class="r93 r">path</span>.<span class="i">EndsWith</span>(<span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemNotSupported&quot;</span>), <b>false</b>);
                                <b>return</b>;
                            }
 
                            <span class="r103 r">strPathChk</span> = <span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                            <b>int</b> <span id="r114 rd" class="r114 r">Sepindex</span> = <span class="r93 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r103 r">strPathChk</span>.<span class="i">Length</span>);
                            <b>string</b> <span id="r115 rd" class="r115 r">sResourceDirName</span> = <b>string</b>.<span class="i">Empty</span>;
                            <b>if</b> (<span class="r114 r">Sepindex</span> == -1)
                            {
                                <span class="r115 r">sResourceDirName</span> = <span class="r93 r">path</span>.<span class="i">Substring</span>(<span class="r103 r">strPathChk</span>.<span class="i">Length</span>);
                            }
                            <b>else</b>
                            {
                                <span class="r115 r">sResourceDirName</span> = <span class="r93 r">path</span>.<span class="i">Substring</span>(<span class="r103 r">strPathChk</span>.<span class="i">Length</span>, <span class="r93 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r103 r">strPathChk</span>.<span class="i">Length</span>) - (<span class="r103 r">strPathChk</span>.<span class="i">Length</span>));
                            }
 
                            <b>if</b> (<span class="r93 r">path</span>.<span class="i">Contains</span>(<span class="r103 r">strPathChk</span> + <span class="r115 r">sResourceDirName</span>))
                            {
                                <b>if</b> (<span class="r93 r">path</span>.<span class="i">EndsWith</span>(<span class="r103 r">strPathChk</span> + <span class="r115 r">sResourceDirName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <b>if</b> (<span class="r111 r">arrResources</span> == <b>null</b>)
                                    {
                                        <b>return</b>;
                                    }
 
                                    <b>if</b> (<span class="r95 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b0fbc7a19c627e9d" class="i field">ConfigResourceUriName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NoChangeValue&quot;</span>), <b>false</b>);
                                        <b>return</b>;
                                    }
 
                                    <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r116 rd" class="r116 r">p</span> <b>in</b> <span class="r111 r">arrResources</span>)
                                    {
                                        <b>if</b> (<span class="r115 r">sResourceDirName</span>.<span class="i">Equals</span>(<span class="r116 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                        {
                                            <b>string</b> <span id="r117 rd" class="r117 r">xpathToUse</span> = <b>string</b>.<span class="i">Format</span>(
                                                <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                                                <span class="s">&quot;{0}:{1}/{0}:{2}[attribute::{3}=&#39;{4}&#39;]&quot;</span>,
                                                <a href="CurrentConfigurations.cs.html#c913eeff994d9e83" class="t t">CurrentConfigurations</a>.<a href="CurrentConfigurations.cs.html#5a39795efa3e93c9" class="i field">DefaultNameSpacePrefix</a>,
                                                <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>,
                                                <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#039e73f615517a0d" class="i field">containerSingleResource</a>,
                                                <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b0fbc7a19c627e9d" class="i field">ConfigResourceUriName</a>,
                                                <span class="r116 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b0fbc7a19c627e9d" class="i field">ConfigResourceUriName</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>());
 
                                            <b>if</b> (!<span class="r116 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r95 r">ChildName</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>))
                                            {
                                                <span class="c">// Allow Set-Item on non-container values only.</span>
                                                <span class="r107 r">pluginConfiguration</span>.<span class="i">UpdateOneConfiguration</span>(<span class="r117 r">xpathToUse</span>, <span class="r95 r">ChildName</span>, <span class="r94 r">value</span>.<span class="i">ToString</span>());
                                            }
                                            <b>else</b>
                                            {
                                                <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NoChangeValue&quot;</span>), <b>false</b>);
                                            }
                                        }
                                    }
                                }
 
                                <span class="r103 r">strPathChk</span> = <span class="r103 r">strPathChk</span> + <span class="r115 r">sResourceDirName</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                                <b>if</b> (<span class="r93 r">path</span>.<span class="i">Contains</span>(<span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>))
                                {
                                    <b>if</b> (<span class="r93 r">path</span>.<span class="i">EndsWith</span>(<span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NoChangeValue&quot;</span>), <b>false</b>);
                                        <b>return</b>;
                                    }
 
                                    <b>if</b> (<span class="r110 r">arrSecurity</span> == <b>null</b>)
                                    {
                                        <b>return</b>;
                                    }
 
                                    <b>if</b> (<span class="r93 r">path</span>.<span class="i">Contains</span>(<span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a> + <span class="s">&quot;_&quot;</span>))
                                    {
                                        <span class="c">// Any setting inside security for plugin is picked up by service dynamically</span>
                                        <span class="r99 r">settingPickedUpDynamically</span> = <b>true</b>;
 
                                        <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r118 rd" class="r118 r">p</span> <b>in</b> <span class="r110 r">arrSecurity</span>)
                                        {
                                            <b>string</b> <span id="r119 rd" class="r119 r">sSecurityDirName</span> = <span class="r93 r">path</span>.<span class="i">Substring</span>(<span class="r93 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1, <span class="r93 r">path</span>.<span class="i">Length</span> - (<span class="r93 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1));
                                            <b>if</b> (<span class="r119 r">sSecurityDirName</span>.<span class="i">Equals</span>(<span class="r118 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;SecurityDIR&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                            {
                                                <b>if</b> (!<a href="/System.Management.Automation/A.html#e3c4d51f13fbfcaa" class="i property">Force</a>)
                                                {
                                                    <b>string</b> <span id="r120 rd" class="r120 r">query</span> = <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;ShouldContinueSecurityQuery&quot;</span>);
                                                    <span class="r120 r">query</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="r120 r">query</span>, <span class="r105 r">currentpluginname</span>);
                                                    <b>if</b> (!<span class="i">ShouldContinue</span>(<span class="r120 r">query</span>, <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;ShouldContinueSecurityCaption&quot;</span>)))
                                                    {
                                                        <b>return</b>;
                                                    }
                                                }
 
                                                <span class="c">// NameSpace:Resources/NameSpace:Resource[@ResourceUri={&#39;&#39;}]/NameSpace:Security[@Uri=&#39;{2}&#39;]</span>
                                                <b>string</b> <span id="r121 rd" class="r121 r">xpathToUse</span> = <b>string</b>.<span class="i">Format</span>(
                                                    <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                                                    <span class="s">&quot;{0}:{1}/{0}:{2}[@{6}=&#39;{7}&#39;]/{0}:{3}[@{4}=&#39;{5}&#39;]&quot;</span>,
                                                    <a href="CurrentConfigurations.cs.html#c913eeff994d9e83" class="t t">CurrentConfigurations</a>.<a href="CurrentConfigurations.cs.html#5a39795efa3e93c9" class="i field">DefaultNameSpacePrefix</a>,
                                                    <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>,
                                                    <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#039e73f615517a0d" class="i field">containerSingleResource</a>,
                                                    <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>,
                                                    <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d3da42830aea3e5b" class="i field">ConfigSecurityUri</a>,
                                                    <span class="r118 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d3da42830aea3e5b" class="i field">ConfigSecurityUri</a>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(),
                                                    <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b0fbc7a19c627e9d" class="i field">ConfigResourceUriName</a>,
                                                    <span class="r118 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ParentResourceUri&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>());
 
                                                <span class="r107 r">pluginConfiguration</span>.<span class="i">UpdateOneConfiguration</span>(<span class="r121 r">xpathToUse</span>, <span class="r95 r">ChildName</span>, <span class="r94 r">value</span>.<span class="i">ToString</span>());
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        <b>else</b> <b>if</b> (<span class="r93 r">path</span>.<span class="i">EndsWith</span>(<span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r122 rd" class="r122 r">p</span> <b>in</b> <span class="r112 r">arrInitParams</span>)
                            {
                                <b>if</b> (<span class="r122 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r95 r">ChildName</span>] != <b>null</b>)
                                {
                                    <b>string</b> <span id="r123 rd" class="r123 r">xpathToUse</span> = <b>string</b>.<span class="i">Format</span>(
                                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                                        <span class="s">&quot;{0}:{1}/{0}:{2}[@{3}=&#39;{4}&#39;]&quot;</span>,
                                        <a href="CurrentConfigurations.cs.html#c913eeff994d9e83" class="t t">CurrentConfigurations</a>.<a href="CurrentConfigurations.cs.html#5a39795efa3e93c9" class="i field">DefaultNameSpacePrefix</a>,
                                        <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>,
                                        <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6737e82eb35b72e4" class="i field">ConfigInitializeParameterTag</a>,
                                        <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5dba89aff32f02c7" class="i field">ConfigInitializeParameterName</a>,
                                        <span class="r122 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r95 r">ChildName</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>);
 
                                    <span class="r107 r">pluginConfiguration</span>.<span class="i">UpdateOneConfiguration</span>(<span class="r123 r">xpathToUse</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#48d6cbce0d4f779f" class="i field">ConfigInitializeParameterValue</a>, <span class="r94 r">value</span>.<span class="i">ToString</span>());
 
                                    <b>break</b>;
                                }
                            }
                        }
                        <b>else</b> <b>if</b> (<span class="r93 r">path</span>.<span class="i">EndsWith</span>(<span class="r103 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>string</b> <span id="r124 rd" class="r124 r">xpathToUse</span> = <b>string</b>.<span class="i">Format</span>(
                                <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                                <span class="s">&quot;{0}:{1}&quot;</span>,
                                <a href="CurrentConfigurations.cs.html#c913eeff994d9e83" class="t t">CurrentConfigurations</a>.<a href="CurrentConfigurations.cs.html#5a39795efa3e93c9" class="i field">DefaultNameSpacePrefix</a>,
                                <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>);
 
                            <span class="r107 r">pluginConfiguration</span>.<span class="i">UpdateOneConfiguration</span>(<span class="r124 r">xpathToUse</span>, <span class="r95 r">ChildName</span>, <span class="r94 r">value</span>.<span class="i">ToString</span>());
 
                            <b>if</b> (<a href="#dc0bbe86e158d91c" class="i field">ppqWarningConfigurations</a>.<span class="i">Contains</span>(<span class="r95 r">ChildName</span>.<span class="i">ToLowerInvariant</span>()))
                            {
                                <b>string</b> <span id="r125 rd" class="r125 r">adjustedChileName</span> = <span class="r95 r">ChildName</span>;
 
                                <b>if</b> (<span class="r95 r">ChildName</span>.<span class="i">Equals</span>(<span class="s">&quot;IdleTimeoutms&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <span class="r125 r">adjustedChileName</span> = <span class="s">&quot;IdleTimeout&quot;</span>;
                                }
 
                                <b>string</b> <span id="r126 rd" class="r126 r">pathForGlobalQuota</span> =
                                    <b>string</b>.<span class="i">Format</span>(
                                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                                        <span class="s">@&quot;{0}:\{1}\{2}\{3}&quot;</span>,
                                        <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ff28b0893dfbf7d2" class="i field">rootpath</a>,
                                        <span class="r97 r">host</span>,
                                        <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#889838e923e5bdb8" class="i field">containerShell</a>,
                                        <span class="r125 r">adjustedChileName</span>);
 
                                <span class="r102 r">warningMessage</span>.<span class="i">Add</span>(<b>string</b>.<span class="i">Format</span>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemWarnigForPPQ&quot;</span>), <span class="r126 r">pathForGlobalQuota</span>));
                            }
                        }
 
                        <span class="r101 r">SessionObjCache</span>.<span class="i">TryGetValue</span>(<span class="r97 r">host</span>, <b>out</b> <span class="r100 r">sessionobj</span>);
                        <b>string</b> <span id="r127 rd" class="r127 r">resourceUri</span> = <b>string</b>.<span class="i">Format</span>(
                            <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                            <span class="s">&quot;{0}?Name={1}&quot;</span>,
                            <span class="r98 r">uri</span>,
                            <span class="r105 r">currentpluginname</span>);
 
                        <b>try</b>
                        {
                            <span class="r107 r">pluginConfiguration</span>.<a href="CurrentConfigurations.cs.html#4bd307848afeaa9c" class="i method">PutConfigurationOnServer</a>(<span class="r127 r">resourceUri</span>);
 
                            <span class="c">// Show Win RM service restart warning only when the changed setting is not picked up dynamically</span>
                            <b>if</b> (!<span class="r99 r">settingPickedUpDynamically</span>)
                            {
                                <b>if</b> (<a href="#f48e279095b5a8c1" class="i method">IsPathLocalMachine</a>(<span class="r97 r">host</span>))
                                {
                                    <span class="r102 r">warningMessage</span>.<span class="i">Add</span>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemServiceRestartWarning&quot;</span>));
                                }
                                <b>else</b>
                                {
                                    <span class="r102 r">warningMessage</span>.<span class="i">Add</span>(<b>string</b>.<span class="i">Format</span>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemServiceRestartWarningRemote&quot;</span>), <span class="r97 r">host</span>));
                                }
                            }
                        }
                        <b>finally</b>
                        {
                            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r107 r">pluginConfiguration</span>.<a href="CurrentConfigurations.cs.html#36490f8394ca2721" class="i property">ServerSession</a>.<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>))
                            {
                                <a href="#014253583d795bc0" class="i method">AssertError</a>(<span class="r107 r">pluginConfiguration</span>.<a href="CurrentConfigurations.cs.html#36490f8394ca2721" class="i property">ServerSession</a>.<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>, <b>true</b>);
                            }
                        }
                    }
                    <b>catch</b> (<a href="/System.Management.Automation/A.html#581bd9b947689819" class="t t">PSArgumentException</a>)
                    {
                        <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;ItemDoesNotExist&quot;</span>), <b>false</b>);
                        <b>return</b>;
                    }
                    <b>catch</b> (<a href="/System.Management.Automation/A.html#efa3789145f41301" class="t t">PSArgumentNullException</a>)
                    {
                        <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;ItemDoesNotExist&quot;</span>), <b>false</b>);
                        <b>return</b>;
                    }
                    <b>catch</b> (<span class="i">NullReferenceException</span>)
                    {
                        <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;ItemDoesNotExist&quot;</span>), <b>false</b>);
                        <b>return</b>;
                    }
                }
                <b>else</b>
                {
                    <b>try</b>
                    {
                        <span class="i">Hashtable</span> <span id="r128 rd" class="r128 r">cmdlinevalue</span> = <b>new</b> <span class="i">Hashtable</span>();
                        <b>if</b> (<span class="r95 r">ChildName</span>.<span class="i">Equals</span>(<span class="s">&quot;TrustedHosts&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || <span class="r95 r">ChildName</span>.<span class="i">Equals</span>(<span class="s">&quot;RootSDDL&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>if</b> (<span class="r94 r">value</span>.<span class="i">GetType</span>().<span class="i">FullName</span>.<span class="i">Equals</span>(<span class="s">&quot;System.String&quot;</span>))
                            {
                                <b>if</b> (!<a href="/System.Management.Automation/A.html#e3c4d51f13fbfcaa" class="i property">Force</a>)
                                {
                                    <b>string</b> <span id="r129 rd" class="r129 r">query</span> = <b>string</b>.<span class="i">Empty</span>;
                                    <b>string</b> <span id="r130 rd" class="r130 r">caption</span> = <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemGeneralSecurityCaption&quot;</span>);
                                    <b>if</b> (<span class="r95 r">ChildName</span>.<span class="i">Equals</span>(<span class="s">&quot;TrustedHosts&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <span class="r129 r">query</span> = <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemTrustedHostsWarningQuery&quot;</span>);
                                    }
                                    <b>else</b> <b>if</b> (<span class="r95 r">ChildName</span>.<span class="i">Equals</span>(<span class="s">&quot;RootSDDL&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <span class="r129 r">query</span> = <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemRootSDDLWarningQuery&quot;</span>);
                                    }
 
                                    <b>if</b> (!<span class="i">ShouldContinue</span>(<span class="r129 r">query</span>, <span class="r130 r">caption</span>))
                                    {
                                        <b>return</b>;
                                    }
                                }
 
                                <a href="#21a58035dfb1e35f" class="t t">WSManProviderSetItemDynamicParameters</a> <span id="r131 rd" class="r131 r">dynParams</span> = <a href="/System.Management.Automation/A.html#57d60aa2d2bc908d" class="i property">DynamicParameters</a> <b>as</b> <a href="#21a58035dfb1e35f" class="t t">WSManProviderSetItemDynamicParameters</a>;
                                <b>if</b> (<span class="r131 r">dynParams</span> != <b>null</b>)
                                {
                                    <b>if</b> (<span class="r131 r">dynParams</span>.<a href="#78a02c044d8ad01d" class="i property">Concatenate</a>)
                                    {
                                        <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r94 r">value</span>.<span class="i">ToString</span>()))
                                        {
                                            <span class="c">// &#39;,&#39; is used as the delimiter in WSMan for TrustedHosts.</span>
                                            <span class="r94 r">value</span> = <span class="i">SplitAndUpdateStringUsingDelimiter</span>(<span class="r100 r">sessionobj</span>, <span class="r98 r">uri</span>, <span class="r95 r">ChildName</span>, <span class="r94 r">value</span>.<span class="i">ToString</span>(), <span class="s">&quot;,&quot;</span>);
                                        }
                                    }
                                }
 
                                <span class="r128 r">cmdlinevalue</span>.<span class="i">Add</span>(<span class="r95 r">ChildName</span>, <span class="r94 r">value</span>);
                            }
                            <b>else</b>
                            {
                                <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;TrustedHostValueTypeError&quot;</span>), <b>false</b>);
                            }
                        }
                        <b>else</b>
                        {
                            <span class="r128 r">cmdlinevalue</span>.<span class="i">Add</span>(<span class="r95 r">ChildName</span>, <span class="r94 r">value</span>);
 
                            <b>if</b> (<a href="#3b8a2f96104bbd3a" class="i field">globalWarningUris</a>.<span class="i">Contains</span>(<span class="r98 r">uri</span>) &amp;&amp; <a href="#4963168d6b750a05" class="i field">globalWarningConfigurations</a>.<span class="i">Contains</span>(<span class="r95 r">ChildName</span>.<span class="i">ToLowerInvariant</span>()))
                            {
                                <span class="r102 r">warningMessage</span>.<span class="i">Add</span>(<b>string</b>.<span class="i">Format</span>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemWarningForGlobalQuota&quot;</span>), <span class="r94 r">value</span>));
                            }
                        }
 
                        <a href="#5d85e884733a3500" class="i method">PutResourceValue</a>(<span class="r100 r">sessionobj</span>, <span class="r98 r">uri</span>, <span class="r128 r">cmdlinevalue</span>, <span class="r97 r">host</span>);
                    }
                    <b>catch</b> (<span class="i">COMException</span> <span id="r132 rd" class="r132 r">e</span>)
                    {
                        <span class="i">AssertError</span>(<span class="r132 r">e</span>.<span class="i">Message</span>, <b>false</b>);
                        <b>return</b>;
                    }
                }
 
                <b>foreach</b> (<b>string</b> <span id="r133 rd" class="r133 r">warnings</span> <b>in</b> <span class="r102 r">warningMessage</span>)
                {
                    <span class="i">WriteWarning</span>(<span class="r133 r">warnings</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This command is used to clear the value of a item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r134 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="49cda3513b07f784" href="R/49cda3513b07f784.html" target="n" data-glyph="75,1" class="i method">ClearItem</a>(<b>string</b> <span id="r134 rd" class="r134 r">path</span>)
        {
            <a href="#959910a828c6b791" class="k">this</a>.<a href="#7a6ae657f181fce0" class="i field">clearItemIsCalled</a> = <b>true</b>;
            <span class="i">SetItem</span>(<span class="r134 r">path</span>, <b>string</b>.<span class="i">Empty</span>);
            <a href="#959910a828c6b791" class="k">this</a>.<a href="#7a6ae657f181fce0" class="i field">clearItemIsCalled</a> = <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is method which create the dynamic or runtime parameter for set-item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r135 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r136 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override object</b> <a id="c6548dc27dafaf72" href="R/c6548dc27dafaf72.html" target="n" data-glyph="75,1" class="i method">SetItemDynamicParameters</a>(<b>string</b> <span id="r135 rd" class="r135 r">path</span>, <b>object</b> <span id="r136 rd" class="r136 r">value</span>)
        {
            <b>if</b> (<span class="r135 r">path</span>.<span class="i">Length</span> != 0)
            {
                <b>string</b> <span id="r137 rd" class="r137 r">hostname</span> = <a href="#660b53b524868f2c" class="i method">GetHostName</a>(<span class="r135 r">path</span>);
                <b>if</b> (<span class="r135 r">path</span>.<span class="i">EndsWith</span>(<span class="r137 r">hostname</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#65ec6609d9d215e7" class="i field">containerClient</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="c">// To have Tab completion.</span>
                    <b>return</b> <b>new</b> <span class="t">WSManProviderSetItemDynamicParameters</span>();
                }
                <b>else</b> <b>if</b> (<span class="r135 r">path</span>.<span class="i">EndsWith</span>(<span class="r137 r">hostname</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#65ec6609d9d215e7" class="i field">containerClient</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#14caf545f3eccbf9" class="i field">containerTrustedHosts</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="c">// To Support Concatenate parameter for trustedhosts.</span>
                    <b>return</b> <b>new</b> <span class="t">WSManProviderSetItemDynamicParameters</span>();
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ContainerCmdletProvider
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the Child items. dir functionality</span>
        <span class="c">///</span><span class="c"> wsman:\localhost\client&gt; dir.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r138 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r139 r">recurse</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="fc40a387deec5963" href="R/fc40a387deec5963.html" target="n" data-glyph="75,1" class="i method">GetChildItems</a>(<b>string</b> <span id="r138 rd" class="r138 r">path</span>, <b>bool</b> <span id="r139 rd" class="r139 r">recurse</span>)
        {
            <a href="#ed74ecb1ed9b455b" class="i method">GetChildItemsOrNames</a>(<span class="r138 r">path</span>, <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>, <span class="r139 r">recurse</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method gives the names of child items. this is used for Tab completion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r140 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r141 r">returnContainers</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="00b26cf6c095a857" href="R/00b26cf6c095a857.html" target="n" data-glyph="75,1" class="i method">GetChildNames</a>(<b>string</b> <span id="r140 rd" class="r140 r">path</span>, <a href="/System.Management.Automation/A.html#33becc108c70a3e1" class="t t">ReturnContainers</a> <span id="r141 rd" class="r141 r">returnContainers</span>)
        {
            <a href="#ed74ecb1ed9b455b" class="i method">GetChildItemsOrNames</a>(<span class="r140 r">path</span>, <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>, <b>false</b>);
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> NavigationalCmdletProvider
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks whether the specified path is a container path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r142 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override bool</b> <a id="849337b35da1393c" href="R/849337b35da1393c.html" target="n" data-glyph="75,1" class="i method">IsItemContainer</a>(<b>string</b> <span id="r142 rd" class="r142 r">path</span>)
        {
            <b>string</b> <span id="r143 rd" class="r143 r">childname</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>string</b> <span id="r144 rd" class="r144 r">strPathCheck</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<span class="r142 r">path</span>.<span class="i">Length</span> == 0 &amp;&amp; <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r143 r">childname</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// if endswith &#39;\&#39;, removes it.</span>
            <b>if</b> (<span class="r142 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r142 r">path</span> = <span class="r142 r">path</span>.<span class="i">Remove</span>(<span class="r142 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
            }
 
            <b>if</b> (<span class="r142 r">path</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>()))
            {
                <span class="c">// Get the ChildName</span>
                <span class="r143 r">childname</span> = <span class="r142 r">path</span>.<span class="i">Substring</span>(<span class="r142 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1);
            }
 
            <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r145 rd" class="r145 r">SessionObjCache</span> = <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2b29be8459e983a7" class="i method">GetSessionObjCache</a>();
            <b>if</b> (<span class="r145 r">SessionObjCache</span>.<span class="i">ContainsKey</span>(<span class="r142 r">path</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// Get the wsman host name to find the session object</span>
            <b>string</b> <span id="r146 rd" class="r146 r">host</span> = <a href="#660b53b524868f2c" class="i method">GetHostName</a>(<span class="r142 r">path</span>);
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r146 r">host</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>string</b> <span id="r147 rd" class="r147 r">WsManURI</span> = <a href="#103267db7d6cc518" class="i method">NormalizePath</a>(<span class="r142 r">path</span>, <span class="r146 r">host</span>);
 
            <b>lock</b> (<a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2a23b1e8c34cc740" class="i field">AutoSession</a>)
            {
                <span class="c">// Gets the session object from the cache.</span>
                <b>object</b> <span id="r148 rd" class="r148 r">sessionobj</span>;
                <span class="r145 r">SessionObjCache</span>.<span class="i">TryGetValue</span>(<span class="r146 r">host</span>, <b>out</b> <span class="r148 r">sessionobj</span>);
 
                <span class="c">/*
                WsMan Config Can be divided in to Four Fixed Regions to Check Whether Item is Container
 
                 * 1. Branch in to Listeners (winrm/config/listener)
                 * 2. Branch in to CertMapping (winrm/config/service/certmapping)
                 * 3. Branch in to Plugin (winrm/config/plugin) - Plugin is subdivided in Resources,Security &amp; InitParams
                 * 4. Rest all the branches like Client, Shell(WinRS) ,Service
 
                */</span>
 
                <span class="c">// 1. Listener Checks</span>
                <span class="r144 r">strPathCheck</span> = <span class="r146 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                <b>if</b> (<span class="r147 r">WsManURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>))
                {
                    <span class="r144 r">strPathCheck</span> += <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>;
                    <b>if</b> (<span class="r142 r">path</span>.<span class="i">EndsWith</span>(<span class="r144 r">strPathCheck</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <span class="i">XmlDocument</span> <span id="r149 rd" class="r149 r">xmlListeners</span> = <a href="#be8ef6f2909993fb" class="i method">EnumerateResourceValue</a>(<span class="r148 r">sessionobj</span>, <span class="r147 r">WsManURI</span>);
 
                    <b>if</b> (<span class="r149 r">xmlListeners</span> != <b>null</b>)
                    {
                        <span class="i">Hashtable</span> <span id="r150 rd" class="r150 r">KeyCache</span>, <span id="r151 rd" class="r151 r">ListenerObjCache</span>;
                        <a href="#52d9ca2566594c0d" class="i method">ProcessListenerObjects</a>(<span class="r149 r">xmlListeners</span>, <b>out</b> <span class="r151 r">ListenerObjCache</span>, <b>out</b> <span class="r150 r">KeyCache</span>);
                        <b>if</b> (<span class="r150 r">KeyCache</span>.<span class="i">Contains</span>(<span class="r143 r">childname</span>))
                        {
                            <b>return</b> <b>true</b>;
                        }
                    }
                }
                <span class="c">// 2. Client Certificate Checks</span>
                <b>else</b> <b>if</b> (<span class="r147 r">WsManURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#22940af130242689" class="i field">containerCertMapping</a>))
                {
                    <span class="r144 r">strPathCheck</span> += <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>;
                    <b>if</b> (<span class="r142 r">path</span>.<span class="i">EndsWith</span>(<span class="r144 r">strPathCheck</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <span class="i">XmlDocument</span> <span id="r152 rd" class="r152 r">xmlCertificates</span> = <a href="#be8ef6f2909993fb" class="i method">EnumerateResourceValue</a>(<span class="r148 r">sessionobj</span>, <span class="r147 r">WsManURI</span>);
                    <b>if</b> (<span class="r152 r">xmlCertificates</span> != <b>null</b>)
                    {
                        <span class="i">Hashtable</span> <span id="r153 rd" class="r153 r">KeyCache</span>, <span id="r154 rd" class="r154 r">CertificatesObjCache</span>;
                        <a href="#01a3c58ac8787b59" class="i method">ProcessCertMappingObjects</a>(<span class="r152 r">xmlCertificates</span>, <b>out</b> <span class="r154 r">CertificatesObjCache</span>, <b>out</b> <span class="r153 r">KeyCache</span>);
                        <b>if</b> (<span class="r153 r">KeyCache</span>.<span class="i">Contains</span>(<span class="r143 r">childname</span>))
                        {
                            <b>return</b> <b>true</b>;
                        }
                    }
                }
                <span class="c">// 3. Plugin and its internal structure Checks</span>
                <b>else</b> <b>if</b> (<span class="r147 r">WsManURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>))
                {
                    <span class="r144 r">strPathCheck</span> += <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>;
                    <span class="c">// Check for Plugin path</span>
                    <b>if</b> (<span class="r142 r">path</span>.<span class="i">EndsWith</span>(<span class="r144 r">strPathCheck</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <span class="r144 r">strPathCheck</span> += <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                    <span class="i">XmlDocument</span> <span id="r155 rd" class="r155 r">xmlPlugins</span> = <a href="#14c3c20542e6ba32" class="i method">FindResourceValue</a>(<span class="r148 r">sessionobj</span>, <span class="r147 r">WsManURI</span>, <b>null</b>);
 
                    <b>string</b> <span id="r156 rd" class="r156 r">currentpluginname</span> = <b>string</b>.<span class="i">Empty</span>;
                    <a href="#652b1bae7a230230" class="i method">GetPluginNames</a>(<span class="r155 r">xmlPlugins</span>, <b>out</b> <a href="#7be9fa29345270fd" class="i field">objPluginNames</a>, <b>out</b> <span class="r156 r">currentpluginname</span>, <span class="r142 r">path</span>);
                    <span class="r144 r">strPathCheck</span> += <span class="r156 r">currentpluginname</span>;
                    <b>if</b> (<span class="r142 r">path</span>.<span class="i">EndsWith</span>(<span class="r156 r">currentpluginname</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <b>string</b> <span id="r157 rd" class="r157 r">filter</span> = <span class="r147 r">WsManURI</span> + <span class="s">&quot;?Name=&quot;</span> + <span class="r156 r">currentpluginname</span>;
                    <span class="i">XmlDocument</span> <span id="r158 rd" class="r158 r">CurrentPluginXML</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r148 r">sessionobj</span>, <span class="r157 r">filter</span>, <b>null</b>);
                    <span class="i">ArrayList</span> <span id="r159 rd" class="r159 r">arrSecurities</span> = <b>null</b>;
                    <span class="i">ArrayList</span> <span id="r160 rd" class="r160 r">arrResources</span> = <a href="#9fc4301cb03b79b7" class="i method">ProcessPluginResourceLevel</a>(<span class="r158 r">CurrentPluginXML</span>, <b>out</b> <span class="r159 r">arrSecurities</span>);
                    <b>if</b> (<span class="r142 r">path</span>.<span class="i">EndsWith</span>(<span class="r144 r">strPathCheck</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <span class="r144 r">strPathCheck</span> += <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                    <b>if</b> (<span class="r142 r">path</span>.<span class="i">EndsWith</span>(<span class="r144 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <b>if</b> (<span class="r142 r">path</span>.<span class="i">EndsWith</span>(<span class="r144 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <b>if</b> (<span class="r142 r">path</span>.<span class="i">EndsWith</span>(<span class="r144 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <b>if</b> (<span class="r160 r">arrResources</span> == <b>null</b> || <span class="r160 r">arrResources</span>.<span class="i">Count</span> == 0)
                    {
                        <b>return</b> <b>false</b>;
                    }
 
                    <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r161 rd" class="r161 r">objresource</span> <b>in</b> <span class="r160 r">arrResources</span>)
                    {
                        <b>string</b> <span id="r162 rd" class="r162 r">sResourceDirName</span> = <span class="r161 r">objresource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                        <b>if</b> (<span class="r142 r">path</span>.<span class="i">Contains</span>(<span class="r162 r">sResourceDirName</span>))
                        {
                            <span class="r144 r">strPathCheck</span> = <span class="r144 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                            <b>if</b> (<span class="r142 r">path</span>.<span class="i">EndsWith</span>(<span class="r144 r">strPathCheck</span> + <span class="r162 r">sResourceDirName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <b>return</b> <b>true</b>;
                            }
 
                            <span class="r144 r">strPathCheck</span> = <span class="r144 r">strPathCheck</span> + <span class="r162 r">sResourceDirName</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                            <b>if</b> (<span class="r142 r">path</span>.<span class="i">Contains</span>(<span class="r144 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>))
                            {
                                <b>if</b> (<span class="r142 r">path</span>.<span class="i">EndsWith</span>(<span class="r144 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <b>return</b> <b>true</b>;
                                }
 
                                <span class="r144 r">strPathCheck</span> = <span class="r144 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                                <b>if</b> (<span class="r142 r">path</span>.<span class="i">Contains</span>(<span class="r144 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a> + <span class="s">&quot;_&quot;</span>))
                                {
                                    <b>if</b> (<span class="r159 r">arrSecurities</span> == <b>null</b>)
                                    {
                                        <b>return</b> <b>false</b>;
                                    }
 
                                    <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r163 rd" class="r163 r">security</span> <b>in</b> <span class="r159 r">arrSecurities</span>)
                                    {
                                        <b>string</b> <span id="r164 rd" class="r164 r">sSecurity</span> = <span class="r163 r">security</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;SecurityDIR&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                                        <b>if</b> (<span class="r142 r">path</span>.<span class="i">EndsWith</span>(<span class="r164 r">sSecurity</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                            <b>return</b> <b>true</b>;
                                    }
                                }
                            }
                        }
                    }
                }
                <b>else</b>
                <span class="c">// 4. All Other Item Checks</span>
                {
                    <b>string</b> <span id="r165 rd" class="r165 r">getXml</span> = <a href="#959910a828c6b791" class="k">this</a>.<a href="#db35803629c6844f" class="i method">GetResourceValueInXml</a>(<span class="r148 r">sessionobj</span>, <span class="r147 r">WsManURI</span>, <b>null</b>);
                    <span class="i">XmlDocument</span> <span id="r166 rd" class="r166 r">xmlResourceValues</span> = <b>new</b> <span class="i">XmlDocument</span>();
                    <span class="r166 r">xmlResourceValues</span>.<span class="i">LoadXml</span>(<span class="r165 r">getXml</span>.<span class="i">ToLowerInvariant</span>());
                    <span class="i">XmlNodeList</span> <span id="r167 rd" class="r167 r">nodes</span> = <a href="#22e74b26a07bdcc0" class="i method">SearchXml</a>(<span class="r166 r">xmlResourceValues</span>, <span class="r143 r">childname</span>, <span class="r147 r">WsManURI</span>, <span class="r142 r">path</span>, <span class="r146 r">host</span>);
                    <b>bool</b> <span id="r168 rd" class="r168 r">result</span> = <a href="#f20176e1b52f02e0" class="i method">IsItemContainer</a>(<span class="r167 r">nodes</span>);
                    <b>return</b> <span class="r168 r">result</span>;
                }
 
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes a particular item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r169 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r170 r">recurse</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="02573d38a88083ce" href="R/02573d38a88083ce.html" target="n" data-glyph="75,1" class="i method">RemoveItem</a>(<b>string</b> <span id="r169 rd" class="r169 r">path</span>, <b>bool</b> <span id="r170 rd" class="r170 r">recurse</span>)
        {
            <b>bool</b> <span id="r171 rd" class="r171 r">throwerror</span> = <b>true</b>;
            <b>if</b> (<span class="r169 r">path</span>.<span class="i">Length</span> == 0)
            {
                <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;RemoveItemNotSupported&quot;</span>), <b>false</b>);
                <b>return</b>;
            }
 
            <b>string</b> <span id="r172 rd" class="r172 r">ChildName</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<span class="r169 r">path</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>()))
            {
                <span class="c">// Get the ChildName</span>
                <span class="r172 r">ChildName</span> = <span class="r169 r">path</span>.<span class="i">Substring</span>(<span class="r169 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1);
            }
            <b>else</b>
            {
                <span class="r172 r">ChildName</span> = <span class="r169 r">path</span>;
            }
 
            <b>if</b> (<span class="r172 r">ChildName</span>.<span class="i">Equals</span>(<span class="r169 r">path</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<span class="r172 r">ChildName</span>.<span class="i">Equals</span>(<span class="s">&quot;localhost&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;LocalHost&quot;</span>), <b>false</b>);
                }
 
                <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#e37737891fff2883" class="i method">RemoveFromDictionary</a>(<span class="r172 r">ChildName</span>);
                <b>return</b>;
            }
 
            <span class="r169 r">path</span> = <span class="r169 r">path</span>.<span class="i">Substring</span>(0, <span class="r169 r">path</span>.<span class="i">LastIndexOf</span>(<span class="r172 r">ChildName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
 
            <span class="c">// Get the wsman host name to find the session object</span>
            <b>string</b> <span id="r173 rd" class="r173 r">host</span> = <a href="#660b53b524868f2c" class="i method">GetHostName</a>(<span class="r169 r">path</span>);
            <b>string</b> <span id="r174 rd" class="r174 r">uri</span> = <a href="#103267db7d6cc518" class="i method">NormalizePath</a>(<span class="r169 r">path</span>, <span class="r173 r">host</span>);
 
            <span class="c">// Chk for Winrm Service</span>
            <b>if</b> (<a href="#f48e279095b5a8c1" class="i method">IsPathLocalMachine</a>(<span class="r173 r">host</span>))
            {
                <b>if</b> (!<a href="#049952faaf766e5b" class="i method">IsWSManServiceRunning</a>())
                {
                    <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#e53fd23e593153ef" class="i method">ThrowIfNotAdministrator</a>();
                    <a href="#76311111d1d2f1b2" class="i method">StartWSManService</a>(<a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#e3c4d51f13fbfcaa" class="i property">Force</a>);
                }
            }
 
            <b>lock</b> (<a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2a23b1e8c34cc740" class="i field">AutoSession</a>)
            {
                <span class="c">// Gets the session object from the cache.</span>
                <b>object</b> <span id="r175 rd" class="r175 r">sessionobj</span>;
                <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r176 rd" class="r176 r">SessionObjCache</span> = <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2b29be8459e983a7" class="i method">GetSessionObjCache</a>();
                <span class="r176 r">SessionObjCache</span>.<span class="i">TryGetValue</span>(<span class="r173 r">host</span>, <b>out</b> <span class="r175 r">sessionobj</span>);
 
                <span class="c">// if endswith &#39;\&#39;, removes it.</span>
                <b>if</b> (<span class="r169 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r169 r">path</span> = <span class="r169 r">path</span>.<span class="i">Remove</span>(<span class="r169 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
                }
 
                <b>string</b> <span id="r177 rd" class="r177 r">inputStr</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>string</b> <span id="r178 rd" class="r178 r">strPathCheck</span> = <b>string</b>.<span class="i">Empty</span>;
                <span class="r178 r">strPathCheck</span> = <span class="r173 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
 
                <b>if</b> (<span class="r169 r">path</span>.<span class="i">Contains</span>(<span class="r178 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>))<span class="c">//(path.Contains(@&quot;\plugin&quot;))</span>
                {
                    <b>if</b> (<span class="r169 r">path</span>.<span class="i">EndsWith</span>(<span class="r178 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="c">// Deletes all the Plugin when user is in WsMan:\Localhost\Plugin.</span>
                        <b>string</b> <span id="r179 rd" class="r179 r">pluginUri</span> = <span class="r174 r">uri</span> + <span class="s">&quot;?Name=&quot;</span> + <span class="r172 r">ChildName</span>;
                        <a href="#f1eb7a45c19a542e" class="i method">DeleteResourceValue</a>(<span class="r175 r">sessionobj</span>, <span class="r179 r">pluginUri</span>, <b>null</b>, <span class="r170 r">recurse</span>);
                        <b>return</b>;
                    }
 
                    <span class="r178 r">strPathCheck</span> += <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>;
                    <b>int</b> <span id="r180 rd" class="r180 r">pos</span> = 0; <b>string</b> <span id="r181 rd" class="r181 r">pName</span> = <b>null</b>;
 
                    <span class="r180 r">pos</span> = <span class="r169 r">path</span>.<span class="i">LastIndexOf</span>(<span class="r178 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) + <span class="r178 r">strPathCheck</span>.<span class="i">Length</span> + 1;
                    <b>int</b> <span id="r182 rd" class="r182 r">pindex</span> = <span class="r169 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r180 r">pos</span>);
                    <b>if</b> (<span class="r182 r">pindex</span> != -1)
                    {
                        <span class="r181 r">pName</span> = <span class="r169 r">path</span>.<span class="i">Substring</span>(<span class="r180 r">pos</span>, <span class="r169 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r180 r">pos</span>) - <span class="r180 r">pos</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r181 r">pName</span> = <span class="r169 r">path</span>.<span class="i">Substring</span>(<span class="r180 r">pos</span>);
                    }
 
                    <b>string</b> <span id="r183 rd" class="r183 r">filter1</span> = <span class="r174 r">uri</span> + <span class="s">&quot;?Name=&quot;</span> + <span class="r181 r">pName</span>;
                    <span class="i">XmlDocument</span> <span id="r184 rd" class="r184 r">pxml</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r175 r">sessionobj</span>, <span class="r183 r">filter1</span>, <b>null</b>);
 
                    <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r185 rd" class="r185 r">ps</span> = <a href="#d773ffd607e22121" class="i method">ProcessPluginConfigurationLevel</a>(<span class="r184 r">pxml</span>);
                    <span class="i">ArrayList</span> <span id="r186 rd" class="r186 r">SecurityArray</span> = <b>null</b>;
                    <span class="i">ArrayList</span> <span id="r187 rd" class="r187 r">ResourceArray</span> = <a href="#9fc4301cb03b79b7" class="i method">ProcessPluginResourceLevel</a>(<span class="r184 r">pxml</span>, <b>out</b> <span class="r186 r">SecurityArray</span>);
                    <span class="i">ArrayList</span> <span id="r188 rd" class="r188 r">InitParamArray</span> = <a href="#0f58ba5254c3d7ba" class="i method">ProcessPluginInitParamLevel</a>(<span class="r184 r">pxml</span>);
 
                    <span class="r178 r">strPathCheck</span> = <span class="r178 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r181 r">pName</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                    <b>if</b> (<span class="r169 r">path</span>.<span class="i">Contains</span>(<span class="r178 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>))
                    {
                        <span class="c">// Remove-Item is called for one of the resources.</span>
                        <b>if</b> (<span class="r169 r">path</span>.<span class="i">EndsWith</span>(<span class="r178 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="r171 r">throwerror</span> = <b>false</b>;
                            <span class="r187 r">ResourceArray</span> = <span class="i">RemoveItemfromResourceArray</span>(<span class="r187 r">ResourceArray</span>, <span class="r172 r">ChildName</span>, <b>string</b>.<span class="i">Empty</span>, <span class="s">&quot;ResourceDir&quot;</span>);
                        }
 
                        <b>if</b> (<span class="r171 r">throwerror</span>)
                        {
                            <span class="r178 r">strPathCheck</span> = <span class="r178 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                            <b>int</b> <span id="r189 rd" class="r189 r">Sepindex</span> = <span class="r169 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r178 r">strPathCheck</span>.<span class="i">Length</span>);
                            <b>string</b> <span id="r190 rd" class="r190 r">sResourceDirName</span> = <b>string</b>.<span class="i">Empty</span>;
                            <b>if</b> (<span class="r189 r">Sepindex</span> == -1)
                            {
                                <span class="r190 r">sResourceDirName</span> = <span class="r169 r">path</span>.<span class="i">Substring</span>(<span class="r178 r">strPathCheck</span>.<span class="i">Length</span>);
                            }
                            <b>else</b>
                            {
                                <span class="r190 r">sResourceDirName</span> = <span class="r169 r">path</span>.<span class="i">Substring</span>(<span class="r178 r">strPathCheck</span>.<span class="i">Length</span>, <span class="r169 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r178 r">strPathCheck</span>.<span class="i">Length</span>) - (<span class="r178 r">strPathCheck</span>.<span class="i">Length</span>));
                            }
 
                            <span class="r178 r">strPathCheck</span> = <span class="r178 r">strPathCheck</span> + <span class="r190 r">sResourceDirName</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                            <b>if</b> (<span class="r169 r">path</span>.<span class="i">EndsWith</span>(<span class="r178 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="r171 r">throwerror</span> = <b>false</b>;
                                <span class="r186 r">SecurityArray</span> = <span class="i">RemoveItemfromResourceArray</span>(<span class="r186 r">SecurityArray</span>, <span class="r172 r">ChildName</span>, <b>string</b>.<span class="i">Empty</span>, <span class="s">&quot;SecurityDIR&quot;</span>);
                            }
                        }
                    }
                    <b>else</b> <b>if</b> (<span class="r169 r">path</span>.<span class="i">EndsWith</span>(<span class="r178 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="c">// Remove-Item is called for one of the initialization Parameters.</span>
                        <span class="r171 r">throwerror</span> = <b>false</b>;
                        <span class="r188 r">InitParamArray</span> = <span class="i">RemoveItemfromResourceArray</span>(<span class="r188 r">InitParamArray</span>, <span class="r172 r">ChildName</span>, <span class="s">&quot;InitParams&quot;</span>, <b>string</b>.<span class="i">Empty</span>);
                    }
 
                    <b>if</b> (<span class="r171 r">throwerror</span>)
                    {
                        <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;RemoveItemNotSupported&quot;</span>), <b>false</b>);
                        <b>return</b>;
                    }
 
                    <span class="r177 r">inputStr</span> = <a href="#78a1921249a2d50e" class="i method">ConstructPluginXml</a>(<span class="r185 r">ps</span>, <span class="r174 r">uri</span>, <span class="r173 r">host</span>, <span class="s">&quot;Set&quot;</span>, <span class="r187 r">ResourceArray</span>, <span class="r186 r">SecurityArray</span>, <span class="r188 r">InitParamArray</span>);
                    <b>try</b>
                    {
                        ((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r175 r">sessionobj</span>).<span class="i">Put</span>(<span class="r174 r">uri</span> + <span class="s">&quot;?Name=&quot;</span> + <span class="r181 r">pName</span>, <span class="r177 r">inputStr</span>, 0);
                    }
                    <b>finally</b>
                    {
                        <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r175 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>))
                        {
                            <a href="#014253583d795bc0" class="i method">AssertError</a>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r175 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>, <b>true</b>);
                        }
                    }
                }
                <b>else</b> <b>if</b> (<span class="r169 r">path</span>.<span class="i">EndsWith</span>(<span class="r178 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r171 r">throwerror</span> = <b>false</b>;
                    <a href="#040bc358686b3352" class="i method">RemoveListenerOrCertMapping</a>(<span class="r175 r">sessionobj</span>, <span class="r174 r">uri</span>, <span class="r172 r">ChildName</span>, <a href="#d26439e8d1643cad" class="i field">PKeyListener</a>, <b>true</b>);
                }
                <b>else</b> <b>if</b> (<span class="r169 r">path</span>.<span class="i">EndsWith</span>(<span class="r178 r">strPathCheck</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r171 r">throwerror</span> = <b>false</b>;
                    <a href="#040bc358686b3352" class="i method">RemoveListenerOrCertMapping</a>(<span class="r175 r">sessionobj</span>, <span class="r174 r">uri</span>, <span class="r172 r">ChildName</span>, <a href="#aee208c83944c3af" class="i field">PKeyCertMapping</a>, <b>false</b>);
                }
 
                <b>if</b> (<span class="r171 r">throwerror</span>)
                {
                    <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;RemoveItemNotSupported&quot;</span>), <b>false</b>);
                    <b>return</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates a new item of listener,clientcertificate etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r191 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r192 r">itemTypeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r193 r">newItemValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="0abbd867c79c0630" href="R/0abbd867c79c0630.html" target="n" data-glyph="75,1" class="i method">NewItem</a>(<b>string</b> <span id="r191 rd" class="r191 r">path</span>, <b>string</b> <span id="r192 rd" class="r192 r">itemTypeName</span>, <b>object</b> <span id="r193 rd" class="r193 r">newItemValue</span>)
        {
            <b>string</b> <span id="r194 rd" class="r194 r">inputStr</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>object</b> <span id="r195 rd" class="r195 r">sessionobj</span>;
 
            <span class="c">// if endswith &#39;\&#39;, removes it.</span>
            <b>if</b> (<span class="r191 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r191 r">path</span> = <span class="r191 r">path</span>.<span class="i">Remove</span>(<span class="r191 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r191 r">path</span>.<span class="i">Length</span> == 0 || !<span class="r191 r">path</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>()))
            {
                <a href="#a0763951fcc39d2c" class="i method">NewItemCreateComputerConnection</a>(<span class="r191 r">path</span>);
                <b>return</b>;
            }
 
            <span class="c">// Get the wsman host name to find the session object</span>
            <b>string</b> <span id="r196 rd" class="r196 r">host</span> = <a href="#660b53b524868f2c" class="i method">GetHostName</a>(<span class="r191 r">path</span>);
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r196 r">host</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;InvalidPath&quot;</span>));
            }
 
            <span class="c">// Chk for Winrm Service</span>
            <b>if</b> (<a href="#f48e279095b5a8c1" class="i method">IsPathLocalMachine</a>(<span class="r196 r">host</span>))
            {
                <b>if</b> (!<a href="#049952faaf766e5b" class="i method">IsWSManServiceRunning</a>())
                {
                    <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#e53fd23e593153ef" class="i method">ThrowIfNotAdministrator</a>();
                    <a href="#76311111d1d2f1b2" class="i method">StartWSManService</a>(<a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#e3c4d51f13fbfcaa" class="i property">Force</a>);
                }
            }
 
            <b>string</b> <span id="r197 rd" class="r197 r">uri</span> = <a href="#103267db7d6cc518" class="i method">NormalizePath</a>(<span class="r191 r">path</span>, <span class="r196 r">host</span>);
 
            <b>lock</b> (<a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2a23b1e8c34cc740" class="i field">AutoSession</a>)
            {
                <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r198 rd" class="r198 r">SessionObjCache</span> = <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2b29be8459e983a7" class="i method">GetSessionObjCache</a>();
                <span class="r198 r">SessionObjCache</span>.<span class="i">TryGetValue</span>(<span class="r196 r">host</span>, <b>out</b> <span class="r195 r">sessionobj</span>);
 
                <b>string</b> <span id="r199 rd" class="r199 r">strPathChk</span> = <span class="r196 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                <b>if</b> (<span class="r191 r">path</span>.<span class="i">Contains</span>(<span class="r199 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>))<span class="c">//(path.Contains(@&quot;\plugin&quot;))</span>
                {
                    <a href="#604bf1a3d891c64f" class="i method">NewItemPluginOrPluginChild</a>(<span class="r195 r">sessionobj</span>, <span class="r191 r">path</span>, <span class="r196 r">host</span>, <span class="r197 r">uri</span>);
                }
                <b>else</b> <b>if</b> (<span class="r191 r">path</span>.<span class="i">EndsWith</span>(<span class="r199 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="#6e1f052e90ea0d50" class="t t">WSManProvidersListenerParameters</a> <span id="r200 rd" class="r200 r">niParams</span> = <a href="/System.Management.Automation/A.html#57d60aa2d2bc908d" class="i property">DynamicParameters</a> <b>as</b> <a href="#6e1f052e90ea0d50" class="t t">WSManProvidersListenerParameters</a>;
                    <span class="i">Hashtable</span> <span id="r201 rd" class="r201 r">listenerparams</span> = <b>new</b> <span class="i">Hashtable</span>();
                    <span class="r201 r">listenerparams</span>.<span class="i">Add</span>(<span class="s">&quot;Address&quot;</span>, <span class="r200 r">niParams</span>.<a href="#6e27f2d5a39f4281" class="i property">Address</a>);
                    <span class="r201 r">listenerparams</span>.<span class="i">Add</span>(<span class="s">&quot;Transport&quot;</span>, <span class="r200 r">niParams</span>.<a href="#a3d54138a555cc2e" class="i property">Transport</a>);
                    <span class="r201 r">listenerparams</span>.<span class="i">Add</span>(<span class="s">&quot;Enabled&quot;</span>, <span class="r200 r">niParams</span>.<a href="#686e87d7f518c591" class="i property">Enabled</a>);
                    <b>if</b> (<span class="r200 r">niParams</span>.<a href="#ddb76bbc9bf6650e" class="i property">HostName</a> != <b>null</b>)
                    {
                        <span class="r201 r">listenerparams</span>.<span class="i">Add</span>(<span class="s">&quot;Hostname&quot;</span>, <span class="r200 r">niParams</span>.<a href="#ddb76bbc9bf6650e" class="i property">HostName</a>);
                    }
 
                    <b>if</b> (<span class="r200 r">niParams</span>.<a href="#c28f431d230a0fad" class="i property">URLPrefix</a> != <b>null</b>)
                    {
                        <span class="r201 r">listenerparams</span>.<span class="i">Add</span>(<span class="s">&quot;URLPrefix&quot;</span>, <span class="r200 r">niParams</span>.<a href="#c28f431d230a0fad" class="i property">URLPrefix</a>);
                    }
 
                    <b>if</b> (<span class="r200 r">niParams</span>.<a href="#591de7e5c80b3d56" class="i property">IsPortSpecified</a>)
                    {
                        <span class="r201 r">listenerparams</span>.<span class="i">Add</span>(<span class="s">&quot;Port&quot;</span>, <span class="r200 r">niParams</span>.<a href="#855207f91a032d9a" class="i property">Port</a>);
                    }
 
                    <b>if</b> (<span class="r200 r">niParams</span>.<a href="#8deea4708be30906" class="i property">CertificateThumbPrint</a> != <b>null</b>)
                    {
                        <span class="r201 r">listenerparams</span>.<span class="i">Add</span>(<span class="s">&quot;CertificateThumbPrint&quot;</span>, <span class="r200 r">niParams</span>.<a href="#8deea4708be30906" class="i property">CertificateThumbPrint</a>);
                    }
 
                    <a href="#b14aef966ee35745" class="i method">NewItemContainerListenerOrCertMapping</a>(<span class="r195 r">sessionobj</span>, <span class="r191 r">path</span>, <span class="r197 r">uri</span>, <span class="r196 r">host</span>, <span class="r201 r">listenerparams</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NewItemShouldContinueListenerQuery&quot;</span>), <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NewItemShouldContinueListenerCaption&quot;</span>));
                }
                <b>else</b> <b>if</b> (<span class="r191 r">path</span>.<span class="i">EndsWith</span>(<span class="r199 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="#210215a4137617df" class="t t">WSManProviderClientCertificateParameters</a> <span id="r202 rd" class="r202 r">dynParams</span> = <a href="/System.Management.Automation/A.html#57d60aa2d2bc908d" class="i property">DynamicParameters</a> <b>as</b> <a href="#210215a4137617df" class="t t">WSManProviderClientCertificateParameters</a>;
                    <span class="r198 r">SessionObjCache</span>.<span class="i">TryGetValue</span>(<span class="r196 r">host</span>, <b>out</b> <span class="r195 r">sessionobj</span>);
                    <span class="i">Hashtable</span> <span id="r203 rd" class="r203 r">Certparams</span> = <b>new</b> <span class="i">Hashtable</span>();
                    <span class="r203 r">Certparams</span>.<span class="i">Add</span>(<span class="s">&quot;Issuer&quot;</span>, <span class="r202 r">dynParams</span>.<a href="#f1042b34978b052f" class="i property">Issuer</a>);
                    <span class="r203 r">Certparams</span>.<span class="i">Add</span>(<span class="s">&quot;Subject&quot;</span>, <span class="r202 r">dynParams</span>.<a href="#199592cf5d04e9b2" class="i property">Subject</a>);
                    <span class="r203 r">Certparams</span>.<span class="i">Add</span>(<span class="s">&quot;Uri&quot;</span>, <span class="r202 r">dynParams</span>.<a href="#767cd4a3df7e8acc" class="i property">URI</a>);
                    <b>if</b> (<a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#87b458a28fd51a4c" class="i property">Credential</a>.<a href="/System.Management.Automation/A.html#3fca673651eaeaff" class="i property">UserName</a> != <b>null</b>)
                    {
                        <span class="i n">System</span>.<span class="i">Net</span>.<span class="i">NetworkCredential</span> <span id="r204 rd" class="r204 r">nwCredentials</span> = <a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#87b458a28fd51a4c" class="i property">Credential</a>.<span class="i">GetNetworkCredential</span>();
                        <span class="r203 r">Certparams</span>.<span class="i">Add</span>(<span class="s">&quot;UserName&quot;</span>, <span class="r204 r">nwCredentials</span>.<span class="i">UserName</span>);
                        <span class="r203 r">Certparams</span>.<span class="i">Add</span>(<span class="s">&quot;Password&quot;</span>, <span class="r204 r">nwCredentials</span>.<span class="i">Password</span>);
                    }
 
                    <span class="r203 r">Certparams</span>.<span class="i">Add</span>(<span class="s">&quot;Enabled&quot;</span>, <span class="r202 r">dynParams</span>.<a href="#c89e86d68cc29575" class="i property">Enabled</a>);
                    <a href="#b14aef966ee35745" class="i method">NewItemContainerListenerOrCertMapping</a>(<span class="r195 r">sessionobj</span>, <span class="r191 r">path</span>, <span class="r197 r">uri</span>, <span class="r196 r">host</span>, <span class="r203 r">Certparams</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NewItemShouldContinueClientCertQuery&quot;</span>), <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NewItemShouldContinueClientCertCaption&quot;</span>));
                }
                <b>else</b>
                {
                    <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NewItemNotSupported&quot;</span>), <b>false</b>);
                    <b>return</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dynamic parameter used by New-Item. According to different path. This method return the</span>
        <span class="c">///</span><span class="c"> required dynamic parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r205 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r206 r">itemTypeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r207 r">newItemValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override object</b> <a id="a8dba78187d4b344" href="R/a8dba78187d4b344.html" target="n" data-glyph="75,1" class="i method">NewItemDynamicParameters</a>(<b>string</b> <span id="r205 rd" class="r205 r">path</span>, <b>string</b> <span id="r206 rd" class="r206 r">itemTypeName</span>, <b>object</b> <span id="r207 rd" class="r207 r">newItemValue</span>)
        {
            <b>if</b> (<span class="r205 r">path</span>.<span class="i">Length</span> == 0)
            {
                <b>return</b> <b>new</b> <span class="t">WSManProviderNewItemComputerParameters</span>();
            }
 
            <b>string</b> <span id="r208 rd" class="r208 r">hostname</span> = <a href="#660b53b524868f2c" class="i method">GetHostName</a>(<span class="r205 r">path</span>);
            <b>string</b> <span id="r209 rd" class="r209 r">strpathchk</span> = <span class="r208 r">hostname</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
            <b>if</b> (<span class="r205 r">path</span>.<span class="i">EndsWith</span>(<span class="r209 r">strpathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <b>new</b> <span class="t">WSManProviderNewItemPluginParameters</span>();
            }
 
            <b>if</b> (<span class="r205 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <b>new</b> <span class="t">WSManProviderInitializeParameters</span>();
            }
 
            <b>if</b> (<span class="r205 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <b>new</b> <span class="t">WSManProviderNewItemResourceParameters</span>();
            }
 
            <b>if</b> (<span class="r205 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <b>new</b> <span class="t">WSManProviderNewItemSecurityParameters</span>();
            }
 
            <b>if</b> (<span class="r205 r">path</span>.<span class="i">EndsWith</span>(<span class="r209 r">strpathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <b>new</b> <span class="t">WSManProvidersListenerParameters</span>();
            }
 
            <b>if</b> (<span class="r205 r">path</span>.<span class="i">EndsWith</span>(<span class="r209 r">strpathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <b>new</b> <span class="t">WSManProviderClientCertificateParameters</span>();
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates the connection to new machine in wsman provider.</span>
        <span class="c">///</span><span class="c"> This is called from New-Item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r210 r">Name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="a0763951fcc39d2c" href="R/a0763951fcc39d2c.html" target="n" data-glyph="76,1" class="i method">NewItemCreateComputerConnection</a>(<b>string</b> <span id="r210 rd" class="r210 r">Name</span>)
        {
            <a href="#1ecc2fce85e48c9a" class="i field">helper</a> = <b>new</b> <a href="WsManHelper.cs.html#f47802d3ea48265e" class="t constructor">WSManHelper</a>(<a href="#959910a828c6b791" class="k">this</a>);
            <a href="#70ede7abd56d75a5" class="t t">WSManProviderNewItemComputerParameters</a> <span id="r211 rd" class="r211 r">dynParams</span> = <a href="/System.Management.Automation/A.html#57d60aa2d2bc908d" class="i property">DynamicParameters</a> <b>as</b> <a href="#70ede7abd56d75a5" class="t t">WSManProviderNewItemComputerParameters</a>;
            <b>string</b> <span id="r212 rd" class="r212 r">parametersetName</span> = <span class="s">&quot;ComputerName&quot;</span>;
            <b>if</b> (<span class="r211 r">dynParams</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r211 r">dynParams</span>.<a href="#7855d648dbe43688" class="i property">ConnectionURI</a> != <b>null</b>)
                {
                    <span class="r212 r">parametersetName</span> = <span class="s">&quot;URI&quot;</span>;
                }
 
                <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f58307aa4d32e17e" class="i method">CreateWsManConnection</a>(<span class="r212 r">parametersetName</span>, <span class="r211 r">dynParams</span>.<a href="#7855d648dbe43688" class="i property">ConnectionURI</a>, <span class="r211 r">dynParams</span>.<a href="#434855edfc5cac35" class="i property">Port</a>, <span class="r210 r">Name</span>, <span class="r211 r">dynParams</span>.<a href="#9cb32e5bc9673529" class="i property">ApplicationName</a>, <span class="r211 r">dynParams</span>.<a href="#9c8d58cc988a8d40" class="i property">UseSSL</a>, <span class="r211 r">dynParams</span>.<a href="#f14708b18ac62924" class="i property">Authentication</a>, <span class="r211 r">dynParams</span>.<a href="#720a47f54e266565" class="i property">SessionOption</a>, <a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#87b458a28fd51a4c" class="i property">Credential</a>, <span class="r211 r">dynParams</span>.<a href="#0b0f8ba468e89cdd" class="i property">CertificateThumbprint</a>);
                <b>if</b> (<span class="r211 r">dynParams</span>.<a href="#7855d648dbe43688" class="i property">ConnectionURI</a> != <b>null</b>)
                {
                    <b>string</b>[] <span id="r213 rd" class="r213 r">constrsplit</span> = <span class="r211 r">dynParams</span>.<a href="#7855d648dbe43688" class="i property">ConnectionURI</a>.<span class="i">OriginalString</span>.<span class="i">Split</span>(<span class="s">&quot;:&quot;</span> + <span class="r211 r">dynParams</span>.<a href="#434855edfc5cac35" class="i property">Port</a> + <span class="s">&quot;/&quot;</span> + <span class="r211 r">dynParams</span>.<a href="#9cb32e5bc9673529" class="i property">ApplicationName</a>, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
                    <b>string</b>[] <span id="r214 rd" class="r214 r">constrsplit1</span> = <span class="r213 r">constrsplit</span>[0].<span class="i">Split</span>(<span class="s">&quot;//&quot;</span>, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
                    <span class="r210 r">Name</span> = <span class="r214 r">constrsplit1</span>[1].<span class="i">Trim</span>();
                }
 
                <span class="i">WriteItemObject</span>(<a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(<span class="r210 r">Name</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>, <b>null</b>, <b>null</b>, <span class="s">&quot;ComputerLevel&quot;</span>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>), <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ff28b0893dfbf7d2" class="i field">rootpath</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r210 r">Name</span>, <b>true</b>);
            }
            <b>else</b>
            {
                <span class="r211 r">dynParams</span> = <b>new</b> <span class="t">WSManProviderNewItemComputerParameters</span>();
                <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f58307aa4d32e17e" class="i method">CreateWsManConnection</a>(<span class="r212 r">parametersetName</span>, <span class="r211 r">dynParams</span>.<a href="#7855d648dbe43688" class="i property">ConnectionURI</a>, <span class="r211 r">dynParams</span>.<a href="#434855edfc5cac35" class="i property">Port</a>, <span class="r210 r">Name</span>, <span class="r211 r">dynParams</span>.<a href="#9cb32e5bc9673529" class="i property">ApplicationName</a>, <span class="r211 r">dynParams</span>.<a href="#9c8d58cc988a8d40" class="i property">UseSSL</a>, <span class="r211 r">dynParams</span>.<a href="#f14708b18ac62924" class="i property">Authentication</a>, <span class="r211 r">dynParams</span>.<a href="#720a47f54e266565" class="i property">SessionOption</a>, <a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#87b458a28fd51a4c" class="i property">Credential</a>, <span class="r211 r">dynParams</span>.<a href="#0b0f8ba468e89cdd" class="i property">CertificateThumbprint</a>);
                <span class="i">WriteItemObject</span>(<a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(<span class="r210 r">Name</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>, <b>null</b>, <b>null</b>, <span class="s">&quot;ComputerLevel&quot;</span>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>), <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ff28b0893dfbf7d2" class="i field">rootpath</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r210 r">Name</span>, <b>true</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates the Listener or ClientCertificate in wsman provider.</span>
        <span class="c">///</span><span class="c"> This is called from New-Item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r215 r">sessionobj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r216 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r217 r">uri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r218 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r219 r">InputParams</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r220 r">ContainerListenerOrCertMapping</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r221 r">ShouldContinueQuery</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r222 r">ShouldContinueCaption</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b14aef966ee35745" href="R/b14aef966ee35745.html" target="n" data-glyph="76,1" class="i method">NewItemContainerListenerOrCertMapping</a>(<b>object</b> <span id="r215 rd" class="r215 r">sessionobj</span>, <b>string</b> <span id="r216 rd" class="r216 r">path</span>, <b>string</b> <span id="r217 rd" class="r217 r">uri</span>, <b>string</b> <span id="r218 rd" class="r218 r">host</span>, <span class="i">Hashtable</span> <span id="r219 rd" class="r219 r">InputParams</span>, <b>string</b> <span id="r220 rd" class="r220 r">ContainerListenerOrCertMapping</span>, <b>string</b> <span id="r221 rd" class="r221 r">ShouldContinueQuery</span>, <b>string</b> <span id="r222 rd" class="r222 r">ShouldContinueCaption</span>)
        {
            <b>if</b> (!<a href="/System.Management.Automation/A.html#e3c4d51f13fbfcaa" class="i property">Force</a>)
            {
                <b>if</b> (!<span class="i">ShouldContinue</span>(<span class="r221 r">ShouldContinueQuery</span>, <span class="r222 r">ShouldContinueCaption</span>))
                {
                    <b>return</b>;
                }
            }
 
            <b>string</b> <span id="r223 rd" class="r223 r">inputstr</span> = <a href="#d5a8dbfa388f2263" class="i method">GetInputStringForCreate</a>(<span class="r217 r">uri</span>, <span class="r219 r">InputParams</span>, <span class="r218 r">host</span>);
            <a href="#1bfabb8847f3c07a" class="i method">CreateResourceValue</a>(<span class="r215 r">sessionobj</span>, <span class="r217 r">uri</span>, <span class="r223 r">inputstr</span>, <span class="r219 r">InputParams</span>);
            <span class="i">XmlDocument</span> <span id="r224 rd" class="r224 r">xmlResource</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r215 r">sessionobj</span>, <span class="r217 r">uri</span>, <span class="r219 r">InputParams</span>);
            <span class="i">Hashtable</span> <span id="r225 rd" class="r225 r">CCache</span> = <b>null</b>;
            <span class="i">Hashtable</span> <span id="r226 rd" class="r226 r">kCache</span> = <b>null</b>;
            <b>if</b> (<span class="r220 r">ContainerListenerOrCertMapping</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>))
            {
                <a href="#01a3c58ac8787b59" class="i method">ProcessCertMappingObjects</a>(<span class="r224 r">xmlResource</span>, <b>out</b> <span class="r225 r">CCache</span>, <b>out</b> <span class="r226 r">kCache</span>);
            }
            <b>else</b> <b>if</b> (<span class="r220 r">ContainerListenerOrCertMapping</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>))
            {
                <a href="#52d9ca2566594c0d" class="i method">ProcessListenerObjects</a>(<span class="r224 r">xmlResource</span>, <b>out</b> <span class="r225 r">CCache</span>, <b>out</b> <span class="r226 r">kCache</span>);
            }
 
            <b>if</b> (<span class="r225 r">CCache</span> != <b>null</b> &amp;&amp; <span class="r225 r">CCache</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r227 rd" class="r227 r">resource</span> <b>in</b> <span class="r225 r">CCache</span>)
                {
                    <span class="i">WriteItemObject</span>(<span class="i">GetItemPSObjectWithTypeName</span>(<span class="r227 r">resource</span>.<span class="i">Key</span>.<span class="i">ToString</span>(), <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>, <b>null</b>, (<b>string</b>[])<span class="r226 r">kCache</span>[<span class="r227 r">resource</span>.<span class="i">Key</span>], <b>string</b>.<span class="i">Empty</span>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>), <span class="r216 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r227 r">resource</span>.<span class="i">Key</span>.<span class="i">ToString</span>(), <b>true</b>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method creates the Plugin and its child items in wsman provider.</span>
        <span class="c">///</span><span class="c"> This is called from New-Item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r228 r">sessionobj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r229 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r230 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r231 r">uri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="604bf1a3d891c64f" href="R/604bf1a3d891c64f.html" target="n" data-glyph="76,1" class="i method">NewItemPluginOrPluginChild</a>(<b>object</b> <span id="r228 rd" class="r228 r">sessionobj</span>, <b>string</b> <span id="r229 rd" class="r229 r">path</span>, <b>string</b> <span id="r230 rd" class="r230 r">host</span>, <b>string</b> <span id="r231 rd" class="r231 r">uri</span>)
        {
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r232 rd" class="r232 r">mshObj</span> = <b>new</b> <span class="t">PSObject</span>();
            <b>string</b> <span id="r233 rd" class="r233 r">PluginName</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>string</b> <span id="r234 rd" class="r234 r">inputStr</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>string</b> <span id="r235 rd" class="r235 r">strPathChk</span> = <span class="r230 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>;
            <b>if</b> (!<span class="r229 r">path</span>.<span class="i">Equals</span>(<span class="r235 r">strPathChk</span>))
            {
                <b>int</b> <span id="r236 rd" class="r236 r">separatorindex</span> = <span class="r229 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r235 r">strPathChk</span>.<span class="i">Length</span> + 1);
                <b>if</b> (<span class="r236 r">separatorindex</span> == -1)
                {
                    <span class="r233 r">PluginName</span> = <span class="r229 r">path</span>.<span class="i">Substring</span>(<span class="r229 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1);
                    <span class="r229 r">path</span> = <span class="r229 r">path</span>.<span class="i">Remove</span>(<span class="r229 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
                }
            }
            <span class="c">// to create a new plugin</span>
            <b>if</b> (<span class="r229 r">path</span>.<span class="i">EndsWith</span>(<span class="r235 r">strPathChk</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#aa6c75de9e5499e4" class="t t">WSManProviderNewItemPluginParameters</a> <span id="r237 rd" class="r237 r">niParams</span> = <a href="/System.Management.Automation/A.html#57d60aa2d2bc908d" class="i property">DynamicParameters</a> <b>as</b> <a href="#aa6c75de9e5499e4" class="t t">WSManProviderNewItemPluginParameters</a>;
                <b>if</b> (<span class="r237 r">niParams</span> != <b>null</b>)
                {
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r237 r">niParams</span>.<a href="#fc231c2e9d30d62b" class="i property">File</a>))
                    {
                        <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;Name&quot;</span>, <span class="r237 r">niParams</span>.<a href="#0bd1436aaecc298a" class="i property">Plugin</a>));
                        <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;Filename&quot;</span>, <span class="r237 r">niParams</span>.<a href="#7169fbfe52fc4b6a" class="i property">FileName</a>));
                        <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;Resource&quot;</span>, <span class="r237 r">niParams</span>.<a href="#4a339856e5cf45aa" class="i property">Resource</a>));
                        <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;SDKVersion&quot;</span>, <span class="r237 r">niParams</span>.<a href="#73613a6b450d5492" class="i property">SDKVersion</a>));
                        <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;Capability&quot;</span>, <span class="r237 r">niParams</span>.<a href="#3cc8b03a048d7ad1" class="i property">Capability</a>));
 
                        <b>if</b> (<span class="r237 r">niParams</span>.<a href="#e630c30cbcef5d03" class="i property">RunAsCredential</a> != <b>null</b>)
                        {
                            <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e67a384d08cc8860" class="i field">ConfigRunAsUserName</a>, <span class="r237 r">niParams</span>.<a href="#e630c30cbcef5d03" class="i property">RunAsCredential</a>.<a href="/System.Management.Automation/A.html#3fca673651eaeaff" class="i property">UserName</a>));
                            <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e21ec3eff0232026" class="i field">ConfigRunAsPasswordName</a>, <span class="r237 r">niParams</span>.<a href="#e630c30cbcef5d03" class="i property">RunAsCredential</a>.<a href="/System.Management.Automation/A.html#828d5fa008f1755c" class="i property">Password</a>));
                        }
 
                        <b>if</b> (<span class="r237 r">niParams</span>.<a href="#bca3e415c5843ba8" class="i property">AutoRestart</a>)
                        {
                            <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ca014d659e5a3983" class="i field">ConfigAutoRestart</a>, <span class="r237 r">niParams</span>.<a href="#bca3e415c5843ba8" class="i property">AutoRestart</a>));
                        }
 
                        <b>if</b> (<span class="r237 r">niParams</span>.<a href="#e8300f9a70d77ddf" class="i property">ProcessIdleTimeoutSec</a>.<span class="i">HasValue</span>)
                        {
                            <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#c6c96905857e0bb8" class="i field">ConfigProcessIdleTimeoutSec</a>, <span class="r237 r">niParams</span>.<a href="#e8300f9a70d77ddf" class="i property">ProcessIdleTimeoutSec</a>.<span class="i">Value</span>));
                        }
 
                        <b>if</b> (<span class="r237 r">niParams</span>.<a href="#03ac5177e0fb6672" class="i property">UseSharedProcess</a>)
                        {
                            <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ecafb34fb9e28b33" class="i field">ConfigUseSharedProcess</a>, <span class="r237 r">niParams</span>.<a href="#03ac5177e0fb6672" class="i property">UseSharedProcess</a>));
                        }
 
                        <b>if</b> (<span class="r237 r">niParams</span>.<a href="#8b15a11f82d2fb3f" class="i property">XMLRenderingType</a> != <b>null</b>)
                        {
                            <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;XmlRenderingType&quot;</span>, <span class="r237 r">niParams</span>.<a href="#8b15a11f82d2fb3f" class="i property">XMLRenderingType</a>));
                        }
                        <b>else</b>
                        {
                            <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;XmlRenderingType&quot;</span>, <span class="s">&quot;Text&quot;</span>));
                        }
 
                        <span class="r234 r">inputStr</span> = <a href="#78a1921249a2d50e" class="i method">ConstructPluginXml</a>(<span class="r232 r">mshObj</span>, <span class="r231 r">uri</span>, <span class="r230 r">host</span>, <span class="s">&quot;New&quot;</span>, <b>null</b>, <b>null</b>, <b>null</b>);
                        <span class="r233 r">PluginName</span> = <span class="r237 r">niParams</span>.<a href="#0bd1436aaecc298a" class="i property">Plugin</a>;
                    }
                    <b>else</b>
                    {
                        <span class="r234 r">inputStr</span> = <a href="#5a3e0bdbf553fe6f" class="i method">ReadFile</a>(<span class="r237 r">niParams</span>.<a href="#fc231c2e9d30d62b" class="i property">File</a>);
                    }
                }
                <b>else</b>
                {
                    <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r238 rd" class="r238 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<b>new</b> <span class="i">InvalidOperationException</span>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;NewItemNotSupported&quot;</span>)), <span class="s">&quot;InvalidOperationException&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                    <span class="i">WriteError</span>(<span class="r238 r">er</span>);
                    <b>return</b>;
                }
 
                <b>string</b> <span id="r239 rd" class="r239 r">filter</span> = <span class="r231 r">uri</span> + <span class="s">&quot;?Name=&quot;</span> + <span class="r233 r">PluginName</span>;
                <a href="#1bfabb8847f3c07a" class="i method">CreateResourceValue</a>(<span class="r228 r">sessionobj</span>, <span class="r239 r">filter</span>, <span class="r234 r">inputStr</span>, <b>null</b>);
                <span class="i">WriteItemObject</span>(<span class="i">GetItemPSObjectWithTypeName</span>(<span class="r233 r">PluginName</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>, <b>null</b>, <b>new</b> <b>string</b>[] { <span class="s">&quot;Name=&quot;</span> + <span class="r233 r">PluginName</span> }, <b>string</b>.<span class="i">Empty</span>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>), <span class="r229 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r233 r">PluginName</span>, <b>true</b>);
            }
            <b>else</b>
            {<span class="c">// to create an internal item of as plugin</span>
                <b>string</b> <span id="r240 rd" class="r240 r">pName</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>string</b> <span id="r241 rd" class="r241 r">NewItem</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>string</b>[] <span id="r242 rd" class="r242 r">Keys</span> = <b>null</b>;
 
                <b>int</b> <span id="r243 rd" class="r243 r">pos</span> = <span class="r229 r">path</span>.<span class="i">LastIndexOf</span>(<span class="r235 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) + <span class="r235 r">strPathChk</span>.<span class="i">Length</span> + 1;
                <b>int</b> <span id="r244 rd" class="r244 r">pindex</span> = <span class="r229 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r243 r">pos</span>);
                <b>if</b> (<span class="r244 r">pindex</span> != -1)
                {
                    <span class="r240 r">pName</span> = <span class="r229 r">path</span>.<span class="i">Substring</span>(<span class="r243 r">pos</span>, <span class="r229 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r243 r">pos</span>) - <span class="r243 r">pos</span>);
                }
                <b>else</b>
                {
                    <span class="r240 r">pName</span> = <span class="r229 r">path</span>.<span class="i">Substring</span>(<span class="r243 r">pos</span>);
                }
 
                <b>string</b> <span id="r245 rd" class="r245 r">filter</span> = <span class="r231 r">uri</span> + <span class="s">&quot;?Name=&quot;</span> + <span class="r240 r">pName</span>;
                <span class="i">XmlDocument</span> <span id="r246 rd" class="r246 r">pxml</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r228 r">sessionobj</span>, <span class="r245 r">filter</span>, <b>null</b>);
 
                <span class="i">ArrayList</span> <span id="r247 rd" class="r247 r">SecurityArray</span> = <b>null</b>;
                <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r248 rd" class="r248 r">ps</span> = <a href="#d773ffd607e22121" class="i method">ProcessPluginConfigurationLevel</a>(<span class="r246 r">pxml</span>);
                <span class="i">ArrayList</span> <span id="r249 rd" class="r249 r">ResourceArray</span> = <a href="#9fc4301cb03b79b7" class="i method">ProcessPluginResourceLevel</a>(<span class="r246 r">pxml</span>, <b>out</b> <span class="r247 r">SecurityArray</span>);
                <span class="i">ArrayList</span> <span id="r250 rd" class="r250 r">InitParamArray</span> = <a href="#0f58ba5254c3d7ba" class="i method">ProcessPluginInitParamLevel</a>(<span class="r246 r">pxml</span>);
 
                <span class="r235 r">strPathChk</span> = <span class="r235 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r240 r">pName</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                <b>if</b> (<span class="r229 r">path</span>.<span class="i">Contains</span>(<span class="r235 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>))
                {
                    <span class="r235 r">strPathChk</span> += <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>;
                    <b>if</b> (<span class="r229 r">path</span>.<span class="i">EndsWith</span>(<span class="r235 r">strPathChk</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <a href="#b467d3e1e1ddfbf2" class="t t">WSManProviderNewItemResourceParameters</a> <span id="r251 rd" class="r251 r">niParams</span> = <a href="/System.Management.Automation/A.html#57d60aa2d2bc908d" class="i property">DynamicParameters</a> <b>as</b> <a href="#b467d3e1e1ddfbf2" class="t t">WSManProviderNewItemResourceParameters</a>;
                        <b>if</b> (<span class="r251 r">niParams</span> != <b>null</b>)
                        {
                            <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;Resource&quot;</span>, <span class="r251 r">niParams</span>.<a href="#a453deb935a43c3b" class="i property">ResourceUri</a>));
                            <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;Capability&quot;</span>, <span class="r251 r">niParams</span>.<a href="#1d89cd2c08910558" class="i property">Capability</a>));
 
                            <span class="r234 r">inputStr</span> = <a href="#32173ad9b3cc811a" class="i method">ConstructResourceXml</a>(<span class="r232 r">mshObj</span>, <b>null</b>, <b>null</b>);
                            <span class="i">XmlDocument</span> <span id="r252 rd" class="r252 r">xdoc</span> = <b>new</b> <span class="i">XmlDocument</span>();
                            <span class="r252 r">xdoc</span>.<span class="i">LoadXml</span>(<span class="r234 r">inputStr</span>);
 
                            <span class="i">ArrayList</span> <span id="r253 rd" class="r253 r">arrList</span> = <b>null</b>;
                            <span class="i">ArrayList</span> <span id="r254 rd" class="r254 r">NewResource</span> = <a href="#9fc4301cb03b79b7" class="i method">ProcessPluginResourceLevel</a>(<span class="r252 r">xdoc</span>, <b>out</b> <span class="r253 r">arrList</span>);
 
                            <span class="r241 r">NewItem</span> = ((<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r254 r">NewResource</span>[0]).<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                            <span class="r242 r">Keys</span> = <b>new</b> <b>string</b>[] { <span class="s">&quot;Uri=&quot;</span> + ((<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r254 r">NewResource</span>[0]).<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceURI&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>() };
 
                            <b>if</b> (<span class="r249 r">ResourceArray</span> != <b>null</b>)
                            {
                                <span class="r249 r">ResourceArray</span>.<span class="i">Add</span>(<span class="r254 r">NewResource</span>[0]);
                            }
                            <b>else</b>
                            {
                                <span class="r249 r">ResourceArray</span> = <span class="r254 r">NewResource</span>;
                            }
                        }
                    }
 
                    <b>int</b> <span id="r255 rd" class="r255 r">Sepindex</span> = <span class="r229 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r235 r">strPathChk</span>.<span class="i">Length</span>);
                    <b>string</b> <span id="r256 rd" class="r256 r">sResourceDirName</span> = <b>string</b>.<span class="i">Empty</span>;
                    <b>if</b> (<span class="r255 r">Sepindex</span> != -1)
                    {
                        <span class="r256 r">sResourceDirName</span> = <span class="r229 r">path</span>.<span class="i">Substring</span>(<span class="r235 r">strPathChk</span>.<span class="i">Length</span> + 1, <span class="r229 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r235 r">strPathChk</span>.<span class="i">Length</span> + 1) - (<span class="r235 r">strPathChk</span>.<span class="i">Length</span> + 1));
                    }
 
                    <span class="r235 r">strPathChk</span> = <span class="r235 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r256 r">sResourceDirName</span>;
 
                    <b>if</b> (<span class="r229 r">path</span>.<span class="i">EndsWith</span>(<span class="r235 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>if</b> (!<a href="/System.Management.Automation/A.html#e3c4d51f13fbfcaa" class="i property">Force</a>)
                        {
                            <b>string</b> <span id="r257 rd" class="r257 r">query</span> = <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;ShouldContinueSecurityQuery&quot;</span>);
                            <span class="r257 r">query</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="r257 r">query</span>, <span class="r240 r">pName</span>);
                            <b>if</b> (!<span class="i">ShouldContinue</span>(<span class="r257 r">query</span>, <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;ShouldContinueSecurityCaption&quot;</span>)))
                            {
                                <b>return</b>;
                            }
                        }
                        <span class="c">// Construct the Uri from Resource_XXXX resource dir.</span>
                        <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r258 rd" class="r258 r">resourceDirProperties</span> = <a href="#8876aa0487fb9487" class="i method">GetItemValue</a>(<span class="r235 r">strPathChk</span>);
                        <b>if</b> ((<span class="r258 r">resourceDirProperties</span> == <b>null</b>) || (<span class="r258 r">resourceDirProperties</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceUri&quot;</span>] == <b>null</b>))
                        {
                            <b>string</b> <span id="r259 rd" class="r259 r">message</span> = <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#b1de34a08cdcd008" class="i method">FormatResourceMsgFromResourcetext</a>(<span class="s">&quot;ResourceURIMissingInResourceDir&quot;</span>,
                                <span class="s">&quot;ResourceUri&quot;</span>, <span class="r235 r">strPathChk</span>);
                            <a href="#014253583d795bc0" class="i method">AssertError</a>(<span class="r259 r">message</span>, <b>false</b>);
                            <b>return</b>; <span class="c">// AssertError is going to throw - return silences some static analysis tools</span>
                        }
 
                        <a href="#c5eac800920ee82b" class="t t">WSManProviderNewItemSecurityParameters</a> <span id="r260 rd" class="r260 r">niParams</span> = <a href="/System.Management.Automation/A.html#57d60aa2d2bc908d" class="i property">DynamicParameters</a> <b>as</b> <a href="#c5eac800920ee82b" class="t t">WSManProviderNewItemSecurityParameters</a>;
                        <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;Uri&quot;</span>, <span class="r258 r">resourceDirProperties</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceUri&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>));
                        <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;Sddl&quot;</span>, <span class="r260 r">niParams</span>.<a href="#5497f75853286041" class="i property">Sddl</a>));
 
                        <span class="r234 r">inputStr</span> = <span class="i">ConstructSecurityXml</span>(<span class="r232 r">mshObj</span>, <b>null</b>, <b>string</b>.<span class="i">Empty</span>);
                        <span class="i">XmlDocument</span> <span id="r261 rd" class="r261 r">xdoc</span> = <b>new</b> <span class="i">XmlDocument</span>();
                        <span class="r261 r">xdoc</span>.<span class="i">LoadXml</span>(<span class="r234 r">inputStr</span>);
 
                        <span class="i">ArrayList</span> <span id="r262 rd" class="r262 r">newSecurity</span> = <b>new</b> <span class="i">ArrayList</span>();
                        <span class="r262 r">newSecurity</span> = <span class="i">ProcessPluginSecurityLevel</span>(<span class="r262 r">newSecurity</span>, <span class="r261 r">xdoc</span>, <span class="r256 r">sResourceDirName</span>, <span class="r258 r">resourceDirProperties</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceUri&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>());
 
                        <span class="r241 r">NewItem</span> = ((<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r262 r">newSecurity</span>[0]).<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;SecurityDIR&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                        <span class="r242 r">Keys</span> = <b>new</b> <b>string</b>[] { <span class="s">&quot;Uri=&quot;</span> + ((<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r262 r">newSecurity</span>[0]).<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;Uri&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>() };
 
                        <b>if</b> (<span class="r247 r">SecurityArray</span> != <b>null</b>)
                        {
                            <span class="r247 r">SecurityArray</span>.<span class="i">Add</span>(<span class="r262 r">newSecurity</span>[0]);
                        }
                        <b>else</b>
                        {
                            <span class="r247 r">SecurityArray</span> = <span class="r262 r">newSecurity</span>;
                        }
                    }
                }
 
                <b>if</b> (<span class="r229 r">path</span>.<span class="i">EndsWith</span>(<span class="r235 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="#eb443521d8dca58e" class="t t">WSManProviderInitializeParameters</a> <span id="r263 rd" class="r263 r">niParams</span> = <a href="/System.Management.Automation/A.html#57d60aa2d2bc908d" class="i property">DynamicParameters</a> <b>as</b> <a href="#eb443521d8dca58e" class="t t">WSManProviderInitializeParameters</a>;
                    <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r263 r">niParams</span>.<a href="#125e0b85de6c1982" class="i property">ParamName</a>, <span class="r263 r">niParams</span>.<a href="#fa61a70017b7fcb0" class="i property">ParamValue</a>));
                    <span class="r234 r">inputStr</span> = <a href="#d7c9c13ade22624f" class="i method">ConstructInitParamsXml</a>(<span class="r232 r">mshObj</span>, <b>null</b>);
                    <span class="i">XmlDocument</span> <span id="r264 rd" class="r264 r">xdoc</span> = <b>new</b> <span class="i">XmlDocument</span>();
                    <span class="r264 r">xdoc</span>.<span class="i">LoadXml</span>(<span class="r234 r">inputStr</span>);
                    <span class="i">ArrayList</span> <span id="r265 rd" class="r265 r">newInitParam</span> = <a href="#0f58ba5254c3d7ba" class="i method">ProcessPluginInitParamLevel</a>(<span class="r264 r">xdoc</span>);
                    <span class="r241 r">NewItem</span> = <span class="r263 r">niParams</span>.<a href="#125e0b85de6c1982" class="i property">ParamName</a>;
                    <b>if</b> (<span class="r250 r">InitParamArray</span> != <b>null</b>)
                    {
                        <span class="r250 r">InitParamArray</span>.<span class="i">Add</span>(<span class="r265 r">newInitParam</span>[0]);
                    }
                    <b>else</b>
                    {
                        <span class="r250 r">InitParamArray</span> = <a href="#0f58ba5254c3d7ba" class="i method">ProcessPluginInitParamLevel</a>(<span class="r264 r">xdoc</span>);
                    }
                }
 
                <span class="r234 r">inputStr</span> = <a href="#78a1921249a2d50e" class="i method">ConstructPluginXml</a>(<span class="r248 r">ps</span>, <span class="r231 r">uri</span>, <span class="r230 r">host</span>, <span class="s">&quot;Set&quot;</span>, <span class="r249 r">ResourceArray</span>, <span class="r247 r">SecurityArray</span>, <span class="r250 r">InitParamArray</span>);
                <b>try</b>
                {
                    ((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r228 r">sessionobj</span>).<span class="i">Put</span>(<span class="r231 r">uri</span> + <span class="s">&quot;?&quot;</span> + <span class="s">&quot;Name=&quot;</span> + <span class="r240 r">pName</span>, <span class="r234 r">inputStr</span>, 0);
                    <b>if</b> (<span class="r229 r">path</span>.<span class="i">EndsWith</span>(<span class="r235 r">strPathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="i">WriteItemObject</span>(<a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(<span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r241 r">NewItem</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r241 r">NewItem</span>].<a href="/System.Management.Automation/A.html#af662506826a4d3d" class="i property">TypeNameOfValue</a>, <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r241 r">NewItem</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>, <b>null</b>, <span class="s">&quot;InitParams&quot;</span>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>), <span class="r229 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r232 r">mshObj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r241 r">NewItem</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <b>false</b>);
                    }
                    <b>else</b>
                    {
                        <span class="i">WriteItemObject</span>(<span class="i">GetItemPSObjectWithTypeName</span>(<span class="r241 r">NewItem</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>, <b>null</b>, <span class="r242 r">Keys</span>, <b>string</b>.<span class="i">Empty</span>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>), <span class="r229 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r241 r">NewItem</span>, <b>true</b>);
                    }
                }
                <b>finally</b>
                {
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r228 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>))
                    {
                        <a href="#014253583d795bc0" class="i method">AssertError</a>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r228 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>, <b>true</b>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the object to be written to the console.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r266 r">Name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r267 r">TypeNameOfElement</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r268 r">Value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r269 r">keys</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r270 r">ExtendedTypeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r271 r">WSManElementObjectType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r272 r">input</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="77348a332c6e9102" href="R/77348a332c6e9102.html" target="n" data-glyph="76,1" class="i method">GetItemPSObjectWithTypeName</a>(<b>string</b> <span id="r266 rd" class="r266 r">Name</span>, <b>string</b> <span id="r267 rd" class="r267 r">TypeNameOfElement</span>, <b>object</b> <span id="r268 rd" class="r268 r">Value</span>, <b>string</b>[] <span id="r269 rd" class="r269 r">keys</span>, <b>string</b> <span id="r270 rd" class="r270 r">ExtendedTypeName</span>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a> <span id="r271 rd" class="r271 r">WSManElementObjectType</span>, <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r272 rd" class="r272 r">input</span> = <b>null</b>)
        {
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r273 rd" class="r273 r">mshObject</span> = <b>null</b>;
            <b>if</b> (<span class="r271 r">WSManElementObjectType</span>.<span class="i">Equals</span>(<a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#ed8179c5c4307879" class="i field">WSManConfigElement</a>))
            {
                <a href="#b8b919c7abee9915" class="t t">WSManConfigElement</a> <span id="r274 rd" class="r274 r">element</span> = <b>new</b> <a href="#009bb91b18854b46" class="t constructor">WSManConfigElement</a>(<span class="r266 r">Name</span>, <span class="r267 r">TypeNameOfElement</span>);
                <span class="r273 r">mshObject</span> = <b>new</b> <span class="t">PSObject</span>(<span class="r274 r">element</span>);
            }
 
            <b>if</b> (<span class="r271 r">WSManElementObjectType</span>.<span class="i">Equals</span>(<a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>))
            {
                <a href="#3de090d28cee208b" class="t t">WSManConfigContainerElement</a> <span id="r275 rd" class="r275 r">element</span> = <b>new</b> <a href="#fc252bdf0f4b1667" class="t constructor">WSManConfigContainerElement</a>(<span class="r266 r">Name</span>, <span class="r267 r">TypeNameOfElement</span>, <span class="r269 r">keys</span>);
                <span class="r273 r">mshObject</span> = <b>new</b> <span class="t">PSObject</span>(<span class="r275 r">element</span>);
            }
 
            <b>if</b> (<span class="r271 r">WSManElementObjectType</span>.<span class="i">Equals</span>(<a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>))
            {
                <b>object</b> <span id="r276 rd" class="r276 r">source</span> = <b>null</b>;
 
                <b>if</b> (<span class="r272 r">input</span> != <b>null</b>)
                {
                    <b>string</b> <span id="r277 rd" class="r277 r">sourceProp</span> = <span class="r266 r">Name</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6fdea0ea28374520" class="i field">HiddenSuffixForSourceOfValue</a>;
                    <b>if</b> (<span class="r272 r">input</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r277 r">sourceProp</span>] != <b>null</b>)
                    {
                        <span class="r276 r">source</span> = <span class="r272 r">input</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r277 r">sourceProp</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>;
                    }
                }
 
                <a href="#bb810df317c60bc3" class="t t">WSManConfigLeafElement</a> <span id="r278 rd" class="r278 r">element</span> = <b>new</b> <a href="#b211f621a826f759" class="t constructor">WSManConfigLeafElement</a>(<span class="r266 r">Name</span>, <span class="r268 r">Value</span>, <span class="r267 r">TypeNameOfElement</span>, <span class="r276 r">source</span>);
                <span class="r273 r">mshObject</span> = <b>new</b> <span class="t">PSObject</span>(<span class="r278 r">element</span>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r270 r">ExtendedTypeName</span>))
            {
                <span class="i">StringBuilder</span> <span id="r279 rd" class="r279 r">types</span> = <b>new</b> <span class="i">StringBuilder</span>(<b>string</b>.<span class="i">Empty</span>);
                <b>if</b> (<span class="r273 r">mshObject</span> != <b>null</b>)
                {
                    <span class="r279 r">types</span>.<span class="i">Append</span>(<span class="r273 r">mshObject</span>.<a href="/System.Management.Automation/A.html#d4170653add67c11" class="i property">ImmediateBaseObject</a>.<span class="i">GetType</span>().<span class="i">FullName</span>);
                    <span class="r279 r">types</span>.<span class="i">Append</span>(<span class="s">&#39;#&#39;</span>);
                    <span class="r279 r">types</span>.<span class="i">Append</span>(<span class="r270 r">ExtendedTypeName</span>);
                    <span class="r273 r">mshObject</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Insert</span>(0, <span class="r279 r">types</span>.<span class="i">ToString</span>());
                }
            }
 
            <b>return</b> <span class="r273 r">mshObject</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Called from setitem. This set the value in Listener and Client Certificate container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r280 r">sessionObj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r281 r">ResourceURI</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r282 r">PrimaryKeys</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r283 r">childName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r284 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r285 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r286 r">parent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r287 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="cd7ef30db324111a" href="R/cd7ef30db324111a.html" target="n" data-glyph="76,1" class="i method">SetItemListenerOrClientCertificate</a>(<b>object</b> <span id="r280 rd" class="r280 r">sessionObj</span>, <b>string</b> <span id="r281 rd" class="r281 r">ResourceURI</span>, <b>string</b>[] <span id="r282 rd" class="r282 r">PrimaryKeys</span>, <b>string</b> <span id="r283 rd" class="r283 r">childName</span>, <b>object</b> <span id="r284 rd" class="r284 r">value</span>, <b>string</b> <span id="r285 rd" class="r285 r">path</span>, <b>string</b> <span id="r286 rd" class="r286 r">parent</span>, <b>string</b> <span id="r287 rd" class="r287 r">host</span>)
        {
            <span class="i">Hashtable</span> <span id="r288 rd" class="r288 r">objcache</span> = <b>null</b>;
            <span class="i">Hashtable</span> <span id="r289 rd" class="r289 r">Keyscache</span> = <b>null</b>;
            <span class="i">XmlDocument</span> <span id="r290 rd" class="r290 r">xmlResource</span> = <a href="#be8ef6f2909993fb" class="i method">EnumerateResourceValue</a>(<span class="r280 r">sessionObj</span>, <span class="r281 r">ResourceURI</span>);
 
            <b>if</b> (<span class="r290 r">xmlResource</span> == <b>null</b>)
            {
                <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;InvalidPath&quot;</span>), <b>false</b>);
            }
 
            <b>if</b> (<span class="r281 r">ResourceURI</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#52d9ca2566594c0d" class="i method">ProcessListenerObjects</a>(<span class="r290 r">xmlResource</span>, <b>out</b> <span class="r288 r">objcache</span>, <b>out</b> <span class="r289 r">Keyscache</span>);
            }
            <b>else</b> <b>if</b> (<span class="r281 r">ResourceURI</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#22940af130242689" class="i field">containerCertMapping</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#01a3c58ac8787b59" class="i method">ProcessCertMappingObjects</a>(<span class="r290 r">xmlResource</span>, <b>out</b> <span class="r288 r">objcache</span>, <b>out</b> <span class="r289 r">Keyscache</span>);
            }
 
            <b>if</b> (<span class="r285 r">path</span>.<span class="i">EndsWith</span>(<span class="r287 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r286 r">parent</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemNotSupported&quot;</span>), <b>false</b>);
            }
            <b>else</b>
            {
                <b>if</b> (!<a href="/System.Management.Automation/A.html#e3c4d51f13fbfcaa" class="i property">Force</a>)
                {
                    <b>if</b> (!<span class="i">ShouldContinue</span>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemShouldContinueQuery&quot;</span>), <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;SetItemShouldContinueCaption&quot;</span>)))
                    {
                        <b>return</b>;
                    }
                }
 
                <b>string</b> <span id="r291 rd" class="r291 r">item</span> = <span class="r285 r">path</span>.<span class="i">Substring</span>(<span class="r285 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1);
                <b>try</b>
                {
                    <span class="i">Hashtable</span> <span id="r292 rd" class="r292 r">cmdlinevalue</span> = <b>new</b> <span class="i">Hashtable</span>();
                    <span class="r292 r">cmdlinevalue</span>.<span class="i">Add</span>(<span class="r283 r">childName</span>, <span class="r284 r">value</span>);
                    <b>foreach</b> (<b>string</b> <span id="r293 rd" class="r293 r">key</span> <b>in</b> <span class="r282 r">PrimaryKeys</span>)
                    {
                        <span class="r292 r">cmdlinevalue</span>.<span class="i">Add</span>(<span class="r293 r">key</span>, ((<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r288 r">objcache</span>[<span class="r291 r">item</span>]).<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r293 r">key</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>);
                    }
 
                    <a href="#5d85e884733a3500" class="i method">PutResourceValue</a>(<span class="r280 r">sessionObj</span>, <span class="r281 r">ResourceURI</span>, <span class="r292 r">cmdlinevalue</span>, <span class="r287 r">host</span>);
                }
                <b>catch</b> (<span class="i">COMException</span> <span id="r294 rd" class="r294 r">e</span>)
                {
                    <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r295 rd" class="r295 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r294 r">e</span>, <span class="s">&quot;COMException&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                    <span class="i">WriteError</span>(<span class="r295 r">er</span>);
                    <b>return</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the input string for create.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r296 r">ResourceURI</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r297 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r298 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="d5a8dbfa388f2263" href="R/d5a8dbfa388f2263.html" target="n" data-glyph="76,1" class="i method">GetInputStringForCreate</a>(<b>string</b> <span id="r296 rd" class="r296 r">ResourceURI</span>, <span class="i">Hashtable</span> <span id="r297 rd" class="r297 r">value</span>, <b>string</b> <span id="r298 rd" class="r298 r">host</span>)
        {
            <b>string</b> <span id="r299 rd" class="r299 r">putstr</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>string</b> <span id="r300 rd" class="r300 r">nilns</span> = <b>string</b>.<span class="i">Empty</span>;
            <span class="i">StringBuilder</span> <span id="r301 rd" class="r301 r">sbvalues</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>if</b> (<span class="r297 r">value</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>foreach</b> (<b>string</b> <span id="r302 rd" class="r302 r">key</span> <b>in</b> <span class="r297 r">value</span>.<span class="i">Keys</span>)
                {
                    <b>if</b> (!<a href="#285d6cd9919232f9" class="i method">IsPKey</a>(<span class="r302 r">key</span>, <span class="r296 r">ResourceURI</span>))
                    {
                        <span class="r301 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;p:&quot;</span>);
                        <span class="r301 r">sbvalues</span>.<span class="i">Append</span>(<span class="r302 r">key</span>);
                        <b>if</b> (<span class="r297 r">value</span>[<span class="r302 r">key</span>] == <b>null</b>)
                        {
                            <span class="r301 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>);
                            <span class="r301 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5e4a0d70ac22b8ef" class="i field">ATTR_NIL</a>);
                            <span class="r300 r">nilns</span> = <span class="s">&quot; &quot;</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#76a180dda0d27567" class="i field">NS_XSI</a>;
                        }
 
                        <span class="r301 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&#39;&gt;&#39;</span>);
                        <span class="r301 r">sbvalues</span>.<span class="i">Append</span>(<span class="i">EscapeValuesForXML</span>(((<span class="i">Hashtable</span>)<span class="r297 r">value</span>)[<span class="r302 r">key</span>].<span class="i">ToString</span>()));
                        <span class="r301 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/p:&quot;</span>);
                        <span class="r301 r">sbvalues</span>.<span class="i">Append</span>(<span class="r302 r">key</span>);
                        <span class="r301 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&#39;&gt;&#39;</span>);
                    }
                }
            }
 
            <b>string</b> <span id="r303 rd" class="r303 r">root</span> = <a href="#5ebbabed750ffd51" class="i method">GetRootNodeName</a>(<span class="r296 r">ResourceURI</span>);
            <span class="r299 r">putstr</span> = <span class="s">&quot;&lt;p:&quot;</span> + <span class="r303 r">root</span> + <span class="s">&quot; &quot;</span> + <span class="s">&quot;xmlns:p=\&quot;&quot;</span> + <a href="#6a24048f72c72f67" class="i method">SetSchemaPath</a>(<span class="r296 r">ResourceURI</span>) + <span class="s">&quot;.xsd\&quot;&quot;</span> + <span class="r300 r">nilns</span> + <span class="s">&quot;&gt;&quot;</span> + <span class="r301 r">sbvalues</span>.<span class="i">ToString</span>() + <span class="s">&quot;&lt;/p:&quot;</span> + <span class="r303 r">root</span> + <span class="s">&quot;&gt;&quot;</span>;
            <b>return</b> <span class="r299 r">putstr</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads the file. used by New-Item for Plugin creation from file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r304 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="5a3e0bdbf553fe6f" href="R/5a3e0bdbf553fe6f.html" target="n" data-glyph="76,1" class="i method">ReadFile</a>(<b>string</b> <span id="r304 rd" class="r304 r">path</span>)
        {
            <b>string</b> <span id="r305 rd" class="r305 r">putstr</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>try</b>
            {
                <b>string</b> <span id="r306 rd" class="r306 r">filePath</span> = <a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#209214b021cef1cf" class="i property">SessionState</a>.<a href="/System.Management.Automation/A.html#3390cfbbdcffb036" class="i property">Path</a>.<span class="i">GetUnresolvedProviderPathFromPSPath</span>(<span class="r304 r">path</span>);
                <span class="r305 r">putstr</span> = <span class="i">File</span>.<span class="i">ReadAllText</span>(<span class="r306 r">filePath</span>, <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">Encoding</span>.<span class="i">UTF8</span>);
            }
            <span class="c">// known exceptions</span>
            <b>catch</b> (<span class="i">ArgumentNullException</span> <span id="r307 rd" class="r307 r">e</span>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r308 rd" class="r308 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r307 r">e</span>, <span class="s">&quot;ArgumentNullException&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                <span class="i">WriteError</span>(<span class="r308 r">er</span>);
            }
            <b>catch</b> (<span class="i">UnauthorizedAccessException</span> <span id="r309 rd" class="r309 r">e</span>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r310 rd" class="r310 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r309 r">e</span>, <span class="s">&quot;UnauthorizedAccessException&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                <span class="i">WriteError</span>(<span class="r310 r">er</span>);
            }
            <b>catch</b> (<span class="i">NotSupportedException</span> <span id="r311 rd" class="r311 r">e</span>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r312 rd" class="r312 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r311 r">e</span>, <span class="s">&quot;NotSupportedException&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                <span class="i">WriteError</span>(<span class="r312 r">er</span>);
            }
            <b>catch</b> (<span class="i">FileNotFoundException</span> <span id="r313 rd" class="r313 r">e</span>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r314 rd" class="r314 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r313 r">e</span>, <span class="s">&quot;FileNotFoundException&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                <span class="i">WriteError</span>(<span class="r314 r">er</span>);
            }
            <b>catch</b> (<span class="i">DirectoryNotFoundException</span> <span id="r315 rd" class="r315 r">e</span>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r316 rd" class="r316 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r315 r">e</span>, <span class="s">&quot;DirectoryNotFoundException&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                <span class="i">WriteError</span>(<span class="r316 r">er</span>);
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">Security</span>.<span class="i">SecurityException</span> <span id="r317 rd" class="r317 r">e</span>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r318 rd" class="r318 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r317 r">e</span>, <span class="s">&quot;SecurityException&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                <span class="i">WriteError</span>(<span class="r318 r">er</span>);
            }
 
            <b>return</b> <span class="r305 r">putstr</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the host name or the machine to which connected.</span>
        <span class="c">///</span><span class="c"> This is used by most of the methods like GetItem,GetChildItem, NewItem, SetItem,RemoveItem etc...</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r319 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="660b53b524868f2c" href="R/660b53b524868f2c.html" target="n" data-glyph="76,1" class="i method">GetHostName</a>(<b>string</b> <span id="r319 rd" class="r319 r">path</span>)
        {
            <b>string</b> <span id="r320 rd" class="r320 r">sHostname</span> = <span class="r319 r">path</span>;
            <b>try</b>
            {
                <span class="c">// HostName is always followed by root name</span>
                <b>if</b> (<span class="r319 r">path</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>()))
                {
                    <span class="r320 r">sHostname</span> = <span class="r319 r">path</span>.<span class="i">Substring</span>(0, <span class="r319 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
                }
 
                <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r321 rd" class="r321 r">SessionObjCache</span> = <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2b29be8459e983a7" class="i method">GetSessionObjCache</a>();
                <b>if</b> (!<span class="r321 r">SessionObjCache</span>.<span class="i">ContainsKey</span>(<span class="r320 r">sHostname</span>))
                    <span class="r320 r">sHostname</span> = <b>null</b>;
            }
            <b>catch</b> (<span class="i">ArgumentNullException</span> <span id="r322 rd" class="r322 r">e</span>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r323 rd" class="r323 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r322 r">e</span>, <span class="s">&quot;ArgumentNullException&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <b>null</b>);
                <span class="i">WriteError</span>(<span class="r323 r">er</span>);
            }
 
            <b>return</b> <span class="r320 r">sHostname</span>;
        }
 
        <b>private static string</b> <a id="5ebbabed750ffd51" href="R/5ebbabed750ffd51.html" target="n" data-glyph="76,1" class="i method">GetRootNodeName</a>(<b>string</b> <span id="r324 rd" class="r324 r">ResourceURI</span>)
        {
            <b>string</b> <span id="r325 rd" class="r325 r">tempuri</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<span class="r324 r">ResourceURI</span>.<span class="i">Contains</span>(<span class="s">&#39;?&#39;</span>))
            {
                <span class="r324 r">ResourceURI</span> = <span class="r324 r">ResourceURI</span>.<span class="i">Split</span>(<span class="s">&#39;?&#39;</span>).<span class="i">GetValue</span>(0).<span class="i">ToString</span>();
            }
 
            <b>const string</b> <span id="r326 rd" class="r326 r">PTRN_URI_LAST</span> = <span class="s">&quot;([a-z_][-a-z0-9._]*)$&quot;</span>;
            <span class="i">Regex</span> <span id="r327 rd" class="r327 r">objregex</span> = <b>new</b> <span class="i">Regex</span>(<span class="r326 r">PTRN_URI_LAST</span>, <span class="i">RegexOptions</span>.<span class="i">IgnoreCase</span>);
            <span class="i">MatchCollection</span> <span id="r328 rd" class="r328 r">regexmatch</span> = <span class="r327 r">objregex</span>.<span class="i">Matches</span>(<span class="r324 r">ResourceURI</span>);
            <b>if</b> (<span class="r328 r">regexmatch</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r325 r">tempuri</span> = <span class="r328 r">regexmatch</span>[0].<span class="i">Value</span>;
            }
 
            <b>return</b> <span class="r325 r">tempuri</span>;
        }
 
        <b>private static string</b> <a id="dde34fad70f5b96b" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">EscapeValuesForXML</a>(<b>string</b> <span id="r329 rd" class="r329 r">value</span>)
        {
            <span class="i">StringBuilder</span> <span id="r330 rd" class="r330 r">esc_str</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>for</b> (<b>int</b> <span id="r331 rd" class="r331 r">i</span> = 0; <span class="r331 r">i</span> &lt;= <span class="r329 r">value</span>.<span class="i">Length</span> - 1; <span class="r331 r">i</span>++)
            {
                <b>switch</b> (<span class="r329 r">value</span>[<span class="r331 r">i</span>])
                {
                    <b>case</b> <span class="s">&#39;&amp;&#39;</span>:
                        {
                            <span class="r330 r">esc_str</span>.<span class="i">Append</span>(<span class="s">&quot;&amp;amp;&quot;</span>);
                            <b>break</b>;
                        }
                    <b>case</b> <span class="s">&#39;&lt;&#39;</span>:
                        {
                            <span class="r330 r">esc_str</span>.<span class="i">Append</span>(<span class="s">&quot;&amp;lt;&quot;</span>);
                            <b>break</b>;
                        }
                    <b>case</b> <span class="s">&#39;&gt;&#39;</span>:
                        {
                            <span class="r330 r">esc_str</span>.<span class="i">Append</span>(<span class="s">&quot;&amp;gt;&quot;</span>);
                            <b>break</b>;
                        }
                    <b>case</b> <span class="s">&#39;\&quot;&#39;</span>:
                        {
                            <span class="r330 r">esc_str</span>.<span class="i">Append</span>(<span class="s">&quot;&amp;quot;&quot;</span>);
                            <b>break</b>;
                        }
                    <b>case</b> <span class="s">&#39;\&#39;&#39;</span>:
                        {
                            <span class="r330 r">esc_str</span>.<span class="i">Append</span>(<span class="s">&quot;&amp;apos;&quot;</span>);
                            <b>break</b>;
                        }
                    <b>default</b>:
                        {
                            <span class="r330 r">esc_str</span>.<span class="i">Append</span>(<span class="r329 r">value</span>[<span class="r331 r">i</span>]);
                            <b>break</b>;
                        }
                }
            }
 
            <b>return</b> <span class="r330 r">esc_str</span>.<span class="i">ToString</span>();
        }
 
        <b>private static bool</b> <a id="f20176e1b52f02e0" href="R/f20176e1b52f02e0.html" target="n" data-glyph="76,1" class="i method">IsItemContainer</a>(<span class="i">XmlNodeList</span> <span id="r332 rd" class="r332 r">nodes</span>)
        {
            <b>bool</b> <span id="r333 rd" class="r333 r">result</span> = <b>false</b>;
            <b>if</b> (<span class="r332 r">nodes</span>.<span class="i">Count</span> != 0)
            {
                <b>if</b> (<span class="r332 r">nodes</span>[0].<span class="i">ChildNodes</span>.<span class="i">Count</span> != 0)
                {
                    <b>if</b> (!<span class="r332 r">nodes</span>[0].<span class="i">FirstChild</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;#text&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r333 r">result</span> = <b>true</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r333 r">result</span>;
        }
 
        <b>private</b> <span class="i">XmlNodeList</span> <a id="22e74b26a07bdcc0" href="R/22e74b26a07bdcc0.html" target="n" data-glyph="76,1" class="i method">SearchXml</a>(<span class="i">XmlDocument</span> <span id="r334 rd" class="r334 r">resourcexmldocument</span>, <b>string</b> <span id="r335 rd" class="r335 r">searchitem</span>, <b>string</b> <span id="r336 rd" class="r336 r">ResourceURI</span>, <b>string</b> <span id="r337 rd" class="r337 r">path</span>, <b>string</b> <span id="r338 rd" class="r338 r">host</span>)
        {
            <span class="i">XmlNodeList</span> <span id="r339 rd" class="r339 r">nodes</span> = <b>null</b>;
            <b>try</b>
            {
                <b>string</b> <span id="r340 rd" class="r340 r">xpathString</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>if</b> (<span class="r336 r">ResourceURI</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#4d3784c76b2cbbcf" class="i field">containerWinrs</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>if</b> (<span class="r337 r">path</span>.<span class="i">Equals</span>(<span class="r338 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#889838e923e5bdb8" class="i field">containerShell</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r335 r">searchitem</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#4d3784c76b2cbbcf" class="i field">containerWinrs</a>.<span class="i">ToLowerInvariant</span>();
                    }
                }
 
                <b>if</b> (<span class="r336 r">ResourceURI</span>.<span class="i">EndsWith</span>(<span class="s">&quot;Config&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || !<span class="r336 r">ResourceURI</span>.<span class="i">EndsWith</span>(<span class="r335 r">searchitem</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r340 r">xpathString</span> = <span class="s">@&quot;/*/*[local-name()=&quot;&quot;&quot;</span> + <span class="r335 r">searchitem</span>.<span class="i">ToLowerInvariant</span>() + <span class="s">@&quot;&quot;&quot;]&quot;</span>;
                }
                <b>else</b>
                {
                    <span class="r340 r">xpathString</span> = <span class="s">@&quot;/*[local-name()=&quot;&quot;&quot;</span> + <span class="r335 r">searchitem</span>.<span class="i">ToLowerInvariant</span>() + <span class="s">@&quot;&quot;&quot;]&quot;</span>;
                }
 
                <span class="r339 r">nodes</span> = <span class="r334 r">resourcexmldocument</span>.<span class="i">SelectNodes</span>(<span class="r340 r">xpathString</span>);
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XPath</span>.<span class="i">XPathException</span> <span id="r341 rd" class="r341 r">ex</span>)
            {
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r342 rd" class="r342 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r341 r">ex</span>, <span class="s">&quot;XPathException&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#846d2b572f2c4820" class="i field">InvalidArgument</a>, <b>null</b>);
                <span class="i">WriteError</span>(<span class="r342 r">er</span>);
            }
 
            <b>return</b> <span class="r339 r">nodes</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;WsMan linking Operations&quot;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> To put a resource value. Wsman put operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r343 r">sessionobj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r344 r">ResourceURI</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r345 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r346 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="5d85e884733a3500" href="R/5d85e884733a3500.html" target="n" data-glyph="76,1" class="i method">PutResourceValue</a>(<b>object</b> <span id="r343 rd" class="r343 r">sessionobj</span>, <b>string</b> <span id="r344 rd" class="r344 r">ResourceURI</span>, <span class="i">Hashtable</span> <span id="r345 rd" class="r345 r">value</span>, <b>string</b> <span id="r346 rd" class="r346 r">host</span>)
        {
            <span class="i">XmlDocument</span> <span id="r347 rd" class="r347 r">inputxml</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r347 r">inputxml</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r343 r">sessionobj</span>, <span class="r344 r">ResourceURI</span>, <span class="r345 r">value</span>);
                <b>if</b> (<span class="r347 r">inputxml</span> != <b>null</b>)
                {
                    <b>bool</b> <span id="r348 rd" class="r348 r">Itemfound</span> = <b>false</b>;
                    <span class="i">XmlNamespaceManager</span> <span id="r349 rd" class="r349 r">nsmgr</span> = <b>new</b> <span class="i">XmlNamespaceManager</span>(<span class="r347 r">inputxml</span>.<span class="i">NameTable</span>);
                    <b>string</b> <span id="r350 rd" class="r350 r">uri_schema</span> = <a href="#6a24048f72c72f67" class="i method">SetSchemaPath</a>(<span class="r344 r">ResourceURI</span>);
                    <span class="r349 r">nsmgr</span>.<span class="i">AddNamespace</span>(<span class="s">&quot;cfg&quot;</span>, <span class="r350 r">uri_schema</span>);
                    <b>string</b> <span id="r351 rd" class="r351 r">xpath</span> = <a href="#fc65cb2d166b53e1" class="i method">SetXPathString</a>(<span class="r344 r">ResourceURI</span>);
                    <span class="i">XmlNodeList</span> <span id="r352 rd" class="r352 r">nodelist</span> = <span class="r347 r">inputxml</span>.<span class="i">SelectNodes</span>(<span class="r351 r">xpath</span>, <span class="r349 r">nsmgr</span>);
                    <b>if</b> (<span class="r352 r">nodelist</span> != <b>null</b> &amp;&amp; <span class="r352 r">nodelist</span>.<span class="i">Count</span> == 1)
                    {
                        <span class="i">XmlNode</span> <span id="r353 rd" class="r353 r">node</span> = (<span class="i">XmlNode</span>)<span class="r352 r">nodelist</span>.<span class="i">Item</span>(0);
                        <b>if</b> (<span class="r353 r">node</span>.<span class="i">HasChildNodes</span>)
                        {
                            <b>for</b> (<b>int</b> <span id="r354 rd" class="r354 r">i</span> = 0; <span class="r354 r">i</span> &lt; <span class="r353 r">node</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span>; <span class="r354 r">i</span>++)
                            {
                                <b>if</b> ((<span class="r353 r">node</span>.<span class="i">ChildNodes</span>[<span class="r354 r">i</span>].<span class="i">ChildNodes</span>.<span class="i">Count</span> == 0) || <span class="r353 r">node</span>.<span class="i">ChildNodes</span>[<span class="r354 r">i</span>].<span class="i">FirstChild</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;#text&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <b>foreach</b> (<b>string</b> <span id="r355 rd" class="r355 r">key</span> <b>in</b> <span class="r345 r">value</span>.<span class="i">Keys</span>)
                                    {
                                        <span class="c">// to make sure we dont set values at inner level.</span>
                                        <span class="c">// for eg: when set-item at winrm/config we dont take input at below level</span>
                                        <b>if</b> (!<a href="#285d6cd9919232f9" class="i method">IsPKey</a>(<span class="r355 r">key</span>, <span class="r344 r">ResourceURI</span>))
                                        {
                                            <b>if</b> (<span class="r353 r">node</span>.<span class="i">ChildNodes</span>[<span class="r354 r">i</span>].<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="r355 r">key</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                            {
                                                <span class="r353 r">node</span>.<span class="i">ChildNodes</span>[<span class="r354 r">i</span>].<span class="i">InnerText</span> = <span class="r345 r">value</span>[<span class="r355 r">key</span>].<span class="i">ToString</span>();
                                                <span class="r348 r">Itemfound</span> = <b>true</b>;
                                            }
                                        }
                                    }
                                }
                            }
 
                            <b>if</b> (<span class="r348 r">Itemfound</span>)
                            {
                                <span class="r344 r">ResourceURI</span> = <a href="#3857aa91e4f9e892" class="i method">GetURIWithFilter</a>(<span class="r344 r">ResourceURI</span>, <span class="r345 r">value</span>);
                                ((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r343 r">sessionobj</span>).<span class="i">Put</span>(<span class="r344 r">ResourceURI</span>, <span class="r353 r">node</span>.<span class="i">OuterXml</span>, 0);
                            }
                            <b>else</b>
                            {
                                <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;ItemDoesNotExist&quot;</span>), <b>false</b>);
                                <b>return</b>;
                            }
                        }
                    }
                }
            }
            <b>finally</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r343 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>))
                {
                    <a href="#014253583d795bc0" class="i method">AssertError</a>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r343 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>, <b>true</b>);
                }
            }
        }
 
        <b>private string</b> <a id="db35803629c6844f" href="R/db35803629c6844f.html" target="n" data-glyph="76,1" class="i method">GetResourceValueInXml</a>(<b>object</b> <span id="r356 rd" class="r356 r">sessionobj</span>, <b>string</b> <span id="r357 rd" class="r357 r">ResourceURI</span>, <span class="i">Hashtable</span> <span id="r358 rd" class="r358 r">cmdlinevalues</span>)
        {
            <b>try</b>
            {
                <span class="r357 r">ResourceURI</span> = <a href="#3857aa91e4f9e892" class="i method">GetURIWithFilter</a>(<span class="r357 r">ResourceURI</span>, <span class="r358 r">cmdlinevalues</span>);
 
                <b>string</b> <span id="r359 rd" class="r359 r">returnValue</span> = <b>string</b>.<span class="i">Empty</span>;
 
                <b>if</b> (!<a href="#959910a828c6b791" class="k">this</a>.<a href="#d1f0d7f75d561b30" class="i field">getMapping</a>.<span class="i">TryGetValue</span>(<span class="r357 r">ResourceURI</span>, <b>out</b> <span class="r359 r">returnValue</span>))
                {
                    <span class="r359 r">returnValue</span> = ((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r356 r">sessionobj</span>).<a href="Interop.cs.html#8322aafdaa3fcc2e" class="i method">Get</a>(<span class="r357 r">ResourceURI</span>, 0);
                    <a href="#959910a828c6b791" class="k">this</a>.<a href="#d1f0d7f75d561b30" class="i field">getMapping</a>.<span class="i">Add</span>(<span class="r357 r">ResourceURI</span>, <span class="r359 r">returnValue</span>);
                }
 
                <b>return</b> <span class="r359 r">returnValue</span>;
            }
            <b>finally</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r356 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>))
                {
                    <a href="#014253583d795bc0" class="i method">AssertError</a>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r356 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>, <b>true</b>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WSMan Get operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r360 r">sessionobj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r361 r">ResourceURI</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r362 r">cmdlinevalues</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">XmlDocument</span> <a id="53ac510d628943c3" href="R/53ac510d628943c3.html" target="n" data-glyph="76,1" class="i method">GetResourceValue</a>(<b>object</b> <span id="r360 rd" class="r360 r">sessionobj</span>, <b>string</b> <span id="r361 rd" class="r361 r">ResourceURI</span>, <span class="i">Hashtable</span> <span id="r362 rd" class="r362 r">cmdlinevalues</span>)
        {
            <span class="i">XmlDocument</span> <span id="r363 rd" class="r363 r">xmlResource</span> = <b>null</b>;
 
            <b>string</b> <span id="r364 rd" class="r364 r">strValueXml</span> = <a href="#959910a828c6b791" class="k">this</a>.<a href="#db35803629c6844f" class="i method">GetResourceValueInXml</a>(<span class="r360 r">sessionobj</span>, <span class="r361 r">ResourceURI</span>, <span class="r362 r">cmdlinevalues</span>);
            <span class="r363 r">xmlResource</span> = <b>new</b> <span class="i">XmlDocument</span>();
            <span class="r363 r">xmlResource</span>.<span class="i">LoadXml</span>(<span class="r364 r">strValueXml</span>);
 
            <b>return</b> <span class="r363 r">xmlResource</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WsMan Enumerate operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r365 r">sessionobj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r366 r">ResourceURI</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">XmlDocument</span> <a id="be8ef6f2909993fb" href="R/be8ef6f2909993fb.html" target="n" data-glyph="76,1" class="i method">EnumerateResourceValue</a>(<b>object</b> <span id="r365 rd" class="r365 r">sessionobj</span>, <b>string</b> <span id="r366 rd" class="r366 r">ResourceURI</span>)
        {
            <span class="i">XmlDocument</span> <span id="r367 rd" class="r367 r">xmlEnumResources</span> = <b>null</b>;
 
            <b>if</b> (!<a href="#959910a828c6b791" class="k">this</a>.<a href="#855f97a7f17d8873" class="i field">enumerateMapping</a>.<span class="i">TryGetValue</span>(<span class="r366 r">ResourceURI</span>, <b>out</b> <span class="r367 r">xmlEnumResources</span>))
            {
                <b>try</b>
                {
                    <b>object</b> <span id="r368 rd" class="r368 r">value</span> = ((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r365 r">sessionobj</span>).<span class="i">Enumerate</span>(<span class="r366 r">ResourceURI</span>, <b>string</b>.<span class="i">Empty</span>, <b>string</b>.<span class="i">Empty</span>, 0);
                    <b>string</b> <span id="r369 rd" class="r369 r">strXmlValue</span> = <b>string</b>.<span class="i">Empty</span>;
 
                    <b>while</b> (!((<a href="Interop.cs.html#498ef0191bb84ab7" class="t t">IWSManEnumerator</a>)<span class="r368 r">value</span>).<a href="Interop.cs.html#8ba03f47e77a0e4a" class="i property">AtEndOfStream</a>)
                    {
                        <span class="r369 r">strXmlValue</span> += ((<a href="Interop.cs.html#498ef0191bb84ab7" class="t t">IWSManEnumerator</a>)<span class="r368 r">value</span>).<a href="Interop.cs.html#d936b539122b186c" class="i method">ReadItem</a>();
                    }
 
                    <span class="i">Marshal</span>.<span class="i">ReleaseComObject</span>(<span class="r368 r">value</span>);
 
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r369 r">strXmlValue</span>))
                    {
                        <span class="r367 r">xmlEnumResources</span> = <b>new</b> <span class="i">XmlDocument</span>();
                        <span class="r369 r">strXmlValue</span> = <span class="s">&quot;&lt;WsManResults&gt;&quot;</span> + <span class="r369 r">strXmlValue</span> + <span class="s">&quot;&lt;/WsManResults&gt;&quot;</span>;
                        <span class="r367 r">xmlEnumResources</span>.<span class="i">LoadXml</span>(<span class="r369 r">strXmlValue</span>);
                        <a href="#959910a828c6b791" class="k">this</a>.<a href="#855f97a7f17d8873" class="i field">enumerateMapping</a>.<span class="i">Add</span>(<span class="r366 r">ResourceURI</span>, <span class="r367 r">xmlEnumResources</span>);
                    }
                }
                <b>finally</b>
                {
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r365 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>))
                    {
                        <a href="#014253583d795bc0" class="i method">AssertError</a>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r365 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>, <b>true</b>);
                    }
                }
            }
 
            <b>return</b> <span class="r367 r">xmlEnumResources</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WsMan Delete Operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r370 r">sessionobj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r371 r">ResourceURI</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r372 r">cmdlinevalues</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r373 r">recurse</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="f1eb7a45c19a542e" href="R/f1eb7a45c19a542e.html" target="n" data-glyph="76,1" class="i method">DeleteResourceValue</a>(<b>object</b> <span id="r370 rd" class="r370 r">sessionobj</span>, <b>string</b> <span id="r371 rd" class="r371 r">ResourceURI</span>, <span class="i">Hashtable</span> <span id="r372 rd" class="r372 r">cmdlinevalues</span>, <b>bool</b> <span id="r373 rd" class="r373 r">recurse</span>)
        {
            <b>try</b>
            {
                <span class="c">// Support only for Listener,plugin and ClientCertificate.</span>
                <b>if</b> (<span class="r371 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>) || <span class="r371 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>) || <span class="r371 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#22940af130242689" class="i field">containerCertMapping</a>))
                {
                    <b>if</b> (<span class="r372 r">cmdlinevalues</span> != <b>null</b>)
                    {
                        <span class="r371 r">ResourceURI</span> = <a href="#3857aa91e4f9e892" class="i method">GetURIWithFilter</a>(<span class="r371 r">ResourceURI</span>, <span class="r372 r">cmdlinevalues</span>);
                    }
 
                    ((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r370 r">sessionobj</span>).<a href="Interop.cs.html#2b0a2c44ae3a3303" class="i method">Delete</a>(<span class="r371 r">ResourceURI</span>, 0);
                }
            }
            <b>finally</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r370 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>))
                {
                    <a href="#014253583d795bc0" class="i method">AssertError</a>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r370 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>, <b>true</b>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WsMan Create Operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r374 r">sessionobj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r375 r">ResourceURI</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r376 r">resource</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r377 r">cmdlinevalues</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="1bfabb8847f3c07a" href="R/1bfabb8847f3c07a.html" target="n" data-glyph="76,1" class="i method">CreateResourceValue</a>(<b>object</b> <span id="r374 rd" class="r374 r">sessionobj</span>, <b>string</b> <span id="r375 rd" class="r375 r">ResourceURI</span>, <b>string</b> <span id="r376 rd" class="r376 r">resource</span>, <span class="i">Hashtable</span> <span id="r377 rd" class="r377 r">cmdlinevalues</span>)
        {
            <b>try</b>
            {
                <b>if</b> (<span class="r375 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>) || <span class="r375 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>) || <span class="r375 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#22940af130242689" class="i field">containerCertMapping</a>))
                {
                    <span class="r375 r">ResourceURI</span> = <a href="#3857aa91e4f9e892" class="i method">GetURIWithFilter</a>(<span class="r375 r">ResourceURI</span>, <span class="r377 r">cmdlinevalues</span>);
                    ((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r374 r">sessionobj</span>).<a href="Interop.cs.html#7ae0beaa00c8c5fb" class="i method">Create</a>(<span class="r375 r">ResourceURI</span>, <span class="r376 r">resource</span>, 0);
                }
            }
            <b>finally</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r374 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>))
                {
                    <a href="#014253583d795bc0" class="i method">AssertError</a>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r374 r">sessionobj</span>).<a href="Interop.cs.html#b572dc301254e63c" class="i property">Error</a>, <b>true</b>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> To find a resource value. Both Get and Enumerate works here.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r378 r">sessionobj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r379 r">ResourceURI</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r380 r">cmdlinevalues</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">XmlDocument</span> <a id="14c3c20542e6ba32" href="R/14c3c20542e6ba32.html" target="n" data-glyph="76,1" class="i method">FindResourceValue</a>(<b>object</b> <span id="r378 rd" class="r378 r">sessionobj</span>, <b>string</b> <span id="r379 rd" class="r379 r">ResourceURI</span>, <span class="i">Hashtable</span> <span id="r380 rd" class="r380 r">cmdlinevalues</span>)
        {
            <span class="i">XmlDocument</span> <span id="r381 rd" class="r381 r">outval</span> = <b>null</b>;
            <b>if</b> (<span class="r379 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>) || <span class="r379 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>) || <span class="r379 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#22940af130242689" class="i field">containerCertMapping</a>))
            {
                <b>if</b> (<span class="r380 r">cmdlinevalues</span> == <b>null</b> || <span class="r380 r">cmdlinevalues</span>.<span class="i">Count</span> == 0)
                {
                    <span class="r381 r">outval</span> = <a href="#be8ef6f2909993fb" class="i method">EnumerateResourceValue</a>(<span class="r378 r">sessionobj</span>, <span class="r379 r">ResourceURI</span>);
                }
                <b>else</b>
                {
                    <span class="r381 r">outval</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r378 r">sessionobj</span>, <span class="r379 r">ResourceURI</span>, <span class="r380 r">cmdlinevalues</span>);
                }
            }
            <b>else</b>
            {
                <span class="r381 r">outval</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r378 r">sessionobj</span>, <span class="r379 r">ResourceURI</span>, <span class="r380 r">cmdlinevalues</span>);
            }
 
            <b>return</b> <span class="r381 r">outval</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks whether a value is present in Wsman config.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r382 r">sessionobj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r383 r">ResourceURI</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r384 r">childname</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r385 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r386 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="e9bf3f91323e9ae6" href="R/e9bf3f91323e9ae6.html" target="n" data-glyph="76,1" class="i method">ContainResourceValue</a>(<b>object</b> <span id="r382 rd" class="r382 r">sessionobj</span>, <b>string</b> <span id="r383 rd" class="r383 r">ResourceURI</span>, <b>string</b> <span id="r384 rd" class="r384 r">childname</span>, <b>string</b> <span id="r385 rd" class="r385 r">path</span>, <b>string</b> <span id="r386 rd" class="r386 r">host</span>)
        {
            <b>bool</b> <span id="r387 rd" class="r387 r">result</span> = <b>false</b>;
            <b>string</b> <span id="r388 rd" class="r388 r">valuexml</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>try</b>
            {
                <b>if</b> (<span class="r383 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>) || <span class="r383 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>) || <span class="r383 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#22940af130242689" class="i field">containerCertMapping</a>))
                {
                    <b>object</b> <span id="r389 rd" class="r389 r">value</span> = ((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r382 r">sessionobj</span>).<span class="i">Enumerate</span>(<span class="r383 r">ResourceURI</span>, <b>string</b>.<span class="i">Empty</span>, <b>string</b>.<span class="i">Empty</span>, 0);
 
                    <b>while</b> (!((<a href="Interop.cs.html#498ef0191bb84ab7" class="t t">IWSManEnumerator</a>)<span class="r389 r">value</span>).<a href="Interop.cs.html#8ba03f47e77a0e4a" class="i property">AtEndOfStream</a>)
                    {
                        <span class="r388 r">valuexml</span> += ((<a href="Interop.cs.html#498ef0191bb84ab7" class="t t">IWSManEnumerator</a>)<span class="r389 r">value</span>).<a href="Interop.cs.html#d936b539122b186c" class="i method">ReadItem</a>();
                    }
 
                    <b>if</b> ((<span class="r388 r">valuexml</span> != <b>string</b>.<span class="i">Empty</span>) &amp;&amp; !(<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r388 r">valuexml</span>)))
                    {
                        <span class="r388 r">valuexml</span> = <span class="s">&quot;&lt;WsManResults&gt;&quot;</span> + <span class="r388 r">valuexml</span> + <span class="s">&quot;&lt;/WsManResults&gt;&quot;</span>;
                    }
 
                    <span class="i">Marshal</span>.<span class="i">ReleaseComObject</span>(<span class="r389 r">value</span>);
                }
                <b>else</b>
                {
                    <span class="r388 r">valuexml</span> = <a href="#959910a828c6b791" class="k">this</a>.<a href="#db35803629c6844f" class="i method">GetResourceValueInXml</a>(((<a href="Interop.cs.html#9141d9ac4bfab2f3" class="t t">IWSManSession</a>)<span class="r382 r">sessionobj</span>), <span class="r383 r">ResourceURI</span>, <b>null</b>);
                }
 
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r388 r">valuexml</span>))
                {
                    <b>return</b> <b>false</b>;
                }
 
                <span class="i">XmlDocument</span> <span id="r390 rd" class="r390 r">xmlResourceValues</span> = <b>new</b> <span class="i">XmlDocument</span>();
                <span class="r390 r">xmlResourceValues</span>.<span class="i">LoadXml</span>(<span class="r388 r">valuexml</span>.<span class="i">ToLowerInvariant</span>());
                <span class="i">XmlNodeList</span> <span id="r391 rd" class="r391 r">nodes</span> = <a href="#22e74b26a07bdcc0" class="i method">SearchXml</a>(<span class="r390 r">xmlResourceValues</span>, <span class="r384 r">childname</span>, <span class="r383 r">ResourceURI</span>, <span class="r385 r">path</span>, <span class="r386 r">host</span>);
                <b>if</b> (<span class="r391 r">nodes</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="r387 r">result</span> = <b>true</b>;
                }
            }
            <b>catch</b> (<span class="i">COMException</span>) { <span class="r387 r">result</span> = <b>false</b>; }
 
            <b>return</b> <span class="r387 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> &quot;WsMan linking Operations&quot;
 
        <b>private static string</b> <a id="3857aa91e4f9e892" href="R/3857aa91e4f9e892.html" target="n" data-glyph="76,1" class="i method">GetURIWithFilter</a>(<b>string</b> <span id="r392 rd" class="r392 r">uri</span>, <span class="i">Hashtable</span> <span id="r393 rd" class="r393 r">cmdlinevalues</span>)
        {
            <span class="i">StringBuilder</span> <span id="r394 rd" class="r394 r">sburi</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="r392 r">uri</span>);
            <b>if</b> (<span class="r393 r">cmdlinevalues</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r392 r">uri</span>.<span class="i">Contains</span>(<span class="s">&quot;Config/Listener&quot;</span>))
                {
                    <span class="r394 r">sburi</span>.<span class="i">Append</span>(<span class="s">&#39;?&#39;</span>);
                    <span class="r394 r">sburi</span>.<span class="i">Append</span>(<a href="#fca6d58dac65f2e4" class="i method">GetFilterString</a>(<span class="r393 r">cmdlinevalues</span>, <a href="#d26439e8d1643cad" class="i field">PKeyListener</a>));
                }
                <b>else</b> <b>if</b> (<span class="r392 r">uri</span>.<span class="i">Contains</span>(<span class="s">&quot;Config/Service/certmapping&quot;</span>))
                {
                    <span class="r394 r">sburi</span>.<span class="i">Append</span>(<span class="s">&#39;?&#39;</span>);
                    <span class="r394 r">sburi</span>.<span class="i">Append</span>(<a href="#fca6d58dac65f2e4" class="i method">GetFilterString</a>(<span class="r393 r">cmdlinevalues</span>, <a href="#aee208c83944c3af" class="i field">PKeyCertMapping</a>));
                }
                <b>else</b> <b>if</b> (<span class="r392 r">uri</span>.<span class="i">Contains</span>(<span class="s">&quot;Config/Plugin&quot;</span>))
                {
                    <span class="r394 r">sburi</span>.<span class="i">Append</span>(<span class="s">&#39;?&#39;</span>);
                    <span class="r394 r">sburi</span>.<span class="i">Append</span>(<a href="#fca6d58dac65f2e4" class="i method">GetFilterString</a>(<span class="r393 r">cmdlinevalues</span>, <a href="#5caecb2abb7dd8be" class="i field">PKeyPlugin</a>));
                }
            }
 
            <b>return</b> <span class="r394 r">sburi</span>.<span class="i">ToString</span>();
        }
 
        <b>private static string</b> <a id="fca6d58dac65f2e4" href="R/fca6d58dac65f2e4.html" target="n" data-glyph="76,1" class="i method">GetFilterString</a>(<span class="i">Hashtable</span> <span id="r395 rd" class="r395 r">cmdlinevalues</span>, <b>string</b>[] <span id="r396 rd" class="r396 r">pkey</span>)
        {
            <span class="i">StringBuilder</span> <span id="r397 rd" class="r397 r">filter</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>foreach</b> (<b>string</b> <span id="r398 rd" class="r398 r">key</span> <b>in</b> <span class="r396 r">pkey</span>)
            {
                <b>if</b> (<span class="r395 r">cmdlinevalues</span>.<span class="i">Contains</span>(<span class="r398 r">key</span>))
                {
                    <span class="r397 r">filter</span>.<span class="i">Append</span>(<span class="r398 r">key</span>);
                    <span class="r397 r">filter</span>.<span class="i">Append</span>(<span class="s">&#39;=&#39;</span>);
                    <span class="r397 r">filter</span>.<span class="i">Append</span>(<span class="r395 r">cmdlinevalues</span>[<span class="r398 r">key</span>].<span class="i">ToString</span>());
                    <span class="r397 r">filter</span>.<span class="i">Append</span>(<span class="s">&#39;+&#39;</span>);
                }
            }
 
            <b>if</b> (<span class="r397 r">filter</span>.<span class="i">ToString</span>().<span class="i">EndsWith</span>(<span class="s">&#39;+&#39;</span>))
                <span class="r397 r">filter</span>.<span class="i">Remove</span>(<span class="r397 r">filter</span>.<span class="i">ToString</span>().<span class="i">Length</span> - 1, 1);
            <b>return</b> <span class="r397 r">filter</span>.<span class="i">ToString</span>();
        }
 
        <b>private static bool</b> <a id="285d6cd9919232f9" href="R/285d6cd9919232f9.html" target="n" data-glyph="76,1" class="i method">IsPKey</a>(<b>string</b> <span id="r399 rd" class="r399 r">value</span>, <b>string</b> <span id="r400 rd" class="r400 r">ResourceURI</span>)
        {
            <b>bool</b> <span id="r401 rd" class="r401 r">result</span> = <b>false</b>;
            <b>if</b> (<span class="r400 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>))
            {
                <span class="r401 r">result</span> = <a href="#46b173aa5330168b" class="i method">CheckPkeysArray</a>(<b>null</b>, <span class="r399 r">value</span>, <a href="#d26439e8d1643cad" class="i field">PKeyListener</a>);
            }
            <b>else</b> <b>if</b> (<span class="r400 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>))
            {
                <span class="r401 r">result</span> = <a href="#46b173aa5330168b" class="i method">CheckPkeysArray</a>(<b>null</b>, <span class="r399 r">value</span>, <a href="#5caecb2abb7dd8be" class="i field">PKeyPlugin</a>);
            }
            <b>else</b> <b>if</b> (<span class="r400 r">ResourceURI</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#22940af130242689" class="i field">containerCertMapping</a>))
            {
                <span class="r401 r">result</span> = <a href="#46b173aa5330168b" class="i method">CheckPkeysArray</a>(<b>null</b>, <span class="r399 r">value</span>, <a href="#aee208c83944c3af" class="i field">PKeyCertMapping</a>);
            }
 
            <b>return</b> <span class="r401 r">result</span>;
        }
 
        <b>private static bool</b> <a id="46b173aa5330168b" href="R/46b173aa5330168b.html" target="n" data-glyph="76,1" class="i method">CheckPkeysArray</a>(<span class="i">Hashtable</span> <span id="r402 rd" class="r402 r">values</span>, <b>string</b> <span id="r403 rd" class="r403 r">value</span>, <b>string</b>[] <span id="r404 rd" class="r404 r">pkeys</span>)
        {
            <b>bool</b> <span id="r405 rd" class="r405 r">result</span> = <b>false</b>;
            <b>if</b> (<span class="r402 r">values</span> != <b>null</b>)
                <b>foreach</b> (<b>string</b> <span id="r406 rd" class="r406 r">key</span> <b>in</b> <span class="r404 r">pkeys</span>)
                {
                    <b>if</b> (<span class="r402 r">values</span>.<span class="i">Contains</span>(<span class="r406 r">key</span>))
                    {
                        <span class="r405 r">result</span> = <b>true</b>;
                    }
                }
            <b>else</b> <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r403 r">value</span>))
            {
                <b>foreach</b> (<b>string</b> <span id="r407 rd" class="r407 r">key</span> <b>in</b> <span class="r404 r">pkeys</span>)
                {
                    <b>if</b> (<span class="r407 r">key</span>.<span class="i">Equals</span>(<span class="r403 r">value</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r405 r">result</span> = <b>true</b>;
                        <b>break</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r405 r">result</span>;
        }
 
        <b>private void</b> <a id="ba7862ec455391bf" href="R/ba7862ec455391bf.html" target="n" data-glyph="76,1" class="i method">WritePSObjectPropertyNames</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r408 rd" class="r408 r">psobject</span>, <b>string</b> <span id="r409 rd" class="r409 r">path</span>)
        {
            <b>foreach</b> (<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r410 rd" class="r410 r">prop</span> <b>in</b> <span class="r408 r">psobject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>)
            {
                <b>if</b> (!<span class="r410 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>))
                {
                    <span class="i">WriteItemObject</span>(<span class="r410 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r409 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r410 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <b>true</b>);
                }
                <b>else</b>
                {
                    <span class="i">WriteItemObject</span>(<span class="r410 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r409 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r410 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <b>false</b>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to Write WSMan objects to the output console. Used by GetChildItem, GetItem and NewItem.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r411 r">psobject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r412 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r413 r">keys</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r414 r">ExtendedTypeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r415 r">WSManElementObjectType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r416 r">recurse</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="ae95a8329bd8f9ae" href="R/ae95a8329bd8f9ae.html" target="n" data-glyph="76,1" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r411 rd" class="r411 r">psobject</span>, <b>string</b> <span id="r412 rd" class="r412 r">path</span>, <b>string</b>[] <span id="r413 rd" class="r413 r">keys</span>, <b>string</b> <span id="r414 rd" class="r414 r">ExtendedTypeName</span>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a> <span id="r415 rd" class="r415 r">WSManElementObjectType</span>, <b>bool</b> <span id="r416 rd" class="r416 r">recurse</span>)
        {
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r417 rd" class="r417 r">mshObject</span> = <b>null</b>;
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r418 rd" class="r418 r">directory</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
            <b>foreach</b> (<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r419 rd" class="r419 r">prop</span> <b>in</b> <span class="r411 r">psobject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>)
            {
                <b>if</b> (<span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6fdea0ea28374520" class="i field">HiddenSuffixForSourceOfValue</a>))
                {
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r415 r">WSManElementObjectType</span>.<span class="i">Equals</span>(<a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#ed8179c5c4307879" class="i field">WSManConfigElement</a>))
                {
                    <a href="#b8b919c7abee9915" class="t t">WSManConfigElement</a> <span id="r420 rd" class="r420 r">element</span> = <b>new</b> <span class="t">WSManConfigElement</span>(<span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>());
                    <span class="r417 r">mshObject</span> = <b>new</b> <span class="t">PSObject</span>(<span class="r420 r">element</span>);
                }
 
                <b>if</b> (<span class="r415 r">WSManElementObjectType</span>.<span class="i">Equals</span>(<a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>))
                {
                    <a href="#3de090d28cee208b" class="t t">WSManConfigContainerElement</a> <span id="r421 rd" class="r421 r">element</span> = <b>new</b> <span class="t">WSManConfigContainerElement</span>(<span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <span class="r413 r">keys</span>);
                    <span class="r417 r">mshObject</span> = <b>new</b> <span class="t">PSObject</span>(<span class="r421 r">element</span>);
                }
 
                <b>if</b> (<span class="r415 r">WSManElementObjectType</span>.<span class="i">Equals</span>(<a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>))
                {
                    <b>string</b> <span id="r422 rd" class="r422 r">sourceProp</span> = <span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6fdea0ea28374520" class="i field">HiddenSuffixForSourceOfValue</a>;
                    <b>object</b> <span id="r423 rd" class="r423 r">source</span> = <b>null</b>;
                    <b>if</b> (<span class="r411 r">psobject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r422 r">sourceProp</span>] != <b>null</b>)
                    {
                        <span class="r423 r">source</span> = <span class="r411 r">psobject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r422 r">sourceProp</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>;
                    }
 
                    <a href="#bb810df317c60bc3" class="t t">WSManConfigLeafElement</a> <span id="r424 rd" class="r424 r">element</span> = <b>null</b>;
                    <b>if</b> (!<span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>))
                    {
                        <span class="r424 r">element</span> = <b>new</b> <a href="#b211f621a826f759" class="t constructor">WSManConfigLeafElement</a>(<span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>, <span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#af662506826a4d3d" class="i property">TypeNameOfValue</a>, <span class="r423 r">source</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r424 r">element</span> = <b>new</b> <span class="t">WSManConfigLeafElement</span>(<span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <b>null</b>, <span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>());
                    }
 
                    <b>if</b> (<span class="r424 r">element</span> != <b>null</b>)
                    {
                        <span class="r417 r">mshObject</span> = <b>new</b> <span class="t">PSObject</span>(<span class="r424 r">element</span>);
                    }
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r414 r">ExtendedTypeName</span>))
                {
                    <span class="i">StringBuilder</span> <span id="r425 rd" class="r425 r">types</span> = <b>new</b> <span class="i">StringBuilder</span>(<b>string</b>.<span class="i">Empty</span>);
                    <b>if</b> (<span class="r417 r">mshObject</span> != <b>null</b>)
                    {
                        <span class="r425 r">types</span>.<span class="i">Append</span>(<span class="r417 r">mshObject</span>.<a href="/System.Management.Automation/A.html#d4170653add67c11" class="i property">ImmediateBaseObject</a>.<span class="i">GetType</span>().<span class="i">FullName</span>);
                        <span class="r425 r">types</span>.<span class="i">Append</span>(<span class="s">&#39;#&#39;</span>);
                        <span class="r425 r">types</span>.<span class="i">Append</span>(<span class="r414 r">ExtendedTypeName</span>);
                        <span class="r417 r">mshObject</span>.<a href="/System.Management.Automation/A.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Insert</span>(0, <span class="r425 r">types</span>.<span class="i">ToString</span>());
                    }
                }
 
                <b>if</b> (!<span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>))
                {
                    <span class="c">// This path is used by WriteItemObject to construct PSPath.</span>
                    <span class="c">// PSPath is a provider qualified path and we dont need to specify</span>
                    <span class="c">// provider root in this path..So I am trying to eliminate provider root</span>
                    <span class="c">// in this case.</span>
                    <b>string</b> <span id="r426 rd" class="r426 r">pathToUse</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ff28b0893dfbf7d2" class="i field">rootpath</a>.<span class="i">Equals</span>(<span class="r412 r">path</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ?
                        <span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a> :
                        (<span class="r412 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>);
                    <span class="i">WriteItemObject</span>(<span class="r417 r">mshObject</span>, <span class="r426 r">pathToUse</span>, <b>false</b>);
                }
                <b>else</b>
                {
                    <span class="c">// This path is used by WriteItemObject to construct PSPath.</span>
                    <span class="c">// PSPath is a provider qualified path and we dont need to specify</span>
                    <span class="c">// provider root in this path..So I am trying to eliminate provider root</span>
                    <span class="c">// in this case.</span>
                    <b>string</b> <span id="r427 rd" class="r427 r">pathToUse</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ff28b0893dfbf7d2" class="i field">rootpath</a>.<span class="i">Equals</span>(<span class="r412 r">path</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ?
                        <span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a> :
                        (<span class="r412 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>);
                    <span class="i">WriteItemObject</span>(<span class="r417 r">mshObject</span>, <span class="r427 r">pathToUse</span>, <b>true</b>);
                    <b>if</b> (<span class="r416 r">recurse</span>)
                    {
                        <span class="r418 r">directory</span>.<span class="i">Add</span>(<span class="r419 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>);
                    }
                }
            }
 
            <b>if</b> (<span class="r416 r">recurse</span>)
            {
                <b>foreach</b> (<b>string</b> <span id="r428 rd" class="r428 r">dir</span> <b>in</b> <span class="r418 r">directory</span>)
                {
                    <a href="#670366064ee48c8b" class="i method">GetChildItemsRecurse</a>(<span class="r412 r">path</span>, <span class="r428 r">dir</span>, <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>, <span class="r416 r">recurse</span>);
                }
            }
        }
 
        <b>private string</b> <a id="e00566e0c0c6a1b9" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">SplitAndUpdateStringUsingDelimiter</a>(<b>object</b> <span id="r429 rd" class="r429 r">sessionobj</span>, <b>string</b> <span id="r430 rd" class="r430 r">uri</span>, <b>string</b> <span id="r431 rd" class="r431 r">childname</span>, <b>string</b> <span id="r432 rd" class="r432 r">value</span>, <b>string</b> <span id="r433 rd" class="r433 r">Delimiter</span>)
        {
            <span class="i">XmlDocument</span> <span id="r434 rd" class="r434 r">xmlResource</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r429 r">sessionobj</span>, <span class="r430 r">uri</span>, <b>null</b>);
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r435 rd" class="r435 r">mshObject</span> = <b>null</b>;
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r436 rd" class="r436 r">innerResourceNodes</span> <b>in</b> <span class="r434 r">xmlResource</span>.<span class="i">ChildNodes</span>)
            {
                <span class="r435 r">mshObject</span> = <a href="#edd1bbc7452c8ae2" class="i method">ConvertToPSObject</a>(<span class="r436 r">innerResourceNodes</span>);
            }
 
            <b>string</b> <span id="r437 rd" class="r437 r">existingvalue</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>try</b>
            {
                <b>if</b> (<span class="r435 r">mshObject</span> != <b>null</b>)
                {
                    <span class="r437 r">existingvalue</span> = <span class="r435 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r431 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r437 r">existingvalue</span>))
                {
                    <b>string</b>[] <span id="r438 rd" class="r438 r">existingsplitvalues</span> = <span class="r437 r">existingvalue</span>.<span class="i">Split</span>(<span class="r433 r">Delimiter</span>, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
                    <b>string</b>[] <span id="r439 rd" class="r439 r">newvalues</span> = <span class="r432 r">value</span>.<span class="i">Split</span>(<span class="r433 r">Delimiter</span>, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
                    <b>foreach</b> (<b>string</b> <span id="r440 rd" class="r440 r">val</span> <b>in</b> <span class="r439 r">newvalues</span>)
                    {
                        <b>if</b> (<span class="i">Array</span>.<span class="i">IndexOf</span>(<span class="r438 r">existingsplitvalues</span>, <span class="r440 r">val</span>) == -1)
                        {
                            <span class="r437 r">existingvalue</span> += <span class="r433 r">Delimiter</span> + <span class="r440 r">val</span>;
                        }
                    }
                }
                <b>else</b>
                {
                    <span class="r437 r">existingvalue</span> = <span class="r432 r">value</span>;
                }
            }
            <b>catch</b> (<a href="/System.Management.Automation/A.html#581bd9b947689819" class="t t">PSArgumentException</a>)
            {
            }
 
            <b>return</b> <span class="r437 r">existingvalue</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For Host Level or WsMan level</span>
        <span class="c">///</span><span class="c"> WsMan\Localhost:\&gt;</span>
        <span class="c">///</span><span class="c"> WsMan:\&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r441 r">objSessionObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r442 r">uri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r443 r">IsWsManLevel</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="95ab8fd9493f109a" href="R/95ab8fd9493f109a.html" target="n" data-glyph="76,1" class="i method">BuildHostLevelPSObjectArrayList</a>(<b>object</b> <span id="r441 rd" class="r441 r">objSessionObject</span>, <b>string</b> <span id="r442 rd" class="r442 r">uri</span>, <b>bool</b> <span id="r443 rd" class="r443 r">IsWsManLevel</span>)
        {
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r444 rd" class="r444 r">mshobject</span> = <b>new</b> <span class="t">PSObject</span>();
            <b>if</b> (<span class="r443 r">IsWsManLevel</span>)
            {
                <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r445 rd" class="r445 r">SessionObjCache</span> = <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2b29be8459e983a7" class="i method">GetSessionObjCache</a>();
                <b>foreach</b> (<b>string</b> <span id="r446 rd" class="r446 r">key</span> <b>in</b> <span class="r445 r">SessionObjCache</span>.<span class="i">Keys</span>)
                {
                    <span class="r444 r">mshobject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r446 r">key</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>));
                }
            }
            <b>else</b>
            {
                <b>if</b> (<span class="r441 r">objSessionObject</span> != <b>null</b>)
                {
                    <span class="i">XmlDocument</span> <span id="r447 rd" class="r447 r">ConfigXml</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r441 r">objSessionObject</span>, <span class="r442 r">uri</span>, <b>null</b>);
                    <span class="c">// Moving in to &lt;Config&gt;</span>
                    <b>foreach</b> (<span class="i">XmlNode</span> <span id="r448 rd" class="r448 r">node</span> <b>in</b> <span class="r447 r">ConfigXml</span>.<span class="i">ChildNodes</span>)
                    {
                        <b>foreach</b> (<span class="i">XmlNode</span> <span id="r449 rd" class="r449 r">node1</span> <b>in</b> <span class="r448 r">node</span>.<span class="i">ChildNodes</span>)
                        {
                            <span class="c">// Getting Top Element in &lt;Config&gt;</span>
                            <b>if</b> ((<span class="r449 r">node1</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span> == 0) || <span class="r449 r">node1</span>.<span class="i">FirstChild</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;#text&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="r444 r">mshobject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r449 r">node1</span>.<span class="i">LocalName</span>, <span class="r449 r">node1</span>.<span class="i">InnerText</span>));
                            }
                        }
                    }
                }
                <span class="c">// Getting the Fixed root nodes.</span>
                <b>foreach</b> (<b>string</b> <span id="r450 rd" class="r450 r">root</span> <b>in</b> <a href="#f764575b79febe1d" class="i field">WinRmRootConfigs</a>)
                {
                    <span class="r444 r">mshobject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r450 r">root</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>));
                }
            }
 
            <b>return</b> <span class="r444 r">mshobject</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Converts XmlNodes ChildNodes to Properties of PSObject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r451 r">xmlnode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="edd1bbc7452c8ae2" href="R/edd1bbc7452c8ae2.html" target="n" data-glyph="76,1" class="i method">ConvertToPSObject</a>(<span class="i">XmlNode</span> <span id="r451 rd" class="r451 r">xmlnode</span>)
        {
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r452 rd" class="r452 r">mshObject</span> = <b>new</b> <span class="t">PSObject</span>();
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r453 rd" class="r453 r">node</span> <b>in</b> <span class="r451 r">xmlnode</span>.<span class="i">ChildNodes</span>)
            {
                <span class="c">// If node contains 0 child-nodes, it is empty node, if it&#39;s name = &quot;#text&quot; then it&#39;s a simple node.</span>
                <b>if</b> ((<span class="r453 r">node</span>.<span class="i">ChildNodes</span>.<span class="i">Count</span> == 0) || <span class="r453 r">node</span>.<span class="i">FirstChild</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;#text&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="i">XmlAttribute</span> <span id="r454 rd" class="r454 r">attrSource</span> = <b>null</b>;
                    <b>foreach</b> (<span class="i">XmlAttribute</span> <span id="r455 rd" class="r455 r">attr</span> <b>in</b> <span class="r453 r">node</span>.<span class="i">Attributes</span>)
                    {
                        <b>if</b> (<span class="r455 r">attr</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;Source&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="r454 r">attrSource</span> = <span class="r455 r">attr</span>;
                            <b>break</b>;
                        }
                    }
 
                    <span class="r452 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r453 r">node</span>.<span class="i">LocalName</span>, <span class="r453 r">node</span>.<span class="i">InnerText</span>));
 
                    <b>if</b> (<span class="r454 r">attrSource</span> != <b>null</b>)
                    {
                        <b>string</b> <span id="r456 rd" class="r456 r">propName</span> = <span class="r453 r">node</span>.<span class="i">LocalName</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6fdea0ea28374520" class="i field">HiddenSuffixForSourceOfValue</a>;
                        <span class="r452 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Remove</span>(<span class="r456 r">propName</span>);
                        <span class="r452 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r456 r">propName</span>, <span class="r454 r">attrSource</span>.<span class="i">Value</span>));
                    }
                }
                <b>else</b>
                {
                    <span class="r452 r">mshObject</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r453 r">node</span>.<span class="i">LocalName</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>));
                }
            }
 
            <b>return</b> <span class="r452 r">mshObject</span>;
        }
 
        <b>private static string</b> <a id="fc65cb2d166b53e1" href="R/fc65cb2d166b53e1.html" target="n" data-glyph="76,1" class="i method">SetXPathString</a>(<b>string</b> <span id="r457 rd" class="r457 r">uri</span>)
        {
            <b>string</b> <span id="r458 rd" class="r458 r">parent</span> = <span class="r457 r">uri</span>.<span class="i">Substring</span>(<span class="r457 r">uri</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#a88135c18afb291c" class="i field">WinrmPathSeparator</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) + 1);
            <b>if</b> (<span class="r458 r">parent</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#4d3784c76b2cbbcf" class="i field">containerWinrs</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r458 r">parent</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#4d3784c76b2cbbcf" class="i field">containerWinrs</a>;
            }
            <b>else</b> <b>if</b> (<span class="r458 r">parent</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#492bc1a90a696ed1" class="i field">containerAuth</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r458 r">parent</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#492bc1a90a696ed1" class="i field">containerAuth</a>;
            }
            <b>else</b> <b>if</b> (<span class="r458 r">parent</span>.<span class="i">Equals</span>(<span class="s">&quot;certmapping&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r458 r">parent</span> = <span class="s">&quot;CertMapping&quot;</span>;
            }
            <b>else</b> <b>if</b> (<span class="r458 r">parent</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#1332bd072f02a398" class="i field">containerService</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r458 r">parent</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#1332bd072f02a398" class="i field">containerService</a>;
            }
            <b>else</b> <b>if</b> (<span class="r458 r">parent</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#c946bcc82c5ee36c" class="i field">containerDefaultPorts</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r458 r">parent</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#c946bcc82c5ee36c" class="i field">containerDefaultPorts</a>;
            }
            <b>else</b> <b>if</b> (<span class="r458 r">parent</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r458 r">parent</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>;
            }
 
            <span class="r458 r">parent</span> = <span class="s">&quot;/cfg:&quot;</span> + <span class="r458 r">parent</span>;
            <b>return</b> <span class="r458 r">parent</span>;
        }
 
        <b>private static string</b> <a id="6a24048f72c72f67" href="R/6a24048f72c72f67.html" target="n" data-glyph="76,1" class="i method">SetSchemaPath</a>(<b>string</b> <span id="r459 rd" class="r459 r">uri</span>)
        {
            <b>string</b> <span id="r460 rd" class="r460 r">schemapath</span> = <b>string</b>.<span class="i">Empty</span>;
            <span class="r459 r">uri</span> = <span class="r459 r">uri</span>.<span class="i">Remove</span>(0, <a href="#b34112b4f6fb44e7" class="i field">WinrmRootName</a>[0].<span class="i">Length</span>);
            <b>if</b> (<span class="r459 r">uri</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>))
            {
                <span class="r460 r">schemapath</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#2bf6a0f44c2ec8e9" class="i field">WsMan_Schema</a> + <span class="s">&quot;/plugin&quot;</span>;
            }
            <b>else</b> <b>if</b> (<span class="r459 r">uri</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>))
            {
                <span class="r459 r">uri</span> = <span class="r459 r">uri</span>.<span class="i">Replace</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="s">&quot;/service/certmapping&quot;</span>);
                <span class="r460 r">schemapath</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#2bf6a0f44c2ec8e9" class="i field">WsMan_Schema</a> + <span class="r459 r">uri</span>.<span class="i">ToLowerInvariant</span>();
            }
            <b>else</b>
            {
                <span class="r460 r">schemapath</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#2bf6a0f44c2ec8e9" class="i field">WsMan_Schema</a> + <span class="r459 r">uri</span>.<span class="i">ToLowerInvariant</span>();
            }
 
            <b>return</b> <span class="r460 r">schemapath</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the Uri for the operation from a path.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r461 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r462 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="103267db7d6cc518" href="R/103267db7d6cc518.html" target="n" data-glyph="76,1" class="i method">NormalizePath</a>(<b>string</b> <span id="r461 rd" class="r461 r">path</span>, <b>string</b> <span id="r462 rd" class="r462 r">host</span>)
        {
            <b>string</b> <span id="r463 rd" class="r463 r">uri</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<span class="r461 r">path</span>.<span class="i">StartsWith</span>(<span class="r462 r">host</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<span class="r461 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    <span class="r461 r">path</span> = <span class="r461 r">path</span>.<span class="i">TrimEnd</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>);
 
                <b>if</b> (<span class="r461 r">path</span>.<span class="i">Equals</span>(<span class="r462 r">host</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r463 r">uri</span> = <a href="#b34112b4f6fb44e7" class="i field">WinrmRootName</a>[0];
                    <b>return</b> <span class="r463 r">uri</span>;
                }
 
                <span class="r463 r">uri</span> = <span class="r461 r">path</span>.<span class="i">Substring</span>(<span class="r462 r">host</span>.<span class="i">Length</span>);
                <span class="r463 r">uri</span> = <span class="r463 r">uri</span>.<span class="i">Replace</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#a88135c18afb291c" class="i field">WinrmPathSeparator</a>);
                <b>string</b> <span id="r464 rd" class="r464 r">host_prefix</span> = <span class="r462 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                <b>if</b> (<span class="r461 r">path</span>.<span class="i">StartsWith</span>(<span class="r464 r">host_prefix</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r463 r">uri</span> = <a href="#b34112b4f6fb44e7" class="i field">WinrmRootName</a>[0] + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#a88135c18afb291c" class="i field">WinrmPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#22940af130242689" class="i field">containerCertMapping</a>;
                }
                <b>else</b> <b>if</b> (<span class="r461 r">path</span>.<span class="i">StartsWith</span>(<span class="r464 r">host_prefix</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r463 r">uri</span> = <a href="#b34112b4f6fb44e7" class="i field">WinrmRootName</a>[0] + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#a88135c18afb291c" class="i field">WinrmPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>;
                }
                <b>else</b> <b>if</b> (<span class="r461 r">path</span>.<span class="i">StartsWith</span>(<span class="r464 r">host_prefix</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#889838e923e5bdb8" class="i field">containerShell</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r463 r">uri</span> = <a href="#b34112b4f6fb44e7" class="i field">WinrmRootName</a>[0] + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#a88135c18afb291c" class="i field">WinrmPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#4d3784c76b2cbbcf" class="i field">containerWinrs</a>;
                }
                <b>else</b> <b>if</b> (<span class="r461 r">path</span>.<span class="i">StartsWith</span>(<span class="r464 r">host_prefix</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r463 r">uri</span> = <a href="#b34112b4f6fb44e7" class="i field">WinrmRootName</a>[0] + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#a88135c18afb291c" class="i field">WinrmPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>;
                }
                <b>else</b>
                {
                    <b>if</b> (!(<span class="r461 r">path</span>.<span class="i">Equals</span>(<span class="r464 r">host_prefix</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#1332bd072f02a398" class="i field">containerService</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                        || <span class="r461 r">path</span>.<span class="i">Equals</span>(<span class="r464 r">host_prefix</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#65ec6609d9d215e7" class="i field">containerClient</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || <span class="r461 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#c946bcc82c5ee36c" class="i field">containerDefaultPorts</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                           || <span class="r461 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#492bc1a90a696ed1" class="i field">containerAuth</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                    {
                        <b>int</b> <span id="r465 rd" class="r465 r">index</span> = <span class="r463 r">uri</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#a88135c18afb291c" class="i field">WinrmPathSeparator</a>);
                        <b>if</b> (<span class="r465 r">index</span> != -1)
                        {
                            <span class="r463 r">uri</span> = <span class="r463 r">uri</span>.<span class="i">Remove</span>(<span class="r465 r">index</span>);
                        }
                    }
 
                    <span class="r463 r">uri</span> = <a href="#b34112b4f6fb44e7" class="i field">WinrmRootName</a>[0] + <span class="r463 r">uri</span>;
                }
 
                <b>return</b> <span class="r463 r">uri</span>;
            }
 
            <b>return</b> <span class="r463 r">uri</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Given wsman config path, gets the value of the leaf present.</span>
        <span class="c">///</span><span class="c"> If path is not valid or not present throws an exception.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Currently this supports only retrieving Resource_XXXX dir contents.</span>
        <span class="c">///</span><span class="c"> if you need support at other levels implement them.</span>
        <span class="c">///</span><span class="c"> Example resource dir: WSMan:\localhost\Plugin\someplugin\Resources\Resource_XXXXXXX.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r466 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A PSObject representing the contents of the path if successful,</span>
        <span class="c">///</span><span class="c"> Otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1. path is null or empty.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">NotSupportedException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1. </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r466 r">path</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> should be of form</span>
        <span class="c">///</span><span class="c">    WSMan:\localhost\Plugin\someplugin\Resources\Resource_XXXXXXX</span>
        <span class="c">///</span><span class="c">    Other paths are not supported currently. If you want you can</span>
        <span class="c">///</span><span class="c">    add them later.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="8876aa0487fb9487" href="R/8876aa0487fb9487.html" target="n" data-glyph="76,1" class="i method">GetItemValue</a>(<b>string</b> <span id="r466 rd" class="r466 r">path</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r466 r">path</span>) || (<span class="r466 r">path</span>.<span class="i">Length</span> == 0))
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<span class="r466 r">path</span>);
            }
 
            <span class="c">// if endswith &#39;\&#39;, removes it.</span>
            <b>if</b> (<span class="r466 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r466 r">path</span> = <span class="r466 r">path</span>.<span class="i">Remove</span>(<span class="r466 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
            }
 
            <span class="c">// Get the wsman host name to find the session object</span>
            <b>string</b> <span id="r467 rd" class="r467 r">host</span> = <a href="#660b53b524868f2c" class="i method">GetHostName</a>(<span class="r466 r">path</span>);
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r467 r">host</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="s">&quot;InvalidPath&quot;</span>);
            }
 
            <span class="c">// Chks the WinRM Service</span>
            <b>if</b> (<a href="#f48e279095b5a8c1" class="i method">IsPathLocalMachine</a>(<span class="r467 r">host</span>) &amp;&amp; (!<a href="#049952faaf766e5b" class="i method">IsWSManServiceRunning</a>()))
            {
                <a href="#014253583d795bc0" class="i method">AssertError</a>(<span class="s">&quot;WinRMServiceError&quot;</span>, <b>false</b>);
            }
 
            <b>lock</b> (<a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2a23b1e8c34cc740" class="i field">AutoSession</a>)
            {
                <b>object</b> <span id="r468 rd" class="r468 r">sessionobj</span>;
                <span class="c">// gets the sessionobject</span>
                <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r469 rd" class="r469 r">SessionObjCache</span> = <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2b29be8459e983a7" class="i method">GetSessionObjCache</a>();
                <span class="r469 r">SessionObjCache</span>.<span class="i">TryGetValue</span>(<span class="r467 r">host</span>, <b>out</b> <span class="r468 r">sessionobj</span>);
 
                <span class="c">// Normalize to the required uri</span>
                <b>string</b> <span id="r470 rd" class="r470 r">uri</span> = <a href="#103267db7d6cc518" class="i method">NormalizePath</a>(<span class="r466 r">path</span>, <span class="r467 r">host</span>);
 
                <b>string</b> <span id="r471 rd" class="r471 r">strPathchk</span> = <span class="r467 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
 
                <b>if</b> (<span class="r466 r">path</span>.<span class="i">EndsWith</span>(<span class="r467 r">host</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r472 rd" class="r472 r">result</span> = <a href="#95ab8fd9493f109a" class="i method">BuildHostLevelPSObjectArrayList</a>(<span class="r468 r">sessionobj</span>, <span class="r470 r">uri</span>, <b>false</b>);
                    <b>return</b> <span class="r472 r">result</span>;
                }
 
                <span class="c">// Get the XML for the resource path we are looking for.</span>
                <span class="i">XmlDocument</span> <span id="r473 rd" class="r473 r">outxml</span> = <a href="#14c3c20542e6ba32" class="i method">FindResourceValue</a>(<span class="r468 r">sessionobj</span>, <span class="r470 r">uri</span>, <b>null</b>);
                <b>if</b> (<span class="r473 r">outxml</span> == <b>null</b> || !<span class="r473 r">outxml</span>.<span class="i">HasChildNodes</span>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<span class="r466 r">path</span>.<span class="i">Contains</span>(<span class="r471 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>))
                {
                    <span class="c">// Implement the necessary functionality here when needed.</span>
                    <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>();
                }
                <b>else</b> <b>if</b> (<span class="r466 r">path</span>.<span class="i">Contains</span>(<span class="r471 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>))
                {
                    <span class="c">// Implement the necessary functionality here when needed.</span>
                    <b>throw</b> <b>new</b> <span class="i">NotSupportedException</span>();
                }
                <b>else</b> <b>if</b> (<span class="r466 r">path</span>.<span class="i">Contains</span>(<span class="r471 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>))
                {
                    <b>string</b> <span id="r474 rd" class="r474 r">currentpluginname</span> = <b>string</b>.<span class="i">Empty</span>;
                    <a href="#652b1bae7a230230" class="i method">GetPluginNames</a>(<span class="r473 r">outxml</span>, <b>out</b> <a href="#7be9fa29345270fd" class="i field">objPluginNames</a>, <b>out</b> <span class="r474 r">currentpluginname</span>, <span class="r466 r">path</span>);
                    <b>if</b> (<span class="r466 r">path</span>.<span class="i">EndsWith</span>(<span class="r471 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <a href="#7be9fa29345270fd" class="i field">objPluginNames</a>;
                    }
                    <b>else</b>
                    {
                        <span class="c">// Currently this supports only retrieving Resource_XXXX dir contents.</span>
                        <span class="c">// if you need support at other levels implement them.</span>
                        <span class="c">// Example resource dir: WSMan:\localhost\Plugin\someplugin\Resources\Resource_67830040</span>
                        <b>string</b> <span id="r475 rd" class="r475 r">filter</span> = <span class="r470 r">uri</span> + <span class="s">&quot;?Name=&quot;</span> + <span class="r474 r">currentpluginname</span>;
                        <span class="i">XmlDocument</span> <span id="r476 rd" class="r476 r">CurrentPluginXML</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r468 r">sessionobj</span>, <span class="r475 r">filter</span>, <b>null</b>);
                        <b>if</b> (<span class="r476 r">CurrentPluginXML</span> == <b>null</b>)
                        {
                            <b>return</b> <b>null</b>;
                        }
 
                        <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r477 rd" class="r477 r">objPluginlevel</span> = <a href="#d773ffd607e22121" class="i method">ProcessPluginConfigurationLevel</a>(<span class="r476 r">CurrentPluginXML</span>);
                        <span class="i">ArrayList</span> <span id="r478 rd" class="r478 r">arrSecurity</span> = <b>null</b>;
                        <span class="i">ArrayList</span> <span id="r479 rd" class="r479 r">arrResources</span> = <a href="#9fc4301cb03b79b7" class="i method">ProcessPluginResourceLevel</a>(<span class="r476 r">CurrentPluginXML</span>, <b>out</b> <span class="r478 r">arrSecurity</span>);
                        <span class="i">ArrayList</span> <span id="r480 rd" class="r480 r">arrInitParams</span> = <a href="#0f58ba5254c3d7ba" class="i method">ProcessPluginInitParamLevel</a>(<span class="r476 r">CurrentPluginXML</span>);
                        <span class="r471 r">strPathchk</span> = <span class="r471 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                        <span class="r471 r">strPathchk</span> = <span class="r471 r">strPathchk</span> + <span class="r474 r">currentpluginname</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
 
                        <span class="c">// We support only retrieving Resource_XXX dir properties only.</span>
                        <span class="c">// other directory support can be added as needed.</span>
                        <b>if</b> (<span class="r479 r">arrResources</span> == <b>null</b>)
                        {
                            <b>return</b> <b>null</b>;
                        }
 
                        <span class="r471 r">strPathchk</span> = <span class="r471 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                        <b>int</b> <span id="r481 rd" class="r481 r">Sepindex</span> = <span class="r466 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r471 r">strPathchk</span>.<span class="i">Length</span>);
                        <b>string</b> <span id="r482 rd" class="r482 r">sResourceDirName</span> = <b>string</b>.<span class="i">Empty</span>;
                        <b>if</b> (<span class="r481 r">Sepindex</span> == -1)
                        {
                            <span class="r482 r">sResourceDirName</span> = <span class="r466 r">path</span>.<span class="i">Substring</span>(<span class="r471 r">strPathchk</span>.<span class="i">Length</span>);
                        }
                        <b>else</b>
                        {
                            <span class="r482 r">sResourceDirName</span> = <span class="r466 r">path</span>.<span class="i">Substring</span>(<span class="r471 r">strPathchk</span>.<span class="i">Length</span>,
                                <span class="r466 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r471 r">strPathchk</span>.<span class="i">Length</span>) - (<span class="r471 r">strPathchk</span>.<span class="i">Length</span>));
                        }
 
                        <b>if</b> (<span class="r466 r">path</span>.<span class="i">EndsWith</span>(<span class="r471 r">strPathchk</span> + <span class="r482 r">sResourceDirName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r483 rd" class="r483 r">p</span> <b>in</b> <span class="r479 r">arrResources</span>)
                            {
                                <b>if</b> (<span class="r482 r">sResourceDirName</span>.<span class="i">Equals</span>(<span class="r483 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>()))
                                {
                                    <span class="r483 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Remove</span>(<span class="s">&quot;ResourceDir&quot;</span>);
                                    <b>return</b> <span class="r483 r">p</span>;
                                }
                            }
                        }
                    }
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private string</b> <a id="431b62c6874cf93e" href="R/431b62c6874cf93e.html" target="n" data-glyph="76,1" class="i method">GetCorrectCaseOfPath</a>(<b>string</b> <span id="r484 rd" class="r484 r">path</span>)
        {
            <b>if</b> (!<span class="r484 r">path</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>()))
            {
                <b>return</b> <a href="#6908f0575ffd28fa" class="i method">GetChildName</a>(<span class="r484 r">path</span>);
            }
 
            <b>string</b>[] <span id="r485 rd" class="r485 r">splitpath</span> = <span class="r484 r">path</span>.<span class="i">Split</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>);
            <span class="i">StringBuilder</span> <span id="r486 rd" class="r486 r">sbPath</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>bool</b> <span id="r487 rd" class="r487 r">first</span> = <b>true</b>;
            <span class="i">StringBuilder</span> <span id="r488 rd" class="r488 r">tempPath</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>foreach</b> (<b>string</b> <span id="r489 rd" class="r489 r">strpath</span> <b>in</b> <span class="r485 r">splitpath</span>)
            {
                <b>if</b> (<span class="r487 r">first</span>)
                {
                    <span class="r487 r">first</span> = <b>false</b>;
                    <span class="r488 r">tempPath</span>.<span class="i">Append</span>(<a href="#6908f0575ffd28fa" class="i method">GetChildName</a>(<span class="r489 r">strpath</span>));
                    <span class="r486 r">sbPath</span>.<span class="i">Append</span>(<span class="r488 r">tempPath</span>);
                }
                <b>else</b>
                {
                    <span class="r488 r">tempPath</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>);
                    <span class="r488 r">tempPath</span>.<span class="i">Append</span>(<span class="r489 r">strpath</span>);
                    <span class="r486 r">sbPath</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>);
                    <span class="r486 r">sbPath</span>.<span class="i">Append</span>(<span class="i">GetChildName</span>(<span class="r488 r">tempPath</span>.<span class="i">ToString</span>()));
                }
            }
 
            <b>return</b> <span class="r486 r">sbPath</span>.<span class="i">ToString</span>();
        }
 
        <b>private string</b> <a id="a21b299ded214582" href="R/a21b299ded214582.html" target="n" data-glyph="76,1" class="i method">GetCorrectCaseOfName</a>(<b>string</b> <span id="r490 rd" class="r490 r">ChildName</span>, <b>string</b> <span id="r491 rd" class="r491 r">hostname</span>, <b>string</b> <span id="r492 rd" class="r492 r">path</span>)
        {
            <b>string</b> <span id="r493 rd" class="r493 r">result</span> = <span class="r490 r">ChildName</span>;
            <b>if</b> (<span class="r490 r">ChildName</span> != <b>null</b>)
            {
                <b>if</b> (!<span class="r490 r">ChildName</span>.<span class="i">Contains</span>(<span class="s">&#39;_&#39;</span>))
                {
                    <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>;
                    <b>else</b> <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>;
                    <b>else</b> <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>;
                    <b>else</b> <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>;
                    <b>else</b> <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#1332bd072f02a398" class="i field">containerService</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#1332bd072f02a398" class="i field">containerService</a>;
                    <b>else</b> <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#889838e923e5bdb8" class="i field">containerShell</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#889838e923e5bdb8" class="i field">containerShell</a>;
                    <b>else</b> <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#14caf545f3eccbf9" class="i field">containerTrustedHosts</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#14caf545f3eccbf9" class="i field">containerTrustedHosts</a>;
                    <b>else</b> <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#492bc1a90a696ed1" class="i field">containerAuth</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#492bc1a90a696ed1" class="i field">containerAuth</a>;
                    <b>else</b> <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#65ec6609d9d215e7" class="i field">containerClient</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#65ec6609d9d215e7" class="i field">containerClient</a>;
                    <b>else</b> <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>;
                    <b>else</b> <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#c946bcc82c5ee36c" class="i field">containerDefaultPorts</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#c946bcc82c5ee36c" class="i field">containerDefaultPorts</a>;
                    <b>else</b> <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>;
                    <b>else</b> <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>;
                    <b>else</b>
                    {
                        <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r491 r">hostname</span>))
                        {
                            <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r494 rd" class="r494 r">SessionObjCache</span> = <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2b29be8459e983a7" class="i method">GetSessionObjCache</a>();
                            <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<span class="r491 r">hostname</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <b>foreach</b> (<b>string</b> <span id="r495 rd" class="r495 r">key</span> <b>in</b> <span class="r494 r">SessionObjCache</span>.<span class="i">Keys</span>)
                                    <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">Equals</span>(<span class="r495 r">key</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                        <span class="r493 r">result</span> = <span class="r495 r">key</span>;
                            }
                            <b>else</b> <b>if</b> (<span class="r492 r">path</span>.<span class="i">Contains</span>(<span class="r491 r">hostname</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>))
                            {
                                <b>if</b> (<a href="#f48e279095b5a8c1" class="i method">IsPathLocalMachine</a>(<span class="r491 r">hostname</span>))
                                {
                                    <b>if</b> (!<a href="#049952faaf766e5b" class="i method">IsWSManServiceRunning</a>())
                                    {
                                        <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#e53fd23e593153ef" class="i method">ThrowIfNotAdministrator</a>();
                                        <a href="#76311111d1d2f1b2" class="i method">StartWSManService</a>(<a href="#959910a828c6b791" class="k">this</a>.<a href="/System.Management.Automation/A.html#e3c4d51f13fbfcaa" class="i property">Force</a>);
                                    }
                                }
 
                                <b>string</b> <span id="r496 rd" class="r496 r">uri</span> = <a href="#103267db7d6cc518" class="i method">NormalizePath</a>(<span class="r492 r">path</span>, <span class="r491 r">hostname</span>);
 
                                <b>lock</b> (<a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2a23b1e8c34cc740" class="i field">AutoSession</a>)
                                {
                                    <b>object</b> <span id="r497 rd" class="r497 r">sessionobj</span>;
                                    <span class="r494 r">SessionObjCache</span>.<span class="i">TryGetValue</span>(<span class="r491 r">hostname</span>, <b>out</b> <span class="r497 r">sessionobj</span>);
                                    <span class="i">XmlDocument</span> <span id="r498 rd" class="r498 r">outxml</span> = <a href="#14c3c20542e6ba32" class="i method">FindResourceValue</a>(<span class="r497 r">sessionobj</span>, <span class="r496 r">uri</span>, <b>null</b>);
                                    <b>if</b> (<span class="r498 r">outxml</span> != <b>null</b>)
                                    {
                                        <b>string</b> <span id="r499 rd" class="r499 r">currentPluginName</span> = <b>string</b>.<span class="i">Empty</span>;
                                        <a href="#652b1bae7a230230" class="i method">GetPluginNames</a>(<span class="r498 r">outxml</span>, <b>out</b> <a href="#7be9fa29345270fd" class="i field">objPluginNames</a>, <b>out</b> <span class="r499 r">currentPluginName</span>, <span class="r492 r">path</span>);
                                        <b>if</b> (<span class="r492 r">path</span>.<span class="i">EndsWith</span>(<span class="r491 r">hostname</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r499 r">currentPluginName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                        {
                                            <span class="r493 r">result</span> = <span class="r499 r">currentPluginName</span>;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                <b>else</b>
                {
                    <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">StartsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <b>string</b>.<span class="i">Concat</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="s">&quot;_&quot;</span>, <span class="r490 r">ChildName</span>.<span class="i">AsSpan</span>(<span class="r490 r">ChildName</span>.<span class="i">IndexOf</span>(<span class="s">&#39;_&#39;</span>) + 1));
                    <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">StartsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#039e73f615517a0d" class="i field">containerSingleResource</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <b>string</b>.<span class="i">Concat</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#039e73f615517a0d" class="i field">containerSingleResource</a>, <span class="s">&quot;_&quot;</span>, <span class="r490 r">ChildName</span>.<span class="i">AsSpan</span>(<span class="r490 r">ChildName</span>.<span class="i">IndexOf</span>(<span class="s">&#39;_&#39;</span>) + 1));
                    <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">StartsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <b>string</b>.<span class="i">Concat</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="s">&quot;_&quot;</span>, <span class="r490 r">ChildName</span>.<span class="i">AsSpan</span>(<span class="r490 r">ChildName</span>.<span class="i">IndexOf</span>(<span class="s">&#39;_&#39;</span>) + 1));
                    <b>if</b> (<span class="r490 r">ChildName</span>.<span class="i">StartsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        <span class="r493 r">result</span> = <b>string</b>.<span class="i">Concat</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="s">&quot;_&quot;</span>, <span class="r490 r">ChildName</span>.<span class="i">AsSpan</span>(<span class="r490 r">ChildName</span>.<span class="i">IndexOf</span>(<span class="s">&#39;_&#39;</span>) + 1));
                }
            }
 
            <b>return</b> <span class="r493 r">result</span>;
        }
 
        <b>private static</b> <span class="i">ArrayList</span> <a id="25d232d631150741" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RemoveItemfromResourceArray</a>(<span class="i">ArrayList</span> <span id="r500 rd" class="r500 r">resourceArray</span>, <b>string</b> <span id="r501 rd" class="r501 r">ChildName</span>, <b>string</b> <span id="r502 rd" class="r502 r">type</span>, <b>string</b> <span id="r503 rd" class="r503 r">property</span>)
        {
            <b>if</b> (<span class="r500 r">resourceArray</span> != <b>null</b>)
            {
                <b>bool</b> <span id="r504 rd" class="r504 r">itemfound</span> = <b>false</b>;
                <b>int</b> <span id="r505 rd" class="r505 r">index</span> = 0;
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r506 rd" class="r506 r">obj</span> <b>in</b> <span class="r500 r">resourceArray</span>)
                {
                    <b>if</b> (<span class="r502 r">type</span>.<span class="i">Equals</span>(<span class="s">&quot;InitParams&quot;</span>))
                    {
                        <b>if</b> (<span class="r506 r">obj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Match</span>(<span class="r501 r">ChildName</span>).<a href="/System.Management.Automation/A.html#4fcb958a2e493168" class="i property">Count</a> &gt; 0)
                        {
                            <span class="r504 r">itemfound</span> = <b>true</b>;
                            <b>break</b>;
                        }
                    }
                    <b>else</b>
                    {
                        <b>if</b> (<span class="r506 r">obj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r503 r">property</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<span class="r501 r">ChildName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="r504 r">itemfound</span> = <b>true</b>;
                            <b>break</b>;
                        }
                    }
 
                    <span class="r505 r">index</span>++;
                }
 
                <b>if</b> (<span class="r504 r">itemfound</span>)
                    <span class="r500 r">resourceArray</span>.<span class="i">RemoveAt</span>(<span class="r505 r">index</span>);
            }
 
            <b>return</b> <span class="r500 r">resourceArray</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get Child Items of Listener and Client Certificate. Used by Getchilditem or getchildname.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r507 r">xmlResource</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r508 r">ListenerOrCerMapping</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r509 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r510 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r511 r">methodname</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r512 r">recurse</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="fbdd0d54b24a2f96" href="R/fbdd0d54b24a2f96.html" target="n" data-glyph="76,1" class="i method">GetChildItemOrNamesForListenerOrCertMapping</a>(<span class="i">XmlDocument</span> <span id="r507 rd" class="r507 r">xmlResource</span>, <b>string</b> <span id="r508 rd" class="r508 r">ListenerOrCerMapping</span>, <b>string</b> <span id="r509 rd" class="r509 r">path</span>, <b>string</b> <span id="r510 rd" class="r510 r">host</span>, <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a> <span id="r511 rd" class="r511 r">methodname</span>, <b>bool</b> <span id="r512 rd" class="r512 r">recurse</span>)
        {
            <span class="i">Hashtable</span> <span id="r513 rd" class="r513 r">Objcache</span>, <span id="r514 rd" class="r514 r">Keyscache</span>;
            <b>string</b> <span id="r515 rd" class="r515 r">PathEnd</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<span class="r508 r">ListenerOrCerMapping</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>))
            {
                <a href="#01a3c58ac8787b59" class="i method">ProcessCertMappingObjects</a>(<span class="r507 r">xmlResource</span>, <b>out</b> <span class="r513 r">Objcache</span>, <b>out</b> <span class="r514 r">Keyscache</span>);
            }
            <b>else</b> <b>if</b> (<span class="r508 r">ListenerOrCerMapping</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>))
            {
                <a href="#52d9ca2566594c0d" class="i method">ProcessListenerObjects</a>(<span class="r507 r">xmlResource</span>, <b>out</b> <span class="r513 r">Objcache</span>, <b>out</b> <span class="r514 r">Keyscache</span>);
            }
            <b>else</b>
            { <b>return</b>; }
 
            <b>if</b> (<span class="r513 r">Objcache</span> == <b>null</b> || <span class="r514 r">Keyscache</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r509 r">path</span>.<span class="i">EndsWith</span>(<span class="r510 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r508 r">ListenerOrCerMapping</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>foreach</b> (<b>string</b> <span id="r516 rd" class="r516 r">key</span> <b>in</b> <span class="r514 r">Keyscache</span>.<span class="i">Keys</span>)
                {
                    <b>switch</b> (<span class="r511 r">methodname</span>)
                    {
                        <span class="c">// Get the items at Config level</span>
                        <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>:
                            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r517 rd" class="r517 r">obj</span> = <b>new</b> <span class="t">PSObject</span>();
                            <span class="r517 r">obj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r516 r">key</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>));
                            <a href="#ae95a8329bd8f9ae" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>(<span class="r517 r">obj</span>, <span class="r509 r">path</span>, (<b>string</b>[])<span class="r514 r">Keyscache</span>[<span class="r516 r">key</span>], <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>, <span class="r512 r">recurse</span>);
                            <span class="c">// WriteItemObject(new WSManConfigContainerElement(key, WSManStringLiterals.ContainerChildValue, (string[])Keyscache[key]), path, true);</span>
                            <b>break</b>;
                        <span class="c">// Get the names of container at config level</span>
                        <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>:
                            <span class="i">WriteItemObject</span>(<span class="r516 r">key</span>, <span class="r509 r">path</span>, <b>true</b>);
                            <b>break</b>;
                    }
                }
 
                <b>return</b>;
            }
            <b>else</b>
            {
                <b>string</b> <span id="r518 rd" class="r518 r">item</span> = <span class="r509 r">path</span>.<span class="i">Substring</span>(<span class="r509 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1);
                <b>if</b> (<span class="r511 r">methodname</span>.<span class="i">Equals</span>(<a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>))
                {
                    <a href="#ae95a8329bd8f9ae" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>((<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r513 r">Objcache</span>[<span class="r518 r">item</span>], <span class="r509 r">path</span>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>, <span class="r512 r">recurse</span>);
                }
                <b>else</b> <b>if</b> (<span class="r511 r">methodname</span>.<span class="i">Equals</span>(<a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>))
                {
                    <b>foreach</b> (<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r519 rd" class="r519 r">prop</span> <b>in</b> ((<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r513 r">Objcache</span>[<span class="r518 r">item</span>]).<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>)
                    {
                        <span class="i">WriteItemObject</span>(<span class="r519 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r509 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r519 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <b>false</b>);
                    }
                }
 
                <b>return</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a Listener or ClientCertificate Item. Used by GEt-Item.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r520 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r521 r">xmlResource</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r522 r">ContainerListenerOrClientCert</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r523 r">childname</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r524 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="f96dda287a4b2b55" href="R/f96dda287a4b2b55.html" target="n" data-glyph="76,1" class="i method">GetItemListenerOrCertMapping</a>(<b>string</b> <span id="r520 rd" class="r520 r">path</span>, <span class="i">XmlDocument</span> <span id="r521 rd" class="r521 r">xmlResource</span>, <b>string</b> <span id="r522 rd" class="r522 r">ContainerListenerOrClientCert</span>, <b>string</b> <span id="r523 rd" class="r523 r">childname</span>, <b>string</b> <span id="r524 rd" class="r524 r">host</span>)
        {
            <span class="i">Hashtable</span> <span id="r525 rd" class="r525 r">Objcache</span>, <span id="r526 rd" class="r526 r">Keyscache</span>;
            <b>if</b> (<span class="r522 r">ContainerListenerOrClientCert</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#52d9ca2566594c0d" class="i method">ProcessListenerObjects</a>(<span class="r521 r">xmlResource</span>, <b>out</b> <span class="r525 r">Objcache</span>, <b>out</b> <span class="r526 r">Keyscache</span>);
            }
            <b>else</b> <b>if</b> (<span class="r522 r">ContainerListenerOrClientCert</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#01a3c58ac8787b59" class="i method">ProcessCertMappingObjects</a>(<span class="r521 r">xmlResource</span>, <b>out</b> <span class="r525 r">Objcache</span>, <b>out</b> <span class="r526 r">Keyscache</span>);
            }
            <b>else</b>
            { <b>return</b>; }
 
            <b>if</b> (<span class="r525 r">Objcache</span> == <b>null</b> || <span class="r526 r">Keyscache</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r520 r">path</span>.<span class="i">EndsWith</span>(<span class="r524 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r522 r">ContainerListenerOrClientCert</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<span class="r525 r">Objcache</span>.<span class="i">ContainsKey</span>(<span class="r523 r">childname</span>))
                    <span class="i">WriteItemObject</span>(<a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(<span class="r523 r">childname</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>, <b>null</b>, (<b>string</b>[])<span class="r526 r">Keyscache</span>[<span class="r523 r">childname</span>], <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>), <span class="r520 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r523 r">childname</span>, <b>true</b>);
            }
            <b>else</b>
            {
                <b>string</b> <span id="r527 rd" class="r527 r">item</span> = <span class="r520 r">path</span>.<span class="i">Substring</span>(<span class="r520 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1);
                <b>try</b>
                {
                    <span class="i">WriteItemObject</span>(<a href="#77348a332c6e9102" class="i method">GetItemPSObjectWithTypeName</a>(((<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r525 r">Objcache</span>[<span class="r527 r">item</span>]).<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r523 r">childname</span>].<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, ((<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r525 r">Objcache</span>[<span class="r527 r">item</span>]).<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r523 r">childname</span>].<a href="/System.Management.Automation/A.html#af662506826a4d3d" class="i property">TypeNameOfValue</a>, ((<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r525 r">Objcache</span>[<span class="r527 r">item</span>]).<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r523 r">childname</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>), <span class="r520 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r523 r">childname</span>, <b>false</b>);
                }
                <b>catch</b> (<a href="/System.Management.Automation/A.html#581bd9b947689819" class="t t">PSArgumentException</a>) { <b>return</b>; }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes a Listener or ClientCertificate object. Used by Remove-Item cmdlets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r528 r">sessionobj</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r529 r">WsManUri</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r530 r">childname</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r531 r">primarykeys</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r532 r">IsListener</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="040bc358686b3352" href="R/040bc358686b3352.html" target="n" data-glyph="76,1" class="i method">RemoveListenerOrCertMapping</a>(<b>object</b> <span id="r528 rd" class="r528 r">sessionobj</span>, <b>string</b> <span id="r529 rd" class="r529 r">WsManUri</span>, <b>string</b> <span id="r530 rd" class="r530 r">childname</span>, <b>string</b>[] <span id="r531 rd" class="r531 r">primarykeys</span>, <b>bool</b> <span id="r532 rd" class="r532 r">IsListener</span>)
        {
            <span class="i">XmlDocument</span> <span id="r533 rd" class="r533 r">xmlresources</span> = <a href="#be8ef6f2909993fb" class="i method">EnumerateResourceValue</a>(<span class="r528 r">sessionobj</span>, <span class="r529 r">WsManUri</span>);
 
            <b>if</b> (<span class="r533 r">xmlresources</span> != <b>null</b>)
            {
                <span class="i">Hashtable</span> <span id="r534 rd" class="r534 r">KeysCache</span>, <span id="r535 rd" class="r535 r">ResourcesCache</span>;
                <b>if</b> (!<span class="r532 r">IsListener</span>)
                {
                    <a href="#01a3c58ac8787b59" class="i method">ProcessCertMappingObjects</a>(<span class="r533 r">xmlresources</span>, <b>out</b> <span class="r535 r">ResourcesCache</span>, <b>out</b> <span class="r534 r">KeysCache</span>);
                }
                <b>else</b>
                {
                    <a href="#52d9ca2566594c0d" class="i method">ProcessListenerObjects</a>(<span class="r533 r">xmlresources</span>, <b>out</b> <span class="r535 r">ResourcesCache</span>, <b>out</b> <span class="r534 r">KeysCache</span>);
                }
 
                <b>if</b> (<span class="r534 r">KeysCache</span>.<span class="i">Contains</span>(<span class="r530 r">childname</span>))
                {
                    <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r536 rd" class="r536 r">objResource</span> = (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r535 r">ResourcesCache</span>[<span class="r530 r">childname</span>];
                    <span class="i">Hashtable</span> <span id="r537 rd" class="r537 r">SelectorParams</span> = <b>new</b> <span class="i">Hashtable</span>();
                    <b>foreach</b> (<b>string</b> <span id="r538 rd" class="r538 r">pKey</span> <b>in</b> <span class="r531 r">primarykeys</span>)
                    {
                        <span class="r537 r">SelectorParams</span>.<span class="i">Add</span>(<span class="r538 r">pKey</span>, <span class="r536 r">objResource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="r538 r">pKey</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>);
                    }
 
                    <a href="#f1eb7a45c19a542e" class="i method">DeleteResourceValue</a>(<span class="r528 r">sessionobj</span>, <span class="r529 r">WsManUri</span>, <span class="r537 r">SelectorParams</span>, <b>false</b>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used By ItemExists, HasChildItem,IsValidPath, IsItemContainer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r539 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="08196698077b587f" href="R/08196698077b587f.html" target="n" data-glyph="76,1" class="i method">CheckValidContainerOrPath</a>(<b>string</b> <span id="r539 rd" class="r539 r">path</span>)
        {
            <b>if</b> (<span class="r539 r">path</span>.<span class="i">Length</span> == 0)
            {
                <b>return</b> <b>true</b>;
            }
            <span class="c">// if endswith &#39;\&#39;, removes it.</span>
 
            <b>if</b> (<span class="r539 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <span class="r539 r">path</span> = <span class="r539 r">path</span>.<span class="i">Remove</span>(<span class="r539 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
 
            <b>string</b> <span id="r540 rd" class="r540 r">ChildName</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>string</b> <span id="r541 rd" class="r541 r">strpathChk</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<span class="r539 r">path</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>()))
            {
                <span class="r540 r">ChildName</span> = <span class="r539 r">path</span>.<span class="i">Substring</span>(<span class="r539 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1);
            }
            <b>else</b>
            {
                <span class="r540 r">ChildName</span> = <span class="r539 r">path</span>;
            }
 
            <span class="c">// Get the wsman host name to find the session object</span>
            <b>string</b> <span id="r542 rd" class="r542 r">host</span> = <a href="#660b53b524868f2c" class="i method">GetHostName</a>(<span class="r539 r">path</span>);
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r542 r">host</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// Chks the WinRM Service</span>
            <b>if</b> (<a href="#f48e279095b5a8c1" class="i method">IsPathLocalMachine</a>(<span class="r542 r">host</span>))
            {
                <b>if</b> (!<a href="#049952faaf766e5b" class="i method">IsWSManServiceRunning</a>())
                {
                    <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#e53fd23e593153ef" class="i method">ThrowIfNotAdministrator</a>();
                    <a href="#76311111d1d2f1b2" class="i method">StartWSManService</a>(<a href="/System.Management.Automation/A.html#e3c4d51f13fbfcaa" class="i property">Force</a>);
                }
            }
 
            <span class="c">// Get URI to pass to WsMan Automation API</span>
            <b>string</b> <span id="r543 rd" class="r543 r">uri</span> = <a href="#103267db7d6cc518" class="i method">NormalizePath</a>(<span class="r539 r">path</span>, <span class="r542 r">host</span>);
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r543 r">uri</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>lock</b> (<a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2a23b1e8c34cc740" class="i field">AutoSession</a>)
            {
                <b>object</b> <span id="r544 rd" class="r544 r">sessionobj</span> = <b>null</b>;
                <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r545 rd" class="r545 r">SessionObjCache</span> = <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2b29be8459e983a7" class="i method">GetSessionObjCache</a>();
                <span class="r545 r">SessionObjCache</span>.<span class="i">TryGetValue</span>(<span class="r542 r">host</span>, <b>out</b> <span class="r544 r">sessionobj</span>);
 
                <span class="r541 r">strpathChk</span> = <span class="r542 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                <span class="c">// Check for host path</span>
                <b>if</b> (<span class="r539 r">path</span>.<span class="i">Equals</span>(<span class="r542 r">host</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <b>true</b>;
                }
 
                <b>if</b> (<span class="r539 r">path</span>.<span class="i">StartsWith</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="c">// Check for Plugin path</span>
                    <b>if</b> (<span class="r539 r">path</span>.<span class="i">Equals</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <span class="i">XmlDocument</span> <span id="r546 rd" class="r546 r">outxml</span> = <a href="#14c3c20542e6ba32" class="i method">FindResourceValue</a>(<span class="r544 r">sessionobj</span>, <span class="r543 r">uri</span>, <b>null</b>);
                    <b>string</b> <span id="r547 rd" class="r547 r">currentpluginname</span> = <b>string</b>.<span class="i">Empty</span>;
                    <a href="#652b1bae7a230230" class="i method">GetPluginNames</a>(<span class="r546 r">outxml</span>, <b>out</b> <a href="#7be9fa29345270fd" class="i field">objPluginNames</a>, <b>out</b> <span class="r547 r">currentpluginname</span>, <span class="r539 r">path</span>);
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r547 r">currentpluginname</span>))
                    {
                        <b>return</b> <b>false</b>;
                    }
 
                    <b>string</b> <span id="r548 rd" class="r548 r">filter</span> = <span class="r543 r">uri</span> + <span class="s">&quot;?Name=&quot;</span> + <span class="r547 r">currentpluginname</span>;
                    <span class="i">XmlDocument</span> <span id="r549 rd" class="r549 r">CurrentPluginXML</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r544 r">sessionobj</span>, <span class="r548 r">filter</span>, <b>null</b>);
                    <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r550 rd" class="r550 r">mshPluginLvl</span> = <a href="#d773ffd607e22121" class="i method">ProcessPluginConfigurationLevel</a>(<span class="r549 r">CurrentPluginXML</span>);
                    <span class="i">ArrayList</span> <span id="r551 rd" class="r551 r">arrSecurities</span> = <b>null</b>;
                    <span class="i">ArrayList</span> <span id="r552 rd" class="r552 r">arrResources</span> = <a href="#9fc4301cb03b79b7" class="i method">ProcessPluginResourceLevel</a>(<span class="r549 r">CurrentPluginXML</span>, <b>out</b> <span class="r551 r">arrSecurities</span>);
                    <span class="i">ArrayList</span> <span id="r553 rd" class="r553 r">arrInitParams</span> = <a href="#0f58ba5254c3d7ba" class="i method">ProcessPluginInitParamLevel</a>(<span class="r549 r">CurrentPluginXML</span>);
                    <span class="r541 r">strpathChk</span> = <span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r547 r">currentpluginname</span>;
                    <b>if</b> (<span class="r539 r">path</span>.<span class="i">Equals</span>(<span class="r541 r">strpathChk</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <b>if</b> (<span class="r539 r">path</span>.<span class="i">StartsWith</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
 
                    <b>if</b> (<span class="r539 r">path</span>.<span class="i">StartsWith</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>if</b> (<span class="r539 r">path</span>.<span class="i">Equals</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>return</b> <b>true</b>;
                        }
 
                        <b>if</b> (<span class="r552 r">arrResources</span> != <b>null</b>)
                        {
                            <span class="r541 r">strpathChk</span> = <span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>;
                            <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r554 rd" class="r554 r">objresource</span> <b>in</b> <span class="r552 r">arrResources</span>)
                            {
                                <b>string</b> <span id="r555 rd" class="r555 r">sResourceDirName</span> = <span class="r554 r">objresource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                                <b>if</b> (<span class="r539 r">path</span>.<span class="i">StartsWith</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r555 r">sResourceDirName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <b>if</b> (<span class="r539 r">path</span>.<span class="i">Equals</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r555 r">sResourceDirName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <b>return</b> <b>true</b>;
                                    }
                                    <b>else</b>
                                    {
                                        <b>if</b> (<span class="r554 r">objresource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Match</span>(<span class="r540 r">ChildName</span>).<a href="/System.Management.Automation/A.html#4fcb958a2e493168" class="i property">Count</a> &gt; 0)
                                        {
                                            <b>return</b> <b>true</b>;
                                        }
                                    }
 
                                    <b>if</b> (<span class="r539 r">path</span>.<span class="i">StartsWith</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r555 r">sResourceDirName</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <b>if</b> (<span class="r539 r">path</span>.<span class="i">Equals</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r555 r">sResourceDirName</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                        {
                                            <b>return</b> <b>true</b>;
                                        }
 
                                        <span class="r541 r">strpathChk</span> = <span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r555 r">sResourceDirName</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                                        <b>if</b> (<span class="r551 r">arrSecurities</span> == <b>null</b>)
                                        {
                                            <b>return</b> <b>false</b>;
                                        }
 
                                        <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r556 rd" class="r556 r">security</span> <b>in</b> <span class="r551 r">arrSecurities</span>)
                                        {
                                            <b>string</b> <span id="r557 rd" class="r557 r">sSecurity</span> = <span class="r556 r">security</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;SecurityDIR&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
 
                                            <b>if</b> (<span class="r539 r">path</span>.<span class="i">Equals</span>(<span class="r541 r">strpathChk</span> + <span class="r557 r">sSecurity</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                            {
                                                <b>return</b> <b>true</b>;
                                            }
                                            <b>else</b>
                                            {
                                                <b>if</b> (<span class="r556 r">security</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Match</span>(<span class="r540 r">ChildName</span>).<a href="/System.Management.Automation/A.html#4fcb958a2e493168" class="i property">Count</a> &gt; 0)
                                                {
                                                    <b>return</b> <b>true</b>;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                    <b>else</b> <b>if</b> (<span class="r539 r">path</span>.<span class="i">StartsWith</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>if</b> (<span class="r539 r">path</span>.<span class="i">Equals</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>return</b> <b>true</b>;
                        }
                        <b>else</b>
                        {
                            <b>if</b> (<span class="r553 r">arrInitParams</span> != <b>null</b>)
                            {
                                <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r558 rd" class="r558 r">obj</span> <b>in</b> <span class="r553 r">arrInitParams</span>)
                                {
                                    <b>if</b> (<span class="r558 r">obj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Match</span>(<span class="r540 r">ChildName</span>).<a href="/System.Management.Automation/A.html#4fcb958a2e493168" class="i property">Count</a> &gt; 0)
                                    {
                                        <b>return</b> <b>true</b>;
                                    }
                                }
                            }
                        }
                    }
                    <b>else</b>
                    {
                        <b>if</b> (<span class="r550 r">mshPluginLvl</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Match</span>(<span class="r540 r">ChildName</span>).<a href="/System.Management.Automation/A.html#4fcb958a2e493168" class="i property">Count</a> &gt; 0)
                        {
                            <b>return</b> <b>true</b>;
                        }
                    }
                }
                <b>else</b> <b>if</b> (<span class="r539 r">path</span>.<span class="i">StartsWith</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <a href="#9198a639d6580bf8" class="i method">ItemExistListenerOrClientCertificate</a>(<span class="r544 r">sessionobj</span>, <span class="r543 r">uri</span>, <span class="r539 r">path</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="r542 r">host</span>);
                }
                <b>else</b> <b>if</b> (<span class="r539 r">path</span>.<span class="i">StartsWith</span>(<span class="r541 r">strpathChk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <a href="#9198a639d6580bf8" class="i method">ItemExistListenerOrClientCertificate</a>(<span class="r544 r">sessionobj</span>, <span class="r543 r">uri</span>, <span class="r539 r">path</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="r542 r">host</span>);
                }
                <b>else</b>
                {
                    <b>return</b> (<a href="#e9bf3f91323e9ae6" class="i method">ContainResourceValue</a>(<span class="r544 r">sessionobj</span>, <span class="r543 r">uri</span>, <span class="r540 r">ChildName</span>, <span class="r539 r">path</span>, <span class="r542 r">host</span>));
                }
 
                <b>return</b> <b>false</b>;
            }
        }
 
        <b>private bool</b> <a id="9198a639d6580bf8" href="R/9198a639d6580bf8.html" target="n" data-glyph="76,1" class="i method">ItemExistListenerOrClientCertificate</a>(<b>object</b> <span id="r559 rd" class="r559 r">sessionobj</span>, <b>string</b> <span id="r560 rd" class="r560 r">ResourceURI</span>, <b>string</b> <span id="r561 rd" class="r561 r">path</span>, <b>string</b> <span id="r562 rd" class="r562 r">parentListenerOrCert</span>, <b>string</b> <span id="r563 rd" class="r563 r">host</span>)
        {
            <span class="i">XmlDocument</span> <span id="r564 rd" class="r564 r">outxml</span> = <a href="#be8ef6f2909993fb" class="i method">EnumerateResourceValue</a>(<span class="r559 r">sessionobj</span>, <span class="r560 r">ResourceURI</span>);
            <b>if</b> (<span class="r561 r">path</span>.<span class="i">Equals</span>(<span class="r563 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r562 r">parentListenerOrCert</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r564 r">outxml</span> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="i">Hashtable</span> <span id="r565 rd" class="r565 r">KeysCache</span> = <b>null</b>, <span id="r566 rd" class="r566 r">objcache</span> = <b>null</b>;
            <b>if</b> (<span class="r562 r">parentListenerOrCert</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#01a3c58ac8787b59" class="i method">ProcessCertMappingObjects</a>(<span class="r564 r">outxml</span>, <b>out</b> <span class="r566 r">objcache</span>, <b>out</b> <span class="r565 r">KeysCache</span>);
            }
            <b>else</b>
            {
                <a href="#52d9ca2566594c0d" class="i method">ProcessListenerObjects</a>(<span class="r564 r">outxml</span>, <b>out</b> <span class="r566 r">objcache</span>, <b>out</b> <span class="r565 r">KeysCache</span>);
            }
 
            <b>string</b> <span id="r567 rd" class="r567 r">PathChecked</span> = <span class="r563 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r562 r">parentListenerOrCert</span>;
            <b>int</b> <span id="r568 rd" class="r568 r">pos</span> = <span class="r567 r">PathChecked</span>.<span class="i">Length</span> + 1;
            <b>string</b> <span id="r569 rd" class="r569 r">RemainingPath</span> = <span class="r561 r">path</span>.<span class="i">Substring</span>(<span class="r568 r">pos</span>);
            <b>string</b> <span id="r570 rd" class="r570 r">CurrentNode</span> = <b>null</b>;
            <span class="r568 r">pos</span> = <span class="r569 r">RemainingPath</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>);
            <b>if</b> (<span class="r568 r">pos</span> == -1)
            {
                <span class="r570 r">CurrentNode</span> = <span class="r569 r">RemainingPath</span>;
            }
            <b>else</b>
            {
                <span class="r570 r">CurrentNode</span> = <span class="r569 r">RemainingPath</span>.<span class="i">Substring</span>(0, <span class="r568 r">pos</span>);
            }
 
            <b>if</b> (!<span class="r566 r">objcache</span>.<span class="i">Contains</span>(<span class="r570 r">CurrentNode</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<span class="r568 r">pos</span> == -1)
            {
                <span class="c">// means the path was only till the CurrentNode. Nothing ahead</span>
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// Get the object cache from the listener object</span>
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r571 rd" class="r571 r">obj</span> = (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>)<span class="r566 r">objcache</span>[<span class="r570 r">CurrentNode</span>];
 
            <span class="r570 r">CurrentNode</span> = <span class="r569 r">RemainingPath</span>.<span class="i">Substring</span>(<span class="r568 r">pos</span> + 1);
            <b>if</b> (<span class="r570 r">CurrentNode</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>))
            {
                <span class="c">// No more directories allowed after listeners objects</span>
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<span class="r571 r">obj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Match</span>(<span class="r570 r">CurrentNode</span>).<a href="/System.Management.Automation/A.html#4fcb958a2e493168" class="i property">Count</a> &gt; 0)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For the recurse operation of Get-ChildItems.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r572 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r573 r">childname</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r574 r">methodname</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r575 r">recurse</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="670366064ee48c8b" href="R/670366064ee48c8b.html" target="n" data-glyph="76,1" class="i method">GetChildItemsRecurse</a>(<b>string</b> <span id="r572 rd" class="r572 r">path</span>, <b>string</b> <span id="r573 rd" class="r573 r">childname</span>, <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a> <span id="r574 rd" class="r574 r">methodname</span>, <b>bool</b> <span id="r575 rd" class="r575 r">recurse</span>)
        {
            <b>if</b> (<span class="r572 r">path</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ff28b0893dfbf7d2" class="i field">rootpath</a>))
            {
                <span class="r572 r">path</span> = <span class="r573 r">childname</span>;
            }
            <b>else</b>
            {
                <span class="r572 r">path</span> = <span class="r572 r">path</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r573 r">childname</span>;
            }
 
            <b>if</b> (<a href="#4ccc6387ffab120b" class="i method">HasChildItems</a>(<span class="r572 r">path</span>))
            {
                <a href="#ed74ecb1ed9b455b" class="i method">GetChildItemsOrNames</a>(<span class="r572 r">path</span>, <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>, <span class="r575 r">recurse</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the child items or Names. Used by GetChildItems and GetChildNames.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r576 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r577 r">methodname</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r578 r">recurse</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Maintainability&quot;</span>, <span class="s">&quot;CA1505:AvoidUnmaintainableCode&quot;</span>)]
        <b>private void</b> <a id="ed74ecb1ed9b455b" href="R/ed74ecb1ed9b455b.html" target="n" data-glyph="76,1" class="i method">GetChildItemsOrNames</a>(<b>string</b> <span id="r576 rd" class="r576 r">path</span>, <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a> <span id="r577 rd" class="r577 r">methodname</span>, <b>bool</b> <span id="r578 rd" class="r578 r">recurse</span>)
        {
            <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r579 rd" class="r579 r">SessionObjCache</span> = <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2b29be8459e983a7" class="i method">GetSessionObjCache</a>();
            <b>if</b> (<span class="r576 r">path</span>.<span class="i">Length</span> == 0)
            {
                <b>switch</b> (<span class="r577 r">methodname</span>)
                {
                    <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>:
                        <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r580 rd" class="r580 r">obj</span> = <span class="i">BuildHostLevelPSObjectArrayList</span>(<b>null</b>, <b>string</b>.<span class="i">Empty</span>, <b>true</b>);
                        <a href="#ae95a8329bd8f9ae" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>(<span class="r580 r">obj</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ff28b0893dfbf7d2" class="i field">rootpath</a>, <b>null</b>,
                            <span class="s">&quot;ComputerLevel&quot;</span>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>, <span class="r578 r">recurse</span>);
                        <b>break</b>;
                    <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>:
                        <b>foreach</b> (<b>string</b> <span id="r581 rd" class="r581 r">hostname</span> <b>in</b> <span class="r579 r">SessionObjCache</span>.<span class="i">Keys</span>)
                        {
                            <span class="i">WriteItemObject</span>(<span class="r581 r">hostname</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ff28b0893dfbf7d2" class="i field">rootpath</a>, <b>true</b>);
                        }
 
                        <b>break</b>;
                }
 
                <b>return</b>;
            }
 
            <span class="c">// if endswith &#39;\&#39;, removes it.</span>
            <b>if</b> (<span class="r576 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r576 r">path</span> = <span class="r576 r">path</span>.<span class="i">Remove</span>(<span class="r576 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>));
            }
 
            <span class="c">// Get the wsman host name to find the session object</span>
            <b>string</b> <span id="r582 rd" class="r582 r">host</span> = <a href="#660b53b524868f2c" class="i method">GetHostName</a>(<span class="r576 r">path</span>);
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r582 r">host</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="s">&quot;InvalidPath&quot;</span>);
            }
 
            <span class="c">// Checks the WinRM Service</span>
            <b>if</b> (<a href="#f48e279095b5a8c1" class="i method">IsPathLocalMachine</a>(<span class="r582 r">host</span>))
            {
                <b>if</b> (!<a href="#049952faaf766e5b" class="i method">IsWSManServiceRunning</a>())
                {
                    <b>if</b> (<span class="r577 r">methodname</span>.<span class="i">Equals</span>(<a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>))
                    {
                        <a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#e53fd23e593153ef" class="i method">ThrowIfNotAdministrator</a>();
                        <a href="#76311111d1d2f1b2" class="i method">StartWSManService</a>(<a href="/System.Management.Automation/A.html#e3c4d51f13fbfcaa" class="i property">Force</a>);
                    }
                    <b>else</b> <b>if</b> (<span class="r577 r">methodname</span>.<span class="i">Equals</span>(<a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>))
                    {
                        <a href="#014253583d795bc0" class="i method">AssertError</a>(<span class="s">&quot;WinRMServiceError&quot;</span>, <b>false</b>);
                    }
                }
            }
 
            <b>lock</b> (<a href="WsManHelper.cs.html#40dbcbafdcf163ba" class="t t">WSManHelper</a>.<a href="WsManHelper.cs.html#2a23b1e8c34cc740" class="i field">AutoSession</a>)
            {
                <b>object</b> <span id="r583 rd" class="r583 r">sessionobj</span>;
                <span class="c">// gets the sessionobject</span>
                <span class="r579 r">SessionObjCache</span>.<span class="i">TryGetValue</span>(<span class="r582 r">host</span>, <b>out</b> <span class="r583 r">sessionobj</span>);
 
                <span class="c">// Normalize to the required uri</span>
                <b>string</b> <span id="r584 rd" class="r584 r">uri</span> = <a href="#103267db7d6cc518" class="i method">NormalizePath</a>(<span class="r576 r">path</span>, <span class="r582 r">host</span>);
 
                <b>string</b> <span id="r585 rd" class="r585 r">strPathchk</span> = <span class="r582 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
 
                <b>if</b> (<span class="r576 r">path</span>.<span class="i">EndsWith</span>(<span class="r582 r">host</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r586 rd" class="r586 r">obj</span> = <a href="#95ab8fd9493f109a" class="i method">BuildHostLevelPSObjectArrayList</a>(<span class="r583 r">sessionobj</span>, <span class="r584 r">uri</span>, <b>false</b>);
                    <b>switch</b> (<span class="r577 r">methodname</span>)
                    {
                        <span class="c">// Get the items at Config level</span>
                        <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>:
                            <a href="#ae95a8329bd8f9ae" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>(<span class="r586 r">obj</span>, <span class="r576 r">path</span>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>, <span class="r578 r">recurse</span>);
                            <b>break</b>;
                        <span class="c">// Get the names of container at config level</span>
                        <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>:
                            <a href="#ba7862ec455391bf" class="i method">WritePSObjectPropertyNames</a>(<span class="r586 r">obj</span>, <span class="r576 r">path</span>);
                            <b>break</b>;
                    }
 
                    <b>return</b>;
                }
 
                <span class="i">XmlDocument</span> <span id="r587 rd" class="r587 r">outxml</span> = <a href="#14c3c20542e6ba32" class="i method">FindResourceValue</a>(<span class="r583 r">sessionobj</span>, <span class="r584 r">uri</span>, <b>null</b>);
                <b>if</b> (<span class="r587 r">outxml</span> == <b>null</b> || !<span class="r587 r">outxml</span>.<span class="i">HasChildNodes</span>)
                {
                    <b>return</b>;
                }
 
                <b>if</b> (<span class="r576 r">path</span>.<span class="i">Contains</span>(<span class="r585 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>))
                {
                    <a href="#fbdd0d54b24a2f96" class="i method">GetChildItemOrNamesForListenerOrCertMapping</a>(<span class="r587 r">outxml</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <span class="r576 r">path</span>, <span class="r582 r">host</span>, <span class="r577 r">methodname</span>, <span class="r578 r">recurse</span>);
                }
                <b>else</b> <b>if</b> (<span class="r576 r">path</span>.<span class="i">Contains</span>(<span class="r585 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>))
                {
                    <a href="#fbdd0d54b24a2f96" class="i method">GetChildItemOrNamesForListenerOrCertMapping</a>(<span class="r587 r">outxml</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <span class="r576 r">path</span>, <span class="r582 r">host</span>, <span class="r577 r">methodname</span>, <span class="r578 r">recurse</span>);
                }
                <b>else</b> <b>if</b> (<span class="r576 r">path</span>.<span class="i">Contains</span>(<span class="r585 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>))
                {
                    <b>string</b> <span id="r588 rd" class="r588 r">currentpluginname</span> = <b>string</b>.<span class="i">Empty</span>;
                    <a href="#652b1bae7a230230" class="i method">GetPluginNames</a>(<span class="r587 r">outxml</span>, <b>out</b> <a href="#7be9fa29345270fd" class="i field">objPluginNames</a>, <b>out</b> <span class="r588 r">currentpluginname</span>, <span class="r576 r">path</span>);
                    <b>if</b> (<span class="r576 r">path</span>.<span class="i">EndsWith</span>(<span class="r585 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>switch</b> (<span class="r577 r">methodname</span>)
                        {
                            <span class="c">// Get the items at Plugin level</span>
                            <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>:
                                <b>foreach</b> (<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r589 rd" class="r589 r">p</span> <b>in</b> <a href="#7be9fa29345270fd" class="i field">objPluginNames</a>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>)
                                {
                                    <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r590 rd" class="r590 r">obj</span> = <b>new</b> <span class="t">PSObject</span>();
                                    <span class="r590 r">obj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r589 r">p</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="r589 r">p</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>));
                                    <a href="#ae95a8329bd8f9ae" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>(<span class="r590 r">obj</span>, <span class="r576 r">path</span>, <b>new</b> <b>string</b>[] { <span class="s">&quot;Name=&quot;</span> + <span class="r589 r">p</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a> }, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>, <span class="r578 r">recurse</span>);
                                    <span class="c">// WriteItemObject(new PSObject(new WSManConfigContainerElement(p.Name, p.Value.ToString(), new string[] { &quot;Name=&quot; + p.Name })), path + WSManStringLiterals.DefaultPathSeparator + p.Name, true);</span>
                                }
 
                                <b>break</b>;
                            <span class="c">// Get the names of container at Plugin level</span>
                            <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>:
                                <a href="#ba7862ec455391bf" class="i method">WritePSObjectPropertyNames</a>(<a href="#7be9fa29345270fd" class="i field">objPluginNames</a>, <span class="r576 r">path</span>);
                                <b>break</b>;
                        }
 
                        <b>return</b>;
                    }
                    <b>else</b>
                    {
                        <b>string</b> <span id="r591 rd" class="r591 r">filter</span> = <span class="r584 r">uri</span> + <span class="s">&quot;?Name=&quot;</span> + <span class="r588 r">currentpluginname</span>;
                        <span class="i">XmlDocument</span> <span id="r592 rd" class="r592 r">CurrentPluginXML</span> = <a href="#53ac510d628943c3" class="i method">GetResourceValue</a>(<span class="r583 r">sessionobj</span>, <span class="r591 r">filter</span>, <b>null</b>);
                        <b>if</b> (<span class="r592 r">CurrentPluginXML</span> == <b>null</b>)
                        {
                            <b>return</b>;
                        }
 
                        <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r593 rd" class="r593 r">objPluginlevel</span> = <a href="#d773ffd607e22121" class="i method">ProcessPluginConfigurationLevel</a>(<span class="r592 r">CurrentPluginXML</span>, <b>true</b>);
                        <span class="i">ArrayList</span> <span id="r594 rd" class="r594 r">arrSecurity</span> = <b>null</b>;
                        <span class="i">ArrayList</span> <span id="r595 rd" class="r595 r">arrResources</span> = <a href="#9fc4301cb03b79b7" class="i method">ProcessPluginResourceLevel</a>(<span class="r592 r">CurrentPluginXML</span>, <b>out</b> <span class="r594 r">arrSecurity</span>);
                        <span class="i">ArrayList</span> <span id="r596 rd" class="r596 r">arrInitParams</span> = <a href="#0f58ba5254c3d7ba" class="i method">ProcessPluginInitParamLevel</a>(<span class="r592 r">CurrentPluginXML</span>);
                        <span class="r585 r">strPathchk</span> = <span class="r585 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                        <b>if</b> (<span class="r576 r">path</span>.<span class="i">EndsWith</span>(<span class="r585 r">strPathchk</span> + <span class="r588 r">currentpluginname</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>switch</b> (<span class="r577 r">methodname</span>)
                            {
                                <span class="c">// Get the items at Plugin level</span>
                                <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>:
                                    <a href="#ae95a8329bd8f9ae" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>(<span class="r593 r">objPluginlevel</span>, <span class="r576 r">path</span>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>, <span class="r578 r">recurse</span>);
                                    <b>break</b>;
                                <span class="c">// Get the names of container at Plugin level</span>
                                <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>:
                                    <a href="#ba7862ec455391bf" class="i method">WritePSObjectPropertyNames</a>(<span class="r593 r">objPluginlevel</span>, <span class="r576 r">path</span>);
                                    <b>break</b>;
                            }
 
                            <b>return</b>;
                        }
                        <b>else</b> <b>if</b> (<span class="r576 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="c">// Get the Quotas element from the config XML.</span>
                            <span class="i">XmlNodeList</span> <span id="r597 rd" class="r597 r">nodeListForQuotas</span> = <span class="r592 r">CurrentPluginXML</span>.<span class="i">GetElementsByTagName</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>);
                            <b>if</b> (<span class="r597 r">nodeListForQuotas</span>.<span class="i">Count</span> &gt; 0)
                            {
                                <span class="i">XmlNode</span> <span id="r598 rd" class="r598 r">pluginQuotas</span> = <span class="r597 r">nodeListForQuotas</span>[0];
                                <b>foreach</b> (<span class="i">XmlAttribute</span> <span id="r599 rd" class="r599 r">attrOfQuotas</span> <b>in</b> <span class="r598 r">pluginQuotas</span>.<span class="i">Attributes</span>)
                                {
                                    <b>string</b> <span id="r600 rd" class="r600 r">pathToAdd</span> =
                                        <b>string</b>.<span class="i">Format</span>(
                                                  <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                                                  <span class="s">&quot;{0}{1}{2}&quot;</span>,
                                                  <span class="r576 r">path</span>,
                                                  <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>,
                                                  <span class="r599 r">attrOfQuotas</span>.<span class="i">Name</span>);
                                    <b>if</b> (<span class="r577 r">methodname</span> == <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>)
                                    {
                                        <span class="i">WriteItemObject</span>(<span class="r599 r">attrOfQuotas</span>.<span class="i">Name</span>, <span class="r600 r">pathToAdd</span>, <b>false</b>);
                                    }
                                    <b>else</b>
                                    {
                                        <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r601 rd" class="r601 r">objectToAdd</span> =
                                        <span class="i">GetItemPSObjectWithTypeName</span>(
                                            <span class="r599 r">attrOfQuotas</span>.<span class="i">Name</span>,
                                            <span class="r599 r">attrOfQuotas</span>.<span class="i">Value</span>.<span class="i">GetType</span>().<span class="i">ToString</span>(),
                                            <span class="r599 r">attrOfQuotas</span>.<span class="i">Value</span>,
                                            <b>null</b>,
                                            <b>null</b>,
                                            <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>);
 
                                        <span class="i">WriteItemObject</span>(<span class="r601 r">objectToAdd</span>, <span class="r600 r">pathToAdd</span>, <b>false</b>);
                                    }
                                }
                            }
                        }
                        <b>else</b> <b>if</b> (<span class="r576 r">path</span>.<span class="i">Contains</span>(<span class="r585 r">strPathchk</span> + <span class="r588 r">currentpluginname</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>))
                        {
                            <span class="r585 r">strPathchk</span> = <span class="r585 r">strPathchk</span> + <span class="r588 r">currentpluginname</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                            <b>if</b> (<span class="r576 r">path</span>.<span class="i">EndsWith</span>(<span class="r585 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <b>if</b> (<span class="r595 r">arrResources</span> != <b>null</b>)
                                {
                                    <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r602 rd" class="r602 r">p</span> <b>in</b> <span class="r595 r">arrResources</span>)
                                    {
                                        <b>switch</b> (<span class="r577 r">methodname</span>)
                                        {
                                            <span class="c">// Get the items at Plugin level</span>
                                            <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>:
                                                <b>string</b>[] <span id="r603 rd" class="r603 r">key</span> = <b>new</b> <b>string</b>[] { <span class="s">&quot;Uri&quot;</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a> + <span class="r602 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceURI&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>() };
                                                <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r604 rd" class="r604 r">obj</span> = <b>new</b> <span class="t">PSObject</span>();
                                                <span class="r604 r">obj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r602 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>));
                                                <a href="#ae95a8329bd8f9ae" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>(<span class="r604 r">obj</span>, <span class="r576 r">path</span>, <span class="r603 r">key</span>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>, <span class="r578 r">recurse</span>);
 
                                                <span class="c">// WriteItemObject(new WSManConfigContainerElement(p.Properties[&quot;ResourceDir&quot;].Value.ToString(), WSManStringLiterals.ContainerChildValue, key), path + WSManStringLiterals.DefaultPathSeparator + p.Properties[&quot;ResourceDir&quot;].Value.ToString(), true);</span>
                                                <b>break</b>;
                                            <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>:
                                                <span class="i">WriteItemObject</span>(<span class="r602 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <span class="r576 r">path</span>, <b>true</b>);
                                                <b>break</b>;
                                        }
                                    }
 
                                    <b>return</b>;
                                }
                            }
 
                            <span class="r585 r">strPathchk</span> = <span class="r585 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6a5b72adecd2a1f0" class="i field">containerResources</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                            <b>int</b> <span id="r605 rd" class="r605 r">Sepindex</span> = <span class="r576 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r585 r">strPathchk</span>.<span class="i">Length</span>);
                            <b>string</b> <span id="r606 rd" class="r606 r">sResourceDirName</span> = <b>string</b>.<span class="i">Empty</span>;
                            <b>if</b> (<span class="r605 r">Sepindex</span> == -1)
                            {
                                <span class="r606 r">sResourceDirName</span> = <span class="r576 r">path</span>.<span class="i">Substring</span>(<span class="r585 r">strPathchk</span>.<span class="i">Length</span>);
                            }
                            <b>else</b>
                            {
                                <span class="r606 r">sResourceDirName</span> = <span class="r576 r">path</span>.<span class="i">Substring</span>(<span class="r585 r">strPathchk</span>.<span class="i">Length</span>, <span class="r576 r">path</span>.<span class="i">IndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>, <span class="r585 r">strPathchk</span>.<span class="i">Length</span>) - (<span class="r585 r">strPathchk</span>.<span class="i">Length</span>));
                            }
 
                            <b>if</b> (<span class="r595 r">arrResources</span> == <b>null</b>)
                            {
                                <b>return</b>;
                            }
 
                            <b>if</b> (<span class="r576 r">path</span>.<span class="i">Contains</span>(<span class="r585 r">strPathchk</span> + <span class="r606 r">sResourceDirName</span>))
                            {
                                <b>if</b> (<span class="r576 r">path</span>.<span class="i">EndsWith</span>(<span class="r585 r">strPathchk</span> + <span class="r606 r">sResourceDirName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r607 rd" class="r607 r">p</span> <b>in</b> <span class="r595 r">arrResources</span>)
                                    {
                                        <b>if</b> (<span class="r606 r">sResourceDirName</span>.<span class="i">Equals</span>(<span class="r607 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>()))
                                        {
                                            <span class="r607 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Remove</span>(<span class="s">&quot;ResourceDir&quot;</span>);
                                            <b>switch</b> (<span class="r577 r">methodname</span>)
                                            {
                                                <span class="c">// Get the items at Initparams level</span>
                                                <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>:
                                                    <a href="#ae95a8329bd8f9ae" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>(<span class="r607 r">p</span>, <span class="r576 r">path</span>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>, <span class="r578 r">recurse</span>);
                                                    <b>break</b>;
                                                <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>:
                                                    <a href="#ba7862ec455391bf" class="i method">WritePSObjectPropertyNames</a>(<span class="r607 r">p</span>, <span class="r576 r">path</span>);
                                                    <b>break</b>;
                                            }
                                        }
                                    }
 
                                    <b>return</b>;
                                }
 
                                <span class="r585 r">strPathchk</span> = <span class="r585 r">strPathchk</span> + <span class="r606 r">sResourceDirName</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>;
                                <b>if</b> (<span class="r576 r">path</span>.<span class="i">EndsWith</span>(<span class="r585 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || <span class="r576 r">path</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a> + <span class="s">&quot;_&quot;</span>))
                                {
                                    <b>if</b> (<span class="r594 r">arrSecurity</span> != <b>null</b>)
                                    {
                                        <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r608 rd" class="r608 r">objsecurity</span> <b>in</b> <span class="r594 r">arrSecurity</span>)
                                        {
                                            <b>if</b> (<span class="r606 r">sResourceDirName</span>.<span class="i">Equals</span>(<span class="r608 r">objsecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                            {
                                                <b>if</b> (<span class="r576 r">path</span>.<span class="i">EndsWith</span>(<span class="r585 r">strPathchk</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                                {
                                                    <span class="r608 r">objsecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Remove</span>(<span class="s">&quot;ResourceDir&quot;</span>);
                                                    <b>switch</b> (<span class="r577 r">methodname</span>)
                                                    {
                                                        <span class="c">// Get the items at Security level</span>
                                                        <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>:
                                                            <b>string</b> <span id="r609 rd" class="r609 r">key</span> = <span class="s">&quot;Uri&quot;</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a> + <span class="r608 r">objsecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;Uri&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>();
                                                            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r610 rd" class="r610 r">obj</span> = <b>new</b> <span class="t">PSObject</span>();
                                                            <span class="r610 r">obj</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r608 r">objsecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;SecurityDIR&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>));
                                                            <a href="#ae95a8329bd8f9ae" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>(<span class="r610 r">obj</span>, <span class="r576 r">path</span>, <b>new</b> <b>string</b>[] { <span class="r609 r">key</span> }, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#b90f663a342a8c65" class="i field">WSManConfigContainerElement</a>, <span class="r578 r">recurse</span>);
                                                            <span class="c">// WriteItemObject(new WSManConfigContainerElement(objsecurity.Properties[&quot;SecurityDIR&quot;].Value.ToString(), WSManStringLiterals.ContainerChildValue, new string[] { key }), path + WSManStringLiterals.DefaultPathSeparator + objsecurity.Properties[&quot;SecurityDIR&quot;].Value.ToString(), true);</span>
 
                                                            <b>break</b>;
                                                        <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>:
                                                            <span class="i">WriteItemObject</span>(<span class="r608 r">objsecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;SecurityDIR&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <span class="r576 r">path</span>, <b>true</b>);
                                                            <b>break</b>;
                                                    }
                                                }
                                                <b>else</b>
                                                {
                                                    <b>string</b> <span id="r611 rd" class="r611 r">sSecurityDirName</span> = <span class="r576 r">path</span>.<span class="i">Substring</span>(<span class="r576 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1, <span class="r576 r">path</span>.<span class="i">Length</span> - (<span class="r576 r">path</span>.<span class="i">LastIndexOf</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>) + 1));
                                                    <b>if</b> (<span class="r611 r">sSecurityDirName</span>.<span class="i">Equals</span>(<span class="r608 r">objsecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;SecurityDIR&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                                    {
                                                        <span class="r608 r">objsecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Remove</span>(<span class="s">&quot;ResourceDir&quot;</span>);
                                                        <span class="r608 r">objsecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Remove</span>(<span class="s">&quot;SecurityDIR&quot;</span>);
                                                        <b>switch</b> (<span class="r577 r">methodname</span>)
                                                        {
                                                            <span class="c">// Get the items at Security level</span>
                                                            <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>:
                                                                <a href="#ae95a8329bd8f9ae" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>(<span class="r608 r">objsecurity</span>, <span class="r576 r">path</span>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>, <span class="r578 r">recurse</span>);
                                                                <b>break</b>;
                                                            <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>:
                                                                <a href="#ba7862ec455391bf" class="i method">WritePSObjectPropertyNames</a>(<span class="r608 r">objsecurity</span>, <span class="r576 r">path</span>);
                                                                <b>break</b>;
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        <b>else</b> <b>if</b> (<span class="r576 r">path</span>.<span class="i">EndsWith</span>(<span class="r582 r">host</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <span class="r588 r">currentpluginname</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#b5fc579b23b96bda" class="i field">containerInitParameters</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>if</b> (<span class="r596 r">arrInitParams</span> == <b>null</b>)
                            {
                                <b>return</b>;
                            }
 
                            <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r612 rd" class="r612 r">p</span> <b>in</b> <span class="r596 r">arrInitParams</span>)
                            {
                                <b>switch</b> (<span class="r577 r">methodname</span>)
                                {
                                    <span class="c">// Get the items at Initparams level</span>
                                    <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>:
                                        <a href="#ae95a8329bd8f9ae" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>(<span class="r612 r">p</span>, <span class="r576 r">path</span>, <b>null</b>, <span class="s">&quot;InitParams&quot;</span>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>, <span class="r578 r">recurse</span>);
                                        <b>break</b>;
                                    <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>:
                                        <a href="#ba7862ec455391bf" class="i method">WritePSObjectPropertyNames</a>(<span class="r612 r">p</span>, <span class="r576 r">path</span>);
                                        <b>break</b>;
                                }
                            }
                        }
                    }
                }
                <b>else</b>
                {
                    <b>if</b> ((<span class="r576 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#1332bd072f02a398" class="i field">containerService</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || <span class="r576 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#14caf545f3eccbf9" class="i field">containerTrustedHosts</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                           || <span class="r576 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#65ec6609d9d215e7" class="i field">containerClient</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || <span class="r576 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#c946bcc82c5ee36c" class="i field">containerDefaultPorts</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                              || <span class="r576 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#492bc1a90a696ed1" class="i field">containerAuth</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || <span class="r576 r">path</span>.<span class="i">EndsWith</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#889838e923e5bdb8" class="i field">containerShell</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                    {
                        <b>foreach</b> (<span class="i">XmlNode</span> <span id="r613 rd" class="r613 r">node</span> <b>in</b> <span class="r587 r">outxml</span>.<span class="i">ChildNodes</span>)
                        {
                            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r614 rd" class="r614 r">mshObject</span> = <a href="#edd1bbc7452c8ae2" class="i method">ConvertToPSObject</a>(<span class="r613 r">node</span>);
                            <b>switch</b> (<span class="r577 r">methodname</span>)
                            {
                                <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#6f48332ff2f66de6" class="i field">GetChildItems</a>:
                                    <a href="#ae95a8329bd8f9ae" class="i method">WritePSObjectPropertiesAsWSManElementObjects</a>(<span class="r614 r">mshObject</span>, <span class="r576 r">path</span>, <b>null</b>, <b>null</b>, <a href="#7dde51839226d515" class="t t">WsManElementObjectTypes</a>.<a href="#67ccd324568a5d33" class="i field">WSManConfigLeafElement</a>, <span class="r578 r">recurse</span>);
                                    <b>break</b>;
                                <b>case</b> <a href="#ab0c824395b1ca56" class="t t">ProviderMethods</a>.<a href="#77fbbc59dc814203" class="i field">GetChildNames</a>:
                                    <a href="#ba7862ec455391bf" class="i method">WritePSObjectPropertyNames</a>(<span class="r614 r">mshObject</span>, <span class="r576 r">path</span>);
                                    <b>break</b>;
                            }
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the Plugin names from the WsMan Config file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r615 r">xmlPlugins</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r616 r">PluginNames</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r617 r">CurrentPluginName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r618 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="652b1bae7a230230" href="R/652b1bae7a230230.html" target="n" data-glyph="76,1" class="i method">GetPluginNames</a>(<span class="i">XmlDocument</span> <span id="r615 rd" class="r615 r">xmlPlugins</span>, <b>out</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r616 rd" class="r616 r">PluginNames</span>, <b>out string</b> <span id="r617 rd" class="r617 r">CurrentPluginName</span>, <b>string</b> <span id="r618 rd" class="r618 r">path</span>)
        {
            <span class="r616 r">PluginNames</span> = <b>new</b> <span class="t">PSObject</span>();
            <span class="r617 r">CurrentPluginName</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <span class="c">// If the execution is reached this point ... that means the path should for plugins directory (..\Plugins...).</span>
            <b>if</b> (!<span class="r618 r">path</span>.<span class="i">Contains</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#d49ea60b914da0fa" class="i field">containerPlugin</a>))
            {
                <b>return</b> 0;
            }
 
            <span class="c">// The path will be something like &lt;serverName&gt;\Plugin\&lt;Name of the plugin&gt;\...</span>
            <b>string</b>[] <span id="r619 rd" class="r619 r">splitPath</span> = <span class="r618 r">path</span>.<span class="i">Split</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#27c73798299c80d0" class="i field">DefaultPathSeparator</a>);
 
            <span class="i">XmlNodeList</span> <span id="r620 rd" class="r620 r">pluginNodeList</span> = <span class="r615 r">xmlPlugins</span>.<span class="i">GetElementsByTagName</span>(<span class="s">&quot;PlugInConfiguration&quot;</span>);
 
            <b>foreach</b> (<span class="i">XmlElement</span> <span id="r621 rd" class="r621 r">e</span> <b>in</b> <span class="r620 r">pluginNodeList</span>)
            {
                <b>for</b> (<b>int</b> <span id="r622 rd" class="r622 r">i</span> = 0; <span class="r622 r">i</span> &lt;= <span class="r621 r">e</span>.<span class="i">Attributes</span>.<span class="i">Count</span> - 1; <span class="r622 r">i</span>++)
                {
                    <b>if</b> (<span class="r621 r">e</span>.<span class="i">Attributes</span>[<span class="r622 r">i</span>].<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>))
                    {
                        <span class="r616 r">PluginNames</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r621 r">e</span>.<span class="i">Attributes</span>[<span class="r622 r">i</span>].<span class="i">Value</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>));
 
                        <span class="c">// If the path contains \plugin and splitLength is greater than 3 then splitLength[2] will be plugin Name.</span>
                        <b>if</b> (<span class="r619 r">splitPath</span>.<span class="i">Length</span> &gt;= 3 &amp;&amp; <span class="r619 r">splitPath</span>[2].<span class="i">Equals</span>(<span class="r621 r">e</span>.<span class="i">Attributes</span>[<span class="r622 r">i</span>].<span class="i">Value</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="r617 r">CurrentPluginName</span> = <span class="r621 r">e</span>.<span class="i">Attributes</span>[<span class="r622 r">i</span>].<span class="i">Value</span>;
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r620 r">pluginNodeList</span>.<span class="i">Count</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All Error are thrown using this method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r623 r">ErrorMessage</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r624 r">IsWSManError</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="014253583d795bc0" href="R/014253583d795bc0.html" target="n" data-glyph="76,1" class="i method">AssertError</a>(<b>string</b> <span id="r623 rd" class="r623 r">ErrorMessage</span>, <b>bool</b> <span id="r624 rd" class="r624 r">IsWSManError</span>)
        {
            <b>if</b> (<span class="r624 r">IsWSManError</span>)
            {
                <span class="i">XmlDocument</span> <span id="r625 rd" class="r625 r">ErrorDoc</span> = <b>new</b> <span class="i">XmlDocument</span>();
                <span class="r625 r">ErrorDoc</span>.<span class="i">LoadXml</span>(<span class="r623 r">ErrorMessage</span>);
                <span class="i">XmlNodeList</span> <span id="r626 rd" class="r626 r">errornodelist</span> = <span class="r625 r">ErrorDoc</span>.<span class="i">GetElementsByTagName</span>(<span class="s">&quot;f:Message&quot;</span>);
                <b>foreach</b> (<span class="i">XmlNode</span> <span id="r627 rd" class="r627 r">node</span> <b>in</b> <span class="r626 r">errornodelist</span>)
                {
                    <span class="i">InvalidOperationException</span> <span id="r628 rd" class="r628 r">ex</span> = <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r627 r">node</span>.<span class="i">InnerText</span>);
                    <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r629 rd" class="r629 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r628 r">ex</span>, <span class="s">&quot;WsManError&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                    <span class="i">ThrowTerminatingError</span>(<span class="r629 r">er</span>);
                }
            }
            <b>else</b>
            {
                <span class="i">InvalidOperationException</span> <span id="r630 rd" class="r630 r">ex</span> = <b>new</b> <span class="i">InvalidOperationException</span>(<span class="r623 r">ErrorMessage</span>);
                <a href="/System.Management.Automation/A.html#fe2b46733a081db9" class="t t">ErrorRecord</a> <span id="r631 rd" class="r631 r">er</span> = <b>new</b> <span class="t">ErrorRecord</span>(<span class="r630 r">ex</span>, <span class="s">&quot;WsManError&quot;</span>, <a href="/System.Management.Automation/A.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="/System.Management.Automation/A.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>, <b>null</b>);
                <span class="i">ThrowTerminatingError</span>(<span class="r631 r">er</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks whether WsMan Service is running.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="049952faaf766e5b" href="R/049952faaf766e5b.html" target="n" data-glyph="76,1" class="i method">IsWSManServiceRunning</a>()
        {
            <b>if</b> (<a href="#961aacbd20eee20c" class="i field">winrmServiceController</a> == <b>null</b>)
            {
                <a href="#961aacbd20eee20c" class="i field">winrmServiceController</a> = <b>new</b> <span class="i">ServiceController</span>(<span class="s">&quot;WinRM&quot;</span>);
            }
            <b>else</b>
            {
                <a href="#961aacbd20eee20c" class="i field">winrmServiceController</a>.<span class="i">Refresh</span>();
            }
 
            <b>return</b> (<a href="#961aacbd20eee20c" class="i field">winrmServiceController</a>.<span class="i">Status</span>.<span class="i">Equals</span>(<span class="i">ServiceControllerStatus</span>.<span class="i">Running</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Starts the WsMan service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r632 r">force</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="76311111d1d2f1b2" href="R/76311111d1d2f1b2.html" target="n" data-glyph="76,1" class="i method">StartWSManService</a>(<b>bool</b> <span id="r632 rd" class="r632 r">force</span>)
        {
            <b>try</b>
            {
                <b>string</b> <span id="r633 rd" class="r633 r">startserviceScript</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#52bb435eef0d3204" class="i field">StartWinrmServiceSBFormat</a>);
                <a href="/System.Management.Automation/A.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r634 rd" class="r634 r">startserviceSb</span> = <a href="/System.Management.Automation/A.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<span class="i">Create</span>(<span class="r633 r">startserviceScript</span>);
                <span class="i">Collection</span>&lt;<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r635 rd" class="r635 r">result</span> = <span class="r634 r">startserviceSb</span>.<span class="i">Invoke</span>(<span class="r632 r">force</span>, <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;WSManServiceStartCaption&quot;</span>), <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;WSManServiceStartQuery&quot;</span>));
                <b>if</b> (!(<b>bool</b>)<span class="r635 r">result</span>[0].<span class="i">ImmediateBaseObject</span>)
                {
                    <a href="#014253583d795bc0" class="i method">AssertError</a>(<a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;WinRMServiceError&quot;</span>), <b>false</b>);
                }
            }
            <b>catch</b> (<a href="/System.Management.Automation/A.html#7b242746a433b370" class="t t">CmdletInvocationException</a>)
            {
                <span class="c">// Eating cmdlet invocation exception. The exception is thrown when No is given.</span>
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks whether localmachine or not. If this returns true only we start the service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r636 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="f48e279095b5a8c1" href="R/f48e279095b5a8c1.html" target="n" data-glyph="76,1" class="i method">IsPathLocalMachine</a>(<b>string</b> <span id="r636 rd" class="r636 r">host</span>)
        {
            <b>bool</b> <span id="r637 rd" class="r637 r">hostfound</span> = <b>false</b>;
            <span class="c">// Check is Localhost</span>
            <b>if</b> (<span class="r636 r">host</span>.<span class="i">Equals</span>(<span class="s">&quot;localhost&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r637 r">hostfound</span> = <b>true</b>;
            }
 
            <span class="c">// Check is TestMac</span>
            <b>if</b> (!<span class="r637 r">hostfound</span>)
            {
                <b>if</b> (<span class="r636 r">host</span>.<span class="i">Equals</span>(<span class="i n">System</span>.<span class="i">Net</span>.<span class="i">Dns</span>.<span class="i">GetHostName</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r637 r">hostfound</span> = <b>true</b>;
                }
            }
 
            <span class="c">// Check is TestMac.redmond.microsoft.corp.com</span>
            <b>if</b> (!<span class="r637 r">hostfound</span>)
            {
                <span class="i n">System</span>.<span class="i">Net</span>.<span class="i">IPHostEntry</span> <span id="r638 rd" class="r638 r">hostentry</span> = <span class="i n">System</span>.<span class="i">Net</span>.<span class="i">Dns</span>.<span class="i">GetHostEntry</span>(<span class="s">&quot;localhost&quot;</span>);
                <b>if</b> (<span class="r636 r">host</span>.<span class="i">Equals</span>(<span class="r638 r">hostentry</span>.<span class="i">HostName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r637 r">hostfound</span> = <b>true</b>;
                }
 
                <span class="c">// Check is 127.0.0.1 or ::1</span>
                <b>if</b> (!<span class="r637 r">hostfound</span>)
                {
                    <b>foreach</b> (<span class="i n">System</span>.<span class="i">Net</span>.<span class="i">IPAddress</span> <span id="r639 rd" class="r639 r">ipaddress</span> <b>in</b> <span class="r638 r">hostentry</span>.<span class="i">AddressList</span>)
                    {
                        <b>if</b> (<span class="r639 r">ipaddress</span>.<span class="i">ToString</span>().<span class="i">Equals</span>(<span class="r636 r">host</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="r637 r">hostfound</span> = <b>true</b>;
                        }
                    }
                }
            }
 
            <span class="c">// check if any IPAddress.</span>
            <b>if</b> (!<span class="r637 r">hostfound</span>)
            {
                <b>foreach</b> (<span class="i n">System</span>.<span class="i">Net</span>.<span class="i">IPAddress</span> <span id="r640 rd" class="r640 r">ipaddress</span> <b>in</b> <span class="i n">System</span>.<span class="i">Net</span>.<span class="i">Dns</span>.<span class="i">GetHostAddresses</span>(<span class="i n">System</span>.<span class="i">Net</span>.<span class="i">Dns</span>.<span class="i">GetHostName</span>()))
                {
                    <b>if</b> (<span class="r640 r">ipaddress</span>.<span class="i">ToString</span>().<span class="i">Equals</span>(<span class="r636 r">host</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r637 r">hostfound</span> = <b>true</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r637 r">hostfound</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Plugin private functions
 
        <b>private static void</b> <a id="e9233d397d5f7bc5" href="R/e9233d397d5f7bc5.html" target="n" data-glyph="76,1" class="i method">GenerateObjectNameAndKeys</a>(<span class="i">Hashtable</span> <span id="r641 rd" class="r641 r">InputAttributes</span>, <b>string</b> <span id="r642 rd" class="r642 r">ResourceURI</span>, <b>string</b> <span id="r643 rd" class="r643 r">ContainerItem</span>, <b>out string</b> <span id="r644 rd" class="r644 r">ItemName</span>, <b>out string</b>[] <span id="r645 rd" class="r645 r">keys</span>)
        {
            <span class="i">StringBuilder</span> <span id="r646 rd" class="r646 r">sbHashKey</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>string</b> <span id="r647 rd" class="r647 r">keysColumns</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r648 rd" class="r648 r">attribute</span> <b>in</b> <span class="r641 r">InputAttributes</span>)
            {
                <b>if</b> (<span class="i">IsPKey</span>(<span class="r648 r">attribute</span>.<span class="i">Key</span>.<span class="i">ToString</span>(), <span class="r642 r">ResourceURI</span>))
                {
                    <span class="r646 r">sbHashKey</span>.<span class="i">Append</span>(<span class="r648 r">attribute</span>.<span class="i">Key</span>.<span class="i">ToString</span>());
                    <span class="r646 r">sbHashKey</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a>);
                    <span class="r646 r">sbHashKey</span>.<span class="i">Append</span>(<span class="r648 r">attribute</span>.<span class="i">Value</span>.<span class="i">ToString</span>());
                    <span class="r647 r">keysColumns</span> = <span class="r647 r">keysColumns</span> + <span class="r648 r">attribute</span>.<span class="i">Key</span>.<span class="i">ToString</span>() + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a> + <span class="r648 r">attribute</span>.<span class="i">Value</span>.<span class="i">ToString</span>() + <span class="s">&quot;|&quot;</span>;
                }
                <b>else</b>
                {
                    <b>if</b> (<span class="r643 r">ContainerItem</span>.<span class="i">Equals</span>(<span class="s">&quot;Listener&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                        &amp;&amp; <span class="r648 r">attribute</span>.<span class="i">Key</span>.<span class="i">ToString</span>().<span class="i">Equals</span>(<span class="s">&quot;Port&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="c">// we add the Port number when generating the name in order</span>
                        <span class="c">// be distinguish compatibility listeners which might have the same</span>
                        <span class="c">// real key (address and port) as a real listener</span>
                        <span class="r646 r">sbHashKey</span>.<span class="i">Append</span>(<span class="r648 r">attribute</span>.<span class="i">Key</span>.<span class="i">ToString</span>());
                        <span class="r646 r">sbHashKey</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a>);
                        <span class="r646 r">sbHashKey</span>.<span class="i">Append</span>(<span class="r648 r">attribute</span>.<span class="i">Value</span>.<span class="i">ToString</span>());
                    }
                }
            }
 
            <span class="r647 r">keysColumns</span> = <span class="r647 r">keysColumns</span>.<span class="i">Substring</span>(0, <span class="r647 r">keysColumns</span>.<span class="i">LastIndexOf</span>(<span class="s">&#39;|&#39;</span>));
            <span class="r644 r">ItemName</span> = <span class="r643 r">ContainerItem</span> + <span class="s">&quot;_&quot;</span> + <span class="i">Math</span>.<span class="i">Abs</span>(<span class="r646 r">sbHashKey</span>.<span class="i">ToString</span>().<span class="i">GetHashCode</span>());
            <span class="r645 r">keys</span> = <span class="r647 r">keysColumns</span>.<span class="i">Split</span>(<span class="s">&#39;|&#39;</span>);
        }
 
        <b>private static void</b> <a id="01a3c58ac8787b59" href="R/01a3c58ac8787b59.html" target="n" data-glyph="76,1" class="i method">ProcessCertMappingObjects</a>(<span class="i">XmlDocument</span> <span id="r649 rd" class="r649 r">xmlCerts</span>, <b>out</b> <span class="i">Hashtable</span> <span id="r650 rd" class="r650 r">Certcache</span>, <b>out</b> <span class="i">Hashtable</span> <span id="r651 rd" class="r651 r">Keyscache</span>)
        {
            <span class="i">Hashtable</span> <span id="r652 rd" class="r652 r">lCache</span> = <b>new</b> <span class="i">Hashtable</span>();
            <span class="i">Hashtable</span> <span id="r653 rd" class="r653 r">kCache</span> = <b>new</b> <span class="i">Hashtable</span>();
            <span class="i">XmlNodeList</span> <span id="r654 rd" class="r654 r">xmlnodesCerts</span> = <span class="r649 r">xmlCerts</span>.<span class="i">GetElementsByTagName</span>(<span class="s">&quot;cfg:&quot;</span> + <span class="s">&quot;CertMapping&quot;</span>);
            <b>if</b> (<span class="r654 r">xmlnodesCerts</span> == <b>null</b>)
            {
                <span class="r650 r">Certcache</span> = <b>null</b>;
                <span class="r651 r">Keyscache</span> = <b>null</b>;
                <b>return</b>;
            }
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r655 rd" class="r655 r">node</span> <b>in</b> <span class="r654 r">xmlnodesCerts</span>)
            {
                <span class="i">Hashtable</span> <span id="r656 rd" class="r656 r">InputAttributes</span> = <b>new</b> <span class="i">Hashtable</span>();
                <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r657 rd" class="r657 r">objCerts</span> = <b>new</b> <span class="t">PSObject</span>();
                <b>string</b>[] <span id="r658 rd" class="r658 r">keys</span> = <b>null</b>;
                <b>string</b> <span id="r659 rd" class="r659 r">ItemName</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>foreach</b> (<span class="i">XmlNode</span> <span id="r660 rd" class="r660 r">childnode</span> <b>in</b> <span class="r655 r">node</span>.<span class="i">ChildNodes</span>)
                {
                    <span class="c">//    if (childnode.LocalName.Equals(&quot;URI&quot;))</span>
                    <span class="c">//    {</span>
 
                    <span class="c">//        // sbCerts.Append(childnode.LocalName);</span>
                    <span class="c">//        // sbCerts.Append(WSManStringLiterals.Equalto);</span>
                    <span class="c">//        // sbCerts.Append(childnode.InnerText);</span>
                    <span class="c">//        // keys[0] = childnode.LocalName + WSManStringLiterals.Equalto + childnode.InnerText;</span>
                    <span class="c">//    }</span>
                    <span class="c">//    else if (childnode.LocalName.Equals(&quot;Subject&quot;))</span>
                    <span class="c">//    {</span>
                    <span class="c">//        // sbCerts.Append(childnode.LocalName);</span>
                    <span class="c">//        // sbCerts.Append(WSManStringLiterals.Equalto);</span>
                    <span class="c">//        // sbCerts.Append(childnode.InnerText);</span>
                    <span class="c">//        // keys[1] = childnode.LocalName + WSManStringLiterals.Equalto + childnode.InnerText;</span>
                    <span class="c">//    }</span>
                    <span class="c">//    else if (childnode.LocalName.Equals(&quot;Issuer&quot;))</span>
                    <span class="c">//    {</span>
                    <span class="c">//        // sbCerts.Append(childnode.LocalName);</span>
                    <span class="c">//        // sbCerts.Append(WSManStringLiterals.Equalto);</span>
                    <span class="c">//        // sbCerts.Append(childnode.InnerText);</span>
                    <span class="c">//        // keys[2] = childnode.LocalName + WSManStringLiterals.Equalto + childnode.InnerText;</span>
                    <span class="c">//    }</span>
 
                    <span class="r656 r">InputAttributes</span>.<span class="i">Add</span>(<span class="r660 r">childnode</span>.<span class="i">LocalName</span>, <span class="r660 r">childnode</span>.<span class="i">InnerText</span>);
                    <span class="r657 r">objCerts</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r660 r">childnode</span>.<span class="i">LocalName</span>, <span class="r660 r">childnode</span>.<span class="i">InnerText</span>));
                }
 
                <a href="#e9233d397d5f7bc5" class="i method">GenerateObjectNameAndKeys</a>(<span class="r656 r">InputAttributes</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#22940af130242689" class="i field">containerCertMapping</a>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#295af3cb4f2d9311" class="i field">containerClientCertificate</a>, <b>out</b> <span class="r659 r">ItemName</span>, <b>out</b> <span class="r658 r">keys</span>);
                <span class="c">// lCache.Add(WSManStringLiterals.containerClientCertificate + &quot;_&quot; + Math.Abs(sbCerts.ToString().GetHashCode()), objCerts);</span>
                <span class="r652 r">lCache</span>.<span class="i">Add</span>(<span class="r659 r">ItemName</span>, <span class="r657 r">objCerts</span>);
                <span class="r653 r">kCache</span>.<span class="i">Add</span>(<span class="r659 r">ItemName</span>, <span class="r658 r">keys</span>);
                <span class="c">// kCache.Add(WSManStringLiterals.containerClientCertificate + &quot;_&quot; + Math.Abs(sbCerts.ToString().GetHashCode()), keys);</span>
            }
 
            <span class="r650 r">Certcache</span> = <span class="r652 r">lCache</span>;
            <span class="r651 r">Keyscache</span> = <span class="r653 r">kCache</span>;
        }
 
        <b>private static void</b> <a id="52d9ca2566594c0d" href="R/52d9ca2566594c0d.html" target="n" data-glyph="76,1" class="i method">ProcessListenerObjects</a>(<span class="i">XmlDocument</span> <span id="r661 rd" class="r661 r">xmlListeners</span>, <b>out</b> <span class="i">Hashtable</span> <span id="r662 rd" class="r662 r">listenercache</span>, <b>out</b> <span class="i">Hashtable</span> <span id="r663 rd" class="r663 r">Keyscache</span>)
        {
            <span class="i">Hashtable</span> <span id="r664 rd" class="r664 r">lCache</span> = <b>new</b> <span class="i">Hashtable</span>();
            <span class="i">Hashtable</span> <span id="r665 rd" class="r665 r">kCache</span> = <b>new</b> <span class="i">Hashtable</span>();
            <span class="i">XmlNodeList</span> <span id="r666 rd" class="r666 r">xmlnodesListeners</span> = <span class="r661 r">xmlListeners</span>.<span class="i">GetElementsByTagName</span>(<span class="s">&quot;cfg:&quot;</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>);
            <b>if</b> (<span class="r666 r">xmlnodesListeners</span> == <b>null</b>)
            {
                <span class="r662 r">listenercache</span> = <b>null</b>;
                <span class="r663 r">Keyscache</span> = <b>null</b>;
                <b>return</b>;
            }
 
            <b>foreach</b> (<span class="i">XmlNode</span> <span id="r667 rd" class="r667 r">node</span> <b>in</b> <span class="r666 r">xmlnodesListeners</span>)
            {
                <span class="i">Hashtable</span> <span id="r668 rd" class="r668 r">InputAttributes</span> = <b>new</b> <span class="i">Hashtable</span>();
                <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r669 rd" class="r669 r">objListener</span> = <b>new</b> <span class="t">PSObject</span>();
                <b>string</b>[] <span id="r670 rd" class="r670 r">Keys</span> = <b>null</b>;
                <b>string</b> <span id="r671 rd" class="r671 r">ItemName</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>foreach</b> (<span class="i">XmlNode</span> <span id="r672 rd" class="r672 r">childnode</span> <b>in</b> <span class="r667 r">node</span>.<span class="i">ChildNodes</span>)
                {
                    <span class="c">// if (childnode.LocalName.Equals(&quot;Address&quot;))</span>
                    <span class="c">// {</span>
                    <span class="c">//    sbListener.Append(childnode.LocalName);</span>
                    <span class="c">//    sbListener.Append(WSManStringLiterals.Equalto);</span>
                    <span class="c">//    sbListener.Append(childnode.InnerText);</span>
                    <span class="c">//    Keys[0] = childnode.LocalName + WSManStringLiterals.Equalto + childnode.InnerText;</span>
                    <span class="c">//    objListener.Properties.Add(new PSNoteProperty(childnode.LocalName, childnode.InnerText));</span>
                    <span class="c">// }</span>
                    <span class="c">// else if (childnode.LocalName.Equals(&quot;Transport&quot;))</span>
                    <span class="c">// {</span>
                    <span class="c">//    sbListener.Append(childnode.LocalName);</span>
                    <span class="c">//    sbListener.Append(WSManStringLiterals.Equalto);</span>
                    <span class="c">//    sbListener.Append(childnode.InnerText);</span>
                    <span class="c">//    Keys[1] = childnode.LocalName + WSManStringLiterals.Equalto + childnode.InnerText;</span>
                    <span class="c">//    objListener.Properties.Add(new PSNoteProperty(childnode.LocalName, childnode.InnerText));</span>
                    <span class="c">// }</span>
 
                    <b>if</b> (<span class="r672 r">childnode</span>.<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;ListeningOn&quot;</span>))
                    {
                        <b>string</b> <span id="r673 rd" class="r673 r">ListeningOnItem</span> = <span class="r672 r">childnode</span>.<span class="i">LocalName</span> + <span class="s">&quot;_&quot;</span> + <span class="i">Math</span>.<span class="i">Abs</span>(<span class="r672 r">childnode</span>.<span class="i">InnerText</span>.<span class="i">GetHashCode</span>());
                        <span class="r669 r">objListener</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r673 r">ListeningOnItem</span>, <span class="r672 r">childnode</span>.<span class="i">InnerText</span>));
                        <span class="r668 r">InputAttributes</span>.<span class="i">Add</span>(<span class="r673 r">ListeningOnItem</span>, <span class="r672 r">childnode</span>.<span class="i">InnerText</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r668 r">InputAttributes</span>.<span class="i">Add</span>(<span class="r672 r">childnode</span>.<span class="i">LocalName</span>, <span class="r672 r">childnode</span>.<span class="i">InnerText</span>);
                        <span class="r669 r">objListener</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r672 r">childnode</span>.<span class="i">LocalName</span>, <span class="r672 r">childnode</span>.<span class="i">InnerText</span>));
                    }
                }
 
                <a href="#e9233d397d5f7bc5" class="i method">GenerateObjectNameAndKeys</a>(<span class="r668 r">InputAttributes</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#8a314c877e5e4804" class="i field">containerListener</a>, <b>out</b> <span class="r671 r">ItemName</span>, <b>out</b> <span class="r670 r">Keys</span>);
                <span class="c">// lCache.Add(WSManStringLiterals.containerListener + &quot;_&quot; + Math.Abs(sbListener.ToString().GetHashCode()), objListener);</span>
                <span class="r664 r">lCache</span>.<span class="i">Add</span>(<span class="r671 r">ItemName</span>, <span class="r669 r">objListener</span>);
                <span class="r665 r">kCache</span>.<span class="i">Add</span>(<span class="r671 r">ItemName</span>, <span class="r670 r">Keys</span>);
                <span class="c">// kCache.Add(WSManStringLiterals.containerListener + &quot;_&quot; + Math.Abs(sbListener.ToString().GetHashCode()), Keys);</span>
            }
 
            <span class="r662 r">listenercache</span> = <span class="r664 r">lCache</span>;
            <span class="r663 r">Keyscache</span> = <span class="r665 r">kCache</span>;
        }
 
        <b>private static</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="d773ffd607e22121" href="R/d773ffd607e22121.html" target="n" data-glyph="76,1" class="i method">ProcessPluginConfigurationLevel</a>(<span class="i">XmlDocument</span> <span id="r674 rd" class="r674 r">xmldoc</span>, <b>bool</b> <span id="r675 rd" class="r675 r">setRunasPasswordAsSecureString</span> = <b>false</b>)
        {
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r676 rd" class="r676 r">objConfiglvl</span> = <b>null</b>;
 
            <b>if</b> (<span class="r674 r">xmldoc</span> != <b>null</b>)
            {
                <span class="i">XmlNodeList</span> <span id="r677 rd" class="r677 r">nodelistPlugin</span> = <span class="r674 r">xmldoc</span>.<span class="i">GetElementsByTagName</span>(<span class="s">&quot;PlugInConfiguration&quot;</span>);
                <b>if</b> (<span class="r677 r">nodelistPlugin</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="r676 r">objConfiglvl</span> = <b>new</b> <span class="t">PSObject</span>();
                    <span class="i">XmlAttributeCollection</span> <span id="r678 rd" class="r678 r">attributecol</span> = <span class="r677 r">nodelistPlugin</span>.<span class="i">Item</span>(0).<span class="i">Attributes</span>;
 
                    <span class="i">XmlNode</span> <span id="r679 rd" class="r679 r">runAsUserNode</span> = <span class="r678 r">attributecol</span>.<span class="i">GetNamedItem</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e67a384d08cc8860" class="i field">ConfigRunAsUserName</a>);
                    <b>bool</b> <span id="r680 rd" class="r680 r">runAsUserPresent</span> = <span class="r679 r">runAsUserNode</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r679 r">runAsUserNode</span>.<span class="i">Value</span>);
 
                    <b>for</b> (<b>int</b> <span id="r681 rd" class="r681 r">i</span> = 0; <span class="r681 r">i</span> &lt;= <span class="r678 r">attributecol</span>.<span class="i">Count</span> - 1; <span class="r681 r">i</span>++)
                    {
                        <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r678 r">attributecol</span>[<span class="r681 r">i</span>].<span class="i">LocalName</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e21ec3eff0232026" class="i field">ConfigRunAsPasswordName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                            &amp;&amp; <span class="r680 r">runAsUserPresent</span>
                            &amp;&amp; <span class="r675 r">setRunasPasswordAsSecureString</span>)
                        {
                            <span class="r676 r">objConfiglvl</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r678 r">attributecol</span>[<span class="r681 r">i</span>].<span class="i">LocalName</span>, <b>new</b> <span class="i">SecureString</span>()));
                        }
                        <b>else</b>
                        {
                            <span class="r676 r">objConfiglvl</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r678 r">attributecol</span>[<span class="r681 r">i</span>].<span class="i">LocalName</span>, <span class="r678 r">attributecol</span>[<span class="r681 r">i</span>].<span class="i">Value</span>));
                        }
                    }
                }
                <span class="c">// Containers in Plugin Level Configs</span>
                <b>if</b> (<span class="r676 r">objConfiglvl</span> != <b>null</b>)
                {
                    <span class="r676 r">objConfiglvl</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;InitializationParameters&quot;</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>));
                    <span class="r676 r">objConfiglvl</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;Resources&quot;</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>));
                    <span class="r676 r">objConfiglvl</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#9326032a5ad16c2c" class="i field">containerQuotasParameters</a>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>));
                }
            }
 
            <b>return</b> <span class="r676 r">objConfiglvl</span>;
        }
 
        <b>private static</b> <span class="i">ArrayList</span> <a id="9fc4301cb03b79b7" href="R/9fc4301cb03b79b7.html" target="n" data-glyph="76,1" class="i method">ProcessPluginResourceLevel</a>(<span class="i">XmlDocument</span> <span id="r682 rd" class="r682 r">xmldoc</span>, <b>out</b> <span class="i">ArrayList</span> <span id="r683 rd" class="r683 r">arrSecurity</span>)
        {
            <span class="i">ArrayList</span> <span id="r684 rd" class="r684 r">Resources</span> = <b>null</b>;
            <span class="i">ArrayList</span> <span id="r685 rd" class="r685 r">nSecurity</span> = <b>null</b>;
            <b>if</b> (<span class="r682 r">xmldoc</span> != <b>null</b>)
            {
                <span class="i">XmlNodeList</span> <span id="r686 rd" class="r686 r">xmlpluginResource</span> = <span class="r682 r">xmldoc</span>.<span class="i">GetElementsByTagName</span>(<span class="s">&quot;Resource&quot;</span>);
                <b>if</b> (<span class="r686 r">xmlpluginResource</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="r684 r">Resources</span> = <b>new</b> <span class="i">ArrayList</span>();
                    <span class="r685 r">nSecurity</span> = <b>new</b> <span class="i">ArrayList</span>();
                    <b>foreach</b> (<span class="i">XmlElement</span> <span id="r687 rd" class="r687 r">xe</span> <b>in</b> <span class="r686 r">xmlpluginResource</span>)
                    {
                        <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r688 rd" class="r688 r">objResource</span> = <b>new</b> <span class="t">PSObject</span>();
                        <b>string</b> <span id="r689 rd" class="r689 r">strUniqueResourceId</span> = <b>string</b>.<span class="i">Empty</span>;
                        <span class="i">XmlAttributeCollection</span> <span id="r690 rd" class="r690 r">attributecol</span> = <span class="r687 r">xe</span>.<span class="i">Attributes</span>;
                        <b>bool</b> <span id="r691 rd" class="r691 r">ExactMatchFound</span> = <b>false</b>;
                        <b>bool</b> <span id="r692 rd" class="r692 r">SupportsOptionsFound</span> = <b>false</b>;
                        <b>string</b> <span id="r693 rd" class="r693 r">resourceUri</span> = <b>string</b>.<span class="i">Empty</span>;
 
                        <b>for</b> (<b>int</b> <span id="r694 rd" class="r694 r">i</span> = 0; <span class="r694 r">i</span> &lt;= <span class="r690 r">attributecol</span>.<span class="i">Count</span> - 1; <span class="r694 r">i</span>++)
                        {
                            <b>if</b> (<span class="r690 r">attributecol</span>[<span class="r694 r">i</span>].<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;ResourceUri&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="r693 r">resourceUri</span> = <span class="r690 r">attributecol</span>[<span class="r694 r">i</span>].<span class="i">Value</span>;
                                <span class="r689 r">strUniqueResourceId</span> = <span class="s">&quot;Resource_&quot;</span> + <span class="i">Convert</span>.<span class="i">ToString</span>(<span class="i">Math</span>.<span class="i">Abs</span>(<span class="r690 r">attributecol</span>[<span class="r694 r">i</span>].<span class="i">Value</span>.<span class="i">GetHashCode</span>()), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                                <span class="r688 r">objResource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;ResourceDir&quot;</span>, <span class="r689 r">strUniqueResourceId</span>));
                            }
 
                            <b>if</b> (<span class="r690 r">attributecol</span>[<span class="r694 r">i</span>].<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;ExactMatch&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="r688 r">objResource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r690 r">attributecol</span>[<span class="r694 r">i</span>].<span class="i">LocalName</span>, <span class="r690 r">attributecol</span>[<span class="r694 r">i</span>].<span class="i">Value</span>));
                                <span class="r691 r">ExactMatchFound</span> = <b>true</b>;
                                <b>continue</b>;
                            }
 
                            <b>if</b> (<span class="r690 r">attributecol</span>[<span class="r694 r">i</span>].<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;SupportsOptions&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="r688 r">objResource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r690 r">attributecol</span>[<span class="r694 r">i</span>].<span class="i">LocalName</span>, <span class="r690 r">attributecol</span>[<span class="r694 r">i</span>].<span class="i">Value</span>));
                                <span class="r692 r">SupportsOptionsFound</span> = <b>true</b>;
                                <b>continue</b>;
                            }
 
                            <span class="r688 r">objResource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r690 r">attributecol</span>[<span class="r694 r">i</span>].<span class="i">LocalName</span>, <span class="r690 r">attributecol</span>[<span class="r694 r">i</span>].<span class="i">Value</span>));
                        }
 
                        <b>if</b> (!<span class="r691 r">ExactMatchFound</span>)
                        {
                            <span class="r688 r">objResource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;ExactMatch&quot;</span>, <b>false</b>));
                        }
 
                        <b>if</b> (!<span class="r692 r">SupportsOptionsFound</span>)
                        {
                            <span class="r688 r">objResource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;SupportsOptions&quot;</span>, <b>false</b>));
                        }
 
                        <span class="c">// Processing capabilities</span>
 
                        <span class="i">XmlDocument</span> <span id="r695 rd" class="r695 r">xmlCapabilities</span> = <b>new</b> <span class="i">XmlDocument</span>();
                        <span class="r695 r">xmlCapabilities</span>.<span class="i">LoadXml</span>(<span class="s">&quot;&lt;Capabilities&gt;&quot;</span> + <span class="r687 r">xe</span>.<span class="i">InnerXml</span> + <span class="s">&quot;&lt;/Capabilities&gt;&quot;</span>);
                        <span class="i">XmlNodeList</span> <span id="r696 rd" class="r696 r">nodeCapabilities</span> = <span class="r695 r">xmlCapabilities</span>.<span class="i">GetElementsByTagName</span>(<span class="s">&quot;Capability&quot;</span>);
                        <b>object</b>[] <span id="r697 rd" class="r697 r">enumcapability</span> = <b>null</b>;
                        <b>if</b> (<span class="r696 r">nodeCapabilities</span>.<span class="i">Count</span> &gt; 0)
                        {
                            <span class="r697 r">enumcapability</span> = <b>new</b> <b>object</b>[<span class="r696 r">nodeCapabilities</span>.<span class="i">Count</span>];
                            <b>for</b> (<b>int</b> <span id="r698 rd" class="r698 r">i</span> = 0; <span class="r698 r">i</span> &lt; <span class="r696 r">nodeCapabilities</span>.<span class="i">Count</span>; <span class="r698 r">i</span>++)
                            {
                                <span class="r697 r">enumcapability</span>.<span class="i">SetValue</span>(<span class="r696 r">nodeCapabilities</span>[<span class="r698 r">i</span>].<span class="i">Attributes</span>[<span class="s">&quot;Type&quot;</span>].<span class="i">Value</span>, <span class="r698 r">i</span>);
                            }
                        }
 
                        <span class="r688 r">objResource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;Capability&quot;</span>, <span class="r697 r">enumcapability</span>));
                        <span class="r688 r">objResource</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#5ddadbcc285617b8" class="i field">ContainerChildValue</a>));
 
                        <span class="c">// Process Security in Resources. We add the resource Unique ID in to each security to</span>
                        <span class="c">// identify in the Provider methods.</span>
                        <span class="r685 r">nSecurity</span> = <a href="#d903dc678fbf6297" class="i method">ProcessPluginSecurityLevel</a>(<span class="r685 r">nSecurity</span>, <span class="r695 r">xmlCapabilities</span>, <span class="r689 r">strUniqueResourceId</span>, <span class="r693 r">resourceUri</span>);
                        <span class="r684 r">Resources</span>.<span class="i">Add</span>(<span class="r688 r">objResource</span>);
                    }
                }
            }
 
            <span class="r683 r">arrSecurity</span> = <span class="r685 r">nSecurity</span>;
            <b>return</b> <span class="r684 r">Resources</span>;
        }
 
        <b>private static</b> <span class="i">ArrayList</span> <a id="0f58ba5254c3d7ba" href="R/0f58ba5254c3d7ba.html" target="n" data-glyph="76,1" class="i method">ProcessPluginInitParamLevel</a>(<span class="i">XmlDocument</span> <span id="r699 rd" class="r699 r">xmldoc</span>)
        {
            <span class="i">ArrayList</span> <span id="r700 rd" class="r700 r">InitParamLvl</span> = <b>null</b>;
            <b>if</b> (<span class="r699 r">xmldoc</span> != <b>null</b>)
            {
                <span class="i">XmlNodeList</span> <span id="r701 rd" class="r701 r">nodelistInitParam</span> = <span class="r699 r">xmldoc</span>.<span class="i">GetElementsByTagName</span>(<span class="s">&quot;Param&quot;</span>);
                <b>if</b> (<span class="r701 r">nodelistInitParam</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="r700 r">InitParamLvl</span> = <b>new</b> <span class="i">ArrayList</span>();
                    <b>foreach</b> (<span class="i">XmlElement</span> <span id="r702 rd" class="r702 r">xe</span> <b>in</b> <span class="r701 r">nodelistInitParam</span>)
                    {
                        <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r703 rd" class="r703 r">objInitParam</span> = <b>new</b> <span class="t">PSObject</span>();
                        <span class="i">XmlAttributeCollection</span> <span id="r704 rd" class="r704 r">attributecol</span> = <span class="r702 r">xe</span>.<span class="i">Attributes</span>;
                        <b>string</b> <span id="r705 rd" class="r705 r">Name</span> = <b>string</b>.<span class="i">Empty</span>;
                        <b>string</b> <span id="r706 rd" class="r706 r">Value</span> = <b>string</b>.<span class="i">Empty</span>;
                        <b>for</b> (<b>int</b> <span id="r707 rd" class="r707 r">i</span> = 0; <span class="r707 r">i</span> &lt;= <span class="r704 r">attributecol</span>.<span class="i">Count</span> - 1; <span class="r707 r">i</span>++)
                        {
                            <b>if</b> (<span class="r704 r">attributecol</span>[<span class="r707 r">i</span>].<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="r705 r">Name</span> = <span class="r704 r">attributecol</span>[<span class="r707 r">i</span>].<span class="i">Value</span>;
                            }
 
                            <b>if</b> (<span class="r704 r">attributecol</span>[<span class="r707 r">i</span>].<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;Value&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <b>string</b> <span id="r708 rd" class="r708 r">ValueAsXML</span> = <span class="r704 r">attributecol</span>[<span class="r707 r">i</span>].<span class="i">Value</span>;
                                <span class="r706 r">Value</span> = <span class="i">SecurityElement</span>.<span class="i">Escape</span>(<span class="r708 r">ValueAsXML</span>);
                            }
                        }
 
                        <span class="r703 r">objInitParam</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r705 r">Name</span>, <span class="r706 r">Value</span>));
                        <span class="r700 r">InitParamLvl</span>.<span class="i">Add</span>(<span class="r703 r">objInitParam</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r700 r">InitParamLvl</span>;
        }
 
        <b>private static</b> <span class="i">ArrayList</span> <a id="d903dc678fbf6297" href="R/d903dc678fbf6297.html" target="n" data-glyph="76,1" class="i method">ProcessPluginSecurityLevel</a>(<span class="i">ArrayList</span> <span id="r709 rd" class="r709 r">arrSecurity</span>, <span class="i">XmlDocument</span> <span id="r710 rd" class="r710 r">xmlSecurity</span>, <b>string</b> <span id="r711 rd" class="r711 r">UniqueResourceID</span>, <b>string</b> <span id="r712 rd" class="r712 r">ParentResourceUri</span>)
        {
            <span class="c">// ArrayList SecurityLvl = null;</span>
            <b>if</b> (<span class="r710 r">xmlSecurity</span> != <b>null</b>)
            {
                <span class="i">XmlNodeList</span> <span id="r713 rd" class="r713 r">nodelistSecurity</span> = <span class="r710 r">xmlSecurity</span>.<span class="i">GetElementsByTagName</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#f0909f094747b743" class="i field">containerSecurity</a>);
                <b>if</b> (<span class="r713 r">nodelistSecurity</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="c">// SecurityLvl = new ArrayList();</span>
                    <b>foreach</b> (<span class="i">XmlElement</span> <span id="r714 rd" class="r714 r">xe</span> <b>in</b> <span class="r713 r">nodelistSecurity</span>)
                    {
                        <b>bool</b> <span id="r715 rd" class="r715 r">ExactMatchFound</span> = <b>false</b>;
                        <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r716 rd" class="r716 r">objSecurity</span> = <b>new</b> <span class="t">PSObject</span>();
                        <span class="i">XmlAttributeCollection</span> <span id="r717 rd" class="r717 r">attributecol</span> = <span class="r714 r">xe</span>.<span class="i">Attributes</span>;
 
                        <b>for</b> (<b>int</b> <span id="r718 rd" class="r718 r">i</span> = 0; <span class="r718 r">i</span> &lt;= <span class="r717 r">attributecol</span>.<span class="i">Count</span> - 1; <span class="r718 r">i</span>++)
                        {
                            <b>if</b> (<span class="r717 r">attributecol</span>[<span class="r718 r">i</span>].<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;Uri&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="r716 r">objSecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;SecurityDIR&quot;</span>, <span class="s">&quot;Security_&quot;</span> + <span class="i">Math</span>.<span class="i">Abs</span>(<span class="r711 r">UniqueResourceID</span>.<span class="i">GetHashCode</span>())));
                            }
 
                            <b>if</b> (<span class="r717 r">attributecol</span>[<span class="r718 r">i</span>].<span class="i">LocalName</span>.<span class="i">Equals</span>(<span class="s">&quot;ExactMatch&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="r716 r">objSecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r717 r">attributecol</span>[<span class="r718 r">i</span>].<span class="i">LocalName</span>, <span class="r717 r">attributecol</span>[<span class="r718 r">i</span>].<span class="i">Value</span>));
                                <span class="r715 r">ExactMatchFound</span> = <b>true</b>;
                                <b>continue</b>;
                            }
 
                            <span class="r716 r">objSecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="r717 r">attributecol</span>[<span class="r718 r">i</span>].<span class="i">LocalName</span>, <span class="r717 r">attributecol</span>[<span class="r718 r">i</span>].<span class="i">Value</span>));
                        }
 
                        <b>if</b> (!<span class="r715 r">ExactMatchFound</span>)
                        {
                            <span class="r716 r">objSecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;ExactMatch&quot;</span>, <b>false</b>));
                        }
 
                        <span class="r716 r">objSecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;ResourceDir&quot;</span>, <span class="r711 r">UniqueResourceID</span>));
                        <span class="r716 r">objSecurity</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<span class="i">Add</span>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;ParentResourceUri&quot;</span>, <span class="r712 r">ParentResourceUri</span>));
 
                        <span class="r709 r">arrSecurity</span>.<span class="i">Add</span>(<span class="r716 r">objSecurity</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r709 r">arrSecurity</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method constructs the Configuration XML from the PSObject.</span>
        <span class="c">///</span><span class="c"> For RunAsPassword, if the value is not of type SecureString or the value is not present</span>
        <span class="c">///</span><span class="c"> then an Empty string is added as value. The caller of this method MUST make sure that</span>
        <span class="c">///</span><span class="c"> the RunAsPassword (if updated) is of type SecureString.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r719 r">objinputparam</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSObject, from which XML will be produced.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r720 r">ResourceURI</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Resource URI for the XML.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r721 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the Host.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r722 r">Operation</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type of Operation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r723 r">resources</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of Resources.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r724 r">securities</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of Securities</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r725 r">initParams</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of initialization parameters.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">An Configuration XML, ready to send to server.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="78a1921249a2d50e" href="R/78a1921249a2d50e.html" target="n" data-glyph="76,1" class="i method">ConstructPluginXml</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r719 rd" class="r719 r">objinputparam</span>, <b>string</b> <span id="r720 rd" class="r720 r">ResourceURI</span>, <b>string</b> <span id="r721 rd" class="r721 r">host</span>, <b>string</b> <span id="r722 rd" class="r722 r">Operation</span>, <span class="i">ArrayList</span> <span id="r723 rd" class="r723 r">resources</span>, <span class="i">ArrayList</span> <span id="r724 rd" class="r724 r">securities</span>, <span class="i">ArrayList</span> <span id="r725 rd" class="r725 r">initParams</span>)
        {
            <span class="i">StringBuilder</span> <span id="r726 rd" class="r726 r">sbvalues</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;PlugInConfiguration &quot;</span>);
            <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;xmlns=&quot;</span>);
            <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(
                <b>string</b>.<span class="i">Concat</span>(
                    <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>,
                    <span class="s">@&quot;http://schemas.microsoft.com/wbem/wsman/1/config/PluginConfiguration&quot;</span>,
                    <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>));
 
            <b>if</b> (<span class="r719 r">objinputparam</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r727 rd" class="r727 r">prop</span> <b>in</b> <span class="r719 r">objinputparam</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>)
                {
                    <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#852f2087a0245e2a" class="i field">SingleWhiteSpace</a>);
                    <b>if</b> (<a href="#0ddca8f346019a3a" class="i method">IsValueOfParamList</a>(<span class="r727 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#18d3668922a97d85" class="i field">NewItemPluginConfigParams</a>))
                    {
                        <span class="c">// ... Name</span>
                        <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(<span class="r727 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>);
 
                        <span class="c">// ... Name=</span>
                        <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a>);
 
                        <b>if</b> (<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e21ec3eff0232026" class="i field">ConfigRunAsPasswordName</a>.<span class="i">Equals</span>(<span class="r727 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="r727 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a> = <a href="#acc5197a7371fd28" class="i method">GetStringFromSecureString</a>(<span class="r727 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>);
                        }
 
                        <span class="c">// ... Name=&quot;Value&quot;</span>
                        <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(
                            <b>string</b>.<span class="i">Concat</span>(
                                <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>,
                                <span class="r727 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>(),
                                <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>));
                    }
                }
            }
 
            <span class="c">// &lt; ...Name=&quot;value&quot; ... &gt;</span>
            <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#7525b34dc50c87f8" class="i field">GreaterThan</a>);
            <b>if</b> (<span class="r722 r">Operation</span>.<span class="i">Equals</span>(<span class="s">&quot;New&quot;</span>))
            {
                <b>if</b> (<span class="r719 r">objinputparam</span> != <b>null</b>)
                    <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(<a href="#32173ad9b3cc811a" class="i method">ConstructResourceXml</a>(<span class="r719 r">objinputparam</span>, <b>null</b>, <b>null</b>));
                <b>else</b>
                    <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(<a href="#32173ad9b3cc811a" class="i method">ConstructResourceXml</a>(<b>null</b>, <span class="r723 r">resources</span>, <b>null</b>));
            }
            <b>else</b> <b>if</b> (<span class="r722 r">Operation</span>.<span class="i">Equals</span>(<span class="s">&quot;Set&quot;</span>))
            {
                <b>if</b> (<span class="r725 r">initParams</span> != <b>null</b>)
                    <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(<a href="#d7c9c13ade22624f" class="i method">ConstructInitParamsXml</a>(<b>null</b>, <span class="r725 r">initParams</span>));
                <b>if</b> (<span class="r723 r">resources</span> != <b>null</b>)
                    <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(<a href="#32173ad9b3cc811a" class="i method">ConstructResourceXml</a>(<b>null</b>, <span class="r723 r">resources</span>, <span class="r724 r">securities</span>));
            }
 
            <span class="r726 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/PlugInConfiguration&gt;&quot;</span>);
            <b>return</b> <span class="r726 r">sbvalues</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PS wraps most of the parameters to Item cmdlets in PSObject. These values are passed as &#39;Object&#39;.</span>
        <span class="c">///</span><span class="c"> This method unwraps the PSObjects and returns the base object as the required Type for the given</span>
        <span class="c">///</span><span class="c"> configuration name as follows:</span>
        <span class="c">///</span><span class="c"> RunAsUser - PSCredential</span>
        <span class="c">///</span><span class="c"> RunAsPassword - SecureString</span>
        <span class="c">///</span><span class="c"> If the object provided by user is not of required type the method return Null.</span>
        <span class="c">///</span><span class="c"> If the object is not PSObject, the method returns the &#39;value&#39;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r728 r">configurationName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the configuration setting.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r729 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Object provided by User.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Object of the required type or Null.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private object</b> <a id="18219680bd3b8f96" href="R/18219680bd3b8f96.html" target="n" data-glyph="76,1" class="i method">ValidateAndGetUserObject</a>(<b>string</b> <span id="r728 rd" class="r728 r">configurationName</span>, <b>object</b> <span id="r729 rd" class="r729 r">value</span>)
        {
            <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r730 rd" class="r730 r">basePsObject</span> = <span class="r729 r">value</span> <b>as</b> <a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a>;
            <a href="/System.Management.Automation/A.html#6245dc122e2f1916" class="t t">PSCredential</a> <span id="r731 rd" class="r731 r">psCredential</span> = <b>null</b>;
            <b>if</b> (<span class="r730 r">basePsObject</span> == <b>null</b>)
            {
                <span class="r731 r">psCredential</span> = <span class="r729 r">value</span> <b>as</b> <a href="/System.Management.Automation/A.html#6245dc122e2f1916" class="t t">PSCredential</a>;
            }
 
            <b>if</b> (<span class="r728 r">configurationName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e21ec3eff0232026" class="i field">ConfigRunAsPasswordName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<span class="r730 r">basePsObject</span> != <b>null</b> &amp;&amp; <span class="r730 r">basePsObject</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <span class="i">SecureString</span>)
                {
                    <b>return</b> <span class="r730 r">basePsObject</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as</b> <span class="i">SecureString</span>;
                }
                <b>else</b>
                {
                    <b>string</b> <span id="r732 rd" class="r732 r">error</span> = <b>string</b>.<span class="i">Format</span>(
                        <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;InvalidValueType&quot;</span>),
                        <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e21ec3eff0232026" class="i field">ConfigRunAsPasswordName</a>,
                        <b>typeof</b>(<span class="i">SecureString</span>).<span class="i">FullName</span>);
 
                    <a href="#014253583d795bc0" class="i method">AssertError</a>(<span class="r732 r">error</span>, <b>false</b>);
                    <b>return</b> <b>null</b>;
                }
            }
            <b>else</b> <b>if</b> (<span class="r728 r">configurationName</span>.<span class="i">Equals</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e67a384d08cc8860" class="i field">ConfigRunAsUserName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<span class="r730 r">basePsObject</span> != <b>null</b> &amp;&amp; <span class="r730 r">basePsObject</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is</b> <a href="/System.Management.Automation/A.html#6245dc122e2f1916" class="t t">PSCredential</a>)
                {
                    <b>return</b> <span class="r730 r">basePsObject</span>.<a href="/System.Management.Automation/A.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as</b> <a href="/System.Management.Automation/A.html#6245dc122e2f1916" class="t t">PSCredential</a>;
                }
                <b>else</b> <b>if</b> (<span class="r731 r">psCredential</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r731 r">psCredential</span>;
                }
                <b>else</b>
                {
                    <b>string</b> <span id="r733 rd" class="r733 r">error</span> = <b>string</b>.<span class="i">Format</span>(
                        <a href="#1ecc2fce85e48c9a" class="i field">helper</a>.<a href="WsManHelper.cs.html#f76b4b9703d327db" class="i method">GetResourceMsgFromResourcetext</a>(<span class="s">&quot;InvalidValueType&quot;</span>),
                        <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e67a384d08cc8860" class="i field">ConfigRunAsUserName</a>,
                        <b>typeof</b>(<a href="/System.Management.Automation/A.html#6245dc122e2f1916" class="t t">PSCredential</a>).<span class="i">FullName</span>);
 
                    <a href="#014253583d795bc0" class="i method">AssertError</a>(<span class="r733 r">error</span>, <b>false</b>);
                    <b>return</b> <b>null</b>;
                }
            }
 
            <b>return</b> <span class="r729 r">value</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Appends the plain text value of a SecureString variable to the StringBuilder.</span>
        <span class="c">///</span><span class="c"> if the propertyValue provided is not SecureString appends empty string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r734 r">propertyValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value to append.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="acc5197a7371fd28" href="R/acc5197a7371fd28.html" target="n" data-glyph="76,1" class="i method">GetStringFromSecureString</a>(<b>object</b> <span id="r734 rd" class="r734 r">propertyValue</span>)
        {
            <span class="i">SecureString</span> <span id="r735 rd" class="r735 r">value</span> = <span class="r734 r">propertyValue</span> <b>as</b> <span class="i">SecureString</span>;
            <b>string</b> <span id="r736 rd" class="r736 r">passwordValueToAdd</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (<span class="r735 r">value</span> != <b>null</b>)
            {
                <span class="i">IntPtr</span> <span id="r737 rd" class="r737 r">ptr</span> = <span class="i">Marshal</span>.<span class="i">SecureStringToBSTR</span>(<span class="r735 r">value</span>);
                <span class="r736 r">passwordValueToAdd</span> = <span class="i">Marshal</span>.<span class="i">PtrToStringAuto</span>(<span class="r737 r">ptr</span>);
                <span class="i">Marshal</span>.<span class="i">ZeroFreeBSTR</span>(<span class="r737 r">ptr</span>);
            }
 
            <b>return</b> <span class="r736 r">passwordValueToAdd</span>;
        }
 
        <b>private static string</b> <a id="32173ad9b3cc811a" href="R/32173ad9b3cc811a.html" target="n" data-glyph="76,1" class="i method">ConstructResourceXml</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r738 rd" class="r738 r">objinputparams</span>, <span class="i">ArrayList</span> <span id="r739 rd" class="r739 r">resources</span>, <span class="i">ArrayList</span> <span id="r740 rd" class="r740 r">securities</span>)
        {
            <span class="i">StringBuilder</span> <span id="r741 rd" class="r741 r">sbvalues</span> = <b>new</b> <span class="i">StringBuilder</span>(<b>string</b>.<span class="i">Empty</span>);
            <b>if</b> (<span class="r738 r">objinputparams</span> == <b>null</b> &amp;&amp; <span class="r739 r">resources</span> == <b>null</b>)
            {
                <b>return</b> <span class="r741 r">sbvalues</span>.<span class="i">ToString</span>();
            }
 
            <b>object</b>[] <span id="r742 rd" class="r742 r">capability</span> = <b>null</b>;
            <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;Resources&gt;&quot;</span>);
            <b>if</b> (<span class="r738 r">objinputparams</span> != <b>null</b>)
            {
                <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;Resource&quot;</span>);
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r743 rd" class="r743 r">prop</span> <b>in</b> <span class="r738 r">objinputparams</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>)
                {
                    <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#852f2087a0245e2a" class="i field">SingleWhiteSpace</a>);
                    <b>if</b> (<a href="#0ddca8f346019a3a" class="i method">IsValueOfParamList</a>(<span class="r743 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6eefb60ef4b9d4a2" class="i field">NewItemResourceParams</a>))
                    {
                        <b>if</b> (<span class="r743 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Resource&quot;</span>) || <span class="r743 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;ResourceUri&quot;</span>))
                        {
                            <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;ResourceUri&quot;</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a> + <span class="r743 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>() + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>);
                        }
                        <b>else</b> <b>if</b> (<span class="r743 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Capability&quot;</span>))
                        {
                            <span class="r742 r">capability</span> = (<b>object</b>[])<span class="r743 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>;
                        }
                        <b>else</b>
                        {
                            <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<span class="r743 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>);
                            <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a>);
                            <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a> + <span class="r743 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>() + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>);
                        }
                    }
                }
 
                <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#7525b34dc50c87f8" class="i field">GreaterThan</a>);
                <b>if</b> (<span class="r740 r">securities</span> != <b>null</b>)
                    <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<span class="i">ConstructSecurityXml</span>(<b>null</b>, <span class="r740 r">securities</span>, <b>string</b>.<span class="i">Empty</span>));
                <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<a href="#1da2f8efa0e26066" class="i method">ConstructCapabilityXml</a>(<span class="r742 r">capability</span>));
                <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/Resource&gt;&quot;</span>);
            }
            <b>else</b>
            {
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r744 rd" class="r744 r">p</span> <b>in</b> <span class="r739 r">resources</span>)
                {
                    <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;Resource&quot;</span>);
                    <b>foreach</b> (<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r745 rd" class="r745 r">prop</span> <b>in</b> <span class="r744 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>)
                    {
                        <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#852f2087a0245e2a" class="i field">SingleWhiteSpace</a>);
                        <b>if</b> (<a href="#0ddca8f346019a3a" class="i method">IsValueOfParamList</a>(<span class="r745 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#6eefb60ef4b9d4a2" class="i field">NewItemResourceParams</a>))
                        {
                            <b>if</b> (<span class="r745 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Resource&quot;</span>) || <span class="r745 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;ResourceUri&quot;</span>))
                            {
                                <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;ResourceUri&quot;</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a> + <span class="r745 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>() + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>);
                            }
                            <b>else</b> <b>if</b> (<span class="r745 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Capability&quot;</span>))
                            {
                                <b>if</b> (<span class="r745 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">GetType</span>().<span class="i">FullName</span>.<span class="i">Equals</span>(<span class="s">&quot;System.String&quot;</span>))
                                {
                                    <span class="r742 r">capability</span> = <b>new</b> <b>object</b>[] { <span class="r745 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a> };
                                }
                                <b>else</b>
                                {
                                    <span class="r742 r">capability</span> = (<b>object</b>[])<span class="r745 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>;
                                }
                            }
                            <b>else</b>
                            {
                                <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<span class="r745 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a>);
                                <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a>);
                                <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a> + <span class="r745 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>() + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>);
                            }
                        }
                    }
 
                    <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#7525b34dc50c87f8" class="i field">GreaterThan</a>);
                    <b>if</b> (<span class="r740 r">securities</span> != <b>null</b>)
                        <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<span class="i">ConstructSecurityXml</span>(<b>null</b>, <span class="r740 r">securities</span>, <span class="r744 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>()));
                    <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<a href="#1da2f8efa0e26066" class="i method">ConstructCapabilityXml</a>(<span class="r742 r">capability</span>));
                    <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/Resource&gt;&quot;</span>);
                }
            }
 
            <span class="r741 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/Resources&gt;&quot;</span>);
            <b>return</b> <span class="r741 r">sbvalues</span>.<span class="i">ToString</span>();
        }
 
        <b>private static string</b> <a id="33c176a93fe17d92" href="R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConstructSecurityXml</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r746 rd" class="r746 r">objinputparams</span>, <span class="i">ArrayList</span> <span id="r747 rd" class="r747 r">securities</span>, <b>string</b> <span id="r748 rd" class="r748 r">strResourceIdentity</span>)
        {
            <span class="c">// &lt;Security Uri=&quot;&quot; ExactMatch=&quot;false&quot; Sddl=&quot;O:NSG:BAD:P(A;;GA;;;BA)(A;;GR;;;ER)S:P(AU;FA;GA;;;WD)(AU;SA;GXGW;;;WD)&quot;/&gt;</span>
            <span class="i">StringBuilder</span> <span id="r749 rd" class="r749 r">sbvalues</span> = <b>new</b> <span class="i">StringBuilder</span>(<b>string</b>.<span class="i">Empty</span>);
            <b>if</b> (<span class="r746 r">objinputparams</span> == <b>null</b> &amp;&amp; <span class="r747 r">securities</span> == <b>null</b>)
            {
                <b>return</b> <span class="r749 r">sbvalues</span>.<span class="i">ToString</span>();
            }
 
            <b>if</b> (<span class="r746 r">objinputparams</span> != <b>null</b>)
            {
                <a href="#6f79989102ca98e9" class="i method">AddSecurityProperties</a>(<span class="r746 r">objinputparams</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>, <span class="r749 r">sbvalues</span>);
            }
            <b>else</b>
            {
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r750 rd" class="r750 r">p</span> <b>in</b> <span class="r747 r">securities</span>)
                {
                    <b>if</b> (<span class="r750 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>[<span class="s">&quot;ResourceDir&quot;</span>].<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>().<span class="i">Equals</span>(<span class="r748 r">strResourceIdentity</span>))
                    {
                        <a href="#6f79989102ca98e9" class="i method">AddSecurityProperties</a>(<span class="r750 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>, <span class="r749 r">sbvalues</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r749 r">sbvalues</span>.<span class="i">ToString</span>();
        }
 
        <b>private static void</b> <a id="6f79989102ca98e9" href="R/6f79989102ca98e9.html" target="n" data-glyph="76,1" class="i method">AddSecurityProperties</a>(
            <a href="/System.Management.Automation/A.html#7dc9937a68c9af8c" class="t t">PSMemberInfoCollection</a>&lt;<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>&gt; <span id="r751 rd" class="r751 r">properties</span>,
            <span class="i">StringBuilder</span> <span id="r752 rd" class="r752 r">sbValues</span>)
        {
            <span class="r752 r">sbValues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;Security&quot;</span>);
            <b>foreach</b> (<b>var</b> <span id="r753 rd" class="r753 r">prop</span> <b>in</b> <span class="r751 r">properties</span>)
            {
                <span class="r752 r">sbValues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#852f2087a0245e2a" class="i field">SingleWhiteSpace</a>);
                <b>if</b> (<span class="i">IsValueOfParamList</span>(<span class="r753 r">prop</span>.<span class="i">Name</span>, <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#58613743b4f43f4d" class="i field">NewItemSecurityParams</a>))
                {
                    <span class="c">// Ensure SDDL, which can contain invalid XML characters such as &#39;&amp;&#39;, is escaped.</span>
                    <b>string</b> <span id="r754 rd" class="r754 r">propValueStr</span> = (<span class="r753 r">prop</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;SDDL&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)) ?
                        <span class="i">EscapeValuesForXML</span>(<span class="r753 r">prop</span>.<span class="i">Value</span>.<span class="i">ToString</span>()) :
                        <span class="r753 r">prop</span>.<span class="i">Value</span>.<span class="i">ToString</span>();
 
                    <span class="r752 r">sbValues</span>.<span class="i">Append</span>(<span class="r753 r">prop</span>.<span class="i">Name</span>);
                    <span class="r752 r">sbValues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a>);
                    <span class="r752 r">sbValues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a> + <span class="r754 r">propValueStr</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>);
                }
            }
 
            <span class="r752 r">sbValues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#7525b34dc50c87f8" class="i field">GreaterThan</a>);
            <span class="r752 r">sbValues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/Security&gt;&quot;</span>);
        }
 
        <b>private static string</b> <a id="d7c9c13ade22624f" href="R/d7c9c13ade22624f.html" target="n" data-glyph="76,1" class="i method">ConstructInitParamsXml</a>(<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r755 rd" class="r755 r">objinputparams</span>, <span class="i">ArrayList</span> <span id="r756 rd" class="r756 r">initparams</span>)
        {
            <span class="c">// &lt;InitializationParameters&gt;</span>
            <span class="c">// &lt;Param Name=&quot;Param1&quot; Value=&quot;Value1&quot; /&gt;</span>
            <span class="c">// &lt;/InitializationParameters&gt;</span>
            <span class="i">StringBuilder</span> <span id="r757 rd" class="r757 r">sbvalues</span> = <b>new</b> <span class="i">StringBuilder</span>(<b>string</b>.<span class="i">Empty</span>);
            <b>if</b> (<span class="r755 r">objinputparams</span> == <b>null</b> &amp;&amp; <span class="r756 r">initparams</span> == <b>null</b>)
            {
                <b>return</b> <span class="r757 r">sbvalues</span>.<span class="i">ToString</span>();
            }
 
            <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;InitializationParameters&gt;&quot;</span>);
            <b>if</b> (<span class="r755 r">objinputparams</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r758 rd" class="r758 r">prop</span> <b>in</b> <span class="r755 r">objinputparams</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>)
                {
                    <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;Param&quot;</span>);
                    <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#852f2087a0245e2a" class="i field">SingleWhiteSpace</a>);
                    <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;Name&quot;</span>);
                    <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a>);
                    <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a> + <span class="r758 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>);
                    <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#852f2087a0245e2a" class="i field">SingleWhiteSpace</a>);
                    <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;Value&quot;</span>);
                    <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a>);
                    <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a> + <span class="r758 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>() + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>);
                    <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#442380341c2f3e37" class="i field">XmlClosingTag</a>);
                }
            }
            <b>else</b>
            {
                <b>foreach</b> (<a href="/System.Management.Automation/A.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r759 rd" class="r759 r">p</span> <b>in</b> <span class="r756 r">initparams</span>)
                {
                    <b>foreach</b> (<a href="/System.Management.Automation/A.html#13ab3796654e613c" class="t t">PSPropertyInfo</a> <span id="r760 rd" class="r760 r">prop</span> <b>in</b> <span class="r759 r">p</span>.<a href="/System.Management.Automation/A.html#59e9cd1ad57ccd34" class="i property">Properties</a>)
                    {
                        <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;Param&quot;</span>);
                        <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#852f2087a0245e2a" class="i field">SingleWhiteSpace</a>);
                        <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;Name&quot;</span>);
                        <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a>);
                        <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a> + <span class="r760 r">prop</span>.<a href="/System.Management.Automation/A.html#02d8236d3d236301" class="i property">Name</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>);
                        <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#852f2087a0245e2a" class="i field">SingleWhiteSpace</a>);
                        <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;Value&quot;</span>);
                        <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a>);
                        <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a> + <span class="r760 r">prop</span>.<a href="/System.Management.Automation/A.html#cd3a9989baedf3dd" class="i property">Value</a>.<span class="i">ToString</span>() + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>);
                        <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#442380341c2f3e37" class="i field">XmlClosingTag</a>);
                    }
                }
            }
 
            <span class="r757 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/InitializationParameters&gt;&quot;</span>);
            <b>return</b> <span class="r757 r">sbvalues</span>.<span class="i">ToString</span>();
        }
 
        <b>private static string</b> <a id="1da2f8efa0e26066" href="R/1da2f8efa0e26066.html" target="n" data-glyph="76,1" class="i method">ConstructCapabilityXml</a>(<b>object</b>[] <span id="r761 rd" class="r761 r">capabilities</span>)
        {
            <span class="i">StringBuilder</span> <span id="r762 rd" class="r762 r">sbvalues</span> = <b>new</b> <span class="i">StringBuilder</span>(<b>string</b>.<span class="i">Empty</span>);
            <b>foreach</b> (<b>object</b> <span id="r763 rd" class="r763 r">cap</span> <b>in</b> <span class="r761 r">capabilities</span>)
            {
                <span class="r762 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;Capability&quot;</span>);
                <span class="r762 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#852f2087a0245e2a" class="i field">SingleWhiteSpace</a>);
                <span class="r762 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;Type&quot;</span> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ef01fa65614d4e2f" class="i field">Equalto</a>);
                <span class="r762 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a> + <span class="r763 r">cap</span>.<span class="i">ToString</span>() + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#86b06fb659b17732" class="i field">EnclosingDoubleQuotes</a>);
                <span class="r762 r">sbvalues</span>.<span class="i">Append</span>(<a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#7525b34dc50c87f8" class="i field">GreaterThan</a>);
                <span class="r762 r">sbvalues</span>.<span class="i">Append</span>(<span class="s">&quot;&lt;/Capability&gt;&quot;</span>);
            }
 
            <b>return</b> <span class="r762 r">sbvalues</span>.<span class="i">ToString</span>();
        }
 
        <b>private static bool</b> <a id="0ddca8f346019a3a" href="R/0ddca8f346019a3a.html" target="n" data-glyph="76,1" class="i method">IsValueOfParamList</a>(<b>string</b> <span id="r764 rd" class="r764 r">name</span>, <b>string</b>[] <span id="r765 rd" class="r765 r">paramcontainer</span>)
        {
            <b>bool</b> <span id="r766 rd" class="r766 r">result</span> = <b>false</b>;
            <b>foreach</b> (<b>string</b> <span id="r767 rd" class="r767 r">value</span> <b>in</b> <span class="r765 r">paramcontainer</span>)
            {
                <b>if</b> (<span class="r767 r">value</span>.<span class="i">Equals</span>(<span class="r764 r">name</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r766 r">result</span> = <b>true</b>;
                    <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r766 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Plugin private functions
 
        <b>private enum</b> <a id="ab0c824395b1ca56" href="R/ab0c824395b1ca56.html" target="n" data-glyph="22,1" class="t t"><span id="c9a3486229118ff9">ProviderMethods</span></a>
        {
            <a id="6f48332ff2f66de6" href="R/6f48332ff2f66de6.html" target="n" data-glyph="24,2" class="i field">GetChildItems</a>,
            <a id="77fbbc59dc814203" href="R/77fbbc59dc814203.html" target="n" data-glyph="24,2" class="i field">GetChildNames</a>
        }
 
        <b>private enum</b> <a id="7dde51839226d515" href="R/7dde51839226d515.html" target="n" data-glyph="22,1" class="t t"><span id="9e2196de4038efa4">WsManElementObjectTypes</span></a>
        {
            <a id="ed8179c5c4307879" href="R/ed8179c5c4307879.html" target="n" data-glyph="24,2" class="i field">WSManConfigElement</a>,
            <a id="b90f663a342a8c65" href="R/b90f663a342a8c65.html" target="n" data-glyph="24,2" class="i field">WSManConfigContainerElement</a>,
            <a id="67ccd324568a5d33" href="R/67ccd324568a5d33.html" target="n" data-glyph="24,2" class="i field">WSManConfigLeafElement</a>
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> def
        <b>private static readonly string</b>[] <a id="b34112b4f6fb44e7" href="R/b34112b4f6fb44e7.html" target="n" data-glyph="46,1" class="i field">WinrmRootName</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;winrm/Config&quot;</span> };
 
        <b>private static readonly string</b>[] <a id="f764575b79febe1d" href="R/f764575b79febe1d.html" target="n" data-glyph="46,1" class="i field">WinRmRootConfigs</a> = <b>new</b> <b>string</b>[] {
            <span class="s">&quot;Client&quot;</span>,
            <span class="s">&quot;Service&quot;</span>,
            <span class="s">&quot;Shell&quot;</span>,
            <span class="s">&quot;Listener&quot;</span>,
            <span class="s">&quot;Plugin&quot;</span>,
            <span class="s">&quot;ClientCertificate&quot;</span>
};
 
        <span class="c">// Defining Primarykeys for resource uri&#39;s</span>
        <b>private static readonly string</b>[] <a id="d26439e8d1643cad" href="R/d26439e8d1643cad.html" target="n" data-glyph="46,1" class="i field">PKeyListener</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;Address&quot;</span>, <span class="s">&quot;Transport&quot;</span> };
        <b>private static readonly string</b>[] <a id="5caecb2abb7dd8be" href="R/5caecb2abb7dd8be.html" target="n" data-glyph="46,1" class="i field">PKeyPlugin</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;Name&quot;</span> };
        <b>private static readonly string</b>[] <a id="aee208c83944c3af" href="R/aee208c83944c3af.html" target="n" data-glyph="46,1" class="i field">PKeyCertMapping</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;Issuer&quot;</span>, <span class="s">&quot;Subject&quot;</span>, <span class="s">&quot;Uri&quot;</span> };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> In PPQ display warnings for these configurations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="dc0bbe86e158d91c" href="R/dc0bbe86e158d91c.html" target="n" data-glyph="46,1" class="i field">ppqWarningConfigurations</a> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;
        {
            <span class="s">&quot;idletimeoutms&quot;</span>,
            <span class="s">&quot;maxprocessespershell&quot;</span>,
            <span class="s">&quot;maxmemorypershellmb&quot;</span>,
            <span class="s">&quot;maxshellsperuser&quot;</span>,
            <span class="s">&quot;maxconcurrentusers&quot;</span>
        };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display warning for these configurations.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="4963168d6b750a05" href="R/4963168d6b750a05.html" target="n" data-glyph="46,1" class="i field">globalWarningConfigurations</a> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;
        {
            <span class="s">&quot;maxconcurrentoperationsperuser&quot;</span>,
            <span class="s">&quot;idletimeout&quot;</span>,
            <span class="s">&quot;maxprocessespershell&quot;</span>,
            <span class="s">&quot;maxmemorypershellmb&quot;</span>,
            <span class="s">&quot;maxshellsperuser&quot;</span>,
            <span class="s">&quot;maxconcurrentusers&quot;</span>
        };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Display warning for these URIs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="3b8a2f96104bbd3a" href="R/3b8a2f96104bbd3a.html" target="n" data-glyph="46,1" class="i field">globalWarningUris</a> =
            <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt; {
                <a href="#b34112b4f6fb44e7" class="i field">WinrmRootName</a>[0] + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#a88135c18afb291c" class="i field">WinrmPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#4d3784c76b2cbbcf" class="i field">containerWinrs</a>,
                <a href="#b34112b4f6fb44e7" class="i field">WinrmRootName</a>[0] + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#a88135c18afb291c" class="i field">WinrmPathSeparator</a> + <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#1332bd072f02a398" class="i field">containerService</a>};
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> def
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;Dynamic Parameter Classes&quot;
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;New-Item Dynamic Parameters&quot;
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Computer dynamic parameters. This is similar to connect-wsman parameters.</span>
    <span class="c">///</span><span class="c"> Available path wsman:\&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="70ede7abd56d75a5" href="R/70ede7abd56d75a5.html" target="n" data-glyph="0,0" class="t t"><span id="2e13295d96c75a05">WSManProviderNewItemComputerParameters</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;OptionSet&quot;.</span>
        <span class="c">///</span><span class="c"> OptionSet is a hash table and is used to pass a set of switches to the</span>
        <span class="c">///</span><span class="c"> service to modify or refine the nature of the request.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;OS&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <span class="i">Hashtable</span> <a id="a4bcbabc8062d96f" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">OptionSet</a>
        {
            <b>get</b> { <b>return</b> <a href="#4b7629335583bc0b" class="i field">optionset</a>; }
 
            <b>set</b> { <a href="#4b7629335583bc0b" class="i field">optionset</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Hashtable</span> <a id="4b7629335583bc0b" href="R/4b7629335583bc0b.html" target="n" data-glyph="46,1" class="i field">optionset</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Authentication&quot;.</span>
        <span class="c">///</span><span class="c"> This parameter takes a set of authentication methods the user can select</span>
        <span class="c">///</span><span class="c"> from. The available method are an enum called Authentication in the</span>
        <span class="c">///</span><span class="c"> System.Management.Automation.Runspaces namespace. The available options</span>
        <span class="c">///</span><span class="c"> should be as follows:</span>
        <span class="c">///</span><span class="c"> - Default : Use the default authentication (ad defined by the underlying</span>
        <span class="c">///</span><span class="c"> protocol) for establishing a remote connection.</span>
        <span class="c">///</span><span class="c"> - Negotiate</span>
        <span class="c">///</span><span class="c"> - Kerberos</span>
        <span class="c">///</span><span class="c"> - Basic:  Use basic authentication for establishing a remote connection.</span>
        <span class="c">///</span><span class="c"> -CredSSP: Use CredSSP authentication for establishing a remote connection</span>
        <span class="c">///</span><span class="c"> which will enable the user to perform credential delegation. (i.e. second</span>
        <span class="c">///</span><span class="c"> hop)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <a href="Interop.cs.html#8c52f9e63ca21bfc" class="t t">AuthenticationMechanism</a> <a id="f14708b18ac62924" href="R/f14708b18ac62924.html" target="n" data-glyph="102,1" class="i property">Authentication</a>
        {
            <b>get</b> { <b>return</b> <a href="#7dfd8916c48faf64" class="i field">authentication</a>; }
 
            <b>set</b> { <a href="#7dfd8916c48faf64" class="i field">authentication</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="Interop.cs.html#8c52f9e63ca21bfc" class="t t">AuthenticationMechanism</a> <a id="7dfd8916c48faf64" href="R/7dfd8916c48faf64.html" target="n" data-glyph="46,1" class="i field">authentication</a> = <a href="Interop.cs.html#8c52f9e63ca21bfc" class="t t">AuthenticationMechanism</a>.<a href="Interop.cs.html#f40f6f246e68877b" class="i field">Default</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies the certificate thumbprint to be used to impersonate the user on the</span>
        <span class="c">///</span><span class="c"> remote machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="0b0f8ba468e89cdd" href="R/0b0f8ba468e89cdd.html" target="n" data-glyph="102,1" class="i property">CertificateThumbprint</a>
        {
            <b>get</b> { <b>return</b> <a href="#35776bd36dd781af" class="i field">thumbPrint</a>; }
 
            <b>set</b> { <a href="#35776bd36dd781af" class="i field">thumbPrint</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="35776bd36dd781af" href="R/35776bd36dd781af.html" target="n" data-glyph="46,1" class="i field">thumbPrint</a> = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;SessionOption&quot;.</span>
        <span class="c">///</span><span class="c"> Defines a set of extended options for the WSMan session.  This hashtable can</span>
        <span class="c">///</span><span class="c"> be created using New-WSManSessionOption.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Alias</span>(<span class="s">&quot;SO&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2227:CollectionPropertiesShouldBeReadOnly&quot;</span>)]
        <b>public</b> <a href="/Microsoft.WSMan.Runtime/A.html#0ae1495c5b1dc50e" class="t t">SessionOption</a> <a id="720a47f54e266565" href="R/720a47f54e266565.html" target="n" data-glyph="102,1" class="i property">SessionOption</a>
        {
            <b>get</b> { <b>return</b> <a href="#a6d8b343569f6a60" class="i field">sessionoption</a>; }
 
            <b>set</b> { <a href="#a6d8b343569f6a60" class="i field">sessionoption</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="/Microsoft.WSMan.Runtime/A.html#0ae1495c5b1dc50e" class="t t">SessionOption</a> <a id="a6d8b343569f6a60" href="R/a6d8b343569f6a60.html" target="n" data-glyph="46,1" class="i field">sessionoption</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ApplicationName&quot;.</span>
        <span class="c">///</span><span class="c"> ApplicationName identifies the remote endpoint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;nameSet&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="9cb32e5bc9673529" href="R/9cb32e5bc9673529.html" target="n" data-glyph="102,1" class="i property">ApplicationName</a>
        {
            <b>get</b> { <b>return</b> <a href="#fb293c93af8dc31e" class="i field">applicationname</a>; }
 
            <b>set</b> { <a href="#fb293c93af8dc31e" class="i field">applicationname</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="fb293c93af8dc31e" href="R/fb293c93af8dc31e.html" target="n" data-glyph="46,1" class="i field">applicationname</a> = <span class="s">&quot;wsman&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;Port&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies the port to be used when connecting to the ws management service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;nameSet&quot;</span>)]
        [<span class="i">ValidateRange</span>(1, <b>int</b>.<span class="i">MaxValue</span>)]
        <b>public int</b> <a id="434855edfc5cac35" href="R/434855edfc5cac35.html" target="n" data-glyph="102,1" class="i property">Port</a>
        {
            <b>get</b> { <b>return</b> <a href="#a959a5a371386b00" class="i field">port</a>; }
 
            <b>set</b> { <a href="#a959a5a371386b00" class="i field">port</a> = <b>value</b>; }
        }
 
        <b>private int</b> <a id="a959a5a371386b00" href="R/a959a5a371386b00.html" target="n" data-glyph="46,1" class="i field">port</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;UseSSL&quot;.</span>
        <span class="c">///</span><span class="c"> Uses the Secure Sockets Layer (SSL) protocol to establish a connection to</span>
        <span class="c">///</span><span class="c"> the remote computer. If SSL is not available on the port specified by the</span>
        <span class="c">///</span><span class="c"> Port parameter, the command fails.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;nameSet&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;SSL&quot;</span>)]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="9c8d58cc988a8d40" href="R/9c8d58cc988a8d40.html" target="n" data-glyph="102,1" class="i property">UseSSL</a>
        {
            <b>get</b> { <b>return</b> <a href="#8f6d045640bd1d25" class="i field">usessl</a>; }
 
            <b>set</b> { <a href="#8f6d045640bd1d25" class="i field">usessl</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="8f6d045640bd1d25" href="R/8f6d045640bd1d25.html" target="n" data-glyph="46,1" class="i field">usessl</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The following is the definition of the input parameter &quot;ConnectionURI&quot;.</span>
        <span class="c">///</span><span class="c"> Specifies the transport, server, port, and ApplicationName of the new</span>
        <span class="c">///</span><span class="c"> runspace. The format of this string is:</span>
        <span class="c">///</span><span class="c"> transport://server:port/ApplicationName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;pathSet&quot;</span>, <a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;URI&quot;</span>)]
        <b>public</b> <span class="i">Uri</span> <a id="7855d648dbe43688" href="R/7855d648dbe43688.html" target="n" data-glyph="102,1" class="i property">ConnectionURI</a>
        {
            <b>get</b> { <b>return</b> <a href="#70acfc5e17446f00" class="i field">connectionuri</a>; }
 
            <b>set</b> { <a href="#70acfc5e17446f00" class="i field">connectionuri</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i">Uri</span> <a id="70acfc5e17446f00" href="R/70acfc5e17446f00.html" target="n" data-glyph="46,1" class="i field">connectionuri</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Plugin Dynamic parameter. There are 2 parameter sets.</span>
    <span class="c">///</span><span class="c"> Path - WSMan:\Localhost\Plugin&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Plugin&quot;</span>)]
    <b>public class</b> <a id="aa6c75de9e5499e4" href="R/aa6c75de9e5499e4.html" target="n" data-glyph="0,0" class="t t"><span id="6c71c810a963db00">WSManProviderNewItemPluginParameters</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Plugin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;pathSet&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Plugin&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="0bd1436aaecc298a" href="R/0bd1436aaecc298a.html" target="n" data-glyph="102,1" class="i property">Plugin</a>
        {
            <b>get</b> { <b>return</b> <a href="#988140bbc52a38cd" class="i field">_plugin</a>; }
 
            <b>set</b> { <a href="#988140bbc52a38cd" class="i field">_plugin</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="988140bbc52a38cd" href="R/988140bbc52a38cd.html" target="n" data-glyph="46,1" class="i field">_plugin</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter FileName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;pathSet&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="7169fbfe52fc4b6a" href="R/7169fbfe52fc4b6a.html" target="n" data-glyph="102,1" class="i property">FileName</a>
        {
            <b>get</b> { <b>return</b> <a href="#2c27c5d9f9e50aae" class="i field">_filename</a>; }
 
            <b>set</b> { <a href="#2c27c5d9f9e50aae" class="i field">_filename</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="2c27c5d9f9e50aae" href="R/2c27c5d9f9e50aae.html" target="n" data-glyph="46,1" class="i field">_filename</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter SDKVersion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;pathSet&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;SDK&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="73613a6b450d5492" href="R/73613a6b450d5492.html" target="n" data-glyph="102,1" class="i property">SDKVersion</a>
        {
            <b>get</b> { <b>return</b> <a href="#2155ac8a257e0d86" class="i field">_sdkversion</a>; }
 
            <b>set</b> { <a href="#2155ac8a257e0d86" class="i field">_sdkversion</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="2155ac8a257e0d86" href="R/2155ac8a257e0d86.html" target="n" data-glyph="46,1" class="i field">_sdkversion</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;pathSet&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i n">System</span>.<span class="i">Uri</span> <a id="4a339856e5cf45aa" href="R/4a339856e5cf45aa.html" target="n" data-glyph="102,1" class="i property">Resource</a>
        {
            <b>get</b> { <b>return</b> <a href="#5c2bcb77c77261dc" class="i field">_resourceuri</a>; }
 
            <b>set</b> { <a href="#5c2bcb77c77261dc" class="i field">_resourceuri</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i n">System</span>.<span class="i">Uri</span> <a id="5c2bcb77c77261dc" href="R/5c2bcb77c77261dc.html" target="n" data-glyph="46,1" class="i field">_resourceuri</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Capability.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;pathSet&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public object</b>[] <a id="3cc8b03a048d7ad1" href="R/3cc8b03a048d7ad1.html" target="n" data-glyph="102,1" class="i property">Capability</a>
        {
            <b>get</b> { <b>return</b> <a href="#98ff330ef70952c1" class="i field">_capability</a>; }
 
            <b>set</b> { <a href="#98ff330ef70952c1" class="i field">_capability</a> = <b>value</b>; }
        }
 
        <b>private object</b>[] <a id="98ff330ef70952c1" href="R/98ff330ef70952c1.html" target="n" data-glyph="46,1" class="i field">_capability</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter XMLRenderingType.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;pathSet&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;XML&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="8b15a11f82d2fb3f" href="R/8b15a11f82d2fb3f.html" target="n" data-glyph="102,1" class="i property">XMLRenderingType</a>
        {
            <b>get</b> { <b>return</b> <a href="#7ae92a1b5621a074" class="i field">_xmlRenderingtype</a>; }
 
            <b>set</b> { <a href="#7ae92a1b5621a074" class="i field">_xmlRenderingtype</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="7ae92a1b5621a074" href="R/7ae92a1b5621a074.html" target="n" data-glyph="46,1" class="i field">_xmlRenderingtype</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter File.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#91bee819daab0925" class="i property">ParameterSetName</a> = <span class="s">&quot;nameSet&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="fc231c2e9d30d62b" href="R/fc231c2e9d30d62b.html" target="n" data-glyph="102,1" class="i property">File</a>
        {
            <b>get</b> { <b>return</b> <a href="#f23be42530f28604" class="i field">_file</a>; }
 
            <b>set</b> { <a href="#f23be42530f28604" class="i field">_file</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="f23be42530f28604" href="R/f23be42530f28604.html" target="n" data-glyph="46,1" class="i field">_file</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter for RunAs credentials for a Plugin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">ValidateNotNull</span>]
        [<span class="i">Parameter</span>()]
        <b>public</b> <a href="/System.Management.Automation/A.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="e630c30cbcef5d03" href="R/e630c30cbcef5d03.html" target="n" data-glyph="102,1" class="i property">RunAsCredential</a>
        {
            <b>get</b> { <b>return</b> <a href="#aa6c75de9e5499e4" class="k">this</a>.<a href="#d832d17e6c5c726e" class="i field">runAsCredentials</a>; }
 
            <b>set</b> { <a href="#aa6c75de9e5499e4" class="k">this</a>.<a href="#d832d17e6c5c726e" class="i field">runAsCredentials</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#6245dc122e2f1916" class="t t">PSCredential</a> <a id="d832d17e6c5c726e" href="R/d832d17e6c5c726e.html" target="n" data-glyph="46,1" class="i field">runAsCredentials</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter for Plugin Host Process configuration (Shared or Separate).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="03ac5177e0fb6672" href="R/03ac5177e0fb6672.html" target="n" data-glyph="102,1" class="i property">UseSharedProcess</a>
        {
            <b>get</b> { <b>return</b> <a href="#aa6c75de9e5499e4" class="k">this</a>.<a href="#47a21cf22ea38825" class="i field">sharedHost</a>; }
 
            <b>set</b> { <a href="#aa6c75de9e5499e4" class="k">this</a>.<a href="#47a21cf22ea38825" class="i field">sharedHost</a> = <b>value</b>; }
        }
 
        <b>private bool</b> <a id="47a21cf22ea38825" href="R/47a21cf22ea38825.html" target="n" data-glyph="46,1" class="i field">sharedHost</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter for Auto Restart configuration for Plugin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="bca3e415c5843ba8" href="R/bca3e415c5843ba8.html" target="n" data-glyph="102,1" class="i property">AutoRestart</a>
        {
            <b>get</b> { <b>return</b> <a href="#aa6c75de9e5499e4" class="k">this</a>.<a href="#15525882c24a462a" class="i field">autoRestart</a>; }
 
            <b>set</b> { <a href="#aa6c75de9e5499e4" class="k">this</a>.<a href="#15525882c24a462a" class="i field">autoRestart</a> = <b>value</b>; }
        }
 
        <b>private bool</b> <a id="15525882c24a462a" href="R/15525882c24a462a.html" target="n" data-glyph="46,1" class="i field">autoRestart</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter for Idle timeout for HostProcess.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public uint</b>? <a id="e8300f9a70d77ddf" href="R/e8300f9a70d77ddf.html" target="n" data-glyph="102,1" class="i property">ProcessIdleTimeoutSec</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#aa6c75de9e5499e4" class="k">this</a>.<a href="#3dc6f21e2a7d7237" class="i field">processIdleTimeoutSeconds</a>;
            }
 
            <b>set</b>
            {
                <a href="#aa6c75de9e5499e4" class="k">this</a>.<a href="#3dc6f21e2a7d7237" class="i field">processIdleTimeoutSeconds</a> = <b>value</b>;
            }
        }
 
        <b>private uint</b>? <a id="3dc6f21e2a7d7237" href="R/3dc6f21e2a7d7237.html" target="n" data-glyph="46,1" class="i field">processIdleTimeoutSeconds</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Initparameters dynamic parameters</span>
    <span class="c">///</span><span class="c"> Path - wsman:\localhost\plugin\[specified plugin]\Initializationparameters&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="eb443521d8dca58e" href="R/eb443521d8dca58e.html" target="n" data-glyph="0,0" class="t t"><span id="51738c01e1dfa2b7">WSManProviderInitializeParameters</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter ParamName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Param&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 0)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="125e0b85de6c1982" href="R/125e0b85de6c1982.html" target="n" data-glyph="102,1" class="i property">ParamName</a>
        {
            <b>get</b> { <b>return</b> <a href="#02bc6b32579d7960" class="i field">_paramname</a>; }
 
            <b>set</b> { <a href="#02bc6b32579d7960" class="i field">_paramname</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="02bc6b32579d7960" href="R/02bc6b32579d7960.html" target="n" data-glyph="46,1" class="i field">_paramname</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter ParamValue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Param&quot;</span>)]
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>, <a href="/System.Management.Automation/A.html#19ccfeb1cdbdb967" class="i property">Position</a> = 1)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="fa61a70017b7fcb0" href="R/fa61a70017b7fcb0.html" target="n" data-glyph="102,1" class="i property">ParamValue</a>
        {
            <b>get</b> { <b>return</b> <a href="#ec227eec8a7ce29d" class="i field">_paramvalue</a>; }
 
            <b>set</b> { <a href="#ec227eec8a7ce29d" class="i field">_paramvalue</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="ec227eec8a7ce29d" href="R/ec227eec8a7ce29d.html" target="n" data-glyph="46,1" class="i field">_paramvalue</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Dynamic parameter for Resource Item.</span>
    <span class="c">///</span><span class="c"> Path - WsMAn:\localhost\Plugin\[Specified Plugin]\Resources&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="b467d3e1e1ddfbf2" href="R/b467d3e1e1ddfbf2.html" target="n" data-glyph="0,0" class="t t"><span id="055583a5b2d7fd53">WSManProviderNewItemResourceParameters</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter ResourceUri.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i n">System</span>.<span class="i">Uri</span> <a id="a453deb935a43c3b" href="R/a453deb935a43c3b.html" target="n" data-glyph="102,1" class="i property">ResourceUri</a>
        {
            <b>get</b> { <b>return</b> <a href="#efb3ae1fa16a949f" class="i field">_resourceuri</a>; }
 
            <b>set</b> { <a href="#efb3ae1fa16a949f" class="i field">_resourceuri</a> = <b>value</b>; }
        }
 
        <b>private</b> <span class="i n">System</span>.<span class="i">Uri</span> <a id="efb3ae1fa16a949f" href="R/efb3ae1fa16a949f.html" target="n" data-glyph="46,1" class="i field">_resourceuri</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Capability.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public object</b>[] <a id="1d89cd2c08910558" href="R/1d89cd2c08910558.html" target="n" data-glyph="102,1" class="i property">Capability</a>
        {
            <b>get</b> { <b>return</b> <a href="#c084daea02cd55ee" class="i field">_capability</a>; }
 
            <b>set</b> { <a href="#c084daea02cd55ee" class="i field">_capability</a> = <b>value</b>; }
        }
 
        <b>private object</b>[] <a id="c084daea02cd55ee" href="R/c084daea02cd55ee.html" target="n" data-glyph="46,1" class="i field">_capability</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Security Dynamic Parameters</span>
    <span class="c">///</span><span class="c"> Path - WsMan:\Localhost\Plugin\[Specified Plugin]\Resources\[Specified Resource]\Security&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="c5eac800920ee82b" href="R/c5eac800920ee82b.html" target="n" data-glyph="0,0" class="t t"><span id="efa896b23d093a19">WSManProviderNewItemSecurityParameters</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Sddl.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1704:IdentifiersShouldBeSpelledCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;Sddl&quot;</span>)]
        <b>public string</b> <a id="5497f75853286041" href="R/5497f75853286041.html" target="n" data-glyph="102,1" class="i property">Sddl</a>
        {
            <b>get</b> { <b>return</b> <a href="#0f7481ab0394366c" class="i field">_sddl</a>; }
 
            <b>set</b> { <a href="#0f7481ab0394366c" class="i field">_sddl</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="0f7481ab0394366c" href="R/0f7481ab0394366c.html" target="n" data-glyph="46,1" class="i field">_sddl</a>;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;ClientCertificate Dynamic Parameters&quot;
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Client Certificate Dynamic Parameters</span>
    <span class="c">///</span><span class="c"> Path - WsMan:\Localhost\ClientCertificate.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="210215a4137617df" href="R/210215a4137617df.html" target="n" data-glyph="0,0" class="t t"><span id="1e5c245da99cfa8b">WSManProviderClientCertificateParameters</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Issuer.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="f1042b34978b052f" href="R/f1042b34978b052f.html" target="n" data-glyph="102,1" class="i property">Issuer</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e531e0c9927cf3d6" class="i field">_issuer</a>;
            }
 
            <b>set</b>
            {
                <a href="#e531e0c9927cf3d6" class="i field">_issuer</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="e531e0c9927cf3d6" href="R/e531e0c9927cf3d6.html" target="n" data-glyph="46,1" class="i field">_issuer</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Subject.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="199592cf5d04e9b2" href="R/199592cf5d04e9b2.html" target="n" data-glyph="102,1" class="i property">Subject</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#826ccf05c7bf4912" class="i field">_subject</a>;
            }
 
            <b>set</b>
            {
                <a href="#826ccf05c7bf4912" class="i field">_subject</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="826ccf05c7bf4912" href="R/826ccf05c7bf4912.html" target="n" data-glyph="46,1" class="i field">_subject</a> = <span class="s">&quot;*&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter URI.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;URI&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public</b> <span class="i n">System</span>.<span class="i">Uri</span> <a id="767cd4a3df7e8acc" href="R/767cd4a3df7e8acc.html" target="n" data-glyph="102,1" class="i property">URI</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4c692720f53c2de8" class="i field">_uri</a>;
            }
 
            <b>set</b>
            {
                <a href="#4c692720f53c2de8" class="i field">_uri</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i n">System</span>.<span class="i">Uri</span> <a id="4c692720f53c2de8" href="R/4c692720f53c2de8.html" target="n" data-glyph="46,1" class="i field">_uri</a> = <b>new</b> <span class="i">Uri</span>(<span class="s">&quot;*&quot;</span>, <span class="i">UriKind</span>.<span class="i">RelativeOrAbsolute</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public bool</b> <a id="c89e86d68cc29575" href="R/c89e86d68cc29575.html" target="n" data-glyph="102,1" class="i property">Enabled</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#d030f9f96e75bba4" class="i field">_enabled</a>;
            }
 
            <b>set</b>
            {
                <a href="#d030f9f96e75bba4" class="i field">_enabled</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b> <a id="d030f9f96e75bba4" href="R/d030f9f96e75bba4.html" target="n" data-glyph="46,1" class="i field">_enabled</a> = <b>true</b>;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Listener Dynamic Parameters
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Listener Dynamic parameters</span>
    <span class="c">///</span><span class="c"> Path - WsMan:\Localhost\Listener&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="6e1f052e90ea0d50" href="R/6e1f052e90ea0d50.html" target="n" data-glyph="0,0" class="t t"><span id="f27d97677f9a08a4">WSManProvidersListenerParameters</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Address.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="6e27f2d5a39f4281" href="R/6e27f2d5a39f4281.html" target="n" data-glyph="102,1" class="i property">Address</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#fe6ff94a62582ca7" class="i field">_address</a>;
            }
 
            <b>set</b>
            {
                <a href="#fe6ff94a62582ca7" class="i field">_address</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="fe6ff94a62582ca7" href="R/fe6ff94a62582ca7.html" target="n" data-glyph="46,1" class="i field">_address</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Transport.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>(<a href="/System.Management.Automation/A.html#d5ad471518092731" class="i property">Mandatory</a> = <b>true</b>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="a3d54138a555cc2e" href="R/a3d54138a555cc2e.html" target="n" data-glyph="102,1" class="i property">Transport</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#40ccb198fe6b32e7" class="i field">_transport</a>;
            }
 
            <b>set</b>
            {
                <a href="#40ccb198fe6b32e7" class="i field">_transport</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="40ccb198fe6b32e7" href="R/40ccb198fe6b32e7.html" target="n" data-glyph="46,1" class="i field">_transport</a> = <span class="s">&quot;http&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Port.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public int</b> <a id="855207f91a032d9a" href="R/855207f91a032d9a.html" target="n" data-glyph="102,1" class="i property">Port</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f456e6b1f293c5ba" class="i field">_port</a>;
            }
 
            <b>set</b>
            {
                <a href="#f456e6b1f293c5ba" class="i field">_port</a> = <b>value</b>;
                <a href="#638798135926619f" class="i field">_IsPortSpecified</a> = <b>true</b>;
            }
        }
 
        <b>private int</b> <a id="f456e6b1f293c5ba" href="R/f456e6b1f293c5ba.html" target="n" data-glyph="46,1" class="i field">_port</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter HostName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="ddb76bbc9bf6650e" href="R/ddb76bbc9bf6650e.html" target="n" data-glyph="102,1" class="i property">HostName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#61b5e3bce0bb0e79" class="i field">_hostName</a>;
            }
 
            <b>set</b>
            {
                <a href="#61b5e3bce0bb0e79" class="i field">_hostName</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="61b5e3bce0bb0e79" href="R/61b5e3bce0bb0e79.html" target="n" data-glyph="46,1" class="i field">_hostName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        <b>public bool</b> <a id="686e87d7f518c591" href="R/686e87d7f518c591.html" target="n" data-glyph="102,1" class="i property">Enabled</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#1f9d23c69889bf68" class="i field">_enabled</a>;
            }
 
            <b>set</b>
            {
                <a href="#1f9d23c69889bf68" class="i field">_enabled</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b> <a id="1f9d23c69889bf68" href="R/1f9d23c69889bf68.html" target="n" data-glyph="46,1" class="i field">_enabled</a> = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter URLPrefix.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1709:IdentifiersShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;URL&quot;</span>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1056:UriPropertiesShouldNotBeStrings&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="c28f431d230a0fad" href="R/c28f431d230a0fad.html" target="n" data-glyph="102,1" class="i property">URLPrefix</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#a01b4f0377c04e3b" class="i field">_urlprefix</a>;
            }
 
            <b>set</b>
            {
                <a href="#a01b4f0377c04e3b" class="i field">_urlprefix</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="a01b4f0377c04e3b" href="R/a01b4f0377c04e3b.html" target="n" data-glyph="46,1" class="i field">_urlprefix</a> = <span class="s">&quot;wsman&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter CertificateThumbPrint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>, <span class="i">MessageId</span> = <span class="s">&quot;ThumbPrint&quot;</span>)]
        [<span class="i">ValidateNotNullOrEmpty</span>]
        <b>public string</b> <a id="8deea4708be30906" href="R/8deea4708be30906.html" target="n" data-glyph="102,1" class="i property">CertificateThumbPrint</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#96165387f70543ab" class="i field">_certificatethumbprint</a>;
            }
 
            <b>set</b>
            {
                <a href="#96165387f70543ab" class="i field">_certificatethumbprint</a> = <b>value</b>;
            }
        }
 
        <b>private string</b> <a id="96165387f70543ab" href="R/96165387f70543ab.html" target="n" data-glyph="46,1" class="i field">_certificatethumbprint</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Variable IsPortSpecified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="591de7e5c80b3d56" href="R/591de7e5c80b3d56.html" target="n" data-glyph="102,1" class="i property">IsPortSpecified</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#638798135926619f" class="i field">_IsPortSpecified</a>;
            }
 
            <b>set</b>
            {
                <a href="#638798135926619f" class="i field">_IsPortSpecified</a> = <b>value</b>;
            }
        }
 
        <b>private bool</b> <a id="638798135926619f" href="R/638798135926619f.html" target="n" data-glyph="46,1" class="i field">_IsPortSpecified</a> = <b>false</b>;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> SetItemDynamicParameters
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Set-Item Dynamic parameters</span>
    <span class="c">///</span><span class="c"> Path - WsMan:\Localhost\Client&gt; Set-Item .\TrustedHosts.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="21a58035dfb1e35f" href="R/21a58035dfb1e35f.html" target="n" data-glyph="0,0" class="t t"><span id="afe5543edbddf087">WSManProviderSetItemDynamicParameters</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter Concatenate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">Parameter</span>()]
        <b>public</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="78a02c044d8ad01d" href="R/78a02c044d8ad01d.html" target="n" data-glyph="102,1" class="i property">Concatenate</a>
        {
            <b>get</b> { <b>return</b> <a href="#9eca68467804ac62" class="i field">_concatenate</a>; }
 
            <b>set</b> { <a href="#9eca68467804ac62" class="i field">_concatenate</a> = <b>value</b>; }
        }
 
        <b>private</b> <a href="/System.Management.Automation/A.html#8260026027378f6c" class="t t">SwitchParameter</a> <a id="9eca68467804ac62" href="R/9eca68467804ac62.html" target="n" data-glyph="46,1" class="i field">_concatenate</a> = <b>false</b>;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> SetItemDynamicParameters
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;String Literals&quot;
 
    <b>internal static class</b> <a id="ac28f281b583d512" href="R/ac28f281b583d512.html" target="n" data-glyph="2,0" class="t t">WSManStringLiterals</a>
    {
        <span class="c">// constants</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The default path separator used by the base implementation of the providers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const char</b> <a id="27c73798299c80d0" href="R/27c73798299c80d0.html" target="n" data-glyph="8,1" class="i field">DefaultPathSeparator</a> = <span class="s">&#39;\\&#39;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The alternate path separator used by the base implementation of the providers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const char</b> <a id="88ad0c8bbed7bb7f" href="R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">AlternatePathSeparator</a> = <span class="s">&#39;/&#39;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Double Quotes used while constructing XML.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const char</b> <a id="86b06fb659b17732" href="R/86b06fb659b17732.html" target="n" data-glyph="8,1" class="i field">EnclosingDoubleQuotes</a> = <span class="s">&#39;\&quot;&#39;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Equalto Used while constructing XML.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const char</b> <a id="ef01fa65614d4e2f" href="R/ef01fa65614d4e2f.html" target="n" data-glyph="8,1" class="i field">Equalto</a> = <span class="s">&#39;=&#39;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For XML Construction.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const char</b> <a id="7525b34dc50c87f8" href="R/7525b34dc50c87f8.html" target="n" data-glyph="8,1" class="i field">GreaterThan</a> = <span class="s">&#39;&gt;&#39;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> XML Closing Tag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="442380341c2f3e37" href="R/442380341c2f3e37.html" target="n" data-glyph="8,1" class="i field">XmlClosingTag</a> = <span class="s">&quot;/&gt;&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> White space used while constructing XML.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const char</b> <a id="852f2087a0245e2a" href="R/852f2087a0245e2a.html" target="n" data-glyph="8,1" class="i field">SingleWhiteSpace</a> = <span class="s">&#39; &#39;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Root node of WsMan.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="b9823ecab71df44a" href="R/b9823ecab71df44a.html" target="n" data-glyph="8,1" class="i field">ProviderName</a> = <span class="s">&quot;WSMan&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="2bf6a0f44c2ec8e9" href="R/2bf6a0f44c2ec8e9.html" target="n" data-glyph="8,1" class="i field">WsMan_Schema</a> = <span class="s">&quot;http://schemas.microsoft.com/wbem/wsman/1/config&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="76a180dda0d27567" href="R/76a180dda0d27567.html" target="n" data-glyph="8,1" class="i field">NS_XSI</a> = <span class="s">&quot;xmlns:xsi=&quot;</span> + <span class="s">&quot;\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot;&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="5e4a0d70ac22b8ef" href="R/5e4a0d70ac22b8ef.html" target="n" data-glyph="8,1" class="i field">ATTR_NIL</a> = <span class="s">&quot;xsi:nil=&quot;</span> + <span class="s">&quot;\&quot;true\&quot;&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="cfee78e23f397431" href="R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">ATTR_NIL_NAME</a> = <span class="s">&quot;xsi:nil&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const char</b> <a id="a88135c18afb291c" href="R/a88135c18afb291c.html" target="n" data-glyph="8,1" class="i field">WinrmPathSeparator</a> = <span class="s">&#39;/&#39;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="ff28b0893dfbf7d2" href="R/ff28b0893dfbf7d2.html" target="n" data-glyph="8,1" class="i field">rootpath</a> = <span class="s">&quot;WSMan&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="5ddadbcc285617b8" href="R/5ddadbcc285617b8.html" target="n" data-glyph="8,1" class="i field">ContainerChildValue</a> = <span class="s">&quot;Container&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> WsMan Containers
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Plugin Container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="d49ea60b914da0fa" href="R/d49ea60b914da0fa.html" target="n" data-glyph="8,1" class="i field">containerPlugin</a> = <span class="s">&quot;Plugin&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Client Container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="65ec6609d9d215e7" href="R/65ec6609d9d215e7.html" target="n" data-glyph="8,1" class="i field">containerClient</a> = <span class="s">&quot;Client&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Shell Container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="889838e923e5bdb8" href="R/889838e923e5bdb8.html" target="n" data-glyph="8,1" class="i field">containerShell</a> = <span class="s">&quot;Shell&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ClientCertificate Container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="295af3cb4f2d9311" href="R/295af3cb4f2d9311.html" target="n" data-glyph="8,1" class="i field">containerClientCertificate</a> = <span class="s">&quot;ClientCertificate&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Listener Container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="8a314c877e5e4804" href="R/8a314c877e5e4804.html" target="n" data-glyph="8,1" class="i field">containerListener</a> = <span class="s">&quot;Listener&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Service Container.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="1332bd072f02a398" href="R/1332bd072f02a398.html" target="n" data-glyph="8,1" class="i field">containerService</a> = <span class="s">&quot;Service&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Auth Container - Under Client,Service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="492bc1a90a696ed1" href="R/492bc1a90a696ed1.html" target="n" data-glyph="8,1" class="i field">containerAuth</a> = <span class="s">&quot;Auth&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> DefaultPorts Container - Under Client,Service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="c946bcc82c5ee36c" href="R/c946bcc82c5ee36c.html" target="n" data-glyph="8,1" class="i field">containerDefaultPorts</a> = <span class="s">&quot;DefaultPorts&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TrustedHosts Container - Under Client,Service.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="14caf545f3eccbf9" href="R/14caf545f3eccbf9.html" target="n" data-glyph="8,1" class="i field">containerTrustedHosts</a> = <span class="s">&quot;TrustedHosts&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Security Container - Under Plugin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="f0909f094747b743" href="R/f0909f094747b743.html" target="n" data-glyph="8,1" class="i field">containerSecurity</a> = <span class="s">&quot;Security&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resources Container - Under Plugin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="6a5b72adecd2a1f0" href="R/6a5b72adecd2a1f0.html" target="n" data-glyph="8,1" class="i field">containerResources</a> = <span class="s">&quot;Resources&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resource in Resources Container - Under Plugin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="039e73f615517a0d" href="R/039e73f615517a0d.html" target="n" data-glyph="8,1" class="i field">containerSingleResource</a> = <span class="s">&quot;Resource&quot;</span>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InitParameters Container - Under Plugin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="b5fc579b23b96bda" href="R/b5fc579b23b96bda.html" target="n" data-glyph="8,1" class="i field">containerInitParameters</a> = <span class="s">&quot;InitializationParameters&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Quotas Container - Under Plugin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="9326032a5ad16c2c" href="R/9326032a5ad16c2c.html" target="n" data-glyph="8,1" class="i field">containerQuotasParameters</a> = <span class="s">&quot;Quotas&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Winrs Container - Exposed as Shell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="4d3784c76b2cbbcf" href="R/4d3784c76b2cbbcf.html" target="n" data-glyph="8,1" class="i field">containerWinrs</a> = <span class="s">&quot;Winrs&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Certmapping Container - Exposed as ClientCertificate in the provider.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="22940af130242689" href="R/22940af130242689.html" target="n" data-glyph="8,1" class="i field">containerCertMapping</a> = <span class="s">&quot;Service/certmapping&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Possible Values in Plugin Top Level XML.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static readonly string</b>[] <a id="18d3668922a97d85" href="R/18d3668922a97d85.html" target="n" data-glyph="44,1" class="i field">NewItemPluginConfigParams</a> =
            <b>new</b> <b>string</b>[] {
                <span class="s">&quot;Name&quot;</span>,
                <span class="s">&quot;Filename&quot;</span>,
                <span class="s">&quot;SDKVersion&quot;</span>,
                <span class="s">&quot;XmlRenderingType&quot;</span>,
                <span class="s">&quot;Enabled&quot;</span>,
                <span class="s">&quot;Architecture&quot;</span>,
                <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e21ec3eff0232026" class="i field">ConfigRunAsPasswordName</a>,
                <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#e67a384d08cc8860" class="i field">ConfigRunAsUserName</a>,
                <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ca014d659e5a3983" class="i field">ConfigAutoRestart</a>,
                <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#c6c96905857e0bb8" class="i field">ConfigProcessIdleTimeoutSec</a>,
                <a href="#ac28f281b583d512" class="t t">WSManStringLiterals</a>.<a href="#ecafb34fb9e28b33" class="i field">ConfigUseSharedProcess</a>,
            };
 
        <span class="c">///</span><span class="c"> Possible Values in Plugin Top Resources XML</span>
        <b>internal static readonly string</b>[] <a id="6eefb60ef4b9d4a2" href="R/6eefb60ef4b9d4a2.html" target="n" data-glyph="44,1" class="i field">NewItemResourceParams</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;Resource&quot;</span>, <span class="s">&quot;ResourceUri&quot;</span>, <span class="s">&quot;Capability&quot;</span>, <span class="s">&quot;ExactMatch&quot;</span>, <span class="s">&quot;SupportsOptions&quot;</span> };
 
        <span class="c">///</span><span class="c"> Possible Values in Plugin Top Init Param XML</span>
        <b>internal static readonly string</b>[] <a id="8393f188cdbbe701" href="R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">NewItemInitParamsParams</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;Name&quot;</span>, <span class="s">&quot;Value&quot;</span> };
 
        <span class="c">///</span><span class="c"> Possible Values in Plugin Top Security XML</span>
        <b>internal static readonly string</b>[] <a id="58613743b4f43f4d" href="R/58613743b4f43f4d.html" target="n" data-glyph="44,1" class="i field">NewItemSecurityParams</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;Uri&quot;</span>, <span class="s">&quot;Sddl&quot;</span>, <span class="s">&quot;ExactMatch&quot;</span> };
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> WsMan Containers
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> WSMAN Config Names
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the configuration which represents RunAs Password.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="e21ec3eff0232026" href="R/e21ec3eff0232026.html" target="n" data-glyph="8,1" class="i field">ConfigRunAsPasswordName</a> = <span class="s">&quot;RunAsPassword&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the configuration which represents RunAs Name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="e67a384d08cc8860" href="R/e67a384d08cc8860.html" target="n" data-glyph="8,1" class="i field">ConfigRunAsUserName</a> = <span class="s">&quot;RunAsUser&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the configuration which represents if HostProcess is shared or separate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="ecafb34fb9e28b33" href="R/ecafb34fb9e28b33.html" target="n" data-glyph="8,1" class="i field">ConfigUseSharedProcess</a> = <span class="s">&quot;UseSharedProcess&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the configuration which represents if AutoRestart is enabled or not.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="ca014d659e5a3983" href="R/ca014d659e5a3983.html" target="n" data-glyph="8,1" class="i field">ConfigAutoRestart</a> = <span class="s">&quot;AutoRestart&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the configuration which represents the Host Idle Timeout in seconds.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="c6c96905857e0bb8" href="R/c6c96905857e0bb8.html" target="n" data-glyph="8,1" class="i field">ConfigProcessIdleTimeoutSec</a> = <span class="s">&quot;ProcessIdleTimeoutSec&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the configuration which represents the Resource URI for a Resource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="b0fbc7a19c627e9d" href="R/b0fbc7a19c627e9d.html" target="n" data-glyph="8,1" class="i field">ConfigResourceUriName</a> = <span class="s">&quot;ResourceUri&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the tag which represents a initialization parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="6737e82eb35b72e4" href="R/6737e82eb35b72e4.html" target="n" data-glyph="8,1" class="i field">ConfigInitializeParameterTag</a> = <span class="s">&quot;Param&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the tag which represents Name of the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="5dba89aff32f02c7" href="R/5dba89aff32f02c7.html" target="n" data-glyph="8,1" class="i field">ConfigInitializeParameterName</a> = <span class="s">&quot;Name&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the tag which represents Value of the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="48d6cbce0d4f779f" href="R/48d6cbce0d4f779f.html" target="n" data-glyph="8,1" class="i field">ConfigInitializeParameterValue</a> = <span class="s">&quot;Value&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the tag which represents a Security URI.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="d3da42830aea3e5b" href="R/d3da42830aea3e5b.html" target="n" data-glyph="8,1" class="i field">ConfigSecurityUri</a> = <span class="s">&quot;Uri&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the tag which represents a Security URI.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="6fdea0ea28374520" href="R/6fdea0ea28374520.html" target="n" data-glyph="8,1" class="i field">HiddenSuffixForSourceOfValue</a> = <span class="s">&quot;___Source&quot;</span>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is used to start the service. return a bool value. if false we throw error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public const string</b> <a id="52bb435eef0d3204" href="R/52bb435eef0d3204.html" target="n" data-glyph="6,1" class="i field">StartWinrmServiceSBFormat</a> = <span class="s">@&quot;
function Start-WSManServiceD15A7957836142a18627D7E1D342DD82
{{
[CmdletBinding()]
param(
    [Parameter()]
    [bool]
    $Force,
 
    [Parameter()]
    [string]
    $captionForStart,
 
    [Parameter()]
    [string]
    $queryForStart)
 
    begin
    {{
        if ($force -or $pscmdlet.ShouldContinue($queryForStart, $captionForStart))
        {{
            Restart-Service  WinRM -Force -Confirm:$false
            return $true
        }}
 
        return $false
    }} #end of Begin block
}}
$_ | Start-WSManServiceD15A7957836142a18627D7E1D342DD82 -force $args[0] -captionForStart $args[1] -queryForStart $args[2]
&quot;</span>;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> &quot;String Literals&quot;
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;WsMan Output Objects&quot;
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base Output object.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="b8b919c7abee9915" href="R/b8b919c7abee9915.html" target="n" data-glyph="0,0" class="t t">WSManConfigElement</a>
    {
        <b>internal</b> <a id="aac4393fbfda3dd3" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">WSManConfigElement</a>()
        {
        }
 
        <b>internal</b> <a id="009bb91b18854b46" href="R/009bb91b18854b46.html" target="n" data-glyph="74,1" class="t constructor">WSManConfigElement</a>(<b>string</b> <span id="r768 rd" class="r768 r">name</span>, <b>string</b> <span id="r769 rd" class="r769 r">typenameofelement</span>)
        {
            <a href="#f2bb56e1a0c050ee" class="i field">_name</a> = <span class="r768 r">name</span>;
            <a href="#7b4c6e5671c010a7" class="i field">_typenameofelement</a> = <span class="r769 r">typenameofelement</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Variable Name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="212d050aff930aa5" href="R/212d050aff930aa5.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b> { <b>return</b> <a href="#f2bb56e1a0c050ee" class="i field">_name</a>; }
 
            <b>set</b> { <a href="#f2bb56e1a0c050ee" class="i field">_name</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="f2bb56e1a0c050ee" href="R/f2bb56e1a0c050ee.html" target="n" data-glyph="46,1" class="i field">_name</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Variable TypeNameOfElement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="777c8b57784372d8" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">TypeNameOfElement</a>
        {
            <b>get</b> { <b>return</b> <a href="#7b4c6e5671c010a7" class="i field">_typenameofelement</a>; }
 
            <b>set</b> { <a href="#7b4c6e5671c010a7" class="i field">_typenameofelement</a> = <b>value</b>; }
        }
 
        <b>private string</b> <a id="7b4c6e5671c010a7" href="R/7b4c6e5671c010a7.html" target="n" data-glyph="46,1" class="i field">_typenameofelement</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or Sets the type if the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ebecc401ccec228f" href="R/ebecc401ccec228f.html" target="n" data-glyph="102,1" class="i property">Type</a>
        {
            <b>get</b> { <b>return</b> <a href="#7b4c6e5671c010a7" class="i field">_typenameofelement</a>; }
 
            <b>set</b> { <a href="#7b4c6e5671c010a7" class="i field">_typenameofelement</a> = <b>value</b>; }
        }
    }
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Leaf Element.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="bb810df317c60bc3" href="R/bb810df317c60bc3.html" target="n" data-glyph="0,0" class="t t">WSManConfigLeafElement</a> : <a href="#b8b919c7abee9915" class="t t">WSManConfigElement</a>
    {
        <b>internal</b> <a id="5230d48fdd39d4b4" href="R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">WSManConfigLeafElement</a>()
        {
        }
 
        <b>internal</b> <a id="b211f621a826f759" href="R/b211f621a826f759.html" target="n" data-glyph="74,1" class="t constructor">WSManConfigLeafElement</a>(<b>string</b> <span id="r770 rd" class="r770 r">Name</span>, <b>object</b> <span id="r771 rd" class="r771 r">Value</span>, <b>string</b> <span id="r772 rd" class="r772 r">TypeNameOfElement</span>, <b>object</b> <span id="r773 rd" class="r773 r">SourceOfValue</span> = <b>null</b>)
        {
            <a href="#db32fe7f1d6342b8" class="i field">_value</a> = <span class="r771 r">Value</span>;
            <a href="#15571fbbf6c43bc6" class="i field">_SourceOfValue</a> = <span class="r773 r">SourceOfValue</span>;
            <a href="#b8b919c7abee9915" class="k">base</a>.<a href="#212d050aff930aa5" class="i property">Name</a> = <span class="r770 r">Name</span>;
            <a href="#b8b919c7abee9915" class="k">base</a>.<a href="#ebecc401ccec228f" class="i property">Type</a> = <span class="r772 r">TypeNameOfElement</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Variable Value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="2026d28ffa57211c" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">SourceOfValue</a>
        {
            <b>get</b> { <b>return</b> <a href="#15571fbbf6c43bc6" class="i field">_SourceOfValue</a>; }
 
            <b>set</b> { <a href="#15571fbbf6c43bc6" class="i field">_SourceOfValue</a> = <b>value</b>; }
        }
 
        <b>private object</b> <a id="15571fbbf6c43bc6" href="R/15571fbbf6c43bc6.html" target="n" data-glyph="46,1" class="i field">_SourceOfValue</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Variable Value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="f4b2d251d298edf4" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Value</a>
        {
            <b>get</b> { <b>return</b> <a href="#db32fe7f1d6342b8" class="i field">_value</a>; }
 
            <b>set</b> { <a href="#db32fe7f1d6342b8" class="i field">_value</a> = <b>value</b>; }
        }
 
        <b>private object</b> <a id="db32fe7f1d6342b8" href="R/db32fe7f1d6342b8.html" target="n" data-glyph="46,1" class="i field">_value</a>;
    }
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Container Element.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="3de090d28cee208b" href="R/3de090d28cee208b.html" target="n" data-glyph="0,0" class="t t">WSManConfigContainerElement</a> : <a href="#b8b919c7abee9915" class="t t">WSManConfigElement</a>
    {
        <b>internal</b> <a id="fc252bdf0f4b1667" href="R/fc252bdf0f4b1667.html" target="n" data-glyph="74,1" class="t constructor">WSManConfigContainerElement</a>(<b>string</b> <span id="r774 rd" class="r774 r">Name</span>, <b>string</b> <span id="r775 rd" class="r775 r">TypeNameOfElement</span>, <b>string</b>[] <span id="r776 rd" class="r776 r">keys</span>)
        {
            <a href="#ebf372b620142693" class="i field">_keys</a> = <span class="r776 r">keys</span>;
            <a href="#b8b919c7abee9915" class="k">base</a>.<a href="#212d050aff930aa5" class="i property">Name</a> = <span class="r774 r">Name</span>;
            <a href="#b8b919c7abee9915" class="k">base</a>.<a href="#ebecc401ccec228f" class="i property">Type</a> = <span class="r775 r">TypeNameOfElement</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Variable Keys.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1819:PropertiesShouldNotReturnArrays&quot;</span>)]
        <b>public string</b>[] <a id="87752d604f15d56e" href="R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Keys</a>
        {
            <b>get</b> { <b>return</b> <a href="#ebf372b620142693" class="i field">_keys</a>; }
 
            <b>set</b> { <a href="#ebf372b620142693" class="i field">_keys</a> = <b>value</b>; }
        }
 
        <b>private string</b>[] <a id="ebf372b620142693" href="R/ebf372b620142693.html" target="n" data-glyph="46,1" class="i field">_keys</a>;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> &quot;WsMan Output Objects&quot;
}
</pre></td></tr></table></div></body></html>
