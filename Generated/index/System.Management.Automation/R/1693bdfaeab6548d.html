<!DOCTYPE html>
<html><head><title>ModuleIntrinsics</title><link rel="stylesheet" href="../../styles.css"/><script src="../../scripts.js"></script></head><body onload="ro();">
<div class="rH">1 instantiation of ModuleIntrinsics</div><div class="rA">System.Management.Automation (1)</div><div class="rG" id="System.Management.Automation"><div class="rF"><div class="rN">engine\ExecutionContext.cs (1)</div>
<a href="../engine/ExecutionContext.cs.html#1585"><b>1585</b>Modules = new <i>ModuleIntrinsics</i>(this);</a>
</div>
</div>
<div class="rH">98 references to ModuleIntrinsics</div><div class="rA">System.Management.Automation (98)</div><div class="rG" id="System.Management.Automation"><div class="rF"><div class="rN">engine\CommandInfo.cs (1)</div>
<a href="../engine/CommandInfo.cs.html#208"><b>208</b>Module.SetVersion(<i>ModuleIntrinsics</i>.GetManifestModuleVersion(Module.Path));</a>
</div>
<div class="rF"><div class="rN">engine\ExecutionContext.cs (1)</div>
<a href="../engine/ExecutionContext.cs.html#236"><b>236</b>internal <i>ModuleIntrinsics</i> Modules { get; private set; }</a>
</div>
<div class="rF"><div class="rN">engine\ExperimentalFeature\GetExperimentalFeatureCommand.cs (3)</div>
<a href="../engine/ExperimentalFeature/GetExperimentalFeatureCommand.cs.html#71"><b>71</b>ExperimentalFeature[] features = <i>ModuleIntrinsics</i>.GetExperimentalFeature(moduleFile);</a>
<a href="../engine/ExperimentalFeature/GetExperimentalFeatureCommand.cs.html#88"><b>88</b>foreach (string path in <i>ModuleIntrinsics</i>.GetModulePath(includeSystemModulePath: false, Context))</a>
<a href="../engine/ExperimentalFeature/GetExperimentalFeatureCommand.cs.html#100"><b>100</b>string currentModuleName = <i>ModuleIntrinsics</i>.GetModuleName(moduleFile);</a>
</div>
<div class="rF"><div class="rN">engine\GetCommandCommand.cs (3)</div>
<a href="../engine/GetCommandCommand.cs.html#705"><b>705</b><i>ModuleIntrinsics</i>.IsModuleMatchingModuleSpec(command.Module, moduleSpecification)))</a>
<a href="../engine/GetCommandCommand.cs.html#1280"><b>1280</b>if (<i>ModuleIntrinsics</i>.IsModuleMatchingModuleSpec(current.Module, moduleSpecification))</a>
<a href="../engine/GetCommandCommand.cs.html#1435"><b>1435</b>else if (_moduleSpecifications.Any(moduleSpecification =&gt; <i>ModuleIntrinsics</i>.IsModuleMatchingModuleSpec(module, moduleSpecification)))</a>
</div>
<div class="rF"><div class="rN">engine\hostifaces\PowerShellProcessInstance.cs (1)</div>
<a href="../engine/hostifaces/PowerShellProcessInstance.cs.html#109"><b>109</b>_startInfo.Environment[&quot;PSModulePath&quot;] = <i>ModuleIntrinsics</i>.GetWindowsPowerShellModulePath();</a>
</div>
<div class="rF"><div class="rN">engine\InitialSessionState.cs (1)</div>
<a href="../engine/InitialSessionState.cs.html#2496"><b>2496</b>ProcessModulesToImport(initializedRunspace, CoreModulesToImport, <i>ModuleIntrinsics</i>.GetPSHomeModulePath(), GetPublicCommands(), unresolvedCmdsToExpose);</a>
</div>
<div class="rF"><div class="rN">engine\Modules\AnalysisCache.cs (21)</div>
<a href="../engine/Modules/AnalysisCache.cs.html#87"><b>87</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Returning {0} exported commands.&quot;, result.Count);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#91"><b>91</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Returning NULL for exported commands.&quot;);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#108"><b>108</b><i>ModuleIntrinsics</i>.Tracer.WriteLine($&quot;Module lies on the Windows System32 legacy module path and is incompatible with current PowerShell edition, skipping module: {modulePath}&quot;);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#118"><b>118</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;ModuleVersion in manifest does not match versioned module directory, skipping module: {0}&quot;, modulePath);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#162"><b>162</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Exception on fast-path analysis of module {0}&quot;, modulePath);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#426"><b>426</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;{0} is already being analyzed. Exiting.&quot;, modulePath);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#431"><b>431</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Started analysis: {0}&quot;, modulePath);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#442"><b>442</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Module analysis generated an exception: {0}&quot;, e);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#448"><b>448</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Finished analysis: {0}&quot;, modulePath);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#482"><b>482</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Module analysis generated an exception: {0}&quot;, e);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#492"><b>492</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Requested caching for {0}&quot;, module.Name);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#498"><b>498</b><i>ModuleIntrinsics</i>.Tracer.WriteLine($&quot;Module &#39;{module.Name}&#39; not edition compatible and not cached.&quot;);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#550"><b>550</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Existing cached info up-to-date. Skipping.&quot;);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#575"><b>575</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Caching command: {0}&quot;, exportedCommand.Name);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#582"><b>582</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Caching command: {0}&quot;, className);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#609"><b>609</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Module analysis generated an exception: {0}&quot;, e);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#623"><b>623</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Exception checking LastWriteTime on module {0}: {1}&quot;, modulePath, e.Message);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#634"><b>634</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;{0}: cache entry out of date, cached on {1}, last updated on {2}&quot;,</a>
<a href="../engine/Modules/AnalysisCache.cs.html#774"><b>774</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Exception checking module analysis cache {0}: {1} &quot;, filename, e.Message);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#872"><b>872</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Exception writing module analysis cache {0}: {1} &quot;, filename, e.Message);</a>
<a href="../engine/Modules/AnalysisCache.cs.html#1050"><b>1050</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Exception checking module analysis cache: &quot; + e.Message);</a>
</div>
<div class="rF"><div class="rN">engine\Modules\ExportModuleMemberCommand.cs (1)</div>
<a href="../engine/Modules/ExportModuleMemberCommand.cs.html#175"><b>175</b><i>ModuleIntrinsics</i>.ExportModuleMembers(this,</a>
</div>
<div class="rF"><div class="rN">engine\Modules\GetModuleCommand.cs (1)</div>
<a href="../engine/Modules/GetModuleCommand.cs.html#557"><b>557</b>if (<i>ModuleIntrinsics</i>.IsModuleMatchingModuleSpec(module, moduleSpec, skipNameCheck: true))</a>
</div>
<div class="rF"><div class="rN">engine\Modules\ImportModuleCommand.cs (5)</div>
<a href="../engine/Modules/ImportModuleCommand.cs.html#686"><b>686</b>|| <i>ModuleIntrinsics</i>.IsVersionMatchingConstraints(module.Version, RequiredVersion, BaseMinimumVersion, BaseMaximumVersion))</a>
<a href="../engine/Modules/ImportModuleCommand.cs.html#803"><b>803</b>IEnumerable&lt;string&gt; modulePath = <i>ModuleIntrinsics</i>.GetModulePath(false, this.Context);</a>
<a href="../engine/Modules/ImportModuleCommand.cs.html#1928"><b>1928</b>string exactModuleName = <i>ModuleIntrinsics</i>.GetModuleName(moduleSpec == null ? moduleName : moduleSpec.Name);</a>
<a href="../engine/Modules/ImportModuleCommand.cs.html#1980"><b>1980</b>string coreModuleToLoad = <i>ModuleIntrinsics</i>.GetModuleName(moduleSpec == null ? moduleName : moduleSpec.Name);</a>
<a href="../engine/Modules/ImportModuleCommand.cs.html#1990"><b>1990</b>string expectedCoreModulePath = Path.Combine(<i>ModuleIntrinsics</i>.GetPSHomeModulePath(), coreModuleToLoad);</a>
</div>
<div class="rF"><div class="rN">engine\Modules\ModuleCmdletBase.cs (31)</div>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#322"><b>322</b>if (string.IsNullOrEmpty(extension) || !<i>ModuleIntrinsics</i>.IsPowerShellModuleExtension(extension))</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#401"><b>401</b>if (!<i>ModuleIntrinsics</i>.IsVersionMatchingConstraints(version, BaseRequiredVersion, BaseMinimumVersion, BaseMaximumVersion))</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#412"><b>412</b>isValidModuleVersion = version.Equals(<i>ModuleIntrinsics</i>.GetManifestModuleVersion(manifestPath));</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#682"><b>682</b>if (!<i>ModuleIntrinsics</i>.IsPowerShellModuleExtension(extension))</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#693"><b>693</b><i>ModuleIntrinsics</i>.GetModuleName(parentModule?.Path));</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#822"><b>822</b>modulePath = <i>ModuleIntrinsics</i>.GetModulePath(false, this.Context);</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#983"><b>983</b>if (!Directory.Exists(resolvedModulePath) &amp;&amp; <i>ModuleIntrinsics</i>.IsPowerShellModuleExtension(Path.GetExtension(moduleName)))</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#1059"><b>1059</b>foreach (string path in <i>ModuleIntrinsics</i>.GetModulePath(false, Context))</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#1310"><b>1310</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Caching skipped for {0} because it had errors while loading.&quot;, moduleInfo.Name);</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#1594"><b>1594</b>if (!string.IsNullOrEmpty(mtpExtension) &amp;&amp; <i>ModuleIntrinsics</i>.IsPowerShellModuleExtension(mtpExtension))</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#1600"><b>1600</b>foreach (string extensionToTry in <i>ModuleIntrinsics</i>.PSModuleExtensions)</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#1681"><b>1681</b>else if (!<i>ModuleIntrinsics</i>.AreModuleFieldsMatchingConstraints(</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#2011"><b>2011</b>string moduleName = <i>ModuleIntrinsics</i>.GetModuleName(moduleManifestPath);</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#2899"><b>2899</b>var exportedFunctionsContainsWildcards = <i>ModuleIntrinsics</i>.PatternContainsWildcard(exportedFunctions);</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#2988"><b>2988</b><i>ModuleIntrinsics</i>.GetModuleName(moduleManifestPath));</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#3058"><b>3058</b><i>ModuleIntrinsics</i>.GetModuleName(moduleManifestPath));</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#3360"><b>3360</b><i>ModuleIntrinsics</i>.ExportModuleMembers(</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#3385"><b>3385</b><i>ModuleIntrinsics</i>.ExportModuleMembers(cmdlet: this,</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#3405"><b>3405</b><i>ModuleIntrinsics</i>.ExportModuleMembers(</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#3491"><b>3491</b><i>ModuleIntrinsics</i>.ExportModuleMembers(</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#3698"><b>3698</b>if (<i>ModuleIntrinsics</i>.IsModuleMatchingModuleSpec(out matchFailure, module, requiredModule))</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#4132"><b>4132</b>if (<i>ModuleIntrinsics</i>.IsModuleMatchingConstraints(</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#5213"><b>5213</b>return <i>ModuleIntrinsics</i>.IsModuleMatchingConstraints(</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#5345"><b>5345</b>extensions = <i>ModuleIntrinsics</i>.PSModuleExtensions;</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#5594"><b>5594</b>if (!<i>ModuleIntrinsics</i>.IsVersionMatchingConstraints(module.Version, minimumVersion: BaseMinimumVersion, maximumVersion: BaseMaximumVersion))</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#5673"><b>5673</b><i>ModuleIntrinsics</i>.ExportModuleMembers(</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#5691"><b>5691</b><i>ModuleIntrinsics</i>.RemoveNestedModuleFunctions(module);</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#5757"><b>5757</b>module = new PSModuleInfo(<i>ModuleIntrinsics</i>.GetModuleName(fileName), fileName, Context, ss, ps1ScriptInfo.DefiningLanguageMode);</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#5871"><b>5871</b><i>ModuleIntrinsics</i>.GetModuleName(fileName),</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#5915"><b>5915</b>string moduleName = <i>ModuleIntrinsics</i>.GetModuleName(fileName);</a>
<a href="../engine/Modules/ModuleCmdletBase.cs.html#6338"><b>6338</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Caching skipped for {0} because it had errors while loading.&quot;, module.Name);</a>
</div>
<div class="rF"><div class="rN">engine\Modules\ModuleIntrinsics.cs (2)</div>
<a href="../engine/Modules/ModuleIntrinsics.cs.html#109"><b>109</b>return CreateModuleImplementation(<i>ModuleIntrinsics</i>.GetModuleName(path), path, scriptInfo, scriptPosition, ss, privateData, out result, arguments);</a>
<a href="../engine/Modules/ModuleIntrinsics.cs.html#863"><b>863</b>string moduleName = <i>ModuleIntrinsics</i>.GetModuleName(manifestPath);</a>
</div>
<div class="rF"><div class="rN">engine\Modules\ModuleSpecification.cs (2)</div>
<a href="../engine/Modules/ModuleSpecification.cs.html#265"><b>265</b>if (!<i>ModuleIntrinsics</i>.IsModuleNamePath(Name))</a>
<a href="../engine/Modules/ModuleSpecification.cs.html#276"><b>276</b>Name = <i>ModuleIntrinsics</i>.NormalizeModuleName(Name, basePath, context)</a>
</div>
<div class="rF"><div class="rN">engine\Modules\ModuleUtils.cs (9)</div>
<a href="../engine/Modules/ModuleUtils.cs.html#98"><b>98</b>foreach (string ext in <i>ModuleIntrinsics</i>.PSModuleExtensions)</a>
<a href="../engine/Modules/ModuleUtils.cs.html#137"><b>137</b>foreach (string directory in <i>ModuleIntrinsics</i>.GetModulePath(isForAutoDiscovery, context))</a>
<a href="../engine/Modules/ModuleUtils.cs.html#208"><b>208</b>if (File.Exists(manifestPath) &amp;&amp; ver.Equals(<i>ModuleIntrinsics</i>.GetManifestModuleVersion(manifestPath)))</a>
<a href="../engine/Modules/ModuleUtils.cs.html#221"><b>221</b>if (File.Exists(manifestPath) &amp;&amp; version.Equals(<i>ModuleIntrinsics</i>.GetManifestModuleVersion(manifestPath)))</a>
<a href="../engine/Modules/ModuleUtils.cs.html#227"><b>227</b>foreach (string ext in <i>ModuleIntrinsics</i>.PSModuleExtensions)</a>
<a href="../engine/Modules/ModuleUtils.cs.html#286"><b>286</b>foreach (string ext in <i>ModuleIntrinsics</i>.PSModuleExtensions)</a>
<a href="../engine/Modules/ModuleUtils.cs.html#377"><b>377</b>string windowsPowerShellPSHomePath = <i>ModuleIntrinsics</i>.GetWindowsPowerShellPSHomeModulePath();</a>
<a href="../engine/Modules/ModuleUtils.cs.html#502"><b>502</b>tempModuleInfo.SetVersion(<i>ModuleIntrinsics</i>.GetManifestModuleVersion(modulePath));</a>
<a href="../engine/Modules/ModuleUtils.cs.html#503"><b>503</b>tempModuleInfo.SetGuid(<i>ModuleIntrinsics</i>.GetManifestGuid(modulePath));</a>
</div>
<div class="rF"><div class="rN">engine\Modules\NewModuleCommand.cs (1)</div>
<a href="../engine/Modules/NewModuleCommand.cs.html#205"><b>205</b><i>ModuleIntrinsics</i>.ExportModuleMembers(this,</a>
</div>
<div class="rF"><div class="rN">engine\Modules\PSModuleInfo.cs (1)</div>
<a href="../engine/Modules/PSModuleInfo.cs.html#94"><b>94</b>Name = name ?? <i>ModuleIntrinsics</i>.GetModuleName(Path);</a>
</div>
<div class="rF"><div class="rN">engine\Modules\ScriptAnalysis.cs (8)</div>
<a href="../engine/Modules/ScriptAnalysis.cs.html#22"><b>22</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Analyzing path: {0}&quot;, path);</a>
<a href="../engine/Modules/ScriptAnalysis.cs.html#197"><b>197</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Discovered function definition: {0}&quot;, functionName);</a>
<a href="../engine/Modules/ScriptAnalysis.cs.html#217"><b>217</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Function defines alias: {0} = {1}&quot;, alias, functionName);</a>
<a href="../engine/Modules/ScriptAnalysis.cs.html#246"><b>246</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Module adds itself to the path.&quot;);</a>
<a href="../engine/Modules/ScriptAnalysis.cs.html#299"><b>299</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Module dots {0}&quot;, commandName);</a>
<a href="../engine/Modules/ScriptAnalysis.cs.html#326"><b>326</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Module defines alias: {0} = {1}&quot;, name, value);</a>
<a href="../engine/Modules/ScriptAnalysis.cs.html#361"><b>361</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Discovered module import: {0}&quot;, moduleName);</a>
<a href="../engine/Modules/ScriptAnalysis.cs.html#390"><b>390</b><i>ModuleIntrinsics</i>.Tracer.WriteLine(&quot;Discovered explicit export: {0}&quot;, exportedCommandName);</a>
</div>
<div class="rF"><div class="rN">engine\Modules\TestModuleManifestCommand.cs (1)</div>
<a href="../engine/Modules/TestModuleManifestCommand.cs.html#296"><b>296</b>private static readonly IReadOnlyList&lt;string&gt; s_validRootModuleExtensions = <i>ModuleIntrinsics</i>.PSModuleExtensions</a>
</div>
<div class="rF"><div class="rN">engine\NativeCommandProcessor.cs (1)</div>
<a href="../engine/NativeCommandProcessor.cs.html#532"><b>532</b>string psmodulepath = <i>ModuleIntrinsics</i>.GetWindowsPowerShellModulePath();</a>
</div>
<div class="rF"><div class="rN">engine\remoting\fanin\InitialSessionStateProvider.cs (1)</div>
<a href="../engine/remoting/fanin/InitialSessionStateProvider.cs.html#1910"><b>1910</b>string[] modulePaths = <i>ModuleIntrinsics</i>.GetModulePath().Split(Utils.Separators.PathSeparator);</a>
</div>
<div class="rF"><div class="rN">help\HelpFileHelpProvider.cs (2)</div>
<a href="../help/HelpFileHelpProvider.cs.html#114"><b>114</b>var allPSModulePaths = <i>ModuleIntrinsics</i>.GetModulePath(false, this.HelpSystem.ExecutionContext);</a>
<a href="../help/HelpFileHelpProvider.cs.html#363"><b>363</b>foreach (string psModulePath in <i>ModuleIntrinsics</i>.GetModulePath(false, this.HelpSystem.ExecutionContext))</a>
</div>
<div class="rF"><div class="rN">utils\PathUtils.cs (1)</div>
<a href="../utils/PathUtils.cs.html#369"><b>369</b>string personalModuleRoot = <i>ModuleIntrinsics</i>.GetPersonalModulePath();</a>
</div>
</div>
</body></html>