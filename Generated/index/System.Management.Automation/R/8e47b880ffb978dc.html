<!DOCTYPE html>
<html><head><title>NativeMethods</title><link rel="stylesheet" href="../../styles.css"/><script src="../../scripts.js"></script></head><body onload="ro();">
<div class="rH">93 references to NativeMethods</div><div class="rA">System.Management.Automation (93)</div><div class="rG" id="System.Management.Automation"><div class="rF"><div class="rN">security\Authenticode.cs (51)</div>
<a href="../security/Authenticode.cs.html#125"><b>125</b>IntPtr oidPtr = <i>NativeMethods</i>.CryptFindOIDInfo(NativeConstants.CRYPT_OID_INFO_NAME_KEY,</a>
<a href="../security/Authenticode.cs.html#139"><b>139</b><i>NativeMethods</i>.CRYPT_OID_INFO oidInfo =</a>
<a href="../security/Authenticode.cs.html#140"><b>140</b>Marshal.PtrToStructure&lt;<i>NativeMethods</i>.CRYPT_OID_INFO&gt;(oidPtr);</a>
<a href="../security/Authenticode.cs.html#172"><b>172</b><i>NativeMethods</i>.CRYPTUI_WIZ_DIGITAL_SIGN_INFO si = <i>NativeMethods</i>.InitSignInfoStruct(fileName,</a>
<a href="../security/Authenticode.cs.html#187"><b>187</b>result = <i>NativeMethods</i>.CryptUIWizDigitalSign(</a>
<a href="../security/Authenticode.cs.html#188"><b>188</b>(DWORD)<i>NativeMethods</i>.CryptUIFlags.CRYPTUI_WIZ_NO_UI,</a>
<a href="../security/Authenticode.cs.html#197"><b>197</b>Marshal.DestroyStructure&lt;<i>NativeMethods</i>.CRYPTUI_WIZ_DIGITAL_SIGN_EXTENDED_INFO&gt;(si.pSignExtInfo);</a>
<a href="../security/Authenticode.cs.html#249"><b>249</b>Marshal.DestroyStructure&lt;<i>NativeMethods</i>.CRYPTUI_WIZ_DIGITAL_SIGN_INFO&gt;(pSignInfo);</a>
<a href="../security/Authenticode.cs.html#312"><b>312</b><i>NativeMethods</i>.SIGNATURE_INFO sigInfo = new <i>NativeMethods</i>.SIGNATURE_INFO();</a>
<a href="../security/Authenticode.cs.html#320"><b>320</b>int hresult = <i>NativeMethods</i>.WTGetSignatureInfo(filename, stream.SafeFileHandle.DangerousGetHandle(),</a>
<a href="../security/Authenticode.cs.html#321"><b>321</b><i>NativeMethods</i>.SIGNATURE_INFO_FLAGS.SIF_CATALOG_SIGNED |</a>
<a href="../security/Authenticode.cs.html#322"><b>322</b><i>NativeMethods</i>.SIGNATURE_INFO_FLAGS.SIF_CATALOG_FIRST |</a>
<a href="../security/Authenticode.cs.html#323"><b>323</b><i>NativeMethods</i>.SIGNATURE_INFO_FLAGS.SIF_AUTHENTICODE_SIGNED |</a>
<a href="../security/Authenticode.cs.html#324"><b>324</b><i>NativeMethods</i>.SIGNATURE_INFO_FLAGS.SIF_BASE_VERIFICATION |</a>
<a href="../security/Authenticode.cs.html#325"><b>325</b><i>NativeMethods</i>.SIGNATURE_INFO_FLAGS.SIF_CHECK_OS_BINARY,</a>
<a href="../security/Authenticode.cs.html#351"><b>351</b>case <i>NativeMethods</i>.SIGNATURE_INFO_TYPE.SIT_AUTHENTICODE: signature.SignatureType = SignatureType.Authenticode; break;</a>
<a href="../security/Authenticode.cs.html#352"><b>352</b>case <i>NativeMethods</i>.SIGNATURE_INFO_TYPE.SIT_CATALOG: signature.SignatureType = SignatureType.Catalog; break;</a>
<a href="../security/Authenticode.cs.html#394"><b>394</b><i>NativeMethods</i>.FreeWVTStateData(phStateData);</a>
<a href="../security/Authenticode.cs.html#399"><b>399</b><i>NativeMethods</i>.CertFreeCertificateContext(ppCertContext);</a>
<a href="../security/Authenticode.cs.html#414"><b>414</b>private static DWORD GetErrorFromSignatureState(<i>NativeMethods</i>.SIGNATURE_STATE state)</a>
<a href="../security/Authenticode.cs.html#418"><b>418</b>case <i>NativeMethods</i>.SIGNATURE_STATE.SIGNATURE_STATE_UNSIGNED_MISSING: return Win32Errors.TRUST_E_NOSIGNATURE;</a>
<a href="../security/Authenticode.cs.html#419"><b>419</b>case <i>NativeMethods</i>.SIGNATURE_STATE.SIGNATURE_STATE_UNSIGNED_UNSUPPORTED: return Win32Errors.TRUST_E_NOSIGNATURE;</a>
<a href="../security/Authenticode.cs.html#420"><b>420</b>case <i>NativeMethods</i>.SIGNATURE_STATE.SIGNATURE_STATE_UNSIGNED_POLICY: return Win32Errors.TRUST_E_NOSIGNATURE;</a>
<a href="../security/Authenticode.cs.html#421"><b>421</b>case <i>NativeMethods</i>.SIGNATURE_STATE.SIGNATURE_STATE_INVALID_CORRUPT: return Win32Errors.TRUST_E_BAD_DIGEST;</a>
<a href="../security/Authenticode.cs.html#422"><b>422</b>case <i>NativeMethods</i>.SIGNATURE_STATE.SIGNATURE_STATE_INVALID_POLICY: return Win32Errors.CRYPT_E_BAD_MSG;</a>
<a href="../security/Authenticode.cs.html#423"><b>423</b>case <i>NativeMethods</i>.SIGNATURE_STATE.SIGNATURE_STATE_VALID: return Win32Errors.NO_ERROR;</a>
<a href="../security/Authenticode.cs.html#424"><b>424</b>case <i>NativeMethods</i>.SIGNATURE_STATE.SIGNATURE_STATE_TRUSTED: return Win32Errors.NO_ERROR;</a>
<a href="../security/Authenticode.cs.html#425"><b>425</b>case <i>NativeMethods</i>.SIGNATURE_STATE.SIGNATURE_STATE_UNTRUSTED: return Win32Errors.TRUST_E_EXPLICIT_DISTRUST;</a>
<a href="../security/Authenticode.cs.html#438"><b>438</b><i>NativeMethods</i>.WINTRUST_DATA wtd;</a>
<a href="../security/Authenticode.cs.html#459"><b>459</b>error = <i>NativeMethods</i>.DestroyWintrustDataStruct(wtd);</a>
<a href="../security/Authenticode.cs.html#476"><b>476</b>out <i>NativeMethods</i>.WINTRUST_DATA wtData)</a>
<a href="../security/Authenticode.cs.html#493"><b>493</b><i>NativeMethods</i>.WINTRUST_DATA wtd;</a>
<a href="../security/Authenticode.cs.html#497"><b>497</b><i>NativeMethods</i>.WINTRUST_FILE_INFO wfi = <i>NativeMethods</i>.InitWintrustFileInfoStruct(fileName);</a>
<a href="../security/Authenticode.cs.html#498"><b>498</b>wtd = <i>NativeMethods</i>.InitWintrustDataStructFromFile(wfi);</a>
<a href="../security/Authenticode.cs.html#502"><b>502</b><i>NativeMethods</i>.WINTRUST_BLOB_INFO wbi = <i>NativeMethods</i>.InitWintrustBlobInfoStruct(fileName, fileContent);</a>
<a href="../security/Authenticode.cs.html#503"><b>503</b>wtd = <i>NativeMethods</i>.InitWintrustDataStructFromBlob(wbi);</a>
<a href="../security/Authenticode.cs.html#512"><b>512</b>dwResult = <i>NativeMethods</i>.WinVerifyTrust(</a>
<a href="../security/Authenticode.cs.html#518"><b>518</b>wtData = Marshal.PtrToStructure&lt;<i>NativeMethods</i>.WINTRUST_DATA&gt;(wtdBuffer);</a>
<a href="../security/Authenticode.cs.html#524"><b>524</b>Marshal.DestroyStructure&lt;<i>NativeMethods</i>.WINTRUST_DATA&gt;(wtdBuffer);</a>
<a href="../security/Authenticode.cs.html#540"><b>540</b><i>NativeMethods</i>.WTHelperGetProvCertFromChain(pSigner, 0);</a>
<a href="../security/Authenticode.cs.html#545"><b>545</b><i>NativeMethods</i>.CRYPT_PROVIDER_CERT provCert =</a>
<a href="../security/Authenticode.cs.html#546"><b>546</b>Marshal.PtrToStructure&lt;<i>NativeMethods</i>.CRYPT_PROVIDER_CERT&gt;(pCert);</a>
<a href="../security/Authenticode.cs.html#557"><b>557</b><i>NativeMethods</i>.WINTRUST_DATA wtd)</a>
<a href="../security/Authenticode.cs.html#609"><b>609</b><i>NativeMethods</i>.WTHelperProvDataFromStateData(wvtStateData);</a>
<a href="../security/Authenticode.cs.html#615"><b>615</b><i>NativeMethods</i>.WTHelperGetProvSignerFromChain(pProvData, 0, 0, 0);</a>
<a href="../security/Authenticode.cs.html#619"><b>619</b><i>NativeMethods</i>.CRYPT_PROVIDER_SGNR provSigner =</a>
<a href="../security/Authenticode.cs.html#620"><b>620</b>Marshal.PtrToStructure&lt;<i>NativeMethods</i>.CRYPT_PROVIDER_SGNR&gt;(pProvSigner);</a>
</div>
<div class="rF"><div class="rN">security\CatalogHelper.cs (29)</div>
<a href="../security/CatalogHelper.cs.html#90"><b>90</b>IntPtr catalogData = <i>NativeMethods</i>.CryptCATStoreFromHandle(catalogHandle);</a>
<a href="../security/CatalogHelper.cs.html#91"><b>91</b><i>NativeMethods</i>.CRYPTCATSTORE catalogInfo = Marshal.PtrToStructure&lt;<i>NativeMethods</i>.CRYPTCATSTORE&gt;(catalogData);</a>
<a href="../security/CatalogHelper.cs.html#252"><b>252</b><i>NativeMethods</i>.CryptCATCDFOpenCallBack catOpenCallBack = new <i>NativeMethods</i>.CryptCATCDFOpenCallBack(ParseErrorCallback);</a>
<a href="../security/CatalogHelper.cs.html#255"><b>255</b>IntPtr resultCDF = <i>NativeMethods</i>.CryptCATCDFOpen(pwszFilePath, catOpenCallBack);</a>
<a href="../security/CatalogHelper.cs.html#264"><b>264</b>catalogAttr = <i>NativeMethods</i>.CryptCATCDFEnumCatAttributes(resultCDF, catalogAttr, catOpenCallBack);</a>
<a href="../security/CatalogHelper.cs.html#278"><b>278</b><i>NativeMethods</i>.CryptCATCDFEnumMembersByCDFTagExErrorCallBack memberCallBack = new <i>NativeMethods</i>.CryptCATCDFEnumMembersByCDFTagExErrorCallBack(ParseErrorCallback);</a>
<a href="../security/CatalogHelper.cs.html#282"><b>282</b>memberFile = <i>NativeMethods</i>.CryptCATCDFEnumMembersByCDFTagEx(resultCDF, memberFile, memberCallBack, ref memberInfo, true, IntPtr.Zero);</a>
<a href="../security/CatalogHelper.cs.html#291"><b>291</b>memberAttr = <i>NativeMethods</i>.CryptCATCDFEnumAttributesWithCDFTag(resultCDF, memberFile, memberInfo, memberAttr, memberCallBack);</a>
<a href="../security/CatalogHelper.cs.html#312"><b>312</b><i>NativeMethods</i>.CryptCATCDFClose(resultCDF);</a>
<a href="../security/CatalogHelper.cs.html#377"><b>377</b><i>NativeMethods</i>.CRYPTCATATTRIBUTE currentMemberAttr = Marshal.PtrToStructure&lt;<i>NativeMethods</i>.CRYPTCATATTRIBUTE&gt;(memberAttrInfo);</a>
<a href="../security/CatalogHelper.cs.html#406"><b>406</b>if (!<i>NativeMethods</i>.CryptCATAdminAcquireContext2(ref catAdmin, IntPtr.Zero, hashAlgorithm, IntPtr.Zero, 0))</a>
<a href="../security/CatalogHelper.cs.html#417"><b>417</b>IntPtr fileHandle = <i>NativeMethods</i>.CreateFile(filePath, GENERIC_READ, 0, 0, OPEN_EXISTING, 0, IntPtr.Zero);</a>
<a href="../security/CatalogHelper.cs.html#426"><b>426</b>if (!<i>NativeMethods</i>.CryptCATAdminCalcHashFromFileHandle2(catAdmin, fileHandle, ref hashBufferSize, hashBuffer, 0))</a>
<a href="../security/CatalogHelper.cs.html#437"><b>437</b>if (!<i>NativeMethods</i>.CryptCATAdminCalcHashFromFileHandle2(catAdmin, fileHandle, ref hashBufferSize, hashBuffer, 0))</a>
<a href="../security/CatalogHelper.cs.html#457"><b>457</b><i>NativeMethods</i>.CryptCATAdminReleaseContext(catAdmin, 0);</a>
<a href="../security/CatalogHelper.cs.html#458"><b>458</b><i>NativeMethods</i>.CloseHandle(fileHandle);</a>
<a href="../security/CatalogHelper.cs.html#480"><b>480</b>IntPtr resultCatalog = <i>NativeMethods</i>.CryptCATOpen(catalogFilePath, 0, IntPtr.Zero, 1, 0);</a>
<a href="../security/CatalogHelper.cs.html#494"><b>494</b>catAttrInfo = <i>NativeMethods</i>.CryptCATEnumerateCatAttr(resultCatalog, catAttrInfo);</a>
<a href="../security/CatalogHelper.cs.html#514"><b>514</b>memberInfo = <i>NativeMethods</i>.CryptCATEnumerateMember(resultCatalog, memberInfo);</a>
<a href="../security/CatalogHelper.cs.html#517"><b>517</b><i>NativeMethods</i>.CRYPTCATMEMBER currentMember = Marshal.PtrToStructure&lt;<i>NativeMethods</i>.CRYPTCATMEMBER&gt;(memberInfo);</a>
<a href="../security/CatalogHelper.cs.html#518"><b>518</b><i>NativeMethods</i>.SIP_INDIRECT_DATA pIndirectData = Marshal.PtrToStructure&lt;<i>NativeMethods</i>.SIP_INDIRECT_DATA&gt;(currentMember.pIndirectData);</a>
<a href="../security/CatalogHelper.cs.html#528"><b>528</b>memberAttrInfo = <i>NativeMethods</i>.CryptCATEnumerateAttr(resultCatalog, memberInfo, memberAttrInfo);</a>
<a href="../security/CatalogHelper.cs.html#557"><b>557</b><i>NativeMethods</i>.CryptCATClose(resultCatalog);</a>
</div>
<div class="rF"><div class="rN">security\nativeMethods.cs (5)</div>
<a href="../security/nativeMethods.cs.html#179"><b>179</b>Security.<i>NativeMethods</i>.CertOpenStoreEncodingType dwEncodingType,</a>
<a href="../security/nativeMethods.cs.html#181"><b>181</b>Security.<i>NativeMethods</i>.CertFindType dwFindType,</a>
<a href="../security/nativeMethods.cs.html#1879"><b>1879</b><i>NativeMethods</i>.LOAD_LIBRARY_AS_DATAFILE |</a>
<a href="../security/nativeMethods.cs.html#1880"><b>1880</b><i>NativeMethods</i>.LOAD_LIBRARY_AS_IMAGE_RESOURCE |</a>
<a href="../security/nativeMethods.cs.html#1881"><b>1881</b><i>NativeMethods</i>.LOAD_LIBRARY_SEARCH_SYSTEM32);</a>
</div>
<div class="rF"><div class="rN">security\SecuritySupport.cs (8)</div>
<a href="../security/SecuritySupport.cs.html#529"><b>529</b>if (<i>NativeMethods</i>.SaferIdentifyLevel(1, ref codeProperties, out hAuthzLevel, NativeConstants.SRP_POLICY_SCRIPT))</a>
<a href="../security/SecuritySupport.cs.html#535"><b>535</b>if (!<i>NativeMethods</i>.SaferComputeTokenFromLevel(</a>
<a href="../security/SecuritySupport.cs.html#564"><b>564</b><i>NativeMethods</i>.CloseHandle(hRestrictedToken);</a>
<a href="../security/SecuritySupport.cs.html#570"><b>570</b><i>NativeMethods</i>.SaferCloseLevel(hAuthzLevel);</a>
<a href="../security/SecuritySupport.cs.html#693"><b>693</b>if (Security.<i>NativeMethods</i>.CertGetEnhancedKeyUsage(pCert, 0, dummy,</a>
<a href="../security/SecuritySupport.cs.html#702"><b>702</b>if (Security.<i>NativeMethods</i>.CertGetEnhancedKeyUsage(pCert, 0,</a>
<a href="../security/SecuritySupport.cs.html#706"><b>706</b>Security.<i>NativeMethods</i>.CERT_ENHKEY_USAGE ekuStruct =</a>
<a href="../security/SecuritySupport.cs.html#707"><b>707</b>Marshal.PtrToStructure&lt;Security.<i>NativeMethods</i>.CERT_ENHKEY_USAGE&gt;(ekuBuffer);</a>
</div>
</div>
</body></html>