<!DOCTYPE html>
<html><head><title>ApartmentState</title><link rel="stylesheet" href="../../styles.css"/><script src="../../scripts.js"></script></head><body onload="ro();">
<div class="rH">4 writes to ApartmentState</div><div class="rA">Microsoft.PowerShell.ConsoleHost (1)</div><div class="rG" id="Microsoft.PowerShell.ConsoleHost"><div class="rF"><div class="rN">host\msh\ConsoleHost.cs (1)</div>
<a href="../../Microsoft.PowerShell.ConsoleHost/host/msh/ConsoleHost.cs.html#1736"><b>1736</b>runspace.<i>ApartmentState</i> = ApartmentState.STA;</a>
</div>
</div>
<div class="rA">System.Management.Automation (3)</div><div class="rG" id="System.Management.Automation"><div class="rF"><div class="rN">engine\hostifaces\ConnectionBase.cs (2)</div>
<a href="../engine/hostifaces/ConnectionBase.cs.html#80"><b>80</b>this.<i>ApartmentState</i> = initialSessionState.ApartmentState;</a>
<a href="../engine/hostifaces/ConnectionBase.cs.html#126"><b>126</b>this.<i>ApartmentState</i> = initialSessionState.ApartmentState;</a>
</div>
<div class="rF"><div class="rN">engine\hostifaces\RunspacePoolInternal.cs (1)</div>
<a href="../engine/hostifaces/RunspacePoolInternal.cs.html#1258"><b>1258</b>result.<i>ApartmentState</i> = this.ApartmentState;</a>
</div>
</div>
<div class="rH">10 references to ApartmentState</div><div class="rA">System.Management.Automation (10)</div><div class="rG" id="System.Management.Automation"><div class="rF"><div class="rN">engine\hostifaces\Connection.cs (1)</div>
<a href="../engine/hostifaces/Connection.cs.html#585"><b>585</b>internal const ApartmentState DefaultApartmentState = <i>ApartmentState</i>.Unknown;</a>
</div>
<div class="rF"><div class="rN">engine\hostifaces\ConnectionBase.cs (1)</div>
<a href="../engine/hostifaces/ConnectionBase.cs.html#918"><b>918</b>if (runningPipelines.Length &gt; 1 &amp;&amp; Thread.CurrentThread.GetApartmentState() == <i>ApartmentState</i>.STA)</a>
</div>
<div class="rF"><div class="rN">engine\hostifaces\LocalConnection.cs (3)</div>
<a href="../engine/hostifaces/LocalConnection.cs.html#172"><b>172</b>return options == PSThreadOptions.ReuseThread &amp;&amp; this.<i>ApartmentState</i> != <i>ApartmentState</i>.STA;</a>
<a href="../engine/hostifaces/LocalConnection.cs.html#773"><b>773</b>_pipelineThread = new PipelineThread(this.<i>ApartmentState</i>);</a>
</div>
<div class="rF"><div class="rN">engine\hostifaces\LocalPipeline.cs (1)</div>
<a href="../engine/hostifaces/LocalPipeline.cs.html#188"><b>188</b>apartmentState = this.LocalRunspace.<i>ApartmentState</i>; // use the Runspace apartment state</a>
</div>
<div class="rF"><div class="rN">engine\hostifaces\PowerShell.cs (2)</div>
<a href="../engine/hostifaces/PowerShell.cs.html#4578"><b>4578</b>VerifyThreadSettings(settings, rsToUse.<i>ApartmentState</i>, rsToUse.ThreadOptions, false);</a>
<a href="../engine/hostifaces/PowerShell.cs.html#4924"><b>4924</b>VerifyThreadSettings(settings, rs.<i>ApartmentState</i>, rs.ThreadOptions, false);</a>
</div>
<div class="rF"><div class="rN">engine\remoting\client\remoterunspace.cs (1)</div>
<a href="../engine/remoting/client/remoterunspace.cs.html#551"><b>551</b>RunspacePool.ApartmentState = this.<i>ApartmentState</i>;</a>
</div>
<div class="rF"><div class="rN">engine\remoting\server\ServerRunspacePoolDriver.cs (1)</div>
<a href="../engine/remoting/server/ServerRunspacePoolDriver.cs.html#536"><b>536</b>args.Runspace.<i>ApartmentState</i>,</a>
</div>
</div>
</body></html>