<!DOCTYPE html>
<html><head><title>MshSnapinInfo.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(1345);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/singleshell/config/MshSnapinInfo.cs" target="_top">singleshell\config\MshSnapinInfo.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Security</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Win32</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
<b>using</b> <span class="i">Regex</span> = <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">RegularExpressions</span>.<span class="i">Regex</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <b>internal static class</b> <a id="fefd5b5c5e75f6ff" href="../../R/fefd5b5c5e75f6ff.html" target="n" data-glyph="2,0" class="t t">RegistryStrings</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Root key path under HKLM.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="930717e253bcfc29" href="../../R/930717e253bcfc29.html" target="n" data-glyph="8,1" class="i field">MonadRootKeyPath</a> = <span class="s">&quot;Software\\Microsoft\\PowerShell&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Root key name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="52bfb245b7bdf500" href="../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">MonadRootKeyName</a> = <span class="s">&quot;PowerShell&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Key for monad engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="cc0f8515a11bdfdc" href="../../R/cc0f8515a11bdfdc.html" target="n" data-glyph="8,1" class="i field">MonadEngineKey</a> = <span class="s">&quot;PowerShellEngine&quot;</span>;
 
        <span class="c">// Name for various values under PSEngine</span>
        <b>internal const string</b> <a id="95527460585fa99e" href="../../R/95527460585fa99e.html" target="n" data-glyph="8,1" class="i field">MonadEngine_ApplicationBase</a> = <span class="s">&quot;ApplicationBase&quot;</span>;
        <b>internal const string</b> <a id="b78d383b4df1894d" href="../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">MonadEngine_ConsoleHostAssemblyName</a> = <span class="s">&quot;ConsoleHostAssemblyName&quot;</span>;
        <b>internal const string</b> <a id="063973aba020542d" href="../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">MonadEngine_ConsoleHostModuleName</a> = <span class="s">&quot;ConsoleHostModuleName&quot;</span>;
        <b>internal const string</b> <a id="ab2302380b47eb76" href="../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">MonadEngine_RuntimeVersion</a> = <span class="s">&quot;RuntimeVersion&quot;</span>;
        <b>internal const string</b> <a id="c31af753d2bfb9a0" href="../../R/c31af753d2bfb9a0.html" target="n" data-glyph="8,1" class="i field">MonadEngine_MonadVersion</a> = <span class="s">&quot;PowerShellVersion&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Key under which all the mshsnapin live.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const string</b> <a id="664881598dcb3b3c" href="../../R/664881598dcb3b3c.html" target="n" data-glyph="8,1" class="i field">MshSnapinKey</a> = <span class="s">&quot;PowerShellSnapIns&quot;</span>;
 
        <span class="c">// Name of various values for each mshsnapin</span>
        <b>internal const string</b> <a id="ffa474d6060bfca5" href="../../R/ffa474d6060bfca5.html" target="n" data-glyph="8,1" class="i field">MshSnapin_ApplicationBase</a> = <span class="s">&quot;ApplicationBase&quot;</span>;
        <b>internal const string</b> <a id="166c068a990d59dc" href="../../R/166c068a990d59dc.html" target="n" data-glyph="8,1" class="i field">MshSnapin_AssemblyName</a> = <span class="s">&quot;AssemblyName&quot;</span>;
        <b>internal const string</b> <a id="8781d4ed0096001b" href="../../R/8781d4ed0096001b.html" target="n" data-glyph="8,1" class="i field">MshSnapin_ModuleName</a> = <span class="s">&quot;ModuleName&quot;</span>;
        <b>internal const string</b> <a id="7e50d60babc0bc67" href="../../R/7e50d60babc0bc67.html" target="n" data-glyph="8,1" class="i field">MshSnapin_MonadVersion</a> = <span class="s">&quot;PowerShellVersion&quot;</span>;
        <b>internal const string</b> <a id="c0cd99346057e9eb" href="../../R/c0cd99346057e9eb.html" target="n" data-glyph="8,1" class="i field">MshSnapin_BuiltInTypes</a> = <span class="s">&quot;Types&quot;</span>;
        <b>internal const string</b> <a id="2fddfed832945a23" href="../../R/2fddfed832945a23.html" target="n" data-glyph="8,1" class="i field">MshSnapin_BuiltInFormats</a> = <span class="s">&quot;Formats&quot;</span>;
        <b>internal const string</b> <a id="93fbc57537f5bda8" href="../../R/93fbc57537f5bda8.html" target="n" data-glyph="8,1" class="i field">MshSnapin_Description</a> = <span class="s">&quot;Description&quot;</span>;
        <b>internal const string</b> <a id="4be1f5db13ee682a" href="../../R/4be1f5db13ee682a.html" target="n" data-glyph="8,1" class="i field">MshSnapin_Version</a> = <span class="s">&quot;Version&quot;</span>;
        <b>internal const string</b> <a id="a5fcf391397f9415" href="../../R/a5fcf391397f9415.html" target="n" data-glyph="8,1" class="i field">MshSnapin_Vendor</a> = <span class="s">&quot;Vendor&quot;</span>;
        <b>internal const string</b> <a id="bba830cb2a1c2485" href="../../R/bba830cb2a1c2485.html" target="n" data-glyph="8,1" class="i field">MshSnapin_DescriptionResource</a> = <span class="s">&quot;DescriptionIndirect&quot;</span>;
        <b>internal const string</b> <a id="6e22dc0a0507aad0" href="../../R/6e22dc0a0507aad0.html" target="n" data-glyph="8,1" class="i field">MshSnapin_VendorResource</a> = <span class="s">&quot;VendorIndirect&quot;</span>;
        <b>internal const string</b> <a id="9df3984f7efc14de" href="../../R/9df3984f7efc14de.html" target="n" data-glyph="8,1" class="i field">MshSnapin_LogPipelineExecutionDetails</a> = <span class="s">&quot;LogPipelineExecutionDetails&quot;</span>;
 
        <span class="c">// Name of default mshsnapins</span>
        <b>internal const string</b> <a id="da086b4b7877a1f3" href="../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">CoreMshSnapinName</a> = <span class="s">&quot;Microsoft.PowerShell.Core&quot;</span>;
        <b>internal const string</b> <a id="aa11c793ba0ac97c" href="../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">HostMshSnapinName</a> = <span class="s">&quot;Microsoft.PowerShell.Host&quot;</span>;
        <b>internal const string</b> <a id="15357393b9f1c8d7" href="../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">ManagementMshSnapinName</a> = <span class="s">&quot;Microsoft.PowerShell.Management&quot;</span>;
        <b>internal const string</b> <a id="87a2b103fc73df98" href="../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SecurityMshSnapinName</a> = <span class="s">&quot;Microsoft.PowerShell.Security&quot;</span>;
        <b>internal const string</b> <a id="6e436cb39415feb7" href="../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">UtilityMshSnapinName</a> = <span class="s">&quot;Microsoft.PowerShell.Utility&quot;</span>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Contains information about a mshsnapin.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="571fb5b01a41502f" href="../../R/571fb5b01a41502f.html" target="n" data-glyph="0,0" class="t t">PSSnapInInfo</a>
    {
        <b>internal</b> <a id="93cd0a543851215c" href="../../R/93cd0a543851215c.html" target="n" data-glyph="74,1" class="t constructor">PSSnapInInfo</a>
        (
            <b>string</b> <span id="r0 rd" class="r0 r">name</span>,
            <b>bool</b> <span id="r1 rd" class="r1 r">isDefault</span>,
            <b>string</b> <span id="r2 rd" class="r2 r">applicationBase</span>,
            <b>string</b> <span id="r3 rd" class="r3 r">assemblyName</span>,
            <b>string</b> <span id="r4 rd" class="r4 r">moduleName</span>,
            <span class="i">Version</span> <span id="r5 rd" class="r5 r">psVersion</span>,
            <span class="i">Version</span> <span id="r6 rd" class="r6 r">version</span>,
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r7 rd" class="r7 r">types</span>,
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r8 rd" class="r8 r">formats</span>,
            <b>string</b> <span id="r9 rd" class="r9 r">descriptionFallback</span>,
            <b>string</b> <span id="r10 rd" class="r10 r">vendorFallback</span>
        )
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r0 r">name</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r0 r">name</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r2 r">applicationBase</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r2 r">applicationBase</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r3 r">assemblyName</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r3 r">assemblyName</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r4 r">moduleName</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r4 r">moduleName</span>));
            }
 
            <b>if</b> (<span class="r5 r">psVersion</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r5 r">psVersion</span>));
            }
 
            <b>if</b> (<span class="r6 r">version</span> == <b>null</b>)
            {
                <span class="r6 r">version</span> = <b>new</b> <span class="i">Version</span>(<span class="s">&quot;0.0&quot;</span>);
            }
 
            <b>if</b> (<span class="r7 r">types</span> == <b>null</b>)
            {
                <span class="r7 r">types</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
            }
 
            <b>if</b> (<span class="r8 r">formats</span> == <b>null</b>)
            {
                <span class="r8 r">formats</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
            }
 
            <b>if</b> (<span class="r9 r">descriptionFallback</span> == <b>null</b>)
            {
                <span class="r9 r">descriptionFallback</span> = <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>if</b> (<span class="r10 r">vendorFallback</span> == <b>null</b>)
            {
                <span class="r10 r">vendorFallback</span> = <b>string</b>.<span class="i">Empty</span>;
            }
 
            <a href="#ebdb1944f8049e83" class="i property">Name</a> = <span class="r0 r">name</span>;
            <a href="#29d7c728d53457e4" class="i property">IsDefault</a> = <span class="r1 r">isDefault</span>;
            <a href="#dc0461df9f1a5d5a" class="i property">ApplicationBase</a> = <span class="r2 r">applicationBase</span>;
            <a href="#ad98c4c4a02154bb" class="i property">AssemblyName</a> = <span class="r3 r">assemblyName</span>;
            <a href="#e13b77813ea4fc5e" class="i property">ModuleName</a> = <span class="r4 r">moduleName</span>;
            <a href="#eccaf10188e41976" class="i property">PSVersion</a> = <span class="r5 r">psVersion</span>;
            <a href="#f0960dddd3597e69" class="i property">Version</a> = <span class="r6 r">version</span>;
            <a href="#e35c7867f8d42d8a" class="i property">Types</a> = <span class="r7 r">types</span>;
            <a href="#97d12a57dedcadc2" class="i property">Formats</a> = <span class="r8 r">formats</span>;
            <a href="#59b848592bff6554" class="i field">_descriptionFallback</a> = <span class="r9 r">descriptionFallback</span>;
            <a href="#56004c833c38f0a3" class="i field">_vendorFallback</a> = <span class="r10 r">vendorFallback</span>;
        }
 
        <b>internal</b> <a id="805c5ae775e8191f" href="../../R/805c5ae775e8191f.html" target="n" data-glyph="74,1" class="t constructor">PSSnapInInfo</a>
        (
            <b>string</b> <span id="r11 rd" class="r11 r">name</span>,
            <b>bool</b> <span id="r12 rd" class="r12 r">isDefault</span>,
            <b>string</b> <span id="r13 rd" class="r13 r">applicationBase</span>,
            <b>string</b> <span id="r14 rd" class="r14 r">assemblyName</span>,
            <b>string</b> <span id="r15 rd" class="r15 r">moduleName</span>,
            <span class="i">Version</span> <span id="r16 rd" class="r16 r">psVersion</span>,
            <span class="i">Version</span> <span id="r17 rd" class="r17 r">version</span>,
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r18 rd" class="r18 r">types</span>,
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r19 rd" class="r19 r">formats</span>,
            <b>string</b> <span id="r20 rd" class="r20 r">description</span>,
            <b>string</b> <span id="r21 rd" class="r21 r">descriptionFallback</span>,
            <b>string</b> <span id="r22 rd" class="r22 r">vendor</span>,
            <b>string</b> <span id="r23 rd" class="r23 r">vendorFallback</span>
        )
        : <a href="#93cd0a543851215c" class="k">this</a>(<span class="r11 r">name</span>, <span class="r12 r">isDefault</span>, <span class="r13 r">applicationBase</span>, <span class="r14 r">assemblyName</span>, <span class="r15 r">moduleName</span>, <span class="r16 r">psVersion</span>, <span class="r17 r">version</span>, <span class="r18 r">types</span>, <span class="r19 r">formats</span>, <span class="r21 r">descriptionFallback</span>, <span class="r23 r">vendorFallback</span>)
        {
            <a href="#8be41a1ec1868713" class="i field">_description</a> = <span class="r20 r">description</span>;
            <a href="#a75e5ee53161067d" class="i field">_vendor</a> = <span class="r22 r">vendor</span>;
        }
 
        <b>internal</b> <a id="8bbd839802902afb" href="../../R/8bbd839802902afb.html" target="n" data-glyph="74,1" class="t constructor">PSSnapInInfo</a>
        (
            <b>string</b> <span id="r24 rd" class="r24 r">name</span>,
            <b>bool</b> <span id="r25 rd" class="r25 r">isDefault</span>,
            <b>string</b> <span id="r26 rd" class="r26 r">applicationBase</span>,
            <b>string</b> <span id="r27 rd" class="r27 r">assemblyName</span>,
            <b>string</b> <span id="r28 rd" class="r28 r">moduleName</span>,
            <span class="i">Version</span> <span id="r29 rd" class="r29 r">psVersion</span>,
            <span class="i">Version</span> <span id="r30 rd" class="r30 r">version</span>,
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r31 rd" class="r31 r">types</span>,
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r32 rd" class="r32 r">formats</span>,
            <b>string</b> <span id="r33 rd" class="r33 r">description</span>,
            <b>string</b> <span id="r34 rd" class="r34 r">descriptionFallback</span>,
            <b>string</b> <span id="r35 rd" class="r35 r">descriptionIndirect</span>,
            <b>string</b> <span id="r36 rd" class="r36 r">vendor</span>,
            <b>string</b> <span id="r37 rd" class="r37 r">vendorFallback</span>,
            <b>string</b> <span id="r38 rd" class="r38 r">vendorIndirect</span>
        ) : <a href="#805c5ae775e8191f" class="k">this</a>(<span class="r24 r">name</span>, <span class="r25 r">isDefault</span>, <span class="r26 r">applicationBase</span>, <span class="r27 r">assemblyName</span>, <span class="r28 r">moduleName</span>, <span class="r29 r">psVersion</span>, <span class="r30 r">version</span>, <span class="r31 r">types</span>, <span class="r32 r">formats</span>, <span class="r33 r">description</span>, <span class="r34 r">descriptionFallback</span>, <span class="r36 r">vendor</span>, <span class="r37 r">vendorFallback</span>)
        {
            <span class="c">// add descriptionIndirect and vendorIndirect only if the mshsnapin is a default mshsnapin</span>
            <b>if</b> (<span class="r25 r">isDefault</span>)
            {
                <a href="#b51367a30593a43f" class="i field">_descriptionIndirect</a> = <span class="r35 r">descriptionIndirect</span>;
                <a href="#51ca6abb145cd836" class="i field">_vendorIndirect</a> = <span class="r38 r">vendorIndirect</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unique Name of the mshsnapin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ebdb1944f8049e83" href="../../R/ebdb1944f8049e83.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Is this mshsnapin default mshsnapin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="29d7c728d53457e4" href="../../R/29d7c728d53457e4.html" target="n" data-glyph="102,1" class="i property">IsDefault</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns applicationbase for mshsnapin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="dc0461df9f1a5d5a" href="../../R/dc0461df9f1a5d5a.html" target="n" data-glyph="102,1" class="i property">ApplicationBase</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Strong name of mshSnapIn assembly.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ad98c4c4a02154bb" href="../../R/ad98c4c4a02154bb.html" target="n" data-glyph="102,1" class="i property">AssemblyName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of PSSnapIn module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="e13b77813ea4fc5e" href="../../R/e13b77813ea4fc5e.html" target="n" data-glyph="102,1" class="i property">ModuleName</a> { <b>get</b>; }
 
        <b>internal string</b> <a id="129cc76c8c0bf832" href="../../R/129cc76c8c0bf832.html" target="n" data-glyph="104,1" class="i property">AbsoluteModulePath</a>
        {
            <b>get</b>
            {
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#e13b77813ea4fc5e" class="i property">ModuleName</a>) || <span class="i">Path</span>.<span class="i">IsPathRooted</span>(<a href="#e13b77813ea4fc5e" class="i property">ModuleName</a>))
                {
                    <b>return</b> <a href="#e13b77813ea4fc5e" class="i property">ModuleName</a>;
                }
                <b>else</b> <b>if</b> (!<span class="i">File</span>.<span class="i">Exists</span>(<span class="i">Path</span>.<span class="i">Combine</span>(<a href="#dc0461df9f1a5d5a" class="i property">ApplicationBase</a>, <a href="#e13b77813ea4fc5e" class="i property">ModuleName</a>)))
                {
                    <b>return</b> <span class="i">Path</span>.<span class="i">GetFileNameWithoutExtension</span>(<a href="#e13b77813ea4fc5e" class="i property">ModuleName</a>);
                }
 
                <b>return</b> <span class="i">Path</span>.<span class="i">Combine</span>(<a href="#dc0461df9f1a5d5a" class="i property">ApplicationBase</a>, <a href="#e13b77813ea4fc5e" class="i property">ModuleName</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Monad version used by mshsnapin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Version</span> <a id="eccaf10188e41976" href="../../R/eccaf10188e41976.html" target="n" data-glyph="102,1" class="i property">PSVersion</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Version of mshsnapin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Version</span> <a id="f0960dddd3597e69" href="../../R/f0960dddd3597e69.html" target="n" data-glyph="102,1" class="i property">Version</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Collection of file names containing types information for PSSnapIn.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="e35c7867f8d42d8a" href="../../R/e35c7867f8d42d8a.html" target="n" data-glyph="102,1" class="i property">Types</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Collection of file names containing format information for PSSnapIn.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="97d12a57dedcadc2" href="../../R/97d12a57dedcadc2.html" target="n" data-glyph="102,1" class="i property">Formats</a> { <b>get</b>; }
 
        <b>private readonly string</b> <a id="b51367a30593a43f" href="../../R/b51367a30593a43f.html" target="n" data-glyph="46,1" class="i field">_descriptionIndirect</a>;
        <b>private readonly string</b> <a id="59b848592bff6554" href="../../R/59b848592bff6554.html" target="n" data-glyph="46,1" class="i field">_descriptionFallback</a> = <b>string</b>.<span class="i">Empty</span>;
        <b>private string</b> <a id="8be41a1ec1868713" href="../../R/8be41a1ec1868713.html" target="n" data-glyph="46,1" class="i field">_description</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Description of mshsnapin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="9a4d55528694a7fc" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Description</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#8be41a1ec1868713" class="i field">_description</a> == <b>null</b>)
                {
                    <a href="#90784400e97542d5" class="i method">LoadIndirectResources</a>();
                }
 
                <b>return</b> <a href="#8be41a1ec1868713" class="i field">_description</a>;
            }
        }
 
        <b>private readonly string</b> <a id="51ca6abb145cd836" href="../../R/51ca6abb145cd836.html" target="n" data-glyph="46,1" class="i field">_vendorIndirect</a>;
        <b>private readonly string</b> <a id="56004c833c38f0a3" href="../../R/56004c833c38f0a3.html" target="n" data-glyph="46,1" class="i field">_vendorFallback</a> = <b>string</b>.<span class="i">Empty</span>;
        <b>private string</b> <a id="a75e5ee53161067d" href="../../R/a75e5ee53161067d.html" target="n" data-glyph="46,1" class="i field">_vendor</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Vendor of mshsnapin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="81e3af23755689ea" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Vendor</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#a75e5ee53161067d" class="i field">_vendor</a> == <b>null</b>)
                {
                    <a href="#90784400e97542d5" class="i method">LoadIndirectResources</a>();
                }
 
                <b>return</b> <a href="#a75e5ee53161067d" class="i field">_vendor</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get/set whether to log Pipeline Execution Detail events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="75aa8a396932903e" href="../../R/75aa8a396932903e.html" target="n" data-glyph="102,1" class="i property">LogPipelineExecutionDetails</a> { <b>get</b>; <b>set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Overrides ToString.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name of the PSSnapIn</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="9955814c7db4199b" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#ebdb1944f8049e83" class="i property">Name</a>;
        }
 
        <b>internal</b> <span class="i">RegistryKey</span> <a id="dba672c832b1744b" href="../../R/dba672c832b1744b.html" target="n" data-glyph="104,1" class="i property">MshSnapinKey</a>
        {
            <b>get</b>
            {
                <span class="i">RegistryKey</span> <span id="r39 rd" class="r39 r">mshsnapinKey</span> = <b>null</b>;
 
                <b>try</b>
                {
                    <span class="r39 r">mshsnapinKey</span> = <a href="#b036b8d90fff7faa" class="t t">PSSnapInReader</a>.<span class="i">GetMshSnapinKey</span>(<a href="#ebdb1944f8049e83" class="i property">Name</a>, <a href="#eccaf10188e41976" class="i property">PSVersion</a>.<span class="i">Major</span>.<span class="i">ToString</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>));
                }
                <b>catch</b> (<span class="i">ArgumentException</span>)
                {
                }
                <b>catch</b> (<span class="i">SecurityException</span>)
                {
                }
                <b>catch</b> (<span class="i n">System</span>.<span class="i">IO</span>.<span class="i">IOException</span>)
                {
                }
 
                <b>return</b> <span class="r39 r">mshsnapinKey</span>;
            }
        }
 
        <b>internal void</b> <a id="90784400e97542d5" href="../../R/90784400e97542d5.html" target="n" data-glyph="74,1" class="i method">LoadIndirectResources</a>()
        {
            <b>using</b> (<a href="../../CoreCLR/CorePsStub.cs.html#7b46197e3795d23d" class="t t">RegistryStringResourceIndirect</a> <span id="r40 rd" class="r40 r">resourceReader</span> = <a href="../../CoreCLR/CorePsStub.cs.html#7b46197e3795d23d" class="t t">RegistryStringResourceIndirect</a>.<a href="../../CoreCLR/CorePsStub.cs.html#46f5e93449d857c6" class="i method">GetResourceIndirectReader</a>())
            {
                <a href="#d747e58379b4518d" class="i method">LoadIndirectResources</a>(<span class="r40 r">resourceReader</span>);
            }
        }
 
        <b>internal void</b> <a id="d747e58379b4518d" href="../../R/d747e58379b4518d.html" target="n" data-glyph="74,1" class="i method">LoadIndirectResources</a>(<a href="../../CoreCLR/CorePsStub.cs.html#7b46197e3795d23d" class="t t">RegistryStringResourceIndirect</a> <span id="r41 rd" class="r41 r">resourceReader</span>)
        {
            <b>if</b> (<a href="#29d7c728d53457e4" class="i property">IsDefault</a>)
            {
                <span class="c">// For default mshsnapins..resource indirects are hardcoded..</span>
                <span class="c">// so dont read from the registry</span>
                <a href="#8be41a1ec1868713" class="i field">_description</a> = <span class="r41 r">resourceReader</span>.<a href="../../CoreCLR/CorePsStub.cs.html#a372bc93cd96e2de" class="i method">GetResourceStringIndirect</a>(
                    <a href="#ad98c4c4a02154bb" class="i property">AssemblyName</a>,
                    <a href="#e13b77813ea4fc5e" class="i property">ModuleName</a>,
                    <a href="#b51367a30593a43f" class="i field">_descriptionIndirect</a>);
 
                <a href="#a75e5ee53161067d" class="i field">_vendor</a> = <span class="r41 r">resourceReader</span>.<a href="../../CoreCLR/CorePsStub.cs.html#a372bc93cd96e2de" class="i method">GetResourceStringIndirect</a>(
                    <a href="#ad98c4c4a02154bb" class="i property">AssemblyName</a>,
                    <a href="#e13b77813ea4fc5e" class="i property">ModuleName</a>,
                    <a href="#51ca6abb145cd836" class="i field">_vendorIndirect</a>);
            }
            <b>else</b>
            {
                <span class="i">RegistryKey</span> <span id="r42 rd" class="r42 r">mshsnapinKey</span> = <a href="#dba672c832b1744b" class="i property">MshSnapinKey</a>;
                <b>if</b> (<span class="r42 r">mshsnapinKey</span> != <b>null</b>)
                {
                    <a href="#8be41a1ec1868713" class="i field">_description</a> =
                        <span class="r41 r">resourceReader</span>.<a href="../../CoreCLR/CorePsStub.cs.html#594e9bd78af58900" class="i method">GetResourceStringIndirect</a>(
                            <span class="r42 r">mshsnapinKey</span>,
                            <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#bba830cb2a1c2485" class="i field">MshSnapin_DescriptionResource</a>,
                            <a href="#ad98c4c4a02154bb" class="i property">AssemblyName</a>,
                            <a href="#e13b77813ea4fc5e" class="i property">ModuleName</a>);
 
                    <a href="#a75e5ee53161067d" class="i field">_vendor</a> =
                        <span class="r41 r">resourceReader</span>.<a href="../../CoreCLR/CorePsStub.cs.html#594e9bd78af58900" class="i method">GetResourceStringIndirect</a>(
                            <span class="r42 r">mshsnapinKey</span>,
                            <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#6e22dc0a0507aad0" class="i field">MshSnapin_VendorResource</a>,
                            <a href="#ad98c4c4a02154bb" class="i property">AssemblyName</a>,
                            <a href="#e13b77813ea4fc5e" class="i property">ModuleName</a>);
                }
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#8be41a1ec1868713" class="i field">_description</a>))
            {
                <a href="#8be41a1ec1868713" class="i field">_description</a> = <a href="#59b848592bff6554" class="i field">_descriptionFallback</a>;
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#a75e5ee53161067d" class="i field">_vendor</a>))
            {
                <a href="#a75e5ee53161067d" class="i field">_vendor</a> = <a href="#56004c833c38f0a3" class="i field">_vendorFallback</a>;
            }
        }
 
        <b>internal</b> <a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <a id="5ca04dcf39de9931" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">Clone</a>()
        {
            <a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r43 rd" class="r43 r">cloned</span> = <b>new</b> <a href="#8bbd839802902afb" class="t constructor">PSSnapInInfo</a>(
                <a href="#ebdb1944f8049e83" class="i property">Name</a>,
                <a href="#29d7c728d53457e4" class="i property">IsDefault</a>,
                <a href="#dc0461df9f1a5d5a" class="i property">ApplicationBase</a>,
                <a href="#ad98c4c4a02154bb" class="i property">AssemblyName</a>,
                <a href="#e13b77813ea4fc5e" class="i property">ModuleName</a>,
                <a href="#eccaf10188e41976" class="i property">PSVersion</a>,
                <a href="#f0960dddd3597e69" class="i property">Version</a>,
                <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<a href="#e35c7867f8d42d8a" class="i property">Types</a>),
                <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<a href="#97d12a57dedcadc2" class="i property">Formats</a>),
                <a href="#8be41a1ec1868713" class="i field">_description</a>,
                <a href="#59b848592bff6554" class="i field">_descriptionFallback</a>,
                <a href="#b51367a30593a43f" class="i field">_descriptionIndirect</a>,
                 <a href="#a75e5ee53161067d" class="i field">_vendor</a>,
                 <a href="#56004c833c38f0a3" class="i field">_vendorFallback</a>,
                 <a href="#51ca6abb145cd836" class="i field">_vendorIndirect</a>);
 
            <b>return</b> <span class="r43 r">cloned</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the PSSnapIn Id is valid. A PSSnapIn is valid iff it contains only</span>
        <span class="c">///</span><span class="c"> &quot;Alpha Numeric&quot;,&quot;-&quot;,&quot;_&quot;,&quot;.&quot; characters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">psSnapinId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSSnapIn Id to validate.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="153f92aef8175cd9" href="../../R/153f92aef8175cd9.html" target="n" data-glyph="74,1" class="i method">IsPSSnapinIdValid</a>(<b>string</b> <span id="r44 rd" class="r44 r">psSnapinId</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r44 r">psSnapinId</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <span class="i">Regex</span>.<span class="i">IsMatch</span>(<span class="r44 r">psSnapinId</span>, <span class="s">&quot;^[A-Za-z0-9-_\x2E]*$&quot;</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validates the PSSnapIn Id. A PSSnapIn is valid iff it contains only</span>
        <span class="c">///</span><span class="c"> &quot;Alpha Numeric&quot;,&quot;-&quot;,&quot;_&quot;,&quot;.&quot; characters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">psSnapinId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSSnapIn Id to validate.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../../utils/MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1. Specified PSSnapIn is not valid</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="6c7c62ec5f9270ca" href="../../R/6c7c62ec5f9270ca.html" target="n" data-glyph="74,1" class="i method">VerifyPSSnapInFormatThrowIfError</a>(<b>string</b> <span id="r45 rd" class="r45 r">psSnapinId</span>)
        {
            <span class="c">// PSSnapIn do not conform to the naming convention..so throw</span>
            <span class="c">// argument exception</span>
            <b>if</b> (!<a href="#153f92aef8175cd9" class="i method">IsPSSnapinIdValid</a>(<span class="r45 r">psSnapinId</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r45 r">psSnapinId</span>),
                    <span class="i">MshSnapInCmdletResources</span>.<span class="i">InvalidPSSnapInName</span>,
                    <span class="r45 r">psSnapinId</span>);
            }
 
            <span class="c">// Valid SnapId..Just return</span>
            <b>return</b>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Internal class to read information about a mshsnapin.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="b036b8d90fff7faa" href="../../R/b036b8d90fff7faa.html" target="n" data-glyph="2,0" class="t t">PSSnapInReader</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads all registered mshsnapin for all monad versions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of PSSnapInInfo objects</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User doesn&#39;t have access to monad/mshsnapin registration information</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Monad key is not installed</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Collection</span>&lt;<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <a id="56caf8ed7e820758" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ReadAll</a>()
        {
            <span class="i">Collection</span>&lt;<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <span id="r46 rd" class="r46 r">allMshSnapins</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt;();
            <span class="i">RegistryKey</span> <span id="r47 rd" class="r47 r">monadRootKey</span> = <a href="#e096581baa29246a" class="i method">GetMonadRootKey</a>();
 
            <b>string</b>[] <span id="r48 rd" class="r48 r">versions</span> = <span class="r47 r">monadRootKey</span>.<span class="i">GetSubKeyNames</span>();
            <b>if</b> (<span class="r48 r">versions</span> == <b>null</b>)
            {
                <b>return</b> <span class="r46 r">allMshSnapins</span>;
            }
 
            <span class="c">// PS V3 snapin information is stored under 1 registry key..</span>
            <span class="c">// so no need to iterate over twice.</span>
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r49 rd" class="r49 r">filteredVersions</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
            <b>foreach</b> (<b>string</b> <span id="r50 rd" class="r50 r">version</span> <b>in</b> <span class="r48 r">versions</span>)
            {
                <b>string</b> <span id="r51 rd" class="r51 r">temp</span> = <a href="../../engine/PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../engine/PSVersionInfo.cs.html#40b698f943dba5f2" class="i method">GetRegistryVersionKeyForSnapinDiscovery</a>(<span class="r50 r">version</span>);
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r51 r">temp</span>))
                {
                    <span class="r51 r">temp</span> = <span class="r50 r">version</span>;
                }
 
                <b>if</b> (!<span class="r49 r">filteredVersions</span>.<span class="i">Contains</span>(<span class="r51 r">temp</span>))
                {
                    <span class="r49 r">filteredVersions</span>.<span class="i">Add</span>(<span class="r51 r">temp</span>);
                }
            }
 
            <b>foreach</b> (<b>string</b> <span id="r52 rd" class="r52 r">version</span> <b>in</b> <span class="r49 r">filteredVersions</span>)
            {
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r52 r">version</span>))
                {
                    <b>continue</b>;
                }
                <span class="c">// found a key which is not version</span>
                <b>if</b> (!<a href="#14dd6be1b0e3ac58" class="i method">MeetsVersionFormat</a>(<span class="r52 r">version</span>))
                {
                    <b>continue</b>;
                }
 
                <span class="i">Collection</span>&lt;<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <span id="r53 rd" class="r53 r">oneVersionMshSnapins</span> = <b>null</b>;
                <b>try</b>
                {
                    <span class="r53 r">oneVersionMshSnapins</span> = <a href="#38812fdcfa11f461" class="i method">ReadAll</a>(<span class="r47 r">monadRootKey</span>, <span class="r52 r">version</span>);
                }
                <span class="c">// If we cannot get information for one version, continue with other</span>
                <span class="c">// versions</span>
                <b>catch</b> (<span class="i">SecurityException</span>)
                {
                }
                <b>catch</b> (<span class="i">ArgumentException</span>)
                {
                }
 
                <b>if</b> (<span class="r53 r">oneVersionMshSnapins</span> != <b>null</b>)
                {
                    <b>foreach</b> (<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r54 rd" class="r54 r">info</span> <b>in</b> <span class="r53 r">oneVersionMshSnapins</span>)
                    {
                        <span class="r46 r">allMshSnapins</span>.<span class="i">Add</span>(<span class="r54 r">info</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r46 r">allMshSnapins</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Version should be integer (1, 2, 3 etc)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">version</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private
        static
        bool</b> <a id="14dd6be1b0e3ac58" href="../../R/14dd6be1b0e3ac58.html" target="n" data-glyph="76,1" class="i method">MeetsVersionFormat</a>(<b>string</b> <span id="r55 rd" class="r55 r">version</span>)
        {
            <b>bool</b> <span id="r56 rd" class="r56 r">r</span> = <b>true</b>;
            <b>try</b>
            {
                <a href="../../engine/LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r55 r">version</span>, <b>typeof</b>(<b>int</b>), <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
            }
            <b>catch</b> (<a href="../../engine/ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a>)
            {
                <span class="r56 r">r</span> = <b>false</b>;
            }
 
            <b>return</b> <span class="r56 r">r</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads all registered mshsnapin for specified psVersion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of PSSnapInInfo objects</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User doesn&#39;t have permission to read MonadRoot or Version</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> MonadRoot or Version key doesn&#39;t exist.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Collection</span>&lt;<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <a id="f4a9b37f5f047fe3" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ReadAll</a>(<b>string</b> <span id="r57 rd" class="r57 r">psVersion</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r57 r">psVersion</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r57 r">psVersion</span>));
            }
 
            <span class="i">RegistryKey</span> <span id="r58 rd" class="r58 r">monadRootKey</span> = <a href="#e096581baa29246a" class="i method">GetMonadRootKey</a>();
            <b>return</b> <a href="#38812fdcfa11f461" class="i method">ReadAll</a>(<span class="r58 r">monadRootKey</span>, <span class="r57 r">psVersion</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads all the mshsnapins for a given psVersion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The User doesn&#39;t have required permission to read the registry key for this version.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specified version doesn&#39;t exist.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User doesn&#39;t have permission to read specified version</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">Collection</span>&lt;<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <a id="38812fdcfa11f461" href="../../R/38812fdcfa11f461.html" target="n" data-glyph="76,1" class="i method">ReadAll</a>(<span class="i">RegistryKey</span> <span id="r59 rd" class="r59 r">monadRootKey</span>, <b>string</b> <span id="r60 rd" class="r60 r">psVersion</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r59 r">monadRootKey</span> != <b>null</b>, <span class="s">&quot;caller should validate the information&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r60 r">psVersion</span>), <span class="s">&quot;caller should validate the information&quot;</span>);
 
            <span class="i">Collection</span>&lt;<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <span id="r61 rd" class="r61 r">mshsnapins</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt;();
            <span class="i">RegistryKey</span> <span id="r62 rd" class="r62 r">versionRoot</span> = <a href="#dd06ce13c1d3a64f" class="i method">GetVersionRootKey</a>(<span class="r59 r">monadRootKey</span>, <span class="r60 r">psVersion</span>);
            <span class="i">RegistryKey</span> <span id="r63 rd" class="r63 r">mshsnapinRoot</span> = <a href="#b59c5a6e27ebf3b7" class="i method">GetMshSnapinRootKey</a>(<span class="r62 r">versionRoot</span>, <span class="r60 r">psVersion</span>);
 
            <span class="c">// get name of all mshsnapin for this version</span>
            <b>string</b>[] <span id="r64 rd" class="r64 r">mshsnapinIds</span> = <span class="r63 r">mshsnapinRoot</span>.<span class="i">GetSubKeyNames</span>();
 
            <b>foreach</b> (<b>string</b> <span id="r65 rd" class="r65 r">id</span> <b>in</b> <span class="r64 r">mshsnapinIds</span>)
            {
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r65 r">id</span>))
                {
                    <b>continue</b>;
                }
 
                <b>try</b>
                {
                    <span class="r61 r">mshsnapins</span>.<span class="i">Add</span>(<a href="#53e678d470b88f85" class="i method">ReadOne</a>(<span class="r63 r">mshsnapinRoot</span>, <span class="r65 r">id</span>));
                }
                <span class="c">// If we cannot read some mshsnapins, we should continue</span>
                <b>catch</b> (<span class="i">SecurityException</span>)
                {
                }
                <b>catch</b> (<span class="i">ArgumentException</span>)
                {
                }
            }
 
            <b>return</b> <span class="r61 r">mshsnapins</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Read mshsnapin for specified mshsnapinId and psVersion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> MshSnapin info object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The user does not have the permissions required to read the</span>
        <span class="c">///</span><span class="c"> registry key for one of the following:</span>
        <span class="c">///</span><span class="c"> 1) Monad</span>
        <span class="c">///</span><span class="c"> 2) PSVersion</span>
        <span class="c">///</span><span class="c"> 3) MshSnapinId</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1) Monad key is not present</span>
        <span class="c">///</span><span class="c"> 2) VersionKey is not present</span>
        <span class="c">///</span><span class="c"> 3) MshSnapin key is not present</span>
        <span class="c">///</span><span class="c"> 4) MshSnapin key is not valid</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <a id="8ac2780a30babc4f" href="../../R/8ac2780a30babc4f.html" target="n" data-glyph="74,1" class="i method">Read</a>(<b>string</b> <span id="r66 rd" class="r66 r">psVersion</span>, <b>string</b> <span id="r67 rd" class="r67 r">mshsnapinId</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r66 r">psVersion</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r66 r">psVersion</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r67 r">mshsnapinId</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r67 r">mshsnapinId</span>));
            }
            <span class="c">// PSSnapIn Reader wont service invalid mshsnapins</span>
            <span class="c">// Monad has specific restrictions on the mshsnapinid like</span>
            <span class="c">// mshsnapinid should be A-Za-z0-9.-_ etc.</span>
            <a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a>.<a href="#6c7c62ec5f9270ca" class="i method">VerifyPSSnapInFormatThrowIfError</a>(<span class="r67 r">mshsnapinId</span>);
 
            <span class="i">RegistryKey</span> <span id="r68 rd" class="r68 r">rootKey</span> = <a href="#e096581baa29246a" class="i method">GetMonadRootKey</a>();
            <span class="i">RegistryKey</span> <span id="r69 rd" class="r69 r">versionRoot</span> = <a href="#dd06ce13c1d3a64f" class="i method">GetVersionRootKey</a>(<span class="r68 r">rootKey</span>, <span class="r66 r">psVersion</span>);
            <span class="i">RegistryKey</span> <span id="r70 rd" class="r70 r">mshsnapinRoot</span> = <a href="#b59c5a6e27ebf3b7" class="i method">GetMshSnapinRootKey</a>(<span class="r69 r">versionRoot</span>, <span class="r66 r">psVersion</span>);
 
            <b>return</b> <a href="#53e678d470b88f85" class="i method">ReadOne</a>(<span class="r70 r">mshsnapinRoot</span>, <span class="r67 r">mshsnapinId</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads the mshsnapin info for a specific key under specific monad version.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ReadOne will never create a default PSSnapInInfo object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The user does not have the permissions required to read the</span>
        <span class="c">///</span><span class="c"> registry key for specified mshsnapin.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> 1) Specified mshsnapin is not installed.</span>
        <span class="c">///</span><span class="c"> 2) Specified mshsnapin is not correctly installed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private static</b> <a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <a id="53e678d470b88f85" href="../../R/53e678d470b88f85.html" target="n" data-glyph="76,1" class="i method">ReadOne</a>(<span class="i">RegistryKey</span> <span id="r71 rd" class="r71 r">mshSnapInRoot</span>, <b>string</b> <span id="r72 rd" class="r72 r">mshsnapinId</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r72 r">mshsnapinId</span>), <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r71 r">mshSnapInRoot</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <span class="i">RegistryKey</span> <span id="r73 rd" class="r73 r">mshsnapinKey</span>;
            <span class="r73 r">mshsnapinKey</span> = <span class="r71 r">mshSnapInRoot</span>.<span class="i">OpenSubKey</span>(<span class="r72 r">mshsnapinId</span>);
            <b>if</b> (<span class="r73 r">mshsnapinKey</span> == <b>null</b>)
            {
                <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<span class="i">TraceError</span>(<span class="s">&quot;Error opening registry key {0}\\{1}.&quot;</span>, <span class="r71 r">mshSnapInRoot</span>.<span class="i">Name</span>, <span class="r72 r">mshsnapinId</span>);
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r72 r">mshsnapinId</span>), <span class="i">MshSnapinInfo</span>.<span class="i">MshSnapinDoesNotExist</span>, <span class="r72 r">mshsnapinId</span>);
            }
 
            <b>string</b> <span id="r74 rd" class="r74 r">applicationBase</span> = <a href="#4993720dfb89919c" class="i method">ReadStringValue</a>(<span class="r73 r">mshsnapinKey</span>, <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#ffa474d6060bfca5" class="i field">MshSnapin_ApplicationBase</a>, <b>true</b>);
            <b>string</b> <span id="r75 rd" class="r75 r">assemblyName</span> = <a href="#4993720dfb89919c" class="i method">ReadStringValue</a>(<span class="r73 r">mshsnapinKey</span>, <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#166c068a990d59dc" class="i field">MshSnapin_AssemblyName</a>, <b>true</b>);
            <b>string</b> <span id="r76 rd" class="r76 r">moduleName</span> = <a href="#4993720dfb89919c" class="i method">ReadStringValue</a>(<span class="r73 r">mshsnapinKey</span>, <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#8781d4ed0096001b" class="i field">MshSnapin_ModuleName</a>, <b>true</b>);
            <span class="i">Version</span> <span id="r77 rd" class="r77 r">monadVersion</span> = <a href="#9cdade30ee7b9fa3" class="i method">ReadVersionValue</a>(<span class="r73 r">mshsnapinKey</span>, <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#7e50d60babc0bc67" class="i field">MshSnapin_MonadVersion</a>, <b>true</b>);
            <span class="i">Version</span> <span id="r78 rd" class="r78 r">version</span> = <a href="#9cdade30ee7b9fa3" class="i method">ReadVersionValue</a>(<span class="r73 r">mshsnapinKey</span>, <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#4be1f5db13ee682a" class="i field">MshSnapin_Version</a>, <b>false</b>);
 
            <b>string</b> <span id="r79 rd" class="r79 r">description</span> = <a href="#4993720dfb89919c" class="i method">ReadStringValue</a>(<span class="r73 r">mshsnapinKey</span>, <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#93fbc57537f5bda8" class="i field">MshSnapin_Description</a>, <b>false</b>);
            <b>if</b> (<span class="r79 r">description</span> == <b>null</b>)
            {
                <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;No description is specified for mshsnapin {0}. Using empty string for description.&quot;</span>, <span class="r72 r">mshsnapinId</span>);
                <span class="r79 r">description</span> = <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>string</b> <span id="r80 rd" class="r80 r">vendor</span> = <a href="#4993720dfb89919c" class="i method">ReadStringValue</a>(<span class="r73 r">mshsnapinKey</span>, <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#a5fcf391397f9415" class="i field">MshSnapin_Vendor</a>, <b>false</b>);
            <b>if</b> (<span class="r80 r">vendor</span> == <b>null</b>)
            {
                <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;No vendor is specified for mshsnapin {0}. Using empty string for description.&quot;</span>, <span class="r72 r">mshsnapinId</span>);
                <span class="r80 r">vendor</span> = <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>bool</b> <span id="r81 rd" class="r81 r">logPipelineExecutionDetails</span> = <b>false</b>;
            <b>string</b> <span id="r82 rd" class="r82 r">logPipelineExecutionDetailsStr</span> = <a href="#4993720dfb89919c" class="i method">ReadStringValue</a>(<span class="r73 r">mshsnapinKey</span>, <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#9df3984f7efc14de" class="i field">MshSnapin_LogPipelineExecutionDetails</a>, <b>false</b>);
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r82 r">logPipelineExecutionDetailsStr</span>))
            {
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="s">&quot;1&quot;</span>, <span class="r82 r">logPipelineExecutionDetailsStr</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    <span class="r81 r">logPipelineExecutionDetails</span> = <b>true</b>;
            }
 
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r83 rd" class="r83 r">types</span> = <a href="#b737517506cebe5c" class="i method">ReadMultiStringValue</a>(<span class="r73 r">mshsnapinKey</span>, <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#c0cd99346057e9eb" class="i field">MshSnapin_BuiltInTypes</a>, <b>false</b>);
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r84 rd" class="r84 r">formats</span> = <a href="#b737517506cebe5c" class="i method">ReadMultiStringValue</a>(<span class="r73 r">mshsnapinKey</span>, <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#2fddfed832945a23" class="i field">MshSnapin_BuiltInFormats</a>, <b>false</b>);
 
            <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Successfully read registry values for mshsnapin {0}. Constructing PSSnapInInfo object.&quot;</span>, <span class="r72 r">mshsnapinId</span>);
            <a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r85 rd" class="r85 r">mshSnapinInfo</span> = <b>new</b> <a href="#93cd0a543851215c" class="t constructor">PSSnapInInfo</a>(<span class="r72 r">mshsnapinId</span>, <b>false</b>, <span class="r74 r">applicationBase</span>, <span class="r75 r">assemblyName</span>, <span class="r76 r">moduleName</span>, <span class="r77 r">monadVersion</span>, <span class="r78 r">version</span>, <span class="r83 r">types</span>, <span class="r84 r">formats</span>, <span class="r79 r">description</span>, <span class="r80 r">vendor</span>);
            <span class="r85 r">mshSnapinInfo</span>.<a href="#75aa8a396932903e" class="i property">LogPipelineExecutionDetails</a> = <span class="r81 r">logPipelineExecutionDetails</span>;
 
            <b>return</b> <span class="r85 r">mshSnapinInfo</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets multistring value for name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">mshsnapinKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r87 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r88 r">mandatory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if value is not present and mandatory is true</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="b737517506cebe5c" href="../../R/b737517506cebe5c.html" target="n" data-glyph="76,1" class="i method">ReadMultiStringValue</a>(<span class="i">RegistryKey</span> <span id="r86 rd" class="r86 r">mshsnapinKey</span>, <b>string</b> <span id="r87 rd" class="r87 r">name</span>, <b>bool</b> <span id="r88 rd" class="r88 r">mandatory</span>)
        {
            <b>object</b> <span id="r89 rd" class="r89 r">value</span> = <span class="r86 r">mshsnapinKey</span>.<span class="i">GetValue</span>(<span class="r87 r">name</span>);
            <b>if</b> (<span class="r89 r">value</span> == <b>null</b>)
            {
                <span class="c">// If this key should be present..throw error</span>
                <b>if</b> (<span class="r88 r">mandatory</span>)
                {
                    <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<span class="i">TraceError</span>(<span class="s">&quot;Mandatory property {0} not specified for registry key {1}&quot;</span>,
                        <span class="r87 r">name</span>, <span class="r86 r">mshsnapinKey</span>.<span class="i">Name</span>);
                    <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r87 r">name</span>), <span class="i">MshSnapinInfo</span>.<span class="i">MandatoryValueNotPresent</span>, <span class="r87 r">name</span>, <span class="r86 r">mshsnapinKey</span>.<span class="i">Name</span>);
                }
                <b>else</b>
                {
                    <b>return</b> <b>null</b>;
                }
            }
 
            <span class="c">// value cannot be null here...</span>
            <b>string</b>[] <span id="r90 rd" class="r90 r">msv</span> = <span class="r89 r">value</span> <b>as string</b>[];
 
            <b>if</b> (<span class="r90 r">msv</span> == <b>null</b>)
            {
                <span class="c">// Check if the value is in string format</span>
                <b>string</b> <span id="r91 rd" class="r91 r">singleValue</span> = <span class="r89 r">value</span> <b>as string</b>;
                <b>if</b> (<span class="r91 r">singleValue</span> != <b>null</b>)
                {
                    <span class="r90 r">msv</span> = <b>new</b> <b>string</b>[1];
                    <span class="r90 r">msv</span>[0] = <span class="r91 r">singleValue</span>;
                }
            }
 
            <b>if</b> (<span class="r90 r">msv</span> == <b>null</b>)
            {
                <b>if</b> (<span class="r88 r">mandatory</span>)
                {
                    <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<span class="i">TraceError</span>(<span class="s">&quot;Cannot get string/multi-string value for mandatory property {0} in registry key {1}&quot;</span>,
                        <span class="r87 r">name</span>, <span class="r86 r">mshsnapinKey</span>.<span class="i">Name</span>);
                    <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r87 r">name</span>), <span class="i">MshSnapinInfo</span>.<span class="i">MandatoryValueNotInCorrectFormatMultiString</span>, <span class="r87 r">name</span>, <span class="r86 r">mshsnapinKey</span>.<span class="i">Name</span>);
                }
                <b>else</b>
                {
                    <b>return</b> <b>null</b>;
                }
            }
 
            <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Successfully read property {0} from {1}&quot;</span>,
                <span class="r87 r">name</span>, <span class="r86 r">mshsnapinKey</span>.<span class="i">Name</span>);
            <b>return</b> <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<span class="r90 r">msv</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the value for name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">mshsnapinKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">mandatory</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if no value is available and mandatory is true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="4993720dfb89919c" href="../../R/4993720dfb89919c.html" target="n" data-glyph="74,1" class="i method">ReadStringValue</a>(<span class="i">RegistryKey</span> <span id="r92 rd" class="r92 r">mshsnapinKey</span>, <b>string</b> <span id="r93 rd" class="r93 r">name</span>, <b>bool</b> <span id="r94 rd" class="r94 r">mandatory</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r93 r">name</span>), <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r92 r">mshsnapinKey</span> != <b>null</b>, <span class="s">&quot;Caller should validate the parameter&quot;</span>);
 
            <b>object</b> <span id="r95 rd" class="r95 r">value</span> = <span class="r92 r">mshsnapinKey</span>.<span class="i">GetValue</span>(<span class="r93 r">name</span>);
            <b>if</b> (<span class="r95 r">value</span> == <b>null</b> &amp;&amp; <span class="r94 r">mandatory</span>)
            {
                <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<span class="i">TraceError</span>(<span class="s">&quot;Mandatory property {0} not specified for registry key {1}&quot;</span>,
                        <span class="r93 r">name</span>, <span class="r92 r">mshsnapinKey</span>.<span class="i">Name</span>);
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r93 r">name</span>), <span class="i">MshSnapinInfo</span>.<span class="i">MandatoryValueNotPresent</span>, <span class="r93 r">name</span>, <span class="r92 r">mshsnapinKey</span>.<span class="i">Name</span>);
            }
 
            <b>string</b> <span id="r96 rd" class="r96 r">s</span> = <span class="r95 r">value</span> <b>as string</b>;
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r96 r">s</span>) &amp;&amp; <span class="r94 r">mandatory</span>)
            {
                <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<span class="i">TraceError</span>(<span class="s">&quot;Value is null or empty for mandatory property {0} in {1}&quot;</span>,
                        <span class="r93 r">name</span>, <span class="r92 r">mshsnapinKey</span>.<span class="i">Name</span>);
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r93 r">name</span>), <span class="i">MshSnapinInfo</span>.<span class="i">MandatoryValueNotInCorrectFormat</span>, <span class="r93 r">name</span>, <span class="r92 r">mshsnapinKey</span>.<span class="i">Name</span>);
            }
 
            <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Successfully read value {0} for property {1} from {2}&quot;</span>,
                <span class="r96 r">s</span>, <span class="r93 r">name</span>, <span class="r92 r">mshsnapinKey</span>.<span class="i">Name</span>);
            <b>return</b> <span class="r96 r">s</span>;
        }
 
        <b>internal static</b> <span class="i">Version</span> <a id="9cdade30ee7b9fa3" href="../../R/9cdade30ee7b9fa3.html" target="n" data-glyph="74,1" class="i method">ReadVersionValue</a>(<span class="i">RegistryKey</span> <span id="r97 rd" class="r97 r">mshsnapinKey</span>, <b>string</b> <span id="r98 rd" class="r98 r">name</span>, <b>bool</b> <span id="r99 rd" class="r99 r">mandatory</span>)
        {
            <b>string</b> <span id="r100 rd" class="r100 r">temp</span> = <a href="#4993720dfb89919c" class="i method">ReadStringValue</a>(<span class="r97 r">mshsnapinKey</span>, <span class="r98 r">name</span>, <span class="r99 r">mandatory</span>);
            <b>if</b> (<span class="r100 r">temp</span> == <b>null</b>)
            {
                <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<span class="i">TraceError</span>(<span class="s">&quot;Cannot read value for property {0} in registry key {1}&quot;</span>,
                    <span class="r98 r">name</span>, <span class="r97 r">mshsnapinKey</span>.<span class="i">ToString</span>());
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<span class="r99 r">mandatory</span>, <span class="s">&quot;mandatory is true, ReadStringValue should have thrown exception&quot;</span>);
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">Version</span> <span id="r101 rd" class="r101 r">v</span>;
            <b>try</b>
            {
                <span class="r101 r">v</span> = <b>new</b> <span class="i">Version</span>(<span class="r100 r">temp</span>);
            }
            <b>catch</b> (<span class="i">ArgumentOutOfRangeException</span>)
            {
                <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="s">&quot;Cannot convert value {0} to version format&quot;</span>, <span class="r100 r">temp</span>);
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r98 r">name</span>), <span class="i">MshSnapinInfo</span>.<span class="i">VersionValueInCorrect</span>, <span class="r98 r">name</span>, <span class="r97 r">mshsnapinKey</span>.<span class="i">Name</span>);
            }
            <b>catch</b> (<span class="i">ArgumentException</span>)
            {
                <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="s">&quot;Cannot convert value {0} to version format&quot;</span>, <span class="r100 r">temp</span>);
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r98 r">name</span>), <span class="i">MshSnapinInfo</span>.<span class="i">VersionValueInCorrect</span>, <span class="r98 r">name</span>, <span class="r97 r">mshsnapinKey</span>.<span class="i">Name</span>);
            }
            <b>catch</b> (<span class="i">OverflowException</span>)
            {
                <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="s">&quot;Cannot convert value {0} to version format&quot;</span>, <span class="r100 r">temp</span>);
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r98 r">name</span>), <span class="i">MshSnapinInfo</span>.<span class="i">VersionValueInCorrect</span>, <span class="r98 r">name</span>, <span class="r97 r">mshsnapinKey</span>.<span class="i">Name</span>);
            }
            <b>catch</b> (<span class="i">FormatException</span>)
            {
                <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<a href="../../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(<span class="s">&quot;Cannot convert value {0} to version format&quot;</span>, <span class="r100 r">temp</span>);
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r98 r">name</span>), <span class="i">MshSnapinInfo</span>.<span class="i">VersionValueInCorrect</span>, <span class="r98 r">name</span>, <span class="r97 r">mshsnapinKey</span>.<span class="i">Name</span>);
            }
 
            <a href="#89a259b8c36900af" class="i field">s_mshsnapinTracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Successfully converted string {0} to version format.&quot;</span>, <span class="r101 r">v</span>);
            <b>return</b> <span class="r101 r">v</span>;
        }
 
        <b>internal static void</b> <a id="101051843f1f53a1" href="../../R/101051843f1f53a1.html" target="n" data-glyph="74,1" class="i method">ReadRegistryInfo</a>(<b>out</b> <span class="i">Version</span> <span id="r102 rd" class="r102 r">assemblyVersion</span>, <b>out string</b> <span id="r103 rd" class="r103 r">publicKeyToken</span>, <b>out string</b> <span id="r104 rd" class="r104 r">culture</span>, <b>out string</b> <span id="r105 rd" class="r105 r">architecture</span>, <b>out string</b> <span id="r106 rd" class="r106 r">applicationBase</span>, <b>out</b> <span class="i">Version</span> <span id="r107 rd" class="r107 r">psVersion</span>)
        {
            <span class="r106 r">applicationBase</span> = <a href="../../engine/Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../../engine/Utils.cs.html#c677cc800603f8f5" class="i property">DefaultPowerShellAppBase</a>;
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(
                !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r106 r">applicationBase</span>),
                <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="s">&quot;{0} is empty or null&quot;</span>, <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#95527460585fa99e" class="i field">MonadEngine_ApplicationBase</a>));
 
            <span class="c">// Get the PSVersion from Utils..this is hardcoded</span>
            <span class="r107 r">psVersion</span> = <a href="../../engine/PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../engine/PSVersionInfo.cs.html#ad63365ac7690eeb" class="i property">PSVersion</a>;
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(
                <span class="r107 r">psVersion</span> != <b>null</b>,
                <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="s">&quot;{0} is null&quot;</span>, <a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#c31af753d2bfb9a0" class="i field">MonadEngine_MonadVersion</a>));
 
            <span class="c">// Get version number in x.x.x.x format</span>
            <span class="c">// This information is available from the executing assembly</span>
            <span class="c">//</span>
            <span class="c">// PROBLEM: The following code assumes all assemblies have the same version,</span>
            <span class="c">// culture, publickeytoken...This will break the scenarios where only one of</span>
            <span class="c">// the assemblies is patched. ie., all monad assemblies should have the</span>
            <span class="c">// same version number.</span>
            <span class="i">Assembly</span> <span id="r108 rd" class="r108 r">currentAssembly</span> = <b>typeof</b>(<a href="#b036b8d90fff7faa" class="t t">PSSnapInReader</a>).<span class="i">Assembly</span>;
            <span class="i">AssemblyName</span> <span id="r109 rd" class="r109 r">assemblyName</span> = <span class="r108 r">currentAssembly</span>.<span class="i">GetName</span>();
            <span class="r102 r">assemblyVersion</span> = <span class="r109 r">assemblyName</span>.<span class="i">Version</span>;
            <b>byte</b>[] <span id="r110 rd" class="r110 r">publicTokens</span> = <span class="r109 r">assemblyName</span>.<span class="i">GetPublicKeyToken</span>();
            <b>if</b> (<span class="r110 r">publicTokens</span>.<span class="i">Length</span> == 0)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;PublicKeyToken&quot;</span>, <span class="i">MshSnapinInfo</span>.<span class="i">PublicKeyTokenAccessFailed</span>);
            }
 
            <span class="r103 r">publicKeyToken</span> = <a href="#a27694b6ab855ba5" class="i method">ConvertByteArrayToString</a>(<span class="r110 r">publicTokens</span>);
 
            <span class="c">// save some cpu cycles by hardcoding the culture to neutral</span>
            <span class="c">// assembly should never be targeted to a particular culture</span>
            <span class="r104 r">culture</span> = <span class="s">&quot;neutral&quot;</span>;
 
            <span class="c">// Hardcoding the architecture MSIL as PowerShell assemblies are architecture neutral, this should</span>
            <span class="c">// be changed if the assumption is broken. Preferred hardcoded string to using (for perf reasons):</span>
            <span class="c">// string architecture = currentAssembly.GetName().ProcessorArchitecture.ToString()</span>
            <span class="r105 r">architecture</span> = <span class="s">&quot;MSIL&quot;</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PublicKeyToken is in the form of byte[]. Use this function to convert to a string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">tokens</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Array of byte&#39;s.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="a27694b6ab855ba5" href="../../R/a27694b6ab855ba5.html" target="n" data-glyph="74,1" class="i method">ConvertByteArrayToString</a>(<b>byte</b>[] <span id="r111 rd" class="r111 r">tokens</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r111 r">tokens</span> != <b>null</b>, <span class="s">&quot;Input tokens should never be null&quot;</span>);
            <span class="i">StringBuilder</span> <span id="r112 rd" class="r112 r">tokenBuilder</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="r111 r">tokens</span>.<span class="i">Length</span> * 2);
            <b>foreach</b> (<b>byte</b> <span id="r113 rd" class="r113 r">b</span> <b>in</b> <span class="r111 r">tokens</span>)
            {
                <span class="r112 r">tokenBuilder</span>.<span class="i">Append</span>(<span class="r113 r">b</span>.<span class="i">ToString</span>(<span class="s">&quot;x2&quot;</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>));
            }
 
            <b>return</b> <span class="r112 r">tokenBuilder</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads core snapin for monad engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A PSSnapInInfo object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <a id="b458c58d8c08f4e3" href="../../R/b458c58d8c08f4e3.html" target="n" data-glyph="74,1" class="i method">ReadCoreEngineSnapIn</a>()
        {
            <span class="i">Version</span> <span id="r114 rd" class="r114 r">assemblyVersion</span>, <span id="r115 rd" class="r115 r">psVersion</span>;
            <b>string</b> <span id="r116 rd" class="r116 r">publicKeyToken</span> = <b>null</b>;
            <b>string</b> <span id="r117 rd" class="r117 r">culture</span> = <b>null</b>;
            <b>string</b> <span id="r118 rd" class="r118 r">architecture</span> = <b>null</b>;
            <b>string</b> <span id="r119 rd" class="r119 r">applicationBase</span> = <b>null</b>;
 
            <a href="#101051843f1f53a1" class="i method">ReadRegistryInfo</a>(<b>out</b> <span class="r114 r">assemblyVersion</span>, <b>out</b> <span class="r116 r">publicKeyToken</span>, <b>out</b> <span class="r117 r">culture</span>, <b>out</b> <span class="r118 r">architecture</span>, <b>out</b> <span class="r119 r">applicationBase</span>, <b>out</b> <span class="r115 r">psVersion</span>);
 
            <span class="c">// System.Management.Automation formats &amp; types files</span>
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r120 rd" class="r120 r">types</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<b>new</b> <b>string</b>[] { <span class="s">&quot;types.ps1xml&quot;</span>, <span class="s">&quot;typesv3.ps1xml&quot;</span> });
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r121 rd" class="r121 r">formats</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<b>new</b> <b>string</b>[]
                        {<span class="s">&quot;Certificate.format.ps1xml&quot;</span>, <span class="s">&quot;DotNetTypes.format.ps1xml&quot;</span>, <span class="s">&quot;FileSystem.format.ps1xml&quot;</span>,
                         <span class="s">&quot;Help.format.ps1xml&quot;</span>, <span class="s">&quot;HelpV3.format.ps1xml&quot;</span>, <span class="s">&quot;PowerShellCore.format.ps1xml&quot;</span>, <span class="s">&quot;PowerShellTrace.format.ps1xml&quot;</span>,
                         <span class="s">&quot;Registry.format.ps1xml&quot;</span>});
 
            <b>string</b> <span id="r122 rd" class="r122 r">strongName</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;{0}, Version={1}, Culture={2}, PublicKeyToken={3}, ProcessorArchitecture={4}&quot;</span>,
                <a href="#62fd927cedd2f97e" class="i field">s_coreSnapin</a>.<a href="#6dbaff1390e46861" class="i field">AssemblyName</a>, <span class="r114 r">assemblyVersion</span>, <span class="r117 r">culture</span>, <span class="r116 r">publicKeyToken</span>, <span class="r118 r">architecture</span>);
 
            <b>string</b> <span id="r123 rd" class="r123 r">moduleName</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r119 r">applicationBase</span>, <a href="#62fd927cedd2f97e" class="i field">s_coreSnapin</a>.<a href="#6dbaff1390e46861" class="i field">AssemblyName</a> + <span class="s">&quot;.dll&quot;</span>);
 
            <a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r124 rd" class="r124 r">coreMshSnapin</span> = <b>new</b> <a href="#8bbd839802902afb" class="t constructor">PSSnapInInfo</a>(
                <a href="#62fd927cedd2f97e" class="i field">s_coreSnapin</a>.<a href="#45442cd5999d4e26" class="i field">PSSnapInName</a>,
                <span class="r25 r">isDefault</span>: <b>true</b>,
                <span class="r119 r">applicationBase</span>,
                <span class="r122 r">strongName</span>,
                <span class="r123 r">moduleName</span>,
                <span class="r115 r">psVersion</span>,
                <span class="r114 r">assemblyVersion</span>,
                <span class="r120 r">types</span>,
                <span class="r121 r">formats</span>,
                <span class="r33 r">description</span>: <b>null</b>,
                <a href="#62fd927cedd2f97e" class="i field">s_coreSnapin</a>.<a href="#c1142d614a251c15" class="i field">Description</a>,
                <a href="#62fd927cedd2f97e" class="i field">s_coreSnapin</a>.<a href="#f6d0471edb4f7871" class="i field">DescriptionIndirect</a>,
                <span class="r36 r">vendor</span>: <b>null</b>,
                <span class="r37 r">vendorFallback</span>: <b>null</b>,
                <a href="#62fd927cedd2f97e" class="i field">s_coreSnapin</a>.<a href="#a9d95d43b5c4a5bc" class="i field">VendorIndirect</a>);
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
            <span class="c">// NOTE: On Unix, logging has to be deferred until after command-line parsing</span>
            <span class="c">// complete. On Windows, deferring the call is not needed</span>
            <span class="c">// and this is in the startup code path.</span>
            <a href="#93c6b18aedf9eed5" class="i method">SetSnapInLoggingInformation</a>(<span class="r124 r">coreMshSnapin</span>);
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
            <b>return</b> <span class="r124 r">coreMshSnapin</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads all registered mshsnapins for currently executing monad engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of PSSnapInInfo objects</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Collection</span>&lt;<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <a id="e508dc80c5619134" href="../../R/e508dc80c5619134.html" target="n" data-glyph="74,1" class="i method">ReadEnginePSSnapIns</a>()
        {
            <span class="i">Version</span> <span id="r125 rd" class="r125 r">assemblyVersion</span>, <span id="r126 rd" class="r126 r">psVersion</span>;
            <b>string</b> <span id="r127 rd" class="r127 r">publicKeyToken</span> = <b>null</b>;
            <b>string</b> <span id="r128 rd" class="r128 r">culture</span> = <b>null</b>;
            <b>string</b> <span id="r129 rd" class="r129 r">architecture</span> = <b>null</b>;
            <b>string</b> <span id="r130 rd" class="r130 r">applicationBase</span> = <b>null</b>;
 
            <a href="#101051843f1f53a1" class="i method">ReadRegistryInfo</a>(<b>out</b> <span class="r125 r">assemblyVersion</span>, <b>out</b> <span class="r127 r">publicKeyToken</span>, <b>out</b> <span class="r128 r">culture</span>, <b>out</b> <span class="r129 r">architecture</span>, <b>out</b> <span class="r130 r">applicationBase</span>, <b>out</b> <span class="r126 r">psVersion</span>);
 
            <span class="c">// System.Management.Automation formats &amp; types files</span>
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r131 rd" class="r131 r">smaFormats</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<b>new</b> <b>string</b>[]
                        {<span class="s">&quot;Certificate.format.ps1xml&quot;</span>, <span class="s">&quot;DotNetTypes.format.ps1xml&quot;</span>, <span class="s">&quot;FileSystem.format.ps1xml&quot;</span>,
                         <span class="s">&quot;Help.format.ps1xml&quot;</span>, <span class="s">&quot;HelpV3.format.ps1xml&quot;</span>, <span class="s">&quot;PowerShellCore.format.ps1xml&quot;</span>, <span class="s">&quot;PowerShellTrace.format.ps1xml&quot;</span>,
                         <span class="s">&quot;Registry.format.ps1xml&quot;</span>});
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r132 rd" class="r132 r">smaTypes</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<b>new</b> <b>string</b>[] { <span class="s">&quot;types.ps1xml&quot;</span>, <span class="s">&quot;typesv3.ps1xml&quot;</span> });
 
            <span class="c">// create default mshsnapininfo objects..</span>
            <span class="i">Collection</span>&lt;<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt; <span id="r133 rd" class="r133 r">engineMshSnapins</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a>&gt;();
            <b>string</b> <span id="r134 rd" class="r134 r">assemblyVersionString</span> = <span class="r125 r">assemblyVersion</span>.<span class="i">ToString</span>();
 
            <b>for</b> (<b>int</b> <span id="r135 rd" class="r135 r">item</span> = 0; <span class="r135 r">item</span> &lt; <a href="#b839acb78f673c2c" class="i property">DefaultMshSnapins</a>.<span class="i">Count</span>; <span class="r135 r">item</span>++)
            {
                <a href="#a759e84c98b182df" class="t t">DefaultPSSnapInInformation</a> <span id="r136 rd" class="r136 r">defaultMshSnapinInfo</span> = <a href="#b839acb78f673c2c" class="i property">DefaultMshSnapins</a>[<span class="r135 r">item</span>];
 
                <b>string</b> <span id="r137 rd" class="r137 r">strongName</span> = <b>string</b>.<span class="i">Format</span>(
                    <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                    <span class="s">&quot;{0}, Version={1}, Culture={2}, PublicKeyToken={3}, ProcessorArchitecture={4}&quot;</span>,
                    <span class="r136 r">defaultMshSnapinInfo</span>.<a href="#6dbaff1390e46861" class="i field">AssemblyName</a>,
                    <span class="r134 r">assemblyVersionString</span>,
                    <span class="r128 r">culture</span>,
                    <span class="r127 r">publicKeyToken</span>,
                    <span class="r129 r">architecture</span>);
 
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r138 rd" class="r138 r">formats</span> = <b>null</b>;
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r139 rd" class="r139 r">types</span> = <b>null</b>;
 
                <b>if</b> (<span class="r136 r">defaultMshSnapinInfo</span>.<a href="#6dbaff1390e46861" class="i field">AssemblyName</a>.<span class="i">Equals</span>(<span class="s">&quot;System.Management.Automation&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r138 r">formats</span> = <span class="r131 r">smaFormats</span>;
                    <span class="r139 r">types</span> = <span class="r132 r">smaTypes</span>;
                }
                <b>else</b> <b>if</b> (<span class="r136 r">defaultMshSnapinInfo</span>.<a href="#6dbaff1390e46861" class="i field">AssemblyName</a>.<span class="i">Equals</span>(<span class="s">&quot;Microsoft.PowerShell.Commands.Diagnostics&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r139 r">types</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<b>new</b> <b>string</b>[] { <span class="s">&quot;GetEvent.types.ps1xml&quot;</span> });
                    <span class="r138 r">formats</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<b>new</b> <b>string</b>[] { <span class="s">&quot;Event.format.ps1xml&quot;</span>, <span class="s">&quot;Diagnostics.format.ps1xml&quot;</span> });
                }
                <b>else</b> <b>if</b> (<span class="r136 r">defaultMshSnapinInfo</span>.<a href="#6dbaff1390e46861" class="i field">AssemblyName</a>.<span class="i">Equals</span>(<span class="s">&quot;Microsoft.WSMan.Management&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r138 r">formats</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;(<b>new</b> <b>string</b>[] { <span class="s">&quot;WSMan.format.ps1xml&quot;</span> });
                }
 
                <b>string</b> <span id="r140 rd" class="r140 r">moduleName</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r130 r">applicationBase</span>, <span class="r136 r">defaultMshSnapinInfo</span>.<a href="#6dbaff1390e46861" class="i field">AssemblyName</a> + <span class="s">&quot;.dll&quot;</span>);
 
                <a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r141 rd" class="r141 r">defaultMshSnapin</span> = <b>new</b> <a href="#8bbd839802902afb" class="t constructor">PSSnapInInfo</a>(
                    <span class="r136 r">defaultMshSnapinInfo</span>.<a href="#45442cd5999d4e26" class="i field">PSSnapInName</a>,
                    <span class="r25 r">isDefault</span>: <b>true</b>,
                    <span class="r130 r">applicationBase</span>,
                    <span class="r137 r">strongName</span>,
                    <span class="r140 r">moduleName</span>,
                    <span class="r126 r">psVersion</span>,
                    <span class="r125 r">assemblyVersion</span>,
                    <span class="r139 r">types</span>,
                    <span class="r138 r">formats</span>,
                    <span class="r33 r">description</span>: <b>null</b>,
                    <span class="r136 r">defaultMshSnapinInfo</span>.<a href="#c1142d614a251c15" class="i field">Description</a>,
                    <span class="r136 r">defaultMshSnapinInfo</span>.<a href="#f6d0471edb4f7871" class="i field">DescriptionIndirect</a>,
                    <span class="r36 r">vendor</span>: <b>null</b>,
                    <span class="r37 r">vendorFallback</span>: <b>null</b>,
                    <span class="r136 r">defaultMshSnapinInfo</span>.<a href="#a9d95d43b5c4a5bc" class="i field">VendorIndirect</a>);
 
                <a href="#93c6b18aedf9eed5" class="i method">SetSnapInLoggingInformation</a>(<span class="r141 r">defaultMshSnapin</span>);
                <span class="r133 r">engineMshSnapins</span>.<span class="i">Add</span>(<span class="r141 r">defaultMshSnapin</span>);
            }
 
            <b>return</b> <span class="r133 r">engineMshSnapins</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enable Snapin logging based on group policy.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="93c6b18aedf9eed5" href="../../R/93c6b18aedf9eed5.html" target="n" data-glyph="76,1" class="i method">SetSnapInLoggingInformation</a>(<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r142 rd" class="r142 r">psSnapInInfo</span>)
        {
            <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r143 rd" class="r143 r">names</span>;
            <a href="../../engine/Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="../../engine/Modules/ModuleCmdletBase.cs.html#877a32efd6bd0f23" class="t t">ModuleLoggingGroupPolicyStatus</a> <span id="r144 rd" class="r144 r">status</span> = <a href="../../engine/Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="../../engine/Modules/ModuleCmdletBase.cs.html#85b1c26ca08c7b07" class="i method">GetModuleLoggingInformation</a>(<b>out</b> <span class="r143 r">names</span>);
            <b>if</b> (<span class="r144 r">status</span> != <a href="../../engine/Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="../../engine/Modules/ModuleCmdletBase.cs.html#877a32efd6bd0f23" class="t t">ModuleLoggingGroupPolicyStatus</a>.<a href="../../engine/Modules/ModuleCmdletBase.cs.html#a1eb324b392b550f" class="i field">Undefined</a>)
            {
                <a href="#34938687e0af283c" class="i method">SetSnapInLoggingInformation</a>(<span class="r142 r">psSnapInInfo</span>, <span class="r144 r">status</span>, <span class="r143 r">names</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enable Snapin logging based on group policy.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="34938687e0af283c" href="../../R/34938687e0af283c.html" target="n" data-glyph="76,1" class="i method">SetSnapInLoggingInformation</a>(<a href="#571fb5b01a41502f" class="t t">PSSnapInInfo</a> <span id="r145 rd" class="r145 r">psSnapInInfo</span>, <a href="../../engine/Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="../../engine/Modules/ModuleCmdletBase.cs.html#877a32efd6bd0f23" class="t t">ModuleLoggingGroupPolicyStatus</a> <span id="r146 rd" class="r146 r">status</span>, <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r147 rd" class="r147 r">moduleOrSnapinNames</span>)
        {
            <b>if</b> (((<span class="r146 r">status</span> &amp; <a href="../../engine/Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="../../engine/Modules/ModuleCmdletBase.cs.html#877a32efd6bd0f23" class="t t">ModuleLoggingGroupPolicyStatus</a>.<a href="../../engine/Modules/ModuleCmdletBase.cs.html#3a381265e4143f74" class="i field">Enabled</a>) != 0) &amp;&amp; <span class="r147 r">moduleOrSnapinNames</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>string</b> <span id="r148 rd" class="r148 r">currentGPModuleOrSnapinName</span> <b>in</b> <span class="r147 r">moduleOrSnapinNames</span>)
                {
                    <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r145 r">psSnapInInfo</span>.<a href="#ebdb1944f8049e83" class="i property">Name</a>, <span class="r148 r">currentGPModuleOrSnapinName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r145 r">psSnapInInfo</span>.<a href="#75aa8a396932903e" class="i property">LogPipelineExecutionDetails</a> = <b>true</b>;
                    }
                    <b>else</b> <b>if</b> (<a href="../../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../engine/regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r148 r">currentGPModuleOrSnapinName</span>))
                    {
                        <a href="../../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r149 rd" class="r149 r">wildcard</span> = <a href="../../engine/regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../../engine/regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r148 r">currentGPModuleOrSnapinName</span>, <a href="../../engine/regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../../engine/regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                        <b>if</b> (<span class="r149 r">wildcard</span>.<a href="../../engine/regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r145 r">psSnapInInfo</span>.<a href="#ebdb1944f8049e83" class="i property">Name</a>))
                        {
                            <span class="r145 r">psSnapInInfo</span>.<a href="#75aa8a396932903e" class="i property">LogPipelineExecutionDetails</a> = <b>true</b>;
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the key to monad root.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caller doesn&#39;t have access to monad registration information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Monad registration information is not available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">RegistryKey</span> <a id="e096581baa29246a" href="../../R/e096581baa29246a.html" target="n" data-glyph="74,1" class="i method">GetMonadRootKey</a>()
        {
            <span class="i">RegistryKey</span> <span id="r150 rd" class="r150 r">rootKey</span> = <span class="i">Registry</span>.<span class="i">LocalMachine</span>.<span class="i">OpenSubKey</span>(<a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#930717e253bcfc29" class="i field">MonadRootKeyPath</a>);
            <b>if</b> (<span class="r150 r">rootKey</span> == <b>null</b>)
            {
                <span class="c">// This should never occur because this code is running</span>
                <span class="c">// because monad is installed. { well this can occur if someone</span>
                <span class="c">// deletes the registry key after starting monad</span>
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Root Key of Monad installation is not present&quot;</span>);
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;monad&quot;</span>, <span class="i">MshSnapinInfo</span>.<span class="i">MonadRootRegistryAccessFailed</span>);
            }
 
            <b>return</b> <span class="r150 r">rootKey</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the registry key to PSEngine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">RegistryKey.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r151 r">psVersion</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Major version in string format.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Monad registration information is not available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">RegistryKey</span> <a id="6584c0dfb0db838c" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetPSEngineKey</a>(<b>string</b> <span id="r151 rd" class="r151 r">psVersion</span>)
        {
            <span class="i">RegistryKey</span> <span id="r152 rd" class="r152 r">rootKey</span> = <a href="#e096581baa29246a" class="i method">GetMonadRootKey</a>();
            <span class="c">// root key wont be null</span>
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r152 r">rootKey</span> != <b>null</b>, <span class="s">&quot;Root Key of Monad installation is not present&quot;</span>);
 
            <span class="i">RegistryKey</span> <span id="r153 rd" class="r153 r">versionRootKey</span> = <a href="#dd06ce13c1d3a64f" class="i method">GetVersionRootKey</a>(<span class="r152 r">rootKey</span>, <span class="r151 r">psVersion</span>);
            <span class="c">// version root key wont be null</span>
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r153 r">versionRootKey</span> != <b>null</b>, <span class="s">&quot;Version Rootkey of Monad installation is not present&quot;</span>);
 
            <span class="i">RegistryKey</span> <span id="r154 rd" class="r154 r">psEngineParentKey</span> = <span class="r152 r">rootKey</span>.<span class="i">OpenSubKey</span>(<span class="r151 r">psVersion</span>);
            <b>if</b> (<span class="r154 r">psEngineParentKey</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;monad&quot;</span>, <span class="i">MshSnapinInfo</span>.<span class="i">MonadEngineRegistryAccessFailed</span>);
            }
 
            <span class="i">RegistryKey</span> <span id="r155 rd" class="r155 r">psEngineKey</span> = <span class="r154 r">psEngineParentKey</span>.<span class="i">OpenSubKey</span>(<a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#cc0f8515a11bdfdc" class="i field">MonadEngineKey</a>);
            <b>if</b> (<span class="r155 r">psEngineKey</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;monad&quot;</span>, <span class="i">MshSnapinInfo</span>.<span class="i">MonadEngineRegistryAccessFailed</span>);
            }
 
            <b>return</b> <span class="r155 r">psEngineKey</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the version root key for specified monad version.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r156 r">rootKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r157 r">psVersion</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caller doesn&#39;t have permission to read the version key</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> specified psVersion key is not present</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b>
        <span class="i">RegistryKey</span>
        <a id="dd06ce13c1d3a64f" href="../../R/dd06ce13c1d3a64f.html" target="n" data-glyph="74,1" class="i method">GetVersionRootKey</a>(<span class="i">RegistryKey</span> <span id="r156 rd" class="r156 r">rootKey</span>, <b>string</b> <span id="r157 rd" class="r157 r">psVersion</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r157 r">psVersion</span>), <span class="s">&quot;caller should validate the parameter&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r156 r">rootKey</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <b>string</b> <span id="r158 rd" class="r158 r">versionKey</span> = <a href="../../engine/PSVersionInfo.cs.html#be287f9ea52b8d2f" class="t t">PSVersionInfo</a>.<a href="../../engine/PSVersionInfo.cs.html#40b698f943dba5f2" class="i method">GetRegistryVersionKeyForSnapinDiscovery</a>(<span class="r157 r">psVersion</span>);
            <span class="i">RegistryKey</span> <span id="r159 rd" class="r159 r">versionRoot</span> = <span class="r156 r">rootKey</span>.<span class="i">OpenSubKey</span>(<span class="r158 r">versionKey</span>);
            <b>if</b> (<span class="r159 r">versionRoot</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r157 r">psVersion</span>), <span class="i">MshSnapinInfo</span>.<span class="i">SpecifiedVersionNotFound</span>, <span class="r158 r">versionKey</span>);
            }
 
            <b>return</b> <span class="r159 r">versionRoot</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the mshsnapin root key for specified monad version.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r160 r">versionRootKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r161 r">psVersion</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caller doesn&#39;t have permission to read the mshsnapin key</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> mshsnapin key is not present</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private static</b>
        <span class="i">RegistryKey</span>
        <a id="b59c5a6e27ebf3b7" href="../../R/b59c5a6e27ebf3b7.html" target="n" data-glyph="76,1" class="i method">GetMshSnapinRootKey</a>(<span class="i">RegistryKey</span> <span id="r160 rd" class="r160 r">versionRootKey</span>, <b>string</b> <span id="r161 rd" class="r161 r">psVersion</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r160 r">versionRootKey</span> != <b>null</b>, <span class="s">&quot;caller should validate the parameter&quot;</span>);
 
            <span class="i">RegistryKey</span> <span id="r162 rd" class="r162 r">mshsnapinRoot</span> = <span class="r160 r">versionRootKey</span>.<span class="i">OpenSubKey</span>(<a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#664881598dcb3b3c" class="i field">MshSnapinKey</a>);
            <b>if</b> (<span class="r162 r">mshsnapinRoot</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r161 r">psVersion</span>), <span class="i">MshSnapinInfo</span>.<span class="i">NoMshSnapinPresentForVersion</span>, <span class="r161 r">psVersion</span>);
            }
 
            <b>return</b> <span class="r162 r">mshsnapinRoot</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the mshsnapin key for specified monad version and mshsnapin name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r163 r">mshSnapInName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r164 r">psVersion</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">SecurityException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Caller doesn&#39;t have permission to read the mshsnapin key</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> mshsnapin key is not present</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b>
        <span class="i">RegistryKey</span>
        <a id="067d2497745ea547" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetMshSnapinKey</a>(<b>string</b> <span id="r163 rd" class="r163 r">mshSnapInName</span>, <b>string</b> <span id="r164 rd" class="r164 r">psVersion</span>)
        {
            <span class="i">RegistryKey</span> <span id="r165 rd" class="r165 r">monadRootKey</span> = <a href="#e096581baa29246a" class="i method">GetMonadRootKey</a>();
            <span class="i">RegistryKey</span> <span id="r166 rd" class="r166 r">versionRootKey</span> = <a href="#dd06ce13c1d3a64f" class="i method">GetVersionRootKey</a>(<span class="r165 r">monadRootKey</span>, <span class="r164 r">psVersion</span>);
            <span class="i">RegistryKey</span> <span id="r167 rd" class="r167 r">mshsnapinRoot</span> = <span class="r166 r">versionRootKey</span>.<span class="i">OpenSubKey</span>(<a href="#fefd5b5c5e75f6ff" class="t t">RegistryStrings</a>.<a href="#664881598dcb3b3c" class="i field">MshSnapinKey</a>);
            <b>if</b> (<span class="r167 r">mshsnapinRoot</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r164 r">psVersion</span>), <span class="i">MshSnapinInfo</span>.<span class="i">NoMshSnapinPresentForVersion</span>, <span class="r164 r">psVersion</span>);
            }
 
            <span class="i">RegistryKey</span> <span id="r168 rd" class="r168 r">mshsnapinKey</span> = <span class="r167 r">mshsnapinRoot</span>.<span class="i">OpenSubKey</span>(<span class="r163 r">mshSnapInName</span>);
            <b>return</b> <span class="r168 r">mshsnapinKey</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Default MshSnapins related structure
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This structure is meant to hold mshsnapin information for default mshsnapins.</span>
        <span class="c">///</span><span class="c"> This is private only.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private struct</b> <a id="a759e84c98b182df" href="../../R/a759e84c98b182df.html" target="n" data-glyph="112,1" class="t t"><span id="243b77a069d51221">DefaultPSSnapInInformation</span></a>
        {
            <span class="c">// since this is a private structure..making it as simple as possible</span>
            <b>public string</b> <a id="45442cd5999d4e26" href="../../R/45442cd5999d4e26.html" target="n" data-glyph="42,2" class="i field">PSSnapInName</a>;
            <b>public string</b> <a id="6dbaff1390e46861" href="../../R/6dbaff1390e46861.html" target="n" data-glyph="42,2" class="i field">AssemblyName</a>;
            <b>public string</b> <a id="c1142d614a251c15" href="../../R/c1142d614a251c15.html" target="n" data-glyph="42,2" class="i field">Description</a>;
            <b>public string</b> <a id="f6d0471edb4f7871" href="../../R/f6d0471edb4f7871.html" target="n" data-glyph="42,2" class="i field">DescriptionIndirect</a>;
            <b>public string</b> <a id="a9d95d43b5c4a5bc" href="../../R/a9d95d43b5c4a5bc.html" target="n" data-glyph="42,2" class="i field">VendorIndirect</a>;
 
            <b>public</b> <a id="db80a057ee91a8e9" href="../../R/db80a057ee91a8e9.html" target="n" data-glyph="72,2" class="t constructor">DefaultPSSnapInInformation</a>(<b>string</b> <span id="r169 rd" class="r169 r">sName</span>,
                <b>string</b> <span id="r170 rd" class="r170 r">sAssemblyName</span>,
                <b>string</b> <span id="r171 rd" class="r171 r">sDescription</span>,
                <b>string</b> <span id="r172 rd" class="r172 r">sDescriptionIndirect</span>,
                <b>string</b> <span id="r173 rd" class="r173 r">sVendorIndirect</span>)
            {
                <a href="#45442cd5999d4e26" class="i field">PSSnapInName</a> = <span class="r169 r">sName</span>;
                <a href="#6dbaff1390e46861" class="i field">AssemblyName</a> = <span class="r170 r">sAssemblyName</span>;
                <a href="#c1142d614a251c15" class="i field">Description</a> = <span class="r171 r">sDescription</span>;
                <a href="#f6d0471edb4f7871" class="i field">DescriptionIndirect</a> = <span class="r172 r">sDescriptionIndirect</span>;
                <a href="#a9d95d43b5c4a5bc" class="i field">VendorIndirect</a> = <span class="r173 r">sVendorIndirect</span>;
            }
        }
 
        <b>private static</b> <a href="#a759e84c98b182df" class="t t">DefaultPSSnapInInformation</a> <a id="62fd927cedd2f97e" href="../../R/62fd927cedd2f97e.html" target="n" data-glyph="46,1" class="i field">s_coreSnapin</a> =
            <b>new</b> <a href="#db80a057ee91a8e9" class="t constructor">DefaultPSSnapInInformation</a>(<span class="s">&quot;Microsoft.PowerShell.Core&quot;</span>, <span class="s">&quot;System.Management.Automation&quot;</span>, <b>null</b>,
                                           <span class="s">&quot;CoreMshSnapInResources,Description&quot;</span>, <span class="s">&quot;CoreMshSnapInResources,Vendor&quot;</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">IList</span>&lt;<a href="#a759e84c98b182df" class="t t">DefaultPSSnapInInformation</a>&gt; <a id="b839acb78f673c2c" href="../../R/b839acb78f673c2c.html" target="n" data-glyph="106,1" class="i property">DefaultMshSnapins</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#9e6403b0ef0b96ce" class="i field">s_defaultMshSnapins</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#ce134f10cc5a80a3" class="i field">s_syncObject</a>)
                    {
                        <b>if</b> (<a href="#9e6403b0ef0b96ce" class="i field">s_defaultMshSnapins</a> == <b>null</b>)
                        {
                            <a href="#9e6403b0ef0b96ce" class="i field">s_defaultMshSnapins</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#a759e84c98b182df" class="t t">DefaultPSSnapInInformation</a>&gt;()
                            {
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
                                <b>new</b> <a href="#db80a057ee91a8e9" class="t constructor">DefaultPSSnapInInformation</a>(<span class="s">&quot;Microsoft.PowerShell.Diagnostics&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Commands.Diagnostics&quot;</span>, <b>null</b>,
                                    <span class="s">&quot;GetEventResources,Description&quot;</span>, <span class="s">&quot;GetEventResources,Vendor&quot;</span>),
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                                <b>new</b> <a href="#db80a057ee91a8e9" class="t constructor">DefaultPSSnapInInformation</a>(<span class="s">&quot;Microsoft.PowerShell.Host&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.ConsoleHost&quot;</span>, <b>null</b>,
                                    <span class="s">&quot;HostMshSnapInResources,Description&quot;</span>, <span class="s">&quot;HostMshSnapInResources,Vendor&quot;</span>),
 
                                <a href="#62fd927cedd2f97e" class="i field">s_coreSnapin</a>,
 
                                <b>new</b> <a href="#db80a057ee91a8e9" class="t constructor">DefaultPSSnapInInformation</a>(<span class="s">&quot;Microsoft.PowerShell.Utility&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Commands.Utility&quot;</span>, <b>null</b>,
                                    <span class="s">&quot;UtilityMshSnapInResources,Description&quot;</span>, <span class="s">&quot;UtilityMshSnapInResources,Vendor&quot;</span>),
 
                                <b>new</b> <a href="#db80a057ee91a8e9" class="t constructor">DefaultPSSnapInInformation</a>(<span class="s">&quot;Microsoft.PowerShell.Management&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Commands.Management&quot;</span>, <b>null</b>,
                                    <span class="s">&quot;ManagementMshSnapInResources,Description&quot;</span>, <span class="s">&quot;ManagementMshSnapInResources,Vendor&quot;</span>),
 
                                <b>new</b> <a href="#db80a057ee91a8e9" class="t constructor">DefaultPSSnapInInformation</a>(<span class="s">&quot;Microsoft.PowerShell.Security&quot;</span>, <span class="s">&quot;Microsoft.PowerShell.Security&quot;</span>, <b>null</b>,
                                    <span class="s">&quot;SecurityMshSnapInResources,Description&quot;</span>, <span class="s">&quot;SecurityMshSnapInResources,Vendor&quot;</span>)
                            };
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
                            <b>if</b> (!<a href="../../engine/Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../../engine/Utils.cs.html#9aecc212ae3f42c7" class="i method">IsWinPEHost</a>())
                            {
                                <a href="#9e6403b0ef0b96ce" class="i field">s_defaultMshSnapins</a>.<span class="i">Add</span>(<b>new</b> <a href="#db80a057ee91a8e9" class="t constructor">DefaultPSSnapInInformation</a>(<span class="s">&quot;Microsoft.WSMan.Management&quot;</span>, <span class="s">&quot;Microsoft.WSMan.Management&quot;</span>, <b>null</b>,
                                    <span class="s">&quot;WsManResources,Description&quot;</span>, <span class="s">&quot;WsManResources,Vendor&quot;</span>));
                            }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                        }
                    }
                }
 
                <b>return</b> <a href="#9e6403b0ef0b96ce" class="i field">s_defaultMshSnapins</a>;
            }
        }
 
        <b>private static</b> <span class="i">IList</span>&lt;<a href="#a759e84c98b182df" class="t t">DefaultPSSnapInInformation</a>&gt; <a id="9e6403b0ef0b96ce" href="../../R/9e6403b0ef0b96ce.html" target="n" data-glyph="46,1" class="i field">s_defaultMshSnapins</a> = <b>null</b>;
        <b>private static readonly object</b> <a id="ce134f10cc5a80a3" href="../../R/ce134f10cc5a80a3.html" target="n" data-glyph="46,1" class="i field">s_syncObject</a> = <b>new</b> <b>object</b>();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <b>private static readonly</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="89a259b8c36900af" href="../../R/89a259b8c36900af.html" target="n" data-glyph="46,1" class="i field">s_mshsnapinTracer</a> = <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#24b0f68d5add3eb3" class="i method">GetTracer</a>(<span class="s">&quot;MshSnapinLoadUnload&quot;</span>, <span class="s">&quot;Loading and unloading mshsnapins&quot;</span>, <b>false</b>);
    }
}
</pre></td></tr></table></div></body></html>
