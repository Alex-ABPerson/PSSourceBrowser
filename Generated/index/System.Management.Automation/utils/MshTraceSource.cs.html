<!DOCTYPE html>
<html><head><title>MshTraceSource.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(557);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/utils/MshTraceSource.cs" target="_top">utils\MshTraceSource.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">define</span> <span class="i">TRACE</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An PSTraceSource is a representation of a System.Diagnostics.TraceSource instance</span>
    <span class="c">///</span><span class="c"> that is used in the Monad components to produce trace output.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> It is permitted to subclass </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a><span class="c">&quot;</span><span class="c">/&gt;</span>
    <span class="c">///</span><span class="c"> but there is no established scenario for doing this, nor has it been tested.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
    <span class="c">///</span><span class="c"> IF YOU ARE NOT PART OF THE MONAD DEVELOPMENT TEAM PLEASE</span>
    <span class="c">///</span><span class="c"> DO NOT USE THIS CLASS!!!!!</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> The PSTraceSource class is derived from Switch to provide granular</span>
    <span class="c">///</span><span class="c"> control over the tracing in a program.  An instance of PSTraceSource</span>
    <span class="c">///</span><span class="c"> is created for each category of tracing such that separate flags</span>
    <span class="c">///</span><span class="c"> (filters) can be set. Each flag enables one or more method for tracing.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> For instance, the Exception flag will enable tracing on these methods:</span>
    <span class="c">///</span><span class="c">     TraceException.</span>
    <span class="c">///</span><span class="c"> &lt;/summary&gt;</span>
    <span class="c">///</span><span class="c"> &lt;remarks&gt;</span>
    <span class="c">///</span><span class="c"> To get an instance of this class a user should define a public static</span>
    <span class="c">///</span><span class="c"> field of the type PSTraceSource, decorated it with an attribute of</span>
    <span class="c">///</span><span class="c"> PSTraceSourceAttribute, and assign the results of GetTracer to it.</span>
    <span class="c">///</span><span class="c"> &lt;newpara/&gt;</span>
    <span class="c">///</span><span class="c"> &lt;example&gt;</span>
    <span class="c">///</span><span class="c"> &lt;code&gt;</span>
    <span class="c">///</span><span class="c"> [PSTraceSourceAttribute(&quot;category&quot;, &quot;description&quot;)]</span>
    <span class="c">///</span><span class="c"> public static PSTraceSource tracer = GetTracer(&quot;category&quot;, &quot;description&quot;);</span>
    <span class="c">///</span><span class="c"> &lt;/code&gt;</span>
    <span class="c">///</span><span class="c"> &lt;/example&gt;</span>
    <span class="c">///</span><span class="c"> &lt;newpara/&gt;</span>
    <span class="c">///</span><span class="c"> Other than initial creation of this class through the GetTracer method,</span>
    <span class="c">///</span><span class="c"> this class should throw no exceptions. Any call to a PSTraceSource method</span>
    <span class="c">///</span><span class="c"> that results in an exception being thrown will be ignored.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
    <b>public</b> <a href="../P/6de812d1f374e1ae.html" target="s" class="k">partial</a> <b>class</b> <a id="6de812d1f374e1ae" href="../R/6de812d1f374e1ae.html" target="n" data-glyph="0,0" class="t t">PSTraceSource</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Lock object for the GetTracer method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly object</b> <a id="98d19d8bc01e8c7a" href="../R/98d19d8bc01e8c7a.html" target="n" data-glyph="46,1" class="i field">s_getTracerLock</a> = <b>new</b> <b>object</b>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A helper to get an instance of the PSTraceSource class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the category that this class</span>
        <span class="c">///</span><span class="c"> will control the tracing for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The description to describe what the category</span>
        <span class="c">///</span><span class="c"> is used for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of the PSTraceSource class which is initialized</span>
        <span class="c">///</span><span class="c"> to trace for the specified category. If multiple callers ask for the same category,</span>
        <span class="c">///</span><span class="c"> the same PSTraceSource will be returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="697b06ec70e3c537" href="../R/697b06ec70e3c537.html" target="n" data-glyph="74,1" class="i method">GetTracer</a>(
            <b>string</b> <span id="r0 rd" class="r0 r">name</span>,
            <b>string</b> <span id="r1 rd" class="r1 r">description</span>)
        {
            <b>return</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="#24b0f68d5add3eb3" class="i method">GetTracer</a>(<span class="r0 r">name</span>, <span class="r1 r">description</span>, <b>true</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A helper to get an instance of the PSTraceSource class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the category that this class</span>
        <span class="c">///</span><span class="c"> will control the tracing for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The description to describe what the category</span>
        <span class="c">///</span><span class="c"> is used for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">traceHeaders</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the line headers will be traced, if false, only the trace message will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An instance of the PSTraceSource class which is initialized</span>
        <span class="c">///</span><span class="c"> to trace for the specified category. If multiple callers ask for the same category,</span>
        <span class="c">///</span><span class="c"> the same PSTraceSource will be returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="24b0f68d5add3eb3" href="../R/24b0f68d5add3eb3.html" target="n" data-glyph="74,1" class="i method">GetTracer</a>(
            <b>string</b> <span id="r2 rd" class="r2 r">name</span>,
            <b>string</b> <span id="r3 rd" class="r3 r">description</span>,
            <b>bool</b> <span id="r4 rd" class="r4 r">traceHeaders</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r2 r">name</span>))
            {
                <span class="c">// 2005/04/13-JonN In theory this should be ArgumentException,</span>
                <span class="c">// but I don&#39;t want to deal with loading the string in this</span>
                <span class="c">// low-level code.</span>
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r2 r">name</span>));
            }
 
            <b>lock</b> (<a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="#98d19d8bc01e8c7a" class="i field">s_getTracerLock</a>)
            {
                <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <span id="r5 rd" class="r5 r">result</span> = <b>null</b>;
 
                <span class="c">// See if we can find an PSTraceSource for this category in the catalog.</span>
                <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="StructuredTraceSource.cs.html#eaec56a0bff15c85" class="i property">TraceCatalog</a>.<span class="i">TryGetValue</span>(<span class="r2 r">name</span>, <b>out</b> <span class="r5 r">result</span>);
 
                <span class="c">// If it&#39;s not already in the catalog, see if we can find it in the</span>
                <span class="c">// pre-configured trace source list</span>
 
                <b>if</b> (<span class="r5 r">result</span> == <b>null</b>)
                {
                    <b>string</b> <span id="r6 rd" class="r6 r">keyName</span> = <span class="r2 r">name</span>;
                    <b>if</b> (!<a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="StructuredTraceSource.cs.html#3296472fb9393bab" class="i property">PreConfiguredTraceSource</a>.<span class="i">ContainsKey</span>(<span class="r6 r">keyName</span>))
                    {
                        <b>if</b> (<span class="r6 r">keyName</span>.<span class="i">Length</span> &gt; 16)
                        {
                            <span class="r6 r">keyName</span> = <span class="r6 r">keyName</span>.<span class="i">Substring</span>(0, 16);
                            <b>if</b> (!<a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="StructuredTraceSource.cs.html#3296472fb9393bab" class="i property">PreConfiguredTraceSource</a>.<span class="i">ContainsKey</span>(<span class="r6 r">keyName</span>))
                            {
                                <span class="r6 r">keyName</span> = <b>null</b>;
                            }
                        }
                        <b>else</b>
                        {
                            <span class="r6 r">keyName</span> = <b>null</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r6 r">keyName</span> != <b>null</b>)
                    {
                        <span class="c">// Get the pre-configured trace source from the catalog</span>
                        <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <span id="r7 rd" class="r7 r">preconfiguredSource</span> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="StructuredTraceSource.cs.html#3296472fb9393bab" class="i property">PreConfiguredTraceSource</a>[<span class="r6 r">keyName</span>];
 
                        <span class="r5 r">result</span> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="#6491fcbc805c1aab" class="i method">GetNewTraceSource</a>(<span class="r6 r">keyName</span>, <span class="r3 r">description</span>, <span class="r4 r">traceHeaders</span>);
                        <span class="r5 r">result</span>.<a href="StructuredTraceSource.cs.html#39a46fbab64bf75b" class="i property">Options</a> = <span class="r7 r">preconfiguredSource</span>.<a href="StructuredTraceSource.cs.html#39a46fbab64bf75b" class="i property">Options</a>;
                        <span class="r5 r">result</span>.<a href="StructuredTraceSource.cs.html#3f62365c6014f09a" class="i property">Listeners</a>.<span class="i">Clear</span>();
                        <span class="r5 r">result</span>.<a href="StructuredTraceSource.cs.html#3f62365c6014f09a" class="i property">Listeners</a>.<span class="i">AddRange</span>(<span class="r7 r">preconfiguredSource</span>.<a href="StructuredTraceSource.cs.html#3f62365c6014f09a" class="i property">Listeners</a>);
 
                        <span class="c">// Add it to the TraceCatalog</span>
                        <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="StructuredTraceSource.cs.html#eaec56a0bff15c85" class="i property">TraceCatalog</a>.<span class="i">Add</span>(<span class="r6 r">keyName</span>, <span class="r5 r">result</span>);
 
                        <span class="c">// Remove it from the pre-configured catalog</span>
                        <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="StructuredTraceSource.cs.html#3296472fb9393bab" class="i property">PreConfiguredTraceSource</a>.<span class="i">Remove</span>(<span class="r6 r">keyName</span>);
                    }
                }
 
                <span class="c">// Even if there was a PSTraceSource in the catalog, let&#39;s replace</span>
                <span class="c">// it with an PSTraceSource to get the added functionality. Anyone using</span>
                <span class="c">// a StructuredTraceSource should be able to do so even with the PSTraceSource</span>
                <span class="c">// instance.</span>
 
                <b>if</b> (<span class="r5 r">result</span> == <b>null</b>)
                {
                    <span class="r5 r">result</span> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="#6491fcbc805c1aab" class="i method">GetNewTraceSource</a>(<span class="r2 r">name</span>, <span class="r3 r">description</span>, <span class="r4 r">traceHeaders</span>);
                    <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="StructuredTraceSource.cs.html#eaec56a0bff15c85" class="i property">TraceCatalog</a>[<span class="r5 r">result</span>.<a href="StructuredTraceSource.cs.html#0b781ff3526050ac" class="i property">FullName</a>] = <span class="r5 r">result</span>;
                }
 
                <b>if</b> (<span class="r5 r">result</span>.<a href="StructuredTraceSource.cs.html#39a46fbab64bf75b" class="i property">Options</a> != <a href="StructuredTraceSource.cs.html#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="StructuredTraceSource.cs.html#a1342943109aa29f" class="i field">None</a> &amp;&amp;
                    <span class="r4 r">traceHeaders</span>)
                {
                    <span class="r5 r">result</span>.<a href="StructuredTraceSource.cs.html#ed454882d6d87a01" class="i method">TraceGlobalAppDomainHeader</a>();
 
                    <span class="c">// Trace the object specific tracer information</span>
                    <span class="r5 r">result</span>.<span class="i">TracerObjectHeader</span>(<span class="i">Assembly</span>.<span class="i">GetCallingAssembly</span>());
                }
 
                <b>return</b> <span class="r5 r">result</span>;
            }
        }
 
        <b>internal static</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="6491fcbc805c1aab" href="../R/6491fcbc805c1aab.html" target="n" data-glyph="74,1" class="i method">GetNewTraceSource</a>(
            <b>string</b> <span id="r8 rd" class="r8 r">name</span>,
            <b>string</b> <span id="r9 rd" class="r9 r">description</span>,
            <b>bool</b> <span id="r10 rd" class="r10 r">traceHeaders</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r8 r">name</span>))
            {
                <span class="c">// Note, all callers should have already verified the name before calling this</span>
                <span class="c">// API, so this exception should never be exposed to an end-user.</span>
 
                <b>throw</b> <b>new</b> <span class="i">ArgumentException</span>(<span class="s">&quot;name&quot;</span>);
            }
 
            <span class="c">// Keep the fullName as it was passed, but truncate or pad</span>
            <span class="c">// the category name to 16 characters.  This allows for</span>
            <span class="c">// uniform output</span>
 
            <b>string</b> <span id="r11 rd" class="r11 r">fullName</span> = <span class="r8 r">name</span>;
            <span class="c">/*
                            // This is here to ensure all the trace category names are 16 characters,
                            // the problem is that the app-config file would need to contain the same
                            // trailing spaces if this actually does pad the name.
 
                            name =
                                string.Format(
                                    System.Globalization.CultureInfo.InvariantCulture,
                                    &quot;{0,-16}&quot;,
                                    name);
            */</span>
            <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <span id="r12 rd" class="r12 r">result</span> =
                <b>new</b> <a href="StructuredTraceSource.cs.html#6d1285cfb983d250" class="t constructor">PSTraceSource</a>(
                    <span class="r11 r">fullName</span>,
                    <span class="r8 r">name</span>,
                    <span class="r9 r">description</span>,
                    <span class="r10 r">traceHeaders</span>);
            <b>return</b> <span class="r12 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> TraceFlags.New*Exception methods/helpers
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception. This is not allowed to call other</span>
        <span class="c">///</span><span class="c"> Throw*Exception variants, since they call this.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">paramName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the parameter whose argument value was null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a> <a id="fbe67220ad7522a0" href="../R/fbe67220ad7522a0.html" target="n" data-glyph="74,1" class="i method">NewArgumentNullException</a>(<b>string</b> <span id="r13 rd" class="r13 r">paramName</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r13 r">paramName</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r13 r">paramName</span>));
            }
 
            <b>string</b> <span id="r14 rd" class="r14 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">AutomationExceptions</span>.<span class="i">ArgumentNull</span>, <span class="r13 r">paramName</span>);
            <a href="MshArgumentNullException.cs.html#efa3789145f41301" class="k">var</a> <span id="r15 rd" class="r15 r">e</span> = <b>new</b> <a href="MshArgumentNullException.cs.html#b3be640c03c3b95b" class="t constructor">PSArgumentNullException</a>(<span class="r13 r">paramName</span>, <span class="r14 r">message</span>);
 
            <b>return</b> <span class="r15 r">e</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception. This variant allows the caller to</span>
        <span class="c">///</span><span class="c"> specify alternate template text, but only in assembly S.M.A.Core.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">paramName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the parameter whose argument value was invalid</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The template string for this error</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Objects corresponding to {0}, {1}, etc. in the resource string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a> <a id="63aa6410c2587d5d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NewArgumentNullException</a>(
            <b>string</b> <span id="r16 rd" class="r16 r">paramName</span>, <b>string</b> <span id="r17 rd" class="r17 r">resourceString</span>, <b>params object</b>[] <span id="r18 rd" class="r18 r">args</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r16 r">paramName</span>))
            {
                <b>throw</b> <a href="#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r16 r">paramName</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r17 r">resourceString</span>))
            {
                <b>throw</b> <a href="#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r17 r">resourceString</span>));
            }
 
            <b>string</b> <span id="r19 rd" class="r19 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="StringUtil.cs.html#798b827f58e30321" class="i method">Format</a>(<span class="r17 r">resourceString</span>, <span class="r18 r">args</span>);
 
            <span class="c">// Note that the paramName param comes first</span>
            <a href="MshArgumentNullException.cs.html#efa3789145f41301" class="k">var</a> <span id="r20 rd" class="r20 r">e</span> = <b>new</b> <a href="MshArgumentNullException.cs.html#b3be640c03c3b95b" class="t constructor">PSArgumentNullException</a>(<span class="r16 r">paramName</span>, <span class="r19 r">message</span>);
 
            <b>return</b> <span class="r20 r">e</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception. This variant uses the default</span>
        <span class="c">///</span><span class="c"> ArgumentException template text. This is not allowed to call</span>
        <span class="c">///</span><span class="c"> other Throw*Exception variants, since they call this.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">paramName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the parameter whose argument value was invalid</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <a id="fed5f40dc0075d41" href="../R/fed5f40dc0075d41.html" target="n" data-glyph="74,1" class="i method">NewArgumentException</a>(<b>string</b> <span id="r21 rd" class="r21 r">paramName</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r21 r">paramName</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r21 r">paramName</span>));
            }
 
            <b>string</b> <span id="r22 rd" class="r22 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">AutomationExceptions</span>.<span class="i">Argument</span>, <span class="r21 r">paramName</span>);
            <span class="c">// Note that the message param comes first</span>
            <a href="MshArgumentException.cs.html#581bd9b947689819" class="k">var</a> <span id="r23 rd" class="r23 r">e</span> = <b>new</b> <a href="MshArgumentException.cs.html#b724902ca4a09ddb" class="t constructor">PSArgumentException</a>(<span class="r22 r">message</span>, <span class="r21 r">paramName</span>);
 
            <b>return</b> <span class="r23 r">e</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception. This variant allows the caller to</span>
        <span class="c">///</span><span class="c"> specify alternate template text, but only in assembly S.M.A.Core.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">paramName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the parameter whose argument value was invalid</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The template string for this error</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Objects corresponding to {0}, {1}, etc. in the resource string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshArgumentException.cs.html#581bd9b947689819" class="t t">PSArgumentException</a> <a id="fabd508643fedbdf" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NewArgumentException</a>(
            <b>string</b> <span id="r24 rd" class="r24 r">paramName</span>, <b>string</b> <span id="r25 rd" class="r25 r">resourceString</span>, <b>params object</b>[] <span id="r26 rd" class="r26 r">args</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r24 r">paramName</span>))
            {
                <b>throw</b> <a href="#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r24 r">paramName</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r25 r">resourceString</span>))
            {
                <b>throw</b> <a href="#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r25 r">resourceString</span>));
            }
 
            <b>string</b> <span id="r27 rd" class="r27 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="StringUtil.cs.html#798b827f58e30321" class="i method">Format</a>(<span class="r25 r">resourceString</span>, <span class="r26 r">args</span>);
 
            <span class="c">// Note that the message param comes first</span>
            <a href="MshArgumentException.cs.html#581bd9b947689819" class="k">var</a> <span id="r28 rd" class="r28 r">e</span> = <b>new</b> <a href="MshArgumentException.cs.html#b724902ca4a09ddb" class="t constructor">PSArgumentException</a>(<span class="r27 r">message</span>, <span class="r24 r">paramName</span>);
 
            <b>return</b> <span class="r28 r">e</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshInvalidOperationException.cs.html#259a38c8b594783c" class="t t">PSInvalidOperationException</a> <a id="4f3f8175dd33a015" href="../R/4f3f8175dd33a015.html" target="n" data-glyph="74,1" class="i method">NewInvalidOperationException</a>()
        {
            <b>string</b> <span id="r29 rd" class="r29 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">AutomationExceptions</span>.<span class="i">InvalidOperation</span>,
                    <b>new</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">StackTrace</span>().<span class="i">GetFrame</span>(1).<span class="i">GetMethod</span>().<span class="i">Name</span>);
            <a href="MshInvalidOperationException.cs.html#259a38c8b594783c" class="k">var</a> <span id="r30 rd" class="r30 r">e</span> = <b>new</b> <a href="MshInvalidOperationException.cs.html#de5b942a57457045" class="t constructor">PSInvalidOperationException</a>(<span class="r29 r">message</span>);
 
            <b>return</b> <span class="r30 r">e</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception. This variant allows the caller to</span>
        <span class="c">///</span><span class="c"> specify alternate template text, but only in assembly S.M.A.Core.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The template string for this error</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Objects corresponding to {0}, {1}, etc. in the resource string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshInvalidOperationException.cs.html#259a38c8b594783c" class="t t">PSInvalidOperationException</a> <a id="eafc61f0708da78f" href="../R/eafc61f0708da78f.html" target="n" data-glyph="74,1" class="i method">NewInvalidOperationException</a>(
            <b>string</b> <span id="r31 rd" class="r31 r">resourceString</span>, <b>params object</b>[] <span id="r32 rd" class="r32 r">args</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r31 r">resourceString</span>))
            {
                <b>throw</b> <a href="#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r31 r">resourceString</span>));
            }
 
            <b>string</b> <span id="r33 rd" class="r33 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="StringUtil.cs.html#798b827f58e30321" class="i method">Format</a>(<span class="r31 r">resourceString</span>, <span class="r32 r">args</span>);
 
            <a href="MshInvalidOperationException.cs.html#259a38c8b594783c" class="k">var</a> <span id="r34 rd" class="r34 r">e</span> = <b>new</b> <a href="MshInvalidOperationException.cs.html#de5b942a57457045" class="t constructor">PSInvalidOperationException</a>(<span class="r33 r">message</span>);
            <b>return</b> <span class="r34 r">e</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception. This variant allows the caller to</span>
        <span class="c">///</span><span class="c"> specify alternate template text, but only in assembly S.M.A.Core.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">innerException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the InnerException for the InvalidOperationException</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The template string for this error</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Objects corresponding to {0}, {1}, etc. in the resource string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshInvalidOperationException.cs.html#259a38c8b594783c" class="t t">PSInvalidOperationException</a> <a id="66f5dbeaeeb53748" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NewInvalidOperationException</a>(
            <span class="i">Exception</span> <span id="r35 rd" class="r35 r">innerException</span>,
            <b>string</b> <span id="r36 rd" class="r36 r">resourceString</span>, <b>params object</b>[] <span id="r37 rd" class="r37 r">args</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r36 r">resourceString</span>))
            {
                <b>throw</b> <a href="#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r36 r">resourceString</span>));
            }
 
            <b>string</b> <span id="r38 rd" class="r38 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="StringUtil.cs.html#798b827f58e30321" class="i method">Format</a>(<span class="r36 r">resourceString</span>, <span class="r37 r">args</span>);
 
            <a href="MshInvalidOperationException.cs.html#259a38c8b594783c" class="k">var</a> <span id="r39 rd" class="r39 r">e</span> = <b>new</b> <a href="MshInvalidOperationException.cs.html#47b9a9ffc226bbc3" class="t constructor">PSInvalidOperationException</a>(<span class="r38 r">message</span>, <span class="r35 r">innerException</span>);
            <b>return</b> <span class="r39 r">e</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception. This is not allowed to call other</span>
        <span class="c">///</span><span class="c"> Throw*Exception variants, since they call this.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="t t">PSNotSupportedException</a> <a id="18f73963f5ead5c2" href="../R/18f73963f5ead5c2.html" target="n" data-glyph="74,1" class="i method">NewNotSupportedException</a>()
        {
            <b>string</b> <span id="r40 rd" class="r40 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">AutomationExceptions</span>.<span class="i">NotSupported</span>,
                <b>new</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">StackTrace</span>().<span class="i">GetFrame</span>(0).<span class="i">ToString</span>());
            <a href="MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="k">var</a> <span id="r41 rd" class="r41 r">e</span> = <b>new</b> <a href="MshNotSupportedException.cs.html#021b4370ebdc2266" class="t constructor">PSNotSupportedException</a>(<span class="r40 r">message</span>);
 
            <b>return</b> <span class="r41 r">e</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception. This is not allowed to call other</span>
        <span class="c">///</span><span class="c"> Throw*Exception variants, since they call this.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The template string for this error</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Objects corresponding to {0}, {1}, etc. in the resource string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="t t">PSNotSupportedException</a> <a id="abc203ffeaad54ba" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NewNotSupportedException</a>(
            <b>string</b> <span id="r42 rd" class="r42 r">resourceString</span>,
            <b>params object</b>[] <span id="r43 rd" class="r43 r">args</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r42 r">resourceString</span>))
            {
                <b>throw</b> <a href="#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r42 r">resourceString</span>));
            }
 
            <b>string</b> <span id="r44 rd" class="r44 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="StringUtil.cs.html#798b827f58e30321" class="i method">Format</a>(<span class="r42 r">resourceString</span>, <span class="r43 r">args</span>);
            <a href="MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="k">var</a> <span id="r45 rd" class="r45 r">e</span> = <b>new</b> <a href="MshNotSupportedException.cs.html#021b4370ebdc2266" class="t constructor">PSNotSupportedException</a>(<span class="r44 r">message</span>);
 
            <b>return</b> <span class="r45 r">e</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception. This is not allowed to call other</span>
        <span class="c">///</span><span class="c"> Throw*Exception variants, since they call this.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshNotImplementedException.cs.html#ddab2b46a60907f3" class="t t">PSNotImplementedException</a> <a id="a7ba17ebc98e51be" href="../R/a7ba17ebc98e51be.html" target="n" data-glyph="74,1" class="i method">NewNotImplementedException</a>()
        {
            <b>string</b> <span id="r46 rd" class="r46 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">AutomationExceptions</span>.<span class="i">NotImplemented</span>,
                <b>new</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">StackTrace</span>().<span class="i">GetFrame</span>(0).<span class="i">ToString</span>());
            <a href="MshNotImplementedException.cs.html#ddab2b46a60907f3" class="k">var</a> <span id="r47 rd" class="r47 r">e</span> = <b>new</b> <a href="MshNotImplementedException.cs.html#a2eed9cfb63b6fb1" class="t constructor">PSNotImplementedException</a>(<span class="r46 r">message</span>);
 
            <b>return</b> <span class="r47 r">e</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception. This variant uses the default</span>
        <span class="c">///</span><span class="c"> ArgumentOutOfRangeException template text. This is not allowed to call</span>
        <span class="c">///</span><span class="c"> other Throw*Exception variants, since they call this.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">paramName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the parameter whose argument value was out of range</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">actualValue</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value of the argument causing the exception</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshArgumentOutOfRangeException.cs.html#30c91f7bd86d4aba" class="t t">PSArgumentOutOfRangeException</a> <a id="3ec1a8e5fa36a1b2" href="../R/3ec1a8e5fa36a1b2.html" target="n" data-glyph="74,1" class="i method">NewArgumentOutOfRangeException</a>(<b>string</b> <span id="r48 rd" class="r48 r">paramName</span>, <b>object</b> <span id="r49 rd" class="r49 r">actualValue</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r48 r">paramName</span>))
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r48 r">paramName</span>));
            }
 
            <b>string</b> <span id="r50 rd" class="r50 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">AutomationExceptions</span>.<span class="i">ArgumentOutOfRange</span>, <span class="r48 r">paramName</span>);
            <a href="MshArgumentOutOfRangeException.cs.html#30c91f7bd86d4aba" class="k">var</a> <span id="r51 rd" class="r51 r">e</span> = <b>new</b> <a href="MshArgumentOutOfRangeException.cs.html#3dcd1db8f1280921" class="t constructor">PSArgumentOutOfRangeException</a>(<span class="r48 r">paramName</span>, <span class="r49 r">actualValue</span>, <span class="r50 r">message</span>);
 
            <b>return</b> <span class="r51 r">e</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception. This variant allows the caller to</span>
        <span class="c">///</span><span class="c"> specify alternate template text, but only in assembly S.M.A.Core.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">paramName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the parameter whose argument value was invalid</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">actualValue</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value of the argument causing the exception</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">resourceString</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The template string for this error</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Objects corresponding to {0}, {1}, etc. in the resource string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshArgumentOutOfRangeException.cs.html#30c91f7bd86d4aba" class="t t">PSArgumentOutOfRangeException</a> <a id="e7708b796cb816a6" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NewArgumentOutOfRangeException</a>(
            <b>string</b> <span id="r52 rd" class="r52 r">paramName</span>, <b>object</b> <span id="r53 rd" class="r53 r">actualValue</span>, <b>string</b> <span id="r54 rd" class="r54 r">resourceString</span>, <b>params object</b>[] <span id="r55 rd" class="r55 r">args</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r52 r">paramName</span>))
            {
                <b>throw</b> <a href="#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r52 r">paramName</span>));
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r54 r">resourceString</span>))
            {
                <b>throw</b> <a href="#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r54 r">resourceString</span>));
            }
 
            <b>string</b> <span id="r56 rd" class="r56 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="StringUtil.cs.html#798b827f58e30321" class="i method">Format</a>(<span class="r54 r">resourceString</span>, <span class="r55 r">args</span>);
            <a href="MshArgumentOutOfRangeException.cs.html#30c91f7bd86d4aba" class="k">var</a> <span id="r57 rd" class="r57 r">e</span> = <b>new</b> <a href="MshArgumentOutOfRangeException.cs.html#3dcd1db8f1280921" class="t constructor">PSArgumentOutOfRangeException</a>(<span class="r52 r">paramName</span>, <span class="r53 r">actualValue</span>, <span class="r56 r">message</span>);
 
            <b>return</b> <span class="r57 r">e</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the Message and StackTrace properties of the exception</span>
        <span class="c">///</span><span class="c"> and returns the new exception. This variant uses the default</span>
        <span class="c">///</span><span class="c"> ObjectDisposedException template text. This is not allowed to call</span>
        <span class="c">///</span><span class="c"> other Throw*Exception variants, since they call this.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">objectName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the disposed object</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Exception instance ready to throw.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Note that the parameter is the object name and not the message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="MshObjectDisposedException.cs.html#4c5cddc0e35c4b87" class="t t">PSObjectDisposedException</a> <a id="02739f4db42486af" href="../R/02739f4db42486af.html" target="n" data-glyph="74,1" class="i method">NewObjectDisposedException</a>(<b>string</b> <span id="r58 rd" class="r58 r">objectName</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r58 r">objectName</span>))
            {
                <b>throw</b> <a href="#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r58 r">objectName</span>));
            }
 
            <b>string</b> <span id="r59 rd" class="r59 r">message</span> = <a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">AutomationExceptions</span>.<span class="i">ObjectDisposed</span>, <span class="r58 r">objectName</span>);
            <a href="MshObjectDisposedException.cs.html#4c5cddc0e35c4b87" class="k">var</a> <span id="r60 rd" class="r60 r">e</span> = <b>new</b> <a href="MshObjectDisposedException.cs.html#b1969f00e3040bac" class="t constructor">PSObjectDisposedException</a>(<span class="r58 r">objectName</span>, <span class="r59 r">message</span>);
 
            <b>return</b> <span class="r60 r">e</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> TraceFlags.New*Exception methods/helpers
    }
}
</pre></td></tr></table></div></body></html>
