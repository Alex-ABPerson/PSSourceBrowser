<!DOCTYPE html>
<html><head><title>PlatformInvokes.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(696);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/utils/PlatformInvokes.cs" target="_top">utils\PlatformInvokes.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Win32</span>.<span class="i">SafeHandles</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <b>internal static class</b> <a id="efe149a5eeb6ff14" href="../R/efe149a5eeb6ff14.html" target="n" data-glyph="2,0" class="t t">PlatformInvokes</a>
    {
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal class</b> <a id="03e0d8d8ae4cbe62" href="../R/03e0d8d8ae4cbe62.html" target="n" data-glyph="2,1" class="t t">FILETIME</a>
        {
            <b>internal uint</b> <a id="2922d6ad7054922d" href="../R/2922d6ad7054922d.html" target="n" data-glyph="44,2" class="i field">dwLowDateTime</a>;
            <b>internal uint</b> <a id="5a6b7772df017200" href="../R/5a6b7772df017200.html" target="n" data-glyph="44,2" class="i field">dwHighDateTime</a>;
 
            <b>internal</b> <a id="d0ab374e1e043ea8" href="../R/d0ab374e1e043ea8.html" target="n" data-glyph="74,2" class="t constructor">FILETIME</a>()
            {
                <a href="#2922d6ad7054922d" class="i field">dwLowDateTime</a> = 0;
                <a href="#5a6b7772df017200" class="i field">dwHighDateTime</a> = 0;
            }
 
            <b>internal</b> <a id="2aa4cd8c5de5943b" href="../R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">FILETIME</a>(<b>long</b> <span id="r0 rd" class="r0 r">fileTime</span>)
            {
                <a href="#2922d6ad7054922d" class="i field">dwLowDateTime</a> = (<b>uint</b>)<span class="r0 r">fileTime</span>;
                <a href="#5a6b7772df017200" class="i field">dwHighDateTime</a> = (<b>uint</b>)(<span class="r0 r">fileTime</span> &gt;&gt; 32);
            }
 
            <b>public long</b> <a id="7694fd9a84429a0b" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">ToTicks</a>()
            {
                <b>return</b> ((<b>long</b>)<a href="#5a6b7772df017200" class="i field">dwHighDateTime</a> &lt;&lt; 32) + <a href="#2922d6ad7054922d" class="i field">dwLowDateTime</a>;
            }
        }
 
        [<span class="i">Flags</span>]
        <span class="c">// dwDesiredAccess of CreateFile</span>
        <b>internal enum</b> <a id="c917bb5b57f8b6c2" href="../R/c917bb5b57f8b6c2.html" target="n" data-glyph="20,1" class="t t"><span id="cdba03d8a97838e3">FileDesiredAccess</span></a> : <b>uint</b>
        {
            <a id="d889a0388da600f1" href="../R/d889a0388da600f1.html" target="n" data-glyph="24,2" class="i field">GenericRead</a> = 0x80000000,
            <a id="02c401ccae577128" href="../R/02c401ccae577128.html" target="n" data-glyph="24,2" class="i field">GenericWrite</a> = 0x40000000,
            <a id="59f7be283c47a7e7" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">GenericExecute</a> = 0x20000000,
            <a id="65ba9f76e132e28f" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">GenericAll</a> = 0x10000000,
        }
 
        [<span class="i">Flags</span>]
        <span class="c">// dwShareMode of CreateFile</span>
        <b>internal enum</b> <a id="d9f96aadec6ee14b" href="../R/d9f96aadec6ee14b.html" target="n" data-glyph="20,1" class="t t"><span id="a14efccff54654b7">FileShareMode</span></a> : <b>uint</b>
        {
            <a id="71cc820ae84b79e6" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">None</a> = 0x00000000,
            <a id="8d33044cbf7c58e2" href="../R/8d33044cbf7c58e2.html" target="n" data-glyph="24,2" class="i field">Read</a> = 0x00000001,
            <a id="7c6d567ca0e44afd" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Write</a> = 0x00000002,
            <a id="cb76781585508cb6" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Delete</a> = 0x00000004,
        }
 
        <span class="c">// dwCreationDisposition of CreateFile</span>
        <b>internal enum</b> <a id="717d3430f9a0894c" href="../R/717d3430f9a0894c.html" target="n" data-glyph="20,1" class="t t"><span id="4ae141fc694b2a89">FileCreationDisposition</span></a> : <b>uint</b>
        {
            <a id="669799a9f43c6713" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">New</a> = 1,
            <a id="62d9fd39732f34d7" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">CreateAlways</a> = 2,
            <a id="e210b61821e30e4e" href="../R/e210b61821e30e4e.html" target="n" data-glyph="24,2" class="i field">OpenExisting</a> = 3,
            <a id="6b6ed345165338f2" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">OpenAlways</a> = 4,
            <a id="2f023144acfd6163" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">TruncateExisting</a> = 5,
        }
 
        [<span class="i">Flags</span>]
        <span class="c">// dwFlagsAndAttributes</span>
        <b>internal enum</b> <a id="8a072c352540d495" href="../R/8a072c352540d495.html" target="n" data-glyph="20,1" class="t t"><span id="17b30a06d4d3029e">FileAttributes</span></a> : <b>uint</b>
        {
            <a id="2ce9f93e88a7f4a4" href="../R/2ce9f93e88a7f4a4.html" target="n" data-glyph="24,2" class="i field">ReadOnly</a> = 0x00000001,
            <a id="081c333a362b82a1" href="../R/081c333a362b82a1.html" target="n" data-glyph="24,2" class="i field">Hidden</a> = 0x00000002,
            <a id="a9183c45ede6b7e0" href="../R/a9183c45ede6b7e0.html" target="n" data-glyph="24,2" class="i field">System</a> = 0x00000004,
            <a id="e4310fc3d782a663" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Directory</a> = 0x00000010,
            <a id="3d4ce0cf4dfe4253" href="../R/3d4ce0cf4dfe4253.html" target="n" data-glyph="24,2" class="i field">Archive</a> = 0x00000020,
            <a id="f65a9e13c0f7838d" href="../R/f65a9e13c0f7838d.html" target="n" data-glyph="24,2" class="i field">Normal</a> = 0x00000080,
            <a id="1e20b3255b403a80" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Temporary</a> = 0x00000100,
            <a id="80634d0f76a5e87f" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Offline</a> = 0x00001000,
            <a id="54a3c35a96e5b11c" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">NotContentIndexed</a> = 0x00002000,
            <a id="26c9e7451e9856ce" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Encrypted</a> = 0x00004000,
            <a id="9fcf24565080bc3c" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Write_Through</a> = 0x80000000,
            <a id="fb5609401bb2eb27" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">Overlapped</a> = 0x40000000,
            <a id="6c0b9c6a20c97de2" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">NoBuffering</a> = 0x20000000,
            <a id="47852c5a856f8c81" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">RandomAccess</a> = 0x10000000,
            <a id="b45fd8f2e766213e" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SequentialScan</a> = 0x08000000,
            <a id="c480f017dd95cc61" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">DeleteOnClose</a> = 0x04000000,
            <a id="ae6b7811938773c3" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">BackupSemantics</a> = 0x02000000,
            <a id="e7420a6fade771f7" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">PosixSemantics</a> = 0x01000000,
            <a id="a27e9c35355979ba" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">OpenReparsePoint</a> = 0x00200000,
            <a id="04b2e02580f70fdc" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">OpenNoRecall</a> = 0x00100000,
            <a id="daf7bc57c879a556" href="../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">SessionAware</a> = 0x00800000
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal class</b> <a id="24cf89a42dfaf689" href="../R/../../0000000000.html" target="n" data-glyph="2,1" class="t t">SecurityAttributes</a>
        {
            <b>internal int</b> <a id="66248748f296c71f" href="../R/66248748f296c71f.html" target="n" data-glyph="44,2" class="i field">nLength</a>;
            <b>internal</b> <a href="#f76c7d738d47e576" class="t t">SafeLocalMemHandle</a> <a id="345c11b5c379a661" href="../R/345c11b5c379a661.html" target="n" data-glyph="44,2" class="i field">lpSecurityDescriptor</a>;
            <b>internal bool</b> <a id="034c2e670828be57" href="../R/034c2e670828be57.html" target="n" data-glyph="44,2" class="i field">bInheritHandle</a>;
 
            <b>internal</b> <a id="e8a88e30548f0574" href="../R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">SecurityAttributes</a>()
            {
                <a href="#24cf89a42dfaf689" class="k">this</a>.<a href="#66248748f296c71f" class="i field">nLength</a> = 12;
                <a href="#24cf89a42dfaf689" class="k">this</a>.<a href="#034c2e670828be57" class="i field">bInheritHandle</a> = <b>true</b>;
                <a href="#24cf89a42dfaf689" class="k">this</a>.<a href="#345c11b5c379a661" class="i field">lpSecurityDescriptor</a> = <b>new</b> <span class="t">SafeLocalMemHandle</span>(<span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>true</b>);
            }
        }
 
        <b>internal sealed class</b> <a id="f76c7d738d47e576" href="../R/f76c7d738d47e576.html" target="n" data-glyph="2,1" class="t t">SafeLocalMemHandle</a> : <span class="i">SafeHandleZeroOrMinusOneIsInvalid</span>
        {
            <span class="c">// Methods</span>
            <b>internal</b> <a id="c22f0a53a72714f3" href="../R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">SafeLocalMemHandle</a>()
                : <b>base</b>(<b>true</b>)
            {
            }
 
            <b>internal</b> <a id="b47b510b27ce80bd" href="../R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">SafeLocalMemHandle</a>(<span class="i">IntPtr</span> <span id="r1 rd" class="r1 r">existingHandle</span>, <b>bool</b> <span id="r2 rd" class="r2 r">ownsHandle</span>)
                : <b>base</b>(<span class="r2 r">ownsHandle</span>)
            {
                <b>base</b>.<span class="i">SetHandle</span>(<span class="r1 r">existingHandle</span>);
            }
 
            [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#001ee47a74a501c0" class="i field">LocalFreeDllName</a>)]
            <b>private static extern</b> <span class="i">IntPtr</span> <a id="167813e84a9c3b2c" href="../R/../../0000000000.html" target="n" data-glyph="76,2" class="i method">LocalFree</a>(<span class="i">IntPtr</span> <span id="r3 rd" class="r3 r">hMem</span>);
 
            <b>protected override bool</b> <a id="d6a54ae98a89dc6e" href="../R/../../0000000000.html" target="n" data-glyph="75,2" class="i method">ReleaseHandle</a>()
            {
                <b>return</b> (<span class="i">LocalFree</span>(<b>base</b>.<span class="i">handle</span>) == <span class="i">IntPtr</span>.<span class="i">Zero</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates or opens a file, file stream, directory, physical disk, volume, console buffer,</span>
        <span class="c">///</span><span class="c"> tape drive, communications resource, mailslot, or named pipe. The function returns a</span>
        <span class="c">///</span><span class="c"> handle that can be used to access the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">lpFileName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the object to be created or opened.</span>
        <span class="c">///</span><span class="c"> In the ANSI version of this function, the name is limited to MAX_PATH characters.</span>
        <span class="c">///</span><span class="c"> To extend this limit to 32,767 wide characters, call the Unicode version of the</span>
        <span class="c">///</span><span class="c"> function and prepend &quot;\\?\&quot; to the path. For more information, see Naming a File.</span>
        <span class="c">///</span><span class="c"> For information on special device names, see Defining an MS-DOS Device Name.</span>
        <span class="c">///</span><span class="c"> To specify a COM port number greater than 9, use the following syntax: &quot;\\.\COM10&quot;.</span>
        <span class="c">///</span><span class="c"> This syntax works for all port numbers and hardware that allows COM port numbers to be specified.</span>
        <span class="c">///</span><span class="c"> To create a file stream, specify the name of the file, a colon, and then the name of the</span>
        <span class="c">///</span><span class="c"> stream. For more information, see File Streams.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">dwDesiredAccess</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The access to the object, which can be read, write, or both.</span>
        <span class="c">///</span><span class="c"> You cannot request an access mode that conflicts with the sharing mode that is</span>
        <span class="c">///</span><span class="c"> specified in an open request that has an open handle.</span>
        <span class="c">///</span><span class="c"> If this parameter is zero (0), the application can query file and device attributes</span>
        <span class="c">///</span><span class="c"> without accessing a device. This is useful for an application to determine the size</span>
        <span class="c">///</span><span class="c"> of a floppy disk drive and the formats it supports without requiring a floppy in a drive.</span>
        <span class="c">///</span><span class="c"> It can also be used to test for the existence of a file or directory without opening</span>
        <span class="c">///</span><span class="c"> them for read or write access.</span>
        <span class="c">///</span><span class="c"> See the &quot;CreateFile desired access&quot; below.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">dwShareMode</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The sharing mode of an object, which can be read, write, both, or none.</span>
        <span class="c">///</span><span class="c"> You cannot request a sharing mode that conflicts with the access mode that is specified</span>
        <span class="c">///</span><span class="c"> in an open request that has an open handle, because that would result in the following</span>
        <span class="c">///</span><span class="c"> sharing violation: ERROR_SHARING_VIOLATION.</span>
        <span class="c">///</span><span class="c"> If this parameter is zero (0) and CreateFile succeeds, the object cannot be shared</span>
        <span class="c">///</span><span class="c"> and cannot be opened again until the handle is closed. For more information, see the</span>
        <span class="c">///</span><span class="c"> Remarks section of this topic.</span>
        <span class="c">///</span><span class="c"> The sharing options remain in effect until you close the handle to an object.</span>
        <span class="c">///</span><span class="c"> To enable a process to share an object while another process has the object open,</span>
        <span class="c">///</span><span class="c"> use a combination of one or more of the following values to specify the access mode</span>
        <span class="c">///</span><span class="c"> they can request to open the object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">lpSecurityAttributes</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A pointer to a SECURITY_ATTRIBUTES structure that determines whether or not the returned</span>
        <span class="c">///</span><span class="c"> handle can be inherited by child processes.</span>
        <span class="c">///</span><span class="c"> If lpSecurityAttributes is NULL, the handle cannot be inherited.</span>
        <span class="c">///</span><span class="c"> The lpSecurityDescriptor member of the structure specifies a security descriptor</span>
        <span class="c">///</span><span class="c"> for an object. If lpSecurityAttributes is NULL, the object gets a default security descriptor.</span>
        <span class="c">///</span><span class="c"> The access control lists (ACL) in the default security descriptor for a file or directory</span>
        <span class="c">///</span><span class="c"> are inherited from its parent directory.</span>
        <span class="c">///</span><span class="c"> The target file system must support security on files and directories for this parameter to</span>
        <span class="c">///</span><span class="c"> have an effect on them, which is indicated when GetVolumeInformation returns FS_PERSISTENT_ACLS.</span>
        <span class="c">///</span><span class="c"> CreateFile ignores lpSecurityDescriptor when opening an existing file, but continues to</span>
        <span class="c">///</span><span class="c"> use the other structure members.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">dwCreationDisposition</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An action to take on files that exist and do not exist.</span>
        <span class="c">///</span><span class="c"> See &quot;CreateFile creation disposition&quot; below</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">dwFlagsAndAttributes</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The file attributes and flags.</span>
        <span class="c">///</span><span class="c"> This parameter can include any combination of the file attributes.</span>
        <span class="c">///</span><span class="c"> All other file attributes override FILE_ATTRIBUTE_NORMAL.</span>
        <span class="c">///</span><span class="c"> When CreateFile opens a file, it combines the file flags with existing</span>
        <span class="c">///</span><span class="c"> file attributes, and ignores any supplied file attributes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">hTemplateFile</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A handle to a template file with the GENERIC_READ access right.</span>
        <span class="c">///</span><span class="c"> The template file supplies file attributes and extended attributes for the file that is</span>
        <span class="c">///</span><span class="c"> being created. This parameter can be NULL.</span>
        <span class="c">///</span><span class="c"> When opening an existing file, CreateFile ignores the template file.</span>
        <span class="c">///</span><span class="c"> When opening a new EFS-encrypted file, the file inherits the DACL from its parent directory.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the function succeeds, the return value is an open handle to a specified file.</span>
        <span class="c">///</span><span class="c"> If a specified file exists before the function call and dwCreationDisposition is CREATE_ALWAYS</span>
        <span class="c">///</span><span class="c"> or OPEN_ALWAYS, a call to GetLastError returns ERROR_ALREADY_EXISTS, even when the</span>
        <span class="c">///</span><span class="c"> function succeeds. If a file does not exist before the call, GetLastError returns zero (0).</span>
        <span class="c">///</span><span class="c"> If the function fails, the return value is INVALID_HANDLE_VALUE.</span>
        <span class="c">///</span><span class="c"> To get extended error information, call GetLastError.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#c72846465597e9c7" class="i field">CreateFileDllName</a>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="b7592d93aa3b5d85" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CreateFile</a>(
            <b>string</b> <span id="r4 rd" class="r4 r">lpFileName</span>,
            <a href="#c917bb5b57f8b6c2" class="t t">FileDesiredAccess</a> <span id="r5 rd" class="r5 r">dwDesiredAccess</span>,
            <a href="#d9f96aadec6ee14b" class="t t">FileShareMode</a> <span id="r6 rd" class="r6 r">dwShareMode</span>,
            <span class="i">IntPtr</span> <span id="r7 rd" class="r7 r">lpSecurityAttributes</span>,
            <a href="#717d3430f9a0894c" class="t t">FileCreationDisposition</a> <span id="r8 rd" class="r8 r">dwCreationDisposition</span>,
            <a href="#8a072c352540d495" class="t t">FileAttributes</a> <span id="r9 rd" class="r9 r">dwFlagsAndAttributes</span>,
            <span class="i">IntPtr</span> <span id="r10 rd" class="r10 r">hTemplateFile</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Closes an open object handle.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">handle</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A valid handle to an open object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the function succeeds, the return value is nonzero.</span>
        <span class="c">///</span><span class="c"> If the function fails, the return value is zero. To get extended error information,</span>
        <span class="c">///</span><span class="c"> call GetLastError.</span>
        <span class="c">///</span><span class="c"> If the application is running under a debugger, the function will throw an exception</span>
        <span class="c">///</span><span class="c"> if it receives either a handle value that is not valid or a pseudo-handle value.</span>
        <span class="c">///</span><span class="c"> This can happen if you close a handle twice, or if you call CloseHandle on a handle</span>
        <span class="c">///</span><span class="c"> returned by the FindFirstFile function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#344fbd4b4ca02933" class="i field">CloseHandleDllName</a>, <span class="i">SetLastError</span> = <b>true</b>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <span class="c">// [SuppressMessage(&quot;Microsoft.Security&quot;, &quot;CA2118:ReviewSuppressUnmanagedCodeSecurityUsage&quot;)]</span>
        <b>internal static extern bool</b> <a id="f1253a9f9c110d3f" href="../R/f1253a9f9c110d3f.html" target="n" data-glyph="74,1" class="i method">CloseHandle</a>(<span class="i">IntPtr</span> <span id="r11 rd" class="r11 r">handle</span>);
 
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#477d3c2839ae2d06" class="i field">DosDateTimeToFileTimeDllName</a>, <span class="i">SetLastError</span> = <b>false</b>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="c6f3e103728f336b" href="../R/c6f3e103728f336b.html" target="n" data-glyph="74,1" class="i method">DosDateTimeToFileTime</a>(
            <b>short</b> <span id="r12 rd" class="r12 r">wFatDate</span>, <span class="c">// _In_   WORD</span>
            <b>short</b> <span id="r13 rd" class="r13 r">wFatTime</span>, <span class="c">// _In_   WORD</span>
            <a href="#03e0d8d8ae4cbe62" class="t t">FILETIME</a> <span id="r14 rd" class="r14 r">lpFileTime</span>); <span class="c">// _Out_ LPFILETIME</span>
 
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#e500ebbd4ed5eed2" class="i field">LocalFileTimeToFileTimeDllName</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="a6eda48e7da1db04" href="../R/a6eda48e7da1db04.html" target="n" data-glyph="74,1" class="i method">LocalFileTimeToFileTime</a>(
            <a href="#03e0d8d8ae4cbe62" class="t t">FILETIME</a> <span id="r15 rd" class="r15 r">lpLocalFileTime</span>, <span class="c">// _In_   const FILETIME *</span>
            <a href="#03e0d8d8ae4cbe62" class="t t">FILETIME</a> <span id="r16 rd" class="r16 r">lpFileTime</span>); <span class="c">// _Out_ LPFILETIME</span>
 
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#4d7e2c59bd1e82cf" class="i field">SetFileTimeDllName</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="3411b76e4b090854" href="../R/3411b76e4b090854.html" target="n" data-glyph="74,1" class="i method">SetFileTime</a>(
            <span class="i">IntPtr</span> <span id="r17 rd" class="r17 r">hFile</span>, <span class="c">// _In_      HANDLE</span>
            <a href="#03e0d8d8ae4cbe62" class="t t">FILETIME</a> <span id="r18 rd" class="r18 r">lpCreationTime</span>, <span class="c">// _In_opt_ const FILETIME *</span>
            <a href="#03e0d8d8ae4cbe62" class="t t">FILETIME</a> <span id="r19 rd" class="r19 r">lpLastAccessTime</span>, <span class="c">// _In_opt_ const FILETIME *</span>
            <a href="#03e0d8d8ae4cbe62" class="t t">FILETIME</a> <span id="r20 rd" class="r20 r">lpLastWriteTime</span>); <span class="c">// _In_opt_ const FILETIME *</span>
 
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#19c91dd42415398d" class="i field">SetFileAttributesWDllName</a>, <span class="i">SetLastError</span> = <b>false</b>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="d46e8345a3ade481" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">SetFileAttributesW</a>(
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r21 rd" class="r21 r">lpFileName</span>, <span class="c">// _In_ LPCTSTR</span>
            <a href="#8a072c352540d495" class="t t">FileAttributes</a> <span id="r22 rd" class="r22 r">dwFileAttributes</span>); <span class="c">// _In_ DWORD</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enable the privilege specified by the privilegeName. If the specified privilege is already enabled, return true</span>
        <span class="c">///</span><span class="c"> with the oldPrivilegeState.PrivilegeCount set to 0. Otherwise, enable the specified privilege, and the old privilege</span>
        <span class="c">///</span><span class="c"> state will be saved in oldPrivilegeState.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">privilegeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">oldPrivilegeState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="3c5d038241a5e50e" href="../R/3c5d038241a5e50e.html" target="n" data-glyph="74,1" class="i method">EnableTokenPrivilege</a>(<b>string</b> <span id="r23 rd" class="r23 r">privilegeName</span>, <b>ref</b> <a href="#3999f62af0b47411" class="t t">TOKEN_PRIVILEGE</a> <span id="r24 rd" class="r24 r">oldPrivilegeState</span>)
        {
            <b>bool</b> <span id="r25 rd" class="r25 r">success</span> = <b>false</b>;
            <a href="#3999f62af0b47411" class="t t">TOKEN_PRIVILEGE</a> <span id="r26 rd" class="r26 r">newPrivilegeState</span> = <b>new</b> <span class="t">TOKEN_PRIVILEGE</span>();
 
            <span class="c">// Check if the caller has the specified privilege or not</span>
            <b>if</b> (<a href="#697a1ad9cdc9fe3a" class="i method">LookupPrivilegeValue</a>(<b>null</b>, <span class="r23 r">privilegeName</span>, <b>ref</b> <span class="r26 r">newPrivilegeState</span>.<a href="#12bbc687538145f0" class="i field">Privilege</a>.<a href="#c6aa02f42b09c6f7" class="i field">Luid</a>))
            {
                <span class="c">// Get the pseudo handler of the current process</span>
                <span class="i">IntPtr</span> <span id="r27 rd" class="r27 r">processHandler</span> = <a href="#a95df4687859326f" class="i method">GetCurrentProcess</a>();
                <b>if</b> (<span class="r27 r">processHandler</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <span class="c">// Get the handler of the current process&#39;s access token</span>
                    <span class="i">IntPtr</span> <span id="r28 rd" class="r28 r">tokenHandler</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                    <b>if</b> (<span class="i">OpenProcessToken</span>(<span class="r27 r">processHandler</span>, <a href="#818965aaceb65387" class="i field">TOKEN_ADJUST_PRIVILEGES</a> | <a href="#c1bd7140975a1ce5" class="i field">TOKEN_QUERY</a>, <b>out</b> <span class="r28 r">tokenHandler</span>))
                    {
                        <span class="c">// Check if the specified privilege is already enabled</span>
                        <a href="#8b852813e8b73e00" class="t t">PRIVILEGE_SET</a> <span id="r29 rd" class="r29 r">requiredPrivilege</span> = <b>new</b> <span class="t">PRIVILEGE_SET</span>();
                        <span class="r29 r">requiredPrivilege</span>.<a href="#4d33eff0df0ce558" class="i field">Privilege</a>.<a href="#c6aa02f42b09c6f7" class="i field">Luid</a> = <span class="r26 r">newPrivilegeState</span>.<a href="#12bbc687538145f0" class="i field">Privilege</a>.<a href="#c6aa02f42b09c6f7" class="i field">Luid</a>;
                        <span class="r29 r">requiredPrivilege</span>.<a href="#85b9fb0b0fdfce5d" class="i field">PrivilegeCount</a> = 1;
                        <span class="c">// PRIVILEGE_SET_ALL_NECESSARY is defined as 1</span>
                        <span class="r29 r">requiredPrivilege</span>.<a href="#d39fc45be047c39b" class="i field">Control</a> = 1;
                        <b>bool</b> <span id="r30 rd" class="r30 r">privilegeEnabled</span> = <b>false</b>;
 
                        <b>if</b> (<a href="#d555f3b985c294ed" class="i method">PrivilegeCheck</a>(<span class="r28 r">tokenHandler</span>, <b>ref</b> <span class="r29 r">requiredPrivilege</span>, <b>out</b> <span class="r30 r">privilegeEnabled</span>) &amp;&amp; <span class="r30 r">privilegeEnabled</span>)
                        {
                            <span class="c">// The specified privilege is already enabled</span>
                            <span class="r24 r">oldPrivilegeState</span>.<a href="#8ad0da4be34169d2" class="i field">PrivilegeCount</a> = 0;
                            <span class="r25 r">success</span> = <b>true</b>;
                        }
                        <b>else</b>
                        {
                            <span class="c">// The specified privilege is not enabled yet. Enable it.</span>
                            <span class="r26 r">newPrivilegeState</span>.<a href="#8ad0da4be34169d2" class="i field">PrivilegeCount</a> = 1;
                            <span class="r26 r">newPrivilegeState</span>.<a href="#12bbc687538145f0" class="i field">Privilege</a>.<a href="#7e88225cf6339201" class="i field">Attributes</a> = <a href="#39346d1f3d11cda8" class="i field">SE_PRIVILEGE_ENABLED</a>;
                            <b>int</b> <span id="r31 rd" class="r31 r">bufferSize</span> = <span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<a href="#3999f62af0b47411" class="t t">TOKEN_PRIVILEGE</a>&gt;();
                            <b>int</b> <span id="r32 rd" class="r32 r">returnSize</span> = 0;
 
                            <span class="c">// enable the specified privilege</span>
                            <b>if</b> (<a href="#6095fb1f06588e2d" class="i method">AdjustTokenPrivileges</a>(<span class="r28 r">tokenHandler</span>, <b>false</b>, <b>ref</b> <span class="r26 r">newPrivilegeState</span>, <span class="r31 r">bufferSize</span>, <b>out</b> <span class="r24 r">oldPrivilegeState</span>, <b>ref</b> <span class="r32 r">returnSize</span>))
                            {
                                <span class="c">// AdjustTokenPrivileges returns true does not mean all specified privileges have been successfully enabled</span>
                                <b>int</b> <span id="r33 rd" class="r33 r">retCode</span> = <span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>();
                                <b>if</b> (<span class="r33 r">retCode</span> == <a href="#b66cf569bca8407c" class="i field">ERROR_SUCCESS</a>)
                                {
                                    <span class="r25 r">success</span> = <b>true</b>;
                                }
                                <b>else</b> <b>if</b> (<span class="r33 r">retCode</span> == 1300)
                                {
                                    <span class="c">// 1300 - Not all privileges referenced are assigned to the caller. This means the specified privilege is not</span>
                                    <span class="c">// assigned to the current user. For example, suppose the role of current caller is &quot;User&quot;, then privilege &quot;SeRemoteShutdownPrivilege&quot;</span>
                                    <span class="c">// is not assigned to the role. In this case, we just return true and leave the call to &quot;Win32Shutdown&quot; to decide</span>
                                    <span class="c">// whether the permission is granted or not.</span>
                                    <span class="c">// Set oldPrivilegeState.PrivilegeCount to 0 to avoid the privilege restore later (PrivilegeCount - how many privileges are modified)</span>
                                    <span class="r24 r">oldPrivilegeState</span>.<a href="#8ad0da4be34169d2" class="i field">PrivilegeCount</a> = 0;
                                    <span class="r25 r">success</span> = <b>true</b>;
                                }
                            }
                        }
                    }
 
                    <span class="c">// Close the token handler and the process handler</span>
                    <b>if</b> (<span class="r28 r">tokenHandler</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                    {
                        <a href="#f1253a9f9c110d3f" class="i method">CloseHandle</a>(<span class="r28 r">tokenHandler</span>);
                    }
 
                    <a href="#f1253a9f9c110d3f" class="i method">CloseHandle</a>(<span class="r27 r">processHandler</span>);
                }
            }
 
            <b>return</b> <span class="r25 r">success</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Restore the previous privilege state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">privilegeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">previousPrivilegeState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="d3d8a632f39191ae" href="../R/d3d8a632f39191ae.html" target="n" data-glyph="74,1" class="i method">RestoreTokenPrivilege</a>(<b>string</b> <span id="r34 rd" class="r34 r">privilegeName</span>, <b>ref</b> <a href="#3999f62af0b47411" class="t t">TOKEN_PRIVILEGE</a> <span id="r35 rd" class="r35 r">previousPrivilegeState</span>)
        {
            <span class="c">// The privilege was not changed, do not need to restore it.</span>
            <b>if</b> (<span class="r35 r">previousPrivilegeState</span>.<a href="#8ad0da4be34169d2" class="i field">PrivilegeCount</a> == 0)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>bool</b> <span id="r36 rd" class="r36 r">success</span> = <b>false</b>;
            <a href="#3999f62af0b47411" class="t t">TOKEN_PRIVILEGE</a> <span id="r37 rd" class="r37 r">newState</span> = <b>new</b> <span class="t">TOKEN_PRIVILEGE</span>();
 
            <span class="c">// Check if the caller has the specified privilege or not. If the caller has it, check the LUID specified in previousPrivilegeState</span>
            <span class="c">// to see if the previousPrivilegeState is defined for the same privilege</span>
            <b>if</b> (<a href="#697a1ad9cdc9fe3a" class="i method">LookupPrivilegeValue</a>(<b>null</b>, <span class="r34 r">privilegeName</span>, <b>ref</b> <span class="r37 r">newState</span>.<a href="#12bbc687538145f0" class="i field">Privilege</a>.<a href="#c6aa02f42b09c6f7" class="i field">Luid</a>) &amp;&amp;
                <span class="r37 r">newState</span>.<a href="#12bbc687538145f0" class="i field">Privilege</a>.<a href="#c6aa02f42b09c6f7" class="i field">Luid</a>.<a href="#e40e9e7fccec0c7b" class="i field">HighPart</a> == <span class="r35 r">previousPrivilegeState</span>.<a href="#12bbc687538145f0" class="i field">Privilege</a>.<a href="#c6aa02f42b09c6f7" class="i field">Luid</a>.<a href="#e40e9e7fccec0c7b" class="i field">HighPart</a> &amp;&amp;
                <span class="r37 r">newState</span>.<a href="#12bbc687538145f0" class="i field">Privilege</a>.<a href="#c6aa02f42b09c6f7" class="i field">Luid</a>.<a href="#5c1d5e0fcc16bf1c" class="i field">LowPart</a> == <span class="r35 r">previousPrivilegeState</span>.<a href="#12bbc687538145f0" class="i field">Privilege</a>.<a href="#c6aa02f42b09c6f7" class="i field">Luid</a>.<a href="#5c1d5e0fcc16bf1c" class="i field">LowPart</a>)
            {
                <span class="c">// Get the pseudo handler of the current process</span>
                <span class="i">IntPtr</span> <span id="r38 rd" class="r38 r">processHandler</span> = <a href="#a95df4687859326f" class="i method">GetCurrentProcess</a>();
                <b>if</b> (<span class="r38 r">processHandler</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                {
                    <span class="c">// Get the handler of the current process&#39;s access token</span>
                    <span class="i">IntPtr</span> <span id="r39 rd" class="r39 r">tokenHandler</span> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                    <b>if</b> (<span class="i">OpenProcessToken</span>(<span class="r38 r">processHandler</span>, <a href="#818965aaceb65387" class="i field">TOKEN_ADJUST_PRIVILEGES</a> | <a href="#c1bd7140975a1ce5" class="i field">TOKEN_QUERY</a>, <b>out</b> <span class="r39 r">tokenHandler</span>))
                    {
                        <b>int</b> <span id="r40 rd" class="r40 r">bufferSize</span> = <span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<a href="#3999f62af0b47411" class="t t">TOKEN_PRIVILEGE</a>&gt;();
                        <b>int</b> <span id="r41 rd" class="r41 r">returnSize</span> = 0;
 
                        <span class="c">// restore the privilege state back to the previous privilege state</span>
                        <b>if</b> (<a href="#6095fb1f06588e2d" class="i method">AdjustTokenPrivileges</a>(<span class="r39 r">tokenHandler</span>, <b>false</b>, <b>ref</b> <span class="r35 r">previousPrivilegeState</span>, <span class="r40 r">bufferSize</span>, <b>out</b> <span class="r37 r">newState</span>, <b>ref</b> <span class="r41 r">returnSize</span>))
                        {
                            <b>if</b> (<span class="i">Marshal</span>.<span class="i">GetLastWin32Error</span>() == <a href="#b66cf569bca8407c" class="i field">ERROR_SUCCESS</a>)
                            {
                                <span class="r36 r">success</span> = <b>true</b>;
                            }
                        }
                    }
 
                    <b>if</b> (<span class="r39 r">tokenHandler</span> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                    {
                        <a href="#f1253a9f9c110d3f" class="i method">CloseHandle</a>(<span class="r39 r">tokenHandler</span>);
                    }
 
                    <a href="#f1253a9f9c110d3f" class="i method">CloseHandle</a>(<span class="r38 r">processHandler</span>);
                }
            }
 
            <b>return</b> <span class="r36 r">success</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The LookupPrivilegeValue function retrieves the locally unique identifier (LUID) used on a specified system to locally represent</span>
        <span class="c">///</span><span class="c"> the specified privilege name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">lpSystemName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">lpName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">lpLuid</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#c10e90ab0b2989a6" class="i field">LookupPrivilegeValueDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">BestFitMapping</span> = <b>false</b>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Security&quot;</span>, <span class="s">&quot;CA2118:ReviewSuppressUnmanagedCodeSecurityUsage&quot;</span>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="697a1ad9cdc9fe3a" href="../R/697a1ad9cdc9fe3a.html" target="n" data-glyph="74,1" class="i method">LookupPrivilegeValue</a>(<b>string</b> <span id="r42 rd" class="r42 r">lpSystemName</span>, <b>string</b> <span id="r43 rd" class="r43 r">lpName</span>, <b>ref</b> <a href="#783ceb98ad0e04e8" class="t t">LUID</a> <span id="r44 rd" class="r44 r">lpLuid</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PrivilegeCheck function determines whether a specified privilege is enabled in an access token.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">tokenHandler</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">requiredPrivileges</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">pfResult</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#147c8f8649dc82b0" class="i field">PrivilegeCheckDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">BestFitMapping</span> = <b>false</b>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Security&quot;</span>, <span class="s">&quot;CA2118:ReviewSuppressUnmanagedCodeSecurityUsage&quot;</span>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="d555f3b985c294ed" href="../R/d555f3b985c294ed.html" target="n" data-glyph="74,1" class="i method">PrivilegeCheck</a>(<span class="i">IntPtr</span> <span id="r45 rd" class="r45 r">tokenHandler</span>, <b>ref</b> <a href="#8b852813e8b73e00" class="t t">PRIVILEGE_SET</a> <span id="r46 rd" class="r46 r">requiredPrivileges</span>, <b>out bool</b> <span id="r47 rd" class="r47 r">pfResult</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The AdjustTokenPrivileges function enables or disables privileges in the specified access token. Enabling or disabling privileges in</span>
        <span class="c">///</span><span class="c"> an access token requires TOKEN_ADJUST_PRIVILEGES access. The TOKEN_ADJUST_PRIVILEGES and TOKEN_QUERY accesses are gained when calling</span>
        <span class="c">///</span><span class="c"> the OpenProcessToken function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">tokenHandler</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">disableAllPrivilege</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">newPrivilegeState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">bufferLength</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">previousPrivilegeState</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">returnLength</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#88a7e5c9463e78ce" class="i field">AdjustTokenPrivilegesDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">BestFitMapping</span> = <b>false</b>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Security&quot;</span>, <span class="s">&quot;CA2118:ReviewSuppressUnmanagedCodeSecurityUsage&quot;</span>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="6095fb1f06588e2d" href="../R/6095fb1f06588e2d.html" target="n" data-glyph="74,1" class="i method">AdjustTokenPrivileges</a>(<span class="i">IntPtr</span> <span id="r48 rd" class="r48 r">tokenHandler</span>, <b>bool</b> <span id="r49 rd" class="r49 r">disableAllPrivilege</span>,
                                                          <b>ref</b> <a href="#3999f62af0b47411" class="t t">TOKEN_PRIVILEGE</a> <span id="r50 rd" class="r50 r">newPrivilegeState</span>, <b>int</b> <span id="r51 rd" class="r51 r">bufferLength</span>,
                                                          <b>out</b> <a href="#3999f62af0b47411" class="t t">TOKEN_PRIVILEGE</a> <span id="r52 rd" class="r52 r">previousPrivilegeState</span>,
                                                          <b>ref int</b> <span id="r53 rd" class="r53 r">returnLength</span>);
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="3999f62af0b47411" href="../R/3999f62af0b47411.html" target="n" data-glyph="110,1" class="t t"><span id="f601dcadab575e93">TOKEN_PRIVILEGE</span></a>
        {
            <b>internal uint</b> <a id="8ad0da4be34169d2" href="../R/8ad0da4be34169d2.html" target="n" data-glyph="44,2" class="i field">PrivilegeCount</a>;
            <b>internal</b> <a href="#42eb15b2156da278" class="t t">LUID_AND_ATTRIBUTES</a> <a id="12bbc687538145f0" href="../R/12bbc687538145f0.html" target="n" data-glyph="44,2" class="i field">Privilege</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="783ceb98ad0e04e8" href="../R/783ceb98ad0e04e8.html" target="n" data-glyph="110,1" class="t t"><span id="335548925946635f">LUID</span></a>
        {
            <b>internal uint</b> <a id="5c1d5e0fcc16bf1c" href="../R/5c1d5e0fcc16bf1c.html" target="n" data-glyph="44,2" class="i field">LowPart</a>;
            <b>internal uint</b> <a id="e40e9e7fccec0c7b" href="../R/e40e9e7fccec0c7b.html" target="n" data-glyph="44,2" class="i field">HighPart</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="42eb15b2156da278" href="../R/42eb15b2156da278.html" target="n" data-glyph="110,1" class="t t"><span id="311dce1d5343be02">LUID_AND_ATTRIBUTES</span></a>
        {
            <b>internal</b> <a href="#783ceb98ad0e04e8" class="t t">LUID</a> <a id="c6aa02f42b09c6f7" href="../R/c6aa02f42b09c6f7.html" target="n" data-glyph="44,2" class="i field">Luid</a>;
            <b>internal uint</b> <a id="7e88225cf6339201" href="../R/7e88225cf6339201.html" target="n" data-glyph="44,2" class="i field">Attributes</a>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>internal struct</b> <a id="8b852813e8b73e00" href="../R/8b852813e8b73e00.html" target="n" data-glyph="110,1" class="t t"><span id="f2614bb43f1eaae2">PRIVILEGE_SET</span></a>
        {
            <b>internal uint</b> <a id="85b9fb0b0fdfce5d" href="../R/85b9fb0b0fdfce5d.html" target="n" data-glyph="44,2" class="i field">PrivilegeCount</a>;
            <b>internal uint</b> <a id="d39fc45be047c39b" href="../R/d39fc45be047c39b.html" target="n" data-glyph="44,2" class="i field">Control</a>;
            <b>internal</b> <a href="#42eb15b2156da278" class="t t">LUID_AND_ATTRIBUTES</a> <a id="4d33eff0df0ce558" href="../R/4d33eff0df0ce558.html" target="n" data-glyph="44,2" class="i field">Privilege</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the pseudo handler of the current process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#b2a49fa9b822570e" class="i field">GetCurrentProcessDllName</a>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Security&quot;</span>, <span class="s">&quot;CA2118:ReviewSuppressUnmanagedCodeSecurityUsage&quot;</span>)]
        <b>internal static extern</b> <span class="i">IntPtr</span> <a id="a95df4687859326f" href="../R/a95df4687859326f.html" target="n" data-glyph="74,1" class="i method">GetCurrentProcess</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Retrieves the current process token.</span>
        <span class="c">///</span><span class="c"> This function exists just for backward compatibility. It is prefered to use the other override that takes &#39;SafeHandle&#39; as parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">processHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Process handle.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">desiredAccess</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Token access.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">tokenHandle</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Process token.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The current process token.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#798b1555bc1a5597" class="i field">OpenProcessTokenDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>, <span class="i">BestFitMapping</span> = <b>false</b>)]
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Security&quot;</span>, <span class="s">&quot;CA2118:ReviewSuppressUnmanagedCodeSecurityUsage&quot;</span>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="d4e45a53d9f33426" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">OpenProcessToken</a>(<span class="i">IntPtr</span> <span id="r54 rd" class="r54 r">processHandle</span>, <b>uint</b> <span id="r55 rd" class="r55 r">desiredAccess</span>, <b>out</b> <span class="i">IntPtr</span> <span id="r56 rd" class="r56 r">tokenHandle</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Required to enable or disable the privileges in an access token.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="818965aaceb65387" href="../R/818965aaceb65387.html" target="n" data-glyph="8,1" class="i field">TOKEN_ADJUST_PRIVILEGES</a> = 0x00000020;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Required to query an access token.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="c1bd7140975a1ce5" href="../R/c1bd7140975a1ce5.html" target="n" data-glyph="8,1" class="i field">TOKEN_QUERY</a> = 0x00000008;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Combines all possible access rights for a token.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal const int</b> <a id="ecb734670750069f" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">TOKEN_ALL_ACCESS</a> = 0x001f01ff;
 
        <b>internal const uint</b> <a id="52a255fa80d2be12" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SE_PRIVILEGE_DISABLED</a> = 0x00000000;
        <b>internal const uint</b> <a id="eac1b4c768cc3373" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SE_PRIVILEGE_ENABLED_BY_DEFAULT</a> = 0x00000001;
        <b>internal const uint</b> <a id="39346d1f3d11cda8" href="../R/39346d1f3d11cda8.html" target="n" data-glyph="8,1" class="i field">SE_PRIVILEGE_ENABLED</a> = 0x00000002;
        <b>internal const uint</b> <a id="ae3c149be7418f61" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SE_PRIVILEGE_USED_FOR_ACCESS</a> = 0x80000000;
 
        <b>internal const int</b> <a id="b66cf569bca8407c" href="../R/b66cf569bca8407c.html" target="n" data-glyph="8,1" class="i field">ERROR_SUCCESS</a> = 0x0;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> CreateProcess for SSH Remoting
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">UNIX</span>
 
        <span class="c">// Fields</span>
        <b>internal static readonly</b> <span class="i">IntPtr</span> <a id="6a9b337c9725f262" href="../R/6a9b337c9725f262.html" target="n" data-glyph="44,1" class="i field">INVALID_HANDLE_VALUE</a> = <b>new</b> <span class="i">IntPtr</span>(-1);
        <b>internal static readonly</b> <span class="i">UInt32</span> <a id="c34ddac2f2db6412" href="../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">GENERIC_READ</a> = 0x80000000;
        <b>internal static readonly</b> <span class="i">UInt32</span> <a id="158434c0a7ae652e" href="../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">GENERIC_WRITE</a> = 0x40000000;
        <b>internal static readonly</b> <span class="i">UInt32</span> <a id="25d6351a792b70cb" href="../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">FILE_ATTRIBUTE_NORMAL</a> = 0x80000000;
        <b>internal static readonly</b> <span class="i">UInt32</span> <a id="ac9d7c80c49075e1" href="../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">CREATE_ALWAYS</a> = 2;
        <b>internal static readonly</b> <span class="i">UInt32</span> <a id="a4a43c3fdaad52b0" href="../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">FILE_SHARE_WRITE</a> = 0x00000002;
        <b>internal static readonly</b> <span class="i">UInt32</span> <a id="641425c3f328ed1b" href="../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">FILE_SHARE_READ</a> = 0x00000001;
        <b>internal static readonly</b> <span class="i">UInt32</span> <a id="8dfc005a34958713" href="../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">OF_READWRITE</a> = 0x00000002;
        <b>internal static readonly</b> <span class="i">UInt32</span> <a id="44029bd38b8c0274" href="../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">OPEN_EXISTING</a> = 3;
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal class</b> <a id="ea19886114ee9b7b" href="../R/ea19886114ee9b7b.html" target="n" data-glyph="2,1" class="t t">PROCESS_INFORMATION</a>
        {
            <b>public</b> <span class="i">IntPtr</span> <a id="7a91cba504741801" href="../R/7a91cba504741801.html" target="n" data-glyph="42,2" class="i field">hProcess</a>;
            <b>public</b> <span class="i">IntPtr</span> <a id="b7f1b530778f8c58" href="../R/b7f1b530778f8c58.html" target="n" data-glyph="42,2" class="i field">hThread</a>;
            <b>public int</b> <a id="0a3cbb380fdd7c4f" href="../R/0a3cbb380fdd7c4f.html" target="n" data-glyph="42,2" class="i field">dwProcessId</a>;
            <b>public int</b> <a id="c855aba28f5bf672" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwThreadId</a>;
 
            <b>public</b> <a id="c12e3b6f5f8c76b7" href="../R/c12e3b6f5f8c76b7.html" target="n" data-glyph="72,2" class="t constructor">PROCESS_INFORMATION</a>()
            {
                <a href="#ea19886114ee9b7b" class="k">this</a>.<a href="#7a91cba504741801" class="i field">hProcess</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                <a href="#ea19886114ee9b7b" class="k">this</a>.<a href="#b7f1b530778f8c58" class="i field">hThread</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Dispose.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>public void</b> <a id="252f5a616f09831f" href="../R/252f5a616f09831f.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <a href="#05c15eeaf16d4af1" class="i method">Dispose</a>(<b>true</b>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Dispose.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">disposing</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
            <b>private void</b> <a id="05c15eeaf16d4af1" href="../R/05c15eeaf16d4af1.html" target="n" data-glyph="76,2" class="i method">Dispose</a>(<b>bool</b> <span id="r57 rd" class="r57 r">disposing</span>)
            {
                <b>if</b> (<span class="r57 r">disposing</span>)
                {
                    <b>if</b> (<a href="#ea19886114ee9b7b" class="k">this</a>.<a href="#7a91cba504741801" class="i field">hProcess</a> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                    {
                        <a href="#f1253a9f9c110d3f" class="i method">CloseHandle</a>(<a href="#ea19886114ee9b7b" class="k">this</a>.<a href="#7a91cba504741801" class="i field">hProcess</a>);
                        <a href="#ea19886114ee9b7b" class="k">this</a>.<a href="#7a91cba504741801" class="i field">hProcess</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                    }
 
                    <b>if</b> (<a href="#ea19886114ee9b7b" class="k">this</a>.<a href="#b7f1b530778f8c58" class="i field">hThread</a> != <span class="i">IntPtr</span>.<span class="i">Zero</span>)
                    {
                        <a href="#f1253a9f9c110d3f" class="i method">CloseHandle</a>(<a href="#ea19886114ee9b7b" class="k">this</a>.<a href="#b7f1b530778f8c58" class="i field">hThread</a>);
                        <a href="#ea19886114ee9b7b" class="k">this</a>.<a href="#b7f1b530778f8c58" class="i field">hThread</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                    }
                }
            }
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal class</b> <a id="208aea11e39bcbec" href="../R/208aea11e39bcbec.html" target="n" data-glyph="2,1" class="t t">STARTUPINFO</a>
        {
            <b>public int</b> <a id="fdcb9d829524bec0" href="../R/fdcb9d829524bec0.html" target="n" data-glyph="42,2" class="i field">cb</a>;
            <b>public</b> <span class="i">IntPtr</span> <a id="0f99e555b6076856" href="../R/0f99e555b6076856.html" target="n" data-glyph="42,2" class="i field">lpReserved</a>;
            <b>public</b> <span class="i">IntPtr</span> <a id="ae251a7318d5b448" href="../R/ae251a7318d5b448.html" target="n" data-glyph="42,2" class="i field">lpDesktop</a>;
            <b>public</b> <span class="i">IntPtr</span> <a id="6fef96bf1d1aec4c" href="../R/6fef96bf1d1aec4c.html" target="n" data-glyph="42,2" class="i field">lpTitle</a>;
            <b>public int</b> <a id="f815008224aaaaee" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwX</a>;
            <b>public int</b> <a id="e459b976e3c9ed91" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwY</a>;
            <b>public int</b> <a id="348a61f7c125a21d" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwXSize</a>;
            <b>public int</b> <a id="39b656bdad0d8f3e" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwYSize</a>;
            <b>public int</b> <a id="952b43193a585b42" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwXCountChars</a>;
            <b>public int</b> <a id="d29e19be2efe746b" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwYCountChars</a>;
            <b>public int</b> <a id="410cc5407d610c4b" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">dwFillAttribute</a>;
            <b>public int</b> <a id="471583ec52bcbc40" href="../R/471583ec52bcbc40.html" target="n" data-glyph="42,2" class="i field">dwFlags</a>;
            <b>public short</b> <a id="2d57d7b5111298aa" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">wShowWindow</a>;
            <b>public short</b> <a id="f8ca87c22ec7d268" href="../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">cbReserved2</a>;
            <b>public</b> <span class="i">IntPtr</span> <a id="723374a11bda4cf8" href="../R/723374a11bda4cf8.html" target="n" data-glyph="42,2" class="i field">lpReserved2</a>;
            <b>public</b> <span class="i">SafeFileHandle</span> <a id="5f15e99b334f39bf" href="../R/5f15e99b334f39bf.html" target="n" data-glyph="42,2" class="i field">hStdInput</a>;
            <b>public</b> <span class="i">SafeFileHandle</span> <a id="a830498ef4131916" href="../R/a830498ef4131916.html" target="n" data-glyph="42,2" class="i field">hStdOutput</a>;
            <b>public</b> <span class="i">SafeFileHandle</span> <a id="25906a0e9a876031" href="../R/25906a0e9a876031.html" target="n" data-glyph="42,2" class="i field">hStdError</a>;
 
            <b>public</b> <a id="0d3cb46978876e5a" href="../R/0d3cb46978876e5a.html" target="n" data-glyph="72,2" class="t constructor">STARTUPINFO</a>()
            {
                <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#0f99e555b6076856" class="i field">lpReserved</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#ae251a7318d5b448" class="i field">lpDesktop</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#6fef96bf1d1aec4c" class="i field">lpTitle</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#723374a11bda4cf8" class="i field">lpReserved2</a> = <span class="i">IntPtr</span>.<span class="i">Zero</span>;
                <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#5f15e99b334f39bf" class="i field">hStdInput</a> = <b>new</b> <span class="i">SafeFileHandle</span>(<span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>false</b>);
                <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#a830498ef4131916" class="i field">hStdOutput</a> = <b>new</b> <span class="i">SafeFileHandle</span>(<span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>false</b>);
                <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#25906a0e9a876031" class="i field">hStdError</a> = <b>new</b> <span class="i">SafeFileHandle</span>(<span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>false</b>);
                <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#fdcb9d829524bec0" class="i field">cb</a> = <span class="i">Marshal</span>.<span class="i">SizeOf</span>(<a href="#208aea11e39bcbec" class="k">this</a>);
            }
 
            <b>public void</b> <a id="d138ec9e6269c926" href="../R/d138ec9e6269c926.html" target="n" data-glyph="72,2" class="i method">Dispose</a>(<b>bool</b> <span id="r58 rd" class="r58 r">disposing</span>)
            {
                <b>if</b> (<span class="r58 r">disposing</span>)
                {
                    <b>if</b> ((<a href="#208aea11e39bcbec" class="k">this</a>.<a href="#5f15e99b334f39bf" class="i field">hStdInput</a> != <b>null</b>) &amp;&amp; !<a href="#208aea11e39bcbec" class="k">this</a>.<a href="#5f15e99b334f39bf" class="i field">hStdInput</a>.<span class="i">IsInvalid</span>)
                    {
                        <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#5f15e99b334f39bf" class="i field">hStdInput</a>.<span class="i">Dispose</span>();
                        <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#5f15e99b334f39bf" class="i field">hStdInput</a> = <b>null</b>;
                    }
 
                    <b>if</b> ((<a href="#208aea11e39bcbec" class="k">this</a>.<a href="#a830498ef4131916" class="i field">hStdOutput</a> != <b>null</b>) &amp;&amp; !<a href="#208aea11e39bcbec" class="k">this</a>.<a href="#a830498ef4131916" class="i field">hStdOutput</a>.<span class="i">IsInvalid</span>)
                    {
                        <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#a830498ef4131916" class="i field">hStdOutput</a>.<span class="i">Dispose</span>();
                        <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#a830498ef4131916" class="i field">hStdOutput</a> = <b>null</b>;
                    }
 
                    <b>if</b> ((<a href="#208aea11e39bcbec" class="k">this</a>.<a href="#25906a0e9a876031" class="i field">hStdError</a> != <b>null</b>) &amp;&amp; !<a href="#208aea11e39bcbec" class="k">this</a>.<a href="#25906a0e9a876031" class="i field">hStdError</a>.<span class="i">IsInvalid</span>)
                    {
                        <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#25906a0e9a876031" class="i field">hStdError</a>.<span class="i">Dispose</span>();
                        <a href="#208aea11e39bcbec" class="k">this</a>.<a href="#25906a0e9a876031" class="i field">hStdError</a> = <b>null</b>;
                    }
                }
            }
 
            <b>public void</b> <a id="aad97dd9881c34d8" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Dispose</a>()
            {
                <a href="#d138ec9e6269c926" class="i method">Dispose</a>(<b>true</b>);
            }
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>)]
        <b>internal class</b> <a id="5ff6c3ee389c8fe3" href="../R/5ff6c3ee389c8fe3.html" target="n" data-glyph="2,1" class="t t">SECURITY_ATTRIBUTES</a>
        {
            <b>public int</b> <a id="69758cd50472fd08" href="../R/69758cd50472fd08.html" target="n" data-glyph="42,2" class="i field">nLength</a>;
            <b>public</b> <a href="#f76c7d738d47e576" class="t t">SafeLocalMemHandle</a> <a id="2ef4d68d1fb83b23" href="../R/2ef4d68d1fb83b23.html" target="n" data-glyph="42,2" class="i field">lpSecurityDescriptor</a>;
            <b>public bool</b> <a id="8290575dd4b658bd" href="../R/8290575dd4b658bd.html" target="n" data-glyph="42,2" class="i field">bInheritHandle</a>;
 
            <b>public</b> <a id="5d86d82b0979b477" href="../R/5d86d82b0979b477.html" target="n" data-glyph="72,2" class="t constructor">SECURITY_ATTRIBUTES</a>()
            {
                <a href="#5ff6c3ee389c8fe3" class="k">this</a>.<a href="#69758cd50472fd08" class="i field">nLength</a> = 12;
                <a href="#5ff6c3ee389c8fe3" class="k">this</a>.<a href="#8290575dd4b658bd" class="i field">bInheritHandle</a> = <b>true</b>;
                <a href="#5ff6c3ee389c8fe3" class="k">this</a>.<a href="#2ef4d68d1fb83b23" class="i field">lpSecurityDescriptor</a> = <b>new</b> <span class="t">SafeLocalMemHandle</span>(<span class="i">IntPtr</span>.<span class="i">Zero</span>, <b>true</b>);
            }
        }
 
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#b7fefcae9ac86ed4" class="i field">CreateProcessDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        [<b>return</b>: <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">Bool</span>)]
        <b>internal static extern bool</b> <a id="b2766bad0274fb85" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CreateProcess</a>(
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r59 rd" class="r59 r">lpApplicationName</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r60 rd" class="r60 r">lpCommandLine</span>,
            <a href="#5ff6c3ee389c8fe3" class="t t">SECURITY_ATTRIBUTES</a> <span id="r61 rd" class="r61 r">lpProcessAttributes</span>,
            <a href="#5ff6c3ee389c8fe3" class="t t">SECURITY_ATTRIBUTES</a> <span id="r62 rd" class="r62 r">lpThreadAttributes</span>,
            <b>bool</b> <span id="r63 rd" class="r63 r">bInheritHandles</span>,
            <b>int</b> <span id="r64 rd" class="r64 r">dwCreationFlags</span>,
            <span class="i">IntPtr</span> <span id="r65 rd" class="r65 r">lpEnvironment</span>,
            [<span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r66 rd" class="r66 r">lpCurrentDirectory</span>,
            <a href="#208aea11e39bcbec" class="t t">STARTUPINFO</a> <span id="r67 rd" class="r67 r">lpStartupInfo</span>,
            <a href="#ea19886114ee9b7b" class="t t">PROCESS_INFORMATION</a> <span id="r68 rd" class="r68 r">lpProcessInformation</span>);
 
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#3b4110b5bc464f21" class="i field">ResumeThreadDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        <b>public static extern uint</b> <a id="0a4db853ebeabb70" href="../R/0a4db853ebeabb70.html" target="n" data-glyph="72,1" class="i method">ResumeThread</a>(<span class="i">IntPtr</span> <span id="r69 rd" class="r69 r">threadHandle</span>);
 
        <b>internal static readonly uint</b> <a id="f12582d977629938" href="../R/f12582d977629938.html" target="n" data-glyph="44,1" class="i field">RESUME_THREAD_FAILED</a> = <span class="i n">System</span>.<span class="i">UInt32</span>.<span class="i">MaxValue</span>; <span class="c">// (DWORD)-1</span>
 
        [<span class="i">DllImport</span>(<a href="PInvokeDllNames.cs.html#6c73838805dd2f2a" class="t t">PinvokeDllNames</a>.<a href="PInvokeDllNames.cs.html#c72846465597e9c7" class="i field">CreateFileDllName</a>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>, <span class="i">SetLastError</span> = <b>true</b>)]
        <b>public static extern</b> <span class="i n">System</span>.<span class="i">IntPtr</span> <a id="48930b68a1e36da5" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CreateFileW</a>(
            [<span class="i">In</span>, <span class="i">MarshalAs</span>(<span class="i">UnmanagedType</span>.<span class="i">LPWStr</span>)] <b>string</b> <span id="r70 rd" class="r70 r">lpFileName</span>,
            <span class="i">UInt32</span> <span id="r71 rd" class="r71 r">dwDesiredAccess</span>,
            <span class="i">UInt32</span> <span id="r72 rd" class="r72 r">dwShareMode</span>,
            <a href="#5ff6c3ee389c8fe3" class="t t">SECURITY_ATTRIBUTES</a> <span id="r73 rd" class="r73 r">lpSecurityAttributes</span>,
            <span class="i">UInt32</span> <span id="r74 rd" class="r74 r">dwCreationDisposition</span>,
            <span class="i">UInt32</span> <span id="r75 rd" class="r75 r">dwFlagsAndAttributes</span>,
            <span class="i n">System</span>.<span class="i">IntPtr</span> <span id="r76 rd" class="r76 r">hTemplateFile</span>);
 
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
}
</pre></td></tr></table></div></body></html>
