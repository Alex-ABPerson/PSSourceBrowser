<!DOCTYPE html>
<html><head><title>StructuredTraceSource.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(1867);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/utils/StructuredTraceSource.cs" target="_top">utils\StructuredTraceSource.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<span class="k preprocess">#</span><span class="k preprocess">define</span> <span class="i">TRACE</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Specialized</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> PSTraceSourceOptions
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> These flags enable tracing based on the types of</span>
    <span class="c">///</span><span class="c"> a tracing supplied. Each type of tracing will allow</span>
    <span class="c">///</span><span class="c"> for one or more methods in the StructuredTraceSource class to become</span>
    <span class="c">///</span><span class="c"> &quot;enabled&quot;.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>public enum</b> <a id="8dccd9e1e9512b25" href="../R/8dccd9e1e9512b25.html" target="n" data-glyph="18,0" class="t t"><span id="18bc7f62c8f6b985">PSTraceSourceOptions</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All tracing off.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> No tracing is enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="a1342943109aa29f" href="../R/a1342943109aa29f.html" target="n" data-glyph="24,1" class="i field">None</a> = 0x00000000,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructors will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> The TraceConstructor methods are enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="02c38635d4d64dee" href="../R/02c38635d4d64dee.html" target="n" data-glyph="24,1" class="i field">Constructor</a> = 0x00000001,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> The TraceDispose methods are enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="bcfd51b7a80fae23" href="../R/bcfd51b7a80fae23.html" target="n" data-glyph="24,1" class="i field">Dispose</a> = 0x00000002,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Finalize will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> The TraceFinalizer methods are enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="d0f04f99a62cab23" href="../R/d0f04f99a62cab23.html" target="n" data-glyph="24,1" class="i field">Finalizer</a> = 0x00000004,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Methods will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> The TraceMethod methods are enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="325b5e4b61eeeaca" href="../R/325b5e4b61eeeaca.html" target="n" data-glyph="24,1" class="i field">Method</a> = 0x00000008,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Properties will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> The TraceProperty methods are enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="effa09b20399a9e8" href="../R/effa09b20399a9e8.html" target="n" data-glyph="24,1" class="i field">Property</a> = 0x00000010,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Delegates will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> The TraceDelegate and TraceDelegateHandler methods are enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="c9e8dfa55d700f89" href="../R/c9e8dfa55d700f89.html" target="n" data-glyph="24,1" class="i field">Delegates</a> = 0x00000020,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Events will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> The TraceRaiseEvent and TraceEventHandler methods are enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="dd73e97f908c3d98" href="../R/dd73e97f908c3d98.html" target="n" data-glyph="24,1" class="i field">Events</a> = 0x00000040,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Exceptions will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> The TraceException method is enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="6ca8cbc797ad94d6" href="../R/6ca8cbc797ad94d6.html" target="n" data-glyph="24,1" class="i field">Exception</a> = 0x00000080,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Locks will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> The TraceLock methods are enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="61ea483637ba2c35" href="../R/61ea483637ba2c35.html" target="n" data-glyph="24,1" class="i field">Lock</a> = 0x00000100,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Errors will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> The TraceError methods are enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="5688c0a7bdbce00e" href="../R/5688c0a7bdbce00e.html" target="n" data-glyph="24,1" class="i field">Error</a> = 0x00000200,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Warnings will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> The TraceWarning methods are enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="12fe4af04bf09771" href="../R/12fe4af04bf09771.html" target="n" data-glyph="24,1" class="i field">Warning</a> = 0x00000400,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verbose messages will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="4d192ae87ff42741" href="../R/4d192ae87ff42741.html" target="n" data-glyph="24,1" class="i field">Verbose</a> = 0x00000800,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> WriteLines will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
        <span class="c">///</span><span class="c"> The WriteLine methods are enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
        <a id="d9418c516f830881" href="../R/d9418c516f830881.html" target="n" data-glyph="24,1" class="i field">WriteLine</a> = 0x00001000,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TraceScope calls will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="c3fb0e2e949be167" href="../R/c3fb0e2e949be167.html" target="n" data-glyph="24,1" class="i field">Scope</a> = 0x00002000,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Assertions will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="152e48fc73adb76e" href="../R/152e48fc73adb76e.html" target="n" data-glyph="24,1" class="i field">Assert</a> = 0x00004000,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A combination of flags that trace the execution flow will</span>
        <span class="c">///</span><span class="c"> be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The methods associated with the flags; Constructor, Dispose,</span>
        <span class="c">///</span><span class="c"> Finalizer, Method, Delegates, and Events will be enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="40f88961c5700b7d" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">ExecutionFlow</a> =
            <a href="#02c38635d4d64dee" class="i field">Constructor</a> |
            <a href="#bcfd51b7a80fae23" class="i field">Dispose</a> |
            <a href="#d0f04f99a62cab23" class="i field">Finalizer</a> |
            <a href="#325b5e4b61eeeaca" class="i field">Method</a> |
            <a href="#c9e8dfa55d700f89" class="i field">Delegates</a> |
            <a href="#dd73e97f908c3d98" class="i field">Events</a> |
            <a href="#c3fb0e2e949be167" class="i field">Scope</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A combination of flags that trace the data will be traced</span>
        <span class="c">///</span><span class="c"> be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The methods associated with the flags; Constructor, Dispose,</span>
        <span class="c">///</span><span class="c"> Finalizer, Property, and WriteLine will be enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="d5ba9566a81a475f" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Data</a> =
            <a href="#02c38635d4d64dee" class="i field">Constructor</a> |
            <a href="#bcfd51b7a80fae23" class="i field">Dispose</a> |
            <a href="#d0f04f99a62cab23" class="i field">Finalizer</a> |
            <a href="#effa09b20399a9e8" class="i field">Property</a> |
            <a href="#4d192ae87ff42741" class="i field">Verbose</a> |
            <a href="#d9418c516f830881" class="i field">WriteLine</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A combination of flags that trace the errors.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The methods associated with the flags; Error,</span>
        <span class="c">///</span><span class="c"> and Exception will be enabled</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="ca15e7a2542611b9" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Errors</a> =
            <a href="#5688c0a7bdbce00e" class="i field">Error</a> |
            <a href="#6ca8cbc797ad94d6" class="i field">Exception</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All combination of trace flags will be set</span>
        <span class="c">///</span><span class="c"> be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> All methods for tracing will be enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="2d29191f68950280" href="../R/2d29191f68950280.html" target="n" data-glyph="24,1" class="i field">All</a> =
            <a href="#02c38635d4d64dee" class="i field">Constructor</a> |
            <a href="#bcfd51b7a80fae23" class="i field">Dispose</a> |
            <a href="#d0f04f99a62cab23" class="i field">Finalizer</a> |
            <a href="#325b5e4b61eeeaca" class="i field">Method</a> |
            <a href="#effa09b20399a9e8" class="i field">Property</a> |
            <a href="#c9e8dfa55d700f89" class="i field">Delegates</a> |
            <a href="#dd73e97f908c3d98" class="i field">Events</a> |
            <a href="#6ca8cbc797ad94d6" class="i field">Exception</a> |
            <a href="#5688c0a7bdbce00e" class="i field">Error</a> |
            <a href="#12fe4af04bf09771" class="i field">Warning</a> |
            <a href="#4d192ae87ff42741" class="i field">Verbose</a> |
            <a href="#61ea483637ba2c35" class="i field">Lock</a> |
            <a href="#d9418c516f830881" class="i field">WriteLine</a> |
            <a href="#c3fb0e2e949be167" class="i field">Scope</a> |
            <a href="#152e48fc73adb76e" class="i field">Assert</a>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PSTraceSourceOptions
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An PSTraceSource is a representation of a System.Diagnostics.TraceSource instance</span>
    <span class="c">///</span><span class="c"> that is used in the Monad components to produce trace output.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span>
    <span class="c">///</span><span class="c"> The StructuredTraceSource class is derived from TraceSource to provide granular</span>
    <span class="c">///</span><span class="c"> control over the tracing in a program.  An instance of StructuredTraceSource</span>
    <span class="c">///</span><span class="c"> is created for each category of tracing such that separate flags</span>
    <span class="c">///</span><span class="c"> (filters) can be set. Each flag enables one or more method for tracing.</span>
    <span class="c">///</span>
    <span class="c">///</span><span class="c"> For instance, the Exception flag will enable tracing on these methods:</span>
    <span class="c">///</span><span class="c">     TraceException.</span>
    <span class="c">///</span><span class="c"> &lt;/summary&gt;</span>
    <span class="c">///</span><span class="c"> &lt;remarks&gt;</span>
    <span class="c">///</span><span class="c"> To get an instance of this class a user should define a static</span>
    <span class="c">///</span><span class="c"> field of the type StructuredTraceSource, and assign the results of GetTracer() to it.</span>
    <span class="c">///</span><span class="c"> If the category should be automatically put in the application config file the</span>
    <span class="c">///</span><span class="c"> field should be decorated with the TraceSourceAttribute so that GenerateAppConfigFile.exe</span>
    <span class="c">///</span><span class="c"> can find it through reflection.</span>
    <span class="c">///</span><span class="c"> &lt;example&gt;</span>
    <span class="c">///</span><span class="c"> &lt;code&gt;</span>
    <span class="c">///</span><span class="c"> [TraceSourceAttribute(&quot;category&quot;, &quot;description&quot;)]</span>
    <span class="c">///</span><span class="c"> public static StructuredTraceSource tracer = GetTracer(&quot;category&quot;, &quot;description&quot;, true);</span>
    <span class="c">///</span><span class="c"> &lt;/code&gt;</span>
    <span class="c">///</span><span class="c"> &lt;/example&gt;</span>
    <span class="c">///</span><span class="c"> Other than initial creation of this class through the GetTracer method,</span>
    <span class="c">///</span><span class="c"> this class should throw no exceptions. Any call to a StructuredTraceSource method</span>
    <span class="c">///</span><span class="c"> that results in an exception being thrown will be ignored.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">--&gt;</span>
    <b>public</b> <a href="../P/6de812d1f374e1ae.html" target="s" class="k">partial</a> <b>class</b> <a id="6de812d1f374e1ae" href="../R/6de812d1f374e1ae.html" target="n" data-glyph="0,0" class="t t">PSTraceSource</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PSTraceSource construction methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor that determines the name of the trace</span>
        <span class="c">///</span><span class="c"> flag in the config file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">fullName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The full name for the trace category. This is different from the name parameter as</span>
        <span class="c">///</span><span class="c"> it is not limited to 16 characters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the category that this class</span>
        <span class="c">///</span><span class="c"> will control the tracing for. This parameter must always be 16 characters to ensure</span>
        <span class="c">///</span><span class="c"> proper formatting of the output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The description to describe what the category</span>
        <span class="c">///</span><span class="c"> is used for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">traceHeaders</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the line headers will be traced, if false, only the trace message will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="6d1285cfb983d250" href="../R/6d1285cfb983d250.html" target="n" data-glyph="74,1" class="t constructor">PSTraceSource</a>(<b>string</b> <span id="r0 rd" class="r0 r">fullName</span>, <b>string</b> <span id="r1 rd" class="r1 r">name</span>, <b>string</b> <span id="r2 rd" class="r2 r">description</span>, <b>bool</b> <span id="r3 rd" class="r3 r">traceHeaders</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r0 r">fullName</span>))
            {
                <span class="c">// 2005/04/13-JonN In theory this should be ArgumentException,</span>
                <span class="c">// but I don&#39;t want to deal with loading the string in this</span>
                <span class="c">// low-level code.</span>
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r0 r">fullName</span>));
            }
 
            <b>try</b>
            {
                <a href="#0b781ff3526050ac" class="i property">FullName</a> = <span class="r0 r">fullName</span>;
                <a href="#8be185b97c6c4e59" class="i field">_name</a> = <span class="r1 r">name</span>;
 
                <span class="c">// TODO: move this to startup json file instead of using env var</span>
                <b>string</b> <span id="r4 rd" class="r4 r">tracingEnvVar</span> = <span class="i">Environment</span>.<span class="i">GetEnvironmentVariable</span>(<span class="s">&quot;MshEnableTrace&quot;</span>);
 
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(
                        <span class="r4 r">tracingEnvVar</span>,
                        <span class="s">&quot;True&quot;</span>,
                        <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>string</b> <span id="r5 rd" class="r5 r">options</span> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="k">this</a>.<a href="#dbc95a377ad7a6b1" class="i property">TraceSource</a>.<span class="i">Attributes</span>[<span class="s">&quot;Options&quot;</span>];
                    <b>if</b> (<span class="r5 r">options</span> != <b>null</b>)
                    {
                        <a href="#7556ea80faf2b0e0" class="i field">_flags</a> = (<a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>)<span class="i">Enum</span>.<span class="i">Parse</span>(<b>typeof</b>(<a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>), <span class="r5 r">options</span>, <b>true</b>);
                    }
                }
 
                <a href="#3505964c91d1d5ab" class="i property">ShowHeaders</a> = <span class="r3 r">traceHeaders</span>;
                <a href="#93591f21a66a2e90" class="i property">Description</a> = <span class="r2 r">description</span>;
            }
            <b>catch</b> (<span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlException</span>)
            {
                <span class="c">// This exception occurs when the config</span>
                <span class="c">// file is malformed. Just default to Off.</span>
 
                <a href="#7556ea80faf2b0e0" class="i field">_flags</a> = <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>;
            }
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span>
<span class="e">            catch (System.Configuration.ConfigurationException)
            {
                // This exception occurs when the config
                // file is malformed. Just default to Off.
 
                _flags = PSTraceSourceOptions.None;
            }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
        }
 
        <b>private static bool</b> <a id="9e6b95d52dcc50f6" href="../R/9e6b95d52dcc50f6.html" target="n" data-glyph="46,1" class="i field">globalTraceInitialized</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the app domain header with information about the execution</span>
        <span class="c">///</span><span class="c"> time, the platform, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="ed454882d6d87a01" href="../R/ed454882d6d87a01.html" target="n" data-glyph="74,1" class="i method">TraceGlobalAppDomainHeader</a>()
        {
            <span class="c">// Only trace the global header if it hasn&#39;t</span>
            <span class="c">// already been traced</span>
 
            <b>if</b> (<a href="#9e6b95d52dcc50f6" class="i field">globalTraceInitialized</a>)
            {
                <b>return</b>;
            }
 
            <span class="c">// AppDomain</span>
 
            <span class="i">OutputLine</span>(
                <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#2d29191f68950280" class="i field">All</a>,
                <span class="s">&quot;Initializing tracing for AppDomain: {0}&quot;</span>,
                <span class="i">AppDomain</span>.<span class="i">CurrentDomain</span>.<span class="i">FriendlyName</span>);
 
            <span class="c">// Current time</span>
 
            <span class="i">OutputLine</span>(
                <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#2d29191f68950280" class="i field">All</a>,
                <span class="s">&quot;\tCurrent time: {0}&quot;</span>,
                <span class="i">DateTime</span>.<span class="i">Now</span>.<span class="i">ToString</span>());
 
            <span class="c">// OS build</span>
 
            <span class="i">OutputLine</span>(
                <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#2d29191f68950280" class="i field">All</a>,
                <span class="s">&quot;\tOS Build: {0}&quot;</span>,
                <span class="i">Environment</span>.<span class="i">OSVersion</span>.<span class="i">ToString</span>());
 
            <span class="c">// .NET Framework version</span>
 
            <span class="i">OutputLine</span>(
                <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#2d29191f68950280" class="i field">All</a>,
                <span class="s">&quot;\tFramework Build: {0}\n&quot;</span>,
                <span class="i">Environment</span>.<span class="i">Version</span>.<span class="i">ToString</span>());
 
            <span class="c">// Mark that we have traced the global header</span>
 
            <a href="#9e6b95d52dcc50f6" class="i field">globalTraceInitialized</a> = <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Outputs a header when a new StructuredTraceSource object is created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r6 r">callingAssembly</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The assembly that created the instance of the StructuredTraceSource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A header will be output that contains information such as;</span>
        <span class="c">///</span><span class="c"> the category and description of the new trace object,</span>
        <span class="c">///</span><span class="c"> the assembly in which the new trace object</span>
        <span class="c">///</span><span class="c"> will be stored.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="d6326b3a344c5805" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">TracerObjectHeader</a>(
            <span class="i">Assembly</span> <span id="r6 rd" class="r6 r">callingAssembly</span>)
        {
            <b>if</b> (<a href="#7556ea80faf2b0e0" class="i field">_flags</a> == <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <b>return</b>;
            }
 
            <span class="c">// Write the header for the new trace object</span>
 
            <a href="#a8a6ad8d244ca888" class="i method">OutputLine</a>(<a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#2d29191f68950280" class="i field">All</a>, <span class="s">&quot;Creating tracer:&quot;</span>);
 
            <span class="c">// Category</span>
 
            <a href="#a8a6ad8d244ca888" class="i method">OutputLine</a>(
                <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#2d29191f68950280" class="i field">All</a>,
                <span class="s">&quot;\tCategory: {0}&quot;</span>,
                <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="k">this</a>.<a href="#37a68a19537ce71f" class="i property">Name</a>);
 
            <span class="c">// Description</span>
 
            <a href="#a8a6ad8d244ca888" class="i method">OutputLine</a>(
                <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#2d29191f68950280" class="i field">All</a>,
                <span class="s">&quot;\tDescription: {0}&quot;</span>,
                <a href="#93591f21a66a2e90" class="i property">Description</a>);
 
            <b>if</b> (<span class="r6 r">callingAssembly</span> != <b>null</b>)
            {
                <span class="c">// Assembly name</span>
 
                <span class="i">OutputLine</span>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#2d29191f68950280" class="i field">All</a>,
                    <span class="s">&quot;\tAssembly: {0}&quot;</span>,
                    <span class="r6 r">callingAssembly</span>.<span class="i">FullName</span>);
 
                <span class="c">// Assembly location</span>
 
                <span class="i">OutputLine</span>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#2d29191f68950280" class="i field">All</a>,
                    <span class="s">&quot;\tAssembly Location: {0}&quot;</span>,
                    <span class="r6 r">callingAssembly</span>.<span class="i">Location</span>);
 
                <span class="c">// Assembly File timestamp</span>
 
                <span class="i">FileInfo</span> <span id="r7 rd" class="r7 r">assemblyFileInfo</span> =
                    <b>new</b> <span class="i">FileInfo</span>(<span class="r6 r">callingAssembly</span>.<span class="i">Location</span>);
 
                <span class="i">OutputLine</span>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#2d29191f68950280" class="i field">All</a>,
                    <span class="s">&quot;\tAssembly File Timestamp: {0}&quot;</span>,
                    <span class="r7 r">assemblyFileInfo</span>.<span class="i">CreationTime</span>.<span class="i">ToString</span>());
            }
 
            <span class="i">StringBuilder</span> <span id="r8 rd" class="r8 r">flagBuilder</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <span class="c">// Label</span>
 
            <span class="r8 r">flagBuilder</span>.<span class="i">Append</span>(<span class="s">&quot;\tFlags: &quot;</span>);
            <span class="r8 r">flagBuilder</span>.<span class="i">Append</span>(<a href="#7556ea80faf2b0e0" class="i field">_flags</a>.<span class="i">ToString</span>());
 
            <span class="c">// Write out the flags</span>
 
            <span class="i">OutputLine</span>(<a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#2d29191f68950280" class="i field">All</a>, <span class="r8 r">flagBuilder</span>.<span class="i">ToString</span>());
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> StructuredTraceSource constructor methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PSTraceSourceOptions.Scope
 
        <b>internal</b> <span class="i">IDisposable</span> <a id="19ce116f88d7b1c7" href="../R/19ce116f88d7b1c7.html" target="n" data-glyph="74,1" class="i method">TraceScope</a>(<b>string</b> <span id="r9 rd" class="r9 r">msg</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#c3fb0e2e949be167" class="i field">Scope</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <b>try</b>
                {
                    <b>return</b> <b>new</b> <span class="t">ScopeTracer</span>(<a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="k">this</a>, <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#c3fb0e2e949be167" class="i field">Scope</a>, <b>null</b>, <b>null</b>, <b>string</b>.<span class="i">Empty</span>, <span class="r9 r">msg</span>);
                }
                <b>catch</b> { }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal</b> <span class="i">IDisposable</span> <a id="ff5e86462c8f4f03" href="../R/ff5e86462c8f4f03.html" target="n" data-glyph="74,1" class="i method">TraceScope</a>(<b>string</b> <span id="r10 rd" class="r10 r">format</span>, <b>object</b> <span id="r11 rd" class="r11 r">arg1</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#c3fb0e2e949be167" class="i field">Scope</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <b>try</b>
                {
                    <b>return</b> <b>new</b> <span class="t">ScopeTracer</span>(<a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="k">this</a>, <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#c3fb0e2e949be167" class="i field">Scope</a>, <b>null</b>, <b>null</b>, <b>string</b>.<span class="i">Empty</span>, <span class="r10 r">format</span>, <span class="r11 r">arg1</span>);
                }
                <b>catch</b> { }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal</b> <span class="i">IDisposable</span> <a id="3e3de94a643f35de" href="../R/3e3de94a643f35de.html" target="n" data-glyph="74,1" class="i method">TraceScope</a>(<b>string</b> <span id="r12 rd" class="r12 r">format</span>, <b>object</b> <span id="r13 rd" class="r13 r">arg1</span>, <b>object</b> <span id="r14 rd" class="r14 r">arg2</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#c3fb0e2e949be167" class="i field">Scope</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <b>try</b>
                {
                    <b>return</b> <b>new</b> <span class="t">ScopeTracer</span>(<a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="k">this</a>, <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#c3fb0e2e949be167" class="i field">Scope</a>, <b>null</b>, <b>null</b>, <b>string</b>.<span class="i">Empty</span>, <span class="r12 r">format</span>, <span class="r13 r">arg1</span>, <span class="r14 r">arg2</span>);
                }
                <b>catch</b> { }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PSTraceSourceOptions.Scope
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PSTraceSourceOptions.Method methods/helpers
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the method name and indents the trace output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The format string for additional arguments to be traced</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The additional arguments given to the format string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object that supports IDisposable. The caller</span>
        <span class="c">///</span><span class="c"> should dispose of the object when it goes out of</span>
        <span class="c">///</span><span class="c"> scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">newpara</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> public void MethodName(int count)</span>
        <span class="c">///</span><span class="c"> {</span>
        <span class="c">///</span><span class="c">     using (TraceMethod(</span>
        <span class="c">///</span><span class="c">                &quot;count={0:d}&quot;,</span>
        <span class="c">///</span><span class="c">                count))</span>
        <span class="c">///</span><span class="c">     {</span>
        <span class="c">///</span><span class="c">         // do something here...</span>
        <span class="c">///</span><span class="c">     }</span>
        <span class="c">///</span><span class="c"> }</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">newpara</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> This will produce output similar to the following:</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">newpara</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> Entering MethodName: count=4</span>
        <span class="c">///</span><span class="c">     other trace output indented</span>
        <span class="c">///</span><span class="c"> Leaving MethodName</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IDisposable</span> <a id="1d6ac2f38dece154" href="../R/1d6ac2f38dece154.html" target="n" data-glyph="74,1" class="i method">TraceMethod</a>(
            <b>string</b> <span id="r15 rd" class="r15 r">format</span>,
            <b>params object</b>[] <span id="r16 rd" class="r16 r">args</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#325b5e4b61eeeaca" class="i field">Method</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <b>try</b>
                {
                    <span class="c">// Get the name of the method that called this method</span>
                    <span class="c">// 1, signifies the caller of this method, whereas 2</span>
                    <span class="c">// would signify the caller of that method.</span>
 
                    <b>string</b> <span id="r17 rd" class="r17 r">methodName</span> = <a href="#a3ea494512502250" class="i method">GetCallingMethodNameAndParameters</a>(1);
 
                    <span class="c">// Create the method tracer object</span>
                    <b>return</b> (<span class="i">IDisposable</span>)<b>new</b> <a href="#e0006fd0d020fbf2" class="t constructor">ScopeTracer</a>(
                        <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="k">this</a>,
                        <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#325b5e4b61eeeaca" class="i field">Method</a>,
                        <a href="#0306a45a8aa86896" class="i field">methodOutputFormatter</a>,
                        <a href="#c5daf6c6a1d591c3" class="i field">methodLeavingFormatter</a>,
                        <span class="r17 r">methodName</span>,
                        <span class="r15 r">format</span>,
                        <span class="r16 r">args</span>);
                }
                <b>catch</b>
                {
                    <span class="c">// Eat all exceptions</span>
 
                    <span class="c">// Do not assert here because exceptions can be</span>
                    <span class="c">// raised while a thread is shutting down during</span>
                    <span class="c">// normal operation.</span>
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PSTraceSourceOptions.Method methods/helpers
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PSTraceSourceOptions.Events methods/helpers
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the entrance and exit from event handlers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object that supports IDisposable. The caller</span>
        <span class="c">///</span><span class="c"> should dispose of the object when it goes out of</span>
        <span class="c">///</span><span class="c"> scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IDisposable</span> <a id="a7463a7f51bc0952" href="../R/a7463a7f51bc0952.html" target="n" data-glyph="74,1" class="i method">TraceEventHandlers</a>()
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#dd73e97f908c3d98" class="i field">Events</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <b>try</b>
                {
                    <span class="c">// Get the name of the method that called this method</span>
                    <span class="c">// 1, signifies the caller of this method, whereas 2</span>
                    <span class="c">// would signify the caller of that method.</span>
 
                    <b>string</b> <span id="r18 rd" class="r18 r">methodName</span> = <a href="#a3ea494512502250" class="i method">GetCallingMethodNameAndParameters</a>(1);
 
                    <span class="c">// Create the scope tracer object</span>
                    <b>return</b> (<span class="i">IDisposable</span>)<b>new</b> <span class="t">ScopeTracer</span>(
                        <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="k">this</a>,
                        <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#dd73e97f908c3d98" class="i field">Events</a>,
                        <a href="#bc90bc6c9f00bbd5" class="i field">eventHandlerOutputFormatter</a>,
                        <a href="#ff2960cc31c9dd90" class="i field">eventHandlerLeavingFormatter</a>,
                        <span class="r18 r">methodName</span>,
                        <b>string</b>.<span class="i">Empty</span>);
                }
                <b>catch</b>
                {
                    <span class="c">// Eat all exceptions</span>
 
                    <span class="c">// Do not assert here because exceptions can be</span>
                    <span class="c">// raised while a thread is shutting down during</span>
                    <span class="c">// normal operation.</span>
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the entrance and exit from event handlers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The format string for additional arguments to be traced</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The additional arguments given to the format string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object that supports IDisposable. The caller</span>
        <span class="c">///</span><span class="c"> should dispose of the object when it goes out of</span>
        <span class="c">///</span><span class="c"> scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IDisposable</span> <a id="e07d3807737169a7" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">TraceEventHandlers</a>(
            <b>string</b> <span id="r19 rd" class="r19 r">format</span>,
            <b>params object</b>[] <span id="r20 rd" class="r20 r">args</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#dd73e97f908c3d98" class="i field">Events</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <b>try</b>
                {
                    <span class="c">// Get the name of the method that called this method</span>
                    <span class="c">// 1, signifies the caller of this method, whereas 2</span>
                    <span class="c">// would signify the caller of that method.</span>
 
                    <b>string</b> <span id="r21 rd" class="r21 r">methodName</span> = <a href="#a3ea494512502250" class="i method">GetCallingMethodNameAndParameters</a>(1);
 
                    <span class="c">// Create the scope tracer object</span>
                    <b>return</b> (<span class="i">IDisposable</span>)<b>new</b> <a href="#e0006fd0d020fbf2" class="t constructor">ScopeTracer</a>(
                        <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="k">this</a>,
                        <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#dd73e97f908c3d98" class="i field">Events</a>,
                        <a href="#bc90bc6c9f00bbd5" class="i field">eventHandlerOutputFormatter</a>,
                        <a href="#ff2960cc31c9dd90" class="i field">eventHandlerLeavingFormatter</a>,
                        <span class="r21 r">methodName</span>,
                        <span class="r19 r">format</span>,
                        <span class="r20 r">args</span>);
                }
                <b>catch</b>
                {
                    <span class="c">// Eat all exceptions</span>
 
                    <span class="c">// Do not assert here because exceptions can be</span>
                    <span class="c">// raised while a thread is shutting down during</span>
                    <span class="c">// normal operation.</span>
                }
            }
 
            <b>return</b> <b>null</b>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PSTraceSourceOptions.Events methods/helpers
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PSTraceSourceOptions.Lock methods/helpers
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the user specified lock name and indents the trace output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> An object that supports IDisposable. The caller</span>
        <span class="c">///</span><span class="c"> should dispose of the object when it goes out of</span>
        <span class="c">///</span><span class="c"> scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">newpara</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> public void MethodName()</span>
        <span class="c">///</span><span class="c"> {</span>
        <span class="c">///</span><span class="c">     lock (this)</span>
        <span class="c">///</span><span class="c">     {</span>
        <span class="c">///</span><span class="c">         using (TraceLock(&quot;my lock name&quot;))</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             // do something here...</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     }</span>
        <span class="c">///</span><span class="c"> }</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">example</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">newpara</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> This will produce output similar to the following:</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">newpara</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> Entering Lock: my lock name</span>
        <span class="c">///</span><span class="c">     other trace output indented</span>
        <span class="c">///</span><span class="c"> Leaving Lock: my lock name</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">IDisposable</span> <a id="fb71011369303699" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">TraceLock</a>(<b>string</b> <span id="r22 rd" class="r22 r">lockName</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#61ea483637ba2c35" class="i field">Lock</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <b>try</b>
                {
                    <b>return</b> (<span class="i">IDisposable</span>)<b>new</b> <a href="#cd97f77013034e9b" class="t constructor">ScopeTracer</a>(
                        <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="k">this</a>,
                        <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#61ea483637ba2c35" class="i field">Lock</a>,
                        <a href="#14570ab55c1b0caa" class="i field">lockEnterFormatter</a>,
                        <a href="#c897079a4a5187dc" class="i field">lockLeavingFormatter</a>,
                        <span class="r22 r">lockName</span>);
                }
                <b>catch</b>
                {
                    <span class="c">// Eat all exceptions</span>
 
                    <span class="c">// Do not assert here because exceptions can be</span>
                    <span class="c">// raised while a thread is shutting down during</span>
                    <span class="c">// normal operation.</span>
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Call this before acquiring a lock.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">lockName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User defined name given to the lock</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="3ec6ebad5d334f72" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">TraceLockAcquiring</a>(<b>string</b> <span id="r23 rd" class="r23 r">lockName</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#61ea483637ba2c35" class="i field">Lock</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#6197bed9cbd9f582" class="i method">TraceLockHelper</a>(
                    <a href="#0a501f355c737d48" class="i field">lockAcquiringFormatter</a>,
                    <span class="r23 r">lockName</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Call this after acquiring a lock.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">lockName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User defined name given to the lock</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Use this only if the TraceLock that returns</span>
        <span class="c">///</span><span class="c"> an IDisposable won&#39;t work in your situation.</span>
        <span class="c">///</span><span class="c"> You will not get automatic indentation or</span>
        <span class="c">///</span><span class="c"> release tracing of the lock.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="7432ae58e364a663" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">TraceLockAcquired</a>(<b>string</b> <span id="r24 rd" class="r24 r">lockName</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#61ea483637ba2c35" class="i field">Lock</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#6197bed9cbd9f582" class="i method">TraceLockHelper</a>(
                    <a href="#14570ab55c1b0caa" class="i field">lockEnterFormatter</a>,
                    <span class="r24 r">lockName</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Call this after releasing the lock, but only</span>
        <span class="c">///</span><span class="c"> if you called TraceLockAcquired when you acquired</span>
        <span class="c">///</span><span class="c"> the lock.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">lockName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User defined name given to the lock</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="90af995e7abb1623" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">TraceLockReleased</a>(<b>string</b> <span id="r25 rd" class="r25 r">lockName</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#61ea483637ba2c35" class="i field">Lock</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#6197bed9cbd9f582" class="i method">TraceLockHelper</a>(
                    <a href="#c897079a4a5187dc" class="i field">lockLeavingFormatter</a>,
                    <span class="r25 r">lockName</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A helper to simplify tracing of the lock flags.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">formatter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A format string for the output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">lockName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> User defined name for the lock</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="6197bed9cbd9f582" href="../R/6197bed9cbd9f582.html" target="n" data-glyph="76,1" class="i method">TraceLockHelper</a>(
            <b>string</b> <span id="r26 rd" class="r26 r">formatter</span>,
            <b>string</b> <span id="r27 rd" class="r27 r">lockName</span>)
        {
            <b>try</b>
            {
                <a href="#a8a6ad8d244ca888" class="i method">OutputLine</a>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#61ea483637ba2c35" class="i field">Lock</a>,
                    <span class="r26 r">formatter</span>,
                    <span class="r27 r">lockName</span>);
            }
            <b>catch</b>
            {
                <span class="c">// Eat all exceptions</span>
 
                <span class="c">// Do not assert here because exceptions can be</span>
                <span class="c">// raised while a thread is shutting down during</span>
                <span class="c">// normal operation.</span>
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PSTraceSourceOptions.Lock methods/helpers
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> PSTraceSourceOptions.Error,Warning,Normal methods/helpers
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the specified formatted output when PSTraceSourceOptions.Error</span>
        <span class="c">///</span><span class="c"> is enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">errorMessageFormat</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The format string containing the error message</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The arguments for the format string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="e7dd110db4bf902f" href="../R/e7dd110db4bf902f.html" target="n" data-glyph="74,1" class="i method">TraceError</a>(
            <b>string</b> <span id="r28 rd" class="r28 r">errorMessageFormat</span>,
            <b>params object</b>[] <span id="r29 rd" class="r29 r">args</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#5688c0a7bdbce00e" class="i field">Error</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#b03b2680b2c568da" class="i method">FormatOutputLine</a>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#5688c0a7bdbce00e" class="i field">Error</a>,
                    <a href="#db999dc4781ca486" class="i field">errorFormatter</a>,
                    <span class="r28 r">errorMessageFormat</span>,
                    <span class="r29 r">args</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the specified formatted output when PSTraceSourceOptions.Warning</span>
        <span class="c">///</span><span class="c"> is enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">warningMessageFormat</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The format string containing the error message</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The arguments for the format string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="906bc47eb55bba45" href="../R/906bc47eb55bba45.html" target="n" data-glyph="74,1" class="i method">TraceWarning</a>(
            <b>string</b> <span id="r30 rd" class="r30 r">warningMessageFormat</span>,
            <b>params object</b>[] <span id="r31 rd" class="r31 r">args</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#12fe4af04bf09771" class="i field">Warning</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#b03b2680b2c568da" class="i method">FormatOutputLine</a>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#12fe4af04bf09771" class="i field">Warning</a>,
                    <a href="#25dfb5a99c2e7d20" class="i field">warningFormatter</a>,
                    <span class="r30 r">warningMessageFormat</span>,
                    <span class="r31 r">args</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the specified formatted output when PSTraceSourceOptions.Verbose</span>
        <span class="c">///</span><span class="c"> is enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">verboseMessageFormat</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The format string containing the error message</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The arguments for the format string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="cf267013ec23d9d4" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">TraceVerbose</a>(
            <b>string</b> <span id="r32 rd" class="r32 r">verboseMessageFormat</span>,
            <b>params object</b>[] <span id="r33 rd" class="r33 r">args</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#4d192ae87ff42741" class="i field">Verbose</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#b03b2680b2c568da" class="i method">FormatOutputLine</a>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#4d192ae87ff42741" class="i field">Verbose</a>,
                    <a href="#87d2fe3028f7a823" class="i field">verboseFormatter</a>,
                    <span class="r32 r">verboseMessageFormat</span>,
                    <span class="r33 r">args</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the formatted output when PSTraceSourceOptions.WriteLine is enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The format string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="96aaf3813a5962a0" href="../R/96aaf3813a5962a0.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r34 rd" class="r34 r">format</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <span class="i">FormatOutputLine</span>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>,
                    <a href="#149dca6a18490c3a" class="i field">writeLineFormatter</a>,
                    <span class="r34 r">format</span>,
                    <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>object</b>&gt;());
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the formatted output when PSTraceSourceOptions.WriteLine is enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">arg1</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="25b8416175e53218" href="../R/25b8416175e53218.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r35 rd" class="r35 r">format</span>, <b>object</b> <span id="r36 rd" class="r36 r">arg1</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#b03b2680b2c568da" class="i method">FormatOutputLine</a>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>,
                    <a href="#149dca6a18490c3a" class="i field">writeLineFormatter</a>,
                    <span class="r35 r">format</span>,
                    <b>new</b> <b>object</b>[] { <span class="r36 r">arg1</span> });
            }
        }
 
        <b>internal void</b> <a id="451d38bf8c2b6b94" href="../R/451d38bf8c2b6b94.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r37 rd" class="r37 r">format</span>, <b>bool</b> <span id="r38 rd" class="r38 r">arg1</span>)
        {
            <a href="#25b8416175e53218" class="i method">WriteLine</a>(<span class="r37 r">format</span>, (<b>object</b>)<span class="r38 r">arg1</span>.<span class="i">ToString</span>());
        }
 
        <b>internal void</b> <a id="49f0bb7865376566" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r39 rd" class="r39 r">format</span>, <b>byte</b> <span id="r40 rd" class="r40 r">arg1</span>)
        {
            <a href="#25b8416175e53218" class="i method">WriteLine</a>(<span class="r39 r">format</span>, (<b>object</b>)<span class="r40 r">arg1</span>.<span class="i">ToString</span>());
        }
 
        <b>internal void</b> <a id="fece962953f4ef04" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r41 rd" class="r41 r">format</span>, <b>char</b> <span id="r42 rd" class="r42 r">arg1</span>)
        {
            <a href="#25b8416175e53218" class="i method">WriteLine</a>(<span class="r41 r">format</span>, (<b>object</b>)<span class="r42 r">arg1</span>.<span class="i">ToString</span>());
        }
 
        <b>internal void</b> <a id="6bdf75abf2bdf7d6" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r43 rd" class="r43 r">format</span>, <b>decimal</b> <span id="r44 rd" class="r44 r">arg1</span>)
        {
            <a href="#25b8416175e53218" class="i method">WriteLine</a>(<span class="r43 r">format</span>, (<b>object</b>)<span class="r44 r">arg1</span>.<span class="i">ToString</span>());
        }
 
        <b>internal void</b> <a id="221660839ce9ed76" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r45 rd" class="r45 r">format</span>, <b>double</b> <span id="r46 rd" class="r46 r">arg1</span>)
        {
            <a href="#25b8416175e53218" class="i method">WriteLine</a>(<span class="r45 r">format</span>, (<b>object</b>)<span class="r46 r">arg1</span>.<span class="i">ToString</span>());
        }
 
        <b>internal void</b> <a id="06b1b393b411f880" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r47 rd" class="r47 r">format</span>, <b>float</b> <span id="r48 rd" class="r48 r">arg1</span>)
        {
            <a href="#25b8416175e53218" class="i method">WriteLine</a>(<span class="r47 r">format</span>, (<b>object</b>)<span class="r48 r">arg1</span>.<span class="i">ToString</span>());
        }
 
        <b>internal void</b> <a id="70ee671c8687bfbd" href="../R/70ee671c8687bfbd.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r49 rd" class="r49 r">format</span>, <b>int</b> <span id="r50 rd" class="r50 r">arg1</span>)
        {
            <a href="#25b8416175e53218" class="i method">WriteLine</a>(<span class="r49 r">format</span>, (<b>object</b>)<span class="r50 r">arg1</span>.<span class="i">ToString</span>());
        }
 
        <b>internal void</b> <a id="25fe29b46cfb1e10" href="../R/25fe29b46cfb1e10.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r51 rd" class="r51 r">format</span>, <b>long</b> <span id="r52 rd" class="r52 r">arg1</span>)
        {
            <a href="#25b8416175e53218" class="i method">WriteLine</a>(<span class="r51 r">format</span>, (<b>object</b>)<span class="r52 r">arg1</span>.<span class="i">ToString</span>());
        }
 
        <b>internal void</b> <a id="450049cb38b7dbe6" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r53 rd" class="r53 r">format</span>, <b>uint</b> <span id="r54 rd" class="r54 r">arg1</span>)
        {
            <a href="#25b8416175e53218" class="i method">WriteLine</a>(<span class="r53 r">format</span>, (<b>object</b>)<span class="r54 r">arg1</span>.<span class="i">ToString</span>());
        }
 
        <b>internal void</b> <a id="c5442600dfd58959" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r55 rd" class="r55 r">format</span>, <b>ulong</b> <span id="r56 rd" class="r56 r">arg1</span>)
        {
            <a href="#25b8416175e53218" class="i method">WriteLine</a>(<span class="r55 r">format</span>, (<b>object</b>)<span class="r56 r">arg1</span>.<span class="i">ToString</span>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the formatted output when PSTraceSourceOptions.WriteLine is enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">arg1</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">arg2</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="49bf988885074437" href="../R/49bf988885074437.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r57 rd" class="r57 r">format</span>, <b>object</b> <span id="r58 rd" class="r58 r">arg1</span>, <b>object</b> <span id="r59 rd" class="r59 r">arg2</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#b03b2680b2c568da" class="i method">FormatOutputLine</a>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>,
                    <a href="#149dca6a18490c3a" class="i field">writeLineFormatter</a>,
                    <span class="r57 r">format</span>,
                    <b>new</b> <b>object</b>[] { <span class="r58 r">arg1</span>, <span class="r59 r">arg2</span> });
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the formatted output when PSTraceSourceOptions.WriteLine is enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">arg1</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">arg2</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">arg3</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="ea4adc43a7440f6a" href="../R/ea4adc43a7440f6a.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r60 rd" class="r60 r">format</span>, <b>object</b> <span id="r61 rd" class="r61 r">arg1</span>, <b>object</b> <span id="r62 rd" class="r62 r">arg2</span>, <b>object</b> <span id="r63 rd" class="r63 r">arg3</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#b03b2680b2c568da" class="i method">FormatOutputLine</a>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>,
                    <a href="#149dca6a18490c3a" class="i field">writeLineFormatter</a>,
                    <span class="r60 r">format</span>,
                    <b>new</b> <b>object</b>[] { <span class="r61 r">arg1</span>, <span class="r62 r">arg2</span>, <span class="r63 r">arg3</span> });
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the formatted output when PSTraceSourceOptions.WriteLine is enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r64 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">arg1</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">arg2</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">arg3</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">arg4</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="5880fe7f3ce30da9" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r64 rd" class="r64 r">format</span>, <b>object</b> <span id="r65 rd" class="r65 r">arg1</span>, <b>object</b> <span id="r66 rd" class="r66 r">arg2</span>, <b>object</b> <span id="r67 rd" class="r67 r">arg3</span>, <b>object</b> <span id="r68 rd" class="r68 r">arg4</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#b03b2680b2c568da" class="i method">FormatOutputLine</a>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>,
                    <a href="#149dca6a18490c3a" class="i field">writeLineFormatter</a>,
                    <span class="r64 r">format</span>,
                    <b>new</b> <b>object</b>[] { <span class="r65 r">arg1</span>, <span class="r66 r">arg2</span>, <span class="r67 r">arg3</span>, <span class="r68 r">arg4</span> });
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the formatted output when PSTraceSourceOptions.WriteLine is enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">arg1</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">arg2</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">arg3</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">arg4</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r74 r">arg5</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="65416c22f3c31d4d" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r69 rd" class="r69 r">format</span>, <b>object</b> <span id="r70 rd" class="r70 r">arg1</span>, <b>object</b> <span id="r71 rd" class="r71 r">arg2</span>, <b>object</b> <span id="r72 rd" class="r72 r">arg3</span>, <b>object</b> <span id="r73 rd" class="r73 r">arg4</span>, <b>object</b> <span id="r74 rd" class="r74 r">arg5</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#b03b2680b2c568da" class="i method">FormatOutputLine</a>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>,
                    <a href="#149dca6a18490c3a" class="i field">writeLineFormatter</a>,
                    <span class="r69 r">format</span>,
                    <b>new</b> <b>object</b>[] { <span class="r70 r">arg1</span>, <span class="r71 r">arg2</span>, <span class="r72 r">arg3</span>, <span class="r73 r">arg4</span>, <span class="r74 r">arg5</span> });
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the formatted output when PSTraceSourceOptions.WriteLine is enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The format string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">arg1</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">arg2</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">arg3</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r79 r">arg4</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">arg5</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r81 r">arg6</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="65cd385f1f8f0f53" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>string</b> <span id="r75 rd" class="r75 r">format</span>, <b>object</b> <span id="r76 rd" class="r76 r">arg1</span>, <b>object</b> <span id="r77 rd" class="r77 r">arg2</span>, <b>object</b> <span id="r78 rd" class="r78 r">arg3</span>, <b>object</b> <span id="r79 rd" class="r79 r">arg4</span>, <b>object</b> <span id="r80 rd" class="r80 r">arg5</span>, <b>object</b> <span id="r81 rd" class="r81 r">arg6</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#b03b2680b2c568da" class="i method">FormatOutputLine</a>(
                    <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>,
                    <a href="#149dca6a18490c3a" class="i field">writeLineFormatter</a>,
                    <span class="r75 r">format</span>,
                    <b>new</b> <b>object</b>[] { <span class="r76 r">arg1</span>, <span class="r77 r">arg2</span>, <span class="r78 r">arg3</span>, <span class="r79 r">arg4</span>, <span class="r80 r">arg5</span>, <span class="r81 r">arg6</span> });
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Traces the formatted output when PSTraceSourceOptions.WriteLine is enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">arg</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The object to be output</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="5c57ca4b1b173c42" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">WriteLine</a>(<b>object</b> <span id="r82 rd" class="r82 r">arg</span>)
        {
            <b>if</b> ((<a href="#7556ea80faf2b0e0" class="i field">_flags</a> &amp; <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#d9418c516f830881" class="i field">WriteLine</a>) != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>)
            {
                <a href="#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;{0}&quot;</span>, <span class="r82 r">arg</span> == <b>null</b> ? <span class="s">&quot;null&quot;</span> : <span class="r82 r">arg</span>.<span class="i">ToString</span>());
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Formats the specified text and then traces it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">flag</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The flag that met the criteria to have this line traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">classFormatter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the trace class formatter. For instance,</span>
        <span class="c">///</span><span class="c"> TraceError has a formatter like &quot;ERROR: {0}&quot;.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r85 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Additional format string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Arguments for the additional format string</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b03b2680b2c568da" href="../R/b03b2680b2c568da.html" target="n" data-glyph="76,1" class="i method">FormatOutputLine</a>(
            <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a> <span id="r83 rd" class="r83 r">flag</span>,
            <b>string</b> <span id="r84 rd" class="r84 r">classFormatter</span>,
            <b>string</b> <span id="r85 rd" class="r85 r">format</span>,
            <b>params object</b>[] <span id="r86 rd" class="r86 r">args</span>)
        {
            <b>try</b>
            {
                <span class="c">// First format the class format string and the</span>
                <span class="c">// user provided format string together</span>
                <span class="i">StringBuilder</span> <span id="r87 rd" class="r87 r">output</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
                <b>if</b> (<span class="r84 r">classFormatter</span> != <b>null</b>)
                {
                    <span class="r87 r">output</span>.<span class="i">Append</span>(<span class="r84 r">classFormatter</span>);
                }
 
                <b>if</b> (<span class="r85 r">format</span> != <b>null</b>)
                {
                    <span class="r87 r">output</span>.<span class="i">AppendFormat</span>(
                        <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                        <span class="r85 r">format</span>,
                        <span class="r86 r">args</span>);
                }
 
                <span class="c">// finally trace the output</span>
                <span class="i">OutputLine</span>(<span class="r83 r">flag</span>, <span class="r87 r">output</span>.<span class="i">ToString</span>());
            }
            <b>catch</b>
            {
                <span class="c">// Eat all exceptions</span>
                <span class="c">//</span>
                <span class="c">// Do not assert here because exceptions can be</span>
                <span class="c">// raised while a thread is shutting down during</span>
                <span class="c">// normal operation.</span>
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> PSTraceSourceOptions.Error methods/helpers
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Class helper methods and properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the method name of the method that called this one</span>
        <span class="c">///</span><span class="c"> plus the skipFrames.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For instance, GetCallingMethodNameAndParameters(1)</span>
        <span class="c">///</span><span class="c"> will return the method that called the method that is calling</span>
        <span class="c">///</span><span class="c"> GetCallingMethodNameAndParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r88 r">skipFrames</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The number of frames to skip in the calling stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the method on the stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="a3ea494512502250" href="../R/a3ea494512502250.html" target="n" data-glyph="76,1" class="i method">GetCallingMethodNameAndParameters</a>(<b>int</b> <span id="r88 rd" class="r88 r">skipFrames</span>)
        {
            <span class="i">StringBuilder</span> <span id="r89 rd" class="r89 r">methodAndParameters</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="c">// Use the stack to get the method and type information</span>
                <span class="c">// for the calling method</span>
 
                <span class="i">StackFrame</span> <span id="r90 rd" class="r90 r">stackFrame</span> = <b>new</b> <span class="i">StackFrame</span>(++<span class="r88 r">skipFrames</span>);
                <span class="i">MethodBase</span> <span id="r91 rd" class="r91 r">callingMethod</span> = <span class="r90 r">stackFrame</span>.<span class="i">GetMethod</span>();
 
                <span class="i">Type</span> <span id="r92 rd" class="r92 r">declaringType</span> = <span class="r91 r">callingMethod</span>.<span class="i">DeclaringType</span>;
 
                <span class="c">// Append the class name and method name together</span>
 
                <span class="r89 r">methodAndParameters</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
                <span class="c">// Note: don&#39;t use the FullName for the declaringType</span>
                <span class="c">// as it is usually way too long and makes the trace</span>
                <span class="c">// output hard to read.</span>
 
                <span class="r89 r">methodAndParameters</span>.<span class="i">AppendFormat</span>(
                    <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                    <span class="s">&quot;{0}.{1}(&quot;</span>,
                    <span class="r92 r">declaringType</span>.<span class="i">Name</span>,
                    <span class="r91 r">callingMethod</span>.<span class="i">Name</span>);
 
                <span class="r89 r">methodAndParameters</span>.<span class="i">Append</span>(<span class="s">&#39;)&#39;</span>);
            }
            <b>catch</b>
            {
                <span class="c">// Eat all exceptions</span>
 
                <span class="c">// Do not assert here because exceptions can be</span>
                <span class="c">// raised while a thread is shutting down during</span>
                <span class="c">// normal operation.</span>
            }
 
            <b>return</b> <span class="r89 r">methodAndParameters</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">// The default formatter for TraceError</span>
        <b>private const string</b> <a id="db999dc4781ca486" href="../R/db999dc4781ca486.html" target="n" data-glyph="10,1" class="i field">errorFormatter</a> =
            <span class="s">&quot;ERROR: &quot;</span>;
 
        <span class="c">// The default formatter for TraceWarning</span>
        <b>private const string</b> <a id="25dfb5a99c2e7d20" href="../R/25dfb5a99c2e7d20.html" target="n" data-glyph="10,1" class="i field">warningFormatter</a> =
            <span class="s">&quot;Warning: &quot;</span>;
 
        <span class="c">// The default formatter for TraceVerbose</span>
        <b>private const string</b> <a id="87d2fe3028f7a823" href="../R/87d2fe3028f7a823.html" target="n" data-glyph="10,1" class="i field">verboseFormatter</a> =
            <span class="s">&quot;Verbose: &quot;</span>;
 
        <span class="c">// The default formatter for WriteLine</span>
        <b>private const string</b> <a id="149dca6a18490c3a" href="../R/149dca6a18490c3a.html" target="n" data-glyph="10,1" class="i field">writeLineFormatter</a> =
            <span class="s">&quot;&quot;</span>;
 
        <span class="c">// The default formatter for TraceConstructor</span>
 
        <b>private const string</b> <a id="e1c43e5d750042ce" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">constructorOutputFormatter</a> =
            <span class="s">&quot;Enter Ctor {0}&quot;</span>;
 
        <b>private const string</b> <a id="d90d69ccb868f714" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">constructorLeavingFormatter</a> =
            <span class="s">&quot;Leave Ctor {0}&quot;</span>;
 
        <span class="c">// The default formatter for TraceDispose</span>
 
        <b>private const string</b> <a id="2cc4f46dd42c6bca" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">disposeOutputFormatter</a> =
            <span class="s">&quot;Enter Disposer {0}&quot;</span>;
 
        <b>private const string</b> <a id="105e0733ce7db802" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">disposeLeavingFormatter</a> =
            <span class="s">&quot;Leave Disposer {0}&quot;</span>;
 
        <span class="c">// The default formatter for TraceMethod</span>
 
        <b>private const string</b> <a id="0306a45a8aa86896" href="../R/0306a45a8aa86896.html" target="n" data-glyph="10,1" class="i field">methodOutputFormatter</a> =
            <span class="s">&quot;Enter {0}:&quot;</span>;
 
        <b>private const string</b> <a id="c5daf6c6a1d591c3" href="../R/c5daf6c6a1d591c3.html" target="n" data-glyph="10,1" class="i field">methodLeavingFormatter</a> =
            <span class="s">&quot;Leave {0}&quot;</span>;
 
        <span class="c">// The default formatter for TraceProperty</span>
 
        <b>private const string</b> <a id="500ca7f6bc591220" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">propertyOutputFormatter</a> =
            <span class="s">&quot;Enter property {0}:&quot;</span>;
 
        <b>private const string</b> <a id="97ff9b73c7416b04" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">propertyLeavingFormatter</a> =
            <span class="s">&quot;Leave property {0}&quot;</span>;
 
        <span class="c">// The default formatter for TraceDelegateHandler</span>
 
        <b>private const string</b> <a id="9b1d1cdfce170a6e" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">delegateHandlerOutputFormatter</a> =
            <span class="s">&quot;Enter delegate handler: {0}:&quot;</span>;
 
        <b>private const string</b> <a id="376a8a7a95000997" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">delegateHandlerLeavingFormatter</a> =
            <span class="s">&quot;Leave delegate handler: {0}&quot;</span>;
 
        <span class="c">// The default formatter for TraceEventHandlers</span>
 
        <b>private const string</b> <a id="bc90bc6c9f00bbd5" href="../R/bc90bc6c9f00bbd5.html" target="n" data-glyph="10,1" class="i field">eventHandlerOutputFormatter</a> =
            <span class="s">&quot;Enter event handler: {0}:&quot;</span>;
 
        <b>private const string</b> <a id="ff2960cc31c9dd90" href="../R/ff2960cc31c9dd90.html" target="n" data-glyph="10,1" class="i field">eventHandlerLeavingFormatter</a> =
            <span class="s">&quot;Leave event handler: {0}&quot;</span>;
 
        <span class="c">// The default formatters for TraceException</span>
 
        <b>private const string</b> <a id="79aa3d9cc0dd3524" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">exceptionOutputFormatter</a> =
            <span class="s">&quot;{0}: {1}\n{2}&quot;</span>;
 
        <b>private const string</b> <a id="aafd133eb4e2e64d" href="../R/../../0000000000.html" target="n" data-glyph="10,1" class="i field">innermostExceptionOutputFormatter</a> =
            <span class="s">&quot;Inner-most {0}: {1}\n{2}&quot;</span>;
 
        <span class="c">// The default formatters for TraceLock</span>
 
        <b>private const string</b> <a id="14570ab55c1b0caa" href="../R/14570ab55c1b0caa.html" target="n" data-glyph="10,1" class="i field">lockEnterFormatter</a> =
            <span class="s">&quot;Enter Lock: {0}&quot;</span>;
 
        <b>private const string</b> <a id="c897079a4a5187dc" href="../R/c897079a4a5187dc.html" target="n" data-glyph="10,1" class="i field">lockLeavingFormatter</a> =
            <span class="s">&quot;Leave Lock: {0}&quot;</span>;
 
        <b>private const string</b> <a id="0a501f355c737d48" href="../R/0a501f355c737d48.html" target="n" data-glyph="10,1" class="i field">lockAcquiringFormatter</a> =
            <span class="s">&quot;Acquiring Lock: {0}&quot;</span>;
 
        <b>private static</b> <span class="i">StringBuilder</span> <a id="a7d0d775e4069eab" href="../R/a7d0d775e4069eab.html" target="n" data-glyph="76,1" class="i method">GetLinePrefix</a>(<a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a> <span id="r93 rd" class="r93 r">flag</span>)
        {
            <span class="i">StringBuilder</span> <span id="r94 rd" class="r94 r">prefixBuilder</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <span class="c">// Add the flag that caused this line to be traced</span>
 
            <span class="r94 r">prefixBuilder</span>.<span class="i">AppendFormat</span>(
                <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                <span class="s">&quot; {0,-11} &quot;</span>,
                <span class="i">Enum</span>.<span class="i">GetName</span>(<b>typeof</b>(<a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>), <span class="r93 r">flag</span>));
            <b>return</b> <span class="r94 r">prefixBuilder</span>;
        }
 
        <b>private static void</b> <a id="ce9454293ea8bc98" href="../R/ce9454293ea8bc98.html" target="n" data-glyph="76,1" class="i method">AddTab</a>(<span class="i">StringBuilder</span> <span id="r95 rd" class="r95 r">lineBuilder</span>)
        {
            <span class="c">// The Trace.IndentSize does not change at all</span>
            <span class="c">// through the running of the process so there</span>
            <span class="c">// are no thread issues here.</span>
            <b>int</b> <span id="r96 rd" class="r96 r">indentSize</span> = <span class="i">Trace</span>.<span class="i">IndentSize</span>;
            <b>int</b> <span id="r97 rd" class="r97 r">threadIndentLevel</span> = <a href="#5f7c8aa98369dc20" class="i property">ThreadIndentLevel</a>;
 
            <span class="r95 r">lineBuilder</span>.<span class="i">Append</span>(<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>.<a href="StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Padding</span>(<span class="r96 r">indentSize</span> * <span class="r97 r">threadIndentLevel</span>));
        }
 
        <span class="c">// used to find and blocks cyclic-loops in tracing.</span>
 
        <b>private bool</b> <a id="6751ee1173385511" href="../R/6751ee1173385511.html" target="n" data-glyph="46,1" class="i field">_alreadyTracing</a> = <b>false</b>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Composes a line of trace output and then writes it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">flag</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The flag that caused the line to be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The string to write with format symbols if necessary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">arg</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Arguments to the format string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The line is composed by prefixing the process name, thread ID,</span>
        <span class="c">///</span><span class="c"> and tick count. Then the indenting is added. Then the</span>
        <span class="c">///</span><span class="c"> specified string is formatted. Finally the finished string</span>
        <span class="c">///</span><span class="c"> is output using the Trace class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="a8a6ad8d244ca888" href="../R/a8a6ad8d244ca888.html" target="n" data-glyph="74,1" class="i method">OutputLine</a>(
            <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a> <span id="r98 rd" class="r98 r">flag</span>,
            <b>string</b> <span id="r99 rd" class="r99 r">format</span>,
            <b>string</b> <span id="r100 rd" class="r100 r">arg</span> = <b>null</b>)
        {
            <span class="c">// if already tracing something for this current TraceSource,</span>
            <span class="c">// dont trace again. This will block cyclic-loops from happening.</span>
            <b>if</b> (<a href="#6751ee1173385511" class="i field">_alreadyTracing</a>)
            {
                <b>return</b>;
            }
 
            <a href="#6751ee1173385511" class="i field">_alreadyTracing</a> = <b>true</b>;
            <b>try</b>
            {
                <a href="assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                    <span class="r99 r">format</span> != <b>null</b>,
                    <span class="s">&quot;The format string should not be null&quot;</span>);
 
                <span class="i">StringBuilder</span> <span id="r101 rd" class="r101 r">lineBuilder</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
                <b>if</b> (<a href="#3505964c91d1d5ab" class="i property">ShowHeaders</a>)
                {
                    <span class="c">// Get the line prefix string which includes things</span>
                    <span class="c">// like App name, clock tick, thread ID, etc.</span>
                    <span class="r101 r">lineBuilder</span>.<span class="i">Append</span>(<a href="#a7d0d775e4069eab" class="i method">GetLinePrefix</a>(<span class="r98 r">flag</span>));
                }
 
                <span class="c">// Add the spaces for the indent</span>
                <a href="#ce9454293ea8bc98" class="i method">AddTab</a>(<span class="r101 r">lineBuilder</span>);
 
                <b>if</b> (<span class="r100 r">arg</span> != <b>null</b>)
                {
                    <span class="r101 r">lineBuilder</span>.<span class="i">AppendFormat</span>(
                        <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                        <span class="r99 r">format</span>,
                        <span class="r100 r">arg</span>);
                }
                <b>else</b>
                {
                    <span class="r101 r">lineBuilder</span>.<span class="i">Append</span>(<span class="r99 r">format</span>);
                }
 
                <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="k">this</a>.<a href="#dbc95a377ad7a6b1" class="i property">TraceSource</a>.<span class="i">TraceInformation</span>(<span class="r101 r">lineBuilder</span>.<span class="i">ToString</span>());
            }
            <b>finally</b>
            {
                <span class="c">// reset tracing for the current trace source..</span>
                <span class="c">// so future traces can go through.</span>
                <a href="#6751ee1173385511" class="i field">_alreadyTracing</a> = <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Property to access the indent level in thread local storage.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static int</b> <a id="5f7c8aa98369dc20" href="../R/5f7c8aa98369dc20.html" target="n" data-glyph="104,1" class="i property">ThreadIndentLevel</a>
        {
            <b>get</b>
            {
                <span class="c">// The first time access the ThreadLocal instance, the default int value will be used</span>
                <span class="c">// to initialize the instance. The default int value is 0.</span>
                <b>return</b> <a href="#c6c659eeef520fdf" class="i field">s_localIndentLevel</a>.<span class="i">Value</span>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> &gt;= 0)
                {
                    <span class="c">// Set the new indent level in thread local storage</span>
                    <a href="#c6c659eeef520fdf" class="i field">s_localIndentLevel</a>.<span class="i">Value</span> = <b>value</b>;
                }
                <b>else</b>
                {
                    <a href="assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>value</b> &gt;= 0, <span class="s">&quot;The indention value cannot be less than zero&quot;</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Allocates some thread local storage to hold the indent level.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">ThreadLocal</span>&lt;<b>int</b>&gt; <a id="c6c659eeef520fdf" href="../R/c6c659eeef520fdf.html" target="n" data-glyph="46,1" class="i field">s_localIndentLevel</a> = <b>new</b> <span class="i">ThreadLocal</span>&lt;<b>int</b>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Local storage for the trace switch flags.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a> <a id="7556ea80faf2b0e0" href="../R/7556ea80faf2b0e0.html" target="n" data-glyph="46,1" class="i field">_flags</a> = <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the description for this trace sources.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="93591f21a66a2e90" href="../R/93591f21a66a2e90.html" target="n" data-glyph="102,1" class="i property">Description</a> { <b>get</b>; <b>set</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the line and switch headers should be shown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="3505964c91d1d5ab" href="../R/3505964c91d1d5ab.html" target="n" data-glyph="104,1" class="i property">ShowHeaders</a> { <b>get</b>; <b>set</b>; } = <b>true</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the full name of the trace source category.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="0b781ff3526050ac" href="../R/0b781ff3526050ac.html" target="n" data-glyph="104,1" class="i property">FullName</a> { <b>get</b>; } = <b>string</b>.<span class="i">Empty</span>;
 
        <b>private readonly string</b> <a id="8be185b97c6c4e59" href="../R/8be185b97c6c4e59.html" target="n" data-glyph="46,1" class="i field">_name</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of the TraceSource on demand.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">TraceSource</span> <a id="dbc95a377ad7a6b1" href="../R/dbc95a377ad7a6b1.html" target="n" data-glyph="104,1" class="i property">TraceSource</a>
        {
            <b>get</b> { <b>return</b> <a href="#6a1f981f363372d4" class="i field">_traceSource</a> ??= <b>new</b> <a href="#fcf540629eb4bf30" class="t constructor">MonadTraceSource</a>(<a href="#8be185b97c6c4e59" class="i field">_name</a>); }
        }
 
        <b>private</b> <span class="i">TraceSource</span> <a id="6a1f981f363372d4" href="../R/6a1f981f363372d4.html" target="n" data-glyph="46,1" class="i field">_traceSource</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Class helper methods and properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the options for what will be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a> <a id="39a46fbab64bf75b" href="../R/39a46fbab64bf75b.html" target="n" data-glyph="102,1" class="i property">Options</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#7556ea80faf2b0e0" class="i field">_flags</a>;
            }
 
            <b>set</b>
            {
                <a href="#7556ea80faf2b0e0" class="i field">_flags</a> = <b>value</b>;
                <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="k">this</a>.<a href="#dbc95a377ad7a6b1" class="i property">TraceSource</a>.<span class="i">Switch</span>.<span class="i">Level</span> = (<span class="i">SourceLevels</span>)<a href="#7556ea80faf2b0e0" class="i field">_flags</a>;
            }
        }
 
        <b>internal bool</b> <a id="f5f0092873f47fa1" href="../R/f5f0092873f47fa1.html" target="n" data-glyph="104,1" class="i property">IsEnabled</a>
        {
            <b>get</b> { <b>return</b> <a href="#7556ea80faf2b0e0" class="i field">_flags</a> != <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a>.<a href="#a1342943109aa29f" class="i field">None</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the attributes of the TraceSource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">StringDictionary</span> <a id="fdbfd80f17593364" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Attributes</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#dbc95a377ad7a6b1" class="i property">TraceSource</a>.<span class="i">Attributes</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the listeners for the TraceSource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">TraceListenerCollection</span> <a id="3f62365c6014f09a" href="../R/3f62365c6014f09a.html" target="n" data-glyph="102,1" class="i property">Listeners</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#dbc95a377ad7a6b1" class="i property">TraceSource</a>.<span class="i">Listeners</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the TraceSource name (also known as category).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Note, this name is truncated to 16 characters due to limitations</span>
        <span class="c">///</span><span class="c"> in the TraceSource class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public string</b> <a id="37a68a19537ce71f" href="../R/37a68a19537ce71f.html" target="n" data-glyph="102,1" class="i property">Name</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#8be185b97c6c4e59" class="i field">_name</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the TraceSource&#39;s Switch.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">SourceSwitch</span> <a id="a595a9ea879ebb23" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Switch</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#dbc95a377ad7a6b1" class="i property">TraceSource</a>.<span class="i">Switch</span>;
            }
 
            <b>set</b>
            {
                <a href="#dbc95a377ad7a6b1" class="i property">TraceSource</a>.<span class="i">Switch</span> = <b>value</b>;
            }
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> TraceCatalog
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Storage for all the PSTraceSource instances.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>&gt; <a id="eaec56a0bff15c85" href="../R/eaec56a0bff15c85.html" target="n" data-glyph="104,1" class="i property">TraceCatalog</a> { <b>get</b>; } = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Storage for trace source instances which have not been instantiated but for which</span>
        <span class="c">///</span><span class="c"> the user has specified Options.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> If the PSTraceSource cannot be found in the TraceCatalog, the same name is used</span>
        <span class="c">///</span><span class="c"> to look in this dictionary to see if the PSTraceSource has been pre-configured.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>&gt; <a id="3296472fb9393bab" href="../R/3296472fb9393bab.html" target="n" data-glyph="104,1" class="i property">PreConfiguredTraceSource</a> { <b>get</b>; } = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> TraceCatalog
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> ScopeTracer object/helpers
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A light-weight object to manage the indention of</span>
    <span class="c">///</span><span class="c"> trace output for each thread.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> An instance of this object is returned when any scoping</span>
    <span class="c">///</span><span class="c"> Trace method (like TraceMethod, TraceProperty, etc.)</span>
    <span class="c">///</span><span class="c"> is called. In the constructor to the object the indention</span>
    <span class="c">///</span><span class="c"> level for the thread is incremented.</span>
    <span class="c">///</span><span class="c"> The Dispose method will decrement the thread indent level.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="aeb53002f652aca4" href="../R/aeb53002f652aca4.html" target="n" data-glyph="2,0" class="t t">ScopeTracer</a> : <span class="i">IDisposable</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor that traces the scope name</span>
        <span class="c">///</span><span class="c"> and raises the indent level in thread</span>
        <span class="c">///</span><span class="c"> local storage.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r102 r">tracer</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The trace object that is to be used for output</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">flag</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSTraceSourceOptions that is causing the scope object to</span>
        <span class="c">///</span><span class="c"> be created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">scopeOutputFormatter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This format string is used to determine the</span>
        <span class="c">///</span><span class="c"> general output format for the scope. For instance,</span>
        <span class="c">///</span><span class="c"> TraceMethod would probably provide a formatter similar</span>
        <span class="c">///</span><span class="c"> to &quot;Entering: {0}: {1}&quot; where {0} is the name of the</span>
        <span class="c">///</span><span class="c"> method and {1} is the additional formatted info provided.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r105 r">leavingScopeFormatter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The format string used to determine the general output</span>
        <span class="c">///</span><span class="c"> format for the scope when the Dispose method is called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r106 r">scopeName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the scope that is being traced</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="cd97f77013034e9b" href="../R/cd97f77013034e9b.html" target="n" data-glyph="74,1" class="t constructor">ScopeTracer</a>(
            <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <span id="r102 rd" class="r102 r">tracer</span>,
            <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a> <span id="r103 rd" class="r103 r">flag</span>,
            <b>string</b> <span id="r104 rd" class="r104 r">scopeOutputFormatter</span>,
            <b>string</b> <span id="r105 rd" class="r105 r">leavingScopeFormatter</span>,
            <b>string</b> <span id="r106 rd" class="r106 r">scopeName</span>)
        {
            <a href="#dbec93b56e404c4e" class="i field">_tracer</a> = <span class="r102 r">tracer</span>;
 
            <span class="c">// Call the helper</span>
 
            <span class="i">ScopeTracerHelper</span>(
                <span class="r103 r">flag</span>,
                <span class="r104 r">scopeOutputFormatter</span>,
                <span class="r105 r">leavingScopeFormatter</span>,
                <span class="r106 r">scopeName</span>,
                <b>string</b>.<span class="i">Empty</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor that traces the scope name</span>
        <span class="c">///</span><span class="c"> and raises the indent level in thread</span>
        <span class="c">///</span><span class="c"> local storage.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r107 r">tracer</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The trace object that is to be used for output</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r108 r">flag</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The PSTraceSourceOptions that is causing the scope object to</span>
        <span class="c">///</span><span class="c"> be created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r109 r">scopeOutputFormatter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This format string is used to determine the</span>
        <span class="c">///</span><span class="c"> general output format for the scope. For instance,</span>
        <span class="c">///</span><span class="c"> TraceMethod would probably provide a formatter similar</span>
        <span class="c">///</span><span class="c"> to &quot;Entering: {0}: {1}&quot; where {0} is the name of the</span>
        <span class="c">///</span><span class="c"> method and {1} is the additional formatted info provided.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">leavingScopeFormatter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The format string used to determine the general output</span>
        <span class="c">///</span><span class="c"> format for the scope when the Dispose method is called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">scopeName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the scope that is being traced</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The format of any additional arguments which will be appended</span>
        <span class="c">///</span><span class="c"> to the line of trace output</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Arguments to the format string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="e0006fd0d020fbf2" href="../R/e0006fd0d020fbf2.html" target="n" data-glyph="74,1" class="t constructor">ScopeTracer</a>(
            <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <span id="r107 rd" class="r107 r">tracer</span>,
            <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a> <span id="r108 rd" class="r108 r">flag</span>,
            <b>string</b> <span id="r109 rd" class="r109 r">scopeOutputFormatter</span>,
            <b>string</b> <span id="r110 rd" class="r110 r">leavingScopeFormatter</span>,
            <b>string</b> <span id="r111 rd" class="r111 r">scopeName</span>,
            <b>string</b> <span id="r112 rd" class="r112 r">format</span>,
            <b>params object</b>[] <span id="r113 rd" class="r113 r">args</span>)
        {
            <a href="#dbec93b56e404c4e" class="i field">_tracer</a> = <span class="r107 r">tracer</span>;
 
            <span class="c">// Call the helper</span>
 
            <b>if</b> (<span class="r112 r">format</span> != <b>null</b>)
            {
                <a href="#ec85c0cf8e1983ff" class="i method">ScopeTracerHelper</a>(
                    <span class="r108 r">flag</span>,
                    <span class="r109 r">scopeOutputFormatter</span>,
                    <span class="r110 r">leavingScopeFormatter</span>,
                    <span class="r111 r">scopeName</span>,
                    <span class="r112 r">format</span>,
                    <span class="r113 r">args</span>);
            }
            <b>else</b>
            {
                <span class="i">ScopeTracerHelper</span>(
                    <span class="r108 r">flag</span>,
                    <span class="r109 r">scopeOutputFormatter</span>,
                    <span class="r110 r">leavingScopeFormatter</span>,
                    <span class="r111 r">scopeName</span>,
                    <b>string</b>.<span class="i">Empty</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper for the ScopeTracer constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r114 r">flag</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The flag that caused this line of tracing to be traced.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r115 r">scopeOutputFormatter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This format string is used to determine the</span>
        <span class="c">///</span><span class="c"> general output format for the scope. For instance,</span>
        <span class="c">///</span><span class="c"> TraceMethod would probably provide a formatter similar</span>
        <span class="c">///</span><span class="c"> to &quot;Entering: {0}: {1}&quot; where {0} is the name of the</span>
        <span class="c">///</span><span class="c"> method and {1} is the additional formatted info provided.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r116 r">leavingScopeFormatter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The format string used to determine the general output</span>
        <span class="c">///</span><span class="c"> format for the scope when the Dispose method is called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">scopeName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the scope being entered</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The format of any additional arguments which will be appended</span>
        <span class="c">///</span><span class="c"> to the &quot;Entering&quot; line of trace output</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r119 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Arguments to the format string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="ec85c0cf8e1983ff" href="../R/ec85c0cf8e1983ff.html" target="n" data-glyph="74,1" class="i method">ScopeTracerHelper</a>(
            <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a> <span id="r114 rd" class="r114 r">flag</span>,
            <b>string</b> <span id="r115 rd" class="r115 r">scopeOutputFormatter</span>,
            <b>string</b> <span id="r116 rd" class="r116 r">leavingScopeFormatter</span>,
            <b>string</b> <span id="r117 rd" class="r117 r">scopeName</span>,
            <b>string</b> <span id="r118 rd" class="r118 r">format</span>,
            <b>params object</b>[] <span id="r119 rd" class="r119 r">args</span>)
        {
            <span class="c">// Store the flags, scopeName, and the leavingScopeFormatter</span>
            <span class="c">// so that it can be used in the Dispose method</span>
 
            <a href="#f48b6b6196ea24bc" class="i field">_flag</a> = <span class="r114 r">flag</span>;
            <a href="#802fc76d4f4e0fe6" class="i field">_scopeName</a> = <span class="r117 r">scopeName</span>;
            <a href="#4fe76ff92f35d954" class="i field">_leavingScopeFormatter</a> = <span class="r116 r">leavingScopeFormatter</span>;
 
            <span class="c">// Format the string for output</span>
 
            <span class="i">StringBuilder</span> <span id="r120 rd" class="r120 r">output</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r115 r">scopeOutputFormatter</span>))
            {
                <span class="r120 r">output</span>.<span class="i">AppendFormat</span>(
                    <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                    <span class="r115 r">scopeOutputFormatter</span>,
                    <a href="#802fc76d4f4e0fe6" class="i field">_scopeName</a>);
            }
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r118 r">format</span>))
            {
                <span class="r120 r">output</span>.<span class="i">AppendFormat</span>(
                    <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                    <span class="r118 r">format</span>,
                    <span class="r119 r">args</span>);
            }
 
            <span class="c">// Now write the trace</span>
 
            <a href="#dbec93b56e404c4e" class="i field">_tracer</a>.<span class="i">OutputLine</span>(<a href="#f48b6b6196ea24bc" class="i field">_flag</a>, <span class="r120 r">output</span>.<span class="i">ToString</span>());
 
            <span class="c">// Increment the current thread indent level</span>
 
            <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="#5f7c8aa98369dc20" class="i property">ThreadIndentLevel</a>++;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Decrements the indent level in thread local</span>
        <span class="c">///</span><span class="c"> storage and then traces the scope name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="ca3cb10625b042ff" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <span class="c">// Decrement the indent level in thread local storage</span>
 
            <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="#5f7c8aa98369dc20" class="i property">ThreadIndentLevel</a>--;
 
            <span class="c">// Trace out the scope name</span>
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#4fe76ff92f35d954" class="i field">_leavingScopeFormatter</a>))
            {
                <a href="#dbec93b56e404c4e" class="i field">_tracer</a>.<a href="#a8a6ad8d244ca888" class="i method">OutputLine</a>(<a href="#f48b6b6196ea24bc" class="i field">_flag</a>, <a href="#4fe76ff92f35d954" class="i field">_leavingScopeFormatter</a>, <a href="#802fc76d4f4e0fe6" class="i field">_scopeName</a>);
            }
 
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#aeb53002f652aca4" class="k">this</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The trace object that is used for any output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="dbec93b56e404c4e" href="../R/dbec93b56e404c4e.html" target="n" data-glyph="46,1" class="i field">_tracer</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The flag which caused this scope object to be created.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#8dccd9e1e9512b25" class="t t">PSTraceSourceOptions</a> <a id="f48b6b6196ea24bc" href="../R/f48b6b6196ea24bc.html" target="n" data-glyph="46,1" class="i field">_flag</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stores the scope name that is passed to the constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="802fc76d4f4e0fe6" href="../R/802fc76d4f4e0fe6.html" target="n" data-glyph="46,1" class="i field">_scopeName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stores the format string used when formatting output when</span>
        <span class="c">///</span><span class="c"> leaving the scope.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private string</b> <a id="4fe76ff92f35d954" href="../R/4fe76ff92f35d954.html" target="n" data-glyph="46,1" class="i field">_leavingScopeFormatter</a>;
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ScopeTracer object/helpers
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> PSTraceSourceAttribute
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This attribute is placed on the field of the PSTraceSource class</span>
    <span class="c">///</span><span class="c"> in the class that is consuming the tracing methods defined in</span>
    <span class="c">///</span><span class="c"> this file. It defines the trace category and description</span>
    <span class="c">///</span><span class="c"> for that instance of PSTraceSource.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This attribute is only allowed on fields and there can only</span>
    <span class="c">///</span><span class="c"> be one for each instance. Only one instance of this attribute</span>
    <span class="c">///</span><span class="c"> should be used in any one class.</span>
    <span class="c">///</span><span class="c"> In order for the attribute to be used to help in constructing</span>
    <span class="c">///</span><span class="c"> the PSTraceSource object, reflection is used to find the field</span>
    <span class="c">///</span><span class="c"> that the PSTraceSource object will be assigned to. This attribute</span>
    <span class="c">///</span><span class="c"> declares the category and description for the PSTraceSource object</span>
    <span class="c">///</span><span class="c"> in that field.  Having multiple instances of this attribute on</span>
    <span class="c">///</span><span class="c"> multiple fields in the same class will cause unexpected results.</span>
    <span class="c">///</span><span class="c"> For instance, trace output for one category may actually be</span>
    <span class="c">///</span><span class="c"> considered part of another category.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    [<span class="i">AttributeUsage</span>(
         <span class="i">AttributeTargets</span>.<span class="i">Field</span>,
         <span class="i">AllowMultiple</span> = <b>false</b>)]
    <b>internal class</b> <a id="a70dffb4f279d33c" href="../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t">TraceSourceAttribute</a> : <span class="i">Attribute</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for the TraceSourceAttribute class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r121 r">category</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the category for which the TraceSource instance</span>
        <span class="c">///</span><span class="c"> will be used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r122 r">description</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A description for the category.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="6d570ba753de90a5" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">TraceSourceAttribute</a>(
            <b>string</b> <span id="r121 rd" class="r121 r">category</span>,
            <b>string</b> <span id="r122 rd" class="r122 r">description</span>)
        {
            <a href="#dc0cee67adc3ac26" class="i property">Category</a> = <span class="r121 r">category</span>;
            <a href="#44ff46d03667b1d8" class="i property">Description</a> = <span class="r122 r">description</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The category to be used for the TraceSource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="dc0cee67adc3ac26" href="../R/dc0cee67adc3ac26.html" target="n" data-glyph="104,1" class="i property">Category</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The description for the category to be used for the TraceSource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="44ff46d03667b1d8" href="../R/44ff46d03667b1d8.html" target="n" data-glyph="104,1" class="i property">Description</a> { <b>get</b>; <b>set</b>; }
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> TraceSourceAttribute
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> MonadTraceSource
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This derived class of TraceSource is required so that we can tell</span>
    <span class="c">///</span><span class="c"> the configuration infrastructure which attributes are supported in</span>
    <span class="c">///</span><span class="c"> the XML app-config file for our trace source.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="7ed77244980bfe01" href="../R/7ed77244980bfe01.html" target="n" data-glyph="2,0" class="t t">MonadTraceSource</a> : <span class="i">TraceSource</span>
    {
        <b>internal</b> <a id="fcf540629eb4bf30" href="../R/fcf540629eb4bf30.html" target="n" data-glyph="74,1" class="t constructor">MonadTraceSource</a>(<b>string</b> <span id="r123 rd" class="r123 r">name</span>)
            : <b>base</b>(<span class="r123 r">name</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Tells the config infrastructure which attributes are supported</span>
        <span class="c">///</span><span class="c"> for our TraceSource.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A string array with the names of the attributes supported by our</span>
        <span class="c">///</span><span class="c"> trace source.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected override string</b>[] <a id="911ad196183b7e9f" href="../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">GetSupportedAttributes</a>()
        {
            <b>return</b> <b>new</b> <b>string</b>[] { <span class="s">&quot;Options&quot;</span> };
        }
    }
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> MonadTraceSource
}
</pre></td></tr></table></div></body></html>
