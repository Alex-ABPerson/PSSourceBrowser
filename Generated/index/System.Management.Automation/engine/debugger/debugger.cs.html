<!DOCTYPE html>
<html><head><title>debugger.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(5919);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/debugger/debugger.cs" target="_top">engine\debugger\debugger.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Concurrent</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">RegularExpressions</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Event Args
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Possible actions for the debugger after hitting a breakpoint/step.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="470618169485a70e" href="../../R/470618169485a70e.html" target="n" data-glyph="18,0" class="t t"><span id="e01b103e5003bf49">DebuggerResumeAction</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Continue running until the next breakpoint, or the end of the script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="c35cb32c2ab7ed0d" href="../../R/c35cb32c2ab7ed0d.html" target="n" data-glyph="24,1" class="i field">Continue</a> = 0,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Step to next statement, going into functions, scripts, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="422455533b156acf" href="../../R/422455533b156acf.html" target="n" data-glyph="24,1" class="i field">StepInto</a> = 1,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Step to next statement, going over functions, scripts, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="4cfb4add3c03409c" href="../../R/4cfb4add3c03409c.html" target="n" data-glyph="24,1" class="i field">StepOut</a> = 2,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Step to next statement after the current function, script, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="de21a4b4866a13cc" href="../../R/de21a4b4866a13cc.html" target="n" data-glyph="24,1" class="i field">StepOver</a> = 3,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stop executing the script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9c143ec10eabd6ad" href="../../R/9c143ec10eabd6ad.html" target="n" data-glyph="24,1" class="i field">Stop</a> = 4,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Arguments for the DebuggerStop event.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="13c865e6481e16a2" href="../../R/13c865e6481e16a2.html" target="n" data-glyph="0,0" class="t t">DebuggerStopEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes the DebuggerStopEventArgs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="a1b1943d925894a6" href="../../R/a1b1943d925894a6.html" target="n" data-glyph="74,1" class="t constructor">DebuggerStopEventArgs</a>(<a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r0 rd" class="r0 r">invocationInfo</span>, <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r1 rd" class="r1 r">breakpoints</span>)
        {
            <a href="#13c865e6481e16a2" class="k">this</a>.<a href="#bf5b2fd8de78c287" class="i property">InvocationInfo</a> = <span class="r0 r">invocationInfo</span>;
            <a href="#13c865e6481e16a2" class="k">this</a>.<a href="#745a4c67d985896b" class="i property">Breakpoints</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;(<span class="r1 r">breakpoints</span>);
            <a href="#13c865e6481e16a2" class="k">this</a>.<a href="#b6941352f3c2c41c" class="i property">ResumeAction</a> = <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">invocationInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">breakpoints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">resumeAction</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="7ac766b9a835f3a6" href="../../R/7ac766b9a835f3a6.html" target="n" data-glyph="72,1" class="t constructor">DebuggerStopEventArgs</a>(
            <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r2 rd" class="r2 r">invocationInfo</span>,
            <span class="i">Collection</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r3 rd" class="r3 r">breakpoints</span>,
            <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a> <span id="r4 rd" class="r4 r">resumeAction</span>)
        {
            <a href="#13c865e6481e16a2" class="k">this</a>.<a href="#bf5b2fd8de78c287" class="i property">InvocationInfo</a> = <span class="r2 r">invocationInfo</span>;
            <a href="#13c865e6481e16a2" class="k">this</a>.<a href="#745a4c67d985896b" class="i property">Breakpoints</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;(<span class="r3 r">breakpoints</span>);
            <a href="#13c865e6481e16a2" class="k">this</a>.<a href="#b6941352f3c2c41c" class="i property">ResumeAction</a> = <span class="r4 r">resumeAction</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invocation info of the code being executed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="bf5b2fd8de78c287" href="../../R/bf5b2fd8de78c287.html" target="n" data-glyph="102,1" class="i property">InvocationInfo</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The breakpoint(s) hit.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Note there may be more than one breakpoint on the same object (line, variable, command). A single event is</span>
        <span class="c">///</span><span class="c"> raised for all these breakpoints.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <a id="745a4c67d985896b" href="../../R/745a4c67d985896b.html" target="n" data-glyph="102,1" class="i property">Breakpoints</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property must be set in the event handler to indicate the debugger what it should do next.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The default action is DebuggerAction.Continue.</span>
        <span class="c">///</span><span class="c"> DebuggerAction.StepToLine is only valid when debugging an script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a> <a id="b6941352f3c2c41c" href="../../R/b6941352f3c2c41c.html" target="n" data-glyph="102,1" class="i property">ResumeAction</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This property is used internally for remote debug stops only.  It is used to signal the remote debugger proxy</span>
        <span class="c">///</span><span class="c"> that it should *not* send a resume action to the remote debugger.  This is used by runspace debug processing to</span>
        <span class="c">///</span><span class="c"> leave pending runspace debug sessions suspended until a debugger is attached.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="9ff6d82303db72dc" href="../../R/9ff6d82303db72dc.html" target="n" data-glyph="104,1" class="i property">SuspendRemote</a> { <b>get</b>; <b>set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Kinds of breakpoint updates.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="7f495a71915b9312" href="../../R/7f495a71915b9312.html" target="n" data-glyph="18,0" class="t t"><span id="d6bbc6c05501f8af">BreakpointUpdateType</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A breakpoint was set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="215e5f765054ee2a" href="../../R/215e5f765054ee2a.html" target="n" data-glyph="24,1" class="i field">Set</a> = 0,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A breakpoint was removed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="81437d00b4c290a8" href="../../R/81437d00b4c290a8.html" target="n" data-glyph="24,1" class="i field">Removed</a> = 1,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A breakpoint was enabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="a771ce8c028969fd" href="../../R/a771ce8c028969fd.html" target="n" data-glyph="24,1" class="i field">Enabled</a> = 2,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A breakpoint was disabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="7cd364741b9d73c6" href="../../R/7cd364741b9d73c6.html" target="n" data-glyph="24,1" class="i field">Disabled</a> = 3
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Arguments for the BreakpointUpdated event.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="6136821c0d0fb181" href="../../R/6136821c0d0fb181.html" target="n" data-glyph="0,0" class="t t">BreakpointUpdatedEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes the BreakpointUpdatedEventArgs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a id="af659be6c5f84358" href="../../R/af659be6c5f84358.html" target="n" data-glyph="74,1" class="t constructor">BreakpointUpdatedEventArgs</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r5 rd" class="r5 r">breakpoint</span>, <a href="#7f495a71915b9312" class="t t">BreakpointUpdateType</a> <span id="r6 rd" class="r6 r">updateType</span>, <b>int</b> <span id="r7 rd" class="r7 r">breakpointCount</span>)
        {
            <a href="#6136821c0d0fb181" class="k">this</a>.<a href="#c4d1730394edec74" class="i property">Breakpoint</a> = <span class="r5 r">breakpoint</span>;
            <a href="#6136821c0d0fb181" class="k">this</a>.<a href="#be64f20bf5a5c957" class="i property">UpdateType</a> = <span class="r6 r">updateType</span>;
            <a href="#6136821c0d0fb181" class="k">this</a>.<a href="#da3e4072e44924a9" class="i property">BreakpointCount</a> = <span class="r7 r">breakpointCount</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the breakpoint that was updated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="c4d1730394edec74" href="../../R/c4d1730394edec74.html" target="n" data-glyph="102,1" class="i property">Breakpoint</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the type of update.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#7f495a71915b9312" class="t t">BreakpointUpdateType</a> <a id="be64f20bf5a5c957" href="../../R/be64f20bf5a5c957.html" target="n" data-glyph="102,1" class="i property">UpdateType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the current breakpoint count.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="da3e4072e44924a9" href="../../R/da3e4072e44924a9.html" target="n" data-glyph="102,1" class="i property">BreakpointCount</a> { <b>get</b>; }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> PSJobStartEventArgs
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Arguments for the script job start callback event.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="cffdf22cdbc9b847" href="../../R/cffdf22cdbc9b847.html" target="n" data-glyph="0,0" class="t t">PSJobStartEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Job to be started.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <a id="e281908b7d5f2da4" href="../../R/e281908b7d5f2da4.html" target="n" data-glyph="102,1" class="i property">Job</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Job debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <a id="f18e75085985ce41" href="../../R/f18e75085985ce41.html" target="n" data-glyph="102,1" class="i property">Debugger</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Job is run asynchronously.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="165a1de89f7fced8" href="../../R/165a1de89f7fced8.html" target="n" data-glyph="102,1" class="i property">IsAsync</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">job</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Started job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">debugger</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Debugger.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">isAsync</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Job started asynchronously.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="bf197f876aba9c12" href="../../R/bf197f876aba9c12.html" target="n" data-glyph="72,1" class="t constructor">PSJobStartEventArgs</a>(<a href="../remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <span id="r8 rd" class="r8 r">job</span>, <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r9 rd" class="r9 r">debugger</span>, <b>bool</b> <span id="r10 rd" class="r10 r">isAsync</span>)
        {
            <a href="#cffdf22cdbc9b847" class="k">this</a>.<a href="#e281908b7d5f2da4" class="i property">Job</a> = <span class="r8 r">job</span>;
            <a href="#cffdf22cdbc9b847" class="k">this</a>.<a href="#f18e75085985ce41" class="i property">Debugger</a> = <span class="r9 r">debugger</span>;
            <a href="#cffdf22cdbc9b847" class="k">this</a>.<a href="#165a1de89f7fced8" class="i property">IsAsync</a> = <span class="r10 r">isAsync</span>;
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace Debug Processing
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> StartRunspaceDebugProcessing event arguments.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="0b214bf7844547d9" href="../../R/0b214bf7844547d9.html" target="n" data-glyph="0,0" class="t t">StartRunspaceDebugProcessingEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c"> The runspace to process </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="f722155d3ec9219d" href="../../R/f722155d3ec9219d.html" target="n" data-glyph="102,1" class="i property">Runspace</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When set to true this will cause PowerShell to process this runspace debug session through its</span>
        <span class="c">///</span><span class="c"> script debugger.  To use the default processing return from this event call after setting</span>
        <span class="c">///</span><span class="c"> this property to true.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="6dcf7de6c55652e9" href="../../R/6dcf7de6c55652e9.html" target="n" data-glyph="102,1" class="i property">UseDefaultProcessing</a>
        {
            <b>get</b>;
            <b>set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="e075a36149989e34" href="../../R/e075a36149989e34.html" target="n" data-glyph="72,1" class="t constructor">StartRunspaceDebugProcessingEventArgs</a>(<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r11 rd" class="r11 r">runspace</span>)
        {
            <b>if</b> (<span class="r11 r">runspace</span> == <b>null</b>) { <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r11 r">runspace</span>)); }
 
            <a href="#f722155d3ec9219d" class="i property">Runspace</a> = <span class="r11 r">runspace</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> ProcessRunspaceDebugEnd event arguments.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="d67ddb7718aa2185" href="../../R/d67ddb7718aa2185.html" target="n" data-glyph="0,0" class="t t">ProcessRunspaceDebugEndEventArgs</a> : <span class="i">EventArgs</span>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The runspace where internal debug processing has ended.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="3c530f86a4f8c862" href="../../R/3c530f86a4f8c862.html" target="n" data-glyph="102,1" class="i property">Runspace</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="4665e0285b21fc86" href="../../R/4665e0285b21fc86.html" target="n" data-glyph="72,1" class="t constructor">ProcessRunspaceDebugEndEventArgs</a>(<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r12 rd" class="r12 r">runspace</span>)
        {
            <b>if</b> (<span class="r12 r">runspace</span> == <b>null</b>) { <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r12 r">runspace</span>)); }
 
            <a href="#3c530f86a4f8c862" class="i property">Runspace</a> = <span class="r12 r">runspace</span>;
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Enums
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines debugging mode.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>public enum</b> <a id="7e71da719f103cfd" href="../../R/7e71da719f103cfd.html" target="n" data-glyph="18,0" class="t t"><span id="c6f0e8322d10ea83">DebugModes</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PowerShell script debugging is disabled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="a52ed56edd63c7ff" href="../../R/a52ed56edd63c7ff.html" target="n" data-glyph="24,1" class="i field">None</a> = 0x0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default setting for original PowerShell script debugging.</span>
        <span class="c">///</span><span class="c"> Compatible with PowerShell Versions 2 and 3.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="cb8333d199605cfe" href="../../R/cb8333d199605cfe.html" target="n" data-glyph="24,1" class="i field">Default</a> = 0x1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PowerShell script debugging.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="8f7455ad81a2c081" href="../../R/8f7455ad81a2c081.html" target="n" data-glyph="24,1" class="i field">LocalScript</a> = 0x2,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PowerShell remote script debugging.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="36492991f477f6e1" href="../../R/36492991f477f6e1.html" target="n" data-glyph="24,1" class="i field">RemoteScript</a> = 0x4
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines unhandled breakpoint processing behavior.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal enum</b> <a id="b3fa2b471807788d" href="../../R/b3fa2b471807788d.html" target="n" data-glyph="20,0" class="t t"><span id="9221ff1b1a8c3482">UnhandledBreakpointProcessingMode</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Ignore unhandled breakpoint events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="e18be175ebce8c0f" href="../../R/e18be175ebce8c0f.html" target="n" data-glyph="24,1" class="i field">Ignore</a> = 1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wait on unhandled breakpoint events until a handler is available.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="acf1bcf988b9a342" href="../../R/acf1bcf988b9a342.html" target="n" data-glyph="24,1" class="i field">Wait</a>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Debugger base class
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base class for all PowerShell debuggers.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public abstract class</b> <a id="9e8f0b396592e65c" href="../../R/9e8f0b396592e65c.html" target="n" data-glyph="0,0" class="t t"><span id="f5fd703749bdd8ea">Debugger</span></a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Events
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when the debugger hits a breakpoint or a step.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a>&gt; <a id="4cf8436684b1ce9c" href="../../R/4cf8436684b1ce9c.html" target="n" data-glyph="30,1" class="i">DebuggerStop</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when a breakpoint is updated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<a href="#6136821c0d0fb181" class="t t">BreakpointUpdatedEventArgs</a>&gt; <a id="373cb831745ae38e" href="../../R/373cb831745ae38e.html" target="n" data-glyph="30,1" class="i">BreakpointUpdated</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when nested debugging is cancelled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal event</b> <span class="i">EventHandler</span>&lt;<span class="i">EventArgs</span>&gt; <a id="7269ef04c257bd3a" href="../../R/7269ef04c257bd3a.html" target="n" data-glyph="32,1" class="i">NestedDebuggingCancelledEvent</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace Debug Processing Events
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when a runspace debugger needs breakpoint processing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<a href="#0b214bf7844547d9" class="t t">StartRunspaceDebugProcessingEventArgs</a>&gt; <a id="bc73f8acf66b0f3f" href="../../R/bc73f8acf66b0f3f.html" target="n" data-glyph="30,1" class="i">StartRunspaceDebugProcessing</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised when a runspace debugger is finished being processed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<a href="#d67ddb7718aa2185" class="t t">ProcessRunspaceDebugEndEventArgs</a>&gt; <a id="2f0f9f65e274419d" href="../../R/2f0f9f65e274419d.html" target="n" data-glyph="30,1" class="i">RunspaceDebugProcessingCompleted</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Event raised to indicate that the debugging session is over and runspace debuggers queued for</span>
        <span class="c">///</span><span class="c"> processing should be released.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public event</b> <span class="i">EventHandler</span>&lt;<span class="i">EventArgs</span>&gt; <a id="cc819d8fb4d7099d" href="../../R/cc819d8fb4d7099d.html" target="n" data-glyph="30,1" class="i">CancelRunspaceDebugProcessing</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True when the debugger is stopped.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected bool</b> <a id="e0706ae30c7c5128" href="../../R/e0706ae30c7c5128.html" target="n" data-glyph="105,1" class="i property">DebuggerStopped</a>
        {
            <b>get</b>;
            <b>private set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IsPushed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual bool</b> <a id="970bc0159abf3265" href="../../R/970bc0159abf3265.html" target="n" data-glyph="104,1" class="i property">IsPushed</a>
        {
            <b>get</b> { <b>return</b> <b>false</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IsRemote.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual bool</b> <a id="a3dd72cb41dcad9b" href="../../R/a3dd72cb41dcad9b.html" target="n" data-glyph="104,1" class="i property">IsRemote</a>
        {
            <b>get</b> { <b>return</b> <b>false</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the debugger is preserving a DebuggerStopEvent</span>
        <span class="c">///</span><span class="c"> event.  Use ReleaseSavedDebugStop() to allow event to process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual bool</b> <a id="65fde7239c87ddf3" href="../../R/65fde7239c87ddf3.html" target="n" data-glyph="104,1" class="i property">IsPendingDebugStopEvent</a>
        {
            <b>get</b> { <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>(); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if debugger has been set to stepInto mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual bool</b> <a id="a7f5757d8dc86cd0" href="../../R/a7f5757d8dc86cd0.html" target="n" data-glyph="104,1" class="i property">IsDebuggerSteppingEnabled</a>
        {
            <b>get</b> { <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>(); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if there is a handler for debugger stops.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="8d289e6a9a62921d" href="../../R/8d289e6a9a62921d.html" target="n" data-glyph="104,1" class="i property">IsDebugHandlerSubscribed</a>
        {
            <b>get</b> { <b>return</b> (<a href="#4cf8436684b1ce9c" class="i">DebuggerStop</a> != <b>null</b>); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> UnhandledBreakpointMode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a> <a id="dbd829c531cef2cb" href="../../R/dbd829c531cef2cb.html" target="n" data-glyph="104,1" class="i property">UnhandledBreakpointMode</a>
        {
            <b>get</b> { <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>(); }
 
            <b>set</b> { <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>(); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> DebuggerMode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#7e71da719f103cfd" class="t t">DebugModes</a> <a id="cb370f0b35bef91f" href="../../R/cb370f0b35bef91f.html" target="n" data-glyph="102,1" class="i property">DebugMode</a> { <b>get</b>; <b>protected set</b>; } = <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#cb8333d199605cfe" class="i field">Default</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if debugger has breakpoints set and</span>
        <span class="c">///</span><span class="c"> is currently active.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="3d31ae79fb4a4117" href="../../R/3d31ae79fb4a4117.html" target="n" data-glyph="102,1" class="i property">IsActive</a>
        {
            <b>get</b> { <b>return</b> <b>false</b>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InstanceId.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual</b> <span class="i">Guid</span> <a id="a7dacfd377481326" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">InstanceId</a>
        {
            <b>get</b> { <b>return</b> <a href="#756494f886bccf1a" class="i field">s_instanceId</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True when debugger is stopped at a breakpoint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="564232f4b51d11aa" href="../../R/564232f4b51d11aa.html" target="n" data-glyph="102,1" class="i property">InBreakpoint</a>
        {
            <b>get</b> { <b>return</b> <a href="#e0706ae30c7c5128" class="i property">DebuggerStopped</a>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Protected Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RaiseDebuggerStopEvent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">DebuggerStopEventArgs.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1030:UseEventsWhereAppropriate&quot;</span>)]
        <b>protected void</b> <a id="19eff05653875667" href="../../R/19eff05653875667.html" target="n" data-glyph="75,1" class="i method">RaiseDebuggerStopEvent</a>(<a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r13 rd" class="r13 r">args</span>)
        {
            <b>try</b>
            {
                <a href="#e0706ae30c7c5128" class="i property">DebuggerStopped</a> = <b>true</b>;
                <a href="#4cf8436684b1ce9c" class="i">DebuggerStop</a>.<span class="i">SafeInvoke</span>&lt;<a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a>&gt;(<a href="#9e8f0b396592e65c" class="k">this</a>, <span class="r13 r">args</span>);
            }
            <b>finally</b>
            {
                <a href="#e0706ae30c7c5128" class="i property">DebuggerStopped</a> = <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IsDebuggerStopEventSubscribed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if event subscription exists.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected bool</b> <a id="74257a81608a56cd" href="../../R/74257a81608a56cd.html" target="n" data-glyph="75,1" class="i method">IsDebuggerStopEventSubscribed</a>()
        {
            <b>return</b> (<a href="#4cf8436684b1ce9c" class="i">DebuggerStop</a> != <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> RaiseBreakpointUpdatedEvent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">BreakpointUpdatedEventArgs.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1030:UseEventsWhereAppropriate&quot;</span>)]
        <b>protected void</b> <a id="8aab7ff30ec5430c" href="../../R/8aab7ff30ec5430c.html" target="n" data-glyph="75,1" class="i method">RaiseBreakpointUpdatedEvent</a>(<a href="#6136821c0d0fb181" class="t t">BreakpointUpdatedEventArgs</a> <span id="r14 rd" class="r14 r">args</span>)
        {
            <a href="#373cb831745ae38e" class="i">BreakpointUpdated</a>.<span class="i">SafeInvoke</span>&lt;<a href="#6136821c0d0fb181" class="t t">BreakpointUpdatedEventArgs</a>&gt;(<a href="#9e8f0b396592e65c" class="k">this</a>, <span class="r14 r">args</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IsDebuggerBreakpointUpdatedEventSubscribed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if event subscription exists.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>protected bool</b> <a id="ffe5f52a8cff3b39" href="../../R/ffe5f52a8cff3b39.html" target="n" data-glyph="75,1" class="i method">IsDebuggerBreakpointUpdatedEventSubscribed</a>()
        {
            <b>return</b> (<a href="#373cb831745ae38e" class="i">BreakpointUpdated</a> != <b>null</b>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace Debug Processing
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">/&gt;</span>
        <b>protected void</b> <a id="ce6e45ecbb928a56" href="../../R/ce6e45ecbb928a56.html" target="n" data-glyph="75,1" class="i method">RaiseStartRunspaceDebugProcessingEvent</a>(<a href="#0b214bf7844547d9" class="t t">StartRunspaceDebugProcessingEventArgs</a> <span id="r15 rd" class="r15 r">args</span>)
        {
            <b>if</b> (<span class="r15 r">args</span> == <b>null</b>) { <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r15 r">args</span>)); }
 
            <a href="#bc73f8acf66b0f3f" class="i">StartRunspaceDebugProcessing</a>.<span class="i">SafeInvoke</span>&lt;<a href="#0b214bf7844547d9" class="t t">StartRunspaceDebugProcessingEventArgs</a>&gt;(<a href="#9e8f0b396592e65c" class="k">this</a>, <span class="r15 r">args</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">/&gt;</span>
        <b>protected void</b> <a id="f816d1954c078dc4" href="../../R/f816d1954c078dc4.html" target="n" data-glyph="75,1" class="i method">RaiseRunspaceProcessingCompletedEvent</a>(<a href="#d67ddb7718aa2185" class="t t">ProcessRunspaceDebugEndEventArgs</a> <span id="r16 rd" class="r16 r">args</span>)
        {
            <b>if</b> (<span class="r16 r">args</span> == <b>null</b>) { <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r16 r">args</span>)); }
 
            <a href="#2f0f9f65e274419d" class="i">RunspaceDebugProcessingCompleted</a>.<span class="i">SafeInvoke</span>&lt;<a href="#d67ddb7718aa2185" class="t t">ProcessRunspaceDebugEndEventArgs</a>&gt;(<a href="#9e8f0b396592e65c" class="k">this</a>, <span class="r16 r">args</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">/&gt;</span>
        <b>protected bool</b> <a id="294be241e582b18d" href="../../R/294be241e582b18d.html" target="n" data-glyph="75,1" class="i method">IsStartRunspaceDebugProcessingEventSubscribed</a>()
        {
            <b>return</b> (<a href="#bc73f8acf66b0f3f" class="i">StartRunspaceDebugProcessing</a> != <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">/&gt;</span>
        <b>protected void</b> <a id="bef53cb994ca5b2b" href="../../R/bef53cb994ca5b2b.html" target="n" data-glyph="75,1" class="i method">RaiseCancelRunspaceDebugProcessingEvent</a>()
        {
            <a href="#cc819d8fb4d7099d" class="i">CancelRunspaceDebugProcessing</a>.<a href="../../utils/ExtensionMethods.cs.html#a198665a0bddba44" class="i method">SafeInvoke</a>&lt;<span class="i">EventArgs</span>&gt;(<a href="#9e8f0b396592e65c" class="k">this</a>, <b>null</b>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Evaluates provided command either as a debugger specific command</span>
        <span class="c">///</span><span class="c"> or a PowerShell command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PowerShell command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">output</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerCommandResults.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <a id="f752da7b39207812" href="../../R/f752da7b39207812.html" target="n" data-glyph="72,1" class="i method">ProcessCommand</a>(<a href="../hostifaces/PSCommand.cs.html#b9f024f73904cf55" class="t t">PSCommand</a> <span id="r17 rd" class="r17 r">command</span>, <a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r18 rd" class="r18 r">output</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the debugger resume action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">resumeAction</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">DebuggerResumeAction.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="63acc80e32c25892" href="../../R/63acc80e32c25892.html" target="n" data-glyph="72,1" class="i method">SetDebuggerAction</a>(<a href="#470618169485a70e" class="t t">DebuggerResumeAction</a> <span id="r19 rd" class="r19 r">resumeAction</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stops a running command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public abstract void</b> <a id="bcb115e0eda53c00" href="../../R/bcb115e0eda53c00.html" target="n" data-glyph="72,1" class="i method">StopProcessCommand</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns current debugger stop event arguments if debugger is in</span>
        <span class="c">///</span><span class="c"> debug stop state.  Otherwise returns null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerStopEventArgs.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public abstract</b> <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <a id="0d780deedecb8a4a" href="../../R/0d780deedecb8a4a.html" target="n" data-glyph="72,1" class="i method">GetDebuggerStopArgs</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the parent debugger, breakpoints and other debugging context information.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">parent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parent debugger.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">breakPoints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of breakpoints.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">startAction</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Debugger mode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Host.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r24 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current path.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="97235da5ecc39c3e" href="../../R/97235da5ecc39c3e.html" target="n" data-glyph="72,1" class="i method">SetParent</a>(
            <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r20 rd" class="r20 r">parent</span>,
            <span class="i">IEnumerable</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r21 rd" class="r21 r">breakPoints</span>,
            <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>? <span id="r22 rd" class="r22 r">startAction</span>,
            <a href="../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r23 rd" class="r23 r">host</span>,
            <a href="../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a> <span id="r24 rd" class="r24 r">path</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the debugger mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="f6349f5fcfadd2ac" href="../../R/f6349f5fcfadd2ac.html" target="n" data-glyph="72,1" class="i method">SetDebugMode</a>(<a href="#7e71da719f103cfd" class="t t">DebugModes</a> <span id="r25 rd" class="r25 r">mode</span>)
        {
            <a href="#9e8f0b396592e65c" class="k">this</a>.<a href="#cb370f0b35bef91f" class="i property">DebugMode</a> = <span class="r25 r">mode</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns IEnumerable of CallStackFrame objects.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual</b> <span class="i">IEnumerable</span>&lt;<a href="#70d153384f134926" class="t t">CallStackFrame</a>&gt; <a id="03b6be6c2122937e" href="../../R/03b6be6c2122937e.html" target="n" data-glyph="72,1" class="i method">GetCallStack</a>()
        {
            <b>return</b> <b>new</b> <span class="i">Collection</span>&lt;<a href="#70d153384f134926" class="t t">CallStackFrame</a>&gt;();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a breakpoint by id in the current runspace, primarily for Enable/Disable/Remove-PSBreakpoint cmdlets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the breakpoint you want.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="43e1c38d62f7235a" href="../../R/43e1c38d62f7235a.html" target="n" data-glyph="72,1" class="i method">GetBreakpoint</a>(<b>int</b> <span id="r26 rd" class="r26 r">id</span>) =&gt;
            <a href="#b6e003b1e66c5826" class="i method">GetBreakpoint</a>(<span class="r26 r">id</span>, <span class="r27 r">runspaceId</span>: <b>null</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a breakpoint by id, primarily for Enable/Disable/Remove-PSBreakpoint cmdlets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r28 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the breakpoint you want.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r27 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="b6e003b1e66c5826" href="../../R/b6e003b1e66c5826.html" target="n" data-glyph="72,1" class="i method">GetBreakpoint</a>(<b>int</b> <span id="r28 rd" class="r28 r">id</span>, <b>int</b>? <span id="r27 rd" class="r27 r">runspaceId</span>) =&gt;
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the provided set of breakpoints to the debugger, in the current runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">breakpoints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Breakpoints.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="7960fdac25827c3f" href="../../R/7960fdac25827c3f.html" target="n" data-glyph="72,1" class="i method">SetBreakpoints</a>(<span class="i">IEnumerable</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r29 rd" class="r29 r">breakpoints</span>) =&gt;
            <a href="#843320f23c8b6ab7" class="i method">SetBreakpoints</a>(<span class="r29 r">breakpoints</span>, <span class="r30 r">runspaceId</span>: <b>null</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the provided set of breakpoints to the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">breakpoints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Breakpoints.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with, null being the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="843320f23c8b6ab7" href="../../R/843320f23c8b6ab7.html" target="n" data-glyph="72,1" class="i method">SetBreakpoints</a>(<span class="i">IEnumerable</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r31 rd" class="r31 r">breakpoints</span>, <b>int</b>? <span id="r30 rd" class="r30 r">runspaceId</span>) =&gt;
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns breakpoints in the current runspace, primarily for the Get-PSBreakpoint cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <a id="00ff38e404c12712" href="../../R/00ff38e404c12712.html" target="n" data-glyph="72,1" class="i method">GetBreakpoints</a>() =&gt;
            <a href="#bece37496a1551b3" class="i method">GetBreakpoints</a>(<span class="r32 r">runspaceId</span>: <b>null</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns breakpoints primarily for the Get-PSBreakpoint cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r32 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual</b> <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <a id="bece37496a1551b3" href="../../R/bece37496a1551b3.html" target="n" data-glyph="72,1" class="i method">GetBreakpoints</a>(<b>int</b>? <span id="r32 rd" class="r32 r">runspaceId</span>) =&gt;
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a command breakpoint in the current runspace in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r33 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the command that will trigger the breakpoint. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r34 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r35 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. If null, the breakpoint may be hit anywhere the command is invoked.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The command breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a> <a id="33f271095fcc8aea" href="../../R/33f271095fcc8aea.html" target="n" data-glyph="72,1" class="i method">SetCommandBreakpoint</a>(<b>string</b> <span id="r33 rd" class="r33 r">command</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r34 rd" class="r34 r">action</span>, <b>string</b> <span id="r35 rd" class="r35 r">path</span>) =&gt;
            <a href="#770250464b312a9d" class="i method">SetCommandBreakpoint</a>(<span class="r33 r">command</span>, <span class="r34 r">action</span>, <span class="r35 r">path</span>, <span class="r36 r">runspaceId</span>: <b>null</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a command breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r37 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the command that will trigger the breakpoint. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r38 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r39 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. If null, the breakpoint may be hit anywhere the command is invoked.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r36 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A value of null will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The command breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a> <a id="770250464b312a9d" href="../../R/770250464b312a9d.html" target="n" data-glyph="72,1" class="i method">SetCommandBreakpoint</a>(<b>string</b> <span id="r37 rd" class="r37 r">command</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r38 rd" class="r38 r">action</span>, <b>string</b> <span id="r39 rd" class="r39 r">path</span>, <b>int</b>? <span id="r36 rd" class="r36 r">runspaceId</span>) =&gt;
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a line breakpoint in the current runspace in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r40 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r41 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The line in the script file where the breakpoint may be hit. This value must be greater than or equal to 1.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r42 r">column</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The column in the script file where the breakpoint may be hit. If 0, the breakpoint will trigger on any statement on the line.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r43 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The line breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <a id="84e2724d7602314d" href="../../R/84e2724d7602314d.html" target="n" data-glyph="72,1" class="i method">SetLineBreakpoint</a>(<b>string</b> <span id="r40 rd" class="r40 r">path</span>, <b>int</b> <span id="r41 rd" class="r41 r">line</span>, <b>int</b> <span id="r42 rd" class="r42 r">column</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r43 rd" class="r43 r">action</span>) =&gt;
            <a href="#76c772e72e8f9e60" class="i method">SetLineBreakpoint</a>(<span class="r40 r">path</span>, <span class="r41 r">line</span>, <span class="r42 r">column</span>, <span class="r43 r">action</span>, <span class="r44 r">runspaceId</span>: <b>null</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a line breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The line in the script file where the breakpoint may be hit. This value must be greater than or equal to 1.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r47 r">column</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The column in the script file where the breakpoint may be hit. If 0, the breakpoint will trigger on any statement on the line.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r48 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r44 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The line breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <a id="76c772e72e8f9e60" href="../../R/76c772e72e8f9e60.html" target="n" data-glyph="72,1" class="i method">SetLineBreakpoint</a>(<b>string</b> <span id="r45 rd" class="r45 r">path</span>, <b>int</b> <span id="r46 rd" class="r46 r">line</span>, <b>int</b> <span id="r47 rd" class="r47 r">column</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r48 rd" class="r48 r">action</span>, <b>int</b>? <span id="r44 rd" class="r44 r">runspaceId</span>) =&gt;
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a variable breakpoint in the current runspace in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r49 r">variableName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable that will trigger the breakpoint. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r50 r">accessMode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The variable access mode that will trigger the breakpoint.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r51 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. If null, the breakpoint may be hit anywhere the variable is accessed using the specified access mode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The variable breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a> <a id="de0e7149ee81261a" href="../../R/de0e7149ee81261a.html" target="n" data-glyph="72,1" class="i method">SetVariableBreakpoint</a>(<b>string</b> <span id="r49 rd" class="r49 r">variableName</span>, <a href="Breakpoint.cs.html#296231e77d11bcb5" class="t t">VariableAccessMode</a> <span id="r50 rd" class="r50 r">accessMode</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r51 rd" class="r51 r">action</span>, <b>string</b> <span id="r52 rd" class="r52 r">path</span>) =&gt;
            <a href="#9563c4fb2f0b68d1" class="i method">SetVariableBreakpoint</a>(<span class="r49 r">variableName</span>, <span class="r50 r">accessMode</span>, <span class="r51 r">action</span>, <span class="r52 r">path</span>, <span class="r53 r">runspaceId</span>: <b>null</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a variable breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r54 r">variableName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable that will trigger the breakpoint. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">accessMode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The variable access mode that will trigger the breakpoint.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. If null, the breakpoint may be hit anywhere the variable is accessed using the specified access mode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r53 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The variable breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a> <a id="9563c4fb2f0b68d1" href="../../R/9563c4fb2f0b68d1.html" target="n" data-glyph="72,1" class="i method">SetVariableBreakpoint</a>(<b>string</b> <span id="r54 rd" class="r54 r">variableName</span>, <a href="Breakpoint.cs.html#296231e77d11bcb5" class="t t">VariableAccessMode</a> <span id="r55 rd" class="r55 r">accessMode</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r56 rd" class="r56 r">action</span>, <b>string</b> <span id="r57 rd" class="r57 r">path</span>, <b>int</b>? <span id="r53 rd" class="r53 r">runspaceId</span>) =&gt;
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes a breakpoint from the debugger in the current runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to remove from the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the breakpoint was removed from the debugger; false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="cdff75b85ebaddd8" href="../../R/cdff75b85ebaddd8.html" target="n" data-glyph="72,1" class="i method">RemoveBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r58 rd" class="r58 r">breakpoint</span>) =&gt;
            <a href="#7137c8a1ec351631" class="i method">RemoveBreakpoint</a>(<span class="r58 r">breakpoint</span>, <span class="r59 r">runspaceId</span>: <b>null</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes a breakpoint from the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to remove from the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the breakpoint was removed from the debugger; false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual bool</b> <a id="7137c8a1ec351631" href="../../R/7137c8a1ec351631.html" target="n" data-glyph="72,1" class="i method">RemoveBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r60 rd" class="r60 r">breakpoint</span>, <b>int</b>? <span id="r59 rd" class="r59 r">runspaceId</span>) =&gt;
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enables a breakpoint in the debugger in the current runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to enable in the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The updated breakpoint if it was found; null if the breakpoint was not found in the debugger.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="8b9564824bfcb02b" href="../../R/8b9564824bfcb02b.html" target="n" data-glyph="72,1" class="i method">EnableBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r61 rd" class="r61 r">breakpoint</span>) =&gt;
            <a href="#670aef2cabe5355b" class="i method">EnableBreakpoint</a>(<span class="r61 r">breakpoint</span>, <span class="r62 r">runspaceId</span>: <b>null</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enables a breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to enable in the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The updated breakpoint if it was found; null if the breakpoint was not found in the debugger.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="670aef2cabe5355b" href="../../R/670aef2cabe5355b.html" target="n" data-glyph="72,1" class="i method">EnableBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r63 rd" class="r63 r">breakpoint</span>, <b>int</b>? <span id="r62 rd" class="r62 r">runspaceId</span>) =&gt;
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disables a breakpoint in the debugger in the current runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r64 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to enable in the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The updated breakpoint if it was found; null if the breakpoint was not found in the debugger.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="7465cc457fb3b609" href="../../R/7465cc457fb3b609.html" target="n" data-glyph="72,1" class="i method">DisableBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r64 rd" class="r64 r">breakpoint</span>) =&gt;
            <a href="#a7be3be2de328046" class="i method">DisableBreakpoint</a>(<span class="r64 r">breakpoint</span>, <span class="r65 r">runspaceId</span>: <b>null</b>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disables a breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r66 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to enable in the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r65 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The updated breakpoint if it was found; null if the breakpoint was not found in the debugger.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public virtual</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="a7be3be2de328046" href="../../R/a7be3be2de328046.html" target="n" data-glyph="72,1" class="i method">DisableBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r66 rd" class="r66 r">breakpoint</span>, <b>int</b>? <span id="r65 rd" class="r65 r">runspaceId</span>) =&gt;
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resets the command processor source information so that it is</span>
        <span class="c">///</span><span class="c"> updated with latest information on the next debug stop.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="317fa4f474d1ee6b" href="../../R/317fa4f474d1ee6b.html" target="n" data-glyph="72,1" class="i method">ResetCommandProcessorSource</a>()
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets debugger stepping mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r67 r">enabled</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if stepping is to be enabled.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="e33bfc6122759440" href="../../R/e33bfc6122759440.html" target="n" data-glyph="72,1" class="i method">SetDebuggerStepMode</a>(<b>bool</b> <span id="r67 rd" class="r67 r">enabled</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Breaks into the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r68 r">triggerObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that triggered the breakpoint, if there is one.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="98454a0ebb421f34" href="../../R/98454a0ebb421f34.html" target="n" data-glyph="74,1" class="i method">Break</a>(<b>object</b> <span id="r68 rd" class="r68 r">triggerObject</span> = <b>null</b>)
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Passes the debugger command to the internal script debugger command processor.  This</span>
        <span class="c">///</span><span class="c"> is used internally to handle debugger commands such as list, help, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">output</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Output collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerCommand containing information on whether and how the command was processed.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <a id="e8d4b0c08ae40f99" href="../../R/e8d4b0c08ae40f99.html" target="n" data-glyph="74,1" class="i method">InternalProcessCommand</a>(<b>string</b> <span id="r69 rd" class="r69 r">command</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r70 rd" class="r70 r">output</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a source list based on root script debugger source information if available, with</span>
        <span class="c">///</span><span class="c"> the current source line highlighted.  This is used internally for nested runspace debugging</span>
        <span class="c">///</span><span class="c"> where the runspace command is run in context of a parent script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">lineNum</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current source line.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">output</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Output collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if source listed successfully.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual bool</b> <a id="18e6d7b8cb885b7e" href="../../R/18e6d7b8cb885b7e.html" target="n" data-glyph="74,1" class="i method">InternalProcessListCommand</a>(<b>int</b> <span id="r71 rd" class="r71 r">lineNum</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r72 rd" class="r72 r">output</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets up debugger to debug provided job or its child jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r73 r">job</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Job object that is either a debuggable job or a container of</span>
        <span class="c">///</span><span class="c"> debuggable child jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r74 r">breakAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the debugger automatically invokes a break all when it</span>
        <span class="c">///</span><span class="c"> attaches to the job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="8291d202d10ef146" href="../../R/8291d202d10ef146.html" target="n" data-glyph="74,1" class="i method">DebugJob</a>(<a href="../remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <span id="r73 rd" class="r73 r">job</span>, <b>bool</b> <span id="r74 rd" class="r74 r">breakAll</span>) =&gt;
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes job from debugger job list and pops the its</span>
        <span class="c">///</span><span class="c"> debugger from the active debugger stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">job</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="b20cae9c467a1579" href="../../R/b20cae9c467a1579.html" target="n" data-glyph="74,1" class="i method">StopDebugJob</a>(<a href="../remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <span id="r75 rd" class="r75 r">job</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> GetActiveDebuggerCallStack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Array of stack frame objects of active debugger.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="#70d153384f134926" class="t t">CallStackFrame</a>[] <a id="fa8592c3abd9de74" href="../../R/fa8592c3abd9de74.html" target="n" data-glyph="74,1" class="i method">GetActiveDebuggerCallStack</a>()
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Method to add the provided runspace information to the debugger</span>
        <span class="c">///</span><span class="c"> for monitoring of debugger events.  This is used to implement nested</span>
        <span class="c">///</span><span class="c"> debugging of runspaces.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSEntityCreatedRunspaceEventArgs.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="06cee48d6b1060f4" href="../../R/06cee48d6b1060f4.html" target="n" data-glyph="74,1" class="i method">StartMonitoringRunspace</a>(<a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a> <span id="r76 rd" class="r76 r">args</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Method to end the monitoring of a runspace for debugging events.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">args</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSEntityCreatedRunspaceEventArgs.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="565365e36cf7b065" href="../../R/565365e36cf7b065.html" target="n" data-glyph="74,1" class="i method">EndMonitoringRunspace</a>(<a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a> <span id="r77 rd" class="r77 r">args</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a debug stop event is currently pending then this method will release</span>
        <span class="c">///</span><span class="c"> the event to continue processing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="a15389d72926a6cd" href="../../R/a15389d72926a6cd.html" target="n" data-glyph="74,1" class="i method">ReleaseSavedDebugStop</a>()
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets up debugger to debug provided Runspace in a nested debug session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The runspace to debug.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r79 r">breakAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the debugger automatically invokes a break all when it</span>
        <span class="c">///</span><span class="c"> attaches to the runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="911e78d8ca74d76a" href="../../R/911e78d8ca74d76a.html" target="n" data-glyph="74,1" class="i method">DebugRunspace</a>(<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r78 rd" class="r78 r">runspace</span>, <b>bool</b> <span id="r79 rd" class="r79 r">breakAll</span>) =&gt;
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the provided Runspace from the nested &quot;active&quot; debugger state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="48e143f1e8d562d9" href="../../R/48e143f1e8d562d9.html" target="n" data-glyph="74,1" class="i method">StopDebugRunspace</a>(<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r80 rd" class="r80 r">runspace</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raises the NestedDebuggingCancelledEvent event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="ee88acde413c3219" href="../../R/ee88acde413c3219.html" target="n" data-glyph="74,1" class="i method">RaiseNestedDebuggingCancelEvent</a>()
        {
            <span class="c">// Raise event on worker thread.</span>
            <span class="i">Threading</span>.<span class="i">ThreadPool</span>.<span class="i">QueueUserWorkItem</span>(
                (<span id="r81 rd" class="r81 r">state</span>) =&gt;
                {
                    <b>try</b>
                    {
                        <a href="#7269ef04c257bd3a" class="i">NestedDebuggingCancelledEvent</a>.<a href="../../utils/ExtensionMethods.cs.html#a198665a0bddba44" class="i method">SafeInvoke</a>&lt;<span class="i">EventArgs</span>&gt;(<a href="#9e8f0b396592e65c" class="k">this</a>, <b>null</b>);
                    }
                    <b>catch</b> (<span class="i">Exception</span>)
                    {
                    }
                });
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace Debug Processing Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the provided Runspace object to the runspace debugger processing queue.</span>
        <span class="c">///</span><span class="c"> The queue will then raise the StartRunspaceDebugProcessing events for each runspace to allow</span>
        <span class="c">///</span><span class="c"> a host script debugger implementation to provide an active debugging session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace to debug.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal virtual void</b> <a id="4b80155f8f31d5b0" href="../../R/4b80155f8f31d5b0.html" target="n" data-glyph="74,1" class="i method">QueueRunspaceForDebug</a>(<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r82 rd" class="r82 r">runspace</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Causes the CancelRunspaceDebugProcessing event to be raised which notifies subscribers that current debugging</span>
        <span class="c">///</span><span class="c"> sessions should be cancelled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="feb2a06bee3eab9a" href="../../R/feb2a06bee3eab9a.html" target="n" data-glyph="72,1" class="i method">CancelDebuggerProcessing</a>()
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Members
 
        <b>internal const string</b> <a id="bd971f01dcc26533" href="../../R/bd971f01dcc26533.html" target="n" data-glyph="8,1" class="i field">CannotProcessCommandNotStopped</a> = <span class="s">&quot;Debugger:CannotProcessCommandNotStopped&quot;</span>;
 
        <b>internal const string</b> <a id="1bffbef41f7f686b" href="../../R/1bffbef41f7f686b.html" target="n" data-glyph="8,1" class="i field">CannotEnableDebuggerSteppingInvalidMode</a> = <span class="s">&quot;Debugger:CannotEnableDebuggerSteppingInvalidMode&quot;</span>;
 
        <b>private static readonly</b> <span class="i">Guid</span> <a id="756494f886bccf1a" href="../../R/756494f886bccf1a.html" target="n" data-glyph="46,1" class="i field">s_instanceId</a> = <b>new</b> <span class="i">Guid</span>();
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> ScriptDebugger class
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Holds the debugging information for a Monad Shell session.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="0d95bb604662e23b" href="../../R/0d95bb604662e23b.html" target="n" data-glyph="2,0" class="t t">ScriptDebugger</a> : <a href="#9e8f0b396592e65c" class="t t">Debugger</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> constructors
 
        <b>internal</b> <a id="0ecd00e9d3e6ea73" href="../../R/0ecd00e9d3e6ea73.html" target="n" data-glyph="74,1" class="t constructor">ScriptDebugger</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r83 rd" class="r83 r">context</span>)
        {
            <a href="#3ac4e385b52c3ec7" class="i field">_context</a> = <span class="r83 r">context</span>;
            <a href="#b7ae8b1cf06dec15" class="i field">_inBreakpoint</a> = <b>false</b>;
            <a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a> = <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;();
            <a href="#97a66285c6d64854" class="i field">_pendingBreakpoints</a> = <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;();
            <a href="#2dd2911da87db3b5" class="i field">_boundBreakpoints</a> = <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<span class="i">WeakReference</span>, <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#d14cf615f134d325" class="i field">_commandBreakpoints</a> = <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a>&gt;();
            <a href="#a8f3199e0f8f72b3" class="i field">_variableBreakpoints</a> = <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#57792450deac46c7" class="i field">_steppingMode</a> = <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#adb717584e0b9060" class="i field">None</a>;
            <a href="#f496970aab0b0b4c" class="i field">_callStack</a> = <b>new</b> <span class="t">CallStackList</span> { <a href="#63918689f41a062f" class="i field">_callStackList</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#66c884979ca0dfea" class="t t">CallStackInfo</a>&gt;() };
 
            <a href="#9b70248372b3e246" class="i field">_runningJobs</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="#cffdf22cdbc9b847" class="t t">PSJobStartEventArgs</a>&gt;();
            <a href="#9e17718415fd538f" class="i field">_activeDebuggers</a> = <b>new</b> <span class="i">ConcurrentStack</span>&lt;<a href="#9e8f0b396592e65c" class="t t">Debugger</a>&gt;();
            <a href="#2772de8722870503" class="i field">_debuggerStopEventArgs</a> = <b>new</b> <span class="i">ConcurrentStack</span>&lt;<a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a>&gt;();
            <a href="#9cd764826df997c7" class="i field">_syncObject</a> = <b>new</b> <b>object</b>();
            <a href="#d0cb7ecfcb4c3c6b" class="i field">_syncActiveDebuggerStopObject</a> = <b>new</b> <b>object</b>();
 
            <a href="#68d085c8eb45aa5f" class="i field">_runningRunspaces</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a>&gt;();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Static constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>static</b> <a id="18981cb30f445c6e" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">ScriptDebugger</a>()
        {
            <a href="#08537d805fb9d93a" class="i field">s_processDebugPromptMatch</a> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="s">@&quot;&quot;&quot;[{0}:&quot;</span>, <span class="i">DebuggerStrings</span>.<span class="i">NestedRunspaceDebuggerPromptProcessName</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> constructors
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True when debugger is stopped at a breakpoint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="bfa00bd3aebf1f44" href="../../R/bfa00bd3aebf1f44.html" target="n" data-glyph="102,1" class="i property">InBreakpoint</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#b7ae8b1cf06dec15" class="i field">_inBreakpoint</a>)
                {
                    <b>return</b> <a href="#b7ae8b1cf06dec15" class="i field">_inBreakpoint</a>;
                }
 
                <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r84 rd" class="r84 r">activeDebugger</span>;
                <b>if</b> (<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r84 r">activeDebugger</span>))
                {
                    <b>return</b> <span class="r84 r">activeDebugger</span>.<a href="#564232f4b51d11aa" class="i property">InBreakpoint</a>;
                }
 
                <b>return</b> <b>false</b>;
            }
        }
 
        <b>internal override bool</b> <a id="fbc5a00710aa76f0" href="../../R/fbc5a00710aa76f0.html" target="n" data-glyph="104,1" class="i property">IsPushed</a>
        {
            <b>get</b> { <b>return</b> (!<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">IsEmpty</span>); }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the debugger is preserving a DebuggerStopEvent</span>
        <span class="c">///</span><span class="c"> event.  Use ReleaseSavedDebugStop() to allow event to process.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="055796f7d08afd08" href="../../R/055796f7d08afd08.html" target="n" data-glyph="104,1" class="i property">IsPendingDebugStopEvent</a>
        {
            <b>get</b>
            {
                <b>return</b> ((<a href="#ce9910145cd5a126" class="i field">_preserveDebugStopEvent</a> != <b>null</b>) &amp;&amp; !<a href="#ce9910145cd5a126" class="i field">_preserveDebugStopEvent</a>.<span class="i">IsSet</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if debugger has been set to stepInto mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="83601e3e220acbe6" href="../../R/83601e3e220acbe6.html" target="n" data-glyph="104,1" class="i property">IsDebuggerSteppingEnabled</a>
        {
            <b>get</b>
            {
                <b>return</b> ((<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> == (<b>int</b>)<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a>) &amp;&amp;
                        (<a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a> == <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#422455533b156acf" class="i field">StepInto</a>) &amp;&amp;
                        (<a href="#57792450deac46c7" class="i field">_steppingMode</a> != <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#adb717584e0b9060" class="i field">None</a>));
            }
        }
 
        <b>private bool</b>? <a id="8201fc6ad586730f" href="../../R/8201fc6ad586730f.html" target="n" data-glyph="46,1" class="i field">_isLocalSession</a>;
 
        <b>private bool</b> <a id="41a8c03f52ff7ac4" href="../../R/41a8c03f52ff7ac4.html" target="n" data-glyph="106,1" class="i property">IsLocalSession</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#8201fc6ad586730f" class="i field">_isLocalSession</a> == <b>null</b>)
                {
                    <span class="c">// Remote debug sessions always have a ServerRemoteHost.  Otherwise it is a local session.</span>
                    <a href="#8201fc6ad586730f" class="i field">_isLocalSession</a> = !(((<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#ad328d08127401c1" class="i property">InternalHost</a>.<a href="../hostifaces/InternalHost.cs.html#f25431d0ab961179" class="i property">ExternalHost</a> != <b>null</b>) &amp;&amp;
                                         (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#ad328d08127401c1" class="i property">InternalHost</a>.<a href="../hostifaces/InternalHost.cs.html#f25431d0ab961179" class="i property">ExternalHost</a> <b>is</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<a href="../remoting/server/ServerRemoteHost.cs.html#ecbb655f955c09fc" class="t t">ServerRemoteHost</a>)));
                }
 
                <b>return</b> <a href="#8201fc6ad586730f" class="i field">_isLocalSession</a>.<span class="i">Value</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the object that triggered the current breakpoint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private object</b> <a id="6d7a38a0f33704a6" href="../../R/6d7a38a0f33704a6.html" target="n" data-glyph="106,1" class="i property">TriggerObject</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> properties
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> internal methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Reset Debugger
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resets debugger to initial state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="9013326d18e74225" href="../../R/9013326d18e74225.html" target="n" data-glyph="74,1" class="i method">ResetDebugger</a>()
        {
            <a href="#b3b16eb4a7a7b381" class="i method">SetDebugMode</a>(<a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#a52ed56edd63c7ff" class="i field">None</a>);
            <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#1f2f5fbf58d44eb7" class="i field">Disabled</a>);
 
            <a href="#57792450deac46c7" class="i field">_steppingMode</a> = <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#adb717584e0b9060" class="i field">None</a>;
            <a href="#b7ae8b1cf06dec15" class="i field">_inBreakpoint</a> = <b>false</b>;
            <a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">Clear</span>();
            <a href="#97a66285c6d64854" class="i field">_pendingBreakpoints</a>.<span class="i">Clear</span>();
            <a href="#2dd2911da87db3b5" class="i field">_boundBreakpoints</a>.<span class="i">Clear</span>();
            <a href="#d14cf615f134d325" class="i field">_commandBreakpoints</a>.<span class="i">Clear</span>();
            <a href="#a8f3199e0f8f72b3" class="i field">_variableBreakpoints</a>.<span class="i">Clear</span>();
            <a href="#66088c813d15db4b" class="i field">s_emptyBreakpointList</a>.<span class="i">Clear</span>();
            <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#999521af0ad95f60" class="i method">Clear</a>();
            <a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a> = <b>null</b>;
            <a href="#d86cde82e8c1278b" class="i field">_commandProcessor</a> = <b>new</b> <a href="#ddb0e911ca6048eb" class="t constructor">DebuggerCommandProcessor</a>();
 
            <a href="#aae66cbc2a9cebb6" class="i field">_currentInvocationInfo</a> = <b>null</b>;
            <a href="#b7ae8b1cf06dec15" class="i field">_inBreakpoint</a> = <b>false</b>;
            <a href="#a750b00e0cb69a64" class="i field">_psDebuggerCommand</a> = <b>null</b>;
            <a href="#9e7b7ce9e70cc24f" class="i field">_savedIgnoreScriptDebug</a> = <b>false</b>;
            <a href="#8201fc6ad586730f" class="i field">_isLocalSession</a> = <b>null</b>;
 
            <a href="#822a39b6aaf94b98" class="i field">_nestedDebuggerStop</a> = <b>false</b>;
            <a href="#2772de8722870503" class="i field">_debuggerStopEventArgs</a>.<span class="i">Clear</span>();
            <a href="#285b7e0548cc6c33" class="i field">_lastActiveDebuggerAction</a> = <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>;
            <a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a> = <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>;
            <a href="#f189a5931f8867de" class="i field">_previousDebuggerAction</a> = <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>;
            <a href="#381821f78732d634" class="i field">_nestedRunningFrame</a> = <b>null</b>;
            <a href="#822a39b6aaf94b98" class="i field">_nestedDebuggerStop</a> = <b>false</b>;
            <a href="#f407eb35d5fdf562" class="i field">_processingOutputCount</a> = 0;
            <a href="#904044cf5171f58b" class="i field">_preserveUnhandledDebugStopEvent</a> = <b>false</b>;
 
            <a href="#60b81ac46249446b" class="i method">ClearRunningJobList</a>();
            <a href="#28a40543a3d08878" class="i method">ClearRunningRunspaceList</a>();
            <a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">Clear</span>();
 
            <a href="#40c888fb804e0de7" class="i method">ReleaseSavedDebugStop</a>();
 
            <a href="#b3b16eb4a7a7b381" class="i method">SetDebugMode</a>(<a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#cb8333d199605cfe" class="i field">Default</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Call stack management
 
        <span class="c">// Called from generated code on entering the script function, called once for each dynamicparam, begin, or end</span>
        <span class="c">// block, and once for each object written to the pipeline.  Also called when entering a trap.</span>
        <b>internal void</b> <a id="441c6f82e24c3501" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">EnterScriptFunction</a>(<a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a> <span id="r85 rd" class="r85 r">functionContext</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r85 r">functionContext</span>.<a href="../parser/Compiler.cs.html#86d08ccdd0602a1b" class="i field">_executionContext</a> == <a href="#3ac4e385b52c3ec7" class="i field">_context</a>, <span class="s">&quot;Wrong debugger is being used.&quot;</span>);
 
            <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="k">var</a> <span id="r86 rd" class="r86 r">invocationInfo</span> = (<a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a>)<span class="r85 r">functionContext</span>.<a href="../parser/Compiler.cs.html#23a9d5ac6a3b086b" class="i field">_localsTuple</a>.<a href="../runtime/MutableTuple.cs.html#245c6f2c176d8a4a" class="i method">GetAutomaticVariable</a>(<a href="../SpecialVariables.cs.html#1c6f2efd91287b59" class="t t">AutomaticVariable</a>.<a href="../SpecialVariables.cs.html#80b3b66ce97fc2c9" class="i field">MyInvocation</a>);
            <a href="#66c884979ca0dfea" class="k">var</a> <span id="r87 rd" class="r87 r">newCallStackInfo</span> = <b>new</b> <span class="t">CallStackInfo</span>
            {
                <a href="#481bca89fc49aa62" class="i property">InvocationInfo</a> = <span class="r86 r">invocationInfo</span>,
                <a href="#7f39291e46a51014" class="i property">File</a> = <span class="r85 r">functionContext</span>.<a href="../parser/Compiler.cs.html#95a73081cffaa015" class="i field">_file</a>,
                <a href="#d539d16001c53c61" class="i property">DebuggerStepThrough</a> = <span class="r85 r">functionContext</span>.<a href="../parser/Compiler.cs.html#f82ab745f95a8791" class="i field">_debuggerStepThrough</a>,
                <a href="#9ad2e5e18339a674" class="i property">FunctionContext</a> = <span class="r85 r">functionContext</span>,
                <a href="#70b28df388667277" class="i property">IsFrameHidden</a> = <span class="r85 r">functionContext</span>.<a href="../parser/Compiler.cs.html#f9539890beb6e765" class="i field">_debuggerHidden</a>,
            };
            <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#a9b1f531d32a7876" class="i method">Add</a>(<span class="r87 r">newCallStackInfo</span>);
 
            <b>if</b> (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> &gt; 0)
            {
                <a href="../ExternalScriptInfo.cs.html#7806ac40f903221c" class="k">var</a> <span id="r88 rd" class="r88 r">scriptCommandInfo</span> = <span class="r86 r">invocationInfo</span>.<a href="../InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a> <b>as</b> <a href="../ExternalScriptInfo.cs.html#7806ac40f903221c" class="t t">ExternalScriptInfo</a>;
                <b>if</b> (<span class="r88 r">scriptCommandInfo</span> != <b>null</b>)
                {
                    <a href="#938d448a012b94dd" class="i method">RegisterScriptFile</a>(<span class="r88 r">scriptCommandInfo</span>);
                }
 
                <b>bool</b> <span id="r89 rd" class="r89 r">checkLineBp</span> = <a href="#ab0382a7b993ff7c" class="i method">CheckCommand</a>(<span class="r86 r">invocationInfo</span>);
                <a href="#36cfb4e447c722e7" class="i method">SetupBreakpoints</a>(<span class="r85 r">functionContext</span>);
 
                <b>if</b> (<span class="r85 r">functionContext</span>.<a href="../parser/Compiler.cs.html#f82ab745f95a8791" class="i field">_debuggerStepThrough</a> &amp;&amp; <a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a> == <b>null</b> &amp;&amp; <a href="#57792450deac46c7" class="i field">_steppingMode</a> == <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#b13a6fed8931e742" class="i field">StepIn</a>)
                {
                    <span class="c">// Treat like step out, but only if we&#39;re not already stepping out</span>
                    <a href="#27abb455d0aa0716" class="i method">ResumeExecution</a>(<a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#4cfb4add3c03409c" class="i field">StepOut</a>);
                }
 
                <b>if</b> (<span class="r89 r">checkLineBp</span>)
                {
                    <a href="#26eb6130f2e56174" class="i method">OnSequencePointHit</a>(<span class="r85 r">functionContext</span>);
                }
 
                <b>if</b> (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#0b681c156010f201" class="i property">PSDebugTraceLevel</a> &gt; 1 &amp;&amp; !<span class="r85 r">functionContext</span>.<a href="../parser/Compiler.cs.html#f82ab745f95a8791" class="i field">_debuggerStepThrough</a> &amp;&amp; !<span class="r85 r">functionContext</span>.<a href="../parser/Compiler.cs.html#f9539890beb6e765" class="i field">_debuggerHidden</a>)
                {
                    <a href="#ee89744ff05c3618" class="i method">TraceScriptFunctionEntry</a>(<span class="r85 r">functionContext</span>);
                }
            }
        }
 
        <b>private void</b> <a id="36cfb4e447c722e7" href="../../R/36cfb4e447c722e7.html" target="n" data-glyph="76,1" class="i method">SetupBreakpoints</a>(<a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a> <span id="r90 rd" class="r90 r">functionContext</span>)
        {
            <b>var</b> <span id="r91 rd" class="r91 r">scriptDebugData</span> = <a href="#2210092054c29bc9" class="i field">_mapScriptToBreakpoints</a>.<span class="i">GetValue</span>(<span class="r90 r">functionContext</span>.<a href="../parser/Compiler.cs.html#354889e302c1693c" class="i field">_sequencePoints</a>,
                                                                   <span id="r92 rd" class="r92 r">_</span> =&gt; <span class="i">Tuple</span>.<span class="i">Create</span>(<b>new</b> <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;(),
                                                                                     <b>new</b> <span class="i">BitArray</span>(<span class="r90 r">functionContext</span>.<a href="../parser/Compiler.cs.html#354889e302c1693c" class="i field">_sequencePoints</a>.<span class="i">Length</span>)));
            <span class="r90 r">functionContext</span>.<a href="../parser/Compiler.cs.html#18b1921c6a906819" class="i field">_boundBreakpoints</a> = <span class="r91 r">scriptDebugData</span>.<span class="i">Item1</span>;
            <span class="r90 r">functionContext</span>.<a href="../parser/Compiler.cs.html#cc249a58ac34eb70" class="i field">_breakPoints</a> = <span class="r91 r">scriptDebugData</span>.<span class="i">Item2</span>;
            <a href="#17696cabffcce66b" class="i method">SetPendingBreakpoints</a>(<span class="r90 r">functionContext</span>);
        }
 
        <span class="c">// Called after exiting the script function, called once for each dynamicparam, begin, or end</span>
        <span class="c">// block, and once for each object written to the pipeline.  Also called when leaving a trap.</span>
        <b>internal void</b> <a id="451ba0d74b794f44" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ExitScriptFunction</a>()
        {
            <span class="c">// If it&#39;s stepping over to exit the current frame, we need to clear the _overOrOutFrame,</span>
            <span class="c">// so that we will stop at the next statement in the outer frame.</span>
            <b>if</b> (<a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#15bc8b05295691f1" class="i method">Last</a>() == <a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a>)
            {
                <a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a> = <b>null</b>;
            }
 
            <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<span class="i">RemoveAt</span>(<a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#5363f64d745abb81" class="i property">Count</a> - 1);
 
            <span class="c">// Don&#39;t disable step mode if the user enabled runspace debugging (UnhandledBreakpointMode == Wait)</span>
            <b>if</b> ((<a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#5363f64d745abb81" class="i property">Count</a> == 0) &amp;&amp; (<a href="#b0571e2bdd2e6b30" class="i property">UnhandledBreakpointMode</a> != <a href="#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="#acf1bcf988b9a342" class="i field">Wait</a>))
            {
                <span class="c">// If we&#39;ve popped the last entry, don&#39;t step into anything else (like prompt, suggestions, etc.)</span>
                <a href="#57792450deac46c7" class="i field">_steppingMode</a> = <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#adb717584e0b9060" class="i field">None</a>;
                <a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a> = <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>;
                <a href="#f189a5931f8867de" class="i field">_previousDebuggerAction</a> = <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>;
            }
        }
 
        <b>internal void</b> <a id="938d448a012b94dd" href="../../R/938d448a012b94dd.html" target="n" data-glyph="74,1" class="i method">RegisterScriptFile</a>(<a href="../ExternalScriptInfo.cs.html#7806ac40f903221c" class="t t">ExternalScriptInfo</a> <span id="r93 rd" class="r93 r">scriptCommandInfo</span>)
        {
            <a href="#baf787c196718d1a" class="i method">RegisterScriptFile</a>(<span class="r93 r">scriptCommandInfo</span>.<a href="../ExternalScriptInfo.cs.html#ba1a326ad41ce463" class="i property">Path</a>, <span class="r93 r">scriptCommandInfo</span>.<a href="../ExternalScriptInfo.cs.html#9f9388511bd97894" class="i property">ScriptContents</a>);
        }
 
        <b>internal void</b> <a id="baf787c196718d1a" href="../../R/baf787c196718d1a.html" target="n" data-glyph="74,1" class="i method">RegisterScriptFile</a>(<b>string</b> <span id="r94 rd" class="r94 r">path</span>, <b>string</b> <span id="r95 rd" class="r95 r">scriptContents</span>)
        {
            <span class="i">Tuple</span>&lt;<span class="i">WeakReference</span>, <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;&gt; <span id="r96 rd" class="r96 r">boundBreakpoints</span>;
            <b>if</b> (!<a href="#2dd2911da87db3b5" class="i field">_boundBreakpoints</a>.<span class="i">TryGetValue</span>(<span class="r94 r">path</span>, <b>out</b> <span class="r96 r">boundBreakpoints</span>))
            {
                <a href="#2dd2911da87db3b5" class="i field">_boundBreakpoints</a>[<span class="r94 r">path</span>] = <span class="i">Tuple</span>.<span class="i">Create</span>(<b>new</b> <span class="i">WeakReference</span>(<span class="r95 r">scriptContents</span>), <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;());
            }
            <b>else</b>
            {
                <span class="c">// If script contents have changed, or if the file got collected, we must rebind the breakpoints.</span>
                <b>string</b> <span id="r97 rd" class="r97 r">oldScriptContents</span>;
                <span class="r96 r">boundBreakpoints</span>.<span class="i">Item1</span>.<span class="i">TryGetTarget</span>(<b>out</b> <span class="r97 r">oldScriptContents</span>);
                <b>if</b> (<span class="r97 r">oldScriptContents</span> == <b>null</b> || !<span class="r97 r">oldScriptContents</span>.<span class="i">Equals</span>(<span class="r95 r">scriptContents</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                {
                    <span class="i">UnbindBoundBreakpoints</span>(<span class="r96 r">boundBreakpoints</span>.<span class="i">Item2</span>.<span class="i">Values</span>.<span class="i">ToList</span>());
                    <a href="#2dd2911da87db3b5" class="i field">_boundBreakpoints</a>[<span class="r94 r">path</span>] = <span class="i">Tuple</span>.<span class="i">Create</span>(<b>new</b> <span class="i">WeakReference</span>(<span class="r95 r">scriptContents</span>), <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;());
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Call stack management
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> setting breakpoints
 
        <b>internal void</b> <a id="346ce3bcd910bdc5" href="../../R/346ce3bcd910bdc5.html" target="n" data-glyph="74,1" class="i method">AddBreakpointCommon</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r98 rd" class="r98 r">breakpoint</span>)
        {
            <b>if</b> (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> == 0)
            {
                <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a>);
            }
 
            <a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>[<span class="r98 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>] = <span class="r98 r">breakpoint</span>;
            <a href="#4245de486881076b" class="i method">OnBreakpointUpdated</a>(<b>new</b> <span class="t">BreakpointUpdatedEventArgs</span>(<span class="r98 r">breakpoint</span>, <a href="#7f495a71915b9312" class="t t">BreakpointUpdateType</a>.<a href="#215e5f765054ee2a" class="i field">Set</a>, <a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">Count</span>));
        }
 
        <b>private</b> <a href="Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a> <a id="c7be3f4755da95f2" href="../../R/c7be3f4755da95f2.html" target="n" data-glyph="76,1" class="i method">AddCommandBreakpoint</a>(<a href="Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a> <span id="r99 rd" class="r99 r">breakpoint</span>)
        {
            <a href="#346ce3bcd910bdc5" class="i method">AddBreakpointCommon</a>(<span class="r99 r">breakpoint</span>);
            <a href="#d14cf615f134d325" class="i field">_commandBreakpoints</a>[<span class="r99 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>] = <span class="r99 r">breakpoint</span>;
            <b>return</b> <span class="r99 r">breakpoint</span>;
        }
 
        <b>private</b> <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <a id="68db037b8e80c938" href="../../R/68db037b8e80c938.html" target="n" data-glyph="76,1" class="i method">AddLineBreakpoint</a>(<a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <span id="r100 rd" class="r100 r">breakpoint</span>)
        {
            <a href="#346ce3bcd910bdc5" class="i method">AddBreakpointCommon</a>(<span class="r100 r">breakpoint</span>);
            <a href="#97a66285c6d64854" class="i field">_pendingBreakpoints</a>[<span class="r100 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>] = <span class="r100 r">breakpoint</span>;
            <b>return</b> <span class="r100 r">breakpoint</span>;
        }
 
        <b>private void</b> <a id="a7c819ca75ee2b43" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">AddNewBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r101 rd" class="r101 r">breakpoint</span>)
        {
            <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <span id="r102 rd" class="r102 r">lineBreakpoint</span> = <span class="r101 r">breakpoint</span> <b>as</b> <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>;
            <b>if</b> (<span class="r102 r">lineBreakpoint</span> != <b>null</b>)
            {
                <a href="#68db037b8e80c938" class="i method">AddLineBreakpoint</a>(<span class="r102 r">lineBreakpoint</span>);
                <b>return</b>;
            }
 
            <a href="Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a> <span id="r103 rd" class="r103 r">cmdBreakpoint</span> = <span class="r101 r">breakpoint</span> <b>as</b> <a href="Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a>;
            <b>if</b> (<span class="r103 r">cmdBreakpoint</span> != <b>null</b>)
            {
                <a href="#c7be3f4755da95f2" class="i method">AddCommandBreakpoint</a>(<span class="r103 r">cmdBreakpoint</span>);
                <b>return</b>;
            }
 
            <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a> <span id="r104 rd" class="r104 r">varBreakpoint</span> = <span class="r101 r">breakpoint</span> <b>as</b> <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a>;
            <b>if</b> (<span class="r104 r">varBreakpoint</span> != <b>null</b>)
            {
                <a href="#013e6d9a23e184cd" class="i method">AddVariableBreakpoint</a>(<span class="r104 r">varBreakpoint</span>);
            }
        }
 
        <b>internal</b> <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a> <a id="013e6d9a23e184cd" href="../../R/013e6d9a23e184cd.html" target="n" data-glyph="74,1" class="i method">AddVariableBreakpoint</a>(<a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a> <span id="r105 rd" class="r105 r">breakpoint</span>)
        {
            <a href="#346ce3bcd910bdc5" class="i method">AddBreakpointCommon</a>(<span class="r105 r">breakpoint</span>);
 
            <b>if</b> (!<a href="#a8f3199e0f8f72b3" class="i field">_variableBreakpoints</a>.<span class="i">TryGetValue</span>(<span class="r105 r">breakpoint</span>.<a href="Breakpoint.cs.html#b6d982265e41af94" class="i property">Variable</a>, <b>out</b> <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a>&gt; <span id="r106 rd" class="r106 r">breakpoints</span>))
            {
                <span class="r106 r">breakpoints</span> = <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a>&gt;();
                <a href="#a8f3199e0f8f72b3" class="i field">_variableBreakpoints</a>[<span class="r105 r">breakpoint</span>.<a href="Breakpoint.cs.html#b6d982265e41af94" class="i property">Variable</a>] = <span class="r106 r">breakpoints</span>;
            }
 
            <span class="r106 r">breakpoints</span>[<span class="r105 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>] = <span class="r105 r">breakpoint</span>;
            <b>return</b> <span class="r105 r">breakpoint</span>;
        }
 
        <b>private void</b> <a id="fc08051035722807" href="../../R/fc08051035722807.html" target="n" data-glyph="76,1" class="i method">UpdateBreakpoints</a>(<a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a> <span id="r107 rd" class="r107 r">functionContext</span>)
        {
            <b>if</b> (<span class="r107 r">functionContext</span>.<a href="../parser/Compiler.cs.html#cc249a58ac34eb70" class="i field">_breakPoints</a> == <b>null</b>)
            {
                <span class="c">// This should be rare - setting a breakpoint inside a script, but debugger hadn&#39;t started.</span>
                <a href="#36cfb4e447c722e7" class="i method">SetupBreakpoints</a>(<span class="r107 r">functionContext</span>);
            }
            <b>else</b>
            {
                <span class="c">// Check pending breakpoints to see if any apply to this script.</span>
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r107 r">functionContext</span>.<a href="../parser/Compiler.cs.html#95a73081cffaa015" class="i field">_file</a>))
                {
                    <b>return</b>;
                }
 
                <b>foreach</b> ((<b>int</b> <span id="r108 rd" class="r108 r">breakpointId</span>, <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <span id="r109 rd" class="r109 r">item</span>) <b>in</b> <a href="#97a66285c6d64854" class="i field">_pendingBreakpoints</a>)
                {
                    <b>if</b> (<span class="r109 r">item</span>.<a href="Breakpoint.cs.html#7489f46dc82c6868" class="i property">IsScriptBreakpoint</a> &amp;&amp; <span class="r109 r">item</span>.<a href="Breakpoint.cs.html#5521b2e7a0a6fbed" class="i property">Script</a>.<span class="i">Equals</span>(<span class="r107 r">functionContext</span>.<a href="../parser/Compiler.cs.html#95a73081cffaa015" class="i field">_file</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <a href="#17696cabffcce66b" class="i method">SetPendingBreakpoints</a>(<span class="r107 r">functionContext</span>);
                        <b>break</b>;
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raises the BreakpointUpdated event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r110 r">e</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="4245de486881076b" href="../../R/4245de486881076b.html" target="n" data-glyph="76,1" class="i method">OnBreakpointUpdated</a>(<a href="#6136821c0d0fb181" class="t t">BreakpointUpdatedEventArgs</a> <span id="r110 rd" class="r110 r">e</span>)
        {
            <a href="#8aab7ff30ec5430c" class="i method">RaiseBreakpointUpdatedEvent</a>(<span class="r110 r">e</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> setting breakpoints
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> removing breakpoints
 
        <b>internal bool</b> <a id="e03cf64ebd665db7" href="../../R/e03cf64ebd665db7.html" target="n" data-glyph="74,1" class="i method">RemoveVariableBreakpoint</a>(<a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a> <span id="r111 rd" class="r111 r">breakpoint</span>) =&gt;
            <a href="#a8f3199e0f8f72b3" class="i field">_variableBreakpoints</a>[<span class="r111 r">breakpoint</span>.<a href="Breakpoint.cs.html#b6d982265e41af94" class="i property">Variable</a>].<span class="i">Remove</span>(<span class="r111 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>, <b>out _</b>);
 
        <b>internal bool</b> <a id="7cb6adb8d0f66f18" href="../../R/7cb6adb8d0f66f18.html" target="n" data-glyph="74,1" class="i method">RemoveCommandBreakpoint</a>(<a href="Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a> <span id="r112 rd" class="r112 r">breakpoint</span>) =&gt;
            <a href="#d14cf615f134d325" class="i field">_commandBreakpoints</a>.<span class="i">Remove</span>(<span class="r112 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>, <b>out _</b>);
 
        <b>internal bool</b> <a id="06a98484e689b6a1" href="../../R/06a98484e689b6a1.html" target="n" data-glyph="74,1" class="i method">RemoveLineBreakpoint</a>(<a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <span id="r113 rd" class="r113 r">breakpoint</span>)
        {
            <b>bool</b> <span id="r114 rd" class="r114 r">removed</span> = <a href="#97a66285c6d64854" class="i field">_pendingBreakpoints</a>.<span class="i">Remove</span>(<span class="r113 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>, <b>out _</b>);
 
            <span class="i">Tuple</span>&lt;<span class="i">WeakReference</span>, <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;&gt; <span id="r115 rd" class="r115 r">value</span>;
            <b>if</b> (<a href="#2dd2911da87db3b5" class="i field">_boundBreakpoints</a>.<span class="i">TryGetValue</span>(<span class="r113 r">breakpoint</span>.<a href="Breakpoint.cs.html#5521b2e7a0a6fbed" class="i property">Script</a>, <b>out</b> <span class="r115 r">value</span>))
            {
                <span class="r114 r">removed</span> = <span class="r115 r">value</span>.<span class="i">Item2</span>.<span class="i">Remove</span>(<span class="r113 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>, <b>out _</b>);
            }
 
            <b>return</b> <span class="r114 r">removed</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> removing breakpoints
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> finding breakpoints
 
        <span class="c">// The bit array is used to detect if a breakpoint is set or not for a given scriptblock.  This bit array</span>
        <span class="c">// is checked when hitting sequence points.  Enabling/disabling a line breakpoint is as simple as flipping</span>
        <span class="c">// the bit.</span>
        <b>private readonly</b> <span class="i">ConditionalWeakTable</span>&lt;<a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>[], <span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;, <span class="i">BitArray</span>&gt;&gt; <a id="2210092054c29bc9" href="../../R/2210092054c29bc9.html" target="n" data-glyph="46,1" class="i field">_mapScriptToBreakpoints</a> =
            <b>new</b> <span class="i">ConditionalWeakTable</span>&lt;<a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>[], <span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;, <span class="i">BitArray</span>&gt;&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks for command breakpoints.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="ab0382a7b993ff7c" href="../../R/ab0382a7b993ff7c.html" target="n" data-glyph="74,1" class="i method">CheckCommand</a>(<a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r116 rd" class="r116 r">invocationInfo</span>)
        {
            <a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="k">var</a> <span id="r117 rd" class="r117 r">functionContext</span> = <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#25f0ee99bdf10600" class="i method">LastFunctionContext</a>();
            <b>if</b> (<span class="r117 r">functionContext</span> != <b>null</b> &amp;&amp; <span class="r117 r">functionContext</span>.<a href="../parser/Compiler.cs.html#f9539890beb6e765" class="i field">_debuggerHidden</a>)
            {
                <span class="c">// Never stop in DebuggerHidden scripts, don&#39;t even call the actions on breakpoints.</span>
                <b>return</b> <b>false</b>;
            }
 
            <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r118 rd" class="r118 r">breakpoints</span> =
                <a href="#d14cf615f134d325" class="i field">_commandBreakpoints</a>.<span class="i">Values</span>.<span class="i">Where</span>(<span id="r119 rd" class="r119 r">bp</span> =&gt; <span class="r119 r">bp</span>.<span class="i">Enabled</span> &amp;&amp; <span class="r119 r">bp</span>.<span class="i">Trigger</span>(<span class="r116 r">invocationInfo</span>)).<span class="i">ToList</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;();
 
            <b>bool</b> <span id="r120 rd" class="r120 r">checkLineBp</span> = <b>true</b>;
            <b>if</b> (<span class="r118 r">breakpoints</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r118 r">breakpoints</span> = <a href="#a997613544759f77" class="i method">TriggerBreakpoints</a>(<span class="r118 r">breakpoints</span>);
                <b>if</b> (<span class="r118 r">breakpoints</span>.<span class="i">Count</span> &gt; 0)
                {
                    <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="k">var</a> <span id="r121 rd" class="r121 r">breakInvocationInfo</span> =
                        <span class="r117 r">functionContext</span> != <b>null</b>
                            ? <b>new</b> <a href="../InvocationInfo.cs.html#73425a3cbc3397ab" class="t constructor">InvocationInfo</a>(<span class="r116 r">invocationInfo</span>.<a href="../InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>, <span class="r117 r">functionContext</span>.<a href="../parser/Compiler.cs.html#5ed77de1a1fe863f" class="i property">CurrentPosition</a>)
                            : <b>null</b>;
                    <a href="#9caedf6d2d0bf41f" class="i method">OnDebuggerStop</a>(<span class="r121 r">breakInvocationInfo</span>, <span class="r118 r">breakpoints</span>);
                    <span class="r120 r">checkLineBp</span> = <b>false</b>;
                }
            }
 
            <b>return</b> <span class="r120 r">checkLineBp</span>;
        }
 
        <b>internal void</b> <a id="3c4ec1f57b035743" href="../../R/3c4ec1f57b035743.html" target="n" data-glyph="74,1" class="i method">CheckVariableRead</a>(<b>string</b> <span id="r122 rd" class="r122 r">variableName</span>)
        {
            <b>var</b> <span id="r123 rd" class="r123 r">breakpointsToTrigger</span> = <a href="#d51327f766b49fd1" class="i method">GetVariableBreakpointsToTrigger</a>(<span class="r122 r">variableName</span>, <span class="r124 r">read</span>: <b>true</b>);
            <b>if</b> (<span class="r123 r">breakpointsToTrigger</span> != <b>null</b> &amp;&amp; <span class="r123 r">breakpointsToTrigger</span>.<span class="i">Count</span> &gt; 0)
            {
                <a href="#62931ee7ec0bf074" class="i method">TriggerVariableBreakpoints</a>(<span class="r123 r">breakpointsToTrigger</span>);
            }
        }
 
        <b>internal void</b> <a id="770e2afe051213fb" href="../../R/770e2afe051213fb.html" target="n" data-glyph="74,1" class="i method">CheckVariableWrite</a>(<b>string</b> <span id="r125 rd" class="r125 r">variableName</span>)
        {
            <b>var</b> <span id="r126 rd" class="r126 r">breakpointsToTrigger</span> = <a href="#d51327f766b49fd1" class="i method">GetVariableBreakpointsToTrigger</a>(<span class="r125 r">variableName</span>, <span class="r124 r">read</span>: <b>false</b>);
            <b>if</b> (<span class="r126 r">breakpointsToTrigger</span> != <b>null</b> &amp;&amp; <span class="r126 r">breakpointsToTrigger</span>.<span class="i">Count</span> &gt; 0)
            {
                <a href="#62931ee7ec0bf074" class="i method">TriggerVariableBreakpoints</a>(<span class="r126 r">breakpointsToTrigger</span>);
            }
        }
 
        <b>private</b> <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a>&gt; <a id="d51327f766b49fd1" href="../../R/d51327f766b49fd1.html" target="n" data-glyph="76,1" class="i method">GetVariableBreakpointsToTrigger</a>(<b>string</b> <span id="r127 rd" class="r127 r">variableName</span>, <b>bool</b> <span id="r124 rd" class="r124 r">read</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> == 1, <span class="s">&quot;breakpoints only hit when debugging mode is 1&quot;</span>);
 
            <a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="k">var</a> <span id="r128 rd" class="r128 r">functionContext</span> = <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#25f0ee99bdf10600" class="i method">LastFunctionContext</a>();
            <b>if</b> (<span class="r128 r">functionContext</span> != <b>null</b> &amp;&amp; <span class="r128 r">functionContext</span>.<a href="../parser/Compiler.cs.html#f9539890beb6e765" class="i field">_debuggerHidden</a>)
            {
                <span class="c">// Never stop in DebuggerHidden scripts, don&#39;t even call the action on any breakpoint.</span>
                <b>return</b> <b>null</b>;
            }
 
            <b>try</b>
            {
                <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#1f2f5fbf58d44eb7" class="i field">Disabled</a>);
 
                <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a>&gt; <span id="r129 rd" class="r129 r">breakpoints</span>;
                <b>if</b> (!<a href="#a8f3199e0f8f72b3" class="i field">_variableBreakpoints</a>.<span class="i">TryGetValue</span>(<span class="r127 r">variableName</span>, <b>out</b> <span class="r129 r">breakpoints</span>))
                {
                    <span class="c">// $PSItem is an alias for $_.  We don&#39;t use PSItem internally, but a user might</span>
                    <span class="c">// have set a bp on $PSItem, so look for that if appropriate.</span>
                    <b>if</b> (<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#e38a238f80434569" class="i method">IsUnderbar</a>(<span class="r127 r">variableName</span>))
                    {
                        <a href="#a8f3199e0f8f72b3" class="i field">_variableBreakpoints</a>.<span class="i">TryGetValue</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#f10afee675f645d4" class="i field">PSItem</a>, <b>out</b> <span class="r129 r">breakpoints</span>);
                    }
                }
 
                <b>if</b> (<span class="r129 r">breakpoints</span> == <b>null</b>)
                    <b>return</b> <b>null</b>;
 
                <a href="#66c884979ca0dfea" class="k">var</a> <span id="r130 rd" class="r130 r">callStackInfo</span> = <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#15bc8b05295691f1" class="i method">Last</a>();
                <b>var</b> <span id="r131 rd" class="r131 r">currentScriptFile</span> = <span class="r130 r">callStackInfo</span>?.<a href="#7f39291e46a51014" class="i property">File</a>;
                <b>return</b> <span class="r129 r">breakpoints</span>.<span class="i">Values</span>.<span class="i">Where</span>(<span id="r132 rd" class="r132 r">bp</span> =&gt; <span class="r132 r">bp</span>.<span class="i">Trigger</span>(<span class="r131 r">currentScriptFile</span>, <span class="i">read</span>: <span class="r124 r">read</span>)).<span class="i">ToList</span>();
            }
            <b>finally</b>
            {
                <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a>);
            }
        }
 
        <b>internal void</b> <a id="62931ee7ec0bf074" href="../../R/62931ee7ec0bf074.html" target="n" data-glyph="74,1" class="i method">TriggerVariableBreakpoints</a>(<span class="i">List</span>&lt;<a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a>&gt; <span id="r133 rd" class="r133 r">breakpoints</span>)
        {
            <a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="k">var</a> <span id="r134 rd" class="r134 r">functionContext</span> = <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#25f0ee99bdf10600" class="i method">LastFunctionContext</a>();
            <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="k">var</a> <span id="r135 rd" class="r135 r">invocationInfo</span> = <span class="r134 r">functionContext</span> != <b>null</b> ? <b>new</b> <a href="../InvocationInfo.cs.html#05f8dff4c341ddae" class="t constructor">InvocationInfo</a>(<b>null</b>, <span class="r134 r">functionContext</span>.<a href="../parser/Compiler.cs.html#5ed77de1a1fe863f" class="i property">CurrentPosition</a>, <a href="#3ac4e385b52c3ec7" class="i field">_context</a>) : <b>null</b>;
            <span class="i">OnDebuggerStop</span>(<span class="r135 r">invocationInfo</span>, <span class="r133 r">breakpoints</span>.<span class="i">ToList</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;());
        }
 
        <span class="c">// Return the line breakpoints bound in a specific script block (used when a sequence point</span>
        <span class="c">// is hit, to find which breakpoints are set on that sequence point.)</span>
        <b>internal</b> <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt; <a id="5afee0f4c79cede4" href="../../R/5afee0f4c79cede4.html" target="n" data-glyph="74,1" class="i method">GetBoundBreakpoints</a>(<a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>[] <span id="r136 rd" class="r136 r">sequencePoints</span>)
        {
            <span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;, <span class="i">BitArray</span>&gt; <span id="r137 rd" class="r137 r">tuple</span>;
            <b>if</b> (<a href="#2210092054c29bc9" class="i field">_mapScriptToBreakpoints</a>.<span class="i">TryGetValue</span>(<span class="r136 r">sequencePoints</span>, <b>out</b> <span class="r137 r">tuple</span>))
            {
                <b>return</b> <span class="r137 r">tuple</span>.<span class="i">Item1</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> finding breakpoints
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> triggering breakpoints
 
        <b>private</b> <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <a id="a997613544759f77" href="../../R/a997613544759f77.html" target="n" data-glyph="76,1" class="i method">TriggerBreakpoints</a>(<span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r138 rd" class="r138 r">breakpoints</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> == 1, <span class="s">&quot;breakpoints only hit when debugging mode == 1&quot;</span>);
 
            <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r139 rd" class="r139 r">breaks</span> = <b>new</b> <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;();
            <b>try</b>
            {
                <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#d1aba08a1f9eb55e" class="i field">InScriptStop</a>);
                <b>foreach</b> (<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r140 rd" class="r140 r">breakpoint</span> <b>in</b> <span class="r138 r">breakpoints</span>)
                {
                    <b>if</b> (<span class="r140 r">breakpoint</span>.<a href="Breakpoint.cs.html#60b65068b60905e1" class="i property">Enabled</a>)
                    {
                        <b>try</b>
                        {
                            <span class="c">// Ensure that code being processed during breakpoint triggers</span>
                            <span class="c">// act like they are broken into the debugger.</span>
                            <a href="#b7ae8b1cf06dec15" class="i field">_inBreakpoint</a> = <b>true</b>;
                            <b>if</b> (<span class="r140 r">breakpoint</span>.<a href="Breakpoint.cs.html#4ed764a16b64d0f0" class="i method">Trigger</a>() == <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>.<a href="Breakpoint.cs.html#22f13b1f208ff153" class="t t">BreakpointAction</a>.<a href="Breakpoint.cs.html#7f29df80df696e42" class="i field">Break</a>)
                            {
                                <span class="r139 r">breaks</span>.<span class="i">Add</span>(<span class="r140 r">breakpoint</span>);
                            }
                        }
                        <b>finally</b>
                        {
                            <a href="#b7ae8b1cf06dec15" class="i field">_inBreakpoint</a> = <b>false</b>;
                        }
                    }
                }
            }
            <b>finally</b>
            {
                <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a>);
            }
 
            <b>return</b> <span class="r139 r">breaks</span>;
        }
 
        <b>internal void</b> <a id="26eb6130f2e56174" href="../../R/26eb6130f2e56174.html" target="n" data-glyph="74,1" class="i method">OnSequencePointHit</a>(<a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a> <span id="r141 rd" class="r141 r">functionContext</span>)
        {
            <b>if</b> (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#6cd076ce305ba4ac" class="i property">ShouldTraceStatement</a> &amp;&amp; !<a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#15bc8b05295691f1" class="i method">Last</a>().<a href="#70b28df388667277" class="i property">IsFrameHidden</a> &amp;&amp; !<span class="r141 r">functionContext</span>.<a href="../parser/Compiler.cs.html#f82ab745f95a8791" class="i field">_debuggerStepThrough</a>)
            {
                <a href="#9894fc03b2569895" class="i method">TraceLine</a>(<span class="r141 r">functionContext</span>.<a href="../parser/Compiler.cs.html#5ed77de1a1fe863f" class="i property">CurrentPosition</a>);
            }
 
            <span class="c">// If a nested debugger received a stop debug command then all debugging</span>
            <span class="c">// should stop.</span>
            <b>if</b> (<a href="#822a39b6aaf94b98" class="i field">_nestedDebuggerStop</a>)
            {
                <a href="#822a39b6aaf94b98" class="i field">_nestedDebuggerStop</a> = <b>false</b>;
                <a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a> = <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>;
                <a href="#27abb455d0aa0716" class="i method">ResumeExecution</a>(<a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#9c143ec10eabd6ad" class="i field">Stop</a>);
            }
 
            <a href="#fc08051035722807" class="i method">UpdateBreakpoints</a>(<span class="r141 r">functionContext</span>);
 
            <b>if</b> (<a href="#57792450deac46c7" class="i field">_steppingMode</a> == <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#b13a6fed8931e742" class="i field">StepIn</a> &amp;&amp;
                (<a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a> == <b>null</b> || <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#15bc8b05295691f1" class="i method">Last</a>() == <a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a>))
            {
                <b>if</b> (!<a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#15bc8b05295691f1" class="i method">Last</a>().<a href="#70b28df388667277" class="i property">IsFrameHidden</a>)
                {
                    <a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a> = <b>null</b>;
                    <a href="#60eef3efd8d15536" class="i method">StopOnSequencePoint</a>(<span class="r141 r">functionContext</span>, <a href="#66088c813d15db4b" class="i field">s_emptyBreakpointList</a>);
                }
                <b>else</b> <b>if</b> (<a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a> == <b>null</b>)
                {
                    <span class="c">// Treat like step out, but only if we&#39;re not already stepping out</span>
                    <a href="#27abb455d0aa0716" class="i method">ResumeExecution</a>(<a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#4cfb4add3c03409c" class="i field">StepOut</a>);
                }
            }
            <b>else</b>
            {
                <b>if</b> (<span class="r141 r">functionContext</span>.<a href="../parser/Compiler.cs.html#cc249a58ac34eb70" class="i field">_breakPoints</a>[<span class="r141 r">functionContext</span>.<a href="../parser/Compiler.cs.html#16213bb1bf477e12" class="i field">_currentSequencePointIndex</a>])
                {
                    <b>var</b> <span id="r142 rd" class="r142 r">breakpoints</span> = (<b>from</b> <span class="i">breakpoint</span> <b>in</b> <span class="r141 r">functionContext</span>.<a href="../parser/Compiler.cs.html#18b1921c6a906819" class="i field">_boundBreakpoints</a>
                                       <b>where</b>
                                           <span class="i">breakpoint</span>.<span class="i">SequencePointIndex</span> == <span class="r141 r">functionContext</span>.<a href="../parser/Compiler.cs.html#16213bb1bf477e12" class="i field">_currentSequencePointIndex</a> &amp;&amp;
                                           <span class="i">breakpoint</span>.<span class="i">Enabled</span>
                                       <b>select</b> <span class="i">breakpoint</span>).<span class="i">ToList</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;();
 
                    <span class="r142 r">breakpoints</span> = <span class="i">TriggerBreakpoints</span>(<span class="r142 r">breakpoints</span>);
                    <b>if</b> (<span class="r142 r">breakpoints</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <span class="i">StopOnSequencePoint</span>(<span class="r141 r">functionContext</span>, <span class="r142 r">breakpoints</span>);
                    }
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> triggering breakpoints
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> internal methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private members
 
        [<span class="i">DebuggerDisplay</span>(<span class="s">&quot;{FunctionContext.CurrentPosition}&quot;</span>)]
        <b>private sealed class</b> <a id="66c884979ca0dfea" href="../../R/66c884979ca0dfea.html" target="n" data-glyph="4,1" class="t t"><span id="bc47a236cef9f1dd">CallStackInfo</span></a>
        {
            <b>internal</b> <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="481bca89fc49aa62" href="../../R/481bca89fc49aa62.html" target="n" data-glyph="104,2" class="i property">InvocationInfo</a> { <b>get</b>; <b>set</b>; }
 
            <b>internal string</b> <a id="7f39291e46a51014" href="../../R/7f39291e46a51014.html" target="n" data-glyph="104,2" class="i property">File</a> { <b>get</b>; <b>set</b>; }
 
            <b>internal bool</b> <a id="d539d16001c53c61" href="../../R/d539d16001c53c61.html" target="n" data-glyph="104,2" class="i property">DebuggerStepThrough</a> { <b>get</b>; <b>set</b>; }
 
            <b>internal</b> <a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a> <a id="9ad2e5e18339a674" href="../../R/9ad2e5e18339a674.html" target="n" data-glyph="104,2" class="i property">FunctionContext</a> { <b>get</b>; <b>set</b>; }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> The frame is hidden due to the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">DebuggerHiddenAttribute</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> attribute.</span>
            <span class="c">///</span><span class="c"> No breakpoints will be set and no stepping in/through.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal bool</b> <a id="70b28df388667277" href="../../R/70b28df388667277.html" target="n" data-glyph="104,2" class="i property">IsFrameHidden</a> { <b>get</b>; <b>set</b>; }
 
            <b>internal bool</b> <a id="51d1e1787f80eb08" href="../../R/51d1e1787f80eb08.html" target="n" data-glyph="104,2" class="i property">TopFrameAtBreakpoint</a> { <b>get</b>; <b>set</b>; }
        }
 
        <b>private struct</b> <a id="5fb4cb1a539d006c" href="../../R/5fb4cb1a539d006c.html" target="n" data-glyph="112,1" class="t t"><span id="fc88d0372a756b86">CallStackList</span></a>
        {
            <b>internal</b> <span class="i">List</span>&lt;<a href="#66c884979ca0dfea" class="t t">CallStackInfo</a>&gt; <a id="63918689f41a062f" href="../../R/63918689f41a062f.html" target="n" data-glyph="44,2" class="i field">_callStackList</a>;
 
            <b>internal void</b> <a id="a9b1f531d32a7876" href="../../R/a9b1f531d32a7876.html" target="n" data-glyph="74,2" class="i method">Add</a>(<a href="#66c884979ca0dfea" class="t t">CallStackInfo</a> <span id="r143 rd" class="r143 r">item</span>)
            {
                <b>lock</b> (<a href="#63918689f41a062f" class="i field">_callStackList</a>)
                {
                    <a href="#63918689f41a062f" class="i field">_callStackList</a>.<span class="i">Add</span>(<span class="r143 r">item</span>);
                }
            }
 
            <b>internal void</b> <a id="ca5345631b476d74" href="../../R/../../0000000000.html" target="n" data-glyph="74,2" class="i method">RemoveAt</a>(<b>int</b> <span id="r144 rd" class="r144 r">index</span>)
            {
                <b>lock</b> (<a href="#63918689f41a062f" class="i field">_callStackList</a>)
                {
                    <a href="#63918689f41a062f" class="i field">_callStackList</a>.<span class="i">RemoveAt</span>(<span class="r144 r">index</span>);
                }
            }
 
            <b>internal</b> <a href="#66c884979ca0dfea" class="t t">CallStackInfo</a> <a id="ac521f582c8777ce" href="../../R/../../0000000000.html" target="n" data-glyph="104,2" class="k">this</a>[<b>int</b> <span id="r145 rd" class="r145 r">index</span>]
            {
                <b>get</b>
                {
                    <b>lock</b> (<a href="#63918689f41a062f" class="i field">_callStackList</a>)
                    {
                        <b>return</b> ((<span class="r145 r">index</span> &gt; -1) &amp;&amp; (<span class="r145 r">index</span> &lt; <a href="#63918689f41a062f" class="i field">_callStackList</a>.<span class="i">Count</span>)) ? <a href="#63918689f41a062f" class="i field">_callStackList</a>[<span class="r145 r">index</span>] : <b>null</b>;
                    }
                }
            }
 
            <b>internal</b> <a href="#66c884979ca0dfea" class="t t">CallStackInfo</a> <a id="15bc8b05295691f1" href="../../R/15bc8b05295691f1.html" target="n" data-glyph="74,2" class="i method">Last</a>()
            {
                <b>lock</b> (<a href="#63918689f41a062f" class="i field">_callStackList</a>)
                {
                    <b>return</b> (<a href="#63918689f41a062f" class="i field">_callStackList</a>.<span class="i">Count</span> &gt; 0) ? <a href="#63918689f41a062f" class="i field">_callStackList</a>[<a href="#63918689f41a062f" class="i field">_callStackList</a>.<span class="i">Count</span> - 1] : <b>null</b>;
                }
            }
 
            <b>internal</b> <a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a> <a id="25f0ee99bdf10600" href="../../R/25f0ee99bdf10600.html" target="n" data-glyph="74,2" class="i method">LastFunctionContext</a>()
            {
                <a href="#66c884979ca0dfea" class="k">var</a> <span id="r146 rd" class="r146 r">last</span> = <a href="#15bc8b05295691f1" class="i method">Last</a>();
                <b>return</b> <span class="r146 r">last</span>?.<a href="#9ad2e5e18339a674" class="i property">FunctionContext</a>;
            }
 
            <b>internal bool</b> <a id="7a7dfc2db85e866b" href="../../R/7a7dfc2db85e866b.html" target="n" data-glyph="74,2" class="i method">Any</a>()
            {
                <b>lock</b> (<a href="#63918689f41a062f" class="i field">_callStackList</a>)
                {
                    <b>return</b> <a href="#63918689f41a062f" class="i field">_callStackList</a>.<span class="i">Count</span> &gt; 0;
                }
            }
 
            <b>internal int</b> <a id="5363f64d745abb81" href="../../R/5363f64d745abb81.html" target="n" data-glyph="104,2" class="i property">Count</a>
            {
                <b>get</b>
                {
                    <b>lock</b> (<a href="#63918689f41a062f" class="i field">_callStackList</a>)
                    {
                        <b>return</b> <a href="#63918689f41a062f" class="i field">_callStackList</a>.<span class="i">Count</span>;
                    }
                }
            }
 
            <b>internal</b> <a href="#66c884979ca0dfea" class="t t">CallStackInfo</a>[] <a id="6f7061c54999061a" href="../../R/6f7061c54999061a.html" target="n" data-glyph="74,2" class="i method">ToArray</a>()
            {
                <b>lock</b> (<a href="#63918689f41a062f" class="i field">_callStackList</a>)
                {
                    <b>return</b> <a href="#63918689f41a062f" class="i field">_callStackList</a>.<span class="i">ToArray</span>();
                }
            }
 
            <b>internal void</b> <a id="999521af0ad95f60" href="../../R/999521af0ad95f60.html" target="n" data-glyph="74,2" class="i method">Clear</a>()
            {
                <b>lock</b> (<a href="#63918689f41a062f" class="i field">_callStackList</a>)
                {
                    <a href="#63918689f41a062f" class="i field">_callStackList</a>.<span class="i">Clear</span>();
                }
            }
        }
 
        <b>private readonly</b> <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="3ac4e385b52c3ec7" href="../../R/3ac4e385b52c3ec7.html" target="n" data-glyph="46,1" class="i field">_context</a>;
        <b>private</b> <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt; <a id="97a66285c6d64854" href="../../R/97a66285c6d64854.html" target="n" data-glyph="46,1" class="i field">_pendingBreakpoints</a>;
        <b>private readonly</b> <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<span class="i">WeakReference</span>, <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;&gt;&gt; <a id="2dd2911da87db3b5" href="../../R/2dd2911da87db3b5.html" target="n" data-glyph="46,1" class="i field">_boundBreakpoints</a>;
        <b>private readonly</b> <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a>&gt; <a id="d14cf615f134d325" href="../../R/d14cf615f134d325.html" target="n" data-glyph="46,1" class="i field">_commandBreakpoints</a>;
        <b>private readonly</b> <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a>&gt;&gt; <a id="a8f3199e0f8f72b3" href="../../R/a8f3199e0f8f72b3.html" target="n" data-glyph="46,1" class="i field">_variableBreakpoints</a>;
        <b>private readonly</b> <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <a id="8ab62f8ec7d2132e" href="../../R/8ab62f8ec7d2132e.html" target="n" data-glyph="46,1" class="i field">_idToBreakpoint</a>;
        <b>private</b> <a href="#05540b7e47470485" class="t t">SteppingMode</a> <a id="57792450deac46c7" href="../../R/57792450deac46c7.html" target="n" data-glyph="46,1" class="i field">_steppingMode</a>;
        <b>private</b> <a href="#66c884979ca0dfea" class="t t">CallStackInfo</a> <a id="2059b645ea13c8cf" href="../../R/2059b645ea13c8cf.html" target="n" data-glyph="46,1" class="i field">_overOrOutFrame</a>;
        <b>private</b> <a href="#5fb4cb1a539d006c" class="t t">CallStackList</a> <a id="f496970aab0b0b4c" href="../../R/f496970aab0b0b4c.html" target="n" data-glyph="46,1" class="i field">_callStack</a>;
        <b>private static readonly</b> <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <a id="66088c813d15db4b" href="../../R/66088c813d15db4b.html" target="n" data-glyph="46,1" class="i field">s_emptyBreakpointList</a> = <b>new</b> <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;();
 
        <b>private</b> <a href="#bf4d705eefc69dbb" class="t t">DebuggerCommandProcessor</a> <a id="d86cde82e8c1278b" href="../../R/d86cde82e8c1278b.html" target="n" data-glyph="46,1" class="i field">_commandProcessor</a> = <b>new</b> <a href="#ddb0e911ca6048eb" class="t constructor">DebuggerCommandProcessor</a>();
        <b>private</b> <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="aae66cbc2a9cebb6" href="../../R/aae66cbc2a9cebb6.html" target="n" data-glyph="46,1" class="i field">_currentInvocationInfo</a>;
        <b>private bool</b> <a id="b7ae8b1cf06dec15" href="../../R/b7ae8b1cf06dec15.html" target="n" data-glyph="46,1" class="i field">_inBreakpoint</a>;
        <b>private</b> <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="a750b00e0cb69a64" href="../../R/a750b00e0cb69a64.html" target="n" data-glyph="46,1" class="i field">_psDebuggerCommand</a>;
 
        <span class="c">// Job debugger integration.</span>
        <b>private bool</b> <a id="822a39b6aaf94b98" href="../../R/822a39b6aaf94b98.html" target="n" data-glyph="46,1" class="i field">_nestedDebuggerStop</a>;
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="#cffdf22cdbc9b847" class="t t">PSJobStartEventArgs</a>&gt; <a id="9b70248372b3e246" href="../../R/9b70248372b3e246.html" target="n" data-glyph="46,1" class="i field">_runningJobs</a>;
        <b>private readonly</b> <span class="i">ConcurrentStack</span>&lt;<a href="#9e8f0b396592e65c" class="t t">Debugger</a>&gt; <a id="9e17718415fd538f" href="../../R/9e17718415fd538f.html" target="n" data-glyph="46,1" class="i field">_activeDebuggers</a>;
        <b>private readonly</b> <span class="i">ConcurrentStack</span>&lt;<a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a>&gt; <a id="2772de8722870503" href="../../R/2772de8722870503.html" target="n" data-glyph="46,1" class="i field">_debuggerStopEventArgs</a>;
        <b>private</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a> <a id="285b7e0548cc6c33" href="../../R/285b7e0548cc6c33.html" target="n" data-glyph="46,1" class="i field">_lastActiveDebuggerAction</a>;
        <b>private</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a> <a id="ee77298ef6a53d8a" href="../../R/ee77298ef6a53d8a.html" target="n" data-glyph="46,1" class="i field">_currentDebuggerAction</a>;
        <b>private</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a> <a id="f189a5931f8867de" href="../../R/f189a5931f8867de.html" target="n" data-glyph="46,1" class="i field">_previousDebuggerAction</a>;
        <b>private</b> <a href="#66c884979ca0dfea" class="t t">CallStackInfo</a> <a id="381821f78732d634" href="../../R/381821f78732d634.html" target="n" data-glyph="46,1" class="i field">_nestedRunningFrame</a>;
        <b>private readonly object</b> <a id="9cd764826df997c7" href="../../R/9cd764826df997c7.html" target="n" data-glyph="46,1" class="i field">_syncObject</a>;
        <b>private readonly object</b> <a id="d0cb7ecfcb4c3c6b" href="../../R/d0cb7ecfcb4c3c6b.html" target="n" data-glyph="46,1" class="i field">_syncActiveDebuggerStopObject</a>;
        <b>private int</b> <a id="f407eb35d5fdf562" href="../../R/f407eb35d5fdf562.html" target="n" data-glyph="46,1" class="i field">_processingOutputCount</a>;
        <b>private</b> <span class="i">ManualResetEventSlim</span> <a id="7233165c4586febe" href="../../R/7233165c4586febe.html" target="n" data-glyph="46,1" class="i field">_processingOutputCompleteEvent</a> = <b>new</b> <span class="i">ManualResetEventSlim</span>(<b>true</b>);
 
        <span class="c">// Runspace debugger integration.</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Guid</span>, <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a>&gt; <a id="68d085c8eb45aa5f" href="../../R/68d085c8eb45aa5f.html" target="n" data-glyph="46,1" class="i field">_runningRunspaces</a>;
 
        <b>private const int</b> <a id="908093f543bdde1b" href="../../R/908093f543bdde1b.html" target="n" data-glyph="10,1" class="i field">_jobCallStackOffset</a> = 2;
        <b>private const int</b> <a id="a93cf9b6587a3f2f" href="../../R/a93cf9b6587a3f2f.html" target="n" data-glyph="10,1" class="i field">_runspaceCallStackOffset</a> = 1;
 
        <b>private bool</b> <a id="904044cf5171f58b" href="../../R/904044cf5171f58b.html" target="n" data-glyph="46,1" class="i field">_preserveUnhandledDebugStopEvent</a>;
        <b>private</b> <span class="i">ManualResetEventSlim</span> <a id="ce9910145cd5a126" href="../../R/ce9910145cd5a126.html" target="n" data-glyph="46,1" class="i field">_preserveDebugStopEvent</a>;
 
        <span class="c">// Process runspace debugger</span>
        <b>private readonly</b> <span class="i">Lazy</span>&lt;<span class="i">ConcurrentQueue</span>&lt;<a href="#0b214bf7844547d9" class="t t">StartRunspaceDebugProcessingEventArgs</a>&gt;&gt; <a id="a3b5454a9bd66dc9" href="../../R/a3b5454a9bd66dc9.html" target="n" data-glyph="46,1" class="i field">_runspaceDebugQueue</a> = <b>new</b> <span class="i">Lazy</span>&lt;<span class="i">ConcurrentQueue</span>&lt;<a href="#0b214bf7844547d9" class="t t">StartRunspaceDebugProcessingEventArgs</a>&gt;&gt;();
        <b>private volatile int</b> <a id="beb1e5c059866670" href="../../R/beb1e5c059866670.html" target="n" data-glyph="46,1" class="i field">_processingRunspaceDebugQueue</a>;
        <b>private</b> <span class="i">ManualResetEventSlim</span> <a id="fdf2f67a7f702043" href="../../R/fdf2f67a7f702043.html" target="n" data-glyph="46,1" class="i field">_runspaceDebugCompleteEvent</a>;
 
        <span class="c">// System is locked down when true. Used to disable debugger on lock down.</span>
        <b>private bool</b>? <a id="9442e090121fbf95" href="../../R/9442e090121fbf95.html" target="n" data-glyph="46,1" class="i field">_isSystemLockedDown</a>;
 
        <b>private static readonly string</b> <a id="08537d805fb9d93a" href="../../R/08537d805fb9d93a.html" target="n" data-glyph="46,1" class="i field">s_processDebugPromptMatch</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Raises the DebuggerStop event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="9caedf6d2d0bf41f" href="../../R/9caedf6d2d0bf41f.html" target="n" data-glyph="76,1" class="i method">OnDebuggerStop</a>(<a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r147 rd" class="r147 r">invocationInfo</span>, <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r148 rd" class="r148 r">breakpoints</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r148 r">breakpoints</span> != <b>null</b>, <span class="s">&quot;The list of breakpoints should not be null&quot;</span>);
 
            <a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a> <span id="r149 rd" class="r149 r">localRunspace</span> = <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a> <b>as</b> <a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a>;
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r149 r">localRunspace</span> != <b>null</b>, <span class="s">&quot;Debugging is only supported on local runspaces&quot;</span>);
 
            <b>if</b> (<span class="r149 r">localRunspace</span>.<a href="../hostifaces/ConnectionBase.cs.html#5970aa4db61a1c2c" class="i property">PulsePipeline</a> != <b>null</b> &amp;&amp; <span class="r149 r">localRunspace</span>.<a href="../hostifaces/ConnectionBase.cs.html#5970aa4db61a1c2c" class="i property">PulsePipeline</a> == <span class="r149 r">localRunspace</span>.<a href="../hostifaces/ConnectionBase.cs.html#2039b1cbfe257822" class="i method">GetCurrentlyRunningPipeline</a>())
            {
                <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>.<a href="../hostifaces/InternalHost.cs.html#d35ea6d8b175fa76" class="i property">UI</a>.<span class="i">WriteWarningLine</span>(
                    <span class="r148 r">breakpoints</span>.<span class="i">Count</span> &gt; 0
                        ? <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="i">DebuggerStrings</span>.<span class="i">WarningBreakpointWillNotBeHit</span>,
                                        <span class="r148 r">breakpoints</span>[0])
                        : <b>new</b> <span class="i">InvalidOperationException</span>().<span class="i">Message</span>);
                <b>return</b>;
            }
 
            <a href="#aae66cbc2a9cebb6" class="i field">_currentInvocationInfo</a> = <span class="r147 r">invocationInfo</span>;
            <a href="#57792450deac46c7" class="i field">_steppingMode</a> = <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#adb717584e0b9060" class="i field">None</a>;
 
            <span class="c">// Optionally wait for a debug stop event subscriber if requested.</span>
            <a href="#b7ae8b1cf06dec15" class="i field">_inBreakpoint</a> = <b>true</b>;
            <b>if</b> (!<a href="#f2da797d02aca72c" class="i method">WaitForDebugStopSubscriber</a>())
            {
                <span class="c">// No subscriber.  Ignore this debug stop event.</span>
                <a href="#b7ae8b1cf06dec15" class="i field">_inBreakpoint</a> = <b>false</b>;
                <b>return</b>;
            }
 
            <b>bool</b> <span id="r150 rd" class="r150 r">oldQuestionMarkVariableValue</span> = <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#1086e67bac3e5c3a" class="i property">QuestionMarkVariableValue</a>;
 
            <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#fa7f7322f772be22" class="i method">SetVariable</a>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#e07cc892c7d5264b" class="i field">PSDebugContextVarPath</a>, <b>new</b> <a href="#3f0121fd104dc258" class="t constructor">PSDebugContext</a>(<span class="r147 r">invocationInfo</span>, <span class="r148 r">breakpoints</span>, <a href="#6d7a38a0f33704a6" class="i property">TriggerObject</a>));
 
            <a href="../FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a> <span id="r151 rd" class="r151 r">defaultPromptInfo</span> = <b>null</b>;
            <b>string</b> <span id="r152 rd" class="r152 r">originalPromptString</span> = <b>null</b>;
            <b>bool</b> <span id="r153 rd" class="r153 r">hadDefaultPrompt</span> = <b>false</b>;
 
            <b>try</b>
            {
                <span class="i">Collection</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r154 rd" class="r154 r">items</span> = <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="../SessionStatePublic.cs.html#43a21166aa0ed2d8" class="i property">InvokeProvider</a>.<a href="../CmdletFamilyProviderInterfaces.cs.html#982f59c2f3f056cc" class="i property">Item</a>.<a href="../ItemCmdletProviderInterfaces.cs.html#66f33971c31b728e" class="i method">Get</a>(<span class="s">&quot;function:\\prompt&quot;</span>);
                <b>if</b> ((<span class="r154 r">items</span> != <b>null</b>) &amp;&amp; (<span class="r154 r">items</span>.<span class="i">Count</span> &gt; 0))
                {
                    <span class="r151 r">defaultPromptInfo</span> = <span class="r154 r">items</span>[0].<span class="i">BaseObject</span> <b>as</b> <a href="../FunctionInfo.cs.html#e37ab42bb144c43b" class="t t">FunctionInfo</a>;
                    <span class="r152 r">originalPromptString</span> = <span class="r151 r">defaultPromptInfo</span>.<a href="../FunctionInfo.cs.html#8cc15262f0da320a" class="i property">Definition</a> <b>as string</b>;
 
                    <b>if</b> (<span class="r152 r">originalPromptString</span>.<span class="i">Equals</span>(<a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="../InitialSessionState.cs.html#e7d42b444a6c9bfe" class="i field">DefaultPromptFunctionText</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                        <span class="r152 r">originalPromptString</span>.<span class="i">Trim</span>().<span class="i">StartsWith</span>(<a href="#08537d805fb9d93a" class="i field">s_processDebugPromptMatch</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r153 r">hadDefaultPrompt</span> = <b>true</b>;
                    }
                }
            }
            <b>catch</b> (<a href="../../utils/SessionStateExceptions.cs.html#9ed59df3c4c15193" class="t t">ItemNotFoundException</a>)
            {
                <span class="c">// Ignore, it means they don&#39;t have the default prompt</span>
            }
 
            <span class="c">// Change the context language mode before updating the prompt script.</span>
            <span class="c">// This way the new prompt scriptblock will pick up the current context language mode.</span>
            <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>? <span id="r155 rd" class="r155 r">originalLanguageMode</span> = <b>null</b>;
            <b>if</b> (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#7a174c9b85c175bf" class="i property">UseFullLanguageModeInDebugger</a> &amp;&amp;
                (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> != <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>))
            {
                <span class="r155 r">originalLanguageMode</span> = <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a>;
                <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> = <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#eec721eb8c02f156" class="i field">FullLanguage</a>;
            }
 
            <span class="c">// Update the prompt to the debug prompt</span>
            <b>if</b> (<span class="r153 r">hadDefaultPrompt</span>)
            {
                <b>int</b> <span id="r156 rd" class="r156 r">index</span> = <span class="r152 r">originalPromptString</span>.<span class="i">IndexOf</span>(<span class="s">&#39;&quot;&#39;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
                <b>if</b> (<span class="r156 r">index</span> &gt; -1)
                {
                    <span class="c">// Fix up prompt.</span>
                    ++<span class="r156 r">index</span>;
                    <b>string</b> <span id="r157 rd" class="r157 r">debugPrompt</span> = <b>string</b>.<span class="i">Concat</span>(<span class="s">&quot;\&quot;[DBG]: &quot;</span>, <span class="r152 r">originalPromptString</span>.<span class="i">AsSpan</span>(<span class="r156 r">index</span>, <span class="r152 r">originalPromptString</span>.<span class="i">Length</span> - <span class="r156 r">index</span>));
 
                    <span class="r151 r">defaultPromptInfo</span>.<a href="../FunctionInfo.cs.html#ac49f3ea90c9a279" class="i method">Update</a>(
                        <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="../lang/scriptblock.cs.html#adfac0fa7bf5725f" class="i method">Create</a>(<span class="r157 r">debugPrompt</span>), <b>true</b>, <a href="../ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="../ShellVariable.cs.html#d3cd3fca45c40287" class="i field">Unspecified</a>);
                }
                <b>else</b>
                {
                    <span class="r153 r">hadDefaultPrompt</span> = <b>false</b>;
                }
            }
 
            <a href="../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a> <span id="r158 rd" class="r158 r">previousAvailability</span> = <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>.<a href="../hostifaces/Connection.cs.html#c8bea13c75bd3198" class="i property">RunspaceAvailability</a>;
 
            <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>.<a href="../hostifaces/Connection.cs.html#222554c22c4a3071" class="i method">UpdateRunspaceAvailability</a>(
                <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>.<a href="../hostifaces/Connection.cs.html#9db062bececf98bd" class="i method">GetCurrentlyRunningPipeline</a>() != <b>null</b>
                    ? <a href="../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../hostifaces/Connection.cs.html#7d8f97430ae71e2a" class="i field">AvailableForNestedCommand</a>
                    : <a href="../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../hostifaces/Connection.cs.html#64bc5c5290cfb16d" class="i field">Available</a>,
                <b>true</b>);
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> == 1, <span class="s">&quot;Should only be stopping when debugger is on.&quot;</span>);
 
            <b>try</b>
            {
                <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#d1aba08a1f9eb55e" class="i field">InScriptStop</a>);
                <b>if</b> (<a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#7a7dfc2db85e866b" class="i method">Any</a>())
                {
                    <span class="c">// Get-PSCallStack shouldn&#39;t report any frames above this frame, so mark it.  One alternative</span>
                    <span class="c">// to marking the frame would be to not push new frames while debugging, but that limits our</span>
                    <span class="c">// ability to give a full callstack if there are errors during eval.</span>
                    <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#15bc8b05295691f1" class="i method">Last</a>().<a href="#51d1e1787f80eb08" class="i property">TopFrameAtBreakpoint</a> = <b>true</b>;
                }
 
                <span class="c">// Reset list lines.</span>
                <a href="#d86cde82e8c1278b" class="i field">_commandProcessor</a>.<a href="#f17a591cdc659d26" class="i method">Reset</a>();
 
                <span class="c">// Save a copy of the stop arguments.</span>
                <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r159 rd" class="r159 r">copyArgs</span> = <b>new</b> <a href="#a1b1943d925894a6" class="t constructor">DebuggerStopEventArgs</a>(<span class="r147 r">invocationInfo</span>, <span class="r148 r">breakpoints</span>);
                <a href="#2772de8722870503" class="i field">_debuggerStopEventArgs</a>.<span class="i">Push</span>(<span class="r159 r">copyArgs</span>);
 
                <span class="c">// Blocking call to raise debugger stop event.</span>
                <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r160 rd" class="r160 r">e</span> = <b>new</b> <a href="#a1b1943d925894a6" class="t constructor">DebuggerStopEventArgs</a>(<span class="r147 r">invocationInfo</span>, <span class="r148 r">breakpoints</span>);
                <a href="#19eff05653875667" class="i method">RaiseDebuggerStopEvent</a>(<span class="r160 r">e</span>);
                <a href="#27abb455d0aa0716" class="i method">ResumeExecution</a>(<span class="r160 r">e</span>.<a href="#b6941352f3c2c41c" class="i property">ResumeAction</a>);
            }
            <b>finally</b>
            {
                <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a>);
                <b>if</b> (<a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#7a7dfc2db85e866b" class="i method">Any</a>())
                {
                    <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#15bc8b05295691f1" class="i method">Last</a>().<a href="#51d1e1787f80eb08" class="i property">TopFrameAtBreakpoint</a> = <b>false</b>;
                }
 
                <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a>.<a href="../hostifaces/Connection.cs.html#222554c22c4a3071" class="i method">UpdateRunspaceAvailability</a>(<span class="r158 r">previousAvailability</span>, <b>true</b>);
 
                <b>if</b> (<span class="r155 r">originalLanguageMode</span>.<span class="i">HasValue</span>)
                {
                    <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> = <span class="r155 r">originalLanguageMode</span>.<span class="i">Value</span>;
                }
 
                <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="../SessionStateVariableAPIs.cs.html#c660eedd165987da" class="i method">RemoveVariable</a>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#f863427022374440" class="i field">PSDebugContext</a>);
 
                <b>if</b> (<span class="r153 r">hadDefaultPrompt</span>)
                {
                    <span class="c">// Restore the prompt if they had our default</span>
                    <span class="r151 r">defaultPromptInfo</span>.<a href="../FunctionInfo.cs.html#ac49f3ea90c9a279" class="i method">Update</a>(
                        <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="../lang/scriptblock.cs.html#adfac0fa7bf5725f" class="i method">Create</a>(<span class="r152 r">originalPromptString</span>), <b>true</b>, <a href="../ShellVariable.cs.html#8d6fb934c02e4185" class="t t">ScopedItemOptions</a>.<a href="../ShellVariable.cs.html#d3cd3fca45c40287" class="i field">Unspecified</a>);
                }
 
                <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r161 rd" class="r161 r">oldArgs</span>;
                <a href="#2772de8722870503" class="i field">_debuggerStopEventArgs</a>.<span class="i">TryPop</span>(<b>out</b> <span class="r161 r">oldArgs</span>);
 
                <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#1086e67bac3e5c3a" class="i property">QuestionMarkVariableValue</a> = <span class="r150 r">oldQuestionMarkVariableValue</span>;
 
                <a href="#b7ae8b1cf06dec15" class="i field">_inBreakpoint</a> = <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resumes execution after a breakpoint/step event has been handled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="27abb455d0aa0716" href="../../R/27abb455d0aa0716.html" target="n" data-glyph="76,1" class="i method">ResumeExecution</a>(<a href="#470618169485a70e" class="t t">DebuggerResumeAction</a> <span id="r162 rd" class="r162 r">action</span>)
        {
            <a href="#f189a5931f8867de" class="i field">_previousDebuggerAction</a> = <a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a>;
            <a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a> = <span class="r162 r">action</span>;
 
            <b>switch</b> (<span class="r162 r">action</span>)
            {
                <b>case</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#422455533b156acf" class="i field">StepInto</a>:
                    <a href="#57792450deac46c7" class="i field">_steppingMode</a> = <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#b13a6fed8931e742" class="i field">StepIn</a>;
                    <a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a> = <b>null</b>;
                    <b>break</b>;
 
                <b>case</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#4cfb4add3c03409c" class="i field">StepOut</a>:
                    <b>if</b> (<a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#5363f64d745abb81" class="i property">Count</a> &gt; 1)
                    {
                        <span class="c">// When we pop to the parent frame, we&#39;ll clear _overOrOutFrame (so OnSequencePointHit</span>
                        <span class="c">// will stop) and continue with a step.</span>
                        <a href="#57792450deac46c7" class="i field">_steppingMode</a> = <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#b13a6fed8931e742" class="i field">StepIn</a>;
                        <a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a> = <a href="#f496970aab0b0b4c" class="i field">_callStack</a>[<a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#5363f64d745abb81" class="i property">Count</a> - 2];
                    }
                    <b>else</b>
                    {
                        <span class="c">// Stepping out of the top frame is just like continue (allow hitting</span>
                        <span class="c">// breakpoints in the current frame, but otherwise just go.)</span>
                        <b>goto</b> <b>case</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>;
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#de21a4b4866a13cc" class="i field">StepOver</a>:
                    <a href="#57792450deac46c7" class="i field">_steppingMode</a> = <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#b13a6fed8931e742" class="i field">StepIn</a>;
                    <a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a> = <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#15bc8b05295691f1" class="i method">Last</a>();
                    <b>break</b>;
 
                <b>case</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>:
                    <span class="c">// nothing to do, just continue</span>
                    <a href="#57792450deac46c7" class="i field">_steppingMode</a> = <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#adb717584e0b9060" class="i field">None</a>;
                    <a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a> = <b>null</b>;
                    <b>break</b>;
 
                <b>case</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#9c143ec10eabd6ad" class="i field">Stop</a>:
                    <a href="#57792450deac46c7" class="i field">_steppingMode</a> = <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#adb717584e0b9060" class="i field">None</a>;
                    <a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a> = <b>null</b>;
                    <b>throw</b> <b>new</b> <span class="t">TerminateException</span>();
 
                <b>default</b>:
                    <span class="i">Debug</span>.<span class="i">Fail</span>(<span class="s">&quot;Received an unknown action: &quot;</span> + <span class="r162 r">action</span>);
                    <b>break</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Blocking call that blocks until a release occurs via ReleaseSavedDebugStop().</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if there is a DebuggerStop event subscriber.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="f2da797d02aca72c" href="../../R/f2da797d02aca72c.html" target="n" data-glyph="76,1" class="i method">WaitForDebugStopSubscriber</a>()
        {
            <b>if</b> (!<a href="#74257a81608a56cd" class="i method">IsDebuggerStopEventSubscribed</a>())
            {
                <b>if</b> (<a href="#904044cf5171f58b" class="i field">_preserveUnhandledDebugStopEvent</a>)
                {
                    <span class="c">// Lazily create the event object.</span>
                    <b>if</b> (<a href="#ce9910145cd5a126" class="i field">_preserveDebugStopEvent</a> == <b>null</b>)
                    {
                        <a href="#ce9910145cd5a126" class="i field">_preserveDebugStopEvent</a> = <b>new</b> <span class="i">ManualResetEventSlim</span>(<b>true</b>);
                    }
 
                    <span class="c">// Set the event handle to non-signaled.</span>
                    <b>if</b> (!<a href="#ce9910145cd5a126" class="i field">_preserveDebugStopEvent</a>.<span class="i">IsSet</span>)
                    {
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;The _preserveDebugStop event handle should always be in the signaled state at this point.&quot;</span>);
                        <b>return</b> <b>false</b>;
                    }
 
                    <a href="#ce9910145cd5a126" class="i field">_preserveDebugStopEvent</a>.<span class="i">Reset</span>();
 
                    <span class="c">// Wait indefinitely for a signal event.</span>
                    <a href="#ce9910145cd5a126" class="i field">_preserveDebugStopEvent</a>.<span class="i">Wait</span>();
 
                    <b>return</b> <a href="#74257a81608a56cd" class="i method">IsDebuggerStopEventSubscribed</a>();
                }
 
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private enum</b> <a id="05540b7e47470485" href="../../R/05540b7e47470485.html" target="n" data-glyph="22,1" class="t t"><span id="b6e45c2e9a2a7f6b">SteppingMode</span></a>
        {
            <a id="b13a6fed8931e742" href="../../R/b13a6fed8931e742.html" target="n" data-glyph="24,2" class="i field">StepIn</a>,
            <a id="adb717584e0b9060" href="../../R/adb717584e0b9060.html" target="n" data-glyph="24,2" class="i field">None</a>
        }
 
        <span class="c">// When a script file changes, we need to rebind all breakpoints in that script.</span>
        <b>private void</b> <a id="5d3ffddc6dcb5739" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">UnbindBoundBreakpoints</a>(<span class="i">List</span>&lt;<a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt; <span id="r163 rd" class="r163 r">boundBreakpoints</span>)
        {
            <b>foreach</b> (<b>var</b> <span id="r164 rd" class="r164 r">breakpoint</span> <b>in</b> <span class="r163 r">boundBreakpoints</span>)
            {
                <span class="c">// Also remove unbound breakpoints from the script to breakpoint map.</span>
                <span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;, <span class="i">BitArray</span>&gt; <span id="r165 rd" class="r165 r">lineBreakTuple</span>;
                <b>if</b> (<a href="#2210092054c29bc9" class="i field">_mapScriptToBreakpoints</a>.<span class="i">TryGetValue</span>(<span class="r164 r">breakpoint</span>.<span class="i">SequencePoints</span>, <b>out</b> <span class="r165 r">lineBreakTuple</span>))
                {
                    <span class="r165 r">lineBreakTuple</span>.<span class="i">Item1</span>.<span class="i">Remove</span>(<span class="r164 r">breakpoint</span>);
                }
 
                <span class="r164 r">breakpoint</span>.<span class="i">SequencePoints</span> = <b>null</b>;
                <span class="r164 r">breakpoint</span>.<span class="i">SequencePointIndex</span> = -1;
                <span class="r164 r">breakpoint</span>.<span class="i">BreakpointBitArray</span> = <b>null</b>;
                <a href="#97a66285c6d64854" class="i field">_pendingBreakpoints</a>[<span class="r164 r">breakpoint</span>.<span class="i">Id</span>] = <span class="r164 r">breakpoint</span>;
            }
 
            <span class="r163 r">boundBreakpoints</span>.<span class="i">Clear</span>();
        }
 
        <b>private void</b> <a id="17696cabffcce66b" href="../../R/17696cabffcce66b.html" target="n" data-glyph="76,1" class="i method">SetPendingBreakpoints</a>(<a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a> <span id="r166 rd" class="r166 r">functionContext</span>)
        {
            <b>if</b> (<a href="#97a66285c6d64854" class="i field">_pendingBreakpoints</a>.<span class="i">IsEmpty</span>)
                <b>return</b>;
 
            <b>var</b> <span id="r167 rd" class="r167 r">newPendingBreakpoints</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;();
            <b>var</b> <span id="r168 rd" class="r168 r">currentScriptFile</span> = <span class="r166 r">functionContext</span>.<a href="../parser/Compiler.cs.html#95a73081cffaa015" class="i field">_file</a>;
 
            <span class="c">// If we&#39;re not in a file, we can&#39;t have any line breakpoints.</span>
            <b>if</b> (<span class="r168 r">currentScriptFile</span> == <b>null</b>)
                <b>return</b>;
 
            <span class="c">// Normally we register a script file when the script is run or the module is imported,</span>
            <span class="c">// but if there weren&#39;t any breakpoints when the script was run and the script was dotted,</span>
            <span class="c">// we will end up here with pending breakpoints, but we won&#39;t have cached the list of</span>
            <span class="c">// breakpoints in the script.</span>
            <span class="i">RegisterScriptFile</span>(<span class="r168 r">currentScriptFile</span>, <span class="r166 r">functionContext</span>.<a href="../parser/Compiler.cs.html#5ed77de1a1fe863f" class="i property">CurrentPosition</a>.<a href="../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>.<a href="../parser/Position.cs.html#b2c2e7d614605592" class="i method">GetFullScript</a>());
 
            <span class="i">Tuple</span>&lt;<span class="i">List</span>&lt;<a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;, <span class="i">BitArray</span>&gt; <span id="r169 rd" class="r169 r">tuple</span>;
            <b>if</b> (!<a href="#2210092054c29bc9" class="i field">_mapScriptToBreakpoints</a>.<span class="i">TryGetValue</span>(<span class="r166 r">functionContext</span>.<a href="../parser/Compiler.cs.html#354889e302c1693c" class="i field">_sequencePoints</a>, <b>out</b> <span class="r169 r">tuple</span>))
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;If the script block is still alive, the entry should not be collected.&quot;</span>);
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r169 r">tuple</span>.<span class="i">Item1</span> == <span class="r166 r">functionContext</span>.<a href="../parser/Compiler.cs.html#18b1921c6a906819" class="i field">_boundBreakpoints</a>, <span class="s">&quot;What&#39;s up?&quot;</span>);
 
            <b>foreach</b> ((<b>int</b> <span id="r170 rd" class="r170 r">breakpointId</span>, <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <span id="r171 rd" class="r171 r">breakpoint</span>) <b>in</b> <a href="#97a66285c6d64854" class="i field">_pendingBreakpoints</a>)
            {
                <b>bool</b> <span id="r172 rd" class="r172 r">bound</span> = <b>false</b>;
                <b>if</b> (<span class="r171 r">breakpoint</span>.<a href="Breakpoint.cs.html#8bfc73f429759d6b" class="i method">TrySetBreakpoint</a>(<span class="r168 r">currentScriptFile</span>, <span class="r166 r">functionContext</span>))
                {
                    <b>if</b> (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> == 0)
                    {
                        <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a>);
                    }
 
                    <span class="r172 r">bound</span> = <b>true</b>;
                    <span class="r169 r">tuple</span>.<span class="i">Item1</span>.<span class="i">Add</span>(<span class="r171 r">breakpoint</span>);
 
                    <span class="c">// We need to keep track of any breakpoints that are bound in each script because they may</span>
                    <span class="c">// need to be rebound if the script changes.</span>
                    <b>var</b> <span id="r173 rd" class="r173 r">boundBreakpoints</span> = <a href="#2dd2911da87db3b5" class="i field">_boundBreakpoints</a>[<span class="r168 r">currentScriptFile</span>].<span class="i">Item2</span>;
                    <span class="r173 r">boundBreakpoints</span>[<span class="r171 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>] = <span class="r171 r">breakpoint</span>;
                }
 
                <b>if</b> (!<span class="r172 r">bound</span>)
                {
                    <span class="r167 r">newPendingBreakpoints</span>.<span class="i">Add</span>(<span class="r171 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>, <span class="r171 r">breakpoint</span>);
                }
            }
 
            <a href="#97a66285c6d64854" class="i field">_pendingBreakpoints</a> = <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>int</b>, <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt;(<span class="r167 r">newPendingBreakpoints</span>);
        }
 
        <b>private void</b> <a id="60eef3efd8d15536" href="../../R/60eef3efd8d15536.html" target="n" data-glyph="76,1" class="i method">StopOnSequencePoint</a>(<a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a> <span id="r174 rd" class="r174 r">functionContext</span>, <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r175 rd" class="r175 r">breakpoints</span>)
        {
            <b>if</b> (<span class="r174 r">functionContext</span>.<a href="../parser/Compiler.cs.html#f9539890beb6e765" class="i field">_debuggerHidden</a>)
            {
                <span class="c">// Never stop in a DebuggerHidden scriptblock.</span>
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r174 r">functionContext</span>.<a href="../parser/Compiler.cs.html#354889e302c1693c" class="i field">_sequencePoints</a>.<span class="i">Length</span> == 1 &amp;&amp;
                <span class="r174 r">functionContext</span>.<a href="../parser/Compiler.cs.html#4980a1f93a561cb3" class="i field">_scriptBlock</a> != <b>null</b> &amp;&amp;
                <b>object</b>.<span class="i">ReferenceEquals</span>(<span class="r174 r">functionContext</span>.<a href="../parser/Compiler.cs.html#354889e302c1693c" class="i field">_sequencePoints</a>[0], <span class="r174 r">functionContext</span>.<a href="../parser/Compiler.cs.html#4980a1f93a561cb3" class="i field">_scriptBlock</a>.<a href="../runtime/CompiledScriptBlock.cs.html#e028cdfe16daf552" class="i property">Ast</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>))
            {
                <span class="c">// If the script is empty or only defines functions, we used the script block extent as a sequence point, but that</span>
                <span class="c">// was only intended for error reporting, it was not meant to be hit as a breakpoint.</span>
                <b>return</b>;
            }
 
            <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="k">var</a> <span id="r176 rd" class="r176 r">invocationInfo</span> = <b>new</b> <a href="../InvocationInfo.cs.html#05f8dff4c341ddae" class="t constructor">InvocationInfo</a>(<b>null</b>, <span class="r174 r">functionContext</span>.<a href="../parser/Compiler.cs.html#5ed77de1a1fe863f" class="i property">CurrentPosition</a>, <a href="#3ac4e385b52c3ec7" class="i field">_context</a>);
            <a href="#9caedf6d2d0bf41f" class="i method">OnDebuggerStop</a>(<span class="r176 r">invocationInfo</span>, <span class="r175 r">breakpoints</span>);
        }
 
        <b>private enum</b> <a id="7ff9e8fbc3fa32a3" href="../../R/7ff9e8fbc3fa32a3.html" target="n" data-glyph="22,1" class="t t"><span id="7aafa123e1f00fe8">InternalDebugMode</span></a>
        {
            <a id="d7b1cf2239bd91b6" href="../../R/d7b1cf2239bd91b6.html" target="n" data-glyph="24,2" class="i field">InPushedStop</a> = -2,
            <a id="d1aba08a1f9eb55e" href="../../R/d1aba08a1f9eb55e.html" target="n" data-glyph="24,2" class="i field">InScriptStop</a> = -1,
            <a id="1f2f5fbf58d44eb7" href="../../R/1f2f5fbf58d44eb7.html" target="n" data-glyph="24,2" class="i field">Disabled</a> = 0,
            <a id="aa1981d1745e86b6" href="../../R/aa1981d1745e86b6.html" target="n" data-glyph="24,2" class="i field">Enabled</a> = 1
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the internal Execution context debug mode given the</span>
        <span class="c">///</span><span class="c"> current DebugMode setting.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r177 r">mode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Internal debug mode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="4ba4cb8853690f28" href="../../R/4ba4cb8853690f28.html" target="n" data-glyph="76,1" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a> <span id="r177 rd" class="r177 r">mode</span>)
        {
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <span class="c">// Disable script debugger when in system lock down mode</span>
                <b>if</b> (<a href="#468da1d38abc86fc" class="i property">IsSystemLockedDown</a>)
                {
                    <b>if</b> (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> != (<b>int</b>)<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#1f2f5fbf58d44eb7" class="i field">Disabled</a>)
                    {
                        <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> = (<b>int</b>)<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#1f2f5fbf58d44eb7" class="i field">Disabled</a>;
                    }
 
                    <b>return</b>;
                }
 
                <b>switch</b> (<span class="r177 r">mode</span>)
                {
                    <b>case</b> <a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#d7b1cf2239bd91b6" class="i field">InPushedStop</a>:
                    <b>case</b> <a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#d1aba08a1f9eb55e" class="i field">InScriptStop</a>:
                    <b>case</b> <a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#1f2f5fbf58d44eb7" class="i field">Disabled</a>:
                        <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> = (<b>int</b>)<span class="r177 r">mode</span>;
                        <b>break</b>;
 
                    <b>case</b> <a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a>:
                        <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> = <a href="#cceb71c5ce3496ea" class="i property">CanEnableDebugger</a> ?
                            (<b>int</b>)<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a> : (<b>int</b>)<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#1f2f5fbf58d44eb7" class="i field">Disabled</a>;
                        <b>break</b>;
                }
            }
        }
 
        <b>private bool</b> <a id="cceb71c5ce3496ea" href="../../R/cceb71c5ce3496ea.html" target="n" data-glyph="106,1" class="i property">CanEnableDebugger</a>
        {
            <b>get</b>
            {
                <span class="c">// The debugger can be enabled if we are not in DebugMode.None and if we are</span>
                <span class="c">// not in a local session set only to RemoteScript.</span>
                <b>return</b> !((<a href="#cb370f0b35bef91f" class="i property">DebugMode</a> == <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#36492991f477f6e1" class="i field">RemoteScript</a>) &amp;&amp; <a href="#41a8c03f52ff7ac4" class="i property">IsLocalSession</a>) &amp;&amp; (<a href="#cb370f0b35bef91f" class="i property">DebugMode</a> != <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#a52ed56edd63c7ff" class="i field">None</a>);
            }
        }
 
        <b>private bool</b> <a id="a9bf199504c4a68c" href="../../R/a9bf199504c4a68c.html" target="n" data-glyph="106,1" class="i property">CanDisableDebugger</a>
        {
            <b>get</b>
            {
                <span class="c">// The debugger can be disbled if there are no breakpoints</span>
                <span class="c">// left and if we are not currently stepping in the debugger.</span>
                <b>return</b> <a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">IsEmpty</span> &amp;&amp;
                       <a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a> != <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#422455533b156acf" class="i field">StepInto</a> &amp;&amp;
                       <a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a> != <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#de21a4b4866a13cc" class="i field">StepOver</a> &amp;&amp;
                       <a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a> != <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#4cfb4add3c03409c" class="i field">StepOut</a>;
            }
        }
 
        <b>private bool</b> <a id="468da1d38abc86fc" href="../../R/468da1d38abc86fc.html" target="n" data-glyph="106,1" class="i property">IsSystemLockedDown</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#9442e090121fbf95" class="i field">_isSystemLockedDown</a> == <b>null</b>)
                {
                    <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
                    {
                        <b>if</b> (<a href="#9442e090121fbf95" class="i field">_isSystemLockedDown</a> == <b>null</b>)
                        {
                            <a href="#9442e090121fbf95" class="i field">_isSystemLockedDown</a> = (<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Security</span>.<a href="../../security/wldpNativeMethods.cs.html#6b51558a7a8cde26" class="t t">SystemPolicy</a>.<a href="../../security/wldpNativeMethods.cs.html#2c0da8883146dab2" class="i method">GetSystemLockdownPolicy</a>() ==
                                <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Security</span>.<a href="../../security/wldpNativeMethods.cs.html#9f0915f7b351778e" class="t t">SystemEnforcementMode</a>.<a href="../../security/wldpNativeMethods.cs.html#5d74206001d0b817" class="i field">Enforce</a>);
                        }
                    }
                }
 
                <b>return</b> <a href="#9442e090121fbf95" class="i field">_isSystemLockedDown</a>.<span class="i">Value</span>;
            }
        }
 
        <b>private void</b> <a id="e983660ae42de204" href="../../R/e983660ae42de204.html" target="n" data-glyph="76,1" class="i method">CheckForBreakpointSupport</a>()
        {
            <b>if</b> (<a href="#468da1d38abc86fc" class="i property">IsSystemLockedDown</a>)
            {
                <span class="c">// Local script debugging is not supported in locked down mode</span>
                <b>throw</b> <b>new</b> <a href="../../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Enable debug stepping
 
        [<span class="i">Flags</span>]
        <b>private enum</b> <a id="79c15bcc3119a7d5" href="../../R/79c15bcc3119a7d5.html" target="n" data-glyph="22,1" class="t t"><span id="865c09d8976265fd">EnableNestedType</span></a>
        {
            <a id="d0d141fe67a6a909" href="../../R/../../0000000000.html" target="n" data-glyph="24,2" class="i field">None</a> = 0x0,
            <a id="a145f763bd0bd658" href="../../R/a145f763bd0bd658.html" target="n" data-glyph="24,2" class="i field">NestedJob</a> = 0x1,
            <a id="a9b0c898a030806f" href="../../R/a9b0c898a030806f.html" target="n" data-glyph="24,2" class="i field">NestedRunspace</a> = 0x2
        }
 
        <b>private void</b> <a id="3ce3a0d02e8e3959" href="../../R/3ce3a0d02e8e3959.html" target="n" data-glyph="76,1" class="i method">EnableDebuggerStepping</a>(<a href="#79c15bcc3119a7d5" class="t t">EnableNestedType</a> <span id="r178 rd" class="r178 r">nestedType</span>)
        {
            <b>if</b> (<a href="#cb370f0b35bef91f" class="i property">DebugMode</a> == <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#a52ed56edd63c7ff" class="i field">None</a>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(
                    <span class="i">DebuggerStrings</span>.<span class="i">CannotEnableDebuggerSteppingInvalidMode</span>,
                    <b>null</b>,
                    <a href="#9e8f0b396592e65c" class="t t">Debugger</a>.<a href="#1bffbef41f7f686b" class="i field">CannotEnableDebuggerSteppingInvalidMode</a>,
                    <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                    <b>null</b>);
            }
 
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <b>if</b> (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> == 0)
                {
                    <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a>);
                }
 
                <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r179 rd" class="r179 r">activeDebugger</span>;
                <b>if</b> (<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r179 r">activeDebugger</span>))
                {
                    <span class="c">// Set active debugger to StepInto mode.</span>
                    <span class="r179 r">activeDebugger</span>.<a href="#f6349f5fcfadd2ac" class="i method">SetDebugMode</a>(<a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#8f7455ad81a2c081" class="i field">LocalScript</a> | <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#36492991f477f6e1" class="i field">RemoteScript</a>);
                    <span class="r179 r">activeDebugger</span>.<a href="#e33bfc6122759440" class="i method">SetDebuggerStepMode</a>(<b>true</b>);
                }
                <b>else</b>
                {
                    <span class="c">// Set script debugger to StepInto mode.</span>
                    <a href="#27abb455d0aa0716" class="i method">ResumeExecution</a>(<a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#422455533b156acf" class="i field">StepInto</a>);
                }
            }
 
            <span class="c">// Look for any runspaces with debuggers and set to setp mode.</span>
            <b>if</b> ((<span class="r178 r">nestedType</span> &amp; <a href="#79c15bcc3119a7d5" class="t t">EnableNestedType</a>.<a href="#a9b0c898a030806f" class="i field">NestedRunspace</a>) == <a href="#79c15bcc3119a7d5" class="t t">EnableNestedType</a>.<a href="#a9b0c898a030806f" class="i field">NestedRunspace</a>)
            {
                <a href="#eb8d4aee6ec37991" class="i method">SetRunspaceListToStep</a>(<b>true</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Restores debugger back to non-step mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b62ae88588e74845" href="../../R/b62ae88588e74845.html" target="n" data-glyph="76,1" class="i method">DisableDebuggerStepping</a>()
        {
            <b>if</b> (!<a href="#83601e3e220acbe6" class="i property">IsDebuggerSteppingEnabled</a>) { <b>return</b>; }
 
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <a href="#27abb455d0aa0716" class="i method">ResumeExecution</a>(<a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>);
                <a href="#36cea9f47de64a63" class="i method">RestoreInternalDebugMode</a>();
 
                <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r180 rd" class="r180 r">activeDebugger</span>;
                <b>if</b> (<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r180 r">activeDebugger</span>))
                {
                    <span class="r180 r">activeDebugger</span>.<a href="#e33bfc6122759440" class="i method">SetDebuggerStepMode</a>(<b>false</b>);
                }
            }
 
            <a href="#dd0254e3d42a745f" class="i method">SetRunningJobListToStep</a>(<b>false</b>);
            <a href="#eb8d4aee6ec37991" class="i method">SetRunspaceListToStep</a>(<b>false</b>);
        }
 
        <b>private void</b> <a id="36cea9f47de64a63" href="../../R/36cea9f47de64a63.html" target="n" data-glyph="76,1" class="i method">RestoreInternalDebugMode</a>()
        {
            <a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a> <span id="r181 rd" class="r181 r">restoreMode</span> = ((<a href="#cb370f0b35bef91f" class="i property">DebugMode</a> != <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#a52ed56edd63c7ff" class="i field">None</a>) &amp;&amp; (!<a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">IsEmpty</span>)) ? <a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a> : <a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#1f2f5fbf58d44eb7" class="i field">Disabled</a>;
            <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<span class="r181 r">restoreMode</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Debugger Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set ScriptDebugger action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r182 r">resumeAction</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">DebuggerResumeAction.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="ca59d78648a11986" href="../../R/ca59d78648a11986.html" target="n" data-glyph="72,1" class="i method">SetDebuggerAction</a>(<a href="#470618169485a70e" class="t t">DebuggerResumeAction</a> <span id="r182 rd" class="r182 r">resumeAction</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotSupportedException.cs.html#021b4370ebdc2266" class="t constructor">PSNotSupportedException</a>(
                <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">CannotSetDebuggerAction</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> GetDebuggerStopped.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerStopEventArgs.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <a id="d684e2e01436f445" href="../../R/d684e2e01436f445.html" target="n" data-glyph="72,1" class="i method">GetDebuggerStopArgs</a>()
        {
            <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r183 rd" class="r183 r">rtnArgs</span>;
            <b>if</b> (<a href="#2772de8722870503" class="i field">_debuggerStopEventArgs</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r183 r">rtnArgs</span>))
            {
                <b>return</b> <span class="r183 r">rtnArgs</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProcessCommand.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r184 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PowerShell command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r185 r">output</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerCommandResults.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <a id="b40049ee7a768070" href="../../R/b40049ee7a768070.html" target="n" data-glyph="72,1" class="i method">ProcessCommand</a>(<a href="../hostifaces/PSCommand.cs.html#b9f024f73904cf55" class="t t">PSCommand</a> <span id="r184 rd" class="r184 r">command</span>, <a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r185 rd" class="r185 r">output</span>)
        {
            <b>if</b> (<span class="r184 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r184 r">command</span>));
            }
 
            <b>if</b> (<span class="r185 r">output</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r185 r">output</span>));
            }
 
            <b>if</b> (!<a href="#e0706ae30c7c5128" class="i property">DebuggerStopped</a>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(
                    <span class="i">DebuggerStrings</span>.<span class="i">CannotProcessDebuggerCommandNotStopped</span>,
                    <b>null</b>,
                    <a href="#9e8f0b396592e65c" class="t t">Debugger</a>.<a href="#bd971f01dcc26533" class="i field">CannotProcessCommandNotStopped</a>,
                    <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                    <b>null</b>);
            }
 
            <span class="c">//</span>
            <span class="c">// Allow an active pushed debugger to process commands</span>
            <span class="c">//</span>
            <a href="#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <span id="r186 rd" class="r186 r">results</span> = <a href="#f9c7c54a3f97666e" class="i method">ProcessCommandForActiveDebugger</a>(<span class="r184 r">command</span>, <span class="r185 r">output</span>);
            <b>if</b> (<span class="r186 r">results</span> != <b>null</b>)
            {
                <b>return</b> <span class="r186 r">results</span>;
            }
 
            <span class="c">//</span>
            <span class="c">// Otherwise let root script debugger handle it.</span>
            <span class="c">//</span>
            <b>if</b> (!(<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#98ee84b98c4d109b" class="i property">CurrentRunspace</a> <b>is</b> <a href="../../P/6fffd57173d247a6.html#6fffd57173d247a6" class="t t">LocalRunspace</a> <span id="r187 rd" class="r187 r">localRunspace</span>))
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(
                    <span class="i">DebuggerStrings</span>.<span class="i">CannotProcessDebuggerCommandNotStopped</span>,
                    <b>null</b>,
                    <a href="#9e8f0b396592e65c" class="t t">Debugger</a>.<a href="#bd971f01dcc26533" class="i field">CannotProcessCommandNotStopped</a>,
                    <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                    <b>null</b>);
            }
 
            <b>try</b>
            {
                <b>using</b> (<a href="#a750b00e0cb69a64" class="i field">_psDebuggerCommand</a> = <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>())
                {
                    <b>if</b> (<span class="r187 r">localRunspace</span>.<a href="../hostifaces/ConnectionBase.cs.html#2039b1cbfe257822" class="i method">GetCurrentlyRunningPipeline</a>() != <b>null</b>)
                    {
                        <a href="#a750b00e0cb69a64" class="i field">_psDebuggerCommand</a>.<a href="../hostifaces/PowerShell.cs.html#ca9abcd81cc054f5" class="i method">SetIsNested</a>(<b>true</b>);
                    }
 
                    <a href="#a750b00e0cb69a64" class="i field">_psDebuggerCommand</a>.<a href="../hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a> = <span class="r187 r">localRunspace</span>;
                    <a href="#a750b00e0cb69a64" class="i field">_psDebuggerCommand</a>.<a href="../hostifaces/PowerShell.cs.html#7bde27452e045465" class="i property">Commands</a> = <span class="r184 r">command</span>;
                    <b>foreach</b> (<b>var</b> <span id="r188 rd" class="r188 r">cmd</span> <b>in</b> <a href="#a750b00e0cb69a64" class="i field">_psDebuggerCommand</a>.<a href="../hostifaces/PowerShell.cs.html#7bde27452e045465" class="i property">Commands</a>.<a href="../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>)
                    {
                        <span class="r188 r">cmd</span>.<span class="i">MergeMyResults</span>(<a href="../hostifaces/Command.cs.html#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="../hostifaces/Command.cs.html#037d2fe8e28834f2" class="i field">All</a>, <a href="../hostifaces/Command.cs.html#b4c8a564cfb76454" class="t t">PipelineResultTypes</a>.<a href="../hostifaces/Command.cs.html#c8d2233323d43e84" class="i field">Output</a>);
                    }
 
                    <a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r189 rd" class="r189 r">internalOutput</span> = <b>new</b> <a href="../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
                    <span class="r189 r">internalOutput</span>.<a href="../hostifaces/PSDataCollection.cs.html#de98d172ff9dac86" class="i">DataAdded</a> += (<span id="r190 rd" class="r190 r">sender</span>, <span id="r191 rd" class="r191 r">args</span>) =&gt;
                        {
                            <b>foreach</b> (<b>var</b> <span id="r192 rd" class="r192 r">item</span> <b>in</b> <span class="r189 r">internalOutput</span>.<a href="../hostifaces/PSDataCollection.cs.html#403be942120e2d89" class="i method">ReadAll</a>())
                            {
                                <b>if</b> (<span class="r192 r">item</span> == <b>null</b>) { <b>continue</b>; }
 
                                <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <span id="r193 rd" class="r193 r">dbgCmd</span> = <span class="r192 r">item</span>.<span class="i">BaseObject</span> <b>as</b> <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a>;
                                <b>if</b> (<span class="r193 r">dbgCmd</span> != <b>null</b>)
                                {
                                    <b>bool</b> <span id="r194 rd" class="r194 r">executedByDebugger</span> = (<span class="r193 r">dbgCmd</span>.<a href="#4aad237c27ce8bd0" class="i property">ResumeAction</a> != <b>null</b> || <span class="r193 r">dbgCmd</span>.<a href="#ed0eefa60321fd1e" class="i property">ExecutedByDebugger</a>);
                                    <span class="r186 r">results</span> = <b>new</b> <a href="#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<span class="r193 r">dbgCmd</span>.<a href="#4aad237c27ce8bd0" class="i property">ResumeAction</a>, <span class="r194 r">executedByDebugger</span>);
                                }
                                <b>else</b>
                                {
                                    <span class="r185 r">output</span>.<span class="i">Add</span>(<span class="r192 r">item</span>);
                                }
                            }
                        };
 
                    <span class="c">// Allow any exceptions to propagate.</span>
                    <a href="#a750b00e0cb69a64" class="i field">_psDebuggerCommand</a>.<span class="i">InvokeWithDebugger</span>(<b>null</b>, <span class="r189 r">internalOutput</span>, <b>null</b>, <b>false</b>);
                }
            }
            <b>finally</b>
            {
                <a href="#a750b00e0cb69a64" class="i field">_psDebuggerCommand</a> = <b>null</b>;
            }
 
            <b>return</b> <span class="r186 r">results</span> ?? <b>new</b> <a href="#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<b>null</b>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> StopProcessCommand.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="ea887c9fed3551c1" href="../../R/ea887c9fed3551c1.html" target="n" data-glyph="72,1" class="i method">StopProcessCommand</a>()
        {
            <span class="c">//</span>
            <span class="c">// If we have a pushed debugger then stop that command.</span>
            <span class="c">//</span>
            <b>if</b> (<a href="#a57e244ad502e771" class="i method">StopCommandForActiveDebugger</a>())
            {
                <b>return</b>;
            }
 
            <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r195 rd" class="r195 r">ps</span> = <a href="#a750b00e0cb69a64" class="i field">_psDebuggerCommand</a>;
            <b>if</b> (<span class="r195 r">ps</span> != <b>null</b>)
            {
                <span class="r195 r">ps</span>.<a href="../hostifaces/PowerShell.cs.html#23f9dce20b146f19" class="i method">BeginStop</a>(<b>null</b>, <b>null</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set debug mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r196 r">mode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="b3b16eb4a7a7b381" href="../../R/b3b16eb4a7a7b381.html" target="n" data-glyph="72,1" class="i method">SetDebugMode</a>(<a href="#7e71da719f103cfd" class="t t">DebugModes</a> <span id="r196 rd" class="r196 r">mode</span>)
        {
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <span class="c">// Restrict local script debugger mode when in system lock down.</span>
                <span class="c">// DebugModes enum flags provide a combination of values.  To disable local script debugging</span>
                <span class="c">// we have to disallow &#39;LocalScript&#39; and &#39;Default&#39; flags and only allow &#39;None&#39; or &#39;RemoteScript&#39;</span>
                <span class="c">// flags exclusively.  This allows only no debugging &#39;None&#39; or remote debugging &#39;RemoteScript&#39;.</span>
                <b>if</b> (<a href="#468da1d38abc86fc" class="i property">IsSystemLockedDown</a> &amp;&amp; (<span class="r196 r">mode</span> != <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#a52ed56edd63c7ff" class="i field">None</a>) &amp;&amp; (<span class="r196 r">mode</span> != <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#36492991f477f6e1" class="i field">RemoteScript</a>))
                {
                    <span class="r196 r">mode</span> = <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#36492991f477f6e1" class="i field">RemoteScript</a>;
                }
 
                <a href="#9e8f0b396592e65c" class="k">base</a>.<a href="#f6349f5fcfadd2ac" class="i method">SetDebugMode</a>(<span class="r196 r">mode</span>);
 
                <b>if</b> (!<a href="#cceb71c5ce3496ea" class="i property">CanEnableDebugger</a>)
                {
                    <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#1f2f5fbf58d44eb7" class="i field">Disabled</a>);
                }
                <b>else</b> <b>if</b> ((!<a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">IsEmpty</span>) &amp;&amp; (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> == 0))
                {
                    <span class="c">// Set internal debugger to active.</span>
                    <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns current call stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">IEnumerable of CallStackFrame objects.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">IEnumerable</span>&lt;<a href="#70d153384f134926" class="t t">CallStackFrame</a>&gt; <a id="6e5b14dde8877cdc" href="../../R/6e5b14dde8877cdc.html" target="n" data-glyph="72,1" class="i method">GetCallStack</a>()
        {
            <a href="#66c884979ca0dfea" class="t t">CallStackInfo</a>[] <span id="r197 rd" class="r197 r">callStack</span> = <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#6f7061c54999061a" class="i method">ToArray</a>();
 
            <b>if</b> (<span class="r197 r">callStack</span>.<span class="i">Length</span> &gt; 0)
            {
                <b>int</b> <span id="r198 rd" class="r198 r">startingIndex</span> = <span class="r197 r">callStack</span>.<span class="i">Length</span> - 1;
                <b>for</b> (<b>int</b> <span id="r199 rd" class="r199 r">i</span> = <span class="r198 r">startingIndex</span>; <span class="r199 r">i</span> &gt;= 0; <span class="r199 r">i</span>--)
                {
                    <b>if</b> (<span class="r197 r">callStack</span>[<span class="r199 r">i</span>].<a href="#51d1e1787f80eb08" class="i property">TopFrameAtBreakpoint</a>)
                    {
                        <span class="r198 r">startingIndex</span> = <span class="r199 r">i</span>;
                        <b>break</b>;
                    }
                }
 
                <b>for</b> (<b>int</b> <span id="r200 rd" class="r200 r">i</span> = <span class="r198 r">startingIndex</span>; <span class="r200 r">i</span> &gt;= 0; <span class="r200 r">i</span>--)
                {
                    <a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="k">var</a> <span id="r201 rd" class="r201 r">funcContext</span> = <span class="r197 r">callStack</span>[<span class="r200 r">i</span>].<a href="#9ad2e5e18339a674" class="i property">FunctionContext</a>;
 
                    <b>yield</b> <b>return</b> <b>new</b> <a href="#9d785051a421ae89" class="t constructor">CallStackFrame</a>(<span class="r201 r">funcContext</span>, <span class="r197 r">callStack</span>[<span class="r200 r">i</span>].<a href="#481bca89fc49aa62" class="i property">InvocationInfo</a>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True when debugger is active with breakpoints.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="5ab574ab787d9d36" href="../../R/5ab574ab787d9d36.html" target="n" data-glyph="102,1" class="i property">IsActive</a>
        {
            <b>get</b>
            {
                <b>int</b> <span id="r202 rd" class="r202 r">debuggerState</span> = <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a>;
                <b>return</b> (<span class="r202 r">debuggerState</span> != 0);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resets the command processor source information so that it is</span>
        <span class="c">///</span><span class="c"> updated with latest information on the next debug stop.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="51e8455ce71ff62b" href="../../R/51e8455ce71ff62b.html" target="n" data-glyph="72,1" class="i method">ResetCommandProcessorSource</a>()
        {
            <a href="#d86cde82e8c1278b" class="i field">_commandProcessor</a>.<a href="#f17a591cdc659d26" class="i method">Reset</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets debugger stepping mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r203 r">enabled</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if stepping is to be enabled.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="700d995c894a21d1" href="../../R/700d995c894a21d1.html" target="n" data-glyph="72,1" class="i method">SetDebuggerStepMode</a>(<b>bool</b> <span id="r203 rd" class="r203 r">enabled</span>)
        {
            <b>if</b> (<span class="r203 r">enabled</span>)
            {
                <a href="#3ce3a0d02e8e3959" class="i method">EnableDebuggerStepping</a>(<a href="#79c15bcc3119a7d5" class="t t">EnableNestedType</a>.<a href="#a145f763bd0bd658" class="i field">NestedJob</a> | <a href="#79c15bcc3119a7d5" class="t t">EnableNestedType</a>.<a href="#a9b0c898a030806f" class="i field">NestedRunspace</a>);
            }
            <b>else</b>
            {
                <a href="#b62ae88588e74845" class="i method">DisableDebuggerStepping</a>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Breaks into the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r204 r">triggerObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that triggered the breakpoint, if there is one.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="0ebffcc754a06736" href="../../R/0ebffcc754a06736.html" target="n" data-glyph="74,1" class="i method">Break</a>(<b>object</b> <span id="r204 rd" class="r204 r">triggerObject</span> = <b>null</b>)
        {
            <b>if</b> (!<a href="#8d289e6a9a62921d" class="i property">IsDebugHandlerSubscribed</a> &amp;&amp;
                (<a href="#b0571e2bdd2e6b30" class="i property">UnhandledBreakpointMode</a> == <a href="#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="#e18be175ebce8c0f" class="i field">Ignore</a>))
            {
                <span class="c">// No debugger attached and runspace debugging is not enabled.  Enable runspace debugging here</span>
                <span class="c">// so that this command is effective.</span>
                <a href="#b0571e2bdd2e6b30" class="i property">UnhandledBreakpointMode</a> = <a href="#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="#acf1bcf988b9a342" class="i field">Wait</a>;
            }
 
            <span class="c">// Store the triggerObject so that we can add it to PSDebugContext</span>
            <a href="#6d7a38a0f33704a6" class="i property">TriggerObject</a> = <span class="r204 r">triggerObject</span>;
 
            <span class="c">// Set debugger to step mode so that a break can occur.</span>
            <a href="#700d995c894a21d1" class="i method">SetDebuggerStepMode</a>(<b>true</b>);
 
            <span class="c">// If the debugger is enabled and we are not in a breakpoint, trigger an immediate break in the current location</span>
            <b>if</b> (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> &gt; 0)
            {
                <b>using</b> (<span class="i">IEnumerator</span>&lt;<a href="#70d153384f134926" class="t t">CallStackFrame</a>&gt; <span id="r205 rd" class="r205 r">enumerator</span> = <a href="#6e5b14dde8877cdc" class="i method">GetCallStack</a>().<span class="i">GetEnumerator</span>())
                {
                    <b>if</b> (<span class="r205 r">enumerator</span>.<span class="i">MoveNext</span>())
                    {
                        <span class="i">OnSequencePointHit</span>(<span class="r205 r">enumerator</span>.<span class="i">Current</span>.<span class="i">FunctionContext</span>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Passes the debugger command to the internal script debugger command processor.  This</span>
        <span class="c">///</span><span class="c"> is used internally to handle debugger commands such as list, help, etc.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r206 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r207 r">output</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerCommand containing information on whether and how the command was processed.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <a id="9be2536809dab65e" href="../../R/9be2536809dab65e.html" target="n" data-glyph="74,1" class="i method">InternalProcessCommand</a>(<b>string</b> <span id="r206 rd" class="r206 r">command</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r207 rd" class="r207 r">output</span>)
        {
            <b>if</b> (!<a href="#e0706ae30c7c5128" class="i property">DebuggerStopped</a>)
            {
                <b>return</b> <b>new</b> <a href="#a148408d8489fb6c" class="t constructor">DebuggerCommand</a>(<span class="r206 r">command</span>, <b>null</b>, <b>false</b>, <b>false</b>);
            }
 
            <span class="c">// &quot;Exit&quot; command should always result with &quot;Continue&quot; behavior for legacy compatibility.</span>
            <b>if</b> (<span class="r206 r">command</span>.<span class="i">Equals</span>(<span class="s">&quot;exit&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <b>new</b> <a href="#a148408d8489fb6c" class="t constructor">DebuggerCommand</a>(<span class="r206 r">command</span>, <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>, <b>false</b>, <b>true</b>);
            }
 
            <b>return</b> <a href="#d86cde82e8c1278b" class="i field">_commandProcessor</a>.<a href="#8b2df97049aba8eb" class="i method">ProcessCommand</a>(<b>null</b>, <span class="r206 r">command</span>, <a href="#aae66cbc2a9cebb6" class="i field">_currentInvocationInfo</a>, <span class="r207 r">output</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a source list based on root script debugger source information if available, with</span>
        <span class="c">///</span><span class="c"> the current source line highlighted.  This is used internally for nested runspace debugging</span>
        <span class="c">///</span><span class="c"> where the runspace command is run in context of a parent script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r208 r">lineNum</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current source line.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r209 r">output</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Output collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if source listed successfully.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="24b73cb0a55b79ec" href="../../R/24b73cb0a55b79ec.html" target="n" data-glyph="74,1" class="i method">InternalProcessListCommand</a>(<b>int</b> <span id="r208 rd" class="r208 r">lineNum</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r209 rd" class="r209 r">output</span>)
        {
            <b>if</b> (!<a href="#e0706ae30c7c5128" class="i property">DebuggerStopped</a> || (<a href="#aae66cbc2a9cebb6" class="i field">_currentInvocationInfo</a> == <b>null</b>)) { <b>return</b> <b>false</b>; }
 
            <span class="c">// Create an Invocation object that has full source script from script debugger plus</span>
            <span class="c">// line information provided from caller.</span>
            <b>string</b> <span id="r210 rd" class="r210 r">fullScript</span> = <a href="#aae66cbc2a9cebb6" class="i field">_currentInvocationInfo</a>.<a href="../InvocationInfo.cs.html#f773f8a07f843643" class="i method">GetFullScript</a>();
            <a href="../parser/Position.cs.html#391058fa374c4cba" class="t t">ScriptPosition</a> <span id="r211 rd" class="r211 r">startScriptPosition</span> = <b>new</b> <a href="../parser/Position.cs.html#9d3079b4badc16cd" class="t constructor">ScriptPosition</a>(
                <a href="#aae66cbc2a9cebb6" class="i field">_currentInvocationInfo</a>.<a href="../InvocationInfo.cs.html#ffa710af0f908256" class="i property">ScriptName</a>,
                <span class="r208 r">lineNum</span>,
                <a href="#aae66cbc2a9cebb6" class="i field">_currentInvocationInfo</a>.<a href="../InvocationInfo.cs.html#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>.<a href="../parser/Position.cs.html#cd3280d5f1045b06" class="i property">Offset</a>,
                <a href="#aae66cbc2a9cebb6" class="i field">_currentInvocationInfo</a>.<a href="../InvocationInfo.cs.html#d8a2387de19e4425" class="i property">Line</a>,
                <span class="r210 r">fullScript</span>);
            <a href="../parser/Position.cs.html#391058fa374c4cba" class="t t">ScriptPosition</a> <span id="r212 rd" class="r212 r">endScriptPosition</span> = <b>new</b> <a href="../parser/Position.cs.html#9d3079b4badc16cd" class="t constructor">ScriptPosition</a>(
                <a href="#aae66cbc2a9cebb6" class="i field">_currentInvocationInfo</a>.<a href="../InvocationInfo.cs.html#ffa710af0f908256" class="i property">ScriptName</a>,
                <span class="r208 r">lineNum</span>,
                <a href="#aae66cbc2a9cebb6" class="i field">_currentInvocationInfo</a>.<a href="../InvocationInfo.cs.html#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>.<a href="../parser/Position.cs.html#cd3280d5f1045b06" class="i property">Offset</a>,
                <a href="#aae66cbc2a9cebb6" class="i field">_currentInvocationInfo</a>.<a href="../InvocationInfo.cs.html#d8a2387de19e4425" class="i property">Line</a>,
                <span class="r210 r">fullScript</span>);
            <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r213 rd" class="r213 r">tempInvocationInfo</span> = <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a>.<a href="../InvocationInfo.cs.html#cdfa6414e01bad12" class="i method">Create</a>(
                <a href="#aae66cbc2a9cebb6" class="i field">_currentInvocationInfo</a>.<a href="../InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>,
                <b>new</b> <a href="../parser/Position.cs.html#da6958ef7491b809" class="t constructor">ScriptExtent</a>(
                    <span class="r211 r">startScriptPosition</span>,
                    <span class="r212 r">endScriptPosition</span>)
                );
 
            <a href="#d86cde82e8c1278b" class="i field">_commandProcessor</a>.<a href="#d71f9505ba7fc953" class="i method">ProcessListCommand</a>(<span class="r213 r">tempInvocationInfo</span>, <span class="r209 r">output</span>);
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> IsRemote.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="2008a318de7140bd" href="../../R/2008a318de7140bd.html" target="n" data-glyph="104,1" class="i property">IsRemote</a>
        {
            <b>get</b>
            {
                <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r214 rd" class="r214 r">activeDebugger</span>;
                <b>if</b> (<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r214 r">activeDebugger</span>))
                {
                    <b>return</b> (<span class="r214 r">activeDebugger</span> <b>is</b> <a href="../remoting/client/Job.cs.html#2ad6213302b234f5" class="t t">RemotingJobDebugger</a>);
                }
 
                <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Array of stack frame objects of active debugger if any,</span>
        <span class="c">///</span><span class="c"> otherwise null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">CallStackFrame[].</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="#70d153384f134926" class="t t">CallStackFrame</a>[] <a id="3ab3622829a6054f" href="../../R/3ab3622829a6054f.html" target="n" data-glyph="74,1" class="i method">GetActiveDebuggerCallStack</a>()
        {
            <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r215 rd" class="r215 r">activeDebugger</span>;
            <b>if</b> (<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r215 r">activeDebugger</span>))
            {
                <b>return</b> <span class="r215 r">activeDebugger</span>.<a href="#03b6be6c2122937e" class="i method">GetCallStack</a>().<span class="i">ToArray</span>();
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets how the debugger deals with breakpoint events that are not handled.</span>
        <span class="c">///</span><span class="c">  Ignore - This is the default behavior and ignores any breakpoint event</span>
        <span class="c">///</span><span class="c">           if there is no handler.  Releases any preserved event.</span>
        <span class="c">///</span><span class="c">  Wait   - This mode preserves a breakpoint event until a handler is</span>
        <span class="c">///</span><span class="c">           subscribed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a> <a id="b0571e2bdd2e6b30" href="../../R/b0571e2bdd2e6b30.html" target="n" data-glyph="104,1" class="i property">UnhandledBreakpointMode</a>
        {
            <b>get</b>
            {
                <b>return</b> (<a href="#904044cf5171f58b" class="i field">_preserveUnhandledDebugStopEvent</a>) ? <a href="#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="#acf1bcf988b9a342" class="i field">Wait</a> : <a href="#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="#e18be175ebce8c0f" class="i field">Ignore</a>;
            }
 
            <b>set</b>
            {
                <b>switch</b> (<b>value</b>)
                {
                    <b>case</b> <a href="#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="#acf1bcf988b9a342" class="i field">Wait</a>:
                        <a href="#904044cf5171f58b" class="i field">_preserveUnhandledDebugStopEvent</a> = <b>true</b>;
                        <b>break</b>;
 
                    <b>case</b> <a href="#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="#e18be175ebce8c0f" class="i field">Ignore</a>:
                        <a href="#904044cf5171f58b" class="i field">_preserveUnhandledDebugStopEvent</a> = <b>false</b>;
                        <a href="#40c888fb804e0de7" class="i method">ReleaseSavedDebugStop</a>();
                        <b>break</b>;
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Breakpoints
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the provided set of breakpoints to the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r216 r">breakpoints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoints to set.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r217 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="fa19ab039c205e7a" href="../../R/fa19ab039c205e7a.html" target="n" data-glyph="72,1" class="i method">SetBreakpoints</a>(<span class="i">IEnumerable</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r216 rd" class="r216 r">breakpoints</span>, <b>int</b>? <span id="r217 rd" class="r217 r">runspaceId</span>)
        {
            <b>if</b> (<span class="r217 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <span class="i">GetRunspaceDebugger</span>(<span class="r217 r">runspaceId</span>.<span class="i">Value</span>).<a href="#7960fdac25827c3f" class="i method">SetBreakpoints</a>(<span class="r216 r">breakpoints</span>);
                <b>return</b>;
            }
 
            <b>foreach</b> (<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r218 rd" class="r218 r">bp</span> <b>in</b> <span class="r216 r">breakpoints</span>)
            {
                <b>switch</b> (<span class="r218 r">bp</span>)
                {
                    <b>case</b> <a href="Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a> <span id="r219 rd" class="r219 r">commandBreakpoint</span>:
                        <a href="#c7be3f4755da95f2" class="i method">AddCommandBreakpoint</a>(<span class="r219 r">commandBreakpoint</span>);
                        <b>continue</b>;
 
                    <b>case</b> <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <span id="r220 rd" class="r220 r">lineBreakpoint</span>:
                        <a href="#68db037b8e80c938" class="i method">AddLineBreakpoint</a>(<span class="r220 r">lineBreakpoint</span>);
                        <b>continue</b>;
 
                    <b>case</b> <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a> <span id="r221 rd" class="r221 r">variableBreakpoint</span>:
                        <a href="#013e6d9a23e184cd" class="i method">AddVariableBreakpoint</a>(<span class="r221 r">variableBreakpoint</span>);
                        <b>continue</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a breakpoint by id, primarily for Enable/Disable/Remove-PSBreakpoint cmdlets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r222 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the breakpoint you want.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r223 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="a811a67c105493f0" href="../../R/a811a67c105493f0.html" target="n" data-glyph="72,1" class="i method">GetBreakpoint</a>(<b>int</b> <span id="r222 rd" class="r222 r">id</span>, <b>int</b>? <span id="r223 rd" class="r223 r">runspaceId</span>)
        {
            <b>if</b> (<span class="r223 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <b>return</b> <span class="i">GetRunspaceDebugger</span>(<span class="r223 r">runspaceId</span>.<span class="i">Value</span>).<a href="#43e1c38d62f7235a" class="i method">GetBreakpoint</a>(<span class="r222 r">id</span>);
            }
 
            <a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">TryGetValue</span>(<span class="r222 r">id</span>, <b>out</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r224 rd" class="r224 r">breakpoint</span>);
            <b>return</b> <span class="r224 r">breakpoint</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns breakpoints primarily for the Get-PSBreakpoint cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r225 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <a id="a006baa6b5a4060b" href="../../R/a006baa6b5a4060b.html" target="n" data-glyph="72,1" class="i method">GetBreakpoints</a>(<b>int</b>? <span id="r225 rd" class="r225 r">runspaceId</span>)
        {
            <b>if</b> (<span class="r225 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <b>return</b> <span class="i">GetRunspaceDebugger</span>(<span class="r225 r">runspaceId</span>.<span class="i">Value</span>).<a href="#00ff38e404c12712" class="i method">GetBreakpoints</a>();
            }
 
            <b>return</b> (<b>from</b> <span class="i">bp</span> <b>in</b> <a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">Values</span> <b>orderby</b> <span class="i">bp</span>.<span class="i">Id</span> <b>select</b> <span class="i">bp</span>).<span class="i">ToList</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a command breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r226 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the command that will trigger the breakpoint. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r227 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r228 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. If null, the breakpoint may be hit anywhere the command is invoked.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r229 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a> <a id="b384b931ecbb2d54" href="../../R/b384b931ecbb2d54.html" target="n" data-glyph="72,1" class="i method">SetCommandBreakpoint</a>(<b>string</b> <span id="r226 rd" class="r226 r">command</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r227 rd" class="r227 r">action</span>, <b>string</b> <span id="r228 rd" class="r228 r">path</span>, <b>int</b>? <span id="r229 rd" class="r229 r">runspaceId</span>)
        {
            <b>if</b> (<span class="r229 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <b>return</b> <span class="i">GetRunspaceDebugger</span>(<span class="r229 r">runspaceId</span>.<span class="i">Value</span>).<a href="#33f271095fcc8aea" class="i method">SetCommandBreakpoint</a>(<span class="r226 r">command</span>, <span class="r227 r">action</span>, <span class="r228 r">path</span>);
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r226 r">command</span>), <span class="s">&quot;Caller to verify command is not null or empty.&quot;</span>);
 
            <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r230 rd" class="r230 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r226 r">command</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#e7978967739ff542" class="i field">Compiled</a> | <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
            <a href="#e983660ae42de204" class="i method">CheckForBreakpointSupport</a>();
            <b>return</b> <a href="#c7be3f4755da95f2" class="i method">AddCommandBreakpoint</a>(<b>new</b> <a href="Breakpoint.cs.html#dfcb594c58315bfd" class="t constructor">CommandBreakpoint</a>(<span class="r228 r">path</span>, <span class="r230 r">pattern</span>, <span class="r226 r">command</span>, <span class="r227 r">action</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a line breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r231 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r232 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The line in the script file where the breakpoint may be hit. This value must be greater than or equal to 1.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r233 r">column</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The column in the script file where the breakpoint may be hit. If 0, the breakpoint will trigger on any statement on the line.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r234 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r235 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A LineBreakpoint</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <a id="2f048ce4c29ec7bb" href="../../R/2f048ce4c29ec7bb.html" target="n" data-glyph="72,1" class="i method">SetLineBreakpoint</a>(<b>string</b> <span id="r231 rd" class="r231 r">path</span>, <b>int</b> <span id="r232 rd" class="r232 r">line</span>, <b>int</b> <span id="r233 rd" class="r233 r">column</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r234 rd" class="r234 r">action</span>, <b>int</b>? <span id="r235 rd" class="r235 r">runspaceId</span>)
        {
            <b>if</b> (<span class="r235 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <b>return</b> <span class="i">GetRunspaceDebugger</span>(<span class="r235 r">runspaceId</span>.<span class="i">Value</span>).<a href="#84e2724d7602314d" class="i method">SetLineBreakpoint</a>(<span class="r231 r">path</span>, <span class="r232 r">line</span>, <span class="r233 r">column</span>, <span class="r234 r">action</span>);
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r231 r">path</span> != <b>null</b>, <span class="s">&quot;Caller to verify path is not null.&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r232 r">line</span> &gt; 0, <span class="s">&quot;Caller to verify line is greater than 0.&quot;</span>);
 
            <a href="#e983660ae42de204" class="i method">CheckForBreakpointSupport</a>();
            <b>return</b> <a href="#68db037b8e80c938" class="i method">AddLineBreakpoint</a>(<b>new</b> <a href="Breakpoint.cs.html#1a2c3c92770133fc" class="t constructor">LineBreakpoint</a>(<span class="r231 r">path</span>, <span class="r232 r">line</span>, <span class="r233 r">column</span>, <span class="r234 r">action</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a variable breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r236 r">variableName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable that will trigger the breakpoint. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r237 r">accessMode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The variable access mode that will trigger the breakpoint.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r238 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r239 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. If null, the breakpoint may be hit anywhere the variable is accessed using the specified access mode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r240 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A VariableBreakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a> <a id="db8d4c5955367ecf" href="../../R/db8d4c5955367ecf.html" target="n" data-glyph="72,1" class="i method">SetVariableBreakpoint</a>(<b>string</b> <span id="r236 rd" class="r236 r">variableName</span>, <a href="Breakpoint.cs.html#296231e77d11bcb5" class="t t">VariableAccessMode</a> <span id="r237 rd" class="r237 r">accessMode</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r238 rd" class="r238 r">action</span>, <b>string</b> <span id="r239 rd" class="r239 r">path</span>, <b>int</b>? <span id="r240 rd" class="r240 r">runspaceId</span>)
        {
            <b>if</b> (<span class="r240 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <b>return</b> <span class="i">GetRunspaceDebugger</span>(<span class="r240 r">runspaceId</span>.<span class="i">Value</span>).<a href="#de0e7149ee81261a" class="i method">SetVariableBreakpoint</a>(<span class="r236 r">variableName</span>, <span class="r237 r">accessMode</span>, <span class="r238 r">action</span>, <span class="r239 r">path</span>);
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r236 r">variableName</span>), <span class="s">&quot;Caller to verify variableName is not null or empty.&quot;</span>);
 
            <a href="#e983660ae42de204" class="i method">CheckForBreakpointSupport</a>();
            <b>return</b> <a href="#013e6d9a23e184cd" class="i method">AddVariableBreakpoint</a>(<b>new</b> <a href="Breakpoint.cs.html#9cd5182b74402cdf" class="t constructor">VariableBreakpoint</a>(<span class="r239 r">path</span>, <span class="r236 r">variableName</span>, <span class="r237 r">accessMode</span>, <span class="r238 r">action</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the implementation of the Remove-PSBreakpoint cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r241 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the breakpoint you want.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r242 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="21a64b886997bdd0" href="../../R/21a64b886997bdd0.html" target="n" data-glyph="72,1" class="i method">RemoveBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r241 rd" class="r241 r">breakpoint</span>, <b>int</b>? <span id="r242 rd" class="r242 r">runspaceId</span>)
        {
            <b>if</b> (<span class="r242 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <b>return</b> <span class="i">GetRunspaceDebugger</span>(<span class="r242 r">runspaceId</span>.<span class="i">Value</span>).<a href="#cdff75b85ebaddd8" class="i method">RemoveBreakpoint</a>(<span class="r241 r">breakpoint</span>);
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r241 r">breakpoint</span> != <b>null</b>, <span class="s">&quot;Caller to verify the breakpoint is not null.&quot;</span>);
 
            <b>if</b> (<a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">Remove</span>(<span class="r241 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>, <b>out _</b>))
            {
                <span class="r241 r">breakpoint</span>.<a href="Breakpoint.cs.html#4c6d7492b3467485" class="i method">RemoveSelf</a>(<a href="#0d95bb604662e23b" class="k">this</a>);
 
                <b>if</b> (<a href="#a9bf199504c4a68c" class="i property">CanDisableDebugger</a>)
                {
                    <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#1f2f5fbf58d44eb7" class="i field">Disabled</a>);
                }
 
                <a href="#4245de486881076b" class="i method">OnBreakpointUpdated</a>(<b>new</b> <span class="t">BreakpointUpdatedEventArgs</span>(<span class="r241 r">breakpoint</span>, <a href="#7f495a71915b9312" class="t t">BreakpointUpdateType</a>.<a href="#81437d00b4c290a8" class="i field">Removed</a>, <a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">Count</span>));
 
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the implementation of the Enable-PSBreakpoint cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r243 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the breakpoint you want.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r244 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="1383d2914fafa000" href="../../R/1383d2914fafa000.html" target="n" data-glyph="72,1" class="i method">EnableBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r243 rd" class="r243 r">breakpoint</span>, <b>int</b>? <span id="r244 rd" class="r244 r">runspaceId</span>)
        {
            <b>if</b> (<span class="r244 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <b>return</b> <span class="i">GetRunspaceDebugger</span>(<span class="r244 r">runspaceId</span>.<span class="i">Value</span>).<a href="#8b9564824bfcb02b" class="i method">EnableBreakpoint</a>(<span class="r243 r">breakpoint</span>);
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r243 r">breakpoint</span> != <b>null</b>, <span class="s">&quot;Caller to verify the breakpoint is not null.&quot;</span>);
 
            <b>if</b> (<a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">TryGetValue</span>(<span class="r243 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>, <b>out _</b>))
            {
                <span class="r243 r">breakpoint</span>.<a href="Breakpoint.cs.html#cdff320c74cd3408" class="i method">SetEnabled</a>(<b>true</b>);
                <a href="#4245de486881076b" class="i method">OnBreakpointUpdated</a>(<b>new</b> <span class="t">BreakpointUpdatedEventArgs</span>(<span class="r243 r">breakpoint</span>, <a href="#7f495a71915b9312" class="t t">BreakpointUpdateType</a>.<a href="#a771ce8c028969fd" class="i field">Enabled</a>, <a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">Count</span>));
 
                <b>return</b> <span class="r243 r">breakpoint</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This is the implementation of the Disable-PSBreakpoint cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r245 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the breakpoint you want.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r246 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="eb53a37d209caec0" href="../../R/eb53a37d209caec0.html" target="n" data-glyph="72,1" class="i method">DisableBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r245 rd" class="r245 r">breakpoint</span>, <b>int</b>? <span id="r246 rd" class="r246 r">runspaceId</span>)
        {
            <b>if</b> (<span class="r246 r">runspaceId</span>.<span class="i">HasValue</span>)
            {
                <b>return</b> <span class="i">GetRunspaceDebugger</span>(<span class="r246 r">runspaceId</span>.<span class="i">Value</span>).<a href="#7465cc457fb3b609" class="i method">DisableBreakpoint</a>(<span class="r245 r">breakpoint</span>);
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r245 r">breakpoint</span> != <b>null</b>, <span class="s">&quot;Caller to verify the breakpoint is not null.&quot;</span>);
 
            <b>if</b> (<a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">TryGetValue</span>(<span class="r245 r">breakpoint</span>.<a href="Breakpoint.cs.html#e5a399bc8559fc9a" class="i property">Id</a>, <b>out _</b>))
            {
                <span class="r245 r">breakpoint</span>.<a href="Breakpoint.cs.html#cdff320c74cd3408" class="i method">SetEnabled</a>(<b>false</b>);
                <a href="#4245de486881076b" class="i method">OnBreakpointUpdated</a>(<b>new</b> <span class="t">BreakpointUpdatedEventArgs</span>(<span class="r245 r">breakpoint</span>, <a href="#7f495a71915b9312" class="t t">BreakpointUpdateType</a>.<a href="#7cd364741b9d73c6" class="i field">Disabled</a>, <a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">Count</span>));
 
                <b>return</b> <span class="r245 r">breakpoint</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static</b> <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <a id="f019af1cd627af87" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetRunspaceDebugger</a>(<b>int</b> <span id="r247 rd" class="r247 r">runspaceId</span>)
        {
            <b>if</b> (!<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#c77882820ba98c13" class="i property">RunspaceDictionary</a>.<span class="i">TryGetValue</span>(<span class="r247 r">runspaceId</span>, <b>out</b> <span class="i">WeakReference</span>&lt;<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>&gt; <span id="r248 rd" class="r248 r">wr</span>))
            {
                <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<b>string</b>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">InvalidRunspaceId</span>, <span class="r247 r">runspaceId</span>));
            }
 
            <b>if</b> (!<span class="r248 r">wr</span>.<span class="i">TryGetTarget</span>(<b>out</b> <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r249 rd" class="r249 r">rs</span>))
            {
                <b>throw</b> <b>new</b> <span class="t">PSArgumentException</span>(<span class="i">DebuggerStrings</span>.<span class="i">UnableToGetRunspace</span>);
            }
 
            <b>return</b> <span class="r249 r">rs</span>.<a href="../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Breakpoints
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Job Debugging
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets up debugger to debug provided job or its child jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r250 r">job</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Job object that is either a debuggable job or a container of</span>
        <span class="c">///</span><span class="c"> debuggable child jobs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r251 r">breakAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the debugger automatically invokes a break all when it</span>
        <span class="c">///</span><span class="c"> attaches to the job.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="ae8dd3259651ca9a" href="../../R/ae8dd3259651ca9a.html" target="n" data-glyph="74,1" class="i method">DebugJob</a>(<a href="../remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <span id="r250 rd" class="r250 r">job</span>, <b>bool</b> <span id="r251 rd" class="r251 r">breakAll</span>)
        {
            <b>if</b> (<span class="r250 r">job</span> == <b>null</b>) { <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r250 r">job</span>)); }
 
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <b>if</b> (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> &lt; 0)
                {
                    <b>throw</b> <b>new</b> <span class="t">RuntimeException</span>(<span class="i">DebuggerStrings</span>.<span class="i">CannotStartJobDebuggingDebuggerBusy</span>);
                }
            }
 
            <span class="c">// If a debuggable job was passed in then add it to the</span>
            <span class="c">// job running list.</span>
            <b>bool</b> <span id="r252 rd" class="r252 r">jobsAdded</span> = <a href="#b6ca38f3f1891726" class="i method">TryAddDebugJob</a>(<span class="r250 r">job</span>, <span class="r251 r">breakAll</span>);
            <b>if</b> (!<span class="r252 r">jobsAdded</span>)
            {
                <span class="c">// Otherwise treat as parent Job and iterate over child jobs.</span>
                <b>foreach</b> (<a href="../remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <span id="r253 rd" class="r253 r">childJob</span> <b>in</b> <span class="r250 r">job</span>.<a href="../remoting/client/Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
                {
                    <b>if</b> (<a href="#b6ca38f3f1891726" class="i method">TryAddDebugJob</a>(<span class="r253 r">childJob</span>, <span class="r251 r">breakAll</span>) &amp;&amp; !<span class="r252 r">jobsAdded</span>)
                    {
                        <span class="r252 r">jobsAdded</span> = <b>true</b>;
                    }
                }
            }
 
            <b>if</b> (!<span class="r252 r">jobsAdded</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">DebuggerStrings</span>.<span class="i">NoDebuggableJobsFound</span>);
            }
        }
 
        <b>private bool</b> <a id="b6ca38f3f1891726" href="../../R/b6ca38f3f1891726.html" target="n" data-glyph="76,1" class="i method">TryAddDebugJob</a>(<a href="../remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <span id="r254 rd" class="r254 r">job</span>, <b>bool</b> <span id="r255 rd" class="r255 r">breakAll</span>)
        {
            <a href="../remoting/client/Job.cs.html#0a5020043aef4132" class="t t">IJobDebugger</a> <span id="r256 rd" class="r256 r">debuggableJob</span> = <span class="r254 r">job</span> <b>as</b> <a href="../remoting/client/Job.cs.html#0a5020043aef4132" class="t t">IJobDebugger</a>;
            <b>if</b> ((<span class="r256 r">debuggableJob</span> != <b>null</b>) &amp;&amp; (<span class="r256 r">debuggableJob</span>.<a href="../remoting/client/Job.cs.html#a3c4b1b7836de96a" class="i property">Debugger</a> != <b>null</b>) &amp;&amp;
                ((<span class="r254 r">job</span>.<a href="../remoting/client/Job.cs.html#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="../remoting/client/Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="../remoting/client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="../remoting/client/Job.cs.html#8b3e2b923f5b0e5d" class="i field">Running</a>) || (<span class="r254 r">job</span>.<a href="../remoting/client/Job.cs.html#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="../remoting/client/Job.cs.html#245057a5f4a9ed30" class="i property">State</a> == <a href="../remoting/client/Job.cs.html#fac7cdff9aee3e4f" class="t t">JobState</a>.<a href="../remoting/client/Job.cs.html#3a538a4d2b74d6fc" class="i field">AtBreakpoint</a>)))
            {
                <span class="c">// Check to see if job is already stopped in debugger.</span>
                <b>bool</b> <span id="r257 rd" class="r257 r">jobDebugAlreadyStopped</span> = <span class="r256 r">debuggableJob</span>.<a href="../remoting/client/Job.cs.html#a3c4b1b7836de96a" class="i property">Debugger</a>.<a href="#564232f4b51d11aa" class="i property">InBreakpoint</a>;
 
                <span class="c">// Add to running job list with debugger set to step into.</span>
                <a href="#973f65579300ad50" class="i method">SetDebugJobAsync</a>(<span class="r256 r">debuggableJob</span>, <b>false</b>);
                <a href="#e10ab605fe30ca47" class="i method">AddToJobRunningList</a>(
                    <b>new</b> <a href="#bf197f876aba9c12" class="t constructor">PSJobStartEventArgs</a>(<span class="r254 r">job</span>, <span class="r256 r">debuggableJob</span>.<a href="../remoting/client/Job.cs.html#a3c4b1b7836de96a" class="i property">Debugger</a>, <b>false</b>),
                    <span class="r255 r">breakAll</span> ? <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#422455533b156acf" class="i field">StepInto</a> : <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>);
 
                <span class="c">// Raise debug stop event if job is already in stopped state.</span>
                <b>if</b> (<span class="r257 r">jobDebugAlreadyStopped</span>)
                {
                    <a href="../remoting/client/Job.cs.html#2ad6213302b234f5" class="t t">RemotingJobDebugger</a> <span id="r258 rd" class="r258 r">remoteJobDebugger</span> = <span class="r256 r">debuggableJob</span>.<a href="../remoting/client/Job.cs.html#a3c4b1b7836de96a" class="i property">Debugger</a> <b>as</b> <a href="../remoting/client/Job.cs.html#2ad6213302b234f5" class="t t">RemotingJobDebugger</a>;
                    <b>if</b> (<span class="r258 r">remoteJobDebugger</span> != <b>null</b>)
                    {
                        <span class="r258 r">remoteJobDebugger</span>.<a href="../remoting/client/Job.cs.html#032e4393cde7499c" class="i method">CheckStateAndRaiseStopEvent</a>();
                    }
                    <b>else</b>
                    {
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Should never get debugger stopped job that is not of RemotingJobDebugger type.&quot;</span>);
                    }
                }
 
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes job from debugger job list and pops its</span>
        <span class="c">///</span><span class="c"> debugger from the active debugger stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r259 r">job</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Job.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="df8144a507d5c9ab" href="../../R/df8144a507d5c9ab.html" target="n" data-glyph="74,1" class="i method">StopDebugJob</a>(<a href="../remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <span id="r259 rd" class="r259 r">job</span>)
        {
            <span class="c">// Parameter validation.</span>
            <b>if</b> (<span class="r259 r">job</span> == <b>null</b>) { <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r259 r">job</span>)); }
 
            <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#1f2f5fbf58d44eb7" class="i field">Disabled</a>);
 
            <a href="#1cf06c7c3c9d5802" class="i method">RemoveFromRunningJobList</a>(<span class="r259 r">job</span>);
            <a href="#973f65579300ad50" class="i method">SetDebugJobAsync</a>(<span class="r259 r">job</span> <b>as</b> <a href="../remoting/client/Job.cs.html#0a5020043aef4132" class="t t">IJobDebugger</a>, <b>true</b>);
 
            <b>foreach</b> (<b>var</b> <span id="r260 rd" class="r260 r">cJob</span> <b>in</b> <span class="r259 r">job</span>.<a href="../remoting/client/Job.cs.html#db120f2476b59753" class="i property">ChildJobs</a>)
            {
                <span class="i">RemoveFromRunningJobList</span>(<span class="r260 r">cJob</span>);
                <a href="#973f65579300ad50" class="i method">SetDebugJobAsync</a>(<span class="r260 r">cJob</span> <b>as</b> <a href="../remoting/client/Job.cs.html#0a5020043aef4132" class="t t">IJobDebugger</a>, <b>true</b>);
            }
 
            <a href="#36cea9f47de64a63" class="i method">RestoreInternalDebugMode</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper method to set a IJobDebugger job CanDebug property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r261 r">debuggableJob</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">IJobDebugger.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r262 r">isAsync</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Boolean.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="973f65579300ad50" href="../../R/973f65579300ad50.html" target="n" data-glyph="74,1" class="i method">SetDebugJobAsync</a>(<a href="../remoting/client/Job.cs.html#0a5020043aef4132" class="t t">IJobDebugger</a> <span id="r261 rd" class="r261 r">debuggableJob</span>, <b>bool</b> <span id="r262 rd" class="r262 r">isAsync</span>)
        {
            <b>if</b> (<span class="r261 r">debuggableJob</span> != <b>null</b>)
            {
                <span class="r261 r">debuggableJob</span>.<a href="../remoting/client/Job.cs.html#3e4fd95ba1813b1f" class="i property">IsAsync</a> = <span class="r262 r">isAsync</span>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace Debugging
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets up debugger to debug provided Runspace in a nested debug session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r263 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace to debug.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r264 r">breakAll</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When true, this command will invoke a BreakAll when the debugger is</span>
        <span class="c">///</span><span class="c"> first attached.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="09a9217188c27b1e" href="../../R/09a9217188c27b1e.html" target="n" data-glyph="74,1" class="i method">DebugRunspace</a>(<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r263 rd" class="r263 r">runspace</span>, <b>bool</b> <span id="r264 rd" class="r264 r">breakAll</span>)
        {
            <b>if</b> (<span class="r263 r">runspace</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r263 r">runspace</span>));
            }
 
            <b>if</b> (<span class="r263 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a> != <a href="../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(
                    <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="i">DebuggerStrings</span>.<span class="i">RunspaceDebuggingInvalidRunspaceState</span>, <span class="r263 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>)
                    );
            }
 
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <b>if</b> (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> &lt; 0)
                {
                    <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">DebuggerStrings</span>.<span class="i">RunspaceDebuggingDebuggerBusy</span>);
                }
            }
 
            <b>if</b> (<span class="r263 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(
                    <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="i">DebuggerStrings</span>.<span class="i">RunspaceDebuggingNoRunspaceDebugger</span>, <span class="r263 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#c40205e63f7ff911" class="i property">Name</a>));
            }
 
            <b>if</b> (<span class="r263 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>.<a href="#cb370f0b35bef91f" class="i property">DebugMode</a> == <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#a52ed56edd63c7ff" class="i field">None</a>)
            {
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">DebuggerStrings</span>.<span class="i">RunspaceDebuggingDebuggerIsOff</span>);
            }
 
            <a href="#e02a4010f6f7ded2" class="i method">AddToRunningRunspaceList</a>(<b>new</b> <a href="#1d50b98aeb5e39ea" class="t constructor">PSStandaloneMonitorRunspaceInfo</a>(<span class="r263 r">runspace</span>));
 
            <b>if</b> (!<span class="r263 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>.<a href="#564232f4b51d11aa" class="i property">InBreakpoint</a> &amp;&amp; <span class="r264 r">breakAll</span>)
            {
                <a href="#3ce3a0d02e8e3959" class="i method">EnableDebuggerStepping</a>(<a href="#79c15bcc3119a7d5" class="t t">EnableNestedType</a>.<a href="#a9b0c898a030806f" class="i field">NestedRunspace</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes the provided Runspace from the nested &quot;active&quot; debugger state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r265 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="e7ff55e150ad3d74" href="../../R/e7ff55e150ad3d74.html" target="n" data-glyph="74,1" class="i method">StopDebugRunspace</a>(<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r265 rd" class="r265 r">runspace</span>)
        {
            <b>if</b> (<span class="r265 r">runspace</span> == <b>null</b>) { <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r265 r">runspace</span>)); }
 
            <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#1f2f5fbf58d44eb7" class="i field">Disabled</a>);
 
            <a href="#4e743e132b598b56" class="i method">RemoveFromRunningRunspaceList</a>(<span class="r265 r">runspace</span>);
 
            <a href="#36cea9f47de64a63" class="i method">RestoreInternalDebugMode</a>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace Debug Processing
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the provided Runspace object to the runspace debugger processing queue.</span>
        <span class="c">///</span><span class="c"> The queue will then raise the StartRunspaceDebugProcessing events for each runspace to allow</span>
        <span class="c">///</span><span class="c"> a host script debugger implementation to provide an active debugging session.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r266 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace to debug.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="1bdbfffd61cff2a4" href="../../R/1bdbfffd61cff2a4.html" target="n" data-glyph="74,1" class="i method">QueueRunspaceForDebug</a>(<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r266 rd" class="r266 r">runspace</span>)
        {
            <span class="r266 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#6866e88f64eb13d6" class="i">StateChanged</a> += <span class="i">RunspaceStateChangedHandler</span>;
            <span class="r266 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#3cd2a1e80935c2fb" class="i">AvailabilityChanged</a> += <span class="i">RunspaceAvailabilityChangedHandler</span>;
            <a href="#a3b5454a9bd66dc9" class="i field">_runspaceDebugQueue</a>.<span class="i">Value</span>.<span class="i">Enqueue</span>(<b>new</b> <a href="#e075a36149989e34" class="t constructor">StartRunspaceDebugProcessingEventArgs</a>(<span class="r266 r">runspace</span>));
            <a href="#d69ab8b0d0240aaf" class="i method">StartRunspaceForDebugQueueProcessing</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Causes the CancelRunspaceDebugProcessing event to be raised which notifies subscribers that these debugging</span>
        <span class="c">///</span><span class="c"> sessions should be cancelled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="9c7da124422496ca" href="../../R/9c7da124422496ca.html" target="n" data-glyph="72,1" class="i method">CancelDebuggerProcessing</a>()
        {
            <span class="c">// Empty runspace debugger processing queue and then notify any subscribers.</span>
            <a href="#2319eaf6f50eb472" class="i method">ReleaseInternalRunspaceDebugProcessing</a>(<b>null</b>, <b>true</b>);
 
            <b>try</b>
            {
                <a href="#bef53cb994ca5b2b" class="i method">RaiseCancelRunspaceDebugProcessingEvent</a>();
            }
            <b>catch</b> (<span class="i">Exception</span>)
            { }
        }
 
        <b>private void</b> <a id="2319eaf6f50eb472" href="../../R/2319eaf6f50eb472.html" target="n" data-glyph="76,1" class="i method">ReleaseInternalRunspaceDebugProcessing</a>(<b>object</b> <span id="r267 rd" class="r267 r">sender</span>, <b>bool</b> <span id="r268 rd" class="r268 r">emptyQueue</span> = <b>false</b>)
        {
            <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r269 rd" class="r269 r">runspace</span> = <span class="r267 r">sender</span> <b>as</b> <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>;
            <b>if</b> (<span class="r269 r">runspace</span> != <b>null</b>)
            {
                <span class="r269 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#6866e88f64eb13d6" class="i">StateChanged</a> -= <span class="i">RunspaceStateChangedHandler</span>;
                <span class="r269 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#3cd2a1e80935c2fb" class="i">AvailabilityChanged</a> -= <span class="i">RunspaceAvailabilityChangedHandler</span>;
            }
 
            <b>if</b> (<span class="r268 r">emptyQueue</span> &amp;&amp; <a href="#a3b5454a9bd66dc9" class="i field">_runspaceDebugQueue</a>.<span class="i">IsValueCreated</span>)
            {
                <a href="#0b214bf7844547d9" class="t t">StartRunspaceDebugProcessingEventArgs</a> <span id="r270 rd" class="r270 r">args</span>;
                <b>while</b> (<a href="#a3b5454a9bd66dc9" class="i field">_runspaceDebugQueue</a>.<span class="i">Value</span>.<span class="i">TryDequeue</span>(<b>out</b> <span class="r270 r">args</span>))
                {
                    <span class="r270 r">args</span>.<a href="#f722155d3ec9219d" class="i property">Runspace</a>.<a href="../hostifaces/Connection.cs.html#6866e88f64eb13d6" class="i">StateChanged</a> -= <span class="i">RunspaceStateChangedHandler</span>;
                    <span class="r270 r">args</span>.<a href="#f722155d3ec9219d" class="i property">Runspace</a>.<a href="../hostifaces/Connection.cs.html#3cd2a1e80935c2fb" class="i">AvailabilityChanged</a> -= <span class="i">RunspaceAvailabilityChangedHandler</span>;
                    <b>try</b>
                    {
                        <span class="r270 r">args</span>.<a href="#f722155d3ec9219d" class="i property">Runspace</a>.<a href="../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>.<a href="#dbd829c531cef2cb" class="i property">UnhandledBreakpointMode</a> = <a href="#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="#e18be175ebce8c0f" class="i field">Ignore</a>;
                    }
                    <b>catch</b> (<span class="i">Exception</span>) { }
                }
            }
 
            <b>if</b> (<a href="#fdf2f67a7f702043" class="i field">_runspaceDebugCompleteEvent</a> != <b>null</b>)
            {
                <b>try</b>
                {
                    <a href="#fdf2f67a7f702043" class="i field">_runspaceDebugCompleteEvent</a>.<span class="i">Set</span>();
                }
                <b>catch</b> (<span class="i">ObjectDisposedException</span>) { }
            }
        }
 
        <b>private void</b> <a id="34e9db1b3dcc2b9f" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RunspaceStateChangedHandler</a>(<b>object</b> <span id="r271 rd" class="r271 r">sender</span>, <a href="../hostifaces/Connection.cs.html#24ce8f9c69bf1c4a" class="t t">RunspaceStateEventArgs</a> <span id="r272 rd" class="r272 r">args</span>)
        {
            <b>switch</b> (<span class="r272 r">args</span>.<a href="../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>)
            {
                <b>case</b> <a href="../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../hostifaces/Connection.cs.html#45de84b67ba18f3f" class="i field">Closed</a>:
                <b>case</b> <a href="../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../hostifaces/Connection.cs.html#e4c76740d99e58bd" class="i field">Broken</a>:
                <b>case</b> <a href="../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../hostifaces/Connection.cs.html#0a8fc62a22d129a1" class="i field">Disconnected</a>:
                    <a href="#2319eaf6f50eb472" class="i method">ReleaseInternalRunspaceDebugProcessing</a>(<span class="r271 r">sender</span>);
                    <b>break</b>;
            }
        }
 
        <b>private void</b> <a id="199bba247d419d90" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RunspaceAvailabilityChangedHandler</a>(<b>object</b> <span id="r273 rd" class="r273 r">sender</span>, <a href="../hostifaces/Connection.cs.html#cb349d0617c35bc7" class="t t">RunspaceAvailabilityEventArgs</a> <span id="r274 rd" class="r274 r">args</span>)
        {
            <b>if</b> (<span class="r274 r">args</span>.<a href="../hostifaces/Connection.cs.html#374d403c14f99b8f" class="i property">RunspaceAvailability</a> == <a href="../hostifaces/Connection.cs.html#bd6944cab8dcc583" class="t t">RunspaceAvailability</a>.<a href="../hostifaces/Connection.cs.html#64bc5c5290cfb16d" class="i field">Available</a>)
            {
                <a href="#2319eaf6f50eb472" class="i method">ReleaseInternalRunspaceDebugProcessing</a>(<span class="r273 r">sender</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Job debugger integration
 
        <b>private void</b> <a id="e10ab605fe30ca47" href="../../R/e10ab605fe30ca47.html" target="n" data-glyph="76,1" class="i method">AddToJobRunningList</a>(<a href="#cffdf22cdbc9b847" class="t t">PSJobStartEventArgs</a> <span id="r275 rd" class="r275 r">jobArgs</span>, <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a> <span id="r276 rd" class="r276 r">startAction</span>)
        {
            <b>bool</b> <span id="r277 rd" class="r277 r">newJob</span> = <b>false</b>;
 
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <span class="r275 r">jobArgs</span>.<a href="#e281908b7d5f2da4" class="i property">Job</a>.<a href="../remoting/client/Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> += <span class="i">HandleJobStateChanged</span>;
                <b>if</b> (<span class="r275 r">jobArgs</span>.<a href="#e281908b7d5f2da4" class="i property">Job</a>.<a href="../remoting/client/Job.cs.html#431bfb528e72aa9f" class="i method">IsPersistentState</a>(<span class="r275 r">jobArgs</span>.<a href="#e281908b7d5f2da4" class="i property">Job</a>.<a href="../remoting/client/Job.cs.html#896d1d1f27daae5f" class="i property">JobStateInfo</a>.<a href="../remoting/client/Job.cs.html#245057a5f4a9ed30" class="i property">State</a>))
                {
                    <span class="r275 r">jobArgs</span>.<a href="#e281908b7d5f2da4" class="i property">Job</a>.<a href="../remoting/client/Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> -= <span class="i">HandleJobStateChanged</span>;
                    <b>return</b>;
                }
 
                <b>if</b> (!<a href="#9b70248372b3e246" class="i field">_runningJobs</a>.<span class="i">ContainsKey</span>(<span class="r275 r">jobArgs</span>.<a href="#e281908b7d5f2da4" class="i property">Job</a>.<a href="../remoting/client/Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>))
                {
                    <span class="c">// For now ignore WF jobs started asynchronously from script.</span>
                    <b>if</b> (<span class="r275 r">jobArgs</span>.<a href="#165a1de89f7fced8" class="i property">IsAsync</a>) { <b>return</b>; }
 
                    <span class="c">// Turn on output processing monitoring on workflow job so that</span>
                    <span class="c">// the debug stop events can coordinate with end of output processing.</span>
                    <span class="r275 r">jobArgs</span>.<a href="#e281908b7d5f2da4" class="i property">Job</a>.<a href="../remoting/client/Job.cs.html#63d86448ba938f17" class="i">OutputProcessingStateChanged</a> += <span class="i">HandleOutputProcessingStateChanged</span>;
                    <span class="r275 r">jobArgs</span>.<a href="#e281908b7d5f2da4" class="i property">Job</a>.<a href="../remoting/client/Job.cs.html#72d48c1ba69954a8" class="i property">MonitorOutputProcessing</a> = <b>true</b>;
 
                    <a href="#9b70248372b3e246" class="i field">_runningJobs</a>.<span class="i">Add</span>(<span class="r275 r">jobArgs</span>.<a href="#e281908b7d5f2da4" class="i property">Job</a>.<a href="../remoting/client/Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>, <span class="r275 r">jobArgs</span>);
                    <span class="r275 r">jobArgs</span>.<a href="#f18e75085985ce41" class="i property">Debugger</a>.<a href="#4cf8436684b1ce9c" class="i">DebuggerStop</a> += <span class="i">HandleMonitorRunningJobsDebuggerStop</span>;
 
                    <span class="r277 r">newJob</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="r277 r">newJob</span>)
            {
                <span class="r275 r">jobArgs</span>.<a href="#f18e75085985ce41" class="i property">Debugger</a>.<span class="i">SetParent</span>(
                    <a href="#0d95bb604662e23b" class="k">this</a>,
                    <a href="#8ab62f8ec7d2132e" class="i field">_idToBreakpoint</a>.<span class="i">Values</span>.<span class="i">ToArray</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;(),
                    <span class="r276 r">startAction</span>,
                    <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>.<a href="../hostifaces/InternalHost.cs.html#f25431d0ab961179" class="i property">ExternalHost</a>,
                    <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="../SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../PathInterfaces.cs.html#91ffa5f8fc6b1308" class="i property">CurrentLocation</a>);
            }
            <b>else</b>
            {
                <span class="c">// If job already in collection then make sure start action is set.</span>
                <span class="c">// Note that this covers the case where Debug-Job was performed on</span>
                <span class="c">// an async job, which then becomes sync, the user continues execution</span>
                <span class="c">// and then wants to break (step mode) into the debugger *again*.</span>
                <span class="r275 r">jobArgs</span>.<a href="#f18e75085985ce41" class="i property">Debugger</a>.<a href="#e33bfc6122759440" class="i method">SetDebuggerStepMode</a>(<b>true</b>);
            }
        }
 
        <b>private void</b> <a id="dd0254e3d42a745f" href="../../R/dd0254e3d42a745f.html" target="n" data-glyph="76,1" class="i method">SetRunningJobListToStep</a>(<b>bool</b> <span id="r278 rd" class="r278 r">enableStepping</span>)
        {
            <a href="#cffdf22cdbc9b847" class="t t">PSJobStartEventArgs</a>[] <span id="r279 rd" class="r279 r">runningJobs</span>;
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <span class="r279 r">runningJobs</span> = <a href="#9b70248372b3e246" class="i field">_runningJobs</a>.<span class="i">Values</span>.<span class="i">ToArray</span>();
            }
 
            <b>foreach</b> (<a href="#cffdf22cdbc9b847" class="k">var</a> <span id="r280 rd" class="r280 r">item</span> <b>in</b> <span class="r279 r">runningJobs</span>)
            {
                <b>try</b>
                {
                    <span class="r280 r">item</span>.<a href="#f18e75085985ce41" class="i property">Debugger</a>.<a href="#e33bfc6122759440" class="i method">SetDebuggerStepMode</a>(<span class="r278 r">enableStepping</span>);
                }
                <b>catch</b> (<a href="../../utils/MshNotImplementedException.cs.html#ddab2b46a60907f3" class="t t">PSNotImplementedException</a>) { }
            }
        }
 
        <b>private void</b> <a id="eb8d4aee6ec37991" href="../../R/eb8d4aee6ec37991.html" target="n" data-glyph="76,1" class="i method">SetRunspaceListToStep</a>(<b>bool</b> <span id="r281 rd" class="r281 r">enableStepping</span>)
        {
            <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a>[] <span id="r282 rd" class="r282 r">runspaceList</span>;
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <span class="r282 r">runspaceList</span> = <a href="#68d085c8eb45aa5f" class="i field">_runningRunspaces</a>.<span class="i">Values</span>.<span class="i">ToArray</span>();
            }
 
            <b>foreach</b> (<a href="#ec28e88960630f53" class="k">var</a> <span id="r283 rd" class="r283 r">item</span> <b>in</b> <span class="r282 r">runspaceList</span>)
            {
                <b>try</b>
                {
                    <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r284 rd" class="r284 r">nestedDebugger</span> = <span class="r283 r">item</span>.<a href="#514755517c5ed096" class="i property">NestedDebugger</a>;
 
                    <b>if</b> (<span class="r284 r">nestedDebugger</span> != <b>null</b>)
                    {
                        <span class="r284 r">nestedDebugger</span>.<a href="#e33bfc6122759440" class="i method">SetDebuggerStepMode</a>(<span class="r281 r">enableStepping</span>);
                    }
                }
                <b>catch</b> (<a href="../../utils/MshNotImplementedException.cs.html#ddab2b46a60907f3" class="t t">PSNotImplementedException</a>) { }
            }
        }
 
        <b>private void</b> <a id="1cf06c7c3c9d5802" href="../../R/1cf06c7c3c9d5802.html" target="n" data-glyph="76,1" class="i method">RemoveFromRunningJobList</a>(<a href="../remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <span id="r285 rd" class="r285 r">job</span>)
        {
            <span class="r285 r">job</span>.<a href="../remoting/client/Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> -= <span class="i">HandleJobStateChanged</span>;
            <span class="r285 r">job</span>.<a href="../remoting/client/Job.cs.html#63d86448ba938f17" class="i">OutputProcessingStateChanged</a> -= <span class="i">HandleOutputProcessingStateChanged</span>;
 
            <a href="#cffdf22cdbc9b847" class="t t">PSJobStartEventArgs</a> <span id="r286 rd" class="r286 r">jobArgs</span> = <b>null</b>;
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <b>if</b> (<a href="#9b70248372b3e246" class="i field">_runningJobs</a>.<span class="i">TryGetValue</span>(<span class="r285 r">job</span>.<a href="../remoting/client/Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>, <b>out</b> <span class="r286 r">jobArgs</span>))
                {
                    <span class="r286 r">jobArgs</span>.<a href="#f18e75085985ce41" class="i property">Debugger</a>.<a href="#4cf8436684b1ce9c" class="i">DebuggerStop</a> -= <span class="i">HandleMonitorRunningJobsDebuggerStop</span>;
                    <a href="#9b70248372b3e246" class="i field">_runningJobs</a>.<span class="i">Remove</span>(<span class="r285 r">job</span>.<a href="../remoting/client/Job.cs.html#958365243a8fc2cd" class="i property">InstanceId</a>);
                }
            }
 
            <b>if</b> (<span class="r286 r">jobArgs</span> != <b>null</b>)
            {
                <span class="c">// Pop from active debugger stack.</span>
                <b>lock</b> (<a href="#d0cb7ecfcb4c3c6b" class="i field">_syncActiveDebuggerStopObject</a>)
                {
                    <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r287 rd" class="r287 r">activeDebugger</span>;
                    <b>if</b> (<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r287 r">activeDebugger</span>))
                    {
                        <b>if</b> (<span class="r287 r">activeDebugger</span>.<span class="i">Equals</span>(<span class="r286 r">jobArgs</span>.<a href="#f18e75085985ce41" class="i property">Debugger</a>))
                        {
                            <a href="#87e67702e81a688d" class="i method">PopActiveDebugger</a>();
                        }
                    }
                }
            }
        }
 
        <b>private void</b> <a id="60b81ac46249446b" href="../../R/60b81ac46249446b.html" target="n" data-glyph="76,1" class="i method">ClearRunningJobList</a>()
        {
            <a href="#cffdf22cdbc9b847" class="t t">PSJobStartEventArgs</a>[] <span id="r288 rd" class="r288 r">runningJobs</span> = <b>null</b>;
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <b>if</b> (<a href="#9b70248372b3e246" class="i field">_runningJobs</a>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="r288 r">runningJobs</span> = <b>new</b> <a href="#cffdf22cdbc9b847" class="t t">PSJobStartEventArgs</a>[<a href="#9b70248372b3e246" class="i field">_runningJobs</a>.<span class="i">Values</span>.<span class="i">Count</span>];
                    <a href="#9b70248372b3e246" class="i field">_runningJobs</a>.<span class="i">Values</span>.<span class="i">CopyTo</span>(<span class="r288 r">runningJobs</span>, 0);
                }
            }
 
            <b>if</b> (<span class="r288 r">runningJobs</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="#cffdf22cdbc9b847" class="k">var</a> <span id="r289 rd" class="r289 r">item</span> <b>in</b> <span class="r288 r">runningJobs</span>)
                {
                    <a href="#1cf06c7c3c9d5802" class="i method">RemoveFromRunningJobList</a>(<span class="r289 r">item</span>.<a href="#e281908b7d5f2da4" class="i property">Job</a>);
                }
            }
        }
 
        <b>private bool</b> <a id="6e82cbf585e4a417" href="../../R/6e82cbf585e4a417.html" target="n" data-glyph="76,1" class="i method">PushActiveDebugger</a>(<a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r290 rd" class="r290 r">debugger</span>, <b>int</b> <span id="r291 rd" class="r291 r">callstackOffset</span>)
        {
            <span class="c">// Don&#39;t push active debugger if script debugger disabled debugging.</span>
            <b>if</b> (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> == -1) { <b>return</b> <b>false</b>; }
 
            <span class="c">// Disable script debugging while another debugger is running.</span>
            <span class="c">// -1 - Indicates script debugging is disabled from script debugger.</span>
            <span class="c">// -2 - Indicates script debugging is disabled from pushed active debugger.</span>
            <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#d7b1cf2239bd91b6" class="i field">InPushedStop</a>);
 
            <span class="c">// Save running calling frame.</span>
            <a href="#381821f78732d634" class="i field">_nestedRunningFrame</a> = <a href="#f496970aab0b0b4c" class="i field">_callStack</a>[<a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#5363f64d745abb81" class="i property">Count</a> - <span class="r291 r">callstackOffset</span>];
 
            <a href="#d86cde82e8c1278b" class="i field">_commandProcessor</a>.<a href="#f17a591cdc659d26" class="i method">Reset</a>();
 
            <span class="c">// Make active debugger.</span>
            <a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">Push</span>(<span class="r290 r">debugger</span>);
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private</b> <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <a id="87e67702e81a688d" href="../../R/87e67702e81a688d.html" target="n" data-glyph="76,1" class="i method">PopActiveDebugger</a>()
        {
            <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r292 rd" class="r292 r">poppedDebugger</span> = <b>null</b>;
            <b>if</b> (<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">TryPop</span>(<b>out</b> <span class="r292 r">poppedDebugger</span>))
            {
                <b>int</b> <span id="r293 rd" class="r293 r">runningJobCount</span>;
                <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
                {
                    <span class="r293 r">runningJobCount</span> = <a href="#9b70248372b3e246" class="i field">_runningJobs</a>.<span class="i">Count</span>;
                }
 
                <b>if</b> (<span class="r293 r">runningJobCount</span> == 0)
                {
                    <span class="c">// If we are back to the root debugger and are in step mode, ensure</span>
                    <span class="c">// that the root debugger is in step mode to continue stepping.</span>
                    <b>switch</b> (<a href="#285b7e0548cc6c33" class="i field">_lastActiveDebuggerAction</a>)
                    {
                        <b>case</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#422455533b156acf" class="i field">StepInto</a>:
                        <b>case</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#de21a4b4866a13cc" class="i field">StepOver</a>:
                        <b>case</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#4cfb4add3c03409c" class="i field">StepOut</a>:
                            <span class="c">// Set script debugger to step mode after the WF running</span>
                            <span class="c">// script completes.</span>
                            <a href="#57792450deac46c7" class="i field">_steppingMode</a> = <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#b13a6fed8931e742" class="i field">StepIn</a>;
                            <a href="#2059b645ea13c8cf" class="i field">_overOrOutFrame</a> = <a href="#381821f78732d634" class="i field">_nestedRunningFrame</a>;
                            <a href="#381821f78732d634" class="i field">_nestedRunningFrame</a> = <b>null</b>;
                            <b>break</b>;
 
                        <b>case</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#9c143ec10eabd6ad" class="i field">Stop</a>:
                            <a href="#822a39b6aaf94b98" class="i field">_nestedDebuggerStop</a> = <b>true</b>;
                            <b>break</b>;
 
                        <b>default</b>:
                            <a href="#27abb455d0aa0716" class="i method">ResumeExecution</a>(<a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>);
                            <b>break</b>;
                    }
 
                    <span class="c">// Allow script debugger to continue in debugging mode.</span>
                    <a href="#f407eb35d5fdf562" class="i field">_processingOutputCount</a> = 0;
                    <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a>);
                    <a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a> = <a href="#285b7e0548cc6c33" class="i field">_lastActiveDebuggerAction</a>;
                    <a href="#285b7e0548cc6c33" class="i field">_lastActiveDebuggerAction</a> = <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>;
                }
            }
 
            <b>return</b> <span class="r292 r">poppedDebugger</span>;
        }
 
        <b>private void</b> <a id="eee57a3cdec52a09" href="../../R/eee57a3cdec52a09.html" target="n" data-glyph="76,1" class="i method">HandleActiveJobDebuggerStop</a>(<b>object</b> <span id="r294 rd" class="r294 r">sender</span>, <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r295 rd" class="r295 r">args</span>)
        {
            <span class="c">// If we are debugging nested runspaces then ignore job debugger stops</span>
            <b>if</b> (<a href="#68d085c8eb45aa5f" class="i field">_runningRunspaces</a>.<span class="i">Count</span> &gt; 0) { <b>return</b>; }
 
            <span class="c">// Forward active debugger event.</span>
            <b>if</b> (<span class="r295 r">args</span> != <b>null</b>)
            {
                <span class="c">// Save copy of arguments.</span>
                <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r296 rd" class="r296 r">copyArgs</span> = <b>new</b> <a href="#7ac766b9a835f3a6" class="t constructor">DebuggerStopEventArgs</a>(
                    <span class="r295 r">args</span>.<a href="#bf5b2fd8de78c287" class="i property">InvocationInfo</a>,
                    <b>new</b> <span class="i">Collection</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;(<span class="r295 r">args</span>.<a href="#745a4c67d985896b" class="i property">Breakpoints</a>),
                    <span class="r295 r">args</span>.<a href="#b6941352f3c2c41c" class="i property">ResumeAction</a>);
                <a href="#2772de8722870503" class="i field">_debuggerStopEventArgs</a>.<span class="i">Push</span>(<span class="r296 r">copyArgs</span>);
 
                <a href="#66c884979ca0dfea" class="t t">CallStackInfo</a> <span id="r297 rd" class="r297 r">savedCallStackItem</span> = <b>null</b>;
                <b>try</b>
                {
                    <span class="c">// Wait for up to 5 seconds for output processing to complete.</span>
                    <a href="#7233165c4586febe" class="i field">_processingOutputCompleteEvent</a>.<span class="i">Wait</span>(5000);
 
                    <span class="c">// Fix up call stack representing this WF call.</span>
                    <span class="r297 r">savedCallStackItem</span> = <a href="#216cad884189af21" class="i method">FixUpCallStack</a>();
 
                    <span class="c">// Blocking call that raises stop event.</span>
                    <a href="#19eff05653875667" class="i method">RaiseDebuggerStopEvent</a>(<span class="r295 r">args</span>);
                    <a href="#285b7e0548cc6c33" class="i field">_lastActiveDebuggerAction</a> = <span class="r295 r">args</span>.<a href="#b6941352f3c2c41c" class="i property">ResumeAction</a>;
                }
                <b>finally</b>
                {
                    <a href="#67a6ac9e69d794e4" class="i method">RestoreCallStack</a>(<span class="r297 r">savedCallStackItem</span>);
                    <a href="#2772de8722870503" class="i field">_debuggerStopEventArgs</a>.<span class="i">TryPop</span>(<b>out</b> <span class="r296 r">copyArgs</span>);
                }
            }
        }
 
        <b>private</b> <a href="#66c884979ca0dfea" class="t t">CallStackInfo</a> <a id="216cad884189af21" href="../../R/216cad884189af21.html" target="n" data-glyph="76,1" class="i method">FixUpCallStack</a>()
        {
            <span class="c">// Remove the top level call stack item, which is</span>
            <span class="c">// the PS script that starts the workflow.  The workflow</span>
            <span class="c">// debugger will add its call stack in its GetCallStack()</span>
            <span class="c">// override.</span>
            <b>int</b> <span id="r298 rd" class="r298 r">count</span> = <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#5363f64d745abb81" class="i property">Count</a>;
            <a href="#66c884979ca0dfea" class="t t">CallStackInfo</a> <span id="r299 rd" class="r299 r">item</span> = <b>null</b>;
            <b>if</b> (<span class="r298 r">count</span> &gt; 1)
            {
                <span class="r299 r">item</span> = <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#15bc8b05295691f1" class="i method">Last</a>();
                <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<span class="i">RemoveAt</span>(<span class="r298 r">count</span> - 1);
            }
 
            <b>return</b> <span class="r299 r">item</span>;
        }
 
        <b>private void</b> <a id="67a6ac9e69d794e4" href="../../R/67a6ac9e69d794e4.html" target="n" data-glyph="76,1" class="i method">RestoreCallStack</a>(<a href="#66c884979ca0dfea" class="t t">CallStackInfo</a> <span id="r300 rd" class="r300 r">item</span>)
        {
            <b>if</b> (<span class="r300 r">item</span> != <b>null</b>)
            {
                <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#a9b1f531d32a7876" class="i method">Add</a>(<span class="r300 r">item</span>);
            }
        }
 
        <b>private void</b> <a id="b8101c164e3d86c1" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleMonitorRunningJobsDebuggerStop</a>(<b>object</b> <span id="r301 rd" class="r301 r">sender</span>, <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r302 rd" class="r302 r">args</span>)
        {
            <b>if</b> (!<a href="#bcc8c0b81235f726" class="i method">IsJobDebuggingMode</a>())
            {
                <span class="c">// Ignore job debugger stop.</span>
                <span class="r302 r">args</span>.<a href="#b6941352f3c2c41c" class="i property">ResumeAction</a> = <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>;
                <b>return</b>;
            }
 
            <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r303 rd" class="r303 r">senderDebugger</span> = <span class="r301 r">sender</span> <b>as</b> <a href="#9e8f0b396592e65c" class="t t">Debugger</a>;
            <b>bool</b> <span id="r304 rd" class="r304 r">pushSucceeded</span> = <b>false</b>;
            <b>lock</b> (<a href="#d0cb7ecfcb4c3c6b" class="i field">_syncActiveDebuggerStopObject</a>)
            {
                <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r305 rd" class="r305 r">activeDebugger</span> = <b>null</b>;
                <b>if</b> (<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r305 r">activeDebugger</span>))
                {
                    <b>if</b> (<span class="r305 r">activeDebugger</span>.<span class="i">Equals</span>(<span class="r303 r">senderDebugger</span>))
                    {
                        <a href="#eee57a3cdec52a09" class="i method">HandleActiveJobDebuggerStop</a>(<span class="r301 r">sender</span>, <span class="r302 r">args</span>);
                        <b>return</b>;
                    }
 
                    <b>if</b> (<a href="#c2fcd43e842a47a9" class="i method">IsRunningWFJobsDebugger</a>(<span class="r305 r">activeDebugger</span>))
                    {
                        <span class="c">// Replace current job active debugger by first popping.</span>
                        <a href="#87e67702e81a688d" class="i method">PopActiveDebugger</a>();
                    }
                }
 
                <span class="r304 r">pushSucceeded</span> = <a href="#6e82cbf585e4a417" class="i method">PushActiveDebugger</a>(<span class="r303 r">senderDebugger</span>, <a href="#908093f543bdde1b" class="i field">_jobCallStackOffset</a>);
            }
 
            <span class="c">// Handle debugger stop outside lock.</span>
            <b>if</b> (<span class="r304 r">pushSucceeded</span>)
            {
                <span class="c">// Forward the debug stop event.</span>
                <a href="#eee57a3cdec52a09" class="i method">HandleActiveJobDebuggerStop</a>(<span class="r301 r">sender</span>, <span class="r302 r">args</span>);
            }
        }
 
        <b>private bool</b> <a id="bcc8c0b81235f726" href="../../R/bcc8c0b81235f726.html" target="n" data-glyph="76,1" class="i method">IsJobDebuggingMode</a>()
        {
            <b>return</b> ((((<a href="#cb370f0b35bef91f" class="i property">DebugMode</a> &amp; <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#8f7455ad81a2c081" class="i field">LocalScript</a>) == <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#8f7455ad81a2c081" class="i field">LocalScript</a>) &amp;&amp; <a href="#41a8c03f52ff7ac4" class="i property">IsLocalSession</a>) ||
                    (((<a href="#cb370f0b35bef91f" class="i property">DebugMode</a> &amp; <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#36492991f477f6e1" class="i field">RemoteScript</a>) == <a href="#7e71da719f103cfd" class="t t">DebugModes</a>.<a href="#36492991f477f6e1" class="i field">RemoteScript</a>) &amp;&amp; !<a href="#41a8c03f52ff7ac4" class="i property">IsLocalSession</a>));
        }
 
        <b>private bool</b> <a id="c2fcd43e842a47a9" href="../../R/c2fcd43e842a47a9.html" target="n" data-glyph="76,1" class="i method">IsRunningWFJobsDebugger</a>(<a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r306 rd" class="r306 r">debugger</span>)
        {
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <b>foreach</b> (<b>var</b> <span id="r307 rd" class="r307 r">item</span> <b>in</b> <a href="#9b70248372b3e246" class="i field">_runningJobs</a>.<span class="i">Values</span>)
                {
                    <b>if</b> (<span class="r307 r">item</span>.<span class="i">Debugger</span>.<span class="i">Equals</span>(<span class="r306 r">debugger</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private void</b> <a id="295887dfaae5b02f" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleJobStateChanged</a>(<b>object</b> <span id="r308 rd" class="r308 r">sender</span>, <a href="../remoting/client/Job.cs.html#efe480d4e86a46d4" class="t t">JobStateEventArgs</a> <span id="r309 rd" class="r309 r">args</span>)
        {
            <a href="../remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <span id="r310 rd" class="r310 r">job</span> = <span class="r308 r">sender</span> <b>as</b> <a href="../remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a>;
 
            <b>if</b> (<span class="r310 r">job</span>.<a href="../remoting/client/Job.cs.html#431bfb528e72aa9f" class="i method">IsPersistentState</a>(<span class="r309 r">args</span>.<a href="../remoting/client/Job.cs.html#7e34bf23c7781be3" class="i property">JobStateInfo</a>.<a href="../remoting/client/Job.cs.html#245057a5f4a9ed30" class="i property">State</a>))
            {
                <a href="#1cf06c7c3c9d5802" class="i method">RemoveFromRunningJobList</a>(<span class="r310 r">job</span>);
            }
        }
 
        <b>private void</b> <a id="07ffaebe9d739512" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleOutputProcessingStateChanged</a>(<b>object</b> <span id="r311 rd" class="r311 r">sender</span>, <a href="../remoting/client/Job.cs.html#7e5214a3bc47f956" class="t t">OutputProcessingStateEventArgs</a> <span id="r312 rd" class="r312 r">e</span>)
        {
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <b>if</b> (<span class="r312 r">e</span>.<a href="../remoting/client/Job.cs.html#814114db50065da3" class="i property">ProcessingOutput</a>)
                {
                    <b>if</b> (++<a href="#f407eb35d5fdf562" class="i field">_processingOutputCount</a> == 1)
                    {
                        <a href="#7233165c4586febe" class="i field">_processingOutputCompleteEvent</a>.<span class="i">Reset</span>();
                    }
                }
                <b>else</b> <b>if</b> (<a href="#f407eb35d5fdf562" class="i field">_processingOutputCount</a> &gt; 0)
                {
                    <b>if</b> (--<a href="#f407eb35d5fdf562" class="i field">_processingOutputCount</a> == 0)
                    {
                        <a href="#7233165c4586febe" class="i field">_processingOutputCompleteEvent</a>.<span class="i">Set</span>();
                    }
                }
            }
        }
 
        <b>private</b> <a href="#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <a id="f9c7c54a3f97666e" href="../../R/f9c7c54a3f97666e.html" target="n" data-glyph="76,1" class="i method">ProcessCommandForActiveDebugger</a>(<a href="../hostifaces/PSCommand.cs.html#b9f024f73904cf55" class="t t">PSCommand</a> <span id="r313 rd" class="r313 r">command</span>, <a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r314 rd" class="r314 r">output</span>)
        {
            <span class="c">// Check for debugger &quot;detach&quot; command which is only applicable to nested debugging.</span>
            <b>bool</b> <span id="r315 rd" class="r315 r">detachCommand</span> = ((<span class="r313 r">command</span>.<a href="../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>.<span class="i">Count</span> &gt; 0) &amp;&amp;
                                  ((<span class="r313 r">command</span>.<a href="../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>[0].<span class="i">CommandText</span>.<span class="i">Equals</span>(<span class="s">&quot;Detach&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)) ||
                                   (<span class="r313 r">command</span>.<a href="../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>[0].<span class="i">CommandText</span>.<span class="i">Equals</span>(<span class="s">&quot;d&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))));
 
            <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r316 rd" class="r316 r">activeDebugger</span>;
            <b>if</b> (<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r316 r">activeDebugger</span>))
            {
                <b>if</b> (<span class="r315 r">detachCommand</span>)
                {
                    <span class="c">// Exit command means to cancel the nested debugger session.  This needs to be done by the</span>
                    <span class="c">// owner of the session so we raise an event and release the debugger stop.</span>
                    <a href="#b0571e2bdd2e6b30" class="i property">UnhandledBreakpointMode</a> = <a href="#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="#e18be175ebce8c0f" class="i field">Ignore</a>;
                    <a href="#ee88acde413c3219" class="i method">RaiseNestedDebuggingCancelEvent</a>();
                    <b>return</b> <b>new</b> <a href="#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>, <b>true</b>);
                }
                <b>else</b> <b>if</b> ((<span class="r313 r">command</span>.<a href="../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>.<span class="i">Count</span> &gt; 0) &amp;&amp;
                         (<span class="r313 r">command</span>.<a href="../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>[0].<span class="i">CommandText</span>.<span class="i">IndexOf</span>(<span class="s">&quot;.EnterNestedPrompt()&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &gt; 0))
                {
                    <span class="c">// Prevent a host EnterNestedPrompt() call from occuring in an active debugger.</span>
                    <span class="c">// Host nested prompt makes no sense in this case and can cause host to stop responding depending on host implementation.</span>
                    <b>throw</b> <b>new</b> <a href="../../utils/MshNotSupportedException.cs.html#d102768354b20ef7" class="t constructor">PSNotSupportedException</a>();
                }
 
                <span class="c">// Get current debugger stop breakpoint info.</span>
                <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r317 rd" class="r317 r">stopArgs</span>;
                <b>if</b> (<a href="#2772de8722870503" class="i field">_debuggerStopEventArgs</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r317 r">stopArgs</span>))
                {
                    <b>string</b> <span id="r318 rd" class="r318 r">commandText</span> = <span class="r313 r">command</span>.<a href="../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>[0].<span class="i">CommandText</span>;
 
                    <span class="c">// Check to see if this is a resume command that we handle here.</span>
                    <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <span id="r319 rd" class="r319 r">dbgCommand</span> = <a href="#d86cde82e8c1278b" class="i field">_commandProcessor</a>.<a href="#d3fd3e29b2d11bff" class="i method">ProcessBasicCommand</a>(<span class="r318 r">commandText</span>);
                    <b>if</b> (<span class="r319 r">dbgCommand</span> != <b>null</b> &amp;&amp;
                        <span class="r319 r">dbgCommand</span>.<a href="#4aad237c27ce8bd0" class="i property">ResumeAction</a> != <b>null</b>)
                    {
                        <a href="#285b7e0548cc6c33" class="i field">_lastActiveDebuggerAction</a> = <span class="r319 r">dbgCommand</span>.<a href="#4aad237c27ce8bd0" class="i property">ResumeAction</a>.<span class="i">Value</span>;
                        <b>return</b> <b>new</b> <a href="#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<span class="r319 r">dbgCommand</span>.<a href="#4aad237c27ce8bd0" class="i property">ResumeAction</a>, <b>true</b>);
                    }
                }
 
                <b>return</b> <span class="r316 r">activeDebugger</span>.<a href="#f752da7b39207812" class="i method">ProcessCommand</a>(<span class="r313 r">command</span>, <span class="r314 r">output</span>);
            }
 
            <b>if</b> (<span class="r315 r">detachCommand</span>)
            {
                <span class="c">// Detach command only applies to nested debugging.  So if there isn&#39;t any active debugger then emit error.</span>
                <b>throw</b> <b>new</b> <span class="t">PSInvalidOperationException</span>(<span class="i">DebuggerStrings</span>.<span class="i">InvalidDetachCommand</span>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private bool</b> <a id="a57e244ad502e771" href="../../R/a57e244ad502e771.html" target="n" data-glyph="76,1" class="i method">StopCommandForActiveDebugger</a>()
        {
            <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r320 rd" class="r320 r">activeDebugger</span>;
            <b>if</b> (<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r320 r">activeDebugger</span>))
            {
                <span class="r320 r">activeDebugger</span>.<a href="#bcb115e0eda53c00" class="i method">StopProcessCommand</a>();
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace debugger integration
 
        <b>internal override void</b> <a id="c0bfeab8ed4d9806" href="../../R/c0bfeab8ed4d9806.html" target="n" data-glyph="74,1" class="i method">StartMonitoringRunspace</a>(<a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a> <span id="r321 rd" class="r321 r">runspaceInfo</span>)
        {
            <b>if</b> (<span class="r321 r">runspaceInfo</span> == <b>null</b> || <span class="r321 r">runspaceInfo</span>.<a href="#c9a2faca9dff1fec" class="i property">Runspace</a> == <b>null</b>) { <b>return</b>; }
 
            <b>if</b> ((<span class="r321 r">runspaceInfo</span>.<a href="#c9a2faca9dff1fec" class="i property">Runspace</a>.<a href="../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a> != <b>null</b>) &amp;&amp;
                <span class="r321 r">runspaceInfo</span>.<a href="#c9a2faca9dff1fec" class="i property">Runspace</a>.<a href="../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>.<span class="i">Equals</span>(<a href="#0d95bb604662e23b" class="k">this</a>))
            {
                <span class="i">Debug</span>.<span class="i">Fail</span>(<span class="s">&quot;Nested debugger cannot be the root debugger.&quot;</span>);
                <b>return</b>;
            }
 
            <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a> <span id="r322 rd" class="r322 r">startAction</span> = (<a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a> == <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#422455533b156acf" class="i field">StepInto</a>) ?
                <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#422455533b156acf" class="i field">StepInto</a> : <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>;
 
            <a href="#e02a4010f6f7ded2" class="i method">AddToRunningRunspaceList</a>(<span class="r321 r">runspaceInfo</span>.<a href="#2f40f487f9e1d3c2" class="i method">Copy</a>());
        }
 
        <b>internal override void</b> <a id="cda9d7e783345d47" href="../../R/cda9d7e783345d47.html" target="n" data-glyph="74,1" class="i method">EndMonitoringRunspace</a>(<a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a> <span id="r323 rd" class="r323 r">runspaceInfo</span>)
        {
            <b>if</b> (<span class="r323 r">runspaceInfo</span> == <b>null</b> || <span class="r323 r">runspaceInfo</span>.<a href="#c9a2faca9dff1fec" class="i property">Runspace</a> == <b>null</b>) { <b>return</b>; }
 
            <a href="#4e743e132b598b56" class="i method">RemoveFromRunningRunspaceList</a>(<span class="r323 r">runspaceInfo</span>.<a href="#c9a2faca9dff1fec" class="i property">Runspace</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a debug stop event is currently pending then this method will release</span>
        <span class="c">///</span><span class="c"> the event to continue processing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="40c888fb804e0de7" href="../../R/40c888fb804e0de7.html" target="n" data-glyph="74,1" class="i method">ReleaseSavedDebugStop</a>()
        {
            <b>if</b> (<a href="#055796f7d08afd08" class="i property">IsPendingDebugStopEvent</a>)
            {
                <a href="#ce9910145cd5a126" class="i field">_preserveDebugStopEvent</a>.<span class="i">Set</span>();
            }
        }
 
        <b>private void</b> <a id="e02a4010f6f7ded2" href="../../R/e02a4010f6f7ded2.html" target="n" data-glyph="76,1" class="i method">AddToRunningRunspaceList</a>(<a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a> <span id="r324 rd" class="r324 r">args</span>)
        {
            <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r325 rd" class="r325 r">runspace</span> = <span class="r324 r">args</span>.<a href="#c9a2faca9dff1fec" class="i property">Runspace</a>;
            <span class="r325 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#6866e88f64eb13d6" class="i">StateChanged</a> += <span class="i">HandleRunspaceStateChanged</span>;
            <a href="../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a> <span id="r326 rd" class="r326 r">rsState</span> = <span class="r325 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#01b12fbdab6c561a" class="i property">RunspaceStateInfo</a>.<a href="../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>;
            <b>if</b> (<span class="r326 r">rsState</span> == <a href="../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../hostifaces/Connection.cs.html#e4c76740d99e58bd" class="i field">Broken</a> ||
                <span class="r326 r">rsState</span> == <a href="../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../hostifaces/Connection.cs.html#45de84b67ba18f3f" class="i field">Closed</a> ||
                <span class="r326 r">rsState</span> == <a href="../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../hostifaces/Connection.cs.html#0a8fc62a22d129a1" class="i field">Disconnected</a>)
            {
                <span class="r325 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#6866e88f64eb13d6" class="i">StateChanged</a> -= <span class="i">HandleRunspaceStateChanged</span>;
                <b>return</b>;
            }
 
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <b>if</b> (!<a href="#68d085c8eb45aa5f" class="i field">_runningRunspaces</a>.<span class="i">ContainsKey</span>(<span class="r325 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>))
                {
                    <a href="#68d085c8eb45aa5f" class="i field">_runningRunspaces</a>.<span class="i">Add</span>(<span class="r325 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>, <span class="r324 r">args</span>);
                }
            }
 
            <span class="c">// It is possible for the debugger to be non-null at this point if a runspace</span>
            <span class="c">// is being reused.</span>
            <a href="#ca4cdd54e09802ca" class="i method">SetUpDebuggerOnRunspace</a>(<span class="r325 r">runspace</span>);
        }
 
        <b>private void</b> <a id="4e743e132b598b56" href="../../R/4e743e132b598b56.html" target="n" data-glyph="76,1" class="i method">RemoveFromRunningRunspaceList</a>(<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r327 rd" class="r327 r">runspace</span>)
        {
            <span class="r327 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#6866e88f64eb13d6" class="i">StateChanged</a> -= <span class="i">HandleRunspaceStateChanged</span>;
 
            <span class="c">// Remove from running list.</span>
            <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a> <span id="r328 rd" class="r328 r">runspaceInfo</span> = <b>null</b>;
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <b>if</b> (<a href="#68d085c8eb45aa5f" class="i field">_runningRunspaces</a>.<span class="i">TryGetValue</span>(<span class="r327 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>, <b>out</b> <span class="r328 r">runspaceInfo</span>))
                {
                    <a href="#68d085c8eb45aa5f" class="i field">_runningRunspaces</a>.<span class="i">Remove</span>(<span class="r327 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>);
                }
            }
 
            <span class="c">// Clean up nested debugger.</span>
            <a href="#06468cc0107c4c70" class="t t">NestedRunspaceDebugger</a> <span id="r329 rd" class="r329 r">nestedDebugger</span> = <span class="r328 r">runspaceInfo</span>?.<a href="#514755517c5ed096" class="i property">NestedDebugger</a>;
            <b>if</b> (<span class="r329 r">nestedDebugger</span> != <b>null</b>)
            {
                <span class="r329 r">nestedDebugger</span>.<a href="#4cf8436684b1ce9c" class="i">DebuggerStop</a> -= <span class="i">HandleMonitorRunningRSDebuggerStop</span>;
                <span class="r329 r">nestedDebugger</span>.<a href="#2f3da5d16b706ffe" class="i method">Dispose</a>();
 
                <span class="c">// If current active debugger, then pop.</span>
                <b>lock</b> (<a href="#d0cb7ecfcb4c3c6b" class="i field">_syncActiveDebuggerStopObject</a>)
                {
                    <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r330 rd" class="r330 r">activeDebugger</span>;
                    <b>if</b> (<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r330 r">activeDebugger</span>))
                    {
                        <b>if</b> (<span class="r330 r">activeDebugger</span>.<span class="i">Equals</span>(<span class="r329 r">nestedDebugger</span>))
                        {
                            <a href="#87e67702e81a688d" class="i method">PopActiveDebugger</a>();
                        }
                    }
                }
            }
        }
 
        <b>private void</b> <a id="28a40543a3d08878" href="../../R/28a40543a3d08878.html" target="n" data-glyph="76,1" class="i method">ClearRunningRunspaceList</a>()
        {
            <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a>[] <span id="r331 rd" class="r331 r">runningRunspaces</span> = <b>null</b>;
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <b>if</b> (<a href="#68d085c8eb45aa5f" class="i field">_runningRunspaces</a>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="r331 r">runningRunspaces</span> = <b>new</b> <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a>[<a href="#68d085c8eb45aa5f" class="i field">_runningRunspaces</a>.<span class="i">Count</span>];
                    <a href="#68d085c8eb45aa5f" class="i field">_runningRunspaces</a>.<span class="i">Values</span>.<span class="i">CopyTo</span>(<span class="r331 r">runningRunspaces</span>, 0);
                }
            }
 
            <b>if</b> (<span class="r331 r">runningRunspaces</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="#ec28e88960630f53" class="k">var</a> <span id="r332 rd" class="r332 r">item</span> <b>in</b> <span class="r331 r">runningRunspaces</span>)
                {
                    <a href="#4e743e132b598b56" class="i method">RemoveFromRunningRunspaceList</a>(<span class="r332 r">item</span>.<a href="#c9a2faca9dff1fec" class="i property">Runspace</a>);
                }
            }
        }
 
        <b>private void</b> <a id="be706d95f597cf5f" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleRunspaceStateChanged</a>(<b>object</b> <span id="r333 rd" class="r333 r">sender</span>, <a href="../hostifaces/Connection.cs.html#24ce8f9c69bf1c4a" class="t t">RunspaceStateEventArgs</a> <span id="r334 rd" class="r334 r">e</span>)
        {
            <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r335 rd" class="r335 r">runspace</span> = <span class="r333 r">sender</span> <b>as</b> <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>;
            <b>bool</b> <span id="r336 rd" class="r336 r">remove</span> = <b>false</b>;
 
            <b>switch</b> (<span class="r334 r">e</span>.<a href="../hostifaces/Connection.cs.html#efb5571439376cca" class="i property">RunspaceStateInfo</a>.<a href="../hostifaces/Connection.cs.html#41627f067662d11c" class="i property">State</a>)
            {
                <span class="c">// Detect transition to Opened state.</span>
                <b>case</b> <a href="../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../hostifaces/Connection.cs.html#9a99efb0eaa3c3db" class="i field">Opened</a>:
                    <span class="r336 r">remove</span> = !<a href="#ca4cdd54e09802ca" class="i method">SetUpDebuggerOnRunspace</a>(<span class="r335 r">runspace</span>);
                    <b>break</b>;
 
                <span class="c">// Detect any transition to a finished runspace.</span>
                <b>case</b> <a href="../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../hostifaces/Connection.cs.html#e4c76740d99e58bd" class="i field">Broken</a>:
                <b>case</b> <a href="../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../hostifaces/Connection.cs.html#45de84b67ba18f3f" class="i field">Closed</a>:
                <b>case</b> <a href="../hostifaces/Connection.cs.html#5da9dc65e996a685" class="t t">RunspaceState</a>.<a href="../hostifaces/Connection.cs.html#0a8fc62a22d129a1" class="i field">Disconnected</a>:
                    <span class="r336 r">remove</span> = <b>true</b>;
                    <b>break</b>;
            }
 
            <b>if</b> (<span class="r336 r">remove</span>)
            {
                <a href="#4e743e132b598b56" class="i method">RemoveFromRunningRunspaceList</a>(<span class="r335 r">runspace</span>);
            }
        }
 
        <b>private void</b> <a id="811ee799a307a5f9" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">HandleMonitorRunningRSDebuggerStop</a>(<b>object</b> <span id="r337 rd" class="r337 r">sender</span>, <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r338 rd" class="r338 r">args</span>)
        {
            <b>if</b> (<span class="r337 r">sender</span> == <b>null</b> || <span class="r338 r">args</span> == <b>null</b>) { <b>return</b>; }
 
            <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r339 rd" class="r339 r">senderDebugger</span> = <span class="r337 r">sender</span> <b>as</b> <a href="#9e8f0b396592e65c" class="t t">Debugger</a>;
            <b>bool</b> <span id="r340 rd" class="r340 r">pushSucceeded</span> = <b>false</b>;
            <b>lock</b> (<a href="#d0cb7ecfcb4c3c6b" class="i field">_syncActiveDebuggerStopObject</a>)
            {
                <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r341 rd" class="r341 r">activeDebugger</span>;
                <b>if</b> (<a href="#9e17718415fd538f" class="i field">_activeDebuggers</a>.<span class="i">TryPeek</span>(<b>out</b> <span class="r341 r">activeDebugger</span>))
                {
                    <span class="c">// Replace current runspace debugger by first popping the old debugger.</span>
                    <b>if</b> (<a href="#0a088d7ac9d964ed" class="i method">IsRunningRSDebugger</a>(<span class="r341 r">activeDebugger</span>))
                    {
                        <a href="#87e67702e81a688d" class="i method">PopActiveDebugger</a>();
                    }
                }
 
                <span class="c">// Get nested debugger runspace info.</span>
                <b>if</b> (!(<span class="r339 r">senderDebugger</span> <b>is</b> <a href="#06468cc0107c4c70" class="t t">NestedRunspaceDebugger</a> <span id="r342 rd" class="r342 r">nestedDebugger</span>)) { <b>return</b>; }
 
                <a href="#29c6cf229c9fc955" class="t t">PSMonitorRunspaceType</a> <span id="r343 rd" class="r343 r">runspaceType</span> = <span class="r342 r">nestedDebugger</span>.<a href="#52702b6b921f6535" class="i property">RunspaceType</a>;
 
                <span class="c">// Fix up invocation info script extents for embedded nested debuggers where the script source is</span>
                <span class="c">// from the parent.</span>
                <span class="r338 r">args</span>.<a href="#bf5b2fd8de78c287" class="i property">InvocationInfo</a> = <span class="r342 r">nestedDebugger</span>.<a href="#c56bb01cb3c3985e" class="i method">FixupInvocationInfo</a>(<span class="r338 r">args</span>.<a href="#bf5b2fd8de78c287" class="i property">InvocationInfo</a>);
 
                <span class="c">// Finally push the runspace debugger.</span>
                <span class="r340 r">pushSucceeded</span> = <a href="#6e82cbf585e4a417" class="i method">PushActiveDebugger</a>(<span class="r339 r">senderDebugger</span>, <a href="#a93cf9b6587a3f2f" class="i field">_runspaceCallStackOffset</a>);
            }
 
            <span class="c">// Handle debugger stop outside lock.</span>
            <b>if</b> (<span class="r340 r">pushSucceeded</span>)
            {
                <span class="c">// Forward the debug stop event.</span>
                <span class="c">// This method will always pop the debugger after debugger stop completes.</span>
                <a href="#2a875f97cd1b9843" class="i method">HandleActiveRunspaceDebuggerStop</a>(<span class="r337 r">sender</span>, <span class="r338 r">args</span>);
            }
        }
 
        <b>private void</b> <a id="2a875f97cd1b9843" href="../../R/2a875f97cd1b9843.html" target="n" data-glyph="76,1" class="i method">HandleActiveRunspaceDebuggerStop</a>(<b>object</b> <span id="r344 rd" class="r344 r">sender</span>, <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r345 rd" class="r345 r">args</span>)
        {
            <span class="c">// Save copy of arguments.</span>
            <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r346 rd" class="r346 r">copyArgs</span> = <b>new</b> <a href="#7ac766b9a835f3a6" class="t constructor">DebuggerStopEventArgs</a>(
                <span class="r345 r">args</span>.<a href="#bf5b2fd8de78c287" class="i property">InvocationInfo</a>,
                <b>new</b> <span class="i">Collection</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;(<span class="r345 r">args</span>.<a href="#745a4c67d985896b" class="i property">Breakpoints</a>),
                <span class="r345 r">args</span>.<a href="#b6941352f3c2c41c" class="i property">ResumeAction</a>);
            <a href="#2772de8722870503" class="i field">_debuggerStopEventArgs</a>.<span class="i">Push</span>(<span class="r346 r">copyArgs</span>);
 
            <span class="c">// Forward active debugger event.</span>
            <b>try</b>
            {
                <span class="c">// Blocking call that raises the stop event.</span>
                <a href="#19eff05653875667" class="i method">RaiseDebuggerStopEvent</a>(<span class="r345 r">args</span>);
                <a href="#285b7e0548cc6c33" class="i field">_lastActiveDebuggerAction</a> = <span class="r345 r">args</span>.<a href="#b6941352f3c2c41c" class="i property">ResumeAction</a>;
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <span class="c">// Catch all external user generated exceptions thrown on event thread.</span>
            }
            <b>finally</b>
            {
                <a href="#2772de8722870503" class="i field">_debuggerStopEventArgs</a>.<span class="i">TryPop</span>(<b>out</b> <span class="r346 r">copyArgs</span>);
                <a href="#87e67702e81a688d" class="i method">PopActiveDebugger</a>();
            }
        }
 
        <b>private bool</b> <a id="0a088d7ac9d964ed" href="../../R/0a088d7ac9d964ed.html" target="n" data-glyph="76,1" class="i method">IsRunningRSDebugger</a>(<a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r347 rd" class="r347 r">debugger</span>)
        {
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <b>foreach</b> (<b>var</b> <span id="r348 rd" class="r348 r">item</span> <b>in</b> <a href="#68d085c8eb45aa5f" class="i field">_runningRunspaces</a>.<span class="i">Values</span>)
                {
                    <b>if</b> (<span class="r348 r">item</span>.<span class="i">Runspace</span>.<span class="i">Debugger</span>.<span class="i">Equals</span>(<span class="r347 r">debugger</span>))
                    {
                        <b>return</b> <b>true</b>;
                    }
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private bool</b> <a id="ca4cdd54e09802ca" href="../../R/ca4cdd54e09802ca.html" target="n" data-glyph="76,1" class="i method">SetUpDebuggerOnRunspace</a>(<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r349 rd" class="r349 r">runspace</span>)
        {
            <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a> <span id="r350 rd" class="r350 r">runspaceInfo</span> = <b>null</b>;
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <a href="#68d085c8eb45aa5f" class="i field">_runningRunspaces</a>.<span class="i">TryGetValue</span>(<span class="r349 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#af7b715fe8b1bee2" class="i property">InstanceId</a>, <b>out</b> <span class="r350 r">runspaceInfo</span>);
            }
 
            <span class="c">// Create nested debugger wrapper if it is not already created and if</span>
            <span class="c">// the runspace debugger is available.</span>
            <b>if</b> ((<span class="r349 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a> != <b>null</b>) &amp;&amp;
                (<span class="r350 r">runspaceInfo</span> != <b>null</b>) &amp;&amp;
                (<span class="r350 r">runspaceInfo</span>.<a href="#514755517c5ed096" class="i property">NestedDebugger</a> == <b>null</b>))
            {
                <b>try</b>
                {
                    <a href="#06468cc0107c4c70" class="t t">NestedRunspaceDebugger</a> <span id="r351 rd" class="r351 r">nestedDebugger</span> = <span class="r350 r">runspaceInfo</span>.<a href="#6050650cfe00a281" class="i method">CreateDebugger</a>(<a href="#0d95bb604662e23b" class="k">this</a>);
 
                    <span class="r350 r">runspaceInfo</span>.<a href="#514755517c5ed096" class="i property">NestedDebugger</a> = <span class="r351 r">nestedDebugger</span>;
 
                    <span class="r351 r">nestedDebugger</span>.<a href="#4cf8436684b1ce9c" class="i">DebuggerStop</a> += <span class="i">HandleMonitorRunningRSDebuggerStop</span>;
 
                    <b>if</b> (((<a href="#285b7e0548cc6c33" class="i field">_lastActiveDebuggerAction</a> == <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#422455533b156acf" class="i field">StepInto</a>) || (<a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a> == <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#422455533b156acf" class="i field">StepInto</a>)) &amp;&amp;
                        !<span class="r351 r">nestedDebugger</span>.<a href="#b03a26662b915238" class="i property">IsActive</a>)
                    {
                        <span class="r351 r">nestedDebugger</span>.<a href="#e173cbbe3c684d5b" class="i method">SetDebuggerStepMode</a>(<b>true</b>);
                    }
 
                    <span class="c">// If the nested debugger has a pending (saved) debug stop then</span>
                    <span class="c">// release it here now that we have the debug stop handler added.</span>
                    <span class="c">// Note that the DebuggerStop event is raised on the original execution</span>
                    <span class="c">// thread in the debugger (not this thread).</span>
                    <span class="r351 r">nestedDebugger</span>.<a href="#8fe0a9f2d0cb2742" class="i method">CheckStateAndRaiseStopEvent</a>();
 
                    <b>return</b> <b>true</b>;
                }
                <b>catch</b> (<a href="../hostifaces/Connection.cs.html#340ccbbd1c6e8b87" class="t t">InvalidRunspaceStateException</a>) { }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Runspace Debug Processing
 
        <b>private void</b> <a id="d69ab8b0d0240aaf" href="../../R/d69ab8b0d0240aaf.html" target="n" data-glyph="76,1" class="i method">StartRunspaceForDebugQueueProcessing</a>()
        {
            <b>int</b> <span id="r352 rd" class="r352 r">startThread</span> = <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#beb1e5c059866670" class="i field">_processingRunspaceDebugQueue</a>, 1, 0);
 
            <b>if</b> (<span class="r352 r">startThread</span> == 0)
            {
                <b>var</b> <span id="r353 rd" class="r353 r">thread</span> = <b>new</b> <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Thread</span>(
                    <b>new</b> <span class="i">ThreadStart</span>(<span class="i">DebuggerQueueThreadProc</span>));
                <span class="r353 r">thread</span>.<span class="i">Start</span>();
            }
        }
 
        <b>private void</b> <a id="9c122a1905b22062" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">DebuggerQueueThreadProc</a>()
        {
            <a href="#0b214bf7844547d9" class="t t">StartRunspaceDebugProcessingEventArgs</a> <span id="r354 rd" class="r354 r">runspaceDebugProcessArgs</span>;
            <b>while</b> (<a href="#a3b5454a9bd66dc9" class="i field">_runspaceDebugQueue</a>.<span class="i">Value</span>.<span class="i">TryDequeue</span>(<b>out</b> <span class="r354 r">runspaceDebugProcessArgs</span>))
            {
                <b>if</b> (<a href="#294be241e582b18d" class="i method">IsStartRunspaceDebugProcessingEventSubscribed</a>())
                {
                    <b>try</b>
                    {
                        <a href="#ce6e45ecbb928a56" class="i method">RaiseStartRunspaceDebugProcessingEvent</a>(<span class="r354 r">runspaceDebugProcessArgs</span>);
                    }
                    <b>catch</b> (<span class="i">Exception</span>) { }
                }
                <b>else</b>
                {
                    <span class="c">// If there are no ProcessDebugger event subscribers then default to handling internally.</span>
                    <span class="r354 r">runspaceDebugProcessArgs</span>.<a href="#6dcf7de6c55652e9" class="i property">UseDefaultProcessing</a> = <b>true</b>;
                }
 
                <span class="c">// Check for internal handling request.</span>
                <b>if</b> (<span class="r354 r">runspaceDebugProcessArgs</span>.<a href="#6dcf7de6c55652e9" class="i property">UseDefaultProcessing</a>)
                {
                    <b>try</b>
                    {
                        <a href="#a4251ea5760adb8c" class="i method">ProcessRunspaceDebugInternally</a>(<span class="r354 r">runspaceDebugProcessArgs</span>.<a href="#f722155d3ec9219d" class="i property">Runspace</a>);
                    }
                    <b>catch</b> (<span class="i">Exception</span>) { }
                }
            }
 
            <span class="i">Interlocked</span>.<span class="i">CompareExchange</span>(<b>ref</b> <a href="#beb1e5c059866670" class="i field">_processingRunspaceDebugQueue</a>, 0, 1);
 
            <b>if</b> (!<a href="#a3b5454a9bd66dc9" class="i field">_runspaceDebugQueue</a>.<span class="i">Value</span>.<span class="i">IsEmpty</span>)
            {
                <a href="#d69ab8b0d0240aaf" class="i method">StartRunspaceForDebugQueueProcessing</a>();
            }
        }
 
        <b>private void</b> <a id="a4251ea5760adb8c" href="../../R/a4251ea5760adb8c.html" target="n" data-glyph="76,1" class="i method">ProcessRunspaceDebugInternally</a>(<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r355 rd" class="r355 r">runspace</span>)
        {
            <a href="#afb646d909846e7a" class="i method">WaitForReadyDebug</a>();
 
            <a href="#09a9217188c27b1e" class="i method">DebugRunspace</a>(<span class="r355 r">runspace</span>, <span class="r264 r">breakAll</span>: <b>true</b>);
 
            <span class="c">// Block this event thread until debugging has ended.</span>
            <a href="#385710f90095983a" class="i method">WaitForDebugComplete</a>();
 
            <span class="c">// Ensure runspace debugger is not stopped in break mode.</span>
            <b>if</b> (<span class="r355 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>.<a href="#564232f4b51d11aa" class="i property">InBreakpoint</a>)
            {
                <b>try</b>
                {
                    <span class="r355 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>.<a href="#dbd829c531cef2cb" class="i property">UnhandledBreakpointMode</a> = <a href="#b3fa2b471807788d" class="t t">UnhandledBreakpointProcessingMode</a>.<a href="#e18be175ebce8c0f" class="i field">Ignore</a>;
                }
                <b>catch</b> (<span class="i">Exception</span>) { }
            }
 
            <a href="#e7ff55e150ad3d74" class="i method">StopDebugRunspace</a>(<span class="r355 r">runspace</span>);
 
            <span class="c">// If we return to local script execution in step mode then ensure the debugger is enabled.</span>
            <a href="#822a39b6aaf94b98" class="i field">_nestedDebuggerStop</a> = <b>false</b>;
            <b>if</b> ((<a href="#57792450deac46c7" class="i field">_steppingMode</a> == <a href="#05540b7e47470485" class="t t">SteppingMode</a>.<a href="#b13a6fed8931e742" class="i field">StepIn</a>) &amp;&amp; (<a href="#ee77298ef6a53d8a" class="i field">_currentDebuggerAction</a> != <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#9c143ec10eabd6ad" class="i field">Stop</a>) &amp;&amp; (<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> == 0))
            {
                <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a>);
            }
 
            <a href="#f816d1954c078dc4" class="i method">RaiseRunspaceProcessingCompletedEvent</a>(
                <b>new</b> <a href="#4665e0285b21fc86" class="t constructor">ProcessRunspaceDebugEndEventArgs</a>(<span class="r355 r">runspace</span>));
        }
 
        <b>private void</b> <a id="afb646d909846e7a" href="../../R/afb646d909846e7a.html" target="n" data-glyph="76,1" class="i method">WaitForReadyDebug</a>()
        {
            <span class="c">// Wait up to ten seconds</span>
            <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Thread</span>.<span class="i">Sleep</span>(500);
            <b>int</b> <span id="r356 rd" class="r356 r">count</span> = 0;
            <b>bool</b> <span id="r357 rd" class="r357 r">debugReady</span> = <b>false</b>;
            <b>do</b>
            {
                <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Thread</span>.<span class="i">Sleep</span>(250);
                <span class="r357 r">debugReady</span> = <a href="#dafb88f24b88724b" class="i method">IsDebuggerReady</a>();
            } <b>while</b> (!<span class="r357 r">debugReady</span> &amp;&amp; (<span class="r356 r">count</span>++ &lt; 40));
 
            <b>if</b> (!<span class="r357 r">debugReady</span>) { <b>throw</b> <b>new</b> <a href="../../utils/MshInvalidOperationException.cs.html#901b411ac57457e6" class="t constructor">PSInvalidOperationException</a>(); }
        }
 
        <b>private bool</b> <a id="dafb88f24b88724b" href="../../R/dafb88f24b88724b.html" target="n" data-glyph="76,1" class="i method">IsDebuggerReady</a>()
        {
            <b>return</b> (!<a href="#0d95bb604662e23b" class="k">this</a>.<a href="#fbc5a00710aa76f0" class="i property">IsPushed</a> &amp;&amp; !<a href="#0d95bb604662e23b" class="k">this</a>.<a href="#bfa00bd3aebf1f44" class="i property">InBreakpoint</a> &amp;&amp; (<a href="#0d95bb604662e23b" class="k">this</a>.<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a> &gt; -1) &amp;&amp; (<a href="#0d95bb604662e23b" class="k">this</a>.<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#ad328d08127401c1" class="i property">InternalHost</a>.<a href="../hostifaces/InternalHost.cs.html#afc6f9f76c5bba72" class="i property">NestedPromptCount</a> == 0));
        }
 
        <b>private void</b> <a id="385710f90095983a" href="../../R/385710f90095983a.html" target="n" data-glyph="76,1" class="i method">WaitForDebugComplete</a>()
        {
            <b>if</b> (<a href="#fdf2f67a7f702043" class="i field">_runspaceDebugCompleteEvent</a> == <b>null</b>)
            {
                <a href="#fdf2f67a7f702043" class="i field">_runspaceDebugCompleteEvent</a> = <b>new</b> <span class="i">ManualResetEventSlim</span>(<b>false</b>);
            }
            <b>else</b>
            {
                <a href="#fdf2f67a7f702043" class="i field">_runspaceDebugCompleteEvent</a>.<span class="i">Reset</span>();
            }
 
            <a href="#fdf2f67a7f702043" class="i field">_runspaceDebugCompleteEvent</a>.<span class="i">Wait</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="b898e736ba1b9deb" href="../../R/b898e736ba1b9deb.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <span class="c">// Ensure all job event handlers are removed.</span>
            <a href="#cffdf22cdbc9b847" class="t t">PSJobStartEventArgs</a>[] <span id="r358 rd" class="r358 r">runningJobs</span>;
            <b>lock</b> (<a href="#9cd764826df997c7" class="i field">_syncObject</a>)
            {
                <span class="r358 r">runningJobs</span> = <a href="#9b70248372b3e246" class="i field">_runningJobs</a>.<span class="i">Values</span>.<span class="i">ToArray</span>();
            }
 
            <b>foreach</b> (<a href="#cffdf22cdbc9b847" class="k">var</a> <span id="r359 rd" class="r359 r">item</span> <b>in</b> <span class="r358 r">runningJobs</span>)
            {
                <a href="../remoting/client/Job.cs.html#e1ff43f6998863de" class="t t">Job</a> <span id="r360 rd" class="r360 r">job</span> = <span class="r359 r">item</span>.<a href="#e281908b7d5f2da4" class="i property">Job</a>;
                <b>if</b> (<span class="r360 r">job</span> != <b>null</b>)
                {
                    <span class="r360 r">job</span>.<a href="../remoting/client/Job.cs.html#a099819afc059aeb" class="i">StateChanged</a> -= <span class="i">HandleJobStateChanged</span>;
                    <span class="r360 r">job</span>.<a href="../remoting/client/Job.cs.html#63d86448ba938f17" class="i">OutputProcessingStateChanged</a> -= <span class="i">HandleOutputProcessingStateChanged</span>;
                }
            }
 
            <a href="#7233165c4586febe" class="i field">_processingOutputCompleteEvent</a>.<span class="i">Dispose</span>();
            <a href="#7233165c4586febe" class="i field">_processingOutputCompleteEvent</a> = <b>null</b>;
 
            <b>if</b> (<a href="#ce9910145cd5a126" class="i field">_preserveDebugStopEvent</a> != <b>null</b>)
            {
                <a href="#ce9910145cd5a126" class="i field">_preserveDebugStopEvent</a>.<span class="i">Dispose</span>();
                <a href="#ce9910145cd5a126" class="i field">_preserveDebugStopEvent</a> = <b>null</b>;
            }
 
            <b>if</b> (<a href="#fdf2f67a7f702043" class="i field">_runspaceDebugCompleteEvent</a> != <b>null</b>)
            {
                <a href="#fdf2f67a7f702043" class="i field">_runspaceDebugCompleteEvent</a>.<span class="i">Dispose</span>();
                <a href="#fdf2f67a7f702043" class="i field">_runspaceDebugCompleteEvent</a> = <b>null</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Tracing
 
        <b>internal void</b> <a id="6f6705dccff01631" href="../../R/6f6705dccff01631.html" target="n" data-glyph="74,1" class="i method">EnableTracing</a>(<b>int</b> <span id="r361 rd" class="r361 r">traceLevel</span>, <b>bool</b>? <span id="r362 rd" class="r362 r">step</span>)
        {
            <span class="c">// Enable might actually be disabling depending on the arguments.</span>
            <b>if</b> (<span class="r361 r">traceLevel</span> &lt; 1 &amp;&amp; (<span class="r362 r">step</span> == <b>null</b> || !(<b>bool</b>)<span class="r362 r">step</span>))
            {
                <a href="#2b1a7cc0d54aea41" class="i method">DisableTracing</a>();
                <b>return</b>;
            }
 
            <a href="#9e7b7ce9e70cc24f" class="i field">_savedIgnoreScriptDebug</a> = <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#49b9b435e62c31c2" class="i property">IgnoreScriptDebug</a>;
            <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#49b9b435e62c31c2" class="i property">IgnoreScriptDebug</a> = <b>false</b>;
 
            <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#0b681c156010f201" class="i property">PSDebugTraceLevel</a> = <span class="r361 r">traceLevel</span>;
            <b>if</b> (<span class="r362 r">step</span> != <b>null</b>)
            {
                <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#0ee8614c19edc283" class="i property">PSDebugTraceStep</a> = (<b>bool</b>)<span class="r362 r">step</span>;
            }
 
            <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#aa1981d1745e86b6" class="i field">Enabled</a>);
        }
 
        <b>internal void</b> <a id="2b1a7cc0d54aea41" href="../../R/2b1a7cc0d54aea41.html" target="n" data-glyph="74,1" class="i method">DisableTracing</a>()
        {
            <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#49b9b435e62c31c2" class="i property">IgnoreScriptDebug</a> = <a href="#9e7b7ce9e70cc24f" class="i field">_savedIgnoreScriptDebug</a>;
            <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#0b681c156010f201" class="i property">PSDebugTraceLevel</a> = 0;
            <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#0ee8614c19edc283" class="i property">PSDebugTraceStep</a> = <b>false</b>;
            <b>if</b> (<a href="#a9bf199504c4a68c" class="i property">CanDisableDebugger</a>)
            {
                <a href="#4ba4cb8853690f28" class="i method">SetInternalDebugMode</a>(<a href="#7ff9e8fbc3fa32a3" class="t t">InternalDebugMode</a>.<a href="#1f2f5fbf58d44eb7" class="i field">Disabled</a>);
            }
        }
 
        <b>private bool</b> <a id="9e7b7ce9e70cc24f" href="../../R/9e7b7ce9e70cc24f.html" target="n" data-glyph="46,1" class="i field">_savedIgnoreScriptDebug</a> = <b>false</b>;
 
        <b>internal void</b> <a id="3a801789eb969f3e" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">Trace</a>(<b>string</b> <span id="r363 rd" class="r363 r">messageId</span>, <b>string</b> <span id="r364 rd" class="r364 r">resourceString</span>, <b>params object</b>[] <span id="r365 rd" class="r365 r">args</span>)
        {
            <a href="../CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r366 rd" class="r366 r">pref</span> = <a href="../CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="../CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
 
            <b>string</b> <span id="r367 rd" class="r367 r">message</span>;
            <b>if</b> (<span class="r365 r">args</span> == <b>null</b> || <span class="r365 r">args</span>.<span class="i">Length</span> == 0)
            {
                <span class="c">// Don&#39;t format in case the string contains literal curly braces</span>
                <span class="r367 r">message</span> = <span class="r364 r">resourceString</span>;
            }
            <b>else</b>
            {
                <span class="r367 r">message</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#798b827f58e30321" class="i method">Format</a>(<span class="r364 r">resourceString</span>, <span class="r365 r">args</span>);
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r367 r">message</span>))
            {
                <span class="r367 r">message</span> = <span class="s">&quot;Could not load text for msh script tracing message id &#39;&quot;</span> + <span class="r363 r">messageId</span> + <span class="s">&quot;&#39;&quot;</span>;
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="r367 r">message</span>);
            }
 
            ((<a href="../../P/660d078b9d606b70.html#660d078b9d606b70" class="t t">InternalHostUserInterface</a>)<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>.<a href="../hostifaces/InternalHost.cs.html#d35ea6d8b175fa76" class="i property">UI</a>).<a href="../hostifaces/InternalHostUserInterface.cs.html#a6592058f8a67a4a" class="i method">WriteDebugLine</a>(<span class="r367 r">message</span>, <b>ref</b> <span class="r366 r">pref</span>);
        }
 
        <b>internal void</b> <a id="9894fc03b2569895" href="../../R/9894fc03b2569895.html" target="n" data-glyph="74,1" class="i method">TraceLine</a>(<a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r368 rd" class="r368 r">extent</span>)
        {
            <b>string</b> <span id="r369 rd" class="r369 r">msg</span> = <a href="../parser/Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="../parser/Position.cs.html#1971b4e1913f3b5f" class="i method">BriefMessage</a>(<span class="r368 r">extent</span>.<a href="../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>);
            <a href="../../P/660d078b9d606b70.html#660d078b9d606b70" class="t t">InternalHostUserInterface</a> <span id="r370 rd" class="r370 r">ui</span> = (<a href="../../P/660d078b9d606b70.html#660d078b9d606b70" class="t t">InternalHostUserInterface</a>)<a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>.<a href="../hostifaces/InternalHost.cs.html#d35ea6d8b175fa76" class="i property">UI</a>;
 
            <a href="../CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a> <span id="r371 rd" class="r371 r">pref</span> = <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#0ee8614c19edc283" class="i property">PSDebugTraceStep</a> ?
                <a href="../CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="../CommandBase.cs.html#acaaaa2f0a580cb4" class="i field">Inquire</a> : <a href="../CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="../CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>;
 
            <span class="r370 r">ui</span>.<a href="../hostifaces/InternalHostUserInterface.cs.html#a6592058f8a67a4a" class="i method">WriteDebugLine</a>(<span class="r369 r">msg</span>, <b>ref</b> <span class="r371 r">pref</span>);
 
            <b>if</b> (<span class="r371 r">pref</span> == <a href="../CommandBase.cs.html#18f88a0529e26331" class="t t">ActionPreference</a>.<a href="../CommandBase.cs.html#0d6a3114b77f011d" class="i field">Continue</a>)
                <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#0ee8614c19edc283" class="i property">PSDebugTraceStep</a> = <b>false</b>;
        }
 
        <b>internal void</b> <a id="ee89744ff05c3618" href="../../R/ee89744ff05c3618.html" target="n" data-glyph="74,1" class="i method">TraceScriptFunctionEntry</a>(<a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a> <span id="r372 rd" class="r372 r">functionContext</span>)
        {
            <b>var</b> <span id="r373 rd" class="r373 r">methodName</span> = <span class="r372 r">functionContext</span>.<a href="../parser/Compiler.cs.html#cf35fafd088fea9b" class="i field">_functionName</a>;
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r372 r">functionContext</span>.<a href="../parser/Compiler.cs.html#95a73081cffaa015" class="i field">_file</a>))
            {
                <span class="i">Trace</span>(<span class="s">&quot;TraceEnteringFunction&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">TraceEnteringFunction</span>, <span class="r373 r">methodName</span>);
            }
            <b>else</b>
            {
                <span class="i">Trace</span>(<span class="s">&quot;TraceEnteringFunctionDefinedInFile&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">TraceEnteringFunctionDefinedInFile</span>, <span class="r373 r">methodName</span>, <span class="r372 r">functionContext</span>.<a href="../parser/Compiler.cs.html#95a73081cffaa015" class="i field">_file</a>);
            }
        }
 
        <b>internal void</b> <a id="fe1b4731b8635154" href="../../R/fe1b4731b8635154.html" target="n" data-glyph="74,1" class="i method">TraceVariableSet</a>(<b>string</b> <span id="r374 rd" class="r374 r">varName</span>, <b>object</b> <span id="r375 rd" class="r375 r">value</span>)
        {
            <span class="c">// Don&#39;t trace into debugger hidden or debugger step through unless the trace level &gt; 2.</span>
            <b>if</b> (<a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#7a7dfc2db85e866b" class="i method">Any</a>() &amp;&amp; <a href="#3ac4e385b52c3ec7" class="i field">_context</a>.<a href="../ExecutionContext.cs.html#0b681c156010f201" class="i property">PSDebugTraceLevel</a> &lt;= 2)
            {
                <span class="c">// Skip trace messages in hidden/step through frames.</span>
                <a href="#66c884979ca0dfea" class="k">var</a> <span id="r376 rd" class="r376 r">frame</span> = <a href="#f496970aab0b0b4c" class="i field">_callStack</a>.<a href="#15bc8b05295691f1" class="i method">Last</a>();
                <b>if</b> (<span class="r376 r">frame</span>.<a href="#70b28df388667277" class="i property">IsFrameHidden</a> || <span class="r376 r">frame</span>.<a href="#d539d16001c53c61" class="i property">DebuggerStepThrough</a>)
                {
                    <b>return</b>;
                }
            }
 
            <span class="c">// If the value is an IEnumerator, we don&#39;t attempt to get its string format via &#39;ToStringParser&#39; method,</span>
            <span class="c">// because &#39;ToStringParser&#39; would iterate through the enumerator to get the individual elements, which will</span>
            <span class="c">// make irreversible changes to the enumerator.</span>
            <b>bool</b> <span id="r377 rd" class="r377 r">isValueAnIEnumerator</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r375 r">value</span>) <b>is</b> <span class="i">IEnumerator</span>;
            <b>string</b> <span id="r378 rd" class="r378 r">valAsString</span> = <span class="r377 r">isValueAnIEnumerator</span> ? <b>nameof</b>(<span class="i">IEnumerator</span>) : <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e87c4fc15a3f59f5" class="i method">ToStringParser</a>(<a href="#3ac4e385b52c3ec7" class="i field">_context</a>, <span class="r375 r">value</span>);
            <b>int</b> <span id="r379 rd" class="r379 r">msgLength</span> = 60 - <span class="r374 r">varName</span>.<span class="i">Length</span>;
 
            <b>if</b> (<span class="r378 r">valAsString</span>.<span class="i">Length</span> &gt; <span class="r379 r">msgLength</span>)
            {
                <span class="r378 r">valAsString</span> = <span class="r378 r">valAsString</span>.<span class="i">Substring</span>(0, <span class="r379 r">msgLength</span>) + <a href="../../FormatAndOutput/common/Utilities/MshObjectUtil.cs.html#fa81a7bc4f9cb4f0" class="t t">PSObjectHelper</a>.<a href="../../FormatAndOutput/common/Utilities/MshObjectUtil.cs.html#a5549bfa35c48a67" class="i field">Ellipsis</a>;
            }
 
            <span class="i">Trace</span>(<span class="s">&quot;TraceVariableAssignment&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">TraceVariableAssignment</span>, <span class="r374 r">varName</span>, <span class="r378 r">valAsString</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Tracing
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> NestedRunspaceDebugger
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Base class for nested runspace debugger wrapper.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal abstract class</b> <a id="06468cc0107c4c70" href="../../R/06468cc0107c4c70.html" target="n" data-glyph="2,0" class="t t">NestedRunspaceDebugger</a> : <a href="#9e8f0b396592e65c" class="t t">Debugger</a>, <span class="i">IDisposable</span>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Members
 
        <b>private bool</b> <a id="936bffb871fc790b" href="../../R/936bffb871fc790b.html" target="n" data-glyph="46,1" class="i field">_isDisposed</a>;
        <b>protected</b> <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="7751daf197396196" href="../../R/7751daf197396196.html" target="n" data-glyph="45,1" class="i field">_runspace</a>;
        <b>protected</b> <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <a id="b9bf6836cd89b912" href="../../R/b9bf6836cd89b912.html" target="n" data-glyph="45,1" class="i field">_wrappedDebugger</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Type of runspace being monitored for debugging.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#29c6cf229c9fc955" class="t t">PSMonitorRunspaceType</a> <a id="52702b6b921f6535" href="../../R/52702b6b921f6535.html" target="n" data-glyph="102,1" class="i property">RunspaceType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unique parent debugger identifier for monitored runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Guid</span> <a id="13081d2c54afcccb" href="../../R/13081d2c54afcccb.html" target="n" data-glyph="102,1" class="i property">ParentDebuggerId</a>
        {
            <b>get</b>;
            <b>private set</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of NestedRunspaceDebugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r380 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r381 r">runspaceType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r382 r">parentDebuggerId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Debugger Id of parent.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="577f46e50f7f5241" href="../../R/577f46e50f7f5241.html" target="n" data-glyph="75,1" class="t constructor">NestedRunspaceDebugger</a>(
            <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r380 rd" class="r380 r">runspace</span>,
            <a href="#29c6cf229c9fc955" class="t t">PSMonitorRunspaceType</a> <span id="r381 rd" class="r381 r">runspaceType</span>,
            <span class="i">Guid</span> <span id="r382 rd" class="r382 r">parentDebuggerId</span>)
        {
            <b>if</b> (<span class="r380 r">runspace</span> == <b>null</b> || <span class="r380 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r380 r">runspace</span>));
            }
 
            <a href="#7751daf197396196" class="i field">_runspace</a> = <span class="r380 r">runspace</span>;
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a> = <span class="r380 r">runspace</span>.<a href="../hostifaces/Connection.cs.html#d6610640d00b19f5" class="i property">Debugger</a>;
            <a href="#9e8f0b396592e65c" class="k">base</a>.<a href="#f6349f5fcfadd2ac" class="i method">SetDebugMode</a>(<a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#cb370f0b35bef91f" class="i property">DebugMode</a>);
            <a href="#52702b6b921f6535" class="i property">RunspaceType</a> = <span class="r381 r">runspaceType</span>;
            <a href="#13081d2c54afcccb" class="i property">ParentDebuggerId</a> = <span class="r382 r">parentDebuggerId</span>;
 
            <span class="c">// Handlers for wrapped debugger events.</span>
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#373cb831745ae38e" class="i">BreakpointUpdated</a> += <span class="i">HandleBreakpointUpdated</span>;
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#4cf8436684b1ce9c" class="i">DebuggerStop</a> += <span class="i">HandleDebuggerStop</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Adds the provided set of breakpoints to the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r383 r">breakpoints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Breakpoints.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r384 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="2e66a59ea0fe9b5c" href="../../R/2e66a59ea0fe9b5c.html" target="n" data-glyph="72,1" class="i method">SetBreakpoints</a>(<span class="i">IEnumerable</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r383 rd" class="r383 r">breakpoints</span>, <b>int</b>? <span id="r384 rd" class="r384 r">runspaceId</span>) =&gt;
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#843320f23c8b6ab7" class="i method">SetBreakpoints</a>(<span class="r383 r">breakpoints</span>, <span class="r384 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process debugger or PowerShell command/script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r385 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PowerShell command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r386 r">output</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Output collection.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerCommandResults.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <a id="e6e5e345edf71813" href="../../R/e6e5e345edf71813.html" target="n" data-glyph="72,1" class="i method">ProcessCommand</a>(<a href="../hostifaces/PSCommand.cs.html#b9f024f73904cf55" class="t t">PSCommand</a> <span id="r385 rd" class="r385 r">command</span>, <a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r386 rd" class="r386 r">output</span>)
        {
            <b>if</b> (<a href="#936bffb871fc790b" class="i field">_isDisposed</a>) { <b>return</b> <b>new</b> <a href="#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<b>null</b>, <b>false</b>); }
 
            <span class="c">// Preprocess debugger commands.</span>
            <b>string</b> <span id="r387 rd" class="r387 r">cmd</span> = <span class="r385 r">command</span>.<a href="../hostifaces/PSCommand.cs.html#cc9b22e4391a9870" class="i property">Commands</a>[0].<span class="i">CommandText</span>.<span class="i">Trim</span>();
 
            <b>if</b> (<span class="r387 r">cmd</span>.<span class="i">Equals</span>(<span class="s">&quot;prompt&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <a href="#7b542d9582502692" class="i method">HandlePromptCommand</a>(<span class="r386 r">output</span>);
            }
 
            <b>if</b> (<span class="r387 r">cmd</span>.<span class="i">Equals</span>(<span class="s">&quot;k&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                <span class="r387 r">cmd</span>.<span class="i">StartsWith</span>(<span class="s">&quot;Get-PSCallStack&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <a href="#c33f53b9dccb8586" class="i method">HandleCallStack</a>(<span class="r386 r">output</span>);
            }
 
            <b>if</b> (<span class="r387 r">cmd</span>.<span class="i">Equals</span>(<span class="s">&quot;l&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                <span class="r387 r">cmd</span>.<span class="i">Equals</span>(<span class="s">&quot;list&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<a href="#b7b3b2c853d51268" class="i method">HandleListCommand</a>(<span class="r386 r">output</span>))
                {
                    <b>return</b> <b>new</b> <a href="#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<b>null</b>, <b>true</b>);
                }
            }
 
            <b>return</b> <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#f752da7b39207812" class="i method">ProcessCommand</a>(<span class="r385 r">command</span>, <span class="r386 r">output</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get a breakpoint by id.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r388 r">id</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Id of the breakpoint you want.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r389 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="31d89f159dec4f66" href="../../R/31d89f159dec4f66.html" target="n" data-glyph="72,1" class="i method">GetBreakpoint</a>(<b>int</b> <span id="r388 rd" class="r388 r">id</span>, <b>int</b>? <span id="r389 rd" class="r389 r">runspaceId</span>) =&gt;
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#b6e003b1e66c5826" class="i method">GetBreakpoint</a>(<span class="r388 r">id</span>, <span class="r389 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns breakpoints on a runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r390 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A list of breakpoints in a runspace.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <a id="5da91d1f5eff13ab" href="../../R/5da91d1f5eff13ab.html" target="n" data-glyph="72,1" class="i method">GetBreakpoints</a>(<b>int</b>? <span id="r390 rd" class="r390 r">runspaceId</span>) =&gt;
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#bece37496a1551b3" class="i method">GetBreakpoints</a>(<span class="r390 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a command breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r391 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the command that will trigger the breakpoint. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r392 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r393 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. If null, the breakpoint may be hit anywhere the command is invoked.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r394 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The command breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="Breakpoint.cs.html#36af4b04ff98769a" class="t t">CommandBreakpoint</a> <a id="83eee9ab690e094a" href="../../R/83eee9ab690e094a.html" target="n" data-glyph="72,1" class="i method">SetCommandBreakpoint</a>(<b>string</b> <span id="r391 rd" class="r391 r">command</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r392 rd" class="r392 r">action</span>, <b>string</b> <span id="r393 rd" class="r393 r">path</span>, <b>int</b>? <span id="r394 rd" class="r394 r">runspaceId</span>) =&gt;
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#770250464b312a9d" class="i method">SetCommandBreakpoint</a>(<span class="r391 r">command</span>, <span class="r392 r">action</span>, <span class="r393 r">path</span>, <span class="r394 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a line breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r395 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r396 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The line in the script file where the breakpoint may be hit. This value must be greater than or equal to 1.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r397 r">column</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The column in the script file where the breakpoint may be hit. If 0, the breakpoint will trigger on any statement on the line.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r398 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r399 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The line breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a> <a id="edc53999a64d1d48" href="../../R/edc53999a64d1d48.html" target="n" data-glyph="72,1" class="i method">SetLineBreakpoint</a>(<b>string</b> <span id="r395 rd" class="r395 r">path</span>, <b>int</b> <span id="r396 rd" class="r396 r">line</span>, <b>int</b> <span id="r397 rd" class="r397 r">column</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r398 rd" class="r398 r">action</span>, <b>int</b>? <span id="r399 rd" class="r399 r">runspaceId</span>) =&gt;
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#76c772e72e8f9e60" class="i method">SetLineBreakpoint</a>(<span class="r395 r">path</span>, <span class="r396 r">line</span>, <span class="r397 r">column</span>, <span class="r398 r">action</span>, <span class="r399 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a variable breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r400 r">variableName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the variable that will trigger the breakpoint. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r401 r">accessMode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The variable access mode that will trigger the breakpoint.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r402 r">action</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action to take when the breakpoint is hit. If null, PowerShell will break into the debugger when the breakpoint is hit.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r403 r">path</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The path to the script file where the breakpoint may be hit. If null, the breakpoint may be hit anywhere the variable is accessed using the specified access mode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r404 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The variable breakpoint that was set.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="Breakpoint.cs.html#939ec0f40914ad61" class="t t">VariableBreakpoint</a> <a id="ac798d12159e6a1f" href="../../R/ac798d12159e6a1f.html" target="n" data-glyph="72,1" class="i method">SetVariableBreakpoint</a>(<b>string</b> <span id="r400 rd" class="r400 r">variableName</span>, <a href="Breakpoint.cs.html#296231e77d11bcb5" class="t t">VariableAccessMode</a> <span id="r401 rd" class="r401 r">accessMode</span>, <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r402 rd" class="r402 r">action</span>, <b>string</b> <span id="r403 rd" class="r403 r">path</span>, <b>int</b>? <span id="r404 rd" class="r404 r">runspaceId</span>) =&gt;
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#9563c4fb2f0b68d1" class="i method">SetVariableBreakpoint</a>(<span class="r400 r">variableName</span>, <span class="r401 r">accessMode</span>, <span class="r402 r">action</span>, <span class="r403 r">path</span>, <span class="r404 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Removes a breakpoint from the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r405 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to remove from the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r406 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if the breakpoint was removed from the debugger; false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="6a36f832ed377aff" href="../../R/6a36f832ed377aff.html" target="n" data-glyph="72,1" class="i method">RemoveBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r405 rd" class="r405 r">breakpoint</span>, <b>int</b>? <span id="r406 rd" class="r406 r">runspaceId</span>) =&gt;
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#7137c8a1ec351631" class="i method">RemoveBreakpoint</a>(<span class="r405 r">breakpoint</span>, <span class="r406 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Enables a breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r407 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to enable in the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r408 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The updated breakpoint if it was found; null if the breakpoint was not found in the debugger.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="53fb36098251fba5" href="../../R/53fb36098251fba5.html" target="n" data-glyph="72,1" class="i method">EnableBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r407 rd" class="r407 r">breakpoint</span>, <b>int</b>? <span id="r408 rd" class="r408 r">runspaceId</span>) =&gt;
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#670aef2cabe5355b" class="i method">EnableBreakpoint</a>(<span class="r407 r">breakpoint</span>, <span class="r408 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Disables a breakpoint in the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r409 r">breakpoint</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint to enable in the debugger. This value may not be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r410 r">runspaceId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The runspace id of the runspace you want to interact with. A null value will use the current runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The updated breakpoint if it was found; null if the breakpoint was not found in the debugger.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <a id="79b4609d1add9471" href="../../R/79b4609d1add9471.html" target="n" data-glyph="72,1" class="i method">DisableBreakpoint</a>(<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a> <span id="r409 rd" class="r409 r">breakpoint</span>, <b>int</b>? <span id="r410 rd" class="r410 r">runspaceId</span>) =&gt;
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#a7be3be2de328046" class="i method">DisableBreakpoint</a>(<span class="r409 r">breakpoint</span>, <span class="r410 r">runspaceId</span>);
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> SetDebuggerAction.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r411 r">resumeAction</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Debugger resume action.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="5122252e3b9a7faf" href="../../R/5122252e3b9a7faf.html" target="n" data-glyph="72,1" class="i method">SetDebuggerAction</a>(<a href="#470618169485a70e" class="t t">DebuggerResumeAction</a> <span id="r411 rd" class="r411 r">resumeAction</span>)
        {
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#63acc80e32c25892" class="i method">SetDebuggerAction</a>(<span class="r411 r">resumeAction</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stops running command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="26f32afd046df000" href="../../R/26f32afd046df000.html" target="n" data-glyph="72,1" class="i method">StopProcessCommand</a>()
        {
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#bcb115e0eda53c00" class="i method">StopProcessCommand</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns current debugger stop event arguments if debugger is in</span>
        <span class="c">///</span><span class="c"> debug stop state.  Otherwise returns null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerStopEventArgs.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override</b> <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <a id="c30596f31310db24" href="../../R/c30596f31310db24.html" target="n" data-glyph="72,1" class="i method">GetDebuggerStopArgs</a>()
        {
            <b>return</b> <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#0d780deedecb8a4a" class="i method">GetDebuggerStopArgs</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets the debugger mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r412 r">mode</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Debug mode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="26cd50d0336622bc" href="../../R/26cd50d0336622bc.html" target="n" data-glyph="72,1" class="i method">SetDebugMode</a>(<a href="#7e71da719f103cfd" class="t t">DebugModes</a> <span id="r412 rd" class="r412 r">mode</span>)
        {
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#f6349f5fcfadd2ac" class="i method">SetDebugMode</a>(<span class="r412 r">mode</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets debugger stepping mode.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r413 r">enabled</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if stepping is to be enabled.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="e173cbbe3c684d5b" href="../../R/e173cbbe3c684d5b.html" target="n" data-glyph="72,1" class="i method">SetDebuggerStepMode</a>(<b>bool</b> <span id="r413 rd" class="r413 r">enabled</span>)
        {
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#e33bfc6122759440" class="i method">SetDebuggerStepMode</a>(<span class="r413 r">enabled</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if debugger is active.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="b03a26662b915238" href="../../R/b03a26662b915238.html" target="n" data-glyph="102,1" class="i property">IsActive</a>
        {
            <b>get</b> { <b>return</b> <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#3d31ae79fb4a4117" class="i property">IsActive</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Breaks into the debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r414 r">triggerObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that triggered the breakpoint, if there is one.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal override void</b> <a id="a0e56181a9813da8" href="../../R/a0e56181a9813da8.html" target="n" data-glyph="74,1" class="i method">Break</a>(<b>object</b> <span id="r414 rd" class="r414 r">triggerObject</span> = <b>null</b>)
        {
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#98454a0ebb421f34" class="i method">Break</a>(<span class="r414 r">triggerObject</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public virtual void</b> <a id="2f3da5d16b706ffe" href="../../R/2f3da5d16b706ffe.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#936bffb871fc790b" class="i field">_isDisposed</a> = <b>true</b>;
 
            <b>if</b> (<a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a> != <b>null</b>)
            {
                <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#373cb831745ae38e" class="i">BreakpointUpdated</a> -= <span class="i">HandleBreakpointUpdated</span>;
                <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#4cf8436684b1ce9c" class="i">DebuggerStop</a> -= <span class="i">HandleDebuggerStop</span>;
            }
 
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a> = <b>null</b>;
            <a href="#7751daf197396196" class="i field">_runspace</a> = <b>null</b>;
 
            <span class="c">// Call GC.SuppressFinalize since this is an unsealed type, in case derived types</span>
            <span class="c">// have finalizers.</span>
            <span class="i">GC</span>.<span class="i">SuppressFinalize</span>(<a href="#06468cc0107c4c70" class="k">this</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Protected Methods
 
        <b>protected virtual void</b> <a id="4f5d91fb76a72d0d" href="../../R/4f5d91fb76a72d0d.html" target="n" data-glyph="75,1" class="i method">HandleDebuggerStop</a>(<b>object</b> <span id="r415 rd" class="r415 r">sender</span>, <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r416 rd" class="r416 r">e</span>)
        {
            <a href="#06468cc0107c4c70" class="k">this</a>.<a href="#19eff05653875667" class="i method">RaiseDebuggerStopEvent</a>(<span class="r416 r">e</span>);
        }
 
        <b>protected virtual void</b> <a id="daac95592abab354" href="../../R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">HandleBreakpointUpdated</a>(<b>object</b> <span id="r417 rd" class="r417 r">sender</span>, <a href="#6136821c0d0fb181" class="t t">BreakpointUpdatedEventArgs</a> <span id="r418 rd" class="r418 r">e</span>)
        {
            <a href="#06468cc0107c4c70" class="k">this</a>.<a href="#8aab7ff30ec5430c" class="i method">RaiseBreakpointUpdatedEvent</a>(<span class="r418 r">e</span>);
        }
 
        <b>protected virtual</b> <a href="#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <a id="7b542d9582502692" href="../../R/7b542d9582502692.html" target="n" data-glyph="75,1" class="i method">HandlePromptCommand</a>(<a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r419 rd" class="r419 r">output</span>)
        {
            <span class="c">// Nested debugged runspace prompt should look like:</span>
            <span class="c">// [ComputerName]: [DBG]: [Process:&lt;id&gt;]: [RunspaceName]: PS C:\&gt;</span>
            <b>string</b> <span id="r420 rd" class="r420 r">computerName</span> = <a href="#7751daf197396196" class="i field">_runspace</a>.<a href="../hostifaces/Connection.cs.html#7ff4c79fcb624bf1" class="i property">ConnectionInfo</a>?.<a href="../remoting/common/RunspaceConnectionInfo.cs.html#64143b41c05cd7ea" class="i property">ComputerName</a>;
            <b>const string</b> <span id="r421 rd" class="r421 r">processPartPattern</span> = <span class="s">&quot;{0}[{1}:{2}]:{3}&quot;</span>;
            <b>string</b> <span id="r422 rd" class="r422 r">processPart</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="r421 r">processPartPattern</span>,
                <span class="s">@&quot;&quot;&quot;&quot;</span>,
                <span class="i">DebuggerStrings</span>.<span class="i">NestedRunspaceDebuggerPromptProcessName</span>,
                <span class="s">@&quot;$($PID)&quot;</span>,
                <span class="s">@&quot;&quot;&quot;&quot;</span>);
            <b>const string</b> <span id="r423 rd" class="r423 r">locationPart</span> = <span class="s">@&quot;&quot;&quot;PS $($executionContext.SessionState.Path.CurrentLocation)&gt; &quot;&quot;&quot;</span>;
            <b>string</b> <span id="r424 rd" class="r424 r">promptScript</span> = <span class="s">&quot;&#39;[DBG]: &#39;&quot;</span> + <span class="s">&quot; + &quot;</span> + <span class="r422 r">processPart</span> + <span class="s">&quot; + &quot;</span> + <span class="s">&quot;&#39; [&quot;</span> + <a href="../lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="../lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<a href="#7751daf197396196" class="i field">_runspace</a>.<a href="../hostifaces/Connection.cs.html#c40205e63f7ff911" class="i property">Name</a>) + <span class="s">&quot;]: &#39;&quot;</span> + <span class="s">&quot; + &quot;</span> + <span class="r423 r">locationPart</span>;
 
            <span class="c">// Get the command prompt from the wrapped debugger.</span>
            <a href="../hostifaces/PSCommand.cs.html#b9f024f73904cf55" class="t t">PSCommand</a> <span id="r425 rd" class="r425 r">promptCommand</span> = <b>new</b> <a href="../hostifaces/PSCommand.cs.html#45c724f1a0c9f07a" class="t constructor">PSCommand</a>();
            <span class="r425 r">promptCommand</span>.<a href="../hostifaces/PSCommand.cs.html#432fcb03d95e8672" class="i method">AddScript</a>(<span class="r424 r">promptScript</span>);
            <a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r426 rd" class="r426 r">promptOutput</span> = <b>new</b> <a href="../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#f752da7b39207812" class="i method">ProcessCommand</a>(<span class="r425 r">promptCommand</span>, <span class="r426 r">promptOutput</span>);
            <b>string</b> <span id="r427 rd" class="r427 r">promptString</span> = (<span class="r426 r">promptOutput</span>.<a href="../hostifaces/PSDataCollection.cs.html#e7cb43bbebbb4aca" class="i property">Count</a> == 1) ? <span class="r426 r">promptOutput</span>[0].<a href="../MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>as string</b> : <b>string</b>.<span class="i">Empty</span>;
            <b>var</b> <span id="r428 rd" class="r428 r">nestedPromptString</span> = <b>new</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">StringBuilder</span>();
 
            <span class="c">// For remote runspaces display computer name in prompt.</span>
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r420 r">computerName</span>))
            {
                <span class="r428 r">nestedPromptString</span>.<span class="i">Append</span>(<span class="s">&quot;[&quot;</span> + <span class="r420 r">computerName</span> + <span class="s">&quot;]:&quot;</span>);
            }
 
            <span class="r428 r">nestedPromptString</span>.<span class="i">Append</span>(<span class="r427 r">promptString</span>);
 
            <span class="c">// Fix up for non-remote runspaces since the runspace is not in a nested prompt</span>
            <span class="c">// but the root runspace is.</span>
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r420 r">computerName</span>))
            {
                <span class="r428 r">nestedPromptString</span>.<span class="i">Insert</span>(<span class="r428 r">nestedPromptString</span>.<span class="i">Length</span> - 1, <span class="s">&quot;&gt;&quot;</span>);
            }
 
            <span class="r419 r">output</span>.<span class="i">Add</span>(<span class="r428 r">nestedPromptString</span>.<span class="i">ToString</span>());
 
            <b>return</b> <b>new</b> <a href="#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<b>null</b>, <b>true</b>);
        }
 
        <b>protected virtual</b> <a href="#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <a id="c33f53b9dccb8586" href="../../R/c33f53b9dccb8586.html" target="n" data-glyph="75,1" class="i method">HandleCallStack</a>(<a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r429 rd" class="r429 r">output</span>)
        {
            <b>throw</b> <b>new</b> <a href="../../utils/MshNotImplementedException.cs.html#7c86d87f06a2f375" class="t constructor">PSNotImplementedException</a>();
        }
 
        <b>protected virtual bool</b> <a id="b7b3b2c853d51268" href="../../R/b7b3b2c853d51268.html" target="n" data-glyph="75,1" class="i method">HandleListCommand</a>(<a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r430 rd" class="r430 r">output</span>)
        {
            <b>return</b> <b>false</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Attempts to fix up the debugger stop invocation information so that</span>
        <span class="c">///</span><span class="c"> the correct stack and source can be displayed in the debugger, for</span>
        <span class="c">///</span><span class="c"> cases where the debugged runspace is called inside a parent sccript,</span>
        <span class="c">///</span><span class="c"> such as with script Invoke-Command cases.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r431 r">debugStopInvocationInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">InvocationInfo.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal virtual</b> <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="c56bb01cb3c3985e" href="../../R/c56bb01cb3c3985e.html" target="n" data-glyph="74,1" class="i method">FixupInvocationInfo</a>(<a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r431 rd" class="r431 r">debugStopInvocationInfo</span>)
        {
            <span class="c">// Default is no fix up.</span>
            <b>return</b> <span class="r431 r">debugStopInvocationInfo</span>;
        }
 
        <b>internal bool</b> <a id="0ba05996d915f724" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsSameDebugger</a>(<a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r432 rd" class="r432 r">testDebugger</span>)
        {
            <b>return</b> <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<span class="i">Equals</span>(<span class="r432 r">testDebugger</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks to see if the runspace debugger is in a preserved debug</span>
        <span class="c">///</span><span class="c"> stop state, and if so then allows the debugger stop event to</span>
        <span class="c">///</span><span class="c"> continue processing and raise the event.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="8fe0a9f2d0cb2742" href="../../R/8fe0a9f2d0cb2742.html" target="n" data-glyph="74,1" class="i method">CheckStateAndRaiseStopEvent</a>()
        {
            <a href="../remoting/client/remoterunspace.cs.html#89199d5c3f22d94e" class="t t">RemoteDebugger</a> <span id="r433 rd" class="r433 r">remoteDebugger</span> = <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a> <b>as</b> <a href="../remoting/client/remoterunspace.cs.html#89199d5c3f22d94e" class="t t">RemoteDebugger</a>;
            <b>if</b> (<span class="r433 r">remoteDebugger</span> != <b>null</b>)
            {
                <span class="c">// Have remote debugger raise existing debugger stop event.</span>
                <span class="r433 r">remoteDebugger</span>.<a href="../remoting/client/remoterunspace.cs.html#7707b91fc96fac5a" class="i method">CheckStateAndRaiseStopEvent</a>();
            }
            <b>else</b> <b>if</b> (<a href="#06468cc0107c4c70" class="k">this</a>.<a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#65fde7239c87ddf3" class="i property">IsPendingDebugStopEvent</a>)
            {
                <span class="c">// Release local debugger preserved debugger stop event.</span>
                <a href="#06468cc0107c4c70" class="k">this</a>.<a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#a15389d72926a6cd" class="i method">ReleaseSavedDebugStop</a>();
            }
            <b>else</b>
            {
                <span class="c">// If this is a remote server debugger then we want to convert the pending remote</span>
                <span class="c">// debugger stop to a local debugger stop event for this Debug-Runspace to handle.</span>
                <a href="../remoting/server/ServerRunspacePoolDriver.cs.html#659f74f76b5af7db" class="t t">ServerRemoteDebugger</a> <span id="r434 rd" class="r434 r">serverRemoteDebugger</span> = <a href="#06468cc0107c4c70" class="k">this</a>.<a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a> <b>as</b> <a href="../remoting/server/ServerRunspacePoolDriver.cs.html#659f74f76b5af7db" class="t t">ServerRemoteDebugger</a>;
                <b>if</b> (<span class="r434 r">serverRemoteDebugger</span> != <b>null</b>)
                {
                    <span class="r434 r">serverRemoteDebugger</span>.<a href="../remoting/server/ServerRunspacePoolDriver.cs.html#30804be080ac34ba" class="i method">ReleaseAndRaiseDebugStopLocal</a>();
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the callstack of the nested runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="9a6675d16f7a2ab1" href="../../R/9a6675d16f7a2ab1.html" target="n" data-glyph="74,1" class="i method">GetRSCallStack</a>()
        {
            <span class="c">// Get call stack from wrapped debugger</span>
            <a href="../hostifaces/PSCommand.cs.html#b9f024f73904cf55" class="t t">PSCommand</a> <span id="r435 rd" class="r435 r">cmd</span> = <b>new</b> <a href="../hostifaces/PSCommand.cs.html#45c724f1a0c9f07a" class="t constructor">PSCommand</a>();
            <span class="r435 r">cmd</span>.<a href="../hostifaces/PSCommand.cs.html#2a2b7de6778550bd" class="i method">AddCommand</a>(<span class="s">&quot;Get-PSCallStack&quot;</span>);
            <a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r436 rd" class="r436 r">callStackOutput</span> = <b>new</b> <a href="../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#f752da7b39207812" class="i method">ProcessCommand</a>(<span class="r435 r">cmd</span>, <span class="r436 r">callStackOutput</span>);
 
            <b>return</b> <span class="r436 r">callStackOutput</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Wrapper class for runspace debugger where it is running in no known</span>
    <span class="c">///</span><span class="c"> embedding scenario and is assumed to be running independently of</span>
    <span class="c">///</span><span class="c"> any other running script.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="ee58f13d1e998683" href="../../R/ee58f13d1e998683.html" target="n" data-glyph="2,0" class="t t">StandaloneRunspaceDebugger</a> : <a href="#06468cc0107c4c70" class="t t">NestedRunspaceDebugger</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r437 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="197cff01e6b17981" href="../../R/197cff01e6b17981.html" target="n" data-glyph="72,1" class="t constructor">StandaloneRunspaceDebugger</a>(
            <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r437 rd" class="r437 r">runspace</span>)
            : <b>base</b>(<span class="r437 r">runspace</span>, <a href="#29c6cf229c9fc955" class="t t">PSMonitorRunspaceType</a>.<a href="#e83f86b047269d84" class="i field">Standalone</a>, <span class="i">Guid</span>.<span class="i">Empty</span>)
        { }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <b>protected override</b> <a href="#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <a id="e7a9913a663b48b7" href="../../R/e7a9913a663b48b7.html" target="n" data-glyph="75,1" class="i method">HandleCallStack</a>(<a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r438 rd" class="r438 r">output</span>)
        {
            <a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r439 rd" class="r439 r">callStackOutput</span> = <a href="#9a6675d16f7a2ab1" class="i method">GetRSCallStack</a>();
 
            <span class="c">// Display call stack info as formatted.</span>
            <b>using</b> (<a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r440 rd" class="r440 r">ps</span> = <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>())
            {
                <span class="r440 r">ps</span>.<a href="../hostifaces/PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<span class="s">&quot;Out-String&quot;</span>).<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Stream&quot;</span>, <b>true</b>);
                <span class="r440 r">ps</span>.<span class="i">Invoke</span>(<span class="r439 r">callStackOutput</span>, <span class="r438 r">output</span>);
            }
 
            <b>return</b> <b>new</b> <a href="#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<b>null</b>, <b>true</b>);
        }
 
        <b>protected override void</b> <a id="0fee2709bbb6253d" href="../../R/0fee2709bbb6253d.html" target="n" data-glyph="75,1" class="i method">HandleDebuggerStop</a>(<b>object</b> <span id="r441 rd" class="r441 r">sender</span>, <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r442 rd" class="r442 r">e</span>)
        {
            <b>object</b> <span id="r443 rd" class="r443 r">runningCmd</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="r443 r">runningCmd</span> = <a href="#74ba71c227415051" class="i method">DrainAndBlockRemoteOutput</a>();
                <a href="#ee58f13d1e998683" class="k">this</a>.<a href="#19eff05653875667" class="i method">RaiseDebuggerStopEvent</a>(<span class="r442 r">e</span>);
            }
            <b>finally</b>
            {
                <a href="#8db10d09ca049a2d" class="i method">RestoreRemoteOutput</a>(<span class="r443 r">runningCmd</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <b>private object</b> <a id="74ba71c227415051" href="../../R/74ba71c227415051.html" target="n" data-glyph="76,1" class="i method">DrainAndBlockRemoteOutput</a>()
        {
            <span class="c">// We do this only for remote runspaces.</span>
            <b>if</b> (!(<a href="#7751daf197396196" class="i field">_runspace</a> <b>is</b> <a href="../remoting/client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a> <span id="r444 rd" class="r444 r">remoteRunspace</span>)) { <b>return</b> <b>null</b>; }
 
            <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="k">var</a> <span id="r445 rd" class="r445 r">runningPowerShell</span> = <span class="r444 r">remoteRunspace</span>.<a href="../hostifaces/Connection.cs.html#edb618fe46065750" class="i method">GetCurrentBasePowerShell</a>();
            <b>if</b> (<span class="r445 r">runningPowerShell</span> != <b>null</b>)
            {
                <span class="r445 r">runningPowerShell</span>.<a href="../hostifaces/PowerShell.cs.html#59ba1b667dcd86e0" class="i method">WaitForServicingComplete</a>();
                <span class="r445 r">runningPowerShell</span>.<a href="../hostifaces/PowerShell.cs.html#17cbd8cde3486cb7" class="i method">SuspendIncomingData</a>();
                <b>return</b> <span class="r445 r">runningPowerShell</span>;
            }
            <b>else</b>
            {
                <a href="../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="k">var</a> <span id="r446 rd" class="r446 r">runningPipe</span> = <span class="r444 r">remoteRunspace</span>.<a href="../remoting/client/remoterunspace.cs.html#9ab3dedcf11ea947" class="i method">GetCurrentlyRunningPipeline</a>();
                <b>if</b> (<span class="r446 r">runningPipe</span> != <b>null</b>)
                {
                    <span class="r446 r">runningPipe</span>.<a href="../hostifaces/Pipeline.cs.html#f60de8c84957b18a" class="i method">DrainIncomingData</a>();
                    <span class="r446 r">runningPipe</span>.<a href="../hostifaces/Pipeline.cs.html#edfe3fa78612efce" class="i method">SuspendIncomingData</a>();
                    <b>return</b> <span class="r446 r">runningPipe</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static void</b> <a id="8db10d09ca049a2d" href="../../R/8db10d09ca049a2d.html" target="n" data-glyph="76,1" class="i method">RestoreRemoteOutput</a>(<b>object</b> <span id="r447 rd" class="r447 r">runningCmd</span>)
        {
            <b>if</b> (<span class="r447 r">runningCmd</span> == <b>null</b>) { <b>return</b>; }
 
            <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="k">var</a> <span id="r448 rd" class="r448 r">runningPowerShell</span> = <span class="r447 r">runningCmd</span> <b>as</b> <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>;
            <b>if</b> (<span class="r448 r">runningPowerShell</span> != <b>null</b>)
            {
                <span class="r448 r">runningPowerShell</span>.<a href="../hostifaces/PowerShell.cs.html#d3f59b7e5131db2a" class="i method">ResumeIncomingData</a>();
            }
            <b>else</b>
            {
                <a href="../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="k">var</a> <span id="r449 rd" class="r449 r">runningPipe</span> = <span class="r447 r">runningCmd</span> <b>as</b> <a href="../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a>;
                <span class="r449 r">runningPipe</span>?.<a href="../hostifaces/Pipeline.cs.html#eba54449dfca431c" class="i method">ResumeIncomingData</a>();
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Wrapper class for runspace debugger where the runspace is being used in an</span>
    <span class="c">///</span><span class="c"> embedded scenario such as Invoke-Command command inside script.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="7d5ee370fd67b4aa" href="../../R/7d5ee370fd67b4aa.html" target="n" data-glyph="2,0" class="t t">EmbeddedRunspaceDebugger</a> : <a href="#06468cc0107c4c70" class="t t">NestedRunspaceDebugger</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Members
 
        <b>private</b> <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="b5a88ccba3ed1699" href="../../R/b5a88ccba3ed1699.html" target="n" data-glyph="46,1" class="i field">_command</a>;
        <b>private</b> <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <a id="c46b1c34fafc5d95" href="../../R/c46b1c34fafc5d95.html" target="n" data-glyph="46,1" class="i field">_rootDebugger</a>;
        <b>private</b> <a href="../parser/ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="8ec99d167a1ff3f7" href="../../R/8ec99d167a1ff3f7.html" target="n" data-glyph="46,1" class="i field">_parentScriptBlockAst</a>;
        <b>private</b> <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <a id="784bafa3324e7651" href="../../R/784bafa3324e7651.html" target="n" data-glyph="46,1" class="i field">_sendDebuggerArgs</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor for runspaces executing from script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r450 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace to debug.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r451 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PowerShell command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r452 r">rootDebugger</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Root debugger.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r453 r">runspaceType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace to monitor type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r454 r">parentDebuggerId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Parent debugger Id.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="21d2e23eed3ee36b" href="../../R/21d2e23eed3ee36b.html" target="n" data-glyph="72,1" class="t constructor">EmbeddedRunspaceDebugger</a>(
            <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r450 rd" class="r450 r">runspace</span>,
            <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r451 rd" class="r451 r">command</span>,
            <a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r452 rd" class="r452 r">rootDebugger</span>,
            <a href="#29c6cf229c9fc955" class="t t">PSMonitorRunspaceType</a> <span id="r453 rd" class="r453 r">runspaceType</span>,
            <span class="i">Guid</span> <span id="r454 rd" class="r454 r">parentDebuggerId</span>)
            : <a href="#577f46e50f7f5241" class="k">base</a>(<span class="r450 r">runspace</span>, <span class="r453 r">runspaceType</span>, <span class="r454 r">parentDebuggerId</span>)
        {
            <b>if</b> (<span class="r452 r">rootDebugger</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r452 r">rootDebugger</span>));
            }
 
            <a href="#b5a88ccba3ed1699" class="i field">_command</a> = <span class="r451 r">command</span>;
            <a href="#c46b1c34fafc5d95" class="i field">_rootDebugger</a> = <span class="r452 r">rootDebugger</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <b>protected override void</b> <a id="a2a4c5e36e367a87" href="../../R/a2a4c5e36e367a87.html" target="n" data-glyph="75,1" class="i method">HandleDebuggerStop</a>(<b>object</b> <span id="r455 rd" class="r455 r">sender</span>, <a href="#13c865e6481e16a2" class="t t">DebuggerStopEventArgs</a> <span id="r456 rd" class="r456 r">e</span>)
        {
            <a href="#784bafa3324e7651" class="i field">_sendDebuggerArgs</a> = <b>new</b> <a href="#7ac766b9a835f3a6" class="t constructor">DebuggerStopEventArgs</a>(
                <span class="r456 r">e</span>.<a href="#bf5b2fd8de78c287" class="i property">InvocationInfo</a>,
                <b>new</b> <span class="i">Collection</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt;(<span class="r456 r">e</span>.<a href="#745a4c67d985896b" class="i property">Breakpoints</a>),
                <span class="r456 r">e</span>.<a href="#b6941352f3c2c41c" class="i property">ResumeAction</a>);
 
            <b>object</b> <span id="r457 rd" class="r457 r">remoteRunningCmd</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="c">// For remote debugging drain/block output channel.</span>
                <span class="r457 r">remoteRunningCmd</span> = <a href="#bda83e6530ae3093" class="i method">DrainAndBlockRemoteOutput</a>();
 
                <a href="#7d5ee370fd67b4aa" class="k">this</a>.<a href="#19eff05653875667" class="i method">RaiseDebuggerStopEvent</a>(<a href="#784bafa3324e7651" class="i field">_sendDebuggerArgs</a>);
            }
            <b>finally</b>
            {
                <a href="#e0c9a65c30868cf4" class="i method">RestoreRemoteOutput</a>(<span class="r457 r">remoteRunningCmd</span>);
 
                <span class="c">// Return user determined resume action.</span>
                <span class="r456 r">e</span>.<a href="#b6941352f3c2c41c" class="i property">ResumeAction</a> = <a href="#784bafa3324e7651" class="i field">_sendDebuggerArgs</a>.<a href="#b6941352f3c2c41c" class="i property">ResumeAction</a>;
            }
        }
 
        <b>protected override</b> <a href="#279d714bfd5743f3" class="t t">DebuggerCommandResults</a> <a id="75c6268adcdfdcdc" href="../../R/75c6268adcdfdcdc.html" target="n" data-glyph="75,1" class="i method">HandleCallStack</a>(<a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r458 rd" class="r458 r">output</span>)
        {
            <span class="c">// First get call stack from wrapped debugger</span>
            <a href="../hostifaces/PSCommand.cs.html#b9f024f73904cf55" class="t t">PSCommand</a> <span id="r459 rd" class="r459 r">cmd</span> = <b>new</b> <a href="../hostifaces/PSCommand.cs.html#45c724f1a0c9f07a" class="t constructor">PSCommand</a>();
            <span class="r459 r">cmd</span>.<a href="../hostifaces/PSCommand.cs.html#2a2b7de6778550bd" class="i method">AddCommand</a>(<span class="s">&quot;Get-PSCallStack&quot;</span>);
            <a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r460 rd" class="r460 r">callStackOutput</span> = <b>new</b> <a href="../hostifaces/PSDataCollection.cs.html#ee85ce3306fe4e5b" class="t constructor">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;();
            <a href="#b9bf6836cd89b912" class="i field">_wrappedDebugger</a>.<a href="#f752da7b39207812" class="i method">ProcessCommand</a>(<span class="r459 r">cmd</span>, <span class="r460 r">callStackOutput</span>);
 
            <span class="c">// Next get call stack from parent debugger.</span>
            <a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="#70d153384f134926" class="t t">CallStackFrame</a>&gt; <span id="r461 rd" class="r461 r">callStack</span> = <a href="#c46b1c34fafc5d95" class="i field">_rootDebugger</a>.<a href="#03b6be6c2122937e" class="i method">GetCallStack</a>().<span class="i">ToArray</span>();
 
            <span class="c">// Combine call stack info.</span>
            <b>foreach</b> (<b>var</b> <span id="r462 rd" class="r462 r">item</span> <b>in</b> <span class="r461 r">callStack</span>)
            {
                <span class="r460 r">callStackOutput</span>.<a href="../hostifaces/PSDataCollection.cs.html#681501d1e27b76df" class="i method">Add</a>(<b>new</b> <span class="t">PSObject</span>(<span class="r462 r">item</span>));
            }
 
            <span class="c">// Display call stack info as formatted.</span>
            <b>using</b> (<a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r463 rd" class="r463 r">ps</span> = <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>())
            {
                <span class="r463 r">ps</span>.<a href="../hostifaces/PowerShell.cs.html#9cc79c297f6cced9" class="i method">AddCommand</a>(<span class="s">&quot;Out-String&quot;</span>).<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Stream&quot;</span>, <b>true</b>);
                <span class="r463 r">ps</span>.<span class="i">Invoke</span>(<span class="r460 r">callStackOutput</span>, <span class="r458 r">output</span>);
            }
 
            <b>return</b> <b>new</b> <a href="#e583fb3239774485" class="t constructor">DebuggerCommandResults</a>(<b>null</b>, <b>true</b>);
        }
 
        <b>protected override bool</b> <a id="9f5c174e5ea4a7ce" href="../../R/9f5c174e5ea4a7ce.html" target="n" data-glyph="75,1" class="i method">HandleListCommand</a>(<a href="../hostifaces/PSDataCollection.cs.html#52e2b209c10ec0a4" class="t t">PSDataCollection</a>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r464 rd" class="r464 r">output</span>)
        {
            <b>if</b> ((<a href="#784bafa3324e7651" class="i field">_sendDebuggerArgs</a> != <b>null</b>) &amp;&amp; (<a href="#784bafa3324e7651" class="i field">_sendDebuggerArgs</a>.<a href="#bf5b2fd8de78c287" class="i property">InvocationInfo</a> != <b>null</b>))
            {
                <b>return</b> <a href="#c46b1c34fafc5d95" class="i field">_rootDebugger</a>.<span class="i">InternalProcessListCommand</span>(<a href="#784bafa3324e7651" class="i field">_sendDebuggerArgs</a>.<a href="#bf5b2fd8de78c287" class="i property">InvocationInfo</a>.<a href="../InvocationInfo.cs.html#6d9f0c2743c6397f" class="i property">ScriptLineNumber</a>, <span class="r464 r">output</span>);
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Attempts to fix up the debugger stop invocation information so that</span>
        <span class="c">///</span><span class="c"> the correct stack and source can be displayed in the debugger, for</span>
        <span class="c">///</span><span class="c"> cases where the debugged runspace is called inside a parent sccript,</span>
        <span class="c">///</span><span class="c"> such as with script Invoke-Command cases.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r465 r">debugStopInvocationInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Invocation information from debugger stop.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">InvocationInfo.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="178158044898fd3e" href="../../R/178158044898fd3e.html" target="n" data-glyph="74,1" class="i method">FixupInvocationInfo</a>(<a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r465 rd" class="r465 r">debugStopInvocationInfo</span>)
        {
            <b>if</b> (<span class="r465 r">debugStopInvocationInfo</span> == <b>null</b>) { <b>return</b> <b>null</b>; }
 
            <span class="c">// Check to see if this nested debug stop is called from within</span>
            <span class="c">// a known parent source.</span>
            <b>int</b> <span id="r466 rd" class="r466 r">dbStopLineNumber</span> = <span class="r465 r">debugStopInvocationInfo</span>.<a href="../InvocationInfo.cs.html#6d9f0c2743c6397f" class="i property">ScriptLineNumber</a>;
            <a href="#70d153384f134926" class="t t">CallStackFrame</a> <span id="r467 rd" class="r467 r">topItem</span> = <b>null</b>;
            <b>var</b> <span id="r468 rd" class="r468 r">parentActiveStack</span> = <a href="#c46b1c34fafc5d95" class="i field">_rootDebugger</a>.<a href="#fa8592c3abd9de74" class="i method">GetActiveDebuggerCallStack</a>();
            <b>if</b> ((<span class="r468 r">parentActiveStack</span> != <b>null</b>) &amp;&amp; (<span class="r468 r">parentActiveStack</span>.<span class="i">Length</span> &gt; 0))
            {
                <span class="r467 r">topItem</span> = <span class="r468 r">parentActiveStack</span>[0];
            }
            <b>else</b>
            {
                <b>var</b> <span id="r469 rd" class="r469 r">parentStack</span> = <a href="#c46b1c34fafc5d95" class="i field">_rootDebugger</a>.<a href="#03b6be6c2122937e" class="i method">GetCallStack</a>().<span class="i">ToArray</span>();
                <b>if</b> ((<span class="r469 r">parentStack</span> != <b>null</b>) &amp;&amp; (<span class="r469 r">parentStack</span>.<span class="i">Length</span> &gt; 0))
                {
                    <span class="r467 r">topItem</span> = <span class="r469 r">parentStack</span>[0];
                    <span class="r466 r">dbStopLineNumber</span>--;
                }
            }
 
            <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r470 rd" class="r470 r">debugInvocationInfo</span> = <a href="#2da82e9b4855a075" class="i method">CreateInvocationInfoFromParent</a>(
                <span class="r467 r">topItem</span>,
                <span class="r466 r">dbStopLineNumber</span>,
                <span class="r465 r">debugStopInvocationInfo</span>.<a href="../InvocationInfo.cs.html#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="../parser/Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>,
                <span class="r465 r">debugStopInvocationInfo</span>.<a href="../InvocationInfo.cs.html#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>.<a href="../parser/Position.cs.html#155675f601d14734" class="i property">EndColumnNumber</a>);
 
            <b>return</b> <span class="r470 r">debugInvocationInfo</span> ?? <span class="r465 r">debugStopInvocationInfo</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> IDisposable
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dispose.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="52f10ab193351a2b" href="../../R/52f10ab193351a2b.html" target="n" data-glyph="72,1" class="i method">Dispose</a>()
        {
            <a href="#06468cc0107c4c70" class="k">base</a>.<a href="#2f3da5d16b706ffe" class="i method">Dispose</a>();
 
            <a href="#c46b1c34fafc5d95" class="i field">_rootDebugger</a> = <b>null</b>;
            <a href="#8ec99d167a1ff3f7" class="i field">_parentScriptBlockAst</a> = <b>null</b>;
            <a href="#b5a88ccba3ed1699" class="i field">_command</a> = <b>null</b>;
            <a href="#784bafa3324e7651" class="i field">_sendDebuggerArgs</a> = <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Private Methods
 
        <b>private</b> <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="2da82e9b4855a075" href="../../R/2da82e9b4855a075.html" target="n" data-glyph="76,1" class="i method">CreateInvocationInfoFromParent</a>(
            <a href="#70d153384f134926" class="t t">CallStackFrame</a> <span id="r471 rd" class="r471 r">parentStackFrame</span>,
            <b>int</b> <span id="r472 rd" class="r472 r">debugLineNumber</span>,
            <b>int</b> <span id="r473 rd" class="r473 r">debugStartColNumber</span>,
            <b>int</b> <span id="r474 rd" class="r474 r">debugEndColNumber</span>)
        {
            <b>if</b> (<span class="r471 r">parentStackFrame</span> == <b>null</b>) { <b>return</b> <b>null</b>; }
 
            <span class="c">// Attempt to find parent script file create script block with Ast to</span>
            <span class="c">// find correct line and offset adjustments.</span>
            <b>if</b> ((<a href="#8ec99d167a1ff3f7" class="i field">_parentScriptBlockAst</a> == <b>null</b>) &amp;&amp;
                !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r471 r">parentStackFrame</span>.<a href="#2d5a7eeacb864cf2" class="i property">ScriptName</a>) &amp;&amp;
                <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">File</span>.<span class="i">Exists</span>(<span class="r471 r">parentStackFrame</span>.<a href="#2d5a7eeacb864cf2" class="i property">ScriptName</a>))
            {
                <a href="../parser/Parser.cs.html#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r475 rd" class="r475 r">errors</span>;
                <a href="../parser/token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[] <span id="r476 rd" class="r476 r">tokens</span>;
                <a href="#8ec99d167a1ff3f7" class="i field">_parentScriptBlockAst</a> = <a href="../parser/Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<span class="i">ParseInput</span>(
                    <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">File</span>.<span class="i">ReadAllText</span>(<span class="r471 r">parentStackFrame</span>.<a href="#2d5a7eeacb864cf2" class="i property">ScriptName</a>),
                    <b>out</b> <span class="r476 r">tokens</span>, <b>out</b> <span class="r475 r">errors</span>);
            }
 
            <b>if</b> (<a href="#8ec99d167a1ff3f7" class="i field">_parentScriptBlockAst</a> != <b>null</b>)
            {
                <b>int</b> <span id="r477 rd" class="r477 r">callingLineNumber</span> = <span class="r471 r">parentStackFrame</span>.<a href="#e62e3970e47139f1" class="i property">ScriptLineNumber</a>;
 
                <a href="../parser/ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r478 rd" class="r478 r">debugStatement</span> = <b>null</b>;
                <a href="../parser/ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r479 rd" class="r479 r">callingStatement</span> = <a href="#8ec99d167a1ff3f7" class="i field">_parentScriptBlockAst</a>.<span class="i">Find</span>(
                    <span id="r480 rd" class="r480 r">ast</span> =&gt; <span class="r480 r">ast</span> <b>is</b> <a href="../parser/ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> &amp;&amp; (<span class="r480 r">ast</span>.<span class="i">Extent</span>.<span class="i">StartLineNumber</span> == <span class="r477 r">callingLineNumber</span>), <b>true</b>) <b>as</b> <a href="../parser/ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>;
 
                <b>if</b> (<span class="r479 r">callingStatement</span> != <b>null</b>)
                {
                    <span class="c">// Find first statement in calling statement.</span>
                    <a href="../parser/ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r481 rd" class="r481 r">firstStatement</span> = <span class="r479 r">callingStatement</span>.<span class="i">Find</span>(
                        <span id="r482 rd" class="r482 r">ast</span> =&gt; <span class="r482 r">ast</span> <b>is</b> <a href="../parser/ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> &amp;&amp; <span class="r482 r">ast</span>.<span class="i">Extent</span>.<span class="i">StartLineNumber</span> &gt; <span class="r477 r">callingLineNumber</span>, <b>true</b>) <b>as</b> <a href="../parser/ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>;
                    <b>if</b> (<span class="r481 r">firstStatement</span> != <b>null</b>)
                    {
                        <b>int</b> <span id="r483 rd" class="r483 r">adjustedLineNumber</span> = <span class="r481 r">firstStatement</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a> + <span class="r472 r">debugLineNumber</span> - 1;
                        <span class="r478 r">debugStatement</span> = <span class="r479 r">callingStatement</span>.<span class="i">Find</span>(
                            <span id="r484 rd" class="r484 r">ast</span> =&gt; <span class="r484 r">ast</span> <b>is</b> <a href="../parser/ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> &amp;&amp; <span class="r484 r">ast</span>.<span class="i">Extent</span>.<span class="i">StartLineNumber</span> == <span class="r483 r">adjustedLineNumber</span>, <b>true</b>) <b>as</b> <a href="../parser/ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>;
                    }
                }
 
                <b>if</b> (<span class="r478 r">debugStatement</span> != <b>null</b>)
                {
                    <b>int</b> <span id="r485 rd" class="r485 r">endColNum</span> = <span class="r473 r">debugStartColNumber</span> + (<span class="r474 r">debugEndColNumber</span> - <span class="r473 r">debugStartColNumber</span>) - 2;
                    <b>string</b> <span id="r486 rd" class="r486 r">statementExtentText</span> = <span class="i">FixUpStatementExtent</span>(<span class="r478 r">debugStatement</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a> - 1, <span class="r478 r">debugStatement</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>);
 
                    <a href="../parser/Position.cs.html#391058fa374c4cba" class="t t">ScriptPosition</a> <span id="r487 rd" class="r487 r">scriptStartPosition</span> = <b>new</b> <a href="../parser/Position.cs.html#40eb7f8097372724" class="t constructor">ScriptPosition</a>(
                        <span class="r471 r">parentStackFrame</span>.<a href="#2d5a7eeacb864cf2" class="i property">ScriptName</a>,
                        <span class="r478 r">debugStatement</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a>,
                        <span class="r473 r">debugStartColNumber</span>,
                        <span class="r486 r">statementExtentText</span>);
 
                    <a href="../parser/Position.cs.html#391058fa374c4cba" class="t t">ScriptPosition</a> <span id="r488 rd" class="r488 r">scriptEndPosition</span> = <b>new</b> <a href="../parser/Position.cs.html#40eb7f8097372724" class="t constructor">ScriptPosition</a>(
                        <span class="r471 r">parentStackFrame</span>.<a href="#2d5a7eeacb864cf2" class="i property">ScriptName</a>,
                        <span class="r478 r">debugStatement</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#ccd649a5269e237d" class="i property">EndLineNumber</a>,
                        <span class="r485 r">endColNum</span>,
                        <span class="r486 r">statementExtentText</span>);
 
                    <b>return</b> <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a>.<a href="../InvocationInfo.cs.html#cdfa6414e01bad12" class="i method">Create</a>(
                        <span class="r471 r">parentStackFrame</span>.<a href="#db51167e7b726802" class="i property">InvocationInfo</a>.<a href="../InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>,
                        <b>new</b> <a href="../parser/Position.cs.html#da6958ef7491b809" class="t constructor">ScriptExtent</a>(
                            <span class="r487 r">scriptStartPosition</span>,
                            <span class="r488 r">scriptEndPosition</span>)
                        );
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static string</b> <a id="9db610915d718b6b" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">FixUpStatementExtent</a>(<b>int</b> <span id="r489 rd" class="r489 r">startColNum</span>, <b>string</b> <span id="r490 rd" class="r490 r">stateExtentText</span>)
        {
            <span class="i">Text</span>.<span class="i">StringBuilder</span> <span id="r491 rd" class="r491 r">sb</span> = <b>new</b> <span class="i">Text</span>.<span class="i">StringBuilder</span>();
            <span class="r491 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>, <span class="r489 r">startColNum</span>);
            <span class="r491 r">sb</span>.<span class="i">Append</span>(<span class="r490 r">stateExtentText</span>);
 
            <b>return</b> <span class="r491 r">sb</span>.<span class="i">ToString</span>();
        }
 
        <b>private object</b> <a id="bda83e6530ae3093" href="../../R/bda83e6530ae3093.html" target="n" data-glyph="76,1" class="i method">DrainAndBlockRemoteOutput</a>()
        {
            <span class="c">// We only do this for remote runspaces.</span>
            <b>if</b> (<a href="#7751daf197396196" class="i field">_runspace</a> <b>is not</b> <a href="../remoting/client/remoterunspace.cs.html#e2c1bde75e106663" class="t t">RemoteRunspace</a>) { <b>return</b> <b>null</b>; }
 
            <b>try</b>
            {
                <b>if</b> (<a href="#b5a88ccba3ed1699" class="i field">_command</a> != <b>null</b>)
                {
                    <a href="#b5a88ccba3ed1699" class="i field">_command</a>.<a href="../hostifaces/PowerShell.cs.html#59ba1b667dcd86e0" class="i method">WaitForServicingComplete</a>();
                    <a href="#b5a88ccba3ed1699" class="i field">_command</a>.<a href="../hostifaces/PowerShell.cs.html#17cbd8cde3486cb7" class="i method">SuspendIncomingData</a>();
 
                    <b>return</b> <a href="#b5a88ccba3ed1699" class="i field">_command</a>;
                }
 
                <a href="../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r492 rd" class="r492 r">runningCmd</span> = <a href="#7751daf197396196" class="i field">_runspace</a>.<a href="../hostifaces/Connection.cs.html#9db062bececf98bd" class="i method">GetCurrentlyRunningPipeline</a>();
                <b>if</b> (<span class="r492 r">runningCmd</span> != <b>null</b>)
                {
                    <span class="r492 r">runningCmd</span>.<a href="../hostifaces/Pipeline.cs.html#f60de8c84957b18a" class="i method">DrainIncomingData</a>();
                    <span class="r492 r">runningCmd</span>.<a href="../hostifaces/Pipeline.cs.html#edfe3fa78612efce" class="i method">SuspendIncomingData</a>();
 
                    <b>return</b> <span class="r492 r">runningCmd</span>;
                }
            }
            <b>catch</b> (<a href="../../utils/MshNotSupportedException.cs.html#55e79fbd51d0f1cb" class="t t">PSNotSupportedException</a>)
            { }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static void</b> <a id="e0c9a65c30868cf4" href="../../R/e0c9a65c30868cf4.html" target="n" data-glyph="76,1" class="i method">RestoreRemoteOutput</a>(<b>object</b> <span id="r493 rd" class="r493 r">runningCmd</span>)
        {
            <b>if</b> (<span class="r493 r">runningCmd</span> == <b>null</b>) { <b>return</b>; }
 
            <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r494 rd" class="r494 r">command</span> = <span class="r493 r">runningCmd</span> <b>as</b> <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>;
            <b>if</b> (<span class="r494 r">command</span> != <b>null</b>)
            {
                <span class="r494 r">command</span>.<a href="../hostifaces/PowerShell.cs.html#d3f59b7e5131db2a" class="i method">ResumeIncomingData</a>();
            }
            <b>else</b>
            {
                <a href="../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a> <span id="r495 rd" class="r495 r">pipelineCommand</span> = <span class="r493 r">runningCmd</span> <b>as</b> <a href="../hostifaces/Pipeline.cs.html#c607964c20793ea5" class="t t">Pipeline</a>;
                <b>if</b> (<span class="r495 r">pipelineCommand</span> != <b>null</b>)
                {
                    <span class="r495 r">pipelineCommand</span>.<a href="../hostifaces/Pipeline.cs.html#eba54449dfca431c" class="i method">ResumeIncomingData</a>();
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> DebuggerCommandResults
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Command results returned from Debugger.ProcessCommand.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="279d714bfd5743f3" href="../../R/279d714bfd5743f3.html" target="n" data-glyph="0,0" class="t t">DebuggerCommandResults</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resume action.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>? <a id="9f60fc13442f915a" href="../../R/9f60fc13442f915a.html" target="n" data-glyph="102,1" class="i property">ResumeAction</a>
        {
            <b>get</b>;
            <b>private set</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if debugger evaluated command.  Otherwise evaluation was</span>
        <span class="c">///</span><span class="c"> performed by PowerShell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="da0723a8426b5d01" href="../../R/da0723a8426b5d01.html" target="n" data-glyph="102,1" class="i property">EvaluatedByDebugger</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <b>private</b> <a id="88ecf6e5e3c93b4c" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t constructor">DebuggerCommandResults</a>()
        { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r496 r">resumeAction</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Resume action.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r497 r">evaluatedByDebugger</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if evaluated by debugger.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="e583fb3239774485" href="../../R/e583fb3239774485.html" target="n" data-glyph="72,1" class="t constructor">DebuggerCommandResults</a>(
            <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>? <span id="r496 rd" class="r496 r">resumeAction</span>,
            <b>bool</b> <span id="r497 rd" class="r497 r">evaluatedByDebugger</span>)
        {
            <a href="#9f60fc13442f915a" class="i property">ResumeAction</a> = <span class="r496 r">resumeAction</span>;
            <a href="#da0723a8426b5d01" class="i property">EvaluatedByDebugger</a> = <span class="r497 r">evaluatedByDebugger</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> DebuggerCommandProcessor
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class is used to pre-process the command read by the host when it is in debug mode; its</span>
    <span class="c">///</span><span class="c"> main intention is to implement the debugger commands (&quot;s&quot;, &quot;c&quot;, &quot;o&quot;, etc)</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="bf4d705eefc69dbb" href="../../R/bf4d705eefc69dbb.html" target="n" data-glyph="2,0" class="t t">DebuggerCommandProcessor</a>
    {
        <span class="c">// debugger commands</span>
        <b>private const string</b> <a id="2bc261a0e9f9459f" href="../../R/2bc261a0e9f9459f.html" target="n" data-glyph="10,1" class="i field">ContinueCommand</a> = <span class="s">&quot;continue&quot;</span>;
        <b>private const string</b> <a id="a5cc651c9dd1e62b" href="../../R/a5cc651c9dd1e62b.html" target="n" data-glyph="10,1" class="i field">ContinueShortcut</a> = <span class="s">&quot;c&quot;</span>;
        <b>private const string</b> <a id="f17952f3d405b1a0" href="../../R/f17952f3d405b1a0.html" target="n" data-glyph="10,1" class="i field">GetStackTraceShortcut</a> = <span class="s">&quot;k&quot;</span>;
        <b>private const string</b> <a id="29b3ba49093a1bd9" href="../../R/29b3ba49093a1bd9.html" target="n" data-glyph="10,1" class="i field">HelpCommand</a> = <span class="s">&quot;h&quot;</span>;
        <b>private const string</b> <a id="c6a342b20998b4f2" href="../../R/c6a342b20998b4f2.html" target="n" data-glyph="10,1" class="i field">HelpShortcut</a> = <span class="s">&quot;?&quot;</span>;
        <b>private const string</b> <a id="dffb5a30880b96b5" href="../../R/dffb5a30880b96b5.html" target="n" data-glyph="10,1" class="i field">ListCommand</a> = <span class="s">&quot;list&quot;</span>;
        <b>private const string</b> <a id="adef20941591d9b5" href="../../R/adef20941591d9b5.html" target="n" data-glyph="10,1" class="i field">ListShortcut</a> = <span class="s">&quot;l&quot;</span>;
        <b>private const string</b> <a id="a2b79668e10cf40a" href="../../R/a2b79668e10cf40a.html" target="n" data-glyph="10,1" class="i field">StepCommand</a> = <span class="s">&quot;stepInto&quot;</span>;
        <b>private const string</b> <a id="2eaf2b575ea65ed6" href="../../R/2eaf2b575ea65ed6.html" target="n" data-glyph="10,1" class="i field">StepShortcut</a> = <span class="s">&quot;s&quot;</span>;
        <b>private const string</b> <a id="6f7ca2708b87a5e2" href="../../R/6f7ca2708b87a5e2.html" target="n" data-glyph="10,1" class="i field">StepOutCommand</a> = <span class="s">&quot;stepOut&quot;</span>;
        <b>private const string</b> <a id="24e8deec7062d385" href="../../R/24e8deec7062d385.html" target="n" data-glyph="10,1" class="i field">StepOutShortcut</a> = <span class="s">&quot;o&quot;</span>;
        <b>private const string</b> <a id="e3c197f302994b9f" href="../../R/e3c197f302994b9f.html" target="n" data-glyph="10,1" class="i field">StepOverCommand</a> = <span class="s">&quot;stepOver&quot;</span>;
        <b>private const string</b> <a id="afb771638589300d" href="../../R/afb771638589300d.html" target="n" data-glyph="10,1" class="i field">StepOverShortcut</a> = <span class="s">&quot;v&quot;</span>;
        <b>private const string</b> <a id="b122a96a04a5a255" href="../../R/b122a96a04a5a255.html" target="n" data-glyph="10,1" class="i field">StopCommand</a> = <span class="s">&quot;quit&quot;</span>;
        <b>private const string</b> <a id="8ec3f7b9c9abd08f" href="../../R/8ec3f7b9c9abd08f.html" target="n" data-glyph="10,1" class="i field">StopShortcut</a> = <span class="s">&quot;q&quot;</span>;
        <b>private const string</b> <a id="d6d12ae2e727d923" href="../../R/d6d12ae2e727d923.html" target="n" data-glyph="10,1" class="i field">DetachCommand</a> = <span class="s">&quot;detach&quot;</span>;
        <b>private const string</b> <a id="1e1abe3c83c2c7b3" href="../../R/1e1abe3c83c2c7b3.html" target="n" data-glyph="10,1" class="i field">DetachShortcut</a> = <span class="s">&quot;d&quot;</span>;
 
        <span class="c">// default line count for the list command</span>
        <b>private const int</b> <a id="e01f1e6deba700a2" href="../../R/e01f1e6deba700a2.html" target="n" data-glyph="10,1" class="i field">DefaultListLineCount</a> = 16;
 
        <span class="c">// table of debugger commands</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a>&gt; <a id="4d7e0652d11e1ae2" href="../../R/4d7e0652d11e1ae2.html" target="n" data-glyph="46,1" class="i field">_commandTable</a>;
 
        <span class="c">// the Help command</span>
        <b>private readonly</b> <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <a id="4076047d84c0bc34" href="../../R/4076047d84c0bc34.html" target="n" data-glyph="46,1" class="i field">_helpCommand</a>;
 
        <span class="c">// the List command</span>
        <b>private readonly</b> <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <a id="6b91337ece85d8fb" href="../../R/6b91337ece85d8fb.html" target="n" data-glyph="46,1" class="i field">_listCommand</a>;
 
        <span class="c">// last command processed</span>
        <b>private</b> <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <a id="d568e3212f25ff89" href="../../R/d568e3212f25ff89.html" target="n" data-glyph="46,1" class="i field">_lastCommand</a>;
 
        <span class="c">// the source script split into lines</span>
        <b>private string</b>[] <a id="097a0128968c1d30" href="../../R/097a0128968c1d30.html" target="n" data-glyph="46,1" class="i field">_lines</a>;
 
        <span class="c">// last line displayed by the list command</span>
        <b>private int</b> <a id="6d61824289c33ab3" href="../../R/6d61824289c33ab3.html" target="n" data-glyph="46,1" class="i field">_lastLineDisplayed</a>;
 
        <b>private const string</b> <a id="8aab277567531fae" href="../../R/8aab277567531fae.html" target="n" data-glyph="10,1" class="i field">Crlf</a> = <span class="s">&quot;\x000D\x000A&quot;</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates the table of debugger commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="ddb0e911ca6048eb" href="../../R/ddb0e911ca6048eb.html" target="n" data-glyph="72,1" class="t constructor">DebuggerCommandProcessor</a>()
        {
            <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#a2b79668e10cf40a" class="i field">StepCommand</a>] = <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#2eaf2b575ea65ed6" class="i field">StepShortcut</a>] = <b>new</b> <a href="#a148408d8489fb6c" class="t constructor">DebuggerCommand</a>(<a href="#a2b79668e10cf40a" class="i field">StepCommand</a>, <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#422455533b156acf" class="i field">StepInto</a>, <span class="r498 r">repeatOnEnter</span>: <b>true</b>, <span class="r499 r">executedByDebugger</span>: <b>false</b>);
            <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#6f7ca2708b87a5e2" class="i field">StepOutCommand</a>] = <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#24e8deec7062d385" class="i field">StepOutShortcut</a>] = <b>new</b> <a href="#a148408d8489fb6c" class="t constructor">DebuggerCommand</a>(<a href="#6f7ca2708b87a5e2" class="i field">StepOutCommand</a>, <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#4cfb4add3c03409c" class="i field">StepOut</a>, <span class="r498 r">repeatOnEnter</span>: <b>false</b>, <span class="r499 r">executedByDebugger</span>: <b>false</b>);
            <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#e3c197f302994b9f" class="i field">StepOverCommand</a>] = <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#afb771638589300d" class="i field">StepOverShortcut</a>] = <b>new</b> <a href="#a148408d8489fb6c" class="t constructor">DebuggerCommand</a>(<a href="#e3c197f302994b9f" class="i field">StepOverCommand</a>, <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#de21a4b4866a13cc" class="i field">StepOver</a>, <span class="r498 r">repeatOnEnter</span>: <b>true</b>, <span class="r499 r">executedByDebugger</span>: <b>false</b>);
            <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#2bc261a0e9f9459f" class="i field">ContinueCommand</a>] = <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#a5cc651c9dd1e62b" class="i field">ContinueShortcut</a>] = <b>new</b> <a href="#a148408d8489fb6c" class="t constructor">DebuggerCommand</a>(<a href="#2bc261a0e9f9459f" class="i field">ContinueCommand</a>, <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#c35cb32c2ab7ed0d" class="i field">Continue</a>, <span class="r498 r">repeatOnEnter</span>: <b>false</b>, <span class="r499 r">executedByDebugger</span>: <b>false</b>);
            <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#b122a96a04a5a255" class="i field">StopCommand</a>] = <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#8ec3f7b9c9abd08f" class="i field">StopShortcut</a>] = <b>new</b> <a href="#a148408d8489fb6c" class="t constructor">DebuggerCommand</a>(<a href="#b122a96a04a5a255" class="i field">StopCommand</a>, <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>.<a href="#9c143ec10eabd6ad" class="i field">Stop</a>, <span class="r498 r">repeatOnEnter</span>: <b>false</b>, <span class="r499 r">executedByDebugger</span>: <b>false</b>);
            <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#f17952f3d405b1a0" class="i field">GetStackTraceShortcut</a>] = <b>new</b> <a href="#a148408d8489fb6c" class="t constructor">DebuggerCommand</a>(<span class="s">&quot;get-pscallstack&quot;</span>, <b>null</b>, <span class="r498 r">repeatOnEnter</span>: <b>false</b>, <span class="r499 r">executedByDebugger</span>: <b>false</b>);
            <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#29b3ba49093a1bd9" class="i field">HelpCommand</a>] = <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#c6a342b20998b4f2" class="i field">HelpShortcut</a>] = <a href="#4076047d84c0bc34" class="i field">_helpCommand</a> = <b>new</b> <a href="#a148408d8489fb6c" class="t constructor">DebuggerCommand</a>(<a href="#29b3ba49093a1bd9" class="i field">HelpCommand</a>, <b>null</b>, <span class="r498 r">repeatOnEnter</span>: <b>false</b>, <span class="r499 r">executedByDebugger</span>: <b>true</b>);
            <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#dffb5a30880b96b5" class="i field">ListCommand</a>] = <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<a href="#adef20941591d9b5" class="i field">ListShortcut</a>] = <a href="#6b91337ece85d8fb" class="i field">_listCommand</a> = <b>new</b> <a href="#a148408d8489fb6c" class="t constructor">DebuggerCommand</a>(<a href="#dffb5a30880b96b5" class="i field">ListCommand</a>, <b>null</b>, <span class="r498 r">repeatOnEnter</span>: <b>true</b>, <span class="r499 r">executedByDebugger</span>: <b>true</b>);
            <a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>[<b>string</b>.<span class="i">Empty</span>] = <b>new</b> <span class="t">DebuggerCommand</span>(<b>string</b>.<span class="i">Empty</span>, <b>null</b>, <span class="i">repeatOnEnter</span>: <b>false</b>, <span class="i">executedByDebugger</span>: <b>true</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resets any state in the command processor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public void</b> <a id="f17a591cdc659d26" href="../../R/f17a591cdc659d26.html" target="n" data-glyph="72,1" class="i method">Reset</a>()
        {
            <a href="#097a0128968c1d30" class="i field">_lines</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process the command read by the host and returns the DebuggerResumeAction or the command</span>
        <span class="c">///</span><span class="c"> that the host should execute (see comments in the DebuggerCommand class above).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <a id="36cdb30fa7127548" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ProcessCommand</a>(<a href="../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r500 rd" class="r500 r">host</span>, <b>string</b> <span id="r501 rd" class="r501 r">command</span>, <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r502 rd" class="r502 r">invocationInfo</span>)
        {
            <b>return</b> <a href="#d568e3212f25ff89" class="i field">_lastCommand</a> = <a href="#5ec64caf703b5b1d" class="i method">DoProcessCommand</a>(<span class="r500 r">host</span>, <span class="r501 r">command</span>, <span class="r502 r">invocationInfo</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProcessCommand.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r503 r">host</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r504 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r505 r">invocationInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r506 r">output</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <a id="8b2df97049aba8eb" href="../../R/8b2df97049aba8eb.html" target="n" data-glyph="72,1" class="i method">ProcessCommand</a>(<a href="../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r503 rd" class="r503 r">host</span>, <b>string</b> <span id="r504 rd" class="r504 r">command</span>, <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r505 rd" class="r505 r">invocationInfo</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r506 rd" class="r506 r">output</span>)
        {
            <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <span id="r507 rd" class="r507 r">dbgCommand</span> = <a href="#5ec64caf703b5b1d" class="i method">DoProcessCommand</a>(<span class="r503 r">host</span>, <span class="r504 r">command</span>, <span class="r505 r">invocationInfo</span>, <span class="r506 r">output</span>);
            <b>if</b> (<span class="r507 r">dbgCommand</span>.<a href="#ed0eefa60321fd1e" class="i property">ExecutedByDebugger</a> || (<span class="r507 r">dbgCommand</span>.<a href="#4aad237c27ce8bd0" class="i property">ResumeAction</a> != <b>null</b>)) { <a href="#d568e3212f25ff89" class="i field">_lastCommand</a> = <span class="r507 r">dbgCommand</span>; }
 
            <b>return</b> <span class="r507 r">dbgCommand</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process list command with provided line number.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r508 r">invocationInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Current InvocationInfo.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r509 r">output</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Output.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="d71f9505ba7fc953" href="../../R/d71f9505ba7fc953.html" target="n" data-glyph="72,1" class="i method">ProcessListCommand</a>(<a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r508 rd" class="r508 r">invocationInfo</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r509 rd" class="r509 r">output</span>)
        {
            <a href="#5ec64caf703b5b1d" class="i method">DoProcessCommand</a>(<b>null</b>, <span class="s">&quot;list&quot;</span>, <span class="r508 r">invocationInfo</span>, <span class="r509 r">output</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Looks up string command and if it is a debugger command returns the</span>
        <span class="c">///</span><span class="c"> corresponding DebuggerCommand object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r510 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">String command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">DebuggerCommand or null.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <a id="d3fd3e29b2d11bff" href="../../R/d3fd3e29b2d11bff.html" target="n" data-glyph="72,1" class="i method">ProcessBasicCommand</a>(<b>string</b> <span id="r510 rd" class="r510 r">command</span>)
        {
            <b>if</b> (<span class="r510 r">command</span>.<span class="i">Length</span> == 0 &amp;&amp; <a href="#d568e3212f25ff89" class="i field">_lastCommand</a> != <b>null</b> &amp;&amp; <a href="#d568e3212f25ff89" class="i field">_lastCommand</a>.<a href="#4f852a3b1ec8065c" class="i property">RepeatOnEnter</a>)
            {
                <b>return</b> <a href="#d568e3212f25ff89" class="i field">_lastCommand</a>;
            }
 
            <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <span id="r511 rd" class="r511 r">debuggerCommand</span>;
            <b>if</b> (<a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>.<span class="i">TryGetValue</span>(<span class="r510 r">command</span>, <b>out</b> <span class="r511 r">debuggerCommand</span>))
            {
                <b>if</b> (<span class="r511 r">debuggerCommand</span>.<a href="#ed0eefa60321fd1e" class="i property">ExecutedByDebugger</a> || (<span class="r511 r">debuggerCommand</span>.<a href="#4aad237c27ce8bd0" class="i property">ResumeAction</a> != <b>null</b>)) { <a href="#d568e3212f25ff89" class="i field">_lastCommand</a> = <span class="r511 r">debuggerCommand</span>; }
 
                <b>return</b> <span class="r511 r">debuggerCommand</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper for ProcessCommand.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <a id="5ec64caf703b5b1d" href="../../R/5ec64caf703b5b1d.html" target="n" data-glyph="76,1" class="i method">DoProcessCommand</a>(<a href="../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r512 rd" class="r512 r">host</span>, <b>string</b> <span id="r513 rd" class="r513 r">command</span>, <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r514 rd" class="r514 r">invocationInfo</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r515 rd" class="r515 r">output</span>)
        {
            <span class="c">// check for &lt;enter&gt;</span>
            <b>if</b> (<span class="r513 r">command</span>.<span class="i">Length</span> == 0 &amp;&amp; <a href="#d568e3212f25ff89" class="i field">_lastCommand</a> != <b>null</b> &amp;&amp; <a href="#d568e3212f25ff89" class="i field">_lastCommand</a>.<a href="#4f852a3b1ec8065c" class="i property">RepeatOnEnter</a>)
            {
                <b>if</b> (<a href="#d568e3212f25ff89" class="i field">_lastCommand</a> == <a href="#6b91337ece85d8fb" class="i field">_listCommand</a>)
                {
                    <b>if</b> (<a href="#097a0128968c1d30" class="i field">_lines</a> != <b>null</b> &amp;&amp; <a href="#6d61824289c33ab3" class="i field">_lastLineDisplayed</a> &lt; <a href="#097a0128968c1d30" class="i field">_lines</a>.<span class="i">Length</span>)
                    {
                        <span class="i">DisplayScript</span>(<span class="r512 r">host</span>, <span class="r515 r">output</span>, <span class="r514 r">invocationInfo</span>, <a href="#6d61824289c33ab3" class="i field">_lastLineDisplayed</a> + 1, <a href="#e01f1e6deba700a2" class="i field">DefaultListLineCount</a>);
                    }
 
                    <b>return</b> <a href="#6b91337ece85d8fb" class="i field">_listCommand</a>;
                }
 
                <span class="r513 r">command</span> = <a href="#d568e3212f25ff89" class="i field">_lastCommand</a>.<a href="#cfe86dbfb45868ad" class="i property">Command</a>;
            }
 
            <span class="c">// Check for the list command using a regular expression</span>
            <span class="i">Regex</span> <span id="r516 rd" class="r516 r">listCommandRegex</span> = <b>new</b> <span class="i">Regex</span>(<span class="s">@&quot;^l(ist)?(\s+(?&lt;start&gt;\S+))?(\s+(?&lt;count&gt;\S+))?$&quot;</span>, <span class="i">RegexOptions</span>.<span class="i">IgnoreCase</span>);
 
            <span class="i">Match</span> <span id="r517 rd" class="r517 r">match</span> = <span class="r516 r">listCommandRegex</span>.<span class="i">Match</span>(<span class="r513 r">command</span>);
 
            <b>if</b> (<span class="r517 r">match</span>.<span class="i">Success</span>)
            {
                <a href="#69796fd1ea08d0f3" class="i method">DisplayScript</a>(<span class="r512 r">host</span>, <span class="r515 r">output</span>, <span class="r514 r">invocationInfo</span>, <span class="r517 r">match</span>);
                <b>return</b> <a href="#6b91337ece85d8fb" class="i field">_listCommand</a>;
            }
 
            <span class="c">// Check for the rest of the debugger commands</span>
            <a href="#bcdf979426ef3d7b" class="t t">DebuggerCommand</a> <span id="r518 rd" class="r518 r">debuggerCommand</span> = <b>null</b>;
 
            <b>if</b> (<a href="#4d7e0652d11e1ae2" class="i field">_commandTable</a>.<span class="i">TryGetValue</span>(<span class="r513 r">command</span>, <b>out</b> <span class="r518 r">debuggerCommand</span>))
            {
                <span class="c">// Check for the help command</span>
                <b>if</b> (<span class="r518 r">debuggerCommand</span> == <a href="#4076047d84c0bc34" class="i field">_helpCommand</a>)
                {
                    <a href="#4e60bb6c5120699e" class="i method">DisplayHelp</a>(<span class="r512 r">host</span>, <span class="r515 r">output</span>);
                }
 
                <b>return</b> <span class="r518 r">debuggerCommand</span>;
            }
 
            <span class="c">// Else return the same command</span>
            <b>return</b> <b>new</b> <a href="#a148408d8489fb6c" class="t constructor">DebuggerCommand</a>(<span class="r513 r">command</span>, <b>null</b>, <b>false</b>, <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Displays the help text for the debugger commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="4e60bb6c5120699e" href="../../R/4e60bb6c5120699e.html" target="n" data-glyph="76,1" class="i method">DisplayHelp</a>(<a href="../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r519 rd" class="r519 r">host</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r520 rd" class="r520 r">output</span>)
        {
            <span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>, <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">StepHelp</span>, <a href="#2eaf2b575ea65ed6" class="i field">StepShortcut</a>, <a href="#a2b79668e10cf40a" class="i field">StepCommand</a>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">StepOverHelp</span>, <a href="#afb771638589300d" class="i field">StepOverShortcut</a>, <a href="#e3c197f302994b9f" class="i field">StepOverCommand</a>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">StepOutHelp</span>, <a href="#24e8deec7062d385" class="i field">StepOutShortcut</a>, <a href="#6f7ca2708b87a5e2" class="i field">StepOutCommand</a>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>, <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">ContinueHelp</span>, <a href="#a5cc651c9dd1e62b" class="i field">ContinueShortcut</a>, <a href="#2bc261a0e9f9459f" class="i field">ContinueCommand</a>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">StopHelp</span>, <a href="#8ec3f7b9c9abd08f" class="i field">StopShortcut</a>, <a href="#b122a96a04a5a255" class="i field">StopCommand</a>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">DetachHelp</span>, <a href="#1e1abe3c83c2c7b3" class="i field">DetachShortcut</a>, <a href="#d6d12ae2e727d923" class="i field">DetachCommand</a>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>, <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">GetStackTraceHelp</span>, <a href="#f17952f3d405b1a0" class="i field">GetStackTraceShortcut</a>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>, <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">ListHelp</span>, <a href="#adef20941591d9b5" class="i field">ListShortcut</a>, <a href="#dffb5a30880b96b5" class="i field">ListCommand</a>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">AdditionalListHelp1</span>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">AdditionalListHelp2</span>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">AdditionalListHelp3</span>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>, <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">EnterHelp</span>, <a href="#a2b79668e10cf40a" class="i field">StepCommand</a>, <a href="#e3c197f302994b9f" class="i field">StepOverCommand</a>, <a href="#dffb5a30880b96b5" class="i field">ListCommand</a>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>, <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">HelpCommandHelp</span>, <a href="#c6a342b20998b4f2" class="i field">HelpShortcut</a>, <a href="#29b3ba49093a1bd9" class="i field">HelpCommand</a>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<span class="s">&quot;\n&quot;</span>, <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <a href="#e1b4d7b5131b9132" class="i method">WriteLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">PromptHelp</span>), <span class="r519 r">host</span>, <span class="r520 r">output</span>);
            <span class="i">WriteLine</span>(<b>string</b>.<span class="i">Empty</span>, <span class="r519 r">host</span>, <span class="r520 r">output</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Executes the list command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="69796fd1ea08d0f3" href="../../R/69796fd1ea08d0f3.html" target="n" data-glyph="76,1" class="i method">DisplayScript</a>(<a href="../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r521 rd" class="r521 r">host</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r522 rd" class="r522 r">output</span>, <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r523 rd" class="r523 r">invocationInfo</span>, <span class="i">Match</span> <span id="r524 rd" class="r524 r">match</span>)
        {
            <b>if</b> (<span class="r523 r">invocationInfo</span> == <b>null</b>) { <b>return</b>; }
 
            <span class="c">//</span>
            <span class="c">// Get the source code for the script</span>
            <span class="c">//</span>
            <b>if</b> (<a href="#097a0128968c1d30" class="i field">_lines</a> == <b>null</b>)
            {
                <b>string</b> <span id="r525 rd" class="r525 r">scriptText</span> = <span class="r523 r">invocationInfo</span>.<a href="../InvocationInfo.cs.html#f773f8a07f843643" class="i method">GetFullScript</a>();
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r525 r">scriptText</span>))
                {
                    <a href="#678eef91b71a8766" class="i method">WriteErrorLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">NoSourceCode</span>), <span class="r521 r">host</span>, <span class="r522 r">output</span>);
                    <b>return</b>;
                }
 
                <a href="#097a0128968c1d30" class="i field">_lines</a> = <span class="r525 r">scriptText</span>.<span class="i">Split</span>(<b>new</b> <b>string</b>[] { <span class="s">&quot;\r\n&quot;</span>, <span class="s">&quot;\r&quot;</span>, <span class="s">&quot;\n&quot;</span> }, <span class="i">StringSplitOptions</span>.<span class="i">None</span>);
            }
 
            <span class="c">//</span>
            <span class="c">// Get the starting line</span>
            <span class="c">//</span>
            <b>int</b> <span id="r526 rd" class="r526 r">start</span> = <span class="i">Math</span>.<span class="i">Max</span>(<span class="r523 r">invocationInfo</span>.<a href="../InvocationInfo.cs.html#6d9f0c2743c6397f" class="i property">ScriptLineNumber</a> - 5, 1);
 
            <b>if</b> (<span class="r524 r">match</span>.<span class="i">Groups</span>[<span class="s">&quot;start&quot;</span>].<span class="i">Value</span>.<span class="i">Length</span> &gt; 0)
            {
                <b>try</b>
                {
                    <span class="r526 r">start</span> = <b>int</b>.<span class="i">Parse</span>(<span class="r524 r">match</span>.<span class="i">Groups</span>[<span class="s">&quot;start&quot;</span>].<span class="i">Value</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>.<span class="i">NumberFormat</span>);
                }
                <b>catch</b>
                {
                    <a href="#678eef91b71a8766" class="i method">WriteErrorLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">BadStartFormat</span>, <a href="#097a0128968c1d30" class="i field">_lines</a>.<span class="i">Length</span>), <span class="r521 r">host</span>, <span class="r522 r">output</span>);
                    <b>return</b>;
                }
 
                <b>if</b> (<span class="r526 r">start</span> &lt;= 0 || <span class="r526 r">start</span> &gt; <a href="#097a0128968c1d30" class="i field">_lines</a>.<span class="i">Length</span>)
                {
                    <a href="#678eef91b71a8766" class="i method">WriteErrorLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">BadStartFormat</span>, <a href="#097a0128968c1d30" class="i field">_lines</a>.<span class="i">Length</span>), <span class="r521 r">host</span>, <span class="r522 r">output</span>);
                    <b>return</b>;
                }
            }
 
            <span class="c">//</span>
            <span class="c">// Get the line count</span>
            <span class="c">//</span>
            <b>int</b> <span id="r527 rd" class="r527 r">count</span> = <a href="#e01f1e6deba700a2" class="i field">DefaultListLineCount</a>;
 
            <b>if</b> (<span class="r524 r">match</span>.<span class="i">Groups</span>[<span class="s">&quot;count&quot;</span>].<span class="i">Value</span>.<span class="i">Length</span> &gt; 0)
            {
                <b>try</b>
                {
                    <span class="r527 r">count</span> = <b>int</b>.<span class="i">Parse</span>(<span class="r524 r">match</span>.<span class="i">Groups</span>[<span class="s">&quot;count&quot;</span>].<span class="i">Value</span>, <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>.<span class="i">NumberFormat</span>);
                }
                <b>catch</b>
                {
                    <a href="#678eef91b71a8766" class="i method">WriteErrorLine</a>(<a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">BadCountFormat</span>, <a href="#097a0128968c1d30" class="i field">_lines</a>.<span class="i">Length</span>), <span class="r521 r">host</span>, <span class="r522 r">output</span>);
                    <b>return</b>;
                }
 
                <span class="c">// Limit requested line count to maximum number of existing lines</span>
                <span class="r527 r">count</span> = (<span class="r527 r">count</span> &gt; <a href="#097a0128968c1d30" class="i field">_lines</a>.<span class="i">Length</span>) ? <a href="#097a0128968c1d30" class="i field">_lines</a>.<span class="i">Length</span> : <span class="r527 r">count</span>;
 
                <b>if</b> (<span class="r527 r">count</span> &lt;= 0)
                {
                    <span class="i">WriteErrorLine</span>(<span class="i">DebuggerStrings</span>.<span class="i">BadCountFormat</span>, <span class="r521 r">host</span>, <span class="r522 r">output</span>);
                    <b>return</b>;
                }
            }
 
            <span class="c">//</span>
            <span class="c">// Execute the command</span>
            <span class="c">//</span>
            <a href="#54d4e4680773f762" class="i method">DisplayScript</a>(<span class="r521 r">host</span>, <span class="r522 r">output</span>, <span class="r523 r">invocationInfo</span>, <span class="r526 r">start</span>, <span class="r527 r">count</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Executes the list command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="54d4e4680773f762" href="../../R/54d4e4680773f762.html" target="n" data-glyph="76,1" class="i method">DisplayScript</a>(<a href="../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r528 rd" class="r528 r">host</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r529 rd" class="r529 r">output</span>, <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r530 rd" class="r530 r">invocationInfo</span>, <b>int</b> <span id="r531 rd" class="r531 r">start</span>, <b>int</b> <span id="r532 rd" class="r532 r">count</span>)
        {
            <a href="#b7fbffaacad75cc3" class="i method">WriteCR</a>(<span class="r528 r">host</span>, <span class="r529 r">output</span>);
 
            <b>for</b> (<b>int</b> <span id="r533 rd" class="r533 r">lineNumber</span> = <span class="r531 r">start</span>; <span class="r533 r">lineNumber</span> &lt;= <a href="#097a0128968c1d30" class="i field">_lines</a>.<span class="i">Length</span> &amp;&amp; <span class="r533 r">lineNumber</span> &lt; <span class="r531 r">start</span> + <span class="r532 r">count</span>; <span class="r533 r">lineNumber</span>++)
            {
                <span class="i">WriteLine</span>(
                    <span class="r533 r">lineNumber</span> == <span class="r530 r">invocationInfo</span>.<a href="../InvocationInfo.cs.html#6d9f0c2743c6397f" class="i property">ScriptLineNumber</a> ?
                    <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="s">&quot;{0,5}:* {1}&quot;</span>, <span class="r533 r">lineNumber</span>, <a href="#097a0128968c1d30" class="i field">_lines</a>[<span class="r533 r">lineNumber</span> - 1])
                    :
                    <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="s">&quot;{0,5}:  {1}&quot;</span>, <span class="r533 r">lineNumber</span>, <a href="#097a0128968c1d30" class="i field">_lines</a>[<span class="r533 r">lineNumber</span> - 1]),
                    <span class="r528 r">host</span>,
                    <span class="r529 r">output</span>);
 
                <a href="#6d61824289c33ab3" class="i field">_lastLineDisplayed</a> = <span class="r533 r">lineNumber</span>;
            }
 
            <a href="#b7fbffaacad75cc3" class="i method">WriteCR</a>(<span class="r528 r">host</span>, <span class="r529 r">output</span>);
        }
 
        <b>private static void</b> <a id="e1b4d7b5131b9132" href="../../R/e1b4d7b5131b9132.html" target="n" data-glyph="76,1" class="i method">WriteLine</a>(<b>string</b> <span id="r534 rd" class="r534 r">line</span>, <a href="../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r535 rd" class="r535 r">host</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r536 rd" class="r536 r">output</span>)
        {
            <b>if</b> (<span class="r535 r">host</span> != <b>null</b>)
            {
                <span class="r535 r">host</span>.<a href="../hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a>.<a href="../hostifaces/MshHostUserInterface.cs.html#41cef667d4ee22a2" class="i method">WriteLine</a>(<span class="r534 r">line</span>);
            }
 
            <b>if</b> (<span class="r536 r">output</span> != <b>null</b>)
            {
                <span class="r536 r">output</span>.<span class="i">Add</span>(<b>new</b> <a href="../MshObject.cs.html#3ee1d75e736c4afc" class="t constructor">PSObject</a>(<span class="r534 r">line</span>));
            }
        }
 
        <b>private static void</b> <a id="b7fbffaacad75cc3" href="../../R/b7fbffaacad75cc3.html" target="n" data-glyph="76,1" class="i method">WriteCR</a>(<a href="../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r537 rd" class="r537 r">host</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r538 rd" class="r538 r">output</span>)
        {
            <b>if</b> (<span class="r537 r">host</span> != <b>null</b>)
            {
                <span class="r537 r">host</span>.<a href="../hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a>.<a href="../hostifaces/MshHostUserInterface.cs.html#f95b9cbe920380e3" class="i method">WriteLine</a>();
            }
 
            <b>if</b> (<span class="r538 r">output</span> != <b>null</b>)
            {
                <span class="r538 r">output</span>.<span class="i">Add</span>(<b>new</b> <a href="../MshObject.cs.html#3ee1d75e736c4afc" class="t constructor">PSObject</a>(<a href="#8aab277567531fae" class="i field">Crlf</a>));
            }
        }
 
        <b>private static void</b> <a id="678eef91b71a8766" href="../../R/678eef91b71a8766.html" target="n" data-glyph="76,1" class="i method">WriteErrorLine</a>(<b>string</b> <span id="r539 rd" class="r539 r">error</span>, <a href="../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <span id="r540 rd" class="r540 r">host</span>, <span class="i">IList</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r541 rd" class="r541 r">output</span>)
        {
            <b>if</b> (<span class="r540 r">host</span> != <b>null</b>)
            {
                <span class="r540 r">host</span>.<a href="../hostifaces/MshHost.cs.html#f3c3c89a5e9dd42a" class="i property">UI</a>.<a href="../hostifaces/MshHostUserInterface.cs.html#c90737c2e1ab652f" class="i method">WriteErrorLine</a>(<span class="r539 r">error</span>);
            }
 
            <b>if</b> (<span class="r541 r">output</span> != <b>null</b>)
            {
                <span class="r541 r">output</span>.<span class="i">Add</span>(
                    <b>new</b> <a href="../MshObject.cs.html#3ee1d75e736c4afc" class="t constructor">PSObject</a>(
                        <b>new</b> <span class="t">ErrorRecord</span>(
                            <b>new</b> <a href="../../utils/RuntimeException.cs.html#e4538a388d78c143" class="t constructor">RuntimeException</a>(<span class="r539 r">error</span>),
                            <span class="s">&quot;DebuggerError&quot;</span>,
                            <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#b5cba3d51f976bb3" class="i field">InvalidOperation</a>,
                            <b>null</b>)));
            }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Class used to hold the output of the DebuggerCommandProcessor.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="bcdf979426ef3d7b" href="../../R/bcdf979426ef3d7b.html" target="n" data-glyph="2,0" class="t t">DebuggerCommand</a>
    {
        <b>public</b> <a id="a148408d8489fb6c" href="../../R/a148408d8489fb6c.html" target="n" data-glyph="72,1" class="t constructor">DebuggerCommand</a>(<b>string</b> <span id="r542 rd" class="r542 r">command</span>, <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>? <span id="r543 rd" class="r543 r">action</span>, <b>bool</b> <span id="r498 rd" class="r498 r">repeatOnEnter</span>, <b>bool</b> <span id="r499 rd" class="r499 r">executedByDebugger</span>)
        {
            <a href="#4aad237c27ce8bd0" class="i property">ResumeAction</a> = <span class="r543 r">action</span>;
            <a href="#cfe86dbfb45868ad" class="i property">Command</a> = <span class="r542 r">command</span>;
            <a href="#4f852a3b1ec8065c" class="i property">RepeatOnEnter</a> = <span class="r498 r">repeatOnEnter</span>;
            <a href="#ed0eefa60321fd1e" class="i property">ExecutedByDebugger</a> = <span class="r499 r">executedByDebugger</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If ResumeAction is not null it indicates that the host must exit the debugger</span>
        <span class="c">///</span><span class="c"> and resume execution of the suspended pipeline; the debugger will use the</span>
        <span class="c">///</span><span class="c"> value of this property to decide how to resume the pipeline (i.e. step into,</span>
        <span class="c">///</span><span class="c"> step-over, continue, etc)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#470618169485a70e" class="t t">DebuggerResumeAction</a>? <a id="4aad237c27ce8bd0" href="../../R/4aad237c27ce8bd0.html" target="n" data-glyph="102,1" class="i property">ResumeAction</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When ResumeAction is null, this property indicates the command that the</span>
        <span class="c">///</span><span class="c"> host should pass to the PowerShell engine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="cfe86dbfb45868ad" href="../../R/cfe86dbfb45868ad.html" target="n" data-glyph="102,1" class="i property">Command</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the host should repeat this command if the next command in an empty line (enter)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="4f852a3b1ec8065c" href="../../R/4f852a3b1ec8065c.html" target="n" data-glyph="102,1" class="i property">RepeatOnEnter</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the command was executed by the debugger and the host should ignore the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="ed0eefa60321fd1e" href="../../R/ed0eefa60321fd1e.html" target="n" data-glyph="102,1" class="i property">ExecutedByDebugger</a> { <b>get</b>; }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> PSDebugContext class
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class exposes the information about the debugger that is available via $PSDebugContext.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="e222de8633bb1762" href="../../R/e222de8633bb1762.html" target="n" data-glyph="0,0" class="t t">PSDebugContext</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e222de8633bb1762" class="t t">PSDebugContext</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r544 r">invocationInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The invocation information for the current command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r545 r">breakpoints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint(s) that caused the script to break in the debugger.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="5eac5528e22d9184" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">PSDebugContext</a>(<a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r544 rd" class="r544 r">invocationInfo</span>, <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r545 rd" class="r545 r">breakpoints</span>)
            : <a href="#3f0121fd104dc258" class="k">this</a>(<span class="r544 r">invocationInfo</span>, <span class="r545 r">breakpoints</span>, <span class="r546 r">triggerObject</span>: <b>null</b>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#e222de8633bb1762" class="t t">PSDebugContext</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r547 r">invocationInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The invocation information for the current command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r548 r">breakpoints</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The breakpoint(s) that caused the script to break in the debugger.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r546 r">triggerObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The object that caused the script to break in the debugger.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="3f0121fd104dc258" href="../../R/3f0121fd104dc258.html" target="n" data-glyph="72,1" class="t constructor">PSDebugContext</a>(<a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r547 rd" class="r547 r">invocationInfo</span>, <span class="i">List</span>&lt;<a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>&gt; <span id="r548 rd" class="r548 r">breakpoints</span>, <b>object</b> <span id="r546 rd" class="r546 r">triggerObject</span>)
        {
            <b>if</b> (<span class="r548 r">breakpoints</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r548 r">breakpoints</span>));
            }
 
            <a href="#e222de8633bb1762" class="k">this</a>.<a href="#8e58e9ba0d766409" class="i property">InvocationInfo</a> = <span class="r547 r">invocationInfo</span>;
            <a href="#e222de8633bb1762" class="k">this</a>.<a href="#2568e95ea9703e06" class="i property">Breakpoints</a> = <span class="r548 r">breakpoints</span>.<span class="i">ToArray</span>();
            <a href="#e222de8633bb1762" class="k">this</a>.<a href="#af608e3583091989" class="i property">Trigger</a> = <span class="r546 r">triggerObject</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> InvocationInfo of the command currently being executed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="8e58e9ba0d766409" href="../../R/8e58e9ba0d766409.html" target="n" data-glyph="102,1" class="i property">InvocationInfo</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If not empty, indicates that the execution was suspended because one or more breakpoints</span>
        <span class="c">///</span><span class="c"> were hit. Otherwise, the execution was suspended as part of a step operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Breakpoint.cs.html#9deaac83de6a8f2c" class="t t">Breakpoint</a>[] <a id="2568e95ea9703e06" href="../../R/2568e95ea9703e06.html" target="n" data-glyph="102,1" class="i property">Breakpoints</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the object that triggered the current dynamic breakpoint.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="af608e3583091989" href="../../R/af608e3583091989.html" target="n" data-glyph="102,1" class="i property">Trigger</a> { <b>get</b>; }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> CallStackFrame class
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A call stack item returned by the Get-PSCallStack cmdlet.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="70d153384f134926" href="../../R/70d153384f134926.html" target="n" data-glyph="0,0" class="t t">CallStackFrame</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r549 r">invocationInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Invocation Info.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="a3ba284f975be756" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">CallStackFrame</a>(<a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r549 rd" class="r549 r">invocationInfo</span>)
            : <a href="#9d785051a421ae89" class="k">this</a>(<b>null</b>, <span class="r549 r">invocationInfo</span>)
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r550 r">functionContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Function context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r551 r">invocationInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Invocation Info.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="9d785051a421ae89" href="../../R/9d785051a421ae89.html" target="n" data-glyph="74,1" class="t constructor">CallStackFrame</a>(<a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a> <span id="r550 rd" class="r550 r">functionContext</span>, <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r551 rd" class="r551 r">invocationInfo</span>)
        {
            <b>if</b> (<span class="r551 r">invocationInfo</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r551 r">invocationInfo</span>));
            }
 
            <b>if</b> (<span class="r550 r">functionContext</span> != <b>null</b>)
            {
                <a href="#70d153384f134926" class="k">this</a>.<a href="#db51167e7b726802" class="i property">InvocationInfo</a> = <span class="r551 r">invocationInfo</span>;
                <a href="#271736087984abfe" class="i property">FunctionContext</a> = <span class="r550 r">functionContext</span>;
                <a href="#70d153384f134926" class="k">this</a>.<a href="#3e401df2644d9a27" class="i property">Position</a> = <span class="r550 r">functionContext</span>.<a href="../parser/Compiler.cs.html#5ed77de1a1fe863f" class="i property">CurrentPosition</a>;
            }
            <b>else</b>
            {
                <span class="c">// WF functions do not have functionContext.  Use InvocationInfo.</span>
                <a href="#70d153384f134926" class="k">this</a>.<a href="#db51167e7b726802" class="i property">InvocationInfo</a> = <span class="r551 r">invocationInfo</span>;
                <a href="#70d153384f134926" class="k">this</a>.<a href="#3e401df2644d9a27" class="i property">Position</a> = <span class="r551 r">invocationInfo</span>.<a href="../InvocationInfo.cs.html#36c1c0cc46ab70ad" class="i property">ScriptPosition</a>;
                <a href="#271736087984abfe" class="i property">FunctionContext</a> = <b>new</b> <span class="t">FunctionContext</span>();
                <a href="#271736087984abfe" class="i property">FunctionContext</a>.<a href="../parser/Compiler.cs.html#cf35fafd088fea9b" class="i field">_functionName</a> = <span class="r551 r">invocationInfo</span>.<a href="../InvocationInfo.cs.html#ffa710af0f908256" class="i property">ScriptName</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> File name of the current location, or null if the frame is not associated to a script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="2d5a7eeacb864cf2" href="../../R/2d5a7eeacb864cf2.html" target="n" data-glyph="102,1" class="i property">ScriptName</a>
        {
            <b>get</b> { <b>return</b> <a href="#3e401df2644d9a27" class="i property">Position</a>.<a href="../parser/Position.cs.html#e933edecd2b0cc1d" class="i property">File</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Line number of the current location, or 0 if the frame is not associated to a script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="e62e3970e47139f1" href="../../R/e62e3970e47139f1.html" target="n" data-glyph="102,1" class="i property">ScriptLineNumber</a>
        {
            <b>get</b> { <b>return</b> <a href="#3e401df2644d9a27" class="i property">Position</a>.<a href="../parser/Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a>; }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The InvocationInfo of the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <a id="db51167e7b726802" href="../../R/db51167e7b726802.html" target="n" data-glyph="102,1" class="i property">InvocationInfo</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The position information for the current position in the frame.  Null if the frame is not</span>
        <span class="c">///</span><span class="c"> associated with a script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="3e401df2644d9a27" href="../../R/3e401df2644d9a27.html" target="n" data-glyph="102,1" class="i property">Position</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the function associated with this frame.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="078cb2a4dc4ad417" href="../../R/078cb2a4dc4ad417.html" target="n" data-glyph="102,1" class="i property">FunctionName</a> { <b>get</b> { <b>return</b> <a href="#271736087984abfe" class="i property">FunctionContext</a>.<a href="../parser/Compiler.cs.html#cf35fafd088fea9b" class="i field">_functionName</a>; } }
 
        <b>internal</b> <a href="../parser/Compiler.cs.html#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a> <a id="271736087984abfe" href="../../R/271736087984abfe.html" target="n" data-glyph="104,1" class="i property">FunctionContext</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a formatted string containing the ScriptName and ScriptLineNumber.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="70bea301f1095214" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetScriptLocation</a>()
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#70d153384f134926" class="k">this</a>.<a href="#2d5a7eeacb864cf2" class="i property">ScriptName</a>))
            {
                <b>return</b> <span class="i">DebuggerStrings</span>.<span class="i">NoFile</span>;
            }
 
            <b>return</b> <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">LocationFormat</span>, <span class="i">Path</span>.<span class="i">GetFileName</span>(<a href="#70d153384f134926" class="k">this</a>.<a href="#2d5a7eeacb864cf2" class="i property">ScriptName</a>), <a href="#70d153384f134926" class="k">this</a>.<a href="#e62e3970e47139f1" class="i property">ScriptLineNumber</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a dictionary with the names and values of variables that are &quot;local&quot;</span>
        <span class="c">///</span><span class="c"> to the frame.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a>&gt; <a id="0ce193312c4e2779" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetFrameVariables</a>()
        {
            <b>var</b> <span id="r552 rd" class="r552 r">result</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <b>if</b> (<a href="#271736087984abfe" class="i property">FunctionContext</a>.<a href="../parser/Compiler.cs.html#86d08ccdd0602a1b" class="i field">_executionContext</a> == <b>null</b>) { <b>return</b> <span class="r552 r">result</span>; }
 
            <a href="../SessionStateScope.cs.html#460261155e0163cb" class="k">var</a> <span id="r553 rd" class="r553 r">scope</span> = <a href="#271736087984abfe" class="i property">FunctionContext</a>.<a href="../parser/Compiler.cs.html#86d08ccdd0602a1b" class="i field">_executionContext</a>.<a href="../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="../SessionStateScopeAPIs.cs.html#224987ad36a90f88" class="i property">CurrentScope</a>;
            <b>while</b> (<span class="r553 r">scope</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r553 r">scope</span>.<a href="../SessionStateScope.cs.html#d10101bbc5961e39" class="i property">LocalsTuple</a> == <a href="#271736087984abfe" class="i property">FunctionContext</a>.<a href="../parser/Compiler.cs.html#23a9d5ac6a3b086b" class="i field">_localsTuple</a>)
                {
                    <span class="c">// We can ignore any dotted scopes.</span>
                    <b>break</b>;
                }
 
                <b>if</b> (<span class="r553 r">scope</span>.<a href="../SessionStateScope.cs.html#240090c569665c17" class="i property">DottedScopes</a> != <b>null</b> &amp;&amp; <span class="r553 r">scope</span>.<a href="../SessionStateScope.cs.html#240090c569665c17" class="i property">DottedScopes</a>.<span class="i">Any</span>(<span id="r554 rd" class="r554 r">s</span> =&gt; <span class="r554 r">s</span> == <a href="#271736087984abfe" class="i property">FunctionContext</a>.<a href="../parser/Compiler.cs.html#23a9d5ac6a3b086b" class="i field">_localsTuple</a>))
                {
                    <b>var</b> <span id="r555 rd" class="r555 r">dottedScopes</span> = <span class="r553 r">scope</span>.<a href="../SessionStateScope.cs.html#240090c569665c17" class="i property">DottedScopes</a>.<span class="i">ToArray</span>();
 
                    <b>int</b> <span id="r556 rd" class="r556 r">i</span>;
                    <span class="c">// Skip dotted scopes above the current scope</span>
                    <b>for</b> (<span class="r556 r">i</span> = 0; <span class="r556 r">i</span> &lt; <span class="r555 r">dottedScopes</span>.<span class="i">Length</span>; ++<span class="r556 r">i</span>)
                    {
                        <b>if</b> (<span class="r555 r">dottedScopes</span>[<span class="r556 r">i</span>] == <a href="#271736087984abfe" class="i property">FunctionContext</a>.<a href="../parser/Compiler.cs.html#23a9d5ac6a3b086b" class="i field">_localsTuple</a>)
                            <b>break</b>;
                    }
 
                    <b>for</b> (; <span class="r556 r">i</span> &lt; <span class="r555 r">dottedScopes</span>.<span class="i">Length</span>; ++<span class="r556 r">i</span>)
                    {
                        <span class="r555 r">dottedScopes</span>[<span class="r556 r">i</span>].<span class="i">GetVariableTable</span>(<span class="r552 r">result</span>, <b>true</b>);
                    }
 
                    <b>break</b>;
                }
 
                <span class="r553 r">scope</span> = <span class="r553 r">scope</span>.<a href="../SessionStateScope.cs.html#ec04fff24436a018" class="i property">Parent</a>;
            }
 
            <a href="#271736087984abfe" class="i property">FunctionContext</a>.<a href="../parser/Compiler.cs.html#23a9d5ac6a3b086b" class="i field">_localsTuple</a>.<a href="../runtime/MutableTuple.cs.html#8e4cde215c4b97af" class="i method">GetVariableTable</a>(<span class="r552 r">result</span>, <b>true</b>);
 
            <b>return</b> <span class="r552 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ToString override.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="a56e48ec3c595fb2" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">DebuggerStrings</span>.<span class="i">StackTraceFormat</span>, <a href="#078cb2a4dc4ad417" class="i property">FunctionName</a>,
                                     <a href="#2d5a7eeacb864cf2" class="i property">ScriptName</a> ?? <span class="i">DebuggerStrings</span>.<span class="i">NoFile</span>, <a href="#e62e3970e47139f1" class="i property">ScriptLineNumber</a>);
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
}
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> DebuggerUtils
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Debugger Utilities class.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.MSInternal&quot;</span>, <span class="s">&quot;CA903:InternalNamespaceShouldNotContainPublicTypes&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Needed Internal use only&quot;</span>)]
    <b>public static class</b> <a id="a25b6893c0f6ac59" href="../../R/a25b6893c0f6ac59.html" target="n" data-glyph="0,0" class="t t">DebuggerUtils</a>
    {
        <b>private static readonly</b> <span class="i">SortedSet</span>&lt;<b>string</b>&gt; <a id="e96e892baa5600a3" href="../../R/e96e892baa5600a3.html" target="n" data-glyph="46,1" class="i field">s_noHistoryCommandNames</a> = <b>new</b> <span class="i">SortedSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
        {
            <span class="s">&quot;prompt&quot;</span>,
            <span class="s">&quot;Set-PSDebuggerAction&quot;</span>,
            <span class="s">&quot;Get-PSDebuggerStopArgs&quot;</span>,
            <span class="s">&quot;Set-PSDebugMode&quot;</span>,
            <span class="s">&quot;TabExpansion2&quot;</span>
        };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Helper method to determine if command should be added to debugger</span>
        <span class="c">///</span><span class="c"> history.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r557 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Command string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True if command can be added to history.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="0bb17dde756030e5" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ShouldAddCommandToHistory</a>(<b>string</b> <span id="r557 rd" class="r557 r">command</span>)
        {
            <b>if</b> (<span class="r557 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r557 r">command</span>));
            }
 
            <b>lock</b> (<a href="#e96e892baa5600a3" class="i field">s_noHistoryCommandNames</a>)
            {
                <b>return</b> !(<a href="#e96e892baa5600a3" class="i field">s_noHistoryCommandNames</a>.<span class="i">Contains</span>(<span class="r557 r">command</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Start monitoring a runspace on the target debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r558 r">debugger</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Target debugger.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r559 r">runspaceInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSMonitorRunspaceInfo.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public static void</b> <a id="e316d201420eaa09" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">StartMonitoringRunspace</a>(<a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r558 rd" class="r558 r">debugger</span>, <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a> <span id="r559 rd" class="r559 r">runspaceInfo</span>)
        {
            <b>if</b> (<span class="r558 r">debugger</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r558 r">debugger</span>));
            }
 
            <b>if</b> (<span class="r559 r">runspaceInfo</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r559 r">runspaceInfo</span>));
            }
 
            <span class="r558 r">debugger</span>.<a href="#06cee48d6b1060f4" class="i method">StartMonitoringRunspace</a>(<span class="r559 r">runspaceInfo</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> End monitoring a runspace on the target degbugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r560 r">debugger</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Target debugger.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r561 r">runspaceInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSMonitorRunspaceInfo.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public static void</b> <a id="d6fbd03ec2ba9d80" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">EndMonitoringRunspace</a>(<a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r560 rd" class="r560 r">debugger</span>, <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a> <span id="r561 rd" class="r561 r">runspaceInfo</span>)
        {
            <b>if</b> (<span class="r560 r">debugger</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r560 r">debugger</span>));
            }
 
            <b>if</b> (<span class="r561 r">runspaceInfo</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r561 r">runspaceInfo</span>));
            }
 
            <span class="r560 r">debugger</span>.<a href="#565365e36cf7b065" class="i method">EndMonitoringRunspace</a>(<span class="r561 r">runspaceInfo</span>);
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> PSMonitorRunspaceEvent
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> PSMonitorRunspaceEvent.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.MSInternal&quot;</span>, <span class="s">&quot;CA903:InternalNamespaceShouldNotContainPublicTypes&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Needed Internal use only&quot;</span>)]
    <b>public enum</b> <a id="29c6cf229c9fc955" href="../../R/29c6cf229c9fc955.html" target="n" data-glyph="18,0" class="t t"><span id="2d444ba98827d974">PSMonitorRunspaceType</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Standalone runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="e83f86b047269d84" href="../../R/e83f86b047269d84.html" target="n" data-glyph="24,1" class="i field">Standalone</a> = 0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Runspace from remote Invoke-Command script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="7d2386902b5bd510" href="../../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">InvokeCommand</a>,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Runspace information for monitoring runspaces for debugging.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.MSInternal&quot;</span>, <span class="s">&quot;CA903:InternalNamespaceShouldNotContainPublicTypes&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Needed Internal use only&quot;</span>)]
    <b>public abstract class</b> <a id="ec28e88960630f53" href="../../R/ec28e88960630f53.html" target="n" data-glyph="0,0" class="t t">PSMonitorRunspaceInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Created Runspace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="c9a2faca9dff1fec" href="../../R/c9a2faca9dff1fec.html" target="n" data-glyph="102,1" class="i property">Runspace</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Type of runspace for monitoring.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#29c6cf229c9fc955" class="t t">PSMonitorRunspaceType</a> <a id="8979cdc792041f63" href="../../R/8979cdc792041f63.html" target="n" data-glyph="102,1" class="i property">RunspaceType</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Nested debugger wrapper for runspace debugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#06468cc0107c4c70" class="t t">NestedRunspaceDebugger</a> <a id="514755517c5ed096" href="../../R/514755517c5ed096.html" target="n" data-glyph="104,1" class="i property">NestedDebugger</a> { <b>get</b>; <b>set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructors
 
        <b>private</b> <a id="5dbd5a5a401c79f8" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t constructor">PSMonitorRunspaceInfo</a>() { }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r562 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r563 r">runspaceType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>protected</b> <a id="4b8ddb2df484d5d2" href="../../R/4b8ddb2df484d5d2.html" target="n" data-glyph="75,1" class="t constructor">PSMonitorRunspaceInfo</a>(
            <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r562 rd" class="r562 r">runspace</span>,
            <a href="#29c6cf229c9fc955" class="t t">PSMonitorRunspaceType</a> <span id="r563 rd" class="r563 r">runspaceType</span>)
        {
            <b>if</b> (<span class="r562 r">runspace</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentNullException.cs.html#166e605c6cb05157" class="t constructor">PSArgumentNullException</a>(<b>nameof</b>(<span class="r562 r">runspace</span>));
            }
 
            <a href="#c9a2faca9dff1fec" class="i property">Runspace</a> = <span class="r562 r">runspace</span>;
            <a href="#8979cdc792041f63" class="i property">RunspaceType</a> = <span class="r563 r">runspaceType</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a copy of this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal abstract</b> <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a> <a id="2f40f487f9e1d3c2" href="../../R/2f40f487f9e1d3c2.html" target="n" data-glyph="74,1" class="i method">Copy</a>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of a NestedRunspaceDebugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r564 r">rootDebugger</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Root debugger or null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">NestedRunspaceDebugger.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal abstract</b> <a href="#06468cc0107c4c70" class="t t">NestedRunspaceDebugger</a> <a id="6050650cfe00a281" href="../../R/6050650cfe00a281.html" target="n" data-glyph="74,1" class="i method">CreateDebugger</a>(<a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r564 rd" class="r564 r">rootDebugger</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Standalone runspace information for monitoring runspaces for debugging.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.MSInternal&quot;</span>, <span class="s">&quot;CA903:InternalNamespaceShouldNotContainPublicTypes&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Needed Internal use only&quot;</span>)]
    <b>public sealed class</b> <a id="37ec9df467825c0d" href="../../R/37ec9df467825c0d.html" target="n" data-glyph="0,0" class="t t">PSStandaloneMonitorRunspaceInfo</a> : <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates instance of PSStandaloneMonitorRunspaceInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r565 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace to monitor.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="1d50b98aeb5e39ea" href="../../R/1d50b98aeb5e39ea.html" target="n" data-glyph="72,1" class="t constructor">PSStandaloneMonitorRunspaceInfo</a>(
            <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r565 rd" class="r565 r">runspace</span>)
            : <a href="#4b8ddb2df484d5d2" class="k">base</a>(<span class="r565 r">runspace</span>, <a href="#29c6cf229c9fc955" class="t t">PSMonitorRunspaceType</a>.<a href="#e83f86b047269d84" class="i field">Standalone</a>)
        { }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a copy of this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a> <a id="75dec19f9f8ac115" href="../../R/75dec19f9f8ac115.html" target="n" data-glyph="74,1" class="i method">Copy</a>()
        {
            <b>return</b> <b>new</b> <a href="#1d50b98aeb5e39ea" class="t constructor">PSStandaloneMonitorRunspaceInfo</a>(<a href="#c9a2faca9dff1fec" class="i property">Runspace</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of a NestedRunspaceDebugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r566 r">rootDebugger</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Root debugger or null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">NestedRunspaceDebugger wrapper.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="#06468cc0107c4c70" class="t t">NestedRunspaceDebugger</a> <a id="250da5ff221f1ee3" href="../../R/250da5ff221f1ee3.html" target="n" data-glyph="74,1" class="i method">CreateDebugger</a>(<a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r566 rd" class="r566 r">rootDebugger</span>)
        {
            <b>return</b> <b>new</b> <a href="#197cff01e6b17981" class="t constructor">StandaloneRunspaceDebugger</a>(<a href="#c9a2faca9dff1fec" class="i property">Runspace</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Embedded runspaces running in context of a parent script, used for monitoring</span>
    <span class="c">///</span><span class="c"> runspace debugging.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.MSInternal&quot;</span>, <span class="s">&quot;CA903:InternalNamespaceShouldNotContainPublicTypes&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Needed Internal use only&quot;</span>)]
    <b>public sealed class</b> <a id="4eca8dd0d1c28909" href="../../R/4eca8dd0d1c28909.html" target="n" data-glyph="0,0" class="t t">PSEmbeddedMonitorRunspaceInfo</a> : <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Properties
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> PowerShell command to run.  Can be null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="8a870e0813dc79cf" href="../../R/8a870e0813dc79cf.html" target="n" data-glyph="102,1" class="i property">Command</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Unique parent debugger identifier.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Guid</span> <a id="5e742eef25e9b7fe" href="../../R/5e742eef25e9b7fe.html" target="n" data-glyph="102,1" class="i property">ParentDebuggerId</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates instance of PSEmbeddedMonitorRunspaceInfo.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r567 r">runspace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Runspace to monitor.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r568 r">runspaceType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Type of runspace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r569 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Running command.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r570 r">parentDebuggerId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Unique parent debugger id or null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="e8c0580682e80ce0" href="../../R/e8c0580682e80ce0.html" target="n" data-glyph="72,1" class="t constructor">PSEmbeddedMonitorRunspaceInfo</a>(
            <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r567 rd" class="r567 r">runspace</span>,
            <a href="#29c6cf229c9fc955" class="t t">PSMonitorRunspaceType</a> <span id="r568 rd" class="r568 r">runspaceType</span>,
            <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r569 rd" class="r569 r">command</span>,
            <span class="i">Guid</span> <span id="r570 rd" class="r570 r">parentDebuggerId</span>)
            : <a href="#4b8ddb2df484d5d2" class="k">base</a>(<span class="r567 r">runspace</span>, <span class="r568 r">runspaceType</span>)
        {
            <a href="#8a870e0813dc79cf" class="i property">Command</a> = <span class="r569 r">command</span>;
            <a href="#5e742eef25e9b7fe" class="i property">ParentDebuggerId</a> = <span class="r570 r">parentDebuggerId</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Overrides
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a copy of this object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="#ec28e88960630f53" class="t t">PSMonitorRunspaceInfo</a> <a id="095816681d50dc2c" href="../../R/095816681d50dc2c.html" target="n" data-glyph="74,1" class="i method">Copy</a>()
        {
            <b>return</b> <b>new</b> <a href="#e8c0580682e80ce0" class="t constructor">PSEmbeddedMonitorRunspaceInfo</a>(
                <a href="#c9a2faca9dff1fec" class="i property">Runspace</a>,
                <a href="#8979cdc792041f63" class="i property">RunspaceType</a>,
                <a href="#8a870e0813dc79cf" class="i property">Command</a>,
                <a href="#5e742eef25e9b7fe" class="i property">ParentDebuggerId</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates an instance of a NestedRunspaceDebugger.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r571 r">rootDebugger</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Root debugger or null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">NestedRunspaceDebugger wrapper.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override</b> <a href="#06468cc0107c4c70" class="t t">NestedRunspaceDebugger</a> <a id="1d5b8577cc02ebfc" href="../../R/1d5b8577cc02ebfc.html" target="n" data-glyph="74,1" class="i method">CreateDebugger</a>(<a href="#9e8f0b396592e65c" class="t t">Debugger</a> <span id="r571 rd" class="r571 r">rootDebugger</span>)
        {
            <b>return</b> <b>new</b> <a href="#21d2e23eed3ee36b" class="t constructor">EmbeddedRunspaceDebugger</a>(
                <a href="#c9a2faca9dff1fec" class="i property">Runspace</a>,
                <a href="#8a870e0813dc79cf" class="i property">Command</a>,
                <span class="r571 r">rootDebugger</span>,
                <a href="#8979cdc792041f63" class="i property">RunspaceType</a>,
                <a href="#5e742eef25e9b7fe" class="i property">ParentDebuggerId</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
}
</pre></td></tr></table></div></body></html>
