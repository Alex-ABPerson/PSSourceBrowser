<!DOCTYPE html>
<html><head><title>CmdletParameterBinderController.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(4643);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/CmdletParameterBinderController.cs" target="_top">engine\CmdletParameterBinderController.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This is the interface between the CommandProcessor and the various</span>
    <span class="c">///</span><span class="c"> parameter binders required to bind parameters to a cmdlet.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="beea52684e39dd34" href="../R/beea52684e39dd34.html" target="n" data-glyph="2,0" class="t t">CmdletParameterBinderController</a> : <a href="ParameterBinderController.cs.html#9e4e49a03a43c579" class="t t">ParameterBinderController</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> tracer
 
        [<span class="i">TraceSource</span>(<span class="s">&quot;ParameterBinderController&quot;</span>, <span class="s">&quot;Controls the interaction between the command processor and the parameter binder(s).&quot;</span>)]
        <b>private static readonly</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a> <a id="620ce08548f60d6f" href="../R/620ce08548f60d6f.html" target="n" data-glyph="46,1" class="i field">s_tracer</a> = <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#697b06ec70e3c537" class="i method">GetTracer</a>(<span class="s">&quot;ParameterBinderController&quot;</span>, <span class="s">&quot;Controls the interaction between the command processor and the parameter binder(s).&quot;</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> tracer
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ctor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes the cmdlet parameter binder controller for</span>
        <span class="c">///</span><span class="c"> the specified cmdlet and engine context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">cmdlet</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The cmdlet that the parameters will be bound to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">commandMetadata</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The metadata about the cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">parameterBinder</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The default parameter binder to use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="29ae2c3d066956e2" href="../R/29ae2c3d066956e2.html" target="n" data-glyph="74,1" class="t constructor">CmdletParameterBinderController</a>(
            <a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r0 rd" class="r0 r">cmdlet</span>,
            <a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a> <span id="r1 rd" class="r1 r">commandMetadata</span>,
            <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a> <span id="r2 rd" class="r2 r">parameterBinder</span>)
            : <a href="ParameterBinderController.cs.html#7c8feb3ce277a36f" class="k">base</a>(
                <span class="r0 r">cmdlet</span>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                <span class="r0 r">cmdlet</span>.<a href="CommandBase.cs.html#a41a765d70fc9c9d" class="i property">Context</a>,
                <span class="r2 r">parameterBinder</span>)
        {
            <b>if</b> (<span class="r0 r">cmdlet</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r0 r">cmdlet</span>));
            }
 
            <b>if</b> (<span class="r1 r">commandMetadata</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r1 r">commandMetadata</span>));
            }
 
            <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a> = <span class="r0 r">cmdlet</span>;
            <a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a> = (<a href="MshCommandRuntime.cs.html#f9ebe6a3b284ab55" class="t t">MshCommandRuntime</a>)<span class="r0 r">cmdlet</span>.<a href="cmdlet.cs.html#fa3830ca3ad4b256" class="i property">CommandRuntime</a>;
            <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a> = <span class="r1 r">commandMetadata</span>;
 
            <span class="c">// Add the static parameter metadata to the bindable parameters</span>
            <span class="c">// And add them to the unbound parameters list</span>
 
            <b>if</b> (<span class="r1 r">commandMetadata</span>.<a href="CommandMetadata.cs.html#132ba2fe4030925b" class="i property">ImplementsDynamicParameters</a>)
            {
                <span class="c">// ReplaceMetadata makes a copy for us, so we can use that collection as is.</span>
                <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a> = <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#0c0422fa7104a94a" class="i method">ReplaceMetadata</a>(<span class="r1 r">commandMetadata</span>.<a href="CommandMetadata.cs.html#2949218a02f2a560" class="i property">StaticCommandParameterMetadata</a>);
            }
            <b>else</b>
            {
                <a href="ParameterBinderController.cs.html#7238478eed2bd243" class="i field">_bindableParameters</a> = <span class="r1 r">commandMetadata</span>.<a href="CommandMetadata.cs.html#2949218a02f2a560" class="i property">StaticCommandParameterMetadata</a>;
 
                <span class="c">// Must make a copy of the list because we&#39;ll modify it.</span>
                <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a> = <b>new</b> <span class="i">List</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt;(<a href="ParameterBinderController.cs.html#7238478eed2bd243" class="i field">_bindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#d586f3508cda9bf3" class="i property">BindableParameters</a>.<span class="i">Values</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ctor
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> helper_methods
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Binds the specified command-line parameters to the target.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">arguments</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameters to the command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If any parameters fail to bind,</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> If any mandatory parameters are missing.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there is an error generating the metadata for dynamic parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="5e8500fa0310cb5c" href="../R/5e8500fa0310cb5c.html" target="n" data-glyph="74,1" class="i method">BindCommandLineParameters</a>(<span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r3 rd" class="r3 r">arguments</span>)
        {
            <a href="#620ce08548f60d6f" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Argument count: {0}&quot;</span>, <span class="r3 r">arguments</span>.<span class="i">Count</span>);
 
            <a href="#50831ff19421d0e9" class="i method">BindCommandLineParametersNoValidation</a>(<span class="r3 r">arguments</span>);
 
            <span class="c">// Is pipeline input expected?</span>
            <b>bool</b> <span id="r4 rd" class="r4 r">isPipelineInputExpected</span> = !(<a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>.<a href="MshCommandRuntime.cs.html#1873a5e7c8d36fbc" class="i property">IsClosed</a> &amp;&amp; <a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>.<a href="MshCommandRuntime.cs.html#2a3306bd1f3917ef" class="i property">InputPipe</a>.<a href="Pipe.cs.html#5b6f412d40044f40" class="i property">Empty</a>);
 
            <b>int</b> <span id="r5 rd" class="r5 r">validParameterSetCount</span>;
 
            <b>if</b> (!<span class="r4 r">isPipelineInputExpected</span>)
            {
                <span class="c">// Since pipeline input is not expected, ensure that we have a single</span>
                <span class="c">// parameter set and that all the mandatory</span>
                <span class="c">// parameters for the working parameter set are specified, or prompt</span>
 
                <span class="r5 r">validParameterSetCount</span> = <a href="#57060ee3f765009b" class="i method">ValidateParameterSets</a>(<b>false</b>, <b>true</b>);
            }
            <b>else</b>
            {
                <span class="c">// Use ValidateParameterSets to get the number of valid parameter</span>
                <span class="c">// sets.</span>
 
                <span class="c">// NTRAID#Windows Out Of Band Releases-2005/11/07-923917-JonN</span>
                <span class="r5 r">validParameterSetCount</span> = <a href="#57060ee3f765009b" class="i method">ValidateParameterSets</a>(<b>true</b>, <b>false</b>);
            }
 
            <span class="c">// If the parameter set is determined and the default parameters are not used</span>
            <span class="c">// we try the default parameter binding again because it may contain some mandatory</span>
            <span class="c">// parameters</span>
            <b>if</b> (<span class="r5 r">validParameterSetCount</span> == 1 &amp;&amp; !<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
            {
                <a href="#2452b196e5609c58" class="i method">ApplyDefaultParameterBinding</a>(<span class="s">&quot;Mandatory Checking&quot;</span>, <b>false</b>);
            }
 
            <span class="c">// If there are multiple valid parameter sets and we are expecting pipeline inputs,</span>
            <span class="c">// we should filter out those parameter sets that cannot take pipeline inputs anymore.</span>
            <b>if</b> (<span class="r5 r">validParameterSetCount</span> &gt; 1 &amp;&amp; <span class="r4 r">isPipelineInputExpected</span>)
            {
                <b>uint</b> <span id="r6 rd" class="r6 r">filteredValidParameterSetFlags</span> = <a href="#3640c7988f3c087d" class="i method">FilterParameterSetsTakingNoPipelineInput</a>();
                <b>if</b> (<span class="r6 r">filteredValidParameterSetFlags</span> != <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>)
                {
                    <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> = <span class="r6 r">filteredValidParameterSetFlags</span>;
                    <span class="c">// The valid parameter set flag is narrowed down, we get the new validParameterSetCount</span>
                    <span class="r5 r">validParameterSetCount</span> = <a href="#57060ee3f765009b" class="i method">ValidateParameterSets</a>(<b>true</b>, <b>false</b>);
                }
            }
 
            <b>using</b> (<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#ff5e86462c8f4f03" class="i method">TraceScope</a>(
                <span class="s">&quot;MANDATORY PARAMETER CHECK on cmdlet [{0}]&quot;</span>,
                <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#8d0d4ac251b21d59" class="i property">Name</a>))
            {
                <b>try</b>
                {
                    <span class="c">// The missingMandatoryParameters out parameter is used for error reporting when binding from the pipeline.</span>
                    <span class="c">// We&#39;re not binding from the pipeline here, and if a mandatory non-pipeline parameter is missing, it will</span>
                    <span class="c">// be prompted for, or an exception will be raised, so we can ignore the missingMandatoryParameters out parameter.</span>
                    <span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r7 rd" class="r7 r">missingMandatoryParameters</span>;
 
                    <span class="c">// We shouldn&#39;t prompt for mandatory parameters if this command is private.</span>
                    <b>bool</b> <span id="r8 rd" class="r8 r">promptForMandatoryParameters</span> = (<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#1f4a1f38862b466a" class="i property">CommandInfo</a>.<a href="CommandInfo.cs.html#cb0c02415aeca7d5" class="i property">Visibility</a> == <a href="SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="SessionStatePublic.cs.html#74d8ba664c504563" class="i field">Public</a>);
                    <a href="#2356e11aefc013fa" class="i method">HandleUnboundMandatoryParameters</a>(<span class="r5 r">validParameterSetCount</span>, <b>true</b>, <span class="r8 r">promptForMandatoryParameters</span>, <span class="r4 r">isPipelineInputExpected</span>, <b>out</b> <span class="r7 r">missingMandatoryParameters</span>);
 
                    <b>if</b> (<a href="ParameterBinderController.cs.html#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a> <b>is</b> <a href="scriptparameterbinder.cs.html#070e81280a64ffb7" class="t t">ScriptParameterBinder</a>)
                    {
                        <a href="ParameterBinderController.cs.html#f631287a37be6f9b" class="i method">BindUnboundScriptParameters</a>();
                    }
                }
                <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r9 rd" class="r9 r">pbex</span>)
                {
                    <b>if</b> (!<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
                    {
                        <b>throw</b>;
                    }
 
                    <a href="ParameterBinderController.cs.html#a9066724fc9cbe64" class="i method">ThrowElaboratedBindingException</a>(<span class="r9 r">pbex</span>);
                }
            }
 
            <span class="c">// If there is no more expected input, ensure there is a single</span>
            <span class="c">// parameter set selected</span>
 
            <b>if</b> (!<span class="r4 r">isPipelineInputExpected</span>)
            {
                <a href="#6300366950279e18" class="i method">VerifyParameterSetSelected</a>();
            }
 
            <span class="c">// Set the prepipeline parameter set flags so that they can be restored</span>
            <span class="c">// between each pipeline object.</span>
 
            <a href="ParameterBinderController.cs.html#fadc9fd52431d28e" class="i field">_prePipelineProcessingParameterSetFlags</a> = <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Binds the unbound arguments to parameters but does not</span>
        <span class="c">///</span><span class="c"> perform mandatory parameter validation or parameter set validation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal void</b> <a id="50831ff19421d0e9" href="../R/50831ff19421d0e9.html" target="n" data-glyph="74,1" class="i method">BindCommandLineParametersNoValidation</a>(<span class="i">Collection</span>&lt;<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <span id="r10 rd" class="r10 r">arguments</span>)
        {
            <a href="runtime/CompiledScriptBlock.cs.html#20151031a0be3c24" class="k">var</a> <span id="r11 rd" class="r11 r">psCompiledScriptCmdlet</span> = <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a> <b>as</b> <a href="runtime/CompiledScriptBlock.cs.html#20151031a0be3c24" class="t t">PSScriptCmdlet</a>;
            <b>if</b> (<span class="r11 r">psCompiledScriptCmdlet</span> != <b>null</b>)
            {
                <span class="r11 r">psCompiledScriptCmdlet</span>.<a href="runtime/CompiledScriptBlock.cs.html#2d00234eb70e2d45" class="i method">PrepareForBinding</a>(<a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#0b62798bea43a39e" class="i property">CommandLineParameters</a>);
            }
 
            <a href="ParameterBinderController.cs.html#3db4667c4d45649b" class="i method">InitUnboundArguments</a>(<span class="r10 r">arguments</span>);
            <a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a> <span id="r12 rd" class="r12 r">cmdletMetadata</span> = <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>;
            <span class="c">// Clear the warningSet at the beginning.</span>
            <a href="#275643992f88c4ca" class="i field">_warningSet</a>.<span class="i">Clear</span>();
            <span class="c">// Parse $PSDefaultParameterValues to get all valid &lt;parameter, value&gt; pairs</span>
            <a href="#902abe29e4a9e389" class="i field">_allDefaultParameterValuePairs</a> = <a href="#beea52684e39dd34" class="k">this</a>.<a href="#88a399ac66fc2469" class="i method">GetDefaultParameterValuePairs</a>(<b>true</b>);
            <span class="c">// Set to false at the beginning</span>
            <a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a> = <b>false</b>;
            <span class="c">// Clear the bound default parameters at the beginning</span>
            <a href="ParameterBinderController.cs.html#1cc9eda224499cdc" class="i property">BoundDefaultParameters</a>.<span class="i">Clear</span>();
 
            <span class="c">// Reparse the arguments based on the merged metadata</span>
            <a href="ParameterBinderController.cs.html#5c35bd87e9fcd1ca" class="i method">ReparseUnboundArguments</a>();
 
            <b>using</b> (<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#ff5e86462c8f4f03" class="i method">TraceScope</a>(
                <span class="s">&quot;BIND NAMED cmd line args [{0}]&quot;</span>,
                <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#8d0d4ac251b21d59" class="i property">Name</a>))
            {
                <span class="c">// Bind the actual arguments</span>
                <a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a> = <a href="ParameterBinderController.cs.html#b49f6e6866858d41" class="i method">BindNamedParameters</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>);
            }
 
            <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r13 rd" class="r13 r">reportedBindingException</span>;
            <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r14 rd" class="r14 r">currentBindingException</span>;
 
            <b>using</b> (<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#ff5e86462c8f4f03" class="i method">TraceScope</a>(
                <span class="s">&quot;BIND POSITIONAL cmd line args [{0}]&quot;</span>,
                <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#8d0d4ac251b21d59" class="i property">Name</a>))
            {
                <span class="c">// Now that we know the parameter set, bind the positional parameters</span>
                <a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a> =
                    <a href="ParameterBinderController.cs.html#9078ab3976c11a31" class="i method">BindPositionalParameters</a>(
                        <a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>,
                        <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>,
                        <span class="r12 r">cmdletMetadata</span>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a>,
                        <b>out</b> <span class="r14 r">currentBindingException</span>);
 
                <span class="r13 r">reportedBindingException</span> = <span class="r14 r">currentBindingException</span>;
            }
 
            <span class="c">// Try applying the default parameter binding after POSITIONAL BIND so that the default parameter</span>
            <span class="c">// values can influence the parameter set selection earlier than the default parameter set.</span>
            <a href="#2452b196e5609c58" class="i method">ApplyDefaultParameterBinding</a>(<span class="s">&quot;POSITIONAL BIND&quot;</span>, <b>false</b>);
 
            <span class="c">// We need to make sure there is at least one valid parameter set. Its</span>
            <span class="c">// OK to allow more than one as long as one of them takes pipeline input.</span>
 
            <span class="c">// NTRAID#Windows Out Of Band Releases-2006/02/14-928660-JonN</span>
            <span class="c">// Pipeline input fails to bind to pipeline enabled parameter</span>
            <span class="c">// second parameter changed from true to false</span>
            <a href="#57060ee3f765009b" class="i method">ValidateParameterSets</a>(<b>true</b>, <b>false</b>);
 
            <span class="c">// Always get the dynamic parameters as there may be mandatory parameters there</span>
 
            <span class="c">// Now try binding the dynamic parameters</span>
            <a href="#7433484d5f721b08" class="i method">HandleCommandLineDynamicParameters</a>(<b>out</b> <span class="r14 r">currentBindingException</span>);
 
            <span class="c">// Try binding the default parameters again. After dynamic binding, new parameter metadata are</span>
            <span class="c">// included, so it&#39;s possible a previously unsuccessful binding will succeed.</span>
            <a href="#2452b196e5609c58" class="i method">ApplyDefaultParameterBinding</a>(<span class="s">&quot;DYNAMIC BIND&quot;</span>, <b>true</b>);
 
            <span class="c">// If this generated an exception (but we didn&#39;t have one from the non-dynamic</span>
            <span class="c">// parameters, report on this one.</span>
            <b>if</b> (<span class="r13 r">reportedBindingException</span> == <b>null</b>)
                <span class="r13 r">reportedBindingException</span> = <span class="r14 r">currentBindingException</span>;
 
            <span class="c">// If the cmdlet implements a ValueFromRemainingArguments parameter (VarArgs)</span>
            <span class="c">// bind the unbound arguments to that parameter.</span>
            <a href="#b878eb3f987f0abb" class="i method">HandleRemainingArguments</a>();
 
            <a href="#9815c4ef699f2550" class="i method">VerifyArgumentsProcessed</a>(<span class="r13 r">reportedBindingException</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process all valid parameter sets, and filter out those that don&#39;t take any pipeline input.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The new valid parameter set flags</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private uint</b> <a id="3640c7988f3c087d" href="../R/3640c7988f3c087d.html" target="n" data-glyph="76,1" class="i method">FilterParameterSetsTakingNoPipelineInput</a>()
        {
            <b>uint</b> <span id="r15 rd" class="r15 r">parameterSetsTakingPipeInput</span> = 0;
            <b>bool</b> <span id="r16 rd" class="r16 r">findPipeParameterInAllSets</span> = <b>false</b>;
 
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="#6c106f272135c12d" class="t t">DelayedScriptBlockArgument</a>&gt; <span id="r17 rd" class="r17 r">entry</span> <b>in</b> <a href="#1c8d945f0156df74" class="i field">_delayBindScriptBlocks</a>)
            {
                <span class="r15 r">parameterSetsTakingPipeInput</span> |= <span class="r17 r">entry</span>.<span class="i">Key</span>.<span class="i">Parameter</span>.<span class="i">ParameterSetFlags</span>;
            }
 
            <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r18 rd" class="r18 r">parameter</span> <b>in</b> <a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>)
            {
                <span class="c">// If a parameter doesn&#39;t take pipeline input at all, we can skip it</span>
                <b>if</b> (!<span class="r18 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#ad80d097afeb91c4" class="i property">IsPipelineParameterInSomeParameterSet</a>)
                {
                    <b>continue</b>;
                }
 
                <b>var</b> <span id="r19 rd" class="r19 r">matchingParameterSetMetadata</span> =
                    <span class="r18 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#6734aa34600c1096" class="i method">GetMatchingParameterSetData</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>);
 
                <b>foreach</b> (<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r20 rd" class="r20 r">parameterSetMetadata</span> <b>in</b> <span class="r19 r">matchingParameterSetMetadata</span>)
                {
                    <b>if</b> (<span class="r20 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#6b00e8f2cc8f5221" class="i property">ValueFromPipeline</a> || <span class="r20 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#9d3ceb11c1e2558a" class="i property">ValueFromPipelineByPropertyName</a>)
                    {
                        <b>if</b> (<span class="r20 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#f78c0b8e1f2ce3b8" class="i property">ParameterSetFlag</a> == 0 &amp;&amp; <span class="r20 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#4410808f4575d589" class="i property">IsInAllSets</a>)
                        {
                            <span class="c">// The parameter takes pipeline input and is in all sets, we don&#39;t change the _currentParameterSetFlag</span>
                            <span class="r15 r">parameterSetsTakingPipeInput</span> = 0;
                            <span class="r16 r">findPipeParameterInAllSets</span> = <b>true</b>;
                            <b>break</b>;
                        }
                        <b>else</b>
                        {
                            <span class="r15 r">parameterSetsTakingPipeInput</span> |= <span class="r20 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#f78c0b8e1f2ce3b8" class="i property">ParameterSetFlag</a>;
                        }
                    }
                }
 
                <b>if</b> (<span class="r16 r">findPipeParameterInAllSets</span>)
                    <b>break</b>;
            }
 
            <span class="c">// If parameterSetsTakingPipeInput is 0, then no parameter set from the _currentParameterSetFlag can take piped objects.</span>
            <span class="c">// Then we just leave what it was, and the pipeline binding deal with the error later</span>
            <b>if</b> (<span class="r15 r">parameterSetsTakingPipeInput</span> != 0)
                <b>return</b> <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> &amp; <span class="r15 r">parameterSetsTakingPipeInput</span>;
            <b>else</b>
                <b>return</b> <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Apply the binding for the default parameter defined by the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r21 r">bindingStage</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Dictate which binding stage this default binding happens</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">isDynamic</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Special operation needed if the default binding happens at the dynamic binding stage</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private void</b> <a id="2452b196e5609c58" href="../R/2452b196e5609c58.html" target="n" data-glyph="76,1" class="i method">ApplyDefaultParameterBinding</a>(<b>string</b> <span id="r21 rd" class="r21 r">bindingStage</span>, <b>bool</b> <span id="r22 rd" class="r22 r">isDynamic</span>)
        {
            <b>if</b> (!<a href="#c430d3d1b818934d" class="i field">_useDefaultParameterBinding</a>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r22 r">isDynamic</span>)
            {
                <span class="c">// Get user defined default parameter value pairs again, so that the</span>
                <span class="c">// dynamic parameter value pairs could be involved.</span>
                <a href="#902abe29e4a9e389" class="i field">_allDefaultParameterValuePairs</a> = <a href="#88a399ac66fc2469" class="i method">GetDefaultParameterValuePairs</a>(<b>false</b>);
            }
 
            <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <b>object</b>&gt; <span id="r23 rd" class="r23 r">qualifiedParameterValuePairs</span> = <a href="#b05a2c822ac3d41c" class="i method">GetQualifiedParameterValuePairs</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <a href="#902abe29e4a9e389" class="i field">_allDefaultParameterValuePairs</a>);
            <b>if</b> (<span class="r23 r">qualifiedParameterValuePairs</span> != <b>null</b>)
            {
                <b>bool</b> <span id="r24 rd" class="r24 r">isSuccess</span> = <b>false</b>;
                <b>using</b> (<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#3e3de94a643f35de" class="i method">TraceScope</a>(
                    <span class="s">&quot;BIND DEFAULT &lt;parameter, value&gt; pairs after [{0}] for [{1}]&quot;</span>,
                    <span class="r21 r">bindingStage</span>, <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#8d0d4ac251b21d59" class="i property">Name</a>))
                {
                    <span class="r24 r">isSuccess</span> = <a href="#d67729b9b1229346" class="i method">BindDefaultParameters</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <span class="r23 r">qualifiedParameterValuePairs</span>);
                    <b>if</b> (<span class="r24 r">isSuccess</span> &amp;&amp; !<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
                    {
                        <a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a> = <b>true</b>;
                    }
                }
 
                <a href="#620ce08548f60d6f" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#49bf988885074437" class="i method">WriteLine</a>(<span class="s">&quot;BIND DEFAULT after [{0}] result [{1}]&quot;</span>, <span class="r21 r">bindingStage</span>, <span class="r24 r">isSuccess</span>);
            }
 
            <b>return</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Bind the default parameter value pairs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r25 r">validParameterSetFlag</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ValidParameterSetFlag.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r26 r">defaultParameterValues</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Default value pairs.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if there is at least one default parameter bound successfully</span>
        <span class="c">///</span><span class="c"> false if there is no default parameter bound successfully</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="d67729b9b1229346" href="../R/d67729b9b1229346.html" target="n" data-glyph="76,1" class="i method">BindDefaultParameters</a>(<b>uint</b> <span id="r25 rd" class="r25 r">validParameterSetFlag</span>, <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <b>object</b>&gt; <span id="r26 rd" class="r26 r">defaultParameterValues</span>)
        {
            <b>bool</b> <span id="r27 rd" class="r27 r">ret</span> = <b>false</b>;
            <b>foreach</b> (<b>var</b> <span id="r28 rd" class="r28 r">pair</span> <b>in</b> <span class="r26 r">defaultParameterValues</span>)
            {
                <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r29 rd" class="r29 r">parameter</span> = <span class="r28 r">pair</span>.<span class="i">Key</span>;
                <b>object</b> <span id="r30 rd" class="r30 r">argumentValue</span> = <span class="r28 r">pair</span>.<span class="i">Value</span>;
                <b>string</b> <span id="r31 rd" class="r31 r">parameterName</span> = <span class="r29 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>;
 
                <b>try</b>
                {
                    <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r32 rd" class="r32 r">scriptBlockArg</span> = <span class="r30 r">argumentValue</span> <b>as</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>;
                    <b>if</b> (<span class="r32 r">scriptBlockArg</span> != <b>null</b>)
                    {
                        <span class="c">// Get the current binding state, and pass it to the ScriptBlock as the argument</span>
                        <span class="c">// The &#39;arg&#39; includes HashSet properties &#39;BoundParameters&#39;, &#39;BoundPositionalParameters&#39;,</span>
                        <span class="c">// &#39;BoundDefaultParameters&#39;, and &#39;LastBindingStage&#39;. So the user can set value</span>
                        <span class="c">// to a parameter depending on the current binding state.</span>
                        <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r33 rd" class="r33 r">arg</span> = <a href="#fc9f02f12dc73b49" class="i method">WrapBindingState</a>();
                        <span class="i">Collection</span>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r34 rd" class="r34 r">results</span> = <span class="r32 r">scriptBlockArg</span>.<a href="lang/scriptblock.cs.html#3f6b9284eb08b880" class="i method">Invoke</a>(<span class="r33 r">arg</span>);
                        <b>if</b> (<span class="r34 r">results</span> == <b>null</b> || <span class="r34 r">results</span>.<span class="i">Count</span> == 0)
                        {
                            <b>continue</b>;
                        }
                        <b>else</b> <b>if</b> (<span class="r34 r">results</span>.<span class="i">Count</span> == 1)
                        {
                            <span class="r30 r">argumentValue</span> = <span class="r34 r">results</span>[0];
                        }
                        <b>else</b>
                        {
                            <span class="r30 r">argumentValue</span> = <span class="r34 r">results</span>;
                        }
                    }
 
                    <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r35 rd" class="r35 r">bindableArgument</span> =
                        <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>(
                           <span class="c">/*parameterAst*/</span><b>null</b>, <span class="r31 r">parameterName</span>, <span class="s">&quot;-&quot;</span> + <span class="r31 r">parameterName</span> + <span class="s">&quot;:&quot;</span>,
                           <span class="c">/*argumentAst*/</span><b>null</b>, <span class="r30 r">argumentValue</span>, <b>false</b>);
 
                    <b>bool</b> <span id="r36 rd" class="r36 r">bindResult</span> =
                            <a href="#1304cfc1ae549ad4" class="i method">BindParameter</a>(
                                <span class="r25 r">validParameterSetFlag</span>,
                                <span class="r35 r">bindableArgument</span>,
                                <span class="r29 r">parameter</span>,
                                <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a> | <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#31ebbff231d00d8c" class="i field">DelayBindScriptBlock</a>);
 
                    <b>if</b> (<span class="r36 r">bindResult</span> &amp;&amp; !<span class="r27 r">ret</span>)
                    {
                        <span class="r27 r">ret</span> = <b>true</b>;
                    }
 
                    <b>if</b> (<span class="r36 r">bindResult</span>)
                    {
                        <a href="ParameterBinderController.cs.html#1cc9eda224499cdc" class="i property">BoundDefaultParameters</a>.<span class="i">Add</span>(<span class="r31 r">parameterName</span>);
                    }
                }
                <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r37 rd" class="r37 r">ex</span>)
                {
                    <span class="c">// We don&#39;t want the failures in default binding affect the command line binding,</span>
                    <span class="c">// so we write out a warning and ignore this binding failure</span>
                    <b>if</b> (!<a href="#275643992f88c4ca" class="i field">_warningSet</a>.<span class="i">Contains</span>(<a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#8d0d4ac251b21d59" class="i property">Name</a> + <a href="#c3f881c8e5d649fb" class="i field">Separator</a> + <span class="r31 r">parameterName</span>))
                    {
                        <b>string</b> <span id="r38 rd" class="r38 r">message</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                            <span class="i">ParameterBinderStrings</span>.<span class="i">FailToBindDefaultParameter</span>,
                            <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="LanguagePrimitives.cs.html#cf665fbdc4612d9d" class="i method">IsNull</a>(<span class="r30 r">argumentValue</span>) ? <span class="s">&quot;null&quot;</span> : <span class="r30 r">argumentValue</span>.<span class="i">ToString</span>(),
                            <span class="r31 r">parameterName</span>, <span class="r37 r">ex</span>.<a href="../utils/ParameterBinderExceptions.cs.html#ddf6dbf1298aeb68" class="i property">Message</a>);
                        <a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>.<a href="MshCommandRuntime.cs.html#887abd71350c6e4e" class="i method">WriteWarning</a>(<span class="r38 r">message</span>);
                        <a href="#275643992f88c4ca" class="i field">_warningSet</a>.<span class="i">Add</span>(<a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#8d0d4ac251b21d59" class="i property">Name</a> + <a href="#c3f881c8e5d649fb" class="i field">Separator</a> + <span class="r31 r">parameterName</span>);
                    }
 
                    <b>continue</b>;
                }
            }
 
            <b>return</b> <span class="r27 r">ret</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Wrap up current binding state to provide more information to the user.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="fc9f02f12dc73b49" href="../R/fc9f02f12dc73b49.html" target="n" data-glyph="76,1" class="i method">WrapBindingState</a>()
        {
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r39 rd" class="r39 r">boundParameterNames</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r40 rd" class="r40 r">boundPositionalParameterNames</span> =
                <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>.<a href="ParameterBinderBase.cs.html#4555288f0b3927cb" class="i property">CommandLineParameters</a>.<a href="ParameterBinderBase.cs.html#7ee86d5b14016915" class="i method">CopyBoundPositionalParameters</a>();
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r41 rd" class="r41 r">boundDefaultParameterNames</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <b>foreach</b> (<b>string</b> <span id="r42 rd" class="r42 r">paramName</span> <b>in</b> <a href="ParameterBinderController.cs.html#03396016088be5fe" class="i property">BoundParameters</a>.<span class="i">Keys</span>)
            {
                <span class="r39 r">boundParameterNames</span>.<span class="i">Add</span>(<span class="r42 r">paramName</span>);
            }
 
            <b>foreach</b> (<b>string</b> <span id="r43 rd" class="r43 r">paramName</span> <b>in</b> <a href="ParameterBinderController.cs.html#1cc9eda224499cdc" class="i property">BoundDefaultParameters</a>)
            {
                <span class="r41 r">boundDefaultParameterNames</span>.<span class="i">Add</span>(<span class="r43 r">paramName</span>);
            }
 
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r44 rd" class="r44 r">result</span> = <b>new</b> <a href="MshObject.cs.html#cbbe437e20e8b8b8" class="t constructor">PSObject</a>();
            <span class="r44 r">result</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;BoundParameters&quot;</span>, <span class="r39 r">boundParameterNames</span>));
            <span class="r44 r">result</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;BoundPositionalParameters&quot;</span>, <span class="r40 r">boundPositionalParameterNames</span>));
            <span class="r44 r">result</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<span class="s">&quot;BoundDefaultParameters&quot;</span>, <span class="r41 r">boundDefaultParameterNames</span>));
 
            <b>return</b> <span class="r44 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get all qualified default parameter value pairs based on the</span>
        <span class="c">///</span><span class="c"> given currentParameterSetFlag.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r45 r">currentParameterSetFlag</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r46 r">availableParameterValuePairs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Null if no qualified pair found.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <b>object</b>&gt; <a id="b05a2c822ac3d41c" href="../R/b05a2c822ac3d41c.html" target="n" data-glyph="76,1" class="i method">GetQualifiedParameterValuePairs</a>(
            <b>uint</b> <span id="r45 rd" class="r45 r">currentParameterSetFlag</span>,
            <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <b>object</b>&gt; <span id="r46 rd" class="r46 r">availableParameterValuePairs</span>)
        {
            <b>if</b> (<span class="r46 r">availableParameterValuePairs</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <b>object</b>&gt; <span id="r47 rd" class="r47 r">result</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <b>object</b>&gt;();
 
            <b>uint</b> <span id="r48 rd" class="r48 r">possibleParameterFlag</span> = <b>uint</b>.<span class="i">MaxValue</span>;
            <b>foreach</b> (<b>var</b> <span id="r49 rd" class="r49 r">pair</span> <b>in</b> <span class="r46 r">availableParameterValuePairs</span>)
            {
                <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r50 rd" class="r50 r">param</span> = <span class="r49 r">pair</span>.<span class="i">Key</span>;
                <b>if</b> ((<span class="r50 r">param</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a> &amp; <span class="r45 r">currentParameterSetFlag</span>) == 0 &amp;&amp; !<span class="r50 r">param</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#28fd649ec0fa1b52" class="i property">IsInAllSets</a>)
                {
                    <b>continue</b>;
                }
 
                <b>if</b> (<a href="ParameterBinderController.cs.html#4893dd5e52f9f477" class="i property">BoundArguments</a>.<span class="i">ContainsKey</span>(<span class="r50 r">param</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                {
                    <b>continue</b>;
                }
 
                <span class="c">// check if this param&#39;s set conflicts with other possible params.</span>
                <b>if</b> (<span class="r50 r">param</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a> != 0)
                {
                    <span class="r48 r">possibleParameterFlag</span> &amp;= <span class="r50 r">param</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a>;
                    <b>if</b> (<span class="r48 r">possibleParameterFlag</span> == 0)
                    {
                        <b>return</b> <b>null</b>;
                    }
                }
 
                <span class="r47 r">result</span>.<span class="i">Add</span>(<span class="r50 r">param</span>, <span class="r49 r">pair</span>.<span class="i">Value</span>);
            }
 
            <b>if</b> (<span class="r47 r">result</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>return</b> <span class="r47 r">result</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the aliases of the current cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="4ff3e9515d95d139" href="../R/4ff3e9515d95d139.html" target="n" data-glyph="76,1" class="i method">GetAliasOfCurrentCmdlet</a>()
        {
            <b>var</b> <span id="r51 rd" class="r51 r">results</span> = <a href="ParameterBinderController.cs.html#ce2a3e6f14a932c8" class="i property">Context</a>.<a href="ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="SessionStatePublic.cs.html#9be0303086619111" class="i property">Internal</a>.<a href="SessionStateAliasAPIs.cs.html#70eb735f337a1bc3" class="i method">GetAliasesByCommandName</a>(<a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#8d0d4ac251b21d59" class="i property">Name</a>).<span class="i">ToList</span>();
 
            <b>return</b> <span class="r51 r">results</span>.<span class="i">Count</span> &gt; 0 ? <span class="r51 r">results</span> : <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if the passed-in aliasName matches an alias name in _aliasList.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r52 r">aliasName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="0e8556dd471f573a" href="../R/0e8556dd471f573a.html" target="n" data-glyph="76,1" class="i method">MatchAnyAlias</a>(<b>string</b> <span id="r52 rd" class="r52 r">aliasName</span>)
        {
            <b>if</b> (<a href="#0d51d1c8f0bbdc50" class="i field">_aliasList</a> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>bool</b> <span id="r53 rd" class="r53 r">result</span> = <b>false</b>;
            <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r54 rd" class="r54 r">aliasPattern</span> = <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r52 r">aliasName</span>, <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <b>foreach</b> (<b>string</b> <span id="r55 rd" class="r55 r">alias</span> <b>in</b> <a href="#0d51d1c8f0bbdc50" class="i field">_aliasList</a>)
            {
                <b>if</b> (<span class="r54 r">aliasPattern</span>.<a href="regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r55 r">alias</span>))
                {
                    <span class="r53 r">result</span> = <b>true</b>;
                    <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r53 r">result</span>;
        }
 
        <b>internal</b> <span class="i">IDictionary</span> <a id="28236370865e2a7b" href="../R/28236370865e2a7b.html" target="n" data-glyph="104,1" class="i property">DefaultParameterValues</a> { <b>get</b>; <b>set</b>; }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get all available default parameter value pairs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Return the available parameter value pairs. Otherwise return null.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <b>object</b>&gt; <a id="88a399ac66fc2469" href="../R/88a399ac66fc2469.html" target="n" data-glyph="76,1" class="i method">GetDefaultParameterValuePairs</a>(<b>bool</b> <span id="r56 rd" class="r56 r">needToGetAlias</span>)
        {
            <b>if</b> (<a href="#28236370865e2a7b" class="i property">DefaultParameterValues</a> == <b>null</b>)
            {
                <a href="#c430d3d1b818934d" class="i field">_useDefaultParameterBinding</a> = <b>false</b>;
                <b>return</b> <b>null</b>;
            }
 
            <b>var</b> <span id="r57 rd" class="r57 r">availablePairs</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <b>object</b>&gt;();
 
            <b>if</b> (<span class="r56 r">needToGetAlias</span> &amp;&amp; <a href="#28236370865e2a7b" class="i property">DefaultParameterValues</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// Get all aliases of the current cmdlet</span>
                <a href="#0d51d1c8f0bbdc50" class="i field">_aliasList</a> = <a href="#4ff3e9515d95d139" class="i method">GetAliasOfCurrentCmdlet</a>();
            }
 
            <span class="c">// Set flag to true by default</span>
            <a href="#c430d3d1b818934d" class="i field">_useDefaultParameterBinding</a> = <b>true</b>;
 
            <b>string</b> <span id="r58 rd" class="r58 r">currentCmdletName</span> = <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#8d0d4ac251b21d59" class="i property">Name</a>;
 
            <span class="i">IDictionary</span>&lt;<b>string</b>, <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r59 rd" class="r59 r">bindableParameters</span> = <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#d586f3508cda9bf3" class="i property">BindableParameters</a>;
            <span class="i">IDictionary</span>&lt;<b>string</b>, <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r60 rd" class="r60 r">bindableAlias</span> = <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#8f45b2ddfe27a956" class="i property">AliasedParameters</a>;
 
            <span class="c">// Contains parameters that are set with different values by settings in $PSDefaultParameterValues.</span>
            <span class="c">// We should ignore those settings and write out a warning</span>
            <b>var</b> <span id="r61 rd" class="r61 r">parametersToRemove</span> = <b>new</b> <span class="i">HashSet</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt;();
            <b>var</b> <span id="r62 rd" class="r62 r">wildcardDefault</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;();
            <span class="c">// Contains keys that are in bad format. For every bad format key, we should write out a warning message</span>
            <span class="c">// the first time we encounter it, and remove it from the $PSDefaultParameterValues</span>
            <b>var</b> <span id="r63 rd" class="r63 r">keysToRemove</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
 
            <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r64 rd" class="r64 r">entry</span> <b>in</b> <a href="#28236370865e2a7b" class="i property">DefaultParameterValues</a>)
            {
                <b>if</b> (!(<span class="r64 r">entry</span>.<span class="i">Key</span> <b>is string</b> <span id="r65 rd" class="r65 r">key</span>))
                {
                    <b>continue</b>;
                }
 
                <span class="r65 r">key</span> = <span class="r65 r">key</span>.<span class="i">Trim</span>();
                <b>string</b> <span id="r66 rd" class="r66 r">cmdletName</span> = <b>null</b>;
                <b>string</b> <span id="r67 rd" class="r67 r">parameterName</span> = <b>null</b>;
 
                <span class="c">// The key is not in valid format</span>
                <b>if</b> (!<a href="#4c03f64470bcc0c2" class="t t">DefaultParameterDictionary</a>.<a href="#6c765456ee892eab" class="i method">CheckKeyIsValid</a>(<span class="r65 r">key</span>, <b>ref</b> <span class="r66 r">cmdletName</span>, <b>ref</b> <span class="r67 r">parameterName</span>))
                {
                    <b>if</b> (<span class="r65 r">key</span>.<span class="i">Equals</span>(<span class="s">&quot;Disabled&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                        <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">IsTrue</span>(<span class="r64 r">entry</span>.<span class="i">Value</span>))
                    {
                        <a href="#c430d3d1b818934d" class="i field">_useDefaultParameterBinding</a> = <b>false</b>;
                        <b>return</b> <b>null</b>;
                    }
                    <span class="c">// Write out a warning message if the key is not &#39;Disabled&#39;</span>
                    <b>if</b> (!<span class="r65 r">key</span>.<span class="i">Equals</span>(<span class="s">&quot;Disabled&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r63 r">keysToRemove</span>.<span class="i">Add</span>(<span class="r64 r">entry</span>.<span class="i">Key</span>);
                    }
 
                    <b>continue</b>;
                }
 
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r66 r">cmdletName</span> != <b>null</b> &amp;&amp; <span class="r67 r">parameterName</span> != <b>null</b>, <span class="s">&quot;The cmdletName and parameterName should be set in CheckKeyIsValid&quot;</span>);
 
                <b>if</b> (<a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r65 r">key</span>))
                {
                    <span class="r62 r">wildcardDefault</span>.<span class="i">Add</span>(<span class="r66 r">cmdletName</span> + <a href="#c3f881c8e5d649fb" class="i field">Separator</a> + <span class="r67 r">parameterName</span>, <span class="r64 r">entry</span>.<span class="i">Value</span>);
                    <b>continue</b>;
                }
 
                <span class="c">// Continue to process this entry only if the specified cmdletName is the name</span>
                <span class="c">// of the current cmdlet, or is an alias name of the current cmdlet.</span>
                <b>if</b> (!<span class="r66 r">cmdletName</span>.<span class="i">Equals</span>(<span class="r58 r">currentCmdletName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp; !<a href="#0e8556dd471f573a" class="i method">MatchAnyAlias</a>(<span class="r66 r">cmdletName</span>))
                {
                    <b>continue</b>;
                }
 
                <span class="i">GetDefaultParameterValuePairsHelper</span>(
                    <span class="r66 r">cmdletName</span>, <span class="r67 r">parameterName</span>, <span class="r64 r">entry</span>.<span class="i">Value</span>,
                    <span class="r59 r">bindableParameters</span>, <span class="r60 r">bindableAlias</span>,
                    <span class="r57 r">availablePairs</span>, <span class="r61 r">parametersToRemove</span>);
            }
 
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <b>object</b>&gt; <span id="r68 rd" class="r68 r">wildcard</span> <b>in</b> <span class="r62 r">wildcardDefault</span>)
            {
                <b>string</b> <span id="r69 rd" class="r69 r">key</span> = <span class="r68 r">wildcard</span>.<span class="i">Key</span>;
 
                <b>string</b> <span id="r70 rd" class="r70 r">cmdletName</span> = <span class="r69 r">key</span>.<span class="i">Substring</span>(0, <span class="r69 r">key</span>.<span class="i">IndexOf</span>(<a href="#c3f881c8e5d649fb" class="i field">Separator</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
                <b>string</b> <span id="r71 rd" class="r71 r">parameterName</span> = <span class="r69 r">key</span>.<span class="i">Substring</span>(<span class="r69 r">key</span>.<span class="i">IndexOf</span>(<a href="#c3f881c8e5d649fb" class="i field">Separator</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) + <a href="#c3f881c8e5d649fb" class="i field">Separator</a>.<span class="i">Length</span>);
 
                <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r72 rd" class="r72 r">cmdletPattern</span> = <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r70 r">cmdletName</span>, <a href="regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                <span class="c">// Continue to process this entry only if the cmdletName matches the name of the current</span>
                <span class="c">// cmdlet, or matches an alias name of the current cmdlet</span>
                <b>if</b> (!<span class="r72 r">cmdletPattern</span>.<a href="regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r58 r">currentCmdletName</span>) &amp;&amp; !<a href="#0e8556dd471f573a" class="i method">MatchAnyAlias</a>(<span class="r70 r">cmdletName</span>))
                {
                    <b>continue</b>;
                }
 
                <b>if</b> (!<a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r71 r">parameterName</span>))
                {
                    <span class="i">GetDefaultParameterValuePairsHelper</span>(
                        <span class="r70 r">cmdletName</span>, <span class="r71 r">parameterName</span>, <span class="r68 r">wildcard</span>.<span class="i">Value</span>,
                        <span class="r59 r">bindableParameters</span>, <span class="r60 r">bindableAlias</span>,
                        <span class="r57 r">availablePairs</span>, <span class="r61 r">parametersToRemove</span>);
 
                    <b>continue</b>;
                }
 
                <a href="regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r73 rd" class="r73 r">parameterPattern</span> = <a href="MshMemberInfo.cs.html#e4629c736a80cf0f" class="t t">MemberMatch</a>.<a href="MshMemberInfo.cs.html#06d7a6508758ced6" class="i method">GetNamePattern</a>(<span class="r71 r">parameterName</span>);
                <b>var</b> <span id="r74 rd" class="r74 r">matches</span> = <b>new</b> <span class="i">List</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt;();
 
                <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r75 rd" class="r75 r">entry</span> <b>in</b> <span class="r59 r">bindableParameters</span>)
                {
                    <b>if</b> (<span class="r73 r">parameterPattern</span>.<span class="i">IsMatch</span>(<span class="r75 r">entry</span>.<span class="i">Key</span>))
                    {
                        <span class="r74 r">matches</span>.<span class="i">Add</span>(<span class="r75 r">entry</span>.<span class="i">Value</span>);
                    }
                }
 
                <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r76 rd" class="r76 r">entry</span> <b>in</b> <span class="r60 r">bindableAlias</span>)
                {
                    <b>if</b> (<span class="r73 r">parameterPattern</span>.<span class="i">IsMatch</span>(<span class="r76 r">entry</span>.<span class="i">Key</span>))
                    {
                        <span class="r74 r">matches</span>.<span class="i">Add</span>(<span class="r76 r">entry</span>.<span class="i">Value</span>);
                    }
                }
 
                <b>if</b> (<span class="r74 r">matches</span>.<span class="i">Count</span> &gt; 1)
                {
                    <span class="c">// The parameterPattern matches more than one parameters, so we write out a warning message and ignore this setting</span>
                    <b>if</b> (!<a href="#275643992f88c4ca" class="i field">_warningSet</a>.<span class="i">Contains</span>(<span class="r70 r">cmdletName</span> + <a href="#c3f881c8e5d649fb" class="i field">Separator</a> + <span class="r71 r">parameterName</span>))
                    {
                        <a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>.<span class="i">WriteWarning</span>(
                            <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="i">ParameterBinderStrings</span>.<span class="i">MultipleParametersMatched</span>, <span class="r71 r">parameterName</span>));
                        <a href="#275643992f88c4ca" class="i field">_warningSet</a>.<span class="i">Add</span>(<span class="r70 r">cmdletName</span> + <a href="#c3f881c8e5d649fb" class="i field">Separator</a> + <span class="r71 r">parameterName</span>);
                    }
 
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r74 r">matches</span>.<span class="i">Count</span> == 1)
                {
                    <b>if</b> (!<span class="r57 r">availablePairs</span>.<span class="i">ContainsKey</span>(<span class="r74 r">matches</span>[0]))
                    {
                        <span class="r57 r">availablePairs</span>.<span class="i">Add</span>(<span class="r74 r">matches</span>[0], <span class="r68 r">wildcard</span>.<span class="i">Value</span>);
                        <b>continue</b>;
                    }
 
                    <b>if</b> (!<span class="r68 r">wildcard</span>.<span class="i">Value</span>.<span class="i">Equals</span>(<span class="r57 r">availablePairs</span>[<span class="r74 r">matches</span>[0]]))
                    {
                        <b>if</b> (!<a href="#275643992f88c4ca" class="i field">_warningSet</a>.<span class="i">Contains</span>(<span class="r70 r">cmdletName</span> + <a href="#c3f881c8e5d649fb" class="i field">Separator</a> + <span class="r71 r">parameterName</span>))
                        {
                            <a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>.<span class="i">WriteWarning</span>(
                                <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="i">ParameterBinderStrings</span>.<span class="i">DifferentValuesAssignedToSingleParameter</span>, <span class="r71 r">parameterName</span>));
                            <a href="#275643992f88c4ca" class="i field">_warningSet</a>.<span class="i">Add</span>(<span class="r70 r">cmdletName</span> + <a href="#c3f881c8e5d649fb" class="i field">Separator</a> + <span class="r71 r">parameterName</span>);
                        }
 
                        <span class="r61 r">parametersToRemove</span>.<span class="i">Add</span>(<span class="r74 r">matches</span>[0]);
                    }
                }
            }
 
            <b>if</b> (<span class="r63 r">keysToRemove</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>var</b> <span id="r77 rd" class="r77 r">keysInError</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <b>foreach</b> (<b>object</b> <span id="r78 rd" class="r78 r">badFormatKey</span> <b>in</b> <span class="r63 r">keysToRemove</span>)
                {
                    <b>if</b> (<a href="#28236370865e2a7b" class="i property">DefaultParameterValues</a>.<span class="i">Contains</span>(<span class="r78 r">badFormatKey</span>))
                        <a href="#28236370865e2a7b" class="i property">DefaultParameterValues</a>.<span class="i">Remove</span>(<span class="r78 r">badFormatKey</span>);
 
                    <span class="r77 r">keysInError</span>.<span class="i">Append</span>(<span class="r78 r">badFormatKey</span>.<span class="i">ToString</span>() + <span class="s">&quot;, &quot;</span>);
                }
 
                <span class="r77 r">keysInError</span>.<span class="i">Remove</span>(<span class="r77 r">keysInError</span>.<span class="i">Length</span> - 2, 2);
                <b>var</b> <span id="r79 rd" class="r79 r">multipleKeys</span> = <span class="r63 r">keysToRemove</span>.<span class="i">Count</span> &gt; 1;
                <b>string</b> <span id="r80 rd" class="r80 r">formatString</span> = <span class="r79 r">multipleKeys</span>
                                            ? <span class="i">ParameterBinderStrings</span>.<span class="i">MultipleKeysInBadFormat</span>
                                            : <span class="i">ParameterBinderStrings</span>.<span class="i">SingleKeyInBadFormat</span>;
                <a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>.<span class="i">WriteWarning</span>(
                    <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="r80 r">formatString</span>, <span class="r77 r">keysInError</span>));
            }
 
            <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r81 rd" class="r81 r">param</span> <b>in</b> <span class="r61 r">parametersToRemove</span>)
            {
                <span class="r57 r">availablePairs</span>.<span class="i">Remove</span>(<span class="r81 r">param</span>);
            }
 
            <b>if</b> (<span class="r57 r">availablePairs</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>return</b> <span class="r57 r">availablePairs</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A helper method for GetDefaultParameterValuePairs.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">cmdletName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">paramName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">paramValue</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r85 r">bindableParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">bindableAlias</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r87 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r88 r">parametersToRemove</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="a640dc49dd19393e" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetDefaultParameterValuePairsHelper</a>(
            <b>string</b> <span id="r82 rd" class="r82 r">cmdletName</span>, <b>string</b> <span id="r83 rd" class="r83 r">paramName</span>, <b>object</b> <span id="r84 rd" class="r84 r">paramValue</span>,
            <span class="i">IDictionary</span>&lt;<b>string</b>, <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r85 rd" class="r85 r">bindableParameters</span>,
            <span class="i">IDictionary</span>&lt;<b>string</b>, <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r86 rd" class="r86 r">bindableAlias</span>,
            <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <b>object</b>&gt; <span id="r87 rd" class="r87 r">result</span>,
            <span class="i">HashSet</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r88 rd" class="r88 r">parametersToRemove</span>)
        {
            <span class="c">// No exception should be thrown if we cannot find a match for the &#39;paramName&#39;,</span>
            <span class="c">// because the &#39;paramName&#39; could be a dynamic parameter name, and this dynamic parameter</span>
            <span class="c">// hasn&#39;t been introduced at the current stage.</span>
            <b>bool</b> <span id="r89 rd" class="r89 r">writeWarning</span> = <b>false</b>;
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r90 rd" class="r90 r">matchParameter</span>;
            <b>object</b> <span id="r91 rd" class="r91 r">resultObject</span>;
            <b>if</b> (<span class="r85 r">bindableParameters</span>.<span class="i">TryGetValue</span>(<span class="r83 r">paramName</span>, <b>out</b> <span class="r90 r">matchParameter</span>))
            {
                <b>if</b> (!<span class="r87 r">result</span>.<span class="i">TryGetValue</span>(<span class="r90 r">matchParameter</span>, <b>out</b> <span class="r91 r">resultObject</span>))
                {
                    <span class="r87 r">result</span>.<span class="i">Add</span>(<span class="r90 r">matchParameter</span>, <span class="r84 r">paramValue</span>);
                    <b>return</b>;
                }
 
                <b>if</b> (!<span class="r84 r">paramValue</span>.<span class="i">Equals</span>(<span class="r91 r">resultObject</span>))
                {
                    <span class="r89 r">writeWarning</span> = <b>true</b>;
                    <span class="r88 r">parametersToRemove</span>.<span class="i">Add</span>(<span class="r90 r">matchParameter</span>);
                }
            }
            <b>else</b>
            {
                <b>if</b> (<span class="r86 r">bindableAlias</span>.<span class="i">TryGetValue</span>(<span class="r83 r">paramName</span>, <b>out</b> <span class="r90 r">matchParameter</span>))
                {
                    <b>if</b> (!<span class="r87 r">result</span>.<span class="i">TryGetValue</span>(<span class="r90 r">matchParameter</span>, <b>out</b> <span class="r91 r">resultObject</span>))
                    {
                        <span class="r87 r">result</span>.<span class="i">Add</span>(<span class="r90 r">matchParameter</span>, <span class="r84 r">paramValue</span>);
                        <b>return</b>;
                    }
 
                    <b>if</b> (!<span class="r84 r">paramValue</span>.<span class="i">Equals</span>(<span class="r91 r">resultObject</span>))
                    {
                        <span class="r89 r">writeWarning</span> = <b>true</b>;
                        <span class="r88 r">parametersToRemove</span>.<span class="i">Add</span>(<span class="r90 r">matchParameter</span>);
                    }
                }
            }
 
            <b>if</b> (<span class="r89 r">writeWarning</span> &amp;&amp; !<a href="#275643992f88c4ca" class="i field">_warningSet</a>.<span class="i">Contains</span>(<span class="r82 r">cmdletName</span> + <a href="#c3f881c8e5d649fb" class="i field">Separator</a> + <span class="r83 r">paramName</span>))
            {
                <a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>.<span class="i">WriteWarning</span>(
                    <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="i">ParameterBinderStrings</span>.<span class="i">DifferentValuesAssignedToSingleParameter</span>, <span class="r83 r">paramName</span>));
                <a href="#275643992f88c4ca" class="i field">_warningSet</a>.<span class="i">Add</span>(<span class="r82 r">cmdletName</span> + <a href="#c3f881c8e5d649fb" class="i field">Separator</a> + <span class="r83 r">paramName</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verify if all arguments from the command line are bound.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">originalBindingException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Previous binding exceptions that possibly causes the failure</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="9815c4ef699f2550" href="../R/9815c4ef699f2550.html" target="n" data-glyph="76,1" class="i method">VerifyArgumentsProcessed</a>(<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r92 rd" class="r92 r">originalBindingException</span>)
        {
            <span class="c">// Now verify that all the arguments that were passed in were processed.</span>
 
            <b>if</b> (<a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>.<span class="i">Count</span> &gt; 0)
            {
                <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r93 rd" class="r93 r">bindingException</span>;
                <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r94 rd" class="r94 r">parameter</span> = <a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>[0];
 
                <span class="c">// Get the argument type that was specified</span>
 
                <span class="i">Type</span> <span id="r95 rd" class="r95 r">specifiedType</span> = <b>null</b>;
                <b>object</b> <span id="r96 rd" class="r96 r">argumentValue</span> = <span class="r94 r">parameter</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>;
                <b>if</b> (<span class="r96 r">argumentValue</span> != <b>null</b> &amp;&amp; <span class="r96 r">argumentValue</span> != <a href="ParameterBinderBase.cs.html#e106e169b0ec2e07" class="t t">UnboundParameter</a>.<a href="ParameterBinderBase.cs.html#914edbc3371c49e2" class="i property">Value</a>)
                {
                    <span class="r95 r">specifiedType</span> = <span class="r96 r">argumentValue</span>.<span class="i">GetType</span>();
                }
 
                <b>if</b> (<span class="r94 r">parameter</span>.<a href="CommandParameter.cs.html#6cc67d908afd0fd6" class="i property">ParameterNameSpecified</a>)
                {
                    <span class="r93 r">bindingException</span> =
                        <b>new</b> <span class="t">ParameterBindingException</span>(
                            <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                            <a href="ParameterBinderController.cs.html#3227307065b1eace" class="i method">GetParameterErrorExtent</a>(<span class="r94 r">parameter</span>),
                            <span class="r94 r">parameter</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>,
                            <b>null</b>,
                            <span class="r95 r">specifiedType</span>,
                            <span class="i">ParameterBinderStrings</span>.<span class="i">NamedParameterNotFound</span>,
                            <span class="s">&quot;NamedParameterNotFound&quot;</span>);
                }
                <b>else</b>
                {
                    <span class="c">// If this was a positional parameter, and we have the original exception,</span>
                    <span class="c">// report on the original error</span>
                    <b>if</b> (<span class="r92 r">originalBindingException</span> != <b>null</b>)
                    {
                        <span class="r93 r">bindingException</span> = <span class="r92 r">originalBindingException</span>;
                    }
                    <span class="c">// Otherwise, give a generic error.</span>
                    <b>else</b>
                    {
                        <b>string</b> <span id="r97 rd" class="r97 r">argument</span> = <a href="SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="SessionStateStrings.cs.html#c7869084266cc07c" class="i field">DollarNull</a>;
                        <b>if</b> (<span class="r94 r">parameter</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a> != <b>null</b>)
                        {
                            <b>try</b>
                            {
                                <span class="r97 r">argument</span> = <span class="r94 r">parameter</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>.<span class="i">ToString</span>();
                            }
                            <b>catch</b> (<span class="i">Exception</span> <span id="r98 rd" class="r98 r">e</span>)
                            {
                                <span class="r93 r">bindingException</span> =
                                    <b>new</b> <span class="t">ParameterBindingArgumentTransformationException</span>(
                                        <span class="r98 r">e</span>,
                                        <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#c855a7c43559f12f" class="i field">InvalidData</a>,
                                        <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#e0677962cb6d3e17" class="i property">InvocationInfo</a>,
                                        <b>null</b>,
                                        <b>null</b>,
                                        <b>null</b>,
                                        <span class="r94 r">parameter</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>.<span class="i">GetType</span>(),
                                        <span class="i">ParameterBinderStrings</span>.<span class="i">ParameterArgumentTransformationErrorMessageOnly</span>,
                                        <span class="s">&quot;ParameterArgumentTransformationErrorMessageOnly&quot;</span>,
                                        <span class="r98 r">e</span>.<span class="i">Message</span>);
 
                                <b>if</b> (!<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
                                {
                                    <b>throw</b> <span class="r93 r">bindingException</span>;
                                }
                                <b>else</b>
                                {
                                    <a href="ParameterBinderController.cs.html#a9066724fc9cbe64" class="i method">ThrowElaboratedBindingException</a>(<span class="r93 r">bindingException</span>);
                                }
                            }
                        }
 
                        <span class="r93 r">bindingException</span> =
                            <b>new</b> <span class="t">ParameterBindingException</span>(
                                <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                                <b>null</b>,
                                <span class="r97 r">argument</span>,
                                <b>null</b>,
                                <span class="r95 r">specifiedType</span>,
                                <span class="i">ParameterBinderStrings</span>.<span class="i">PositionalParameterNotFound</span>,
                                <span class="s">&quot;PositionalParameterNotFound&quot;</span>);
                    }
                }
 
                <b>if</b> (!<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
                {
                    <b>throw</b> <span class="r93 r">bindingException</span>;
                }
                <b>else</b>
                {
                    <a href="ParameterBinderController.cs.html#a9066724fc9cbe64" class="i method">ThrowElaboratedBindingException</a>(<span class="r93 r">bindingException</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verifies that a single parameter set is selected and throws an exception if</span>
        <span class="c">///</span><span class="c"> one of there are multiple and one of them is not the default parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="6300366950279e18" href="../R/6300366950279e18.html" target="n" data-glyph="76,1" class="i method">VerifyParameterSetSelected</a>()
        {
            <span class="c">// Now verify that a parameter set has been selected if any parameter sets</span>
            <span class="c">// were defined.</span>
 
            <b>if</b> (<a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#b1838d676acf437e" class="i property">ParameterSetCount</a> &gt; 1)
            {
                <b>if</b> (<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> == <b>uint</b>.<span class="i">MaxValue</span>)
                {
                    <b>if</b> ((<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> &amp;
                         <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a>) != 0 &amp;&amp;
                         <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a> != <b>uint</b>.<span class="i">MaxValue</span>)
                    {
                        <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<span class="i">WriteLine</span>(
                            <span class="s">&quot;{0} valid parameter sets, using the DEFAULT PARAMETER SET: [{0}]&quot;</span>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#b1838d676acf437e" class="i property">ParameterSetCount</a>.<span class="i">ToString</span>(),
                            <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#8b69ebf363ce4bf7" class="i property">DefaultParameterSetName</a>);
 
                        <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> =
                            <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a>;
                    }
                    <b>else</b>
                    {
                        <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#e7dd110db4bf902f" class="i method">TraceError</a>(
                            <span class="s">&quot;ERROR: {0} valid parameter sets, but NOT DEFAULT PARAMETER SET.&quot;</span>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#b1838d676acf437e" class="i property">ParameterSetCount</a>);
 
                        <span class="c">// Throw an exception for ambiguous parameter set</span>
                        <a href="#655a56df4458b11e" class="i method">ThrowAmbiguousParameterSetException</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>);
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Restores the specified parameter to the original value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">argumentToBind</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The argument containing the value to restore.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">parameter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The metadata for the parameter to restore.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the parameter was restored correctly, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="d84ee93526c45807" href="../R/d84ee93526c45807.html" target="n" data-glyph="76,1" class="i method">RestoreParameter</a>(<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r99 rd" class="r99 r">argumentToBind</span>, <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r100 rd" class="r100 r">parameter</span>)
        {
            <b>switch</b> (<span class="r100 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#dfdaee66f98b9a67" class="i property">BinderAssociation</a>)
            {
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#515e5d093bc20be2" class="i field">DeclaredFormalParameters</a>:
                    <a href="ParameterBinderController.cs.html#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>.<a href="ParameterBinderBase.cs.html#fa702e1956545968" class="i method">BindParameter</a>(<span class="r99 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>, <span class="r99 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>, <span class="r100 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>);
                    <b>break</b>;
 
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#5061cf0360fde0b5" class="i field">CommonParameters</a>:
                    <a href="#c79452d10d14674c" class="i property">CommonParametersBinder</a>.<a href="ReflectionParameterBinder.cs.html#930fa60824e6e9b9" class="i method">BindParameter</a>(<span class="r99 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>, <span class="r99 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>, <span class="r100 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>);
                    <b>break</b>;
 
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#c60a12a7e7110562" class="i field">ShouldProcessParameters</a>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                        <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#aa53189195e06c7a" class="i property">SupportsShouldProcess</a>,
                        <span class="s">&quot;The metadata for the ShouldProcessParameters should only be available if the command supports ShouldProcess&quot;</span>);
 
                    <a href="#3dd609bc9dee03ea" class="i property">ShouldProcessParametersBinder</a>.<a href="ReflectionParameterBinder.cs.html#930fa60824e6e9b9" class="i method">BindParameter</a>(<span class="r99 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>, <span class="r99 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>, <span class="r100 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>);
                    <b>break</b>;
 
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#5c8c49bf90cb9996" class="i field">PagingParameters</a>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                        <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#6e322fe87e0f4bcc" class="i property">SupportsPaging</a>,
                        <span class="s">&quot;The metadata for the PagingParameters should only be available if the command supports paging&quot;</span>);
 
                    <a href="#c1b26462629998f8" class="i property">PagingParametersBinder</a>.<a href="ReflectionParameterBinder.cs.html#930fa60824e6e9b9" class="i method">BindParameter</a>(<span class="r99 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>, <span class="r99 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>, <span class="r100 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>);
                    <b>break</b>;
 
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#1bd613dc40264db8" class="i field">TransactionParameters</a>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                        <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#20ae284e47c80be8" class="i property">SupportsTransactions</a>,
                        <span class="s">&quot;The metadata for the TransactionParameters should only be available if the command supports Transactions&quot;</span>);
 
                    <a href="#7ca9748670fc564e" class="i property">TransactionParametersBinder</a>.<a href="ReflectionParameterBinder.cs.html#930fa60824e6e9b9" class="i method">BindParameter</a>(<span class="r99 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>, <span class="r99 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>, <span class="r100 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>);
                    <b>break</b>;
 
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#13d23785e977caeb" class="i field">DynamicParameters</a>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                        <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#132ba2fe4030925b" class="i property">ImplementsDynamicParameters</a>,
                        <span class="s">&quot;The metadata for the dynamic parameters should only be available if the command supports IDynamicParameters&quot;</span>);
 
                    <b>if</b> (<a href="#d9416506792d8d98" class="i field">_dynamicParameterBinder</a> != <b>null</b>)
                    {
                        <a href="#d9416506792d8d98" class="i field">_dynamicParameterBinder</a>.<a href="ParameterBinderBase.cs.html#fa702e1956545968" class="i method">BindParameter</a>(<span class="r99 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>, <span class="r99 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>, <span class="r100 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>);
                    }
 
                    <b>break</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Validate the given named parameter against the specified parameter set,</span>
        <span class="c">///</span><span class="c"> and then bind the argument to the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected override void</b> <a id="657a26e21e40a35c" href="../R/657a26e21e40a35c.html" target="n" data-glyph="75,1" class="i method">BindNamedParameter</a>(
            <b>uint</b> <span id="r101 rd" class="r101 r">parameterSets</span>,
            <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r102 rd" class="r102 r">argument</span>,
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r103 rd" class="r103 r">parameter</span>)
        {
            <b>if</b> ((<span class="r103 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a> &amp; <span class="r101 r">parameterSets</span>) == 0 &amp;&amp;
                !<span class="r103 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#28fd649ec0fa1b52" class="i property">IsInAllSets</a>)
            {
                <b>string</b> <span id="r104 rd" class="r104 r">parameterSetName</span> = <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#03ef644bfcd9605d" class="i method">GetParameterSetName</a>(<span class="r101 r">parameterSets</span>);
 
                <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r105 rd" class="r105 r">bindingException</span> =
                    <b>new</b> <span class="t">ParameterBindingException</span>(
                        <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                        <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                        <span class="i">errorPosition</span>: <b>null</b>,
                        <span class="r102 r">argument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>,
                        <span class="i">parameterType</span>: <b>null</b>,
                        <span class="i">typeSpecified</span>: <b>null</b>,
                        <span class="i">ParameterBinderStrings</span>.<span class="i">ParameterNotInParameterSet</span>,
                        <span class="s">&quot;ParameterNotInParameterSet&quot;</span>,
                        <span class="r104 r">parameterSetName</span>);
 
                <span class="c">// Might be caused by default parameter binding</span>
                <b>if</b> (!<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
                {
                    <b>throw</b> <span class="r105 r">bindingException</span>;
                }
                <b>else</b>
                {
                    <a href="ParameterBinderController.cs.html#a9066724fc9cbe64" class="i method">ThrowElaboratedBindingException</a>(<span class="r105 r">bindingException</span>);
                }
            }
 
            <b>try</b>
            {
                <a href="#1304cfc1ae549ad4" class="i method">BindParameter</a>(<span class="r101 r">parameterSets</span>, <span class="r102 r">argument</span>, <span class="r103 r">parameter</span>,
                    <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a> | <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#31ebbff231d00d8c" class="i field">DelayBindScriptBlock</a>);
            }
            <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r106 rd" class="r106 r">pbex</span>)
            {
                <b>if</b> (!<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
                {
                    <b>throw</b>;
                }
 
                <a href="ParameterBinderController.cs.html#a9066724fc9cbe64" class="i method">ThrowElaboratedBindingException</a>(<span class="r106 r">pbex</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if a ScriptBlock can be bound directly to the type of the specified parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r107 r">parameter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The metadata of the parameter to check the type of.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true if the parameter type is Object, ScriptBlock, derived from ScriptBlock, a</span>
        <span class="c">///</span><span class="c"> collection of ScriptBlocks, a collection of Objects, or a collection of types derived from</span>
        <span class="c">///</span><span class="c"> ScriptBlock.</span>
        <span class="c">///</span><span class="c"> False otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="f6505895e8c6d359" href="../R/f6505895e8c6d359.html" target="n" data-glyph="76,1" class="i method">IsParameterScriptBlockBindable</a>(<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r107 rd" class="r107 r">parameter</span>)
        {
            <b>bool</b> <span id="r108 rd" class="r108 r">result</span> = <b>false</b>;
 
            <span class="i">Type</span> <span id="r109 rd" class="r109 r">parameterType</span> = <span class="r107 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>;
 
            <b>do</b> <span class="c">// false loop</span>
            {
                <b>if</b> (<span class="r109 r">parameterType</span> == <b>typeof</b>(<b>object</b>))
                {
                    <span class="r108 r">result</span> = <b>true</b>;
                    <b>break</b>;
                }
 
                <b>if</b> (<span class="r109 r">parameterType</span> == <b>typeof</b>(<a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>))
                {
                    <span class="r108 r">result</span> = <b>true</b>;
                    <b>break</b>;
                }
 
                <b>if</b> (<span class="r109 r">parameterType</span>.<span class="i">IsSubclassOf</span>(<b>typeof</b>(<a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>)))
                {
                    <span class="r108 r">result</span> = <b>true</b>;
                    <b>break</b>;
                }
 
                <a href="CompiledCommandParameter.cs.html#b78c35f87c747be1" class="t t">ParameterCollectionTypeInformation</a> <span id="r110 rd" class="r110 r">parameterCollectionTypeInfo</span> = <span class="r107 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#417af85aa7cb39b1" class="i property">CollectionTypeInformation</a>;
                <b>if</b> (<span class="r110 r">parameterCollectionTypeInfo</span>.<a href="CompiledCommandParameter.cs.html#5b7b2c72ae3167c5" class="i property">ParameterCollectionType</a> != <a href="CompiledCommandParameter.cs.html#8e2afd828adc549d" class="t t">ParameterCollectionType</a>.<a href="CompiledCommandParameter.cs.html#f21241fc7477e88a" class="i field">NotCollection</a>)
                {
                    <b>if</b> (<span class="r110 r">parameterCollectionTypeInfo</span>.<a href="CompiledCommandParameter.cs.html#a3e13d75b560e4c1" class="i property">ElementType</a> == <b>typeof</b>(<b>object</b>))
                    {
                        <span class="r108 r">result</span> = <b>true</b>;
                        <b>break</b>;
                    }
 
                    <b>if</b> (<span class="r110 r">parameterCollectionTypeInfo</span>.<a href="CompiledCommandParameter.cs.html#a3e13d75b560e4c1" class="i property">ElementType</a> == <b>typeof</b>(<a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>))
                    {
                        <span class="r108 r">result</span> = <b>true</b>;
                        <b>break</b>;
                    }
 
                    <b>if</b> (<span class="r110 r">parameterCollectionTypeInfo</span>.<a href="CompiledCommandParameter.cs.html#a3e13d75b560e4c1" class="i property">ElementType</a>.<span class="i">IsSubclassOf</span>(<b>typeof</b>(<a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>)))
                    {
                        <span class="r108 r">result</span> = <b>true</b>;
                        <b>break</b>;
                    }
                }
            } <b>while</b> (<b>false</b>);
 
            <a href="#620ce08548f60d6f" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#451d38bf8c2b6b94" class="i method">WriteLine</a>(<span class="s">&quot;IsParameterScriptBlockBindable: result = {0}&quot;</span>, <span class="r108 r">result</span>);
            <b>return</b> <span class="r108 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Binds the specified argument to the specified parameter using the appropriate</span>
        <span class="c">///</span><span class="c"> parameter binder. If the argument is of type ScriptBlock and the parameter takes</span>
        <span class="c">///</span><span class="c"> pipeline input, then the ScriptBlock is saved off in the delay-bind ScriptBlock</span>
        <span class="c">///</span><span class="c"> container for further processing of pipeline input and is not bound as the argument</span>
        <span class="c">///</span><span class="c"> to the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r111 r">parameterSets</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter set used to bind the arguments.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r112 r">argument</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The argument to be bound.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r113 r">parameter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The metadata for the parameter to bind the argument to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r114 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Flags for type coercion, validation, and script block binding.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> ParameterBindingFlags.DelayBindScriptBlock:</span>
        <span class="c">///</span><span class="c"> If set, arguments that are of type ScriptBlock where the parameter is not of type ScriptBlock,</span>
        <span class="c">///</span><span class="c"> Object, or PSObject will be stored for execution during pipeline input and not bound as</span>
        <span class="c">///</span><span class="c"> an argument to the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the parameter was successfully bound. False if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r114 r">flags</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> has the flag </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> set and the type does not match the parameter type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal override bool</b> <a id="1304cfc1ae549ad4" href="../R/1304cfc1ae549ad4.html" target="n" data-glyph="74,1" class="i method">BindParameter</a>(
            <b>uint</b> <span id="r111 rd" class="r111 r">parameterSets</span>,
            <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r112 rd" class="r112 r">argument</span>,
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r113 rd" class="r113 r">parameter</span>,
            <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a> <span id="r114 rd" class="r114 r">flags</span>)
        {
            <span class="c">// Now we need to check to see if the argument value is</span>
            <span class="c">// a ScriptBlock.  If it is and the parameter type is</span>
            <span class="c">// not ScriptBlock and not Object, then we need to delay</span>
            <span class="c">// binding until a pipeline object is provided to invoke</span>
            <span class="c">// the ScriptBlock.</span>
 
            <span class="c">// Note: we haven&#39;t yet determined that only a single parameter</span>
            <span class="c">// set is valid, so we have to take a best guess on pipeline input</span>
            <span class="c">// based on the current valid parameter sets.</span>
 
            <b>bool</b> <span id="r115 rd" class="r115 r">continueWithBinding</span> = <b>true</b>;
 
            <b>if</b> ((<span class="r114 r">flags</span> &amp; <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#31ebbff231d00d8c" class="i field">DelayBindScriptBlock</a>) != 0 &amp;&amp;
                <span class="r113 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#9acad6d2852c15fd" class="i method">DoesParameterSetTakePipelineInput</a>(<span class="r111 r">parameterSets</span>) &amp;&amp;
                <span class="r112 r">argument</span>.<a href="CommandParameter.cs.html#f6c863f6ae765a95" class="i property">ArgumentSpecified</a>)
            {
                <b>object</b> <span id="r116 rd" class="r116 r">argumentValue</span> = <span class="r112 r">argument</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>;
                <b>if</b> ((<span class="r116 r">argumentValue</span> <b>is</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> || <span class="r116 r">argumentValue</span> <b>is</b> <a href="#6c106f272135c12d" class="t t">DelayedScriptBlockArgument</a>) &amp;&amp;
                    !<a href="#f6505895e8c6d359" class="i method">IsParameterScriptBlockBindable</a>(<span class="r113 r">parameter</span>))
                {
                    <span class="c">// Now check to see if the command expects to have pipeline input.</span>
                    <span class="c">// If not, we should throw an exception now to inform the</span>
                    <span class="c">// user with more information than they would get if it was</span>
                    <span class="c">// considered an unbound mandatory parameter.</span>
 
                    <b>if</b> (<a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>.<a href="MshCommandRuntime.cs.html#1873a5e7c8d36fbc" class="i property">IsClosed</a> &amp;&amp; <a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>.<a href="MshCommandRuntime.cs.html#2a3306bd1f3917ef" class="i property">InputPipe</a>.<a href="Pipe.cs.html#5b6f412d40044f40" class="i property">Empty</a>)
                    {
                        <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r117 rd" class="r117 r">bindingException</span> =
                            <b>new</b> <span class="t">ParameterBindingException</span>(
                                    <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#b56ca68d755dc414" class="i field">MetadataError</a>,
                                    <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                                    <a href="ParameterBinderController.cs.html#a9e5006bea1e5324" class="i method">GetErrorExtent</a>(<span class="r112 r">argument</span>),
                                    <span class="r113 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>,
                                    <span class="r113 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>,
                                    <b>null</b>,
                                    <span class="i">ParameterBinderStrings</span>.<span class="i">ScriptBlockArgumentNoInput</span>,
                                    <span class="s">&quot;ScriptBlockArgumentNoInput&quot;</span>);
 
                        <b>throw</b> <span class="r117 r">bindingException</span>;
                    }
 
                    <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(
                        <span class="s">&quot;Adding ScriptBlock to delay-bind list for parameter &#39;{0}&#39;&quot;</span>,
                        <span class="r113 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>);
 
                    <span class="c">// We need to delay binding of this argument to the parameter</span>
 
                    <a href="#6c106f272135c12d" class="t t">DelayedScriptBlockArgument</a> <span id="r118 rd" class="r118 r">delayedArg</span> = <span class="r116 r">argumentValue</span> <b>as</b> <a href="#6c106f272135c12d" class="t t">DelayedScriptBlockArgument</a> ??
                                                            <b>new</b> <span class="t">DelayedScriptBlockArgument</span> { <a href="#b090366c313f61bb" class="i field">_argument</a> = <span class="r112 r">argument</span>, <a href="#edfba978d2fc060a" class="i field">_parameterBinder</a> = <a href="#beea52684e39dd34" class="k">this</a> };
                    <b>if</b> (!<a href="#1c8d945f0156df74" class="i field">_delayBindScriptBlocks</a>.<span class="i">ContainsKey</span>(<span class="r113 r">parameter</span>))
                    {
                        <a href="#1c8d945f0156df74" class="i field">_delayBindScriptBlocks</a>.<span class="i">Add</span>(<span class="r113 r">parameter</span>, <span class="r118 r">delayedArg</span>);
                    }
 
                    <span class="c">// We treat the parameter as bound, but really the</span>
                    <span class="c">// script block gets run for each pipeline object and</span>
                    <span class="c">// the result is bound.</span>
 
                    <b>if</b> (<span class="r113 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a> != 0)
                    {
                        <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> &amp;= <span class="r113 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a>;
                    }
 
                    <a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>.<span class="i">Remove</span>(<span class="r113 r">parameter</span>);
 
                    <a href="ParameterBinderController.cs.html#03396016088be5fe" class="i property">BoundParameters</a>[<span class="r113 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>] = <span class="r113 r">parameter</span>;
                    <a href="ParameterBinderController.cs.html#4893dd5e52f9f477" class="i property">BoundArguments</a>[<span class="r113 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>] = <span class="r112 r">argument</span>;
 
                    <b>if</b> (<a href="ParameterBinderController.cs.html#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>.<a href="ParameterBinderBase.cs.html#80f311903d85dd3b" class="i field">RecordBoundParameters</a> &amp;&amp;
                        !<a href="ParameterBinderController.cs.html#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>.<a href="ParameterBinderBase.cs.html#4555288f0b3927cb" class="i property">CommandLineParameters</a>.<a href="ParameterBinderBase.cs.html#13e30d3c8502fa00" class="i method">ContainsKey</a>(<span class="r113 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                    {
                        <a href="ParameterBinderController.cs.html#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>.<a href="ParameterBinderBase.cs.html#4555288f0b3927cb" class="i property">CommandLineParameters</a>.<a href="ParameterBinderBase.cs.html#fb9729d19c4f40b0" class="i method">Add</a>(<span class="r113 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="r118 r">delayedArg</span>);
                    }
 
                    <span class="r115 r">continueWithBinding</span> = <b>false</b>;
                }
            }
 
            <b>bool</b> <span id="r119 rd" class="r119 r">result</span> = <b>false</b>;
            <b>if</b> (<span class="r115 r">continueWithBinding</span>)
            {
                <b>try</b>
                {
                    <span class="r119 r">result</span> = <a href="#d2fdd848ef4bdf7a" class="i method">BindParameter</a>(<span class="r112 r">argument</span>, <span class="r113 r">parameter</span>, <span class="r114 r">flags</span>);
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r120 rd" class="r120 r">e</span>)
                {
                    <b>bool</b> <span id="r121 rd" class="r121 r">rethrow</span> = <b>true</b>;
                    <b>if</b> ((<span class="r114 r">flags</span> &amp; <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a>) == 0)
                    {
                        <span class="c">// Attributes are used to do type coercion and result in various exceptions.</span>
                        <span class="c">// We assume that if we aren&#39;t trying to do type coercion, we should avoid</span>
                        <span class="c">// propagating type conversion exceptions.</span>
                        <b>while</b> (<span class="r120 r">e</span> != <b>null</b>)
                        {
                            <b>if</b> (<span class="r120 r">e</span> <b>is</b> <a href="ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a>)
                            {
                                <span class="r121 r">rethrow</span> = <b>false</b>;
                                <b>break</b>;
                            }
 
                            <span class="r120 r">e</span> = <span class="r120 r">e</span>.<span class="i">InnerException</span>;
                        }
                    }
 
                    <b>if</b> (<span class="r121 r">rethrow</span>)
                    {
                        <b>throw</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r119 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Binds the specified argument to the specified parameter using the appropriate</span>
        <span class="c">///</span><span class="c"> parameter binder.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r122 r">argument</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The argument to be bound.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r123 r">parameter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The metadata for the parameter to bind the argument to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r124 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Flags for type coercion and validation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the parameter was successfully bound. False if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r124 r">flags</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> has the flag </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> set and the type does not match the parameter type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="d2fdd848ef4bdf7a" href="../R/d2fdd848ef4bdf7a.html" target="n" data-glyph="76,1" class="i method">BindParameter</a>(
            <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r122 rd" class="r122 r">argument</span>,
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r123 rd" class="r123 r">parameter</span>,
            <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a> <span id="r124 rd" class="r124 r">flags</span>)
        {
            <b>bool</b> <span id="r125 rd" class="r125 r">result</span> = <b>false</b>;
 
            <b>switch</b> (<span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#dfdaee66f98b9a67" class="i property">BinderAssociation</a>)
            {
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#515e5d093bc20be2" class="i field">DeclaredFormalParameters</a>:
                    <span class="r125 r">result</span> =
                        <a href="ParameterBinderController.cs.html#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>.<a href="ParameterBinderBase.cs.html#af68f8de580249df" class="i method">BindParameter</a>(
                            <span class="r122 r">argument</span>,
                            <span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>,
                            <span class="r124 r">flags</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#5061cf0360fde0b5" class="i field">CommonParameters</a>:
                    <span class="r125 r">result</span> =
                        <a href="#c79452d10d14674c" class="i property">CommonParametersBinder</a>.<a href="ParameterBinderBase.cs.html#af68f8de580249df" class="i method">BindParameter</a>(
                            <span class="r122 r">argument</span>,
                            <span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>,
                            <span class="r124 r">flags</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#c60a12a7e7110562" class="i field">ShouldProcessParameters</a>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                        <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#aa53189195e06c7a" class="i property">SupportsShouldProcess</a>,
                        <span class="s">&quot;The metadata for the ShouldProcessParameters should only be available if the command supports ShouldProcess&quot;</span>);
 
                    <span class="r125 r">result</span> =
                        <a href="#3dd609bc9dee03ea" class="i property">ShouldProcessParametersBinder</a>.<a href="ParameterBinderBase.cs.html#af68f8de580249df" class="i method">BindParameter</a>(
                            <span class="r122 r">argument</span>,
                            <span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>,
                            <span class="r124 r">flags</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#5c8c49bf90cb9996" class="i field">PagingParameters</a>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                        <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#6e322fe87e0f4bcc" class="i property">SupportsPaging</a>,
                        <span class="s">&quot;The metadata for the PagingParameters should only be available if the command supports paging&quot;</span>);
 
                    <span class="r125 r">result</span> =
                        <a href="#c1b26462629998f8" class="i property">PagingParametersBinder</a>.<a href="ParameterBinderBase.cs.html#af68f8de580249df" class="i method">BindParameter</a>(
                            <span class="r122 r">argument</span>,
                            <span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>,
                            <span class="r124 r">flags</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#1bd613dc40264db8" class="i field">TransactionParameters</a>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                        <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#20ae284e47c80be8" class="i property">SupportsTransactions</a>,
                        <span class="s">&quot;The metadata for the TransactionsParameters should only be available if the command supports transactions&quot;</span>);
 
                    <span class="r125 r">result</span> =
                        <a href="#7ca9748670fc564e" class="i property">TransactionParametersBinder</a>.<a href="ParameterBinderBase.cs.html#af68f8de580249df" class="i method">BindParameter</a>(
                            <span class="r122 r">argument</span>,
                            <span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>,
                            <span class="r124 r">flags</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#13d23785e977caeb" class="i field">DynamicParameters</a>:
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                        <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#132ba2fe4030925b" class="i property">ImplementsDynamicParameters</a>,
                        <span class="s">&quot;The metadata for the dynamic parameters should only be available if the command supports IDynamicParameters&quot;</span>);
 
                    <b>if</b> (<a href="#d9416506792d8d98" class="i field">_dynamicParameterBinder</a> != <b>null</b>)
                    {
                        <span class="r125 r">result</span> =
                            <a href="#d9416506792d8d98" class="i field">_dynamicParameterBinder</a>.<a href="ParameterBinderBase.cs.html#af68f8de580249df" class="i method">BindParameter</a>(
                                <span class="r122 r">argument</span>,
                                <span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>,
                                <span class="r124 r">flags</span>);
                    }
 
                    <b>break</b>;
            }
 
            <b>if</b> (<span class="r125 r">result</span> &amp;&amp; ((<span class="r124 r">flags</span> &amp; <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#765bb2966dedd770" class="i field">IsDefaultValue</a>) == 0))
            {
                <span class="c">// Update the current valid parameter set flags</span>
 
                <b>if</b> (<span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a> != 0)
                {
                    <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> &amp;= <span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a>;
                }
 
                <a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>.<span class="i">Remove</span>(<span class="r123 r">parameter</span>);
 
                <b>if</b> (!<a href="ParameterBinderController.cs.html#03396016088be5fe" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                {
                    <a href="ParameterBinderController.cs.html#03396016088be5fe" class="i property">BoundParameters</a>.<span class="i">Add</span>(<span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="r123 r">parameter</span>);
                }
 
                <b>if</b> (!<a href="ParameterBinderController.cs.html#4893dd5e52f9f477" class="i property">BoundArguments</a>.<span class="i">ContainsKey</span>(<span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                {
                    <a href="ParameterBinderController.cs.html#4893dd5e52f9f477" class="i property">BoundArguments</a>.<span class="i">Add</span>(<span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="r122 r">argument</span>);
                }
 
                <b>if</b> (<span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#40248e207b9f981e" class="i property">ObsoleteAttribute</a> != <b>null</b> &amp;&amp;
                    (<span class="r124 r">flags</span> &amp; <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#765bb2966dedd770" class="i field">IsDefaultValue</a>) == 0 &amp;&amp;
                    !<a href="#e0b1677d418ee076" class="i property">BoundObsoleteParameterNames</a>.<span class="i">Contains</span>(<span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                {
                    <b>string</b> <span id="r126 rd" class="r126 r">obsoleteWarning</span> = <b>string</b>.<span class="i">Format</span>(
                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                        <span class="i">ParameterBinderStrings</span>.<span class="i">UseOfDeprecatedParameterWarning</span>,
                        <span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>,
                        <span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#40248e207b9f981e" class="i property">ObsoleteAttribute</a>.<span class="i">Message</span>);
                    <a href="hostifaces/InformationalRecord.cs.html#59cd69dde48b9557" class="k">var</a> <span id="r127 rd" class="r127 r">warningRecord</span> = <b>new</b> <a href="hostifaces/InformationalRecord.cs.html#dcad78b02a1ab129" class="t constructor">WarningRecord</a>(<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#1e7425f5fa5359d6" class="i field">FQIDParameterObsolete</a>, <span class="r126 r">obsoleteWarning</span>);
 
                    <a href="#e0b1677d418ee076" class="i property">BoundObsoleteParameterNames</a>.<span class="i">Add</span>(<span class="r123 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>);
 
                    <b>if</b> (<a href="#f317c00dad07ba60" class="i property">ObsoleteParameterWarningList</a> == <b>null</b>)
                        <a href="#f317c00dad07ba60" class="i property">ObsoleteParameterWarningList</a> = <b>new</b> <span class="i">List</span>&lt;<a href="hostifaces/InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a>&gt;();
 
                    <a href="#f317c00dad07ba60" class="i property">ObsoleteParameterWarningList</a>.<span class="i">Add</span>(<span class="r127 r">warningRecord</span>);
                }
            }
 
            <b>return</b> <span class="r125 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Binds the remaining arguments to an unbound ValueFromRemainingArguments parameter (Varargs)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there was an error binding the arguments to the parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="b878eb3f987f0abb" href="../R/b878eb3f987f0abb.html" target="n" data-glyph="76,1" class="i method">HandleRemainingArguments</a>()
        {
            <b>if</b> (<a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// Find the parameters that take the remaining args, if there are more</span>
                <span class="c">// than one and the parameter set has not been defined, this is an error</span>
 
                <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r128 rd" class="r128 r">varargsParameter</span> = <b>null</b>;
 
                <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r129 rd" class="r129 r">parameter</span> <b>in</b> <a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>)
                {
                    <a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r130 rd" class="r130 r">parameterSetData</span> = <span class="r129 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#26b6aaf167021208" class="i method">GetParameterSetData</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>);
 
                    <b>if</b> (<span class="r130 r">parameterSetData</span> == <b>null</b>)
                    {
                        <b>continue</b>;
                    }
 
                    <span class="c">// If the parameter takes the remaining arguments, bind them.</span>
 
                    <b>if</b> (<span class="r130 r">parameterSetData</span>.<a href="ParameterSetSpecificMetadata.cs.html#75971da95a085c4f" class="i property">ValueFromRemainingArguments</a>)
                    {
                        <b>if</b> (<span class="r128 r">varargsParameter</span> != <b>null</b>)
                        {
                            <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r131 rd" class="r131 r">bindingException</span> =
                                <b>new</b> <span class="t">ParameterBindingException</span>(
                                        <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#b56ca68d755dc414" class="i field">MetadataError</a>,
                                        <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                                        <b>null</b>,
                                        <span class="r129 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>,
                                        <span class="r129 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>,
                                        <b>null</b>,
                                        <span class="i">ParameterBinderStrings</span>.<span class="i">AmbiguousParameterSet</span>,
                                        <span class="s">&quot;AmbiguousParameterSet&quot;</span>);
 
                            <span class="c">// Might be caused by the default parameter binding</span>
                            <b>if</b> (!<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
                            {
                                <b>throw</b> <span class="r131 r">bindingException</span>;
                            }
                            <b>else</b>
                            {
                                <a href="ParameterBinderController.cs.html#a9066724fc9cbe64" class="i method">ThrowElaboratedBindingException</a>(<span class="r131 r">bindingException</span>);
                            }
                        }
 
                        <span class="r128 r">varargsParameter</span> = <span class="r129 r">parameter</span>;
                    }
                }
 
                <b>if</b> (<span class="r128 r">varargsParameter</span> != <b>null</b>)
                {
                    <b>using</b> (<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#ff5e86462c8f4f03" class="i method">TraceScope</a>(
                        <span class="s">&quot;BIND REMAININGARGUMENTS cmd line args to param: [{0}]&quot;</span>,
                        <span class="r128 r">varargsParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                    {
                        <span class="c">// Accumulate the unbound arguments in to an list and then bind it to the parameter</span>
 
                        <span class="i">List</span>&lt;<b>object</b>&gt; <span id="r132 rd" class="r132 r">valueFromRemainingArguments</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
 
                        <b>foreach</b> (<a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r133 rd" class="r133 r">argument</span> <b>in</b> <a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>)
                        {
                            <b>if</b> (<span class="r133 r">argument</span>.<a href="CommandParameter.cs.html#6cc67d908afd0fd6" class="i property">ParameterNameSpecified</a>)
                            {
                                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r133 r">argument</span>.<a href="CommandParameter.cs.html#e4b21d1937e05e60" class="i property">ParameterText</a>), <span class="s">&quot;Don&#39;t add a null argument&quot;</span>);
                                <span class="r132 r">valueFromRemainingArguments</span>.<span class="i">Add</span>(<span class="r133 r">argument</span>.<a href="CommandParameter.cs.html#e4b21d1937e05e60" class="i property">ParameterText</a>);
                            }
 
                            <b>if</b> (<span class="r133 r">argument</span>.<a href="CommandParameter.cs.html#f6c863f6ae765a95" class="i property">ArgumentSpecified</a>)
                            {
                                <b>object</b> <span id="r134 rd" class="r134 r">argumentValue</span> = <span class="r133 r">argument</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>;
                                <b>if</b> (<span class="r134 r">argumentValue</span> != <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a> &amp;&amp; <span class="r134 r">argumentValue</span> != <a href="ParameterBinderBase.cs.html#e106e169b0ec2e07" class="t t">UnboundParameter</a>.<a href="ParameterBinderBase.cs.html#914edbc3371c49e2" class="i property">Value</a>)
                                {
                                    <span class="r132 r">valueFromRemainingArguments</span>.<span class="i">Add</span>(<span class="r134 r">argumentValue</span>);
                                }
                            }
                        }
 
                        <span class="c">// If there are multiple arguments, it&#39;s not clear how best to represent the extent as the extent</span>
                        <span class="c">// may be disjoint, as in &#39;echo a -verbose b&#39;, we have &#39;a&#39; and &#39;b&#39; in UnboundArguments.</span>
                        <b>var</b> <span id="r135 rd" class="r135 r">argumentAst</span> = <a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>.<span class="i">Count</span> == 1 ? <a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>[0].<span class="i">ArgumentAst</span> : <b>null</b>;
                        <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="k">var</a> <span id="r136 rd" class="r136 r">cpi</span> = <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>(
                            <span class="c">/*parameterAst*/</span><b>null</b>, <span class="r128 r">varargsParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="s">&quot;-&quot;</span> + <span class="r128 r">varargsParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a> + <span class="s">&quot;:&quot;</span>,
                            <span class="r135 r">argumentAst</span>, <span class="r132 r">valueFromRemainingArguments</span>, <b>false</b>);
 
                        <span class="c">// To make all of the following work similarly (the first is handled elsewhere, but second and third are</span>
                        <span class="c">// handled here):</span>
                        <span class="c">//     Set-ClusterOwnerNode -Owners foo,bar</span>
                        <span class="c">//     Set-ClusterOwnerNode foo bar</span>
                        <span class="c">//     Set-ClusterOwnerNode foo,bar</span>
                        <span class="c">// we unwrap our List, but only if there is a single argument which is a collection.</span>
                        <b>if</b> (<span class="r132 r">valueFromRemainingArguments</span>.<span class="i">Count</span> == 1 &amp;&amp; <a href="LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">IsObjectEnumerable</span>(<span class="r132 r">valueFromRemainingArguments</span>[0]))
                        {
                            <span class="r136 r">cpi</span>.<span class="i">SetArgumentValue</span>(<a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>[0].<span class="i">ArgumentAst</span>, <span class="r132 r">valueFromRemainingArguments</span>[0]);
                        }
 
                        <b>try</b>
                        {
                            <a href="#d2fdd848ef4bdf7a" class="i method">BindParameter</a>(<span class="r136 r">cpi</span>, <span class="r128 r">varargsParameter</span>, <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a>);
                        }
                        <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r137 rd" class="r137 r">pbex</span>)
                        {
                            <b>if</b> (!<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
                            {
                                <b>throw</b>;
                            }
                            <b>else</b>
                            {
                                <a href="ParameterBinderController.cs.html#a9066724fc9cbe64" class="i method">ThrowElaboratedBindingException</a>(<span class="r137 r">pbex</span>);
                            }
                        }
 
                        <a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>.<span class="i">Clear</span>();
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if the cmdlet supports dynamic parameters. If it does,</span>
        <span class="c">///</span><span class="c"> the dynamic parameter bindable object is retrieved and the unbound</span>
        <span class="c">///</span><span class="c"> arguments are bound to it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r138 r">outgoingBindingException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the underlying parameter binding exception if any was generated.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/MetadataExceptions.cs.html#3bf974090c4e60a1" class="t t">MetadataException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there was an error compiling the parameter metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there was an error binding the arguments to the parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="7433484d5f721b08" href="../R/7433484d5f721b08.html" target="n" data-glyph="76,1" class="i method">HandleCommandLineDynamicParameters</a>(<b>out</b> <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r138 rd" class="r138 r">outgoingBindingException</span>)
        {
            <span class="r138 r">outgoingBindingException</span> = <b>null</b>;
 
            <b>if</b> (<a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#132ba2fe4030925b" class="i property">ImplementsDynamicParameters</a>)
            {
                <b>using</b> (<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#19ce116f88d7b1c7" class="i method">TraceScope</a>(
                    <span class="s">&quot;BIND cmd line args to DYNAMIC parameters.&quot;</span>))
                {
                    <a href="#620ce08548f60d6f" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;The Cmdlet supports the dynamic parameter interface&quot;</span>);
 
                    <a href="MshCmdlet.cs.html#c401984c7c9aeb48" class="t t">IDynamicParameters</a> <span id="r139 rd" class="r139 r">dynamicParameterCmdlet</span> = <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a> <b>as</b> <a href="MshCmdlet.cs.html#c401984c7c9aeb48" class="t t">IDynamicParameters</a>;
 
                    <b>if</b> (<span class="r139 r">dynamicParameterCmdlet</span> != <b>null</b>)
                    {
                        <b>if</b> (<a href="#d9416506792d8d98" class="i field">_dynamicParameterBinder</a> == <b>null</b>)
                        {
                            <a href="#620ce08548f60d6f" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Getting the bindable object from the Cmdlet&quot;</span>);
 
                            <span class="c">// Now get the dynamic parameter bindable object.</span>
                            <b>object</b> <span id="r140 rd" class="r140 r">dynamicParamBindableObject</span>;
 
                            <b>try</b>
                            {
                                <span class="r140 r">dynamicParamBindableObject</span> = <span class="r139 r">dynamicParameterCmdlet</span>.<a href="MshCmdlet.cs.html#e0bc45e96264bf54" class="i method">GetDynamicParameters</a>();
                            }
                            <b>catch</b> (<span class="i">Exception</span> <span id="r141 rd" class="r141 r">e</span>) <span class="c">// Catch-all OK, this is a third-party callout</span>
                            {
                                <b>if</b> (<span class="r141 r">e</span> <b>is</b> <a href="../utils/SessionStateExceptions.cs.html#35e07c15a7526bcd" class="t t">ProviderInvocationException</a>) { <b>throw</b>; }
 
                                <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r142 rd" class="r142 r">bindingException</span> =
                                    <b>new</b> <span class="t">ParameterBindingException</span>(
                                        <span class="r141 r">e</span>,
                                        <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                        <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                                        <b>null</b>,
                                        <b>null</b>,
                                        <b>null</b>,
                                        <b>null</b>,
                                        <span class="i">ParameterBinderStrings</span>.<span class="i">GetDynamicParametersException</span>,
                                        <span class="s">&quot;GetDynamicParametersException&quot;</span>,
                                        <span class="r141 r">e</span>.<span class="i">Message</span>);
 
                                <span class="c">// This exception is caused because failure happens when retrieving the dynamic parameters,</span>
                                <span class="c">// this is not caused by introducing the default parameter binding.</span>
                                <b>throw</b> <span class="r142 r">bindingException</span>;
                            }
 
                            <b>if</b> (<span class="r140 r">dynamicParamBindableObject</span> != <b>null</b>)
                            {
                                <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<span class="i">WriteLine</span>(
                                    <span class="s">&quot;DYNAMIC parameter object: [{0}]&quot;</span>,
                                    <span class="r140 r">dynamicParamBindableObject</span>.<span class="i">GetType</span>());
 
                                <a href="#620ce08548f60d6f" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;Creating a new parameter binder for the dynamic parameter object&quot;</span>);
 
                                <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a> <span id="r143 rd" class="r143 r">dynamicParameterMetadata</span>;
 
                                <a href="PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a> <span id="r144 rd" class="r144 r">runtimeParamDictionary</span> = <span class="r140 r">dynamicParamBindableObject</span> <b>as</b> <a href="PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a>;
                                <b>if</b> (<span class="r144 r">runtimeParamDictionary</span> != <b>null</b>)
                                {
                                    <span class="c">// Generate the type metadata for the runtime-defined parameters</span>
                                    <span class="r143 r">dynamicParameterMetadata</span> =
                                        <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a>.<a href="TypeMetadata.cs.html#37a5e8eb404da755" class="i method">Get</a>(<span class="r144 r">runtimeParamDictionary</span>, <b>true</b>, <b>true</b>);
 
                                    <a href="#d9416506792d8d98" class="i field">_dynamicParameterBinder</a> =
                                        <b>new</b> <a href="PseudoParameterBinder.cs.html#f7e189d98c6be95a" class="t constructor">RuntimeDefinedParameterBinder</a>(
                                            <span class="r144 r">runtimeParamDictionary</span>,
                                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>,
                                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#0b62798bea43a39e" class="i property">CommandLineParameters</a>);
                                }
                                <b>else</b>
                                {
                                    <span class="c">// Generate the type metadata or retrieve it from the cache</span>
                                    <span class="r143 r">dynamicParameterMetadata</span> =
                                        <a href="TypeMetadata.cs.html#a8f6662c681b78f9" class="t t">InternalParameterMetadata</a>.<span class="i">Get</span>(<span class="r140 r">dynamicParamBindableObject</span>.<span class="i">GetType</span>(), <a href="ParameterBinderController.cs.html#ce2a3e6f14a932c8" class="i property">Context</a>, <b>true</b>);
 
                                    <span class="c">// Create the parameter binder for the dynamic parameter object</span>
 
                                    <a href="#d9416506792d8d98" class="i field">_dynamicParameterBinder</a> =
                                        <b>new</b> <a href="ReflectionParameterBinder.cs.html#419c6cd460edf2d3" class="t constructor">ReflectionParameterBinder</a>(
                                            <span class="r140 r">dynamicParamBindableObject</span>,
                                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>,
                                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#0b62798bea43a39e" class="i property">CommandLineParameters</a>);
                                }
 
                                <span class="c">// Now merge the metadata with other metadata for the command</span>
 
                                <b>var</b> <span id="r145 rd" class="r145 r">dynamicParams</span> =
                                    <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#38d7db725edf154f" class="i method">AddMetadataForBinder</a>(
                                        <span class="r143 r">dynamicParameterMetadata</span>,
                                        <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#13d23785e977caeb" class="i field">DynamicParameters</a>);
                                <b>foreach</b> (<b>var</b> <span id="r146 rd" class="r146 r">param</span> <b>in</b> <span class="r145 r">dynamicParams</span>)
                                {
                                    <a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>.<span class="i">Add</span>(<span class="r146 r">param</span>);
                                }
 
                                <span class="c">// Now set the parameter set flags for the new type metadata.</span>
                                <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a> =
                                    <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#1e4f66b12a1584cf" class="i method">GenerateParameterSetMappingFromMetadata</a>(<a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#8b69ebf363ce4bf7" class="i property">DefaultParameterSetName</a>);
                            }
                        }
 
                        <b>if</b> (<a href="#d9416506792d8d98" class="i field">_dynamicParameterBinder</a> == <b>null</b>)
                        {
                            <a href="#620ce08548f60d6f" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;No dynamic parameter object was returned from the Cmdlet&quot;</span>);
                            <b>return</b>;
                        }
 
                        <b>if</b> (<a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>.<span class="i">Count</span> &gt; 0)
                        {
                            <b>using</b> (<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#19ce116f88d7b1c7" class="i method">TraceScope</a>(
                                    <span class="s">&quot;BIND NAMED args to DYNAMIC parameters&quot;</span>))
                            {
                                <span class="c">// Try to bind the unbound arguments as static parameters to the</span>
                                <span class="c">// dynamic parameter object.</span>
 
                                <a href="ParameterBinderController.cs.html#5c35bd87e9fcd1ca" class="i method">ReparseUnboundArguments</a>();
 
                                <a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a> = <a href="ParameterBinderController.cs.html#b49f6e6866858d41" class="i method">BindNamedParameters</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>);
                            }
 
                            <b>using</b> (<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#19ce116f88d7b1c7" class="i method">TraceScope</a>(
                                    <span class="s">&quot;BIND POSITIONAL args to DYNAMIC parameters&quot;</span>))
                            {
                                <a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a> =
                                    <a href="ParameterBinderController.cs.html#9078ab3976c11a31" class="i method">BindPositionalParameters</a>(
                                    <a href="ParameterBinderController.cs.html#609d30f416d5dd37" class="i property">UnboundArguments</a>,
                                    <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>,
                                    <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a>,
                                    <b>out</b> <span class="r138 r">outgoingBindingException</span>);
                            }
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method determines if the unbound mandatory parameters take pipeline input or</span>
        <span class="c">///</span><span class="c"> if we can use the default parameter set.  If all the unbound mandatory parameters</span>
        <span class="c">///</span><span class="c"> take pipeline input and the default parameter set is valid, then the default parameter</span>
        <span class="c">///</span><span class="c"> set is set as the current parameter set and processing can continue.  If there are</span>
        <span class="c">///</span><span class="c"> more than one valid parameter sets and the unbound mandatory parameters are not</span>
        <span class="c">///</span><span class="c"> consistent across parameter sets or there is no default parameter set then a</span>
        <span class="c">///</span><span class="c"> ParameterBindingException is thrown with an errorId of AmbiguousParameterSet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r147 r">validParameterSetCount</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The number of valid parameter sets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r148 r">isPipelineInputExpected</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the pipeline is open to receive input.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there are multiple valid parameter sets and the missing mandatory parameters are</span>
        <span class="c">///</span><span class="c"> not consistent across parameter sets, or there is no default parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Maintainability&quot;</span>, <span class="s">&quot;CA1505:AvoidUnmaintainableCode&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;Consider Simplifying it.&quot;</span>)]
        <b>private</b> <span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <a id="ec379eb77df25ab7" href="../R/ec379eb77df25ab7.html" target="n" data-glyph="76,1" class="i method">GetMissingMandatoryParameters</a>(
            <b>int</b> <span id="r147 rd" class="r147 r">validParameterSetCount</span>,
            <b>bool</b> <span id="r148 rd" class="r148 r">isPipelineInputExpected</span>)
        {
            <span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r149 rd" class="r149 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt;();
 
            <b>uint</b> <span id="r150 rd" class="r150 r">defaultParameterSet</span> = <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a>;
            <b>uint</b> <span id="r151 rd" class="r151 r">commandMandatorySets</span> = 0;
 
            <span class="i">Dictionary</span>&lt;<b>uint</b>, <a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a>&gt; <span id="r152 rd" class="r152 r">promptingData</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>uint</b>, <a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a>&gt;();
 
            <b>bool</b> <span id="r153 rd" class="r153 r">missingAMandatoryParameter</span> = <b>false</b>;
            <b>bool</b> <span id="r154 rd" class="r154 r">missingAMandatoryParameterInAllSet</span> = <b>false</b>;
 
            <span class="c">// See if any of the unbound parameters are mandatory</span>
 
            <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r155 rd" class="r155 r">parameter</span> <b>in</b> <a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>)
            {
                <span class="c">// If a parameter is never mandatory, we can skip lots of work here.</span>
                <b>if</b> (!<span class="r155 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#2506aa2af2064ac8" class="i property">IsMandatoryInSomeParameterSet</a>)
                {
                    <b>continue</b>;
                }
 
                <b>var</b> <span id="r156 rd" class="r156 r">matchingParameterSetMetadata</span> = <span class="r155 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#6734aa34600c1096" class="i method">GetMatchingParameterSetData</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>);
 
                <b>uint</b> <span id="r157 rd" class="r157 r">parameterMandatorySets</span> = 0;
                <b>bool</b> <span id="r158 rd" class="r158 r">thisParameterMissing</span> = <b>false</b>;
 
                <b>foreach</b> (<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r159 rd" class="r159 r">parameterSetMetadata</span> <b>in</b> <span class="r156 r">matchingParameterSetMetadata</span>)
                {
                    <b>uint</b> <span id="r160 rd" class="r160 r">newMandatoryParameterSetFlag</span> = <a href="#257fcbc06aef1728" class="i method">NewParameterSetPromptingData</a>(<span class="r152 r">promptingData</span>, <span class="r155 r">parameter</span>, <span class="r159 r">parameterSetMetadata</span>, <span class="r150 r">defaultParameterSet</span>, <span class="r148 r">isPipelineInputExpected</span>);
 
                    <b>if</b> (<span class="r160 r">newMandatoryParameterSetFlag</span> != 0)
                    {
                        <span class="r153 r">missingAMandatoryParameter</span> = <b>true</b>;
                        <span class="r158 r">thisParameterMissing</span> = <b>true</b>;
 
                        <b>if</b> (<span class="r160 r">newMandatoryParameterSetFlag</span> != <b>uint</b>.<span class="i">MaxValue</span>)
                        {
                            <span class="r157 r">parameterMandatorySets</span> |= (<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> &amp; <span class="r160 r">newMandatoryParameterSetFlag</span>);
                            <span class="r151 r">commandMandatorySets</span> |= (<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> &amp; <span class="r157 r">parameterMandatorySets</span>);
                        }
                        <b>else</b>
                        {
                            <span class="r154 r">missingAMandatoryParameterInAllSet</span> = <b>true</b>;
                        }
                    }
                }
 
                <span class="c">// We are not expecting pipeline input</span>
                <b>if</b> (!<span class="r148 r">isPipelineInputExpected</span>)
                {
                    <span class="c">// The parameter is mandatory so we need to prompt for it</span>
                    <b>if</b> (<span class="r158 r">thisParameterMissing</span>)
                    {
                        <span class="r149 r">result</span>.<span class="i">Add</span>(<span class="r155 r">parameter</span>);
                        <b>continue</b>;
                    }
                    <span class="c">// The parameter was not mandatory in any parameter set</span>
                }
            }
 
            <b>if</b> (<span class="r153 r">missingAMandatoryParameter</span> &amp;&amp; <span class="r148 r">isPipelineInputExpected</span>)
            {
                <b>if</b> (<span class="r151 r">commandMandatorySets</span> == 0)
                {
                    <span class="r151 r">commandMandatorySets</span> = <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>;
                }
 
                <b>if</b> (<span class="r154 r">missingAMandatoryParameterInAllSet</span>)
                {
                    <b>uint</b> <span id="r161 rd" class="r161 r">availableParameterSetFlags</span> = <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#cc916ab3a31f7f26" class="i property">AllParameterSetFlags</a>;
                    <b>if</b> (<span class="r161 r">availableParameterSetFlags</span> == 0)
                    {
                        <span class="r161 r">availableParameterSetFlags</span> = <b>uint</b>.<span class="i">MaxValue</span>;
                    }
 
                    <span class="r151 r">commandMandatorySets</span> = (<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> &amp; <span class="r161 r">availableParameterSetFlags</span>);
                }
 
                <span class="c">// First we need to see if there are multiple valid parameter sets, and if one is</span>
                <span class="c">// the default parameter set, and it is not missing any mandatory parameters, then</span>
                <span class="c">// use the default parameter set.</span>
 
                <b>if</b> (<span class="r147 r">validParameterSetCount</span> &gt; 1 &amp;&amp;
                    <span class="r150 r">defaultParameterSet</span> != 0 &amp;&amp;
                    (<span class="r150 r">defaultParameterSet</span> &amp; <span class="r151 r">commandMandatorySets</span>) == 0 &amp;&amp;
                    (<span class="r150 r">defaultParameterSet</span> &amp; <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>) != 0)
                {
                    <span class="c">// If no other set takes pipeline input, then latch on to the default set</span>
 
                    <b>uint</b> <span id="r162 rd" class="r162 r">setThatTakesPipelineInput</span> = 0;
                    <b>foreach</b> (<a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r163 rd" class="r163 r">promptingSetData</span> <b>in</b> <span class="r152 r">promptingData</span>.<span class="i">Values</span>)
                    {
                        <b>if</b> ((<span class="r163 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a> &amp; <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>) != 0 &amp;&amp;
                            (<span class="r163 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a> &amp; <span class="r150 r">defaultParameterSet</span>) == 0 &amp;&amp;
                            !<span class="r163 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a>)
                        {
                            <b>if</b> (<span class="r163 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#e99baa7bb574c877" class="i property">PipelineableMandatoryParameters</a>.<span class="i">Count</span> &gt; 0)
                            {
                                <span class="r162 r">setThatTakesPipelineInput</span> = <span class="r163 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a>;
                                <b>break</b>;
                            }
                        }
                    }
 
                    <b>if</b> (<span class="r162 r">setThatTakesPipelineInput</span> == 0)
                    {
                        <span class="c">// Old algorithm starts</span>
                        <span class="c">// // latch on to the default parameter set</span>
                        <span class="c">// commandMandatorySets = defaultParameterSet;</span>
                        <span class="c">// _currentParameterSetFlag = defaultParameterSet;</span>
                        <span class="c">// Command.SetParameterSetName(CurrentParameterSetName);</span>
                        <span class="c">// Old algorithm ends</span>
 
                        <span class="c">// At this point, we have the following information:</span>
                        <span class="c">//  1. There are unbound mandatory parameter(s)</span>
                        <span class="c">//  2. No unbound mandatory parameter is in AllSet</span>
                        <span class="c">//  3. All unbound mandatory parameters don&#39;t take pipeline input</span>
                        <span class="c">//  4. Default parameter set is valid</span>
                        <span class="c">//  5. Default parameter set doesn&#39;t contain unbound mandatory parameters</span>
                        <span class="c">//</span>
                        <span class="c">// We ignore those parameter sets that contain unbound mandatory parameters, but leave</span>
                        <span class="c">// all other parameter sets remain valid. The other parameter sets contains the default</span>
                        <span class="c">// parameter set and have one characteristic: NONE of them contain unbound mandatory parameters</span>
                        <span class="c">//</span>
                        <span class="c">// Comparing to the old algorithm, we keep more possible parameter sets here, but</span>
                        <span class="c">// we need to prioritize the default parameter set for pipeline binding, so as NOT to</span>
                        <span class="c">// make breaking changes. This is to handle the following scenario:</span>
                        <span class="c">//                               Old Algorithm              New Algorithm (without prioritizing default)      New Algorithm (with prioritizing default)</span>
                        <span class="c">//  Remaining Parameter Sets       A(default)               A(default), B                                     A(default), B</span>
                        <span class="c">//        Pipeline parameter       P1(string)               A: P1(string); B: P2(System.DateTime)             A: P1(string); B: P2(System.DateTime)</span>
                        <span class="c">//   Pipeline parameter type       P1:By Value              P1:By Value; P2:By Value                          P1:By Value; P2:By Value</span>
                        <span class="c">//            Pipeline input       $a (System.DateTime)     $a (System.DateTime)                              $a (System.DateTime)</span>
                        <span class="c">//   Pipeline binding result       P1 --&gt; $a.ToString()     P2 --&gt; $a                                         P1 --&gt; $a.ToString()</span>
                        <span class="c">//     Pipeline binding type       ByValueWithCoercion      ByValueWithoutCoercion                            ByValueWithCoercion</span>
 
                        <span class="r151 r">commandMandatorySets</span> = <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> &amp; (~<span class="r151 r">commandMandatorySets</span>);
                        <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> = <span class="r151 r">commandMandatorySets</span>;
 
                        <b>if</b> (<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> == <span class="r150 r">defaultParameterSet</span>)
                            <a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="cmdlet.cs.html#464de8fab6b163d3" class="i method">SetParameterSetName</a>(<a href="#f7c0306305e83ce1" class="i property">CurrentParameterSetName</a>);
                        <b>else</b>
                            <a href="#44000d600756d5de" class="i field">_parameterSetToBePrioritizedInPipelineBinding</a> = <span class="r150 r">defaultParameterSet</span>;
                    }
                }
                <span class="c">// We need to analyze the prompting data that was gathered to determine what parameter</span>
                <span class="c">// set to use, which parameters need prompting for, and which parameters take pipeline input.</span>
 
                <b>int</b> <span id="r164 rd" class="r164 r">commandMandatorySetsCount</span> = <a href="#3a6a88ae705b1bbb" class="i method">ValidParameterSetCount</a>(<span class="r151 r">commandMandatorySets</span>);
                <b>if</b> (<span class="r164 r">commandMandatorySetsCount</span> == 0)
                {
                    <a href="#655a56df4458b11e" class="i method">ThrowAmbiguousParameterSetException</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>);
                }
                <b>else</b> <b>if</b> (<span class="r164 r">commandMandatorySetsCount</span> == 1)
                {
                    <span class="c">// Since we have only one valid parameter set, add all</span>
                    <b>foreach</b> (<a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r165 rd" class="r165 r">promptingSetData</span> <b>in</b> <span class="r152 r">promptingData</span>.<span class="i">Values</span>)
                    {
                        <b>if</b> ((<span class="r165 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a> &amp; <span class="r151 r">commandMandatorySets</span>) != 0 ||
                            <span class="r165 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a>)
                        {
                            <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r166 rd" class="r166 r">mandatoryParameter</span> <b>in</b> <span class="r165 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#6717dbda4b770b33" class="i property">NonpipelineableMandatoryParameters</a>.<span class="i">Keys</span>)
                            {
                                <span class="r149 r">result</span>.<span class="i">Add</span>(<span class="r166 r">mandatoryParameter</span>);
                            }
                        }
                    }
                }
                <b>else</b> <b>if</b> (<a href="#44000d600756d5de" class="i field">_parameterSetToBePrioritizedInPipelineBinding</a> == 0)
                {
                    <span class="c">// We have more than one valid parameter set.  Need to figure out which one to</span>
                    <span class="c">// use.</span>
                    <span class="c">// First we need to process the default parameter set if it can fill its parameters</span>
                    <span class="c">// from the pipeline.</span>
 
                    <b>bool</b> <span id="r167 rd" class="r167 r">latchOnToDefault</span> = <b>false</b>;
                    <b>if</b> (<span class="r150 r">defaultParameterSet</span> != 0 &amp;&amp; (<span class="r151 r">commandMandatorySets</span> &amp; <span class="r150 r">defaultParameterSet</span>) != 0)
                    {
                        <span class="c">// Determine if another set could be satisfied by pipeline input - that is, it</span>
                        <span class="c">// has mandatory pipeline input parameters but no mandatory command-line only parameters.</span>
                        <b>bool</b> <span id="r168 rd" class="r168 r">anotherSetTakesPipelineInput</span> = <b>false</b>;
                        <b>foreach</b> (<a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r169 rd" class="r169 r">paramPromptingData</span> <b>in</b> <span class="r152 r">promptingData</span>.<span class="i">Values</span>)
                        {
                            <b>if</b> (!<span class="r169 r">paramPromptingData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a> &amp;&amp;
                                !<span class="r169 r">paramPromptingData</span>.<a href="ParameterSetPromptingData.cs.html#46532bc8462f9b35" class="i property">IsDefaultSet</a> &amp;&amp;
                                <span class="r169 r">paramPromptingData</span>.<a href="ParameterSetPromptingData.cs.html#e99baa7bb574c877" class="i property">PipelineableMandatoryParameters</a>.<span class="i">Count</span> &gt; 0 &amp;&amp;
                                <span class="r169 r">paramPromptingData</span>.<a href="ParameterSetPromptingData.cs.html#6717dbda4b770b33" class="i property">NonpipelineableMandatoryParameters</a>.<span class="i">Count</span> == 0)
                            {
                                <span class="r168 r">anotherSetTakesPipelineInput</span> = <b>true</b>;
                                <b>break</b>;
                            }
                        }
 
                        <span class="c">// Determine if another set takes pipeline input by property name</span>
                        <b>bool</b> <span id="r170 rd" class="r170 r">anotherSetTakesPipelineInputByPropertyName</span> = <b>false</b>;
                        <b>foreach</b> (<a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r171 rd" class="r171 r">paramPromptingData</span> <b>in</b> <span class="r152 r">promptingData</span>.<span class="i">Values</span>)
                        {
                            <b>if</b> (!<span class="r171 r">paramPromptingData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a> &amp;&amp;
                                !<span class="r171 r">paramPromptingData</span>.<a href="ParameterSetPromptingData.cs.html#46532bc8462f9b35" class="i property">IsDefaultSet</a> &amp;&amp;
                                <span class="r171 r">paramPromptingData</span>.<a href="ParameterSetPromptingData.cs.html#b93f7e5d6036b6e7" class="i property">PipelineableMandatoryByPropertyNameParameters</a>.<span class="i">Count</span> &gt; 0)
                            {
                                <span class="r170 r">anotherSetTakesPipelineInputByPropertyName</span> = <b>true</b>;
                                <b>break</b>;
                            }
                        }
 
                        <span class="c">// See if we should pick the default set if it can bind strongly to the incoming objects</span>
                        <a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r172 rd" class="r172 r">defaultSetPromptingData</span>;
                        <b>if</b> (<span class="r152 r">promptingData</span>.<span class="i">TryGetValue</span>(<span class="r150 r">defaultParameterSet</span>, <b>out</b> <span class="r172 r">defaultSetPromptingData</span>))
                        {
                            <b>bool</b> <span id="r173 rd" class="r173 r">defaultSetTakesPipelineInput</span> = <span class="r172 r">defaultSetPromptingData</span>.<a href="ParameterSetPromptingData.cs.html#e99baa7bb574c877" class="i property">PipelineableMandatoryParameters</a>.<span class="i">Count</span> &gt; 0;
                            <b>bool</b> <span id="r174 rd" class="r174 r">defaultSetTakesPipelineInputByPropertyName</span> = <span class="r172 r">defaultSetPromptingData</span>.<a href="ParameterSetPromptingData.cs.html#b93f7e5d6036b6e7" class="i property">PipelineableMandatoryByPropertyNameParameters</a>.<span class="i">Count</span> &gt; 0;
 
                            <b>if</b> (<span class="r174 r">defaultSetTakesPipelineInputByPropertyName</span> &amp;&amp; !<span class="r170 r">anotherSetTakesPipelineInputByPropertyName</span>)
                            {
                                <span class="r167 r">latchOnToDefault</span> = <b>true</b>;
                            }
                            <b>else</b> <b>if</b> (<span class="r173 r">defaultSetTakesPipelineInput</span> &amp;&amp; !<span class="r168 r">anotherSetTakesPipelineInput</span>)
                            {
                                <span class="r167 r">latchOnToDefault</span> = <b>true</b>;
                            }
                        }
 
                        <b>if</b> (!<span class="r167 r">latchOnToDefault</span>)
                        {
                            <span class="c">// If only the all set takes pipeline input then latch on to the</span>
                            <span class="c">// default set</span>
 
                            <b>if</b> (!<span class="r168 r">anotherSetTakesPipelineInput</span>)
                            {
                                <span class="r167 r">latchOnToDefault</span> = <b>true</b>;
                            }
                        }
 
                        <b>if</b> (!<span class="r167 r">latchOnToDefault</span>)
                        {
                            <span class="c">// Need to see if there are nonpipelineable mandatory parameters in the</span>
                            <span class="c">// all set.</span>
 
                            <a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r175 rd" class="r175 r">allSetPromptingData</span>;
                            <b>if</b> (<span class="r152 r">promptingData</span>.<span class="i">TryGetValue</span>(<b>uint</b>.<span class="i">MaxValue</span>, <b>out</b> <span class="r175 r">allSetPromptingData</span>))
                            {
                                <b>if</b> (<span class="r175 r">allSetPromptingData</span>.<a href="ParameterSetPromptingData.cs.html#6717dbda4b770b33" class="i property">NonpipelineableMandatoryParameters</a>.<span class="i">Count</span> &gt; 0)
                                {
                                    <span class="r167 r">latchOnToDefault</span> = <b>true</b>;
                                }
                            }
                        }
 
                        <b>if</b> (<span class="r167 r">latchOnToDefault</span>)
                        {
                            <span class="c">// latch on to the default parameter set</span>
                            <span class="r151 r">commandMandatorySets</span> = <span class="r150 r">defaultParameterSet</span>;
                            <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> = <span class="r150 r">defaultParameterSet</span>;
                            <a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="cmdlet.cs.html#464de8fab6b163d3" class="i method">SetParameterSetName</a>(<a href="#f7c0306305e83ce1" class="i property">CurrentParameterSetName</a>);
 
                            <span class="c">// Add all missing mandatory parameters that don&#39;t take pipeline input</span>
                            <b>foreach</b> (<a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r176 rd" class="r176 r">promptingSetData</span> <b>in</b> <span class="r152 r">promptingData</span>.<span class="i">Values</span>)
                            {
                                <b>if</b> ((<span class="r176 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a> &amp; <span class="r151 r">commandMandatorySets</span>) != 0 ||
                                    <span class="r176 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a>)
                                {
                                    <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r177 rd" class="r177 r">mandatoryParameter</span> <b>in</b> <span class="r176 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#6717dbda4b770b33" class="i property">NonpipelineableMandatoryParameters</a>.<span class="i">Keys</span>)
                                    {
                                        <span class="r149 r">result</span>.<span class="i">Add</span>(<span class="r177 r">mandatoryParameter</span>);
                                    }
                                }
                            }
                        }
                    }
 
                    <b>if</b> (!<span class="r167 r">latchOnToDefault</span>)
                    {
                        <span class="c">// When we select a mandatory set to latch on, we should try to preserve other parameter sets that contain no mandatory parameters or contain only common mandatory parameters</span>
                        <span class="c">// as much as possible, so as to support the binding for the following scenarios:</span>
                        <span class="c">//</span>
                        <span class="c">// (1) Scenario 1:</span>
                        <span class="c">// Valid parameter sets when it comes to the mandatory checking: A, B</span>
                        <span class="c">// Mandatory parameters in A, B:</span>
                        <span class="c">// Set      Nonpipelineable-Mandatory-InSet         Pipelineable-Mandatory-InSet       Common-Nonpipelineable-Mandatory       Common-Pipelineable-Mandatory</span>
                        <span class="c">// A        N/A                                     N/A                                N/A                                    AllParam (of type DateTime)</span>
                        <span class="c">// B        N/A                                     ParamB (of type TimeSpan)          N/A                                    AllParam (of type DateTime)</span>
                        <span class="c">//</span>
                        <span class="c">// Piped-in object: Get-Date</span>
                        <span class="c">//</span>
                        <span class="c">// (2) Scenario 2:</span>
                        <span class="c">// Valid parameter sets when it comes to the mandatory checking: A, B, C, Default</span>
                        <span class="c">// Mandatory parameters in A, B, C and Default:</span>
                        <span class="c">// Set      Nonpipelineable-Mandatory-InSet         Pipelineable-Mandatory-InSet       Common-Nonpipelineable-Mandatory       Common-Pipelineable-Mandatory</span>
                        <span class="c">// A        N/A                                     N/A                                N/A                                    AllParam (of type DateTime)</span>
                        <span class="c">// B        N/A                                     ParamB (of type TimeSpan)          N/A                                    AllParam (of type DateTime)</span>
                        <span class="c">// C        N/A                                     N/A                                N/A                                    AllParam (of type DateTime)</span>
                        <span class="c">// Default  N/A                                     N/A                                N/A                                    AllParam (of type DateTime)</span>
                        <span class="c">//</span>
                        <span class="c">// Piped-in object: Get-Date</span>
                        <span class="c">//</span>
                        <span class="c">// Before the fix, the mandatory checking will resolve the parameter set to be B in both scenario 1 and 2, which will fail in the subsequent pipeline binding.</span>
                        <span class="c">// After the fix, the parameter set &quot;A&quot; in the scenario 1 and the set &quot;A&quot;, &quot;C&quot;, &quot;Default&quot; in the scenario 2 will be preserved, and the subsequent pipeline binding will succeed.</span>
                        <span class="c">//</span>
                        <span class="c">// (3) Scenario 3:</span>
                        <span class="c">// Valid parameter sets when it comes to the mandatory checking: A, B, C</span>
                        <span class="c">// Mandatory parameters in A, B and C:</span>
                        <span class="c">// Set      Nonpipelineable-Mandatory-InSet         Pipelineable-Mandatory-InSet       Pipelineable-Nonmandatory-InSet       Common-Nonpipelineable-Mandatory       Common-Pipelineable-Mandatory       Common-Pipelineable-Nonmandatory</span>
                        <span class="c">// A        N/A                                     ParamA (of type TimeSpan)          N/A                                   N/A                                    N/A                                 N/A</span>
                        <span class="c">// B        ParamB-1                                N/A                                ParamB-2 (of type string[])           N/A                                    N/A                                 N/A</span>
                        <span class="c">// C        N/A                                     N/A                                ParamC (of type DateTime)             N/A                                    N/A                                 N/A</span>
                        <span class="c">//</span>
                        <span class="c">// (4) Scenario 4:</span>
                        <span class="c">// Valid parameter sets when it comes to the mandatory checking: A, B, C, Default</span>
                        <span class="c">// Mandatory parameters in A, B, C and Default:</span>
                        <span class="c">// Set      Nonpipelineable-Mandatory-InSet         Pipelineable-Mandatory-InSet       Pipelineable-Nonmandatory-InSet       Common-Nonpipelineable-Mandatory       Common-Pipelineable-Mandatory       Common-Pipelineable-Nonmandatory</span>
                        <span class="c">// A        N/A                                     ParamA (of type TimeSpan)          N/A                                   N/A                                    N/A                                 AllParam (of type DateTime)</span>
                        <span class="c">// B        ParamB-1                                N/A                                ParamB-2 (of type string[])           N/A                                    N/A                                 AllParam (of type DateTime)</span>
                        <span class="c">// C        N/A                                     N/A                                N/A                                   N/A                                    N/A                                 AllParam (of type DateTime)</span>
                        <span class="c">// Default  N/A                                     N/A                                N/A                                   N/A                                    N/A                                 AllParam (of type DateTime)</span>
                        <span class="c">//</span>
                        <span class="c">// Piped-in object: Get-Date</span>
                        <span class="c">//</span>
                        <span class="c">// Before the fix, the mandatory checking will resolve the parameter set to be A in both scenario 3 and 4, which will fail in the subsequent pipeline binding.</span>
                        <span class="c">// After the fix, the parameter set &quot;C&quot; in the scenario 1 and the set &quot;C&quot; and &quot;Default&quot; in the scenario 2 will be preserved, and the subsequent pipeline binding will succeed.</span>
                        <span class="c">//</span>
                        <span class="c">// Examples:</span>
                        <span class="c">// (1) Scenario 1</span>
                        <span class="c">// Function Get-Cmdlet</span>
                        <span class="c">// {</span>
                        <span class="c">//       [CmdletBinding()]</span>
                        <span class="c">//       param(</span>
                        <span class="c">//          [Parameter(Mandatory=$true, ValueFromPipeline=$true)]</span>
                        <span class="c">//          [System.DateTime]</span>
                        <span class="c">//          $Date,</span>
                        <span class="c">//          [Parameter(ParameterSetName=&quot;computer&quot;)]</span>
                        <span class="c">//          [Parameter(ParameterSetName=&quot;session&quot;)]</span>
                        <span class="c">//          $ComputerName,</span>
                        <span class="c">//          [Parameter(ParameterSetName=&quot;session&quot;, Mandatory=$true, ValueFromPipeline=$true)]</span>
                        <span class="c">//          [System.TimeSpan]</span>
                        <span class="c">//          $TimeSpan</span>
                        <span class="c">//       )</span>
                        <span class="c">//</span>
                        <span class="c">//      Process</span>
                        <span class="c">//      {</span>
                        <span class="c">//         Write-Output $PsCmdlet.ParameterSetName</span>
                        <span class="c">//      }</span>
                        <span class="c">// }</span>
                        <span class="c">//</span>
                        <span class="c">// PS:\&gt; Get-Date | Get-Cmdlet</span>
                        <span class="c">// PS:\&gt; computer</span>
                        <span class="c">//</span>
                        <span class="c">// (2) Scenario 2</span>
                        <span class="c">//</span>
                        <span class="c">// Function Get-Cmdlet</span>
                        <span class="c">// {</span>
                        <span class="c">//       [CmdletBinding(DefaultParameterSetName=&quot;computer&quot;)]</span>
                        <span class="c">//       param(</span>
                        <span class="c">//          [Parameter(ParameterSetName=&quot;new&quot;)]</span>
                        <span class="c">//          $NewName,</span>
                        <span class="c">//          [Parameter(Mandatory=$true, ValueFromPipeline=$true)]</span>
                        <span class="c">//          [System.DateTime]</span>
                        <span class="c">//          $Date,</span>
                        <span class="c">//          [Parameter(ParameterSetName=&quot;computer&quot;)]</span>
                        <span class="c">//          [Parameter(ParameterSetName=&quot;session&quot;)]</span>
                        <span class="c">//          $ComputerName,</span>
                        <span class="c">//          [Parameter(ParameterSetName=&quot;session&quot;, Mandatory=$true, ValueFromPipeline=$true)]</span>
                        <span class="c">//          [System.TimeSpan]</span>
                        <span class="c">//          $TimeSpan</span>
                        <span class="c">//       )</span>
                        <span class="c">//</span>
                        <span class="c">//      Process</span>
                        <span class="c">//      {</span>
                        <span class="c">//         Write-Output $PsCmdlet.ParameterSetName</span>
                        <span class="c">//      }</span>
                        <span class="c">// }</span>
                        <span class="c">//</span>
                        <span class="c">// PS:\&gt; Get-Date | Get-Cmdlet</span>
                        <span class="c">// PS:\&gt; computer</span>
                        <span class="c">//</span>
                        <span class="c">// (3) Scenario 3</span>
                        <span class="c">//</span>
                        <span class="c">// Function Get-Cmdlet</span>
                        <span class="c">// {</span>
                        <span class="c">//        [CmdletBinding()]</span>
                        <span class="c">//        param(</span>
                        <span class="c">//           [Parameter(ParameterSetName=&quot;network&quot;, Mandatory=$true, ValueFromPipeline=$true)]</span>
                        <span class="c">//           [TimeSpan]</span>
                        <span class="c">//           $network,</span>
                        <span class="c">//</span>
                        <span class="c">//           [Parameter(ParameterSetName=&quot;computer&quot;, ValueFromPipelineByPropertyName=$true)]</span>
                        <span class="c">//           [string[]]</span>
                        <span class="c">//           $ComputerName,</span>
                        <span class="c">//</span>
                        <span class="c">//           [Parameter(ParameterSetName=&quot;computer&quot;, Mandatory=$true)]</span>
                        <span class="c">//           [switch]</span>
                        <span class="c">//           $DisableComputer,</span>
                        <span class="c">//</span>
                        <span class="c">//           [Parameter(ParameterSetName=&quot;session&quot;, ValueFromPipeline=$true)]</span>
                        <span class="c">//           [DateTime]</span>
                        <span class="c">//           $Date</span>
                        <span class="c">//        )</span>
                        <span class="c">//</span>
                        <span class="c">//        Process</span>
                        <span class="c">//        {</span>
                        <span class="c">//           Write-Output $PsCmdlet.ParameterSetName</span>
                        <span class="c">//        }</span>
                        <span class="c">// }</span>
                        <span class="c">//</span>
                        <span class="c">// PS:\&gt; Get-Date | Get-Cmdlet</span>
                        <span class="c">// PS:\&gt; session</span>
                        <span class="c">//</span>
                        <span class="c">// (4) Scenario 4</span>
                        <span class="c">//</span>
                        <span class="c">// Function Get-Cmdlet</span>
                        <span class="c">// {</span>
                        <span class="c">//       [CmdletBinding(DefaultParameterSetName=&quot;server&quot;)]</span>
                        <span class="c">//       param(</span>
                        <span class="c">//          [Parameter(ParameterSetName=&quot;network&quot;, Mandatory=$true, ValueFromPipeline=$true)]</span>
                        <span class="c">//          [TimeSpan]</span>
                        <span class="c">//          $network,</span>
                        <span class="c">//</span>
                        <span class="c">//          [Parameter(ParameterSetName=&quot;computer&quot;, ValueFromPipelineByPropertyName=$true)]</span>
                        <span class="c">//          [string[]]</span>
                        <span class="c">//          $ComputerName,</span>
                        <span class="c">//</span>
                        <span class="c">//          [Parameter(ParameterSetName=&quot;computer&quot;, Mandatory=$true)]</span>
                        <span class="c">//          [switch]</span>
                        <span class="c">//          $DisableComputer,</span>
                        <span class="c">//</span>
                        <span class="c">//          [Parameter(ParameterSetName=&quot;session&quot;)]</span>
                        <span class="c">//          [Parameter(ParameterSetName=&quot;server&quot;)]</span>
                        <span class="c">//          [string]</span>
                        <span class="c">//          $Param,</span>
                        <span class="c">//</span>
                        <span class="c">//          [Parameter(ValueFromPipeline=$true)]</span>
                        <span class="c">//          [DateTime]</span>
                        <span class="c">//          $Date</span>
                        <span class="c">//       )</span>
 
                        <span class="c">//      Process</span>
                        <span class="c">//      {</span>
                        <span class="c">//         Write-Output $PsCmdlet.ParameterSetName</span>
                        <span class="c">//      }</span>
                        <span class="c">// }</span>
                        <span class="c">//</span>
                        <span class="c">// PS:\&gt; Get-Date | Get-Cmdlet</span>
                        <span class="c">// PS:\&gt; server</span>
                        <span class="c">//</span>
 
                        <b>uint</b> <span id="r178 rd" class="r178 r">setThatTakesPipelineInputByValue</span> = 0;
                        <b>uint</b> <span id="r179 rd" class="r179 r">setThatTakesPipelineInputByPropertyName</span> = 0;
 
                        <span class="c">// Find the single set that takes pipeline input by value</span>
                        <b>bool</b> <span id="r180 rd" class="r180 r">foundSetThatTakesPipelineInputByValue</span> = <b>false</b>;
                        <b>bool</b> <span id="r181 rd" class="r181 r">foundMultipleSetsThatTakesPipelineInputByValue</span> = <b>false</b>;
                        <b>foreach</b> (<a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r182 rd" class="r182 r">promptingSetData</span> <b>in</b> <span class="r152 r">promptingData</span>.<span class="i">Values</span>)
                        {
                            <b>if</b> ((<span class="r182 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a> &amp; <span class="r151 r">commandMandatorySets</span>) != 0 &amp;&amp;
                                !<span class="r182 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a>)
                            {
                                <b>if</b> (<span class="r182 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#0adea1f858970e9d" class="i property">PipelineableMandatoryByValueParameters</a>.<span class="i">Count</span> &gt; 0)
                                {
                                    <b>if</b> (<span class="r180 r">foundSetThatTakesPipelineInputByValue</span>)
                                    {
                                        <span class="r181 r">foundMultipleSetsThatTakesPipelineInputByValue</span> = <b>true</b>;
                                        <span class="r178 r">setThatTakesPipelineInputByValue</span> = 0;
                                        <b>break</b>;
                                    }
 
                                    <span class="r178 r">setThatTakesPipelineInputByValue</span> = <span class="r182 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a>;
                                    <span class="r180 r">foundSetThatTakesPipelineInputByValue</span> = <b>true</b>;
                                }
                            }
                        }
 
                        <span class="c">// Find the single set that takes pipeline input by property name</span>
                        <b>bool</b> <span id="r183 rd" class="r183 r">foundSetThatTakesPipelineInputByPropertyName</span> = <b>false</b>;
                        <b>bool</b> <span id="r184 rd" class="r184 r">foundMultipleSetsThatTakesPipelineInputByPropertyName</span> = <b>false</b>;
                        <b>foreach</b> (<a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r185 rd" class="r185 r">promptingSetData</span> <b>in</b> <span class="r152 r">promptingData</span>.<span class="i">Values</span>)
                        {
                            <b>if</b> ((<span class="r185 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a> &amp; <span class="r151 r">commandMandatorySets</span>) != 0 &amp;&amp;
                                    !<span class="r185 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a>)
                            {
                                <b>if</b> (<span class="r185 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#b93f7e5d6036b6e7" class="i property">PipelineableMandatoryByPropertyNameParameters</a>.<span class="i">Count</span> &gt; 0)
                                {
                                    <b>if</b> (<span class="r183 r">foundSetThatTakesPipelineInputByPropertyName</span>)
                                    {
                                        <span class="r184 r">foundMultipleSetsThatTakesPipelineInputByPropertyName</span> = <b>true</b>;
                                        <span class="r179 r">setThatTakesPipelineInputByPropertyName</span> = 0;
                                        <b>break</b>;
                                    }
 
                                    <span class="r179 r">setThatTakesPipelineInputByPropertyName</span> = <span class="r185 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a>;
                                    <span class="r183 r">foundSetThatTakesPipelineInputByPropertyName</span> = <b>true</b>;
                                }
                            }
                        }
 
                        <span class="c">// If we have one or the other, we can latch onto that set without difficulty</span>
                        <b>uint</b> <span id="r186 rd" class="r186 r">uniqueSetThatTakesPipelineInput</span> = 0;
                        <b>if</b> (<span class="r180 r">foundSetThatTakesPipelineInputByValue</span> &amp;&amp; <span class="r183 r">foundSetThatTakesPipelineInputByPropertyName</span> &amp;&amp;
                            (<span class="r178 r">setThatTakesPipelineInputByValue</span> == <span class="r179 r">setThatTakesPipelineInputByPropertyName</span>))
                        {
                            <span class="r186 r">uniqueSetThatTakesPipelineInput</span> = <span class="r178 r">setThatTakesPipelineInputByValue</span>;
                        }
 
                        <b>if</b> (<span class="r180 r">foundSetThatTakesPipelineInputByValue</span> ^ <span class="r183 r">foundSetThatTakesPipelineInputByPropertyName</span>)
                        {
                            <span class="r186 r">uniqueSetThatTakesPipelineInput</span> = <span class="r180 r">foundSetThatTakesPipelineInputByValue</span> ?
                                <span class="r178 r">setThatTakesPipelineInputByValue</span> : <span class="r179 r">setThatTakesPipelineInputByPropertyName</span>;
                        }
 
                        <b>if</b> (<span class="r186 r">uniqueSetThatTakesPipelineInput</span> != 0)
                        {
                            <span class="c">// latch on to the set that takes pipeline input</span>
                            <span class="r151 r">commandMandatorySets</span> = <span class="r186 r">uniqueSetThatTakesPipelineInput</span>;
                            <b>uint</b> <span id="r187 rd" class="r187 r">otherMandatorySetsToBeIgnored</span> = 0;
                            <b>bool</b> <span id="r188 rd" class="r188 r">chosenMandatorySetContainsNonpipelineableMandatoryParameters</span> = <b>false</b>;
 
                            <span class="c">// Add all missing mandatory parameters that don&#39;t take pipeline input</span>
                            <b>foreach</b> (<a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r189 rd" class="r189 r">promptingSetData</span> <b>in</b> <span class="r152 r">promptingData</span>.<span class="i">Values</span>)
                            {
                                <b>if</b> ((<span class="r189 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a> &amp; <span class="r151 r">commandMandatorySets</span>) != 0 ||
                                    <span class="r189 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a>)
                                {
                                    <b>if</b> (!<span class="r189 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a>)
                                    {
                                        <span class="r188 r">chosenMandatorySetContainsNonpipelineableMandatoryParameters</span> =
                                            <span class="r189 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#6717dbda4b770b33" class="i property">NonpipelineableMandatoryParameters</a>.<span class="i">Count</span> &gt; 0;
                                    }
 
                                    <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r190 rd" class="r190 r">mandatoryParameter</span> <b>in</b> <span class="r189 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#6717dbda4b770b33" class="i property">NonpipelineableMandatoryParameters</a>.<span class="i">Keys</span>)
                                    {
                                        <span class="r149 r">result</span>.<span class="i">Add</span>(<span class="r190 r">mandatoryParameter</span>);
                                    }
                                }
                                <b>else</b>
                                {
                                    <span class="r187 r">otherMandatorySetsToBeIgnored</span> |= <span class="r189 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a>;
                                }
                            }
 
                            <span class="c">// Preserve potential parameter sets as much as possible</span>
                            <a href="#35a90852394bb7ce" class="i method">PreservePotentialParameterSets</a>(<span class="r186 r">uniqueSetThatTakesPipelineInput</span>,
                                                           <span class="r187 r">otherMandatorySetsToBeIgnored</span>,
                                                           <span class="r188 r">chosenMandatorySetContainsNonpipelineableMandatoryParameters</span>);
                        }
                        <b>else</b>
                        {
                            <span class="c">// Now if any valid parameter sets have nonpipelineable mandatory parameters we have</span>
                            <span class="c">// an error</span>
                            <b>bool</b> <span id="r191 rd" class="r191 r">foundMissingParameters</span> = <b>false</b>;
                            <b>uint</b> <span id="r192 rd" class="r192 r">setsThatContainNonpipelineableMandatoryParameter</span> = 0;
                            <b>foreach</b> (<a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r193 rd" class="r193 r">promptingSetData</span> <b>in</b> <span class="r152 r">promptingData</span>.<span class="i">Values</span>)
                            {
                                <b>if</b> ((<span class="r193 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a> &amp; <span class="r151 r">commandMandatorySets</span>) != 0 ||
                                     <span class="r193 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a>)
                                {
                                    <b>if</b> (<span class="r193 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#6717dbda4b770b33" class="i property">NonpipelineableMandatoryParameters</a>.<span class="i">Count</span> &gt; 0)
                                    {
                                        <span class="r191 r">foundMissingParameters</span> = <b>true</b>;
                                        <b>if</b> (!<span class="r193 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a>)
                                        {
                                            <span class="r192 r">setsThatContainNonpipelineableMandatoryParameter</span> |= <span class="r193 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a>;
                                        }
                                    }
                                }
                            }
 
                            <b>if</b> (<span class="r191 r">foundMissingParameters</span>)
                            {
                                <span class="c">// As a last-ditch effort, bind to the set that takes pipeline input by value</span>
                                <b>if</b> (<span class="r178 r">setThatTakesPipelineInputByValue</span> != 0)
                                {
                                    <span class="c">// latch on to the set that takes pipeline input</span>
                                    <span class="r151 r">commandMandatorySets</span> = <span class="r178 r">setThatTakesPipelineInputByValue</span>;
                                    <b>uint</b> <span id="r194 rd" class="r194 r">otherMandatorySetsToBeIgnored</span> = 0;
                                    <b>bool</b> <span id="r195 rd" class="r195 r">chosenMandatorySetContainsNonpipelineableMandatoryParameters</span> = <b>false</b>;
 
                                    <span class="c">// Add all missing mandatory parameters that don&#39;t take pipeline input</span>
                                    <b>foreach</b> (<a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r196 rd" class="r196 r">promptingSetData</span> <b>in</b> <span class="r152 r">promptingData</span>.<span class="i">Values</span>)
                                    {
                                        <b>if</b> ((<span class="r196 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a> &amp; <span class="r151 r">commandMandatorySets</span>) != 0 ||
                                            <span class="r196 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a>)
                                        {
                                            <b>if</b> (!<span class="r196 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#d82587bd5078c7fa" class="i property">IsAllSet</a>)
                                            {
                                                <span class="r195 r">chosenMandatorySetContainsNonpipelineableMandatoryParameters</span> =
                                                    <span class="r196 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#6717dbda4b770b33" class="i property">NonpipelineableMandatoryParameters</a>.<span class="i">Count</span> &gt; 0;
                                            }
 
                                            <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r197 rd" class="r197 r">mandatoryParameter</span> <b>in</b> <span class="r196 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#6717dbda4b770b33" class="i property">NonpipelineableMandatoryParameters</a>.<span class="i">Keys</span>)
                                            {
                                                <span class="r149 r">result</span>.<span class="i">Add</span>(<span class="r197 r">mandatoryParameter</span>);
                                            }
                                        }
                                        <b>else</b>
                                        {
                                            <span class="r194 r">otherMandatorySetsToBeIgnored</span> |= <span class="r196 r">promptingSetData</span>.<a href="ParameterSetPromptingData.cs.html#1f7a800b2c72b066" class="i property">ParameterSet</a>;
                                        }
                                    }
 
                                    <span class="c">// Preserve potential parameter sets as much as possible</span>
                                    <a href="#35a90852394bb7ce" class="i method">PreservePotentialParameterSets</a>(<span class="r178 r">setThatTakesPipelineInputByValue</span>,
                                                                   <span class="r194 r">otherMandatorySetsToBeIgnored</span>,
                                                                   <span class="r195 r">chosenMandatorySetContainsNonpipelineableMandatoryParameters</span>);
                                }
                                <b>else</b>
                                {
                                    <b>if</b> ((!<span class="r181 r">foundMultipleSetsThatTakesPipelineInputByValue</span>) &amp;&amp;
                                       (!<span class="r184 r">foundMultipleSetsThatTakesPipelineInputByPropertyName</span>))
                                    {
                                        <a href="#655a56df4458b11e" class="i method">ThrowAmbiguousParameterSetException</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>);
                                    }
 
                                    <span class="c">// Remove the data set that contains non-pipelineable mandatory parameters, since we are not</span>
                                    <span class="c">// prompting for them and they will not be bound later.</span>
                                    <span class="c">// If no data set left, throw ambiguous parameter set exception</span>
                                    <b>if</b> (<span class="r192 r">setsThatContainNonpipelineableMandatoryParameter</span> != 0)
                                    {
                                        <a href="#eb55c3adbe225f2e" class="i method">IgnoreOtherMandatoryParameterSets</a>(<span class="r192 r">setsThatContainNonpipelineableMandatoryParameter</span>);
                                        <b>if</b> (<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> == 0)
                                        {
                                            <a href="#655a56df4458b11e" class="i method">ThrowAmbiguousParameterSetException</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>);
                                        }
 
                                        <b>if</b> (<a href="#3a6a88ae705b1bbb" class="i method">ValidParameterSetCount</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>) == 1)
                                        {
                                            <a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="cmdlet.cs.html#464de8fab6b163d3" class="i method">SetParameterSetName</a>(<a href="#f7c0306305e83ce1" class="i property">CurrentParameterSetName</a>);
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r149 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Preserve potential parameter sets as much as possible.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r198 r">chosenMandatorySet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The mandatory set we choose to latch on.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r199 r">otherMandatorySetsToBeIgnored</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Other mandatory parameter sets to be ignored.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r200 r">chosenSetContainsNonpipelineableMandatoryParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicate if the chosen mandatory set contains any non-pipelineable mandatory parameters.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="35a90852394bb7ce" href="../R/35a90852394bb7ce.html" target="n" data-glyph="76,1" class="i method">PreservePotentialParameterSets</a>(<b>uint</b> <span id="r198 rd" class="r198 r">chosenMandatorySet</span>, <b>uint</b> <span id="r199 rd" class="r199 r">otherMandatorySetsToBeIgnored</span>, <b>bool</b> <span id="r200 rd" class="r200 r">chosenSetContainsNonpipelineableMandatoryParameters</span>)
        {
            <span class="c">// If the chosen set contains nonpipelineable mandatory parameters, then we set it as the only valid parameter set since we will prompt for those mandatory parameters</span>
            <b>if</b> (<span class="r200 r">chosenSetContainsNonpipelineableMandatoryParameters</span>)
            {
                <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> = <span class="r198 r">chosenMandatorySet</span>;
                <a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="cmdlet.cs.html#464de8fab6b163d3" class="i method">SetParameterSetName</a>(<a href="#f7c0306305e83ce1" class="i property">CurrentParameterSetName</a>);
            }
            <b>else</b>
            {
                <span class="c">// Otherwise, we additionally preserve those valid parameter sets that contain no mandatory parameter, or contain only the common mandatory parameters</span>
                <a href="#eb55c3adbe225f2e" class="i method">IgnoreOtherMandatoryParameterSets</a>(<span class="r199 r">otherMandatorySetsToBeIgnored</span>);
                <a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="cmdlet.cs.html#464de8fab6b163d3" class="i method">SetParameterSetName</a>(<a href="#f7c0306305e83ce1" class="i property">CurrentParameterSetName</a>);
 
                <b>if</b> (<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> != <span class="r198 r">chosenMandatorySet</span>)
                {
                    <a href="#44000d600756d5de" class="i field">_parameterSetToBePrioritizedInPipelineBinding</a> = <span class="r198 r">chosenMandatorySet</span>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Update _currentParameterSetFlag to ignore the specified mandatory sets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method is used only when we try to preserve parameter sets during the mandatory parameter checking.</span>
        <span class="c">///</span><span class="c"> In cases where this method is used, there must be at least one parameter set declared.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r201 r">otherMandatorySetsToBeIgnored</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The mandatory parameter sets to be ignored.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="eb55c3adbe225f2e" href="../R/eb55c3adbe225f2e.html" target="n" data-glyph="76,1" class="i method">IgnoreOtherMandatoryParameterSets</a>(<b>uint</b> <span id="r201 rd" class="r201 r">otherMandatorySetsToBeIgnored</span>)
        {
            <b>if</b> (<span class="r201 r">otherMandatorySetsToBeIgnored</span> == 0)
                <b>return</b>;
 
            <b>if</b> (<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> == <b>uint</b>.<span class="i">MaxValue</span>)
            {
                <span class="c">// We cannot update the _currentParameterSetFlag to remove some parameter sets directly when it&#39;s AllSet as that will get it to an incorrect state.</span>
                <b>uint</b> <span id="r202 rd" class="r202 r">availableParameterSets</span> = <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#cc916ab3a31f7f26" class="i property">AllParameterSetFlags</a>;
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r202 r">availableParameterSets</span> != 0, <span class="s">&quot;At least one parameter set must be declared&quot;</span>);
                <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> = <span class="r202 r">availableParameterSets</span> &amp; (~<span class="r201 r">otherMandatorySetsToBeIgnored</span>);
            }
            <b>else</b>
            {
                <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> &amp;= (~<span class="r201 r">otherMandatorySetsToBeIgnored</span>);
            }
        }
 
        <b>private static uint</b> <a id="257fcbc06aef1728" href="../R/257fcbc06aef1728.html" target="n" data-glyph="76,1" class="i method">NewParameterSetPromptingData</a>(
            <span class="i">Dictionary</span>&lt;<b>uint</b>, <a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a>&gt; <span id="r203 rd" class="r203 r">promptingData</span>,
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r204 rd" class="r204 r">parameter</span>,
            <a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r205 rd" class="r205 r">parameterSetMetadata</span>,
            <b>uint</b> <span id="r206 rd" class="r206 r">defaultParameterSet</span>,
            <b>bool</b> <span id="r207 rd" class="r207 r">pipelineInputExpected</span>)
        {
            <b>uint</b> <span id="r208 rd" class="r208 r">parameterMandatorySets</span> = 0;
            <b>uint</b> <span id="r209 rd" class="r209 r">parameterSetFlag</span> = <span class="r205 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#f78c0b8e1f2ce3b8" class="i property">ParameterSetFlag</a>;
            <b>if</b> (<span class="r209 r">parameterSetFlag</span> == 0)
            {
                <span class="r209 r">parameterSetFlag</span> = <b>uint</b>.<span class="i">MaxValue</span>;
            }
 
            <b>bool</b> <span id="r210 rd" class="r210 r">isDefaultSet</span> = (<span class="r206 r">defaultParameterSet</span> != 0) &amp;&amp; ((<span class="r206 r">defaultParameterSet</span> &amp; <span class="r209 r">parameterSetFlag</span>) != 0);
 
            <b>bool</b> <span id="r211 rd" class="r211 r">isMandatory</span> = <b>false</b>;
            <b>if</b> (<span class="r205 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#9ef997a363d3cc80" class="i property">IsMandatory</a>)
            {
                <span class="r208 r">parameterMandatorySets</span> |= <span class="r209 r">parameterSetFlag</span>;
                <span class="r211 r">isMandatory</span> = <b>true</b>;
            }
 
            <b>bool</b> <span id="r212 rd" class="r212 r">isPipelineable</span> = <b>false</b>;
            <b>if</b> (<span class="r207 r">pipelineInputExpected</span>)
            {
                <b>if</b> (<span class="r205 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#6b00e8f2cc8f5221" class="i property">ValueFromPipeline</a> || <span class="r205 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#9d3ceb11c1e2558a" class="i property">ValueFromPipelineByPropertyName</a>)
                {
                    <span class="r212 r">isPipelineable</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="r211 r">isMandatory</span>)
            {
                <a href="ParameterSetPromptingData.cs.html#5a87714da2684ca5" class="t t">ParameterSetPromptingData</a> <span id="r213 rd" class="r213 r">promptingDataForSet</span>;
                <b>if</b> (!<span class="r203 r">promptingData</span>.<span class="i">TryGetValue</span>(<span class="r209 r">parameterSetFlag</span>, <b>out</b> <span class="r213 r">promptingDataForSet</span>))
                {
                    <span class="r213 r">promptingDataForSet</span> = <b>new</b> <a href="ParameterSetPromptingData.cs.html#c66f6cb5d4b4798d" class="t constructor">ParameterSetPromptingData</a>(<span class="r209 r">parameterSetFlag</span>, <span class="r210 r">isDefaultSet</span>);
                    <span class="r203 r">promptingData</span>.<span class="i">Add</span>(<span class="r209 r">parameterSetFlag</span>, <span class="r213 r">promptingDataForSet</span>);
                }
 
                <b>if</b> (<span class="r212 r">isPipelineable</span>)
                {
                    <span class="r213 r">promptingDataForSet</span>.<a href="ParameterSetPromptingData.cs.html#e99baa7bb574c877" class="i property">PipelineableMandatoryParameters</a>[<span class="r204 r">parameter</span>] = <span class="r205 r">parameterSetMetadata</span>;
 
                    <b>if</b> (<span class="r205 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#6b00e8f2cc8f5221" class="i property">ValueFromPipeline</a>)
                    {
                        <span class="r213 r">promptingDataForSet</span>.<a href="ParameterSetPromptingData.cs.html#0adea1f858970e9d" class="i property">PipelineableMandatoryByValueParameters</a>[<span class="r204 r">parameter</span>] = <span class="r205 r">parameterSetMetadata</span>;
                    }
 
                    <b>if</b> (<span class="r205 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#9d3ceb11c1e2558a" class="i property">ValueFromPipelineByPropertyName</a>)
                    {
                        <span class="r213 r">promptingDataForSet</span>.<a href="ParameterSetPromptingData.cs.html#b93f7e5d6036b6e7" class="i property">PipelineableMandatoryByPropertyNameParameters</a>[<span class="r204 r">parameter</span>] = <span class="r205 r">parameterSetMetadata</span>;
                    }
                }
                <b>else</b>
                {
                    <span class="r213 r">promptingDataForSet</span>.<a href="ParameterSetPromptingData.cs.html#6717dbda4b770b33" class="i property">NonpipelineableMandatoryParameters</a>[<span class="r204 r">parameter</span>] = <span class="r205 r">parameterSetMetadata</span>;
                }
            }
 
            <b>return</b> <span class="r208 r">parameterMandatorySets</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Ensures that only one parameter set is valid or throws an appropriate exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r214 r">prePipelineInput</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, it is acceptable to have multiple valid parameter sets as long as one</span>
        <span class="c">///</span><span class="c"> of those parameter sets take pipeline input.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r215 r">setDefault</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, the default parameter set will be selected if there is more than</span>
        <span class="c">///</span><span class="c"> one valid parameter set and one is the default set.</span>
        <span class="c">///</span><span class="c"> If false, the count of valid parameter sets will be returned but no error</span>
        <span class="c">///</span><span class="c"> will occur and the default parameter set will not be used.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The number of valid parameter sets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the more than one or zero parameter sets were resolved from the named</span>
        <span class="c">///</span><span class="c"> parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private int</b> <a id="57060ee3f765009b" href="../R/57060ee3f765009b.html" target="n" data-glyph="76,1" class="i method">ValidateParameterSets</a>(<b>bool</b> <span id="r214 rd" class="r214 r">prePipelineInput</span>, <b>bool</b> <span id="r215 rd" class="r215 r">setDefault</span>)
        {
            <span class="c">// Compute how many parameter sets are still valid</span>
            <b>int</b> <span id="r216 rd" class="r216 r">validParameterSetCount</span> = <a href="#3a6a88ae705b1bbb" class="i method">ValidParameterSetCount</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>);
 
            <b>if</b> (<span class="r216 r">validParameterSetCount</span> == 0 &amp;&amp; <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> != <b>uint</b>.<span class="i">MaxValue</span>)
            {
                <a href="#655a56df4458b11e" class="i method">ThrowAmbiguousParameterSetException</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>);
            }
            <b>else</b> <b>if</b> (<span class="r216 r">validParameterSetCount</span> &gt; 1)
            {
                <b>uint</b> <span id="r217 rd" class="r217 r">defaultParameterSetFlag</span> = <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a>;
                <b>bool</b> <span id="r218 rd" class="r218 r">hasDefaultSetDefined</span> = <span class="r217 r">defaultParameterSetFlag</span> != 0;
 
                <b>bool</b> <span id="r219 rd" class="r219 r">validSetIsAllSet</span> = <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> == <b>uint</b>.<span class="i">MaxValue</span>;
                <b>bool</b> <span id="r220 rd" class="r220 r">validSetIsDefault</span> = <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> == <span class="r217 r">defaultParameterSetFlag</span>;
 
                <span class="c">// If no default parameter set is defined and the valid set is the &quot;all&quot; set</span>
                <span class="c">// then use the all set.</span>
 
                <b>if</b> (<span class="r219 r">validSetIsAllSet</span> &amp;&amp; !<span class="r218 r">hasDefaultSetDefined</span>)
                {
                    <span class="c">// The current parameter set flags are valid.</span>
                    <span class="c">// Note: this is the same as having a single valid parameter set flag.</span>
                    <span class="r216 r">validParameterSetCount</span> = 1;
                }
                <span class="c">// If the valid parameter set is the default parameter set, or if the default</span>
                <span class="c">// parameter set has been defined and one of the valid parameter sets is</span>
                <span class="c">// the default parameter set, then use the default parameter set.</span>
                <b>else</b> <b>if</b> (!<span class="r214 r">prePipelineInput</span> &amp;&amp;
                    <span class="r220 r">validSetIsDefault</span> ||
                    (<span class="r218 r">hasDefaultSetDefined</span> &amp;&amp; (<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> &amp; <span class="r217 r">defaultParameterSetFlag</span>) != 0))
                {
                    <span class="c">// NTRAID#Windows Out Of Band Releases-2006/02/14-928660-JonN</span>
                    <span class="c">// Set currentParameterSetName regardless of setDefault</span>
                    <b>string</b> <span id="r221 rd" class="r221 r">currentParameterSetName</span> = <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#03ef644bfcd9605d" class="i method">GetParameterSetName</a>(<span class="r217 r">defaultParameterSetFlag</span>);
                    <a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="cmdlet.cs.html#464de8fab6b163d3" class="i method">SetParameterSetName</a>(<span class="r221 r">currentParameterSetName</span>);
                    <b>if</b> (<span class="r215 r">setDefault</span>)
                    {
                        <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> = <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a>;
                        <span class="r216 r">validParameterSetCount</span> = 1;
                    }
                }
                <span class="c">// There are multiple valid parameter sets but at least one parameter set takes</span>
                <span class="c">// pipeline input</span>
                <b>else</b> <b>if</b> (<span class="r214 r">prePipelineInput</span> &amp;&amp;
                    <a href="#c958d52226f891de" class="i method">AtLeastOneUnboundValidParameterSetTakesPipelineInput</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>))
                {
                    <span class="c">// We haven&#39;t fixated on a valid parameter set yet, but will wait for pipeline input to</span>
                    <span class="c">// determine which parameter set to use.</span>
                }
                <b>else</b>
                {
                    <b>int</b> <span id="r222 rd" class="r222 r">resolvedParameterSetCount</span> = <a href="#987ae3643468d0c2" class="i method">ResolveParameterSetAmbiguityBasedOnMandatoryParameters</a>();
                    <b>if</b> (<span class="r222 r">resolvedParameterSetCount</span> != 1)
                    {
                        <a href="#655a56df4458b11e" class="i method">ThrowAmbiguousParameterSetException</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>);
                    }
 
                    <span class="r216 r">validParameterSetCount</span> = <span class="r222 r">resolvedParameterSetCount</span>;
                }
            }
            <b>else</b> <span class="c">// validParameterSetCount == 1</span>
            {
                <span class="c">// If the valid parameter set is the &quot;all&quot; set, and a default set was defined,</span>
                <span class="c">// then set the current parameter set to the default set.</span>
 
                <b>if</b> (<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> == <b>uint</b>.<span class="i">MaxValue</span>)
                {
                    <span class="c">// Since this is the &quot;all&quot; set, default the parameter set count to the</span>
                    <span class="c">// number of parameter sets that were defined for the cmdlet or 1 if</span>
                    <span class="c">// none were defined.</span>
 
                    <span class="r216 r">validParameterSetCount</span> =
                        (<a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#b1838d676acf437e" class="i property">ParameterSetCount</a> &gt; 0) ?
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#b1838d676acf437e" class="i property">ParameterSetCount</a> : 1;
 
                    <b>if</b> (<span class="r214 r">prePipelineInput</span> &amp;&amp;
                        <a href="#c958d52226f891de" class="i method">AtLeastOneUnboundValidParameterSetTakesPipelineInput</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>))
                    {
                        <span class="c">// Don&#39;t fixate on the default parameter set yet. Wait until after</span>
                        <span class="c">// we have processed pipeline input.</span>
                    }
                    <b>else</b> <b>if</b> (<a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a> != 0)
                    {
                        <b>if</b> (<span class="r215 r">setDefault</span>)
                        {
                            <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> = <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a>;
                            <span class="r216 r">validParameterSetCount</span> = 1;
                        }
                    }
                    <span class="c">// NTRAID#Windows Out Of Band Releases-2005/11/07-923917-JonN</span>
                    <b>else</b> <b>if</b> (<span class="r216 r">validParameterSetCount</span> &gt; 1)
                    {
                        <b>int</b> <span id="r223 rd" class="r223 r">resolvedParameterSetCount</span> = <a href="#987ae3643468d0c2" class="i method">ResolveParameterSetAmbiguityBasedOnMandatoryParameters</a>();
                        <b>if</b> (<span class="r223 r">resolvedParameterSetCount</span> != 1)
                        {
                            <a href="#655a56df4458b11e" class="i method">ThrowAmbiguousParameterSetException</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>);
                        }
 
                        <span class="r216 r">validParameterSetCount</span> = <span class="r223 r">resolvedParameterSetCount</span>;
                    }
                }
 
                <a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="cmdlet.cs.html#464de8fab6b163d3" class="i method">SetParameterSetName</a>(<a href="#f7c0306305e83ce1" class="i property">CurrentParameterSetName</a>);
            }
 
            <b>return</b> <span class="r216 r">validParameterSetCount</span>;
        }
 
        <b>private int</b> <a id="987ae3643468d0c2" href="../R/987ae3643468d0c2.html" target="n" data-glyph="76,1" class="i method">ResolveParameterSetAmbiguityBasedOnMandatoryParameters</a>()
        {
            <b>return</b> <span class="i">ResolveParameterSetAmbiguityBasedOnMandatoryParameters</span>(<a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#03396016088be5fe" class="i property">BoundParameters</a>, <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>, <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>, <b>ref</b> <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <a href="#fe713c9e71fbf172" class="i property">Command</a>);
        }
 
        <b>internal static int</b> <a id="2f6d6a205bc4b1fc" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ResolveParameterSetAmbiguityBasedOnMandatoryParameters</a>(
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r224 rd" class="r224 r">boundParameters</span>,
            <span class="i">ICollection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r225 rd" class="r225 r">unboundParameters</span>,
            <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <span id="r226 rd" class="r226 r">bindableParameters</span>,
            <b>ref uint</b> <span id="r227 rd" class="r227 r">_currentParameterSetFlag</span>,
            <a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r228 rd" class="r228 r">command</span>
            )
        {
            <b>uint</b> <span id="r229 rd" class="r229 r">remainingParameterSetsWithNoMandatoryUnboundParameters</span> = <span class="r227 r">_currentParameterSetFlag</span>;
 
            <span class="i">IEnumerable</span>&lt;<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a>&gt; <span id="r230 rd" class="r230 r">allParameterSetMetadatas</span> = <span class="r224 r">boundParameters</span>.<span class="i">Values</span>
                .<span class="i">Concat</span>(<span class="r225 r">unboundParameters</span>)
                .<span class="i">SelectMany</span>(<b>static</b> <span id="r231 rd" class="r231 r">p</span> =&gt; <span class="r231 r">p</span>.<span class="i">Parameter</span>.<span class="i">ParameterSetData</span>.<span class="i">Values</span>);
            <b>uint</b> <span id="r232 rd" class="r232 r">allParameterSetFlags</span> = 0;
            <b>foreach</b> (<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r233 rd" class="r233 r">parameterSetMetadata</span> <b>in</b> <span class="r230 r">allParameterSetMetadatas</span>)
            {
                <span class="r232 r">allParameterSetFlags</span> |= <span class="r233 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#f78c0b8e1f2ce3b8" class="i property">ParameterSetFlag</a>;
            }
 
            <span class="r229 r">remainingParameterSetsWithNoMandatoryUnboundParameters</span> &amp;= <span class="r232 r">allParameterSetFlags</span>;
 
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <a href="#3a6a88ae705b1bbb" class="i method">ValidParameterSetCount</a>(<span class="r229 r">remainingParameterSetsWithNoMandatoryUnboundParameters</span>) &gt; 1,
                <span class="s">&quot;This method should only be called when there is an ambiguity wrt parameter sets&quot;</span>);
 
            <span class="i">IEnumerable</span>&lt;<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a>&gt; <span id="r234 rd" class="r234 r">parameterSetMetadatasForUnboundMandatoryParameters</span> = <span class="r225 r">unboundParameters</span>
                .<span class="i">SelectMany</span>(<b>static</b> <span id="r235 rd" class="r235 r">p</span> =&gt; <span class="r235 r">p</span>.<span class="i">Parameter</span>.<span class="i">ParameterSetData</span>.<span class="i">Values</span>)
                .<span class="i">Where</span>(<b>static</b> <span id="r236 rd" class="r236 r">p</span> =&gt; <span class="r236 r">p</span>.<span class="i">IsMandatory</span>);
            <b>foreach</b> (<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r237 rd" class="r237 r">parameterSetMetadata</span> <b>in</b> <span class="r234 r">parameterSetMetadatasForUnboundMandatoryParameters</span>)
            {
                <span class="r229 r">remainingParameterSetsWithNoMandatoryUnboundParameters</span> &amp;= (~<span class="r237 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#f78c0b8e1f2ce3b8" class="i property">ParameterSetFlag</a>);
            }
 
            <b>int</b> <span id="r238 rd" class="r238 r">finalParameterSetCount</span> = <a href="#3a6a88ae705b1bbb" class="i method">ValidParameterSetCount</a>(<span class="r229 r">remainingParameterSetsWithNoMandatoryUnboundParameters</span>);
            <b>if</b> (<span class="r238 r">finalParameterSetCount</span> == 1)
            {
                <span class="r227 r">_currentParameterSetFlag</span> = <span class="r229 r">remainingParameterSetsWithNoMandatoryUnboundParameters</span>;
 
                <b>if</b> (<span class="r228 r">command</span> != <b>null</b>)
                {
                    <b>string</b> <span id="r239 rd" class="r239 r">currentParameterSetName</span> = <span class="r226 r">bindableParameters</span>.<a href="MergedCommandParameterMetadata.cs.html#03ef644bfcd9605d" class="i method">GetParameterSetName</a>(<span class="r227 r">_currentParameterSetFlag</span>);
                    <span class="r228 r">command</span>.<a href="cmdlet.cs.html#464de8fab6b163d3" class="i method">SetParameterSetName</a>(<span class="r239 r">currentParameterSetName</span>);
                }
 
                <b>return</b> <span class="r238 r">finalParameterSetCount</span>;
            }
 
            <b>return</b> -1;
        }
 
        <b>private void</b> <a id="655a56df4458b11e" href="../R/655a56df4458b11e.html" target="n" data-glyph="76,1" class="i method">ThrowAmbiguousParameterSetException</a>(<b>uint</b> <span id="r240 rd" class="r240 r">parameterSetFlags</span>, <a href="MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <span id="r241 rd" class="r241 r">bindableParameters</span>)
        {
            <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r242 rd" class="r242 r">bindingException</span> =
                <b>new</b> <span class="t">ParameterBindingException</span>(
                    <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                    <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                    <b>null</b>,
                    <b>null</b>,
                    <b>null</b>,
                    <b>null</b>,
                    <span class="i">ParameterBinderStrings</span>.<span class="i">AmbiguousParameterSet</span>,
                    <span class="s">&quot;AmbiguousParameterSet&quot;</span>);
 
            <span class="c">// Trace the parameter sets still active</span>
            <b>uint</b> <span id="r243 rd" class="r243 r">currentParameterSet</span> = 1;
 
            <b>while</b> (<span class="r240 r">parameterSetFlags</span> != 0)
            {
                <b>uint</b> <span id="r244 rd" class="r244 r">currentParameterSetActive</span> = <span class="r240 r">parameterSetFlags</span> &amp; 0x1;
 
                <b>if</b> (<span class="r244 r">currentParameterSetActive</span> == 1)
                {
                    <b>string</b> <span id="r245 rd" class="r245 r">parameterSetName</span> = <span class="r241 r">bindableParameters</span>.<a href="MergedCommandParameterMetadata.cs.html#03ef644bfcd9605d" class="i method">GetParameterSetName</a>(<span class="r243 r">currentParameterSet</span>);
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r245 r">parameterSetName</span>))
                    {
                        <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;Remaining valid parameter set: {0}&quot;</span>, <span class="r245 r">parameterSetName</span>);
                    }
                }
 
                <span class="r240 r">parameterSetFlags</span> &gt;&gt;= 1;
                <span class="r243 r">currentParameterSet</span> &lt;&lt;= 1;
            }
 
            <b>if</b> (!<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
            {
                <b>throw</b> <span class="r242 r">bindingException</span>;
            }
            <b>else</b>
            {
                <a href="ParameterBinderController.cs.html#a9066724fc9cbe64" class="i method">ThrowElaboratedBindingException</a>(<span class="r242 r">bindingException</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines if there are any unbound parameters that take pipeline input</span>
        <span class="c">///</span><span class="c"> for the specified parameter sets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r246 r">validParameterSetFlags</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter sets that should be checked for each unbound parameter to see</span>
        <span class="c">///</span><span class="c"> if it accepts pipeline input.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if there is at least one parameter that takes pipeline input for the</span>
        <span class="c">///</span><span class="c"> specified parameter sets, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="c958d52226f891de" href="../R/c958d52226f891de.html" target="n" data-glyph="76,1" class="i method">AtLeastOneUnboundValidParameterSetTakesPipelineInput</a>(<b>uint</b> <span id="r246 rd" class="r246 r">validParameterSetFlags</span>)
        {
            <b>bool</b> <span id="r247 rd" class="r247 r">result</span> = <b>false</b>;
 
            <span class="c">// Loop through all the unbound parameters to see if there are any</span>
            <span class="c">// that take pipeline input for the specified parameter sets.</span>
 
            <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r248 rd" class="r248 r">parameter</span> <b>in</b> <a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>)
            {
                <b>if</b> (<span class="r248 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#9acad6d2852c15fd" class="i method">DoesParameterSetTakePipelineInput</a>(<span class="r246 r">validParameterSetFlags</span>))
                {
                    <span class="r247 r">result</span> = <b>true</b>;
                    <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r247 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks for unbound mandatory parameters. If any are found, an exception is thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r249 r">missingMandatoryParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the missing mandatory parameters, if any.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if there are no unbound mandatory parameters. False if there are unbound mandatory parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="a40c0c0f4107e736" href="../R/a40c0c0f4107e736.html" target="n" data-glyph="74,1" class="i method">HandleUnboundMandatoryParameters</a>(<b>out</b> <span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r249 rd" class="r249 r">missingMandatoryParameters</span>)
        {
            <b>return</b> <a href="#2356e11aefc013fa" class="i method">HandleUnboundMandatoryParameters</a>(
                <a href="#3a6a88ae705b1bbb" class="i method">ValidParameterSetCount</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>),
                <b>false</b>,
                <b>false</b>,
                <b>false</b>,
                <b>out</b> <span class="r249 r">missingMandatoryParameters</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Checks for unbound mandatory parameters. If any are found and promptForMandatory is true,</span>
        <span class="c">///</span><span class="c"> the user will be prompted for the missing mandatory parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r250 r">validParameterSetCount</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The number of valid parameter sets.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r251 r">processMissingMandatory</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, unbound mandatory parameters will be processed via user prompting (if allowed by promptForMandatory).</span>
        <span class="c">///</span><span class="c"> If false, unbound mandatory parameters will cause false to be returned.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r252 r">promptForMandatory</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, unbound mandatory parameters will cause the user to be prompted. If false, unbound</span>
        <span class="c">///</span><span class="c"> mandatory parameters will cause an exception to be thrown.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r253 r">isPipelineInputExpected</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, then only parameters that don&#39;t take pipeline input will be prompted for.</span>
        <span class="c">///</span><span class="c"> If false, any mandatory parameter that has not been specified will be prompted for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r254 r">missingMandatoryParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns the missing mandatory parameters, if any.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if there are no unbound mandatory parameters. False if there are unbound mandatory parameters</span>
        <span class="c">///</span><span class="c"> and promptForMandatory if false.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If prompting didn&#39;t result in a value for the parameter (only when </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r252 r">promptForMandatory</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is true.)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="2356e11aefc013fa" href="../R/2356e11aefc013fa.html" target="n" data-glyph="74,1" class="i method">HandleUnboundMandatoryParameters</a>(
            <b>int</b> <span id="r250 rd" class="r250 r">validParameterSetCount</span>,
            <b>bool</b> <span id="r251 rd" class="r251 r">processMissingMandatory</span>,
            <b>bool</b> <span id="r252 rd" class="r252 r">promptForMandatory</span>,
            <b>bool</b> <span id="r253 rd" class="r253 r">isPipelineInputExpected</span>,
            <b>out</b> <span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r254 rd" class="r254 r">missingMandatoryParameters</span>)
        {
            <b>bool</b> <span id="r255 rd" class="r255 r">result</span> = <b>true</b>;
 
            <span class="r254 r">missingMandatoryParameters</span> = <a href="#ec379eb77df25ab7" class="i method">GetMissingMandatoryParameters</a>(<span class="r250 r">validParameterSetCount</span>, <span class="r253 r">isPipelineInputExpected</span>);
 
            <b>if</b> (<span class="r254 r">missingMandatoryParameters</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>if</b> (<span class="r251 r">processMissingMandatory</span>)
                {
                    <span class="c">// If the host interface wasn&#39;t specified or we were instructed not to prmopt, then throw</span>
                    <span class="c">// an exception instead</span>
                    <b>if</b> ((<a href="ParameterBinderController.cs.html#ce2a3e6f14a932c8" class="i property">Context</a>.<a href="ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a> == <b>null</b>) || (!<span class="r252 r">promptForMandatory</span>))
                    {
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                            <a href="ParameterBinderController.cs.html#ce2a3e6f14a932c8" class="i property">Context</a>.<a href="ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a> != <b>null</b>,
                            <span class="s">&quot;The EngineHostInterface should never be null&quot;</span>);
 
                        <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(
                            <span class="s">&quot;ERROR: host does not support prompting for missing mandatory parameters&quot;</span>);
 
                        <b>string</b> <span id="r256 rd" class="r256 r">missingParameters</span> = <a href="#1bc763b0b8bc7440" class="i method">BuildMissingParamsString</a>(<span class="r254 r">missingMandatoryParameters</span>);
 
                        <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r257 rd" class="r257 r">bindingException</span> =
                            <b>new</b> <span class="t">ParameterBindingException</span>(
                                <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                                <b>null</b>,
                                <span class="r256 r">missingParameters</span>,
                                <b>null</b>,
                                <b>null</b>,
                                <span class="i">ParameterBinderStrings</span>.<span class="i">MissingMandatoryParameter</span>,
                                <span class="s">&quot;MissingMandatoryParameter&quot;</span>);
 
                        <b>throw</b> <span class="r257 r">bindingException</span>;
                    }
 
                    <span class="c">// Create a collection to store the prompt descriptions of unbound mandatory parameters</span>
 
                    <span class="i">Collection</span>&lt;<a href="hostifaces/FieldDescription.cs.html#604dc47cb14e8ae1" class="t t">FieldDescription</a>&gt; <span id="r258 rd" class="r258 r">fieldDescriptionList</span> = <a href="#e5b7adc2e66f3a2d" class="i method">CreatePromptDataStructures</a>(<span class="r254 r">missingMandatoryParameters</span>);
 
                    <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r259 rd" class="r259 r">parameters</span> =
                        <a href="#b1d02cd636be77bb" class="i method">PromptForMissingMandatoryParameters</a>(
                            <span class="r258 r">fieldDescriptionList</span>,
                            <span class="r254 r">missingMandatoryParameters</span>);
 
                    <b>using</b> (<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#19ce116f88d7b1c7" class="i method">TraceScope</a>(
                        <span class="s">&quot;BIND PROMPTED mandatory parameter args&quot;</span>))
                    {
                        <span class="c">// Now bind any parameters that were retrieved.</span>
 
                        <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r260 rd" class="r260 r">entry</span> <b>in</b> <span class="r259 r">parameters</span>)
                        {
                            <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="k">var</a> <span id="r261 rd" class="r261 r">argument</span> =
                                <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>(
                                <span class="c">/*parameterAst*/</span><b>null</b>, <span class="r260 r">entry</span>.<span class="i">Key</span>, <span class="s">&quot;-&quot;</span> + <span class="r260 r">entry</span>.<span class="i">Key</span> + <span class="s">&quot;:&quot;</span>,
                                <span class="c">/*argumentAst*/</span><b>null</b>, <span class="r260 r">entry</span>.<span class="i">Value</span>,
                                <b>false</b>);
 
                            <span class="c">// Ignore the result since any failure should cause an exception</span>
                            <span class="r255 r">result</span> =
                                <a href="ParameterBinderController.cs.html#d7bec2a482789f4b" class="i method">BindParameter</a>(<span class="r261 r">argument</span>, <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a> | <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#29b6a605a3b407fe" class="i field">ThrowOnParameterNotFound</a>);
 
                            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                                <span class="r255 r">result</span>,
                                <span class="s">&quot;Any error in binding the parameter with type coercion should result in an exception&quot;</span>);
                        }
 
                        <span class="r255 r">result</span> = <b>true</b>;
                    }
                }
                <b>else</b>
                {
                    <span class="r255 r">result</span> = <b>false</b>;
                }
            }
 
            <b>return</b> <span class="r255 r">result</span>;
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="b1d02cd636be77bb" href="../R/b1d02cd636be77bb.html" target="n" data-glyph="76,1" class="i method">PromptForMissingMandatoryParameters</a>(
            <span class="i">Collection</span>&lt;<a href="hostifaces/FieldDescription.cs.html#604dc47cb14e8ae1" class="t t">FieldDescription</a>&gt; <span id="r262 rd" class="r262 r">fieldDescriptionList</span>,
            <span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r263 rd" class="r263 r">missingMandatoryParameters</span>)
        {
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r264 rd" class="r264 r">parameters</span> = <b>null</b>;
 
            <span class="i">Exception</span> <span id="r265 rd" class="r265 r">error</span> = <b>null</b>;
 
            <span class="c">// Prompt</span>
            <b>try</b>
            {
                <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(
                    <span class="s">&quot;PROMPTING for missing mandatory parameters using the host&quot;</span>);
                <b>string</b> <span id="r266 rd" class="r266 r">msg</span> = <span class="i">ParameterBinderStrings</span>.<span class="i">PromptMessage</span>;
                <a href="InvocationInfo.cs.html#407d6c7d1ecbc8cc" class="t t">InvocationInfo</a> <span id="r267 rd" class="r267 r">invoInfo</span> = <a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>;
                <b>string</b> <span id="r268 rd" class="r268 r">caption</span> = <a href="../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ParameterBinderStrings</span>.<span class="i">PromptCaption</span>,
                    <span class="r267 r">invoInfo</span>.<a href="InvocationInfo.cs.html#8edab65bf1913897" class="i property">MyCommand</a>.<a href="CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>,
                    <span class="r267 r">invoInfo</span>.<a href="InvocationInfo.cs.html#b9401843293d51d4" class="i property">PipelinePosition</a>);
 
                <span class="r264 r">parameters</span> = <a href="ParameterBinderController.cs.html#ce2a3e6f14a932c8" class="i property">Context</a>.<a href="ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>.<a href="hostifaces/InternalHost.cs.html#d35ea6d8b175fa76" class="i property">UI</a>.<a href="hostifaces/MshHostUserInterface.cs.html#22ada0187831536b" class="i method">Prompt</a>(<span class="r268 r">caption</span>, <span class="r266 r">msg</span>, <span class="r262 r">fieldDescriptionList</span>);
            }
            <b>catch</b> (<span class="i">NotImplementedException</span> <span id="r269 rd" class="r269 r">notImplemented</span>)
            {
                <span class="r265 r">error</span> = <span class="r269 r">notImplemented</span>;
            }
            <b>catch</b> (<a href="../utils/HostInterfacesExceptions.cs.html#4b15a598e99c7dd9" class="t t">HostException</a> <span id="r270 rd" class="r270 r">hostException</span>)
            {
                <span class="r265 r">error</span> = <span class="r270 r">hostException</span>;
            }
            <b>catch</b> (<a href="../utils/MshInvalidOperationException.cs.html#259a38c8b594783c" class="t t">PSInvalidOperationException</a> <span id="r271 rd" class="r271 r">invalidOperation</span>)
            {
                <span class="r265 r">error</span> = <span class="r271 r">invalidOperation</span>;
            }
 
            <b>if</b> (<span class="r265 r">error</span> != <b>null</b>)
            {
                <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(
                    <span class="s">&quot;ERROR: host does not support prompting for missing mandatory parameters&quot;</span>);
 
                <b>string</b> <span id="r272 rd" class="r272 r">missingParameters</span> = <a href="#1bc763b0b8bc7440" class="i method">BuildMissingParamsString</a>(<span class="r263 r">missingMandatoryParameters</span>);
 
                <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r273 rd" class="r273 r">bindingException</span> =
                    <b>new</b> <span class="t">ParameterBindingException</span>(
                        <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                        <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                        <b>null</b>,
                        <span class="r272 r">missingParameters</span>,
                        <b>null</b>,
                        <b>null</b>,
                        <span class="i">ParameterBinderStrings</span>.<span class="i">MissingMandatoryParameter</span>,
                        <span class="s">&quot;MissingMandatoryParameter&quot;</span>);
 
                <b>throw</b> <span class="r273 r">bindingException</span>;
            }
 
            <b>if</b> ((<span class="r264 r">parameters</span> == <b>null</b>) || (<span class="r264 r">parameters</span>.<span class="i">Count</span> == 0))
            {
                <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(
                    <span class="s">&quot;ERROR: still missing mandatory parameters after PROMPTING&quot;</span>);
 
                <b>string</b> <span id="r274 rd" class="r274 r">missingParameters</span> = <a href="#1bc763b0b8bc7440" class="i method">BuildMissingParamsString</a>(<span class="r263 r">missingMandatoryParameters</span>);
 
                <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r275 rd" class="r275 r">bindingException</span> =
                    <b>new</b> <span class="t">ParameterBindingException</span>(
                        <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                        <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                        <b>null</b>,
                        <span class="r274 r">missingParameters</span>,
                        <b>null</b>,
                        <b>null</b>,
                        <span class="i">ParameterBinderStrings</span>.<span class="i">MissingMandatoryParameter</span>,
                        <span class="s">&quot;MissingMandatoryParameter&quot;</span>);
 
                <b>throw</b> <span class="r275 r">bindingException</span>;
            }
 
            <b>return</b> <span class="r264 r">parameters</span>;
        }
 
        <b>internal static string</b> <a id="1bc763b0b8bc7440" href="../R/1bc763b0b8bc7440.html" target="n" data-glyph="74,1" class="i method">BuildMissingParamsString</a>(<span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r276 rd" class="r276 r">missingMandatoryParameters</span>)
        {
            <span class="i">StringBuilder</span> <span id="r277 rd" class="r277 r">missingParameters</span> = <b>new</b> <span class="i">StringBuilder</span>();
 
            <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r278 rd" class="r278 r">missingParameter</span> <b>in</b> <span class="r276 r">missingMandatoryParameters</span>)
            {
                <span class="r277 r">missingParameters</span>.<span class="i">AppendFormat</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot; {0}&quot;</span>, <span class="r278 r">missingParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>);
            }
 
            <b>return</b> <span class="r277 r">missingParameters</span>.<span class="i">ToString</span>();
        }
 
        <b>private</b> <span class="i">Collection</span>&lt;<a href="hostifaces/FieldDescription.cs.html#604dc47cb14e8ae1" class="t t">FieldDescription</a>&gt; <a id="e5b7adc2e66f3a2d" href="../R/e5b7adc2e66f3a2d.html" target="n" data-glyph="76,1" class="i method">CreatePromptDataStructures</a>(
            <span class="i">Collection</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r279 rd" class="r279 r">missingMandatoryParameters</span>)
        {
            <span class="i">StringBuilder</span> <span id="r280 rd" class="r280 r">usedHotKeys</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <span class="i">Collection</span>&lt;<a href="hostifaces/FieldDescription.cs.html#604dc47cb14e8ae1" class="t t">FieldDescription</a>&gt; <span id="r281 rd" class="r281 r">fieldDescriptionList</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="hostifaces/FieldDescription.cs.html#604dc47cb14e8ae1" class="t t">FieldDescription</a>&gt;();
 
            <span class="c">// See if any of the unbound parameters are mandatory</span>
 
            <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r282 rd" class="r282 r">parameter</span> <b>in</b> <span class="r279 r">missingMandatoryParameters</span>)
            {
                <a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r283 rd" class="r283 r">parameterSetMetadata</span> =
                    <span class="r282 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#26b6aaf167021208" class="i method">GetParameterSetData</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>);
 
                <a href="hostifaces/FieldDescription.cs.html#604dc47cb14e8ae1" class="t t">FieldDescription</a> <span id="r284 rd" class="r284 r">fDesc</span> = <b>new</b> <a href="hostifaces/FieldDescription.cs.html#fa5ee5ec028527f8" class="t constructor">FieldDescription</a>(<span class="r282 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>);
 
                <b>string</b> <span id="r285 rd" class="r285 r">helpInfo</span> = <b>null</b>;
 
                <b>try</b>
                {
                    <span class="r285 r">helpInfo</span> = <span class="r283 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#b92f5be49cf77c84" class="i method">GetHelpMessage</a>(<a href="#fe713c9e71fbf172" class="i property">Command</a>);
                }
                <b>catch</b> (<span class="i">InvalidOperationException</span>)
                {
                }
                <b>catch</b> (<span class="i">ArgumentException</span>)
                {
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r285 r">helpInfo</span>))
                {
                    <span class="r284 r">fDesc</span>.<a href="hostifaces/FieldDescription.cs.html#3fbb648ef49de9ef" class="i property">HelpMessage</a> = <span class="r285 r">helpInfo</span>;
                }
 
                <span class="r284 r">fDesc</span>.<span class="i">SetParameterType</span>(<span class="r282 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>);
                <span class="r284 r">fDesc</span>.<a href="hostifaces/FieldDescription.cs.html#4bb9c572923973c6" class="i property">Label</a> = <a href="#4725edaa7c1c2d3b" class="i method">BuildLabel</a>(<span class="r282 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="r280 r">usedHotKeys</span>);
 
                <b>foreach</b> (<a href="Attributes.cs.html#f182d3d1083583da" class="t t">ValidateArgumentsAttribute</a> <span id="r286 rd" class="r286 r">vaAttr</span> <b>in</b> <span class="r282 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#f854be24d6c5bdf6" class="i property">ValidationAttributes</a>)
                {
                    <span class="r284 r">fDesc</span>.<a href="hostifaces/FieldDescription.cs.html#cbb2c0d11a096c6a" class="i property">Attributes</a>.<span class="i">Add</span>(<span class="r286 r">vaAttr</span>);
                }
 
                <b>foreach</b> (<a href="Attributes.cs.html#80472519ecf33cf1" class="t t">ArgumentTransformationAttribute</a> <span id="r287 rd" class="r287 r">arAttr</span> <b>in</b> <span class="r282 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#91e5071384d2bc8f" class="i property">ArgumentTransformationAttributes</a>)
                {
                    <span class="r284 r">fDesc</span>.<a href="hostifaces/FieldDescription.cs.html#cbb2c0d11a096c6a" class="i property">Attributes</a>.<span class="i">Add</span>(<span class="r287 r">arAttr</span>);
                }
 
                <span class="r284 r">fDesc</span>.<a href="hostifaces/FieldDescription.cs.html#964eb5c82527d436" class="i property">IsMandatory</a> = <b>true</b>;
 
                <span class="r281 r">fieldDescriptionList</span>.<span class="i">Add</span>(<span class="r284 r">fDesc</span>);
            }
 
            <b>return</b> <span class="r281 r">fieldDescriptionList</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a label with a Hotkey from </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r288 r">parameterName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">. The Hotkey is</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r288 r">parameterName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&#39;s first capital character not in </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r289 r">usedHotKeys</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">.</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r288 r">parameterName</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> does not have any capital character, the first lower</span>
        <span class="c">///</span><span class="c">  case character is used. The Hotkey is preceded by an ampersand in the label.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r288 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter name from which the Hotkey is created</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r289 r">usedHotKeys</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of used HotKeys</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A label made from parameterName with a HotKey indicated by an ampersand</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static string</b> <a id="4725edaa7c1c2d3b" href="../R/4725edaa7c1c2d3b.html" target="n" data-glyph="76,1" class="i method">BuildLabel</a>(<b>string</b> <span id="r288 rd" class="r288 r">parameterName</span>, <span class="i">StringBuilder</span> <span id="r289 rd" class="r289 r">usedHotKeys</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r288 r">parameterName</span>), <span class="s">&quot;parameterName is not set&quot;</span>);
            <b>const char</b> <span id="r290 rd" class="r290 r">hotKeyPrefix</span> = <span class="s">&#39;&amp;&#39;</span>;
            <b>bool</b> <span id="r291 rd" class="r291 r">built</span> = <b>false</b>;
            <span class="i">StringBuilder</span> <span id="r292 rd" class="r292 r">label</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="r288 r">parameterName</span>);
            <b>string</b> <span id="r293 rd" class="r293 r">usedHotKeysStr</span> = <span class="r289 r">usedHotKeys</span>.<span class="i">ToString</span>();
 
            <b>for</b> (<b>int</b> <span id="r294 rd" class="r294 r">i</span> = 0; <span class="r294 r">i</span> &lt; <span class="r288 r">parameterName</span>.<span class="i">Length</span>; <span class="r294 r">i</span>++)
            {
                <span class="c">// try Upper case</span>
                <b>if</b> (<b>char</b>.<span class="i">IsUpper</span>(<span class="r288 r">parameterName</span>[<span class="r294 r">i</span>]) &amp;&amp; <span class="r293 r">usedHotKeysStr</span>.<span class="i">Contains</span>(<span class="r288 r">parameterName</span>[<span class="r294 r">i</span>]))
                {
                    <span class="r292 r">label</span>.<span class="i">Insert</span>(<span class="r294 r">i</span>, <span class="r290 r">hotKeyPrefix</span>);
                    <span class="r289 r">usedHotKeys</span>.<span class="i">Append</span>(<span class="r288 r">parameterName</span>[<span class="r294 r">i</span>]);
                    <span class="r291 r">built</span> = <b>true</b>;
                    <b>break</b>;
                }
            }
 
            <b>if</b> (!<span class="r291 r">built</span>)
            {
                <span class="c">// try Lower case</span>
                <b>for</b> (<b>int</b> <span id="r295 rd" class="r295 r">i</span> = 0; <span class="r295 r">i</span> &lt; <span class="r288 r">parameterName</span>.<span class="i">Length</span>; <span class="r295 r">i</span>++)
                {
                    <b>if</b> (<b>char</b>.<span class="i">IsLower</span>(<span class="r288 r">parameterName</span>[<span class="r295 r">i</span>]) &amp;&amp; <span class="r293 r">usedHotKeysStr</span>.<span class="i">Contains</span>(<span class="r288 r">parameterName</span>[<span class="r295 r">i</span>]))
                    {
                        <span class="r292 r">label</span>.<span class="i">Insert</span>(<span class="r295 r">i</span>, <span class="r290 r">hotKeyPrefix</span>);
                        <span class="r289 r">usedHotKeys</span>.<span class="i">Append</span>(<span class="r288 r">parameterName</span>[<span class="r295 r">i</span>]);
                        <span class="r291 r">built</span> = <b>true</b>;
                        <b>break</b>;
                    }
                }
            }
 
            <b>if</b> (!<span class="r291 r">built</span>)
            {
                <span class="c">// try non-letters</span>
                <b>for</b> (<b>int</b> <span id="r296 rd" class="r296 r">i</span> = 0; <span class="r296 r">i</span> &lt; <span class="r288 r">parameterName</span>.<span class="i">Length</span>; <span class="r296 r">i</span>++)
                {
                    <b>if</b> (!<b>char</b>.<span class="i">IsLetter</span>(<span class="r288 r">parameterName</span>[<span class="r296 r">i</span>]) &amp;&amp; <span class="r293 r">usedHotKeysStr</span>.<span class="i">Contains</span>(<span class="r288 r">parameterName</span>[<span class="r296 r">i</span>]))
                    {
                        <span class="r292 r">label</span>.<span class="i">Insert</span>(<span class="r296 r">i</span>, <span class="r290 r">hotKeyPrefix</span>);
                        <span class="r289 r">usedHotKeys</span>.<span class="i">Append</span>(<span class="r288 r">parameterName</span>[<span class="r296 r">i</span>]);
                        <span class="r291 r">built</span> = <b>true</b>;
                        <b>break</b>;
                    }
                }
            }
 
            <b>if</b> (!<span class="r291 r">built</span>)
            {
                <span class="c">// use first char</span>
                <span class="r292 r">label</span>.<span class="i">Insert</span>(0, <span class="r290 r">hotKeyPrefix</span>);
            }
 
            <b>return</b> <span class="r292 r">label</span>.<span class="i">ToString</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the parameter set name for the current parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="f7c0306305e83ce1" href="../R/f7c0306305e83ce1.html" target="n" data-glyph="104,1" class="i property">CurrentParameterSetName</a>
        {
            <b>get</b>
            {
                <b>string</b> <span id="r297 rd" class="r297 r">currentParameterSetName</span> = <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#03ef644bfcd9605d" class="i method">GetParameterSetName</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>);
                <a href="#620ce08548f60d6f" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(<span class="s">&quot;CurrentParameterSetName = {0}&quot;</span>, <span class="r297 r">currentParameterSetName</span>);
                <b>return</b> <span class="r297 r">currentParameterSetName</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Binds the specified object or its properties to parameters</span>
        <span class="c">///</span><span class="c"> that accept pipeline input.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r298 r">inputToOperateOn</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline object to bind.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the pipeline input was bound successfully or there was nothing</span>
        <span class="c">///</span><span class="c"> to bind, or false if there was an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="4dbe34e5defca41f" href="../R/4dbe34e5defca41f.html" target="n" data-glyph="74,1" class="i method">BindPipelineParameters</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r298 rd" class="r298 r">inputToOperateOn</span>)
        {
            <b>bool</b> <span id="r299 rd" class="r299 r">result</span>;
 
            <b>try</b>
            {
                <b>using</b> (<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#ff5e86462c8f4f03" class="i method">TraceScope</a>(
                    <span class="s">&quot;BIND PIPELINE object to parameters: [{0}]&quot;</span>,
                    <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#8d0d4ac251b21d59" class="i property">Name</a>))
                {
                    <span class="c">// First run any of the delay bind ScriptBlocks and bind the</span>
                    <span class="c">// result to the appropriate parameter.</span>
 
                    <b>bool</b> <span id="r300 rd" class="r300 r">thereWasSomethingToBind</span>;
                    <b>bool</b> <span id="r301 rd" class="r301 r">invokeScriptResult</span> = <a href="#6dcaf4af764711d3" class="i method">InvokeAndBindDelayBindScriptBlock</a>(<span class="r298 r">inputToOperateOn</span>, <b>out</b> <span class="r300 r">thereWasSomethingToBind</span>);
 
                    <b>bool</b> <span id="r302 rd" class="r302 r">continueBindingAfterScriptBlockProcessing</span> = !<span class="r300 r">thereWasSomethingToBind</span> || <span class="r301 r">invokeScriptResult</span>;
 
                    <b>bool</b> <span id="r303 rd" class="r303 r">bindPipelineParametersResult</span> = <b>false</b>;
 
                    <b>if</b> (<span class="r302 r">continueBindingAfterScriptBlockProcessing</span>)
                    {
                        <span class="c">// If any of the parameters in the parameter set which are not yet bound</span>
                        <span class="c">// accept pipeline input, process the input object and bind to those</span>
                        <span class="c">// parameters</span>
 
                        <span class="r303 r">bindPipelineParametersResult</span> = <a href="#822f25084c0921f8" class="i method">BindPipelineParametersPrivate</a>(<span class="r298 r">inputToOperateOn</span>);
                    }
 
                    <span class="c">// We are successful at binding the pipeline input if there was a ScriptBlock to</span>
                    <span class="c">// run and it ran successfully or if we successfully bound a parameter based on</span>
                    <span class="c">// the pipeline input.</span>
 
                    <span class="r299 r">result</span> = (<span class="r300 r">thereWasSomethingToBind</span> &amp;&amp; <span class="r301 r">invokeScriptResult</span>) || <span class="r303 r">bindPipelineParametersResult</span>;
                }
            }
            <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>)
            {
                <span class="c">// Reset the default values</span>
                <span class="c">// This prevents the last pipeline object from being bound during EndProcessing</span>
                <span class="c">// if it failed some post binding verification step.</span>
                <a href="#beea52684e39dd34" class="k">this</a>.<span class="i">RestoreDefaultParameterValues</span>(<a href="ParameterBinderController.cs.html#d0bd55d2c98c7d2a" class="i property">ParametersBoundThroughPipelineInput</a>);
 
                <span class="c">// Let the parameter binding errors propagate out</span>
                <b>throw</b>;
            }
 
            <b>try</b>
            {
                <span class="c">// Now make sure we have latched on to a single parameter set.</span>
                <a href="#6300366950279e18" class="i method">VerifyParameterSetSelected</a>();
            }
            <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>)
            {
                <span class="c">// Reset the default values</span>
                <span class="c">// This prevents the last pipeline object from being bound during EndProcessing</span>
                <span class="c">// if it failed some post binding verification step.</span>
                <a href="#beea52684e39dd34" class="k">this</a>.<span class="i">RestoreDefaultParameterValues</span>(<a href="ParameterBinderController.cs.html#d0bd55d2c98c7d2a" class="i property">ParametersBoundThroughPipelineInput</a>);
 
                <b>throw</b>;
            }
 
            <b>if</b> (!<span class="r299 r">result</span>)
            {
                <span class="c">// Reset the default values</span>
                <span class="c">// This prevents the last pipeline object from being bound during EndProcessing</span>
                <span class="c">// if it failed some post binding verification step.</span>
                <a href="#beea52684e39dd34" class="k">this</a>.<span class="i">RestoreDefaultParameterValues</span>(<a href="ParameterBinderController.cs.html#d0bd55d2c98c7d2a" class="i property">ParametersBoundThroughPipelineInput</a>);
            }
 
            <b>return</b> <span class="r299 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Binds the pipeline parameters using the specified input and parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r304 r">inputToOperateOn</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pipeline input to be bound to the parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If argument transformation fails.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> The argument could not be coerced to the appropriate type for the parameter.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> The parameter argument transformation, prerequisite, or validation failed.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> If the binding to the parameter fails.</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c"> If there is a failure resetting values prior to binding from the pipeline</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The algorithm for binding the pipeline object is as follows. If any</span>
        <span class="c">///</span><span class="c"> step is successful true gets returned immediately.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> - If parameter supports ValueFromPipeline</span>
        <span class="c">///</span><span class="c">     - attempt to bind input value without type coercion</span>
        <span class="c">///</span><span class="c"> - If parameter supports ValueFromPipelineByPropertyName</span>
        <span class="c">///</span><span class="c">     - attempt to bind the value of the property with the matching name without type coercion</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Now see if we have a single valid parameter set and reset the validParameterSets flags as</span>
        <span class="c">///</span><span class="c"> necessary. If there are still multiple valid parameter sets, then we need to use TypeDistance</span>
        <span class="c">///</span><span class="c"> to determine which parameters to do type coercion binding on.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> - If parameter supports ValueFromPipeline</span>
        <span class="c">///</span><span class="c">     - attempt to bind input value using type coercion</span>
        <span class="c">///</span><span class="c"> - If parameter support ValueFromPipelineByPropertyName</span>
        <span class="c">///</span><span class="c">     - attempt to bind the vlue of the property with the matching name using type coercion</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="822f25084c0921f8" href="../R/822f25084c0921f8.html" target="n" data-glyph="76,1" class="i method">BindPipelineParametersPrivate</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r304 rd" class="r304 r">inputToOperateOn</span>)
        {
            <b>if</b> (<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#f5f0092873f47fa1" class="i property">IsEnabled</a>)
            {
                <a href="TypeTable.cs.html#d34ed619706e31fc" class="t t">ConsolidatedString</a> <span id="r305 rd" class="r305 r">dontuseInternalTypeNames</span>;
                <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(
                    <span class="s">&quot;PIPELINE object TYPE = [{0}]&quot;</span>,
                    <span class="r304 r">inputToOperateOn</span> == <b>null</b> || <span class="r304 r">inputToOperateOn</span> == <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>
                        ? <span class="s">&quot;null&quot;</span>
                        : ((<span class="r305 r">dontuseInternalTypeNames</span> = <span class="r304 r">inputToOperateOn</span>.<a href="MshObject.cs.html#829da48f79891848" class="i property">InternalTypeNames</a>).<span class="i">Count</span> &gt; 0 &amp;&amp; <span class="r305 r">dontuseInternalTypeNames</span>[0] != <b>null</b>)
                              ? <span class="r305 r">dontuseInternalTypeNames</span>[0]
                              : <span class="r304 r">inputToOperateOn</span>.<a href="MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>.<span class="i">GetType</span>().<span class="i">FullName</span>);
 
                <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#96aaf3813a5962a0" class="i method">WriteLine</a>(<span class="s">&quot;RESTORING pipeline parameter&#39;s original values&quot;</span>);
            }
 
            <b>bool</b> <span id="r306 rd" class="r306 r">result</span> = <b>false</b>;
 
            <span class="c">// Reset the default values</span>
 
            <a href="#beea52684e39dd34" class="k">this</a>.<span class="i">RestoreDefaultParameterValues</span>(<a href="ParameterBinderController.cs.html#d0bd55d2c98c7d2a" class="i property">ParametersBoundThroughPipelineInput</a>);
 
            <span class="c">// Now clear the parameter names from the previous pipeline input</span>
 
            <a href="ParameterBinderController.cs.html#d0bd55d2c98c7d2a" class="i property">ParametersBoundThroughPipelineInput</a>.<span class="i">Clear</span>();
 
            <span class="c">// Now restore the parameter set flags</span>
 
            <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> = <a href="ParameterBinderController.cs.html#fadc9fd52431d28e" class="i field">_prePipelineProcessingParameterSetFlags</a>;
            <b>uint</b> <span id="r307 rd" class="r307 r">validParameterSets</span> = <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>;
            <b>bool</b> <span id="r308 rd" class="r308 r">needToPrioritizeOneSpecificParameterSet</span> = <a href="#44000d600756d5de" class="i field">_parameterSetToBePrioritizedInPipelineBinding</a> != 0;
            <b>int</b> <span id="r309 rd" class="r309 r">steps</span> = <span class="r308 r">needToPrioritizeOneSpecificParameterSet</span> ? 2 : 1;
 
            <b>if</b> (<span class="r308 r">needToPrioritizeOneSpecificParameterSet</span>)
            {
                <span class="c">// _parameterSetToBePrioritizedInPipelineBinding is set, so we are certain that the specified parameter set must be valid,</span>
                <span class="c">// and it&#39;s not the only valid parameter set.</span>
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>((<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> &amp; <a href="#44000d600756d5de" class="i field">_parameterSetToBePrioritizedInPipelineBinding</a>) != 0, <span class="s">&quot;_parameterSetToBePrioritizedInPipelineBinding should be valid if it&#39;s set&quot;</span>);
                <span class="r307 r">validParameterSets</span> = <a href="#44000d600756d5de" class="i field">_parameterSetToBePrioritizedInPipelineBinding</a>;
            }
 
            <b>for</b> (<b>int</b> <span id="r310 rd" class="r310 r">i</span> = 0; <span class="r310 r">i</span> &lt; <span class="r309 r">steps</span>; <span class="r310 r">i</span>++)
            {
                <b>for</b> (<a href="#cd7fe53f420580d7" class="t t">CurrentlyBinding</a> <span id="r311 rd" class="r311 r">currentlyBinding</span> = <a href="#cd7fe53f420580d7" class="t t">CurrentlyBinding</a>.<a href="#df2debc7c4dc2ccd" class="i field">ValueFromPipelineNoCoercion</a>; <span class="r311 r">currentlyBinding</span> &lt;= <a href="#cd7fe53f420580d7" class="t t">CurrentlyBinding</a>.<a href="#560078e0ef8d21e6" class="i field">ValueFromPipelineByPropertyNameWithCoercion</a>; ++<span class="r311 r">currentlyBinding</span>)
                {
                    <span class="c">// The parameterBoundForCurrentlyBindingState will be true as long as there is one parameter gets bound, even if it belongs to AllSet</span>
                    <b>bool</b> <span id="r312 rd" class="r312 r">parameterBoundForCurrentlyBindingState</span> =
                        <a href="#3144c99665d386dc" class="i method">BindUnboundParametersForBindingState</a>(
                            <span class="r304 r">inputToOperateOn</span>,
                            <span class="r311 r">currentlyBinding</span>,
                            <span class="r307 r">validParameterSets</span>);
 
                    <b>if</b> (<span class="r312 r">parameterBoundForCurrentlyBindingState</span>)
                    {
                        <span class="c">// Now validate the parameter sets again and update the valid sets.</span>
                        <span class="c">// No need to validate the parameter sets and update the valid sets when dealing with the prioritized parameter set,</span>
                        <span class="c">// this is because the prioritized parameter set is a single set, and when binding succeeds, _currentParameterSetFlag</span>
                        <span class="c">// must be equal to the specific prioritized parameter set.</span>
                        <b>if</b> (!<span class="r308 r">needToPrioritizeOneSpecificParameterSet</span> || <span class="r310 r">i</span> == 1)
                        {
                            <a href="#57060ee3f765009b" class="i method">ValidateParameterSets</a>(<b>true</b>, <b>true</b>);
                            <span class="r307 r">validParameterSets</span> = <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>;
                        }
 
                        <span class="r306 r">result</span> = <b>true</b>;
                    }
                }
 
                <span class="c">// Update the validParameterSets after the binding attempt for the prioritized parameter set</span>
                <b>if</b> (<span class="r308 r">needToPrioritizeOneSpecificParameterSet</span> &amp;&amp; <span class="r310 r">i</span> == 0)
                {
                    <span class="c">// If the prioritized set can be bound successfully, there is no need to do the second round binding</span>
                    <b>if</b> (<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> == <a href="#44000d600756d5de" class="i field">_parameterSetToBePrioritizedInPipelineBinding</a>) <b>break</b>;
                    <span class="r307 r">validParameterSets</span> = <a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a> &amp; (~<a href="#44000d600756d5de" class="i field">_parameterSetToBePrioritizedInPipelineBinding</a>);
                }
            }
 
            <span class="c">// Now make sure we only have one valid parameter set</span>
            <span class="c">// Note, this will throw if we have more than one.</span>
 
            <a href="#57060ee3f765009b" class="i method">ValidateParameterSets</a>(<b>false</b>, <b>true</b>);
 
            <b>if</b> (!<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
            {
                <a href="#2452b196e5609c58" class="i method">ApplyDefaultParameterBinding</a>(<span class="s">&quot;PIPELINE BIND&quot;</span>, <b>false</b>);
            }
 
            <b>return</b> <span class="r306 r">result</span>;
        }
 
        <b>private bool</b> <a id="3144c99665d386dc" href="../R/3144c99665d386dc.html" target="n" data-glyph="76,1" class="i method">BindUnboundParametersForBindingState</a>(
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r313 rd" class="r313 r">inputToOperateOn</span>,
            <a href="#cd7fe53f420580d7" class="t t">CurrentlyBinding</a> <span id="r314 rd" class="r314 r">currentlyBinding</span>,
            <b>uint</b> <span id="r315 rd" class="r315 r">validParameterSets</span>)
        {
            <b>bool</b> <span id="r316 rd" class="r316 r">aParameterWasBound</span> = <b>false</b>;
 
            <span class="c">// First check to see if the default parameter set has been defined and if it</span>
            <span class="c">// is still valid.</span>
 
            <b>uint</b> <span id="r317 rd" class="r317 r">defaultParameterSetFlag</span> = <a href="#b4aec3f9fea80051" class="i field">_commandMetadata</a>.<a href="CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a>;
 
            <b>if</b> (<span class="r317 r">defaultParameterSetFlag</span> != 0 &amp;&amp; (<span class="r315 r">validParameterSets</span> &amp; <span class="r317 r">defaultParameterSetFlag</span>) != 0)
            {
                <span class="c">// Since we have a default parameter set and it is still valid, give preference to the</span>
                <span class="c">// parameters in the default set.</span>
 
                <span class="r316 r">aParameterWasBound</span> =
                    <a href="#34c6aefd61c9d4f6" class="i method">BindUnboundParametersForBindingStateInParameterSet</a>(
                        <span class="r313 r">inputToOperateOn</span>,
                        <span class="r314 r">currentlyBinding</span>,
                        <span class="r317 r">defaultParameterSetFlag</span>);
 
                <b>if</b> (!<span class="r316 r">aParameterWasBound</span>)
                {
                    <span class="r315 r">validParameterSets</span> &amp;= ~(<span class="r317 r">defaultParameterSetFlag</span>);
                }
            }
 
            <b>if</b> (!<span class="r316 r">aParameterWasBound</span>)
            {
                <span class="c">// Since nothing was bound for the default parameter set, try all</span>
                <span class="c">// the other parameter sets that are still valid.</span>
 
                <span class="r316 r">aParameterWasBound</span> =
                    <a href="#34c6aefd61c9d4f6" class="i method">BindUnboundParametersForBindingStateInParameterSet</a>(
                        <span class="r313 r">inputToOperateOn</span>,
                        <span class="r314 r">currentlyBinding</span>,
                        <span class="r315 r">validParameterSets</span>);
            }
 
            <a href="#620ce08548f60d6f" class="i field">s_tracer</a>.<a href="../utils/StructuredTraceSource.cs.html#451d38bf8c2b6b94" class="i method">WriteLine</a>(<span class="s">&quot;aParameterWasBound = {0}&quot;</span>, <span class="r316 r">aParameterWasBound</span>);
            <b>return</b> <span class="r316 r">aParameterWasBound</span>;
        }
 
        <b>private bool</b> <a id="34c6aefd61c9d4f6" href="../R/34c6aefd61c9d4f6.html" target="n" data-glyph="76,1" class="i method">BindUnboundParametersForBindingStateInParameterSet</a>(
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r318 rd" class="r318 r">inputToOperateOn</span>,
            <a href="#cd7fe53f420580d7" class="t t">CurrentlyBinding</a> <span id="r319 rd" class="r319 r">currentlyBinding</span>,
            <b>uint</b> <span id="r320 rd" class="r320 r">validParameterSets</span>)
        {
            <b>bool</b> <span id="r321 rd" class="r321 r">aParameterWasBound</span> = <b>false</b>;
 
            <span class="c">// For all unbound parameters in the parameter set, see if we can bind</span>
            <span class="c">// from the input object directly from pipeline without type coercion.</span>
            <span class="c">//</span>
            <span class="c">// We loop the unbound parameters in reversed order, so that we can move</span>
            <span class="c">// items from the unboundParameters collection to the boundParameters</span>
            <span class="c">// collection as we process, without the need to make a copy of the</span>
            <span class="c">// unboundParameters collection.</span>
            <span class="c">//</span>
            <span class="c">// We used to make a copy of UnboundParameters and loop from the head of the</span>
            <span class="c">// list. Now we are processing the unbound parameters from the end of the list.</span>
            <span class="c">// This change should NOT be a breaking change. The &#39;validParameterSets&#39; in</span>
            <span class="c">// this method never changes, so no matter we start from the head or the end of</span>
            <span class="c">// the list, every unbound parameter in the list that takes pipeline input and</span>
            <span class="c">// satisfy the &#39;validParameterSets&#39; will be bound. If parameters from more than</span>
            <span class="c">// one sets got bound, then &quot;parameter set cannot be resolved&quot; error will be thrown,</span>
            <span class="c">// which is expected.</span>
 
            <b>for</b> (<b>int</b> <span id="r322 rd" class="r322 r">i</span> = <a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>.<span class="i">Count</span> - 1; <span class="r322 r">i</span> &gt;= 0; <span class="r322 r">i</span>--)
            {
                <b>var</b> <span id="r323 rd" class="r323 r">parameter</span> = <a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>[<span class="r322 r">i</span>];
 
                <span class="c">// if the parameter is never a pipeline parameter, don&#39;t consider it</span>
                <b>if</b> (!<span class="r323 r">parameter</span>.<span class="i">Parameter</span>.<span class="i">IsPipelineParameterInSomeParameterSet</span>)
                    <b>continue</b>;
 
                <span class="c">// if the parameter is not in the specified parameter set, don&#39;t consider it</span>
                <b>if</b> ((<span class="r320 r">validParameterSets</span> &amp; <span class="r323 r">parameter</span>.<span class="i">Parameter</span>.<span class="i">ParameterSetFlags</span>) == 0 &amp;&amp;
                    !<span class="r323 r">parameter</span>.<span class="i">Parameter</span>.<span class="i">IsInAllSets</span>)
                {
                    <b>continue</b>;
                }
 
                <span class="c">// Get the appropriate parameter set data</span>
                <b>var</b> <span id="r324 rd" class="r324 r">parameterSetData</span> = <span class="r323 r">parameter</span>.<span class="i">Parameter</span>.<span class="i">GetMatchingParameterSetData</span>(<span class="r320 r">validParameterSets</span>);
 
                <b>bool</b> <span id="r325 rd" class="r325 r">bindResult</span> = <b>false</b>;
 
                <b>foreach</b> (<a href="ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r326 rd" class="r326 r">parameterSetMetadata</span> <b>in</b> <span class="r324 r">parameterSetData</span>)
                {
                    <span class="c">// In the first phase we try to bind the value from the pipeline without</span>
                    <span class="c">// type coercion</span>
 
                    <b>if</b> (<span class="r319 r">currentlyBinding</span> == <a href="#cd7fe53f420580d7" class="t t">CurrentlyBinding</a>.<a href="#df2debc7c4dc2ccd" class="i field">ValueFromPipelineNoCoercion</a> &amp;&amp;
                        <span class="r326 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#6b00e8f2cc8f5221" class="i property">ValueFromPipeline</a>)
                    {
                        <span class="r325 r">bindResult</span> = <span class="i">BindValueFromPipeline</span>(<span class="r318 r">inputToOperateOn</span>, <span class="r323 r">parameter</span>, <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#fc91c8b7242cb73c" class="i field">None</a>);
                    }
                    <span class="c">// In the next phase we try binding the value from the pipeline by matching</span>
                    <span class="c">// the property name</span>
                    <b>else</b> <b>if</b> (<span class="r319 r">currentlyBinding</span> == <a href="#cd7fe53f420580d7" class="t t">CurrentlyBinding</a>.<a href="#90757fcc31caeebd" class="i field">ValueFromPipelineByPropertyNameNoCoercion</a> &amp;&amp;
                        <span class="r326 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#9d3ceb11c1e2558a" class="i property">ValueFromPipelineByPropertyName</a> &amp;&amp;
                        <span class="r318 r">inputToOperateOn</span> != <b>null</b>)
                    {
                        <span class="r325 r">bindResult</span> = <span class="i">BindValueFromPipelineByPropertyName</span>(<span class="r318 r">inputToOperateOn</span>, <span class="r323 r">parameter</span>, <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#fc91c8b7242cb73c" class="i field">None</a>);
                    }
                    <span class="c">// The third step is to attempt to bind the value from the pipeline with</span>
                    <span class="c">// type coercion.</span>
                    <b>else</b> <b>if</b> (<span class="r319 r">currentlyBinding</span> == <a href="#cd7fe53f420580d7" class="t t">CurrentlyBinding</a>.<a href="#5f6e2039d3fe189a" class="i field">ValueFromPipelineWithCoercion</a> &amp;&amp;
                        <span class="r326 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#6b00e8f2cc8f5221" class="i property">ValueFromPipeline</a>)
                    {
                        <span class="r325 r">bindResult</span> = <span class="i">BindValueFromPipeline</span>(<span class="r318 r">inputToOperateOn</span>, <span class="r323 r">parameter</span>, <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a>);
                    }
                    <span class="c">// The final step is to attempt to bind the value from the pipeline by matching</span>
                    <span class="c">// the property name</span>
                    <b>else</b> <b>if</b> (<span class="r319 r">currentlyBinding</span> == <a href="#cd7fe53f420580d7" class="t t">CurrentlyBinding</a>.<a href="#560078e0ef8d21e6" class="i field">ValueFromPipelineByPropertyNameWithCoercion</a> &amp;&amp;
                        <span class="r326 r">parameterSetMetadata</span>.<a href="ParameterSetSpecificMetadata.cs.html#9d3ceb11c1e2558a" class="i property">ValueFromPipelineByPropertyName</a> &amp;&amp;
                        <span class="r318 r">inputToOperateOn</span> != <b>null</b>)
                    {
                        <span class="r325 r">bindResult</span> = <span class="i">BindValueFromPipelineByPropertyName</span>(<span class="r318 r">inputToOperateOn</span>, <span class="r323 r">parameter</span>, <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a>);
                    }
 
                    <b>if</b> (<span class="r325 r">bindResult</span>)
                    {
                        <span class="r321 r">aParameterWasBound</span> = <b>true</b>;
                        <b>break</b>;
                    }
                }
            }
 
            <b>return</b> <span class="r321 r">aParameterWasBound</span>;
        }
 
        <b>private bool</b> <a id="d4fdf129e8862774" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">BindValueFromPipeline</a>(
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r327 rd" class="r327 r">inputToOperateOn</span>,
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r328 rd" class="r328 r">parameter</span>,
            <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a> <span id="r329 rd" class="r329 r">flags</span>)
        {
            <b>bool</b> <span id="r330 rd" class="r330 r">bindResult</span> = <b>false</b>;
 
            <span class="c">// Attempt binding the value from the pipeline</span>
            <span class="c">// without type coercion</span>
 
            <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(
                ((<span class="r329 r">flags</span> &amp; <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a>) != 0) ?
                    <span class="s">&quot;Parameter [{0}] PIPELINE INPUT ValueFromPipeline WITH COERCION&quot;</span> :
                    <span class="s">&quot;Parameter [{0}] PIPELINE INPUT ValueFromPipeline NO COERCION&quot;</span>,
                <span class="r328 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>);
 
            <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r331 rd" class="r331 r">parameterBindingException</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r330 r">bindResult</span> = <a href="#b003a06fb441c091" class="i method">BindPipelineParameter</a>(<span class="r327 r">inputToOperateOn</span>, <span class="r328 r">parameter</span>, <span class="r329 r">flags</span>);
            }
            <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#3585a1c095cead84" class="t t">ParameterBindingArgumentTransformationException</a> <span id="r332 rd" class="r332 r">e</span>)
            {
                <a href="ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a> <span id="r333 rd" class="r333 r">invalidCast</span>;
                <b>if</b> (<span class="r332 r">e</span>.<span class="i">InnerException</span> <b>is</b> <a href="../utils/MetadataExceptions.cs.html#722d7d23ff4e1a1a" class="t t">ArgumentTransformationMetadataException</a>)
                {
                    <span class="r333 r">invalidCast</span> = <span class="r332 r">e</span>.<span class="i">InnerException</span>.<span class="i">InnerException</span> <b>as</b> <a href="ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a>;
                }
                <b>else</b>
                {
                    <span class="r333 r">invalidCast</span> = <span class="r332 r">e</span>.<span class="i">InnerException</span> <b>as</b> <a href="ExtendedTypeSystemException.cs.html#d39d66bdddfa507c" class="t t">PSInvalidCastException</a>;
                }
 
                <b>if</b> (<span class="r333 r">invalidCast</span> == <b>null</b>)
                {
                    <span class="r331 r">parameterBindingException</span> = <span class="r332 r">e</span>;
                }
                <span class="c">// Just ignore and continue;</span>
                <span class="r330 r">bindResult</span> = <b>false</b>;
            }
            <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#e39f77ef0b39d632" class="t t">ParameterBindingValidationException</a> <span id="r334 rd" class="r334 r">e</span>)
            {
                <span class="r331 r">parameterBindingException</span> = <span class="r334 r">e</span>;
            }
            <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#025f44cd23269a6e" class="t t">ParameterBindingParameterDefaultValueException</a> <span id="r335 rd" class="r335 r">e</span>)
            {
                <span class="r331 r">parameterBindingException</span> = <span class="r335 r">e</span>;
            }
            <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>)
            {
                <span class="c">// Just ignore and continue;</span>
                <span class="r330 r">bindResult</span> = <b>false</b>;
            }
 
            <b>if</b> (<span class="r331 r">parameterBindingException</span> != <b>null</b>)
            {
                <b>if</b> (!<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
                {
                    <b>throw</b> <span class="r331 r">parameterBindingException</span>;
                }
                <b>else</b>
                {
                    <a href="ParameterBinderController.cs.html#a9066724fc9cbe64" class="i method">ThrowElaboratedBindingException</a>(<span class="r331 r">parameterBindingException</span>);
                }
            }
 
            <b>return</b> <span class="r330 r">bindResult</span>;
        }
 
        <b>private bool</b> <a id="fa22b41c7e29625e" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">BindValueFromPipelineByPropertyName</a>(
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r336 rd" class="r336 r">inputToOperateOn</span>,
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r337 rd" class="r337 r">parameter</span>,
            <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a> <span id="r338 rd" class="r338 r">flags</span>)
        {
            <b>bool</b> <span id="r339 rd" class="r339 r">bindResult</span> = <b>false</b>;
 
            <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#25b8416175e53218" class="i method">WriteLine</a>(
                ((<span class="r338 r">flags</span> &amp; <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a>) != 0) ?
                    <span class="s">&quot;Parameter [{0}] PIPELINE INPUT ValueFromPipelineByPropertyName WITH COERCION&quot;</span> :
                    <span class="s">&quot;Parameter [{0}] PIPELINE INPUT ValueFromPipelineByPropertyName NO COERCION&quot;</span>,
                <span class="r337 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>);
 
            <a href="MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a> <span id="r340 rd" class="r340 r">member</span> = <span class="r336 r">inputToOperateOn</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r337 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>];
 
            <b>if</b> (<span class="r340 r">member</span> == <b>null</b>)
            {
                <span class="c">// Since a member matching the name of the parameter wasn&#39;t found,</span>
                <span class="c">// check the aliases.</span>
 
                <b>foreach</b> (<b>string</b> <span id="r341 rd" class="r341 r">alias</span> <b>in</b> <span class="r337 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#029c8e124435d0fd" class="i property">Aliases</a>)
                {
                    <span class="r340 r">member</span> = <span class="r336 r">inputToOperateOn</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a><a href="MshMemberInfo.cs.html#f603b32aa49d3ffa">[</a><span class="r341 r">alias</span>];
 
                    <b>if</b> (<span class="r340 r">member</span> != <b>null</b>)
                    {
                        <b>break</b>;
                    }
                }
            }
 
            <b>if</b> (<span class="r340 r">member</span> != <b>null</b>)
            {
                <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r342 rd" class="r342 r">parameterBindingException</span> = <b>null</b>;
                <b>try</b>
                {
                    <span class="r339 r">bindResult</span> =
                        <a href="#b003a06fb441c091" class="i method">BindPipelineParameter</a>(
                            <span class="r340 r">member</span>.<a href="MshMemberInfo.cs.html#cd3a9989baedf3dd" class="i property">Value</a>,
                            <span class="r337 r">parameter</span>,
                            <span class="r338 r">flags</span>);
                }
                <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#3585a1c095cead84" class="t t">ParameterBindingArgumentTransformationException</a> <span id="r343 rd" class="r343 r">e</span>)
                {
                    <span class="r342 r">parameterBindingException</span> = <span class="r343 r">e</span>;
                }
                <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#e39f77ef0b39d632" class="t t">ParameterBindingValidationException</a> <span id="r344 rd" class="r344 r">e</span>)
                {
                    <span class="r342 r">parameterBindingException</span> = <span class="r344 r">e</span>;
                }
                <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#025f44cd23269a6e" class="t t">ParameterBindingParameterDefaultValueException</a> <span id="r345 rd" class="r345 r">e</span>)
                {
                    <span class="r342 r">parameterBindingException</span> = <span class="r345 r">e</span>;
                }
                <b>catch</b> (<a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>)
                {
                    <span class="c">// Just ignore and continue;</span>
                    <span class="r339 r">bindResult</span> = <b>false</b>;
                }
 
                <b>if</b> (<span class="r342 r">parameterBindingException</span> != <b>null</b>)
                {
                    <b>if</b> (!<a href="ParameterBinderController.cs.html#6f34f8dc3c4c2aaf" class="i property">DefaultParameterBindingInUse</a>)
                    {
                        <b>throw</b> <span class="r342 r">parameterBindingException</span>;
                    }
                    <b>else</b>
                    {
                        <a href="ParameterBinderController.cs.html#a9066724fc9cbe64" class="i method">ThrowElaboratedBindingException</a>(<span class="r342 r">parameterBindingException</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r339 r">bindResult</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used for defining the state of the binding state machine.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private enum</b> <a id="cd7fe53f420580d7" href="../R/cd7fe53f420580d7.html" target="n" data-glyph="22,1" class="t t"><span id="01d32dba1d6c7211">CurrentlyBinding</span></a>
        {
            <a id="df2debc7c4dc2ccd" href="../R/df2debc7c4dc2ccd.html" target="n" data-glyph="24,2" class="i field">ValueFromPipelineNoCoercion</a> = 0,
            <a id="90757fcc31caeebd" href="../R/90757fcc31caeebd.html" target="n" data-glyph="24,2" class="i field">ValueFromPipelineByPropertyNameNoCoercion</a> = 1,
            <a id="5f6e2039d3fe189a" href="../R/5f6e2039d3fe189a.html" target="n" data-glyph="24,2" class="i field">ValueFromPipelineWithCoercion</a> = 2,
            <a id="560078e0ef8d21e6" href="../R/560078e0ef8d21e6.html" target="n" data-glyph="24,2" class="i field">ValueFromPipelineByPropertyNameWithCoercion</a> = 3
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Invokes any delay bind script blocks and binds the resulting value</span>
        <span class="c">///</span><span class="c"> to the appropriate parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r346 r">inputToOperateOn</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The input to the script block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r347 r">thereWasSomethingToBind</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns True if there was a ScriptBlock to invoke and bind, or false if there</span>
        <span class="c">///</span><span class="c"> are no ScriptBlocks to invoke.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the binding succeeds, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r346 r">inputToOperateOn</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If execution of the script block throws an exception or if it doesn&#39;t produce</span>
        <span class="c">///</span><span class="c"> any output.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="6dcaf4af764711d3" href="../R/6dcaf4af764711d3.html" target="n" data-glyph="76,1" class="i method">InvokeAndBindDelayBindScriptBlock</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r346 rd" class="r346 r">inputToOperateOn</span>, <b>out bool</b> <span id="r347 rd" class="r347 r">thereWasSomethingToBind</span>)
        {
            <span class="r347 r">thereWasSomethingToBind</span> = <b>false</b>;
            <b>bool</b> <span id="r348 rd" class="r348 r">result</span> = <b>true</b>;
 
            <span class="c">// NOTE: we are not doing backup and restore of default parameter</span>
            <span class="c">// values here.  It is not needed because each script block will be</span>
            <span class="c">// invoked and each delay bind parameter bound for each pipeline object.</span>
            <span class="c">// This is unlike normal pipeline object processing which may bind</span>
            <span class="c">// different parameters depending on the type of the incoming pipeline</span>
            <span class="c">// object.</span>
 
            <span class="c">// Loop through each of the delay bind script blocks and invoke them.</span>
            <span class="c">// Bind the result to the associated parameter</span>
 
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="#6c106f272135c12d" class="t t">DelayedScriptBlockArgument</a>&gt; <span id="r349 rd" class="r349 r">delayedScriptBlock</span> <b>in</b> <a href="#1c8d945f0156df74" class="i field">_delayBindScriptBlocks</a>)
            {
                <span class="r347 r">thereWasSomethingToBind</span> = <b>true</b>;
 
                <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r350 rd" class="r350 r">argument</span> = <span class="r349 r">delayedScriptBlock</span>.<span class="i">Value</span>.<span class="i">_argument</span>;
                <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r351 rd" class="r351 r">parameter</span> = <span class="r349 r">delayedScriptBlock</span>.<span class="i">Key</span>;
 
                <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r352 rd" class="r352 r">script</span> = <span class="r350 r">argument</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a> <b>as</b> <a href="../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>;
 
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                    <span class="r352 r">script</span> != <b>null</b>,
                    <span class="s">&quot;An argument should only be put in the delayBindScriptBlocks collection if it is a ScriptBlock&quot;</span>);
 
                <span class="i">Collection</span>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r353 rd" class="r353 r">output</span> = <b>null</b>;
 
                <span class="i">Exception</span> <span id="r354 rd" class="r354 r">error</span> = <b>null</b>;
                <b>using</b> (<a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a>.<a href="ParameterBinderBase.cs.html#53b6cf6cdd8c3311" class="i field">bindingTracer</a>.<a href="../utils/StructuredTraceSource.cs.html#19ce116f88d7b1c7" class="i method">TraceScope</a>(
                    <span class="s">&quot;Invoking delay-bind ScriptBlock&quot;</span>))
                {
                    <b>if</b> (<span class="r349 r">delayedScriptBlock</span>.<span class="i">Value</span>.<span class="i">_parameterBinder</span> == <a href="#beea52684e39dd34" class="k">this</a>)
                    {
                        <b>try</b>
                        {
                            <span class="r353 r">output</span> = <span class="r352 r">script</span>.<span class="i">DoInvoke</span>(<span class="r346 r">inputToOperateOn</span>, <span class="r346 r">inputToOperateOn</span>, <span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>object</b>&gt;());
                            <span class="r349 r">delayedScriptBlock</span>.<span class="i">Value</span>.<span class="i">_evaluatedArgument</span> = <span class="r353 r">output</span>;
                        }
                        <b>catch</b> (<a href="../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a> <span id="r355 rd" class="r355 r">runtimeException</span>)
                        {
                            <span class="r354 r">error</span> = <span class="r355 r">runtimeException</span>;
                        }
                    }
                    <b>else</b>
                    {
                        <span class="r353 r">output</span> = <span class="r349 r">delayedScriptBlock</span>.<span class="i">Value</span>.<span class="i">_evaluatedArgument</span>;
                    }
                }
 
                <b>if</b> (<span class="r354 r">error</span> != <b>null</b>)
                {
                    <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r356 rd" class="r356 r">bindingException</span> =
                        <b>new</b> <span class="t">ParameterBindingException</span>(
                            <span class="r354 r">error</span>,
                            <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                            <a href="ParameterBinderController.cs.html#a9e5006bea1e5324" class="i method">GetErrorExtent</a>(<span class="r350 r">argument</span>),
                            <span class="r351 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>,
                            <b>null</b>,
                            <b>null</b>,
                            <span class="i">ParameterBinderStrings</span>.<span class="i">ScriptBlockArgumentInvocationFailed</span>,
                            <span class="s">&quot;ScriptBlockArgumentInvocationFailed&quot;</span>,
                            <span class="r354 r">error</span>.<span class="i">Message</span>);
 
                    <b>throw</b> <span class="r356 r">bindingException</span>;
                }
 
                <b>if</b> (<span class="r353 r">output</span> == <b>null</b> || <span class="r353 r">output</span>.<span class="i">Count</span> == 0)
                {
                    <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r357 rd" class="r357 r">bindingException</span> =
                        <b>new</b> <span class="t">ParameterBindingException</span>(
                            <b>null</b>,
                            <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                            <a href="ParameterBinderController.cs.html#a9e5006bea1e5324" class="i method">GetErrorExtent</a>(<span class="r350 r">argument</span>),
                            <span class="r351 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>,
                            <b>null</b>,
                            <b>null</b>,
                            <span class="i">ParameterBinderStrings</span>.<span class="i">ScriptBlockArgumentNoOutput</span>,
                            <span class="s">&quot;ScriptBlockArgumentNoOutput&quot;</span>);
 
                    <b>throw</b> <span class="r357 r">bindingException</span>;
                }
 
                <span class="c">// Check the output.  If it is only a single value, just pass the single value,</span>
                <span class="c">// if not, pass in the whole collection.</span>
 
                <b>object</b> <span id="r358 rd" class="r358 r">newValue</span> = <span class="r353 r">output</span>;
                <b>if</b> (<span class="r353 r">output</span>.<span class="i">Count</span> == 1)
                {
                    <span class="r358 r">newValue</span> = <span class="r353 r">output</span>[0];
                }
 
                <span class="c">// Create a new CommandParameterInternal for the output of the script block.</span>
                <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="k">var</a> <span id="r359 rd" class="r359 r">newArgument</span> = <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>(
                    <span class="r350 r">argument</span>.<a href="CommandParameter.cs.html#74d736f52a784a08" class="i property">ParameterAst</a>, <span class="r350 r">argument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a>, <span class="s">&quot;-&quot;</span> + <span class="r350 r">argument</span>.<a href="CommandParameter.cs.html#8a262faeff991e7d" class="i property">ParameterName</a> + <span class="s">&quot;:&quot;</span>,
                    <span class="r350 r">argument</span>.<a href="CommandParameter.cs.html#74477d6db015267b" class="i property">ArgumentAst</a>, <span class="r358 r">newValue</span>,
                    <b>false</b>);
 
                <b>if</b> (!<a href="#d2fdd848ef4bdf7a" class="i method">BindParameter</a>(<span class="r359 r">newArgument</span>, <span class="r351 r">parameter</span>, <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#624cb715ac400e62" class="i field">ShouldCoerceType</a>))
                {
                    <span class="r348 r">result</span> = <b>false</b>;
                }
            }
 
            <b>return</b> <span class="r348 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines the number of valid parameter sets based on the valid parameter</span>
        <span class="c">///</span><span class="c"> set flags.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r360 r">parameterSetFlags</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The valid parameter set flags.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The number of valid parameter sets in the parameterSetFlags.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="3a6a88ae705b1bbb" href="../R/3a6a88ae705b1bbb.html" target="n" data-glyph="76,1" class="i method">ValidParameterSetCount</a>(<b>uint</b> <span id="r360 rd" class="r360 r">parameterSetFlags</span>)
        {
            <b>int</b> <span id="r361 rd" class="r361 r">result</span> = 0;
 
            <b>if</b> (<span class="r360 r">parameterSetFlags</span> == <b>uint</b>.<span class="i">MaxValue</span>)
            {
                <span class="r361 r">result</span> = 1;
            }
            <b>else</b>
            {
                <b>while</b> (<span class="r360 r">parameterSetFlags</span> != 0)
                {
                    <span class="r361 r">result</span> += (<b>int</b>)(<span class="r360 r">parameterSetFlags</span> &amp; 0x1);
                    <span class="r360 r">parameterSetFlags</span> &gt;&gt;= 1;
                }
            }
 
            <b>return</b> <span class="r361 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> helper_methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> private_members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This method gets a backup of the default value of a parameter.</span>
        <span class="c">///</span><span class="c"> Derived classes may override this method to get the default parameter</span>
        <span class="c">///</span><span class="c"> value in a different way.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r362 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the parameter to get the default value of.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value of the parameter specified by name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#025f44cd23269a6e" class="t t">ParameterBindingParameterDefaultValueException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the parameter binder encounters an error getting the default value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal object</b> <a id="84033b493c35130e" href="../R/84033b493c35130e.html" target="n" data-glyph="74,1" class="i method">GetDefaultParameterValue</a>(<b>string</b> <span id="r362 rd" class="r362 r">name</span>)
        {
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r363 rd" class="r363 r">matchingParameter</span> =
                <a href="ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>.<a href="MergedCommandParameterMetadata.cs.html#7f23a99ce96423e1" class="i method">GetMatchingParameter</a>(
                    <span class="r362 r">name</span>,
                    <b>false</b>,
                    <b>true</b>,
                    <b>null</b>);
 
            <b>object</b> <span id="r364 rd" class="r364 r">result</span> = <b>null</b>;
 
            <b>try</b>
            {
                <b>switch</b> (<span class="r363 r">matchingParameter</span>.<a href="MergedCommandParameterMetadata.cs.html#dfdaee66f98b9a67" class="i property">BinderAssociation</a>)
                {
                    <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#515e5d093bc20be2" class="i field">DeclaredFormalParameters</a>:
                        <span class="r364 r">result</span> = <a href="ParameterBinderController.cs.html#ce76907c0e73fffa" class="i property">DefaultParameterBinder</a>.<a href="ParameterBinderBase.cs.html#5b59a05c2ca863a1" class="i method">GetDefaultParameterValue</a>(<span class="r362 r">name</span>);
                        <b>break</b>;
 
                    <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#5061cf0360fde0b5" class="i field">CommonParameters</a>:
                        <span class="r364 r">result</span> = <a href="#c79452d10d14674c" class="i property">CommonParametersBinder</a>.<a href="ReflectionParameterBinder.cs.html#06d656a99e027734" class="i method">GetDefaultParameterValue</a>(<span class="r362 r">name</span>);
                        <b>break</b>;
 
                    <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#c60a12a7e7110562" class="i field">ShouldProcessParameters</a>:
                        <span class="r364 r">result</span> = <a href="#3dd609bc9dee03ea" class="i property">ShouldProcessParametersBinder</a>.<a href="ReflectionParameterBinder.cs.html#06d656a99e027734" class="i method">GetDefaultParameterValue</a>(<span class="r362 r">name</span>);
                        <b>break</b>;
 
                    <b>case</b> <a href="MergedCommandParameterMetadata.cs.html#977e057a7512768d" class="t t">ParameterBinderAssociation</a>.<a href="MergedCommandParameterMetadata.cs.html#13d23785e977caeb" class="i field">DynamicParameters</a>:
                        <b>if</b> (<a href="#d9416506792d8d98" class="i field">_dynamicParameterBinder</a> != <b>null</b>)
                        {
                            <span class="r364 r">result</span> = <a href="#d9416506792d8d98" class="i field">_dynamicParameterBinder</a>.<a href="ParameterBinderBase.cs.html#5b59a05c2ca863a1" class="i method">GetDefaultParameterValue</a>(<span class="r362 r">name</span>);
                        }
 
                        <b>break</b>;
                }
            }
            <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#396f7c7b826437d7" class="t t">GetValueException</a> <span id="r365 rd" class="r365 r">getValueException</span>)
            {
                <a href="../utils/ParameterBinderExceptions.cs.html#025f44cd23269a6e" class="t t">ParameterBindingParameterDefaultValueException</a> <span id="r366 rd" class="r366 r">bindingError</span> =
                    <b>new</b> <span class="t">ParameterBindingParameterDefaultValueException</span>(
                        <span class="r365 r">getValueException</span>,
                        <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#cad1e0e3e13dc1f3" class="i field">ReadError</a>,
                        <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>.<a href="CommandBase.cs.html#f81679c755698e2e" class="i property">MyInvocation</a>,
                        <b>null</b>,
                        <span class="r362 r">name</span>,
                        <b>null</b>,
                        <b>null</b>,
                        <span class="s">&quot;ParameterBinderStrings&quot;</span>,
                        <span class="s">&quot;GetDefaultValueFailed&quot;</span>,
                        <span class="r365 r">getValueException</span>.<span class="i">Message</span>);
 
                <b>throw</b> <span class="r366 r">bindingError</span>;
            }
 
            <b>return</b> <span class="r364 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the command that this parameter binder controller</span>
        <span class="c">///</span><span class="c"> will bind parameters to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <a id="fe713c9e71fbf172" href="../R/fe713c9e71fbf172.html" target="n" data-glyph="104,1" class="i property">Command</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> DefaultParameterBindingStructures
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The separator used in GetDefaultParameterValuePairs function.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private const string</b> <a id="c3f881c8e5d649fb" href="../R/c3f881c8e5d649fb.html" target="n" data-glyph="10,1" class="i field">Separator</a> = <span class="s">&quot;:::&quot;</span>;
 
        <span class="c">// Hold all aliases of the current cmdlet</span>
        <b>private</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="0d51d1c8f0bbdc50" href="../R/0d51d1c8f0bbdc50.html" target="n" data-glyph="46,1" class="i field">_aliasList</a>;
        <span class="c">// Method GetDefaultParameterValuePairs() will be invoked twice, one time before the Named Bind,</span>
        <span class="c">// one time after Dynamic Bind. We don&#39;t want the same warning message to be written out twice.</span>
        <span class="c">// Put the key(in case the key format is invalid), or cmdletName+separator+parameterName(in case</span>
        <span class="c">// setting resolves to multiple parameters or multiple different values are assigned to the same</span>
        <span class="c">// parameter) in warningSet when the corresponding warnings are written out, so they won&#39;t get</span>
        <span class="c">// written out the second time GetDefaultParameterValuePairs() is called.</span>
        <b>private readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="275643992f88c4ca" href="../R/275643992f88c4ca.html" target="n" data-glyph="46,1" class="i field">_warningSet</a> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;();
 
        <span class="c">// Hold all user defined default parameter values</span>
        <b>private</b> <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <b>object</b>&gt; <a id="902abe29e4a9e389" href="../R/902abe29e4a9e389.html" target="n" data-glyph="46,1" class="i field">_allDefaultParameterValuePairs</a>;
        <b>private bool</b> <a id="c430d3d1b818934d" href="../R/c430d3d1b818934d.html" target="n" data-glyph="46,1" class="i field">_useDefaultParameterBinding</a> = <b>true</b>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> DefaultParameterBindingStructures
 
        <b>private uint</b> <a id="44000d600756d5de" href="../R/44000d600756d5de.html" target="n" data-glyph="46,1" class="i field">_parameterSetToBePrioritizedInPipelineBinding</a> = 0;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The cmdlet metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="CommandMetadata.cs.html#543f906b9137ce10" class="t t">CommandMetadata</a> <a id="b4aec3f9fea80051" href="../R/b4aec3f9fea80051.html" target="n" data-glyph="46,1" class="i field">_commandMetadata</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> THe command runtime object for this cmdlet.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <a href="MshCommandRuntime.cs.html#f9ebe6a3b284ab55" class="t t">MshCommandRuntime</a> <a id="107fc4b9167dce2a" href="../R/107fc4b9167dce2a.html" target="n" data-glyph="46,1" class="i field">_commandRuntime</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Keep the obsolete parameter warnings generated from parameter binding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <span class="i">List</span>&lt;<a href="hostifaces/InformationalRecord.cs.html#59cd69dde48b9557" class="t t">WarningRecord</a>&gt; <a id="f317c00dad07ba60" href="../R/f317c00dad07ba60.html" target="n" data-glyph="104,1" class="i property">ObsoleteParameterWarningList</a> { <b>get</b>; <b>private set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Keep names of the parameters for which we have generated obsolete warning messages.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="e0b1677d418ee076" href="../R/e0b1677d418ee076.html" target="n" data-glyph="106,1" class="i property">BoundObsoleteParameterNames</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#1b4c7b977e6c454e" class="i field">_boundObsoleteParameterNames</a> ??= <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            }
        }
 
        <b>private</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="1b4c7b977e6c454e" href="../R/1b4c7b977e6c454e.html" target="n" data-glyph="46,1" class="i field">_boundObsoleteParameterNames</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter binder for the dynamic parameters. Currently this</span>
        <span class="c">///</span><span class="c"> can be either a ReflectionParameterBinder or a RuntimeDefinedParameterBinder.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private</b> <a href="ParameterBinderBase.cs.html#6a035e6bf95bfc67" class="t t">ParameterBinderBase</a> <a id="d9416506792d8d98" href="../R/d9416506792d8d98.html" target="n" data-glyph="46,1" class="i field">_dynamicParameterBinder</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter binder for the ShouldProcess parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ReflectionParameterBinder.cs.html#ce5c5179dbfe8fcf" class="t t">ReflectionParameterBinder</a> <a id="3dd609bc9dee03ea" href="../R/3dd609bc9dee03ea.html" target="n" data-glyph="104,1" class="i property">ShouldProcessParametersBinder</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#89bb2637f6d3770d" class="i field">_shouldProcessParameterBinder</a> == <b>null</b>)
                {
                    <span class="c">// Construct a new instance of the should process parameters object</span>
                    <a href="UserFeedbackParameters.cs.html#bc412e9aa0179760" class="t t">ShouldProcessParameters</a> <span id="r367 rd" class="r367 r">shouldProcessParameters</span> = <b>new</b> <a href="UserFeedbackParameters.cs.html#d4a69f323c91d4f7" class="t constructor">ShouldProcessParameters</a>(<a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>);
 
                    <span class="c">// Create reflection binder for this object</span>
 
                    <a href="#89bb2637f6d3770d" class="i field">_shouldProcessParameterBinder</a> =
                        <b>new</b> <a href="ReflectionParameterBinder.cs.html#419c6cd460edf2d3" class="t constructor">ReflectionParameterBinder</a>(
                            <span class="r367 r">shouldProcessParameters</span>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#0b62798bea43a39e" class="i property">CommandLineParameters</a>);
                }
 
                <b>return</b> <a href="#89bb2637f6d3770d" class="i field">_shouldProcessParameterBinder</a>;
            }
        }
 
        <b>private</b> <a href="ReflectionParameterBinder.cs.html#ce5c5179dbfe8fcf" class="t t">ReflectionParameterBinder</a> <a id="89bb2637f6d3770d" href="../R/89bb2637f6d3770d.html" target="n" data-glyph="46,1" class="i field">_shouldProcessParameterBinder</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter binder for the Paging parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ReflectionParameterBinder.cs.html#ce5c5179dbfe8fcf" class="t t">ReflectionParameterBinder</a> <a id="c1b26462629998f8" href="../R/c1b26462629998f8.html" target="n" data-glyph="104,1" class="i property">PagingParametersBinder</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#25340fd3855d2b40" class="i field">_pagingParameterBinder</a> == <b>null</b>)
                {
                    <span class="c">// Construct a new instance of the should process parameters object</span>
                    <a href="UserFeedbackParameters.cs.html#19fbf494d8a3adaf" class="t t">PagingParameters</a> <span id="r368 rd" class="r368 r">pagingParameters</span> = <b>new</b> <a href="UserFeedbackParameters.cs.html#064206ef3ea80de5" class="t constructor">PagingParameters</a>(<a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>);
 
                    <span class="c">// Create reflection binder for this object</span>
 
                    <a href="#25340fd3855d2b40" class="i field">_pagingParameterBinder</a> =
                        <b>new</b> <a href="ReflectionParameterBinder.cs.html#419c6cd460edf2d3" class="t constructor">ReflectionParameterBinder</a>(
                            <span class="r368 r">pagingParameters</span>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#0b62798bea43a39e" class="i property">CommandLineParameters</a>);
                }
 
                <b>return</b> <a href="#25340fd3855d2b40" class="i field">_pagingParameterBinder</a>;
            }
        }
 
        <b>private</b> <a href="ReflectionParameterBinder.cs.html#ce5c5179dbfe8fcf" class="t t">ReflectionParameterBinder</a> <a id="25340fd3855d2b40" href="../R/25340fd3855d2b40.html" target="n" data-glyph="46,1" class="i field">_pagingParameterBinder</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter binder for the Transactions parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ReflectionParameterBinder.cs.html#ce5c5179dbfe8fcf" class="t t">ReflectionParameterBinder</a> <a id="7ca9748670fc564e" href="../R/7ca9748670fc564e.html" target="n" data-glyph="104,1" class="i property">TransactionParametersBinder</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#4437430c31fd5ec3" class="i field">_transactionParameterBinder</a> == <b>null</b>)
                {
                    <span class="c">// Construct a new instance of the transactions parameters object</span>
                    <a href="UserFeedbackParameters.cs.html#88f4e3c74eecfca7" class="t t">TransactionParameters</a> <span id="r369 rd" class="r369 r">transactionParameters</span> = <b>new</b> <a href="UserFeedbackParameters.cs.html#fe863e9f216c6724" class="t constructor">TransactionParameters</a>(<a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>);
 
                    <span class="c">// Create reflection binder for this object</span>
 
                    <a href="#4437430c31fd5ec3" class="i field">_transactionParameterBinder</a> =
                        <b>new</b> <a href="ReflectionParameterBinder.cs.html#419c6cd460edf2d3" class="t constructor">ReflectionParameterBinder</a>(
                            <span class="r369 r">transactionParameters</span>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#0b62798bea43a39e" class="i property">CommandLineParameters</a>);
                }
 
                <b>return</b> <a href="#4437430c31fd5ec3" class="i field">_transactionParameterBinder</a>;
            }
        }
 
        <b>private</b> <a href="ReflectionParameterBinder.cs.html#ce5c5179dbfe8fcf" class="t t">ReflectionParameterBinder</a> <a id="4437430c31fd5ec3" href="../R/4437430c31fd5ec3.html" target="n" data-glyph="46,1" class="i field">_transactionParameterBinder</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter binder for the CommonParameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal</b> <a href="ReflectionParameterBinder.cs.html#ce5c5179dbfe8fcf" class="t t">ReflectionParameterBinder</a> <a id="c79452d10d14674c" href="../R/c79452d10d14674c.html" target="n" data-glyph="104,1" class="i property">CommonParametersBinder</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#102fbb2407d64467" class="i field">_commonParametersBinder</a> == <b>null</b>)
                {
                    <span class="c">// Construct a new instance of the user feedback parameters object</span>
                    <a href="CommonCommandParameters.cs.html#2ad29128f1bdef2a" class="t t">CommonParameters</a> <span id="r370 rd" class="r370 r">commonParameters</span> = <b>new</b> <a href="CommonCommandParameters.cs.html#33d53b500f5c9c3e" class="t constructor">CommonParameters</a>(<a href="#107fc4b9167dce2a" class="i field">_commandRuntime</a>);
 
                    <span class="c">// Create reflection binder for this object</span>
 
                    <a href="#102fbb2407d64467" class="i field">_commonParametersBinder</a> =
                        <b>new</b> <a href="ReflectionParameterBinder.cs.html#419c6cd460edf2d3" class="t constructor">ReflectionParameterBinder</a>(
                            <span class="r370 r">commonParameters</span>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="#fe713c9e71fbf172" class="i property">Command</a>,
                            <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#0b62798bea43a39e" class="i property">CommandLineParameters</a>);
                }
 
                <b>return</b> <a href="#102fbb2407d64467" class="i field">_commonParametersBinder</a>;
            }
        }
 
        <b>private</b> <a href="ReflectionParameterBinder.cs.html#ce5c5179dbfe8fcf" class="t t">ReflectionParameterBinder</a> <a id="102fbb2407d64467" href="../R/102fbb2407d64467.html" target="n" data-glyph="46,1" class="i field">_commonParametersBinder</a>;
 
        <b>private sealed class</b> <a id="6c106f272135c12d" href="../R/6c106f272135c12d.html" target="n" data-glyph="4,1" class="t t"><span id="2d00b974751765d9">DelayedScriptBlockArgument</span></a>
        {
            <span class="c">// Remember the parameter binder so we know when to invoke the script block</span>
            <span class="c">// and when to use the evaluated argument.</span>
            <b>internal</b> <a href="#beea52684e39dd34" class="t t">CmdletParameterBinderController</a> <a id="edfba978d2fc060a" href="../R/edfba978d2fc060a.html" target="n" data-glyph="44,2" class="i field">_parameterBinder</a>;
            <b>internal</b> <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <a id="b090366c313f61bb" href="../R/b090366c313f61bb.html" target="n" data-glyph="44,2" class="i field">_argument</a>;
            <b>internal</b> <span class="i">Collection</span>&lt;<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <a id="4f398bccb7748b14" href="../R/../../0000000000.html" target="n" data-glyph="44,2" class="i field">_evaluatedArgument</a>;
 
            <b>public override string</b> <a id="05ded73c68508dad" href="../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">ToString</a>()
            {
                <b>return</b> <a href="#b090366c313f61bb" class="i field">_argument</a>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>.<span class="i">ToString</span>();
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This dictionary is used to contain the arguments that were passed in as ScriptBlocks</span>
        <span class="c">///</span><span class="c"> but the parameter isn&#39;t a ScriptBlock. So we have to wait to bind the parameter</span>
        <span class="c">///</span><span class="c"> until there is a pipeline object available to invoke the ScriptBlock with.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="#6c106f272135c12d" class="t t">DelayedScriptBlockArgument</a>&gt; <a id="1c8d945f0156df74" href="../R/1c8d945f0156df74.html" target="n" data-glyph="46,1" class="i field">_delayBindScriptBlocks</a> =
            <b>new</b> <span class="i">Dictionary</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="#6c106f272135c12d" class="t t">DelayedScriptBlockArgument</a>&gt;();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A collection of the default values of the parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt; <a id="66312110d3469696" href="../R/66312110d3469696.html" target="n" data-glyph="46,1" class="i field">_defaultParameterValues</a> =
            <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> private_members
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Binds the specified value to the specified parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r371 r">parameterValue</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The value to bind to the parameter</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r372 r">parameter</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter to bind the value to.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r373 r">flags</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parameter binding flags for type coercion and validation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if the parameter was successfully bound. False if </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r373 r">flags</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> specifies no coercion and the type does not match the parameter type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#025f44cd23269a6e" class="t t">ParameterBindingParameterDefaultValueException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the parameter binder encounters an error getting the default value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="b003a06fb441c091" href="../R/b003a06fb441c091.html" target="n" data-glyph="76,1" class="i method">BindPipelineParameter</a>(
            <b>object</b> <span id="r371 rd" class="r371 r">parameterValue</span>,
            <a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r372 rd" class="r372 r">parameter</span>,
            <a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a> <span id="r373 rd" class="r373 r">flags</span>)
        {
            <b>bool</b> <span id="r374 rd" class="r374 r">result</span> = <b>false</b>;
 
            <b>if</b> (<span class="r371 r">parameterValue</span> != <a href="AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>)
            {
                <a href="#620ce08548f60d6f" class="i field">s_tracer</a>.<span class="i">WriteLine</span>(<span class="s">&quot;Adding PipelineParameter name={0}; value={1}&quot;</span>,
                                 <span class="r372 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="r371 r">parameterValue</span> ?? <span class="s">&quot;null&quot;</span>);
 
                <span class="c">// Backup the default value</span>
                <a href="#15bb7c6f95c5c097" class="i method">BackupDefaultParameter</a>(<span class="r372 r">parameter</span>);
 
                <span class="c">// Now bind the new value</span>
                <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r375 rd" class="r375 r">param</span> = <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>(
                    <span class="c">/*parameterAst*/</span><b>null</b>, <span class="r372 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="s">&quot;-&quot;</span> + <span class="r372 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a> + <span class="s">&quot;:&quot;</span>,
                    <span class="c">/*argumentAst*/</span><b>null</b>, <span class="r371 r">parameterValue</span>,
                    <b>false</b>);
 
                <span class="r373 r">flags</span> &amp;= ~<a href="ParameterBinderBase.cs.html#2554c5af1a54de10" class="t t">ParameterBindingFlags</a>.<a href="ParameterBinderBase.cs.html#31ebbff231d00d8c" class="i field">DelayBindScriptBlock</a>;
                <span class="r374 r">result</span> = <a href="#1304cfc1ae549ad4" class="i method">BindParameter</a>(<a href="ParameterBinderController.cs.html#4524af3c017b217b" class="i field">_currentParameterSetFlag</a>, <span class="r375 r">param</span>, <span class="r372 r">parameter</span>, <span class="r373 r">flags</span>);
 
                <b>if</b> (<span class="r374 r">result</span>)
                {
                    <span class="c">// Now make sure to remember that the default value needs to be restored</span>
                    <span class="c">// if we get another pipeline object</span>
                    <a href="ParameterBinderController.cs.html#d0bd55d2c98c7d2a" class="i property">ParametersBoundThroughPipelineInput</a>.<span class="i">Add</span>(<span class="r372 r">parameter</span>);
                }
            }
 
            <b>return</b> <span class="r374 r">result</span>;
        }
 
        <b>protected override void</b> <a id="bb016260daf9a4af" href="../R/bb016260daf9a4af.html" target="n" data-glyph="75,1" class="i method">SaveDefaultScriptParameterValue</a>(<b>string</b> <span id="r376 rd" class="r376 r">name</span>, <b>object</b> <span id="r377 rd" class="r377 r">value</span>)
        {
            <a href="#66312110d3469696" class="i field">_defaultParameterValues</a>.<span class="i">Add</span>(<span class="r376 r">name</span>,
                <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>(
                    <span class="c">/*parameterAst*/</span><b>null</b>, <span class="r376 r">name</span>, <span class="s">&quot;-&quot;</span> + <span class="r376 r">name</span> + <span class="s">&quot;:&quot;</span>,
                    <span class="c">/*argumentAst*/</span><b>null</b>, <span class="r377 r">value</span>,
                    <b>false</b>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Backs up the specified parameter value by calling the GetDefaultParameterValue</span>
        <span class="c">///</span><span class="c"> abstract method.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> This method is called when binding a parameter value that came from a pipeline</span>
        <span class="c">///</span><span class="c"> object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="../utils/ParameterBinderExceptions.cs.html#025f44cd23269a6e" class="t t">ParameterBindingParameterDefaultValueException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the parameter binder encounters an error getting the default value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="15bb7c6f95c5c097" href="../R/15bb7c6f95c5c097.html" target="n" data-glyph="76,1" class="i method">BackupDefaultParameter</a>(<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r378 rd" class="r378 r">parameter</span>)
        {
            <b>if</b> (!<a href="#66312110d3469696" class="i field">_defaultParameterValues</a>.<span class="i">ContainsKey</span>(<span class="r378 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
            {
                <b>object</b> <span id="r379 rd" class="r379 r">defaultParameterValue</span> = <a href="#84033b493c35130e" class="i method">GetDefaultParameterValue</a>(<span class="r378 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>);
                <a href="#66312110d3469696" class="i field">_defaultParameterValues</a>.<span class="i">Add</span>(
                    <span class="r378 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>,
                    <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>(
                        <span class="c">/*parameterAst*/</span><b>null</b>, <span class="r378 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="s">&quot;-&quot;</span> + <span class="r378 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a> + <span class="s">&quot;:&quot;</span>,
                        <span class="c">/*argumentAst*/</span><b>null</b>, <span class="r379 r">defaultParameterValue</span>,
                        <b>false</b>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Replaces the values of the parameters with their initial value for the</span>
        <span class="c">///</span><span class="c"> parameters specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r380 r">parameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameters that should have their default values restored.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r380 r">parameters</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>private void</b> <a id="31670812f9bbcda8" href="../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RestoreDefaultParameterValues</a>(<span class="i">IEnumerable</span>&lt;<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r380 rd" class="r380 r">parameters</span>)
        {
            <b>if</b> (<span class="r380 r">parameters</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r380 r">parameters</span>));
            }
 
            <span class="c">// Get all the matching arguments from the defaultParameterValues collection</span>
            <span class="c">// and bind those that had parameters that were bound via pipeline input</span>
 
            <b>foreach</b> (<a href="MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r381 rd" class="r381 r">parameter</span> <b>in</b> <span class="r380 r">parameters</span>)
            {
                <b>if</b> (<span class="r381 r">parameter</span> == <b>null</b>)
                {
                    <b>continue</b>;
                }
 
                <a href="CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a> <span id="r382 rd" class="r382 r">argumentToBind</span> = <b>null</b>;
 
                <span class="c">// If the argument was found then bind it to the parameter</span>
                <span class="c">// and manage the bound and unbound parameter list</span>
 
                <b>if</b> (<a href="#66312110d3469696" class="i field">_defaultParameterValues</a>.<span class="i">TryGetValue</span>(<span class="r381 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <b>out</b> <span class="r382 r">argumentToBind</span>))
                {
                    <span class="c">// Don&#39;t go through the normal binding routine to run data generation,</span>
                    <span class="c">// type coercion, validation, or prerequisites since we know the</span>
                    <span class="c">// type is already correct, and we don&#39;t want data generation to</span>
                    <span class="c">// run when resetting the default value.</span>
 
                    <span class="i">Exception</span> <span id="r383 rd" class="r383 r">error</span> = <b>null</b>;
                    <b>try</b>
                    {
                        <span class="c">// We shouldn&#39;t have to coerce the type here so its</span>
                        <span class="c">// faster to pass false</span>
 
                        <b>bool</b> <span id="r384 rd" class="r384 r">bindResult</span> = <a href="#d84ee93526c45807" class="i method">RestoreParameter</a>(<span class="r382 r">argumentToBind</span>, <span class="r381 r">parameter</span>);
 
                        <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                            <span class="r384 r">bindResult</span>,
                            <span class="s">&quot;Restoring the default value should not require type coercion&quot;</span>);
                    }
                    <b>catch</b> (<a href="ExtendedTypeSystemException.cs.html#8f44bde8a24c50c0" class="t t">SetValueException</a> <span id="r385 rd" class="r385 r">setValueException</span>)
                    {
                        <span class="r383 r">error</span> = <span class="r385 r">setValueException</span>;
                    }
 
                    <b>if</b> (<span class="r383 r">error</span> != <b>null</b>)
                    {
                        <span class="i">Type</span> <span id="r386 rd" class="r386 r">specifiedType</span> = <span class="r382 r">argumentToBind</span>.<a href="CommandParameter.cs.html#8b23fe67ce0ebecb" class="i property">ArgumentValue</a>?.<span class="i">GetType</span>();
                        <a href="../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r387 rd" class="r387 r">bindingException</span> =
                            <b>new</b> <span class="t">ParameterBindingException</span>(
                                <span class="r383 r">error</span>,
                                <a href="ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="ErrorPackage.cs.html#0c2f4b9c74e5b7c2" class="i field">WriteError</a>,
                                <a href="#beea52684e39dd34" class="k">this</a>.<a href="ParameterBinderController.cs.html#e0677962cb6d3e17" class="i property">InvocationInfo</a>,
                                <a href="ParameterBinderController.cs.html#a9e5006bea1e5324" class="i method">GetErrorExtent</a>(<span class="r382 r">argumentToBind</span>),
                                <span class="r381 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>,
                                <span class="r381 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>,
                                <span class="r386 r">specifiedType</span>,
                                <span class="i">ParameterBinderStrings</span>.<span class="i">ParameterBindingFailed</span>,
                                <span class="s">&quot;ParameterBindingFailed&quot;</span>,
                                <span class="r383 r">error</span>.<span class="i">Message</span>);
                        <b>throw</b> <span class="r387 r">bindingException</span>;
                    }
 
                    <span class="c">// Since the parameter was returned to its original value,</span>
                    <span class="c">// ensure that it is not in the boundParameters list but</span>
                    <span class="c">// is in the unboundParameters list</span>
 
                    <a href="ParameterBinderController.cs.html#03396016088be5fe" class="i property">BoundParameters</a>.<span class="i">Remove</span>(<span class="r381 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>);
 
                    <b>if</b> (!<a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>.<span class="i">Contains</span>(<span class="r381 r">parameter</span>))
                    {
                        <a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>.<span class="i">Add</span>(<span class="r381 r">parameter</span>);
                    }
 
                    <a href="ParameterBinderController.cs.html#4893dd5e52f9f477" class="i property">BoundArguments</a>.<span class="i">Remove</span>(<span class="r381 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>);
                }
                <b>else</b>
                {
                    <span class="c">// Since the parameter was not reset, ensure that the parameter</span>
                    <span class="c">// is in the bound parameters list and not in the unbound</span>
                    <span class="c">// parameters list</span>
 
                    <b>if</b> (!<a href="ParameterBinderController.cs.html#03396016088be5fe" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<span class="r381 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                    {
                        <a href="ParameterBinderController.cs.html#03396016088be5fe" class="i property">BoundParameters</a>.<span class="i">Add</span>(<span class="r381 r">parameter</span>.<a href="MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="r381 r">parameter</span>);
                    }
 
                    <span class="c">// Ensure the parameter is not in the unboundParameters list</span>
 
                    <a href="ParameterBinderController.cs.html#717e40a5f982f97b" class="i property">UnboundParameters</a>.<span class="i">Remove</span>(<span class="r381 r">parameter</span>);
                }
            }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A versionable hashtable, so the caching of UserInput -&gt; ParameterBindingResult will work.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Usage&quot;</span>, <span class="s">&quot;CA2237:MarkISerializableTypesWithSerializable&quot;</span>, <span class="i">Justification</span> = <span class="s">&quot;DefaultParameterDictionary will only be used for $PSDefaultParameterValues.&quot;</span>)]
    <b>public sealed class</b> <a id="4c03f64470bcc0c2" href="../R/4c03f64470bcc0c2.html" target="n" data-glyph="0,0" class="t t">DefaultParameterDictionary</a> : <span class="i">Hashtable</span>
    {
        <b>private bool</b> <a id="4a40fd2d6b86e7d5" href="../R/4a40fd2d6b86e7d5.html" target="n" data-glyph="46,1" class="i field">_isChanged</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check to see if the hashtable has been changed since last check.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True for changed; false for not changed.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="b81319f22c5257f0" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ChangeSinceLastCheck</a>()
        {
            <b>bool</b> <span id="r388 rd" class="r388 r">ret</span> = <a href="#4a40fd2d6b86e7d5" class="i field">_isChanged</a>;
            <a href="#4a40fd2d6b86e7d5" class="i field">_isChanged</a> = <b>false</b>;
            <b>return</b> <span class="r388 r">ret</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Default constructor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="164c12623948f225" href="../R/164c12623948f225.html" target="n" data-glyph="72,1" class="t constructor">DefaultParameterDictionary</a>()
            : <b>base</b>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
        {
            <a href="#4a40fd2d6b86e7d5" class="i field">_isChanged</a> = <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructor takes a hash table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check for the keys&#39; formats and make it versionable</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r389 r">dictionary</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">A hashtable instance.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="8015491936ab16d8" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">DefaultParameterDictionary</a>(<span class="i">IDictionary</span> <span id="r389 rd" class="r389 r">dictionary</span>)
            : <a href="#164c12623948f225" class="k">this</a>()
        {
            <b>if</b> (<span class="r389 r">dictionary</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r389 r">dictionary</span>));
            }
            <span class="c">// Contains keys that are in bad format. For every bad format key, we should write out a warning message</span>
            <span class="c">// the first time we encounter it, and remove it from the $PSDefaultParameterValues</span>
            <b>var</b> <span id="r390 rd" class="r390 r">keysInBadFormat</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
 
            <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r391 rd" class="r391 r">entry</span> <b>in</b> <span class="r389 r">dictionary</span>)
            {
                <b>var</b> <span id="r392 rd" class="r392 r">entryKey</span> = <span class="r391 r">entry</span>.<span class="i">Key</span> <b>as string</b>;
                <b>if</b> (<span class="r392 r">entryKey</span> != <b>null</b>)
                {
                    <b>string</b> <span id="r393 rd" class="r393 r">key</span> = <span class="r392 r">entryKey</span>.<span class="i">Trim</span>();
                    <b>string</b> <span id="r394 rd" class="r394 r">cmdletName</span> = <b>null</b>;
                    <b>string</b> <span id="r395 rd" class="r395 r">parameterName</span> = <b>null</b>;
                    <b>bool</b> <span id="r396 rd" class="r396 r">isSpecialKey</span> = <b>false</b>; <span class="c">// The key is &#39;Disabled&#39;</span>
 
                    <span class="c">// The key is not with valid format</span>
                    <b>if</b> (!<a href="#6c765456ee892eab" class="i method">CheckKeyIsValid</a>(<span class="r393 r">key</span>, <b>ref</b> <span class="r394 r">cmdletName</span>, <b>ref</b> <span class="r395 r">parameterName</span>))
                    {
                        <span class="r396 r">isSpecialKey</span> = <span class="r393 r">key</span>.<span class="i">Equals</span>(<span class="s">&quot;Disabled&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
                        <b>if</b> (!<span class="r396 r">isSpecialKey</span>)
                        {
                            <span class="r390 r">keysInBadFormat</span>.<span class="i">Add</span>(<span class="r392 r">entryKey</span>);
                            <b>continue</b>;
                        }
                    }
 
                    <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r396 r">isSpecialKey</span> || (<span class="r394 r">cmdletName</span> != <b>null</b> &amp;&amp; <span class="r395 r">parameterName</span> != <b>null</b>), <span class="s">&quot;The cmdletName and parameterName should be set in CheckKeyIsValid&quot;</span>);
                    <b>if</b> (<span class="r390 r">keysInBadFormat</span>.<span class="i">Count</span> == 0 &amp;&amp; !<b>base</b>.<span class="i">ContainsKey</span>(<span class="r393 r">key</span>))
                    {
                        <b>base</b>.<span class="i">Add</span>(<span class="r393 r">key</span>, <span class="r391 r">entry</span>.<span class="i">Value</span>);
                    }
                }
                <b>else</b>
                {
                    <span class="r390 r">keysInBadFormat</span>.<span class="i">Add</span>(<span class="r391 r">entry</span>.<span class="i">Key</span>);
                }
            }
 
            <b>var</b> <span id="r397 rd" class="r397 r">keysInError</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>foreach</b> (<b>object</b> <span id="r398 rd" class="r398 r">badFormatKey</span> <b>in</b> <span class="r390 r">keysInBadFormat</span>)
            {
                <span class="r397 r">keysInError</span>.<span class="i">Append</span>(<span class="r398 r">badFormatKey</span>.<span class="i">ToString</span>() + <span class="s">&quot;, &quot;</span>);
            }
 
            <b>if</b> (<span class="r397 r">keysInError</span>.<span class="i">Length</span> &gt; 0)
            {
                <span class="r397 r">keysInError</span>.<span class="i">Remove</span>(<span class="r397 r">keysInError</span>.<span class="i">Length</span> - 2, 2);
                <b>string</b> <span id="r399 rd" class="r399 r">resourceString</span> = <span class="r390 r">keysInBadFormat</span>.<span class="i">Count</span> &gt; 1
                                            ? <span class="i">ParameterBinderStrings</span>.<span class="i">MultipleKeysInBadFormat</span>
                                            : <span class="i">ParameterBinderStrings</span>.<span class="i">SingleKeyInBadFormat</span>;
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="r399 r">resourceString</span>, <span class="r397 r">keysInError</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Constructor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Override Contains.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="fd70caf5256380d1" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Contains</a>(<b>object</b> <span id="r400 rd" class="r400 r">key</span>)
        {
            <b>return</b> <a href="#4c03f64470bcc0c2" class="k">this</a>.<a href="#17991295840a0701" class="i method">ContainsKey</a>(<span class="r400 r">key</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Override ContainsKey.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override bool</b> <a id="17991295840a0701" href="../R/17991295840a0701.html" target="n" data-glyph="72,1" class="i method">ContainsKey</a>(<b>object</b> <span id="r401 rd" class="r401 r">key</span>)
        {
            <b>if</b> (<span class="r401 r">key</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r401 r">key</span>));
            }
 
            <b>if</b> (!(<span class="r401 r">key</span> <b>is string</b> <span id="r402 rd" class="r402 r">strKey</span>)) { <b>return</b> <b>false</b>; }
 
            <b>string</b> <span id="r403 rd" class="r403 r">keyAfterTrim</span> = <span class="r402 r">strKey</span>.<span class="i">Trim</span>();
            <b>return</b> <b>base</b>.<span class="i">ContainsKey</span>(<span class="r403 r">keyAfterTrim</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Override the Add to check for key&#39;s format and make it versionable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r404 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Key.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r405 r">value</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Value.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="c0631afa917061a6" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Add</a>(<b>object</b> <span id="r404 rd" class="r404 r">key</span>, <b>object</b> <span id="r405 rd" class="r405 r">value</span>)
        {
            <a href="#da83452cf70e83e3" class="i method">AddImpl</a>(<span class="r404 r">key</span>, <span class="r405 r">value</span>, <span class="r406 r">isSelfIndexing</span>: <b>false</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Actual implementation for Add.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="da83452cf70e83e3" href="../R/da83452cf70e83e3.html" target="n" data-glyph="76,1" class="i method">AddImpl</a>(<b>object</b> <span id="r407 rd" class="r407 r">key</span>, <b>object</b> <span id="r408 rd" class="r408 r">value</span>, <b>bool</b> <span id="r406 rd" class="r406 r">isSelfIndexing</span>)
        {
            <b>if</b> (<span class="r407 r">key</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r407 r">key</span>));
            }
 
            <b>if</b> (!(<span class="r407 r">key</span> <b>is string</b> <span id="r409 rd" class="r409 r">strKey</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r407 r">key</span>), <span class="i">ParameterBinderStrings</span>.<span class="i">StringValueKeyExpected</span>, <span class="r407 r">key</span>, <span class="r407 r">key</span>.<span class="i">GetType</span>().<span class="i">FullName</span>);
            }
 
            <b>string</b> <span id="r410 rd" class="r410 r">keyAfterTrim</span> = <span class="r409 r">strKey</span>.<span class="i">Trim</span>();
            <b>string</b> <span id="r411 rd" class="r411 r">cmdletName</span> = <b>null</b>;
            <b>string</b> <span id="r412 rd" class="r412 r">parameterName</span> = <b>null</b>;
 
            <b>if</b> (<b>base</b>.<span class="i">ContainsKey</span>(<span class="r410 r">keyAfterTrim</span>))
            {
                <b>if</b> (<span class="r406 r">isSelfIndexing</span>)
                {
                    <a href="#4a40fd2d6b86e7d5" class="i field">_isChanged</a> = <b>true</b>;
                    <b>base</b>[<span class="r410 r">keyAfterTrim</span>] = <span class="r408 r">value</span>;
                    <b>return</b>;
                }
 
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r407 r">key</span>), <span class="i">ParameterBinderStrings</span>.<span class="i">KeyAlreadyAdded</span>, <span class="r407 r">key</span>);
            }
 
            <b>if</b> (!<a href="#6c765456ee892eab" class="i method">CheckKeyIsValid</a>(<span class="r410 r">keyAfterTrim</span>, <b>ref</b> <span class="r411 r">cmdletName</span>, <b>ref</b> <span class="r412 r">parameterName</span>))
            {
                <span class="c">// The key is not in valid format</span>
                <b>if</b> (!<span class="r410 r">keyAfterTrim</span>.<span class="i">Equals</span>(<span class="s">&quot;Disabled&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewInvalidOperationException</span>(<span class="i">ParameterBinderStrings</span>.<span class="i">SingleKeyInBadFormat</span>, <span class="r407 r">key</span>);
                }
            }
 
            <a href="#4a40fd2d6b86e7d5" class="i field">_isChanged</a> = <b>true</b>;
            <b>base</b>.<span class="i">Add</span>(<span class="r410 r">keyAfterTrim</span>, <span class="r408 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Override the indexing to check for key&#39;s format and make it versionable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r413 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override object</b> <a id="c0631d6d3e966a8f" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="k">this</a>[<b>object</b> <span id="r413 rd" class="r413 r">key</span>]
        {
            <b>get</b>
            {
                <b>if</b> (<span class="r413 r">key</span> == <b>null</b>) { <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r413 r">key</span>)); }
 
                <b>if</b> (!(<span class="r413 r">key</span> <b>is string</b> <span id="r414 rd" class="r414 r">strKey</span>)) { <b>return</b> <b>null</b>; }
 
                <b>string</b> <span id="r415 rd" class="r415 r">keyAfterTrim</span> = <span class="r414 r">strKey</span>.<span class="i">Trim</span>();
                <b>return</b> <b>base</b>[<span class="r415 r">keyAfterTrim</span>];
            }
 
            <b>set</b>
            {
                <a href="#da83452cf70e83e3" class="i method">AddImpl</a>(<span class="r413 r">key</span>, <b>value</b>, <span class="r406 r">isSelfIndexing</span>: <b>true</b>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Override the Remove to make it versionable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r416 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Key.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="cffd975eb4a7852a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Remove</a>(<b>object</b> <span id="r416 rd" class="r416 r">key</span>)
        {
            <b>if</b> (<span class="r416 r">key</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r416 r">key</span>));
            }
 
            <b>if</b> (!(<span class="r416 r">key</span> <b>is string</b> <span id="r417 rd" class="r417 r">strKey</span>)) { <b>return</b>; }
 
            <b>string</b> <span id="r418 rd" class="r418 r">keyAfterTrim</span> = <span class="r417 r">strKey</span>.<span class="i">Trim</span>();
            <b>if</b> (<b>base</b>.<span class="i">ContainsKey</span>(<span class="r418 r">keyAfterTrim</span>))
            {
                <b>base</b>.<span class="i">Remove</span>(<span class="r418 r">keyAfterTrim</span>);
                <a href="#4a40fd2d6b86e7d5" class="i field">_isChanged</a> = <b>true</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Override the Clear to make it versionable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public override void</b> <a id="0f7151ba87fa3da9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Clear</a>()
        {
            <b>base</b>.<span class="i">Clear</span>();
            <a href="#4a40fd2d6b86e7d5" class="i field">_isChanged</a> = <b>true</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> KeyValidation
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if the key is in valid format. If it is, get the cmdlet name and parameter name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r419 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r420 r">cmdletName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r421 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Return true if the key is valid, false if not.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="6c765456ee892eab" href="../R/6c765456ee892eab.html" target="n" data-glyph="74,1" class="i method">CheckKeyIsValid</a>(<b>string</b> <span id="r419 rd" class="r419 r">key</span>, <b>ref string</b> <span id="r420 rd" class="r420 r">cmdletName</span>, <b>ref string</b> <span id="r421 rd" class="r421 r">parameterName</span>)
        {
            <b>if</b> (<span class="r419 r">key</span> == <b>string</b>.<span class="i">Empty</span>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// The index returned should point to the separator or a character that is before the separator</span>
            <b>int</b> <span id="r422 rd" class="r422 r">index</span> = <a href="#99186a245a306ff2" class="i method">GetValueToken</a>(0, <span class="r419 r">key</span>, <b>ref</b> <span class="r420 r">cmdletName</span>, <b>true</b>);
            <b>if</b> (<span class="r422 r">index</span> == -1)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// The index returned should point to the first non-whitespace character, and it should be the separator</span>
            <span class="r422 r">index</span> = <a href="#3d15f181d88786e4" class="i method">SkipWhiteSpace</a>(<span class="r422 r">index</span>, <span class="r419 r">key</span>);
            <b>if</b> (<span class="r422 r">index</span> == -1 || <span class="r419 r">key</span>[<span class="r422 r">index</span>] != <span class="s">&#39;:&#39;</span>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// The index returned should point to the first non-whitespace character after the separator</span>
            <span class="r422 r">index</span> = <span class="i">SkipWhiteSpace</span>(<span class="r422 r">index</span> + 1, <span class="r419 r">key</span>);
            <b>if</b> (<span class="r422 r">index</span> == -1)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// The index returned should point to the last character in key</span>
            <span class="r422 r">index</span> = <a href="#99186a245a306ff2" class="i method">GetValueToken</a>(<span class="r422 r">index</span>, <span class="r419 r">key</span>, <b>ref</b> <span class="r421 r">parameterName</span>, <b>false</b>);
            <b>if</b> (<span class="r422 r">index</span> == -1 || <span class="r422 r">index</span> != <span class="r419 r">key</span>.<span class="i">Length</span>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the cmdlet name and the parameter name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r423 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Point to a non-whitespace character.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r424 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The key to iterate over.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r425 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r426 r">getCmdletName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Specify whether to get the cmdlet name or parameter name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For cmdletName:</span>
        <span class="c">///</span><span class="c"> When the name is enclosed by quotes, the index returned should be the index of the character right after the second quote;</span>
        <span class="c">///</span><span class="c"> When the name is not enclosed by quotes, the index returned should be the index of the separator;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> For parameterName:</span>
        <span class="c">///</span><span class="c"> When the name is enclosed by quotes, the index returned should be the index of the second quote plus 1 (the length of the key if the key is in a valid format);</span>
        <span class="c">///</span><span class="c"> When the name is not enclosed by quotes, the index returned should be the length of the key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="99186a245a306ff2" href="../R/99186a245a306ff2.html" target="n" data-glyph="76,1" class="i method">GetValueToken</a>(<b>int</b> <span id="r423 rd" class="r423 r">index</span>, <b>string</b> <span id="r424 rd" class="r424 r">key</span>, <b>ref string</b> <span id="r425 rd" class="r425 r">name</span>, <b>bool</b> <span id="r426 rd" class="r426 r">getCmdletName</span>)
        {
            <b>char</b> <span id="r427 rd" class="r427 r">quoteChar</span> = <span class="s">&#39;\0&#39;</span>;
            <b>if</b> (<span class="r424 r">key</span>[<span class="r423 r">index</span>].<span class="i">IsSingleQuote</span>() || <span class="r424 r">key</span>[<span class="r423 r">index</span>].<span class="i">IsDoubleQuote</span>())
            {
                <span class="r427 r">quoteChar</span> = <span class="r424 r">key</span>[<span class="r423 r">index</span>];
                <span class="r423 r">index</span>++;
            }
 
            <span class="i">StringBuilder</span> <span id="r428 rd" class="r428 r">builder</span> = <b>new</b> <span class="i">StringBuilder</span>(<b>string</b>.<span class="i">Empty</span>);
            <b>for</b> (; <span class="r423 r">index</span> &lt; <span class="r424 r">key</span>.<span class="i">Length</span>; <span class="r423 r">index</span>++)
            {
                <b>if</b> (<span class="r427 r">quoteChar</span> != <span class="s">&#39;\0&#39;</span>)
                {
                    <b>if</b> ((<span class="r427 r">quoteChar</span>.<a href="parser/CharTraits.cs.html#b40a10af036c9eeb" class="i method">IsSingleQuote</a>() &amp;&amp; <span class="r424 r">key</span>[<span class="r423 r">index</span>].<span class="i">IsSingleQuote</span>()) ||
                        (<span class="r427 r">quoteChar</span>.<a href="parser/CharTraits.cs.html#07f0a28c4f50e364" class="i method">IsDoubleQuote</a>() &amp;&amp; <span class="r424 r">key</span>[<span class="r423 r">index</span>].<span class="i">IsDoubleQuote</span>()))
                    {
                        <span class="r425 r">name</span> = <span class="r428 r">builder</span>.<span class="i">ToString</span>().<span class="i">Trim</span>();
                        <span class="c">// Make the index point to the character right after the quote</span>
                        <b>return</b> <span class="r425 r">name</span>.<span class="i">Length</span> == 0 ? -1 : <span class="r423 r">index</span> + 1;
                    }
 
                    <span class="r428 r">builder</span>.<span class="i">Append</span>(<span class="r424 r">key</span>[<span class="r423 r">index</span>]);
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r426 r">getCmdletName</span>)
                {
                    <b>if</b> (<span class="r424 r">key</span>[<span class="r423 r">index</span>] != <span class="s">&#39;:&#39;</span>)
                    {
                        <span class="r428 r">builder</span>.<span class="i">Append</span>(<span class="r424 r">key</span>[<span class="r423 r">index</span>]);
                        <b>continue</b>;
                    }
 
                    <span class="r425 r">name</span> = <span class="r428 r">builder</span>.<span class="i">ToString</span>().<span class="i">Trim</span>();
                    <b>return</b> <span class="r425 r">name</span>.<span class="i">Length</span> == 0 ? -1 : <span class="r423 r">index</span>;
                }
                <b>else</b>
                {
                    <span class="r428 r">builder</span>.<span class="i">Append</span>(<span class="r424 r">key</span>[<span class="r423 r">index</span>]);
                }
            }
 
            <b>if</b> (!<span class="r426 r">getCmdletName</span> &amp;&amp; <span class="r427 r">quoteChar</span> == <span class="s">&#39;\0&#39;</span>)
            {
                <span class="r425 r">name</span> = <span class="r428 r">builder</span>.<span class="i">ToString</span>().<span class="i">Trim</span>();
                <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r425 r">name</span>.<span class="i">Length</span> &gt; 0, <span class="s">&quot;name should not be empty at this point&quot;</span>);
                <b>return</b> <span class="r423 r">index</span>;
            }
 
            <b>return</b> -1;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Skip whitespace characters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r429 r">index</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Start index.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r430 r">key</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The string to iterate over.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return -1 if we reach the end of the key, otherwise return the index of the first</span>
        <span class="c">///</span><span class="c"> non-whitespace character we encounter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static int</b> <a id="3d15f181d88786e4" href="../R/3d15f181d88786e4.html" target="n" data-glyph="76,1" class="i method">SkipWhiteSpace</a>(<b>int</b> <span id="r429 rd" class="r429 r">index</span>, <b>string</b> <span id="r430 rd" class="r430 r">key</span>)
        {
            <b>for</b> (; <span class="r429 r">index</span> &lt; <span class="r430 r">key</span>.<span class="i">Length</span>; <span class="r429 r">index</span>++)
            {
                <b>if</b> (<span class="r430 r">key</span>[<span class="r429 r">index</span>].<span class="i">IsWhitespace</span>() || <span class="r430 r">key</span>[<span class="r429 r">index</span>] == <span class="s">&#39;\r&#39;</span> || <span class="r430 r">key</span>[<span class="r429 r">index</span>] == <span class="s">&#39;\n&#39;</span>)
                    <b>continue</b>;
                <b>return</b> <span class="r429 r">index</span>;
            }
 
            <b>return</b> -1;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> KeyValidation
    }
}
</pre></td></tr></table></div></body></html>
