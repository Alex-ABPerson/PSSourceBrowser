<!DOCTYPE html>
<html><head><title>ParameterSetSpecificMetadata.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(215);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/ParameterSetSpecificMetadata.cs" target="_top">engine\ParameterSetSpecificMetadata.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <b>internal class</b> <a id="c4b0e9de62b9ecea" href="../R/c4b0e9de62b9ecea.html" target="n" data-glyph="2,0" class="t t">ParameterSetSpecificMetadata</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> ctor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Constructs an instance of the ParameterSetSpecificMetadata using the instance of the attribute</span>
        <span class="c">///</span><span class="c"> that is specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">attribute</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The attribute to be compiled.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">attribute</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal</b> <a id="a51bff1b4843e581" href="../R/a51bff1b4843e581.html" target="n" data-glyph="74,1" class="t constructor">ParameterSetSpecificMetadata</a>(<a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a> <span id="r0 rd" class="r0 r">attribute</span>)
        {
            <b>if</b> (<span class="r0 r">attribute</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r0 r">attribute</span>));
            }
 
            <a href="#33d8db69c214be65" class="i field">_attribute</a> = <span class="r0 r">attribute</span>;
            <a href="#9ef997a363d3cc80" class="i property">IsMandatory</a> = <span class="r0 r">attribute</span>.<a href="Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a>;
            <a href="#5fe039f108b3ea8f" class="i property">Position</a> = <span class="r0 r">attribute</span>.<a href="Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a>;
            <a href="#75971da95a085c4f" class="i property">ValueFromRemainingArguments</a> = <span class="r0 r">attribute</span>.<a href="Attributes.cs.html#b706e4aa5f357f6a" class="i property">ValueFromRemainingArguments</a>;
            <a href="#c4b0e9de62b9ecea" class="k">this</a>.<a href="#19cea6790d0c6cb0" class="i field">valueFromPipeline</a> = <span class="r0 r">attribute</span>.<a href="Attributes.cs.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a>;
            <a href="#c4b0e9de62b9ecea" class="k">this</a>.<a href="#e369dafe46154cac" class="i field">valueFromPipelineByPropertyName</a> = <span class="r0 r">attribute</span>.<a href="Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a>;
            <a href="#067ab0fb1477db92" class="i property">HelpMessage</a> = <span class="r0 r">attribute</span>.<a href="Attributes.cs.html#1ea1a618dbf069dc" class="i property">HelpMessage</a>;
            <a href="#5f25034a4b159117" class="i property">HelpMessageBaseName</a> = <span class="r0 r">attribute</span>.<a href="Attributes.cs.html#2f9601faf9b1be05" class="i property">HelpMessageBaseName</a>;
            <a href="#bf3aa755a84c5c70" class="i property">HelpMessageResourceId</a> = <span class="r0 r">attribute</span>.<a href="Attributes.cs.html#92a3ab71e21da3c3" class="i property">HelpMessageResourceId</a>;
        }
 
        <b>internal</b> <a id="875d49c301317dd6" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">ParameterSetSpecificMetadata</a>(
            <b>bool</b> <span id="r1 rd" class="r1 r">isMandatory</span>,
            <b>int</b> <span id="r2 rd" class="r2 r">position</span>,
            <b>bool</b> <span id="r3 rd" class="r3 r">valueFromRemainingArguments</span>,
            <b>bool</b> <span id="r4 rd" class="r4 r">valueFromPipeline</span>,
            <b>bool</b> <span id="r5 rd" class="r5 r">valueFromPipelineByPropertyName</span>,
            <b>string</b> <span id="r6 rd" class="r6 r">helpMessageBaseName</span>,
            <b>string</b> <span id="r7 rd" class="r7 r">helpMessageResourceId</span>,
            <b>string</b> <span id="r8 rd" class="r8 r">helpMessage</span>)
        {
            <a href="#9ef997a363d3cc80" class="i property">IsMandatory</a> = <span class="r1 r">isMandatory</span>;
            <a href="#5fe039f108b3ea8f" class="i property">Position</a> = <span class="r2 r">position</span>;
            <a href="#75971da95a085c4f" class="i property">ValueFromRemainingArguments</a> = <span class="r3 r">valueFromRemainingArguments</span>;
            <a href="#c4b0e9de62b9ecea" class="k">this</a>.<a href="#19cea6790d0c6cb0" class="i field">valueFromPipeline</a> = <span class="r4 r">valueFromPipeline</span>;
            <a href="#c4b0e9de62b9ecea" class="k">this</a>.<a href="#e369dafe46154cac" class="i field">valueFromPipelineByPropertyName</a> = <span class="r5 r">valueFromPipelineByPropertyName</span>;
            <a href="#5f25034a4b159117" class="i property">HelpMessageBaseName</a> = <span class="r6 r">helpMessageBaseName</span>;
            <a href="#bf3aa755a84c5c70" class="i property">HelpMessageResourceId</a> = <span class="r7 r">helpMessageResourceId</span>;
            <a href="#067ab0fb1477db92" class="i property">HelpMessage</a> = <span class="r8 r">helpMessage</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> ctor
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the parameter is mandatory for this parameterset, false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="9ef997a363d3cc80" href="../R/9ef997a363d3cc80.html" target="n" data-glyph="104,1" class="i property">IsMandatory</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the parameter is allowed to be positional for this parameter set, this returns</span>
        <span class="c">///</span><span class="c"> the position it is allowed to be in. If it is not positional, this returns int.MinValue.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal int</b> <a id="5fe039f108b3ea8f" href="../R/5fe039f108b3ea8f.html" target="n" data-glyph="104,1" class="i property">Position</a> { <b>get</b>; } = <b>int</b>.<span class="i">MinValue</span>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if the parameter is positional for this parameter set, or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="764317fc3e150010" href="../R/764317fc3e150010.html" target="n" data-glyph="104,1" class="i property">IsPositional</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#5fe039f108b3ea8f" class="i property">Position</a> != <b>int</b>.<span class="i">MinValue</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns true if this parameter takes all the remaining unbound arguments that were specified,</span>
        <span class="c">///</span><span class="c"> or false otherwise.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">value</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">value</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="75971da95a085c4f" href="../R/75971da95a085c4f.html" target="n" data-glyph="104,1" class="i property">ValueFromRemainingArguments</a> { <b>get</b>; }
 
        <b>internal bool</b> <a id="19cea6790d0c6cb0" href="../R/19cea6790d0c6cb0.html" target="n" data-glyph="44,1" class="i field">valueFromPipeline</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies that this parameter can take values from the incoming pipeline object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="6b00e8f2cc8f5221" href="../R/6b00e8f2cc8f5221.html" target="n" data-glyph="104,1" class="i property">ValueFromPipeline</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#19cea6790d0c6cb0" class="i field">valueFromPipeline</a>;
            }
        }
 
        <b>internal bool</b> <a id="e369dafe46154cac" href="../R/e369dafe46154cac.html" target="n" data-glyph="44,1" class="i field">valueFromPipelineByPropertyName</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Specifies that this parameter can take values from a property un the incoming</span>
        <span class="c">///</span><span class="c"> pipeline object with the same name as the parameter.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="9d3ceb11c1e2558a" href="../R/9d3ceb11c1e2558a.html" target="n" data-glyph="104,1" class="i property">ValueFromPipelineByPropertyName</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e369dafe46154cac" class="i field">valueFromPipelineByPropertyName</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A short description for this parameter, suitable for presentation as a tool tip.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="067ab0fb1477db92" href="../R/067ab0fb1477db92.html" target="n" data-glyph="104,1" class="i property">HelpMessage</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The base name of the resource for a help message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="5f25034a4b159117" href="../R/5f25034a4b159117.html" target="n" data-glyph="104,1" class="i property">HelpMessageBaseName</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The Id of the resource for a help message.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="bf3aa755a84c5c70" href="../R/bf3aa755a84c5c70.html" target="n" data-glyph="104,1" class="i property">HelpMessageResourceId</a> { <b>get</b>; } = <b>null</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets or sets the value that tells whether this parameter set</span>
        <span class="c">///</span><span class="c"> data is for the &quot;all&quot; parameter set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal bool</b> <a id="4410808f4575d589" href="../R/4410808f4575d589.html" target="n" data-glyph="104,1" class="i property">IsInAllSets</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the parameter set flag that represents the parameter set</span>
        <span class="c">///</span><span class="c"> that this data is valid for.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal uint</b> <a id="f78c0b8e1f2ce3b8" href="../R/f78c0b8e1f2ce3b8.html" target="n" data-glyph="104,1" class="i property">ParameterSetFlag</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If HelpMessageBaseName and HelpMessageResourceId are set, the help info is</span>
        <span class="c">///</span><span class="c"> loaded from the resource indicated by HelpMessageBaseName and HelpMessageResourceId.</span>
        <span class="c">///</span><span class="c"> If that fails and HelpMessage is set, the help info is set to HelpMessage; otherwise,</span>
        <span class="c">///</span><span class="c"> the exception that is thrown when loading the resource is thrown.</span>
        <span class="c">///</span><span class="c"> If both HelpMessageBaseName and HelpMessageResourceId are not set, the help info is</span>
        <span class="c">///</span><span class="c"> set to HelpMessage.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Help info about the parameter</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">InvalidOperationException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the value of the specified resource is not a string and</span>
        <span class="c">///</span><span class="c">     HelpMessage is not set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If only one of HelpMessageBaseName and HelpMessageResourceId is set</span>
        <span class="c">///</span><span class="c">     OR if no usable resources have been found, and</span>
        <span class="c">///</span><span class="c">     there are no neutral culture resources and HelpMessage is not set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal string</b> <a id="b92f5be49cf77c84" href="../R/b92f5be49cf77c84.html" target="n" data-glyph="74,1" class="i method">GetHelpMessage</a>(<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a> <span id="r9 rd" class="r9 r">cmdlet</span>)
        {
            <b>string</b> <span id="r10 rd" class="r10 r">helpInfo</span> = <b>null</b>;
            <b>bool</b> <span id="r11 rd" class="r11 r">isHelpMsgSet</span> = !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#067ab0fb1477db92" class="i property">HelpMessage</a>);
            <b>bool</b> <span id="r12 rd" class="r12 r">isHelpMsgBaseNameSet</span> = !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#5f25034a4b159117" class="i property">HelpMessageBaseName</a>);
            <b>bool</b> <span id="r13 rd" class="r13 r">isHelpMsgResIdSet</span> = !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<a href="#bf3aa755a84c5c70" class="i property">HelpMessageResourceId</a>);
 
            <b>if</b> (<span class="r12 r">isHelpMsgBaseNameSet</span> ^ <span class="r13 r">isHelpMsgResIdSet</span>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<span class="r12 r">isHelpMsgBaseNameSet</span> ? <span class="s">&quot;HelpMessageResourceId&quot;</span> : <span class="s">&quot;HelpMessageBaseName&quot;</span>);
            }
 
            <b>if</b> (<span class="r12 r">isHelpMsgBaseNameSet</span> &amp;&amp; <span class="r13 r">isHelpMsgResIdSet</span>)
            {
                <b>try</b>
                {
                    <span class="r10 r">helpInfo</span> = <span class="r9 r">cmdlet</span>.<a href="cmdlet.cs.html#5c4315de0df8dce1" class="i method">GetResourceString</a>(<a href="#5f25034a4b159117" class="i property">HelpMessageBaseName</a>, <a href="#bf3aa755a84c5c70" class="i property">HelpMessageResourceId</a>);
                }
                <b>catch</b> (<span class="i">ArgumentException</span>)
                {
                    <b>if</b> (<span class="r11 r">isHelpMsgSet</span>)
                    {
                        <span class="r10 r">helpInfo</span> = <a href="#067ab0fb1477db92" class="i property">HelpMessage</a>;
                    }
                    <b>else</b>
                    {
                        <b>throw</b>;
                    }
                }
                <b>catch</b> (<span class="i">InvalidOperationException</span>)
                {
                    <b>if</b> (<span class="r11 r">isHelpMsgSet</span>)
                    {
                        <span class="r10 r">helpInfo</span> = <a href="#067ab0fb1477db92" class="i property">HelpMessage</a>;
                    }
                    <b>else</b>
                    {
                        <b>throw</b>;
                    }
                }
            }
            <b>else</b> <b>if</b> (<span class="r11 r">isHelpMsgSet</span>)
            {
                <span class="r10 r">helpInfo</span> = <a href="#067ab0fb1477db92" class="i property">HelpMessage</a>;
            }
 
            <b>return</b> <span class="r10 r">helpInfo</span>;
        }
 
        <b>private readonly</b> <a href="Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a> <a id="33d8db69c214be65" href="../R/33d8db69c214be65.html" target="n" data-glyph="46,1" class="i field">_attribute</a>;
    }
}
</pre></td></tr></table></div></body></html>
