<!DOCTYPE html>
<html><head><title>ProgressRecord.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(543);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/ProgressRecord.cs" target="_top">engine\ProgressRecord.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">Serialization</span>;
 
<b>using</b> <span class="t">Dbg</span> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines a data structure used to represent the status of an ongoing operation at a point in time.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> ProgressRecords are passed to </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#2001742b423b982c" class="i method">WriteProgress</a>(<a href="#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">,</span>
    <span class="c">///</span><span class="c"> which, according to user preference, forwards that information on to the host for rendering to the user.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="cmdlet.cs.html#2001742b423b982c" class="i method">WriteProgress</a>(<a href="#d79b27687c6ed8c8" class="t t">ProgressRecord</a>)<span class="c">&quot;</span><span class="c">/&gt;</span>
    [<span class="i">DataContract</span>()]
    <b>public
    class</b> <a id="d79b27687c6ed8c8" href="../R/d79b27687c6ed8c8.html" target="n" data-glyph="0,0" class="t t">ProgressRecord</a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Public API
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the ProgressRecord class and defines the activity Id,</span>
        <span class="c">///</span><span class="c"> activity description, and status description.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">activityId</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A unique numeric key that identifies the activity to which this record applies.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">activity</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A description of the activity for which progress is being reported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">statusDescription</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A description of the status of the activity.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b>
        <a id="fc5a01f49984a3f9" href="../R/fc5a01f49984a3f9.html" target="n" data-glyph="72,1" class="t constructor">ProgressRecord</a>(<b>int</b> <span id="r0 rd" class="r0 r">activityId</span>, <b>string</b> <span id="r1 rd" class="r1 r">activity</span>, <b>string</b> <span id="r2 rd" class="r2 r">statusDescription</span>)
        {
            <b>if</b> (<span class="r0 r">activityId</span> &lt; 0)
            {
                <span class="c">// negative Ids are reserved to indicate &quot;no id&quot; for parent Ids.</span>
 
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentOutOfRangeException</span>(<b>nameof</b>(<span class="r0 r">activityId</span>), <span class="r0 r">activityId</span>, <span class="i">ProgressRecordStrings</span>.<span class="i">ArgMayNotBeNegative</span>, <span class="s">&quot;activityId&quot;</span>);
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1 r">activity</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r1 r">activity</span>), <span class="i">ProgressRecordStrings</span>.<span class="i">ArgMayNotBeNullOrEmpty</span>, <span class="s">&quot;activity&quot;</span>);
            }
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r2 r">statusDescription</span>))
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<b>nameof</b>(<span class="r1 r">activity</span>), <span class="i">ProgressRecordStrings</span>.<span class="i">ArgMayNotBeNullOrEmpty</span>, <span class="s">&quot;statusDescription&quot;</span>);
            }
 
            <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#4116399e059b4280" class="i field">id</a> = <span class="r0 r">activityId</span>;
            <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#f16c60f6af3b1271" class="i field">activity</a> = <span class="r1 r">activity</span>;
            <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#e353e4ded0c1bcf9" class="i field">status</a> = <span class="r2 r">statusDescription</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Cloning constructor (all fields are value types - can treat our implementation of cloning as &quot;deep&quot; copy)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">other</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="90bbc41a000f2235" href="../R/90bbc41a000f2235.html" target="n" data-glyph="74,1" class="t constructor">ProgressRecord</a>(<a href="#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r3 rd" class="r3 r">other</span>)
        {
            <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#f16c60f6af3b1271" class="i field">activity</a> = <span class="r3 r">other</span>.<a href="#f16c60f6af3b1271" class="i field">activity</a>;
            <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#0c0a1d50cd61d854" class="i field">currentOperation</a> = <span class="r3 r">other</span>.<a href="#0c0a1d50cd61d854" class="i field">currentOperation</a>;
            <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#4116399e059b4280" class="i field">id</a> = <span class="r3 r">other</span>.<a href="#4116399e059b4280" class="i field">id</a>;
            <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#64b105c3c6d2750d" class="i field">parentId</a> = <span class="r3 r">other</span>.<a href="#64b105c3c6d2750d" class="i field">parentId</a>;
            <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#23feffa524bf5ddc" class="i field">percent</a> = <span class="r3 r">other</span>.<a href="#23feffa524bf5ddc" class="i field">percent</a>;
            <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#9f3d6413a06aec58" class="i field">secondsRemaining</a> = <span class="r3 r">other</span>.<a href="#9f3d6413a06aec58" class="i field">secondsRemaining</a>;
            <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#e353e4ded0c1bcf9" class="i field">status</a> = <span class="r3 r">other</span>.<a href="#e353e4ded0c1bcf9" class="i field">status</a>;
            <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#c71d1f6e8029d974" class="i field">type</a> = <span class="r3 r">other</span>.<a href="#c71d1f6e8029d974" class="i field">type</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets the Id of the activity to which this record corresponds.  Used as a &#39;key&#39; for the</span>
        <span class="c">///</span><span class="c"> linking of subordinate activities.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        int</b>
        <a id="035f9f51bcda9b17" href="../R/035f9f51bcda9b17.html" target="n" data-glyph="102,1" class="i property">ActivityId</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#4116399e059b4280" class="i field">id</a>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets the Id of the activity for which this record is a subordinate.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Used to allow chaining of progress records (such as when one installation invokes a child installation). UI:</span>
        <span class="c">///</span><span class="c"> normally not directly visible except as already displayed as its own activity. Usually a sub-activity will be</span>
        <span class="c">///</span><span class="c"> positioned below and to the right of its parent.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> A negative value (the default) indicates that the activity is not a subordinate.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> May not be the same as ActivityId.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;!--</span><span class="c">NTRAID#Windows OS Bugs-1161549 the default value for this should be picked up from a variable in the</span>
        <span class="c">///</span><span class="c"> shell so that a script can set that variable, and have all subsequent calls to WriteProgress (the API) be</span>
        <span class="c">///</span><span class="c"> subordinate to the &quot;current parent id&quot;.</span><span class="c">--&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public
        int</b>
        <a id="730521203ee4eba0" href="../R/730521203ee4eba0.html" target="n" data-glyph="102,1" class="i property">ParentActivityId</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#64b105c3c6d2750d" class="i field">parentId</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> == <a href="#035f9f51bcda9b17" class="i property">ActivityId</a>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;value&quot;</span>, <span class="i">ProgressRecordStrings</span>.<span class="i">ParentActivityIdCantBeActivityId</span>);
                }
 
                <a href="#64b105c3c6d2750d" class="i field">parentId</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets the description of the activity for which progress is being reported.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> States the overall intent of whats being accomplished, such as &quot;Recursively removing item c:\temp.&quot; Typically</span>
        <span class="c">///</span><span class="c"> displayed in conjunction with a progress bar.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public
        string</b>
        <a id="4b85501b44d8e997" href="../R/4b85501b44d8e997.html" target="n" data-glyph="102,1" class="i property">Activity</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#f16c60f6af3b1271" class="i field">activity</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<b>value</b>))
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;value&quot;</span>, <span class="i">ProgressRecordStrings</span>.<span class="i">ArgMayNotBeNullOrEmpty</span>, <span class="s">&quot;value&quot;</span>);
                }
 
                <a href="#f16c60f6af3b1271" class="i field">activity</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets the current status of the operation, e.g., &quot;35 of 50 items Copied.&quot; or &quot;95% completed.&quot; or &quot;100 files purged.&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        string</b>
        <a id="7b8dea277788f5cd" href="../R/7b8dea277788f5cd.html" target="n" data-glyph="102,1" class="i property">StatusDescription</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#e353e4ded0c1bcf9" class="i field">status</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<b>value</b>))
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentException</span>(<span class="s">&quot;value&quot;</span>, <span class="i">ProgressRecordStrings</span>.<span class="i">ArgMayNotBeNullOrEmpty</span>, <span class="s">&quot;value&quot;</span>);
                }
 
                <a href="#e353e4ded0c1bcf9" class="i field">status</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets the current operation of the many required to accomplish the activity (such as &quot;copying foo.txt&quot;). Normally displayed</span>
        <span class="c">///</span><span class="c"> below its associated progress bar, e.g., &quot;deleting file foo.bar&quot;</span>
        <span class="c">///</span><span class="c"> Set to null or empty in the case a sub-activity will be used to show the current operation.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        string</b>
        <a id="f7d64fec26cd635a" href="../R/f7d64fec26cd635a.html" target="n" data-glyph="102,1" class="i property">CurrentOperation</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#0c0a1d50cd61d854" class="i field">currentOperation</a>;
            }
 
            <b>set</b>
            {
                <span class="c">// null or empty string is allowed</span>
 
                <a href="#0c0a1d50cd61d854" class="i field">currentOperation</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets the estimate of the percentage of total work for the activity that is completed.  Typically displayed as a progress bar.</span>
        <span class="c">///</span><span class="c"> Set to a negative value to indicate that the percentage completed should not be displayed.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public
        int</b>
        <a id="7c559492a0012510" href="../R/7c559492a0012510.html" target="n" data-glyph="102,1" class="i property">PercentComplete</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#23feffa524bf5ddc" class="i field">percent</a>;
            }
 
            <b>set</b>
            {
                <span class="c">// negative values are allowed</span>
 
                <b>if</b> (<b>value</b> &gt; 100)
                {
                    <b>throw</b>
                        <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentOutOfRangeException</span>(
                            <span class="s">&quot;value&quot;</span>, <b>value</b>, <span class="i">ProgressRecordStrings</span>.<span class="i">PercentMayNotBeMoreThan100</span>, <span class="s">&quot;PercentComplete&quot;</span>);
                }
 
                <a href="#23feffa524bf5ddc" class="i field">percent</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets the estimate of time remaining until this activity is completed.  This can be based upon a measurement of time since</span>
        <span class="c">///</span><span class="c"> started and the percent complete or another approach deemed appropriate by the caller.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> Normally displayed beside the progress bar, as &quot;N seconds remaining.&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A value less than 0 means &quot;don&#39;t display a time remaining.&quot;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>public
        int</b>
        <a id="b36a767584bc86ea" href="../R/b36a767584bc86ea.html" target="n" data-glyph="102,1" class="i property">SecondsRemaining</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#9f3d6413a06aec58" class="i field">secondsRemaining</a>;
            }
 
            <b>set</b>
            {
                <span class="c">// negative values are allowed</span>
 
                <a href="#9f3d6413a06aec58" class="i field">secondsRemaining</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Gets and sets the type of record represented by this instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b>
        <a href="#1f168993cf0b800f" class="t t">ProgressRecordType</a>
        <a id="b83bd20609cddaf5" href="../R/b83bd20609cddaf5.html" target="n" data-glyph="102,1" class="i property">RecordType</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#c71d1f6e8029d974" class="i field">type</a>;
            }
 
            <b>set</b>
            {
                <b>if</b> (<b>value</b> != <a href="#1f168993cf0b800f" class="t t">ProgressRecordType</a>.<a href="#be29e101fe03f5d0" class="i field">Completed</a> &amp;&amp; <b>value</b> != <a href="#1f168993cf0b800f" class="t t">ProgressRecordType</a>.<a href="#b02a1a2b864a452c" class="i field">Processing</a>)
                {
                    <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<span class="s">&quot;value&quot;</span>);
                }
 
                <a href="#c71d1f6e8029d974" class="i field">type</a> = <b>value</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Overrides </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i">Object</span>.<span class="i">ToString</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> &quot;parent = a id = b act = c stat = d cur = e pct = f sec = g type = h&quot; where</span>
        <span class="c">///</span><span class="c"> a, b, c, d, e, f, and g are the values of ParentActivityId, ActivityId, Activity, StatusDescription,</span>
        <span class="c">///</span><span class="c"> CurrentOperation, PercentComplete, SecondsRemaining and RecordType properties.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override
        string</b>
        <a id="d980ad7de765b9ee" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b>
                <b>string</b>.<span class="i">Format</span>(
                    <span class="i n">System</span>.<span class="i">Globalization</span>.<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                    <span class="s">&quot;parent = {0} id = {1} act = {2} stat = {3} cur = {4} pct = {5} sec = {6} type = {7}&quot;</span>,
                    <a href="#64b105c3c6d2750d" class="i field">parentId</a>,
                    <a href="#4116399e059b4280" class="i field">id</a>,
                    <a href="#f16c60f6af3b1271" class="i field">activity</a>,
                    <a href="#e353e4ded0c1bcf9" class="i field">status</a>,
                    <a href="#0c0a1d50cd61d854" class="i field">currentOperation</a>,
                    <a href="#23feffa524bf5ddc" class="i field">percent</a>,
                    <a href="#9f3d6413a06aec58" class="i field">secondsRemaining</a>,
                    <a href="#c71d1f6e8029d974" class="i field">type</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Helper methods
 
        <b>internal static int</b>? <a id="8b9ed7e7c683efa7" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetSecondsRemaining</a>(<span class="i">DateTime</span> <span id="r4 rd" class="r4 r">startTime</span>, <b>double</b> <span id="r5 rd" class="r5 r">percentageComplete</span>)
        {
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r5 r">percentageComplete</span> &gt;= 0.0, <span class="s">&quot;Caller should verify percentageComplete &gt;= 0.0&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r5 r">percentageComplete</span> &lt;= 1.0, <span class="s">&quot;Caller should verify percentageComplete &lt;= 1.0&quot;</span>);
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r4 r">startTime</span>.<span class="i">Kind</span> == <span class="i">DateTimeKind</span>.<span class="i">Utc</span>,
                <span class="s">&quot;DateTime arithmetic should always be done in utc mode [to avoid problems when some operands are calculated right before and right after switching to /from a daylight saving time&quot;</span>);
 
            <b>if</b> ((<span class="r5 r">percentageComplete</span> &lt; 0.00001) || <b>double</b>.<span class="i">IsNaN</span>(<span class="r5 r">percentageComplete</span>))
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">DateTime</span> <span id="r6 rd" class="r6 r">now</span> = <span class="i">DateTime</span>.<span class="i">UtcNow</span>;
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r4 r">startTime</span> &lt;= <span class="r6 r">now</span>, <span class="s">&quot;Caller should pass a valid startTime&quot;</span>);
            <span class="i">TimeSpan</span> <span id="r7 rd" class="r7 r">elapsedTime</span> = <span class="r6 r">now</span> - <span class="r4 r">startTime</span>;
 
            <span class="i">TimeSpan</span> <span id="r8 rd" class="r8 r">totalTime</span>;
            <b>try</b>
            {
                <span class="r8 r">totalTime</span> = <span class="i">TimeSpan</span>.<span class="i">FromMilliseconds</span>(<span class="r7 r">elapsedTime</span>.<span class="i">TotalMilliseconds</span> / <span class="r5 r">percentageComplete</span>);
            }
            <b>catch</b> (<span class="i">OverflowException</span>)
            {
                <b>return</b> <b>null</b>;
            }
            <b>catch</b> (<span class="i">ArgumentException</span>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">TimeSpan</span> <span id="r9 rd" class="r9 r">remainingTime</span> = <span class="r8 r">totalTime</span> - <span class="r7 r">elapsedTime</span>;
 
            <b>return</b> (<b>int</b>)(<span class="r9 r">remainingTime</span>.<span class="i">TotalSeconds</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns percentage complete when it is impossible to predict how long an operation might take.</span>
        <span class="c">///</span><span class="c"> The percentage complete will slowly converge toward 100%.</span>
        <span class="c">///</span><span class="c"> At the </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">expectedDuration</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> the percentage complete will be 90%.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">startTime</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">When did the operation start.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">expectedDuration</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">How long does the operation usually take.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Estimated percentage complete of the operation (always between 0 and 99% - never returns 100%).</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentOutOfRangeException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when</span>
        <span class="c">///</span><span class="c"> 1) </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">startTime</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is in the future</span>
        <span class="c">///</span><span class="c"> 2) </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">expectedDuration</span><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> is negative or zero</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static int</b> <a id="676225a3789daee4" href="../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetPercentageComplete</a>(<span class="i">DateTime</span> <span id="r11 rd" class="r11 r">startTime</span>, <span class="i">TimeSpan</span> <span id="r10 rd" class="r10 r">expectedDuration</span>)
        {
            <span class="i">DateTime</span> <span id="r12 rd" class="r12 r">now</span> = <span class="i">DateTime</span>.<span class="i">UtcNow</span>;
 
            <a href="../utils/assert.cs.html#c04955255430d32f" class="t t">Dbg</a>.<a href="../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r11 r">startTime</span>.<span class="i">Kind</span> == <span class="i">DateTimeKind</span>.<span class="i">Utc</span>,
                <span class="s">&quot;DateTime arithmetic should always be done in utc mode [to avoid problems when some operands are calculated right before and right after switching to /from a daylight saving time&quot;</span>);
 
            <b>if</b> (<span class="r11 r">startTime</span> &gt; <span class="r12 r">now</span>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentOutOfRangeException</span>(<b>nameof</b>(<span class="r11 r">startTime</span>));
            }
 
            <b>if</b> (<span class="r10 r">expectedDuration</span> &lt;= <span class="i">TimeSpan</span>.<span class="i">Zero</span>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentOutOfRangeException</span>(<b>nameof</b>(<span class="r10 r">expectedDuration</span>));
            }
 
            <span class="c">/*
             * According to the spec of Checkpoint-Computer
             * (http://cmdletdesigner/SpecViewer/Default.aspx?Project=PowerShell&amp;Cmdlet=Checkpoint-Computer)
             * we have percentage remaining = f(t) where
             * f(inf) = 0%
             * f(0) = 100%
             * f(90) = &lt;something small&gt; = 10%
             *
             * The spec talks about exponential decay, but function based on 1/x seems better:
             * f(t) = a / (T + b)
             *
             * This by definition has f(inf) = 0, so we have to find a and b for the last 2 cases:
             * E1: f(0) = a / (0 + b) = 100
             * E2: f(T = 90) = a / (T + b) = 10
             *
             * From E1 we have a = 100 * b, which we can use in E2:
             * (100 * b) / (T + b) = 10
             * 100 * b = 10 * T + 10 * b
             * 90 * b = 10 * T
             * b = T / 9
             *
             * Some sample values (for T=90):
             * t   | %rem
             * -----------
             * 0   | 100.0%
             * 5   |  66.6%
             * 10  |  50.0%
             * 30  |  25.0%
             * 70  |  12.5%
             * 90  |  10.0%
             * 300 |   3.2%
             * 600 |   1.6%
             * 3600|   0.2%
             */</span>
            <span class="i">TimeSpan</span> <span id="r13 rd" class="r13 r">timeElapsed</span> = <span class="r12 r">now</span> - <span class="r11 r">startTime</span>;
            <b>double</b> <span id="r14 rd" class="r14 r">b</span> = <span class="r10 r">expectedDuration</span>.<span class="i">TotalSeconds</span> / 9.0;
            <b>double</b> <span id="r15 rd" class="r15 r">a</span> = 100.0 * <span class="r14 r">b</span>;
            <b>double</b> <span id="r16 rd" class="r16 r">percentageRemaining</span> = <span class="r15 r">a</span> / (<span class="r13 r">timeElapsed</span>.<span class="i">TotalSeconds</span> + <span class="r14 r">b</span>);
            <b>double</b> <span id="r17 rd" class="r17 r">percentageCompleted</span> = 100.0 - <span class="r16 r">percentageRemaining</span>;
 
            <b>return</b> (<b>int</b>)<span class="i">Math</span>.<span class="i">Floor</span>(<span class="r17 r">percentageCompleted</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> DO NOT REMOVE OR RENAME THESE FIELDS - it will break remoting compatibility with Windows PowerShell
 
        [<span class="i">DataMemberAttribute</span>()]
        <b>private readonly int</b> <a id="4116399e059b4280" href="../R/4116399e059b4280.html" target="n" data-glyph="46,1" class="i field">id</a>;
 
        [<span class="i">DataMemberAttribute</span>()]
        <b>private int</b> <a id="64b105c3c6d2750d" href="../R/64b105c3c6d2750d.html" target="n" data-glyph="46,1" class="i field">parentId</a> = -1;
 
        [<span class="i">DataMemberAttribute</span>()]
        <b>private string</b> <a id="f16c60f6af3b1271" href="../R/f16c60f6af3b1271.html" target="n" data-glyph="46,1" class="i field">activity</a>;
 
        [<span class="i">DataMemberAttribute</span>()]
        <b>private string</b> <a id="e353e4ded0c1bcf9" href="../R/e353e4ded0c1bcf9.html" target="n" data-glyph="46,1" class="i field">status</a>;
 
        [<span class="i">DataMemberAttribute</span>()]
        <b>private string</b> <a id="0c0a1d50cd61d854" href="../R/0c0a1d50cd61d854.html" target="n" data-glyph="46,1" class="i field">currentOperation</a>;
 
        [<span class="i">DataMemberAttribute</span>()]
        <b>private int</b> <a id="23feffa524bf5ddc" href="../R/23feffa524bf5ddc.html" target="n" data-glyph="46,1" class="i field">percent</a> = -1;
 
        [<span class="i">DataMemberAttribute</span>()]
        <b>private int</b> <a id="9f3d6413a06aec58" href="../R/9f3d6413a06aec58.html" target="n" data-glyph="46,1" class="i field">secondsRemaining</a> = -1;
 
        [<span class="i">DataMemberAttribute</span>()]
        <b>private</b> <a href="#1f168993cf0b800f" class="t t">ProgressRecordType</a> <a id="c71d1f6e8029d974" href="../R/c71d1f6e8029d974.html" target="n" data-glyph="46,1" class="i field">type</a> = <a href="#1f168993cf0b800f" class="t t">ProgressRecordType</a>.<a href="#b02a1a2b864a452c" class="i field">Processing</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Serialization / deserialization for remoting
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a ProgressRecord object from a PSObject property bag.</span>
        <span class="c">///</span><span class="c"> PSObject has to be in the format returned by ToPSObjectForRemoting method.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">progressAsPSObject</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">PSObject to rehydrate.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> ProgressRecord rehydrated from a PSObject property bag</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i">ArgumentNullException</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown if the PSObject is null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Remoting</span>.<a href="remoting/common/remotingexceptions.cs.html#553740d8dd522b58" class="t t">PSRemotingDataStructureException</a><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Thrown when the PSObject is not in the expected format</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
        <b>internal static</b> <a href="#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <a id="b59ff0d76f410fc2" href="../R/b59ff0d76f410fc2.html" target="n" data-glyph="74,1" class="i method">FromPSObjectForRemoting</a>(<a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r18 rd" class="r18 r">progressAsPSObject</span>)
        {
            <b>if</b> (<span class="r18 r">progressAsPSObject</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r18 r">progressAsPSObject</span>));
            }
 
            <b>string</b> <span id="r19 rd" class="r19 r">activity</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r18 r">progressAsPSObject</span>, <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6e984ab018c222fd" class="i field">ProgressRecord_Activity</a>);
            <b>int</b> <span id="r20 rd" class="r20 r">activityId</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r18 r">progressAsPSObject</span>, <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#c383d52302afba97" class="i field">ProgressRecord_ActivityId</a>);
            <b>string</b> <span id="r21 rd" class="r21 r">statusDescription</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r18 r">progressAsPSObject</span>, <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#cd488263b3003d1e" class="i field">ProgressRecord_StatusDescription</a>);
 
            <a href="#d79b27687c6ed8c8" class="t t">ProgressRecord</a> <span id="r22 rd" class="r22 r">result</span> = <b>new</b> <a href="#fc5a01f49984a3f9" class="t constructor">ProgressRecord</a>(<span class="r20 r">activityId</span>, <span class="r19 r">activity</span>, <span class="r21 r">statusDescription</span>);
 
            <span class="r22 r">result</span>.<a href="#f7d64fec26cd635a" class="i property">CurrentOperation</a> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r18 r">progressAsPSObject</span>, <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#34497a498766de09" class="i field">ProgressRecord_CurrentOperation</a>);
            <span class="r22 r">result</span>.<a href="#730521203ee4eba0" class="i property">ParentActivityId</a> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r18 r">progressAsPSObject</span>, <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#130ba7424e0fa115" class="i field">ProgressRecord_ParentActivityId</a>);
            <span class="r22 r">result</span>.<a href="#7c559492a0012510" class="i property">PercentComplete</a> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r18 r">progressAsPSObject</span>, <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7e0cddd9bf804000" class="i field">ProgressRecord_PercentComplete</a>);
            <span class="r22 r">result</span>.<a href="#b83bd20609cddaf5" class="i property">RecordType</a> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<a href="#1f168993cf0b800f" class="t t">ProgressRecordType</a>&gt;(<span class="r18 r">progressAsPSObject</span>, <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#ba836e438434ac61" class="i field">ProgressRecord_Type</a>);
            <span class="r22 r">result</span>.<a href="#b36a767584bc86ea" class="i property">SecondsRemaining</a> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r18 r">progressAsPSObject</span>, <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6d1706484e22479a" class="i field">ProgressRecord_SecondsRemaining</a>);
 
            <b>return</b> <span class="r22 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns this object as a PSObject property bag</span>
        <span class="c">///</span><span class="c"> that can be used in a remoting protocol data object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">This object as a PSObject property bag.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <a id="b278995941ed5af9" href="../R/b278995941ed5af9.html" target="n" data-glyph="74,1" class="i method">ToPSObjectForRemoting</a>()
        {
            <a href="MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r23 rd" class="r23 r">progressAsPSObject</span> = <a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#22d9fb1506026254" class="i method">CreateEmptyPSObject</a>();
 
            <span class="r23 r">progressAsPSObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6e984ab018c222fd" class="i field">ProgressRecord_Activity</a>, <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#4b85501b44d8e997" class="i property">Activity</a>));
            <span class="r23 r">progressAsPSObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#c383d52302afba97" class="i field">ProgressRecord_ActivityId</a>, <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#035f9f51bcda9b17" class="i property">ActivityId</a>));
            <span class="r23 r">progressAsPSObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#cd488263b3003d1e" class="i field">ProgressRecord_StatusDescription</a>, <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#7b8dea277788f5cd" class="i property">StatusDescription</a>));
 
            <span class="r23 r">progressAsPSObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#34497a498766de09" class="i field">ProgressRecord_CurrentOperation</a>, <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#f7d64fec26cd635a" class="i property">CurrentOperation</a>));
            <span class="r23 r">progressAsPSObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#130ba7424e0fa115" class="i field">ProgressRecord_ParentActivityId</a>, <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#730521203ee4eba0" class="i property">ParentActivityId</a>));
            <span class="r23 r">progressAsPSObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7e0cddd9bf804000" class="i field">ProgressRecord_PercentComplete</a>, <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#7c559492a0012510" class="i property">PercentComplete</a>));
            <span class="r23 r">progressAsPSObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <span class="t">PSNoteProperty</span>(<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#ba836e438434ac61" class="i field">ProgressRecord_Type</a>, <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#b83bd20609cddaf5" class="i property">RecordType</a>));
            <span class="r23 r">progressAsPSObject</span>.<a href="MshObject.cs.html#59e9cd1ad57ccd34" class="i property">Properties</a>.<a href="MshMemberInfo.cs.html#a9e3a2dc56d98237" class="i method">Add</a>(<b>new</b> <a href="MshMemberInfo.cs.html#f4e5bccf8ccb9f2a" class="t constructor">PSNoteProperty</a>(<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#7c9c1b0b95848ffd" class="t t">RemoteDataNameStrings</a>.<a href="remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6d1706484e22479a" class="i field">ProgressRecord_SecondsRemaining</a>, <a href="#d79b27687c6ed8c8" class="k">this</a>.<a href="#b36a767584bc86ea" class="i property">SecondsRemaining</a>));
 
            <b>return</b> <span class="r23 r">progressAsPSObject</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines two types of progress record that refer to the beginning (or middle) and end of an operation.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public
    enum</b> <a id="1f168993cf0b800f" href="../R/1f168993cf0b800f.html" target="n" data-glyph="18,0" class="t t"><span id="fe075b3ba870d287">ProgressRecordType</span></a>
    {
        <span class="c">///</span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Operation just started or is not yet complete.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A cmdlet can call WriteProgress with ProgressRecordType.Processing</span>
        <span class="c">///</span><span class="c"> as many times as it wishes.  However, at the end of the operation,</span>
        <span class="c">///</span><span class="c"> it should call once more with ProgressRecordType.Completed.</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c"> The first time that a host receives a progress record</span>
        <span class="c">///</span><span class="c"> for a given activity, it will typically display a progress</span>
        <span class="c">///</span><span class="c"> indicator for that activity.  For each subsequent record</span>
        <span class="c">///</span><span class="c"> of the same Id, the host will update that display.</span>
        <span class="c">///</span><span class="c"> Finally, when the host receives a &#39;completed&#39; record</span>
        <span class="c">///</span><span class="c"> for that activity, it will remove the progress indicator.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="b02a1a2b864a452c" href="../R/b02a1a2b864a452c.html" target="n" data-glyph="24,1" class="i field">Processing</a>,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Operation is complete.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If a cmdlet uses WriteProgress, it should use</span>
        <span class="c">///</span><span class="c"> ProgressRecordType.Completed exactly once, in the last call</span>
        <span class="c">///</span><span class="c"> to WriteProgress.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <a id="be29e101fe03f5d0" href="../R/be29e101fe03f5d0.html" target="n" data-glyph="24,1" class="i field">Completed</a>
    }
}
</pre></td></tr></table></div></body></html>
