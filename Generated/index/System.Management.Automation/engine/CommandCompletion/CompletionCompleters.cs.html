<!DOCTYPE html>
<html><head><title>CompletionCompleters.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(7712);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/CommandCompletion/CompletionCompleters.cs" target="_top">engine\CommandCompletion\CompletionCompleters.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Concurrent</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Data</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">InteropServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">RegularExpressions</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">Options</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Cim</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>.<span class="i n">Internal</span>.<span class="i n">Format</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public static class</b> <a id="ef47b689fd4f15e2" href="../../R/ef47b689fd4f15e2.html" target="n" data-glyph="0,0" class="t t">CompletionCompleters</a>
    {
        <b>static</b> <a id="3c0c280708689ab7" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">CompletionCompleters</a>()
        {
            <span class="i">AppDomain</span>.<span class="i">CurrentDomain</span>.<span class="i">AssemblyLoad</span> += <span class="i">UpdateTypeCacheOnAssemblyLoad</span>;
        }
 
        <b>private static void</b> <a id="f6eaf4fce706def5" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">UpdateTypeCacheOnAssemblyLoad</a>(<b>object</b> <span id="r0 rd" class="r0 r">sender</span>, <span class="i">AssemblyLoadEventArgs</span> <span id="r1 rd" class="r1 r">args</span>)
        {
            <span class="c">// Just null out the cache - we&#39;ll rebuild it the next time someone tries to complete a type.</span>
            <span class="c">// We could rebuild it now, but we could be loading multiple assemblies (e.g. dependent assemblies)</span>
            <span class="c">// and there is no sense in rebuilding anything until we&#39;re done loading all of the assemblies.</span>
            <span class="i">Interlocked</span>.<span class="i">Exchange</span>(<b>ref</b> <a href="#20224d4c52cf7c0a" class="i field">s_typeCache</a>, <b>null</b>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Names
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">commandName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <span class="i">IEnumerable</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="da5eb3b277f051c7" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CompleteCommand</a>(<b>string</b> <span id="r2 rd" class="r2 r">commandName</span>)
        {
            <b>return</b> <a href="#65b99a19700ef921" class="i method">CompleteCommand</a>(<span class="r2 r">commandName</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">commandName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">moduleName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r5 r">commandTypes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1026:DefaultParametersShouldNotBeUsed&quot;</span>)]
        <b>public static</b> <span class="i">IEnumerable</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="65b99a19700ef921" href="../../R/65b99a19700ef921.html" target="n" data-glyph="72,1" class="i method">CompleteCommand</a>(<b>string</b> <span id="r3 rd" class="r3 r">commandName</span>, <b>string</b> <span id="r4 rd" class="r4 r">moduleName</span>, <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r5 rd" class="r5 r">commandTypes</span> = <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#d7f466cfbbd45cdb" class="i field">All</a>)
        {
            <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="k">var</a> <span id="r6 rd" class="r6 r">runspace</span> = <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>;
            <b>if</b> (<span class="r6 r">runspace</span> == <b>null</b>)
            {
                <span class="c">// No runspace, just return no results.</span>
                <b>return</b> <a href="CommandCompletion.cs.html#a9d35cade4030f50" class="t t">CommandCompletion</a>.<a href="CommandCompletion.cs.html#13ad720861798479" class="i field">EmptyCompletionResult</a>;
            }
 
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r7 rd" class="r7 r">helper</span> = <b>new</b> <a href="../../utils/PowerShellExecutionHelper.cs.html#b251f5b816b2dd25" class="t constructor">PowerShellExecutionHelper</a>(<a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#1c6a51d3c837bb4d" class="i method">Create</a>(<a href="../hostifaces/PowerShell.cs.html#c3c0f0e5e0b337ff" class="t t">RunspaceMode</a>.<a href="../hostifaces/PowerShell.cs.html#75d224de5df87e75" class="i field">CurrentRunspace</a>));
            <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r8 rd" class="r8 r">executionContext</span> = <span class="r7 r">helper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ddb7ad1950c8ea20" class="i property">CurrentPowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a>.<a href="../hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>;
            <b>return</b> <a href="#b7128a499cb55335" class="i method">CompleteCommand</a>(<b>new</b> <span class="t">CompletionContext</span> { <a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r3 r">commandName</span>, <a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a> = <span class="r7 r">helper</span>, <a href="CompletionAnalysis.cs.html#4055c622a2008ac8" class="i property">ExecutionContext</a> = <span class="r8 r">executionContext</span> }, <span class="r4 r">moduleName</span>, <span class="r5 r">commandTypes</span>);
        }
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="8ad3630ff3ff385a" href="../../R/8ad3630ff3ff385a.html" target="n" data-glyph="74,1" class="i method">CompleteCommand</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r9 rd" class="r9 r">context</span>)
        {
            <b>return</b> <a href="#b7128a499cb55335" class="i method">CompleteCommand</a>(<span class="r9 r">context</span>, <b>null</b>);
        }
 
        <b>private static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="b7128a499cb55335" href="../../R/b7128a499cb55335.html" target="n" data-glyph="76,1" class="i method">CompleteCommand</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r10 rd" class="r10 r">context</span>, <b>string</b> <span id="r11 rd" class="r11 r">moduleName</span>, <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r12 rd" class="r12 r">types</span> = <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#d7f466cfbbd45cdb" class="i field">All</a>)
        {
            <b>var</b> <span id="r13 rd" class="r13 r">addAmpersandIfNecessary</span> = <a href="#c0636828e4dcf26b" class="i method">IsAmpersandNeeded</a>(<span class="r10 r">context</span>, <b>false</b>);
 
            <b>string</b> <span id="r14 rd" class="r14 r">commandName</span> = <span class="r10 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>;
            <b>string</b> <span id="r15 rd" class="r15 r">quote</span> = <a href="#944eddaabbba5d42" class="i method">HandleDoubleAndSingleQuote</a>(<b>ref</b> <span class="r14 r">commandName</span>);
 
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r16 rd" class="r16 r">commandResults</span> = <b>null</b>;
 
            <b>if</b> (<span class="r14 r">commandName</span>.<span class="i">IndexOfAny</span>(<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../Utils.cs.html#0702ea1962d7d49b" class="i field">DirectoryOrDrive</a>) == -1)
            {
                <span class="c">// The name to complete is neither module qualified nor is it a relative/rooted file path.</span>
 
                <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r17 rd" class="r17 r">lastAst</span> = <b>null</b>;
                <b>if</b> (<span class="r10 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a> != <b>null</b> &amp;&amp; <span class="r10 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="r17 r">lastAst</span> = <span class="r10 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>.<span class="i">Last</span>();
                }
 
                <span class="r16 r">commandResults</span> = <a href="#e019ffc2f1b949fb" class="i method">ExecuteGetCommandCommand</a>(<span class="r18 r">useModulePrefix</span>: <b>false</b>);
 
                <b>if</b> (<span class="r17 r">lastAst</span> != <b>null</b>)
                {
                    <span class="c">// We need to add the wildcard to the end so the regex is built correctly.</span>
                    <span class="r14 r">commandName</span> += <span class="s">&quot;*&quot;</span>;
 
                    <span class="c">// Search the asts for function definitions that we might be calling</span>
                    <a href="#14a2eecd6e655208" class="k">var</a> <span id="r19 rd" class="r19 r">findFunctionsVisitor</span> = <b>new</b> <span class="t">FindFunctionsVisitor</span>();
                    <b>while</b> (<span class="r17 r">lastAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> != <b>null</b>)
                    {
                        <span class="r17 r">lastAst</span> = <span class="r17 r">lastAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                    }
 
                    <span class="r17 r">lastAst</span>.<a href="../parser/ast.cs.html#b97830265ba444e4" class="i method">Visit</a>(<span class="r19 r">findFunctionsVisitor</span>);
 
                    <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r20 rd" class="r20 r">commandNamePattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r14 r">commandName</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                    <b>foreach</b> (<b>var</b> <span id="r21 rd" class="r21 r">defn</span> <b>in</b> <span class="r19 r">findFunctionsVisitor</span>.<a href="#e9575886aef00c9e" class="i field">FunctionDefinitions</a>)
                    {
                        <b>if</b> (<span class="r20 r">commandNamePattern</span>.<span class="i">IsMatch</span>(<span class="r21 r">defn</span>.<span class="i">Name</span>)
                            &amp;&amp; !<span class="r16 r">commandResults</span>.<span class="i">Any</span>(<span id="r22 rd" class="r22 r">cr</span> =&gt; <span class="r22 r">cr</span>.<span class="i">CompletionText</span>.<span class="i">Equals</span>(<span class="r21 r">defn</span>.<span class="i">Name</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                        {
                            <span class="c">// Results found in the current script are prepended to show up at the top of the list.</span>
                            <span class="r16 r">commandResults</span>.<span class="i">Insert</span>(0, <span class="i">GetCommandNameCompletionResult</span>(<span class="r21 r">defn</span>.<span class="i">Name</span>, <span class="r21 r">defn</span>, <span class="r13 r">addAmpersandIfNecessary</span>, <span class="r15 r">quote</span>));
                        }
                    }
                }
            }
            <b>else</b>
            {
                <span class="c">// If there is a single \, we might be looking for a module/snapin qualified command</span>
                <b>var</b> <span id="r23 rd" class="r23 r">indexOfFirstColon</span> = <span class="r14 r">commandName</span>.<span class="i">IndexOf</span>(<span class="s">&#39;:&#39;</span>);
                <b>var</b> <span id="r24 rd" class="r24 r">indexOfFirstBackslash</span> = <span class="r14 r">commandName</span>.<span class="i">IndexOf</span>(<span class="s">&#39;\\&#39;</span>);
                <b>if</b> (<span class="r24 r">indexOfFirstBackslash</span> &gt; 0 &amp;&amp; (<span class="r24 r">indexOfFirstBackslash</span> &lt; <span class="r23 r">indexOfFirstColon</span> || <span class="r23 r">indexOfFirstColon</span> == -1))
                {
                    <span class="c">// First try the name before the backslash as a module name.</span>
                    <span class="c">// Use the exact module name provided by the user</span>
                    <span class="r11 r">moduleName</span> = <span class="r14 r">commandName</span>.<span class="i">Substring</span>(0, <span class="r24 r">indexOfFirstBackslash</span>);
                    <span class="r14 r">commandName</span> = <span class="r14 r">commandName</span>.<span class="i">Substring</span>(<span class="r24 r">indexOfFirstBackslash</span> + 1);
 
                    <span class="r16 r">commandResults</span> = <a href="#e019ffc2f1b949fb" class="i method">ExecuteGetCommandCommand</a>(<span class="r18 r">useModulePrefix</span>: <b>true</b>);
                }
            }
 
            <b>return</b> <span class="r16 r">commandResults</span>;
 
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="e019ffc2f1b949fb" href="../../R/e019ffc2f1b949fb.html" target="n" data-glyph="76,2" class="i method">ExecuteGetCommandCommand</a>(<b>bool</b> <span id="r18 rd" class="r18 r">useModulePrefix</span>)
            {
                <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="k">var</a> <span id="r25 rd" class="r25 r">powershell</span> = <span class="r10 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>
                    .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Get-Command&quot;</span>, <b>typeof</b>(<a href="../GetCommandCommand.cs.html#ff1a9d86cf34497b" class="t t">GetCommandCommand</a>))
                    .<a href="../hostifaces/PowerShell.cs.html#ad181c9dec5e4ffa" class="i method">AddParameter</a>(<span class="s">&quot;All&quot;</span>)
                    .<span class="i">AddParameter</span>(<span class="s">&quot;Name&quot;</span>, <span class="r14 r">commandName</span> + <span class="s">&quot;*&quot;</span>);
 
                <b>if</b> (<span class="r11 r">moduleName</span> != <b>null</b>)
                {
                    <span class="r25 r">powershell</span>.<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Module&quot;</span>, <span class="r11 r">moduleName</span>);
                }
 
                <b>if</b> (!<span class="r12 r">types</span>.<span class="i">Equals</span>(<a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#d7f466cfbbd45cdb" class="i field">All</a>))
                {
                    <span class="r25 r">powershell</span>.<span class="i">AddParameter</span>(<span class="s">&quot;CommandType&quot;</span>, <span class="r12 r">types</span>);
                }
 
                <span class="c">// Exception is ignored, the user simply does not get any completion results if the pipeline fails</span>
                <span class="i">Exception</span> <span id="r26 rd" class="r26 r">exceptionThrown</span>;
                <b>var</b> <span id="r27 rd" class="r27 r">commandInfos</span> = <span class="r10 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r26 r">exceptionThrown</span>);
 
                <b>if</b> (<span class="r27 r">commandInfos</span> == <b>null</b> || <span class="r27 r">commandInfos</span>.<span class="i">Count</span> == 0)
                {
                    <span class="r25 r">powershell</span>.<a href="../hostifaces/PowerShell.cs.html#7bde27452e045465" class="i property">Commands</a>.<a href="../hostifaces/PSCommand.cs.html#15970659c9fe6157" class="i method">Clear</a>();
                    <span class="r25 r">powershell</span>
                        .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Get-Command&quot;</span>, <b>typeof</b>(<a href="../GetCommandCommand.cs.html#ff1a9d86cf34497b" class="t t">GetCommandCommand</a>))
                        .<a href="../hostifaces/PowerShell.cs.html#ad181c9dec5e4ffa" class="i method">AddParameter</a>(<span class="s">&quot;All&quot;</span>)
                        .<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Name&quot;</span>, <span class="r14 r">commandName</span>)
                        .<a href="../hostifaces/PowerShell.cs.html#ad181c9dec5e4ffa" class="i method">AddParameter</a>(<span class="s">&quot;UseAbbreviationExpansion&quot;</span>);
 
                    <b>if</b> (<span class="r11 r">moduleName</span> != <b>null</b>)
                    {
                        <span class="r25 r">powershell</span>.<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Module&quot;</span>, <span class="r11 r">moduleName</span>);
                    }
 
                    <b>if</b> (!<span class="r12 r">types</span>.<span class="i">Equals</span>(<a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#d7f466cfbbd45cdb" class="i field">All</a>))
                    {
                        <span class="r25 r">powershell</span>.<span class="i">AddParameter</span>(<span class="s">&quot;CommandType&quot;</span>, <span class="r12 r">types</span>);
                    }
 
                    <span class="r27 r">commandInfos</span> = <span class="r10 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r26 r">exceptionThrown</span>);
                }
 
                <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r28 rd" class="r28 r">completionResults</span> = <b>null</b>;
 
                <b>if</b> (<span class="r27 r">commandInfos</span> != <b>null</b> &amp;&amp; <span class="r27 r">commandInfos</span>.<span class="i">Count</span> &gt; 1)
                {
                    <span class="c">// OrderBy is using stable sorting</span>
                    <b>var</b> <span id="r29 rd" class="r29 r">sortedCommandInfos</span> = <span class="r27 r">commandInfos</span>.<span class="i">OrderBy</span>(<b>static</b> <span id="r30 rd" class="r30 r">a</span> =&gt; <span class="r30 r">a</span>, <b>new</b> <span class="t">CommandNameComparer</span>());
                    <span class="r28 r">completionResults</span> = <span class="i">MakeCommandsUnique</span>(<span class="r29 r">sortedCommandInfos</span>, <span class="r18 r">useModulePrefix</span>, <span class="r13 r">addAmpersandIfNecessary</span>, <span class="r15 r">quote</span>);
                }
                <b>else</b>
                {
                    <span class="r28 r">completionResults</span> = <span class="i">MakeCommandsUnique</span>(<span class="r27 r">commandInfos</span>, <span class="r18 r">useModulePrefix</span>, <span class="r13 r">addAmpersandIfNecessary</span>, <span class="r15 r">quote</span>);
                }
 
                <b>return</b> <span class="r28 r">completionResults</span>;
            }
        }
 
        <b>private static readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="d44890319b67b8e1" href="../../R/d44890319b67b8e1.html" target="n" data-glyph="46,1" class="i field">s_keywordsToExcludeFromAddingAmpersand</a>
            = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>) { <b>nameof</b>(<a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#7002a360506192c2" class="i field">InlineScript</a>), <b>nameof</b>(<a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#c97348c99412133c" class="i field">Configuration</a>) };
 
        <b>internal static</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="afd1223c02d4198e" href="../../R/afd1223c02d4198e.html" target="n" data-glyph="74,1" class="i method">GetCommandNameCompletionResult</a>(<b>string</b> <span id="r31 rd" class="r31 r">name</span>, <b>object</b> <span id="r32 rd" class="r32 r">command</span>, <b>bool</b> <span id="r33 rd" class="r33 r">addAmpersandIfNecessary</span>, <b>string</b> <span id="r34 rd" class="r34 r">quote</span>)
        {
            <b>string</b> <span id="r35 rd" class="r35 r">syntax</span> = <span class="r31 r">name</span>, <span id="r36 rd" class="r36 r">listItem</span> = <span class="r31 r">name</span>;
 
            <a href="../CommandInfo.cs.html#71babe57a99ca852" class="k">var</a> <span id="r37 rd" class="r37 r">commandInfo</span> = <span class="r32 r">command</span> <b>as</b> <a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>;
            <b>if</b> (<span class="r37 r">commandInfo</span> != <b>null</b>)
            {
                <b>try</b>
                {
                    <span class="r36 r">listItem</span> = <span class="r37 r">commandInfo</span>.<a href="../CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
                    <span class="c">// This may require parsing a script, which could fail in a number of different ways</span>
                    <span class="c">// (syntax errors, security exceptions, etc.)  If so, the name is fine for the tooltip.</span>
                    <span class="r35 r">syntax</span> = <span class="r37 r">commandInfo</span>.<a href="../CommandInfo.cs.html#dadfecc65f9b7a31" class="i property">Syntax</a>;
                }
                <b>catch</b> (<span class="i">Exception</span>)
                {
                }
            }
 
            <span class="r35 r">syntax</span> = <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r35 r">syntax</span>) ? <span class="r31 r">name</span> : <span class="r35 r">syntax</span>;
            <b>bool</b> <span id="r38 rd" class="r38 r">needAmpersand</span>;
 
            <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r31 r">name</span>, <b>false</b>))
            {
                <span class="r38 r">needAmpersand</span> = <span class="r34 r">quote</span> == <b>string</b>.<span class="i">Empty</span> &amp;&amp; <span class="r33 r">addAmpersandIfNecessary</span>;
                <b>string</b> <span id="r39 rd" class="r39 r">quoteInUse</span> = <span class="r34 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r34 r">quote</span>;
                <b>if</b> (<span class="r39 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                {
                    <span class="r31 r">name</span> = <span class="r31 r">name</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                }
                <b>else</b>
                {
                    <span class="r31 r">name</span> = <span class="r31 r">name</span>.<span class="i">Replace</span>(<span class="s">&quot;`&quot;</span>, <span class="s">&quot;``&quot;</span>);
                    <span class="r31 r">name</span> = <span class="r31 r">name</span>.<span class="i">Replace</span>(<span class="s">&quot;$&quot;</span>, <span class="s">&quot;`$&quot;</span>);
                }
 
                <span class="r31 r">name</span> = <span class="r39 r">quoteInUse</span> + <span class="r31 r">name</span> + <span class="r39 r">quoteInUse</span>;
            }
            <b>else</b>
            {
                <span class="r38 r">needAmpersand</span> = <span class="r34 r">quote</span> == <b>string</b>.<span class="i">Empty</span> &amp;&amp; <span class="r33 r">addAmpersandIfNecessary</span> &amp;&amp;
                                <a href="../parser/tokenizer.cs.html#fac4dc2d20ae0759" class="t t">Tokenizer</a>.<a href="../parser/tokenizer.cs.html#d678726f968b9d52" class="i method">IsKeyword</a>(<span class="r31 r">name</span>) &amp;&amp; !<a href="#d44890319b67b8e1" class="i field">s_keywordsToExcludeFromAddingAmpersand</a>.<span class="i">Contains</span>(<span class="r31 r">name</span>);
                <span class="r31 r">name</span> = <span class="r34 r">quote</span> + <span class="r31 r">name</span> + <span class="r34 r">quote</span>;
            }
 
            <span class="c">// It&#39;s useless to call ForEach-Object (foreach) as the first command of a pipeline. For example:</span>
            <span class="c">//     PS C:\&gt; fore&lt;tab&gt;  ---&gt;   PS C:\&gt; foreach   (expected, use as the keyword)</span>
            <span class="c">//     PS C:\&gt; fore&lt;tab&gt;  ---&gt;   PS C:\&gt; &amp; foreach (unexpected, ForEach-Object is seldom used as the first command of a pipeline)</span>
            <b>if</b> (<span class="r38 r">needAmpersand</span> &amp;&amp; <span class="r31 r">name</span> != <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#0b26037366c6e99a" class="i field">@foreach</a>)
            {
                <span class="r31 r">name</span> = <span class="s">&quot;&amp; &quot;</span> + <span class="r31 r">name</span>;
            }
 
            <b>return</b> <b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r31 r">name</span>, <span class="r36 r">listItem</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#8f5d60fd073bb8d9" class="i field">Command</a>, <span class="r35 r">syntax</span>);
        }
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="5c4fc2885646d8d7" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">MakeCommandsUnique</a>(<span class="i">IEnumerable</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r40 rd" class="r40 r">commandInfoPsObjs</span>, <b>bool</b> <span id="r41 rd" class="r41 r">includeModulePrefix</span>, <b>bool</b> <span id="r42 rd" class="r42 r">addAmpersandIfNecessary</span>, <b>string</b> <span id="r43 rd" class="r43 r">quote</span>)
        {
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r44 rd" class="r44 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
            <b>if</b> (<span class="r40 r">commandInfoPsObjs</span> == <b>null</b> || !<span class="r40 r">commandInfoPsObjs</span>.<span class="i">Any</span>())
            {
                <b>return</b> <span class="r44 r">results</span>;
            }
 
            <b>var</b> <span id="r45 rd" class="r45 r">commandTable</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>object</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<b>var</b> <span id="r46 rd" class="r46 r">psobj</span> <b>in</b> <span class="r40 r">commandInfoPsObjs</span>)
            {
                <b>object</b> <span id="r47 rd" class="r47 r">baseObj</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">Base</span>(<span class="r46 r">psobj</span>);
                <b>string</b> <span id="r48 rd" class="r48 r">name</span> = <b>null</b>;
 
                <a href="../CommandInfo.cs.html#71babe57a99ca852" class="k">var</a> <span id="r49 rd" class="r49 r">commandInfo</span> = <span class="r47 r">baseObj</span> <b>as</b> <a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>;
                <b>if</b> (<span class="r49 r">commandInfo</span> != <b>null</b>)
                {
                    <span class="c">// Skip the private commands</span>
                    <b>if</b> (<span class="r49 r">commandInfo</span>.<a href="../CommandInfo.cs.html#cb0c02415aeca7d5" class="i property">Visibility</a> == <a href="../SessionStatePublic.cs.html#3acdda74c688180a" class="t t">SessionStateEntryVisibility</a>.<a href="../SessionStatePublic.cs.html#9412d519f56b8001" class="i field">Private</a>) { <b>continue</b>; }
 
                    <span class="r48 r">name</span> = <span class="r49 r">commandInfo</span>.<a href="../CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
                    <b>if</b> (<span class="r41 r">includeModulePrefix</span> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r49 r">commandInfo</span>.<a href="../CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>))
                    {
                        <span class="c">// The command might be a prefixed commandInfo that we get by importing a module with the -Prefix parameter, for example:</span>
                        <span class="c">//    FooModule.psm1: Get-Foo</span>
                        <span class="c">//    import-module FooModule -Prefix PowerShell</span>
                        <span class="c">//    --&gt; command &#39;Get-PowerShellFoo&#39; in the global session state (prefixed commandInfo)</span>
                        <span class="c">//        command &#39;Get-Foo&#39; in the module session state (un-prefixed commandInfo)</span>
                        <span class="c">// in that case, we should not add the module name qualification because it doesn&#39;t work</span>
                        <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r49 r">commandInfo</span>.<a href="../CommandInfo.cs.html#48e9ebf217764505" class="i property">Prefix</a>) || !<a href="../Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="../Modules/ModuleCmdletBase.cs.html#a5c7fe2c0cac1ea6" class="i method">IsPrefixedCommand</a>(<span class="r49 r">commandInfo</span>))
                        {
                            <span class="r48 r">name</span> = <span class="r49 r">commandInfo</span>.<a href="../CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a> + <span class="s">&quot;\\&quot;</span> + <span class="r49 r">commandInfo</span>.<a href="../CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
                        }
                    }
                }
                <b>else</b>
                {
                    <span class="r48 r">name</span> = <span class="r47 r">baseObj</span> <b>as string</b>;
                    <b>if</b> (<span class="r48 r">name</span> == <b>null</b>) { <b>continue</b>; }
                }
 
                <b>object</b> <span id="r50 rd" class="r50 r">value</span>;
                <b>if</b> (!<span class="r45 r">commandTable</span>.<span class="i">TryGetValue</span>(<span class="r48 r">name</span>, <b>out</b> <span class="r50 r">value</span>))
                {
                    <span class="r45 r">commandTable</span>.<span class="i">Add</span>(<span class="r48 r">name</span>, <span class="r47 r">baseObj</span>);
                }
                <b>else</b>
                {
                    <b>var</b> <span id="r51 rd" class="r51 r">list</span> = <span class="r50 r">value</span> <b>as</b> <span class="i">List</span>&lt;<b>object</b>&gt;;
                    <b>if</b> (<span class="r51 r">list</span> != <b>null</b>)
                    {
                        <span class="r51 r">list</span>.<span class="i">Add</span>(<span class="r47 r">baseObj</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r51 r">list</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt; { <span class="r50 r">value</span>, <span class="r47 r">baseObj</span> };
                        <span class="r45 r">commandTable</span>[<span class="r48 r">name</span>] = <span class="r51 r">list</span>;
                    }
                }
            }
 
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r52 rd" class="r52 r">endResults</span> = <b>null</b>;
            <b>foreach</b> (<b>var</b> <span id="r53 rd" class="r53 r">keyValuePair</span> <b>in</b> <span class="r45 r">commandTable</span>)
            {
                <b>var</b> <span id="r54 rd" class="r54 r">commandList</span> = <span class="r53 r">keyValuePair</span>.<span class="i">Value</span> <b>as</b> <span class="i">List</span>&lt;<b>object</b>&gt;;
                <b>if</b> (<span class="r54 r">commandList</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r52 r">endResults</span> == <b>null</b>)
                    {
                        <span class="r52 r">endResults</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
                    }
 
                    <span class="c">// The first command might be an un-prefixed commandInfo that we get by importing a module with the -Prefix parameter,</span>
                    <span class="c">// in that case, we should add the module name qualification because if the module is not in the module path, calling</span>
                    <span class="c">// &#39;Get-Foo&#39; directly doesn&#39;t work</span>
                    <b>string</b> <span id="r55 rd" class="r55 r">completionName</span> = <span class="r53 r">keyValuePair</span>.<span class="i">Key</span>;
                    <b>if</b> (!<span class="r41 r">includeModulePrefix</span>)
                    {
                        <a href="../CommandInfo.cs.html#71babe57a99ca852" class="k">var</a> <span id="r56 rd" class="r56 r">commandInfo</span> = <span class="r54 r">commandList</span>[0] <b>as</b> <a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>;
                        <b>if</b> (<span class="r56 r">commandInfo</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r56 r">commandInfo</span>.<a href="../CommandInfo.cs.html#48e9ebf217764505" class="i property">Prefix</a>))
                        {
                            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r56 r">commandInfo</span>.<a href="../CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>), <span class="s">&quot;the module name should exist if commandInfo.Prefix is not an empty string&quot;</span>);
                            <b>if</b> (!<a href="../Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="../Modules/ModuleCmdletBase.cs.html#a5c7fe2c0cac1ea6" class="i method">IsPrefixedCommand</a>(<span class="r56 r">commandInfo</span>))
                            {
                                <span class="r55 r">completionName</span> = <span class="r56 r">commandInfo</span>.<a href="../CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a> + <span class="s">&quot;\\&quot;</span> + <span class="r55 r">completionName</span>;
                            }
                        }
                    }
 
                    <span class="r44 r">results</span>.<span class="i">Add</span>(<span class="i">GetCommandNameCompletionResult</span>(<span class="r55 r">completionName</span>, <span class="r54 r">commandList</span>[0], <span class="r42 r">addAmpersandIfNecessary</span>, <span class="r43 r">quote</span>));
 
                    <span class="c">// For the other commands that are hidden, we need to disambiguate,</span>
                    <span class="c">// but put these at the end as it&#39;s less likely any of the hidden</span>
                    <span class="c">// commands are desired.  If we can&#39;t add anything to disambiguate,</span>
                    <span class="c">// then we&#39;ll skip adding a completion result.</span>
                    <b>for</b> (<b>int</b> <span id="r57 rd" class="r57 r">index</span> = 1; <span class="r57 r">index</span> &lt; <span class="r54 r">commandList</span>.<span class="i">Count</span>; <span class="r57 r">index</span>++)
                    {
                        <a href="../CommandInfo.cs.html#71babe57a99ca852" class="k">var</a> <span id="r58 rd" class="r58 r">commandInfo</span> = <span class="r54 r">commandList</span>[<span class="r57 r">index</span>] <b>as</b> <a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>;
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r58 r">commandInfo</span> != <b>null</b>, <span class="s">&quot;Elements should always be CommandInfo&quot;</span>);
 
                        <b>if</b> (<span class="r58 r">commandInfo</span>.<a href="../CommandInfo.cs.html#1aa74ca244a39308" class="i property">CommandType</a> == <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#f4fc4c6de9082bc5" class="i field">Application</a>)
                        {
                            <span class="r52 r">endResults</span>.<span class="i">Add</span>(<a href="#afd1223c02d4198e" class="i method">GetCommandNameCompletionResult</a>(<span class="r58 r">commandInfo</span>.<a href="../CommandInfo.cs.html#a887e8cd226475a7" class="i property">Definition</a>, <span class="r58 r">commandInfo</span>, <span class="r42 r">addAmpersandIfNecessary</span>, <span class="r43 r">quote</span>));
                        }
                        <b>else</b> <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r58 r">commandInfo</span>.<a href="../CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>))
                        {
                            <b>var</b> <span id="r59 rd" class="r59 r">name</span> = <span class="r58 r">commandInfo</span>.<a href="../CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a> + <span class="s">&quot;\\&quot;</span> + <span class="r58 r">commandInfo</span>.<a href="../CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
                            <span class="r52 r">endResults</span>.<span class="i">Add</span>(<span class="i">GetCommandNameCompletionResult</span>(<span class="r59 r">name</span>, <span class="r58 r">commandInfo</span>, <span class="r42 r">addAmpersandIfNecessary</span>, <span class="r43 r">quote</span>));
                        }
                    }
                }
                <b>else</b>
                {
                    <span class="c">// The first command might be an un-prefixed commandInfo that we get by importing a module with the -Prefix parameter,</span>
                    <span class="c">// in that case, we should add the module name qualification because if the module is not in the module path, calling</span>
                    <span class="c">// &#39;Get-Foo&#39; directly doesn&#39;t work</span>
                    <b>string</b> <span id="r60 rd" class="r60 r">completionName</span> = <span class="r53 r">keyValuePair</span>.<span class="i">Key</span>;
                    <b>if</b> (!<span class="r41 r">includeModulePrefix</span>)
                    {
                        <a href="../CommandInfo.cs.html#71babe57a99ca852" class="k">var</a> <span id="r61 rd" class="r61 r">commandInfo</span> = <span class="r53 r">keyValuePair</span>.<span class="i">Value</span> <b>as</b> <a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>;
                        <b>if</b> (<span class="r61 r">commandInfo</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r61 r">commandInfo</span>.<a href="../CommandInfo.cs.html#48e9ebf217764505" class="i property">Prefix</a>))
                        {
                            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r61 r">commandInfo</span>.<a href="../CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a>), <span class="s">&quot;the module name should exist if commandInfo.Prefix is not an empty string&quot;</span>);
                            <b>if</b> (!<a href="../Modules/ModuleCmdletBase.cs.html#0479f5f00c7dafc1" class="t t">ModuleCmdletBase</a>.<a href="../Modules/ModuleCmdletBase.cs.html#a5c7fe2c0cac1ea6" class="i method">IsPrefixedCommand</a>(<span class="r61 r">commandInfo</span>))
                            {
                                <span class="r60 r">completionName</span> = <span class="r61 r">commandInfo</span>.<a href="../CommandInfo.cs.html#fab1cff11b16805c" class="i property">ModuleName</a> + <span class="s">&quot;\\&quot;</span> + <span class="r60 r">completionName</span>;
                            }
                        }
                    }
 
                    <span class="r44 r">results</span>.<span class="i">Add</span>(<span class="i">GetCommandNameCompletionResult</span>(<span class="r60 r">completionName</span>, <span class="r53 r">keyValuePair</span>.<span class="i">Value</span>, <span class="r42 r">addAmpersandIfNecessary</span>, <span class="r43 r">quote</span>));
                }
            }
 
            <b>if</b> (<span class="r52 r">endResults</span> != <b>null</b> &amp;&amp; <span class="r52 r">endResults</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r44 r">results</span>.<span class="i">AddRange</span>(<span class="r52 r">endResults</span>);
            }
 
            <b>return</b> <span class="r44 r">results</span>;
        }
 
        <b>private sealed class</b> <a id="14a2eecd6e655208" href="../../R/14a2eecd6e655208.html" target="n" data-glyph="4,1" class="t t"><span id="7f56350115ac1843">FindFunctionsVisitor</span></a> : <a href="../parser/PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a>
        {
            <b>internal readonly</b> <span class="i">List</span>&lt;<a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a>&gt; <a id="e9575886aef00c9e" href="../../R/e9575886aef00c9e.html" target="n" data-glyph="44,2" class="i field">FunctionDefinitions</a> = <b>new</b> <span class="i">List</span>&lt;<a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a>&gt;();
 
            <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="cebd2813f77a2a1d" href="../../R/cebd2813f77a2a1d.html" target="n" data-glyph="72,2" class="i method">VisitFunctionDefinition</a>(<a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r62 rd" class="r62 r">functionDefinitionAst</span>)
            {
                <a href="#e9575886aef00c9e" class="i field">FunctionDefinitions</a>.<span class="i">Add</span>(<span class="r62 r">functionDefinitionAst</span>);
                <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command Names
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Module Names
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="f0abd69597cfd93f" href="../../R/f0abd69597cfd93f.html" target="n" data-glyph="74,1" class="i method">CompleteModuleName</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r63 rd" class="r63 r">context</span>, <b>bool</b> <span id="r64 rd" class="r64 r">loadedModulesOnly</span>, <b>bool</b> <span id="r65 rd" class="r65 r">skipEditionCheck</span> = <b>false</b>)
        {
            <b>var</b> <span id="r66 rd" class="r66 r">moduleName</span> = <span class="r63 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ?? <b>string</b>.<span class="i">Empty</span>;
            <b>var</b> <span id="r67 rd" class="r67 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
            <b>var</b> <span id="r68 rd" class="r68 r">quote</span> = <span class="i">HandleDoubleAndSingleQuote</span>(<b>ref</b> <span class="r66 r">moduleName</span>);
 
            <b>if</b> (!<span class="r66 r">moduleName</span>.<span class="i">EndsWith</span>(<span class="s">&#39;*&#39;</span>))
            {
                <span class="r66 r">moduleName</span> += <span class="s">&quot;*&quot;</span>;
            }
 
            <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="k">var</a> <span id="r69 rd" class="r69 r">powershell</span> = <span class="r63 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Get-Module&quot;</span>, <b>typeof</b>(<a href="../Modules/GetModuleCommand.cs.html#6f6537067f4dfc41" class="t t">GetModuleCommand</a>)).<span class="i">AddParameter</span>(<span class="s">&quot;Name&quot;</span>, <span class="r66 r">moduleName</span>);
            <b>if</b> (!<span class="r64 r">loadedModulesOnly</span>)
            {
                <span class="r69 r">powershell</span>.<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;ListAvailable&quot;</span>, <b>true</b>);
 
                <span class="c">// -SkipEditionCheck should only be set or apply to -ListAvailable</span>
                <b>if</b> (<span class="r65 r">skipEditionCheck</span>)
                {
                    <span class="r69 r">powershell</span>.<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;SkipEditionCheck&quot;</span>, <b>true</b>);
                }
            }
 
            <span class="i">Exception</span> <span id="r70 rd" class="r70 r">exceptionThrown</span>;
            <b>var</b> <span id="r71 rd" class="r71 r">psObjects</span> = <span class="r63 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r70 r">exceptionThrown</span>);
 
            <b>if</b> (<span class="r71 r">psObjects</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>dynamic</b> <span id="r72 rd" class="r72 r">moduleInfo</span> <b>in</b> <span class="r71 r">psObjects</span>)
                {
                    <b>var</b> <span id="r73 rd" class="r73 r">completionText</span> = <span class="r72 r">moduleInfo</span>.<span class="i">Name</span>.<span class="i">ToString</span>();
                    <b>var</b> <span id="r74 rd" class="r74 r">listItemText</span> = <span class="r73 r">completionText</span>;
                    <b>var</b> <span id="r75 rd" class="r75 r">toolTip</span> = <span class="s">&quot;Description: &quot;</span> + <span class="r72 r">moduleInfo</span>.<span class="i">Description</span>.<span class="i">ToString</span>() + <span class="s">&quot;\r\nModuleType: &quot;</span>
                                  + <span class="r72 r">moduleInfo</span>.<span class="i">ModuleType</span>.<span class="i">ToString</span>() + <span class="s">&quot;\r\nPath: &quot;</span>
                                  + <span class="r72 r">moduleInfo</span>.<span class="i">Path</span>.<span class="i">ToString</span>();
 
                    <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r73 r">completionText</span>, <b>false</b>))
                    {
                        <b>var</b> <span id="r76 rd" class="r76 r">quoteInUse</span> = <span class="r68 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r68 r">quote</span>;
                        <b>if</b> (<span class="r76 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                            <span class="r73 r">completionText</span> = <span class="r73 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                        <span class="r73 r">completionText</span> = <span class="r76 r">quoteInUse</span> + <span class="r73 r">completionText</span> + <span class="r76 r">quoteInUse</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r73 r">completionText</span> = <span class="r68 r">quote</span> + <span class="r73 r">completionText</span> + <span class="r68 r">quote</span>;
                    }
 
                    <span class="r67 r">result</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(<span class="r73 r">completionText</span>, <span class="r74 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r75 r">toolTip</span>));
                }
            }
 
            <b>return</b> <span class="r67 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Module Names
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Parameters
        <b>private static readonly string</b>[] <a id="a433894e04a1a5b2" href="../../R/a433894e04a1a5b2.html" target="n" data-glyph="46,1" class="i field">s_parameterNamesOfImportDSCResource</a> = { <span class="s">&quot;Name&quot;</span>, <span class="s">&quot;ModuleName&quot;</span>, <span class="s">&quot;ModuleVersion&quot;</span> };
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="ab1ad2c5a684cb16" href="../../R/ab1ad2c5a684cb16.html" target="n" data-glyph="74,1" class="i method">CompleteCommandParameter</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r77 rd" class="r77 r">context</span>)
        {
            <b>string</b> <span id="r78 rd" class="r78 r">partialName</span> = <b>null</b>;
            <b>bool</b> <span id="r79 rd" class="r79 r">withColon</span> = <b>false</b>;
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r80 rd" class="r80 r">commandAst</span> = <b>null</b>;
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r81 rd" class="r81 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
 
            <span class="c">// Find the parameter ast, it will be near or at the end</span>
            <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r82 rd" class="r82 r">parameterAst</span> = <b>null</b>;
            <a href="../parser/ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a> <span id="r83 rd" class="r83 r">keywordAst</span> = <b>null</b>;
            <b>for</b> (<b>int</b> <span id="r84 rd" class="r84 r">i</span> = <span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>.<span class="i">Count</span> - 1; <span class="r84 r">i</span> &gt;= 0; <span class="r84 r">i</span>--)
            {
                <b>if</b> (<span class="r83 r">keywordAst</span> == <b>null</b>)
                    <span class="r83 r">keywordAst</span> = <span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>[<span class="r84 r">i</span>] <b>as</b> <a href="../parser/ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a>;
                <span class="r82 r">parameterAst</span> = (<span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>[<span class="r84 r">i</span>] <b>as</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>);
                <b>if</b> (<span class="r82 r">parameterAst</span> != <b>null</b>) <b>break</b>;
            }
 
            <b>if</b> (<span class="r82 r">parameterAst</span> != <b>null</b>)
            {
                <span class="r83 r">keywordAst</span> = <span class="r82 r">parameterAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="../parser/ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a>;
            }
 
            <span class="c">// If parent is DynamicKeywordStatementAst - &#39;Import-DscResource&#39;,</span>
            <span class="c">// then customize the auto completion results</span>
            <b>if</b> (<span class="r83 r">keywordAst</span> != <b>null</b> &amp;&amp; <b>string</b>.<span class="i">Equals</span>(<span class="r83 r">keywordAst</span>.<a href="../parser/ast.cs.html#0f0688a599c6de89" class="i property">Keyword</a>.<a href="../parser/tokenizer.cs.html#b4378cc74685de63" class="i property">Keyword</a>, <span class="s">&quot;Import-DscResource&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                &amp;&amp; !<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>) &amp;&amp; <span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>.<span class="i">StartsWith</span>(<span class="s">&#39;-&#39;</span>))
            {
                <b>var</b> <span id="r85 rd" class="r85 r">lastAst</span> = <span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>.<span class="i">Last</span>();
                <b>var</b> <span id="r86 rd" class="r86 r">wordToMatch</span> = <b>string</b>.<span class="i">Concat</span>(<span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>.<span class="i">AsSpan</span>(1), <span class="s">&quot;*&quot;</span>);
                <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r87 rd" class="r87 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r86 r">wordToMatch</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                <b>var</b> <span id="r88 rd" class="r88 r">parameterNames</span> = <span class="r83 r">keywordAst</span>.<a href="../parser/ast.cs.html#783dff95585ad1fe" class="i property">CommandElements</a>.<span class="i">Where</span>(<b>static</b> <span id="r89 rd" class="r89 r">ast</span> =&gt; <span class="r89 r">ast</span> <b>is</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>).<span class="i">Select</span>(<b>static</b> <span id="r90 rd" class="r90 r">ast</span> =&gt; (<span class="r90 r">ast</span> <b>as</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>).<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>);
                <b>foreach</b> (<b>var</b> <span id="r91 rd" class="r91 r">parameterName</span> <b>in</b> <a href="#a433894e04a1a5b2" class="i field">s_parameterNamesOfImportDSCResource</a>)
                {
                    <b>if</b> (<span class="r87 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r91 r">parameterName</span>) &amp;&amp; !<span class="r88 r">parameterNames</span>.<span class="i">Contains</span>(<span class="r91 r">parameterName</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>string</b> <span id="r92 rd" class="r92 r">tooltip</span> = <span class="s">&quot;[String] &quot;</span> + <span class="r91 r">parameterName</span>;
                        <span class="r81 r">result</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(<span class="s">&quot;-&quot;</span> + <span class="r91 r">parameterName</span>, <span class="r91 r">parameterName</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#c4ba8e90b3cad3b3" class="i field">ParameterName</a>, <span class="r92 r">tooltip</span>));
                    }
                }
 
                <b>if</b> (<span class="r81 r">result</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#c219030db690057a" class="i property">ReplacementLength</a> = <span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>.<span class="i">Length</span>;
                    <span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a> = <span class="r85 r">lastAst</span>.<span class="i">Extent</span>.<span class="i">StartOffset</span>;
                }
 
                <b>return</b> <span class="r81 r">result</span>;
            }
 
            <b>if</b> (<span class="r82 r">parameterAst</span> != <b>null</b>)
            {
                <span class="c">// Parent must be a command</span>
                <span class="r80 r">commandAst</span> = (<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>)<span class="r82 r">parameterAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                <span class="r78 r">partialName</span> = <span class="r82 r">parameterAst</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
                <span class="r79 r">withColon</span> = <span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>.<span class="i">EndsWith</span>(<span class="s">&#39;:&#39;</span>);
            }
            <b>else</b>
            {
                <span class="c">// No CommandParameterAst is found. It could be a StringConstantExpressionAst &quot;-&quot;</span>
                <b>if</b> (!(<span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>[<span class="r77 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>.<span class="i">Count</span> - 1] <b>is</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <span id="r93 rd" class="r93 r">dashAst</span>))
                    <b>return</b> <span class="r81 r">result</span>;
                <b>if</b> (!<span class="r93 r">dashAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>.<span class="i">Trim</span>().<span class="i">Equals</span>(<span class="s">&quot;-&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    <b>return</b> <span class="r81 r">result</span>;
 
                <span class="c">// Parent must be a command</span>
                <span class="r80 r">commandAst</span> = (<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>)<span class="r93 r">dashAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                <span class="r78 r">partialName</span> = <b>string</b>.<span class="i">Empty</span>;
            }
 
            <a href="PseudoParameterBinder.cs.html#5ac9244be24c2bbd" class="t t">PseudoBindingInfo</a> <span id="r94 rd" class="r94 r">pseudoBinding</span> = <b>new</b> <span class="t">PseudoParameterBinder</span>()
                                                .<a href="PseudoParameterBinder.cs.html#4f331f824f2a1e35" class="i method">DoPseudoParameterBinding</a>(<span class="r80 r">commandAst</span>, <b>null</b>, <span class="r82 r">parameterAst</span>, <a href="PseudoParameterBinder.cs.html#9dc50bf5ddf87930" class="t t">PseudoParameterBinder</a>.<a href="PseudoParameterBinder.cs.html#ad6e81c17c696e75" class="t t">BindingType</a>.<a href="PseudoParameterBinder.cs.html#aeae553133a922a5" class="i field">ParameterCompletion</a>);
            <span class="c">// The command cannot be found or it&#39;s not a cmdlet, not a script cmdlet, not a function.</span>
            <span class="c">// Try completing as if it the parameter is a command argument for native command completion.</span>
            <b>if</b> (<span class="r94 r">pseudoBinding</span> == <b>null</b>)
            {
                <b>return</b> <a href="#f46bcd6b9210bb57" class="i method">CompleteCommandArgument</a>(<span class="r77 r">context</span>);
            }
 
            <b>switch</b> (<span class="r94 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#be318ae0c4315a2a" class="i property">InfoType</a>)
            {
                <b>case</b> <a href="PseudoParameterBinder.cs.html#32dafa2abbeb3f2b" class="t t">PseudoBindingInfoType</a>.<a href="PseudoParameterBinder.cs.html#dde67aa5a8134b0c" class="i field">PseudoBindingFail</a>:
                    <span class="c">// The command is a cmdlet or script cmdlet. Binding failed</span>
                    <span class="r81 r">result</span> = <span class="i">GetParameterCompletionResults</span>(<span class="r78 r">partialName</span>, <b>uint</b>.<span class="i">MaxValue</span>, <span class="r94 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#a765b55f276ef803" class="i property">UnboundParameters</a>, <span class="r79 r">withColon</span>);
                    <b>break</b>;
                <b>case</b> <a href="PseudoParameterBinder.cs.html#32dafa2abbeb3f2b" class="t t">PseudoBindingInfoType</a>.<a href="PseudoParameterBinder.cs.html#fac4de227da7e29b" class="i field">PseudoBindingSucceed</a>:
                    <span class="c">// The command is a cmdlet or script cmdlet. Binding succeeded.</span>
                    <span class="r81 r">result</span> = <a href="#62cb606e257c8738" class="i method">GetParameterCompletionResults</a>(<span class="r78 r">partialName</span>, <span class="r94 r">pseudoBinding</span>, <span class="r82 r">parameterAst</span>, <span class="r79 r">withColon</span>);
                    <b>break</b>;
            }
 
            <b>if</b> (<span class="r81 r">result</span>.<span class="i">Count</span> == 0)
            {
                <span class="r81 r">result</span> = <span class="r94 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#8a99b7a836aade94" class="i property">CommandName</a>.<span class="i">Equals</span>(<span class="s">&quot;Set-Location&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                             ? <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;(<a href="#f23c14b94c0c013f" class="i method">CompleteFilename</a>(<span class="r77 r">context</span>, <span class="r95 r">containerOnly</span>: <b>true</b>, <span class="r96 r">extension</span>: <b>null</b>))
                             : <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;(<a href="#729d5ec1cd6162b7" class="i method">CompleteFilename</a>(<span class="r77 r">context</span>));
            }
 
            <b>return</b> <span class="r81 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the parameter completion results when the pseudo binding was successful.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">bindingInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">parameterAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r100 r">withColon</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="62cb606e257c8738" href="../../R/62cb606e257c8738.html" target="n" data-glyph="76,1" class="i method">GetParameterCompletionResults</a>(<b>string</b> <span id="r97 rd" class="r97 r">parameterName</span>, <a href="PseudoParameterBinder.cs.html#5ac9244be24c2bbd" class="t t">PseudoBindingInfo</a> <span id="r98 rd" class="r98 r">bindingInfo</span>, <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r99 rd" class="r99 r">parameterAst</span>, <b>bool</b> <span id="r100 rd" class="r100 r">withColon</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#be318ae0c4315a2a" class="i property">InfoType</a>.<span class="i">Equals</span>(<a href="PseudoParameterBinder.cs.html#32dafa2abbeb3f2b" class="t t">PseudoBindingInfoType</a>.<a href="PseudoParameterBinder.cs.html#fac4de227da7e29b" class="i field">PseudoBindingSucceed</a>), <span class="s">&quot;The pseudo binding should succeed&quot;</span>);
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r101 rd" class="r101 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
 
            <b>if</b> (<span class="r97 r">parameterName</span> == <b>string</b>.<span class="i">Empty</span>)
            {
                <span class="r101 r">result</span> = <span class="i">GetParameterCompletionResults</span>(
                    <span class="r97 r">parameterName</span>,
                    <span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#c06c8a4dc27d4026" class="i property">ValidParameterSetsFlags</a>,
                    <span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#a765b55f276ef803" class="i property">UnboundParameters</a>,
                    <span class="r100 r">withColon</span>);
                <b>return</b> <span class="r101 r">result</span>;
            }
 
            <b>if</b> (<span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#52787ab8ce126866" class="i property">ParametersNotFound</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// The parameter name cannot be matched to any parameter</span>
                <b>if</b> (<span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#52787ab8ce126866" class="i property">ParametersNotFound</a>.<span class="i">Any</span>(<span id="r102 rd" class="r102 r">pAst</span> =&gt; <span class="r99 r">parameterAst</span>.<span class="i">GetHashCode</span>() == <span class="r102 r">pAst</span>.<span class="i">GetHashCode</span>()))
                {
                    <b>return</b> <span class="r101 r">result</span>;
                }
            }
 
            <b>if</b> (<span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#93392c80a0f80091" class="i property">AmbiguousParameters</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// The parameter name is ambiguous. It&#39;s ignored in the pseudo binding, and we should search in the UnboundParameters</span>
                <b>if</b> (<span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#93392c80a0f80091" class="i property">AmbiguousParameters</a>.<span class="i">Any</span>(<span id="r103 rd" class="r103 r">pAst</span> =&gt; <span class="r99 r">parameterAst</span>.<span class="i">GetHashCode</span>() == <span class="r103 r">pAst</span>.<span class="i">GetHashCode</span>()))
                {
                    <span class="r101 r">result</span> = <span class="i">GetParameterCompletionResults</span>(
                        <span class="r97 r">parameterName</span>,
                        <span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#c06c8a4dc27d4026" class="i property">ValidParameterSetsFlags</a>,
                        <span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#a765b55f276ef803" class="i property">UnboundParameters</a>,
                        <span class="r100 r">withColon</span>);
                }
 
                <b>return</b> <span class="r101 r">result</span>;
            }
 
            <b>if</b> (<span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#e8b7e6ad67a8adf2" class="i property">DuplicateParameters</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// The parameter name is resolved to a parameter that is already bound. We search it in the BoundParameters</span>
                <b>if</b> (<span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#e8b7e6ad67a8adf2" class="i property">DuplicateParameters</a>.<span class="i">Any</span>(<span id="r104 rd" class="r104 r">pAst</span> =&gt; <span class="r99 r">parameterAst</span>.<span class="i">GetHashCode</span>() == <span class="r104 r">pAst</span>.<span class="i">Parameter</span>.<span class="i">GetHashCode</span>()))
                {
                    <span class="r101 r">result</span> = <span class="i">GetParameterCompletionResults</span>(
                        <span class="r97 r">parameterName</span>,
                        <span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#c06c8a4dc27d4026" class="i property">ValidParameterSetsFlags</a>,
                        <span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#05127fa9589c0eeb" class="i property">BoundParameters</a>.<span class="i">Values</span>,
                        <span class="r100 r">withColon</span>);
                }
 
                <b>return</b> <span class="r101 r">result</span>;
            }
 
            <span class="c">// The parameter should be bound in the pseudo binding during the named binding</span>
            <b>string</b> <span id="r105 rd" class="r105 r">matchedParameterName</span> = <b>null</b>;
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r106 rd" class="r106 r">entry</span> <b>in</b> <span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#0890fafe524fd733" class="i property">BoundArguments</a>)
            {
                <b>switch</b> (<span class="r106 r">entry</span>.<span class="i">Value</span>.<span class="i">ParameterArgumentType</span>)
                {
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#409b194c1cec01fc" class="i field">AstPair</a>:
                        {
                            <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a> <span id="r107 rd" class="r107 r">pair</span> = (<a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a>)<span class="r106 r">entry</span>.<span class="i">Value</span>;
                            <b>if</b> (<span class="r107 r">pair</span>.<a href="PseudoParameterBinder.cs.html#ee5926fcf99682f5" class="i property">ParameterSpecified</a> &amp;&amp; <span class="r107 r">pair</span>.<a href="PseudoParameterBinder.cs.html#72c3e7cefee2f768" class="i property">Parameter</a>.<span class="i">GetHashCode</span>() == <span class="r99 r">parameterAst</span>.<span class="i">GetHashCode</span>())
                            {
                                <span class="r105 r">matchedParameterName</span> = <span class="r106 r">entry</span>.<span class="i">Key</span>;
                            }
                            <b>else</b> <b>if</b> (<span class="r107 r">pair</span>.<a href="PseudoParameterBinder.cs.html#e1c4a25087b9c0e3" class="i property">ArgumentIsCommandParameterAst</a> &amp;&amp; <span class="r107 r">pair</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>.<span class="i">GetHashCode</span>() == <span class="r99 r">parameterAst</span>.<span class="i">GetHashCode</span>())
                            {
                                <span class="c">// The parameter name cannot be resolved to a parameter</span>
                                <b>return</b> <span class="r101 r">result</span>;
                            }
                        }
 
                        <b>break</b>;
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#9aaa905ba785afb7" class="i field">Fake</a>:
                        {
                            <a href="PseudoParameterBinder.cs.html#5a548350b3d738b5" class="t t">FakePair</a> <span id="r108 rd" class="r108 r">pair</span> = (<a href="PseudoParameterBinder.cs.html#5a548350b3d738b5" class="t t">FakePair</a>)<span class="r106 r">entry</span>.<span class="i">Value</span>;
                            <b>if</b> (<span class="r108 r">pair</span>.<a href="PseudoParameterBinder.cs.html#ee5926fcf99682f5" class="i property">ParameterSpecified</a> &amp;&amp; <span class="r108 r">pair</span>.<a href="PseudoParameterBinder.cs.html#72c3e7cefee2f768" class="i property">Parameter</a>.<span class="i">GetHashCode</span>() == <span class="r99 r">parameterAst</span>.<span class="i">GetHashCode</span>())
                            {
                                <span class="r105 r">matchedParameterName</span> = <span class="r106 r">entry</span>.<span class="i">Key</span>;
                            }
                        }
 
                        <b>break</b>;
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#6caa5fee113f4237" class="i field">Switch</a>:
                        {
                            <a href="PseudoParameterBinder.cs.html#4eb6fcc40752a8a5" class="t t">SwitchPair</a> <span id="r109 rd" class="r109 r">pair</span> = (<a href="PseudoParameterBinder.cs.html#4eb6fcc40752a8a5" class="t t">SwitchPair</a>)<span class="r106 r">entry</span>.<span class="i">Value</span>;
                            <b>if</b> (<span class="r109 r">pair</span>.<a href="PseudoParameterBinder.cs.html#ee5926fcf99682f5" class="i property">ParameterSpecified</a> &amp;&amp; <span class="r109 r">pair</span>.<a href="PseudoParameterBinder.cs.html#72c3e7cefee2f768" class="i property">Parameter</a>.<span class="i">GetHashCode</span>() == <span class="r99 r">parameterAst</span>.<span class="i">GetHashCode</span>())
                            {
                                <span class="r105 r">matchedParameterName</span> = <span class="r106 r">entry</span>.<span class="i">Key</span>;
                            }
                        }
 
                        <b>break</b>;
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#a7afade9bdc8b534" class="i field">AstArray</a>:
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#ac5fbd8418f369ff" class="i field">PipeObject</a>:
                        <b>break</b>;
                }
 
                <b>if</b> (<span class="r105 r">matchedParameterName</span> != <b>null</b>)
                    <b>break</b>;
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r105 r">matchedParameterName</span> != <b>null</b>, <span class="s">&quot;we should find matchedParameterName from the BoundArguments&quot;</span>);
            <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r110 rd" class="r110 r">param</span> = <span class="r98 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#05127fa9589c0eeb" class="i property">BoundParameters</a>[<span class="r105 r">matchedParameterName</span>];
 
            <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r111 rd" class="r111 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r97 r">parameterName</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <b>string</b> <span id="r112 rd" class="r112 r">parameterType</span> = <span class="s">&quot;[&quot;</span> + <a href="../../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<a href="../MshObject.cs.html#edc1ecfda5d75ea9" class="i method">Type</a>(<span class="r110 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>, <span class="r113 r">dropNamespaces</span>: <b>true</b>) + <span class="s">&quot;] &quot;</span>;
            <b>string</b> <span id="r114 rd" class="r114 r">colonSuffix</span> = <span class="r100 r">withColon</span> ? <span class="s">&quot;:&quot;</span> : <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<span class="r111 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r105 r">matchedParameterName</span>))
            {
                <b>string</b> <span id="r115 rd" class="r115 r">completionText</span> = <span class="s">&quot;-&quot;</span> + <span class="r105 r">matchedParameterName</span> + <span class="r114 r">colonSuffix</span>;
                <b>string</b> <span id="r116 rd" class="r116 r">tooltip</span> = <span class="r112 r">parameterType</span> + <span class="r105 r">matchedParameterName</span>;
                <span class="r101 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r115 r">completionText</span>, <span class="r105 r">matchedParameterName</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#c4ba8e90b3cad3b3" class="i field">ParameterName</a>, <span class="r116 r">tooltip</span>));
            }
 
            <span class="c">// Process alias when there is partial input</span>
            <span class="r101 r">result</span>.<span class="i">AddRange</span>(<b>from</b> <span class="i">alias</span> <b>in</b> <span class="r110 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#029c8e124435d0fd" class="i property">Aliases</a>
                            <b>where</b> <span class="r111 r">pattern</span>.<span class="i">IsMatch</span>(<span class="i">alias</span>)
                            <b>select</b>
                                <b>new</b> <span class="t">CompletionResult</span>(<span class="s">&quot;-&quot;</span> + <span class="i">alias</span> + <span class="r114 r">colonSuffix</span>, <span class="i">alias</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#c4ba8e90b3cad3b3" class="i field">ParameterName</a>,
                                                     <span class="r112 r">parameterType</span> + <span class="i">alias</span>));
 
            <b>return</b> <span class="r101 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the parameter completion results by using the given valid parameter sets and available parameters.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r117 r">parameterName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r118 r">validParameterSetFlags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r119 r">parameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r120 r">withColon</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="48fe35846a06f3ee" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetParameterCompletionResults</a>(
            <b>string</b> <span id="r117 rd" class="r117 r">parameterName</span>,
            <b>uint</b> <span id="r118 rd" class="r118 r">validParameterSetFlags</span>,
            <span class="i">IEnumerable</span>&lt;<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r119 rd" class="r119 r">parameters</span>,
            <b>bool</b> <span id="r120 rd" class="r120 r">withColon</span>)
        {
            <b>var</b> <span id="r121 rd" class="r121 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
            <b>var</b> <span id="r122 rd" class="r122 r">commonParamResult</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
            <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r123 rd" class="r123 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r117 r">parameterName</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <b>var</b> <span id="r124 rd" class="r124 r">colonSuffix</span> = <span class="r120 r">withColon</span> ? <span class="s">&quot;:&quot;</span> : <b>string</b>.<span class="i">Empty</span>;
 
            <b>bool</b> <span id="r125 rd" class="r125 r">addCommonParameters</span> = <b>true</b>;
            <b>foreach</b> (<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r126 rd" class="r126 r">param</span> <b>in</b> <span class="r119 r">parameters</span>)
            {
                <b>bool</b> <span id="r127 rd" class="r127 r">inParameterSet</span> = (<span class="r126 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a> &amp; <span class="r118 r">validParameterSetFlags</span>) != 0 || <span class="r126 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#28fd649ec0fa1b52" class="i property">IsInAllSets</a>;
                <b>if</b> (!<span class="r127 r">inParameterSet</span>)
                    <b>continue</b>;
 
                <b>string</b> <span id="r128 rd" class="r128 r">name</span> = <span class="r126 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>;
                <b>string</b> <span id="r129 rd" class="r129 r">type</span> = <span class="s">&quot;[&quot;</span> + <a href="../../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<a href="../MshObject.cs.html#edc1ecfda5d75ea9" class="i method">Type</a>(<span class="r126 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>, <span class="r113 r">dropNamespaces</span>: <b>true</b>) + <span class="s">&quot;] &quot;</span>;
                <b>bool</b> <span id="r130 rd" class="r130 r">isCommonParameter</span> = <a href="../cmdlet.cs.html#b0d421ff1d7581f9" class="t t">Cmdlet</a>.<a href="../cmdlet.cs.html#c2e19a049c38e66b" class="i property">CommonParameters</a>.<span class="i">Contains</span>(<span class="r128 r">name</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r131 rd" class="r131 r">listInUse</span> = <span class="r130 r">isCommonParameter</span> ? <span class="r122 r">commonParamResult</span> : <span class="r121 r">result</span>;
 
                <b>if</b> (<span class="r123 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r128 r">name</span>))
                {
                    <span class="c">// Then using functions to back dynamic keywords, we don&#39;t necessarily</span>
                    <span class="c">// want all of the parameters to be shown to the user. Those that are marked</span>
                    <span class="c">// DontShow will not be displayed. Also, if any of the parameters have</span>
                    <span class="c">// don&#39;t show set, we won&#39;t show any of the common parameters either.</span>
                    <b>bool</b> <span id="r132 rd" class="r132 r">showToUser</span> = <b>true</b>;
                    <b>var</b> <span id="r133 rd" class="r133 r">compiledAttributes</span> = <span class="r126 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#f2f9b722fb3a36da" class="i property">CompiledAttributes</a>;
                    <b>if</b> (<span class="r133 r">compiledAttributes</span> != <b>null</b> &amp;&amp; <span class="r133 r">compiledAttributes</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <b>foreach</b> (<b>var</b> <span id="r134 rd" class="r134 r">attr</span> <b>in</b> <span class="r133 r">compiledAttributes</span>)
                        {
                            <a href="../Attributes.cs.html#3d5ed915c8442ad6" class="k">var</a> <span id="r135 rd" class="r135 r">pattr</span> = <span class="r134 r">attr</span> <b>as</b> <a href="../Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>;
                            <b>if</b> (<span class="r135 r">pattr</span> != <b>null</b> &amp;&amp; <span class="r135 r">pattr</span>.<a href="../Attributes.cs.html#aece56bfac51ced8" class="i property">DontShow</a>)
                            {
                                <span class="r132 r">showToUser</span> = <b>false</b>;
                                <span class="r125 r">addCommonParameters</span> = <b>false</b>;
                                <b>break</b>;
                            }
                        }
                    }
 
                    <b>if</b> (<span class="r132 r">showToUser</span>)
                    {
                        <b>string</b> <span id="r136 rd" class="r136 r">completionText</span> = <span class="s">&quot;-&quot;</span> + <span class="r128 r">name</span> + <span class="r124 r">colonSuffix</span>;
                        <b>string</b> <span id="r137 rd" class="r137 r">tooltip</span> = <span class="r129 r">type</span> + <span class="r128 r">name</span>;
                        <span class="r131 r">listInUse</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r136 r">completionText</span>, <span class="r128 r">name</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#c4ba8e90b3cad3b3" class="i field">ParameterName</a>,
                                                           <span class="r137 r">tooltip</span>));
                    }
                }
 
                <b>if</b> (<span class="r117 r">parameterName</span> != <b>string</b>.<span class="i">Empty</span>)
                {
                    <span class="c">// Process alias when there is partial input</span>
                    <span class="r131 r">listInUse</span>.<span class="i">AddRange</span>(<b>from</b> <span class="i">alias</span> <b>in</b> <span class="r126 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#029c8e124435d0fd" class="i property">Aliases</a>
                                       <b>where</b> <span class="r123 r">pattern</span>.<span class="i">IsMatch</span>(<span class="i">alias</span>)
                                       <b>select</b>
                                         <b>new</b> <span class="t">CompletionResult</span>(<span class="s">&quot;-&quot;</span> + <span class="i">alias</span> + <span class="r124 r">colonSuffix</span>, <span class="i">alias</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#c4ba8e90b3cad3b3" class="i field">ParameterName</a>,
                                                              <span class="r129 r">type</span> + <span class="i">alias</span>));
                }
            }
 
            <span class="c">// Add the common parameters to the results if expected.</span>
            <b>if</b> (<span class="r125 r">addCommonParameters</span>)
            {
                <span class="r121 r">result</span>.<span class="i">AddRange</span>(<span class="r122 r">commonParamResult</span>);
            }
 
            <b>return</b> <span class="r121 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get completion results for operators that start with </span><span class="c">&lt;</span><span class="c">paramref</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r138 r">wordToComplete</span><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r138 r">wordToComplete</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The starting text of the operator to complete.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A list of completion results.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="c445882fd2905d76" href="../../R/c445882fd2905d76.html" target="n" data-glyph="72,1" class="i method">CompleteOperator</a>(<b>string</b> <span id="r138 rd" class="r138 r">wordToComplete</span>)
        {
            <b>if</b> (<span class="r138 r">wordToComplete</span>.<span class="i">StartsWith</span>(<span class="s">&#39;-&#39;</span>))
            {
                <span class="r138 r">wordToComplete</span> = <span class="r138 r">wordToComplete</span>.<span class="i">Substring</span>(1);
            }
 
            <b>return</b> (<b>from</b> <span class="i">op</span> <b>in</b> <a href="../parser/tokenizer.cs.html#fac4dc2d20ae0759" class="t t">Tokenizer</a>.<a href="../parser/tokenizer.cs.html#d1014122afd4af1c" class="i field">_operatorText</a>
                    <b>where</b> <span class="i">op</span>.<span class="i">StartsWith</span>(<span class="r138 r">wordToComplete</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                    <b>orderby</b> <span class="i">op</span>
                    <b>select</b> <b>new</b> <span class="t">CompletionResult</span>(<span class="s">&quot;-&quot;</span> + <span class="i">op</span>, <span class="i">op</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#c4ba8e90b3cad3b3" class="i field">ParameterName</a>, <span class="i">GetOperatorDescription</span>(<span class="i">op</span>))).<span class="i">ToList</span>();
        }
 
        <b>private static string</b> <a id="afdc86e7815fb760" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetOperatorDescription</a>(<b>string</b> <span id="r139 rd" class="r139 r">op</span>)
        {
            <b>return</b> <a href="../../utils/ResourceManagerCache.cs.html#ce506566c7e4a091" class="t t">ResourceManagerCache</a>.<span class="i">GetResourceString</span>(<b>typeof</b>(<a href="#ef47b689fd4f15e2" class="t t">CompletionCompleters</a>).<span class="i">Assembly</span>,
                                                          <span class="s">&quot;System.Management.Automation.resources.TabCompletionStrings&quot;</span>,
                                                          <span class="r139 r">op</span> + <span class="s">&quot;OperatorDescription&quot;</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command Parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Command Arguments
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="f46bcd6b9210bb57" href="../../R/f46bcd6b9210bb57.html" target="n" data-glyph="74,1" class="i method">CompleteCommandArgument</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r140 rd" class="r140 r">context</span>)
        {
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r141 rd" class="r141 r">commandAst</span> = <b>null</b>;
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r142 rd" class="r142 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
 
            <span class="c">// Find the expression ast. It should be at the end if there is one</span>
            <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r143 rd" class="r143 r">expressionAst</span> = <b>null</b>;
            <a href="../parser/ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a> <span id="r144 rd" class="r144 r">secondToLastMemberAst</span> = <b>null</b>;
            <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r145 rd" class="r145 r">lastAst</span> = <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>.<span class="i">Last</span>();
 
            <span class="r143 r">expressionAst</span> = <span class="r145 r">lastAst</span> <b>as</b> <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>;
            <b>if</b> (<span class="r143 r">expressionAst</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>)
                {
                    <span class="r141 r">commandAst</span> = (<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>)<span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
 
                    <b>if</b> (<span class="r143 r">expressionAst</span> <b>is</b> <a href="../parser/ast.cs.html#bdf2b3276843e0c2" class="t t">ErrorExpressionAst</a> &amp;&amp; <span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>.<span class="i">EndsWith</span>(<span class="s">&#39;,&#39;</span>))
                    {
                        <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <b>string</b>.<span class="i">Empty</span>;
                        <span class="c">// BUGBUG context.CursorPosition = expressionAst.Extent.StartScriptPosition;</span>
                    }
                    <b>else</b> <b>if</b> (<span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span> == 1 || <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> == <b>string</b>.<span class="i">Empty</span>)
                    {
                        <span class="r143 r">expressionAst</span> = <b>null</b>;
                    }
                    <b>else</b> <b>if</b> (<span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span> &gt; 2)
                    {
                        <b>var</b> <span id="r146 rd" class="r146 r">length</span> = <span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span>;
                        <b>var</b> <span id="r147 rd" class="r147 r">index</span> = 1;
 
                        <b>for</b> (; <span class="r147 r">index</span> &lt; <span class="r146 r">length</span>; <span class="r147 r">index</span>++)
                        {
                            <b>if</b> (<span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[<span class="r147 r">index</span>] == <span class="r143 r">expressionAst</span>)
                                <b>break</b>;
                        }
 
                        <a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r148 rd" class="r148 r">secondToLastAst</span> = <b>null</b>;
                        <b>if</b> (<span class="r147 r">index</span> &gt; 1)
                        {
                            <span class="r148 r">secondToLastAst</span> = <span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[<span class="r147 r">index</span> - 1];
                            <span class="r144 r">secondToLastMemberAst</span> = <span class="r148 r">secondToLastAst</span> <b>as</b> <a href="../parser/ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a>;
                        }
 
                        <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r149 rd" class="r149 r">partialPathAst</span> = <span class="r143 r">expressionAst</span> <b>as</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                        <b>if</b> (<span class="r149 r">partialPathAst</span> != <b>null</b> &amp;&amp; <span class="r148 r">secondToLastAst</span> != <b>null</b> &amp;&amp;
                            <span class="r149 r">partialPathAst</span>.<a href="../parser/ast.cs.html#de305f3ed8002148" class="i property">StringConstantType</a> == <a href="../parser/ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="../parser/ast.cs.html#7902d7b060b16556" class="i field">BareWord</a> &amp;&amp;
                            <span class="r148 r">secondToLastAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#ccd649a5269e237d" class="i property">EndLineNumber</a> == <span class="r149 r">partialPathAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a> &amp;&amp;
                            <span class="r148 r">secondToLastAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#155675f601d14734" class="i property">EndColumnNumber</a> == <span class="r149 r">partialPathAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a> &amp;&amp;
                            <span class="r149 r">partialPathAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>.<span class="i">IndexOfAny</span>(<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../Utils.cs.html#182cf4a18b62de18" class="i field">Directory</a>) == 0)
                        {
                            <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r150 rd" class="r150 r">secondToLastStringConstantAst</span> = <span class="r148 r">secondToLastAst</span> <b>as</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                            <a href="../parser/ast.cs.html#dac25e1530bb8b85" class="k">var</a> <span id="r151 rd" class="r151 r">secondToLastExpandableStringAst</span> = <span class="r148 r">secondToLastAst</span> <b>as</b> <a href="../parser/ast.cs.html#dac25e1530bb8b85" class="t t">ExpandableStringExpressionAst</a>;
                            <a href="../parser/ast.cs.html#0e44bc9125134006" class="k">var</a> <span id="r152 rd" class="r152 r">secondToLastArrayAst</span> = <span class="r148 r">secondToLastAst</span> <b>as</b> <a href="../parser/ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>;
                            <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="k">var</a> <span id="r153 rd" class="r153 r">secondToLastParamAst</span> = <span class="r148 r">secondToLastAst</span> <b>as</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>;
 
                            <b>if</b> (<span class="r150 r">secondToLastStringConstantAst</span> != <b>null</b> || <span class="r151 r">secondToLastExpandableStringAst</span> != <b>null</b>)
                            {
                                <b>var</b> <span id="r154 rd" class="r154 r">fullPath</span> = <a href="#4cf5560a7b1499c0" class="i method">ConcatenateStringPathArguments</a>(<span class="r148 r">secondToLastAst</span>, <span class="r149 r">partialPathAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <span class="r140 r">context</span>);
                                <span class="r143 r">expressionAst</span> = <span class="r150 r">secondToLastStringConstantAst</span> != <b>null</b>
                                                    ? (<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>)<span class="r150 r">secondToLastStringConstantAst</span>
                                                    : (<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>)<span class="r151 r">secondToLastExpandableStringAst</span>;
 
                                <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a> = ((<a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a>)<span class="r148 r">secondToLastAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>).<a href="../parser/Position.cs.html#ae983dad2327d7fd" class="i property">Offset</a>;
                                <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#c219030db690057a" class="i property">ReplacementLength</a> += ((<a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a>)<span class="r148 r">secondToLastAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#b8cb5655f70ff8ee" class="i property">EndScriptPosition</a>).<a href="../parser/Position.cs.html#ae983dad2327d7fd" class="i property">Offset</a> - <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a>;
                                <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r154 r">fullPath</span>;
                                <span class="c">// context.CursorPosition = secondToLastAst.Extent.StartScriptPosition;</span>
                            }
                            <b>else</b> <b>if</b> (<span class="r152 r">secondToLastArrayAst</span> != <b>null</b>)
                            {
                                <span class="c">// Handle cases like: dir -Path .\cd, &#39;a b&#39;\new&lt;tab&gt;</span>
                                <b>var</b> <span id="r155 rd" class="r155 r">lastArrayElement</span> = <span class="r152 r">secondToLastArrayAst</span>.<a href="../parser/ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">LastOrDefault</span>();
                                <b>var</b> <span id="r156 rd" class="r156 r">fullPath</span> = <span class="i">ConcatenateStringPathArguments</span>(<span class="r155 r">lastArrayElement</span>, <span class="r149 r">partialPathAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <span class="r140 r">context</span>);
                                <b>if</b> (<span class="r156 r">fullPath</span> != <b>null</b>)
                                {
                                    <span class="r143 r">expressionAst</span> = <span class="r152 r">secondToLastArrayAst</span>;
 
                                    <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a> = ((<a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a>)<span class="r155 r">lastArrayElement</span>.<span class="i">Extent</span>.<span class="i">StartScriptPosition</span>).<a href="../parser/Position.cs.html#ae983dad2327d7fd" class="i property">Offset</a>;
                                    <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#c219030db690057a" class="i property">ReplacementLength</a> += ((<a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a>)<span class="r155 r">lastArrayElement</span>.<span class="i">Extent</span>.<span class="i">EndScriptPosition</span>).<a href="../parser/Position.cs.html#ae983dad2327d7fd" class="i property">Offset</a> - <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a>;
                                    <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r156 r">fullPath</span>;
                                }
                            }
                            <b>else</b> <b>if</b> (<span class="r153 r">secondToLastParamAst</span> != <b>null</b>)
                            {
                                <span class="c">// Handle cases like: dir -Path: .\cd, &#39;a b&#39;\new&lt;tab&gt; || dir -Path: &#39;a b&#39;\new&lt;tab&gt;</span>
                                <b>var</b> <span id="r157 rd" class="r157 r">fullPath</span> = <a href="#4cf5560a7b1499c0" class="i method">ConcatenateStringPathArguments</a>(<span class="r153 r">secondToLastParamAst</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a>, <span class="r149 r">partialPathAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <span class="r140 r">context</span>);
                                <b>if</b> (<span class="r157 r">fullPath</span> != <b>null</b>)
                                {
                                    <span class="r143 r">expressionAst</span> = <span class="r153 r">secondToLastParamAst</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a>;
 
                                    <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a> = ((<a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a>)<span class="r153 r">secondToLastParamAst</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>).<a href="../parser/Position.cs.html#ae983dad2327d7fd" class="i property">Offset</a>;
                                    <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#c219030db690057a" class="i property">ReplacementLength</a> += ((<a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a>)<span class="r153 r">secondToLastParamAst</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#b8cb5655f70ff8ee" class="i property">EndScriptPosition</a>).<a href="../parser/Position.cs.html#ae983dad2327d7fd" class="i property">Offset</a> - <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a>;
                                    <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r157 r">fullPath</span>;
                                }
                                <b>else</b>
                                {
                                    <a href="../parser/ast.cs.html#0e44bc9125134006" class="k">var</a> <span id="r158 rd" class="r158 r">arrayArgAst</span> = <span class="r153 r">secondToLastParamAst</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a> <b>as</b> <a href="../parser/ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>;
                                    <b>if</b> (<span class="r158 r">arrayArgAst</span> != <b>null</b>)
                                    {
                                        <b>var</b> <span id="r159 rd" class="r159 r">lastArrayElement</span> = <span class="r158 r">arrayArgAst</span>.<a href="../parser/ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">LastOrDefault</span>();
                                        <span class="r157 r">fullPath</span> = <span class="i">ConcatenateStringPathArguments</span>(<span class="r159 r">lastArrayElement</span>, <span class="r149 r">partialPathAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <span class="r140 r">context</span>);
                                        <b>if</b> (<span class="r157 r">fullPath</span> != <b>null</b>)
                                        {
                                            <span class="r143 r">expressionAst</span> = <span class="r158 r">arrayArgAst</span>;
 
                                            <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a> = ((<a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a>)<span class="r159 r">lastArrayElement</span>.<span class="i">Extent</span>.<span class="i">StartScriptPosition</span>).<a href="../parser/Position.cs.html#ae983dad2327d7fd" class="i property">Offset</a>;
                                            <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#c219030db690057a" class="i property">ReplacementLength</a> += ((<a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a>)<span class="r159 r">lastArrayElement</span>.<span class="i">Extent</span>.<span class="i">EndScriptPosition</span>).<a href="../parser/Position.cs.html#ae983dad2327d7fd" class="i property">Offset</a> - <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a>;
                                            <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r157 r">fullPath</span>;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                <b>else</b> <b>if</b> (<span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="../parser/ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a> &amp;&amp; <span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>)
                {
                    <span class="r141 r">commandAst</span> = (<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>)<span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
 
                    <b>if</b> (<span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span> == 1 || <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> == <b>string</b>.<span class="i">Empty</span>)
                    {
                        <span class="c">// dir -Path a.txt, b.txt &lt;tab&gt;</span>
                        <span class="r143 r">expressionAst</span> = <b>null</b>;
                    }
                    <b>else</b>
                    {
                        <span class="c">// dir -Path a.txt, b.txt c&lt;tab&gt;</span>
                        <span class="r143 r">expressionAst</span> = (<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>)<span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                    }
                }
                <b>else</b> <b>if</b> (<span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="../parser/ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a> &amp;&amp; <span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>)
                {
                    <span class="c">// Handle scenarios such as</span>
                    <span class="c">//      dir -Path: a.txt, &lt;tab&gt; || dir -Path: a.txt, b.txt &lt;tab&gt;</span>
                    <span class="r141 r">commandAst</span> = (<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>)<span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                    <b>if</b> (<span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> == <b>string</b>.<span class="i">Empty</span>)
                    {
                        <span class="c">// dir -Path: a.txt, b.txt &lt;tab&gt;</span>
                        <span class="r143 r">expressionAst</span> = <b>null</b>;
                    }
                    <b>else</b>
                    {
                        <span class="c">// dir -Path: a.txt, b&lt;tab&gt;</span>
                        <span class="r143 r">expressionAst</span> = (<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>)<span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                    }
                }
                <b>else</b> <b>if</b> (<span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> &amp;&amp; <span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>)
                {
                    <span class="r141 r">commandAst</span> = (<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>)<span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                    <b>if</b> (<span class="r143 r">expressionAst</span> <b>is</b> <a href="../parser/ast.cs.html#bdf2b3276843e0c2" class="t t">ErrorExpressionAst</a> &amp;&amp; <span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>.<span class="i">EndsWith</span>(<span class="s">&#39;,&#39;</span>))
                    {
                        <span class="c">// dir -Path: a.txt,&lt;tab&gt;</span>
                        <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <b>string</b>.<span class="i">Empty</span>;
                        <span class="c">// context.CursorPosition = expressionAst.Extent.StartScriptPosition;</span>
                    }
                    <b>else</b> <b>if</b> (<span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> == <b>string</b>.<span class="i">Empty</span>)
                    {
                        <span class="c">// Handle scenario like this: Set-ExecutionPolicy -Scope:CurrentUser &lt;tab&gt;</span>
                        <span class="r143 r">expressionAst</span> = <b>null</b>;
                    }
                }
            }
            <b>else</b>
            {
                <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="k">var</a> <span id="r160 rd" class="r160 r">paramAst</span> = <span class="r145 r">lastAst</span> <b>as</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>;
                <b>if</b> (<span class="r160 r">paramAst</span> != <b>null</b>)
                {
                    <span class="r141 r">commandAst</span> = <span class="r160 r">paramAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>;
                }
                <b>else</b>
                {
                    <span class="r141 r">commandAst</span> = <span class="r145 r">lastAst</span> <b>as</b> <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>;
                }
            }
 
            <b>if</b> (<span class="r141 r">commandAst</span> == <b>null</b>)
            {
                <span class="c">// We don&#39;t know if this could be expanded into anything interesting</span>
                <b>return</b> <span class="r142 r">result</span>;
            }
 
            <a href="PseudoParameterBinder.cs.html#5ac9244be24c2bbd" class="t t">PseudoBindingInfo</a> <span id="r161 rd" class="r161 r">pseudoBinding</span> = <b>new</b> <span class="t">PseudoParameterBinder</span>()
                                                .<a href="PseudoParameterBinder.cs.html#4f331f824f2a1e35" class="i method">DoPseudoParameterBinding</a>(<span class="r141 r">commandAst</span>, <b>null</b>, <b>null</b>, <a href="PseudoParameterBinder.cs.html#9dc50bf5ddf87930" class="t t">PseudoParameterBinder</a>.<a href="PseudoParameterBinder.cs.html#ad6e81c17c696e75" class="t t">BindingType</a>.<a href="PseudoParameterBinder.cs.html#240740e6b3591d03" class="i field">ArgumentCompletion</a>);
 
            <b>do</b>
            {
                <span class="c">// The command cannot be found, or it&#39;s NOT a cmdlet, NOT a script cmdlet and NOT a function</span>
                <b>if</b> (<span class="r161 r">pseudoBinding</span> == <b>null</b>)
                    <b>break</b>;
 
                <b>bool</b> <span id="r162 rd" class="r162 r">parsedArgumentsProvidesMatch</span> = <b>false</b>;
 
                <b>if</b> (<span class="r161 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#e625bf306f80f711" class="i property">AllParsedArguments</a> != <b>null</b> &amp;&amp; <span class="r161 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#e625bf306f80f711" class="i property">AllParsedArguments</a>.<span class="i">Count</span> &gt; 0)
                {
                    <a href="#522c290efaf3eb7d" class="t t">ArgumentLocation</a> <span id="r163 rd" class="r163 r">argLocation</span>;
                    <b>bool</b> <span id="r164 rd" class="r164 r">treatAsExpression</span> = <b>false</b>;
 
                    <b>if</b> (<span class="r143 r">expressionAst</span> != <b>null</b>)
                    {
                        <span class="r164 r">treatAsExpression</span> = <b>true</b>;
                        <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r165 rd" class="r165 r">dashExp</span> = <span class="r143 r">expressionAst</span> <b>as</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                        <b>if</b> (<span class="r165 r">dashExp</span> != <b>null</b> &amp;&amp; <span class="r165 r">dashExp</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>.<span class="i">Trim</span>().<span class="i">Equals</span>(<span class="s">&quot;-&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="c">// &quot;-&quot; is represented as StringConstantExpressionAst. Most likely the user is typing a &lt;tab&gt;</span>
                            <span class="c">// after it, so in the pseudo binder, we ignore it to avoid treating it as an argument.</span>
                            <span class="c">// for example:</span>
                            <span class="c">//      Get-Content -Path &quot;-&lt;tab&gt;  --&gt;  Get-Content -Path &quot;.\-patt.txt&quot;</span>
                            <span class="r164 r">treatAsExpression</span> = <b>false</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r164 r">treatAsExpression</span>)
                    {
                        <span class="r163 r">argLocation</span> = <a href="#e25a2913dc84acab" class="i method">FindTargetArgumentLocation</a>(
                            <span class="r161 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#e625bf306f80f711" class="i property">AllParsedArguments</a>, <span class="r143 r">expressionAst</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r163 r">argLocation</span> = <a href="#d19ff4b66c1ea4ed" class="i method">FindTargetArgumentLocation</a>(
                            <span class="r161 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#e625bf306f80f711" class="i property">AllParsedArguments</a>, <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a> ?? <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#13e001aeea27aaa6" class="i property">TokenBeforeCursor</a>);
                    }
 
                    <b>if</b> (<span class="r163 r">argLocation</span> != <b>null</b>)
                    {
                        <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#aa0594eac663bfde" class="i property">PseudoBindingInfo</a> = <span class="r161 r">pseudoBinding</span>;
                        <b>switch</b> (<span class="r161 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#be318ae0c4315a2a" class="i property">InfoType</a>)
                        {
                            <b>case</b> <a href="PseudoParameterBinder.cs.html#32dafa2abbeb3f2b" class="t t">PseudoBindingInfoType</a>.<a href="PseudoParameterBinder.cs.html#fac4de227da7e29b" class="i field">PseudoBindingSucceed</a>:
                                <span class="r142 r">result</span> = <a href="#03bb7607e3241b3d" class="i method">GetArgumentCompletionResultsWithSuccessfulPseudoBinding</a>(<span class="r140 r">context</span>, <span class="r163 r">argLocation</span>, <span class="r141 r">commandAst</span>);
                                <b>break</b>;
                            <b>case</b> <a href="PseudoParameterBinder.cs.html#32dafa2abbeb3f2b" class="t t">PseudoBindingInfoType</a>.<a href="PseudoParameterBinder.cs.html#dde67aa5a8134b0c" class="i field">PseudoBindingFail</a>:
                                <span class="r142 r">result</span> = <a href="#b930671f794ebf86" class="i method">GetArgumentCompletionResultsWithFailedPseudoBinding</a>(<span class="r140 r">context</span>, <span class="r163 r">argLocation</span>, <span class="r141 r">commandAst</span>);
                                <b>break</b>;
                        }
 
                        <span class="r162 r">parsedArgumentsProvidesMatch</span> = <b>true</b>;
                    }
                }
 
                <b>if</b> (!<span class="r162 r">parsedArgumentsProvidesMatch</span>)
                {
                    <b>int</b> <span id="r166 rd" class="r166 r">index</span> = 0;
                    <a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r167 rd" class="r167 r">prevElem</span> = <b>null</b>;
                    <b>if</b> (<span class="r143 r">expressionAst</span> != <b>null</b>)
                    {
                        <b>foreach</b> (<a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r168 rd" class="r168 r">eleAst</span> <b>in</b> <span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>)
                        {
                            <b>if</b> (<span class="r168 r">eleAst</span>.<span class="i">GetHashCode</span>() == <span class="r143 r">expressionAst</span>.<span class="i">GetHashCode</span>())
                                <b>break</b>;
                            <span class="r167 r">prevElem</span> = <span class="r168 r">eleAst</span>;
                            <span class="r166 r">index</span>++;
                        }
                    }
                    <b>else</b>
                    {
                        <a href="../parser/token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r169 rd" class="r169 r">token</span> = <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a> ?? <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#13e001aeea27aaa6" class="i property">TokenBeforeCursor</a>;
                        <b>foreach</b> (<a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r170 rd" class="r170 r">eleAst</span> <b>in</b> <span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>)
                        {
                            <b>if</b> (<span class="r170 r">eleAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> &gt; <span class="r169 r">token</span>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a>)
                                <b>break</b>;
                            <span class="r167 r">prevElem</span> = <span class="r170 r">eleAst</span>;
                            <span class="r166 r">index</span>++;
                        }
                    }
 
                    <span class="c">// positional argument with position 0</span>
                    <b>if</b> (<span class="r166 r">index</span> == 1)
                    {
                        <span class="i">CompletePositionalArgument</span>(
                            <span class="r161 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#8a99b7a836aade94" class="i property">CommandName</a>,
                            <span class="r141 r">commandAst</span>,
                            <span class="r140 r">context</span>,
                            <span class="r142 r">result</span>,
                            <span class="r161 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#a765b55f276ef803" class="i property">UnboundParameters</a>,
                            <span class="r161 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#b621e7fcaed07b69" class="i property">DefaultParameterSetFlag</a>,
                            <b>uint</b>.<span class="i">MaxValue</span>,
                            0);
                    }
                    <b>else</b>
                    {
                        <b>if</b> (<span class="r167 r">prevElem</span> <b>is</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> &amp;&amp; ((<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>)<span class="r167 r">prevElem</span>).<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a> == <b>null</b>)
                        {
                            <b>var</b> <span id="r171 rd" class="r171 r">paramName</span> = ((<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>)<span class="r167 r">prevElem</span>).<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
                            <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r172 rd" class="r172 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r171 r">paramName</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                            <b>foreach</b> (<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r173 rd" class="r173 r">param</span> <b>in</b> <span class="r161 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#a765b55f276ef803" class="i property">UnboundParameters</a>)
                            {
                                <b>if</b> (<span class="r172 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r173 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                                {
                                    <a href="#2abc5ab9613b3baa" class="i method">ProcessParameter</a>(<span class="r161 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#8a99b7a836aade94" class="i property">CommandName</a>, <span class="r141 r">commandAst</span>, <span class="r140 r">context</span>, <span class="r142 r">result</span>, <span class="r173 r">param</span>);
                                    <b>break</b>;
                                }
 
                                <b>var</b> <span id="r174 rd" class="r174 r">isAliasMatch</span> = <b>false</b>;
                                <b>foreach</b> (<b>string</b> <span id="r175 rd" class="r175 r">alias</span> <b>in</b> <span class="r173 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#029c8e124435d0fd" class="i property">Aliases</a>)
                                {
                                    <b>if</b> (<span class="r172 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r175 r">alias</span>))
                                    {
                                        <span class="r174 r">isAliasMatch</span> = <b>true</b>;
                                        <a href="#2abc5ab9613b3baa" class="i method">ProcessParameter</a>(<span class="r161 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#8a99b7a836aade94" class="i property">CommandName</a>, <span class="r141 r">commandAst</span>, <span class="r140 r">context</span>, <span class="r142 r">result</span>, <span class="r173 r">param</span>);
                                        <b>break</b>;
                                    }
                                }
 
                                <b>if</b> (<span class="r174 r">isAliasMatch</span>)
                                    <b>break</b>;
                            }
                        }
                    }
                }
            } <b>while</b> (<b>false</b>);
 
            <span class="c">// Indicate if the current argument completion falls into those pre-defined cases and</span>
            <span class="c">// has been processed already.</span>
            <b>bool</b> <span id="r176 rd" class="r176 r">hasBeenProcessed</span> = <b>false</b>;
            <b>if</b> (<span class="r142 r">result</span>.<span class="i">Count</span> &gt; 0 &amp;&amp; <span class="r142 r">result</span>[<span class="r142 r">result</span>.<span class="i">Count</span> - 1].<span class="i">Equals</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>))
            {
                <span class="r142 r">result</span>.<span class="i">RemoveAt</span>(<span class="r142 r">result</span>.<span class="i">Count</span> - 1);
                <span class="r176 r">hasBeenProcessed</span> = <b>true</b>;
 
                <b>if</b> (<span class="r142 r">result</span>.<span class="i">Count</span> &gt; 0)
                    <b>return</b> <span class="r142 r">result</span>;
            }
 
            <span class="c">// Handle some special cases such as:</span>
            <span class="c">//    &amp; &quot;get-comm&lt;tab&gt; --&gt; &amp; &quot;Get-Command&quot;</span>
            <span class="c">//    &amp; &quot;sa&lt;tab&gt;       --&gt; &amp; &quot;.\sa[v].txt&quot;</span>
            <b>if</b> (<span class="r143 r">expressionAst</span> == <b>null</b> &amp;&amp; !<span class="r176 r">hasBeenProcessed</span> &amp;&amp;
                <span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span> == 1 &amp;&amp;
                <span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#16e18484040f8b6f" class="i property">InvocationOperator</a> != <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a> &amp;&amp;
                <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> != <b>string</b>.<span class="i">Empty</span>)
            {
                <span class="c">// Use literal path after Ampersand</span>
                <b>var</b> <span id="r177 rd" class="r177 r">tryCmdletCompletion</span> = <b>false</b>;
                <b>var</b> <span id="r178 rd" class="r178 r">clearLiteralPathsKey</span> = <a href="#2bbbf54fb571efb5" class="i method">TurnOnLiteralPathOption</a>(<span class="r140 r">context</span>);
 
                <b>if</b> (<span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>.<span class="i">Contains</span>(<span class="s">&#39;-&#39;</span>))
                {
                    <span class="r177 r">tryCmdletCompletion</span> = <b>true</b>;
                }
 
                <b>try</b>
                {
                    <b>var</b> <span id="r179 rd" class="r179 r">fileCompletionResults</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;(<a href="#729d5ec1cd6162b7" class="i method">CompleteFilename</a>(<span class="r140 r">context</span>));
                    <b>if</b> (<span class="r177 r">tryCmdletCompletion</span>)
                    {
                        <span class="c">// It&#39;s actually command name completion, other than argument completion</span>
                        <b>var</b> <span id="r180 rd" class="r180 r">cmdletCompletionResults</span> = <a href="#8ad3630ff3ff385a" class="i method">CompleteCommand</a>(<span class="r140 r">context</span>);
                        <b>if</b> (<span class="r180 r">cmdletCompletionResults</span> != <b>null</b> &amp;&amp; <span class="r180 r">cmdletCompletionResults</span>.<span class="i">Count</span> &gt; 0)
                        {
                            <span class="r179 r">fileCompletionResults</span>.<span class="i">AddRange</span>(<span class="r180 r">cmdletCompletionResults</span>);
                        }
                    }
 
                    <b>return</b> <span class="r179 r">fileCompletionResults</span>;
                }
                <b>finally</b>
                {
                    <b>if</b> (<span class="r178 r">clearLiteralPathsKey</span>)
                        <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#f3f4d193708c896f" class="i property">Options</a>.<span class="i">Remove</span>(<span class="s">&quot;LiteralPaths&quot;</span>);
                }
            }
 
            <b>if</b> (<span class="r143 r">expressionAst</span> <b>is</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)
            {
                <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r181 rd" class="r181 r">pathAst</span> = (<a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)<span class="r143 r">expressionAst</span>;
                <span class="c">// Handle static member completion: echo [int]::&lt;tab&gt;</span>
                <b>var</b> <span id="r182 rd" class="r182 r">shareMatch</span> = <span class="i">Regex</span>.<span class="i">Match</span>(<span class="r181 r">pathAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <span class="s">@&quot;^(\[[\w\d\.]+\]::[\w\d\*]*)$&quot;</span>);
                <b>if</b> (<span class="r182 r">shareMatch</span>.<span class="i">Success</span>)
                {
                    <b>int</b> <span id="r183 rd" class="r183 r">fakeReplacementIndex</span>, <span id="r184 rd" class="r184 r">fakeReplacementLength</span>;
                    <b>var</b> <span id="r185 rd" class="r185 r">input</span> = <span class="r182 r">shareMatch</span>.<span class="i">Groups</span>[1].<span class="i">Value</span>;
                    <b>var</b> <span id="r186 rd" class="r186 r">completionParameters</span> = <a href="CommandCompletion.cs.html#a9d35cade4030f50" class="t t">CommandCompletion</a>.<span class="i">MapStringInputToParsedInput</span>(<span class="r185 r">input</span>, <span class="r185 r">input</span>.<span class="i">Length</span>);
                    <a href="CompletionAnalysis.cs.html#978ec9faf3baf106" class="k">var</a> <span id="r187 rd" class="r187 r">completionAnalysis</span> = <b>new</b> <span class="t">CompletionAnalysis</span>(<span class="r186 r">completionParameters</span>.<span class="i">Item1</span>, <span class="r186 r">completionParameters</span>.<span class="i">Item2</span>, <span class="r186 r">completionParameters</span>.<span class="i">Item3</span>, <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#f3f4d193708c896f" class="i property">Options</a>);
                    <b>var</b> <span id="r188 rd" class="r188 r">ret</span> = <span class="r187 r">completionAnalysis</span>.<a href="CompletionAnalysis.cs.html#5cf3c5e39f65b543" class="i method">GetResults</a>(
                        <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ddb7ad1950c8ea20" class="i property">CurrentPowerShell</a>,
                        <b>out</b> <span class="r183 r">fakeReplacementIndex</span>,
                        <b>out</b> <span class="r184 r">fakeReplacementLength</span>);
 
                    <b>if</b> (<span class="r188 r">ret</span> != <b>null</b> &amp;&amp; <span class="r188 r">ret</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <b>string</b> <span id="r189 rd" class="r189 r">prefix</span> = <b>string</b>.<span class="i">Concat</span>(<a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>.<a href="../parser/token.cs.html#7fc630435d0dbb33" class="i method">Text</a>(), <span class="r185 r">input</span>.<span class="i">AsSpan</span>(0, <span class="r183 r">fakeReplacementIndex</span>));
                        <b>foreach</b> (<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <span id="r190 rd" class="r190 r">entry</span> <b>in</b> <span class="r188 r">ret</span>)
                        {
                            <b>string</b> <span id="r191 rd" class="r191 r">completionText</span> = <span class="r189 r">prefix</span> + <span class="r190 r">entry</span>.<a href="CompletionResult.cs.html#536dd0f937b80f9b" class="i property">CompletionText</a>;
                            <b>if</b> (<span class="r190 r">entry</span>.<a href="CompletionResult.cs.html#d35199370d0a5658" class="i property">ResultType</a>.<span class="i">Equals</span>(<a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#bad7fb67c06b9e4e" class="i field">Property</a>))
                                <span class="r191 r">completionText</span> += <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#33afcffc839d1905" class="i field">RParen</a>.<a href="../parser/token.cs.html#7fc630435d0dbb33" class="i method">Text</a>();
                            <span class="r142 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r191 r">completionText</span>, <span class="r190 r">entry</span>.<a href="CompletionResult.cs.html#e734fe4987da07ab" class="i property">ListItemText</a>, <span class="r190 r">entry</span>.<a href="CompletionResult.cs.html#d35199370d0a5658" class="i property">ResultType</a>,
                                                            <span class="r190 r">entry</span>.<a href="CompletionResult.cs.html#34a44c8b3b89530a" class="i property">ToolTip</a>));
                        }
 
                        <b>return</b> <span class="r142 r">result</span>;
                    }
                }
 
                <span class="c">// Handle member completion with wildcard: echo $a.*&lt;tab&gt;</span>
                <b>if</b> (<span class="r181 r">pathAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>.<span class="i">Contains</span>(<span class="s">&#39;*&#39;</span>) &amp;&amp; <span class="r144 r">secondToLastMemberAst</span> != <b>null</b> &amp;&amp;
                    <span class="r144 r">secondToLastMemberAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#ccd649a5269e237d" class="i property">EndLineNumber</a> == <span class="r181 r">pathAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a> &amp;&amp;
                    <span class="r144 r">secondToLastMemberAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#155675f601d14734" class="i property">EndColumnNumber</a> == <span class="r181 r">pathAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>)
                {
                    <b>var</b> <span id="r192 rd" class="r192 r">memberName</span> = <span class="r181 r">pathAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>.<span class="i">EndsWith</span>(<span class="s">&#39;*&#39;</span>)
                                         ? <span class="r181 r">pathAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>
                                         : <span class="r181 r">pathAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a> + <span class="s">&quot;*&quot;</span>;
                    <a href="../parser/ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r193 rd" class="r193 r">targetExpr</span> = <span class="r144 r">secondToLastMemberAst</span>.<a href="../parser/ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>;
                    <b>if</b> (<a href="#0b590d9a87f772b1" class="i method">IsSplattedVariable</a>(<span class="r193 r">targetExpr</span>))
                    {
                        <span class="c">// It&#39;s splatted variable, and the member completion is not useful</span>
                        <b>return</b> <span class="r142 r">result</span>;
                    }
 
                    <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r194 rd" class="r194 r">memberAst</span> = <span class="r144 r">secondToLastMemberAst</span>.<a href="../parser/ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a> <b>as</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                    <b>if</b> (<span class="r194 r">memberAst</span> != <b>null</b>)
                    {
                        <span class="r192 r">memberName</span> = <span class="r194 r">memberAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a> + <span class="r192 r">memberName</span>;
                    }
 
                    <a href="#f848645913a53ddb" class="i method">CompleteMemberHelper</a>(<b>false</b>, <span class="r192 r">memberName</span>, <span class="r193 r">targetExpr</span>, <span class="r140 r">context</span>, <span class="r142 r">result</span>);
                    <b>if</b> (<span class="r142 r">result</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a> =
                            ((<a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a>)<span class="r144 r">secondToLastMemberAst</span>.<a href="../parser/ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#b8cb5655f70ff8ee" class="i property">EndScriptPosition</a>).<a href="../parser/Position.cs.html#ae983dad2327d7fd" class="i property">Offset</a> + 1;
                        <b>if</b> (<span class="r194 r">memberAst</span> != <b>null</b>)
                            <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#c219030db690057a" class="i property">ReplacementLength</a> += <span class="r194 r">memberAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>.<span class="i">Length</span>;
                        <b>return</b> <span class="r142 r">result</span>;
                    }
                }
 
                <span class="c">// Treat it as the file name completion</span>
                <span class="c">// Handle this scenario: &amp; &#39;c:\a b&#39;\&lt;tab&gt;</span>
                <b>string</b> <span id="r195 rd" class="r195 r">fileName</span> = <span class="r181 r">pathAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>;
                <b>if</b> (<span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#16e18484040f8b6f" class="i property">InvocationOperator</a> != <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a> &amp;&amp; <span class="r195 r">fileName</span>.<span class="i">IndexOfAny</span>(<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../Utils.cs.html#182cf4a18b62de18" class="i field">Directory</a>) == 0 &amp;&amp;
                    <span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span> == 2 &amp;&amp; <span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[0] <b>is</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> &amp;&amp;
                    <span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[0].<span class="i">Extent</span>.<span class="i">EndLineNumber</span> == <span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a> &amp;&amp;
                    <span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[0].<span class="i">Extent</span>.<span class="i">EndColumnNumber</span> == <span class="r143 r">expressionAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>)
                {
                    <b>if</b> (<span class="r161 r">pseudoBinding</span> != <b>null</b>)
                    {
                        <span class="c">// CommandElements[0] is resolved to a command</span>
                        <b>return</b> <span class="r142 r">result</span>;
                    }
                    <b>else</b>
                    {
                        <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r196 rd" class="r196 r">constantAst</span> = (<a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)<span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[0];
                        <span class="r195 r">fileName</span> = <span class="r196 r">constantAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a> + <span class="r195 r">fileName</span>;
                        <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a> = ((<a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a>)<span class="r196 r">constantAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>).<a href="../parser/Position.cs.html#ae983dad2327d7fd" class="i property">Offset</a>;
                        <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#c219030db690057a" class="i property">ReplacementLength</a> += ((<a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a>)<span class="r196 r">constantAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#b8cb5655f70ff8ee" class="i property">EndScriptPosition</a>).<a href="../parser/Position.cs.html#ae983dad2327d7fd" class="i property">Offset</a> - <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a>;
                        <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r195 r">fileName</span>;
                        <span class="c">// commandAst.InvocationOperator != TokenKind.Unknown, so we should use literal path</span>
                        <b>var</b> <span id="r197 rd" class="r197 r">clearLiteralPathKey</span> = <a href="#2bbbf54fb571efb5" class="i method">TurnOnLiteralPathOption</a>(<span class="r140 r">context</span>);
 
                        <b>try</b>
                        {
                            <b>return</b> <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;(<a href="#729d5ec1cd6162b7" class="i method">CompleteFilename</a>(<span class="r140 r">context</span>));
                        }
                        <b>finally</b>
                        {
                            <b>if</b> (<span class="r197 r">clearLiteralPathKey</span>)
                                <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#f3f4d193708c896f" class="i property">Options</a>.<span class="i">Remove</span>(<span class="s">&quot;LiteralPaths&quot;</span>);
                        }
                    }
                }
            }
 
            <span class="c">// The default argument completion: file path completion, command name completion(&#39;WordToComplete&#39; is not empty and contains a dash).</span>
            <span class="c">// If the current argument completion has been process already, we don&#39;t go through the default argument completion anymore.</span>
            <b>if</b> (!<span class="r176 r">hasBeenProcessed</span>)
            {
                <b>var</b> <span id="r198 rd" class="r198 r">commandName</span> = <span class="r141 r">commandAst</span>.<a href="../parser/ast.cs.html#14cec84b5558d5c6" class="i method">GetCommandName</a>();
                <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="k">var</a> <span id="r199 rd" class="r199 r">customCompleter</span> = <span class="i">GetCustomArgumentCompleter</span>(
                    <span class="s">&quot;NativeArgumentCompleters&quot;</span>,
                    <b>new</b>[] { <span class="r198 r">commandName</span>, <span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="r198 r">commandName</span>), <span class="i">Path</span>.<span class="i">GetFileNameWithoutExtension</span>(<span class="r198 r">commandName</span>) },
                    <span class="r140 r">context</span>);
                <b>if</b> (<span class="r199 r">customCompleter</span> != <b>null</b>)
                {
                    <b>if</b> (<a href="#c75827f28cced0ec" class="i method">InvokeScriptArgumentCompleter</a>(
                        <span class="r199 r">customCompleter</span>,
                        <b>new</b> <b>object</b>[] { <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>, <span class="r141 r">commandAst</span>, <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>.<a href="../parser/Position.cs.html#cd3280d5f1045b06" class="i property">Offset</a> },
                        <span class="r142 r">result</span>))
                    {
                        <b>return</b> <span class="r142 r">result</span>;
                    }
                }
 
                <b>var</b> <span id="r200 rd" class="r200 r">clearLiteralPathKey</span> = <b>false</b>;
                <b>if</b> (<span class="r161 r">pseudoBinding</span> == <b>null</b>)
                {
                    <span class="c">// the command could be a native command such as notepad.exe, we use literal path in this case</span>
                    <span class="r200 r">clearLiteralPathKey</span> = <a href="#2bbbf54fb571efb5" class="i method">TurnOnLiteralPathOption</a>(<span class="r140 r">context</span>);
                }
 
                <b>try</b>
                {
                    <span class="r142 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;(<a href="#729d5ec1cd6162b7" class="i method">CompleteFilename</a>(<span class="r140 r">context</span>));
                }
                <b>finally</b>
                {
                    <b>if</b> (<span class="r200 r">clearLiteralPathKey</span>)
                        <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#f3f4d193708c896f" class="i property">Options</a>.<span class="i">Remove</span>(<span class="s">&quot;LiteralPaths&quot;</span>);
                }
 
                <b>if</b> (<span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> != <b>string</b>.<span class="i">Empty</span> &amp;&amp; <span class="r140 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>.<span class="i">Contains</span>(<span class="s">&#39;-&#39;</span>))
                {
                    <b>var</b> <span id="r201 rd" class="r201 r">commandResults</span> = <a href="#8ad3630ff3ff385a" class="i method">CompleteCommand</a>(<span class="r140 r">context</span>);
                    <b>if</b> (<span class="r201 r">commandResults</span> != <b>null</b>)
                        <span class="r142 r">result</span>.<span class="i">AddRange</span>(<span class="r201 r">commandResults</span>);
                }
            }
 
            <b>return</b> <span class="r142 r">result</span>;
        }
 
        <b>internal static string</b> <a id="4cf5560a7b1499c0" href="../../R/4cf5560a7b1499c0.html" target="n" data-glyph="74,1" class="i method">ConcatenateStringPathArguments</a>(<a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r202 rd" class="r202 r">stringAst</span>, <b>string</b> <span id="r203 rd" class="r203 r">partialPath</span>, <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r204 rd" class="r204 r">completionContext</span>)
        {
            <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r205 rd" class="r205 r">constantPathAst</span> = <span class="r202 r">stringAst</span> <b>as</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
            <b>if</b> (<span class="r205 r">constantPathAst</span> != <b>null</b>)
            {
                <b>string</b> <span id="r206 rd" class="r206 r">quote</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>switch</b> (<span class="r205 r">constantPathAst</span>.<a href="../parser/ast.cs.html#de305f3ed8002148" class="i property">StringConstantType</a>)
                {
                    <b>case</b> <a href="../parser/ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="../parser/ast.cs.html#9cd69ce5e01bdb24" class="i field">SingleQuoted</a>:
                        <span class="r206 r">quote</span> = <span class="s">&quot;&#39;&quot;</span>;
                        <b>break</b>;
                    <b>case</b> <a href="../parser/ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="../parser/ast.cs.html#f67f871ab7fadb8a" class="i field">DoubleQuoted</a>:
                        <span class="r206 r">quote</span> = <span class="s">&quot;\&quot;&quot;</span>;
                        <b>break</b>;
                    <b>default</b>:
                        <b>break</b>;
                }
 
                <b>return</b> <span class="r206 r">quote</span> + <span class="r205 r">constantPathAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a> + <span class="r203 r">partialPath</span> + <span class="r206 r">quote</span>;
            }
            <b>else</b>
            {
                <a href="../parser/ast.cs.html#dac25e1530bb8b85" class="k">var</a> <span id="r207 rd" class="r207 r">expandablePathAst</span> = <span class="r202 r">stringAst</span> <b>as</b> <a href="../parser/ast.cs.html#dac25e1530bb8b85" class="t t">ExpandableStringExpressionAst</a>;
                <b>string</b> <span id="r208 rd" class="r208 r">fullPath</span> = <b>null</b>;
                <b>if</b> (<span class="r207 r">expandablePathAst</span> != <b>null</b> &amp;&amp;
                    <a href="#43cc4ec4c59478b8" class="i method">IsPathSafelyExpandable</a>(<span class="r209 r">expandableStringAst</span>: <span class="r207 r">expandablePathAst</span>,
                                           <span class="r210 r">extraText</span>: <span class="r203 r">partialPath</span>,
                                           <span class="r211 r">executionContext</span>: <span class="r204 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#4055c622a2008ac8" class="i property">ExecutionContext</a>,
                                           <span class="r212 r">expandedString</span>: <b>out</b> <span class="r208 r">fullPath</span>))
                {
                    <b>return</b> <span class="r208 r">fullPath</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the argument completion results when the pseudo binding was not successful.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="b930671f794ebf86" href="../../R/b930671f794ebf86.html" target="n" data-glyph="76,1" class="i method">GetArgumentCompletionResultsWithFailedPseudoBinding</a>(
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r213 rd" class="r213 r">context</span>,
            <a href="#522c290efaf3eb7d" class="t t">ArgumentLocation</a> <span id="r214 rd" class="r214 r">argLocation</span>,
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r215 rd" class="r215 r">commandAst</span>)
        {
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r216 rd" class="r216 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
 
            <a href="PseudoParameterBinder.cs.html#5ac9244be24c2bbd" class="t t">PseudoBindingInfo</a> <span id="r217 rd" class="r217 r">bindingInfo</span> = <span class="r213 r">context</span>.<a href="CompletionAnalysis.cs.html#aa0594eac663bfde" class="i property">PseudoBindingInfo</a>;
            <b>if</b> (<span class="r214 r">argLocation</span>.<a href="#3091dd81c57d0646" class="i property">IsPositional</a>)
            {
                <span class="i">CompletePositionalArgument</span>(
                    <span class="r217 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#8a99b7a836aade94" class="i property">CommandName</a>,
                    <span class="r215 r">commandAst</span>,
                    <span class="r213 r">context</span>,
                    <span class="r216 r">result</span>,
                    <span class="r217 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#a765b55f276ef803" class="i property">UnboundParameters</a>,
                    <span class="r217 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#b621e7fcaed07b69" class="i property">DefaultParameterSetFlag</a>,
                    <b>uint</b>.<span class="i">MaxValue</span>,
                    <span class="r214 r">argLocation</span>.<a href="#33135be11a585538" class="i property">Position</a>);
            }
            <b>else</b>
            {
                <b>string</b> <span id="r218 rd" class="r218 r">paramName</span> = <span class="r214 r">argLocation</span>.<a href="#245629496e4946e2" class="i property">Argument</a>.<a href="PseudoParameterBinder.cs.html#3f07007c27aa3c29" class="i property">ParameterName</a>;
                <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r219 rd" class="r219 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r218 r">paramName</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                <b>foreach</b> (<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r220 rd" class="r220 r">param</span> <b>in</b> <span class="r217 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#a765b55f276ef803" class="i property">UnboundParameters</a>)
                {
                    <b>if</b> (<span class="r219 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r220 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                    {
                        <a href="#2abc5ab9613b3baa" class="i method">ProcessParameter</a>(<span class="r217 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#8a99b7a836aade94" class="i property">CommandName</a>, <span class="r215 r">commandAst</span>, <span class="r213 r">context</span>, <span class="r216 r">result</span>, <span class="r220 r">param</span>);
                        <b>break</b>;
                    }
 
                    <b>bool</b> <span id="r221 rd" class="r221 r">isAliasMatch</span> = <b>false</b>;
                    <b>foreach</b> (<b>string</b> <span id="r222 rd" class="r222 r">alias</span> <b>in</b> <span class="r220 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#029c8e124435d0fd" class="i property">Aliases</a>)
                    {
                        <b>if</b> (<span class="r219 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r222 r">alias</span>))
                        {
                            <span class="r221 r">isAliasMatch</span> = <b>true</b>;
                            <a href="#2abc5ab9613b3baa" class="i method">ProcessParameter</a>(<span class="r217 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#8a99b7a836aade94" class="i property">CommandName</a>, <span class="r215 r">commandAst</span>, <span class="r213 r">context</span>, <span class="r216 r">result</span>, <span class="r220 r">param</span>);
                            <b>break</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r221 r">isAliasMatch</span>)
                        <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r216 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the argument completion results when the pseudo binding was successful.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="03bb7607e3241b3d" href="../../R/03bb7607e3241b3d.html" target="n" data-glyph="76,1" class="i method">GetArgumentCompletionResultsWithSuccessfulPseudoBinding</a>(
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r223 rd" class="r223 r">context</span>,
            <a href="#522c290efaf3eb7d" class="t t">ArgumentLocation</a> <span id="r224 rd" class="r224 r">argLocation</span>,
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r225 rd" class="r225 r">commandAst</span>)
        {
            <a href="PseudoParameterBinder.cs.html#5ac9244be24c2bbd" class="t t">PseudoBindingInfo</a> <span id="r226 rd" class="r226 r">bindingInfo</span> = <span class="r223 r">context</span>.<a href="CompletionAnalysis.cs.html#aa0594eac663bfde" class="i property">PseudoBindingInfo</a>;
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#be318ae0c4315a2a" class="i property">InfoType</a>.<span class="i">Equals</span>(<a href="PseudoParameterBinder.cs.html#32dafa2abbeb3f2b" class="t t">PseudoBindingInfoType</a>.<a href="PseudoParameterBinder.cs.html#fac4de227da7e29b" class="i field">PseudoBindingSucceed</a>), <span class="s">&quot;Caller needs to make sure the pseudo binding was successful&quot;</span>);
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r227 rd" class="r227 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
 
            <b>if</b> (<span class="r224 r">argLocation</span>.<a href="#3091dd81c57d0646" class="i property">IsPositional</a> &amp;&amp; <span class="r224 r">argLocation</span>.<a href="#245629496e4946e2" class="i property">Argument</a> == <b>null</b>)
            {
                <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a> <span id="r228 rd" class="r228 r">lastPositionalArg</span>;
                <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r229 rd" class="r229 r">targetPositionalArg</span> =
                    <a href="#7d394c018fb20d47" class="i method">FindTargetPositionalArgument</a>(
                        <span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#e625bf306f80f711" class="i property">AllParsedArguments</a>,
                        <span class="r224 r">argLocation</span>.<a href="#33135be11a585538" class="i property">Position</a>,
                        <b>out</b> <span class="r228 r">lastPositionalArg</span>);
 
                <b>if</b> (<span class="r229 r">targetPositionalArg</span> != <b>null</b>)
                    <span class="r224 r">argLocation</span>.<a href="#245629496e4946e2" class="i property">Argument</a> = <span class="r229 r">targetPositionalArg</span>;
                <b>else</b>
                {
                    <b>if</b> (<span class="r228 r">lastPositionalArg</span> != <b>null</b>)
                    {
                        <b>bool</b> <span id="r230 rd" class="r230 r">lastPositionalGetBound</span> = <b>false</b>;
                        <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r231 rd" class="r231 r">parameterNames</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
 
                        <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r232 rd" class="r232 r">entry</span> <b>in</b> <span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#0890fafe524fd733" class="i property">BoundArguments</a>)
                        {
                            <span class="c">// positional argument</span>
                            <b>if</b> (!<span class="r232 r">entry</span>.<span class="i">Value</span>.<span class="i">ParameterSpecified</span>)
                            {
                                <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="k">var</a> <span id="r233 rd" class="r233 r">arg</span> = (<a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a>)<span class="r232 r">entry</span>.<span class="i">Value</span>;
                                <b>if</b> (<span class="r233 r">arg</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>.<span class="i">GetHashCode</span>() == <span class="r228 r">lastPositionalArg</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>.<span class="i">GetHashCode</span>())
                                {
                                    <span class="r230 r">lastPositionalGetBound</span> = <b>true</b>;
                                    <b>break</b>;
                                }
                            }
                            <b>else</b> <b>if</b> (<span class="r232 r">entry</span>.<span class="i">Value</span>.<span class="i">ParameterArgumentType</span>.<span class="i">Equals</span>(<a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#a7afade9bdc8b534" class="i field">AstArray</a>))
                            {
                                <span class="c">// check if the positional argument would be bound to a &quot;ValueFromRemainingArgument&quot; parameter</span>
                                <a href="PseudoParameterBinder.cs.html#d3a0a7f99c8105c4" class="k">var</a> <span id="r234 rd" class="r234 r">arg</span> = (<a href="PseudoParameterBinder.cs.html#d3a0a7f99c8105c4" class="t t">AstArrayPair</a>)<span class="r232 r">entry</span>.<span class="i">Value</span>;
                                <b>if</b> (<span class="r234 r">arg</span>.<a href="PseudoParameterBinder.cs.html#5ea2ac266039b42b" class="i property">Argument</a>.<span class="i">Any</span>(<span id="r235 rd" class="r235 r">exp</span> =&gt; <span class="r235 r">exp</span>.<span class="i">GetHashCode</span>() == <span class="r228 r">lastPositionalArg</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>.<span class="i">GetHashCode</span>()))
                                {
                                    <span class="r231 r">parameterNames</span>.<span class="i">Add</span>(<span class="r232 r">entry</span>.<span class="i">Key</span>);
                                }
                            }
                        }
 
                        <b>if</b> (<span class="r231 r">parameterNames</span>.<span class="i">Count</span> &gt; 0)
                        {
                            <span class="c">// parameter should be in BoundParameters</span>
                            <b>foreach</b> (<b>string</b> <span id="r236 rd" class="r236 r">param</span> <b>in</b> <span class="r231 r">parameterNames</span>)
                            {
                                <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r237 rd" class="r237 r">parameter</span> = <span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#05127fa9589c0eeb" class="i property">BoundParameters</a>[<span class="r236 r">param</span>];
                                <a href="#2abc5ab9613b3baa" class="i method">ProcessParameter</a>(<span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#8a99b7a836aade94" class="i property">CommandName</a>, <span class="r225 r">commandAst</span>, <span class="r223 r">context</span>, <span class="r227 r">result</span>, <span class="r237 r">parameter</span>, <span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#0890fafe524fd733" class="i property">BoundArguments</a>);
                            }
 
                            <b>return</b> <span class="r227 r">result</span>;
                        }
                        <b>else</b> <b>if</b> (!<span class="r230 r">lastPositionalGetBound</span>)
                        {
                            <span class="c">// last positional argument was not bound, then positional argument &#39;tab&#39; wants to</span>
                            <span class="c">// expand will not get bound either</span>
                            <b>return</b> <span class="r227 r">result</span>;
                        }
                    }
 
                    <span class="i">CompletePositionalArgument</span>(
                        <span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#8a99b7a836aade94" class="i property">CommandName</a>,
                        <span class="r225 r">commandAst</span>,
                        <span class="r223 r">context</span>,
                        <span class="r227 r">result</span>,
                        <span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#a765b55f276ef803" class="i property">UnboundParameters</a>,
                        <span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#b621e7fcaed07b69" class="i property">DefaultParameterSetFlag</a>,
                        <span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#c06c8a4dc27d4026" class="i property">ValidParameterSetsFlags</a>,
                        <span class="r224 r">argLocation</span>.<a href="#33135be11a585538" class="i property">Position</a>,
                        <span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#0890fafe524fd733" class="i property">BoundArguments</a>);
 
                    <b>return</b> <span class="r227 r">result</span>;
                }
            }
 
            <b>if</b> (<span class="r224 r">argLocation</span>.<a href="#245629496e4946e2" class="i property">Argument</a> != <b>null</b>)
            {
                <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r238 rd" class="r238 r">parameterNames</span> = <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
                <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r239 rd" class="r239 r">entry</span> <b>in</b> <span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#0890fafe524fd733" class="i property">BoundArguments</a>)
                {
                    <b>if</b> (<span class="r239 r">entry</span>.<span class="i">Value</span>.<span class="i">ParameterArgumentType</span>.<span class="i">Equals</span>(<a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#ac5fbd8418f369ff" class="i field">PipeObject</a>))
                        <b>continue</b>;
 
                    <b>if</b> (<span class="r239 r">entry</span>.<span class="i">Value</span>.<span class="i">ParameterArgumentType</span>.<span class="i">Equals</span>(<a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#a7afade9bdc8b534" class="i field">AstArray</a>) &amp;&amp; !<span class="r224 r">argLocation</span>.<a href="#245629496e4946e2" class="i property">Argument</a>.<a href="PseudoParameterBinder.cs.html#ee5926fcf99682f5" class="i property">ParameterSpecified</a>)
                    {
                        <a href="PseudoParameterBinder.cs.html#d3a0a7f99c8105c4" class="k">var</a> <span id="r240 rd" class="r240 r">arrayArg</span> = (<a href="PseudoParameterBinder.cs.html#d3a0a7f99c8105c4" class="t t">AstArrayPair</a>)<span class="r239 r">entry</span>.<span class="i">Value</span>;
                        <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="k">var</a> <span id="r241 rd" class="r241 r">target</span> = (<a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a>)<span class="r224 r">argLocation</span>.<a href="#245629496e4946e2" class="i property">Argument</a>;
                        <b>if</b> (<span class="r240 r">arrayArg</span>.<a href="PseudoParameterBinder.cs.html#5ea2ac266039b42b" class="i property">Argument</a>.<span class="i">Any</span>(<span id="r242 rd" class="r242 r">exp</span> =&gt; <span class="r242 r">exp</span>.<span class="i">GetHashCode</span>() == <span class="r241 r">target</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>.<span class="i">GetHashCode</span>()))
                        {
                            <span class="r238 r">parameterNames</span>.<span class="i">Add</span>(<span class="r239 r">entry</span>.<span class="i">Key</span>);
                        }
                    }
                    <b>else</b> <b>if</b> (<span class="r239 r">entry</span>.<span class="i">Value</span>.<span class="i">GetHashCode</span>() == <span class="r224 r">argLocation</span>.<a href="#245629496e4946e2" class="i property">Argument</a>.<span class="i">GetHashCode</span>())
                    {
                        <span class="r238 r">parameterNames</span>.<span class="i">Add</span>(<span class="r239 r">entry</span>.<span class="i">Key</span>);
                    }
                }
 
                <b>if</b> (<span class="r238 r">parameterNames</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="c">// those parameters should be in BoundParameters</span>
                    <b>foreach</b> (<b>string</b> <span id="r243 rd" class="r243 r">param</span> <b>in</b> <span class="r238 r">parameterNames</span>)
                    {
                        <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r244 rd" class="r244 r">parameter</span> = <span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#05127fa9589c0eeb" class="i property">BoundParameters</a>[<span class="r243 r">param</span>];
                        <a href="#2abc5ab9613b3baa" class="i method">ProcessParameter</a>(<span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#8a99b7a836aade94" class="i property">CommandName</a>, <span class="r225 r">commandAst</span>, <span class="r223 r">context</span>, <span class="r227 r">result</span>, <span class="r244 r">parameter</span>, <span class="r226 r">bindingInfo</span>.<a href="PseudoParameterBinder.cs.html#0890fafe524fd733" class="i property">BoundArguments</a>);
                    }
                }
            }
 
            <b>return</b> <span class="r227 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the positional argument completion results based on the position it&#39;s in the command line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="a1d5ff1b60ea72bf" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CompletePositionalArgument</a>(
            <b>string</b> <span id="r245 rd" class="r245 r">commandName</span>,
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r246 rd" class="r246 r">commandAst</span>,
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r247 rd" class="r247 r">context</span>,
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r248 rd" class="r248 r">result</span>,
            <span class="i">IEnumerable</span>&lt;<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r249 rd" class="r249 r">parameters</span>,
            <b>uint</b> <span id="r250 rd" class="r250 r">defaultParameterSetFlag</span>,
            <b>uint</b> <span id="r251 rd" class="r251 r">validParameterSetFlags</span>,
            <b>int</b> <span id="r252 rd" class="r252 r">position</span>,
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r253 rd" class="r253 r">boundArguments</span> = <b>null</b>)
        {
            <b>bool</b> <span id="r254 rd" class="r254 r">isProcessedAsPositional</span> = <b>false</b>;
            <b>bool</b> <span id="r255 rd" class="r255 r">isDefaultParameterSetValid</span> = <span class="r250 r">defaultParameterSetFlag</span> != 0 &amp;&amp;
                                              (<span class="r250 r">defaultParameterSetFlag</span> &amp; <span class="r251 r">validParameterSetFlags</span>) != 0;
            <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r256 rd" class="r256 r">positionalParam</span> = <b>null</b>;
 
            <b>foreach</b> (<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r257 rd" class="r257 r">param</span> <b>in</b> <span class="r249 r">parameters</span>)
            {
                <b>bool</b> <span id="r258 rd" class="r258 r">isInParameterSet</span> = (<span class="r257 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a> &amp; <span class="r251 r">validParameterSetFlags</span>) != 0 || <span class="r257 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#28fd649ec0fa1b52" class="i property">IsInAllSets</a>;
                <b>if</b> (!<span class="r258 r">isInParameterSet</span>)
                    <b>continue</b>;
 
                <b>var</b> <span id="r259 rd" class="r259 r">parameterSetDataCollection</span> = <span class="r257 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#6734aa34600c1096" class="i method">GetMatchingParameterSetData</a>(<span class="r251 r">validParameterSetFlags</span>);
                <b>foreach</b> (<a href="../ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r260 rd" class="r260 r">parameterSetData</span> <b>in</b> <span class="r259 r">parameterSetDataCollection</span>)
                {
                    <span class="c">// in the first pass, we skip the remaining argument ones</span>
                    <b>if</b> (<span class="r260 r">parameterSetData</span>.<a href="../ParameterSetSpecificMetadata.cs.html#75971da95a085c4f" class="i property">ValueFromRemainingArguments</a>)
                    {
                        <b>continue</b>;
                    }
 
                    <span class="c">// Check the position</span>
                    <b>int</b> <span id="r261 rd" class="r261 r">positionInParameterSet</span> = <span class="r260 r">parameterSetData</span>.<a href="../ParameterSetSpecificMetadata.cs.html#5fe039f108b3ea8f" class="i property">Position</a>;
 
                    <b>if</b> (<span class="r261 r">positionInParameterSet</span> == <b>int</b>.<span class="i">MinValue</span> || <span class="r261 r">positionInParameterSet</span> != <span class="r252 r">position</span>)
                    {
                        <span class="c">// The parameter is not positional, or its position is not what we want</span>
                        <b>continue</b>;
                    }
 
                    <b>if</b> (<span class="r255 r">isDefaultParameterSetValid</span>)
                    {
                        <b>if</b> (<span class="r260 r">parameterSetData</span>.<a href="../ParameterSetSpecificMetadata.cs.html#f78c0b8e1f2ce3b8" class="i property">ParameterSetFlag</a> == <span class="r250 r">defaultParameterSetFlag</span>)
                        {
                            <a href="#2abc5ab9613b3baa" class="i method">ProcessParameter</a>(<span class="r245 r">commandName</span>, <span class="r246 r">commandAst</span>, <span class="r247 r">context</span>, <span class="r248 r">result</span>, <span class="r257 r">param</span>, <span class="r253 r">boundArguments</span>);
                            <span class="r254 r">isProcessedAsPositional</span> = <span class="r248 r">result</span>.<span class="i">Count</span> &gt; 0;
                            <b>break</b>;
                        }
                        <b>else</b>
                        {
                            <b>if</b> (<span class="r256 r">positionalParam</span> == <b>null</b>)
                                <span class="r256 r">positionalParam</span> = <span class="r257 r">param</span>;
                        }
                    }
                    <b>else</b>
                    {
                        <span class="r254 r">isProcessedAsPositional</span> = <b>true</b>;
                        <a href="#2abc5ab9613b3baa" class="i method">ProcessParameter</a>(<span class="r245 r">commandName</span>, <span class="r246 r">commandAst</span>, <span class="r247 r">context</span>, <span class="r248 r">result</span>, <span class="r257 r">param</span>, <span class="r253 r">boundArguments</span>);
                        <b>break</b>;
                    }
                }
 
                <b>if</b> (<span class="r254 r">isProcessedAsPositional</span>)
                    <b>break</b>;
            }
 
            <b>if</b> (!<span class="r254 r">isProcessedAsPositional</span> &amp;&amp; <span class="r256 r">positionalParam</span> != <b>null</b>)
            {
                <span class="r254 r">isProcessedAsPositional</span> = <b>true</b>;
                <a href="#2abc5ab9613b3baa" class="i method">ProcessParameter</a>(<span class="r245 r">commandName</span>, <span class="r246 r">commandAst</span>, <span class="r247 r">context</span>, <span class="r248 r">result</span>, <span class="r256 r">positionalParam</span>, <span class="r253 r">boundArguments</span>);
            }
 
            <b>if</b> (!<span class="r254 r">isProcessedAsPositional</span>)
            {
                <b>foreach</b> (<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r262 rd" class="r262 r">param</span> <b>in</b> <span class="r249 r">parameters</span>)
                {
                    <b>bool</b> <span id="r263 rd" class="r263 r">isInParameterSet</span> = (<span class="r262 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a> &amp; <span class="r251 r">validParameterSetFlags</span>) != 0 || <span class="r262 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#28fd649ec0fa1b52" class="i property">IsInAllSets</a>;
                    <b>if</b> (!<span class="r263 r">isInParameterSet</span>)
                        <b>continue</b>;
 
                    <b>var</b> <span id="r264 rd" class="r264 r">parameterSetDataCollection</span> = <span class="r262 r">param</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#6734aa34600c1096" class="i method">GetMatchingParameterSetData</a>(<span class="r251 r">validParameterSetFlags</span>);
                    <b>foreach</b> (<a href="../ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r265 rd" class="r265 r">parameterSetData</span> <b>in</b> <span class="r264 r">parameterSetDataCollection</span>)
                    {
                        <span class="c">// in the second pass, we check the remaining argument ones</span>
                        <b>if</b> (<span class="r265 r">parameterSetData</span>.<a href="../ParameterSetSpecificMetadata.cs.html#75971da95a085c4f" class="i property">ValueFromRemainingArguments</a>)
                        {
                            <a href="#2abc5ab9613b3baa" class="i method">ProcessParameter</a>(<span class="r245 r">commandName</span>, <span class="r246 r">commandAst</span>, <span class="r247 r">context</span>, <span class="r248 r">result</span>, <span class="r262 r">param</span>, <span class="r253 r">boundArguments</span>);
                            <b>break</b>;
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Process a parameter to get the argument completion results.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the argument completion falls into these pre-defined cases:</span>
        <span class="c">///</span><span class="c">   1. The matching parameter is of type Enum</span>
        <span class="c">///</span><span class="c">   2. The matching parameter is of type SwitchParameter</span>
        <span class="c">///</span><span class="c">   3. The matching parameter is declared with ValidateSetAttribute</span>
        <span class="c">///</span><span class="c">   4. Falls into the native command argument completion</span>
        <span class="c">///</span><span class="c"> a null instance of CompletionResult is added to the end of the</span>
        <span class="c">///</span><span class="c"> &quot;result&quot; list, to indicate that this particular argument completion</span>
        <span class="c">///</span><span class="c"> has been processed already. If the &quot;result&quot; list is still empty, we</span>
        <span class="c">///</span><span class="c"> will not go through the default argument completion steps anymore.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="2abc5ab9613b3baa" href="../../R/2abc5ab9613b3baa.html" target="n" data-glyph="76,1" class="i method">ProcessParameter</a>(
            <b>string</b> <span id="r266 rd" class="r266 r">commandName</span>,
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r267 rd" class="r267 r">commandAst</span>,
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r268 rd" class="r268 r">context</span>,
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r269 rd" class="r269 r">result</span>,
            <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r270 rd" class="r270 r">parameter</span>,
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r271 rd" class="r271 r">boundArguments</span> = <b>null</b>)
        {
            <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <span id="r272 rd" class="r272 r">fullMatch</span> = <b>null</b>;
            <span class="i">Type</span> <span id="r273 rd" class="r273 r">parameterType</span> = <a href="#a3fa8f644e432f1e" class="i method">GetEffectiveParameterType</a>(<span class="r270 r">parameter</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>);
 
            <b>if</b> (<span class="r273 r">parameterType</span>.<span class="i">IsArray</span>)
            {
                <span class="r273 r">parameterType</span> = <span class="r273 r">parameterType</span>.<span class="i">GetElementType</span>();
            }
 
            <b>if</b> (<span class="r273 r">parameterType</span>.<span class="i">IsEnum</span>)
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r269 r">result</span>);
 
                <b>string</b> <span id="r274 rd" class="r274 r">enumString</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<a href="../LanguagePrimitives.cs.html#7e68d3d58478ec8d" class="i method">EnumValues</a>(<span class="r273 r">parameterType</span>);
                <b>string</b> <span id="r275 rd" class="r275 r">separator</span> = <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>.<span class="i">TextInfo</span>.<span class="i">ListSeparator</span>;
                <b>string</b>[] <span id="r276 rd" class="r276 r">enumArray</span> = <span class="r274 r">enumString</span>.<span class="i">Split</span>(<span class="r275 r">separator</span>, <span class="i">StringSplitOptions</span>.<span class="i">RemoveEmptyEntries</span>);
 
                <b>string</b> <span id="r277 rd" class="r277 r">wordToComplete</span> = <span class="r268 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>;
                <b>string</b> <span id="r278 rd" class="r278 r">quote</span> = <a href="#944eddaabbba5d42" class="i method">HandleDoubleAndSingleQuote</a>(<b>ref</b> <span class="r277 r">wordToComplete</span>);
 
                <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r279 rd" class="r279 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r277 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                <b>var</b> <span id="r280 rd" class="r280 r">enumList</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
                <b>foreach</b> (<b>string</b> <span id="r281 rd" class="r281 r">value</span> <b>in</b> <span class="r276 r">enumArray</span>)
                {
                    <b>if</b> (<span class="r277 r">wordToComplete</span>.<span class="i">Equals</span>(<span class="r281 r">value</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>string</b> <span id="r282 rd" class="r282 r">completionText</span> = <span class="r278 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="r281 r">value</span> : <span class="r278 r">quote</span> + <span class="r281 r">value</span> + <span class="r278 r">quote</span>;
                        <span class="r272 r">fullMatch</span> = <b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r282 r">completionText</span>, <span class="r281 r">value</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r281 r">value</span>);
                        <b>continue</b>;
                    }
 
                    <b>if</b> (<span class="r279 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r281 r">value</span>))
                    {
                        <span class="r280 r">enumList</span>.<span class="i">Add</span>(<span class="r281 r">value</span>);
                    }
                }
 
                <b>if</b> (<span class="r272 r">fullMatch</span> != <b>null</b>)
                {
                    <span class="r269 r">result</span>.<span class="i">Add</span>(<span class="r272 r">fullMatch</span>);
                }
 
                <span class="r280 r">enumList</span>.<span class="i">Sort</span>();
                <span class="r269 r">result</span>.<span class="i">AddRange</span>(<b>from</b> <span class="i">entry</span> <b>in</b> <span class="r280 r">enumList</span>
                                <b>let</b> <span class="i">completionText</span> = <span class="r278 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="i">entry</span> : <span class="r278 r">quote</span> + <span class="i">entry</span> + <span class="r278 r">quote</span>
                                <b>select</b> <b>new</b> <span class="t">CompletionResult</span>(<span class="i">completionText</span>, <span class="i">entry</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="i">entry</span>));
 
                <span class="r269 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r273 r">parameterType</span>.<span class="i">Equals</span>(<b>typeof</b>(<a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>)))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r269 r">result</span>);
 
                <b>if</b> (<span class="r268 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> == <b>string</b>.<span class="i">Empty</span> || <span class="r268 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>.<span class="i">Equals</span>(<span class="s">&quot;$&quot;</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                {
                    <span class="r269 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="s">&quot;$true&quot;</span>, <span class="s">&quot;$true&quot;</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="s">&quot;$true&quot;</span>));
                    <span class="r269 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="s">&quot;$false&quot;</span>, <span class="s">&quot;$false&quot;</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="s">&quot;$false&quot;</span>));
                }
 
                <span class="r269 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
                <b>return</b>;
            }
 
            <b>foreach</b> (<a href="../Attributes.cs.html#f182d3d1083583da" class="t t">ValidateArgumentsAttribute</a> <span id="r283 rd" class="r283 r">att</span> <b>in</b> <span class="r270 r">parameter</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#f854be24d6c5bdf6" class="i property">ValidationAttributes</a>)
            {
                <b>if</b> (<span class="r283 r">att</span> <b>is</b> <a href="../Attributes.cs.html#33a6a027748d30a4" class="t t">ValidateSetAttribute</a> <span id="r284 rd" class="r284 r">setAtt</span>)
                {
                    <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r269 r">result</span>);
 
                    <b>string</b> <span id="r285 rd" class="r285 r">wordToComplete</span> = <span class="r268 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>;
                    <b>string</b> <span id="r286 rd" class="r286 r">quote</span> = <a href="#944eddaabbba5d42" class="i method">HandleDoubleAndSingleQuote</a>(<b>ref</b> <span class="r285 r">wordToComplete</span>);
 
                    <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r287 rd" class="r287 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r285 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                    <b>var</b> <span id="r288 rd" class="r288 r">setList</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
                    <b>foreach</b> (<b>string</b> <span id="r289 rd" class="r289 r">value</span> <b>in</b> <span class="r284 r">setAtt</span>.<a href="../Attributes.cs.html#7e92ecc5d5d777ac" class="i property">ValidValues</a>)
                    {
                        <b>if</b> (<span class="r289 r">value</span> == <b>string</b>.<span class="i">Empty</span>) { <b>continue</b>; }
 
                        <b>if</b> (<span class="r285 r">wordToComplete</span>.<span class="i">Equals</span>(<span class="r289 r">value</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>string</b> <span id="r290 rd" class="r290 r">completionText</span> = <span class="r286 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="r289 r">value</span> : <span class="r286 r">quote</span> + <span class="r289 r">value</span> + <span class="r286 r">quote</span>;
                            <span class="r272 r">fullMatch</span> = <b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r290 r">completionText</span>, <span class="r289 r">value</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r289 r">value</span>);
                            <b>continue</b>;
                        }
 
                        <b>if</b> (<span class="r287 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r289 r">value</span>))
                        {
                            <span class="r288 r">setList</span>.<span class="i">Add</span>(<span class="r289 r">value</span>);
                        }
                    }
 
                    <b>if</b> (<span class="r272 r">fullMatch</span> != <b>null</b>)
                    {
                        <span class="r269 r">result</span>.<span class="i">Add</span>(<span class="r272 r">fullMatch</span>);
                    }
 
                    <span class="r288 r">setList</span>.<span class="i">Sort</span>();
                    <b>foreach</b> (<b>string</b> <span id="r291 rd" class="r291 r">entry</span> <b>in</b> <span class="r288 r">setList</span>)
                    {
                        <b>string</b> <span id="r292 rd" class="r292 r">realEntry</span> = <span class="r291 r">entry</span>;
                        <b>string</b> <span id="r293 rd" class="r293 r">completionText</span> = <span class="r291 r">entry</span>;
                        <b>if</b> (<span class="r286 r">quote</span> == <b>string</b>.<span class="i">Empty</span>)
                        {
                            <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r291 r">entry</span>, <b>false</b>))
                            {
                                <span class="r292 r">realEntry</span> = <a href="../lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="../lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<span class="r291 r">entry</span>);
                                <span class="r293 r">completionText</span> = <span class="s">&quot;&#39;&quot;</span> + <span class="r292 r">realEntry</span> + <span class="s">&quot;&#39;&quot;</span>;
                            }
                        }
                        <b>else</b>
                        {
                            <b>if</b> (<span class="r286 r">quote</span>.<span class="i">Equals</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="r292 r">realEntry</span> = <a href="../lang/codegen.cs.html#ec5e2f0e22eb2223" class="t t">CodeGeneration</a>.<a href="../lang/codegen.cs.html#99c5bb762439f325" class="i method">EscapeSingleQuotedStringContent</a>(<span class="r291 r">entry</span>);
                            }
 
                            <span class="r293 r">completionText</span> = <span class="r286 r">quote</span> + <span class="r292 r">realEntry</span> + <span class="r286 r">quote</span>;
                        }
 
                        <span class="r269 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r293 r">completionText</span>, <span class="r291 r">entry</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r291 r">entry</span>));
                    }
 
                    <span class="r269 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
                    <b>return</b>;
                }
            }
 
            <a href="#f135b8dad16b6fd8" class="i method">NativeCommandArgumentCompletion</a>(<span class="r266 r">commandName</span>, <span class="r270 r">parameter</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>, <span class="r269 r">result</span>, <span class="r267 r">commandAst</span>, <span class="r268 r">context</span>, <span class="r271 r">boundArguments</span>);
        }
 
        <b>private static</b> <span class="i">IEnumerable</span>&lt;<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt; <a id="b0cb9c13674b4be8" href="../../R/b0cb9c13674b4be8.html" target="n" data-glyph="76,1" class="i method">NativeCommandArgumentCompletion_InferTypesOfArgument</a>(
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r294 rd" class="r294 r">boundArguments</span>,
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r295 rd" class="r295 r">commandAst</span>,
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r296 rd" class="r296 r">context</span>,
            <b>string</b> <span id="r297 rd" class="r297 r">parameterName</span>)
        {
            <b>if</b> (<span class="r294 r">boundArguments</span> == <b>null</b>)
            {
                <b>yield</b> <b>break</b>;
            }
 
            <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r298 rd" class="r298 r">astParameterArgumentPair</span>;
            <b>if</b> (!<span class="r294 r">boundArguments</span>.<span class="i">TryGetValue</span>(<span class="r297 r">parameterName</span>, <b>out</b> <span class="r298 r">astParameterArgumentPair</span>))
            {
                <b>yield</b> <b>break</b>;
            }
 
            <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r299 rd" class="r299 r">argumentAst</span> = <b>null</b>;
            <b>switch</b> (<span class="r298 r">astParameterArgumentPair</span>.<a href="PseudoParameterBinder.cs.html#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a>)
            {
                <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#409b194c1cec01fc" class="i field">AstPair</a>:
                    {
                        <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a> <span id="r300 rd" class="r300 r">astPair</span> = (<a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a>)<span class="r298 r">astParameterArgumentPair</span>;
                        <span class="r299 r">argumentAst</span> = <span class="r300 r">astPair</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>;
                    }
 
                    <b>break</b>;
 
                <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#ac5fbd8418f369ff" class="i field">PipeObject</a>:
                    {
                        <a href="../parser/ast.cs.html#785915ec8547ce9f" class="k">var</a> <span id="r301 rd" class="r301 r">pipelineAst</span> = <span class="r295 r">commandAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="../parser/ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a>;
                        <b>if</b> (<span class="r301 r">pipelineAst</span> != <b>null</b>)
                        {
                            <b>int</b> <span id="r302 rd" class="r302 r">i</span>;
                            <b>for</b> (<span class="r302 r">i</span> = 0; <span class="r302 r">i</span> &lt; <span class="r301 r">pipelineAst</span>.<a href="../parser/ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>.<span class="i">Count</span>; <span class="r302 r">i</span>++)
                            {
                                <b>if</b> (<span class="r301 r">pipelineAst</span>.<a href="../parser/ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>[<span class="r302 r">i</span>] == <span class="r295 r">commandAst</span>)
                                    <b>break</b>;
                            }
 
                            <b>if</b> (<span class="r302 r">i</span> != 0)
                            {
                                <span class="r299 r">argumentAst</span> = <span class="r301 r">pipelineAst</span>.<a href="../parser/ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>[<span class="r302 r">i</span> - 1];
                            }
                        }
                    }
 
                    <b>break</b>;
 
                <b>default</b>:
                    <b>break</b>;
            }
 
            <b>if</b> (<span class="r299 r">argumentAst</span> == <b>null</b>)
            {
                <b>yield</b> <b>break</b>;
            }
 
            <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r303 rd" class="r303 r">argumentExpressionAst</span> = <span class="r299 r">argumentAst</span> <b>as</b> <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>;
            <b>if</b> (<span class="r303 r">argumentExpressionAst</span> == <b>null</b>)
            {
                <a href="../parser/ast.cs.html#f4da818a29387c5d" class="t t">CommandExpressionAst</a> <span id="r304 rd" class="r304 r">argumentCommandExpressionAst</span> = <span class="r299 r">argumentAst</span> <b>as</b> <a href="../parser/ast.cs.html#f4da818a29387c5d" class="t t">CommandExpressionAst</a>;
                <b>if</b> (<span class="r304 r">argumentCommandExpressionAst</span> != <b>null</b>)
                {
                    <span class="r303 r">argumentExpressionAst</span> = <span class="r304 r">argumentCommandExpressionAst</span>.<a href="../parser/ast.cs.html#5e5388d1f86139f7" class="i property">Expression</a>;
                }
            }
 
            <b>object</b> <span id="r305 rd" class="r305 r">argumentValue</span>;
            <b>if</b> (<span class="r303 r">argumentExpressionAst</span> != <b>null</b> &amp;&amp; <a href="#734c1ec38d499153" class="t t">SafeExprEvaluator</a>.<a href="#f61f6e9c4ea81b8b" class="i method">TrySafeEval</a>(<span class="r303 r">argumentExpressionAst</span>, <span class="r296 r">context</span>.<a href="CompletionAnalysis.cs.html#4055c622a2008ac8" class="i property">ExecutionContext</a>, <b>out</b> <span class="r305 r">argumentValue</span>))
            {
                <b>if</b> (<span class="r305 r">argumentValue</span> != <b>null</b>)
                {
                    <span class="i">IEnumerable</span> <span id="r306 rd" class="r306 r">enumerable</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#5489692986d47497" class="i method">GetEnumerable</a>(<span class="r305 r">argumentValue</span>) ??
                                             <b>new</b> <b>object</b>[] { <span class="r305 r">argumentValue</span> };
                    <b>foreach</b> (<b>var</b> <span id="r307 rd" class="r307 r">element</span> <b>in</b> <span class="r306 r">enumerable</span>)
                    {
                        <b>if</b> (<span class="r307 r">element</span> == <b>null</b>)
                        {
                            <b>continue</b>;
                        }
 
                        <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r308 rd" class="r308 r">pso</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">AsPSObject</span>(<span class="r307 r">element</span>);
                        <b>if</b> ((<span class="r308 r">pso</span>.<a href="../MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>.<span class="i">Count</span> &gt; 0) &amp;&amp; (!(<span class="r308 r">pso</span>.<a href="../MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>[0].<span class="i">Equals</span>(<span class="r308 r">pso</span>.<a href="../MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>.<span class="i">GetType</span>().<span class="i">FullName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))))
                        {
                            <b>yield</b> <b>return</b> <b>new</b> <span class="t">PSTypeName</span>(<span class="r308 r">pso</span>.<a href="../MshObject.cs.html#86c0a84d554979ba" class="i property">TypeNames</a>[0]);
                        }
 
                        <b>if</b> (<span class="r308 r">pso</span>.<a href="../MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a> <b>is not</b> <a href="../MshObject.cs.html#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>)
                        {
                            <b>yield</b> <b>return</b> <b>new</b> <span class="t">PSTypeName</span>(<span class="r308 r">pso</span>.<a href="../MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>.<span class="i">GetType</span>());
                        }
                    }
 
                    <b>yield</b> <b>break</b>;
                }
            }
 
            <b>foreach</b> (<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a> <span id="r309 rd" class="r309 r">typeName</span> <b>in</b> <a href="../parser/TypeInferenceVisitor.cs.html#85308821e258515b" class="t t">AstTypeInference</a>.<a href="../parser/TypeInferenceVisitor.cs.html#a161c4fce43bc728" class="i method">InferTypeOf</a>(<span class="r299 r">argumentAst</span>, <span class="r296 r">context</span>.<a href="CompletionAnalysis.cs.html#95d0769179a8633b" class="i property">TypeInferenceContext</a>, <a href="../parser/TypeInferenceVisitor.cs.html#c79f5fa1494e528d" class="t t">TypeInferenceRuntimePermissions</a>.<a href="../parser/TypeInferenceVisitor.cs.html#8df46f8adea8c4e2" class="i field">AllowSafeEval</a>))
            {
                <b>yield</b> <b>return</b> <span class="r309 r">typeName</span>;
            }
        }
 
        <b>internal static</b> <span class="i">IList</span>&lt;<b>string</b>&gt; <a id="33f96c4967c48877" href="../../R/33f96c4967c48877.html" target="n" data-glyph="74,1" class="i method">NativeCommandArgumentCompletion_ExtractSecondaryArgument</a>(
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r310 rd" class="r310 r">boundArguments</span>,
            <b>string</b> <span id="r311 rd" class="r311 r">parameterName</span>)
        {
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r312 rd" class="r312 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
            <b>if</b> (<span class="r310 r">boundArguments</span> == <b>null</b>)
            {
                <b>return</b> <span class="r312 r">result</span>;
            }
 
            <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r313 rd" class="r313 r">argumentValue</span>;
            <b>if</b> (!<span class="r310 r">boundArguments</span>.<span class="i">TryGetValue</span>(<span class="r311 r">parameterName</span>, <b>out</b> <span class="r313 r">argumentValue</span>))
            {
                <b>return</b> <span class="r312 r">result</span>;
            }
 
            <b>switch</b> (<span class="r313 r">argumentValue</span>.<a href="PseudoParameterBinder.cs.html#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a>)
            {
                <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#409b194c1cec01fc" class="i field">AstPair</a>:
                    {
                        <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="k">var</a> <span id="r314 rd" class="r314 r">value</span> = (<a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a>)<span class="r313 r">argumentValue</span>;
                        <b>if</b> (<span class="r314 r">value</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a> <b>is</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)
                        {
                            <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r315 rd" class="r315 r">argument</span> = (<a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)<span class="r314 r">value</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>;
                            <span class="r312 r">result</span>.<span class="i">Add</span>(<span class="r315 r">argument</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>);
                        }
                        <b>else</b> <b>if</b> (<span class="r314 r">value</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a> <b>is</b> <a href="../parser/ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>)
                        {
                            <a href="../parser/ast.cs.html#0e44bc9125134006" class="k">var</a> <span id="r316 rd" class="r316 r">argument</span> = (<a href="../parser/ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>)<span class="r314 r">value</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>;
                            <b>foreach</b> (<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r317 rd" class="r317 r">entry</span> <b>in</b> <span class="r316 r">argument</span>.<a href="../parser/ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>)
                            {
                                <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r318 rd" class="r318 r">entryAsString</span> = <span class="r317 r">entry</span> <b>as</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                                <b>if</b> (<span class="r318 r">entryAsString</span> != <b>null</b>)
                                {
                                    <span class="r312 r">result</span>.<span class="i">Add</span>(<span class="r318 r">entryAsString</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>);
                                }
                                <b>else</b>
                                {
                                    <span class="r312 r">result</span>.<span class="i">Clear</span>();
                                    <b>break</b>;
                                }
                            }
                        }
 
                        <b>break</b>;
                    }
                <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#a7afade9bdc8b534" class="i field">AstArray</a>:
                    {
                        <a href="PseudoParameterBinder.cs.html#d3a0a7f99c8105c4" class="k">var</a> <span id="r319 rd" class="r319 r">value</span> = (<a href="PseudoParameterBinder.cs.html#d3a0a7f99c8105c4" class="t t">AstArrayPair</a>)<span class="r313 r">argumentValue</span>;
                        <b>var</b> <span id="r320 rd" class="r320 r">argument</span> = <span class="r319 r">value</span>.<a href="PseudoParameterBinder.cs.html#5ea2ac266039b42b" class="i property">Argument</a>;
 
                        <b>foreach</b> (<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r321 rd" class="r321 r">entry</span> <b>in</b> <span class="r320 r">argument</span>)
                        {
                            <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r322 rd" class="r322 r">entryAsString</span> = <span class="r321 r">entry</span> <b>as</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                            <b>if</b> (<span class="r322 r">entryAsString</span> != <b>null</b>)
                            {
                                <span class="r312 r">result</span>.<span class="i">Add</span>(<span class="r322 r">entryAsString</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>);
                            }
                            <b>else</b>
                            {
                                <span class="r312 r">result</span>.<span class="i">Clear</span>();
                                <b>break</b>;
                            }
                        }
 
                        <b>break</b>;
                    }
                <b>default</b>:
                    <b>break</b>;
            }
 
            <b>return</b> <span class="r312 r">result</span>;
        }
 
        <b>private static void</b> <a id="f135b8dad16b6fd8" href="../../R/f135b8dad16b6fd8.html" target="n" data-glyph="76,1" class="i method">NativeCommandArgumentCompletion</a>(
            <b>string</b> <span id="r323 rd" class="r323 r">commandName</span>,
            <a href="../CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a> <span id="r324 rd" class="r324 r">parameter</span>,
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r325 rd" class="r325 r">result</span>,
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r326 rd" class="r326 r">commandAst</span>,
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r327 rd" class="r327 r">context</span>,
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r328 rd" class="r328 r">boundArguments</span> = <b>null</b>)
        {
            <b>string</b> <span id="r329 rd" class="r329 r">parameterName</span> = <span class="r324 r">parameter</span>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>;
 
            <span class="c">// Fall back to the commandAst command name if a command name is not found. This can be caused by a script block or AST with the matching function definition being passed to CompleteInput</span>
            <span class="c">// This allows for editors and other tools using CompleteInput with Script/AST definations to get values from RegisteredArgumentCompleters to better match the console experience.</span>
            <span class="c">// See issue https://github.com/PowerShell/PowerShell/issues/10567</span>
            <b>string</b> <span id="r330 rd" class="r330 r">actualCommandName</span> = <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r323 r">commandName</span>)
                        ? <span class="r326 r">commandAst</span>.<a href="../parser/ast.cs.html#14cec84b5558d5c6" class="i method">GetCommandName</a>()
                        : <span class="r323 r">commandName</span>;
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r330 r">actualCommandName</span>))
            {
                <b>return</b>;
            }
 
            <b>string</b> <span id="r331 rd" class="r331 r">parameterFullName</span> = <span class="s">$&quot;</span>{<span class="r330 r">actualCommandName</span>}<span class="s">:</span>{<span class="r329 r">parameterName</span>}<span class="s">&quot;</span>;
 
            <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r332 rd" class="r332 r">customCompleter</span> = <span class="i">GetCustomArgumentCompleter</span>(
                <span class="s">&quot;CustomArgumentCompleters&quot;</span>,
                <b>new</b>[] { <span class="r331 r">parameterFullName</span>, <span class="r329 r">parameterName</span> },
                <span class="r327 r">context</span>);
 
            <b>if</b> (<span class="r332 r">customCompleter</span> != <b>null</b>)
            {
                <b>if</b> (<a href="#f39ca631290ea7db" class="i method">InvokeScriptArgumentCompleter</a>(
                    <span class="r332 r">customCompleter</span>,
                    <span class="r323 r">commandName</span>, <span class="r329 r">parameterName</span>, <span class="r327 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>, <span class="r326 r">commandAst</span>, <span class="r327 r">context</span>,
                    <span class="r325 r">result</span>))
                {
                    <b>return</b>;
                }
            }
 
            <b>var</b> <span id="r333 rd" class="r333 r">argumentCompleterAttribute</span> = <span class="r324 r">parameter</span>.<a href="../CompiledCommandParameter.cs.html#f2f9b722fb3a36da" class="i property">CompiledAttributes</a>.<span class="i">OfType</span>&lt;<a href="ExtensibleCompletion.cs.html#164bbe7828ad5f99" class="t t">ArgumentCompleterAttribute</a>&gt;().<span class="i">FirstOrDefault</span>();
            <b>if</b> (<span class="r333 r">argumentCompleterAttribute</span> != <b>null</b>)
            {
                <b>try</b>
                {
                    <b>var</b> <span id="r334 rd" class="r334 r">completer</span> = <span class="r333 r">argumentCompleterAttribute</span>.<span class="i">CreateArgumentCompleter</span>();
 
                    <b>if</b> (<span class="r334 r">completer</span> != <b>null</b>)
                    {
                        <b>var</b> <span id="r335 rd" class="r335 r">customResults</span> = <span class="r334 r">completer</span>.<span class="i">CompleteArgument</span>(<span class="r323 r">commandName</span>, <span class="r329 r">parameterName</span>,
                            <span class="r327 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>, <span class="r326 r">commandAst</span>, <a href="#e89db5ccd9fe157e" class="i method">GetBoundArgumentsAsHashtable</a>(<span class="r327 r">context</span>));
                        <b>if</b> (<span class="r335 r">customResults</span> != <b>null</b>)
                        {
                            <span class="r325 r">result</span>.<span class="i">AddRange</span>(<span class="r335 r">customResults</span>);
                            <span class="r325 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
                            <b>return</b>;
                        }
                    }
                    <b>else</b>
                    {
                        <b>if</b> (<span class="i">InvokeScriptArgumentCompleter</span>(
                            <span class="r333 r">argumentCompleterAttribute</span>.<span class="i">ScriptBlock</span>,
                            <span class="r323 r">commandName</span>, <span class="r329 r">parameterName</span>, <span class="r327 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>, <span class="r326 r">commandAst</span>, <span class="r327 r">context</span>,
                            <span class="r325 r">result</span>))
                        {
                            <b>return</b>;
                        }
                    }
                }
                <b>catch</b> (<span class="i">Exception</span>)
                {
                }
            }
 
            <b>var</b> <span id="r336 rd" class="r336 r">argumentCompletionsAttribute</span> = <span class="r324 r">parameter</span>.<a href="../CompiledCommandParameter.cs.html#f2f9b722fb3a36da" class="i property">CompiledAttributes</a>.<span class="i">OfType</span>&lt;<a href="ExtensibleCompletion.cs.html#a72296adbadc7feb" class="t t">ArgumentCompletionsAttribute</a>&gt;().<span class="i">FirstOrDefault</span>();
            <b>if</b> (<span class="r336 r">argumentCompletionsAttribute</span> != <b>null</b>)
            {
                <b>var</b> <span id="r337 rd" class="r337 r">customResults</span> = <span class="r336 r">argumentCompletionsAttribute</span>.<span class="i">CompleteArgument</span>(<span class="r323 r">commandName</span>, <span class="r329 r">parameterName</span>,
                        <span class="r327 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>, <span class="r326 r">commandAst</span>, <a href="#e89db5ccd9fe157e" class="i method">GetBoundArgumentsAsHashtable</a>(<span class="r327 r">context</span>));
                <b>if</b> (<span class="r337 r">customResults</span> != <b>null</b>)
                {
                    <span class="r325 r">result</span>.<span class="i">AddRange</span>(<span class="r337 r">customResults</span>);
                    <span class="r325 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
                    <b>return</b>;
                }
            }
 
            <b>switch</b> (<span class="r323 r">commandName</span>)
            {
                <b>case</b> <span class="s">&quot;Get-Command&quot;</span>:
                    {
                        <b>if</b> (<span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;Module&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="#07df9dfac035c2f1" class="i method">NativeCompletionGetCommand</a>(<span class="r327 r">context</span>, <span class="c">/* moduleName: */</span> <b>null</b>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                            <b>break</b>;
                        }
 
                        <b>if</b> (<span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>var</b> <span id="r338 rd" class="r338 r">moduleNames</span> = <a href="#33f96c4967c48877" class="i method">NativeCommandArgumentCompletion_ExtractSecondaryArgument</a>(<span class="r328 r">boundArguments</span>, <span class="s">&quot;Module&quot;</span>);
 
                            <b>if</b> (<span class="r338 r">moduleNames</span>.<span class="i">Count</span> &gt; 0)
                            {
                                <b>foreach</b> (<b>string</b> <span id="r339 rd" class="r339 r">module</span> <b>in</b> <span class="r338 r">moduleNames</span>)
                                {
                                    <a href="#07df9dfac035c2f1" class="i method">NativeCompletionGetCommand</a>(<span class="r327 r">context</span>, <span class="r339 r">module</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                                }
                            }
                            <b>else</b>
                            {
                                <a href="#07df9dfac035c2f1" class="i method">NativeCompletionGetCommand</a>(<span class="r327 r">context</span>, <span class="c">/* moduleName: */</span> <b>null</b>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                            }
 
                            <b>break</b>;
                        }
 
                        <b>if</b> (<span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;ParameterType&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="#0856cf0848606af5" class="i method">NativeCompletionTypeName</a>(<span class="r327 r">context</span>, <span class="r325 r">result</span>);
                            <b>break</b>;
                        }
 
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Show-Command&quot;</span>:
                    {
                        <a href="#2cd83401a5a83fe6" class="i method">NativeCompletionGetHelpCommand</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="c">/* isHelpRelated: */</span> <b>false</b>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;help&quot;</span>:
                <b>case</b> <span class="s">&quot;Get-Help&quot;</span>:
                    {
                        <a href="#2cd83401a5a83fe6" class="i method">NativeCompletionGetHelpCommand</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="c">/* isHelpRelated: */</span> <b>true</b>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Invoke-Expression&quot;</span>:
                    {
                        <b>if</b> (<span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;Command&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>var</b> <span id="r340 rd" class="r340 r">commandResults</span> = <a href="#8ad3630ff3ff385a" class="i method">CompleteCommand</a>(<span class="r327 r">context</span>);
                            <b>if</b> (<span class="r340 r">commandResults</span> != <b>null</b>)
                                <span class="r325 r">result</span>.<span class="i">AddRange</span>(<span class="r340 r">commandResults</span>);
                        }
 
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Clear-EventLog&quot;</span>:
                <b>case</b> <span class="s">&quot;Get-EventLog&quot;</span>:
                <b>case</b> <span class="s">&quot;Limit-EventLog&quot;</span>:
                <b>case</b> <span class="s">&quot;Remove-EventLog&quot;</span>:
                <b>case</b> <span class="s">&quot;Write-EventLog&quot;</span>:
                    {
                        <a href="#8ddbf4a217aec33e" class="i method">NativeCompletionEventLogCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Get-Job&quot;</span>:
                <b>case</b> <span class="s">&quot;Receive-Job&quot;</span>:
                <b>case</b> <span class="s">&quot;Remove-Job&quot;</span>:
                <b>case</b> <span class="s">&quot;Stop-Job&quot;</span>:
                <b>case</b> <span class="s">&quot;Wait-Job&quot;</span>:
                <b>case</b> <span class="s">&quot;Suspend-Job&quot;</span>:
                <b>case</b> <span class="s">&quot;Resume-Job&quot;</span>:
                    {
                        <a href="#32323e118cf66419" class="i method">NativeCompletionJobCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Disable-ScheduledJob&quot;</span>:
                <b>case</b> <span class="s">&quot;Enable-ScheduledJob&quot;</span>:
                <b>case</b> <span class="s">&quot;Get-ScheduledJob&quot;</span>:
                <b>case</b> <span class="s">&quot;Unregister-ScheduledJob&quot;</span>:
                    {
                        <a href="#e750f8aa9a10e980" class="i method">NativeCompletionScheduledJobCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Get-Module&quot;</span>:
                    {
                        <b>bool</b> <span id="r341 rd" class="r341 r">loadedModulesOnly</span> = <span class="r328 r">boundArguments</span> == <b>null</b> || !<span class="r328 r">boundArguments</span>.<span class="i">ContainsKey</span>(<span class="s">&quot;ListAvailable&quot;</span>);
                        <b>bool</b> <span id="r342 rd" class="r342 r">skipEditionCheck</span> = !<span class="r341 r">loadedModulesOnly</span> &amp;&amp; <span class="r328 r">boundArguments</span>.<span class="i">ContainsKey</span>(<span class="s">&quot;SkipEditionCheck&quot;</span>);
                        <a href="#a1aef215dcaf182e" class="i method">NativeCompletionModuleCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>, <span class="r341 r">loadedModulesOnly</span>, <span class="r343 r">skipEditionCheck</span>: <span class="r342 r">skipEditionCheck</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Remove-Module&quot;</span>:
                    {
                        <a href="#a1aef215dcaf182e" class="i method">NativeCompletionModuleCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>, <span class="r344 r">loadedModulesOnly</span>: <b>true</b>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Import-Module&quot;</span>:
                    {
                        <b>bool</b> <span id="r345 rd" class="r345 r">skipEditionCheck</span> = <span class="r328 r">boundArguments</span> != <b>null</b> &amp;&amp; <span class="r328 r">boundArguments</span>.<span class="i">ContainsKey</span>(<span class="s">&quot;SkipEditionCheck&quot;</span>);
                        <a href="#a1aef215dcaf182e" class="i method">NativeCompletionModuleCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>, <span class="r346 r">isImportModule</span>: <b>true</b>, <span class="r343 r">skipEditionCheck</span>: <span class="r345 r">skipEditionCheck</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Debug-Process&quot;</span>:
                <b>case</b> <span class="s">&quot;Get-Process&quot;</span>:
                <b>case</b> <span class="s">&quot;Stop-Process&quot;</span>:
                <b>case</b> <span class="s">&quot;Wait-Process&quot;</span>:
                <b>case</b> <span class="s">&quot;Enter-PSHostProcess&quot;</span>:
                    {
                        <a href="#9bfa16923bc282cc" class="i method">NativeCompletionProcessCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Get-PSDrive&quot;</span>:
                <b>case</b> <span class="s">&quot;Remove-PSDrive&quot;</span>:
                    {
                        <b>if</b> (<span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;PSProvider&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="#05dbbd089189736c" class="i method">NativeCompletionProviderCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        }
                        <b>else</b> <b>if</b> (<span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>var</b> <span id="r347 rd" class="r347 r">psProviders</span> = <a href="#33f96c4967c48877" class="i method">NativeCommandArgumentCompletion_ExtractSecondaryArgument</a>(<span class="r328 r">boundArguments</span>, <span class="s">&quot;PSProvider&quot;</span>);
                            <b>if</b> (<span class="r347 r">psProviders</span>.<span class="i">Count</span> &gt; 0)
                            {
                                <b>foreach</b> (<b>string</b> <span id="r348 rd" class="r348 r">psProvider</span> <b>in</b> <span class="r347 r">psProviders</span>)
                                {
                                    <a href="#eb650d5c84dfb904" class="i method">NativeCompletionDriveCommands</a>(<span class="r327 r">context</span>, <span class="r348 r">psProvider</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                                }
                            }
                            <b>else</b>
                            {
                                <a href="#eb650d5c84dfb904" class="i method">NativeCompletionDriveCommands</a>(<span class="r327 r">context</span>, <span class="c">/* psProvider: */</span> <b>null</b>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                            }
                        }
 
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;New-PSDrive&quot;</span>:
                    {
                        <a href="#05dbbd089189736c" class="i method">NativeCompletionProviderCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Get-PSProvider&quot;</span>:
                    {
                        <a href="#05dbbd089189736c" class="i method">NativeCompletionProviderCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Get-Service&quot;</span>:
                <b>case</b> <span class="s">&quot;Start-Service&quot;</span>:
                <b>case</b> <span class="s">&quot;Restart-Service&quot;</span>:
                <b>case</b> <span class="s">&quot;Resume-Service&quot;</span>:
                <b>case</b> <span class="s">&quot;Set-Service&quot;</span>:
                <b>case</b> <span class="s">&quot;Stop-Service&quot;</span>:
                <b>case</b> <span class="s">&quot;Suspend-Service&quot;</span>:
                    {
                        <a href="#858a78bdb80c8624" class="i method">NativeCompletionServiceCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Clear-Variable&quot;</span>:
                <b>case</b> <span class="s">&quot;Get-Variable&quot;</span>:
                <b>case</b> <span class="s">&quot;Remove-Variable&quot;</span>:
                <b>case</b> <span class="s">&quot;Set-Variable&quot;</span>:
                    {
                        <a href="#bb4f4093b72dafd1" class="i method">NativeCompletionVariableCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Get-Alias&quot;</span>:
                    {
                        <a href="#3d79170f5dc142f2" class="i method">NativeCompletionAliasCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Get-TraceSource&quot;</span>:
                <b>case</b> <span class="s">&quot;Set-TraceSource&quot;</span>:
                <b>case</b> <span class="s">&quot;Trace-Command&quot;</span>:
                    {
                        <a href="#83d2665d87f94531" class="i method">NativeCompletionTraceSourceCommands</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Push-Location&quot;</span>:
                <b>case</b> <span class="s">&quot;Set-Location&quot;</span>:
                    {
                        <a href="#2d16f58d09ee8e5a" class="i method">NativeCompletionSetLocationCommand</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Move-Item&quot;</span>:
                <b>case</b> <span class="s">&quot;Copy-Item&quot;</span>:
                    {
                        <a href="#cb4fb4800dfc9583" class="i method">NativeCompletionCopyMoveItemCommand</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;New-Item&quot;</span>:
                    {
                        <a href="#cfade976d0dbf7f9" class="i method">NativeCompletionNewItemCommand</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;ForEach-Object&quot;</span>:
                    {
                        <b>if</b> (<span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;MemberName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="#1cd0bbbf57ec35bd" class="i method">NativeCompletionMemberName</a>(<span class="r327 r">context</span>, <span class="r325 r">result</span>, <span class="r326 r">commandAst</span>);
                        }
 
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Group-Object&quot;</span>:
                <b>case</b> <span class="s">&quot;Measure-Object&quot;</span>:
                <b>case</b> <span class="s">&quot;Sort-Object&quot;</span>:
                <b>case</b> <span class="s">&quot;Where-Object&quot;</span>:
                    {
                        <b>if</b> (<span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;Property&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="#1cd0bbbf57ec35bd" class="i method">NativeCompletionMemberName</a>(<span class="r327 r">context</span>, <span class="r325 r">result</span>, <span class="r326 r">commandAst</span>);
                        }
 
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Format-Custom&quot;</span>:
                <b>case</b> <span class="s">&quot;Format-List&quot;</span>:
                <b>case</b> <span class="s">&quot;Format-Table&quot;</span>:
                <b>case</b> <span class="s">&quot;Format-Wide&quot;</span>:
                    {
                        <b>if</b> (<span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;Property&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="#1cd0bbbf57ec35bd" class="i method">NativeCompletionMemberName</a>(<span class="r327 r">context</span>, <span class="r325 r">result</span>, <span class="r326 r">commandAst</span>);
                        }
                        <b>else</b> <b>if</b> (<span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;View&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="#1e38d0227f2fba69" class="i method">NativeCompletionFormatViewName</a>(<span class="r327 r">context</span>, <span class="r328 r">boundArguments</span>, <span class="r325 r">result</span>, <span class="r326 r">commandAst</span>, <span class="r323 r">commandName</span>);
                        }
 
                        <b>break</b>;
                    }
                <b>case</b> <span class="s">&quot;Select-Object&quot;</span>:
                    {
                        <b>if</b> (<span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;Property&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                         || <span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;ExcludeProperty&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                         || <span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;ExpandProperty&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="#1cd0bbbf57ec35bd" class="i method">NativeCompletionMemberName</a>(<span class="r327 r">context</span>, <span class="r325 r">result</span>, <span class="r326 r">commandAst</span>);
                        }
 
                        <b>break</b>;
                    }
 
                <b>case</b> <span class="s">&quot;New-Object&quot;</span>:
                    {
                        <b>if</b> (<span class="r329 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;TypeName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="#0856cf0848606af5" class="i method">NativeCompletionTypeName</a>(<span class="r327 r">context</span>, <span class="r325 r">result</span>);
                        }
 
                        <b>break</b>;
                    }
 
                <b>case</b> <span class="s">&quot;Get-CimClass&quot;</span>:
                <b>case</b> <span class="s">&quot;Get-CimInstance&quot;</span>:
                <b>case</b> <span class="s">&quot;Get-CimAssociatedInstance&quot;</span>:
                <b>case</b> <span class="s">&quot;Invoke-CimMethod&quot;</span>:
                <b>case</b> <span class="s">&quot;New-CimInstance&quot;</span>:
                <b>case</b> <span class="s">&quot;Register-CimIndicationEvent&quot;</span>:
                    {
                        <a href="#e019deedbbf28601" class="i method">NativeCompletionCimCommands</a>(<span class="r329 r">parameterName</span>, <span class="r328 r">boundArguments</span>, <span class="r325 r">result</span>, <span class="r326 r">commandAst</span>, <span class="r327 r">context</span>);
                        <b>break</b>;
                    }
 
                <b>default</b>:
                    {
                        <a href="#bebbae3048899f74" class="i method">NativeCompletionPathArgument</a>(<span class="r327 r">context</span>, <span class="r329 r">parameterName</span>, <span class="r325 r">result</span>);
                        <b>break</b>;
                    }
            }
        }
 
        <b>private static</b> <span class="i">Hashtable</span> <a id="e89db5ccd9fe157e" href="../../R/e89db5ccd9fe157e.html" target="n" data-glyph="76,1" class="i method">GetBoundArgumentsAsHashtable</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r349 rd" class="r349 r">context</span>)
        {
            <b>var</b> <span id="r350 rd" class="r350 r">result</span> = <b>new</b> <span class="i">Hashtable</span>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>if</b> (<span class="r349 r">context</span>.<a href="CompletionAnalysis.cs.html#aa0594eac663bfde" class="i property">PseudoBindingInfo</a> != <b>null</b>)
            {
                <b>var</b> <span id="r351 rd" class="r351 r">boundArguments</span> = <span class="r349 r">context</span>.<a href="CompletionAnalysis.cs.html#aa0594eac663bfde" class="i property">PseudoBindingInfo</a>.<a href="PseudoParameterBinder.cs.html#0890fafe524fd733" class="i property">BoundArguments</a>;
                <b>if</b> (<span class="r351 r">boundArguments</span> != <b>null</b>)
                {
                    <b>foreach</b> (<b>var</b> <span id="r352 rd" class="r352 r">boundArgument</span> <b>in</b> <span class="r351 r">boundArguments</span>)
                    {
                        <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="k">var</a> <span id="r353 rd" class="r353 r">astPair</span> = <span class="r352 r">boundArgument</span>.<span class="i">Value</span> <b>as</b> <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a>;
                        <b>if</b> (<span class="r353 r">astPair</span> != <b>null</b>)
                        {
                            <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="k">var</a> <span id="r354 rd" class="r354 r">parameterAst</span> = <span class="r353 r">astPair</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a> <b>as</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>;
                            <a href="../parser/ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r355 rd" class="r355 r">exprAst</span> = <span class="r354 r">parameterAst</span> != <b>null</b>
                                              ? <span class="r354 r">parameterAst</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a>
                                              : <span class="r353 r">astPair</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a> <b>as</b> <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>;
                            <b>object</b> <span id="r356 rd" class="r356 r">value</span>;
                            <b>if</b> (<span class="r355 r">exprAst</span> != <b>null</b> &amp;&amp; <a href="#734c1ec38d499153" class="t t">SafeExprEvaluator</a>.<a href="#f61f6e9c4ea81b8b" class="i method">TrySafeEval</a>(<span class="r355 r">exprAst</span>, <span class="r349 r">context</span>.<a href="CompletionAnalysis.cs.html#4055c622a2008ac8" class="i property">ExecutionContext</a>, <b>out</b> <span class="r356 r">value</span>))
                            {
                                <span class="r350 r">result</span>[<span class="r352 r">boundArgument</span>.<span class="i">Key</span>] = <span class="r356 r">value</span>;
                            }
 
                            <b>continue</b>;
                        }
 
                        <a href="PseudoParameterBinder.cs.html#4eb6fcc40752a8a5" class="k">var</a> <span id="r357 rd" class="r357 r">switchPair</span> = <span class="r352 r">boundArgument</span>.<span class="i">Value</span> <b>as</b> <a href="PseudoParameterBinder.cs.html#4eb6fcc40752a8a5" class="t t">SwitchPair</a>;
                        <b>if</b> (<span class="r357 r">switchPair</span> != <b>null</b>)
                        {
                            <span class="r350 r">result</span>[<span class="r352 r">boundArgument</span>.<span class="i">Key</span>] = <span class="r357 r">switchPair</span>.<a href="PseudoParameterBinder.cs.html#92fcffd9c834f7dd" class="i property">Argument</a>;
                            <b>continue</b>;
                        }
                        <span class="c">// Ignored:</span>
                        <span class="c">//     AstArrayPair - only used for ValueFromRemainingArguments, not that useful for tab completion</span>
                        <span class="c">//     FakePair - missing argument, not that useful</span>
                        <span class="c">//     PipeObjectPair - no actual argument, makes for a poor api</span>
                    }
                }
            }
 
            <b>return</b> <span class="r350 r">result</span>;
        }
 
        <b>private static</b> <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="8548cd11eb899ac5" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetCustomArgumentCompleter</a>(
            <b>string</b> <span id="r358 rd" class="r358 r">optionKey</span>,
            <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r359 rd" class="r359 r">keys</span>,
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r360 rd" class="r360 r">context</span>)
        {
            <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r361 rd" class="r361 r">scriptBlock</span>;
            <b>var</b> <span id="r362 rd" class="r362 r">options</span> = <span class="r360 r">context</span>.<a href="CompletionAnalysis.cs.html#f3f4d193708c896f" class="i property">Options</a>;
            <b>if</b> (<span class="r362 r">options</span> != <b>null</b>)
            {
                <b>var</b> <span id="r363 rd" class="r363 r">customCompleters</span> = <span class="r362 r">options</span>[<span class="r358 r">optionKey</span>] <b>as</b> <span class="i">Hashtable</span>;
                <b>if</b> (<span class="r363 r">customCompleters</span> != <b>null</b>)
                {
                    <b>foreach</b> (<b>var</b> <span id="r364 rd" class="r364 r">key</span> <b>in</b> <span class="r359 r">keys</span>)
                    {
                        <b>if</b> (<span class="r363 r">customCompleters</span>.<span class="i">ContainsKey</span>(<span class="r364 r">key</span>))
                        {
                            <span class="r361 r">scriptBlock</span> = <span class="r363 r">customCompleters</span>[<span class="r364 r">key</span>] <b>as</b> <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>;
                            <b>if</b> (<span class="r361 r">scriptBlock</span> != <b>null</b>)
                                <b>return</b> <span class="r361 r">scriptBlock</span>;
                        }
                    }
                }
            }
 
            <b>var</b> <span id="r365 rd" class="r365 r">registeredCompleters</span> = <span class="r358 r">optionKey</span>.<span class="i">Equals</span>(<span class="s">&quot;NativeArgumentCompleters&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                ? <span class="r360 r">context</span>.<a href="CompletionAnalysis.cs.html#e6b0eb9fc41f5838" class="i property">NativeArgumentCompleters</a>
                : <span class="r360 r">context</span>.<a href="CompletionAnalysis.cs.html#d7d397e503f13ffb" class="i property">CustomArgumentCompleters</a>;
 
            <b>if</b> (<span class="r365 r">registeredCompleters</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>var</b> <span id="r366 rd" class="r366 r">key</span> <b>in</b> <span class="r359 r">keys</span>)
                {
                    <b>if</b> (<span class="r365 r">registeredCompleters</span>.<span class="i">TryGetValue</span>(<span class="r366 r">key</span>, <b>out</b> <span class="r361 r">scriptBlock</span>))
                    {
                        <b>return</b> <span class="r361 r">scriptBlock</span>;
                    }
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static bool</b> <a id="f39ca631290ea7db" href="../../R/f39ca631290ea7db.html" target="n" data-glyph="76,1" class="i method">InvokeScriptArgumentCompleter</a>(
            <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r367 rd" class="r367 r">scriptBlock</span>,
            <b>string</b> <span id="r368 rd" class="r368 r">commandName</span>,
            <b>string</b> <span id="r369 rd" class="r369 r">parameterName</span>,
            <b>string</b> <span id="r370 rd" class="r370 r">wordToComplete</span>,
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r371 rd" class="r371 r">commandAst</span>,
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r372 rd" class="r372 r">context</span>,
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r373 rd" class="r373 r">resultList</span>)
        {
            <b>bool</b> <span id="r374 rd" class="r374 r">result</span> = <a href="#c75827f28cced0ec" class="i method">InvokeScriptArgumentCompleter</a>(
                <span class="r367 r">scriptBlock</span>,
                <b>new</b> <b>object</b>[] { <span class="r368 r">commandName</span>, <span class="r369 r">parameterName</span>, <span class="r370 r">wordToComplete</span>, <span class="r371 r">commandAst</span>, <a href="#e89db5ccd9fe157e" class="i method">GetBoundArgumentsAsHashtable</a>(<span class="r372 r">context</span>) },
                <span class="r373 r">resultList</span>);
            <b>if</b> (<span class="r374 r">result</span>)
            {
                <span class="r373 r">resultList</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
 
            <b>return</b> <span class="r374 r">result</span>;
        }
 
        <b>private static bool</b> <a id="c75827f28cced0ec" href="../../R/c75827f28cced0ec.html" target="n" data-glyph="76,1" class="i method">InvokeScriptArgumentCompleter</a>(
            <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <span id="r375 rd" class="r375 r">scriptBlock</span>,
            <b>object</b>[] <span id="r376 rd" class="r376 r">argumentsToCompleter</span>,
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r377 rd" class="r377 r">result</span>)
        {
            <span class="i">Collection</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r378 rd" class="r378 r">customResults</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r378 r">customResults</span> = <span class="r375 r">scriptBlock</span>.<a href="../lang/scriptblock.cs.html#3f6b9284eb08b880" class="i method">Invoke</a>(<span class="r376 r">argumentsToCompleter</span>);
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
            }
 
            <b>if</b> (<span class="r378 r">customResults</span> == <b>null</b> || <span class="r378 r">customResults</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>foreach</b> (<b>var</b> <span id="r379 rd" class="r379 r">customResult</span> <b>in</b> <span class="r378 r">customResults</span>)
            {
                <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="k">var</a> <span id="r380 rd" class="r380 r">resultAsCompletion</span> = <span class="r379 r">customResult</span>.<span class="i">BaseObject</span> <b>as</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>;
                <b>if</b> (<span class="r380 r">resultAsCompletion</span> != <b>null</b>)
                {
                    <span class="r377 r">result</span>.<span class="i">Add</span>(<span class="r380 r">resultAsCompletion</span>);
                    <b>continue</b>;
                }
 
                <b>var</b> <span id="r381 rd" class="r381 r">resultAsString</span> = <span class="r379 r">customResult</span>.<span class="i">ToString</span>();
                <span class="r377 r">result</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(<span class="r381 r">resultAsString</span>));
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <span class="c">// All the methods for native command argument completion will add a null instance of the type CompletionResult to the end of the</span>
        <span class="c">// &quot;result&quot; list, to indicate that this particular argument completion has fallen into one of the native command argument completion methods,</span>
        <span class="c">// and has been processed already. So if the &quot;result&quot; list is still empty afterward, we will not go through the default argument completion anymore.</span>
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Native Command Argument Completion
 
        <b>private static void</b> <a id="67d6affee43a8461" href="../../R/67d6affee43a8461.html" target="n" data-glyph="76,1" class="i method">RemoveLastNullCompletionResult</a>(<span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r382 rd" class="r382 r">result</span>)
        {
            <b>if</b> (<span class="r382 r">result</span>.<span class="i">Count</span> &gt; 0 &amp;&amp; <span class="r382 r">result</span>[<span class="r382 r">result</span>.<span class="i">Count</span> - 1].<span class="i">Equals</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>))
            {
                <span class="r382 r">result</span>.<span class="i">RemoveAt</span>(<span class="r382 r">result</span>.<span class="i">Count</span> - 1);
            }
        }
 
        <b>private static void</b> <a id="e019deedbbf28601" href="../../R/e019deedbbf28601.html" target="n" data-glyph="76,1" class="i method">NativeCompletionCimCommands</a>(
            <b>string</b> <span id="r383 rd" class="r383 r">parameter</span>,
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r384 rd" class="r384 r">boundArguments</span>,
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r385 rd" class="r385 r">result</span>,
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r386 rd" class="r386 r">commandAst</span>,
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r387 rd" class="r387 r">context</span>)
        {
            <b>if</b> (<span class="r384 r">boundArguments</span> != <b>null</b>)
            {
                <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r388 rd" class="r388 r">astParameterArgumentPair</span>;
                <b>if</b> ((<span class="r384 r">boundArguments</span>.<span class="i">TryGetValue</span>(<span class="s">&quot;ComputerName&quot;</span>, <b>out</b> <span class="r388 r">astParameterArgumentPair</span>)
                     || <span class="r384 r">boundArguments</span>.<span class="i">TryGetValue</span>(<span class="s">&quot;CimSession&quot;</span>, <b>out</b> <span class="r388 r">astParameterArgumentPair</span>))
                    &amp;&amp; <span class="r388 r">astParameterArgumentPair</span> != <b>null</b>)
                {
                    <b>switch</b> (<span class="r388 r">astParameterArgumentPair</span>.<a href="PseudoParameterBinder.cs.html#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a>)
                    {
                        <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#ac5fbd8418f369ff" class="i field">PipeObject</a>:
                        <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#9aaa905ba785afb7" class="i field">Fake</a>:
                            <b>break</b>;
 
                        <b>default</b>:
                            <b>return</b>; <span class="c">// we won&#39;t tab-complete remote class names</span>
                    }
                }
            }
 
            <b>if</b> (<span class="r383 r">parameter</span>.<span class="i">Equals</span>(<span class="s">&quot;Namespace&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#9c5f60a2bf00c130" class="i method">NativeCompletionCimNamespace</a>(<span class="r385 r">result</span>, <span class="r387 r">context</span>);
                <span class="r385 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
                <b>return</b>;
            }
 
            <b>string</b> <span id="r389 rd" class="r389 r">pseudoboundCimNamespace</span> = <a href="#33f96c4967c48877" class="i method">NativeCommandArgumentCompletion_ExtractSecondaryArgument</a>(<span class="r384 r">boundArguments</span>, <span class="s">&quot;Namespace&quot;</span>).<span class="i">FirstOrDefault</span>();
            <b>if</b> (<span class="r383 r">parameter</span>.<span class="i">Equals</span>(<span class="s">&quot;ClassName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#0fad5f497189b1d0" class="i method">NativeCompletionCimClassName</a>(<span class="r389 r">pseudoboundCimNamespace</span>, <span class="r385 r">result</span>, <span class="r387 r">context</span>);
                <span class="r385 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
                <b>return</b>;
            }
 
            <b>bool</b> <span id="r390 rd" class="r390 r">gotInstance</span> = <b>false</b>;
            <span class="i">IEnumerable</span>&lt;<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt; <span id="r391 rd" class="r391 r">cimClassTypeNames</span> = <b>null</b>;
            <b>string</b> <span id="r392 rd" class="r392 r">pseudoboundClassName</span> = <a href="#33f96c4967c48877" class="i method">NativeCommandArgumentCompletion_ExtractSecondaryArgument</a>(<span class="r384 r">boundArguments</span>, <span class="s">&quot;ClassName&quot;</span>).<span class="i">FirstOrDefault</span>();
            <b>if</b> (<span class="r392 r">pseudoboundClassName</span> != <b>null</b>)
            {
                <span class="r390 r">gotInstance</span> = <b>false</b>;
                <b>var</b> <span id="r393 rd" class="r393 r">tmp</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt;();
                <span class="r393 r">tmp</span>.<span class="i">Add</span>(<b>new</b> <span class="t">PSTypeName</span>(<b>typeof</b>(<span class="i">CimInstance</span>).<span class="i">FullName</span> + <span class="s">&quot;#&quot;</span> + (<span class="r389 r">pseudoboundCimNamespace</span> ?? <span class="s">&quot;root/cimv2&quot;</span>) + <span class="s">&quot;/&quot;</span> + <span class="r392 r">pseudoboundClassName</span>));
                <span class="r391 r">cimClassTypeNames</span> = <span class="r393 r">tmp</span>;
            }
            <b>else</b> <b>if</b> (<span class="r384 r">boundArguments</span> != <b>null</b> &amp;&amp; <span class="r384 r">boundArguments</span>.<span class="i">ContainsKey</span>(<span class="s">&quot;InputObject&quot;</span>))
            {
                <span class="r390 r">gotInstance</span> = <b>true</b>;
                <span class="r391 r">cimClassTypeNames</span> = <a href="#b0cb9c13674b4be8" class="i method">NativeCommandArgumentCompletion_InferTypesOfArgument</a>(<span class="r384 r">boundArguments</span>, <span class="r386 r">commandAst</span>, <span class="r387 r">context</span>, <span class="s">&quot;InputObject&quot;</span>);
            }
 
            <b>if</b> (<span class="r391 r">cimClassTypeNames</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a> <span id="r394 rd" class="r394 r">typeName</span> <b>in</b> <span class="r391 r">cimClassTypeNames</span>)
                {
                    <b>if</b> (<a href="../parser/TypeInferenceVisitor.cs.html#475e6219e3f308ae" class="t t">TypeInferenceContext</a>.<a href="../parser/TypeInferenceVisitor.cs.html#70727e577f7e051c" class="i method">ParseCimCommandsTypeName</a>(<span class="r394 r">typeName</span>, <b>out</b> <span class="r389 r">pseudoboundCimNamespace</span>, <b>out</b> <span class="r392 r">pseudoboundClassName</span>))
                    {
                        <b>if</b> (<span class="r383 r">parameter</span>.<span class="i">Equals</span>(<span class="s">&quot;ResultClassName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <a href="#d2db8190d0abcae1" class="i method">NativeCompletionCimAssociationResultClassName</a>(<span class="r389 r">pseudoboundCimNamespace</span>, <span class="r392 r">pseudoboundClassName</span>, <span class="r385 r">result</span>, <span class="r387 r">context</span>);
                        }
                        <b>else</b> <b>if</b> (<span class="r383 r">parameter</span>.<span class="i">Equals</span>(<span class="s">&quot;MethodName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="i">NativeCompletionCimMethodName</span>(<span class="r389 r">pseudoboundCimNamespace</span>, <span class="r392 r">pseudoboundClassName</span>, !<span class="r390 r">gotInstance</span>, <span class="r385 r">result</span>, <span class="r387 r">context</span>);
                        }
                    }
                }
 
                <span class="r385 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
        }
 
        <b>private static readonly</b> <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <span class="i">IEnumerable</span>&lt;<b>string</b>&gt;&gt; <a id="a46180f532c686ab" href="../../R/a46180f532c686ab.html" target="n" data-glyph="46,1" class="i field">s_cimNamespaceAndClassNameToAssociationResultClassNames</a> =
            <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <span class="i">IEnumerable</span>&lt;<b>string</b>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <b>private static</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="0a7cb64be78f14da" href="../../R/0a7cb64be78f14da.html" target="n" data-glyph="76,1" class="i method">NativeCompletionCimAssociationResultClassName_GetResultClassNames</a>(
            <b>string</b> <span id="r395 rd" class="r395 r">cimNamespaceOfSource</span>,
            <b>string</b> <span id="r396 rd" class="r396 r">cimClassNameOfSource</span>)
        {
            <span class="i">StringBuilder</span> <span id="r397 rd" class="r397 r">safeClassName</span> = <b>new</b> <span class="i">StringBuilder</span>();
            <b>foreach</b> (<b>char</b> <span id="r398 rd" class="r398 r">c</span> <b>in</b> <span class="r396 r">cimClassNameOfSource</span>)
            {
                <b>if</b> (<b>char</b>.<span class="i">IsLetterOrDigit</span>(<span class="r398 r">c</span>) || <span class="r398 r">c</span> == <span class="s">&#39;_&#39;</span>)
                {
                    <span class="r397 r">safeClassName</span>.<span class="i">Append</span>(<span class="r398 r">c</span>);
                }
            }
 
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r399 rd" class="r399 r">resultClassNames</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <b>using</b> (<b>var</b> <span id="r400 rd" class="r400 r">cimSession</span> = <span class="i">CimSession</span>.<span class="i">Create</span>(<b>null</b>))
            {
                <span class="i">CimClass</span> <span id="r401 rd" class="r401 r">cimClass</span> = <span class="r400 r">cimSession</span>.<span class="i">GetClass</span>(<span class="r395 r">cimNamespaceOfSource</span> ?? <span class="s">&quot;root/cimv2&quot;</span>, <span class="r396 r">cimClassNameOfSource</span>);
                <b>while</b> (<span class="r401 r">cimClass</span> != <b>null</b>)
                {
                    <b>string</b> <span id="r402 rd" class="r402 r">query</span> = <b>string</b>.<span class="i">Format</span>(
                        <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>,
                        <span class="s">&quot;associators of {{{0}}} WHERE SchemaOnly&quot;</span>,
                        <span class="r401 r">cimClass</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>);
 
                    <span class="r399 r">resultClassNames</span>.<span class="i">AddRange</span>(
                        <span class="r400 r">cimSession</span>.<span class="i">QueryInstances</span>(<span class="r395 r">cimNamespaceOfSource</span> ?? <span class="s">&quot;root/cimv2&quot;</span>, <span class="s">&quot;WQL&quot;</span>, <span class="r402 r">query</span>)
                            .<span class="i">Select</span>(<b>static</b> <span id="r403 rd" class="r403 r">associationInstance</span> =&gt; <span class="r403 r">associationInstance</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>));
 
                    <span class="r401 r">cimClass</span> = <span class="r401 r">cimClass</span>.<span class="i">CimSuperClass</span>;
                }
            }
 
            <span class="r399 r">resultClassNames</span>.<span class="i">Sort</span>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <b>return</b> <span class="r399 r">resultClassNames</span>.<span class="i">Distinct</span>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>).<span class="i">ToList</span>();
        }
 
        <b>private static void</b> <a id="d2db8190d0abcae1" href="../../R/d2db8190d0abcae1.html" target="n" data-glyph="76,1" class="i method">NativeCompletionCimAssociationResultClassName</a>(
            <b>string</b> <span id="r404 rd" class="r404 r">pseudoboundNamespace</span>,
            <b>string</b> <span id="r405 rd" class="r405 r">pseudoboundClassName</span>,
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r406 rd" class="r406 r">result</span>,
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r407 rd" class="r407 r">context</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r405 r">pseudoboundClassName</span>))
            {
                <b>return</b>;
            }
 
            <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r408 rd" class="r408 r">resultClassNames</span> = <a href="#a46180f532c686ab" class="i field">s_cimNamespaceAndClassNameToAssociationResultClassNames</a>.<span class="i">GetOrAdd</span>(
                (<span class="r404 r">pseudoboundNamespace</span> ?? <span class="s">&quot;root/cimv2&quot;</span>) + <span class="s">&quot;:&quot;</span> + <span class="r405 r">pseudoboundClassName</span>,
                <span id="r409 rd" class="r409 r">_</span> =&gt; <a href="#0a7cb64be78f14da" class="i method">NativeCompletionCimAssociationResultClassName_GetResultClassNames</a>(<span class="r404 r">pseudoboundNamespace</span>, <span class="r405 r">pseudoboundClassName</span>));
 
            <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r410 rd" class="r410 r">resultClassNamePattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r407 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a> | <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#c83c96a47a1cc99d" class="i field">CultureInvariant</a>);
            <span class="r406 r">result</span>.<span class="i">AddRange</span>(<span class="r408 r">resultClassNames</span>
                .<span class="i">Where</span>(<span class="r410 r">resultClassNamePattern</span>.<span class="i">IsMatch</span>)
                .<span class="i">Select</span>(<span id="r411 rd" class="r411 r">x</span> =&gt; <b>new</b> <span class="t">CompletionResult</span>(<span class="r411 r">x</span>, <span class="r411 r">x</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#46005faf1cdef9c1" class="i field">Type</a>, <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;{0} -&gt; {1}&quot;</span>, <span class="r405 r">pseudoboundClassName</span>, <span class="r411 r">x</span>))));
        }
 
        <b>private static void</b> <a id="a7acdc286c1a5883" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NativeCompletionCimMethodName</a>(
            <b>string</b> <span id="r412 rd" class="r412 r">pseudoboundNamespace</span>,
            <b>string</b> <span id="r413 rd" class="r413 r">pseudoboundClassName</span>,
            <b>bool</b> <span id="r414 rd" class="r414 r">staticMethod</span>,
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r415 rd" class="r415 r">result</span>,
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r416 rd" class="r416 r">context</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r413 r">pseudoboundClassName</span>))
            {
                <b>return</b>;
            }
 
            <span class="i">CimClass</span> <span id="r417 rd" class="r417 r">cimClass</span>;
            <b>using</b> (<b>var</b> <span id="r418 rd" class="r418 r">cimSession</span> = <span class="i">CimSession</span>.<span class="i">Create</span>(<b>null</b>))
            {
                <span class="r417 r">cimClass</span> = <span class="r418 r">cimSession</span>.<span class="i">GetClass</span>(<span class="r412 r">pseudoboundNamespace</span> ?? <span class="s">&quot;root/cimv2&quot;</span>, <span class="r413 r">pseudoboundClassName</span>);
            }
 
            <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r419 rd" class="r419 r">methodNamePattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r416 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#c83c96a47a1cc99d" class="i field">CultureInvariant</a> | <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r420 rd" class="r420 r">localResults</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
            <b>foreach</b> (<span class="i">CimMethodDeclaration</span> <span id="r421 rd" class="r421 r">methodDeclaration</span> <b>in</b> <span class="r417 r">cimClass</span>.<span class="i">CimClassMethods</span>)
            {
                <b>string</b> <span id="r422 rd" class="r422 r">methodName</span> = <span class="r421 r">methodDeclaration</span>.<span class="i">Name</span>;
                <b>if</b> (!<span class="r419 r">methodNamePattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r422 r">methodName</span>))
                {
                    <b>continue</b>;
                }
 
                <b>bool</b> <span id="r423 rd" class="r423 r">currentMethodIsStatic</span> = <span class="r421 r">methodDeclaration</span>.<span class="i">Qualifiers</span>.<span class="i">Any</span>(<b>static</b> <span id="r424 rd" class="r424 r">q</span> =&gt; <span class="r424 r">q</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;Static&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
                <b>if</b> ((<span class="r423 r">currentMethodIsStatic</span> &amp;&amp; !<span class="r414 r">staticMethod</span>) || (!<span class="r423 r">currentMethodIsStatic</span> &amp;&amp; <span class="r414 r">staticMethod</span>))
                {
                    <b>continue</b>;
                }
 
                <span class="i">StringBuilder</span> <span id="r425 rd" class="r425 r">tooltipText</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <span class="r425 r">tooltipText</span>.<span class="i">Append</span>(<span class="r422 r">methodName</span>);
                <span class="r425 r">tooltipText</span>.<span class="i">Append</span>(<span class="s">&#39;(&#39;</span>);
                <b>bool</b> <span id="r426 rd" class="r426 r">gotFirstParameter</span> = <b>false</b>;
                <b>foreach</b> (<b>var</b> <span id="r427 rd" class="r427 r">methodParameter</span> <b>in</b> <span class="r421 r">methodDeclaration</span>.<span class="i">Parameters</span>)
                {
                    <b>bool</b> <span id="r428 rd" class="r428 r">outParameter</span> = <span class="r427 r">methodParameter</span>.<span class="i">Qualifiers</span>.<span class="i">Any</span>(<b>static</b> <span id="r429 rd" class="r429 r">q</span> =&gt; <span class="r429 r">q</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;Out&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
 
                    <b>if</b> (!<span class="r426 r">gotFirstParameter</span>)
                    {
                        <span class="r426 r">gotFirstParameter</span> = <b>true</b>;
                    }
                    <b>else</b>
                    {
                        <span class="r425 r">tooltipText</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                    }
 
                    <b>if</b> (<span class="r428 r">outParameter</span>)
                    {
                        <span class="r425 r">tooltipText</span>.<span class="i">Append</span>(<span class="s">&quot;[out] &quot;</span>);
                    }
 
                    <span class="r425 r">tooltipText</span>.<span class="i">Append</span>(<a href="../../cimSupport/other/ciminstancetypeadapter.cs.html#c0991a61473db1f8" class="t t">CimInstanceAdapter</a>.<span class="i">CimTypeToTypeNameDisplayString</span>(<span class="r427 r">methodParameter</span>.<span class="i">CimType</span>));
                    <span class="r425 r">tooltipText</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>);
                    <span class="r425 r">tooltipText</span>.<span class="i">Append</span>(<span class="r427 r">methodParameter</span>.<span class="i">Name</span>);
 
                    <b>if</b> (<span class="r428 r">outParameter</span>)
                    {
                        <b>continue</b>;
                    }
                }
 
                <span class="r425 r">tooltipText</span>.<span class="i">Append</span>(<span class="s">&#39;)&#39;</span>);
 
                <span class="r420 r">localResults</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(<span class="r422 r">methodName</span>, <span class="r422 r">methodName</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#389017ea02ead55a" class="i field">Method</a>, <span class="r425 r">tooltipText</span>.<span class="i">ToString</span>()));
            }
 
            <span class="r415 r">result</span>.<span class="i">AddRange</span>(<span class="r420 r">localResults</span>.<span class="i">OrderBy</span>(<b>static</b> <span id="r430 rd" class="r430 r">x</span> =&gt; <span class="r430 r">x</span>.<span class="i">ListItemText</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>));
        }
 
        <b>private static readonly</b> <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <span class="i">IEnumerable</span>&lt;<b>string</b>&gt;&gt; <a id="429215ef6fc48801" href="../../R/429215ef6fc48801.html" target="n" data-glyph="46,1" class="i field">s_cimNamespaceToClassNames</a> =
            <b>new</b> <span class="i">ConcurrentDictionary</span>&lt;<b>string</b>, <span class="i">IEnumerable</span>&lt;<b>string</b>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <b>private static</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="6f0bbca79dd9fb3b" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NativeCompletionCimClassName_GetClassNames</a>(<b>string</b> <span id="r431 rd" class="r431 r">targetNamespace</span>)
        {
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r432 rd" class="r432 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <b>using</b> (<span class="i">CimSession</span> <span id="r433 rd" class="r433 r">cimSession</span> = <span class="i">CimSession</span>.<span class="i">Create</span>(<b>null</b>))
            {
                <b>using</b> (<b>var</b> <span id="r434 rd" class="r434 r">operationOptions</span> = <b>new</b> <span class="i">CimOperationOptions</span> { <span class="i">ClassNamesOnly</span> = <b>true</b> })
                    <b>foreach</b> (<span class="i">CimClass</span> <span id="r435 rd" class="r435 r">cimClass</span> <b>in</b> <span class="r433 r">cimSession</span>.<span class="i">EnumerateClasses</span>(<span class="r431 r">targetNamespace</span>, <b>null</b>, <span class="r434 r">operationOptions</span>))
                        <b>using</b> (<span class="r435 r">cimClass</span>)
                        {
                            <b>string</b> <span id="r436 rd" class="r436 r">className</span> = <span class="r435 r">cimClass</span>.<span class="i">CimSystemProperties</span>.<span class="i">ClassName</span>;
                            <span class="r432 r">result</span>.<span class="i">Add</span>(<span class="r436 r">className</span>);
                        }
            }
 
            <b>return</b> <span class="r432 r">result</span>;
        }
 
        <b>private static void</b> <a id="0fad5f497189b1d0" href="../../R/0fad5f497189b1d0.html" target="n" data-glyph="76,1" class="i method">NativeCompletionCimClassName</a>(
            <b>string</b> <span id="r437 rd" class="r437 r">pseudoBoundNamespace</span>,
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r438 rd" class="r438 r">result</span>,
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r439 rd" class="r439 r">context</span>)
        {
            <b>string</b> <span id="r440 rd" class="r440 r">targetNamespace</span> = <span class="r437 r">pseudoBoundNamespace</span> ?? <span class="s">&quot;root/cimv2&quot;</span>;
 
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r441 rd" class="r441 r">regularClasses</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r442 rd" class="r442 r">systemClasses</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
            <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r443 rd" class="r443 r">allClasses</span> = <a href="#429215ef6fc48801" class="i field">s_cimNamespaceToClassNames</a>.<span class="i">GetOrAdd</span>(
                <span class="r440 r">targetNamespace</span>,
                <span class="i">NativeCompletionCimClassName_GetClassNames</span>);
            <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r444 rd" class="r444 r">classNamePattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r439 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#c83c96a47a1cc99d" class="i field">CultureInvariant</a> | <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
            <b>foreach</b> (<b>string</b> <span id="r445 rd" class="r445 r">className</span> <b>in</b> <span class="r443 r">allClasses</span>)
            {
                <b>if</b> (<span class="r439 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>.<a href="../../utils/PowerShellExecutionHelper.cs.html#6ffb97ec2c945a0a" class="i property">CancelTabCompletion</a>)
                {
                    <b>break</b>;
                }
 
                <b>if</b> (!<span class="r444 r">classNamePattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r445 r">className</span>))
                {
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r445 r">className</span>.<span class="i">Length</span> &gt; 0 &amp;&amp; <span class="r445 r">className</span>[0] == <span class="s">&#39;_&#39;</span>)
                {
                    <span class="r442 r">systemClasses</span>.<span class="i">Add</span>(<span class="r445 r">className</span>);
                }
                <b>else</b>
                {
                    <span class="r441 r">regularClasses</span>.<span class="i">Add</span>(<span class="r445 r">className</span>);
                }
            }
 
            <span class="r441 r">regularClasses</span>.<span class="i">Sort</span>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <span class="r442 r">systemClasses</span>.<span class="i">Sort</span>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <span class="r438 r">result</span>.<span class="i">AddRange</span>(
                <span class="r441 r">regularClasses</span>.<span class="i">Concat</span>(<span class="r442 r">systemClasses</span>)
                    .<span class="i">Select</span>(<span id="r446 rd" class="r446 r">className</span> =&gt; <b>new</b> <span class="t">CompletionResult</span>(<span class="r446 r">className</span>, <span class="r446 r">className</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#46005faf1cdef9c1" class="i field">Type</a>, <span class="r440 r">targetNamespace</span> + <span class="s">&quot;:&quot;</span> + <span class="r446 r">className</span>)));
        }
 
        <b>private static void</b> <a id="9c5f60a2bf00c130" href="../../R/9c5f60a2bf00c130.html" target="n" data-glyph="76,1" class="i method">NativeCompletionCimNamespace</a>(
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r447 rd" class="r447 r">result</span>,
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r448 rd" class="r448 r">context</span>)
        {
            <b>string</b> <span id="r449 rd" class="r449 r">containerNamespace</span> = <span class="s">&quot;root&quot;</span>;
            <b>string</b> <span id="r450 rd" class="r450 r">prefixOfChildNamespace</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r448 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>))
            {
                <b>int</b> <span id="r451 rd" class="r451 r">lastSlashOrBackslash</span> = <span class="r448 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>.<span class="i">LastIndexOfAny</span>(<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../Utils.cs.html#182cf4a18b62de18" class="i field">Directory</a>);
                <b>if</b> (<span class="r451 r">lastSlashOrBackslash</span> != (-1))
                {
                    <span class="r449 r">containerNamespace</span> = <span class="r448 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>.<span class="i">Substring</span>(0, <span class="r451 r">lastSlashOrBackslash</span>);
                    <span class="r450 r">prefixOfChildNamespace</span> = <span class="r448 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>.<span class="i">Substring</span>(<span class="r451 r">lastSlashOrBackslash</span> + 1);
                }
            }
 
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r452 rd" class="r452 r">namespaceResults</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
            <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r453 rd" class="r453 r">childNamespacePattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r450 r">prefixOfChildNamespace</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a> | <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#c83c96a47a1cc99d" class="i field">CultureInvariant</a>);
            <b>using</b> (<span class="i">CimSession</span> <span id="r454 rd" class="r454 r">cimSession</span> = <span class="i">CimSession</span>.<span class="i">Create</span>(<b>null</b>))
            {
                <b>foreach</b> (<span class="i">CimInstance</span> <span id="r455 rd" class="r455 r">namespaceInstance</span> <b>in</b> <span class="r454 r">cimSession</span>.<span class="i">EnumerateInstances</span>(<span class="r449 r">containerNamespace</span>, <span class="s">&quot;__Namespace&quot;</span>))
                    <b>using</b> (<span class="r455 r">namespaceInstance</span>)
                    {
                        <b>if</b> (<span class="r448 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>.<a href="../../utils/PowerShellExecutionHelper.cs.html#6ffb97ec2c945a0a" class="i property">CancelTabCompletion</a>)
                        {
                            <b>break</b>;
                        }
 
                        <span class="i">CimProperty</span> <span id="r456 rd" class="r456 r">namespaceNameProperty</span> = <span class="r455 r">namespaceInstance</span>.<span class="i">CimInstanceProperties</span>[<span class="s">&quot;Name&quot;</span>];
                        <b>if</b> (<span class="r456 r">namespaceNameProperty</span> == <b>null</b>)
                        {
                            <b>continue</b>;
                        }
 
                        <b>if</b> (!(<span class="r456 r">namespaceNameProperty</span>.<span class="i">Value</span> <b>is string</b> <span id="r457 rd" class="r457 r">childNamespace</span>))
                        {
                            <b>continue</b>;
                        }
 
                        <b>if</b> (!<span class="r453 r">childNamespacePattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r457 r">childNamespace</span>))
                        {
                            <b>continue</b>;
                        }
 
                        <span class="r452 r">namespaceResults</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(
                                                 <span class="r449 r">containerNamespace</span> + <span class="s">&quot;/&quot;</span> + <span class="r457 r">childNamespace</span>,
                                                 <span class="r457 r">childNamespace</span>,
                                                 <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#0c8ffb24052ce771" class="i field">Namespace</a>,
                                                 <span class="r449 r">containerNamespace</span> + <span class="s">&quot;/&quot;</span> + <span class="r457 r">childNamespace</span>));
                    }
            }
 
            <span class="r447 r">result</span>.<span class="i">AddRange</span>(<span class="r452 r">namespaceResults</span>.<span class="i">OrderBy</span>(<b>static</b> <span id="r458 rd" class="r458 r">x</span> =&gt; <span class="r458 r">x</span>.<span class="i">ListItemText</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>));
        }
 
        <b>private static void</b> <a id="07df9dfac035c2f1" href="../../R/07df9dfac035c2f1.html" target="n" data-glyph="76,1" class="i method">NativeCompletionGetCommand</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r459 rd" class="r459 r">context</span>, <b>string</b> <span id="r460 rd" class="r460 r">moduleName</span>, <b>string</b> <span id="r461 rd" class="r461 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r462 rd" class="r462 r">result</span>)
        {
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r461 r">paramName</span>) &amp;&amp; <span class="r461 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r462 r">result</span>);
 
                <span class="c">// Available commands</span>
                <b>var</b> <span id="r463 rd" class="r463 r">commandResults</span> = <a href="#b7128a499cb55335" class="i method">CompleteCommand</a>(<span class="r459 r">context</span>, <span class="r460 r">moduleName</span>);
                <b>if</b> (<span class="r463 r">commandResults</span> != <b>null</b>)
                    <span class="r462 r">result</span>.<span class="i">AddRange</span>(<span class="r463 r">commandResults</span>);
 
                <span class="c">// Consider files only if the -Module parameter is not present</span>
                <b>if</b> (<span class="r460 r">moduleName</span> == <b>null</b>)
                {
                    <span class="c">// ps1 files and directories. We only complete the files with .ps1 extension for Get-Command, because the -Syntax</span>
                    <span class="c">// may only works on files with .ps1 extension</span>
                    <b>var</b> <span id="r464 rd" class="r464 r">ps1Extension</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>) { <a href="../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../SessionStateStrings.cs.html#2338784ad03a106f" class="i field">PowerShellScriptFileExtension</a> };
                    <b>var</b> <span id="r465 rd" class="r465 r">moduleFilesResults</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;(<a href="#f23c14b94c0c013f" class="i method">CompleteFilename</a>(<span class="r459 r">context</span>, <span class="c">/* containerOnly: */</span> <b>false</b>, <span class="r464 r">ps1Extension</span>));
                    <b>if</b> (<span class="r465 r">moduleFilesResults</span>.<span class="i">Count</span> &gt; 0)
                        <span class="r462 r">result</span>.<span class="i">AddRange</span>(<span class="r465 r">moduleFilesResults</span>);
                }
 
                <span class="r462 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
            <b>else</b> <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r461 r">paramName</span>) &amp;&amp; <span class="r461 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Module&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r462 r">result</span>);
 
                <b>var</b> <span id="r466 rd" class="r466 r">modules</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                <b>var</b> <span id="r467 rd" class="r467 r">moduleResults</span> = <a href="#f0abd69597cfd93f" class="i method">CompleteModuleName</a>(<span class="r459 r">context</span>, <span class="r64 r">loadedModulesOnly</span>: <b>true</b>);
                <b>if</b> (<span class="r467 r">moduleResults</span> != <b>null</b>)
                {
                    <b>foreach</b> (<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <span id="r468 rd" class="r468 r">moduleResult</span> <b>in</b> <span class="r467 r">moduleResults</span>)
                    {
                        <b>if</b> (!<span class="r466 r">modules</span>.<span class="i">Contains</span>(<span class="r468 r">moduleResult</span>.<a href="CompletionResult.cs.html#34a44c8b3b89530a" class="i property">ToolTip</a>))
                        {
                            <span class="r466 r">modules</span>.<span class="i">Add</span>(<span class="r468 r">moduleResult</span>.<a href="CompletionResult.cs.html#34a44c8b3b89530a" class="i property">ToolTip</a>);
                            <span class="r462 r">result</span>.<span class="i">Add</span>(<span class="r468 r">moduleResult</span>);
                        }
                    }
                }
 
                <span class="r467 r">moduleResults</span> = <a href="#f0abd69597cfd93f" class="i method">CompleteModuleName</a>(<span class="r459 r">context</span>, <span class="r64 r">loadedModulesOnly</span>: <b>false</b>);
                <b>if</b> (<span class="r467 r">moduleResults</span> != <b>null</b>)
                {
                    <b>foreach</b> (<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <span id="r469 rd" class="r469 r">moduleResult</span> <b>in</b> <span class="r467 r">moduleResults</span>)
                    {
                        <b>if</b> (!<span class="r466 r">modules</span>.<span class="i">Contains</span>(<span class="r469 r">moduleResult</span>.<a href="CompletionResult.cs.html#34a44c8b3b89530a" class="i property">ToolTip</a>))
                        {
                            <span class="r466 r">modules</span>.<span class="i">Add</span>(<span class="r469 r">moduleResult</span>.<a href="CompletionResult.cs.html#34a44c8b3b89530a" class="i property">ToolTip</a>);
                            <span class="r462 r">result</span>.<span class="i">Add</span>(<span class="r469 r">moduleResult</span>);
                        }
                    }
                }
 
                <span class="r462 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
        }
 
        <b>private static void</b> <a id="2cd83401a5a83fe6" href="../../R/2cd83401a5a83fe6.html" target="n" data-glyph="76,1" class="i method">NativeCompletionGetHelpCommand</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r470 rd" class="r470 r">context</span>, <b>string</b> <span id="r471 rd" class="r471 r">paramName</span>, <b>bool</b> <span id="r472 rd" class="r472 r">isHelpRelated</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r473 rd" class="r473 r">result</span>)
        {
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r471 r">paramName</span>) &amp;&amp; <span class="r471 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r473 r">result</span>);
 
                <span class="c">// Available commands</span>
                <b>const</b> <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r474 rd" class="r474 r">commandTypes</span> = <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a> | <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#8a4bdbbd93f182bf" class="i field">Function</a> | <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#83aa5e1f88cb9bf5" class="i field">Alias</a> | <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#5baa5da2219b134a" class="i field">ExternalScript</a> | <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#2a673544a3a7e93f" class="i field">Configuration</a>;
                <b>var</b> <span id="r475 rd" class="r475 r">commandResults</span> = <a href="#b7128a499cb55335" class="i method">CompleteCommand</a>(<span class="r470 r">context</span>, <span class="c">/* moduleName: */</span> <b>null</b>, <span class="r474 r">commandTypes</span>);
                <b>if</b> (<span class="r475 r">commandResults</span> != <b>null</b>)
                    <span class="r473 r">result</span>.<span class="i">AddRange</span>(<span class="r475 r">commandResults</span>);
 
                <span class="c">// ps1 files and directories</span>
                <b>var</b> <span id="r476 rd" class="r476 r">ps1Extension</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>) { <a href="../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../SessionStateStrings.cs.html#2338784ad03a106f" class="i field">PowerShellScriptFileExtension</a> };
                <b>var</b> <span id="r477 rd" class="r477 r">fileResults</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;(<a href="#f23c14b94c0c013f" class="i method">CompleteFilename</a>(<span class="r470 r">context</span>, <span class="c">/* containerOnly: */</span> <b>false</b>, <span class="r476 r">ps1Extension</span>));
                <b>if</b> (<span class="r477 r">fileResults</span>.<span class="i">Count</span> &gt; 0)
                    <span class="r473 r">result</span>.<span class="i">AddRange</span>(<span class="r477 r">fileResults</span>);
 
                <b>if</b> (<span class="r472 r">isHelpRelated</span>)
                {
                    <span class="c">// Available topics</span>
                    <b>var</b> <span id="r478 rd" class="r478 r">helpTopicResults</span> = <a href="#9866247c8183a354" class="i method">CompleteHelpTopics</a>(<span class="r470 r">context</span>);
                    <b>if</b> (<span class="r478 r">helpTopicResults</span> != <b>null</b>)
                        <span class="r473 r">result</span>.<span class="i">AddRange</span>(<span class="r478 r">helpTopicResults</span>);
                }
 
                <span class="r473 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
        }
 
        <b>private static void</b> <a id="8ddbf4a217aec33e" href="../../R/8ddbf4a217aec33e.html" target="n" data-glyph="76,1" class="i method">NativeCompletionEventLogCommands</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r479 rd" class="r479 r">context</span>, <b>string</b> <span id="r480 rd" class="r480 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r481 rd" class="r481 r">result</span>)
        {
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r480 r">paramName</span>) &amp;&amp; <span class="r480 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;LogName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r481 r">result</span>);
 
                <b>var</b> <span id="r482 rd" class="r482 r">logName</span> = <span class="r479 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ?? <b>string</b>.<span class="i">Empty</span>;
                <b>var</b> <span id="r483 rd" class="r483 r">quote</span> = <span class="i">HandleDoubleAndSingleQuote</span>(<b>ref</b> <span class="r482 r">logName</span>);
 
                <b>if</b> (!<span class="r482 r">logName</span>.<span class="i">EndsWith</span>(<span class="s">&#39;*&#39;</span>))
                {
                    <span class="r482 r">logName</span> += <span class="s">&quot;*&quot;</span>;
                }
 
                <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r484 rd" class="r484 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r482 r">logName</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
                <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r485 rd" class="r485 r">powerShellExecutionHelper</span> = <span class="r479 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
                <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="k">var</a> <span id="r486 rd" class="r486 r">powershell</span> = <span class="r485 r">powerShellExecutionHelper</span>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Get-EventLog&quot;</span>).<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;LogName&quot;</span>, <span class="s">&quot;*&quot;</span>);
 
                <span class="i">Exception</span> <span id="r487 rd" class="r487 r">exceptionThrown</span>;
                <b>var</b> <span id="r488 rd" class="r488 r">psObjects</span> = <span class="r485 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r487 r">exceptionThrown</span>);
 
                <b>if</b> (<span class="r488 r">psObjects</span> != <b>null</b>)
                {
                    <b>foreach</b> (<b>dynamic</b> <span id="r489 rd" class="r489 r">eventLog</span> <b>in</b> <span class="r488 r">psObjects</span>)
                    {
                        <b>var</b> <span id="r490 rd" class="r490 r">completionText</span> = <span class="r489 r">eventLog</span>.<span class="i">Log</span>.<span class="i">ToString</span>();
                        <b>var</b> <span id="r491 rd" class="r491 r">listItemText</span> = <span class="r490 r">completionText</span>;
 
                        <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r490 r">completionText</span>, <b>false</b>))
                        {
                            <b>var</b> <span id="r492 rd" class="r492 r">quoteInUse</span> = <span class="r483 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r483 r">quote</span>;
                            <b>if</b> (<span class="r492 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                                <span class="r490 r">completionText</span> = <span class="r490 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                            <span class="r490 r">completionText</span> = <span class="r492 r">quoteInUse</span> + <span class="r490 r">completionText</span> + <span class="r492 r">quoteInUse</span>;
                        }
                        <b>else</b>
                        {
                            <span class="r490 r">completionText</span> = <span class="r483 r">quote</span> + <span class="r490 r">completionText</span> + <span class="r483 r">quote</span>;
                        }
 
                        <b>if</b> (<span class="r484 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r491 r">listItemText</span>))
                        {
                            <span class="r481 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r490 r">completionText</span>, <span class="r491 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r491 r">listItemText</span>));
                        }
                    }
                }
 
                <span class="r481 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
        }
 
        <b>private static void</b> <a id="32323e118cf66419" href="../../R/32323e118cf66419.html" target="n" data-glyph="76,1" class="i method">NativeCompletionJobCommands</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r493 rd" class="r493 r">context</span>, <b>string</b> <span id="r494 rd" class="r494 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r495 rd" class="r495 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r494 r">paramName</span>))
                <b>return</b>;
 
            <b>var</b> <span id="r496 rd" class="r496 r">wordToComplete</span> = <span class="r493 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ?? <b>string</b>.<span class="i">Empty</span>;
            <b>var</b> <span id="r497 rd" class="r497 r">quote</span> = <span class="i">HandleDoubleAndSingleQuote</span>(<b>ref</b> <span class="r496 r">wordToComplete</span>);
 
            <b>if</b> (!<span class="r496 r">wordToComplete</span>.<span class="i">EndsWith</span>(<span class="s">&#39;*&#39;</span>))
            {
                <span class="r496 r">wordToComplete</span> += <span class="s">&quot;*&quot;</span>;
            }
 
            <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r498 rd" class="r498 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r496 r">wordToComplete</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
            <b>var</b> <span id="r499 rd" class="r499 r">paramIsName</span> = <span class="r494 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>var</b> (<span id="r500 rd" class="r500 r">parameterName</span>, <span id="r501 rd" class="r501 r">value</span>) = <span class="r499 r">paramIsName</span> ? (<span class="s">&quot;Name&quot;</span>, <span class="r496 r">wordToComplete</span>) : (<span class="s">&quot;IncludeChildJob&quot;</span>, (<b>object</b>)<b>true</b>);
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r502 rd" class="r502 r">powerShellExecutionHelper</span> = <span class="r493 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
            <span class="r502 r">powerShellExecutionHelper</span>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Get-Job&quot;</span>, <b>typeof</b>(<a href="../remoting/commands/GetJob.cs.html#656f12d497463796" class="t t">GetJobCommand</a>)).<span class="i">AddParameter</span>(<span class="r500 r">parameterName</span>, <span class="r501 r">value</span>);
 
            <span class="i">Exception</span> <span id="r503 rd" class="r503 r">exceptionThrown</span>;
            <b>var</b> <span id="r504 rd" class="r504 r">psObjects</span> = <span class="r502 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r503 r">exceptionThrown</span>);
            <b>if</b> (<span class="r504 r">psObjects</span> == <b>null</b>)
                <b>return</b>;
 
            <b>if</b> (<span class="r494 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Id&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r495 r">result</span>);
 
                <b>foreach</b> (<b>dynamic</b> <span id="r505 rd" class="r505 r">psJob</span> <b>in</b> <span class="r504 r">psObjects</span>)
                {
                    <b>var</b> <span id="r506 rd" class="r506 r">completionText</span> = <span class="r505 r">psJob</span>.<span class="i">Id</span>.<span class="i">ToString</span>();
                    <b>if</b> (<span class="r498 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r506 r">completionText</span>))
                    {
                        <b>var</b> <span id="r507 rd" class="r507 r">listItemText</span> = <span class="r506 r">completionText</span>;
                        <span class="r506 r">completionText</span> = <span class="r497 r">quote</span> + <span class="r506 r">completionText</span> + <span class="r497 r">quote</span>;
                        <span class="r495 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r506 r">completionText</span>, <span class="r507 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r507 r">listItemText</span>));
                    }
                }
 
                <span class="r495 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
            <b>else</b> <b>if</b> (<span class="r494 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;InstanceId&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r495 r">result</span>);
 
                <b>foreach</b> (<b>dynamic</b> <span id="r508 rd" class="r508 r">psJob</span> <b>in</b> <span class="r504 r">psObjects</span>)
                {
                    <b>var</b> <span id="r509 rd" class="r509 r">completionText</span> = <span class="r508 r">psJob</span>.<span class="i">InstanceId</span>.<span class="i">ToString</span>();
                    <b>if</b> (<span class="r498 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r509 r">completionText</span>))
                    {
                        <b>var</b> <span id="r510 rd" class="r510 r">listItemText</span> = <span class="r509 r">completionText</span>;
                        <span class="r509 r">completionText</span> = <span class="r497 r">quote</span> + <span class="r509 r">completionText</span> + <span class="r497 r">quote</span>;
                        <span class="r495 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r509 r">completionText</span>, <span class="r510 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r510 r">listItemText</span>));
                    }
                }
 
                <span class="r495 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
            <b>else</b> <b>if</b> (<span class="r499 r">paramIsName</span>)
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r495 r">result</span>);
 
                <b>foreach</b> (<b>dynamic</b> <span id="r511 rd" class="r511 r">psJob</span> <b>in</b> <span class="r504 r">psObjects</span>)
                {
                    <b>var</b> <span id="r512 rd" class="r512 r">completionText</span> = <span class="r511 r">psJob</span>.<span class="i">Name</span>;
                    <b>var</b> <span id="r513 rd" class="r513 r">listItemText</span> = <span class="r512 r">completionText</span>;
 
                    <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r512 r">completionText</span>, <b>false</b>))
                    {
                        <b>var</b> <span id="r514 rd" class="r514 r">quoteInUse</span> = <span class="r497 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r497 r">quote</span>;
                        <b>if</b> (<span class="r514 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                            <span class="r512 r">completionText</span> = <span class="r512 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                        <span class="r512 r">completionText</span> = <span class="r514 r">quoteInUse</span> + <span class="r512 r">completionText</span> + <span class="r514 r">quoteInUse</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r512 r">completionText</span> = <span class="r497 r">quote</span> + <span class="r512 r">completionText</span> + <span class="r497 r">quote</span>;
                    }
 
                    <span class="r495 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r512 r">completionText</span>, <span class="r513 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r513 r">listItemText</span>));
                }
 
                <span class="r495 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
        }
 
        <b>private static void</b> <a id="e750f8aa9a10e980" href="../../R/e750f8aa9a10e980.html" target="n" data-glyph="76,1" class="i method">NativeCompletionScheduledJobCommands</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r515 rd" class="r515 r">context</span>, <b>string</b> <span id="r516 rd" class="r516 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r517 rd" class="r517 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r516 r">paramName</span>))
                <b>return</b>;
 
            <b>var</b> <span id="r518 rd" class="r518 r">wordToComplete</span> = <span class="r515 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ?? <b>string</b>.<span class="i">Empty</span>;
            <b>var</b> <span id="r519 rd" class="r519 r">quote</span> = <span class="i">HandleDoubleAndSingleQuote</span>(<b>ref</b> <span class="r518 r">wordToComplete</span>);
 
            <b>if</b> (!<span class="r518 r">wordToComplete</span>.<span class="i">EndsWith</span>(<span class="s">&#39;*&#39;</span>))
            {
                <span class="r518 r">wordToComplete</span> += <span class="s">&quot;*&quot;</span>;
            }
 
            <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r520 rd" class="r520 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r518 r">wordToComplete</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r521 rd" class="r521 r">powerShellExecutionHelper</span> = <span class="r515 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
            <b>if</b> (<span class="r516 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r521 r">powerShellExecutionHelper</span>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;PSScheduledJob\\Get-ScheduledJob&quot;</span>).<span class="i">AddParameter</span>(<span class="s">&quot;Name&quot;</span>, <span class="r518 r">wordToComplete</span>);
            }
            <b>else</b>
            {
                <span class="r521 r">powerShellExecutionHelper</span>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;PSScheduledJob\\Get-ScheduledJob&quot;</span>);
            }
 
            <span class="i">Exception</span> <span id="r522 rd" class="r522 r">exceptionThrown</span>;
            <b>var</b> <span id="r523 rd" class="r523 r">psObjects</span> = <span class="r521 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r522 r">exceptionThrown</span>);
            <b>if</b> (<span class="r523 r">psObjects</span> == <b>null</b>)
                <b>return</b>;
 
            <b>if</b> (<span class="r516 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Id&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r517 r">result</span>);
 
                <b>foreach</b> (<b>dynamic</b> <span id="r524 rd" class="r524 r">psJob</span> <b>in</b> <span class="r523 r">psObjects</span>)
                {
                    <b>var</b> <span id="r525 rd" class="r525 r">completionText</span> = <span class="r524 r">psJob</span>.<span class="i">Id</span>.<span class="i">ToString</span>();
                    <b>if</b> (<span class="r520 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r525 r">completionText</span>))
                    {
                        <b>var</b> <span id="r526 rd" class="r526 r">listItemText</span> = <span class="r525 r">completionText</span>;
                        <span class="r525 r">completionText</span> = <span class="r519 r">quote</span> + <span class="r525 r">completionText</span> + <span class="r519 r">quote</span>;
                        <span class="r517 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r525 r">completionText</span>, <span class="r526 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r526 r">listItemText</span>));
                    }
                }
 
                <span class="r517 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
            <b>else</b> <b>if</b> (<span class="r516 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r517 r">result</span>);
 
                <b>foreach</b> (<b>dynamic</b> <span id="r527 rd" class="r527 r">psJob</span> <b>in</b> <span class="r523 r">psObjects</span>)
                {
                    <b>var</b> <span id="r528 rd" class="r528 r">completionText</span> = <span class="r527 r">psJob</span>.<span class="i">Name</span>;
                    <b>var</b> <span id="r529 rd" class="r529 r">listItemText</span> = <span class="r528 r">completionText</span>;
 
                    <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r528 r">completionText</span>, <b>false</b>))
                    {
                        <b>var</b> <span id="r530 rd" class="r530 r">quoteInUse</span> = <span class="r519 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r519 r">quote</span>;
                        <b>if</b> (<span class="r530 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                            <span class="r528 r">completionText</span> = <span class="r528 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                        <span class="r528 r">completionText</span> = <span class="r530 r">quoteInUse</span> + <span class="r528 r">completionText</span> + <span class="r530 r">quoteInUse</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r528 r">completionText</span> = <span class="r519 r">quote</span> + <span class="r528 r">completionText</span> + <span class="r519 r">quote</span>;
                    }
 
                    <span class="r517 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r528 r">completionText</span>, <span class="r529 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r529 r">listItemText</span>));
                }
 
                <span class="r517 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
        }
 
        <b>private static void</b> <a id="a1aef215dcaf182e" href="../../R/a1aef215dcaf182e.html" target="n" data-glyph="76,1" class="i method">NativeCompletionModuleCommands</a>(
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r531 rd" class="r531 r">context</span>,
            <b>string</b> <span id="r532 rd" class="r532 r">paramName</span>,
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r533 rd" class="r533 r">result</span>,
            <b>bool</b> <span id="r344 rd" class="r344 r">loadedModulesOnly</span> = <b>false</b>,
            <b>bool</b> <span id="r346 rd" class="r346 r">isImportModule</span> = <b>false</b>,
            <b>bool</b> <span id="r343 rd" class="r343 r">skipEditionCheck</span> = <b>false</b>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r532 r">paramName</span>))
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r532 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r533 r">result</span>);
 
                <b>if</b> (<span class="r346 r">isImportModule</span>)
                {
                    <b>var</b> <span id="r534 rd" class="r534 r">moduleExtensions</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
                            {   <a href="../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../SessionStateStrings.cs.html#2338784ad03a106f" class="i field">PowerShellScriptFileExtension</a>,
                                <a href="../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../SessionStateStrings.cs.html#d3eec386d080fd52" class="i field">PowerShellModuleFileExtension</a>,
                                <a href="../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../SessionStateStrings.cs.html#35afed2e7cb8ba9d" class="i field">PowerShellDataFileExtension</a>,
                                <a href="../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../SessionStateStrings.cs.html#2e404a9d6d45ec4c" class="i field">PowerShellNgenAssemblyExtension</a>,
                                <a href="../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../SessionStateStrings.cs.html#8b7b1c77a80f7bf4" class="i field">PowerShellILAssemblyExtension</a>,
                                <a href="../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../SessionStateStrings.cs.html#b12271d4e9d97dc9" class="i field">PowerShellILExecutableExtension</a>,
                                <a href="../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../SessionStateStrings.cs.html#8de3ad39fcb348d7" class="i field">PowerShellCmdletizationFileExtension</a>
                            };
                    <b>var</b> <span id="r535 rd" class="r535 r">moduleFilesResults</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;(<a href="#f23c14b94c0c013f" class="i method">CompleteFilename</a>(<span class="r531 r">context</span>, <span class="r95 r">containerOnly</span>: <b>false</b>, <span class="r534 r">moduleExtensions</span>));
                    <b>if</b> (<span class="r535 r">moduleFilesResults</span>.<span class="i">Count</span> &gt; 0)
                        <span class="r533 r">result</span>.<span class="i">AddRange</span>(<span class="r535 r">moduleFilesResults</span>);
 
                    <b>var</b> <span id="r536 rd" class="r536 r">assemblyOrModuleName</span> = <span class="r531 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>;
                    <b>if</b> (<span class="r536 r">assemblyOrModuleName</span>.<span class="i">IndexOfAny</span>(<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../Utils.cs.html#0702ea1962d7d49b" class="i field">DirectoryOrDrive</a>) != -1)
                    {
                        <span class="c">// The partial input is a path, then we don&#39;t iterate modules under $ENV:PSModulePath</span>
                        <b>return</b>;
                    }
                }
 
                <b>var</b> <span id="r537 rd" class="r537 r">moduleResults</span> = <a href="#f0abd69597cfd93f" class="i method">CompleteModuleName</a>(<span class="r531 r">context</span>, <span class="r344 r">loadedModulesOnly</span>, <span class="r343 r">skipEditionCheck</span>);
                <b>if</b> (<span class="r537 r">moduleResults</span> != <b>null</b> &amp;&amp; <span class="r537 r">moduleResults</span>.<span class="i">Count</span> &gt; 0)
                    <span class="r533 r">result</span>.<span class="i">AddRange</span>(<span class="r537 r">moduleResults</span>);
 
                <span class="r533 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
            <b>else</b> <b>if</b> (<span class="r532 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Assembly&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r533 r">result</span>);
 
                <b>var</b> <span id="r538 rd" class="r538 r">moduleExtensions</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>) { <span class="s">&quot;.dll&quot;</span> };
                <b>var</b> <span id="r539 rd" class="r539 r">moduleFilesResults</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;(<a href="#f23c14b94c0c013f" class="i method">CompleteFilename</a>(<span class="r531 r">context</span>, <span class="c">/* containerOnly: */</span> <b>false</b>, <span class="r538 r">moduleExtensions</span>));
                <b>if</b> (<span class="r539 r">moduleFilesResults</span>.<span class="i">Count</span> &gt; 0)
                    <span class="r533 r">result</span>.<span class="i">AddRange</span>(<span class="r539 r">moduleFilesResults</span>);
 
                <span class="r533 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
        }
 
        <b>private static void</b> <a id="9bfa16923bc282cc" href="../../R/9bfa16923bc282cc.html" target="n" data-glyph="76,1" class="i method">NativeCompletionProcessCommands</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r540 rd" class="r540 r">context</span>, <b>string</b> <span id="r541 rd" class="r541 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r542 rd" class="r542 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r541 r">paramName</span>))
                <b>return</b>;
 
            <b>var</b> <span id="r543 rd" class="r543 r">wordToComplete</span> = <span class="r540 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ?? <b>string</b>.<span class="i">Empty</span>;
            <b>var</b> <span id="r544 rd" class="r544 r">quote</span> = <span class="i">HandleDoubleAndSingleQuote</span>(<b>ref</b> <span class="r543 r">wordToComplete</span>);
 
            <b>if</b> (!<span class="r543 r">wordToComplete</span>.<span class="i">EndsWith</span>(<span class="s">&#39;*&#39;</span>))
            {
                <span class="r543 r">wordToComplete</span> += <span class="s">&quot;*&quot;</span>;
            }
 
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r545 rd" class="r545 r">powerShellExecutionHelper</span> = <span class="r540 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
            <b>if</b> (<span class="r541 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Id&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r545 r">powerShellExecutionHelper</span>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Get-Process&quot;</span>);
            }
            <b>else</b>
            {
                <span class="r545 r">powerShellExecutionHelper</span>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Get-Process&quot;</span>).<span class="i">AddParameter</span>(<span class="s">&quot;Name&quot;</span>, <span class="r543 r">wordToComplete</span>);
            }
 
            <span class="i">Exception</span> <span id="r546 rd" class="r546 r">exceptionThrown</span>;
            <b>var</b> <span id="r547 rd" class="r547 r">psObjects</span> = <span class="r545 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r546 r">exceptionThrown</span>);
            <b>if</b> (<span class="r547 r">psObjects</span> == <b>null</b>)
                <b>return</b>;
 
            <b>if</b> (<span class="r541 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Id&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r542 r">result</span>);
 
                <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r548 rd" class="r548 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r543 r">wordToComplete</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                <b>foreach</b> (<b>dynamic</b> <span id="r549 rd" class="r549 r">process</span> <b>in</b> <span class="r547 r">psObjects</span>)
                {
                    <b>var</b> <span id="r550 rd" class="r550 r">processId</span> = <span class="r549 r">process</span>.<span class="i">Id</span>.<span class="i">ToString</span>();
                    <b>if</b> (<span class="r548 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r550 r">processId</span>))
                    {
                        <b>var</b> <span id="r551 rd" class="r551 r">processName</span> = <span class="r549 r">process</span>.<span class="i">Name</span>;
 
                        <b>var</b> <span id="r552 rd" class="r552 r">idAndName</span> = <span class="s">$&quot;</span>{<span class="r550 r">processId</span>}<span class="s"> - </span>{<span class="r551 r">processName</span>}<span class="s">&quot;</span>;
                        <span class="r550 r">processId</span> = <span class="r544 r">quote</span> + <span class="r550 r">processId</span> + <span class="r544 r">quote</span>;
                        <span class="r542 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r550 r">processId</span>, <span class="r552 r">idAndName</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r552 r">idAndName</span>));
                    }
                }
 
                <span class="r542 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
            <b>else</b> <b>if</b> (<span class="r541 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r542 r">result</span>);
 
                <b>var</b> <span id="r553 rd" class="r553 r">uniqueSet</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                <b>foreach</b> (<b>dynamic</b> <span id="r554 rd" class="r554 r">process</span> <b>in</b> <span class="r547 r">psObjects</span>)
                {
                    <b>var</b> <span id="r555 rd" class="r555 r">completionText</span> = <span class="r554 r">process</span>.<span class="i">Name</span>;
                    <b>var</b> <span id="r556 rd" class="r556 r">listItemText</span> = <span class="r555 r">completionText</span>;
 
                    <b>if</b> (<span class="r553 r">uniqueSet</span>.<span class="i">Contains</span>(<span class="r555 r">completionText</span>))
                        <b>continue</b>;
 
                    <span class="r553 r">uniqueSet</span>.<span class="i">Add</span>(<span class="r555 r">completionText</span>);
                    <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r555 r">completionText</span>, <b>false</b>))
                    {
                        <b>var</b> <span id="r557 rd" class="r557 r">quoteInUse</span> = <span class="r544 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r544 r">quote</span>;
                        <b>if</b> (<span class="r557 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                            <span class="r555 r">completionText</span> = <span class="r555 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                        <span class="r555 r">completionText</span> = <span class="r557 r">quoteInUse</span> + <span class="r555 r">completionText</span> + <span class="r557 r">quoteInUse</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r555 r">completionText</span> = <span class="r544 r">quote</span> + <span class="r555 r">completionText</span> + <span class="r544 r">quote</span>;
                    }
 
                    <span class="c">// on macOS, system processes names will be empty if PowerShell isn&#39;t run as `sudo`</span>
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r556 r">listItemText</span>))
                    {
                        <b>continue</b>;
                    }
 
                    <span class="r542 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r555 r">completionText</span>, <span class="r556 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r556 r">listItemText</span>));
                }
 
                <span class="r542 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
        }
 
        <b>private static void</b> <a id="05dbbd089189736c" href="../../R/05dbbd089189736c.html" target="n" data-glyph="76,1" class="i method">NativeCompletionProviderCommands</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r558 rd" class="r558 r">context</span>, <b>string</b> <span id="r559 rd" class="r559 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r560 rd" class="r560 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r559 r">paramName</span>) || !<span class="r559 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;PSProvider&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b>;
            }
 
            <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r560 r">result</span>);
 
            <b>var</b> <span id="r561 rd" class="r561 r">providerName</span> = <span class="r558 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ?? <b>string</b>.<span class="i">Empty</span>;
            <b>var</b> <span id="r562 rd" class="r562 r">quote</span> = <span class="i">HandleDoubleAndSingleQuote</span>(<b>ref</b> <span class="r561 r">providerName</span>);
 
            <b>if</b> (!<span class="r561 r">providerName</span>.<span class="i">EndsWith</span>(<span class="s">&#39;*&#39;</span>))
            {
                <span class="r561 r">providerName</span> += <span class="s">&quot;*&quot;</span>;
            }
 
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r563 rd" class="r563 r">powerShellExecutionHelper</span> = <span class="r558 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
            <span class="r563 r">powerShellExecutionHelper</span>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Get-PSProvider&quot;</span>).<span class="i">AddParameter</span>(<span class="s">&quot;PSProvider&quot;</span>, <span class="r561 r">providerName</span>);
            <b>var</b> <span id="r564 rd" class="r564 r">psObjects</span> = <span class="r563 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out _</b>);
            <b>if</b> (<span class="r564 r">psObjects</span> == <b>null</b>)
                <b>return</b>;
 
            <b>foreach</b> (<b>dynamic</b> <span id="r565 rd" class="r565 r">providerInfo</span> <b>in</b> <span class="r564 r">psObjects</span>)
            {
                <b>var</b> <span id="r566 rd" class="r566 r">completionText</span> = <span class="r565 r">providerInfo</span>.<span class="i">Name</span>;
                <b>var</b> <span id="r567 rd" class="r567 r">listItemText</span> = <span class="r566 r">completionText</span>;
 
                <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r566 r">completionText</span>, <b>false</b>))
                {
                    <b>var</b> <span id="r568 rd" class="r568 r">quoteInUse</span> = <span class="r562 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r562 r">quote</span>;
                    <b>if</b> (<span class="r568 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                        <span class="r566 r">completionText</span> = <span class="r566 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                    <span class="r566 r">completionText</span> = <span class="r568 r">quoteInUse</span> + <span class="r566 r">completionText</span> + <span class="r568 r">quoteInUse</span>;
                }
                <b>else</b>
                {
                    <span class="r566 r">completionText</span> = <span class="r562 r">quote</span> + <span class="r566 r">completionText</span> + <span class="r562 r">quote</span>;
                }
 
                <span class="r560 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r566 r">completionText</span>, <span class="r567 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r567 r">listItemText</span>));
            }
 
            <span class="r560 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
        }
 
        <b>private static void</b> <a id="eb650d5c84dfb904" href="../../R/eb650d5c84dfb904.html" target="n" data-glyph="76,1" class="i method">NativeCompletionDriveCommands</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r569 rd" class="r569 r">context</span>, <b>string</b> <span id="r570 rd" class="r570 r">psProvider</span>, <b>string</b> <span id="r571 rd" class="r571 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r572 rd" class="r572 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r571 r">paramName</span>) || !<span class="r571 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b>;
 
            <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r572 r">result</span>);
 
            <b>var</b> <span id="r573 rd" class="r573 r">wordToComplete</span> = <span class="r569 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ?? <b>string</b>.<span class="i">Empty</span>;
            <b>var</b> <span id="r574 rd" class="r574 r">quote</span> = <span class="i">HandleDoubleAndSingleQuote</span>(<b>ref</b> <span class="r573 r">wordToComplete</span>);
 
            <b>if</b> (!<span class="r573 r">wordToComplete</span>.<span class="i">EndsWith</span>(<span class="s">&#39;*&#39;</span>))
            {
                <span class="r573 r">wordToComplete</span> += <span class="s">&quot;*&quot;</span>;
            }
 
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r575 rd" class="r575 r">powerShellExecutionHelper</span> = <span class="r569 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
            <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="k">var</a> <span id="r576 rd" class="r576 r">powershell</span> = <span class="r575 r">powerShellExecutionHelper</span>
                .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Get-PSDrive&quot;</span>)
                .<span class="i">AddParameter</span>(<span class="s">&quot;Name&quot;</span>, <span class="r573 r">wordToComplete</span>);
            <b>if</b> (<span class="r570 r">psProvider</span> != <b>null</b>)
                <span class="r576 r">powershell</span>.<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;PSProvider&quot;</span>, <span class="r570 r">psProvider</span>);
 
            <b>var</b> <span id="r577 rd" class="r577 r">psObjects</span> = <span class="r575 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out _</b>);
            <b>if</b> (<span class="r577 r">psObjects</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>dynamic</b> <span id="r578 rd" class="r578 r">driveInfo</span> <b>in</b> <span class="r577 r">psObjects</span>)
                {
                    <b>var</b> <span id="r579 rd" class="r579 r">completionText</span> = <span class="r578 r">driveInfo</span>.<span class="i">Name</span>;
                    <b>var</b> <span id="r580 rd" class="r580 r">listItemText</span> = <span class="r579 r">completionText</span>;
 
                    <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r579 r">completionText</span>, <b>false</b>))
                    {
                        <b>var</b> <span id="r581 rd" class="r581 r">quoteInUse</span> = <span class="r574 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r574 r">quote</span>;
                        <b>if</b> (<span class="r581 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                            <span class="r579 r">completionText</span> = <span class="r579 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                        <span class="r579 r">completionText</span> = <span class="r581 r">quoteInUse</span> + <span class="r579 r">completionText</span> + <span class="r581 r">quoteInUse</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r579 r">completionText</span> = <span class="r574 r">quote</span> + <span class="r579 r">completionText</span> + <span class="r574 r">quote</span>;
                    }
 
                    <span class="r572 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r579 r">completionText</span>, <span class="r580 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r580 r">listItemText</span>));
                }
            }
 
            <span class="r572 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
        }
 
        <b>private static void</b> <a id="858a78bdb80c8624" href="../../R/858a78bdb80c8624.html" target="n" data-glyph="76,1" class="i method">NativeCompletionServiceCommands</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r582 rd" class="r582 r">context</span>, <b>string</b> <span id="r583 rd" class="r583 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r584 rd" class="r584 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r583 r">paramName</span>))
                <b>return</b>;
 
            <b>var</b> <span id="r585 rd" class="r585 r">wordToComplete</span> = <span class="r582 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ?? <b>string</b>.<span class="i">Empty</span>;
            <b>var</b> <span id="r586 rd" class="r586 r">quote</span> = <span class="i">HandleDoubleAndSingleQuote</span>(<b>ref</b> <span class="r585 r">wordToComplete</span>);
 
            <b>if</b> (!<span class="r585 r">wordToComplete</span>.<span class="i">EndsWith</span>(<span class="s">&#39;*&#39;</span>))
            {
                <span class="r585 r">wordToComplete</span> += <span class="s">&quot;*&quot;</span>;
            }
 
            <span class="i">Exception</span> <span id="r587 rd" class="r587 r">exceptionThrown</span>;
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r588 rd" class="r588 r">powerShellExecutionHelper</span> = <span class="r582 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
            <b>if</b> (<span class="r583 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;DisplayName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r584 r">result</span>);
 
                <span class="r588 r">powerShellExecutionHelper</span>
                    .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Get-Service&quot;</span>)
                    .<span class="i">AddParameter</span>(<span class="s">&quot;DisplayName&quot;</span>, <span class="r585 r">wordToComplete</span>)
                    .<a href="../../utils/PowerShellExecutionHelper.cs.html#9bbdee3db96adb67" class="i method">AddCommandWithPreferenceSetting</a>(<span class="s">&quot;Microsoft.PowerShell.Utility\\Sort-Object&quot;</span>)
                    .<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Property&quot;</span>, <span class="s">&quot;DisplayName&quot;</span>);
                <b>var</b> <span id="r589 rd" class="r589 r">psObjects</span> = <span class="r588 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r587 r">exceptionThrown</span>);
                <b>if</b> (<span class="r589 r">psObjects</span> != <b>null</b>)
                {
                    <b>foreach</b> (<b>dynamic</b> <span id="r590 rd" class="r590 r">serviceInfo</span> <b>in</b> <span class="r589 r">psObjects</span>)
                    {
                        <b>var</b> <span id="r591 rd" class="r591 r">completionText</span> = <span class="r590 r">serviceInfo</span>.<span class="i">DisplayName</span>;
                        <b>var</b> <span id="r592 rd" class="r592 r">listItemText</span> = <span class="r591 r">completionText</span>;
 
                        <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r591 r">completionText</span>, <b>false</b>))
                        {
                            <b>var</b> <span id="r593 rd" class="r593 r">quoteInUse</span> = <span class="r586 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r586 r">quote</span>;
                            <b>if</b> (<span class="r593 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                                <span class="r591 r">completionText</span> = <span class="r591 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                            <span class="r591 r">completionText</span> = <span class="r593 r">quoteInUse</span> + <span class="r591 r">completionText</span> + <span class="r593 r">quoteInUse</span>;
                        }
                        <b>else</b>
                        {
                            <span class="r591 r">completionText</span> = <span class="r586 r">quote</span> + <span class="r591 r">completionText</span> + <span class="r586 r">quote</span>;
                        }
 
                        <span class="r584 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r591 r">completionText</span>, <span class="r592 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r592 r">listItemText</span>));
                    }
                }
 
                <span class="r584 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
            <b>else</b> <b>if</b> (<span class="r583 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r584 r">result</span>);
 
                <span class="r588 r">powerShellExecutionHelper</span>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Get-Service&quot;</span>).<span class="i">AddParameter</span>(<span class="s">&quot;Name&quot;</span>, <span class="r585 r">wordToComplete</span>);
                <b>var</b> <span id="r594 rd" class="r594 r">psObjects</span> = <span class="r588 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r587 r">exceptionThrown</span>);
                <b>if</b> (<span class="r594 r">psObjects</span> != <b>null</b>)
                {
                    <b>foreach</b> (<b>dynamic</b> <span id="r595 rd" class="r595 r">serviceInfo</span> <b>in</b> <span class="r594 r">psObjects</span>)
                    {
                        <b>var</b> <span id="r596 rd" class="r596 r">completionText</span> = <span class="r595 r">serviceInfo</span>.<span class="i">Name</span>;
                        <b>var</b> <span id="r597 rd" class="r597 r">listItemText</span> = <span class="r596 r">completionText</span>;
 
                        <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r596 r">completionText</span>, <b>false</b>))
                        {
                            <b>var</b> <span id="r598 rd" class="r598 r">quoteInUse</span> = <span class="r586 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r586 r">quote</span>;
                            <b>if</b> (<span class="r598 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                                <span class="r596 r">completionText</span> = <span class="r596 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                            <span class="r596 r">completionText</span> = <span class="r598 r">quoteInUse</span> + <span class="r596 r">completionText</span> + <span class="r598 r">quoteInUse</span>;
                        }
                        <b>else</b>
                        {
                            <span class="r596 r">completionText</span> = <span class="r586 r">quote</span> + <span class="r596 r">completionText</span> + <span class="r586 r">quote</span>;
                        }
 
                        <span class="r584 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r596 r">completionText</span>, <span class="r597 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r597 r">listItemText</span>));
                    }
                }
 
                <span class="r584 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
        }
 
        <b>private static void</b> <a id="bb4f4093b72dafd1" href="../../R/bb4f4093b72dafd1.html" target="n" data-glyph="76,1" class="i method">NativeCompletionVariableCommands</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r599 rd" class="r599 r">context</span>, <b>string</b> <span id="r600 rd" class="r600 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r601 rd" class="r601 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r600 r">paramName</span>) || !<span class="r600 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b>;
            }
 
            <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r601 r">result</span>);
 
            <b>var</b> <span id="r602 rd" class="r602 r">variableName</span> = <span class="r599 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ?? <b>string</b>.<span class="i">Empty</span>;
            <b>var</b> <span id="r603 rd" class="r603 r">quote</span> = <span class="i">HandleDoubleAndSingleQuote</span>(<b>ref</b> <span class="r602 r">variableName</span>);
            <b>if</b> (!<span class="r602 r">variableName</span>.<span class="i">EndsWith</span>(<span class="s">&#39;*&#39;</span>))
            {
                <span class="r602 r">variableName</span> += <span class="s">&quot;*&quot;</span>;
            }
 
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r604 rd" class="r604 r">powerShellExecutionHelper</span> = <span class="r599 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
            <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="k">var</a> <span id="r605 rd" class="r605 r">powershell</span> = <span class="r604 r">powerShellExecutionHelper</span>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Utility\\Get-Variable&quot;</span>).<span class="i">AddParameter</span>(<span class="s">&quot;Name&quot;</span>, <span class="r602 r">variableName</span>);
            <b>var</b> <span id="r606 rd" class="r606 r">psObjects</span> = <span class="r604 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out _</b>);
            <b>if</b> (<span class="r606 r">psObjects</span> == <b>null</b>)
                <b>return</b>;
 
            <b>foreach</b> (<b>dynamic</b> <span id="r607 rd" class="r607 r">variable</span> <b>in</b> <span class="r606 r">psObjects</span>)
            {
                <b>var</b> <span id="r608 rd" class="r608 r">effectiveQuote</span> = <span class="r603 r">quote</span>;
                <b>var</b> <span id="r609 rd" class="r609 r">completionText</span> = <span class="r607 r">variable</span>.<span class="i">Name</span>;
                <b>var</b> <span id="r610 rd" class="r610 r">listItemText</span> = <span class="r609 r">completionText</span>;
 
                <span class="c">// Handle special characters ? and * in variable names</span>
                <b>if</b> (<span class="r609 r">completionText</span>.<span class="i">IndexOfAny</span>(<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../Utils.cs.html#8bdf3580e6bcbb80" class="i field">StarOrQuestion</a>) != -1)
                {
                    <span class="r608 r">effectiveQuote</span> = <span class="s">&quot;&#39;&quot;</span>;
                    <span class="r609 r">completionText</span> = <span class="r609 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;?&quot;</span>, <span class="s">&quot;`?&quot;</span>);
                    <span class="r609 r">completionText</span> = <span class="r609 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;*&quot;</span>, <span class="s">&quot;`*&quot;</span>);
                }
 
                <b>if</b> (!<span class="r609 r">completionText</span>.<span class="i">Equals</span>(<span class="s">&quot;$&quot;</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>) &amp;&amp; <a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r609 r">completionText</span>, <b>false</b>))
                {
                    <b>var</b> <span id="r611 rd" class="r611 r">quoteInUse</span> = <span class="r608 r">effectiveQuote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r608 r">effectiveQuote</span>;
                    <b>if</b> (<span class="r611 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                        <span class="r609 r">completionText</span> = <span class="r609 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                    <span class="r609 r">completionText</span> = <span class="r611 r">quoteInUse</span> + <span class="r609 r">completionText</span> + <span class="r611 r">quoteInUse</span>;
                }
                <b>else</b>
                {
                    <span class="r609 r">completionText</span> = <span class="r608 r">effectiveQuote</span> + <span class="r609 r">completionText</span> + <span class="r608 r">effectiveQuote</span>;
                }
 
                <span class="r601 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r609 r">completionText</span>, <span class="r610 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r610 r">listItemText</span>));
            }
 
            <span class="r601 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
        }
 
        <b>private static void</b> <a id="3d79170f5dc142f2" href="../../R/3d79170f5dc142f2.html" target="n" data-glyph="76,1" class="i method">NativeCompletionAliasCommands</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r612 rd" class="r612 r">context</span>, <b>string</b> <span id="r613 rd" class="r613 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r614 rd" class="r614 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r613 r">paramName</span>) ||
                (!<span class="r613 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Definition&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                 !<span class="r613 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
            {
                <b>return</b>;
            }
 
            <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r614 r">result</span>);
 
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r615 rd" class="r615 r">powerShellExecutionHelper</span> = <span class="r612 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
            <b>if</b> (<span class="r613 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>var</b> <span id="r616 rd" class="r616 r">commandName</span> = <span class="r612 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ?? <b>string</b>.<span class="i">Empty</span>;
                <b>var</b> <span id="r617 rd" class="r617 r">quote</span> = <span class="i">HandleDoubleAndSingleQuote</span>(<b>ref</b> <span class="r616 r">commandName</span>);
 
                <b>if</b> (!<span class="r616 r">commandName</span>.<span class="i">EndsWith</span>(<span class="s">&#39;*&#39;</span>))
                {
                    <span class="r616 r">commandName</span> += <span class="s">&quot;*&quot;</span>;
                }
 
                <span class="i">Exception</span> <span id="r618 rd" class="r618 r">exceptionThrown</span>;
                <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="k">var</a> <span id="r619 rd" class="r619 r">powershell</span> = <span class="r615 r">powerShellExecutionHelper</span>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Utility\\Get-Alias&quot;</span>).<span class="i">AddParameter</span>(<span class="s">&quot;Name&quot;</span>, <span class="r616 r">commandName</span>);
                <b>var</b> <span id="r620 rd" class="r620 r">psObjects</span> = <span class="r615 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r618 r">exceptionThrown</span>);
                <b>if</b> (<span class="r620 r">psObjects</span> != <b>null</b>)
                {
                    <b>foreach</b> (<b>dynamic</b> <span id="r621 rd" class="r621 r">aliasInfo</span> <b>in</b> <span class="r620 r">psObjects</span>)
                    {
                        <b>var</b> <span id="r622 rd" class="r622 r">completionText</span> = <span class="r621 r">aliasInfo</span>.<span class="i">Name</span>;
                        <b>var</b> <span id="r623 rd" class="r623 r">listItemText</span> = <span class="r622 r">completionText</span>;
 
                        <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r622 r">completionText</span>, <b>false</b>))
                        {
                            <b>var</b> <span id="r624 rd" class="r624 r">quoteInUse</span> = <span class="r617 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r617 r">quote</span>;
                            <b>if</b> (<span class="r624 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                                <span class="r622 r">completionText</span> = <span class="r622 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                            <span class="r622 r">completionText</span> = <span class="r624 r">quoteInUse</span> + <span class="r622 r">completionText</span> + <span class="r624 r">quoteInUse</span>;
                        }
                        <b>else</b>
                        {
                            <span class="r622 r">completionText</span> = <span class="r617 r">quote</span> + <span class="r622 r">completionText</span> + <span class="r617 r">quote</span>;
                        }
 
                        <span class="r614 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r622 r">completionText</span>, <span class="r623 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r623 r">listItemText</span>));
                    }
                }
            }
            <b>else</b>
            {
                <span class="c">// Complete for the parameter Definition</span>
                <span class="c">// Available commands</span>
                <b>const</b> <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a> <span id="r625 rd" class="r625 r">commandTypes</span> = <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#e95f2e5deaaf9b93" class="i field">Cmdlet</a> | <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#8a4bdbbd93f182bf" class="i field">Function</a> | <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#5baa5da2219b134a" class="i field">ExternalScript</a> | <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#2a673544a3a7e93f" class="i field">Configuration</a>;
                <b>var</b> <span id="r626 rd" class="r626 r">commandResults</span> = <a href="#b7128a499cb55335" class="i method">CompleteCommand</a>(<span class="r612 r">context</span>, <span class="c">/* moduleName: */</span> <b>null</b>, <span class="r625 r">commandTypes</span>);
                <b>if</b> (<span class="r626 r">commandResults</span> != <b>null</b> &amp;&amp; <span class="r626 r">commandResults</span>.<span class="i">Count</span> &gt; 0)
                    <span class="r614 r">result</span>.<span class="i">AddRange</span>(<span class="r626 r">commandResults</span>);
 
                <span class="c">// The parameter Definition takes a file</span>
                <b>var</b> <span id="r627 rd" class="r627 r">fileResults</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;(<a href="#729d5ec1cd6162b7" class="i method">CompleteFilename</a>(<span class="r612 r">context</span>));
                <b>if</b> (<span class="r627 r">fileResults</span>.<span class="i">Count</span> &gt; 0)
                    <span class="r614 r">result</span>.<span class="i">AddRange</span>(<span class="r627 r">fileResults</span>);
            }
 
            <span class="r614 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
        }
 
        <b>private static void</b> <a id="83d2665d87f94531" href="../../R/83d2665d87f94531.html" target="n" data-glyph="76,1" class="i method">NativeCompletionTraceSourceCommands</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r628 rd" class="r628 r">context</span>, <b>string</b> <span id="r629 rd" class="r629 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r630 rd" class="r630 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r629 r">paramName</span>) || !<span class="r629 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Name&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b>;
            }
 
            <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r630 r">result</span>);
 
            <b>var</b> <span id="r631 rd" class="r631 r">traceSourceName</span> = <span class="r628 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ?? <b>string</b>.<span class="i">Empty</span>;
            <b>var</b> <span id="r632 rd" class="r632 r">quote</span> = <span class="i">HandleDoubleAndSingleQuote</span>(<b>ref</b> <span class="r631 r">traceSourceName</span>);
 
            <b>if</b> (!<span class="r631 r">traceSourceName</span>.<span class="i">EndsWith</span>(<span class="s">&#39;*&#39;</span>))
            {
                <span class="r631 r">traceSourceName</span> += <span class="s">&quot;*&quot;</span>;
            }
 
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r633 rd" class="r633 r">powerShellExecutionHelper</span> = <span class="r628 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
            <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="k">var</a> <span id="r634 rd" class="r634 r">powershell</span> = <span class="r633 r">powerShellExecutionHelper</span>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Utility\\Get-TraceSource&quot;</span>).<span class="i">AddParameter</span>(<span class="s">&quot;Name&quot;</span>, <span class="r631 r">traceSourceName</span>);
            <span class="i">Exception</span> <span id="r635 rd" class="r635 r">exceptionThrown</span>;
            <b>var</b> <span id="r636 rd" class="r636 r">psObjects</span> = <span class="r633 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r635 r">exceptionThrown</span>);
            <b>if</b> (<span class="r636 r">psObjects</span> == <b>null</b>)
                <b>return</b>;
 
            <b>foreach</b> (<b>dynamic</b> <span id="r637 rd" class="r637 r">trace</span> <b>in</b> <span class="r636 r">psObjects</span>)
            {
                <b>var</b> <span id="r638 rd" class="r638 r">completionText</span> = <span class="r637 r">trace</span>.<span class="i">Name</span>;
                <b>var</b> <span id="r639 rd" class="r639 r">listItemText</span> = <span class="r638 r">completionText</span>;
 
                <b>if</b> (<a href="#722eabc002827a75" class="i method">CompletionRequiresQuotes</a>(<span class="r638 r">completionText</span>, <b>false</b>))
                {
                    <b>var</b> <span id="r640 rd" class="r640 r">quoteInUse</span> = <span class="r632 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r632 r">quote</span>;
                    <b>if</b> (<span class="r640 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                        <span class="r638 r">completionText</span> = <span class="r638 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                    <span class="r638 r">completionText</span> = <span class="r640 r">quoteInUse</span> + <span class="r638 r">completionText</span> + <span class="r640 r">quoteInUse</span>;
                }
                <b>else</b>
                {
                    <span class="r638 r">completionText</span> = <span class="r632 r">quote</span> + <span class="r638 r">completionText</span> + <span class="r632 r">quote</span>;
                }
 
                <span class="r630 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r638 r">completionText</span>, <span class="r639 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r639 r">listItemText</span>));
            }
 
            <span class="r630 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
        }
 
        <b>private static void</b> <a id="2d16f58d09ee8e5a" href="../../R/2d16f58d09ee8e5a.html" target="n" data-glyph="76,1" class="i method">NativeCompletionSetLocationCommand</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r641 rd" class="r641 r">context</span>, <b>string</b> <span id="r642 rd" class="r642 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r643 rd" class="r643 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r642 r">paramName</span>) ||
                (!<span class="r642 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Path&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                 !<span class="r642 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;LiteralPath&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
            {
                <b>return</b>;
            }
 
            <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r643 r">result</span>);
 
            <span class="r641 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ??= <b>string</b>.<span class="i">Empty</span>;
            <b>var</b> <span id="r644 rd" class="r644 r">clearLiteralPath</span> = <b>false</b>;
            <b>if</b> (<span class="r642 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;LiteralPath&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r644 r">clearLiteralPath</span> = <a href="#2bbbf54fb571efb5" class="i method">TurnOnLiteralPathOption</a>(<span class="r641 r">context</span>);
            }
 
            <b>try</b>
            {
                <b>var</b> <span id="r645 rd" class="r645 r">fileNameResults</span> = <a href="#f23c14b94c0c013f" class="i method">CompleteFilename</a>(<span class="r641 r">context</span>, <span class="r95 r">containerOnly</span>: <b>true</b>, <span class="r96 r">extension</span>: <b>null</b>);
                <b>if</b> (<span class="r645 r">fileNameResults</span> != <b>null</b>)
                    <span class="r643 r">result</span>.<span class="i">AddRange</span>(<span class="r645 r">fileNameResults</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r644 r">clearLiteralPath</span>)
                    <span class="r641 r">context</span>.<a href="CompletionAnalysis.cs.html#f3f4d193708c896f" class="i property">Options</a>.<span class="i">Remove</span>(<span class="s">&quot;LiteralPaths&quot;</span>);
            }
 
            <span class="r643 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Provides completion results for NewItemCommand.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r646 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Completion context.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r647 r">paramName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Name of the parameter whose value needs completion.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r648 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">List of completion suggestions.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="cfade976d0dbf7f9" href="../../R/cfade976d0dbf7f9.html" target="n" data-glyph="76,1" class="i method">NativeCompletionNewItemCommand</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r646 rd" class="r646 r">context</span>, <b>string</b> <span id="r647 rd" class="r647 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r648 rd" class="r648 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r647 r">paramName</span>))
            {
                <b>return</b>;
            }
 
            <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r649 rd" class="r649 r">executionContext</span> = <span class="r646 r">context</span>.<a href="CompletionAnalysis.cs.html#4055c622a2008ac8" class="i property">ExecutionContext</a>;
 
            <b>var</b> <span id="r650 rd" class="r650 r">boundArgs</span> = <a href="#e89db5ccd9fe157e" class="i method">GetBoundArgumentsAsHashtable</a>(<span class="r646 r">context</span>);
            <b>var</b> <span id="r651 rd" class="r651 r">providedPath</span> = <span class="r650 r">boundArgs</span>[<span class="s">&quot;Path&quot;</span>] <b>as string</b> ?? <span class="r649 r">executionContext</span>.<a href="../ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="../SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../PathInterfaces.cs.html#91ffa5f8fc6b1308" class="i property">CurrentLocation</a>.<a href="../../namespaces/PathInfo.cs.html#de00cd47bf0cf721" class="i property">Path</a>;
 
            <a href="../DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r652 rd" class="r652 r">provider</span>;
            <span class="r649 r">executionContext</span>.<a href="../ExecutionContext.cs.html#287b499ae3f5652b" class="i property">LocationGlobber</a>.<span class="i">GetProviderPath</span>(<span class="r651 r">providedPath</span>, <b>out</b> <span class="r652 r">provider</span>);
 
            <b>var</b> <span id="r653 rd" class="r653 r">isFileSystem</span> = <span class="r652 r">provider</span> != <b>null</b> &amp;&amp;
                               <span class="r652 r">provider</span>.<a href="../DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>.<span class="i">Equals</span>(<a href="../../P/64a92af39f1cd630.html#64a92af39f1cd630" class="t t">FileSystemProvider</a>.<a href="../../namespaces/FileSystemProvider.cs.html#10b665caf52d3382" class="i field">ProviderName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <span class="c">// AutoComplete only if filesystem provider.</span>
            <b>if</b> (<span class="r653 r">isFileSystem</span>)
            {
                <b>if</b> (<span class="r647 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;ItemType&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r646 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>))
                    {
                        <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r654 rd" class="r654 r">patternEvaluator</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r646 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
                        <b>if</b> (<span class="r654 r">patternEvaluator</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="s">&quot;file&quot;</span>))
                        {
                            <span class="r648 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="s">&quot;File&quot;</span>));
                        }
                        <b>else</b> <b>if</b> (<span class="r654 r">patternEvaluator</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="s">&quot;directory&quot;</span>))
                        {
                            <span class="r648 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="s">&quot;Directory&quot;</span>));
                        }
                        <b>else</b> <b>if</b> (<span class="r654 r">patternEvaluator</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="s">&quot;symboliclink&quot;</span>))
                        {
                            <span class="r648 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="s">&quot;SymbolicLink&quot;</span>));
                        }
                        <b>else</b> <b>if</b> (<span class="r654 r">patternEvaluator</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="s">&quot;junction&quot;</span>))
                        {
                            <span class="r648 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="s">&quot;Junction&quot;</span>));
                        }
                        <b>else</b> <b>if</b> (<span class="r654 r">patternEvaluator</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="s">&quot;hardlink&quot;</span>))
                        {
                            <span class="r648 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="s">&quot;HardLink&quot;</span>));
                        }
                    }
                    <b>else</b>
                    {
                        <span class="r648 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="s">&quot;File&quot;</span>));
                        <span class="r648 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="s">&quot;Directory&quot;</span>));
                        <span class="r648 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="s">&quot;SymbolicLink&quot;</span>));
                        <span class="r648 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="s">&quot;Junction&quot;</span>));
                        <span class="r648 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="s">&quot;HardLink&quot;</span>));
                    }
 
                    <span class="r648 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
                }
            }
        }
 
        <b>private static void</b> <a id="cb4fb4800dfc9583" href="../../R/cb4fb4800dfc9583.html" target="n" data-glyph="76,1" class="i method">NativeCompletionCopyMoveItemCommand</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r655 rd" class="r655 r">context</span>, <b>string</b> <span id="r656 rd" class="r656 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r657 rd" class="r657 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r656 r">paramName</span>))
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r656 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;LiteralPath&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) || <span class="r656 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Path&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <a href="#bebbae3048899f74" class="i method">NativeCompletionPathArgument</a>(<span class="r655 r">context</span>, <span class="r656 r">paramName</span>, <span class="r657 r">result</span>);
            }
            <b>else</b> <b>if</b> (<span class="r656 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Destination&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="c">// The parameter Destination for Move-Item and Copy-Item takes literal path</span>
                <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r657 r">result</span>);
 
                <span class="r655 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ??= <b>string</b>.<span class="i">Empty</span>;
                <b>var</b> <span id="r658 rd" class="r658 r">clearLiteralPath</span> = <a href="#2bbbf54fb571efb5" class="i method">TurnOnLiteralPathOption</a>(<span class="r655 r">context</span>);
 
                <b>try</b>
                {
                    <b>var</b> <span id="r659 rd" class="r659 r">fileNameResults</span> = <a href="#729d5ec1cd6162b7" class="i method">CompleteFilename</a>(<span class="r655 r">context</span>);
                    <b>if</b> (<span class="r659 r">fileNameResults</span> != <b>null</b>)
                        <span class="r657 r">result</span>.<span class="i">AddRange</span>(<span class="r659 r">fileNameResults</span>);
                }
                <b>finally</b>
                {
                    <b>if</b> (<span class="r658 r">clearLiteralPath</span>)
                        <span class="r655 r">context</span>.<a href="CompletionAnalysis.cs.html#f3f4d193708c896f" class="i property">Options</a>.<span class="i">Remove</span>(<span class="s">&quot;LiteralPaths&quot;</span>);
                }
 
                <span class="r657 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
            }
        }
 
        <b>private static void</b> <a id="bebbae3048899f74" href="../../R/bebbae3048899f74.html" target="n" data-glyph="76,1" class="i method">NativeCompletionPathArgument</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r660 rd" class="r660 r">context</span>, <b>string</b> <span id="r661 rd" class="r661 r">paramName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r662 rd" class="r662 r">result</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r661 r">paramName</span>) ||
                (!<span class="r661 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;LiteralPath&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                (!<span class="r661 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;Path&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)) &amp;&amp;
                (!<span class="r661 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;FilePath&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))))
            {
                <b>return</b>;
            }
 
            <a href="#67d6affee43a8461" class="i method">RemoveLastNullCompletionResult</a>(<span class="r662 r">result</span>);
 
            <span class="r660 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> ??= <b>string</b>.<span class="i">Empty</span>;
            <b>var</b> <span id="r663 rd" class="r663 r">clearLiteralPath</span> = <b>false</b>;
            <b>if</b> (<span class="r661 r">paramName</span>.<span class="i">Equals</span>(<span class="s">&quot;LiteralPath&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r663 r">clearLiteralPath</span> = <a href="#2bbbf54fb571efb5" class="i method">TurnOnLiteralPathOption</a>(<span class="r660 r">context</span>);
            }
 
            <b>try</b>
            {
                <b>var</b> <span id="r664 rd" class="r664 r">fileNameResults</span> = <a href="#729d5ec1cd6162b7" class="i method">CompleteFilename</a>(<span class="r660 r">context</span>);
                <b>if</b> (<span class="r664 r">fileNameResults</span> != <b>null</b>)
                    <span class="r662 r">result</span>.<span class="i">AddRange</span>(<span class="r664 r">fileNameResults</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (<span class="r663 r">clearLiteralPath</span>)
                    <span class="r660 r">context</span>.<a href="CompletionAnalysis.cs.html#f3f4d193708c896f" class="i property">Options</a>.<span class="i">Remove</span>(<span class="s">&quot;LiteralPaths&quot;</span>);
            }
 
            <span class="r662 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
        }
 
        <b>private static</b> <span class="i">IEnumerable</span>&lt;<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt; <a id="1cdf60b7f8fa2399" href="../../R/1cdf60b7f8fa2399.html" target="n" data-glyph="76,1" class="i method">GetInferenceTypes</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r665 rd" class="r665 r">context</span>, <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r666 rd" class="r666 r">commandAst</span>)
        {
            <span class="c">// Command is something like where-object/foreach-object/format-list/etc. where there is a parameter that is a property name</span>
            <span class="c">// and we want member names based on the input object, which is either the parameter InputObject, or comes from the pipeline.</span>
            <b>if</b> (<span class="r666 r">commandAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is not</b> <a href="../parser/ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r667 rd" class="r667 r">pipelineAst</span>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>int</b> <span id="r668 rd" class="r668 r">i</span>;
            <b>for</b> (<span class="r668 r">i</span> = 0; <span class="r668 r">i</span> &lt; <span class="r667 r">pipelineAst</span>.<a href="../parser/ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>.<span class="i">Count</span>; <span class="r668 r">i</span>++)
            {
                <b>if</b> (<span class="r667 r">pipelineAst</span>.<a href="../parser/ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>[<span class="r668 r">i</span>] == <span class="r666 r">commandAst</span>)
                {
                    <b>break</b>;
                }
            }
 
            <span class="i">IEnumerable</span>&lt;<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt; <span id="r669 rd" class="r669 r">prevType</span> = <b>null</b>;
            <b>if</b> (<span class="r668 r">i</span> == 0)
            {
                <span class="c">// based on a type of the argument which is binded to &#39;InputObject&#39; parameter.</span>
                <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r670 rd" class="r670 r">pair</span>;
                <b>if</b> (!<span class="r665 r">context</span>.<a href="CompletionAnalysis.cs.html#aa0594eac663bfde" class="i property">PseudoBindingInfo</a>.<a href="PseudoParameterBinder.cs.html#0890fafe524fd733" class="i property">BoundArguments</a>.<span class="i">TryGetValue</span>(<span class="s">&quot;InputObject&quot;</span>, <b>out</b> <span class="r670 r">pair</span>)
                    || !<span class="r670 r">pair</span>.<a href="PseudoParameterBinder.cs.html#20b483ea1bf76f76" class="i property">ArgumentSpecified</a>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="k">var</a> <span id="r671 rd" class="r671 r">astPair</span> = <span class="r670 r">pair</span> <b>as</b> <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a>;
                <b>if</b> (<span class="r671 r">astPair</span> == <b>null</b> || <span class="r671 r">astPair</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <span class="r669 r">prevType</span> = <a href="../parser/TypeInferenceVisitor.cs.html#85308821e258515b" class="t t">AstTypeInference</a>.<a href="../parser/TypeInferenceVisitor.cs.html#a161c4fce43bc728" class="i method">InferTypeOf</a>(<span class="r671 r">astPair</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>, <span class="r665 r">context</span>.<a href="CompletionAnalysis.cs.html#95d0769179a8633b" class="i property">TypeInferenceContext</a>, <a href="../parser/TypeInferenceVisitor.cs.html#c79f5fa1494e528d" class="t t">TypeInferenceRuntimePermissions</a>.<a href="../parser/TypeInferenceVisitor.cs.html#8df46f8adea8c4e2" class="i field">AllowSafeEval</a>);
            }
            <b>else</b>
            {
                <span class="c">// based on OutputTypeAttribute() of the first cmdlet in pipeline.</span>
                <span class="r669 r">prevType</span> = <a href="../parser/TypeInferenceVisitor.cs.html#85308821e258515b" class="t t">AstTypeInference</a>.<span class="i">InferTypeOf</span>(<span class="r667 r">pipelineAst</span>.<a href="../parser/ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>[<span class="r668 r">i</span> - 1], <span class="r665 r">context</span>.<a href="CompletionAnalysis.cs.html#95d0769179a8633b" class="i property">TypeInferenceContext</a>, <a href="../parser/TypeInferenceVisitor.cs.html#c79f5fa1494e528d" class="t t">TypeInferenceRuntimePermissions</a>.<a href="../parser/TypeInferenceVisitor.cs.html#8df46f8adea8c4e2" class="i field">AllowSafeEval</a>);
            }
 
            <b>return</b> <span class="r669 r">prevType</span>;
        }
 
        <b>private static void</b> <a id="1cd0bbbf57ec35bd" href="../../R/1cd0bbbf57ec35bd.html" target="n" data-glyph="76,1" class="i method">NativeCompletionMemberName</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r672 rd" class="r672 r">context</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r673 rd" class="r673 r">result</span>, <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r674 rd" class="r674 r">commandAst</span>)
        {
            <span class="i">IEnumerable</span>&lt;<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt; <span id="r675 rd" class="r675 r">prevType</span> = <a href="#1cdf60b7f8fa2399" class="i method">GetInferenceTypes</a>(<span class="r672 r">context</span>, <span class="r674 r">commandAst</span>);
            <b>if</b> (<span class="r675 r">prevType</span> <b>is not null</b>)
            {
                <span class="i">CompleteMemberByInferredType</span>(<span class="r672 r">context</span>.<a href="CompletionAnalysis.cs.html#95d0769179a8633b" class="i property">TypeInferenceContext</a>, <span class="r675 r">prevType</span>, <span class="r673 r">result</span>, <span class="r672 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> + <span class="s">&quot;*&quot;</span>, <span class="i">filter</span>: <span class="i">IsPropertyMember</span>, <span class="i">isStatic</span>: <b>false</b>);
            }
 
            <span class="r673 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
        }
 
        <b>private static void</b> <a id="1e38d0227f2fba69" href="../../R/1e38d0227f2fba69.html" target="n" data-glyph="76,1" class="i method">NativeCompletionFormatViewName</a>(
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r676 rd" class="r676 r">context</span>,
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r677 rd" class="r677 r">boundArguments</span>,
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r678 rd" class="r678 r">result</span>,
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r679 rd" class="r679 r">commandAst</span>,
            <b>string</b> <span id="r680 rd" class="r680 r">commandName</span>)
        {
            <span class="i">IEnumerable</span>&lt;<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt; <span id="r681 rd" class="r681 r">prevType</span> = <a href="#b0cb9c13674b4be8" class="i method">NativeCommandArgumentCompletion_InferTypesOfArgument</a>(<span class="r677 r">boundArguments</span>, <span class="r679 r">commandAst</span>, <span class="r676 r">context</span>, <span class="s">&quot;InputObject&quot;</span>);
 
            <b>if</b> (<span class="r681 r">prevType</span> <b>is not null</b>)
            {
                <b>string</b>[] <span id="r682 rd" class="r682 r">inferTypeNames</span> = <span class="r681 r">prevType</span>.<span class="i">Select</span>(<span id="r683 rd" class="r683 r">t</span> =&gt; <span class="r683 r">t</span>.<span class="i">Name</span>).<span class="i">ToArray</span>();
                <a href="#fde322ecd5cf5546" class="i method">CompleteFormatViewByInferredType</a>(<span class="r676 r">context</span>, <span class="r682 r">inferTypeNames</span>, <span class="r678 r">result</span>, <span class="r680 r">commandName</span>);
            }
 
            <span class="r678 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
        }
 
        <b>private static void</b> <a id="0856cf0848606af5" href="../../R/0856cf0848606af5.html" target="n" data-glyph="76,1" class="i method">NativeCompletionTypeName</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r684 rd" class="r684 r">context</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r685 rd" class="r685 r">result</span>)
        {
            <b>var</b> <span id="r686 rd" class="r686 r">wordToComplete</span> = <span class="r684 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>;
            <b>var</b> <span id="r687 rd" class="r687 r">isQuoted</span> = <span class="r686 r">wordToComplete</span>.<span class="i">Length</span> &gt; 0 &amp;&amp; (<span class="r686 r">wordToComplete</span>[0].<span class="i">IsSingleQuote</span>() || <span class="r686 r">wordToComplete</span>[0].<span class="i">IsDoubleQuote</span>());
            <b>string</b> <span id="r688 rd" class="r688 r">prefix</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>string</b> <span id="r689 rd" class="r689 r">suffix</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (<span class="r687 r">isQuoted</span>)
            {
                <span class="r688 r">prefix</span> = <span class="r689 r">suffix</span> = <span class="r686 r">wordToComplete</span>.<span class="i">Substring</span>(0, 1);
 
                <b>var</b> <span id="r690 rd" class="r690 r">endQuoted</span> = (<span class="r686 r">wordToComplete</span>.<span class="i">Length</span> &gt; 1) &amp;&amp; <span class="r686 r">wordToComplete</span>[<span class="r686 r">wordToComplete</span>.<span class="i">Length</span> - 1] == <span class="r686 r">wordToComplete</span>[0];
                <span class="r686 r">wordToComplete</span> = <span class="r686 r">wordToComplete</span>.<span class="i">Substring</span>(1, <span class="r686 r">wordToComplete</span>.<span class="i">Length</span> - (<span class="r690 r">endQuoted</span> ? 2 : 1));
            }
 
            <b>if</b> (<span class="r686 r">wordToComplete</span>.<span class="i">Contains</span>(<span class="s">&#39;[&#39;</span>))
            {
                <a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="k">var</a> <span id="r691 rd" class="r691 r">cursor</span> = (<a href="../parser/Position.cs.html#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a>)<span class="r684 r">context</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>;
                <span class="r691 r">cursor</span> = <span class="r691 r">cursor</span>.<span class="i">CloneWithNewOffset</span>(<span class="r691 r">cursor</span>.<a href="../parser/Position.cs.html#ae983dad2327d7fd" class="i property">Offset</a> - <span class="r684 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> - (<span class="r687 r">isQuoted</span> ? 1 : 0));
                <a href="../parser/ast.cs.html#a422e1772da6dbc8" class="k">var</a> <span id="r692 rd" class="r692 r">fullTypeName</span> = <a href="../parser/Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="../parser/Parser.cs.html#48b79e78a1e64334" class="i method">ScanType</a>(<span class="r686 r">wordToComplete</span>, <span class="r693 r">ignoreErrors</span>: <b>true</b>);
                <a href="../parser/ast.cs.html#83b43c1855a09e15" class="k">var</a> <span id="r694 rd" class="r694 r">typeNameToComplete</span> = <a href="CompletionAnalysis.cs.html#978ec9faf3baf106" class="t t">CompletionAnalysis</a>.<a href="CompletionAnalysis.cs.html#7b63557478b3594a" class="i method">FindTypeNameToComplete</a>(<span class="r692 r">fullTypeName</span>, <span class="r691 r">cursor</span>);
                <b>if</b> (<span class="r694 r">typeNameToComplete</span> == <b>null</b>)
                    <b>return</b>;
 
                <b>var</b> <span id="r695 rd" class="r695 r">openBrackets</span> = 0;
                <b>var</b> <span id="r696 rd" class="r696 r">closeBrackets</span> = 0;
                <b>foreach</b> (<b>char</b> <span id="r697 rd" class="r697 r">c</span> <b>in</b> <span class="r686 r">wordToComplete</span>)
                {
                    <b>if</b> (<span class="r697 r">c</span> == <span class="s">&#39;[&#39;</span>) <span class="r695 r">openBrackets</span> += 1;
                    <b>else</b> <b>if</b> (<span class="r697 r">c</span> == <span class="s">&#39;]&#39;</span>) <span class="r696 r">closeBrackets</span> += 1;
                }
 
                <span class="r686 r">wordToComplete</span> = <span class="r694 r">typeNameToComplete</span>.<a href="../parser/ast.cs.html#5d27e8e58d692064" class="i property">FullName</a>;
                <b>var</b> <span id="r698 rd" class="r698 r">typeNameText</span> = <span class="r692 r">fullTypeName</span>.<a href="../parser/ast.cs.html#2b8e897172d31016" class="i property">Extent</a>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>;
                <b>if</b> (!<span class="r687 r">isQuoted</span>)
                {
                    <span class="c">// We need to add quotes - the square bracket messes up parsing the argument</span>
                    <span class="r688 r">prefix</span> = <span class="r689 r">suffix</span> = <span class="s">&quot;&#39;&quot;</span>;
                }
 
                <b>if</b> (<span class="r696 r">closeBrackets</span> &lt; <span class="r695 r">openBrackets</span>)
                {
                    <span class="r689 r">suffix</span> = <span class="r689 r">suffix</span>.<span class="i">Insert</span>(0, <b>new</b> <b>string</b>(<span class="s">&#39;]&#39;</span>, (<span class="r695 r">openBrackets</span> - <span class="r696 r">closeBrackets</span>)));
                }
 
                <b>if</b> (<span class="r687 r">isQuoted</span> &amp;&amp; <span class="r696 r">closeBrackets</span> == <span class="r695 r">openBrackets</span>)
                {
                    <span class="c">// Already quoted, and has matching [].  We can give a better Intellisense experience</span>
                    <span class="c">// if we only replace the minimum.</span>
                    <span class="r684 r">context</span>.<a href="CompletionAnalysis.cs.html#2d472ecad9988a80" class="i property">ReplacementIndex</a> = <span class="r694 r">typeNameToComplete</span>.<a href="../parser/ast.cs.html#1ce6d6f63fe6922f" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> + <span class="r684 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> + 1;
                    <span class="r684 r">context</span>.<a href="CompletionAnalysis.cs.html#c219030db690057a" class="i property">ReplacementLength</a> = <span class="r686 r">wordToComplete</span>.<span class="i">Length</span>;
                    <span class="r688 r">prefix</span> = <span class="r689 r">suffix</span> = <b>string</b>.<span class="i">Empty</span>;
                }
                <b>else</b>
                {
                    <span class="r688 r">prefix</span> += <span class="r698 r">typeNameText</span>.<span class="i">Substring</span>(0, <span class="r694 r">typeNameToComplete</span>.<a href="../parser/ast.cs.html#1ce6d6f63fe6922f" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>);
                    <span class="r689 r">suffix</span> = <span class="r689 r">suffix</span>.<span class="i">Insert</span>(0, <span class="r698 r">typeNameText</span>.<span class="i">Substring</span>(<span class="r694 r">typeNameToComplete</span>.<a href="../parser/ast.cs.html#1ce6d6f63fe6922f" class="i property">Extent</a>.<a href="../parser/Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a>));
                }
            }
 
            <span class="r684 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r686 r">wordToComplete</span>;
 
            <b>var</b> <span id="r699 rd" class="r699 r">typeResults</span> = <a href="#57017baf59ddb34d" class="i method">CompleteType</a>(<span class="r684 r">context</span>, <span class="r688 r">prefix</span>, <span class="r689 r">suffix</span>);
            <b>if</b> (<span class="r699 r">typeResults</span> != <b>null</b>)
            {
                <span class="r685 r">result</span>.<span class="i">AddRange</span>(<span class="r699 r">typeResults</span>);
            }
 
            <span class="r685 r">result</span>.<span class="i">Add</span>(<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>.<a href="CompletionResult.cs.html#9a067b23e123e28d" class="i property">Null</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Native Command Argument Completion
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Find the positional argument at the specific position from the parsed argument list.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r700 r">parsedArguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r701 r">position</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r702 r">lastPositionalArgument</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the command line after the [tab] will not be truncated, the return value could be non-null: Get-Cmdlet [tab] abc</span>
        <span class="c">///</span><span class="c"> If the command line after the [tab] is truncated, the return value will always be null</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a> <a id="7d394c018fb20d47" href="../../R/7d394c018fb20d47.html" target="n" data-glyph="76,1" class="i method">FindTargetPositionalArgument</a>(<span class="i">Collection</span>&lt;<a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r700 rd" class="r700 r">parsedArguments</span>, <b>int</b> <span id="r701 rd" class="r701 r">position</span>, <b>out</b> <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a> <span id="r702 rd" class="r702 r">lastPositionalArgument</span>)
        {
            <b>int</b> <span id="r703 rd" class="r703 r">index</span> = 0;
            <span class="r702 r">lastPositionalArgument</span> = <b>null</b>;
            <b>foreach</b> (<a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r704 rd" class="r704 r">pair</span> <b>in</b> <span class="r700 r">parsedArguments</span>)
            {
                <b>if</b> (!<span class="r704 r">pair</span>.<a href="PseudoParameterBinder.cs.html#ee5926fcf99682f5" class="i property">ParameterSpecified</a> &amp;&amp; <span class="r703 r">index</span> == <span class="r701 r">position</span>)
                    <b>return</b> (<a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a>)<span class="r704 r">pair</span>;
                <b>else</b> <b>if</b> (!<span class="r704 r">pair</span>.<a href="PseudoParameterBinder.cs.html#ee5926fcf99682f5" class="i property">ParameterSpecified</a>)
                {
                    <span class="r703 r">index</span>++;
                    <span class="r702 r">lastPositionalArgument</span> = (<a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a>)<span class="r704 r">pair</span>;
                }
            }
 
            <span class="c">// Cannot find an existing positional argument at &#39;position&#39;</span>
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Find the location where &#39;tab&#39; is typed based on the line and column.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <a href="#522c290efaf3eb7d" class="t t">ArgumentLocation</a> <a id="d19ff4b66c1ea4ed" href="../../R/d19ff4b66c1ea4ed.html" target="n" data-glyph="76,1" class="i method">FindTargetArgumentLocation</a>(<span class="i">Collection</span>&lt;<a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r705 rd" class="r705 r">parsedArguments</span>, <a href="../parser/token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r706 rd" class="r706 r">token</span>)
        {
            <b>int</b> <span id="r707 rd" class="r707 r">position</span> = 0;
            <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r708 rd" class="r708 r">prevArg</span> = <b>null</b>;
            <b>foreach</b> (<a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r709 rd" class="r709 r">pair</span> <b>in</b> <span class="r705 r">parsedArguments</span>)
            {
                <b>switch</b> (<span class="r709 r">pair</span>.<a href="PseudoParameterBinder.cs.html#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a>)
                {
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#409b194c1cec01fc" class="i field">AstPair</a>:
                        {
                            <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="k">var</a> <span id="r710 rd" class="r710 r">arg</span> = (<a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a>)<span class="r709 r">pair</span>;
                            <b>if</b> (<span class="r710 r">arg</span>.<a href="PseudoParameterBinder.cs.html#ee5926fcf99682f5" class="i property">ParameterSpecified</a>)
                            {
                                <span class="c">// Named argument</span>
                                <b>if</b> (<span class="r710 r">arg</span>.<a href="PseudoParameterBinder.cs.html#72c3e7cefee2f768" class="i property">Parameter</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> &gt; <span class="r706 r">token</span>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>)
                                {
                                    <span class="c">// case: Get-Cmdlet &lt;tab&gt; -Param abc</span>
                                    <b>return</b> <a href="#05d6ce02e3190bc9" class="i method">GenerateArgumentLocation</a>(<span class="r708 r">prevArg</span>, <span class="r707 r">position</span>);
                                }
 
                                <b>if</b> (!<span class="r710 r">arg</span>.<a href="PseudoParameterBinder.cs.html#a8ce790d560597c7" class="i property">ParameterContainsArgument</a> &amp;&amp; <span class="r710 r">arg</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> &gt; <span class="r706 r">token</span>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>)
                                {
                                    <span class="c">// case: Get-Cmdlet -Param &lt;tab&gt; abc</span>
                                    <b>return</b> <b>new</b> <span class="t">ArgumentLocation</span>() { <a href="#245629496e4946e2" class="i property">Argument</a> = <span class="r710 r">arg</span>, <a href="#3091dd81c57d0646" class="i property">IsPositional</a> = <b>false</b>, <a href="#33135be11a585538" class="i property">Position</a> = -1 };
                                }
                            }
                            <b>else</b>
                            {
                                <span class="c">// Positional argument</span>
                                <b>if</b> (<span class="r710 r">arg</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> &gt; <span class="r706 r">token</span>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>)
                                {
                                    <span class="c">// case: Get-Cmdlet &lt;tab&gt; abc</span>
                                    <b>return</b> <a href="#05d6ce02e3190bc9" class="i method">GenerateArgumentLocation</a>(<span class="r708 r">prevArg</span>, <span class="r707 r">position</span>);
                                }
 
                                <span class="r707 r">position</span>++;
                            }
 
                            <span class="r708 r">prevArg</span> = <span class="r710 r">arg</span>;
                        }
 
                        <b>break</b>;
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#9aaa905ba785afb7" class="i field">Fake</a>:
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#6caa5fee113f4237" class="i field">Switch</a>:
                        {
                            <b>if</b> (<span class="r709 r">pair</span>.<a href="PseudoParameterBinder.cs.html#72c3e7cefee2f768" class="i property">Parameter</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> &gt; <span class="r706 r">token</span>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>)
                            {
                                <b>return</b> <a href="#05d6ce02e3190bc9" class="i method">GenerateArgumentLocation</a>(<span class="r708 r">prevArg</span>, <span class="r707 r">position</span>);
                            }
 
                            <span class="r708 r">prevArg</span> = <span class="r709 r">pair</span>;
                        }
 
                        <b>break</b>;
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#a7afade9bdc8b534" class="i field">AstArray</a>:
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#ac5fbd8418f369ff" class="i field">PipeObject</a>:
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;parsed arguments should not contain AstArray and PipeObject&quot;</span>);
                        <b>break</b>;
                }
            }
 
            <span class="c">// The &#39;tab&#39; should be typed after the last argument</span>
            <b>return</b> <a href="#05d6ce02e3190bc9" class="i method">GenerateArgumentLocation</a>(<span class="r708 r">prevArg</span>, <span class="r707 r">position</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r711 r">prev</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The argument that is right before the &#39;tab&#39; location.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r712 r">position</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The number of positional arguments before the &#39;tab&#39; location.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="#522c290efaf3eb7d" class="t t">ArgumentLocation</a> <a id="05d6ce02e3190bc9" href="../../R/05d6ce02e3190bc9.html" target="n" data-glyph="76,1" class="i method">GenerateArgumentLocation</a>(<a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r711 rd" class="r711 r">prev</span>, <b>int</b> <span id="r712 rd" class="r712 r">position</span>)
        {
            <span class="c">// Tab is typed before the first argument</span>
            <b>if</b> (<span class="r711 r">prev</span> == <b>null</b>)
            {
                <b>return</b> <b>new</b> <span class="t">ArgumentLocation</span>() { <a href="#245629496e4946e2" class="i property">Argument</a> = <b>null</b>, <a href="#3091dd81c57d0646" class="i property">IsPositional</a> = <b>true</b>, <a href="#33135be11a585538" class="i property">Position</a> = 0 };
            }
 
            <b>switch</b> (<span class="r711 r">prev</span>.<a href="PseudoParameterBinder.cs.html#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a>)
            {
                <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#409b194c1cec01fc" class="i field">AstPair</a>:
                <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#6caa5fee113f4237" class="i field">Switch</a>:
                    <b>if</b> (!<span class="r711 r">prev</span>.<a href="PseudoParameterBinder.cs.html#ee5926fcf99682f5" class="i property">ParameterSpecified</a>)
                        <b>return</b> <b>new</b> <span class="t">ArgumentLocation</span>() { <a href="#245629496e4946e2" class="i property">Argument</a> = <b>null</b>, <a href="#3091dd81c57d0646" class="i property">IsPositional</a> = <b>true</b>, <a href="#33135be11a585538" class="i property">Position</a> = <span class="r712 r">position</span> };
 
                    <b>return</b> <span class="r711 r">prev</span>.<a href="PseudoParameterBinder.cs.html#72c3e7cefee2f768" class="i property">Parameter</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>.<span class="i">EndsWith</span>(<span class="s">&#39;:&#39;</span>)
                        ? <b>new</b> <span class="t">ArgumentLocation</span>() { <a href="#245629496e4946e2" class="i property">Argument</a> = <span class="r711 r">prev</span>, <a href="#3091dd81c57d0646" class="i property">IsPositional</a> = <b>false</b>, <a href="#33135be11a585538" class="i property">Position</a> = -1 }
 
                        : <b>new</b> <span class="t">ArgumentLocation</span>() { <a href="#245629496e4946e2" class="i property">Argument</a> = <b>null</b>, <a href="#3091dd81c57d0646" class="i property">IsPositional</a> = <b>true</b>, <a href="#33135be11a585538" class="i property">Position</a> = <span class="r712 r">position</span> };
                <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#9aaa905ba785afb7" class="i field">Fake</a>:
                    <b>return</b> <b>new</b> <span class="t">ArgumentLocation</span>() { <a href="#245629496e4946e2" class="i property">Argument</a> = <span class="r711 r">prev</span>, <a href="#3091dd81c57d0646" class="i property">IsPositional</a> = <b>false</b>, <a href="#33135be11a585538" class="i property">Position</a> = -1 };
                <b>default</b>:
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;parsed arguments should not contain AstArray and PipeObject&quot;</span>);
                    <b>return</b> <b>null</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Find the location where &#39;tab&#39; is typed based on the expressionAst.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r713 r">parsedArguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r714 r">expAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="#522c290efaf3eb7d" class="t t">ArgumentLocation</a> <a id="e25a2913dc84acab" href="../../R/e25a2913dc84acab.html" target="n" data-glyph="76,1" class="i method">FindTargetArgumentLocation</a>(<span class="i">Collection</span>&lt;<a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r713 rd" class="r713 r">parsedArguments</span>, <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r714 rd" class="r714 r">expAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r714 r">expAst</span> != <b>null</b>, <span class="s">&quot;Caller needs to make sure expAst is not null&quot;</span>);
            <b>int</b> <span id="r715 rd" class="r715 r">position</span> = 0;
            <b>foreach</b> (<a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r716 rd" class="r716 r">pair</span> <b>in</b> <span class="r713 r">parsedArguments</span>)
            {
                <b>switch</b> (<span class="r716 r">pair</span>.<a href="PseudoParameterBinder.cs.html#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a>)
                {
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#409b194c1cec01fc" class="i field">AstPair</a>:
                        {
                            <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a> <span id="r717 rd" class="r717 r">arg</span> = (<a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a>)<span class="r716 r">pair</span>;
                            <b>if</b> (<span class="r717 r">arg</span>.<a href="PseudoParameterBinder.cs.html#e1c4a25087b9c0e3" class="i property">ArgumentIsCommandParameterAst</a>)
                                <b>continue</b>;
 
                            <b>if</b> (<span class="r717 r">arg</span>.<a href="PseudoParameterBinder.cs.html#a8ce790d560597c7" class="i property">ParameterContainsArgument</a> &amp;&amp; <span class="r717 r">arg</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a> == <span class="r714 r">expAst</span>)
                            {
                                <b>return</b> <b>new</b> <span class="t">ArgumentLocation</span>() { <a href="#3091dd81c57d0646" class="i property">IsPositional</a> = <b>false</b>, <a href="#33135be11a585538" class="i property">Position</a> = -1, <a href="#245629496e4946e2" class="i property">Argument</a> = <span class="r717 r">arg</span> };
                            }
 
                            <b>if</b> (<span class="r717 r">arg</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>.<span class="i">GetHashCode</span>() == <span class="r714 r">expAst</span>.<span class="i">GetHashCode</span>())
                            {
                                <b>return</b> <span class="r717 r">arg</span>.<a href="PseudoParameterBinder.cs.html#ee5926fcf99682f5" class="i property">ParameterSpecified</a> ?
                                    <b>new</b> <span class="t">ArgumentLocation</span>() { <a href="#3091dd81c57d0646" class="i property">IsPositional</a> = <b>false</b>, <a href="#33135be11a585538" class="i property">Position</a> = -1, <a href="#245629496e4946e2" class="i property">Argument</a> = <span class="r717 r">arg</span> } :
                                    <b>new</b> <span class="t">ArgumentLocation</span>() { <a href="#3091dd81c57d0646" class="i property">IsPositional</a> = <b>true</b>, <a href="#33135be11a585538" class="i property">Position</a> = <span class="r715 r">position</span>, <a href="#245629496e4946e2" class="i property">Argument</a> = <span class="r717 r">arg</span> };
                            }
 
                            <b>if</b> (!<span class="r717 r">arg</span>.<a href="PseudoParameterBinder.cs.html#ee5926fcf99682f5" class="i property">ParameterSpecified</a>)
                                <span class="r715 r">position</span>++;
                        }
 
                        <b>break</b>;
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#9aaa905ba785afb7" class="i field">Fake</a>:
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#6caa5fee113f4237" class="i field">Switch</a>:
                        <span class="c">// FakePair and SwitchPair contains no ExpressionAst</span>
                        <b>break</b>;
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#a7afade9bdc8b534" class="i field">AstArray</a>:
                    <b>case</b> <a href="PseudoParameterBinder.cs.html#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="PseudoParameterBinder.cs.html#ac5fbd8418f369ff" class="i field">PipeObject</a>:
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;parsed arguments should not contain AstArray and PipeObject arguments&quot;</span>);
                        <b>break</b>;
                }
            }
 
            <span class="c">// We should be able to find the ExpAst from the parsed argument list, if all parameters was specified correctly.</span>
            <span class="c">// We may try to complete something incorrect</span>
            <span class="c">// ls -Recurse -QQQ qwe&lt;+tab&gt;</span>
            <b>return</b> <b>null</b>;
        }
 
        <b>private sealed class</b> <a id="522c290efaf3eb7d" href="../../R/522c290efaf3eb7d.html" target="n" data-glyph="4,1" class="t t"><span id="86aa702ce630cace">ArgumentLocation</span></a>
        {
            <b>internal bool</b> <a id="3091dd81c57d0646" href="../../R/3091dd81c57d0646.html" target="n" data-glyph="104,2" class="i property">IsPositional</a> { <b>get</b>; <b>set</b>; }
 
            <b>internal int</b> <a id="33135be11a585538" href="../../R/33135be11a585538.html" target="n" data-glyph="104,2" class="i property">Position</a> { <b>get</b>; <b>set</b>; }
 
            <b>internal</b> <a href="PseudoParameterBinder.cs.html#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <a id="245629496e4946e2" href="../../R/245629496e4946e2.html" target="n" data-glyph="104,2" class="i property">Argument</a> { <b>get</b>; <b>set</b>; }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Command Arguments
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Filenames
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r718 r">fileName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>)]
        <b>public static</b> <span class="i">IEnumerable</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="a6623c692587b1c4" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CompleteFilename</a>(<b>string</b> <span id="r718 rd" class="r718 r">fileName</span>)
        {
            <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="k">var</a> <span id="r719 rd" class="r719 r">runspace</span> = <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>;
            <b>if</b> (<span class="r719 r">runspace</span> == <b>null</b>)
            {
                <span class="c">// No runspace, just return no results.</span>
                <b>return</b> <a href="CommandCompletion.cs.html#a9d35cade4030f50" class="t t">CommandCompletion</a>.<a href="CommandCompletion.cs.html#13ad720861798479" class="i field">EmptyCompletionResult</a>;
            }
 
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r720 rd" class="r720 r">helper</span> = <b>new</b> <a href="../../utils/PowerShellExecutionHelper.cs.html#b251f5b816b2dd25" class="t constructor">PowerShellExecutionHelper</a>(<a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#1c6a51d3c837bb4d" class="i method">Create</a>(<a href="../hostifaces/PowerShell.cs.html#c3c0f0e5e0b337ff" class="t t">RunspaceMode</a>.<a href="../hostifaces/PowerShell.cs.html#75d224de5df87e75" class="i field">CurrentRunspace</a>));
            <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r721 rd" class="r721 r">executionContext</span> = <span class="r720 r">helper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ddb7ad1950c8ea20" class="i property">CurrentPowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a>.<a href="../hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>;
            <b>return</b> <a href="#729d5ec1cd6162b7" class="i method">CompleteFilename</a>(<b>new</b> <span class="t">CompletionContext</span> { <a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r718 r">fileName</span>, <a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a> = <span class="r720 r">helper</span>, <a href="CompletionAnalysis.cs.html#4055c622a2008ac8" class="i property">ExecutionContext</a> = <span class="r721 r">executionContext</span> });
        }
 
        <b>internal static</b> <span class="i">IEnumerable</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="729d5ec1cd6162b7" href="../../R/729d5ec1cd6162b7.html" target="n" data-glyph="74,1" class="i method">CompleteFilename</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r722 rd" class="r722 r">context</span>)
        {
            <b>return</b> <a href="#f23c14b94c0c013f" class="i method">CompleteFilename</a>(<span class="r722 r">context</span>, <span class="r95 r">containerOnly</span>: <b>false</b>, <span class="r96 r">extension</span>: <b>null</b>);
        }
 
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>)]
        <b>internal static</b> <span class="i">IEnumerable</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="f23c14b94c0c013f" href="../../R/f23c14b94c0c013f.html" target="n" data-glyph="74,1" class="i method">CompleteFilename</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r723 rd" class="r723 r">context</span>, <b>bool</b> <span id="r95 rd" class="r95 r">containerOnly</span>, <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r96 rd" class="r96 r">extension</span>)
        {
            <b>var</b> <span id="r724 rd" class="r724 r">wordToComplete</span> = <span class="r723 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>;
            <b>var</b> <span id="r725 rd" class="r725 r">quote</span> = <a href="#944eddaabbba5d42" class="i method">HandleDoubleAndSingleQuote</a>(<b>ref</b> <span class="r724 r">wordToComplete</span>);
            <b>var</b> <span id="r726 rd" class="r726 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
 
            <span class="c">// First, try to match \\server\share</span>
            <b>var</b> <span id="r727 rd" class="r727 r">shareMatch</span> = <span class="i">Regex</span>.<span class="i">Match</span>(<span class="r724 r">wordToComplete</span>, <span class="s">&quot;^\\\\\\\\([^\\\\]+)\\\\([^\\\\]*)$&quot;</span>);
            <b>if</b> (<span class="r727 r">shareMatch</span>.<span class="i">Success</span>)
            {
                <span class="c">// Only match share names, no filenames.</span>
                <b>var</b> <span id="r728 rd" class="r728 r">server</span> = <span class="r727 r">shareMatch</span>.<span class="i">Groups</span>[1].<span class="i">Value</span>;
                <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r729 rd" class="r729 r">sharePattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r727 r">shareMatch</span>.<span class="i">Groups</span>[2].<span class="i">Value</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                <b>var</b> <span id="r730 rd" class="r730 r">ignoreHidden</span> = <span class="r723 r">context</span>.<a href="CompletionAnalysis.cs.html#21758d2e318f92cc" class="i method">GetOption</a>(<span class="s">&quot;IgnoreHiddenShares&quot;</span>, <span class="r731 r">@default</span>: <b>false</b>);
                <b>var</b> <span id="r732 rd" class="r732 r">shares</span> = <span class="i">GetFileShares</span>(<span class="r728 r">server</span>, <span class="r730 r">ignoreHidden</span>);
                <b>foreach</b> (<b>var</b> <span id="r733 rd" class="r733 r">share</span> <b>in</b> <span class="r732 r">shares</span>)
                {
                    <b>if</b> (<span class="r729 r">sharePattern</span>.<span class="i">IsMatch</span>(<span class="r733 r">share</span>))
                    {
                        <b>string</b> <span id="r734 rd" class="r734 r">shareFullPath</span> = <span class="s">&quot;\\\\&quot;</span> + <span class="r728 r">server</span> + <span class="s">&quot;\\&quot;</span> + <span class="r733 r">share</span>;
                        <b>if</b> (<span class="r725 r">quote</span> != <b>string</b>.<span class="i">Empty</span>)
                        {
                            <span class="r734 r">shareFullPath</span> = <span class="r725 r">quote</span> + <span class="r734 r">shareFullPath</span> + <span class="r725 r">quote</span>;
                        }
 
                        <span class="r726 r">results</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r734 r">shareFullPath</span>, <span class="r734 r">shareFullPath</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#f4f151a5480e81af" class="i field">ProviderContainer</a>, <span class="r734 r">shareFullPath</span>));
                    }
                }
            }
            <b>else</b>
            {
                <span class="c">// We want to prefer relative paths in a completion result unless the user has already</span>
                <span class="c">// specified a drive or portion of the path.</span>
                <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r735 rd" class="r735 r">executionContext</span> = <span class="r723 r">context</span>.<a href="CompletionAnalysis.cs.html#4055c622a2008ac8" class="i property">ExecutionContext</a>;
                <b>var</b> <span id="r736 rd" class="r736 r">defaultRelative</span> = <b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r724 r">wordToComplete</span>)
                                      || (<span class="r724 r">wordToComplete</span>.<span class="i">IndexOfAny</span>(<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../Utils.cs.html#182cf4a18b62de18" class="i field">Directory</a>) != 0 &amp;&amp;
                                          !<span class="i">Regex</span>.<span class="i">Match</span>(<span class="r724 r">wordToComplete</span>, <span class="s">@&quot;^~[\\/]+.*&quot;</span>).<span class="i">Success</span> &amp;&amp;
                                          !<span class="r735 r">executionContext</span>.<a href="../ExecutionContext.cs.html#287b499ae3f5652b" class="i property">LocationGlobber</a>.<a href="../../namespaces/LocationGlobber.cs.html#05183b55d060d7bb" class="i method">IsAbsolutePath</a>(<span class="r724 r">wordToComplete</span>, <b>out _</b>));
                <b>var</b> <span id="r737 rd" class="r737 r">relativePaths</span> = <span class="r723 r">context</span>.<span class="i">GetOption</span>(<span class="s">&quot;RelativePaths&quot;</span>, <span class="i">@default</span>: <span class="r736 r">defaultRelative</span>);
                <b>var</b> <span id="r738 rd" class="r738 r">useLiteralPath</span> = <span class="r723 r">context</span>.<a href="CompletionAnalysis.cs.html#21758d2e318f92cc" class="i method">GetOption</a>(<span class="s">&quot;LiteralPaths&quot;</span>, <span class="r731 r">@default</span>: <b>false</b>);
 
                <b>if</b> (<span class="r738 r">useLiteralPath</span> &amp;&amp; <a href="../../namespaces/LocationGlobber.cs.html#6387d90abe0ca584" class="t t">LocationGlobber</a>.<a href="../../namespaces/LocationGlobber.cs.html#be9734ddba52229e" class="i method">StringContainsGlobCharacters</a>(<span class="r724 r">wordToComplete</span>))
                {
                    <span class="r724 r">wordToComplete</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#9ba1c4a3b0b47d6a" class="i method">Escape</a>(<span class="r724 r">wordToComplete</span>, <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6fd6d3492cb91f87" class="t t">Separators</a>.<a href="../Utils.cs.html#8bdf3580e6bcbb80" class="i field">StarOrQuestion</a>);
                }
 
                <b>if</b> (!<span class="r736 r">defaultRelative</span> &amp;&amp; <span class="r724 r">wordToComplete</span>.<span class="i">Length</span> &gt;= 2 &amp;&amp; <span class="r724 r">wordToComplete</span>[1] == <span class="s">&#39;:&#39;</span> &amp;&amp; <b>char</b>.<span class="i">IsLetter</span>(<span class="r724 r">wordToComplete</span>[0]) &amp;&amp; <span class="r735 r">executionContext</span> != <b>null</b>)
                {
                    <span class="c">// We don&#39;t actually need the drive, but the drive must be &quot;mounted&quot; in PowerShell before completion</span>
                    <span class="c">// can succeed.  This call will mount the drive if it wasn&#39;t already.</span>
                    <span class="r735 r">executionContext</span>.<a href="../ExecutionContext.cs.html#4502619a6e4808ee" class="i property">SessionState</a>.<a href="../SessionStatePublic.cs.html#49ff6e2d0769f2e2" class="i property">Drive</a>.<span class="i">GetAtScope</span>(<span class="r724 r">wordToComplete</span>.<span class="i">Substring</span>(0, 1), <span class="s">&quot;global&quot;</span>);
                }
 
                <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r739 rd" class="r739 r">powerShellExecutionHelper</span> = <span class="r723 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
                <span class="r739 r">powerShellExecutionHelper</span>
                    .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Resolve-Path&quot;</span>)
                    .<span class="i">AddParameter</span>(<span class="s">&quot;Path&quot;</span>, <span class="r724 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>);
 
                <span class="i">Exception</span> <span id="r740 rd" class="r740 r">exceptionThrown</span>;
                <b>var</b> <span id="r741 rd" class="r741 r">psobjs</span> = <span class="r739 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r740 r">exceptionThrown</span>);
 
                <b>if</b> (<span class="r741 r">psobjs</span> != <b>null</b>)
                {
                    <b>var</b> <span id="r742 rd" class="r742 r">isFileSystem</span> = <b>false</b>;
                    <b>var</b> <span id="r743 rd" class="r743 r">wordContainsProviderId</span> = <a href="#d1c5d9bdceb0cae3" class="i method">ProviderSpecified</a>(<span class="r724 r">wordToComplete</span>);
 
                    <b>if</b> (<span class="r741 r">psobjs</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <b>dynamic</b> <span id="r744 rd" class="r744 r">firstObj</span> = <span class="r741 r">psobjs</span>[0];
                        <a href="../DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="k">var</a> <span id="r745 rd" class="r745 r">provider</span> = <span class="r744 r">firstObj</span>.<span class="i">Provider</span> <b>as</b> <a href="../DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a>;
                        <span class="r742 r">isFileSystem</span> = <span class="r745 r">provider</span> != <b>null</b> &amp;&amp;
                                       <span class="r745 r">provider</span>.<a href="../DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>.<span class="i">Equals</span>(<a href="../../P/64a92af39f1cd630.html#64a92af39f1cd630" class="t t">FileSystemProvider</a>.<a href="../../namespaces/FileSystemProvider.cs.html#10b665caf52d3382" class="i field">ProviderName</a>,
                                                            <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
                    }
                    <b>else</b>
                    {
                        <b>try</b>
                        {
                            <a href="../DataStoreAdapterProvider.cs.html#dd4e1f2f8e73a1dd" class="t t">ProviderInfo</a> <span id="r746 rd" class="r746 r">provider</span>;
                            <b>if</b> (<span class="r736 r">defaultRelative</span>)
                            {
                                <span class="r746 r">provider</span> = <span class="r735 r">executionContext</span>.<a href="../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>.<a href="../SessionStateDriveAPIs.cs.html#719e0929a853f471" class="i property">CurrentDrive</a>.<a href="../DataStoreAdapter.cs.html#599e6ea3519fc2d6" class="i property">Provider</a>;
                            }
                            <b>else</b>
                            {
                                <span class="r735 r">executionContext</span>.<a href="../ExecutionContext.cs.html#287b499ae3f5652b" class="i property">LocationGlobber</a>.<a href="../../namespaces/LocationGlobber.cs.html#b8ced6b564d69b01" class="i method">GetProviderPath</a>(<span class="r724 r">wordToComplete</span>, <b>out</b> <span class="r746 r">provider</span>);
                            }
 
                            <span class="r742 r">isFileSystem</span> = <span class="r746 r">provider</span> != <b>null</b> &amp;&amp;
                                           <span class="r746 r">provider</span>.<a href="../DataStoreAdapterProvider.cs.html#2837d805ea30ef5c" class="i property">Name</a>.<span class="i">Equals</span>(<a href="../../P/64a92af39f1cd630.html#64a92af39f1cd630" class="t t">FileSystemProvider</a>.<a href="../../namespaces/FileSystemProvider.cs.html#10b665caf52d3382" class="i field">ProviderName</a>,
                                                                <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
                        }
                        <b>catch</b> (<span class="i">Exception</span>)
                        {
                        }
                    }
 
                    <b>if</b> (<span class="r742 r">isFileSystem</span>)
                    {
                        <b>bool</b> <span id="r747 rd" class="r747 r">hiddenFilesAreHandled</span> = <b>false</b>;
 
                        <b>if</b> (<span class="r741 r">psobjs</span>.<span class="i">Count</span> &gt; 0 &amp;&amp; !<a href="../../namespaces/LocationGlobber.cs.html#6387d90abe0ca584" class="t t">LocationGlobber</a>.<a href="../../namespaces/LocationGlobber.cs.html#be9734ddba52229e" class="i method">StringContainsGlobCharacters</a>(<span class="r724 r">wordToComplete</span>))
                        {
                            <b>string</b> <span id="r748 rd" class="r748 r">leaf</span> = <b>null</b>;
                            <b>string</b> <span id="r749 rd" class="r749 r">pathWithoutProvider</span> = <span class="r743 r">wordContainsProviderId</span>
                                    ? <span class="r724 r">wordToComplete</span>.<span class="i">Substring</span>(<span class="r724 r">wordToComplete</span>.<span class="i">IndexOf</span>(<span class="s">&#39;:&#39;</span>) + 2)
                                    : <span class="r724 r">wordToComplete</span>;
 
                            <b>try</b>
                            {
                                <span class="r748 r">leaf</span> = <span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="r749 r">pathWithoutProvider</span>);
                            }
                            <b>catch</b> (<span class="i">Exception</span>)
                            {
                            }
 
                            <b>var</b> <span id="r750 rd" class="r750 r">notHiddenEntries</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                            <b>string</b> <span id="r751 rd" class="r751 r">providerPath</span> = <b>null</b>;
 
                            <b>foreach</b> (<b>dynamic</b> <span id="r752 rd" class="r752 r">entry</span> <b>in</b> <span class="r741 r">psobjs</span>)
                            {
                                <span class="r751 r">providerPath</span> = <span class="r752 r">entry</span>.<span class="i">ProviderPath</span>;
                                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r751 r">providerPath</span>))
                                {
                                    <span class="c">// This is unexpected. ProviderPath should never be null or an empty string</span>
                                    <span class="r748 r">leaf</span> = <b>null</b>;
                                    <b>break</b>;
                                }
 
                                <b>if</b> (!<span class="r750 r">notHiddenEntries</span>.<span class="i">Contains</span>(<span class="r751 r">providerPath</span>))
                                {
                                    <span class="r750 r">notHiddenEntries</span>.<span class="i">Add</span>(<span class="r751 r">providerPath</span>);
                                }
                            }
 
                            <b>if</b> (<span class="r748 r">leaf</span> != <b>null</b>)
                            {
                                <span class="r748 r">leaf</span> += <span class="s">&quot;*&quot;</span>;
                                <b>var</b> <span id="r753 rd" class="r753 r">parentPath</span> = <span class="i">Path</span>.<span class="i">GetDirectoryName</span>(<span class="r751 r">providerPath</span>);
 
                                <span class="c">// ProviderPath should be absolute path for FileSystem entries</span>
                                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r753 r">parentPath</span>))
                                {
                                    <b>string</b>[] <span id="r754 rd" class="r754 r">entries</span> = <b>null</b>;
                                    <b>try</b>
                                    {
                                        <span class="r754 r">entries</span> = <span class="i">Directory</span>.<span class="i">GetFileSystemEntries</span>(<span class="r753 r">parentPath</span>, <span class="r748 r">leaf</span>, <a href="#37d507b619619ebd" class="i field">_enumerationOptions</a>);
                                    }
                                    <b>catch</b> (<span class="i">Exception</span>)
                                    {
                                    }
 
                                    <b>if</b> (<span class="r754 r">entries</span> != <b>null</b>)
                                    {
                                        <span class="r747 r">hiddenFilesAreHandled</span> = <b>true</b>;
 
                                        <b>if</b> (<span class="r754 r">entries</span>.<span class="i">Length</span> &gt; <span class="r750 r">notHiddenEntries</span>.<span class="i">Count</span>)
                                        {
                                            <span class="c">// Do the iteration only if there are hidden files</span>
                                            <b>foreach</b> (<b>var</b> <span id="r755 rd" class="r755 r">entry</span> <b>in</b> <span class="r754 r">entries</span>)
                                            {
                                                <b>if</b> (<span class="r750 r">notHiddenEntries</span>.<span class="i">Contains</span>(<span class="r755 r">entry</span>))
                                                    <b>continue</b>;
 
                                                <b>var</b> <span id="r756 rd" class="r756 r">fileInfo</span> = <b>new</b> <span class="i">FileInfo</span>(<span class="r755 r">entry</span>);
                                                <b>try</b>
                                                {
                                                    <b>if</b> ((<span class="r756 r">fileInfo</span>.<span class="i">Attributes</span> &amp; <span class="i">FileAttributes</span>.<span class="i">Hidden</span>) != 0)
                                                    {
                                                        <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r757 rd" class="r757 r">wrapper</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r755 r">entry</span>);
                                                        <span class="r741 r">psobjs</span>.<span class="i">Add</span>(<span class="r757 r">wrapper</span>);
                                                    }
                                                }
                                                <b>catch</b>
                                                {
                                                    <span class="c">// do nothing if can&#39;t get file attributes</span>
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
 
                        <b>if</b> (!<span class="r747 r">hiddenFilesAreHandled</span>)
                        {
                            <span class="r739 r">powerShellExecutionHelper</span>
                                .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Get-ChildItem&quot;</span>)
                                .<span class="i">AddParameter</span>(<span class="s">&quot;Path&quot;</span>, <span class="r724 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>)
                                .<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Hidden&quot;</span>, <b>true</b>);
 
                            <b>var</b> <span id="r758 rd" class="r758 r">hiddenItems</span> = <span class="r739 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r740 r">exceptionThrown</span>);
                            <b>if</b> (<span class="r758 r">hiddenItems</span> != <b>null</b> &amp;&amp; <span class="r758 r">hiddenItems</span>.<span class="i">Count</span> &gt; 0)
                            {
                                <b>foreach</b> (<b>var</b> <span id="r759 rd" class="r759 r">hiddenItem</span> <b>in</b> <span class="r758 r">hiddenItems</span>)
                                {
                                    <span class="r741 r">psobjs</span>.<span class="i">Add</span>(<span class="r759 r">hiddenItem</span>);
                                }
                            }
                        }
                    }
 
                    <span class="c">// Sorting the results by the path</span>
                    <b>var</b> <span id="r760 rd" class="r760 r">sortedPsobjs</span> = <span class="r741 r">psobjs</span>.<span class="i">OrderBy</span>(<b>static</b> <span id="r761 rd" class="r761 r">a</span> =&gt; <span class="r761 r">a</span>, <b>new</b> <span class="t">ItemPathComparer</span>());
 
                    <b>foreach</b> (<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r762 rd" class="r762 r">psobj</span> <b>in</b> <span class="r760 r">sortedPsobjs</span>)
                    {
                        <b>object</b> <span id="r763 rd" class="r763 r">baseObj</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r762 r">psobj</span>);
                        <b>string</b> <span id="r764 rd" class="r764 r">path</span> = <b>null</b>, <span id="r765 rd" class="r765 r">providerPath</span> = <b>null</b>;
 
                        <span class="c">// Get the path, the PSObject could be:</span>
                        <span class="c">// 1. a PathInfo object -- results of Resolve-Path</span>
                        <span class="c">// 2. a FileSystemInfo Object -- results of Get-ChildItem</span>
                        <span class="c">// 3. a string -- the path results return by the direct .NET API invocation</span>
                        <a href="../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="k">var</a> <span id="r766 rd" class="r766 r">baseObjAsPathInfo</span> = <span class="r763 r">baseObj</span> <b>as</b> <a href="../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a>;
                        <b>if</b> (<span class="r766 r">baseObjAsPathInfo</span> != <b>null</b>)
                        {
                            <span class="r764 r">path</span> = <span class="r766 r">baseObjAsPathInfo</span>.<a href="../../namespaces/PathInfo.cs.html#de00cd47bf0cf721" class="i property">Path</a>;
                            <span class="r765 r">providerPath</span> = <span class="r766 r">baseObjAsPathInfo</span>.<a href="../../namespaces/PathInfo.cs.html#16e3fcd7f95c1bfc" class="i property">ProviderPath</a>;
                        }
                        <b>else</b> <b>if</b> (<span class="r763 r">baseObj</span> <b>is</b> <span class="i">FileSystemInfo</span>)
                        {
                            <span class="c">// The target provider is the FileSystem</span>
                            <b>dynamic</b> <span id="r767 rd" class="r767 r">dirResult</span> = <span class="r762 r">psobj</span>;
                            <span class="r765 r">providerPath</span> = <span class="r767 r">dirResult</span>.<span class="i">FullName</span>;
                            <span class="r764 r">path</span> = <span class="r743 r">wordContainsProviderId</span> ? <span class="r767 r">dirResult</span>.<span class="i">PSPath</span> : <span class="r765 r">providerPath</span>;
                        }
                        <b>else</b>
                        {
                            <b>var</b> <span id="r768 rd" class="r768 r">baseObjAsString</span> = <span class="r763 r">baseObj</span> <b>as string</b>;
                            <b>if</b> (<span class="r768 r">baseObjAsString</span> != <b>null</b>)
                            {
                                <span class="c">// The target provider is the FileSystem</span>
                                <span class="r765 r">providerPath</span> = <span class="r768 r">baseObjAsString</span>;
                                <span class="r764 r">path</span> = <span class="r743 r">wordContainsProviderId</span>
                                    ? <a href="../../P/64a92af39f1cd630.html#64a92af39f1cd630" class="t t">FileSystemProvider</a>.<a href="../../namespaces/FileSystemProvider.cs.html#10b665caf52d3382" class="i field">ProviderName</a> + <span class="s">&quot;::&quot;</span> + <span class="r768 r">baseObjAsString</span>
                                    : <span class="r765 r">providerPath</span>;
                            }
                        }
 
                        <b>if</b> (<span class="r764 r">path</span> == <b>null</b>) <b>continue</b>;
                        <b>if</b> (<span class="r742 r">isFileSystem</span> &amp;&amp; <span class="r765 r">providerPath</span> == <b>null</b>) <b>continue</b>;
 
                        <b>string</b> <span id="r769 rd" class="r769 r">completionText</span>;
                        <b>if</b> (<span class="r737 r">relativePaths</span>)
                        {
                            <b>try</b>
                            {
                                <a href="../../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="k">var</a> <span id="r770 rd" class="r770 r">sessionStateInternal</span> = <span class="r735 r">executionContext</span>.<a href="../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>;
                                <span class="r769 r">completionText</span> = <span class="r770 r">sessionStateInternal</span>.<a href="../SessionStateNavigation.cs.html#53053bcd94d8a249" class="i method">NormalizeRelativePath</a>(<span class="r764 r">path</span>, <span class="r770 r">sessionStateInternal</span>.<a href="../SessionStateLocationAPIs.cs.html#7f6b3bbb0c411e27" class="i property">CurrentLocation</a>.<a href="../../namespaces/PathInfo.cs.html#16e3fcd7f95c1bfc" class="i property">ProviderPath</a>);
                                <b>string</b> <span id="r771 rd" class="r771 r">parentDirectory</span> = <span class="s">&quot;..&quot;</span> + <a href="../SessionStateStrings.cs.html#55ee11e42c7cf459" class="t t">StringLiterals</a>.<a href="../SessionStateStrings.cs.html#88fdd102fa325178" class="i field">DefaultPathSeparator</a>;
                                <b>if</b> (!<span class="r769 r">completionText</span>.<span class="i">StartsWith</span>(<span class="r771 r">parentDirectory</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                                    <span class="r769 r">completionText</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="s">&quot;.&quot;</span>, <span class="r769 r">completionText</span>);
                            }
                            <b>catch</b> (<span class="i">Exception</span>)
                            {
                                <span class="c">// The object at the specified path is not accessable, such as c:\hiberfil.sys (for hibernation) or c:\pagefile.sys (for paging)</span>
                                <span class="c">// We ignore those files</span>
                                <b>continue</b>;
                            }
                        }
                        <b>else</b>
                        {
                            <span class="r769 r">completionText</span> = <span class="r764 r">path</span>;
                        }
 
                        <b>if</b> (<a href="#d1c5d9bdceb0cae3" class="i method">ProviderSpecified</a>(<span class="r769 r">completionText</span>) &amp;&amp; !<span class="r743 r">wordContainsProviderId</span>)
                        {
                            <span class="c">// Remove the provider id from the path: cd \\scratch2\scratch\dongbw</span>
                            <b>var</b> <span id="r772 rd" class="r772 r">index</span> = <span class="r769 r">completionText</span>.<span class="i">IndexOf</span>(<span class="s">&#39;:&#39;</span>);
                            <span class="r769 r">completionText</span> = <span class="r769 r">completionText</span>.<span class="i">Substring</span>(<span class="r772 r">index</span> + 2);
                        }
 
                        <b>if</b> (<span class="i">CompletionRequiresQuotes</span>(<span class="r769 r">completionText</span>, !<span class="r738 r">useLiteralPath</span>))
                        {
                            <b>var</b> <span id="r773 rd" class="r773 r">quoteInUse</span> = <span class="r725 r">quote</span> == <b>string</b>.<span class="i">Empty</span> ? <span class="s">&quot;&#39;&quot;</span> : <span class="r725 r">quote</span>;
                            <b>if</b> (<span class="r773 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                            {
                                <span class="r769 r">completionText</span> = <span class="r769 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                            }
                            <b>else</b>
                            {
                                <span class="c">// When double quote is in use, we have to escape the backtip and &#39;$&#39; even when using literal path</span>
                                <span class="c">//   Get-Content -LiteralPath &quot;.\a``g.txt&quot;</span>
                                <span class="r769 r">completionText</span> = <span class="r769 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;`&quot;</span>, <span class="s">&quot;``&quot;</span>);
                                <span class="r769 r">completionText</span> = <span class="r769 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;$&quot;</span>, <span class="s">&quot;`$&quot;</span>);
                            }
 
                            <b>if</b> (!<span class="r738 r">useLiteralPath</span>)
                            {
                                <b>if</b> (<span class="r773 r">quoteInUse</span> == <span class="s">&quot;&#39;&quot;</span>)
                                {
                                    <span class="r769 r">completionText</span> = <span class="r769 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;[&quot;</span>, <span class="s">&quot;`[&quot;</span>);
                                    <span class="r769 r">completionText</span> = <span class="r769 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;]&quot;</span>, <span class="s">&quot;`]&quot;</span>);
                                }
                                <b>else</b>
                                {
                                    <span class="r769 r">completionText</span> = <span class="r769 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;[&quot;</span>, <span class="s">&quot;``[&quot;</span>);
                                    <span class="r769 r">completionText</span> = <span class="r769 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;]&quot;</span>, <span class="s">&quot;``]&quot;</span>);
                                }
                            }
 
                            <span class="r769 r">completionText</span> = <span class="r773 r">quoteInUse</span> + <span class="r769 r">completionText</span> + <span class="r773 r">quoteInUse</span>;
                        }
                        <b>else</b> <b>if</b> (<span class="r725 r">quote</span> != <b>string</b>.<span class="i">Empty</span>)
                        {
                            <span class="r769 r">completionText</span> = <span class="r725 r">quote</span> + <span class="r769 r">completionText</span> + <span class="r725 r">quote</span>;
                        }
 
                        <b>if</b> (<span class="r742 r">isFileSystem</span>)
                        {
                            <span class="c">// Use .NET APIs directly to reduce the time overhead</span>
                            <b>var</b> <span id="r774 rd" class="r774 r">isContainer</span> = <span class="i">Directory</span>.<span class="i">Exists</span>(<span class="r765 r">providerPath</span>);
                            <b>if</b> (<span class="r95 r">containerOnly</span> &amp;&amp; !<span class="r774 r">isContainer</span>)
                                <b>continue</b>;
 
                            <b>if</b> (!<span class="r95 r">containerOnly</span> &amp;&amp; !<span class="r774 r">isContainer</span> &amp;&amp; !<a href="#609742d7475145e0" class="i method">CheckFileExtension</a>(<span class="r765 r">providerPath</span>, <span class="r96 r">extension</span>))
                                <b>continue</b>;
 
                            <b>string</b> <span id="r775 rd" class="r775 r">tooltip</span> = <span class="r765 r">providerPath</span>, <span id="r776 rd" class="r776 r">listItemText</span> = <span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="r765 r">providerPath</span>);
                            <span class="r726 r">results</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r769 r">completionText</span>, <span class="r776 r">listItemText</span>,
                                                             <span class="r774 r">isContainer</span> ? <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#f4f151a5480e81af" class="i field">ProviderContainer</a> : <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#14b0f548feb1e82f" class="i field">ProviderItem</a>,
                                                             <span class="r775 r">tooltip</span>));
                        }
                        <b>else</b>
                        {
                            <span class="r739 r">powerShellExecutionHelper</span>
                                .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Get-Item&quot;</span>)
                                .<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;LiteralPath&quot;</span>, <span class="r764 r">path</span>);
                            <b>var</b> <span id="r777 rd" class="r777 r">items</span> = <span class="r739 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r740 r">exceptionThrown</span>);
                            <b>if</b> (<span class="r777 r">items</span> != <b>null</b> &amp;&amp; <span class="r777 r">items</span>.<span class="i">Count</span> == 1)
                            {
                                <b>dynamic</b> <span id="r778 rd" class="r778 r">item</span> = <span class="r777 r">items</span>[0];
                                <b>var</b> <span id="r779 rd" class="r779 r">isContainer</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<b>bool</b>&gt;(<span class="r778 r">item</span>.<span class="i">PSIsContainer</span>);
 
                                <b>if</b> (<span class="r95 r">containerOnly</span> &amp;&amp; !<span class="r779 r">isContainer</span>)
                                    <b>continue</b>;
 
                                <span class="r739 r">powerShellExecutionHelper</span>
                                    .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Convert-Path&quot;</span>)
                                    .<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;LiteralPath&quot;</span>, <span class="r778 r">item</span>.<span class="i">PSPath</span>);
                                <b>var</b> <span id="r780 rd" class="r780 r">tooltips</span> = <span class="r739 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r740 r">exceptionThrown</span>);
                                <b>string</b> <span id="r781 rd" class="r781 r">tooltip</span> = <b>null</b>, <span id="r782 rd" class="r782 r">listItemText</span> = <span class="r778 r">item</span>.<span class="i">PSChildName</span>;
                                <b>if</b> (<span class="r780 r">tooltips</span> != <b>null</b> &amp;&amp; <span class="r780 r">tooltips</span>.<span class="i">Count</span> == 1)
                                {
                                    <span class="r781 r">tooltip</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">Base</span>(<span class="r780 r">tooltips</span>[0]) <b>as string</b>;
                                }
 
                                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r782 r">listItemText</span>))
                                {
                                    <span class="c">// For provider items that don&#39;t have PSChildName values, such as variable::error</span>
                                    <span class="r782 r">listItemText</span> = <span class="r778 r">item</span>.<span class="i">Name</span>;
                                }
 
                                <span class="r726 r">results</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(<span class="r769 r">completionText</span>, <span class="r782 r">listItemText</span>,
                                                                 <span class="r779 r">isContainer</span> ? <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#f4f151a5480e81af" class="i field">ProviderContainer</a> : <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#14b0f548feb1e82f" class="i field">ProviderItem</a>,
                                                                 <span class="r781 r">tooltip</span> ?? <span class="r764 r">path</span>));
                            }
                            <b>else</b>
                            {
                                <span class="c">// We can get here when get-item fails, perhaps due an acl or whatever.</span>
                                <span class="r726 r">results</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="r769 r">completionText</span>));
                            }
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r726 r">results</span>;
        }
 
        [<span class="i">StructLayout</span>(<span class="i">LayoutKind</span>.<span class="i">Sequential</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>private struct</b> <a id="fd6adbfacf8ef667" href="../../R/fd6adbfacf8ef667.html" target="n" data-glyph="112,1" class="t t"><span id="ef4d00c38c7b93b8">SHARE_INFO_1</span></a>
        {
            <b>public string</b> <a id="15fef290b67315e3" href="../../R/15fef290b67315e3.html" target="n" data-glyph="42,2" class="i field">netname</a>;
            <b>public int</b> <a id="5189b10620f51fde" href="../../R/5189b10620f51fde.html" target="n" data-glyph="42,2" class="i field">type</a>;
            <b>public string</b> <a id="7962965d9e235fc4" href="../../R/../../0000000000.html" target="n" data-glyph="42,2" class="i field">remark</a>;
        }
 
        <b>private const int</b> <a id="20719c4e81c11c05" href="../../R/20719c4e81c11c05.html" target="n" data-glyph="10,1" class="i field">MAX_PREFERRED_LENGTH</a> = -1;
        <b>private const int</b> <a id="a3cbf9ee2072d34f" href="../../R/a3cbf9ee2072d34f.html" target="n" data-glyph="10,1" class="i field">NERR_Success</a> = 0;
        <b>private const int</b> <a id="e8c14698f5e05efa" href="../../R/e8c14698f5e05efa.html" target="n" data-glyph="10,1" class="i field">ERROR_MORE_DATA</a> = 234;
        <b>private const int</b> <a id="9cb1e049533bec26" href="../../R/9cb1e049533bec26.html" target="n" data-glyph="10,1" class="i field">STYPE_DISKTREE</a> = 0;
        <b>private const int</b> <a id="fc225440ce2a61f1" href="../../R/fc225440ce2a61f1.html" target="n" data-glyph="10,1" class="i field">STYPE_MASK</a> = 0x000000FF;
 
        <b>private static readonly</b> <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">EnumerationOptions</span> <a id="37d507b619619ebd" href="../../R/37d507b619619ebd.html" target="n" data-glyph="46,1" class="i field">_enumerationOptions</a> = <b>new</b> <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">EnumerationOptions</span>
        {
            <span class="i">MatchCasing</span> = <span class="i">MatchCasing</span>.<span class="i">CaseInsensitive</span>,
            <span class="i">AttributesToSkip</span> = 0 <span class="c">// Default is to skip Hidden and System files, so we clear this to retain existing behavior</span>
        };
 
        [<span class="i">DllImport</span>(<span class="s">&quot;Netapi32.dll&quot;</span>, <span class="i">CharSet</span> = <span class="i">CharSet</span>.<span class="i">Unicode</span>)]
        <b>private static extern int</b> <a id="cab41c663f4edb7a" href="../../R/cab41c663f4edb7a.html" target="n" data-glyph="76,1" class="i method">NetShareEnum</a>(<b>string</b> <span id="r783 rd" class="r783 r">serverName</span>, <b>int</b> <span id="r784 rd" class="r784 r">level</span>, <b>out</b> <span class="i">IntPtr</span> <span id="r785 rd" class="r785 r">bufptr</span>, <b>int</b> <span id="r786 rd" class="r786 r">prefMaxLen</span>,
                                               <b>out uint</b> <span id="r787 rd" class="r787 r">entriesRead</span>, <b>out uint</b> <span id="r788 rd" class="r788 r">totalEntries</span>, <b>ref uint</b> <span id="r789 rd" class="r789 r">resumeHandle</span>);
 
        <b>internal static</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="0d5b10281878035c" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GetFileShares</a>(<b>string</b> <span id="r790 rd" class="r790 r">machine</span>, <b>bool</b> <span id="r791 rd" class="r791 r">ignoreHidden</span>)
        {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">UNIX</span>
<span class="e">            return new List&lt;string&gt;();
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
            <span class="i">IntPtr</span> <span id="r792 rd" class="r792 r">shBuf</span>;
            <b>uint</b> <span id="r793 rd" class="r793 r">numEntries</span>;
            <b>uint</b> <span id="r794 rd" class="r794 r">totalEntries</span>;
            <b>uint</b> <span id="r795 rd" class="r795 r">resumeHandle</span> = 0;
            <b>int</b> <span id="r796 rd" class="r796 r">result</span> = <a href="#cab41c663f4edb7a" class="i method">NetShareEnum</a>(<span class="r790 r">machine</span>, 1, <b>out</b> <span class="r792 r">shBuf</span>,
                                        <a href="#20719c4e81c11c05" class="i field">MAX_PREFERRED_LENGTH</a>, <b>out</b> <span class="r793 r">numEntries</span>, <b>out</b> <span class="r794 r">totalEntries</span>,
                                        <b>ref</b> <span class="r795 r">resumeHandle</span>);
 
            <b>var</b> <span id="r797 rd" class="r797 r">shares</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <b>if</b> (<span class="r796 r">result</span> == <a href="#a3cbf9ee2072d34f" class="i field">NERR_Success</a> || <span class="r796 r">result</span> == <a href="#e8c14698f5e05efa" class="i field">ERROR_MORE_DATA</a>)
            {
                <b>for</b> (<b>int</b> <span id="r798 rd" class="r798 r">i</span> = 0; <span class="r798 r">i</span> &lt; <span class="r793 r">numEntries</span>; ++<span class="r798 r">i</span>)
                {
                    <span class="i">IntPtr</span> <span id="r799 rd" class="r799 r">curInfoPtr</span> = (<span class="i">IntPtr</span>)((<b>long</b>)<span class="r792 r">shBuf</span> + (<span class="i">Marshal</span>.<span class="i">SizeOf</span>&lt;<a href="#fd6adbfacf8ef667" class="t t">SHARE_INFO_1</a>&gt;() * <span class="r798 r">i</span>));
                    <a href="#fd6adbfacf8ef667" class="t t">SHARE_INFO_1</a> <span id="r800 rd" class="r800 r">shareInfo</span> = <span class="i">Marshal</span>.<span class="i">PtrToStructure</span>&lt;<a href="#fd6adbfacf8ef667" class="t t">SHARE_INFO_1</a>&gt;(<span class="r799 r">curInfoPtr</span>);
 
                    <b>if</b> ((<span class="r800 r">shareInfo</span>.<a href="#5189b10620f51fde" class="i field">type</a> &amp; <a href="#fc225440ce2a61f1" class="i field">STYPE_MASK</a>) != <a href="#9cb1e049533bec26" class="i field">STYPE_DISKTREE</a>)
                        <b>continue</b>;
                    <b>if</b> (<span class="r791 r">ignoreHidden</span> &amp;&amp; <span class="r800 r">shareInfo</span>.<a href="#15fef290b67315e3" class="i field">netname</a>.<span class="i">EndsWith</span>(<span class="s">&#39;$&#39;</span>))
                        <b>continue</b>;
                    <span class="r797 r">shares</span>.<span class="i">Add</span>(<span class="r800 r">shareInfo</span>.<a href="#15fef290b67315e3" class="i field">netname</a>);
                }
            }
 
            <b>return</b> <span class="r797 r">shares</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
        }
 
        <b>private static bool</b> <a id="609742d7475145e0" href="../../R/609742d7475145e0.html" target="n" data-glyph="76,1" class="i method">CheckFileExtension</a>(<b>string</b> <span id="r801 rd" class="r801 r">path</span>, <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r802 rd" class="r802 r">extension</span>)
        {
            <b>if</b> (<span class="r802 r">extension</span> == <b>null</b> || <span class="r802 r">extension</span>.<span class="i">Count</span> == 0)
                <b>return</b> <b>true</b>;
 
            <b>var</b> <span id="r803 rd" class="r803 r">ext</span> = <span class="i n">System</span>.<span class="i">IO</span>.<span class="i">Path</span>.<span class="i">GetExtension</span>(<span class="r801 r">path</span>);
            <b>return</b> <span class="r803 r">ext</span> == <b>null</b> || <span class="r802 r">extension</span>.<span class="i">Contains</span>(<span class="r803 r">ext</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Filenames
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Variable
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r804 r">variableName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <span class="i">IEnumerable</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="0173bb22aa86c457" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CompleteVariable</a>(<b>string</b> <span id="r804 rd" class="r804 r">variableName</span>)
        {
            <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="k">var</a> <span id="r805 rd" class="r805 r">runspace</span> = <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>;
            <b>if</b> (<span class="r805 r">runspace</span> == <b>null</b>)
            {
                <span class="c">// No runspace, just return no results.</span>
                <b>return</b> <a href="CommandCompletion.cs.html#a9d35cade4030f50" class="t t">CommandCompletion</a>.<a href="CommandCompletion.cs.html#13ad720861798479" class="i field">EmptyCompletionResult</a>;
            }
 
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r806 rd" class="r806 r">helper</span> = <b>new</b> <a href="../../utils/PowerShellExecutionHelper.cs.html#b251f5b816b2dd25" class="t constructor">PowerShellExecutionHelper</a>(<a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#1c6a51d3c837bb4d" class="i method">Create</a>(<a href="../hostifaces/PowerShell.cs.html#c3c0f0e5e0b337ff" class="t t">RunspaceMode</a>.<a href="../hostifaces/PowerShell.cs.html#75d224de5df87e75" class="i field">CurrentRunspace</a>));
            <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r807 rd" class="r807 r">executionContext</span> = <span class="r806 r">helper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ddb7ad1950c8ea20" class="i property">CurrentPowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a>.<a href="../hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>;
            <b>return</b> <a href="#2e1c9f0c9f032eaa" class="i method">CompleteVariable</a>(<b>new</b> <span class="t">CompletionContext</span> { <a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r804 r">variableName</span>, <a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a> = <span class="r806 r">helper</span>, <a href="CompletionAnalysis.cs.html#4055c622a2008ac8" class="i property">ExecutionContext</a> = <span class="r807 r">executionContext</span> });
        }
 
        <b>private static readonly string</b>[] <a id="a133fdedb2147393" href="../../R/a133fdedb2147393.html" target="n" data-glyph="46,1" class="i field">s_variableScopes</a> = <b>new</b> <b>string</b>[] { <span class="s">&quot;Global:&quot;</span>, <span class="s">&quot;Local:&quot;</span>, <span class="s">&quot;Script:&quot;</span>, <span class="s">&quot;Private:&quot;</span> };
 
        <b>private static readonly char</b>[] <a id="c30c08aec33a7836" href="../../R/c30c08aec33a7836.html" target="n" data-glyph="46,1" class="i field">s_charactersRequiringQuotes</a> = <b>new</b> <b>char</b>[] {
            <span class="s">&#39;-&#39;</span>, <span class="s">&#39;`&#39;</span>, <span class="s">&#39;&amp;&#39;</span>, <span class="s">&#39;@&#39;</span>, <span class="s">&#39;\&#39;&#39;</span>, <span class="s">&#39;&quot;&#39;</span>, <span class="s">&#39;#&#39;</span>, <span class="s">&#39;{&#39;</span>, <span class="s">&#39;}&#39;</span>, <span class="s">&#39;(&#39;</span>, <span class="s">&#39;)&#39;</span>, <span class="s">&#39;$&#39;</span>, <span class="s">&#39;,&#39;</span>, <span class="s">&#39;;&#39;</span>, <span class="s">&#39;|&#39;</span>, <span class="s">&#39;&lt;&#39;</span>, <span class="s">&#39;&gt;&#39;</span>, <span class="s">&#39; &#39;</span>, <span class="s">&#39;.&#39;</span>, <span class="s">&#39;\\&#39;</span>, <span class="s">&#39;/&#39;</span>, <span class="s">&#39;\t&#39;</span>, <span class="s">&#39;^&#39;</span>,
        };
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="2e1c9f0c9f032eaa" href="../../R/2e1c9f0c9f032eaa.html" target="n" data-glyph="74,1" class="i method">CompleteVariable</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r808 rd" class="r808 r">context</span>)
        {
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r809 rd" class="r809 r">hashedResults</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r810 rd" class="r810 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
 
            <b>var</b> <span id="r811 rd" class="r811 r">wordToComplete</span> = <span class="r808 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>;
            <b>var</b> <span id="r812 rd" class="r812 r">colon</span> = <span class="r811 r">wordToComplete</span>.<span class="i">IndexOf</span>(<span class="s">&#39;:&#39;</span>);
 
            <b>var</b> <span id="r813 rd" class="r813 r">lastAst</span> = <span class="r808 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>?.<span class="i">Last</span>();
            <a href="../parser/ast.cs.html#248562b22b336dec" class="k">var</a> <span id="r814 rd" class="r814 r">variableAst</span> = <span class="r813 r">lastAst</span> <b>as</b> <a href="../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>;
            <b>var</b> <span id="r815 rd" class="r815 r">prefix</span> = <span class="r814 r">variableAst</span> != <b>null</b> &amp;&amp; <span class="r814 r">variableAst</span>.<a href="../parser/ast.cs.html#7f1485a08eb97fcc" class="i property">Splatted</a> ? <span class="s">&quot;@&quot;</span> : <span class="s">&quot;$&quot;</span>;
 
            <span class="c">// Look for variables in the input (e.g. parameters, etc.) before checking session state - these</span>
            <span class="c">// variables might not exist in session state yet.</span>
            <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r816 rd" class="r816 r">wildcardPattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r811 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <b>if</b> (<span class="r813 r">lastAst</span> != <b>null</b>)
            {
                <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r817 rd" class="r817 r">parent</span> = <span class="r813 r">lastAst</span>.<span class="i">Parent</span>;
                <a href="#166522bbe62b746d" class="k">var</a> <span id="r818 rd" class="r818 r">findVariablesVisitor</span> = <b>new</b> <span class="t">FindVariablesVisitor</span> { <a href="#2cc14bf882ec42e9" class="i field">CompletionVariableAst</a> = <span class="r813 r">lastAst</span> };
                <b>while</b> (<span class="r817 r">parent</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r817 r">parent</span> <b>is</b> <a href="../parser/ast.cs.html#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)
                    {
                        <span class="r818 r">findVariablesVisitor</span>.<a href="#6a8dde23240f66a2" class="i field">Top</a> = <span class="r817 r">parent</span>;
                        <span class="r817 r">parent</span>.<a href="../parser/ast.cs.html#b97830265ba444e4" class="i method">Visit</a>(<span class="r818 r">findVariablesVisitor</span>);
                    }
 
                    <span class="r817 r">parent</span> = <span class="r817 r">parent</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                }
 
                <b>foreach</b> (<span class="i">Tuple</span>&lt;<b>string</b>, <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r819 rd" class="r819 r">varAst</span> <b>in</b> <span class="r818 r">findVariablesVisitor</span>.<a href="#df14c0f488cc45db" class="i field">VariableSources</a>)
                {
                    <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r820 rd" class="r820 r">astTarget</span> = <b>null</b>;
                    <b>string</b> <span id="r821 rd" class="r821 r">userPath</span> = <b>null</b>;
 
                    <a href="../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r822 rd" class="r822 r">variableDefinitionAst</span> = <span class="r819 r">varAst</span>.<span class="i">Item2</span> <b>as</b> <a href="../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>;
                    <b>if</b> (<span class="r822 r">variableDefinitionAst</span> != <b>null</b>)
                    {
                        <span class="r821 r">userPath</span> = <span class="r819 r">varAst</span>.<span class="i">Item1</span>;
                        <span class="r820 r">astTarget</span> = <span class="r819 r">varAst</span>.<span class="i">Item2</span>.<span class="i">Parent</span>;
                    }
                    <b>else</b>
                    {
                        <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r823 rd" class="r823 r">commandParameterAst</span> = <span class="r819 r">varAst</span>.<span class="i">Item2</span> <b>as</b> <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>;
                        <b>if</b> (<span class="r823 r">commandParameterAst</span> != <b>null</b>)
                        {
                            <span class="r821 r">userPath</span> = <span class="r819 r">varAst</span>.<span class="i">Item1</span>;
                            <span class="r820 r">astTarget</span> = <span class="r819 r">varAst</span>.<span class="i">Item2</span>;
                        }
                    }
 
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r821 r">userPath</span>))
                    {
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Found a variable source but it was an unknown AST type.&quot;</span>);
                    }
 
                    <b>if</b> (<span class="r816 r">wildcardPattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r821 r">userPath</span>))
                    {
                        <b>var</b> <span id="r824 rd" class="r824 r">completedName</span> = (<span class="r821 r">userPath</span>.<span class="i">IndexOfAny</span>(<a href="#c30c08aec33a7836" class="i field">s_charactersRequiringQuotes</a>) == -1)
                                                ? <span class="r815 r">prefix</span> + <span class="r821 r">userPath</span>
                                                : <span class="r815 r">prefix</span> + <span class="s">&quot;{&quot;</span> + <span class="r821 r">userPath</span> + <span class="s">&quot;}&quot;</span>;
                        <b>var</b> <span id="r825 rd" class="r825 r">tooltip</span> = <span class="r821 r">userPath</span>;
                        <a href="../parser/ast.cs.html#d47621d83efd14de" class="k">var</a> <span id="r826 rd" class="r826 r">ast</span> = <span class="r820 r">astTarget</span>;
 
                        <b>while</b> (<span class="r826 r">ast</span> != <b>null</b>)
                        {
                            <a href="../parser/ast.cs.html#bf2a2797225b11b5" class="k">var</a> <span id="r827 rd" class="r827 r">parameterAst</span> = <span class="r826 r">ast</span> <b>as</b> <a href="../parser/ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a>;
                            <b>if</b> (<span class="r827 r">parameterAst</span> != <b>null</b>)
                            {
                                <b>var</b> <span id="r828 rd" class="r828 r">typeConstraint</span> = <span class="r827 r">parameterAst</span>.<a href="../parser/ast.cs.html#5f4fbe2ccc8004ce" class="i property">Attributes</a>.<span class="i">OfType</span>&lt;<a href="../parser/ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;().<span class="i">FirstOrDefault</span>();
                                <b>if</b> (<span class="r828 r">typeConstraint</span> != <b>null</b>)
                                {
                                    <span class="r825 r">tooltip</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="s">&quot;{0}${1}&quot;</span>, <span class="r828 r">typeConstraint</span>.<span class="i">Extent</span>.<span class="i">Text</span>, <span class="r821 r">userPath</span>);
                                }
 
                                <b>break</b>;
                            }
 
                            <a href="../parser/ast.cs.html#da5f345864f42e06" class="k">var</a> <span id="r829 rd" class="r829 r">assignmentAst</span> = <span class="r826 r">ast</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="../parser/ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a>;
                            <b>if</b> (<span class="r829 r">assignmentAst</span> != <b>null</b>)
                            {
                                <b>if</b> (<span class="r829 r">assignmentAst</span>.<a href="../parser/ast.cs.html#737e87d58bda06dc" class="i property">Left</a> == <span class="r826 r">ast</span>)
                                {
                                    <span class="r825 r">tooltip</span> = <span class="r826 r">ast</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>;
                                }
 
                                <b>break</b>;
                            }
 
                            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="k">var</a> <span id="r830 rd" class="r830 r">commandAst</span> = <span class="r826 r">ast</span> <b>as</b> <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>;
                            <b>if</b> (<span class="r830 r">commandAst</span> != <b>null</b>)
                            {
                                <a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a> <span id="r831 rd" class="r831 r">discoveredType</span> = <a href="../parser/TypeInferenceVisitor.cs.html#85308821e258515b" class="t t">AstTypeInference</a>.<a href="../parser/TypeInferenceVisitor.cs.html#a161c4fce43bc728" class="i method">InferTypeOf</a>(<span class="r826 r">ast</span>, <span class="r808 r">context</span>.<a href="CompletionAnalysis.cs.html#95d0769179a8633b" class="i property">TypeInferenceContext</a>, <a href="../parser/TypeInferenceVisitor.cs.html#c79f5fa1494e528d" class="t t">TypeInferenceRuntimePermissions</a>.<a href="../parser/TypeInferenceVisitor.cs.html#8df46f8adea8c4e2" class="i field">AllowSafeEval</a>).<span class="i">FirstOrDefault</span>&lt;<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt;();
                                <b>if</b> (<span class="r831 r">discoveredType</span> != <b>null</b>)
                                {
                                    <span class="r825 r">tooltip</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#2212180d4582cc59" class="i method">Format</a>(<span class="s">&quot;[{0}]${1}&quot;</span>, <span class="r831 r">discoveredType</span>.<a href="../CommandInfo.cs.html#77cc6b79382c5568" class="i property">Name</a>, <span class="r821 r">userPath</span>);
                                }
 
                                <b>break</b>;
                            }
 
                            <span class="r826 r">ast</span> = <span class="r826 r">ast</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                        }
 
                        <span class="i">AddUniqueVariable</span>(<span class="r809 r">hashedResults</span>, <span class="r810 r">results</span>, <span class="r824 r">completedName</span>, <span class="r821 r">userPath</span>, <span class="r825 r">tooltip</span>);
                    }
                }
            }
 
            <b>string</b> <span id="r832 rd" class="r832 r">pattern</span>;
            <b>string</b> <span id="r833 rd" class="r833 r">provider</span>;
            <b>if</b> (<span class="r812 r">colon</span> == -1)
            {
                <span class="r832 r">pattern</span> = <span class="s">&quot;variable:&quot;</span> + <span class="r811 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>;
                <span class="r833 r">provider</span> = <b>string</b>.<span class="i">Empty</span>;
            }
            <b>else</b>
            {
                <span class="r833 r">provider</span> = <span class="r811 r">wordToComplete</span>.<span class="i">Substring</span>(0, <span class="r812 r">colon</span> + 1);
                <b>if</b> (<a href="#a133fdedb2147393" class="i field">s_variableScopes</a>.<span class="i">Contains</span>(<span class="r833 r">provider</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r832 r">pattern</span> = <b>string</b>.<span class="i">Concat</span>(<span class="s">&quot;variable:&quot;</span>, <span class="r811 r">wordToComplete</span>.<span class="i">AsSpan</span>(<span class="r812 r">colon</span> + 1), <span class="s">&quot;*&quot;</span>);
                }
                <b>else</b>
                {
                    <span class="r832 r">pattern</span> = <span class="r811 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>;
                }
            }
 
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r834 rd" class="r834 r">powerShellExecutionHelper</span> = <span class="r808 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
            <span class="r834 r">powerShellExecutionHelper</span>
                .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Get-Item&quot;</span>).<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Path&quot;</span>, <span class="r832 r">pattern</span>)
                .<a href="../../utils/PowerShellExecutionHelper.cs.html#9bbdee3db96adb67" class="i method">AddCommandWithPreferenceSetting</a>(<span class="s">&quot;Microsoft.PowerShell.Utility\\Sort-Object&quot;</span>).<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Property&quot;</span>, <span class="s">&quot;Name&quot;</span>);
 
            <span class="i">Exception</span> <span id="r835 rd" class="r835 r">exceptionThrown</span>;
            <b>var</b> <span id="r836 rd" class="r836 r">psobjs</span> = <span class="r834 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r835 r">exceptionThrown</span>);
            <b>if</b> (<span class="r836 r">psobjs</span> != <b>null</b>)
            {
                <b>foreach</b> (<b>dynamic</b> <span id="r837 rd" class="r837 r">psobj</span> <b>in</b> <span class="r836 r">psobjs</span>)
                {
                    <b>var</b> <span id="r838 rd" class="r838 r">name</span> = <span class="r837 r">psobj</span>.<span class="i">Name</span> <b>as string</b>;
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r838 r">name</span>))
                    {
                        <b>var</b> <span id="r839 rd" class="r839 r">tooltip</span> = <span class="r838 r">name</span>;
                        <a href="../ShellVariable.cs.html#5bd16fef1f858b3d" class="k">var</a> <span id="r840 rd" class="r840 r">variable</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r837 r">psobj</span>) <b>as</b> <a href="../ShellVariable.cs.html#5bd16fef1f858b3d" class="t t">PSVariable</a>;
                        <b>if</b> (<span class="r840 r">variable</span> != <b>null</b>)
                        {
                            <b>var</b> <span id="r841 rd" class="r841 r">value</span> = <span class="r840 r">variable</span>.<a href="../ShellVariable.cs.html#8b1105722178c660" class="i property">Value</a>;
                            <b>if</b> (<span class="r841 r">value</span> != <b>null</b>)
                            {
                                <span class="r839 r">tooltip</span> = <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<a href="../../utils/StringUtil.cs.html#2212180d4582cc59" class="i method">Format</a>(<span class="s">&quot;[{0}]${1}&quot;</span>,
                                                            <a href="../../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r841 r">value</span>.<span class="i">GetType</span>(),
                                                                                     <span class="i">dropNamespaces</span>: <b>true</b>), <span class="r838 r">name</span>);
                            }
                        }
 
                        <b>var</b> <span id="r842 rd" class="r842 r">completedName</span> = (<span class="r838 r">name</span>.<span class="i">IndexOfAny</span>(<a href="#c30c08aec33a7836" class="i field">s_charactersRequiringQuotes</a>) == -1)
                                                ? <span class="r815 r">prefix</span> + <span class="r833 r">provider</span> + <span class="r838 r">name</span>
                                                : <span class="r815 r">prefix</span> + <span class="s">&quot;{&quot;</span> + <span class="r833 r">provider</span> + <span class="r838 r">name</span> + <span class="s">&quot;}&quot;</span>;
                        <span class="i">AddUniqueVariable</span>(<span class="r809 r">hashedResults</span>, <span class="r810 r">results</span>, <span class="r842 r">completedName</span>, <span class="r838 r">name</span>, <span class="r839 r">tooltip</span>);
                    }
                }
            }
 
            <b>if</b> (<span class="r812 r">colon</span> == -1 &amp;&amp; <span class="s">&quot;env&quot;</span>.<span class="i">StartsWith</span>(<span class="r811 r">wordToComplete</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r834 r">powerShellExecutionHelper</span>
                    .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Get-Item&quot;</span>).<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Path&quot;</span>, <span class="s">&quot;env:*&quot;</span>)
                    .<a href="../../utils/PowerShellExecutionHelper.cs.html#9bbdee3db96adb67" class="i method">AddCommandWithPreferenceSetting</a>(<span class="s">&quot;Microsoft.PowerShell.Utility\\Sort-Object&quot;</span>).<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Property&quot;</span>, <span class="s">&quot;Key&quot;</span>);
 
                <span class="r836 r">psobjs</span> = <span class="r834 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r835 r">exceptionThrown</span>);
                <b>if</b> (<span class="r836 r">psobjs</span> != <b>null</b>)
                {
                    <b>foreach</b> (<b>dynamic</b> <span id="r843 rd" class="r843 r">psobj</span> <b>in</b> <span class="r836 r">psobjs</span>)
                    {
                        <b>var</b> <span id="r844 rd" class="r844 r">name</span> = <span class="r843 r">psobj</span>.<span class="i">Name</span> <b>as string</b>;
                        <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r844 r">name</span>))
                        {
                            <span class="r844 r">name</span> = <span class="s">&quot;env:&quot;</span> + <span class="r844 r">name</span>;
                            <b>var</b> <span id="r845 rd" class="r845 r">completedName</span> = (<span class="r844 r">name</span>.<span class="i">IndexOfAny</span>(<a href="#c30c08aec33a7836" class="i field">s_charactersRequiringQuotes</a>) == -1)
                                                    ? <span class="r815 r">prefix</span> + <span class="r844 r">name</span>
                                                    : <span class="r815 r">prefix</span> + <span class="s">&quot;{&quot;</span> + <span class="r844 r">name</span> + <span class="s">&quot;}&quot;</span>;
                            <span class="i">AddUniqueVariable</span>(<span class="r809 r">hashedResults</span>, <span class="r810 r">results</span>, <span class="r845 r">completedName</span>, <span class="r844 r">name</span>, <span class="s">&quot;[string]&quot;</span> + <span class="r844 r">name</span>);
                        }
                    }
                }
            }
 
            <span class="c">// Return variables already in session state first, because we can sometimes give better information,</span>
            <span class="c">// like the variables type.</span>
            <b>foreach</b> (<b>var</b> <span id="r846 rd" class="r846 r">specialVariable</span> <b>in</b> <a href="#3bbffea30dc9adfb" class="i field">s_specialVariablesCache</a>.<span class="i">Value</span>)
            {
                <b>if</b> (<span class="r816 r">wildcardPattern</span>.<span class="i">IsMatch</span>(<span class="r846 r">specialVariable</span>))
                {
                    <b>var</b> <span id="r847 rd" class="r847 r">completedName</span> = (<span class="r846 r">specialVariable</span>.<span class="i">IndexOfAny</span>(<a href="#c30c08aec33a7836" class="i field">s_charactersRequiringQuotes</a>) == -1)
                                            ? <span class="r815 r">prefix</span> + <span class="r846 r">specialVariable</span>
                                            : <span class="r815 r">prefix</span> + <span class="s">&quot;{&quot;</span> + <span class="r846 r">specialVariable</span> + <span class="s">&quot;}&quot;</span>;
 
                    <span class="i">AddUniqueVariable</span>(<span class="r809 r">hashedResults</span>, <span class="r810 r">results</span>, <span class="r847 r">completedName</span>, <span class="r846 r">specialVariable</span>, <span class="r846 r">specialVariable</span>);
                }
            }
 
            <b>if</b> (<span class="r812 r">colon</span> == -1)
            {
                <span class="c">// If no drive was specified, then look for matching drives/scopes</span>
                <span class="r832 r">pattern</span> = <span class="r811 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>;
                <span class="r834 r">powerShellExecutionHelper</span>
                    .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Management\\Get-PSDrive&quot;</span>).<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Name&quot;</span>, <span class="r832 r">pattern</span>)
                    .<a href="../../utils/PowerShellExecutionHelper.cs.html#9bbdee3db96adb67" class="i method">AddCommandWithPreferenceSetting</a>(<span class="s">&quot;Microsoft.PowerShell.Utility\\Sort-Object&quot;</span>).<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Property&quot;</span>, <span class="s">&quot;Name&quot;</span>);
                <span class="r836 r">psobjs</span> = <span class="r834 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out</b> <span class="r835 r">exceptionThrown</span>);
                <b>if</b> (<span class="r836 r">psobjs</span> != <b>null</b>)
                {
                    <b>foreach</b> (<b>var</b> <span id="r848 rd" class="r848 r">psobj</span> <b>in</b> <span class="r836 r">psobjs</span>)
                    {
                        <a href="../DataStoreAdapter.cs.html#2d16b26a541ba185" class="k">var</a> <span id="r849 rd" class="r849 r">driveInfo</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">Base</span>(<span class="r848 r">psobj</span>) <b>as</b> <a href="../DataStoreAdapter.cs.html#2d16b26a541ba185" class="t t">PSDriveInfo</a>;
                        <b>if</b> (<span class="r849 r">driveInfo</span> != <b>null</b>)
                        {
                            <b>var</b> <span id="r850 rd" class="r850 r">name</span> = <span class="r849 r">driveInfo</span>.<a href="../DataStoreAdapter.cs.html#7c2d83a1b2b425a9" class="i property">Name</a>;
                            <b>if</b> (<span class="r850 r">name</span> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r850 r">name</span>) &amp;&amp; <span class="r850 r">name</span>.<span class="i">Length</span> &gt; 1)
                            {
                                <b>var</b> <span id="r851 rd" class="r851 r">completedName</span> = (<span class="r850 r">name</span>.<span class="i">IndexOfAny</span>(<a href="#c30c08aec33a7836" class="i field">s_charactersRequiringQuotes</a>) == -1)
                                                        ? <span class="r815 r">prefix</span> + <span class="r850 r">name</span> + <span class="s">&quot;:&quot;</span>
                                                        : <span class="r815 r">prefix</span> + <span class="s">&quot;{&quot;</span> + <span class="r850 r">name</span> + <span class="s">&quot;:}&quot;</span>;
 
                                <b>var</b> <span id="r852 rd" class="r852 r">tooltip</span> = <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r849 r">driveInfo</span>.<a href="../DataStoreAdapter.cs.html#8741fc8d5ae7e498" class="i property">Description</a>) ? <span class="r850 r">name</span> : <span class="r849 r">driveInfo</span>.<a href="../DataStoreAdapter.cs.html#8741fc8d5ae7e498" class="i property">Description</a>;
                                <span class="i">AddUniqueVariable</span>(<span class="r809 r">hashedResults</span>, <span class="r810 r">results</span>, <span class="r851 r">completedName</span>, <span class="r850 r">name</span>, <span class="r852 r">tooltip</span>);
                            }
                        }
                    }
                }
 
                <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r853 rd" class="r853 r">scopePattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r832 r">pattern</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                <b>foreach</b> (<b>var</b> <span id="r854 rd" class="r854 r">scope</span> <b>in</b> <a href="#a133fdedb2147393" class="i field">s_variableScopes</a>)
                {
                    <b>if</b> (<span class="r853 r">scopePattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r854 r">scope</span>))
                    {
                        <b>var</b> <span id="r855 rd" class="r855 r">completedName</span> = (<span class="r854 r">scope</span>.<span class="i">IndexOfAny</span>(<a href="#c30c08aec33a7836" class="i field">s_charactersRequiringQuotes</a>) == -1)
                                                ? <span class="r815 r">prefix</span> + <span class="r854 r">scope</span>
                                                : <span class="r815 r">prefix</span> + <span class="s">&quot;{&quot;</span> + <span class="r854 r">scope</span> + <span class="s">&quot;}&quot;</span>;
                        <span class="i">AddUniqueVariable</span>(<span class="r809 r">hashedResults</span>, <span class="r810 r">results</span>, <span class="r855 r">completedName</span>, <span class="r854 r">scope</span>, <span class="r854 r">scope</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r810 r">results</span>;
        }
 
        <b>private static void</b> <a id="efa0c7354667a0fe" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">AddUniqueVariable</a>(<span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r856 rd" class="r856 r">hashedResults</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r857 rd" class="r857 r">results</span>, <b>string</b> <span id="r858 rd" class="r858 r">completionText</span>, <b>string</b> <span id="r859 rd" class="r859 r">listItemText</span>, <b>string</b> <span id="r860 rd" class="r860 r">tooltip</span>)
        {
            <b>if</b> (!<span class="r856 r">hashedResults</span>.<span class="i">Contains</span>(<span class="r858 r">completionText</span>))
            {
                <span class="r856 r">hashedResults</span>.<span class="i">Add</span>(<span class="r858 r">completionText</span>);
                <span class="r857 r">results</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r858 r">completionText</span>, <span class="r859 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#113b64205564c700" class="i field">Variable</a>, <span class="r860 r">tooltip</span>));
            }
        }
 
        <b>private sealed class</b> <a id="166522bbe62b746d" href="../../R/166522bbe62b746d.html" target="n" data-glyph="4,1" class="t t"><span id="bdbccf76a402c7ff">FindVariablesVisitor</span></a> : <a href="../parser/PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a>
        {
            <b>internal</b> <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <a id="6a8dde23240f66a2" href="../../R/6a8dde23240f66a2.html" target="n" data-glyph="44,2" class="i field">Top</a>;
            <b>internal</b> <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <a id="2cc14bf882ec42e9" href="../../R/2cc14bf882ec42e9.html" target="n" data-glyph="44,2" class="i field">CompletionVariableAst</a>;
            <b>internal readonly</b> <span class="i">List</span>&lt;<span class="i">Tuple</span>&lt;<b>string</b>, <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;&gt; <a id="df14c0f488cc45db" href="../../R/df14c0f488cc45db.html" target="n" data-glyph="44,2" class="i field">VariableSources</a> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Tuple</span>&lt;<b>string</b>, <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;&gt;();
 
            <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="e671fdaf93a29008" href="../../R/e671fdaf93a29008.html" target="n" data-glyph="72,2" class="i method">VisitVariableExpression</a>(<a href="../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r861 rd" class="r861 r">variableExpressionAst</span>)
            {
                <b>if</b> (<span class="r861 r">variableExpressionAst</span> != <a href="#2cc14bf882ec42e9" class="i field">CompletionVariableAst</a>)
                {
                    <a href="#df14c0f488cc45db" class="i field">VariableSources</a>.<span class="i">Add</span>(<b>new</b> <span class="i">Tuple</span>&lt;<b>string</b>, <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r861 r">variableExpressionAst</span>.<a href="../parser/ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>, <span class="r861 r">variableExpressionAst</span>));
                }
 
                <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            }
 
            <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="0717d1155ea88b04" href="../../R/0717d1155ea88b04.html" target="n" data-glyph="72,2" class="i method">VisitCommand</a>(<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r862 rd" class="r862 r">commandAst</span>)
            {
                <span class="c">// MSFT: 784739 Stack overflow during tab completion of pipeline variable</span>
                <span class="c">// $null | % -pv p { $p&lt;TAB&gt; -&gt; In this case $p is pipelinevariable</span>
                <span class="c">// and is used in the same command. PipelineVariables are not available</span>
                <span class="c">// in the command they are assigned in. Hence the following code ignores</span>
                <span class="c">// if the variable being completed is in the command extent.</span>
                <b>if</b> ((<span class="r862 r">commandAst</span> != <a href="#2cc14bf882ec42e9" class="i field">CompletionVariableAst</a>) &amp;&amp; (!<a href="#2cc14bf882ec42e9" class="i field">CompletionVariableAst</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#82c1f5e7b0f904bc" class="i method">IsWithin</a>(<span class="r862 r">commandAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>)))
                {
                    <b>string</b>[] <span id="r863 rd" class="r863 r">desiredParameters</span> = <b>new</b> <b>string</b>[] { <span class="s">&quot;PV&quot;</span>, <span class="s">&quot;PipelineVariable&quot;</span>, <span class="s">&quot;OV&quot;</span>, <span class="s">&quot;OutVariable&quot;</span> };
 
                    <a href="PseudoParameterBinder.cs.html#cae64ef619e0a99a" class="t t">StaticBindingResult</a> <span id="r864 rd" class="r864 r">bindingResult</span> = <a href="PseudoParameterBinder.cs.html#b6eface4652c31d3" class="t t">StaticParameterBinder</a>.<a href="PseudoParameterBinder.cs.html#078ba0a0a68941af" class="i method">BindCommand</a>(<span class="r862 r">commandAst</span>, <b>false</b>, <span class="r863 r">desiredParameters</span>);
                    <b>if</b> (<span class="r864 r">bindingResult</span> != <b>null</b>)
                    {
                        <a href="PseudoParameterBinder.cs.html#15f8f4f4f6f1cb09" class="t t">ParameterBindingResult</a> <span id="r865 rd" class="r865 r">parameterBindingResult</span>;
 
                        <b>foreach</b> (<b>string</b> <span id="r866 rd" class="r866 r">commandVariableParameter</span> <b>in</b> <span class="r863 r">desiredParameters</span>)
                        {
                            <b>if</b> (<span class="r864 r">bindingResult</span>.<a href="PseudoParameterBinder.cs.html#e54921e80ff4b0b1" class="i property">BoundParameters</a>.<span class="i">TryGetValue</span>(<span class="r866 r">commandVariableParameter</span>, <b>out</b> <span class="r865 r">parameterBindingResult</span>))
                            {
                                <a href="#df14c0f488cc45db" class="i field">VariableSources</a>.<span class="i">Add</span>(<b>new</b> <span class="i">Tuple</span>&lt;<b>string</b>, <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;((<b>string</b>)<span class="r865 r">parameterBindingResult</span>.<a href="PseudoParameterBinder.cs.html#852cbd614441cc24" class="i property">ConstantValue</a>, <span class="r862 r">commandAst</span>));
                            }
                        }
                    }
                }
 
                <b>return</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            }
 
            <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="95447d0cbfe3e7cb" href="../../R/95447d0cbfe3e7cb.html" target="n" data-glyph="72,2" class="i method">VisitFunctionDefinition</a>(<a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r867 rd" class="r867 r">functionDefinitionAst</span>)
            {
                <b>return</b> <span class="r867 r">functionDefinitionAst</span> != <a href="#6a8dde23240f66a2" class="i field">Top</a> ? <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a> : <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            }
 
            <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="4367680249aeb010" href="../../R/4367680249aeb010.html" target="n" data-glyph="72,2" class="i method">VisitScriptBlockExpression</a>(<a href="../parser/ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a> <span id="r868 rd" class="r868 r">scriptBlockExpressionAst</span>)
            {
                <b>return</b> <span class="r868 r">scriptBlockExpressionAst</span> != <a href="#6a8dde23240f66a2" class="i field">Top</a> ? <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a> : <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            }
 
            <b>public override</b> <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="172d051fb4fac6bb" href="../../R/172d051fb4fac6bb.html" target="n" data-glyph="72,2" class="i method">VisitScriptBlock</a>(<a href="../parser/ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r869 rd" class="r869 r">scriptBlockAst</span>)
            {
                <b>return</b> <span class="r869 r">scriptBlockAst</span> != <a href="#6a8dde23240f66a2" class="i field">Top</a> ? <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#32db74815e3296ba" class="i field">SkipChildren</a> : <a href="../parser/PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="../parser/PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            }
        }
 
        <b>private static readonly</b> <span class="i">Lazy</span>&lt;<span class="i">SortedSet</span>&lt;<b>string</b>&gt;&gt; <a id="3bbffea30dc9adfb" href="../../R/3bbffea30dc9adfb.html" target="n" data-glyph="46,1" class="i field">s_specialVariablesCache</a> = <b>new</b> <span class="i">Lazy</span>&lt;<span class="i">SortedSet</span>&lt;<b>string</b>&gt;&gt;(<span class="i">BuildSpecialVariablesCache</span>);
 
        <b>private static</b> <span class="i">SortedSet</span>&lt;<b>string</b>&gt; <a id="e1450f349cb5c552" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">BuildSpecialVariablesCache</a>()
        {
            <b>var</b> <span id="r870 rd" class="r870 r">result</span> = <b>new</b> <span class="i">SortedSet</span>&lt;<b>string</b>&gt;();
            <b>foreach</b> (<b>var</b> <span id="r871 rd" class="r871 r">member</span> <b>in</b> <b>typeof</b>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>).<span class="i">GetFields</span>(<span class="i">BindingFlags</span>.<span class="i">NonPublic</span> | <span class="i">BindingFlags</span>.<span class="i">Static</span>))
            {
                <b>if</b> (<span class="r871 r">member</span>.<span class="i">FieldType</span>.<span class="i">Equals</span>(<b>typeof</b>(<b>string</b>)))
                {
                    <span class="r870 r">result</span>.<span class="i">Add</span>((<b>string</b>)<span class="r871 r">member</span>.<span class="i">GetValue</span>(<b>null</b>));
                }
            }
 
            <b>return</b> <span class="r870 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Variables
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Comments
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="55990c3b8b42a076" href="../../R/55990c3b8b42a076.html" target="n" data-glyph="74,1" class="i method">CompleteComment</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r872 rd" class="r872 r">context</span>, <b>ref int</b> <span id="r873 rd" class="r873 r">replacementIndex</span>, <b>ref int</b> <span id="r874 rd" class="r874 r">replacementLength</span>)
        {
            <b>if</b> (<span class="r872 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>.<span class="i">StartsWith</span>(<span class="s">&quot;&lt;#&quot;</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
            {
                <b>return</b> <a href="#06ff7077f23e50c1" class="i method">CompleteCommentHelp</a>(<span class="r872 r">context</span>, <b>ref</b> <span class="r873 r">replacementIndex</span>, <b>ref</b> <span class="r874 r">replacementLength</span>);
            }
 
            <span class="c">// Complete #requires statements</span>
            <b>if</b> (<span class="r872 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>.<span class="i">StartsWith</span>(<span class="s">&quot;#requires &quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <a href="#67bdce7917c281f9" class="i method">CompleteRequires</a>(<span class="r872 r">context</span>, <b>ref</b> <span class="r873 r">replacementIndex</span>, <b>ref</b> <span class="r874 r">replacementLength</span>);
            }
 
            <b>var</b> <span id="r875 rd" class="r875 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
 
            <span class="c">// Complete the history entries</span>
            <span class="i">Match</span> <span id="r876 rd" class="r876 r">matchResult</span> = <span class="i">Regex</span>.<span class="i">Match</span>(<span class="r872 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>, <span class="s">@&quot;^#([\w\-]*)$&quot;</span>);
            <b>if</b> (!<span class="r876 r">matchResult</span>.<span class="i">Success</span>)
            {
                <b>return</b> <span class="r875 r">results</span>;
            }
 
            <b>string</b> <span id="r877 rd" class="r877 r">wordToComplete</span> = <span class="r876 r">matchResult</span>.<span class="i">Groups</span>[1].<span class="i">Value</span>;
            <span class="i">Collection</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt; <span id="r878 rd" class="r878 r">psobjs</span>;
 
            <b>int</b> <span id="r879 rd" class="r879 r">entryId</span>;
            <b>if</b> (<span class="i">Regex</span>.<span class="i">IsMatch</span>(<span class="r877 r">wordToComplete</span>, <span class="s">@&quot;^[0-9]+$&quot;</span>) &amp;&amp; <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">TryConvertTo</span>(<span class="r877 r">wordToComplete</span>, <b>out</b> <span class="r879 r">entryId</span>))
            {
                <span class="r872 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Get-History&quot;</span>, <b>typeof</b>(<a href="../hostifaces/History.cs.html#ad869538b692aa74" class="t t">GetHistoryCommand</a>)).<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Id&quot;</span>, <span class="r879 r">entryId</span>);
                <span class="r878 r">psobjs</span> = <span class="r872 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out _</b>);
 
                <b>if</b> (<span class="r878 r">psobjs</span> != <b>null</b> &amp;&amp; <span class="r878 r">psobjs</span>.<span class="i">Count</span> == 1)
                {
                    <a href="../hostifaces/History.cs.html#aa61f1e3135e278f" class="k">var</a> <span id="r880 rd" class="r880 r">historyInfo</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">Base</span>(<span class="r878 r">psobjs</span>[0]) <b>as</b> <a href="../hostifaces/History.cs.html#aa61f1e3135e278f" class="t t">HistoryInfo</a>;
                    <b>if</b> (<span class="r880 r">historyInfo</span> != <b>null</b>)
                    {
                        <b>var</b> <span id="r881 rd" class="r881 r">commandLine</span> = <span class="r880 r">historyInfo</span>.<a href="../hostifaces/History.cs.html#8a8406b2b45fb781" class="i property">CommandLine</a>;
                        <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r881 r">commandLine</span>))
                        {
                            <span class="c">// var tooltip = &quot;Id: &quot; + historyInfo.Id + &quot;\n&quot; +</span>
                            <span class="c">//               &quot;ExecutionStatus: &quot; + historyInfo.ExecutionStatus + &quot;\n&quot; +</span>
                            <span class="c">//               &quot;StartExecutionTime: &quot; + historyInfo.StartExecutionTime + &quot;\n&quot; +</span>
                            <span class="c">//               &quot;EndExecutionTime: &quot; + historyInfo.EndExecutionTime + &quot;\n&quot;;</span>
                            <span class="c">// Use the commandLine as the Tooltip in case the commandLine is multiple lines of scripts</span>
                            <span class="r875 r">results</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r881 r">commandLine</span>, <span class="r881 r">commandLine</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#9ecfa2d2925f2f3d" class="i field">History</a>, <span class="r881 r">commandLine</span>));
                        }
                    }
                }
 
                <b>return</b> <span class="r875 r">results</span>;
            }
 
            <span class="r877 r">wordToComplete</span> = <span class="s">&quot;*&quot;</span> + <span class="r877 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>;
            <span class="r872 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>.<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Get-History&quot;</span>, <b>typeof</b>(<a href="../hostifaces/History.cs.html#ad869538b692aa74" class="t t">GetHistoryCommand</a>));
 
            <span class="r878 r">psobjs</span> = <span class="r872 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out _</b>);
            <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r882 rd" class="r882 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r877 r">wordToComplete</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
            <b>if</b> (<span class="r878 r">psobjs</span> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r883 rd" class="r883 r">index</span> = <span class="r878 r">psobjs</span>.<span class="i">Count</span> - 1; <span class="r883 r">index</span> &gt;= 0; <span class="r883 r">index</span>--)
                {
                    <b>var</b> <span id="r884 rd" class="r884 r">psobj</span> = <span class="r878 r">psobjs</span>[<span class="r883 r">index</span>];
                    <b>if</b> (!(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">Base</span>(<span class="r884 r">psobj</span>) <b>is</b> <a href="../hostifaces/History.cs.html#aa61f1e3135e278f" class="t t">HistoryInfo</a> <span id="r885 rd" class="r885 r">historyInfo</span>)) <b>continue</b>;
 
                    <b>var</b> <span id="r886 rd" class="r886 r">commandLine</span> = <span class="r885 r">historyInfo</span>.<a href="../hostifaces/History.cs.html#8a8406b2b45fb781" class="i property">CommandLine</a>;
                    <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r886 r">commandLine</span>) &amp;&amp; <span class="r882 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r886 r">commandLine</span>))
                    {
                        <span class="c">// var tooltip = &quot;Id: &quot; + historyInfo.Id + &quot;\n&quot; +</span>
                        <span class="c">//               &quot;ExecutionStatus: &quot; + historyInfo.ExecutionStatus + &quot;\n&quot; +</span>
                        <span class="c">//               &quot;StartExecutionTime: &quot; + historyInfo.StartExecutionTime + &quot;\n&quot; +</span>
                        <span class="c">//               &quot;EndExecutionTime: &quot; + historyInfo.EndExecutionTime + &quot;\n&quot;;</span>
                        <span class="c">// Use the commandLine as the Tooltip in case the commandLine is multiple lines of scripts</span>
                        <span class="r875 r">results</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r886 r">commandLine</span>, <span class="r886 r">commandLine</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#9ecfa2d2925f2f3d" class="i field">History</a>, <span class="r886 r">commandLine</span>));
                    }
                }
            }
 
            <b>return</b> <span class="r875 r">results</span>;
        }
 
        <b>private static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="67bdce7917c281f9" href="../../R/67bdce7917c281f9.html" target="n" data-glyph="76,1" class="i method">CompleteRequires</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r887 rd" class="r887 r">context</span>, <b>ref int</b> <span id="r888 rd" class="r888 r">replacementIndex</span>, <b>ref int</b> <span id="r889 rd" class="r889 r">replacementLength</span>)
        {
            <b>var</b> <span id="r890 rd" class="r890 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
 
            <b>int</b> <span id="r891 rd" class="r891 r">cursorIndex</span> = <span class="r887 r">context</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>.<a href="../parser/Position.cs.html#adb21ecf0073d187" class="i property">ColumnNumber</a> - 1;
            <b>string</b> <span id="r892 rd" class="r892 r">lineToCursor</span> = <span class="r887 r">context</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>.<a href="../parser/Position.cs.html#5498933e478f6930" class="i property">Line</a>.<span class="i">Substring</span>(0, <span class="r891 r">cursorIndex</span>);
 
            <span class="c">// RunAsAdministrator must be the last parameter in a Requires statement so no completion if the cursor is after the parameter.</span>
            <b>if</b> (<span class="r892 r">lineToCursor</span>.<span class="i">Contains</span>(<span class="s">&quot; -RunAsAdministrator&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <span class="r890 r">results</span>;
            }
 
            <span class="c">// Regex to find parameter like &quot; -Parameter1&quot; or &quot; -&quot;</span>
            <span class="i">MatchCollection</span> <span id="r893 rd" class="r893 r">hashtableKeyMatches</span> = <span class="i">Regex</span>.<span class="i">Matches</span>(<span class="r892 r">lineToCursor</span>, <span class="s">@&quot;\s+-([A-Za-z]+|$)&quot;</span>);
            <b>if</b> (<span class="r893 r">hashtableKeyMatches</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <span class="r890 r">results</span>;
            }
 
            <span class="i">Group</span> <span id="r894 rd" class="r894 r">currentParameterMatch</span> = <span class="r893 r">hashtableKeyMatches</span>[^1].<span class="i">Groups</span>[1];
 
            <span class="c">// Complete the parameter if the cursor is at a parameter</span>
            <b>if</b> (<span class="r894 r">currentParameterMatch</span>.<span class="i">Index</span> + <span class="r894 r">currentParameterMatch</span>.<span class="i">Length</span> == <span class="r891 r">cursorIndex</span>)
            {
                <b>string</b> <span id="r895 rd" class="r895 r">currentParameterPrefix</span> = <span class="r894 r">currentParameterMatch</span>.<span class="i">Value</span>;
 
                <span class="r888 r">replacementIndex</span> = <span class="r887 r">context</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>.<a href="../parser/Position.cs.html#cd3280d5f1045b06" class="i property">Offset</a> - <span class="r895 r">currentParameterPrefix</span>.<span class="i">Length</span>;
                <span class="r889 r">replacementLength</span> = <span class="r895 r">currentParameterPrefix</span>.<span class="i">Length</span>;
 
                <span class="c">// Produce completions for all parameters that begin with the prefix we&#39;ve found,</span>
                <span class="c">// but which haven&#39;t already been specified in the line we need to complete</span>
                <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <b>string</b>&gt; <span id="r896 rd" class="r896 r">parameter</span> <b>in</b> <a href="#9f020eb9524b6785" class="i field">s_requiresParameters</a>)
                {
                    <b>if</b> (<span class="r896 r">parameter</span>.<span class="i">Key</span>.<span class="i">StartsWith</span>(<span class="r895 r">currentParameterPrefix</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                        &amp;&amp; !<span class="r887 r">context</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>.<a href="../parser/Position.cs.html#5498933e478f6930" class="i property">Line</a>.<span class="i">Contains</span>(<span class="s">$&quot;</span><span class="s"> -</span>{<span class="r896 r">parameter</span>.<span class="i">Key</span>}<span class="s">&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r890 r">results</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(<span class="r896 r">parameter</span>.<span class="i">Key</span>, <span class="r896 r">parameter</span>.<span class="i">Key</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#c4ba8e90b3cad3b3" class="i field">ParameterName</a>, <span class="r896 r">parameter</span>.<span class="i">Value</span>));
                    }
                }
 
                <b>return</b> <span class="r890 r">results</span>;
            }
 
            <span class="c">// Regex to find parameter values (any text that appears after various delimiters)</span>
            <span class="r893 r">hashtableKeyMatches</span> = <span class="i">Regex</span>.<span class="i">Matches</span>(<span class="r892 r">lineToCursor</span>, <span class="s">@&quot;(\s+|,|;|{|\&quot;&quot;|&#39;|=)(\w+|$)&quot;</span>);
            <b>string</b> <span id="r897 rd" class="r897 r">currentValue</span>;
            <b>if</b> (<span class="r893 r">hashtableKeyMatches</span>.<span class="i">Count</span> == 0)
            {
                <span class="r897 r">currentValue</span> = <b>string</b>.<span class="i">Empty</span>;
            }
            <b>else</b>
            {
                <span class="r897 r">currentValue</span> = <span class="r893 r">hashtableKeyMatches</span>[^1].<span class="i">Groups</span>[2].<span class="i">Value</span>;
            }
 
            <span class="r888 r">replacementIndex</span> = <span class="r887 r">context</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>.<a href="../parser/Position.cs.html#cd3280d5f1045b06" class="i property">Offset</a> - <span class="r897 r">currentValue</span>.<span class="i">Length</span>;
            <span class="r889 r">replacementLength</span> = <span class="r897 r">currentValue</span>.<span class="i">Length</span>;
 
            <span class="c">// Complete PSEdition parameter values</span>
            <b>if</b> (<span class="r894 r">currentParameterMatch</span>.<span class="i">Value</span>.<span class="i">Equals</span>(<span class="s">&quot;PSEdition&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <b>string</b>&gt; <span id="r898 rd" class="r898 r">psEditionEntry</span> <b>in</b> <a href="#eec5e41b4d346697" class="i field">s_requiresPSEditions</a>)
                {
                    <b>if</b> (<span class="r898 r">psEditionEntry</span>.<span class="i">Key</span>.<span class="i">StartsWith</span>(<span class="r897 r">currentValue</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r890 r">results</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(<span class="r898 r">psEditionEntry</span>.<span class="i">Key</span>, <span class="r898 r">psEditionEntry</span>.<span class="i">Key</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <span class="r898 r">psEditionEntry</span>.<span class="i">Value</span>));
                    }
                }
 
                <b>return</b> <span class="r890 r">results</span>;
            }
 
            <span class="c">// Complete Modules module specification values</span>
            <b>if</b> (<span class="r894 r">currentParameterMatch</span>.<span class="i">Value</span>.<span class="i">Equals</span>(<span class="s">&quot;Modules&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>int</b> <span id="r899 rd" class="r899 r">hashtableStart</span> = <span class="r892 r">lineToCursor</span>.<span class="i">LastIndexOf</span>(<span class="s">&quot;@{&quot;</span>);
                <b>int</b> <span id="r900 rd" class="r900 r">hashtableEnd</span> = <span class="r892 r">lineToCursor</span>.<span class="i">LastIndexOf</span>(<span class="s">&#39;}&#39;</span>);
 
                <b>bool</b> <span id="r901 rd" class="r901 r">insideHashtable</span> = <span class="r899 r">hashtableStart</span> != -1 &amp;&amp; (<span class="r900 r">hashtableEnd</span> == -1 || <span class="r900 r">hashtableEnd</span> &lt; <span class="r899 r">hashtableStart</span>);
 
                <span class="c">// If not inside a hashtable, try to complete a module simple name</span>
                <b>if</b> (!<span class="r901 r">insideHashtable</span>)
                {
                    <span class="r887 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r897 r">currentValue</span>;
                    <b>return</b> <a href="#f0abd69597cfd93f" class="i method">CompleteModuleName</a>(<span class="r887 r">context</span>, <b>true</b>);
                }
 
                <b>string</b> <span id="r902 rd" class="r902 r">hashtableString</span> = <span class="r892 r">lineToCursor</span>.<span class="i">Substring</span>(<span class="r899 r">hashtableStart</span>);
 
                <span class="c">// Regex to find hashtable keys with or without quotes</span>
                <span class="r893 r">hashtableKeyMatches</span> = <span class="i">Regex</span>.<span class="i">Matches</span>(<span class="r902 r">hashtableString</span>, <span class="s">@&quot;(@{|;)\s*(?:&#39;|\&quot;&quot;|\w*)\w*&quot;</span>);
 
                <span class="c">// Build the list of keys we might want to complete, based on what&#39;s already been provided</span>
                <b>var</b> <span id="r903 rd" class="r903 r">moduleSpecKeysToComplete</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<a href="#6a8c19bc77dcfc20" class="i field">s_requiresModuleSpecKeys</a>.<span class="i">Keys</span>);
                <b>bool</b> <span id="r904 rd" class="r904 r">sawModuleNameLast</span> = <b>false</b>;
                <b>foreach</b> (<span class="i">Match</span> <span id="r905 rd" class="r905 r">existingHashtableKeyMatch</span> <b>in</b> <span class="r893 r">hashtableKeyMatches</span>)
                {
                    <b>string</b> <span id="r906 rd" class="r906 r">existingHashtableKey</span> = <span class="r905 r">existingHashtableKeyMatch</span>.<span class="i">Value</span>.<span class="i">TrimStart</span>(<a href="#8e93d7c34b3cc221" class="i field">s_hashtableKeyPrefixes</a>);
 
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r906 r">existingHashtableKey</span>))
                    {
                        <b>continue</b>;
                    }
 
                    <span class="c">// Remove the existing key we just saw</span>
                    <span class="r903 r">moduleSpecKeysToComplete</span>.<span class="i">Remove</span>(<span class="r906 r">existingHashtableKey</span>);
 
                    <span class="c">// We need to remember later if we saw &quot;ModuleName&quot; as the last hashtable key, for completions</span>
                    <b>if</b> (<span class="r904 r">sawModuleNameLast</span> = <span class="r906 r">existingHashtableKey</span>.<span class="i">Equals</span>(<span class="s">&quot;ModuleName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>continue</b>;
                    }
 
                    <span class="c">// &quot;RequiredVersion&quot; is mutually exclusive with &quot;ModuleVersion&quot; and &quot;MaximumVersion&quot;</span>
                    <b>if</b> (<span class="r906 r">existingHashtableKey</span>.<span class="i">Equals</span>(<span class="s">&quot;ModuleVersion&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                        || <span class="r906 r">existingHashtableKey</span>.<span class="i">Equals</span>(<span class="s">&quot;MaximumVersion&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r903 r">moduleSpecKeysToComplete</span>.<span class="i">Remove</span>(<span class="s">&quot;RequiredVersion&quot;</span>);
                        <b>continue</b>;
                    }
 
                    <b>if</b> (<span class="r906 r">existingHashtableKey</span>.<span class="i">Equals</span>(<span class="s">&quot;RequiredVersion&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r903 r">moduleSpecKeysToComplete</span>.<span class="i">Remove</span>(<span class="s">&quot;ModuleVersion&quot;</span>);
                        <span class="r903 r">moduleSpecKeysToComplete</span>.<span class="i">Remove</span>(<span class="s">&quot;MaximumVersion&quot;</span>);
                        <b>continue</b>;
                    }
                }
 
                <span class="i">Group</span> <span id="r907 rd" class="r907 r">lastHashtableKeyPrefixGroup</span> = <span class="r893 r">hashtableKeyMatches</span>[^1].<span class="i">Groups</span>[0];
 
                <span class="c">// If we&#39;re not completing a key for the hashtable, try to complete module names, but nothing else</span>
                <b>bool</b> <span id="r908 rd" class="r908 r">completingHashtableKey</span> = <span class="r907 r">lastHashtableKeyPrefixGroup</span>.<span class="i">Index</span> + <span class="r907 r">lastHashtableKeyPrefixGroup</span>.<span class="i">Length</span> == <span class="r902 r">hashtableString</span>.<span class="i">Length</span>;
                <b>if</b> (!<span class="r908 r">completingHashtableKey</span>)
                {
                    <b>if</b> (<span class="r904 r">sawModuleNameLast</span>)
                    {
                        <span class="r887 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r897 r">currentValue</span>;
                        <b>return</b> <a href="#f0abd69597cfd93f" class="i method">CompleteModuleName</a>(<span class="r887 r">context</span>, <b>true</b>);
                    }
 
                    <b>return</b> <span class="r890 r">results</span>;
                }
 
                <span class="c">// Now try to complete hashtable keys</span>
                <b>foreach</b> (<b>string</b> <span id="r909 rd" class="r909 r">moduleSpecKey</span> <b>in</b> <span class="r903 r">moduleSpecKeysToComplete</span>)
                {
                    <b>if</b> (<span class="r909 r">moduleSpecKey</span>.<span class="i">StartsWith</span>(<span class="r897 r">currentValue</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r890 r">results</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(<span class="r909 r">moduleSpecKey</span>, <span class="r909 r">moduleSpecKey</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#381d18cfe9b15b03" class="i field">ParameterValue</a>, <a href="#6a8c19bc77dcfc20" class="i field">s_requiresModuleSpecKeys</a>[<span class="r909 r">moduleSpecKey</span>]));
                    }
                }
            }
 
            <b>return</b> <span class="r890 r">results</span>;
        }
 
        <b>private static readonly</b> <span class="i">IReadOnlyDictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="9f020eb9524b6785" href="../../R/9f020eb9524b6785.html" target="n" data-glyph="46,1" class="i field">s_requiresParameters</a> = <b>new</b> <span class="i">SortedList</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
        {
            { <span class="s">&quot;Modules&quot;</span>, <span class="s">&quot;Specifies PowerShell modules that the script requires.&quot;</span> },
            { <span class="s">&quot;PSEdition&quot;</span>, <span class="s">&quot;Specifies a PowerShell edition that the script requires.&quot;</span> },
            { <span class="s">&quot;RunAsAdministrator&quot;</span>, <span class="s">&quot;Specifies that PowerShell must be running as administrator on Windows.&quot;</span> },
            { <span class="s">&quot;Version&quot;</span>, <span class="s">&quot;Specifies the minimum version of PowerShell that the script requires.&quot;</span> },
        };
 
        <b>private static readonly</b> <span class="i">IReadOnlyDictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="eec5e41b4d346697" href="../../R/eec5e41b4d346697.html" target="n" data-glyph="46,1" class="i field">s_requiresPSEditions</a> = <b>new</b> <span class="i">SortedList</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
        {
            { <span class="s">&quot;Core&quot;</span>, <span class="s">&quot;Specifies that the script requires PowerShell Core to run.&quot;</span> },
            { <span class="s">&quot;Desktop&quot;</span>, <span class="s">&quot;Specifies that the script requires Windows PowerShell to run.&quot;</span> },
        };
 
        <b>private static readonly</b> <span class="i">IReadOnlyDictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="6a8c19bc77dcfc20" href="../../R/6a8c19bc77dcfc20.html" target="n" data-glyph="46,1" class="i field">s_requiresModuleSpecKeys</a> = <b>new</b> <span class="i">SortedList</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
        {
            { <span class="s">&quot;ModuleName&quot;</span>, <span class="s">&quot;Required. Specifies the module name.&quot;</span> },
            { <span class="s">&quot;GUID&quot;</span>, <span class="s">&quot;Optional. Specifies the GUID of the module.&quot;</span> },
            { <span class="s">&quot;ModuleVersion&quot;</span>, <span class="s">&quot;Specifies a minimum acceptable version of the module.&quot;</span> },
            { <span class="s">&quot;RequiredVersion&quot;</span>, <span class="s">&quot;Specifies an exact, required version of the module.&quot;</span> },
            { <span class="s">&quot;MaximumVersion&quot;</span>, <span class="s">&quot;Specifies the maximum acceptable version of the module.&quot;</span> },
        };
 
        <b>private static readonly char</b>[] <a id="8e93d7c34b3cc221" href="../../R/8e93d7c34b3cc221.html" target="n" data-glyph="46,1" class="i field">s_hashtableKeyPrefixes</a> = <b>new</b>[]
        {
            <span class="s">&#39;@&#39;</span>,
            <span class="s">&#39;{&#39;</span>,
            <span class="s">&#39;;&#39;</span>,
            <span class="s">&#39;&quot;&#39;</span>,
            <span class="s">&#39;\&#39;&#39;</span>,
            <span class="s">&#39; &#39;</span>,
        };
 
        <b>private static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="06ff7077f23e50c1" href="../../R/06ff7077f23e50c1.html" target="n" data-glyph="76,1" class="i method">CompleteCommentHelp</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r910 rd" class="r910 r">context</span>, <b>ref int</b> <span id="r911 rd" class="r911 r">replacementIndex</span>, <b>ref int</b> <span id="r912 rd" class="r912 r">replacementLength</span>)
        {
            <span class="c">// Finds comment keywords like &quot;.DESCRIPTION&quot;</span>
            <span class="i">MatchCollection</span> <span id="r913 rd" class="r913 r">usedKeywords</span> = <span class="i">Regex</span>.<span class="i">Matches</span>(<span class="r910 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <span class="s">@&quot;(?&lt;=^\s*\.)\w*&quot;</span>, <span class="i">RegexOptions</span>.<span class="i">Multiline</span>);
            <b>if</b> (<span class="r913 r">usedKeywords</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="c">// Last keyword at or before the cursor</span>
            <span class="i">Match</span> <span id="r914 rd" class="r914 r">lineKeyword</span> = <b>null</b>;
            <b>for</b> (<b>int</b> <span id="r915 rd" class="r915 r">i</span> = <span class="r913 r">usedKeywords</span>.<span class="i">Count</span> - 1; <span class="r915 r">i</span> &gt;= 0; <span class="r915 r">i</span>--)
            {
                <span class="i">Match</span> <span id="r916 rd" class="r916 r">keyword</span> = <span class="r913 r">usedKeywords</span>[<span class="r915 r">i</span>];
                <b>if</b> (<span class="r910 r">context</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>.<a href="../parser/Position.cs.html#cd3280d5f1045b06" class="i property">Offset</a> &gt;= <span class="r916 r">keyword</span>.<span class="i">Index</span> + <span class="r910 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>)
                {
                    <span class="r914 r">lineKeyword</span> = <span class="r916 r">keyword</span>;
                    <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r914 r">lineKeyword</span> <b>is null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="c">// Cursor is within or at the start/end of the keyword</span>
            <b>if</b> (<span class="r910 r">context</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>.<a href="../parser/Position.cs.html#cd3280d5f1045b06" class="i property">Offset</a> &lt;= <span class="r914 r">lineKeyword</span>.<span class="i">Index</span> + <span class="r914 r">lineKeyword</span>.<span class="i">Length</span> + <span class="r910 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>)
            {
                <span class="r911 r">replacementIndex</span> = <span class="r910 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> + <span class="r914 r">lineKeyword</span>.<span class="i">Index</span>;
                <span class="r912 r">replacementLength</span> = <span class="r914 r">lineKeyword</span>.<span class="i">Value</span>.<span class="i">Length</span>;
 
                <b>var</b> <span id="r917 rd" class="r917 r">validKeywords</span> = <b>new</b> <span class="i">HashSet</span>&lt;<span class="i">String</span>&gt;(<a href="#f298e7f54e3c83e5" class="i field">s_commentHelpKeywords</a>.<span class="i">Keys</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                <b>foreach</b> (<span class="i">Match</span> <span id="r918 rd" class="r918 r">keyword</span> <b>in</b> <span class="r913 r">usedKeywords</span>)
                {
                    <b>if</b> (<span class="r918 r">keyword</span> == <span class="r914 r">lineKeyword</span> || <a href="#15abb8ed957b232d" class="i field">s_commentHelpAllowedDuplicateKeywords</a>.<span class="i">Contains</span>(<span class="r918 r">keyword</span>.<span class="i">Value</span>))
                    {
                        <b>continue</b>;
                    }
 
                    <span class="r917 r">validKeywords</span>.<span class="i">Remove</span>(<span class="r918 r">keyword</span>.<span class="i">Value</span>);
                }
 
                <b>var</b> <span id="r919 rd" class="r919 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
                <b>foreach</b> (<b>string</b> <span id="r920 rd" class="r920 r">keyword</span> <b>in</b> <span class="r917 r">validKeywords</span>)
                {
                    <b>if</b> (<span class="r920 r">keyword</span>.<span class="i">StartsWith</span>(<span class="r914 r">lineKeyword</span>.<span class="i">Value</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r919 r">result</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(<span class="r920 r">keyword</span>, <span class="r920 r">keyword</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#4c0781f5b4fa61bf" class="i field">Keyword</a>, <a href="#f298e7f54e3c83e5" class="i field">s_commentHelpKeywords</a>[<span class="r920 r">keyword</span>]));
                    }
                }
 
                <b>return</b> <span class="r919 r">result</span>.<span class="i">Count</span> &gt; 0 ? <span class="r919 r">result</span> : <b>null</b>;
            }
 
            <span class="c">// Finds the argument for the keyword (any characters following the keyword, ignoring leading/trailing whitespace). For example &quot;C:\New folder&quot;</span>
            <span class="i">Match</span> <span id="r921 rd" class="r921 r">keywordArgument</span> = <span class="i">Regex</span>.<span class="i">Match</span>(<span class="r910 r">context</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>.<a href="../parser/Position.cs.html#5498933e478f6930" class="i property">Line</a>, <span class="s">@&quot;(?&lt;=^\s*\.\w+\s+)\S.*(?&lt;=\S)&quot;</span>);
            <b>int</b> <span id="r922 rd" class="r922 r">lineStartIndex</span> = <span class="r914 r">lineKeyword</span>.<span class="i">Index</span> - <span class="r910 r">context</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>.<a href="../parser/Position.cs.html#5498933e478f6930" class="i property">Line</a>.<span class="i">IndexOf</span>(<span class="r914 r">lineKeyword</span>.<span class="i">Value</span>) + <span class="r910 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>;
            <b>int</b> <span id="r923 rd" class="r923 r">argumentIndex</span> = <span class="r921 r">keywordArgument</span>.<span class="i">Success</span> ? <span class="r921 r">keywordArgument</span>.<span class="i">Index</span> : <span class="r910 r">context</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>.<a href="../parser/Position.cs.html#adb21ecf0073d187" class="i property">ColumnNumber</a> - 1;
 
            <span class="r911 r">replacementIndex</span> = <span class="r922 r">lineStartIndex</span> + <span class="r923 r">argumentIndex</span>;
            <span class="r912 r">replacementLength</span> = <span class="r921 r">keywordArgument</span>.<span class="i">Value</span>.<span class="i">Length</span>;
 
            <b>if</b> (<span class="r914 r">lineKeyword</span>.<span class="i">Value</span>.<span class="i">Equals</span>(<span class="s">&quot;PARAMETER&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>return</b> <span class="i">CompleteCommentParameterValue</span>(<span class="r910 r">context</span>, <span class="r921 r">keywordArgument</span>.<span class="i">Value</span>);
            }
 
            <b>if</b> (<span class="r914 r">lineKeyword</span>.<span class="i">Value</span>.<span class="i">Equals</span>(<span class="s">&quot;FORWARDHELPTARGETNAME&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>var</b> <span id="r924 rd" class="r924 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;(<span class="i">CompleteCommand</span>(<span class="r921 r">keywordArgument</span>.<span class="i">Value</span>, <span class="s">&quot;*&quot;</span>, <a href="../CommandInfo.cs.html#3699fe79fa6969b5" class="t t">CommandTypes</a>.<a href="../CommandInfo.cs.html#d7f466cfbbd45cdb" class="i field">All</a>));
                <b>return</b> <span class="r924 r">result</span>.<span class="i">Count</span> &gt; 0 ? <span class="r924 r">result</span> : <b>null</b>;
            }
 
            <b>if</b> (<span class="r914 r">lineKeyword</span>.<span class="i">Value</span>.<span class="i">Equals</span>(<span class="s">&quot;FORWARDHELPCATEGORY&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>var</b> <span id="r925 rd" class="r925 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
                <b>foreach</b> (<b>string</b> <span id="r926 rd" class="r926 r">category</span> <b>in</b> <a href="#87b7cc6ec6188fff" class="i field">s_commentHelpForwardCategories</a>)
                {
                    <b>if</b> (<span class="r926 r">category</span>.<span class="i">StartsWith</span>(<span class="r921 r">keywordArgument</span>.<span class="i">Value</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r925 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="r926 r">category</span>));
                    }
                }
                <b>return</b> <span class="r925 r">result</span>.<span class="i">Count</span> &gt; 0 ? <span class="r925 r">result</span> : <b>null</b>;
            }
 
            <b>if</b> (<span class="r914 r">lineKeyword</span>.<span class="i">Value</span>.<span class="i">Equals</span>(<span class="s">&quot;REMOTEHELPRUNSPACE&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>var</b> <span id="r927 rd" class="r927 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
                <b>foreach</b> (<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <span id="r928 rd" class="r928 r">variable</span> <b>in</b> <span class="i">CompleteVariable</span>(<span class="r921 r">keywordArgument</span>.<span class="i">Value</span>))
                {
                    <span class="c">// ListItemText is used because it excludes the &quot;$&quot; as expected by REMOTEHELPRUNSPACE.</span>
                    <span class="r927 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r928 r">variable</span>.<a href="CompletionResult.cs.html#e734fe4987da07ab" class="i property">ListItemText</a>, <span class="r928 r">variable</span>.<a href="CompletionResult.cs.html#e734fe4987da07ab" class="i property">ListItemText</a>, <span class="r928 r">variable</span>.<a href="CompletionResult.cs.html#d35199370d0a5658" class="i property">ResultType</a>, <span class="r928 r">variable</span>.<a href="CompletionResult.cs.html#34a44c8b3b89530a" class="i property">ToolTip</a>));
                }
                <b>return</b> <span class="r927 r">result</span>.<span class="i">Count</span> &gt; 0 ? <span class="r927 r">result</span> : <b>null</b>;
            }
 
            <b>if</b> (<span class="r914 r">lineKeyword</span>.<span class="i">Value</span>.<span class="i">Equals</span>(<span class="s">&quot;EXTERNALHELP&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r910 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r921 r">keywordArgument</span>.<span class="i">Value</span>;
                <b>var</b> <span id="r929 rd" class="r929 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;(<a href="#f23c14b94c0c013f" class="i method">CompleteFilename</a>(<span class="r910 r">context</span>, <span class="r95 r">containerOnly</span>: <b>false</b>, (<b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;() { <span class="s">&quot;.xml&quot;</span> })));
                <b>return</b> <span class="r929 r">result</span>.<span class="i">Count</span> &gt; 0 ? <span class="r929 r">result</span> : <b>null</b>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static readonly</b> <span class="i">IReadOnlyDictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="f298e7f54e3c83e5" href="../../R/f298e7f54e3c83e5.html" target="n" data-glyph="46,1" class="i field">s_commentHelpKeywords</a> = <b>new</b> <span class="i">SortedList</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
        {
            { <span class="s">&quot;SYNOPSIS&quot;</span>, <span class="s">&quot;A brief description of the function or script. This keyword can be used only once in each topic.&quot;</span> },
            { <span class="s">&quot;DESCRIPTION&quot;</span>, <span class="s">&quot;A detailed description of the function or script. This keyword can be used only once in each topic.&quot;</span> },
            { <span class="s">&quot;PARAMETER&quot;</span>, <span class="s">&quot;.PARAMETER  &lt;Parameter-Name&gt;\nThe description of a parameter. Add a .PARAMETER keyword for each parameter in the function or script syntax.&quot;</span> },
            { <span class="s">&quot;EXAMPLE&quot;</span>, <span class="s">&quot;A sample command that uses the function or script, optionally followed by sample output and a description. Repeat this keyword for each example.&quot;</span> },
            { <span class="s">&quot;INPUTS&quot;</span>, <span class="s">&quot;The .NET types of objects that can be piped to the function or script. You can also include a description of the input objects.&quot;</span> },
            { <span class="s">&quot;OUTPUTS&quot;</span>, <span class="s">&quot;The .NET type of the objects that the cmdlet returns. You can also include a description of the returned objects.&quot;</span> },
            { <span class="s">&quot;NOTES&quot;</span>, <span class="s">&quot;Additional information about the function or script.&quot;</span> },
            { <span class="s">&quot;LINK&quot;</span>, <span class="s">&quot;The name of a related topic. Repeat the .LINK keyword for each related topic. The .Link keyword content can also include a URI to an online version of the same help topic.&quot;</span> },
            { <span class="s">&quot;COMPONENT&quot;</span>, <span class="s">&quot;The name of the technology or feature that the function or script uses, or to which it is related.&quot;</span> },
            { <span class="s">&quot;ROLE&quot;</span>, <span class="s">&quot;The name of the user role for the help topic.&quot;</span> },
            { <span class="s">&quot;FUNCTIONALITY&quot;</span>, <span class="s">&quot;The keywords that describe the intended use of the function.&quot;</span> },
            { <span class="s">&quot;FORWARDHELPTARGETNAME&quot;</span>, <span class="s">&quot;.FORWARDHELPTARGETNAME &lt;Command-Name&gt;\nRedirects to the help topic for the specified command.&quot;</span> },
            { <span class="s">&quot;FORWARDHELPCATEGORY&quot;</span>, <span class="s">&quot;.FORWARDHELPCATEGORY &lt;Category&gt;\nSpecifies the help category of the item in .ForwardHelpTargetName&quot;</span> },
            { <span class="s">&quot;REMOTEHELPRUNSPACE&quot;</span>, <span class="s">&quot;.REMOTEHELPRUNSPACE &lt;PSSession-variable&gt;\nSpecifies a session that contains the help topic. Enter a variable that contains a PSSession object.&quot;</span> },
            { <span class="s">&quot;EXTERNALHELP&quot;</span>, <span class="s">&quot;.EXTERNALHELP &lt;XML Help File&gt;\nThe .ExternalHelp keyword is required when a function or script is documented in XML files.&quot;</span> }
        };
 
        <b>private static readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="15abb8ed957b232d" href="../../R/15abb8ed957b232d.html" target="n" data-glyph="46,1" class="i field">s_commentHelpAllowedDuplicateKeywords</a> = <b>new</b>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
        {
            <span class="s">&quot;PARAMETER&quot;</span>,
            <span class="s">&quot;EXAMPLE&quot;</span>,
            <span class="s">&quot;LINK&quot;</span>
        };
 
        <b>private static readonly string</b>[] <a id="87b7cc6ec6188fff" href="../../R/87b7cc6ec6188fff.html" target="n" data-glyph="46,1" class="i field">s_commentHelpForwardCategories</a> = <b>new</b> <b>string</b>[]
        {
            <span class="s">&quot;Alias&quot;</span>,
            <span class="s">&quot;Cmdlet&quot;</span>,
            <span class="s">&quot;HelpFile&quot;</span>,
            <span class="s">&quot;Function&quot;</span>,
            <span class="s">&quot;Provider&quot;</span>,
            <span class="s">&quot;General&quot;</span>,
            <span class="s">&quot;FAQ&quot;</span>,
            <span class="s">&quot;Glossary&quot;</span>,
            <span class="s">&quot;ScriptCommand&quot;</span>,
            <span class="s">&quot;ExternalScript&quot;</span>,
            <span class="s">&quot;Filter&quot;</span>,
            <span class="s">&quot;All&quot;</span>
        };
 
        <b>private static</b> <a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <a id="7bdaea23556d3d11" href="../../R/7bdaea23556d3d11.html" target="n" data-glyph="76,1" class="i method">GetCommentHelpFunctionTarget</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r930 rd" class="r930 r">context</span>)
        {
            <b>if</b> (<span class="r930 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#1be92d0c82164308" class="i field">Comment</a>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r931 rd" class="r931 r">lastAst</span> = <span class="r930 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>[^1];
            <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r932 rd" class="r932 r">firstAstAfterComment</span> = <span class="r931 r">lastAst</span>.<span class="i">Find</span>(<span id="r933 rd" class="r933 r">ast</span> =&gt; <span class="r933 r">ast</span>.<span class="i">Extent</span>.<span class="i">StartOffset</span> &gt;= <span class="r930 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a>, <span class="i">searchNestedScriptBlocks</span>: <b>false</b>);
 
            <span class="c">// Comment-based help can apply to a following function definition if it starts within 2 lines</span>
            <b>int</b> <span id="r934 rd" class="r934 r">commentEndLine</span> = <span class="r930 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#ccd649a5269e237d" class="i property">EndLineNumber</a> + 2;
 
            <b>if</b> (<span class="r931 r">lastAst</span> <b>is</b> <a href="../parser/ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a>)
            {
                <span class="c">// Helpblock before function inside advanced function</span>
                <b>if</b> (<span class="r932 r">firstAstAfterComment</span> <b>is not null</b>
                    &amp;&amp; <span class="r932 r">firstAstAfterComment</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a> &lt;= <span class="r934 r">commentEndLine</span>
                    &amp;&amp; <span class="r932 r">firstAstAfterComment</span> <b>is</b> <a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r935 rd" class="r935 r">outerHelpFunctionDefAst</span>)
                {
                    <b>return</b> <span class="r935 r">outerHelpFunctionDefAst</span>;
                }
 
                <span class="c">// Helpblock inside function</span>
                <b>if</b> (<span class="r931 r">lastAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r936 rd" class="r936 r">innerHelpFunctionDefAst</span>)
                {
                    <b>return</b> <span class="r936 r">innerHelpFunctionDefAst</span>;
                }
            }
 
            <b>if</b> (<span class="r931 r">lastAst</span> <b>is</b> <a href="../parser/ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a>)
            {
                <span class="c">// Helpblock before function</span>
                <b>if</b> (<span class="r932 r">firstAstAfterComment</span> <b>is not null</b>
                    &amp;&amp; <span class="r932 r">firstAstAfterComment</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a> &lt;= <span class="r934 r">commentEndLine</span>
                    &amp;&amp; <span class="r932 r">firstAstAfterComment</span> <b>is</b> <a href="../parser/ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r937 rd" class="r937 r">block</span>
                    &amp;&amp; <span class="r937 r">block</span>.<a href="../parser/ast.cs.html#496f71fcd5c4e6a1" class="i property">Statements</a>.<span class="i">Count</span> &gt; 0
                    &amp;&amp; <span class="r937 r">block</span>.<a href="../parser/ast.cs.html#496f71fcd5c4e6a1" class="i property">Statements</a>[0] <b>is</b> <a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r938 rd" class="r938 r">statement</span>)
                {
                    <b>return</b> <span class="r938 r">statement</span>;
                }
 
                <span class="c">// Advanced function with help inside</span>
                <b>if</b> (<span class="r931 r">lastAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r939 rd" class="r939 r">advFuncDefAst</span>)
                {
                    <b>return</b> <span class="r939 r">advFuncDefAst</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="f442672bb53444da" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CompleteCommentParameterValue</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r940 rd" class="r940 r">context</span>, <b>string</b> <span id="r941 rd" class="r941 r">wordToComplete</span>)
        {
            <a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r942 rd" class="r942 r">foundFunction</span> = <a href="#7bdaea23556d3d11" class="i method">GetCommentHelpFunctionTarget</a>(<span class="r940 r">context</span>);
 
            <span class="i">ReadOnlyCollection</span>&lt;<a href="../parser/ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <span id="r943 rd" class="r943 r">foundParameters</span> = <b>null</b>;
            <b>if</b> (<span class="r942 r">foundFunction</span> <b>is not null</b>)
            {
                <span class="r943 r">foundParameters</span> = <span class="r942 r">foundFunction</span>.<a href="../parser/ast.cs.html#653a0e4bf79364c2" class="i property">Parameters</a> ?? <span class="r942 r">foundFunction</span>.<a href="../parser/ast.cs.html#201bce3cfc040274" class="i property">Body</a>.<a href="../parser/ast.cs.html#3fd8788db62344d2" class="i property">ParamBlock</a>?.<a href="../parser/ast.cs.html#ffac8f01ede94077" class="i property">Parameters</a>;
            }
            <b>else</b> <b>if</b> (<span class="r940 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>[^1] <b>is</b> <a href="../parser/ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r944 rd" class="r944 r">scriptAst</span>)
            {
                <span class="c">// The helpblock is for a script file</span>
                <span class="r943 r">foundParameters</span> = <span class="r944 r">scriptAst</span>.<a href="../parser/ast.cs.html#3fd8788db62344d2" class="i property">ParamBlock</a>?.<a href="../parser/ast.cs.html#ffac8f01ede94077" class="i property">Parameters</a>;
            }
 
            <b>if</b> (<span class="r943 r">foundParameters</span> <b>is null</b> || <span class="r943 r">foundParameters</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>var</b> <span id="r945 rd" class="r945 r">parametersToShow</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<a href="../parser/ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a> <span id="r946 rd" class="r946 r">parameter</span> <b>in</b> <span class="r943 r">foundParameters</span>)
            {
                <b>if</b> (<span class="r946 r">parameter</span>.<a href="../parser/ast.cs.html#ba2fe0223eb09f0d" class="i property">Name</a>.<a href="../parser/ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>.<span class="i">StartsWith</span>(<span class="r941 r">wordToComplete</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r945 r">parametersToShow</span>.<span class="i">Add</span>(<span class="r946 r">parameter</span>.<a href="../parser/ast.cs.html#ba2fe0223eb09f0d" class="i property">Name</a>.<a href="../parser/ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>);
                }
            }
 
            <span class="i">MatchCollection</span> <span id="r947 rd" class="r947 r">usedParameters</span> = <span class="i">Regex</span>.<span class="i">Matches</span>(<span class="r940 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <span class="s">@&quot;(?&lt;=^\s*\.parameter\s+)\w.*(?&lt;=\S)&quot;</span>, <span class="i">RegexOptions</span>.<span class="i">Multiline</span> | <span class="i">RegexOptions</span>.<span class="i">IgnoreCase</span>);
            <b>foreach</b> (<span class="i">Match</span> <span id="r948 rd" class="r948 r">parameter</span> <b>in</b> <span class="r947 r">usedParameters</span>)
            {
                <b>if</b> (<span class="r941 r">wordToComplete</span>.<span class="i">Equals</span>(<span class="r948 r">parameter</span>.<span class="i">Value</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>continue</b>;
                }
                <span class="r945 r">parametersToShow</span>.<span class="i">Remove</span>(<span class="r948 r">parameter</span>.<span class="i">Value</span>);
            }
 
            <b>var</b> <span id="r949 rd" class="r949 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
            <b>foreach</b> (<b>string</b> <span id="r950 rd" class="r950 r">parameter</span> <b>in</b> <span class="r945 r">parametersToShow</span>)
            {
                <span class="r949 r">result</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="r950 r">parameter</span>));
            }
 
            <b>return</b> <span class="r949 r">result</span>.<span class="i">Count</span> &gt; 0 ? <span class="r949 r">result</span> : <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Comments
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Members
 
        <span class="c">// List of extension methods &lt;MethodName, Signature&gt;</span>
        <b>private static readonly</b> <span class="i">List</span>&lt;<span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt;&gt; <a id="0ecb27d56aede831" href="../../R/0ecb27d56aede831.html" target="n" data-glyph="46,1" class="i field">s_extensionMethods</a> =
            <b>new</b> <span class="i">List</span>&lt;<span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt;&gt;
                {
                    <b>new</b> <span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="s">&quot;Where&quot;</span>, <span class="s">&quot;Where({ expression } [, mode [, numberToReturn]])&quot;</span>),
                    <b>new</b> <span class="i">Tuple</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="s">&quot;ForEach&quot;</span>, <span class="s">&quot;ForEach(expression [, arguments...])&quot;</span>)
                };
 
        <span class="c">// List of DSC collection-value variables</span>
        <b>private static readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="92efff4a709fa739" href="../../R/92efff4a709fa739.html" target="n" data-glyph="46,1" class="i field">s_dscCollectionVariables</a> =
            <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>) { <span class="s">&quot;SelectedNodes&quot;</span>, <span class="s">&quot;AllNodes&quot;</span> };
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="c5cd3c69e6ecde2e" href="../../R/c5cd3c69e6ecde2e.html" target="n" data-glyph="74,1" class="i method">CompleteMember</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r951 rd" class="r951 r">context</span>, <b>bool</b> <span id="r952 rd" class="r952 r">@static</span>)
        {
            <span class="c">// If we get here, we know that either:</span>
            <span class="c">//   * the cursor appeared immediately after a member access token (&#39;.&#39; or &#39;::&#39;).</span>
            <span class="c">//   * the parent of the ast on the cursor was a member expression.</span>
            <span class="c">//</span>
            <span class="c">// In the first case, we have 2 possibilities:</span>
            <span class="c">//   * the last ast is an error ast because no member name was entered and we were in expression context</span>
            <span class="c">//   * the last ast is a string constant, with something like:   echo $foo.</span>
 
            <b>var</b> <span id="r953 rd" class="r953 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
 
            <b>var</b> <span id="r954 rd" class="r954 r">lastAst</span> = <span class="r951 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>.<span class="i">Last</span>();
            <a href="../parser/ast.cs.html#a3e8bc64452a67d0" class="k">var</a> <span id="r955 rd" class="r955 r">lastAstAsMemberExpr</span> = <span class="r954 r">lastAst</span> <b>as</b> <a href="../parser/ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a>;
            <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r956 rd" class="r956 r">memberNameCandidateAst</span> = <b>null</b>;
            <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r957 rd" class="r957 r">targetExpr</span> = <b>null</b>;
            <b>if</b> (<span class="r955 r">lastAstAsMemberExpr</span> != <b>null</b>)
            {
                <span class="c">// If the cursor is not inside the member name in the member expression, assume</span>
                <span class="c">// that the user had incomplete input, but the parser got lucky and succeeded parsing anyway.</span>
                <b>if</b> (<span class="r951 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> &gt;= <span class="r955 r">lastAstAsMemberExpr</span>.<a href="../parser/ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>)
                {
                    <span class="r956 r">memberNameCandidateAst</span> = <span class="r955 r">lastAstAsMemberExpr</span>.<a href="../parser/ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a>;
                }
 
                <span class="r957 r">targetExpr</span> = <span class="r955 r">lastAstAsMemberExpr</span>.<a href="../parser/ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>;
            }
            <b>else</b>
            {
                <span class="r956 r">memberNameCandidateAst</span> = <span class="r954 r">lastAst</span>;
            }
 
            <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r958 rd" class="r958 r">memberNameAst</span> = <span class="r956 r">memberNameCandidateAst</span> <b>as</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
 
            <b>var</b> <span id="r959 rd" class="r959 r">memberName</span> = <span class="s">&quot;*&quot;</span>;
            <b>if</b> (<span class="r958 r">memberNameAst</span> != <b>null</b>)
            {
                <span class="c">// Make sure to correctly handle: echo $foo.</span>
                <b>if</b> (!<span class="r958 r">memberNameAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>.<span class="i">Equals</span>(<span class="s">&quot;.&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp; !<span class="r958 r">memberNameAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>.<span class="i">Equals</span>(<span class="s">&quot;::&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r959 r">memberName</span> = <span class="r958 r">memberNameAst</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a> + <span class="s">&quot;*&quot;</span>;
                }
            }
            <b>else</b> <b>if</b> (<span class="r954 r">lastAst</span> <b>is not</b> <a href="../parser/ast.cs.html#bdf2b3276843e0c2" class="t t">ErrorExpressionAst</a> &amp;&amp; <span class="r957 r">targetExpr</span> == <b>null</b>)
            {
                <span class="c">// I don&#39;t think we can complete anything interesting</span>
                <b>return</b> <span class="r953 r">results</span>;
            }
 
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="k">var</a> <span id="r960 rd" class="r960 r">commandAst</span> = <span class="r954 r">lastAst</span>.<span class="i">Parent</span> <b>as</b> <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>;
            <b>if</b> (<span class="r960 r">commandAst</span> != <b>null</b>)
            {
                <b>int</b> <span id="r961 rd" class="r961 r">i</span>;
                <b>for</b> (<span class="r961 r">i</span> = <span class="r960 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span> - 1; <span class="r961 r">i</span> &gt;= 0; --<span class="r961 r">i</span>)
                {
                    <b>if</b> (<span class="r960 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[<span class="r961 r">i</span>] == <span class="r954 r">lastAst</span>)
                    {
                        <b>break</b>;
                    }
                }
 
                <b>var</b> <span id="r962 rd" class="r962 r">nextToLastAst</span> = <span class="r960 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[<span class="r961 r">i</span> - 1];
                <b>var</b> <span id="r963 rd" class="r963 r">nextToLastExtent</span> = <span class="r962 r">nextToLastAst</span>.<span class="i">Extent</span>;
                <b>var</b> <span id="r964 rd" class="r964 r">lastExtent</span> = <span class="r954 r">lastAst</span>.<span class="i">Extent</span>;
                <b>if</b> (<span class="r963 r">nextToLastExtent</span>.<span class="i">EndLineNumber</span> == <span class="r964 r">lastExtent</span>.<span class="i">StartLineNumber</span> &amp;&amp;
                    <span class="r963 r">nextToLastExtent</span>.<span class="i">EndColumnNumber</span> == <span class="r964 r">lastExtent</span>.<span class="i">StartColumnNumber</span>)
                {
                    <span class="r957 r">targetExpr</span> = <span class="r962 r">nextToLastAst</span> <b>as</b> <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>;
                }
            }
            <b>else</b> <b>if</b> (<span class="r954 r">lastAst</span>.<span class="i">Parent</span> <b>is</b> <a href="../parser/ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a>)
            {
                <span class="c">// If &#39;targetExpr&#39; has already been set, we should skip this step. This is for some member completion</span>
                <span class="c">// cases in ISE. In ISE, we may add a new statement in the middle of existing statements as follows:</span>
                <span class="c">//     $xml = New-Object Xml</span>
                <span class="c">//     $xml.</span>
                <span class="c">//     $xml.Save(&quot;C:\data.xml&quot;)</span>
                <span class="c">// In this example, we add $xml. between two existing statements, and the &#39;lastAst&#39; in this case is</span>
                <span class="c">// a MemberExpressionAst &#39;$xml.$xml&#39;, whose parent is still a MemberExpressionAst &#39;$xml.$xml.Save&#39;.</span>
                <span class="c">// But here we DO NOT want to re-assign &#39;targetExpr&#39; to be &#39;$xml.$xml&#39;. &#39;targetExpr&#39; in this case</span>
                <span class="c">// should be &#39;$xml&#39;.</span>
                <b>if</b> (<span class="r957 r">targetExpr</span> == <b>null</b>)
                {
                    <a href="../parser/ast.cs.html#a3e8bc64452a67d0" class="k">var</a> <span id="r965 rd" class="r965 r">memberExprAst</span> = (<a href="../parser/ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a>)<span class="r954 r">lastAst</span>.<span class="i">Parent</span>;
                    <span class="r957 r">targetExpr</span> = <span class="r965 r">memberExprAst</span>.<a href="../parser/ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>;
                }
            }
            <b>else</b> <b>if</b> (<span class="r954 r">lastAst</span>.<span class="i">Parent</span> <b>is</b> <a href="../parser/ast.cs.html#f3e3848ef2eae593" class="t t">BinaryExpressionAst</a> &amp;&amp; <span class="r951 r">context</span>.<a href="CompletionAnalysis.cs.html#63bd97dbd0ed3b94" class="i property">TokenAtCursor</a>.<a href="../parser/token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<span class="i">Equals</span>(<a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#79806bba953290ee" class="i field">Multiply</a>))
            {
                <a href="../parser/ast.cs.html#a3e8bc64452a67d0" class="k">var</a> <span id="r966 rd" class="r966 r">memberExprAst</span> = ((<a href="../parser/ast.cs.html#f3e3848ef2eae593" class="t t">BinaryExpressionAst</a>)<span class="r954 r">lastAst</span>.<span class="i">Parent</span>).<a href="../parser/ast.cs.html#e19b481693ff50d7" class="i property">Left</a> <b>as</b> <a href="../parser/ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a>;
                <b>if</b> (<span class="r966 r">memberExprAst</span> != <b>null</b>)
                {
                    <span class="r957 r">targetExpr</span> = <span class="r966 r">memberExprAst</span>.<a href="../parser/ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>;
                    <b>if</b> (<span class="r966 r">memberExprAst</span>.<a href="../parser/ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a> <b>is</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)
                    {
                        <span class="r959 r">memberName</span> = ((<a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)<span class="r966 r">memberExprAst</span>.<a href="../parser/ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a>).<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a> + <span class="s">&quot;*&quot;</span>;
                    }
                }
            }
 
            <b>if</b> (<span class="r957 r">targetExpr</span> == <b>null</b>)
            {
                <span class="c">// Not sure what we have, but we&#39;re not looking for members.</span>
                <b>return</b> <span class="r953 r">results</span>;
            }
 
            <b>if</b> (<a href="#0b590d9a87f772b1" class="i method">IsSplattedVariable</a>(<span class="r957 r">targetExpr</span>))
            {
                <span class="c">// It&#39;s splatted variable, member expansion is not useful</span>
                <b>return</b> <span class="r953 r">results</span>;
            }
 
            <a href="#f848645913a53ddb" class="i method">CompleteMemberHelper</a>(<span class="r952 r">@static</span>, <span class="r959 r">memberName</span>, <span class="r957 r">targetExpr</span>, <span class="r951 r">context</span>, <span class="r953 r">results</span>);
 
            <b>if</b> (<span class="r953 r">results</span>.<span class="i">Count</span> == 0)
            {
                <a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>[] <span id="r967 rd" class="r967 r">inferredTypes</span> = <b>null</b>;
 
                <b>if</b> (<span class="r952 r">@static</span>)
                {
                    <a href="../parser/ast.cs.html#bf258955590d49b7" class="k">var</a> <span id="r968 rd" class="r968 r">typeExpr</span> = <span class="r957 r">targetExpr</span> <b>as</b> <a href="../parser/ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a>;
                    <b>if</b> (<span class="r968 r">typeExpr</span> != <b>null</b>)
                    {
                        <span class="r967 r">inferredTypes</span> = <b>new</b>[] { <b>new</b> <a href="../CommandInfo.cs.html#6d38682bb2f27b26" class="t constructor">PSTypeName</a>(<span class="r968 r">typeExpr</span>.<a href="../parser/ast.cs.html#c43447ab6269441a" class="i property">TypeName</a>) };
                    }
                }
                <b>else</b>
                {
                    <span class="r967 r">inferredTypes</span> = <a href="../parser/TypeInferenceVisitor.cs.html#85308821e258515b" class="t t">AstTypeInference</a>.<a href="../parser/TypeInferenceVisitor.cs.html#a161c4fce43bc728" class="i method">InferTypeOf</a>(<span class="r957 r">targetExpr</span>, <span class="r951 r">context</span>.<a href="CompletionAnalysis.cs.html#95d0769179a8633b" class="i property">TypeInferenceContext</a>, <a href="../parser/TypeInferenceVisitor.cs.html#c79f5fa1494e528d" class="t t">TypeInferenceRuntimePermissions</a>.<a href="../parser/TypeInferenceVisitor.cs.html#8df46f8adea8c4e2" class="i field">AllowSafeEval</a>).<span class="i">ToArray</span>();
                }
 
                <b>if</b> (<span class="r967 r">inferredTypes</span> != <b>null</b> &amp;&amp; <span class="r967 r">inferredTypes</span>.<span class="i">Length</span> &gt; 0)
                {
                    <span class="c">// Use inferred types if we have any</span>
                    <span class="i">CompleteMemberByInferredType</span>(<span class="r951 r">context</span>.<a href="CompletionAnalysis.cs.html#95d0769179a8633b" class="i property">TypeInferenceContext</a>, <span class="r967 r">inferredTypes</span>, <span class="r953 r">results</span>, <span class="r959 r">memberName</span>, <span class="i">filter</span>: <b>null</b>, <span class="i">isStatic</span>: <span class="r952 r">@static</span>);
                }
                <b>else</b>
                {
                    <span class="c">// Handle special DSC collection variables to complete the extension methods &#39;Where&#39; and &#39;ForEach&#39;</span>
                    <span class="c">// e.g. Configuration foo { node $AllNodes.&lt;tab&gt; --&gt; $AllNodes.Where(</span>
                    <a href="../parser/ast.cs.html#248562b22b336dec" class="k">var</a> <span id="r969 rd" class="r969 r">variableAst</span> = <span class="r957 r">targetExpr</span> <b>as</b> <a href="../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>;
                    <a href="../parser/ast.cs.html#a3e8bc64452a67d0" class="k">var</a> <span id="r970 rd" class="r970 r">memberExprAst</span> = <span class="r957 r">targetExpr</span> <b>as</b> <a href="../parser/ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a>;
                    <b>bool</b> <span id="r971 rd" class="r971 r">shouldAddExtensionMethods</span> = <b>false</b>;
 
                    <span class="c">// We complete against extension methods &#39;Where&#39; and &#39;ForEach&#39; for the following DSC variables</span>
                    <span class="c">// $SelectedNodes, $AllNodes, $ConfigurationData.AllNodes</span>
                    <b>if</b> (<span class="r969 r">variableAst</span> != <b>null</b>)
                    {
                        <span class="c">// Handle $SelectedNodes and $AllNodes</span>
                        <a href="../VariablePath.cs.html#41e5b41974741cc5" class="k">var</a> <span id="r972 rd" class="r972 r">variablePath</span> = <span class="r969 r">variableAst</span>.<a href="../parser/ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>;
                        <b>if</b> (<span class="r972 r">variablePath</span>.<a href="../VariablePath.cs.html#6af6d06d3e3c5d67" class="i property">IsVariable</a> &amp;&amp; <a href="#92efff4a709fa739" class="i field">s_dscCollectionVariables</a>.<span class="i">Contains</span>(<span class="r972 r">variablePath</span>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>) &amp;&amp; <a href="#3cbd5052524b9513" class="i method">IsInDscContext</a>(<span class="r969 r">variableAst</span>))
                        {
                            <span class="r971 r">shouldAddExtensionMethods</span> = <b>true</b>;
                        }
                    }
                    <b>else</b> <b>if</b> (<span class="r970 r">memberExprAst</span> != <b>null</b>)
                    {
                        <span class="c">// Handle $ConfigurationData.AllNodes</span>
                        <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r973 rd" class="r973 r">member</span> = <span class="r970 r">memberExprAst</span>.<a href="../parser/ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a> <b>as</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                        <b>if</b> (<a href="#017daacc7553be9d" class="i method">IsConfigurationDataVariable</a>(<span class="r970 r">memberExprAst</span>.<a href="../parser/ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>) &amp;&amp; <span class="r973 r">member</span> != <b>null</b> &amp;&amp;
                            <b>string</b>.<span class="i">Equals</span>(<span class="s">&quot;AllNodes&quot;</span>, <span class="r973 r">member</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                            <a href="#3cbd5052524b9513" class="i method">IsInDscContext</a>(<span class="r970 r">memberExprAst</span>))
                        {
                            <span class="r971 r">shouldAddExtensionMethods</span> = <b>true</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r971 r">shouldAddExtensionMethods</span>)
                    {
                        <a href="#7badfeeea424353c" class="i method">CompleteExtensionMethods</a>(<span class="r959 r">memberName</span>, <span class="r953 r">results</span>);
                    }
                }
 
                <b>if</b> (<span class="r953 r">results</span>.<span class="i">Count</span> == 0)
                {
                    <span class="c">// Handle &#39;$ConfigurationData&#39; specially to complete &#39;AllNodes&#39; for it</span>
                    <b>if</b> (<a href="#017daacc7553be9d" class="i method">IsConfigurationDataVariable</a>(<span class="r957 r">targetExpr</span>) &amp;&amp; <a href="#3cbd5052524b9513" class="i method">IsInDscContext</a>(<span class="r957 r">targetExpr</span>))
                    {
                        <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r974 rd" class="r974 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r959 r">memberName</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                        <b>if</b> (<span class="r974 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="s">&quot;AllNodes&quot;</span>))
                        {
                            <span class="r953 r">results</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="s">&quot;AllNodes&quot;</span>, <span class="s">&quot;AllNodes&quot;</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#bad7fb67c06b9e4e" class="i field">Property</a>, <span class="s">&quot;AllNodes&quot;</span>));
                        }
                    }
                }
            }
 
            <b>return</b> <span class="r953 r">results</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Complete members against extension methods &#39;Where&#39; and &#39;ForEach&#39;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="7badfeeea424353c" href="../../R/7badfeeea424353c.html" target="n" data-glyph="76,1" class="i method">CompleteExtensionMethods</a>(<b>string</b> <span id="r975 rd" class="r975 r">memberName</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r976 rd" class="r976 r">results</span>)
        {
            <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r977 rd" class="r977 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r975 r">memberName</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <a href="#72e5c684486b7af1" class="i method">CompleteExtensionMethods</a>(<span class="r977 r">pattern</span>, <span class="r976 r">results</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Complete members against extension methods &#39;Where&#39; and &#39;ForEach&#39; based on the given pattern.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="72e5c684486b7af1" href="../../R/72e5c684486b7af1.html" target="n" data-glyph="76,1" class="i method">CompleteExtensionMethods</a>(<a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r978 rd" class="r978 r">pattern</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r979 rd" class="r979 r">results</span>)
        {
            <span class="r979 r">results</span>.<span class="i">AddRange</span>(<b>from</b> <span class="i">member</span> <b>in</b> <a href="#0ecb27d56aede831" class="i field">s_extensionMethods</a>
                             <b>where</b> <span class="r978 r">pattern</span>.<span class="i">IsMatch</span>(<span class="i">member</span>.<span class="i">Item1</span>)
                             <b>select</b>
                                 <b>new</b> <span class="t">CompletionResult</span>(<span class="i">member</span>.<span class="i">Item1</span> + <span class="s">&quot;(&quot;</span>, <span class="i">member</span>.<span class="i">Item1</span>,
                                                      <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#389017ea02ead55a" class="i field">Method</a>, <span class="i">member</span>.<span class="i">Item2</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verify if an expression Ast is representing the $ConfigurationData variable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="017daacc7553be9d" href="../../R/017daacc7553be9d.html" target="n" data-glyph="76,1" class="i method">IsConfigurationDataVariable</a>(<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r980 rd" class="r980 r">targetExpr</span>)
        {
            <a href="../parser/ast.cs.html#248562b22b336dec" class="k">var</a> <span id="r981 rd" class="r981 r">variableExpr</span> = <span class="r980 r">targetExpr</span> <b>as</b> <a href="../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>;
            <b>if</b> (<span class="r981 r">variableExpr</span> != <b>null</b>)
            {
                <a href="../VariablePath.cs.html#41e5b41974741cc5" class="k">var</a> <span id="r982 rd" class="r982 r">varPath</span> = <span class="r981 r">variableExpr</span>.<a href="../parser/ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>;
                <b>if</b> (<span class="r982 r">varPath</span>.<a href="../VariablePath.cs.html#6af6d06d3e3c5d67" class="i property">IsVariable</a> &amp;&amp;
                    <span class="r982 r">varPath</span>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>.<span class="i">Equals</span>(<span class="s">&quot;ConfigurationData&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Verify if an expression Ast is within a configuration definition.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="3cbd5052524b9513" href="../../R/3cbd5052524b9513.html" target="n" data-glyph="76,1" class="i method">IsInDscContext</a>(<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r983 rd" class="r983 r">expression</span>)
        {
            <b>return</b> <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a>.<a href="../parser/ast.cs.html#4ec2535310b60c23" class="i method">GetAncestorAst</a>&lt;<a href="../parser/ast.cs.html#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a>&gt;(<span class="r983 r">expression</span>) != <b>null</b>;
        }
 
        <b>private static void</b> <a id="fde322ecd5cf5546" href="../../R/fde322ecd5cf5546.html" target="n" data-glyph="76,1" class="i method">CompleteFormatViewByInferredType</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r984 rd" class="r984 r">context</span>, <b>string</b>[] <span id="r985 rd" class="r985 r">inferredTypeNames</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r986 rd" class="r986 r">results</span>, <b>string</b> <span id="r987 rd" class="r987 r">commandName</span>)
        {
            <a href="../../P/e64c182db20ea05c.html#e64c182db20ea05c" class="k">var</a> <span id="r988 rd" class="r988 r">typeInfoDB</span> = <span class="r984 r">context</span>.<a href="CompletionAnalysis.cs.html#95d0769179a8633b" class="i property">TypeInferenceContext</a>.<a href="../parser/TypeInferenceVisitor.cs.html#30f31c72b9cad077" class="i property">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#40afda0efcb0cad4" class="i property">FormatDBManager</a>.<a href="../../FormatAndOutput/common/DisplayDatabase/typeDataManager.cs.html#b98bbbe500c5a257" class="i method">GetTypeInfoDataBase</a>();
 
            <b>if</b> (<span class="r988 r">typeInfoDB</span> <b>is null</b>)
            {
                <b>return</b>;
            }
 
            <span class="i">Type</span> <span id="r989 rd" class="r989 r">controlBodyType</span> = <span class="r987 r">commandName</span> <b>switch</b>
            {
                <span class="s">&quot;Format-Table&quot;</span> =&gt; <b>typeof</b>(<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Table.cs.html#ccad4737e6e7dc9d" class="t t">TableControlBody</a>),
                <span class="s">&quot;Format-List&quot;</span> =&gt; <b>typeof</b>(<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_List.cs.html#3771338ebddfda56" class="t t">ListControlBody</a>),
                <span class="s">&quot;Format-Wide&quot;</span> =&gt; <b>typeof</b>(<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Wide.cs.html#6fd8600eba3bbaa2" class="t t">WideControlBody</a>),
                <span class="s">&quot;Format-Custom&quot;</span> =&gt; <b>typeof</b>(<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData_Complex.cs.html#7a2c532347a3934e" class="t t">ComplexControlBody</a>),
                <b>_</b> =&gt; <b>null</b>
            };
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r989 r">controlBodyType</span> <b>is not null</b>, <span class="s">&quot;This should never happen unless a new Format-* cmdlet is added&quot;</span>);
 
            <b>var</b> <span id="r990 rd" class="r990 r">wordToComplete</span> = <span class="r984 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>;
            <b>var</b> <span id="r991 rd" class="r991 r">quote</span> = <a href="#944eddaabbba5d42" class="i method">HandleDoubleAndSingleQuote</a>(<b>ref</b> <span class="r990 r">wordToComplete</span>);
            <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r992 rd" class="r992 r">viewPattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r990 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
            <b>var</b> <span id="r993 rd" class="r993 r">uniqueNames</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;();
            <b>foreach</b> (<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#a2841e9b0027167f" class="t t">ViewDefinition</a> <span id="r994 rd" class="r994 r">viewDefinition</span> <b>in</b> <span class="r988 r">typeInfoDB</span>.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#63e926f26a6da5a5" class="i field">viewDefinitionsSection</a>.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#bf04e3771cfbee35" class="i field">viewDefinitionList</a>)
            {
                <b>if</b> (<span class="r994 r">viewDefinition</span>?.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#32d268bba2ea075f" class="i field">appliesTo</a> <b>is not null</b> &amp;&amp; <span class="r989 r">controlBodyType</span> == <span class="r994 r">viewDefinition</span>.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#7ecc51405216112c" class="i field">mainControl</a>.<span class="i">GetType</span>())
                {
                    <b>foreach</b> (<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#c83e340e0e2a174f" class="t t">TypeOrGroupReference</a> <span id="r995 rd" class="r995 r">applyTo</span> <b>in</b> <span class="r994 r">viewDefinition</span>.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#32d268bba2ea075f" class="i field">appliesTo</a>.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#e562e7ea6df51ae6" class="i field">referenceList</a>)
                    {
                        <b>foreach</b> (<b>string</b> <span id="r996 rd" class="r996 r">inferredTypeName</span> <b>in</b> <span class="r985 r">inferredTypeNames</span>)
                        {
                            <span class="c">// We use &#39;StartsWith()&#39; because &#39;applyTo.Name&#39; can look like &quot;System.Diagnostics.Process#IncludeUserName&quot;.</span>
                            <b>if</b> (<span class="r995 r">applyTo</span>.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#df908891090d2c93" class="i field">name</a>.<span class="i">StartsWith</span>(<span class="r996 r">inferredTypeName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                                &amp;&amp; <span class="r993 r">uniqueNames</span>.<span class="i">Add</span>(<span class="r994 r">viewDefinition</span>.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#fe2f859d4c82481b" class="i field">name</a>)
                                &amp;&amp; <span class="r992 r">viewPattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r994 r">viewDefinition</span>.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#fe2f859d4c82481b" class="i field">name</a>))
                            {
                                <b>string</b> <span id="r997 rd" class="r997 r">completionText</span> = <span class="r994 r">viewDefinition</span>.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#fe2f859d4c82481b" class="i field">name</a>;
                                <span class="c">// If the string is quoted or if it contains characters that need quoting, quote it in single quotes</span>
                                <b>if</b> (<span class="r991 r">quote</span> != <b>string</b>.<span class="i">Empty</span> || <span class="r994 r">viewDefinition</span>.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#fe2f859d4c82481b" class="i field">name</a>.<span class="i">IndexOfAny</span>(<a href="#c30c08aec33a7836" class="i field">s_charactersRequiringQuotes</a>) != -1)
                                {
                                    <span class="r997 r">completionText</span> = <span class="s">&quot;&#39;&quot;</span> + <span class="r997 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>) + <span class="s">&quot;&#39;&quot;</span>;
                                }
 
                                <span class="r986 r">results</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r997 r">completionText</span>, <span class="r994 r">viewDefinition</span>.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#fe2f859d4c82481b" class="i field">name</a>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#c2d33fde95710648" class="i field">Text</a>, <span class="r994 r">viewDefinition</span>.<a href="../../FormatAndOutput/common/DisplayDatabase/displayDescriptionData.cs.html#fe2f859d4c82481b" class="i field">name</a>));
                            }
                        }
                    }
                }
            }
        }
 
        <b>internal static void</b> <a id="4a555604aaff1923" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CompleteMemberByInferredType</a>(<a href="../parser/TypeInferenceVisitor.cs.html#475e6219e3f308ae" class="t t">TypeInferenceContext</a> <span id="r998 rd" class="r998 r">context</span>, <span class="i">IEnumerable</span>&lt;<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt; <span id="r999 rd" class="r999 r">inferredTypes</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r1000 rd" class="r1000 r">results</span>, <b>string</b> <span id="r1001 rd" class="r1001 r">memberName</span>, <span class="i">Func</span>&lt;<b>object</b>, <b>bool</b>&gt; <span id="r1002 rd" class="r1002 r">filter</span>, <b>bool</b> <span id="r1003 rd" class="r1003 r">isStatic</span>)
        {
            <b>bool</b> <span id="r1004 rd" class="r1004 r">extensionMethodsAdded</span> = <b>false</b>;
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r1005 rd" class="r1005 r">typeNameUsed</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r1006 rd" class="r1006 r">memberNamePattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r1001 r">memberName</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
            <b>foreach</b> (<b>var</b> <span id="r1007 rd" class="r1007 r">psTypeName</span> <b>in</b> <span class="r999 r">inferredTypes</span>)
            {
                <b>if</b> (<span class="r1005 r">typeNameUsed</span>.<span class="i">Contains</span>(<span class="r1007 r">psTypeName</span>.<span class="i">Name</span>))
                {
                    <b>continue</b>;
                }
 
                <span class="r1005 r">typeNameUsed</span>.<span class="i">Add</span>(<span class="r1007 r">psTypeName</span>.<span class="i">Name</span>);
                <b>var</b> <span id="r1008 rd" class="r1008 r">members</span> = <span class="r998 r">context</span>.<span class="i">GetMembersByInferredType</span>(<span class="r1007 r">psTypeName</span>, <span class="r1003 r">isStatic</span>, <span class="r1002 r">filter</span>);
                <b>foreach</b> (<b>var</b> <span id="r1009 rd" class="r1009 r">member</span> <b>in</b> <span class="r1008 r">members</span>)
                {
                    <span class="i">AddInferredMember</span>(<span class="r1009 r">member</span>, <span class="r1006 r">memberNamePattern</span>, <span class="r1000 r">results</span>);
                }
 
                <span class="c">// Check if we need to complete against the extension methods &#39;Where&#39; and &#39;ForEach&#39;</span>
                <b>if</b> (!<span class="r1004 r">extensionMethodsAdded</span> &amp;&amp; <span class="r1007 r">psTypeName</span>.<span class="i">Type</span> != <b>null</b> &amp;&amp; <span class="i">IsStaticTypeEnumerable</span>(<span class="r1007 r">psTypeName</span>.<span class="i">Type</span>))
                {
                    <span class="c">// Complete extension methods &#39;Where&#39; and &#39;ForEach&#39; for Enumerable types</span>
                    <span class="r1004 r">extensionMethodsAdded</span> = <b>true</b>;
                    <a href="#72e5c684486b7af1" class="i method">CompleteExtensionMethods</a>(<span class="r1006 r">memberNamePattern</span>, <span class="r1000 r">results</span>);
                }
            }
 
            <b>if</b> (<span class="r1000 r">results</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// Sort the results</span>
                <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r1010 rd" class="r1010 r">powerShellExecutionHelper</span> = <span class="r998 r">context</span>.<a href="../parser/TypeInferenceVisitor.cs.html#17fe250986da5799" class="i property">Helper</a>;
                <span class="r1010 r">powerShellExecutionHelper</span>
                    .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Utility\\Sort-Object&quot;</span>)
                    .<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Property&quot;</span>, <b>new</b>[] { <span class="s">&quot;ResultType&quot;</span>, <span class="s">&quot;ListItemText&quot;</span> })
                    .<a href="../hostifaces/PowerShell.cs.html#ad181c9dec5e4ffa" class="i method">AddParameter</a>(<span class="s">&quot;Unique&quot;</span>);
                <span class="i">Exception</span> <span id="r1011 rd" class="r1011 r">unused</span>;
                <b>var</b> <span id="r1012 rd" class="r1012 r">sortedResults</span> = <span class="r1010 r">powerShellExecutionHelper</span>.<span class="i">ExecuteCurrentPowerShell</span>(<b>out</b> <span class="r1011 r">unused</span>, <span class="r1000 r">results</span>);
                <span class="r1000 r">results</span>.<span class="i">Clear</span>();
                <span class="r1000 r">results</span>.<span class="i">AddRange</span>(<span class="r1012 r">sortedResults</span>.<span class="i">Select</span>(<b>static</b> <span id="r1013 rd" class="r1013 r">psobj</span> =&gt; <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">Base</span>(<span class="r1013 r">psobj</span>) <b>as</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>));
            }
        }
 
        <b>private static void</b> <a id="65def8fec3b1cf6d" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">AddInferredMember</a>(<b>object</b> <span id="r1014 rd" class="r1014 r">member</span>, <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a> <span id="r1015 rd" class="r1015 r">memberNamePattern</span>, <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r1016 rd" class="r1016 r">results</span>)
        {
            <b>string</b> <span id="r1017 rd" class="r1017 r">memberName</span> = <b>null</b>;
            <b>bool</b> <span id="r1018 rd" class="r1018 r">isMethod</span> = <b>false</b>;
            <span class="i">Func</span>&lt;<b>string</b>&gt; <span id="r1019 rd" class="r1019 r">getToolTip</span> = <b>null</b>;
            <b>var</b> <span id="r1020 rd" class="r1020 r">propertyInfo</span> = <span class="r1014 r">member</span> <b>as</b> <span class="i">PropertyInfo</span>;
            <b>if</b> (<span class="r1020 r">propertyInfo</span> != <b>null</b>)
            {
                <span class="r1017 r">memberName</span> = <span class="r1020 r">propertyInfo</span>.<span class="i">Name</span>;
                <span class="r1019 r">getToolTip</span> = () =&gt; <a href="../../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r1020 r">propertyInfo</span>.<span class="i">PropertyType</span>) + <span class="s">&quot; &quot;</span> + <span class="r1017 r">memberName</span>
                    + <span class="s">&quot; { &quot;</span> + (<span class="r1020 r">propertyInfo</span>.<span class="i">GetGetMethod</span>() != <b>null</b> ? <span class="s">&quot;get; &quot;</span> : <b>string</b>.<span class="i">Empty</span>)
                    + (<span class="r1020 r">propertyInfo</span>.<span class="i">GetSetMethod</span>() != <b>null</b> ? <span class="s">&quot;set; &quot;</span> : <b>string</b>.<span class="i">Empty</span>) + <span class="s">&quot;}&quot;</span>;
            }
 
            <b>var</b> <span id="r1021 rd" class="r1021 r">fieldInfo</span> = <span class="r1014 r">member</span> <b>as</b> <span class="i">FieldInfo</span>;
            <b>if</b> (<span class="r1021 r">fieldInfo</span> != <b>null</b>)
            {
                <span class="r1017 r">memberName</span> = <span class="r1021 r">fieldInfo</span>.<span class="i">Name</span>;
                <span class="r1019 r">getToolTip</span> = () =&gt; <a href="../../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r1021 r">fieldInfo</span>.<span class="i">FieldType</span>) + <span class="s">&quot; &quot;</span> + <span class="r1017 r">memberName</span>;
            }
 
            <a href="../CoreAdapter.cs.html#6dfefa2e34e759ac" class="k">var</a> <span id="r1022 rd" class="r1022 r">methodCacheEntry</span> = <span class="r1014 r">member</span> <b>as</b> <a href="../CoreAdapter.cs.html#27353615475f6dbc" class="t t">DotNetAdapter</a>.<a href="../CoreAdapter.cs.html#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a>;
            <b>if</b> (<span class="r1022 r">methodCacheEntry</span> != <b>null</b>)
            {
                <span class="r1017 r">memberName</span> = <span class="r1022 r">methodCacheEntry</span>[0].<a href="../CoreAdapter.cs.html#3a0e575988f5a5de" class="i field">method</a>.<span class="i">Name</span>;
                <span class="r1018 r">isMethod</span> = <b>true</b>;
                <span class="r1019 r">getToolTip</span> = () =&gt; <b>string</b>.<span class="i">Join</span>(<span class="s">&quot;\n&quot;</span>, <span class="r1022 r">methodCacheEntry</span>.<a href="../CoreAdapter.cs.html#faf234dfe054f8ec" class="i field">methodInformationStructures</a>.<span class="i">Select</span>(<b>static</b> <span id="r1023 rd" class="r1023 r">m</span> =&gt; <span class="r1023 r">m</span>.<span class="i">methodDefinition</span>));
            }
 
            <a href="../MshMemberInfo.cs.html#fbee845d6706f8da" class="k">var</a> <span id="r1024 rd" class="r1024 r">psMemberInfo</span> = <span class="r1014 r">member</span> <b>as</b> <a href="../MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>;
            <b>if</b> (<span class="r1024 r">psMemberInfo</span> != <b>null</b>)
            {
                <span class="r1017 r">memberName</span> = <span class="r1024 r">psMemberInfo</span>.<a href="../MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>;
                <span class="r1018 r">isMethod</span> = <span class="r1014 r">member</span> <b>is</b> <a href="../MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>;
                <span class="r1019 r">getToolTip</span> = <span class="r1024 r">psMemberInfo</span>.<span class="i">ToString</span>;
            }
 
            <b>var</b> <span id="r1025 rd" class="r1025 r">cimProperty</span> = <span class="r1014 r">member</span> <b>as</b> <span class="i">CimPropertyDeclaration</span>;
            <b>if</b> (<span class="r1025 r">cimProperty</span> != <b>null</b>)
            {
                <span class="r1017 r">memberName</span> = <span class="r1025 r">cimProperty</span>.<span class="i">Name</span>;
                <span class="r1018 r">isMethod</span> = <b>false</b>;
                <span class="r1019 r">getToolTip</span> = () =&gt; <a href="#c6fc184171c34aa8" class="i method">GetCimPropertyToString</a>(<span class="r1025 r">cimProperty</span>);
            }
 
            <a href="../parser/ast.cs.html#6092492a0585632c" class="k">var</a> <span id="r1026 rd" class="r1026 r">memberAst</span> = <span class="r1014 r">member</span> <b>as</b> <a href="../parser/ast.cs.html#6092492a0585632c" class="t t">MemberAst</a>;
            <b>if</b> (<span class="r1026 r">memberAst</span> != <b>null</b>)
            {
                <span class="r1017 r">memberName</span> = <span class="r1026 r">memberAst</span> <b>is</b> <a href="../parser/ast.cs.html#542e4087fd3a0dac" class="t t">CompilerGeneratedMemberFunctionAst</a> ? <span class="s">&quot;new&quot;</span> : <span class="r1026 r">memberAst</span>.<a href="../parser/ast.cs.html#ddafb4df65953092" class="i property">Name</a>;
                <span class="r1018 r">isMethod</span> = <span class="r1026 r">memberAst</span> <b>is</b> <a href="../parser/ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a> || <span class="r1026 r">memberAst</span> <b>is</b> <a href="../parser/ast.cs.html#542e4087fd3a0dac" class="t t">CompilerGeneratedMemberFunctionAst</a>;
                <span class="r1019 r">getToolTip</span> = <span class="r1026 r">memberAst</span>.<span class="i">GetTooltip</span>;
            }
 
            <b>if</b> (<span class="r1017 r">memberName</span> == <b>null</b> || !<span class="r1015 r">memberNamePattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r1017 r">memberName</span>))
            {
                <b>return</b>;
            }
 
            <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="k">var</a> <span id="r1027 rd" class="r1027 r">completionResultType</span> = <span class="r1018 r">isMethod</span> ? <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#389017ea02ead55a" class="i field">Method</a> : <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#bad7fb67c06b9e4e" class="i field">Property</a>;
            <b>var</b> <span id="r1028 rd" class="r1028 r">completionText</span> = <span class="r1018 r">isMethod</span> ? <span class="r1017 r">memberName</span> + <span class="s">&quot;(&quot;</span> : <span class="r1017 r">memberName</span>;
 
            <span class="r1016 r">results</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(<span class="r1028 r">completionText</span>, <span class="r1017 r">memberName</span>, <span class="r1027 r">completionResultType</span>, <span class="r1019 r">getToolTip</span>()));
        }
 
        <b>private static string</b> <a id="c6fc184171c34aa8" href="../../R/c6fc184171c34aa8.html" target="n" data-glyph="76,1" class="i method">GetCimPropertyToString</a>(<span class="i">CimPropertyDeclaration</span> <span id="r1029 rd" class="r1029 r">cimProperty</span>)
        {
            <b>string</b> <span id="r1030 rd" class="r1030 r">type</span>;
            <b>switch</b> (<span class="r1029 r">cimProperty</span>.<span class="i">CimType</span>)
            {
                <b>case</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">CimType</span>.<span class="i">DateTime</span>:
                <b>case</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">CimType</span>.<span class="i">Instance</span>:
                <b>case</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">CimType</span>.<span class="i">Reference</span>:
                <b>case</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">CimType</span>.<span class="i">DateTimeArray</span>:
                <b>case</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">CimType</span>.<span class="i">InstanceArray</span>:
                <b>case</b> <span class="i n">Microsoft</span>.<span class="i">Management</span>.<span class="i">Infrastructure</span>.<span class="i">CimType</span>.<span class="i">ReferenceArray</span>:
                    <span class="r1030 r">type</span> = <span class="s">&quot;CimInstance#&quot;</span> + <span class="r1029 r">cimProperty</span>.<span class="i">CimType</span>.<span class="i">ToString</span>();
                    <b>break</b>;
 
                <b>default</b>:
                    <span class="r1030 r">type</span> = <a href="../../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="i">CimConverter</span>.<span class="i">GetDotNetType</span>(<span class="r1029 r">cimProperty</span>.<span class="i">CimType</span>));
                    <b>break</b>;
            }
 
            <b>bool</b> <span id="r1031 rd" class="r1031 r">isReadOnly</span> = ((<span class="r1029 r">cimProperty</span>.<span class="i">Flags</span> &amp; <span class="i">CimFlags</span>.<span class="i">ReadOnly</span>) == <span class="i">CimFlags</span>.<span class="i">ReadOnly</span>);
            <b>return</b> <span class="r1030 r">type</span> + <span class="s">&quot; &quot;</span> + <span class="r1029 r">cimProperty</span>.<span class="i">Name</span> + <span class="s">&quot; { get; &quot;</span> + (<span class="r1031 r">isReadOnly</span> ? <span class="s">&quot;}&quot;</span> : <span class="s">&quot;set; }&quot;</span>);
        }
 
        <b>private static bool</b> <a id="c5cbdeab184a585c" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">IsWriteablePropertyMember</a>(<b>object</b> <span id="r1032 rd" class="r1032 r">member</span>)
        {
            <b>var</b> <span id="r1033 rd" class="r1033 r">propertyInfo</span> = <span class="r1032 r">member</span> <b>as</b> <span class="i">PropertyInfo</span>;
            <b>if</b> (<span class="r1033 r">propertyInfo</span> != <b>null</b>)
            {
                <b>return</b> <span class="r1033 r">propertyInfo</span>.<span class="i">CanWrite</span>;
            }
 
            <a href="../MshMemberInfo.cs.html#13ab3796654e613c" class="k">var</a> <span id="r1034 rd" class="r1034 r">psPropertyInfo</span> = <span class="r1032 r">member</span> <b>as</b> <a href="../MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>;
            <b>if</b> (<span class="r1034 r">psPropertyInfo</span> != <b>null</b>)
            {
                <b>return</b> <span class="r1034 r">psPropertyInfo</span>.<a href="../MshMemberInfo.cs.html#794d03c9459171a6" class="i property">IsSettable</a>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>internal static bool</b> <a id="10d97f1aee498350" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">IsPropertyMember</a>(<b>object</b> <span id="r1035 rd" class="r1035 r">member</span>)
        {
            <b>return</b> <span class="r1035 r">member</span> <b>is</b> <span class="i">PropertyInfo</span>
                   || <span class="r1035 r">member</span> <b>is</b> <span class="i">FieldInfo</span>
                   || <span class="r1035 r">member</span> <b>is</b> <a href="../MshMemberInfo.cs.html#13ab3796654e613c" class="t t">PSPropertyInfo</a>
                   || <span class="r1035 r">member</span> <b>is</b> <span class="i">CimPropertyDeclaration</span>
                   || <span class="r1035 r">member</span> <b>is</b> <a href="../parser/ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a>;
        }
 
        <b>private static bool</b> <a id="6485d549291b7e35" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">IsMemberHidden</a>(<b>object</b> <span id="r1036 rd" class="r1036 r">member</span>)
        {
            <a href="../MshMemberInfo.cs.html#fbee845d6706f8da" class="k">var</a> <span id="r1037 rd" class="r1037 r">psMemberInfo</span> = <span class="r1036 r">member</span> <b>as</b> <a href="../MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>;
            <b>if</b> (<span class="r1037 r">psMemberInfo</span> != <b>null</b>)
                <b>return</b> <span class="r1037 r">psMemberInfo</span>.<a href="../MshMemberInfo.cs.html#ddc58fcb9ef869dd" class="i property">IsHidden</a>;
 
            <b>var</b> <span id="r1038 rd" class="r1038 r">memberInfo</span> = <span class="r1036 r">member</span> <b>as</b> <span class="i">MemberInfo</span>;
            <b>if</b> (<span class="r1038 r">memberInfo</span> != <b>null</b>)
                <b>return</b> <span class="r1038 r">memberInfo</span>.<span class="i">GetCustomAttributes</span>(<b>typeof</b>(<a href="../Attributes.cs.html#95fc557737f7107e" class="t t">HiddenAttribute</a>), <b>false</b>).<span class="i">Length</span> &gt; 0;
 
            <a href="../parser/ast.cs.html#88ad8abafd061e97" class="k">var</a> <span id="r1039 rd" class="r1039 r">propertyMemberAst</span> = <span class="r1036 r">member</span> <b>as</b> <a href="../parser/ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a>;
            <b>if</b> (<span class="r1039 r">propertyMemberAst</span> != <b>null</b>)
                <b>return</b> <span class="r1039 r">propertyMemberAst</span>.<a href="../parser/ast.cs.html#19f0ac305787111e" class="i property">IsHidden</a>;
 
            <a href="../parser/ast.cs.html#0c4f2db9a681a977" class="k">var</a> <span id="r1040 rd" class="r1040 r">functionMemberAst</span> = <span class="r1036 r">member</span> <b>as</b> <a href="../parser/ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>;
            <b>if</b> (<span class="r1040 r">functionMemberAst</span> != <b>null</b>)
                <b>return</b> <span class="r1040 r">functionMemberAst</span>.<a href="../parser/ast.cs.html#eb78b3c043381ff5" class="i property">IsHidden</a>;
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private static bool</b> <a id="4156e5c75ab7b673" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">IsConstructor</a>(<b>object</b> <span id="r1041 rd" class="r1041 r">member</span>)
        {
            <a href="../MshMemberInfo.cs.html#678ebc1a7c5bc189" class="k">var</a> <span id="r1042 rd" class="r1042 r">psMethod</span> = <span class="r1041 r">member</span> <b>as</b> <a href="../MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>;
            <b>if</b> (<span class="r1042 r">psMethod</span> != <b>null</b>)
            {
                <a href="../CoreAdapter.cs.html#6dfefa2e34e759ac" class="k">var</a> <span id="r1043 rd" class="r1043 r">methodCacheEntry</span> = <span class="r1042 r">psMethod</span>.<a href="../MshMemberInfo.cs.html#90d6e570e2f5700c" class="i field">adapterData</a> <b>as</b> <a href="../CoreAdapter.cs.html#27353615475f6dbc" class="t t">DotNetAdapter</a>.<a href="../CoreAdapter.cs.html#6dfefa2e34e759ac" class="t t">MethodCacheEntry</a>;
                <b>if</b> (<span class="r1043 r">methodCacheEntry</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r1043 r">methodCacheEntry</span>.<a href="../CoreAdapter.cs.html#faf234dfe054f8ec" class="i field">methodInformationStructures</a>[0].<a href="../CoreAdapter.cs.html#3a0e575988f5a5de" class="i field">method</a>.<span class="i">IsConstructor</span>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Members
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Types
 
        <b>private abstract class</b> <a id="bd5c32e26e01d827" href="../../R/bd5c32e26e01d827.html" target="n" data-glyph="4,1" class="t t"><span id="b3659fd9daf02940">TypeCompletionBase</span></a>
        {
            <b>internal abstract</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="9b6a425689c7f8e0" href="../../R/9b6a425689c7f8e0.html" target="n" data-glyph="74,2" class="i method">GetCompletionResult</a>(<b>string</b> <span id="r1044 rd" class="r1044 r">keyMatched</span>, <b>string</b> <span id="r1045 rd" class="r1045 r">prefix</span>, <b>string</b> <span id="r1046 rd" class="r1046 r">suffix</span>);
 
            <b>internal abstract</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="932c6e5a9de494ad" href="../../R/932c6e5a9de494ad.html" target="n" data-glyph="74,2" class="i method">GetCompletionResult</a>(<b>string</b> <span id="r1047 rd" class="r1047 r">keyMatched</span>, <b>string</b> <span id="r1048 rd" class="r1048 r">prefix</span>, <b>string</b> <span id="r1049 rd" class="r1049 r">suffix</span>, <b>string</b> <span id="r1050 rd" class="r1050 r">namespaceToRemove</span>);
 
            <b>internal static string</b> <a id="0f0f557f55a62cda" href="../../R/0f0f557f55a62cda.html" target="n" data-glyph="74,2" class="i method">RemoveBackTick</a>(<b>string</b> <span id="r1051 rd" class="r1051 r">typeName</span>)
            {
                <b>var</b> <span id="r1052 rd" class="r1052 r">backtick</span> = <span class="r1051 r">typeName</span>.<span class="i">LastIndexOf</span>(<span class="s">&#39;`&#39;</span>);
                <b>return</b> <span class="r1052 r">backtick</span> == -1 ? <span class="r1051 r">typeName</span> : <span class="r1051 r">typeName</span>.<span class="i">Substring</span>(0, <span class="r1052 r">backtick</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> In OneCore PS, there is no way to retrieve all loaded assemblies. But we have the type catalog dictionary</span>
        <span class="c">///</span><span class="c"> which contains the full type names of all available CoreCLR .NET types. We can extract the necessary info</span>
        <span class="c">///</span><span class="c"> from the full type names to make type name auto-completion work.</span>
        <span class="c">///</span><span class="c"> This type represents a non-generic type for type name completion. It only contains information that can be</span>
        <span class="c">///</span><span class="c"> inferred from the full type name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private class</b> <a id="de928d2f7700de02" href="../../R/de928d2f7700de02.html" target="n" data-glyph="4,1" class="t t"><span id="66990ddae4a5b0d9">TypeCompletionInStringFormat</span></a> : <a href="#bd5c32e26e01d827" class="t t">TypeCompletionBase</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Get the full type name of the type represented by this instance.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal string</b> <a id="65215f345f19bc1a" href="../../R/65215f345f19bc1a.html" target="n" data-glyph="44,2" class="i field">FullTypeName</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Get the short type name of the type represented by this instance.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal string</b> <a id="3d42a8e6f4604ddd" href="../../R/3d42a8e6f4604ddd.html" target="n" data-glyph="104,2" class="i property">ShortTypeName</a>
            {
                <b>get</b>
                {
                    <b>if</b> (<a href="#a4529aab57a44d81" class="i field">_shortTypeName</a> == <b>null</b>)
                    {
                        <b>int</b> <span id="r1053 rd" class="r1053 r">lastDotIndex</span> = <a href="#65215f345f19bc1a" class="i field">FullTypeName</a>.<span class="i">LastIndexOf</span>(<span class="s">&#39;.&#39;</span>);
                        <b>int</b> <span id="r1054 rd" class="r1054 r">lastPlusIndex</span> = <a href="#65215f345f19bc1a" class="i field">FullTypeName</a>.<span class="i">LastIndexOf</span>(<span class="s">&#39;+&#39;</span>);
                        <a href="#a4529aab57a44d81" class="i field">_shortTypeName</a> = <span class="r1054 r">lastPlusIndex</span> != -1
                                           ? <a href="#65215f345f19bc1a" class="i field">FullTypeName</a>.<span class="i">Substring</span>(<span class="r1054 r">lastPlusIndex</span> + 1)
                                           : <a href="#65215f345f19bc1a" class="i field">FullTypeName</a>.<span class="i">Substring</span>(<span class="r1053 r">lastDotIndex</span> + 1);
                    }
 
                    <b>return</b> <a href="#a4529aab57a44d81" class="i field">_shortTypeName</a>;
                }
            }
 
            <b>private string</b> <a id="a4529aab57a44d81" href="../../R/a4529aab57a44d81.html" target="n" data-glyph="46,2" class="i field">_shortTypeName</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Get the namespace of the type represented by this instance.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal string</b> <a id="333d526590fe4b42" href="../../R/333d526590fe4b42.html" target="n" data-glyph="104,2" class="i property">Namespace</a>
            {
                <b>get</b>
                {
                    <b>if</b> (<a href="#bcf9f5eccdad8749" class="i field">_namespace</a> == <b>null</b>)
                    {
                        <b>int</b> <span id="r1055 rd" class="r1055 r">lastDotIndex</span> = <a href="#65215f345f19bc1a" class="i field">FullTypeName</a>.<span class="i">LastIndexOf</span>(<span class="s">&#39;.&#39;</span>);
                        <a href="#bcf9f5eccdad8749" class="i field">_namespace</a> = <a href="#65215f345f19bc1a" class="i field">FullTypeName</a>.<span class="i">Substring</span>(0, <span class="r1055 r">lastDotIndex</span>);
                    }
 
                    <b>return</b> <a href="#bcf9f5eccdad8749" class="i field">_namespace</a>;
                }
            }
 
            <b>private string</b> <a id="bcf9f5eccdad8749" href="../../R/bcf9f5eccdad8749.html" target="n" data-glyph="46,2" class="i field">_namespace</a>;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Construct the CompletionResult based on the information of this instance.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal override</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="f87eb6a7acffc9d7" href="../../R/f87eb6a7acffc9d7.html" target="n" data-glyph="74,2" class="i method">GetCompletionResult</a>(<b>string</b> <span id="r1056 rd" class="r1056 r">keyMatched</span>, <b>string</b> <span id="r1057 rd" class="r1057 r">prefix</span>, <b>string</b> <span id="r1058 rd" class="r1058 r">suffix</span>)
            {
                <b>return</b> <a href="#4ba7c3ec70c9f100" class="i method">GetCompletionResult</a>(<span class="r1056 r">keyMatched</span>, <span class="r1057 r">prefix</span>, <span class="r1058 r">suffix</span>, <b>null</b>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Construct the CompletionResult based on the information of this instance.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal override</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="4ba7c3ec70c9f100" href="../../R/4ba7c3ec70c9f100.html" target="n" data-glyph="74,2" class="i method">GetCompletionResult</a>(<b>string</b> <span id="r1059 rd" class="r1059 r">keyMatched</span>, <b>string</b> <span id="r1060 rd" class="r1060 r">prefix</span>, <b>string</b> <span id="r1061 rd" class="r1061 r">suffix</span>, <b>string</b> <span id="r1062 rd" class="r1062 r">namespaceToRemove</span>)
            {
                <b>string</b> <span id="r1063 rd" class="r1063 r">completion</span> = <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1062 r">namespaceToRemove</span>)
                                        ? <a href="#65215f345f19bc1a" class="i field">FullTypeName</a>
                                        : <a href="#65215f345f19bc1a" class="i field">FullTypeName</a>.<span class="i">Substring</span>(<span class="r1062 r">namespaceToRemove</span>.<span class="i">Length</span> + 1);
 
                <b>string</b> <span id="r1064 rd" class="r1064 r">listItem</span> = <a href="#3d42a8e6f4604ddd" class="i property">ShortTypeName</a>;
                <b>string</b> <span id="r1065 rd" class="r1065 r">tooltip</span> = <a href="#65215f345f19bc1a" class="i field">FullTypeName</a>;
 
                <b>return</b> <b>new</b> <span class="t">CompletionResult</span>(<span class="r1060 r">prefix</span> + <span class="r1063 r">completion</span> + <span class="r1061 r">suffix</span>, <span class="r1064 r">listItem</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#46005faf1cdef9c1" class="i field">Type</a>, <span class="r1065 r">tooltip</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> In OneCore PS, there is no way to retrieve all loaded assemblies. But we have the type catalog dictionary</span>
        <span class="c">///</span><span class="c"> which contains the full type names of all available CoreCLR .NET types. We can extract the necessary info</span>
        <span class="c">///</span><span class="c"> from the full type names to make type name auto-completion work.</span>
        <span class="c">///</span><span class="c"> This type represents a generic type for type name completion. It only contains information that can be</span>
        <span class="c">///</span><span class="c"> inferred from the full type name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="f45f8ec52caf5be3" href="../../R/../../0000000000.html" target="n" data-glyph="4,1" class="t t"><span id="9ccf22aed22f5572">GenericTypeCompletionInStringFormat</span></a> : <a href="#de928d2f7700de02" class="t t">TypeCompletionInStringFormat</a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Get the number of generic type arguments required by the type represented by this instance.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>private int</b> <a id="93066fea8c4261a6" href="../../R/93066fea8c4261a6.html" target="n" data-glyph="106,2" class="i property">GenericArgumentCount</a>
            {
                <b>get</b>
                {
                    <b>if</b> (<a href="#14c1d92d4369182a" class="i field">_genericArgumentCount</a> == 0)
                    {
                        <b>var</b> <span id="r1066 rd" class="r1066 r">backtick</span> = <a href="#65215f345f19bc1a" class="i field">FullTypeName</a>.<span class="i">LastIndexOf</span>(<span class="s">&#39;`&#39;</span>);
                        <b>var</b> <span id="r1067 rd" class="r1067 r">argCount</span> = <a href="#65215f345f19bc1a" class="i field">FullTypeName</a>.<span class="i">Substring</span>(<span class="r1066 r">backtick</span> + 1);
                        <a href="#14c1d92d4369182a" class="i field">_genericArgumentCount</a> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>&lt;<b>int</b>&gt;(<span class="r1067 r">argCount</span>);
                    }
 
                    <b>return</b> <a href="#14c1d92d4369182a" class="i field">_genericArgumentCount</a>;
                }
            }
 
            <b>private int</b> <a id="14c1d92d4369182a" href="../../R/14c1d92d4369182a.html" target="n" data-glyph="46,2" class="i field">_genericArgumentCount</a> = 0;
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Construct the CompletionResult based on the information of this instance.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal override</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="a2d000c4da60aae7" href="../../R/a2d000c4da60aae7.html" target="n" data-glyph="74,2" class="i method">GetCompletionResult</a>(<b>string</b> <span id="r1068 rd" class="r1068 r">keyMatched</span>, <b>string</b> <span id="r1069 rd" class="r1069 r">prefix</span>, <b>string</b> <span id="r1070 rd" class="r1070 r">suffix</span>)
            {
                <b>return</b> <a href="#30f236e0baf670c9" class="i method">GetCompletionResult</a>(<span class="r1068 r">keyMatched</span>, <span class="r1069 r">prefix</span>, <span class="r1070 r">suffix</span>, <b>null</b>);
            }
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Construct the CompletionResult based on the information of this instance.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <b>internal override</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="30f236e0baf670c9" href="../../R/30f236e0baf670c9.html" target="n" data-glyph="74,2" class="i method">GetCompletionResult</a>(<b>string</b> <span id="r1071 rd" class="r1071 r">keyMatched</span>, <b>string</b> <span id="r1072 rd" class="r1072 r">prefix</span>, <b>string</b> <span id="r1073 rd" class="r1073 r">suffix</span>, <b>string</b> <span id="r1074 rd" class="r1074 r">namespaceToRemove</span>)
            {
                <b>string</b> <span id="r1075 rd" class="r1075 r">fullNameWithoutBacktip</span> = <a href="#0f0f557f55a62cda" class="i method">RemoveBackTick</a>(<a href="#65215f345f19bc1a" class="i field">FullTypeName</a>);
                <b>string</b> <span id="r1076 rd" class="r1076 r">completion</span> = <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1074 r">namespaceToRemove</span>)
                                        ? <span class="r1075 r">fullNameWithoutBacktip</span>
                                        : <span class="r1075 r">fullNameWithoutBacktip</span>.<span class="i">Substring</span>(<span class="r1074 r">namespaceToRemove</span>.<span class="i">Length</span> + 1);
 
                <b>string</b> <span id="r1077 rd" class="r1077 r">typeName</span> = <a href="#0f0f557f55a62cda" class="i method">RemoveBackTick</a>(<a href="#3d42a8e6f4604ddd" class="i property">ShortTypeName</a>);
                <b>var</b> <span id="r1078 rd" class="r1078 r">listItem</span> = <span class="r1077 r">typeName</span> + <span class="s">&quot;&lt;&gt;&quot;</span>;
 
                <b>var</b> <span id="r1079 rd" class="r1079 r">tooltip</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <span class="r1079 r">tooltip</span>.<span class="i">Append</span>(<span class="r1075 r">fullNameWithoutBacktip</span>);
                <span class="r1079 r">tooltip</span>.<span class="i">Append</span>(<span class="s">&#39;[&#39;</span>);
 
                <b>for</b> (<b>int</b> <span id="r1080 rd" class="r1080 r">i</span> = 0; <span class="r1080 r">i</span> &lt; <a href="#93066fea8c4261a6" class="i property">GenericArgumentCount</a>; <span class="r1080 r">i</span>++)
                {
                    <b>if</b> (<span class="r1080 r">i</span> != 0) <span class="r1079 r">tooltip</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                    <span class="r1079 r">tooltip</span>.<span class="i">Append</span>(<a href="#93066fea8c4261a6" class="i property">GenericArgumentCount</a> == 1
                                       ? <span class="s">&quot;T&quot;</span>
                                       : <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;T{0}&quot;</span>, <span class="r1080 r">i</span> + 1));
                }
 
                <span class="r1079 r">tooltip</span>.<span class="i">Append</span>(<span class="s">&#39;]&#39;</span>);
 
                <b>return</b> <b>new</b> <span class="t">CompletionResult</span>(<span class="r1072 r">prefix</span> + <span class="r1076 r">completion</span> + <span class="r1073 r">suffix</span>, <span class="r1078 r">listItem</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#46005faf1cdef9c1" class="i field">Type</a>, <span class="r1079 r">tooltip</span>.<span class="i">ToString</span>());
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This type represents a non-generic type for type name completion. It contains the actual type instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private class</b> <a id="051ba16176027beb" href="../../R/051ba16176027beb.html" target="n" data-glyph="4,1" class="t t"><span id="63cd9b069b898d61">TypeCompletion</span></a> : <a href="#bd5c32e26e01d827" class="t t">TypeCompletionBase</a>
        {
            <b>internal</b> <span class="i">Type</span> <a id="2c3a0ffb83f6fcfb" href="../../R/2c3a0ffb83f6fcfb.html" target="n" data-glyph="44,2" class="i field">Type</a>;
 
            <b>protected string</b> <a id="5f0cb719b4f6ce00" href="../../R/5f0cb719b4f6ce00.html" target="n" data-glyph="75,2" class="i method">GetTooltipPrefix</a>()
            {
                <b>if</b> (<b>typeof</b>(<span class="i">Delegate</span>).<span class="i">IsAssignableFrom</span>(<a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>))
                    <b>return</b> <span class="s">&quot;Delegate &quot;</span>;
                <b>if</b> (<a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>.<span class="i">IsInterface</span>)
                    <b>return</b> <span class="s">&quot;Interface &quot;</span>;
                <b>if</b> (<a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>.<span class="i">IsClass</span>)
                    <b>return</b> <span class="s">&quot;Class &quot;</span>;
                <b>if</b> (<a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>.<span class="i">IsEnum</span>)
                    <b>return</b> <span class="s">&quot;Enum &quot;</span>;
                <b>if</b> (<b>typeof</b>(<span class="i">ValueType</span>).<span class="i">IsAssignableFrom</span>(<a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>))
                    <b>return</b> <span class="s">&quot;Struct &quot;</span>;
 
                <b>return</b> <b>string</b>.<span class="i">Empty</span>; <span class="c">// what other interesting types are there?</span>
            }
 
            <b>internal override</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="61b7f882dd7f2c04" href="../../R/61b7f882dd7f2c04.html" target="n" data-glyph="74,2" class="i method">GetCompletionResult</a>(<b>string</b> <span id="r1081 rd" class="r1081 r">keyMatched</span>, <b>string</b> <span id="r1082 rd" class="r1082 r">prefix</span>, <b>string</b> <span id="r1083 rd" class="r1083 r">suffix</span>)
            {
                <b>return</b> <a href="#0b85b498c26b273c" class="i method">GetCompletionResult</a>(<span class="r1081 r">keyMatched</span>, <span class="r1082 r">prefix</span>, <span class="r1083 r">suffix</span>, <b>null</b>);
            }
 
            <b>internal override</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="0b85b498c26b273c" href="../../R/0b85b498c26b273c.html" target="n" data-glyph="74,2" class="i method">GetCompletionResult</a>(<b>string</b> <span id="r1084 rd" class="r1084 r">keyMatched</span>, <b>string</b> <span id="r1085 rd" class="r1085 r">prefix</span>, <b>string</b> <span id="r1086 rd" class="r1086 r">suffix</span>, <b>string</b> <span id="r1087 rd" class="r1087 r">namespaceToRemove</span>)
            {
                <b>string</b> <span id="r1088 rd" class="r1088 r">completion</span> = <a href="../../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<a href="../MshObject.cs.html#edc1ecfda5d75ea9" class="i method">Type</a>(<a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>, <b>false</b>, <span class="r1084 r">keyMatched</span>);
 
                <span class="c">// If the completion included a namespace and ToStringCodeMethods.Type found</span>
                <span class="c">// an accelerator, then just use the type&#39;s FullName instead because the user</span>
                <span class="c">// probably didn&#39;t want the accelerator.</span>
                <b>if</b> (<span class="r1084 r">keyMatched</span>.<span class="i">Contains</span>(<span class="s">&#39;.&#39;</span>) &amp;&amp; !<span class="r1088 r">completion</span>.<span class="i">Contains</span>(<span class="s">&#39;.&#39;</span>))
                {
                    <span class="r1088 r">completion</span> = <a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>.<span class="i">FullName</span>;
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1087 r">namespaceToRemove</span>) &amp;&amp; <span class="r1088 r">completion</span>.<span class="i">Equals</span>(<a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>.<span class="i">FullName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="c">// Remove the namespace only if the completion text contains namespace</span>
                    <span class="r1088 r">completion</span> = <span class="r1088 r">completion</span>.<span class="i">Substring</span>(<span class="r1087 r">namespaceToRemove</span>.<span class="i">Length</span> + 1);
                }
 
                <b>string</b> <span id="r1089 rd" class="r1089 r">listItem</span> = <a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>.<span class="i">Name</span>;
                <b>string</b> <span id="r1090 rd" class="r1090 r">tooltip</span> = <a href="#5f0cb719b4f6ce00" class="i method">GetTooltipPrefix</a>() + <a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>.<span class="i">FullName</span>;
 
                <b>return</b> <b>new</b> <span class="t">CompletionResult</span>(<span class="r1085 r">prefix</span> + <span class="r1088 r">completion</span> + <span class="r1086 r">suffix</span>, <span class="r1089 r">listItem</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#46005faf1cdef9c1" class="i field">Type</a>, <span class="r1090 r">tooltip</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This type represents a generic type for type name completion. It contains the actual type instance.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="4d950c3cd2d61561" href="../../R/../../0000000000.html" target="n" data-glyph="4,1" class="t t"><span id="84c8cfcc0db058a3">GenericTypeCompletion</span></a> : <a href="#051ba16176027beb" class="t t">TypeCompletion</a>
        {
            <b>internal override</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="8f4f0e04585f65f9" href="../../R/8f4f0e04585f65f9.html" target="n" data-glyph="74,2" class="i method">GetCompletionResult</a>(<b>string</b> <span id="r1091 rd" class="r1091 r">keyMatched</span>, <b>string</b> <span id="r1092 rd" class="r1092 r">prefix</span>, <b>string</b> <span id="r1093 rd" class="r1093 r">suffix</span>)
            {
                <b>return</b> <a href="#1baf6c4583432caa" class="i method">GetCompletionResult</a>(<span class="r1091 r">keyMatched</span>, <span class="r1092 r">prefix</span>, <span class="r1093 r">suffix</span>, <b>null</b>);
            }
 
            <b>internal override</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="1baf6c4583432caa" href="../../R/1baf6c4583432caa.html" target="n" data-glyph="74,2" class="i method">GetCompletionResult</a>(<b>string</b> <span id="r1094 rd" class="r1094 r">keyMatched</span>, <b>string</b> <span id="r1095 rd" class="r1095 r">prefix</span>, <b>string</b> <span id="r1096 rd" class="r1096 r">suffix</span>, <b>string</b> <span id="r1097 rd" class="r1097 r">namespaceToRemove</span>)
            {
                <b>string</b> <span id="r1098 rd" class="r1098 r">fullNameWithoutBacktip</span> = <span class="i">RemoveBackTick</span>(<a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>.<span class="i">FullName</span>);
                <b>string</b> <span id="r1099 rd" class="r1099 r">completion</span> = <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1097 r">namespaceToRemove</span>)
                                        ? <span class="r1098 r">fullNameWithoutBacktip</span>
                                        : <span class="r1098 r">fullNameWithoutBacktip</span>.<span class="i">Substring</span>(<span class="r1097 r">namespaceToRemove</span>.<span class="i">Length</span> + 1);
 
                <b>string</b> <span id="r1100 rd" class="r1100 r">typeName</span> = <span class="i">RemoveBackTick</span>(<a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>.<span class="i">Name</span>);
                <b>var</b> <span id="r1101 rd" class="r1101 r">listItem</span> = <span class="r1100 r">typeName</span> + <span class="s">&quot;&lt;&gt;&quot;</span>;
 
                <b>var</b> <span id="r1102 rd" class="r1102 r">tooltip</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <span class="r1102 r">tooltip</span>.<span class="i">Append</span>(<a href="#5f0cb719b4f6ce00" class="i method">GetTooltipPrefix</a>());
                <span class="r1102 r">tooltip</span>.<span class="i">Append</span>(<span class="r1098 r">fullNameWithoutBacktip</span>);
                <span class="r1102 r">tooltip</span>.<span class="i">Append</span>(<span class="s">&#39;[&#39;</span>);
                <b>var</b> <span id="r1103 rd" class="r1103 r">genericParameters</span> = <a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>.<span class="i">GetGenericArguments</span>();
                <b>for</b> (<b>int</b> <span id="r1104 rd" class="r1104 r">i</span> = 0; <span class="r1104 r">i</span> &lt; <span class="r1103 r">genericParameters</span>.<span class="i">Length</span>; <span class="r1104 r">i</span>++)
                {
                    <b>if</b> (<span class="r1104 r">i</span> != 0) <span class="r1102 r">tooltip</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                    <span class="r1102 r">tooltip</span>.<span class="i">Append</span>(<span class="r1103 r">genericParameters</span>[<span class="r1104 r">i</span>].<span class="i">Name</span>);
                }
 
                <span class="r1102 r">tooltip</span>.<span class="i">Append</span>(<span class="s">&#39;]&#39;</span>);
 
                <b>return</b> <b>new</b> <span class="t">CompletionResult</span>(<span class="r1095 r">prefix</span> + <span class="r1099 r">completion</span> + <span class="r1096 r">suffix</span>, <span class="r1101 r">listItem</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#46005faf1cdef9c1" class="i field">Type</a>, <span class="r1102 r">tooltip</span>.<span class="i">ToString</span>());
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This type represents a namespace for namespace completion.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private sealed class</b> <a id="f863c1b65dc66612" href="../../R/f863c1b65dc66612.html" target="n" data-glyph="4,1" class="t t"><span id="d6ed97728ee634df">NamespaceCompletion</span></a> : <a href="#bd5c32e26e01d827" class="t t">TypeCompletionBase</a>
        {
            <b>internal string</b> <a id="9c7cbf19a66f18a4" href="../../R/9c7cbf19a66f18a4.html" target="n" data-glyph="44,2" class="i field">Namespace</a>;
 
            <b>internal override</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="dd876e8cc31a40d4" href="../../R/dd876e8cc31a40d4.html" target="n" data-glyph="74,2" class="i method">GetCompletionResult</a>(<b>string</b> <span id="r1105 rd" class="r1105 r">keyMatched</span>, <b>string</b> <span id="r1106 rd" class="r1106 r">prefix</span>, <b>string</b> <span id="r1107 rd" class="r1107 r">suffix</span>)
            {
                <b>var</b> <span id="r1108 rd" class="r1108 r">listItemText</span> = <a href="#9c7cbf19a66f18a4" class="i field">Namespace</a>;
                <b>var</b> <span id="r1109 rd" class="r1109 r">dotIndex</span> = <span class="r1108 r">listItemText</span>.<span class="i">LastIndexOf</span>(<span class="s">&#39;.&#39;</span>);
                <b>if</b> (<span class="r1109 r">dotIndex</span> != -1)
                {
                    <span class="r1108 r">listItemText</span> = <span class="r1108 r">listItemText</span>.<span class="i">Substring</span>(<span class="r1109 r">dotIndex</span> + 1);
                }
 
                <b>return</b> <b>new</b> <span class="t">CompletionResult</span>(<span class="r1106 r">prefix</span> + <a href="#9c7cbf19a66f18a4" class="i field">Namespace</a> + <span class="r1107 r">suffix</span>, <span class="r1108 r">listItemText</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#0c8ffb24052ce771" class="i field">Namespace</a>, <span class="s">&quot;Namespace &quot;</span> + <a href="#9c7cbf19a66f18a4" class="i field">Namespace</a>);
            }
 
            <b>internal override</b> <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <a id="e71c7d99de8fe3f8" href="../../R/e71c7d99de8fe3f8.html" target="n" data-glyph="74,2" class="i method">GetCompletionResult</a>(<b>string</b> <span id="r1110 rd" class="r1110 r">keyMatched</span>, <b>string</b> <span id="r1111 rd" class="r1111 r">prefix</span>, <b>string</b> <span id="r1112 rd" class="r1112 r">suffix</span>, <b>string</b> <span id="r1113 rd" class="r1113 r">namespaceToRemove</span>)
            {
                <b>return</b> <a href="#dd876e8cc31a40d4" class="i method">GetCompletionResult</a>(<span class="r1110 r">keyMatched</span>, <span class="r1111 r">prefix</span>, <span class="r1112 r">suffix</span>);
            }
        }
 
        <b>private sealed class</b> <a id="9608b00173ce2fb7" href="../../R/9608b00173ce2fb7.html" target="n" data-glyph="4,1" class="t t"><span id="53bc7cc93ea440a6">TypeCompletionMapping</span></a>
        {
            <span class="c">// The Key is the string we&#39;ll be searching on.  It could complete to various things.</span>
            <b>internal string</b> <a id="4515293761e4a3cb" href="../../R/4515293761e4a3cb.html" target="n" data-glyph="44,2" class="i field">Key</a>;
            <b>internal</b> <span class="i">List</span>&lt;<a href="#bd5c32e26e01d827" class="t t">TypeCompletionBase</a>&gt; <a id="410898aeeaf1ca2a" href="../../R/410898aeeaf1ca2a.html" target="n" data-glyph="44,2" class="i field">Completions</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#bd5c32e26e01d827" class="t t">TypeCompletionBase</a>&gt;();
        }
 
        <b>private static</b> <a href="#9608b00173ce2fb7" class="t t">TypeCompletionMapping</a>[][] <a id="20224d4c52cf7c0a" href="../../R/20224d4c52cf7c0a.html" target="n" data-glyph="46,1" class="i field">s_typeCache</a>;
 
        <b>private static</b> <a href="#9608b00173ce2fb7" class="t t">TypeCompletionMapping</a>[][] <a id="af3b6a2b7e39a8ad" href="../../R/af3b6a2b7e39a8ad.html" target="n" data-glyph="76,1" class="i method">InitializeTypeCache</a>()
        {
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Process_TypeAccelerators
 
            <b>var</b> <span id="r1114 rd" class="r1114 r">entries</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#9608b00173ce2fb7" class="t t">TypeCompletionMapping</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<b>var</b> <span id="r1115 rd" class="r1115 r">type</span> <b>in</b> <a href="../parser/TypeResolver.cs.html#c299defb2b5f7804" class="t t">TypeAccelerators</a>.<a href="../parser/TypeResolver.cs.html#da69e644635c6f39" class="i property">Get</a>)
            {
                <a href="#9608b00173ce2fb7" class="t t">TypeCompletionMapping</a> <span id="r1116 rd" class="r1116 r">entry</span>;
                <a href="#051ba16176027beb" class="k">var</a> <span id="r1117 rd" class="r1117 r">typeCompletionInstance</span> = <b>new</b> <span class="t">TypeCompletion</span> { <a href="#2c3a0ffb83f6fcfb" class="i field">Type</a> = <span class="r1115 r">type</span>.<span class="i">Value</span> };
 
                <b>if</b> (<span class="r1114 r">entries</span>.<span class="i">TryGetValue</span>(<span class="r1115 r">type</span>.<span class="i">Key</span>, <b>out</b> <span class="r1116 r">entry</span>))
                {
                    <span class="c">// Check if this accelerator type is already included in the mapping entry referenced by the same key.</span>
                    <span class="i">Type</span> <span id="r1118 rd" class="r1118 r">acceleratorType</span> = <span class="r1115 r">type</span>.<span class="i">Value</span>;
                    <b>bool</b> <span id="r1119 rd" class="r1119 r">typeAlreadyIncluded</span> = <span class="r1116 r">entry</span>.<a href="#410898aeeaf1ca2a" class="i field">Completions</a>.<span class="i">Any</span>(
                        <span id="r1120 rd" class="r1120 r">item</span> =&gt;
                            {
                                <a href="#051ba16176027beb" class="k">var</a> <span id="r1121 rd" class="r1121 r">typeCompletion</span> = <span class="r1120 r">item</span> <b>as</b> <a href="#051ba16176027beb" class="t t">TypeCompletion</a>;
                                <b>return</b> <span class="r1121 r">typeCompletion</span> != <b>null</b> &amp;&amp; <span class="r1121 r">typeCompletion</span>.<a href="#2c3a0ffb83f6fcfb" class="i field">Type</a> == <span class="r1118 r">acceleratorType</span>;
                            });
 
                    <span class="c">// If it&#39;s already included, skip it.</span>
                    <span class="c">// This may happen when an accelerator name is the same as the short name of the type it represents,</span>
                    <span class="c">// and aslo that type has more than one accelerator names. For example:</span>
                    <span class="c">//    &quot;float&quot;  -&gt; System.Single</span>
                    <span class="c">//    &quot;single&quot; -&gt; System.Single</span>
                    <b>if</b> (<span class="r1119 r">typeAlreadyIncluded</span>) { <b>continue</b>; }
 
                    <span class="c">// If this accelerator type is not included in the mapping entry, add it in.</span>
                    <span class="c">// This may happen when an accelerator name happens to be the short name of a different type (rare case).</span>
                    <span class="r1116 r">entry</span>.<a href="#410898aeeaf1ca2a" class="i field">Completions</a>.<span class="i">Add</span>(<span class="r1117 r">typeCompletionInstance</span>);
                }
                <b>else</b>
                {
                    <span class="r1114 r">entries</span>.<span class="i">Add</span>(<span class="r1115 r">type</span>.<span class="i">Key</span>, <b>new</b> <span class="t">TypeCompletionMapping</span> { <a href="#4515293761e4a3cb" class="i field">Key</a> = <span class="r1115 r">type</span>.<span class="i">Key</span>, <a href="#410898aeeaf1ca2a" class="i field">Completions</a> = { <span class="r1117 r">typeCompletionInstance</span> } });
                }
 
                <span class="c">// If the full type name has already been included, then we know for sure that the short type name has also been included.</span>
                <b>string</b> <span id="r1122 rd" class="r1122 r">fullTypeName</span> = <span class="r1115 r">type</span>.<span class="i">Value</span>.<span class="i">FullName</span>;
                <b>if</b> (<span class="r1114 r">entries</span>.<span class="i">ContainsKey</span>(<span class="r1122 r">fullTypeName</span>)) { <b>continue</b>; }
 
                <span class="c">// Otherwise, add the mapping from full type name to the type</span>
                <span class="r1114 r">entries</span>.<span class="i">Add</span>(<span class="r1122 r">fullTypeName</span>, <b>new</b> <span class="t">TypeCompletionMapping</span> { <a href="#4515293761e4a3cb" class="i field">Key</a> = <span class="r1122 r">fullTypeName</span>, <a href="#410898aeeaf1ca2a" class="i field">Completions</a> = { <span class="r1117 r">typeCompletionInstance</span> } });
 
                <span class="c">// If the short type name is the same as the accelerator name, then skip it to avoid duplication.</span>
                <b>string</b> <span id="r1123 rd" class="r1123 r">shortTypeName</span> = <span class="r1115 r">type</span>.<span class="i">Value</span>.<span class="i">Name</span>;
                <b>if</b> (<span class="r1115 r">type</span>.<span class="i">Key</span>.<span class="i">Equals</span>(<span class="r1123 r">shortTypeName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)) { <b>continue</b>; }
 
                <span class="c">// Otherwise, add a new mapping entry, or put the TypeCompletion instance in the existing mapping entry.</span>
                <span class="c">// For example, this may happen if both System.TimeoutException and System.ServiceProcess.TimeoutException</span>
                <span class="c">// are in the TypeAccelerator cache.</span>
                <b>if</b> (!<span class="r1114 r">entries</span>.<span class="i">TryGetValue</span>(<span class="r1123 r">shortTypeName</span>, <b>out</b> <span class="r1116 r">entry</span>))
                {
                    <span class="r1116 r">entry</span> = <b>new</b> <span class="t">TypeCompletionMapping</span> { <a href="#4515293761e4a3cb" class="i field">Key</a> = <span class="r1123 r">shortTypeName</span> };
                    <span class="r1114 r">entries</span>.<span class="i">Add</span>(<span class="r1123 r">shortTypeName</span>, <span class="r1116 r">entry</span>);
                }
 
                <span class="r1116 r">entry</span>.<a href="#410898aeeaf1ca2a" class="i field">Completions</a>.<span class="i">Add</span>(<span class="r1117 r">typeCompletionInstance</span>);
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Process_TypeAccelerators
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Process_CoreCLR_TypeCatalog
 
            <span class="c">// In CoreCLR, we have namespace-qualified type names of all available .NET Core types stored in TypeCatalog.</span>
            <span class="c">// Populate the type completion cache using the namespace-qualified type names.</span>
            <b>foreach</b> (<b>string</b> <span id="r1124 rd" class="r1124 r">fullTypeName</span> <b>in</b> <a href="../../utils/ClrFacade.cs.html#a9a016478ec73a42" class="t t">ClrFacade</a>.<a href="../../utils/ClrFacade.cs.html#2accf5603a160752" class="i property">AvailableDotNetTypeNames</a>)
            {
                <a href="#de928d2f7700de02" class="k">var</a> <span id="r1125 rd" class="r1125 r">typeCompInString</span> = <b>new</b> <span class="t">TypeCompletionInStringFormat</span> { <a href="#65215f345f19bc1a" class="i field">FullTypeName</a> = <span class="r1124 r">fullTypeName</span> };
                <a href="#26d045846bc716a3" class="i method">HandleNamespace</a>(<span class="r1114 r">entries</span>, <span class="r1125 r">typeCompInString</span>.<a href="#333d526590fe4b42" class="i property">Namespace</a>);
                <a href="#72fa6565d78ad266" class="i method">HandleType</a>(<span class="r1114 r">entries</span>, <span class="r1124 r">fullTypeName</span>, <span class="r1125 r">typeCompInString</span>.<a href="#3d42a8e6f4604ddd" class="i property">ShortTypeName</a>, <b>null</b>);
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Process_CoreCLR_TypeCatalog
 
            <span class="k preprocess">#</span><span class="k preprocess">region</span> Process_LoadedAssemblies
 
            <b>foreach</b> (<span class="i">Assembly</span> <span id="r1126 rd" class="r1126 r">assembly</span> <b>in</b> <a href="../../utils/ClrFacade.cs.html#a9a016478ec73a42" class="t t">ClrFacade</a>.<a href="../../utils/ClrFacade.cs.html#0f02ed52d6976720" class="i method">GetAssemblies</a>())
            {
                <span class="c">// Ignore the assemblies that are already covered by the type catalog</span>
                <b>if</b> (<a href="../../utils/ClrFacade.cs.html#a9a016478ec73a42" class="t t">ClrFacade</a>.<a href="../../utils/ClrFacade.cs.html#bd2ab28d61e79000" class="i property">AvailableDotNetAssemblyNames</a>.<span class="i">Contains</span>(<span class="r1126 r">assembly</span>.<span class="i">FullName</span>)) { <b>continue</b>; }
 
                <b>try</b>
                {
                    <b>foreach</b> (<span class="i">Type</span> <span id="r1127 rd" class="r1127 r">type</span> <b>in</b> <span class="r1126 r">assembly</span>.<span class="i">GetTypes</span>())
                    {
                        <span class="c">// Ignore non-public types</span>
                        <b>if</b> (!<a href="../parser/TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="../parser/TypeResolver.cs.html#4060500316c13cf6" class="i method">IsPublic</a>(<span class="r1127 r">type</span>)) { <b>continue</b>; }
 
                        <span class="i">HandleNamespace</span>(<span class="r1114 r">entries</span>, <span class="r1127 r">type</span>.<span class="i">Namespace</span>);
                        <span class="i">HandleType</span>(<span class="r1114 r">entries</span>, <span class="r1127 r">type</span>.<span class="i">FullName</span>, <span class="r1127 r">type</span>.<span class="i">Name</span>, <span class="r1127 r">type</span>);
                    }
                }
                <b>catch</b> (<span class="i">ReflectionTypeLoadException</span>)
                {
                }
            }
 
            <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Process_LoadedAssemblies
 
            <b>var</b> <span id="r1128 rd" class="r1128 r">grouping</span> = <span class="r1114 r">entries</span>.<span class="i">Values</span>.<span class="i">GroupBy</span>(<b>static</b> <span id="r1129 rd" class="r1129 r">t</span> =&gt; <span class="r1129 r">t</span>.<span class="i">Key</span>.<span class="i">Count</span>(<span id="r1130 rd" class="r1130 r">c</span> =&gt; <span class="r1130 r">c</span> == <span class="s">&#39;.&#39;</span>)).<span class="i">OrderBy</span>(<b>static</b> <span id="r1131 rd" class="r1131 r">g</span> =&gt; <span class="r1131 r">g</span>.<span class="i">Key</span>).<span class="i">ToArray</span>();
            <b>var</b> <span id="r1132 rd" class="r1132 r">localTypeCache</span> = <b>new</b> <a href="#9608b00173ce2fb7" class="t t">TypeCompletionMapping</a>[<span class="r1128 r">grouping</span>.<span class="i">Last</span>().<span class="i">Key</span> + 1][];
            <b>foreach</b> (<b>var</b> <span id="r1133 rd" class="r1133 r">group</span> <b>in</b> <span class="r1128 r">grouping</span>)
            {
                <span class="r1132 r">localTypeCache</span>[<span class="r1133 r">group</span>.<span class="i">Key</span>] = <span class="r1133 r">group</span>.<span class="i">ToArray</span>();
            }
 
            <span class="i">Interlocked</span>.<span class="i">Exchange</span>(<b>ref</b> <a href="#20224d4c52cf7c0a" class="i field">s_typeCache</a>, <span class="r1132 r">localTypeCache</span>);
            <b>return</b> <span class="r1132 r">localTypeCache</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle namespace when initializing the type cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1134 r">entryCache</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The TypeCompletionMapping dictionary.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1135 r">namespace</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The namespace.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="26d045846bc716a3" href="../../R/26d045846bc716a3.html" target="n" data-glyph="76,1" class="i method">HandleNamespace</a>(<span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#9608b00173ce2fb7" class="t t">TypeCompletionMapping</a>&gt; <span id="r1134 rd" class="r1134 r">entryCache</span>, <b>string</b> <span id="r1135 rd" class="r1135 r">@namespace</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1135 r">@namespace</span>))
            {
                <b>return</b>;
            }
 
            <b>int</b> <span id="r1136 rd" class="r1136 r">dotIndex</span> = 0;
            <b>while</b> (<span class="r1136 r">dotIndex</span> != -1)
            {
                <span class="r1136 r">dotIndex</span> = <span class="r1135 r">@namespace</span>.<span class="i">IndexOf</span>(<span class="s">&#39;.&#39;</span>, <span class="r1136 r">dotIndex</span> + 1);
                <b>string</b> <span id="r1137 rd" class="r1137 r">subNamespace</span> = <span class="r1136 r">dotIndex</span> != -1
                                        ? <span class="r1135 r">@namespace</span>.<span class="i">Substring</span>(0, <span class="r1136 r">dotIndex</span>)
                                        : <span class="r1135 r">@namespace</span>;
 
                <a href="#9608b00173ce2fb7" class="t t">TypeCompletionMapping</a> <span id="r1138 rd" class="r1138 r">entry</span>;
                <b>if</b> (!<span class="r1134 r">entryCache</span>.<span class="i">TryGetValue</span>(<span class="r1137 r">subNamespace</span>, <b>out</b> <span class="r1138 r">entry</span>))
                {
                    <span class="r1138 r">entry</span> = <b>new</b> <span class="t">TypeCompletionMapping</span>
                    {
                        <a href="#4515293761e4a3cb" class="i field">Key</a> = <span class="r1137 r">subNamespace</span>,
                        <a href="#410898aeeaf1ca2a" class="i field">Completions</a> = { <b>new</b> <span class="t">NamespaceCompletion</span> { <a href="#9c7cbf19a66f18a4" class="i field">Namespace</a> = <span class="r1137 r">subNamespace</span> } }
                    };
                    <span class="r1134 r">entryCache</span>.<span class="i">Add</span>(<span class="r1137 r">subNamespace</span>, <span class="r1138 r">entry</span>);
                }
                <b>else</b> <b>if</b> (!<span class="r1138 r">entry</span>.<a href="#410898aeeaf1ca2a" class="i field">Completions</a>.<span class="i">OfType</span>&lt;<a href="#f863c1b65dc66612" class="t t">NamespaceCompletion</a>&gt;().<span class="i">Any</span>())
                {
                    <span class="r1138 r">entry</span>.<a href="#410898aeeaf1ca2a" class="i field">Completions</a>.<span class="i">Add</span>(<b>new</b> <span class="t">NamespaceCompletion</span> { <a href="#9c7cbf19a66f18a4" class="i field">Namespace</a> = <span class="r1137 r">subNamespace</span> });
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle a type when initializing the type cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1139 r">entryCache</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The TypeCompletionMapping dictionary.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1140 r">fullTypeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The full type name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1141 r">shortTypeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The short type name.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1142 r">actualType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The actual type object. It may be null if we are handling type information from the CoreCLR TypeCatalog.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="72fa6565d78ad266" href="../../R/72fa6565d78ad266.html" target="n" data-glyph="76,1" class="i method">HandleType</a>(<span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#9608b00173ce2fb7" class="t t">TypeCompletionMapping</a>&gt; <span id="r1139 rd" class="r1139 r">entryCache</span>, <b>string</b> <span id="r1140 rd" class="r1140 r">fullTypeName</span>, <b>string</b> <span id="r1141 rd" class="r1141 r">shortTypeName</span>, <span class="i">Type</span> <span id="r1142 rd" class="r1142 r">actualType</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1140 r">fullTypeName</span>)) { <b>return</b>; }
 
            <a href="#bd5c32e26e01d827" class="t t">TypeCompletionBase</a> <span id="r1143 rd" class="r1143 r">typeCompletionBase</span> = <b>null</b>;
            <b>var</b> <span id="r1144 rd" class="r1144 r">backtick</span> = <span class="r1140 r">fullTypeName</span>.<span class="i">LastIndexOf</span>(<span class="s">&#39;`&#39;</span>);
            <b>var</b> <span id="r1145 rd" class="r1145 r">plusChar</span> = <span class="r1140 r">fullTypeName</span>.<span class="i">LastIndexOf</span>(<span class="s">&#39;+&#39;</span>);
 
            <b>bool</b> <span id="r1146 rd" class="r1146 r">isGenericTypeDefinition</span> = <span class="r1144 r">backtick</span> != -1;
            <b>bool</b> <span id="r1147 rd" class="r1147 r">isNested</span> = <span class="r1145 r">plusChar</span> != -1;
 
            <b>if</b> (<span class="r1146 r">isGenericTypeDefinition</span>)
            {
                <span class="c">// Nested generic types aren&#39;t useful for completion.</span>
                <b>if</b> (<span class="r1147 r">isNested</span>) { <b>return</b>; }
 
                <span class="r1143 r">typeCompletionBase</span> = <span class="r1142 r">actualType</span> != <b>null</b>
                                         ? (<a href="#bd5c32e26e01d827" class="t t">TypeCompletionBase</a>)<b>new</b> <span class="t">GenericTypeCompletion</span> { <a href="#2c3a0ffb83f6fcfb" class="i field">Type</a> = <span class="r1142 r">actualType</span> }
 
                                         : <b>new</b> <span class="t">GenericTypeCompletionInStringFormat</span> { <a href="#65215f345f19bc1a" class="i field">FullTypeName</a> = <span class="r1140 r">fullTypeName</span> };
 
                <span class="c">// Remove the backtick, we only want 1 generic in our results for types like Func or Action.</span>
                <span class="r1140 r">fullTypeName</span> = <span class="r1140 r">fullTypeName</span>.<span class="i">Substring</span>(0, <span class="r1144 r">backtick</span>);
                <span class="r1141 r">shortTypeName</span> = <span class="r1141 r">shortTypeName</span>.<span class="i">Substring</span>(0, <span class="r1141 r">shortTypeName</span>.<span class="i">LastIndexOf</span>(<span class="s">&#39;`&#39;</span>));
            }
            <b>else</b>
            {
                <span class="r1143 r">typeCompletionBase</span> = <span class="r1142 r">actualType</span> != <b>null</b>
                                         ? (<a href="#bd5c32e26e01d827" class="t t">TypeCompletionBase</a>)<b>new</b> <span class="t">TypeCompletion</span> { <a href="#2c3a0ffb83f6fcfb" class="i field">Type</a> = <span class="r1142 r">actualType</span> }
 
                                         : <b>new</b> <span class="t">TypeCompletionInStringFormat</span> { <a href="#65215f345f19bc1a" class="i field">FullTypeName</a> = <span class="r1140 r">fullTypeName</span> };
            }
 
            <span class="c">// If the full type name has already been included, then we know for sure that the short type</span>
            <span class="c">// name and the accelerator type names (if there are any) have also been included.</span>
            <a href="#9608b00173ce2fb7" class="t t">TypeCompletionMapping</a> <span id="r1148 rd" class="r1148 r">entry</span>;
            <b>if</b> (!<span class="r1139 r">entryCache</span>.<span class="i">TryGetValue</span>(<span class="r1140 r">fullTypeName</span>, <b>out</b> <span class="r1148 r">entry</span>))
            {
                <span class="r1148 r">entry</span> = <b>new</b> <span class="t">TypeCompletionMapping</span>
                {
                    <a href="#4515293761e4a3cb" class="i field">Key</a> = <span class="r1140 r">fullTypeName</span>,
                    <a href="#410898aeeaf1ca2a" class="i field">Completions</a> = { <span class="r1143 r">typeCompletionBase</span> }
                };
                <span class="r1139 r">entryCache</span>.<span class="i">Add</span>(<span class="r1140 r">fullTypeName</span>, <span class="r1148 r">entry</span>);
 
                <span class="c">// Add a new mapping entry, or put the TypeCompletion instance in the existing mapping entry of the shortTypeName.</span>
                <span class="c">// For example, this may happen to System.ServiceProcess.TimeoutException when System.TimeoutException is already in the cache.</span>
                <b>if</b> (!<span class="r1139 r">entryCache</span>.<span class="i">TryGetValue</span>(<span class="r1141 r">shortTypeName</span>, <b>out</b> <span class="r1148 r">entry</span>))
                {
                    <span class="r1148 r">entry</span> = <b>new</b> <span class="t">TypeCompletionMapping</span> { <a href="#4515293761e4a3cb" class="i field">Key</a> = <span class="r1141 r">shortTypeName</span> };
                    <span class="r1139 r">entryCache</span>.<span class="i">Add</span>(<span class="r1141 r">shortTypeName</span>, <span class="r1148 r">entry</span>);
                }
 
                <span class="r1148 r">entry</span>.<a href="#410898aeeaf1ca2a" class="i field">Completions</a>.<span class="i">Add</span>(<span class="r1143 r">typeCompletionBase</span>);
            }
        }
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="d5d16aeb36fae66f" href="../../R/d5d16aeb36fae66f.html" target="n" data-glyph="74,1" class="i method">CompleteNamespace</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r1149 rd" class="r1149 r">context</span>, <b>string</b> <span id="r1150 rd" class="r1150 r">prefix</span> = <span class="s">&quot;&quot;</span>, <b>string</b> <span id="r1151 rd" class="r1151 r">suffix</span> = <span class="s">&quot;&quot;</span>)
        {
            <b>var</b> <span id="r1152 rd" class="r1152 r">localTypeCache</span> = <a href="#20224d4c52cf7c0a" class="i field">s_typeCache</a> ?? <a href="#af3b6a2b7e39a8ad" class="i method">InitializeTypeCache</a>();
            <b>var</b> <span id="r1153 rd" class="r1153 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
            <b>var</b> <span id="r1154 rd" class="r1154 r">wordToComplete</span> = <span class="r1149 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>;
            <b>var</b> <span id="r1155 rd" class="r1155 r">dots</span> = <span class="r1154 r">wordToComplete</span>.<span class="i">Count</span>(<b>static</b> <span id="r1156 rd" class="r1156 r">c</span> =&gt; <span class="r1156 r">c</span> == <span class="s">&#39;.&#39;</span>);
            <b>if</b> (<span class="r1155 r">dots</span> &gt;= <span class="r1152 r">localTypeCache</span>.<span class="i">Length</span> || <span class="r1152 r">localTypeCache</span>[<span class="r1155 r">dots</span>] == <b>null</b>)
            {
                <b>return</b> <span class="r1153 r">results</span>;
            }
 
            <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r1157 rd" class="r1157 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r1154 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
            <b>foreach</b> (<b>var</b> <span id="r1158 rd" class="r1158 r">entry</span> <b>in</b> <span class="r1152 r">localTypeCache</span>[<span class="r1155 r">dots</span>].<span class="i">Where</span>(<span id="r1159 rd" class="r1159 r">e</span> =&gt; <span class="r1159 r">e</span>.<span class="i">Completions</span>.<span class="i">OfType</span>&lt;<a href="#f863c1b65dc66612" class="t t">NamespaceCompletion</a>&gt;().<span class="i">Any</span>() &amp;&amp; <span class="r1157 r">pattern</span>.<span class="i">IsMatch</span>(<span class="r1159 r">e</span>.<span class="i">Key</span>)))
            {
                <b>foreach</b> (<b>var</b> <span id="r1160 rd" class="r1160 r">completion</span> <b>in</b> <span class="r1158 r">entry</span>.<span class="i">Completions</span>)
                {
                    <span class="r1153 r">results</span>.<span class="i">Add</span>(<span class="r1160 r">completion</span>.<span class="i">GetCompletionResult</span>(<span class="r1158 r">entry</span>.<span class="i">Key</span>, <span class="r1150 r">prefix</span>, <span class="r1151 r">suffix</span>));
                }
            }
 
            <span class="r1153 r">results</span>.<span class="i">Sort</span>(<b>static</b> (<span id="r1161 rd" class="r1161 r">c1</span>, <span id="r1162 rd" class="r1162 r">c2</span>) =&gt; <b>string</b>.<span class="i">Compare</span>(<span class="r1161 r">c1</span>.<span class="i">ListItemText</span>, <span class="r1162 r">c2</span>.<span class="i">ListItemText</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
            <b>return</b> <span class="r1153 r">results</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Complete a typename.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1163 r">typeName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <span class="i">IEnumerable</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="f5d7b2cda50ff9f6" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CompleteType</a>(<b>string</b> <span id="r1163 rd" class="r1163 r">typeName</span>)
        {
            <span class="c">// When completing types, we don&#39;t care about the runspace, types are visible across the appdomain</span>
            <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="k">var</a> <span id="r1164 rd" class="r1164 r">powershell</span> = (<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> == <b>null</b>)
                                 ? <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>()
                                 : <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#1c6a51d3c837bb4d" class="i method">Create</a>(<a href="../hostifaces/PowerShell.cs.html#c3c0f0e5e0b337ff" class="t t">RunspaceMode</a>.<a href="../hostifaces/PowerShell.cs.html#75d224de5df87e75" class="i field">CurrentRunspace</a>);
 
            <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r1165 rd" class="r1165 r">helper</span> = <b>new</b> <a href="../../utils/PowerShellExecutionHelper.cs.html#b251f5b816b2dd25" class="t constructor">PowerShellExecutionHelper</a>(<span class="r1164 r">powershell</span>);
            <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r1166 rd" class="r1166 r">executionContext</span> = <span class="r1165 r">helper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ddb7ad1950c8ea20" class="i property">CurrentPowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a>.<a href="../hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>;
            <b>return</b> <a href="#57017baf59ddb34d" class="i method">CompleteType</a>(<b>new</b> <span class="t">CompletionContext</span> { <a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> = <span class="r1163 r">typeName</span>, <a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a> = <span class="r1165 r">helper</span>, <a href="CompletionAnalysis.cs.html#4055c622a2008ac8" class="i property">ExecutionContext</a> = <span class="r1166 r">executionContext</span> });
        }
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="57017baf59ddb34d" href="../../R/57017baf59ddb34d.html" target="n" data-glyph="74,1" class="i method">CompleteType</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r1167 rd" class="r1167 r">context</span>, <b>string</b> <span id="r1168 rd" class="r1168 r">prefix</span> = <span class="s">&quot;&quot;</span>, <b>string</b> <span id="r1169 rd" class="r1169 r">suffix</span> = <span class="s">&quot;&quot;</span>)
        {
            <b>var</b> <span id="r1170 rd" class="r1170 r">localTypeCache</span> = <a href="#20224d4c52cf7c0a" class="i field">s_typeCache</a> ?? <a href="#af3b6a2b7e39a8ad" class="i method">InitializeTypeCache</a>();
 
            <b>var</b> <span id="r1171 rd" class="r1171 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
            <b>var</b> <span id="r1172 rd" class="r1172 r">completionTextSet</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>var</b> <span id="r1173 rd" class="r1173 r">wordToComplete</span> = <span class="r1167 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>;
            <b>var</b> <span id="r1174 rd" class="r1174 r">dots</span> = <span class="r1173 r">wordToComplete</span>.<span class="i">Count</span>(<b>static</b> <span id="r1175 rd" class="r1175 r">c</span> =&gt; <span class="r1175 r">c</span> == <span class="s">&#39;.&#39;</span>);
            <b>if</b> (<span class="r1174 r">dots</span> &gt;= <span class="r1170 r">localTypeCache</span>.<span class="i">Length</span> || <span class="r1170 r">localTypeCache</span>[<span class="r1174 r">dots</span>] == <b>null</b>)
            {
                <b>return</b> <span class="r1171 r">results</span>;
            }
 
            <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r1176 rd" class="r1176 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r1173 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
            <b>foreach</b> (<b>var</b> <span id="r1177 rd" class="r1177 r">entry</span> <b>in</b> <span class="r1170 r">localTypeCache</span>[<span class="r1174 r">dots</span>].<span class="i">Where</span>(<span id="r1178 rd" class="r1178 r">e</span> =&gt; <span class="r1176 r">pattern</span>.<span class="i">IsMatch</span>(<span class="r1178 r">e</span>.<span class="i">Key</span>)))
            {
                <b>foreach</b> (<b>var</b> <span id="r1179 rd" class="r1179 r">completion</span> <b>in</b> <span class="r1177 r">entry</span>.<span class="i">Completions</span>)
                {
                    <b>string</b> <span id="r1180 rd" class="r1180 r">namespaceToRemove</span> = <span class="i">GetNamespaceToRemove</span>(<span class="r1167 r">context</span>, <span class="r1179 r">completion</span>);
                    <b>var</b> <span id="r1181 rd" class="r1181 r">completionResult</span> = <span class="r1179 r">completion</span>.<span class="i">GetCompletionResult</span>(<span class="r1177 r">entry</span>.<span class="i">Key</span>, <span class="r1168 r">prefix</span>, <span class="r1169 r">suffix</span>, <span class="r1180 r">namespaceToRemove</span>);
 
                    <span class="c">// We might get the same completion result twice. For example, the type cache has:</span>
                    <span class="c">//    DscResource-&gt;System.Management.Automation.DscResourceAttribute (from accelerator)</span>
                    <span class="c">//    DscResourceAttribute-&gt;System.Management.Automation.DscResourceAttribute (from short type name)</span>
                    <span class="c">// input &#39;[DSCRes&#39; can match both of them, but they actually resolves to the same completion text &#39;DscResource&#39;.</span>
                    <b>if</b> (!<span class="r1172 r">completionTextSet</span>.<span class="i">Contains</span>(<span class="r1181 r">completionResult</span>.<span class="i">CompletionText</span>))
                    {
                        <span class="r1171 r">results</span>.<span class="i">Add</span>(<span class="r1181 r">completionResult</span>);
                        <span class="r1172 r">completionTextSet</span>.<span class="i">Add</span>(<span class="r1181 r">completionResult</span>.<span class="i">CompletionText</span>);
                    }
                }
            }
 
            <span class="c">// this is a temporary fix. Only the type defined in the same script get complete. Need to use using Module when that is available.</span>
            <b>if</b> (<span class="r1167 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a> != <b>null</b> &amp;&amp; <span class="r1167 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>.<span class="i">Count</span> &gt; 0)
            {
                <a href="../parser/ast.cs.html#6f963589327835a4" class="k">var</a> <span id="r1182 rd" class="r1182 r">scriptBlockAst</span> = (<a href="../parser/ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a>)<span class="r1167 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>[0];
                <b>var</b> <span id="r1183 rd" class="r1183 r">typeAsts</span> = <span class="r1182 r">scriptBlockAst</span>.<span class="i">FindAll</span>(<b>static</b> <span id="r1184 rd" class="r1184 r">ast</span> =&gt; <span class="r1184 r">ast</span> <b>is</b> <a href="../parser/ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>, <b>false</b>).<span class="i">Cast</span>&lt;<a href="../parser/ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt;();
                <b>foreach</b> (<b>var</b> <span id="r1185 rd" class="r1185 r">typeAst</span> <b>in</b> <span class="r1183 r">typeAsts</span>.<span class="i">Where</span>(<span id="r1186 rd" class="r1186 r">ast</span> =&gt; <span class="r1176 r">pattern</span>.<span class="i">IsMatch</span>(<span class="r1186 r">ast</span>.<span class="i">Name</span>)))
                {
                    <b>string</b> <span id="r1187 rd" class="r1187 r">toolTipPrefix</span> = <b>string</b>.<span class="i">Empty</span>;
                    <b>if</b> (<span class="r1185 r">typeAst</span>.<span class="i">IsInterface</span>)
                        <span class="r1187 r">toolTipPrefix</span> = <span class="s">&quot;Interface &quot;</span>;
                    <b>else</b> <b>if</b> (<span class="r1185 r">typeAst</span>.<span class="i">IsClass</span>)
                        <span class="r1187 r">toolTipPrefix</span> = <span class="s">&quot;Class &quot;</span>;
                    <b>else</b> <b>if</b> (<span class="r1185 r">typeAst</span>.<span class="i">IsEnum</span>)
                        <span class="r1187 r">toolTipPrefix</span> = <span class="s">&quot;Enum &quot;</span>;
 
                    <span class="r1171 r">results</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(<span class="r1168 r">prefix</span> + <span class="r1185 r">typeAst</span>.<span class="i">Name</span> + <span class="r1169 r">suffix</span>, <span class="r1185 r">typeAst</span>.<span class="i">Name</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#46005faf1cdef9c1" class="i field">Type</a>, <span class="r1187 r">toolTipPrefix</span> + <span class="r1185 r">typeAst</span>.<span class="i">Name</span>));
                }
            }
 
            <span class="r1171 r">results</span>.<span class="i">Sort</span>(<b>static</b> (<span id="r1188 rd" class="r1188 r">c1</span>, <span id="r1189 rd" class="r1189 r">c2</span>) =&gt; <b>string</b>.<span class="i">Compare</span>(<span class="r1188 r">c1</span>.<span class="i">ListItemText</span>, <span class="r1189 r">c2</span>.<span class="i">ListItemText</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
            <b>return</b> <span class="r1171 r">results</span>;
        }
 
        <b>private static string</b> <a id="72118feec50370e4" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetNamespaceToRemove</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r1190 rd" class="r1190 r">context</span>, <a href="#bd5c32e26e01d827" class="t t">TypeCompletionBase</a> <span id="r1191 rd" class="r1191 r">completion</span>)
        {
            <b>if</b> (<span class="r1191 r">completion</span> <b>is</b> <a href="#f863c1b65dc66612" class="t t">NamespaceCompletion</a> || <span class="r1190 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a> == <b>null</b> || <span class="r1190 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="#051ba16176027beb" class="k">var</a> <span id="r1192 rd" class="r1192 r">typeCompletion</span> = <span class="r1191 r">completion</span> <b>as</b> <a href="#051ba16176027beb" class="t t">TypeCompletion</a>;
            <b>string</b> <span id="r1193 rd" class="r1193 r">typeNameSpace</span> = <span class="r1192 r">typeCompletion</span> != <b>null</b>
                                       ? <span class="r1192 r">typeCompletion</span>.<a href="#2c3a0ffb83f6fcfb" class="i field">Type</a>.<span class="i">Namespace</span>
                                       : ((<a href="#de928d2f7700de02" class="t t">TypeCompletionInStringFormat</a>)<span class="r1191 r">completion</span>).<a href="#333d526590fe4b42" class="i property">Namespace</a>;
 
            <a href="../parser/ast.cs.html#6f963589327835a4" class="k">var</a> <span id="r1194 rd" class="r1194 r">scriptBlockAst</span> = (<a href="../parser/ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a>)<span class="r1190 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>[0];
            <b>var</b> <span id="r1195 rd" class="r1195 r">matchingNsStates</span> = <span class="r1194 r">scriptBlockAst</span>.<a href="../parser/ast.cs.html#c707ba0b01460c10" class="i property">UsingStatements</a>.<span class="i">Where</span>(<span id="r1196 rd" class="r1196 r">s</span> =&gt;
                 <span class="r1196 r">s</span>.<span class="i">UsingStatementKind</span> == <a href="../parser/ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="../parser/ast.cs.html#8c39b25da17c5e31" class="i field">Namespace</a>
                 &amp;&amp; <span class="r1193 r">typeNameSpace</span> != <b>null</b>
                 &amp;&amp; <span class="r1193 r">typeNameSpace</span>.<span class="i">StartsWith</span>(<span class="r1196 r">s</span>.<span class="i">Name</span>.<span class="i">Value</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
 
            <b>string</b> <span id="r1197 rd" class="r1197 r">ns</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>foreach</b> (<b>var</b> <span id="r1198 rd" class="r1198 r">nsState</span> <b>in</b> <span class="r1195 r">matchingNsStates</span>)
            {
                <b>if</b> (<span class="r1198 r">nsState</span>.<span class="i">Name</span>.<span class="i">Extent</span>.<span class="i">Text</span>.<span class="i">Length</span> &gt; <span class="r1197 r">ns</span>.<span class="i">Length</span>)
                {
                    <span class="r1197 r">ns</span> = <span class="r1198 r">nsState</span>.<span class="i">Name</span>.<span class="i">Extent</span>.<span class="i">Text</span>;
                }
            }
 
            <b>return</b> <span class="r1197 r">ns</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Types
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Help Topics
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="9866247c8183a354" href="../../R/9866247c8183a354.html" target="n" data-glyph="74,1" class="i method">CompleteHelpTopics</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r1199 rd" class="r1199 r">context</span>)
        {
            <b>var</b> <span id="r1200 rd" class="r1200 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
            <b>string</b> <span id="r1201 rd" class="r1201 r">userHelpDir</span> = <a href="../../help/HelpUtils.cs.html#2a2e2f95cc938568" class="t t">HelpUtils</a>.<a href="../../help/HelpUtils.cs.html#7fc28a2723390ba9" class="i method">GetUserHomeHelpSearchPath</a>();
            <b>string</b> <span id="r1202 rd" class="r1202 r">appHelpDir</span> = <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#78d6f695d9d21e06" class="i method">GetApplicationBase</a>(<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#afe3ed92dba2b2b0" class="i field">DefaultPowerShellShellID</a>);
            <b>string</b> <span id="r1203 rd" class="r1203 r">currentCulture</span> = <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>.<span class="i">Name</span>;
 
            <span class="c">//search for help files for the current culture + en-US as fallback</span>
            <b>var</b> <span id="r1204 rd" class="r1204 r">searchPaths</span> = <b>new</b> <b>string</b>[]
            {
                <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r1201 r">userHelpDir</span>, <span class="r1203 r">currentCulture</span>),
                <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r1202 r">appHelpDir</span>, <span class="r1203 r">currentCulture</span>),
                <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r1201 r">userHelpDir</span>, <span class="s">&quot;en-US&quot;</span>),
                <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r1202 r">appHelpDir</span>, <span class="s">&quot;en-US&quot;</span>)
            }.<span class="i">Distinct</span>();
 
            <b>string</b> <span id="r1205 rd" class="r1205 r">wordToComplete</span> = <span class="r1199 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> + <span class="s">&quot;*&quot;</span>;
            <b>try</b>
            {
                <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r1206 rd" class="r1206 r">wildcardPattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r1205 r">wordToComplete</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
 
                <b>foreach</b> (<b>var</b> <span id="r1207 rd" class="r1207 r">dir</span> <b>in</b> <span class="r1204 r">searchPaths</span>)
                {
                    <b>var</b> <span id="r1208 rd" class="r1208 r">currentDir</span> = <b>new</b> <span class="i">DirectoryInfo</span>(<span class="r1207 r">dir</span>);
                    <b>if</b> (<span class="r1208 r">currentDir</span>.<span class="i">Exists</span>)
                    {
                        <b>foreach</b> (<b>var</b> <span id="r1209 rd" class="r1209 r">file</span> <b>in</b> <span class="r1208 r">currentDir</span>.<span class="i">EnumerateFiles</span>(<span class="s">&quot;about_*.help.txt&quot;</span>))
                        {
                            <b>if</b> (<span class="r1206 r">wildcardPattern</span>.<span class="i">IsMatch</span>(<span class="r1209 r">file</span>.<span class="i">Name</span>))
                            {
                                <b>string</b> <span id="r1210 rd" class="r1210 r">topicName</span> = <span class="r1209 r">file</span>.<span class="i">Name</span>.<span class="i">Substring</span>(0, <span class="r1209 r">file</span>.<span class="i">Name</span>.<span class="i">LastIndexOf</span>(<span class="s">&quot;.help.txt&quot;</span>));
                                <span class="r1200 r">results</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#56c384dfa9027ed2" class="t constructor">CompletionResult</a>(<span class="r1210 r">topicName</span>));
                            }
                        }
                    }
                }
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
            }
            <b>return</b> <span class="r1200 r">results</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Help Topics
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Statement Parameters
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="edc9a29b37eca791" href="../../R/edc9a29b37eca791.html" target="n" data-glyph="74,1" class="i method">CompleteStatementFlags</a>(<a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r1211 rd" class="r1211 r">kind</span>, <b>string</b> <span id="r1212 rd" class="r1212 r">wordToComplete</span>)
        {
            <b>switch</b> (<span class="r1211 r">kind</span>)
            {
                <b>case</b> <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#16bd62526b80a3f2" class="i field">Switch</a>:
 
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1212 r">wordToComplete</span>) &amp;&amp; <span class="r1212 r">wordToComplete</span>[0].<span class="i">IsDash</span>(), <span class="s">&quot;the word to complete should start with &#39;-&#39;&quot;</span>);
                    <span class="r1212 r">wordToComplete</span> = <span class="r1212 r">wordToComplete</span>.<span class="i">Substring</span>(1);
                    <b>bool</b> <span id="r1213 rd" class="r1213 r">withColon</span> = <span class="r1212 r">wordToComplete</span>.<span class="i">EndsWith</span>(<span class="s">&#39;:&#39;</span>);
                    <span class="r1212 r">wordToComplete</span> = <span class="r1213 r">withColon</span> ? <span class="r1212 r">wordToComplete</span>.<span class="i">Remove</span>(<span class="r1212 r">wordToComplete</span>.<span class="i">Length</span> - 1) : <span class="r1212 r">wordToComplete</span>;
 
                    <b>string</b> <span id="r1214 rd" class="r1214 r">enumString</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#ca4f496a5bed30f5" class="t t">EnumSingleTypeConverter</a>.<span class="i">EnumValues</span>(<b>typeof</b>(<a href="../parser/ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>));
                    <b>string</b> <span id="r1215 rd" class="r1215 r">separator</span> = <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>.<span class="i">TextInfo</span>.<span class="i">ListSeparator</span>;
                    <b>string</b>[] <span id="r1216 rd" class="r1216 r">enumArray</span> = <span class="r1214 r">enumString</span>.<span class="i">Split</span>(<span class="r1215 r">separator</span>, <span class="i">StringSplitOptions</span>.<span class="i">RemoveEmptyEntries</span>);
 
                    <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r1217 rd" class="r1217 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r1212 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                    <b>var</b> <span id="r1218 rd" class="r1218 r">enumList</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
                    <b>var</b> <span id="r1219 rd" class="r1219 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
                    <a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a> <span id="r1220 rd" class="r1220 r">fullMatch</span> = <b>null</b>;
 
                    <b>foreach</b> (<b>string</b> <span id="r1221 rd" class="r1221 r">value</span> <b>in</b> <span class="r1216 r">enumArray</span>)
                    {
                        <b>if</b> (<span class="r1221 r">value</span>.<span class="i">Equals</span>(<a href="../parser/ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="../parser/ast.cs.html#c295735669134c1e" class="i field">None</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)) { <b>continue</b>; }
 
                        <b>if</b> (<span class="r1212 r">wordToComplete</span>.<span class="i">Equals</span>(<span class="r1221 r">value</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>string</b> <span id="r1222 rd" class="r1222 r">completionText</span> = <span class="r1213 r">withColon</span> ? <span class="s">&quot;-&quot;</span> + <span class="r1221 r">value</span> + <span class="s">&quot;:&quot;</span> : <span class="s">&quot;-&quot;</span> + <span class="r1221 r">value</span>;
                            <span class="r1220 r">fullMatch</span> = <b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r1222 r">completionText</span>, <span class="r1221 r">value</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#c4ba8e90b3cad3b3" class="i field">ParameterName</a>, <span class="r1221 r">value</span>);
                            <b>continue</b>;
                        }
 
                        <b>if</b> (<span class="r1217 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r1221 r">value</span>))
                        {
                            <span class="r1218 r">enumList</span>.<span class="i">Add</span>(<span class="r1221 r">value</span>);
                        }
                    }
 
                    <b>if</b> (<span class="r1220 r">fullMatch</span> != <b>null</b>)
                    {
                        <span class="r1219 r">result</span>.<span class="i">Add</span>(<span class="r1220 r">fullMatch</span>);
                    }
 
                    <span class="r1218 r">enumList</span>.<span class="i">Sort</span>();
                    <span class="r1219 r">result</span>.<span class="i">AddRange</span>(<b>from</b> <span class="i">entry</span> <b>in</b> <span class="r1218 r">enumList</span>
                                    <b>let</b> <span class="i">completionText</span> = <span class="r1213 r">withColon</span> ? <span class="s">&quot;-&quot;</span> + <span class="i">entry</span> + <span class="s">&quot;:&quot;</span> : <span class="s">&quot;-&quot;</span> + <span class="i">entry</span>
                                    <b>select</b> <b>new</b> <span class="t">CompletionResult</span>(<span class="i">completionText</span>, <span class="i">entry</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#c4ba8e90b3cad3b3" class="i field">ParameterName</a>, <span class="i">entry</span>));
 
                    <b>return</b> <span class="r1219 r">result</span>;
 
                <b>default</b>:
                    <b>break</b>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Statement Parameters
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Hashtable Keys
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Generate auto complete results for hashtable key within a Dynamickeyword.</span>
        <span class="c">///</span><span class="c"> Results are generated based on properties of a DynamicKeyword matches given identifier.</span>
        <span class="c">///</span><span class="c"> For example, following &quot;D&quot; matches &quot;DestinationPath&quot;</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">     Configuration</span>
        <span class="c">///</span><span class="c">     {</span>
        <span class="c">///</span><span class="c">         File</span>
        <span class="c">///</span><span class="c">         {</span>
        <span class="c">///</span><span class="c">             D^</span>
        <span class="c">///</span><span class="c">         }</span>
        <span class="c">///</span><span class="c">     }</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1223 r">completionContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1224 r">ast</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1225 r">hashtableAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="adfb823de1b22f3f" href="../../R/adfb823de1b22f3f.html" target="n" data-glyph="74,1" class="i method">CompleteHashtableKeyForDynamicKeyword</a>(
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r1223 rd" class="r1223 r">completionContext</span>,
            <a href="../parser/ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a> <span id="r1224 rd" class="r1224 r">ast</span>,
            <a href="../parser/ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r1225 rd" class="r1225 r">hashtableAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r1224 r">ast</span>.<a href="../parser/ast.cs.html#0f0688a599c6de89" class="i property">Keyword</a> != <b>null</b>, <span class="s">&quot;DynamicKeywordStatementAst.Keyword can never be null&quot;</span>);
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r1226 rd" class="r1226 r">results</span> = <b>null</b>;
            <b>var</b> <span id="r1227 rd" class="r1227 r">dynamicKeywordProperties</span> = <span class="r1224 r">ast</span>.<a href="../parser/ast.cs.html#0f0688a599c6de89" class="i property">Keyword</a>.<a href="../parser/tokenizer.cs.html#5381d21bcf0af976" class="i property">Properties</a>;
            <b>var</b> <span id="r1228 rd" class="r1228 r">memberPattern</span> = <span class="r1223 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> + <span class="s">&quot;*&quot;</span>;
 
            <span class="c">//</span>
            <span class="c">// Capture all existing properties in hashtable</span>
            <span class="c">//</span>
            <b>var</b> <span id="r1229 rd" class="r1229 r">propertiesName</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <b>int</b> <span id="r1230 rd" class="r1230 r">cursorOffset</span> = <span class="r1223 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#cf83a017dd6fc3e8" class="i property">CursorPosition</a>.<a href="../parser/Position.cs.html#cd3280d5f1045b06" class="i property">Offset</a>;
            <b>foreach</b> (<b>var</b> <span id="r1231 rd" class="r1231 r">keyValueTuple</span> <b>in</b> <span class="r1225 r">hashtableAst</span>.<a href="../parser/ast.cs.html#87313f35bc2b66d9" class="i property">KeyValuePairs</a>)
            {
                <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r1232 rd" class="r1232 r">propName</span> = <span class="r1231 r">keyValueTuple</span>.<span class="i">Item1</span> <b>as</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                <span class="c">// Exclude the property name at cursor</span>
                <b>if</b> (<span class="r1232 r">propName</span> != <b>null</b> &amp;&amp; <span class="r1232 r">propName</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a> != <span class="r1230 r">cursorOffset</span>)
                {
                    <span class="r1229 r">propertiesName</span>.<span class="i">Add</span>(<span class="r1232 r">propName</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>);
                }
            }
 
            <b>if</b> (<span class="r1227 r">dynamicKeywordProperties</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// Excludes existing properties in the hashtable statement</span>
                <b>var</b> <span id="r1233 rd" class="r1233 r">tempProperties</span> = <span class="r1227 r">dynamicKeywordProperties</span>.<span class="i">Where</span>(<span id="r1234 rd" class="r1234 r">p</span> =&gt; !<span class="r1229 r">propertiesName</span>.<span class="i">Contains</span>(<span class="r1234 r">p</span>.<span class="i">Key</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>));
                <b>if</b> (<span class="r1233 r">tempProperties</span> != <b>null</b> &amp;&amp; <span class="r1233 r">tempProperties</span>.<span class="i">Any</span>())
                {
                    <span class="r1226 r">results</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
                    <span class="c">// Filter by name</span>
                    <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r1235 rd" class="r1235 r">wildcardPattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<span class="i">Get</span>(<span class="r1228 r">memberPattern</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                    <b>var</b> <span id="r1236 rd" class="r1236 r">matchedResults</span> = <span class="r1233 r">tempProperties</span>.<span class="i">Where</span>(<span id="r1237 rd" class="r1237 r">p</span> =&gt; <span class="r1235 r">wildcardPattern</span>.<span class="i">IsMatch</span>(<span class="r1237 r">p</span>.<span class="i">Key</span>));
                    <b>if</b> (<span class="r1236 r">matchedResults</span> == <b>null</b> || !<span class="r1236 r">matchedResults</span>.<span class="i">Any</span>())
                    {
                        <span class="c">// Fallback to all non-exist properties in the hashtable statement</span>
                        <span class="r1236 r">matchedResults</span> = <span class="r1233 r">tempProperties</span>;
                    }
 
                    <b>foreach</b> (<b>var</b> <span id="r1238 rd" class="r1238 r">p</span> <b>in</b> <span class="r1236 r">matchedResults</span>)
                    {
                        <b>string</b> <span id="r1239 rd" class="r1239 r">psTypeName</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTypeNameToPSTypeName</span>(<span class="r1238 r">p</span>.<span class="i">Value</span>.<span class="i">TypeConstraint</span>);
                        <b>if</b> (<span class="r1239 r">psTypeName</span> == <span class="s">&quot;[]&quot;</span> || <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1239 r">psTypeName</span>))
                        {
                            <span class="r1239 r">psTypeName</span> = <span class="s">&quot;[&quot;</span> + <span class="r1238 r">p</span>.<span class="i">Value</span>.<span class="i">TypeConstraint</span> + <span class="s">&quot;]&quot;</span>;
                        }
 
                        <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r1239 r">psTypeName</span>, <span class="s">&quot;[MSFT_Credential]&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="r1239 r">psTypeName</span> = <span class="s">&quot;[pscredential]&quot;</span>;
                        }
 
                        <span class="r1226 r">results</span>.<span class="i">Add</span>(<b>new</b> <span class="t">CompletionResult</span>(
                            <span class="r1238 r">p</span>.<span class="i">Key</span> + <span class="s">&quot; = &quot;</span>,
                            <span class="r1238 r">p</span>.<span class="i">Key</span>,
                            <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#bad7fb67c06b9e4e" class="i field">Property</a>,
                            <span class="r1239 r">psTypeName</span>));
                    }
                }
            }
 
            <b>return</b> <span class="r1226 r">results</span>;
        }
 
        <b>internal static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="dffbec9e850a0d5a" href="../../R/dffbec9e850a0d5a.html" target="n" data-glyph="74,1" class="i method">CompleteHashtableKey</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r1240 rd" class="r1240 r">completionContext</span>, <a href="../parser/ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r1241 rd" class="r1241 r">hashtableAst</span>)
        {
            <a href="../parser/ast.cs.html#49daf252fdb62723" class="k">var</a> <span id="r1242 rd" class="r1242 r">typeAst</span> = <span class="r1241 r">hashtableAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="../parser/ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a>;
            <b>if</b> (<span class="r1242 r">typeAst</span> != <b>null</b>)
            {
                <b>var</b> <span id="r1243 rd" class="r1243 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
                <span class="i">CompleteMemberByInferredType</span>(
                    <span class="r1240 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#95d0769179a8633b" class="i property">TypeInferenceContext</a>, <a href="../parser/TypeInferenceVisitor.cs.html#85308821e258515b" class="t t">AstTypeInference</a>.<a href="../parser/TypeInferenceVisitor.cs.html#a161c4fce43bc728" class="i method">InferTypeOf</a>(<span class="r1242 r">typeAst</span>, <span class="r1240 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#95d0769179a8633b" class="i property">TypeInferenceContext</a>, <a href="../parser/TypeInferenceVisitor.cs.html#c79f5fa1494e528d" class="t t">TypeInferenceRuntimePermissions</a>.<a href="../parser/TypeInferenceVisitor.cs.html#8df46f8adea8c4e2" class="i field">AllowSafeEval</a>),
                    <span class="r1243 r">result</span>, <span class="r1240 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> + <span class="s">&quot;*&quot;</span>, <span class="i">IsWriteablePropertyMember</span>, <span class="i">isStatic</span>: <b>false</b>);
                <b>return</b> <span class="r1243 r">result</span>;
            }
 
            <span class="c">// hashtable arguments sometimes have expected keys.  Examples:</span>
            <span class="c">//   new-object System.Drawing.Point -prop @{ X=1; Y=1 }</span>
            <span class="c">//   dir | sort-object -prop @{Expression=...   ; Ascending=... }</span>
            <span class="c">// format-table -Property</span>
            <span class="c">//     Expression</span>
            <span class="c">//     FormatString</span>
            <span class="c">//     Label</span>
            <span class="c">//     Width</span>
            <span class="c">//     Alignment</span>
            <span class="c">// format-list -Property</span>
            <span class="c">//     Expression</span>
            <span class="c">//     FormatString</span>
            <span class="c">//     Label</span>
            <span class="c">// format-custom -Property</span>
            <span class="c">//     Expression</span>
            <span class="c">//     Depth</span>
            <span class="c">// format-* -GroupBy</span>
            <span class="c">//     Expression</span>
            <span class="c">//     FormatString</span>
            <span class="c">//     Label</span>
            <span class="c">//</span>
 
            <span class="c">// Find out if we are in a command argument.  Consider the following possibilities:</span>
            <span class="c">//     cmd @{}</span>
            <span class="c">//     cmd -foo @{}</span>
            <span class="c">//     cmd -foo:@{}</span>
            <span class="c">//     cmd @{},@{}</span>
            <span class="c">//     cmd -foo @{},@{}</span>
            <span class="c">//     cmd -foo:@{},@{}</span>
 
            <a href="../parser/ast.cs.html#d47621d83efd14de" class="k">var</a> <span id="r1244 rd" class="r1244 r">ast</span> = <span class="r1241 r">hashtableAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
 
            <span class="c">// Handle completion for hashtable within DynamicKeyword statement</span>
            <a href="../parser/ast.cs.html#2c7580ec5eda8932" class="k">var</a> <span id="r1245 rd" class="r1245 r">dynamicKeywordStatementAst</span> = <span class="r1244 r">ast</span> <b>as</b> <a href="../parser/ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a>;
            <b>if</b> (<span class="r1245 r">dynamicKeywordStatementAst</span> != <b>null</b>)
            {
                <b>return</b> <a href="#adfb823de1b22f3f" class="i method">CompleteHashtableKeyForDynamicKeyword</a>(<span class="r1240 r">completionContext</span>, <span class="r1245 r">dynamicKeywordStatementAst</span>, <span class="r1241 r">hashtableAst</span>);
            }
 
            <b>if</b> (<span class="r1244 r">ast</span> <b>is</b> <a href="../parser/ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>)
            {
                <span class="r1244 r">ast</span> = <span class="r1244 r">ast</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
            }
 
            <b>if</b> (<span class="r1244 r">ast</span> <b>is</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>)
            {
                <span class="r1244 r">ast</span> = <span class="r1244 r">ast</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
            }
 
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="k">var</a> <span id="r1246 rd" class="r1246 r">commandAst</span> = <span class="r1244 r">ast</span> <b>as</b> <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>;
            <b>if</b> (<span class="r1246 r">commandAst</span> != <b>null</b>)
            {
                <a href="PseudoParameterBinder.cs.html#5ac9244be24c2bbd" class="k">var</a> <span id="r1247 rd" class="r1247 r">binding</span> = <b>new</b> <span class="t">PseudoParameterBinder</span>().<a href="PseudoParameterBinder.cs.html#4f331f824f2a1e35" class="i method">DoPseudoParameterBinding</a>(<span class="r1246 r">commandAst</span>, <b>null</b>, <b>null</b>, <span class="r1248 r">bindingType</span>: <a href="PseudoParameterBinder.cs.html#9dc50bf5ddf87930" class="t t">PseudoParameterBinder</a>.<a href="PseudoParameterBinder.cs.html#ad6e81c17c696e75" class="t t">BindingType</a>.<a href="PseudoParameterBinder.cs.html#240740e6b3591d03" class="i field">ArgumentCompletion</a>);
                <b>if</b> (<span class="r1247 r">binding</span> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>string</b> <span id="r1249 rd" class="r1249 r">parameterName</span> = <b>null</b>;
                <b>foreach</b> (<b>var</b> <span id="r1250 rd" class="r1250 r">boundArg</span> <b>in</b> <span class="r1247 r">binding</span>.<a href="PseudoParameterBinder.cs.html#0890fafe524fd733" class="i property">BoundArguments</a>)
                {
                    <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="k">var</a> <span id="r1251 rd" class="r1251 r">astPair</span> = <span class="r1250 r">boundArg</span>.<span class="i">Value</span> <b>as</b> <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a>;
                    <b>if</b> (<span class="r1251 r">astPair</span> != <b>null</b>)
                    {
                        <b>if</b> (<span class="r1251 r">astPair</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a> == <span class="r1241 r">hashtableAst</span>)
                        {
                            <span class="r1249 r">parameterName</span> = <span class="r1250 r">boundArg</span>.<span class="i">Key</span>;
                            <b>break</b>;
                        }
 
                        <b>continue</b>;
                    }
 
                    <a href="PseudoParameterBinder.cs.html#d3a0a7f99c8105c4" class="k">var</a> <span id="r1252 rd" class="r1252 r">astArrayPair</span> = <span class="r1250 r">boundArg</span>.<span class="i">Value</span> <b>as</b> <a href="PseudoParameterBinder.cs.html#d3a0a7f99c8105c4" class="t t">AstArrayPair</a>;
                    <b>if</b> (<span class="r1252 r">astArrayPair</span> != <b>null</b>)
                    {
                        <b>if</b> (<span class="r1252 r">astArrayPair</span>.<a href="PseudoParameterBinder.cs.html#5ea2ac266039b42b" class="i property">Argument</a>.<span class="i">Contains</span>(<span class="r1241 r">hashtableAst</span>))
                        {
                            <span class="r1249 r">parameterName</span> = <span class="r1250 r">boundArg</span>.<span class="i">Key</span>;
                            <b>break</b>;
                        }
 
                        <b>continue</b>;
                    }
                }
 
                <b>if</b> (<span class="r1249 r">parameterName</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r1249 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;GroupBy&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>switch</b> (<span class="r1247 r">binding</span>.<a href="PseudoParameterBinder.cs.html#8a99b7a836aade94" class="i property">CommandName</a>)
                        {
                            <b>case</b> <span class="s">&quot;Format-Table&quot;</span>:
                            <b>case</b> <span class="s">&quot;Format-List&quot;</span>:
                            <b>case</b> <span class="s">&quot;Format-Wide&quot;</span>:
                            <b>case</b> <span class="s">&quot;Format-Custom&quot;</span>:
                                <b>return</b> <a href="#11438dde5e049421" class="i method">GetSpecialHashTableKeyMembers</a>(<span class="s">&quot;Expression&quot;</span>, <span class="s">&quot;FormatString&quot;</span>, <span class="s">&quot;Label&quot;</span>);
                        }
 
                        <b>return</b> <b>null</b>;
                    }
 
                    <b>if</b> (<span class="r1249 r">parameterName</span>.<span class="i">Equals</span>(<span class="s">&quot;Property&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <b>switch</b> (<span class="r1247 r">binding</span>.<a href="PseudoParameterBinder.cs.html#8a99b7a836aade94" class="i property">CommandName</a>)
                        {
                            <b>case</b> <span class="s">&quot;New-Object&quot;</span>:
                                <b>var</b> <span id="r1253 rd" class="r1253 r">inferredType</span> = <a href="../parser/TypeInferenceVisitor.cs.html#85308821e258515b" class="t t">AstTypeInference</a>.<a href="../parser/TypeInferenceVisitor.cs.html#a161c4fce43bc728" class="i method">InferTypeOf</a>(<span class="r1246 r">commandAst</span>, <span class="r1240 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#95d0769179a8633b" class="i property">TypeInferenceContext</a>, <a href="../parser/TypeInferenceVisitor.cs.html#c79f5fa1494e528d" class="t t">TypeInferenceRuntimePermissions</a>.<a href="../parser/TypeInferenceVisitor.cs.html#8df46f8adea8c4e2" class="i field">AllowSafeEval</a>);
                                <b>var</b> <span id="r1254 rd" class="r1254 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
                                <span class="i">CompleteMemberByInferredType</span>(
                                    <span class="r1240 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#95d0769179a8633b" class="i property">TypeInferenceContext</a>, <span class="r1253 r">inferredType</span>,
                                    <span class="r1254 r">result</span>, <span class="r1240 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a> + <span class="s">&quot;*&quot;</span>, <span class="i">IsWriteablePropertyMember</span>, <span class="i">isStatic</span>: <b>false</b>);
                                <b>return</b> <span class="r1254 r">result</span>;
                            <b>case</b> <span class="s">&quot;Select-Object&quot;</span>:
                                <b>return</b> <a href="#11438dde5e049421" class="i method">GetSpecialHashTableKeyMembers</a>(<span class="s">&quot;Name&quot;</span>, <span class="s">&quot;Expression&quot;</span>);
                            <b>case</b> <span class="s">&quot;Sort-Object&quot;</span>:
                                <b>return</b> <a href="#11438dde5e049421" class="i method">GetSpecialHashTableKeyMembers</a>(<span class="s">&quot;Expression&quot;</span>, <span class="s">&quot;Ascending&quot;</span>, <span class="s">&quot;Descending&quot;</span>);
                            <b>case</b> <span class="s">&quot;Group-Object&quot;</span>:
                                <b>return</b> <a href="#11438dde5e049421" class="i method">GetSpecialHashTableKeyMembers</a>(<span class="s">&quot;Expression&quot;</span>);
                            <b>case</b> <span class="s">&quot;Format-Table&quot;</span>:
                                <b>return</b> <a href="#11438dde5e049421" class="i method">GetSpecialHashTableKeyMembers</a>(<span class="s">&quot;Expression&quot;</span>, <span class="s">&quot;FormatString&quot;</span>, <span class="s">&quot;Label&quot;</span>, <span class="s">&quot;Width&quot;</span>, <span class="s">&quot;Alignment&quot;</span>);
                            <b>case</b> <span class="s">&quot;Format-List&quot;</span>:
                                <b>return</b> <a href="#11438dde5e049421" class="i method">GetSpecialHashTableKeyMembers</a>(<span class="s">&quot;Expression&quot;</span>, <span class="s">&quot;FormatString&quot;</span>, <span class="s">&quot;Label&quot;</span>);
                            <b>case</b> <span class="s">&quot;Format-Wide&quot;</span>:
                                <b>return</b> <a href="#11438dde5e049421" class="i method">GetSpecialHashTableKeyMembers</a>(<span class="s">&quot;Expression&quot;</span>, <span class="s">&quot;FormatString&quot;</span>);
                            <b>case</b> <span class="s">&quot;Format-Custom&quot;</span>:
                                <b>return</b> <a href="#11438dde5e049421" class="i method">GetSpecialHashTableKeyMembers</a>(<span class="s">&quot;Expression&quot;</span>, <span class="s">&quot;Depth&quot;</span>);
                        }
                    }
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a id="11438dde5e049421" href="../../R/11438dde5e049421.html" target="n" data-glyph="76,1" class="i method">GetSpecialHashTableKeyMembers</a>(<b>params string</b>[] <span id="r1255 rd" class="r1255 r">keys</span>)
        {
            <span class="c">// Resources were removed because they missed the deadline for loc.</span>
            <span class="c">// return keys.Select(key =&gt; new CompletionResult(key, key, CompletionResultType.Property,</span>
            <span class="c">//    ResourceManagerCache.GetResourceString(typeof(CompletionCompleters).Assembly,</span>
            <span class="c">//                                           &quot;TabCompletionStrings&quot;, key + &quot;HashKeyDescription&quot;))).ToList();</span>
            <b>return</b> <span class="r1255 r">keys</span>.<span class="i">Select</span>(<b>static</b> <span id="r1256 rd" class="r1256 r">key</span> =&gt; <b>new</b> <span class="t">CompletionResult</span>(<span class="r1256 r">key</span>, <span class="r1256 r">key</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#bad7fb67c06b9e4e" class="i field">Property</a>, <span class="r1256 r">key</span>)).<span class="i">ToList</span>();
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Hashtable Keys
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Helpers
 
        <b>internal static bool</b> <a id="43cc4ec4c59478b8" href="../../R/43cc4ec4c59478b8.html" target="n" data-glyph="74,1" class="i method">IsPathSafelyExpandable</a>(<a href="../parser/ast.cs.html#dac25e1530bb8b85" class="t t">ExpandableStringExpressionAst</a> <span id="r209 rd" class="r209 r">expandableStringAst</span>, <b>string</b> <span id="r210 rd" class="r210 r">extraText</span>, <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r211 rd" class="r211 r">executionContext</span>, <b>out string</b> <span id="r212 rd" class="r212 r">expandedString</span>)
        {
            <span class="r212 r">expandedString</span> = <b>null</b>;
            <span class="c">// Expand the string if its type is DoubleQuoted or BareWord</span>
            <a href="../parser/ast.cs.html#9280da14e6db65ed" class="k">var</a> <span id="r1257 rd" class="r1257 r">constType</span> = <span class="r209 r">expandableStringAst</span>.<a href="../parser/ast.cs.html#65d512276737c07d" class="i property">StringConstantType</a>;
            <b>if</b> (<span class="r1257 r">constType</span> == <a href="../parser/ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="../parser/ast.cs.html#7d8b29b78e0d555b" class="i field">DoubleQuotedHereString</a>) { <b>return</b> <b>false</b>; }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r1257 r">constType</span> == <a href="../parser/ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="../parser/ast.cs.html#7902d7b060b16556" class="i field">BareWord</a> ||
                (<span class="r1257 r">constType</span> == <a href="../parser/ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="../parser/ast.cs.html#f67f871ab7fadb8a" class="i field">DoubleQuoted</a> &amp;&amp; <span class="r209 r">expandableStringAst</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>[0].<span class="i">IsDoubleQuote</span>()),
                <span class="s">&quot;the string to be expanded should be either BareWord or DoubleQuoted&quot;</span>);
 
            <b>var</b> <span id="r1258 rd" class="r1258 r">varValues</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <b>foreach</b> (<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r1259 rd" class="r1259 r">nestedAst</span> <b>in</b> <span class="r209 r">expandableStringAst</span>.<a href="../parser/ast.cs.html#7a52821c53f08528" class="i property">NestedExpressions</a>)
            {
                <b>if</b> (!(<span class="r1259 r">nestedAst</span> <b>is</b> <a href="../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r1260 rd" class="r1260 r">variableAst</span>)) { <b>return</b> <b>false</b>; }
 
                <b>string</b> <span id="r1261 rd" class="r1261 r">strValue</span> = <a href="#f539e39d020bfd17" class="i method">CombineVariableWithPartialPath</a>(<span class="r1260 r">variableAst</span>, <b>null</b>, <span class="r211 r">executionContext</span>);
                <b>if</b> (<span class="r1261 r">strValue</span> != <b>null</b>)
                {
                    <span class="r1258 r">varValues</span>.<span class="i">Add</span>(<span class="r1261 r">strValue</span>);
                }
                <b>else</b>
                {
                    <b>return</b> <b>false</b>;
                }
            }
 
            <b>var</b> <span id="r1262 rd" class="r1262 r">formattedString</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="r209 r">expandableStringAst</span>.<a href="../parser/ast.cs.html#b2f43eb7778a1d9a" class="i property">FormatExpression</a>, <span class="r1258 r">varValues</span>.<span class="i">ToArray</span>());
            <b>string</b> <span id="r1263 rd" class="r1263 r">quote</span> = (<span class="r1257 r">constType</span> == <a href="../parser/ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="../parser/ast.cs.html#f67f871ab7fadb8a" class="i field">DoubleQuoted</a>) ? <span class="s">&quot;\&quot;&quot;</span> : <b>string</b>.<span class="i">Empty</span>;
 
            <span class="r212 r">expandedString</span> = <span class="r1263 r">quote</span> + <span class="r1262 r">formattedString</span> + <span class="r210 r">extraText</span> + <span class="r1263 r">quote</span>;
            <b>return</b> <b>true</b>;
        }
 
        <b>internal static string</b> <a id="f539e39d020bfd17" href="../../R/f539e39d020bfd17.html" target="n" data-glyph="74,1" class="i method">CombineVariableWithPartialPath</a>(<a href="../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r1264 rd" class="r1264 r">variableAst</span>, <b>string</b> <span id="r1265 rd" class="r1265 r">extraText</span>, <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r1266 rd" class="r1266 r">executionContext</span>)
        {
            <a href="../VariablePath.cs.html#41e5b41974741cc5" class="k">var</a> <span id="r1267 rd" class="r1267 r">varPath</span> = <span class="r1264 r">variableAst</span>.<a href="../parser/ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>;
            <b>if</b> (<span class="r1267 r">varPath</span>.<a href="../VariablePath.cs.html#6af6d06d3e3c5d67" class="i property">IsVariable</a> || <span class="r1267 r">varPath</span>.<a href="../VariablePath.cs.html#88c3e3f5b3aa0d19" class="i property">DriveName</a>.<span class="i">Equals</span>(<span class="s">&quot;env&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>try</b>
                {
                    <span class="c">// We check the strict mode inside GetVariableValue</span>
                    <b>object</b> <span id="r1268 rd" class="r1268 r">value</span> = <a href="../runtime/Operations/VariableOps.cs.html#d5ccea9fa7bfb556" class="t t">VariableOps</a>.<a href="../runtime/Operations/VariableOps.cs.html#95ebbb7039f5ef2d" class="i method">GetVariableValue</a>(<span class="r1267 r">varPath</span>, <span class="r1266 r">executionContext</span>, <span class="r1264 r">variableAst</span>);
                    <b>var</b> <span id="r1269 rd" class="r1269 r">strValue</span> = (<span class="r1268 r">value</span> == <b>null</b>) ? <b>string</b>.<span class="i">Empty</span> : <span class="r1268 r">value</span> <b>as string</b>;
 
                    <b>if</b> (<span class="r1269 r">strValue</span> == <b>null</b>)
                    {
                        <b>object</b> <span id="r1270 rd" class="r1270 r">baseObj</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1268 r">value</span>);
                        <b>if</b> (<span class="r1270 r">baseObj</span> <b>is string</b> || <span class="r1270 r">baseObj</span>.<span class="i">GetType</span>().<span class="i">IsPrimitive</span>)
                        {
                            <span class="r1269 r">strValue</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<b>string</b>&gt;(<span class="r1268 r">value</span>);
                        }
                    }
 
                    <b>if</b> (<span class="r1269 r">strValue</span> != <b>null</b>)
                    {
                        <b>return</b> <span class="r1269 r">strValue</span> + <span class="r1265 r">extraText</span>;
                    }
                }
                <b>catch</b> (<span class="i">Exception</span>)
                {
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal static string</b> <a id="944eddaabbba5d42" href="../../R/944eddaabbba5d42.html" target="n" data-glyph="74,1" class="i method">HandleDoubleAndSingleQuote</a>(<b>ref string</b> <span id="r1271 rd" class="r1271 r">wordToComplete</span>)
        {
            <b>string</b> <span id="r1272 rd" class="r1272 r">quote</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1271 r">wordToComplete</span>) &amp;&amp; (<span class="r1271 r">wordToComplete</span>[0].<span class="i">IsSingleQuote</span>() || <span class="r1271 r">wordToComplete</span>[0].<span class="i">IsDoubleQuote</span>()))
            {
                <b>char</b> <span id="r1273 rd" class="r1273 r">frontQuote</span> = <span class="r1271 r">wordToComplete</span>[0];
                <b>int</b> <span id="r1274 rd" class="r1274 r">length</span> = <span class="r1271 r">wordToComplete</span>.<span class="i">Length</span>;
 
                <b>if</b> (<span class="r1274 r">length</span> == 1)
                {
                    <span class="r1271 r">wordToComplete</span> = <b>string</b>.<span class="i">Empty</span>;
                    <span class="r1272 r">quote</span> = <span class="r1273 r">frontQuote</span>.<a href="../parser/CharTraits.cs.html#b40a10af036c9eeb" class="i method">IsSingleQuote</a>() ? <span class="s">&quot;&#39;&quot;</span> : <span class="s">&quot;\&quot;&quot;</span>;
                }
                <b>else</b> <b>if</b> (<span class="r1274 r">length</span> &gt; 1)
                {
                    <b>if</b> ((<span class="r1271 r">wordToComplete</span>[<span class="r1274 r">length</span> - 1].<span class="i">IsDoubleQuote</span>() &amp;&amp; <span class="r1273 r">frontQuote</span>.<a href="../parser/CharTraits.cs.html#07f0a28c4f50e364" class="i method">IsDoubleQuote</a>()) || (<span class="r1271 r">wordToComplete</span>[<span class="r1274 r">length</span> - 1].<span class="i">IsSingleQuote</span>() &amp;&amp; <span class="r1273 r">frontQuote</span>.<a href="../parser/CharTraits.cs.html#b40a10af036c9eeb" class="i method">IsSingleQuote</a>()))
                    {
                        <span class="r1271 r">wordToComplete</span> = <span class="r1271 r">wordToComplete</span>.<span class="i">Substring</span>(1, <span class="r1274 r">length</span> - 2);
                        <span class="r1272 r">quote</span> = <span class="r1273 r">frontQuote</span>.<a href="../parser/CharTraits.cs.html#b40a10af036c9eeb" class="i method">IsSingleQuote</a>() ? <span class="s">&quot;&#39;&quot;</span> : <span class="s">&quot;\&quot;&quot;</span>;
                    }
                    <b>else</b> <b>if</b> (!<span class="r1271 r">wordToComplete</span>[<span class="r1274 r">length</span> - 1].<span class="i">IsDoubleQuote</span>() &amp;&amp; !<span class="r1271 r">wordToComplete</span>[<span class="r1274 r">length</span> - 1].<span class="i">IsSingleQuote</span>())
                    {
                        <span class="r1271 r">wordToComplete</span> = <span class="r1271 r">wordToComplete</span>.<span class="i">Substring</span>(1);
                        <span class="r1272 r">quote</span> = <span class="r1273 r">frontQuote</span>.<a href="../parser/CharTraits.cs.html#b40a10af036c9eeb" class="i method">IsSingleQuote</a>() ? <span class="s">&quot;&#39;&quot;</span> : <span class="s">&quot;\&quot;&quot;</span>;
                    }
                }
            }
 
            <b>return</b> <span class="r1272 r">quote</span>;
        }
 
        <b>internal static bool</b> <a id="0b590d9a87f772b1" href="../../R/0b590d9a87f772b1.html" target="n" data-glyph="74,1" class="i method">IsSplattedVariable</a>(<a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r1275 rd" class="r1275 r">targetExpr</span>)
        {
            <b>if</b> (<span class="r1275 r">targetExpr</span> <b>is</b> <a href="../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> &amp;&amp; ((<a href="../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>)<span class="r1275 r">targetExpr</span>).<a href="../parser/ast.cs.html#7f1485a08eb97fcc" class="i property">Splatted</a>)
            {
                <span class="c">// It&#39;s splatted variable, member expansion is not useful</span>
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>internal static void</b> <a id="f848645913a53ddb" href="../../R/f848645913a53ddb.html" target="n" data-glyph="74,1" class="i method">CompleteMemberHelper</a>(
            <b>bool</b> <span id="r1276 rd" class="r1276 r">@static</span>,
            <b>string</b> <span id="r1277 rd" class="r1277 r">memberName</span>,
            <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r1278 rd" class="r1278 r">targetExpr</span>,
            <a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r1279 rd" class="r1279 r">context</span>,
            <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <span id="r1280 rd" class="r1280 r">results</span>)
        {
            <b>object</b> <span id="r1281 rd" class="r1281 r">value</span>;
            <b>if</b> (<a href="#734c1ec38d499153" class="t t">SafeExprEvaluator</a>.<a href="#f61f6e9c4ea81b8b" class="i method">TrySafeEval</a>(<span class="r1278 r">targetExpr</span>, <span class="r1279 r">context</span>.<a href="CompletionAnalysis.cs.html#4055c622a2008ac8" class="i property">ExecutionContext</a>, <b>out</b> <span class="r1281 r">value</span>) &amp;&amp; <span class="r1281 r">value</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r1278 r">targetExpr</span> <b>is</b> <a href="../parser/ast.cs.html#6bb067a9fcfafabf" class="t t">ArrayExpressionAst</a> &amp;&amp; <span class="r1281 r">value</span> <b>is not object</b>[])
                {
                    <span class="c">// When the array contains only one element, the evaluation result would be that element. We wrap it into an array</span>
                    <span class="r1281 r">value</span> = <b>new</b>[] { <span class="r1281 r">value</span> };
                }
 
                <span class="c">// Instead of Get-Member, we access the members directly and send as input to the pipe.</span>
                <a href="../../utils/PowerShellExecutionHelper.cs.html#4790f0f05d781b55" class="k">var</a> <span id="r1282 rd" class="r1282 r">powerShellExecutionHelper</span> = <span class="r1279 r">context</span>.<a href="CompletionAnalysis.cs.html#f944e077619447e4" class="i property">Helper</a>;
                <span class="r1282 r">powerShellExecutionHelper</span>
                    .<span class="i">AddCommandWithPreferenceSetting</span>(<span class="s">&quot;Microsoft.PowerShell.Core\\Where-Object&quot;</span>)
                    .<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Property&quot;</span>, <span class="s">&quot;Name&quot;</span>)
                    .<a href="../hostifaces/PowerShell.cs.html#ad181c9dec5e4ffa" class="i method">AddParameter</a>(<span class="s">&quot;Like&quot;</span>)
                    .<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Value&quot;</span>, <span class="r1277 r">memberName</span>)
                    .<a href="../../utils/PowerShellExecutionHelper.cs.html#9bbdee3db96adb67" class="i method">AddCommandWithPreferenceSetting</a>(<span class="s">&quot;Microsoft.PowerShell.Utility\\Sort-Object&quot;</span>)
                    .<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Property&quot;</span>, <b>new</b> <b>object</b>[] { <span class="s">&quot;MemberType&quot;</span>, <span class="s">&quot;Name&quot;</span> });
 
                <span class="i">IEnumerable</span> <span id="r1283 rd" class="r1283 r">members</span>;
                <b>if</b> (<span class="r1276 r">@static</span>)
                {
                    <b>if</b> (!(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1281 r">value</span>) <b>is</b> <span class="i">Type</span> <span id="r1284 rd" class="r1284 r">type</span>))
                    {
                        <b>return</b>;
                    }
 
                    <span class="r1283 r">members</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#09463c4cdacf00f4" class="i property">DotNetStaticAdapter</a>.<span class="i">BaseGetMembers</span>&lt;<a href="../MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>&gt;(<span class="r1284 r">type</span>);
                }
                <b>else</b>
                {
                    <span class="r1283 r">members</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#e81a321a846beda7" class="i method">AsPSObject</a>(<span class="r1281 r">value</span>).<a href="../MshObject.cs.html#56bc82b240e4291b" class="i property">Members</a>;
                }
 
                <b>var</b> <span id="r1285 rd" class="r1285 r">sortedMembers</span> = <span class="r1282 r">powerShellExecutionHelper</span>.<a href="../../utils/PowerShellExecutionHelper.cs.html#ca353a51989cf3bd" class="i method">ExecuteCurrentPowerShell</a>(<b>out _</b>, <span class="r1283 r">members</span>);
 
                <b>foreach</b> (<b>var</b> <span id="r1286 rd" class="r1286 r">member</span> <b>in</b> <span class="r1285 r">sortedMembers</span>)
                {
                    <a href="../MshMemberInfo.cs.html#fbee845d6706f8da" class="k">var</a> <span id="r1287 rd" class="r1287 r">memberInfo</span> = (<a href="../MshMemberInfo.cs.html#fbee845d6706f8da" class="t t">PSMemberInfo</a>)<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">Base</span>(<span class="r1286 r">member</span>);
                    <b>if</b> (<span class="r1287 r">memberInfo</span>.<a href="../MshMemberInfo.cs.html#ddc58fcb9ef869dd" class="i property">IsHidden</a>)
                    {
                        <b>continue</b>;
                    }
 
                    <b>var</b> <span id="r1288 rd" class="r1288 r">completionText</span> = <span class="r1287 r">memberInfo</span>.<a href="../MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>;
 
                    <span class="c">// Handle scenarios like this: $aa | add-member &#39;a b&#39; 23; $aa.a&lt;tab&gt;</span>
                    <b>if</b> (<span class="r1288 r">completionText</span>.<span class="i">IndexOfAny</span>(<a href="#c30c08aec33a7836" class="i field">s_charactersRequiringQuotes</a>) != -1)
                    {
                        <span class="r1288 r">completionText</span> = <span class="r1288 r">completionText</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                        <span class="r1288 r">completionText</span> = <span class="s">&quot;&#39;&quot;</span> + <span class="r1288 r">completionText</span> + <span class="s">&quot;&#39;&quot;</span>;
                    }
 
                    <b>var</b> <span id="r1289 rd" class="r1289 r">isMethod</span> = <span class="r1287 r">memberInfo</span> <b>is</b> <a href="../MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>;
                    <b>if</b> (<span class="r1289 r">isMethod</span>)
                    {
                        <b>var</b> <span id="r1290 rd" class="r1290 r">isSpecial</span> = (<span class="r1287 r">memberInfo</span> <b>is</b> <a href="../MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>) &amp;&amp; ((<a href="../MshMemberInfo.cs.html#678ebc1a7c5bc189" class="t t">PSMethod</a>)<span class="r1287 r">memberInfo</span>).<a href="../MshMemberInfo.cs.html#fe2680ea34b79b2a" class="i property">IsSpecial</a>;
                        <b>if</b> (<span class="r1290 r">isSpecial</span>)
                            <b>continue</b>;
                        <span class="r1288 r">completionText</span> += <span class="s">&#39;(&#39;</span>;
                    }
 
                    <b>string</b> <span id="r1291 rd" class="r1291 r">tooltip</span> = <span class="r1287 r">memberInfo</span>.<span class="i">ToString</span>();
                    <b>if</b> (<span class="r1291 r">tooltip</span>.<span class="i">Contains</span>(<span class="s">&quot;),&quot;</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                    {
                        <b>var</b> <span id="r1292 rd" class="r1292 r">overloads</span> = <span class="r1291 r">tooltip</span>.<span class="i">Split</span>(<span class="s">&quot;),&quot;</span>, <span class="i">StringSplitOptions</span>.<span class="i">RemoveEmptyEntries</span>);
                        <b>var</b> <span id="r1293 rd" class="r1293 r">newTooltip</span> = <b>new</b> <span class="i">StringBuilder</span>();
                        <b>foreach</b> (<b>var</b> <span id="r1294 rd" class="r1294 r">overload</span> <b>in</b> <span class="r1292 r">overloads</span>)
                        {
                            <span class="r1293 r">newTooltip</span>.<span class="i">Append</span>(<span class="r1294 r">overload</span>.<span class="i">Trim</span>() + <span class="s">&quot;)\r\n&quot;</span>);
                        }
 
                        <span class="r1293 r">newTooltip</span>.<span class="i">Remove</span>(<span class="r1293 r">newTooltip</span>.<span class="i">Length</span> - 3, 3);
                        <span class="r1291 r">tooltip</span> = <span class="r1293 r">newTooltip</span>.<span class="i">ToString</span>();
                    }
 
                    <span class="r1280 r">results</span>.<span class="i">Add</span>(
                        <b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r1288 r">completionText</span>, <span class="r1287 r">memberInfo</span>.<a href="../MshMemberInfo.cs.html#02d8236d3d236301" class="i property">Name</a>,
                                             <span class="r1289 r">isMethod</span> ? <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#389017ea02ead55a" class="i field">Method</a> : <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#bad7fb67c06b9e4e" class="i field">Property</a>,
                                             <span class="r1291 r">tooltip</span>));
                }
 
                <b>var</b> <span id="r1295 rd" class="r1295 r">dictionary</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1281 r">value</span>) <b>as</b> <span class="i">IDictionary</span>;
                <b>if</b> (<span class="r1295 r">dictionary</span> != <b>null</b>)
                {
                    <a href="../regex.cs.html#d450e739ff28e660" class="k">var</a> <span id="r1296 rd" class="r1296 r">pattern</span> = <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r1277 r">memberName</span>, <a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>);
                    <b>foreach</b> (<span class="i">DictionaryEntry</span> <span id="r1297 rd" class="r1297 r">entry</span> <b>in</b> <span class="r1295 r">dictionary</span>)
                    {
                        <b>if</b> (!(<span class="r1297 r">entry</span>.<span class="i">Key</span> <b>is string</b> <span id="r1298 rd" class="r1298 r">key</span>))
                            <b>continue</b>;
 
                        <b>if</b> (<span class="r1296 r">pattern</span>.<a href="../regex.cs.html#02e7d1c913f3c256" class="i method">IsMatch</a>(<span class="r1298 r">key</span>))
                        {
                            <span class="c">// Handle scenarios like this: $hashtable[&quot;abc#d&quot;] = 100; $hashtable.ab&lt;tab&gt;</span>
                            <b>if</b> (<span class="r1298 r">key</span>.<span class="i">IndexOfAny</span>(<a href="#c30c08aec33a7836" class="i field">s_charactersRequiringQuotes</a>) != -1)
                            {
                                <span class="r1298 r">key</span> = <span class="r1298 r">key</span>.<span class="i">Replace</span>(<span class="s">&quot;&#39;&quot;</span>, <span class="s">&quot;&#39;&#39;&quot;</span>);
                                <span class="r1298 r">key</span> = <span class="s">&quot;&#39;&quot;</span> + <span class="r1298 r">key</span> + <span class="s">&quot;&#39;&quot;</span>;
                            }
 
                            <span class="r1280 r">results</span>.<span class="i">Add</span>(<b>new</b> <a href="CompletionResult.cs.html#ca2afdd6b4929db6" class="t constructor">CompletionResult</a>(<span class="r1298 r">key</span>, <span class="r1298 r">key</span>, <a href="CompletionResult.cs.html#3cfd90a9cdb70973" class="t t">CompletionResultType</a>.<a href="CompletionResult.cs.html#bad7fb67c06b9e4e" class="i field">Property</a>, <span class="r1298 r">key</span>));
                        }
                    }
                }
 
                <b>if</b> (!<span class="r1276 r">@static</span> &amp;&amp; <a href="#0025ac13d5fdb515" class="i method">IsValueEnumerable</a>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1281 r">value</span>)))
                {
                    <span class="c">// Complete extension methods &#39;Where&#39; and &#39;ForEach&#39; for Enumerable values</span>
                    <a href="#7badfeeea424353c" class="i method">CompleteExtensionMethods</a>(<span class="r1277 r">memberName</span>, <span class="r1280 r">results</span>);
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if a value is treated as Enumerable in powershell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="0025ac13d5fdb515" href="../../R/0025ac13d5fdb515.html" target="n" data-glyph="76,1" class="i method">IsValueEnumerable</a>(<b>object</b> <span id="r1299 rd" class="r1299 r">value</span>)
        {
            <b>object</b> <span id="r1300 rd" class="r1300 r">baseValue</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1299 r">value</span>);
 
            <b>if</b> (<span class="r1300 r">baseValue</span> == <b>null</b> || <span class="r1300 r">baseValue</span> <b>is string</b> || <span class="r1300 r">baseValue</span> <b>is</b> <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> ||
                <span class="r1300 r">baseValue</span> <b>is</b> <span class="i">IDictionary</span> || <span class="r1300 r">baseValue</span> <b>is</b> <span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlNode</span>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<span class="r1300 r">baseValue</span> <b>is</b> <span class="i">IEnumerable</span> || <span class="r1300 r">baseValue</span> <b>is</b> <span class="i">IEnumerator</span> || <span class="r1300 r">baseValue</span> <b>is</b> <span class="i">DataTable</span>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if a strong type is treated as Enumerable in powershell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="440e5941e0434350" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">IsStaticTypeEnumerable</a>(<span class="i">Type</span> <span id="r1301 rd" class="r1301 r">type</span>)
        {
            <b>if</b> (<span class="r1301 r">type</span>.<span class="i">Equals</span>(<b>typeof</b>(<b>string</b>)) || <b>typeof</b>(<span class="i">IDictionary</span>).<span class="i">IsAssignableFrom</span>(<span class="r1301 r">type</span>) || <b>typeof</b>(<span class="i n">System</span>.<span class="i">Xml</span>.<span class="i">XmlNode</span>).<span class="i">IsAssignableFrom</span>(<span class="r1301 r">type</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<b>typeof</b>(<span class="i">IEnumerable</span>).<span class="i">IsAssignableFrom</span>(<span class="r1301 r">type</span>) || <b>typeof</b>(<span class="i">IEnumerator</span>).<span class="i">IsAssignableFrom</span>(<span class="r1301 r">type</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private static bool</b> <a id="722eabc002827a75" href="../../R/722eabc002827a75.html" target="n" data-glyph="76,1" class="i method">CompletionRequiresQuotes</a>(<b>string</b> <span id="r1302 rd" class="r1302 r">completion</span>, <b>bool</b> <span id="r1303 rd" class="r1303 r">escape</span>)
        {
            <span class="c">// If the tokenizer sees the completion as more than two tokens, or if there is some error, then</span>
            <span class="c">// some form of quoting is necessary (if it&#39;s a variable, we&#39;d need ${}, filenames would need [], etc.)</span>
 
            <span class="i n">Language</span>.<a href="../parser/token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[] <span id="r1304 rd" class="r1304 r">tokens</span>;
            <a href="../parser/Parser.cs.html#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r1305 rd" class="r1305 r">errors</span>;
            <span class="i n">Language</span>.<a href="../parser/Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="../parser/Parser.cs.html#8c264bb718ff180a" class="i method">ParseInput</a>(<span class="r1302 r">completion</span>, <b>out</b> <span class="r1304 r">tokens</span>, <b>out</b> <span class="r1305 r">errors</span>);
 
            <b>char</b>[] <span id="r1306 rd" class="r1306 r">charToCheck</span> = <span class="r1303 r">escape</span> ? <b>new</b>[] { <span class="s">&#39;$&#39;</span>, <span class="s">&#39;[&#39;</span>, <span class="s">&#39;]&#39;</span>, <span class="s">&#39;`&#39;</span> } : <b>new</b>[] { <span class="s">&#39;$&#39;</span>, <span class="s">&#39;`&#39;</span> };
 
            <span class="c">// Expect no errors and 2 tokens (1 is for our completion, the other is eof)</span>
            <span class="c">// Or if the completion is a keyword, we ignore the errors</span>
            <b>bool</b> <span id="r1307 rd" class="r1307 r">requireQuote</span> = !(<span class="r1305 r">errors</span>.<span class="i">Length</span> == 0 &amp;&amp; <span class="r1304 r">tokens</span>.<span class="i">Length</span> == 2);
            <b>if</b> ((!<span class="r1307 r">requireQuote</span> &amp;&amp; <span class="r1304 r">tokens</span>[0] <b>is</b> <a href="../parser/token.cs.html#dce06fb5d7448125" class="t t">StringToken</a>) ||
                (<span class="r1304 r">tokens</span>.<span class="i">Length</span> == 2 &amp;&amp; (<span class="r1304 r">tokens</span>[0].<a href="../parser/token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> &amp; <a href="../parser/token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="../parser/token.cs.html#bffc83c32a1428ea" class="i field">Keyword</a>) != 0))
            {
                <span class="r1307 r">requireQuote</span> = <b>false</b>;
                <b>var</b> <span id="r1308 rd" class="r1308 r">value</span> = <span class="r1304 r">tokens</span>[0].<a href="../parser/token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>;
                <b>if</b> (<span class="r1308 r">value</span>.<span class="i">IndexOfAny</span>(<span class="r1306 r">charToCheck</span>) != -1)
                    <span class="r1307 r">requireQuote</span> = <b>true</b>;
            }
 
            <b>return</b> <span class="r1307 r">requireQuote</span>;
        }
 
        <b>private static bool</b> <a id="d1c5d9bdceb0cae3" href="../../R/d1c5d9bdceb0cae3.html" target="n" data-glyph="76,1" class="i method">ProviderSpecified</a>(<b>string</b> <span id="r1309 rd" class="r1309 r">path</span>)
        {
            <b>var</b> <span id="r1310 rd" class="r1310 r">index</span> = <span class="r1309 r">path</span>.<span class="i">IndexOf</span>(<span class="s">&#39;:&#39;</span>);
            <b>return</b> <span class="r1310 r">index</span> != -1 &amp;&amp; <span class="r1310 r">index</span> + 1 &lt; <span class="r1309 r">path</span>.<span class="i">Length</span> &amp;&amp; <span class="r1309 r">path</span>[<span class="r1310 r">index</span> + 1] == <span class="s">&#39;:&#39;</span>;
        }
 
        <b>private static</b> <span class="i">Type</span> <a id="a3fa8f644e432f1e" href="../../R/a3fa8f644e432f1e.html" target="n" data-glyph="76,1" class="i method">GetEffectiveParameterType</a>(<span class="i">Type</span> <span id="r1311 rd" class="r1311 r">type</span>)
        {
            <b>var</b> <span id="r1312 rd" class="r1312 r">underlying</span> = <span class="i">Nullable</span>.<span class="i">GetUnderlyingType</span>(<span class="r1311 r">type</span>);
            <b>return</b> <span class="r1312 r">underlying</span> ?? <span class="r1311 r">type</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Turn on the &quot;LiteralPaths&quot; option.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1313 r">completionContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate whether the &quot;LiteralPaths&quot; option needs to be removed after operation</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static bool</b> <a id="2bbbf54fb571efb5" href="../../R/2bbbf54fb571efb5.html" target="n" data-glyph="76,1" class="i method">TurnOnLiteralPathOption</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r1313 rd" class="r1313 r">completionContext</span>)
        {
            <b>bool</b> <span id="r1314 rd" class="r1314 r">clearLiteralPathsKey</span> = <b>false</b>;
 
            <b>if</b> (<span class="r1313 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#f3f4d193708c896f" class="i property">Options</a> == <b>null</b>)
            {
                <span class="r1313 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#f3f4d193708c896f" class="i property">Options</a> = <b>new</b> <span class="i">Hashtable</span> { { <span class="s">&quot;LiteralPaths&quot;</span>, <b>true</b> } };
                <span class="r1314 r">clearLiteralPathsKey</span> = <b>true</b>;
            }
            <b>else</b> <b>if</b> (!<span class="r1313 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#f3f4d193708c896f" class="i property">Options</a>.<span class="i">ContainsKey</span>(<span class="s">&quot;LiteralPaths&quot;</span>))
            {
                <span class="c">// Dont escape &#39;[&#39;,&#39;]&#39;,&#39;`&#39; when the file name is treated as command name</span>
                <span class="r1313 r">completionContext</span>.<a href="CompletionAnalysis.cs.html#f3f4d193708c896f" class="i property">Options</a>.<span class="i">Add</span>(<span class="s">&quot;LiteralPaths&quot;</span>, <b>true</b>);
                <span class="r1314 r">clearLiteralPathsKey</span> = <b>true</b>;
            }
 
            <b>return</b> <span class="r1314 r">clearLiteralPathsKey</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return whether we need to add ampersand when it&#39;s necessary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1315 r">context</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1316 r">defaultChoice</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="c0636828e4dcf26b" href="../../R/c0636828e4dcf26b.html" target="n" data-glyph="74,1" class="i method">IsAmpersandNeeded</a>(<a href="CompletionAnalysis.cs.html#f4bb7b26e8be6324" class="t t">CompletionContext</a> <span id="r1315 rd" class="r1315 r">context</span>, <b>bool</b> <span id="r1316 rd" class="r1316 r">defaultChoice</span>)
        {
            <b>if</b> (<span class="r1315 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a> != <b>null</b> &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1315 r">context</span>.<a href="CompletionAnalysis.cs.html#cf3f9752b9748c9c" class="i property">WordToComplete</a>))
            {
                <b>var</b> <span id="r1317 rd" class="r1317 r">lastAst</span> = <span class="r1315 r">context</span>.<a href="CompletionAnalysis.cs.html#c4b25a4935fa7b79" class="i property">RelatedAsts</a>.<span class="i">Last</span>();
                <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="k">var</a> <span id="r1318 rd" class="r1318 r">parent</span> = <span class="r1317 r">lastAst</span>.<span class="i">Parent</span> <b>as</b> <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>;
 
                <b>if</b> (<span class="r1318 r">parent</span> != <b>null</b> &amp;&amp; <span class="r1318 r">parent</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span> == 1 &amp;&amp;
                    ((!<span class="r1316 r">defaultChoice</span> &amp;&amp; <span class="r1318 r">parent</span>.<a href="../parser/ast.cs.html#16e18484040f8b6f" class="i property">InvocationOperator</a> == <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a>) ||
                     (<span class="r1316 r">defaultChoice</span> &amp;&amp; <span class="r1318 r">parent</span>.<a href="../parser/ast.cs.html#16e18484040f8b6f" class="i property">InvocationOperator</a> != <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a>)))
                {
                    <span class="c">// - When the default choice is NOT to add ampersand, we only return true</span>
                    <span class="c">//   when the invocation operator is NOT specified.</span>
                    <span class="c">// - When the default choice is to add ampersand, we only return false</span>
                    <span class="c">//   when the invocation operator is specified.</span>
                    <span class="r1316 r">defaultChoice</span> = !<span class="r1316 r">defaultChoice</span>;
                }
            }
 
            <b>return</b> <span class="r1316 r">defaultChoice</span>;
        }
 
        <b>private sealed class</b> <a id="2a50738072f55b23" href="../../R/../../0000000000.html" target="n" data-glyph="4,1" class="t t"><span id="67c1d8f706d82a90">ItemPathComparer</span></a> : <span class="i">IComparer</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;
        {
            <b>public int</b> <a id="8f3e7623a9535929" href="../../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Compare</a>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1319 rd" class="r1319 r">x</span>, <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1320 rd" class="r1320 r">y</span>)
            {
                <a href="../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="k">var</a> <span id="r1321 rd" class="r1321 r">xPathInfo</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1319 r">x</span>) <b>as</b> <a href="../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a>;
                <b>var</b> <span id="r1322 rd" class="r1322 r">xFileInfo</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1319 r">x</span>) <b>as</b> <span class="i">IO</span>.<span class="i">FileSystemInfo</span>;
                <b>var</b> <span id="r1323 rd" class="r1323 r">xPathStr</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1319 r">x</span>) <b>as string</b>;
 
                <a href="../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="k">var</a> <span id="r1324 rd" class="r1324 r">yPathInfo</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1320 r">y</span>) <b>as</b> <a href="../../namespaces/PathInfo.cs.html#9504cfb54420cfd7" class="t t">PathInfo</a>;
                <b>var</b> <span id="r1325 rd" class="r1325 r">yFileInfo</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1320 r">y</span>) <b>as</b> <span class="i">IO</span>.<span class="i">FileSystemInfo</span>;
                <b>var</b> <span id="r1326 rd" class="r1326 r">yPathStr</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1320 r">y</span>) <b>as string</b>;
 
                <b>string</b> <span id="r1327 rd" class="r1327 r">xPath</span> = <b>null</b>, <span id="r1328 rd" class="r1328 r">yPath</span> = <b>null</b>;
 
                <b>if</b> (<span class="r1321 r">xPathInfo</span> != <b>null</b>)
                    <span class="r1327 r">xPath</span> = <span class="r1321 r">xPathInfo</span>.<a href="../../namespaces/PathInfo.cs.html#16e3fcd7f95c1bfc" class="i property">ProviderPath</a>;
                <b>else</b> <b>if</b> (<span class="r1322 r">xFileInfo</span> != <b>null</b>)
                    <span class="r1327 r">xPath</span> = <span class="r1322 r">xFileInfo</span>.<span class="i">FullName</span>;
                <b>else</b> <b>if</b> (<span class="r1323 r">xPathStr</span> != <b>null</b>)
                    <span class="r1327 r">xPath</span> = <span class="r1323 r">xPathStr</span>;
 
                <b>if</b> (<span class="r1324 r">yPathInfo</span> != <b>null</b>)
                    <span class="r1328 r">yPath</span> = <span class="r1324 r">yPathInfo</span>.<a href="../../namespaces/PathInfo.cs.html#16e3fcd7f95c1bfc" class="i property">ProviderPath</a>;
                <b>else</b> <b>if</b> (<span class="r1325 r">yFileInfo</span> != <b>null</b>)
                    <span class="r1328 r">yPath</span> = <span class="r1325 r">yFileInfo</span>.<span class="i">FullName</span>;
                <b>else</b> <b>if</b> (<span class="r1326 r">yPathStr</span> != <b>null</b>)
                    <span class="r1328 r">yPath</span> = <span class="r1326 r">yPathStr</span>;
 
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1327 r">xPath</span>) || <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1328 r">yPath</span>))
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Base object of item PSObject should be either PathInfo or FileSystemInfo&quot;</span>);
 
                <b>return</b> <b>string</b>.<span class="i">Compare</span>(<span class="r1327 r">xPath</span>, <span class="r1328 r">yPath</span>, <span class="i">StringComparison</span>.<span class="i">CurrentCultureIgnoreCase</span>);
            }
        }
 
        <b>private sealed class</b> <a id="81094cb107686afc" href="../../R/../../0000000000.html" target="n" data-glyph="4,1" class="t t"><span id="0a84afc66423368c">CommandNameComparer</span></a> : <span class="i">IComparer</span>&lt;<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>&gt;
        {
            <b>public int</b> <a id="6aab416b37745d28" href="../../R/../../0000000000.html" target="n" data-glyph="72,2" class="i method">Compare</a>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1329 rd" class="r1329 r">x</span>, <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r1330 rd" class="r1330 r">y</span>)
            {
                <b>string</b> <span id="r1331 rd" class="r1331 r">xName</span> = <b>null</b>;
                <b>string</b> <span id="r1332 rd" class="r1332 r">yName</span> = <b>null</b>;
 
                <b>object</b> <span id="r1333 rd" class="r1333 r">xObj</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1329 r">x</span>);
                <b>object</b> <span id="r1334 rd" class="r1334 r">yObj</span> = <a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#8ae71f08053e5ae1" class="i method">Base</a>(<span class="r1330 r">y</span>);
 
                <a href="../CommandInfo.cs.html#71babe57a99ca852" class="k">var</a> <span id="r1335 rd" class="r1335 r">xCommandInfo</span> = <span class="r1333 r">xObj</span> <b>as</b> <a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>;
                <span class="r1331 r">xName</span> = <span class="r1335 r">xCommandInfo</span> != <b>null</b> ? <span class="r1335 r">xCommandInfo</span>.<a href="../CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a> : <span class="r1333 r">xObj</span> <b>as string</b>;
 
                <a href="../CommandInfo.cs.html#71babe57a99ca852" class="k">var</a> <span id="r1336 rd" class="r1336 r">yCommandInfo</span> = <span class="r1334 r">yObj</span> <b>as</b> <a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a>;
                <span class="r1332 r">yName</span> = <span class="r1336 r">yCommandInfo</span> != <b>null</b> ? <span class="r1336 r">yCommandInfo</span>.<a href="../CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a> : <span class="r1334 r">yObj</span> <b>as string</b>;
 
                <b>if</b> (<span class="r1331 r">xName</span> == <b>null</b> || <span class="r1332 r">yName</span> == <b>null</b>)
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Base object of Command PSObject should be either CommandInfo or string&quot;</span>);
 
                <b>return</b> <b>string</b>.<span class="i">Compare</span>(<span class="r1331 r">xName</span>, <span class="r1332 r">yName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Helpers
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> This class is very similar to the restricted language checker, but it is meant to allow more things, yet still</span>
    <span class="c">///</span><span class="c"> be considered &quot;safe&quot;, at least in the sense that tab completion can rely on it to not do bad things.  The primary</span>
    <span class="c">///</span><span class="c"> use is for intellisense where you don&#39;t want to run arbitrary code, but you do want to know the values</span>
    <span class="c">///</span><span class="c"> of various expressions so you can get the members.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="734c1ec38d499153" href="../../R/734c1ec38d499153.html" target="n" data-glyph="2,0" class="t t"><span id="3bb477a2af979cec">SafeExprEvaluator</span></a> : <a href="../parser/AstVisitor.cs.html#92b75e0afbdd3cf3" class="t t">ICustomAstVisitor2</a>
    {
        <b>internal static bool</b> <a id="f61f6e9c4ea81b8b" href="../../R/f61f6e9c4ea81b8b.html" target="n" data-glyph="74,1" class="i method">TrySafeEval</a>(<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r1337 rd" class="r1337 r">ast</span>, <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r1338 rd" class="r1338 r">executionContext</span>, <b>out object</b> <span id="r1339 rd" class="r1339 r">value</span>)
        {
            <b>if</b> (!(<b>bool</b>)<span class="r1337 r">ast</span>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<b>new</b> <span class="t">SafeExprEvaluator</span>()))
            {
                <span class="r1339 r">value</span> = <b>null</b>;
                <b>return</b> <b>false</b>;
            }
 
            <b>try</b>
            {
                <span class="c">// ConstrainedLanguage has already been applied as necessary when we construct CompletionContext</span>
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!(<span class="r1338 r">executionContext</span>.<a href="../ExecutionContext.cs.html#6ec645dc27615492" class="i property">HasRunspaceEverUsedConstrainedLanguageMode</a> &amp;&amp; <span class="r1338 r">executionContext</span>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> != <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#9f1205fe78117fc2" class="i field">ConstrainedLanguage</a>),
                                   <span class="s">&quot;If the runspace has ever used constrained language mode, then the current language mode should already be set to constrained language&quot;</span>);
 
                <span class="c">// We&#39;re passing &#39;true&#39; here for isTrustedInput, because SafeExprEvaluator ensures that the AST</span>
                <span class="c">// has no dangerous side-effects such as arbitrary expression evaluation. It does require variable</span>
                <span class="c">// access and a few other minor things, which staples of tab completion:</span>
                <span class="c">//</span>
                <span class="c">// $t = Get-Process</span>
                <span class="c">// $t[0].MainModule.&lt;TAB&gt;</span>
                <span class="c">//</span>
                <span class="r1339 r">value</span> = <a href="../parser/Compiler.cs.html#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="../parser/Compiler.cs.html#e64c031d9d5607aa" class="i method">GetExpressionValue</a>(<span class="r1337 r">ast</span>, <b>true</b>, <span class="r1338 r">executionContext</span>);
                <b>return</b> <b>true</b>;
            }
            <b>catch</b>
            {
                <span class="r1339 r">value</span> = <b>null</b>;
                <b>return</b> <b>false</b>;
            }
        }
 
        <b>public object</b> <a id="eaf8356c299a3030" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitErrorStatement</a>(<a href="../parser/ast.cs.html#e02a155b7afded8b" class="t t">ErrorStatementAst</a> <span id="r1340 rd" class="r1340 r">errorStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="78f8596fa80214e2" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitErrorExpression</a>(<a href="../parser/ast.cs.html#bdf2b3276843e0c2" class="t t">ErrorExpressionAst</a> <span id="r1341 rd" class="r1341 r">errorExpressionAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="7ebbc299f4328a4b" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitScriptBlock</a>(<a href="../parser/ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r1342 rd" class="r1342 r">scriptBlockAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="aed900e85b3c00df" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitParamBlock</a>(<a href="../parser/ast.cs.html#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r1343 rd" class="r1343 r">paramBlockAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="fb50b33ab439ab26" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitNamedBlock</a>(<a href="../parser/ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r1344 rd" class="r1344 r">namedBlockAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="c191288a878771eb" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitTypeConstraint</a>(<a href="../parser/ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r1345 rd" class="r1345 r">typeConstraintAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="1b0601051a8ded6a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitAttribute</a>(<a href="../parser/ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r1346 rd" class="r1346 r">attributeAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="56ead9525326f321" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitNamedAttributeArgument</a>(<a href="../parser/ast.cs.html#283d46191e6456a4" class="t t">NamedAttributeArgumentAst</a> <span id="r1347 rd" class="r1347 r">namedAttributeArgumentAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="904154e95f07a843" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitParameter</a>(<a href="../parser/ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a> <span id="r1348 rd" class="r1348 r">parameterAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="bdea6f3164e60592" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitFunctionDefinition</a>(<a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r1349 rd" class="r1349 r">functionDefinitionAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="e4528e759a2b6812" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitIfStatement</a>(<a href="../parser/ast.cs.html#5371982d66a6137d" class="t t">IfStatementAst</a> <span id="r1350 rd" class="r1350 r">ifStmtAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="188ab6e519aad485" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitTrap</a>(<a href="../parser/ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a> <span id="r1351 rd" class="r1351 r">trapStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="bc78c56a2eab947e" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitSwitchStatement</a>(<a href="../parser/ast.cs.html#4d96f6c979a5266e" class="t t">SwitchStatementAst</a> <span id="r1352 rd" class="r1352 r">switchStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="d2cdba096f54084a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitDataStatement</a>(<a href="../parser/ast.cs.html#37c175482122764b" class="t t">DataStatementAst</a> <span id="r1353 rd" class="r1353 r">dataStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="c16aaac0e4c138ee" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitForEachStatement</a>(<a href="../parser/ast.cs.html#9ae6aa2909fef7b0" class="t t">ForEachStatementAst</a> <span id="r1354 rd" class="r1354 r">forEachStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="7f6a45688feb7ed7" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitDoWhileStatement</a>(<a href="../parser/ast.cs.html#b2d1fe560ff56deb" class="t t">DoWhileStatementAst</a> <span id="r1355 rd" class="r1355 r">doWhileStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="399a3ada2dd087be" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitForStatement</a>(<a href="../parser/ast.cs.html#4ca51f16f7c100d4" class="t t">ForStatementAst</a> <span id="r1356 rd" class="r1356 r">forStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="ecf9cd122fc5522b" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitWhileStatement</a>(<a href="../parser/ast.cs.html#4e9a52b62ed8b2b1" class="t t">WhileStatementAst</a> <span id="r1357 rd" class="r1357 r">whileStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="e64fae8b6ac1561c" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitCatchClause</a>(<a href="../parser/ast.cs.html#fafbccc59f688c0e" class="t t">CatchClauseAst</a> <span id="r1358 rd" class="r1358 r">catchClauseAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="9d2e69e8e7b258e2" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitTryStatement</a>(<a href="../parser/ast.cs.html#9827b5d12d62be7f" class="t t">TryStatementAst</a> <span id="r1359 rd" class="r1359 r">tryStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="d14c7902fdacdf32" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitBreakStatement</a>(<a href="../parser/ast.cs.html#410610c8cad1e99b" class="t t">BreakStatementAst</a> <span id="r1360 rd" class="r1360 r">breakStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="aeb3d2c7514041ff" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitContinueStatement</a>(<a href="../parser/ast.cs.html#f8a733d027117fbc" class="t t">ContinueStatementAst</a> <span id="r1361 rd" class="r1361 r">continueStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="8bf16f07d8232453" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitReturnStatement</a>(<a href="../parser/ast.cs.html#ba60713bd71ce457" class="t t">ReturnStatementAst</a> <span id="r1362 rd" class="r1362 r">returnStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="5f2864ad177a4398" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitExitStatement</a>(<a href="../parser/ast.cs.html#c410ad4dd51f9687" class="t t">ExitStatementAst</a> <span id="r1363 rd" class="r1363 r">exitStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="a52c9f7546da3415" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitThrowStatement</a>(<a href="../parser/ast.cs.html#07e9c4f5bce4153b" class="t t">ThrowStatementAst</a> <span id="r1364 rd" class="r1364 r">throwStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="42cad89d87015ad0" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitDoUntilStatement</a>(<a href="../parser/ast.cs.html#d641b5faf306abeb" class="t t">DoUntilStatementAst</a> <span id="r1365 rd" class="r1365 r">doUntilStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="3b13f2d44b15b8df" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitAssignmentStatement</a>(<a href="../parser/ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a> <span id="r1366 rd" class="r1366 r">assignmentStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <span class="c">// REVIEW: we could relax this to allow specific commands</span>
        <b>public object</b> <a id="5f0f4fccad0221a4" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitCommand</a>(<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r1367 rd" class="r1367 r">commandAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="f2ba58cbc7deb8d4" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitCommandExpression</a>(<a href="../parser/ast.cs.html#f4da818a29387c5d" class="t t">CommandExpressionAst</a> <span id="r1368 rd" class="r1368 r">commandExpressionAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="2b6f17aadb83cfa7" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitCommandParameter</a>(<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r1369 rd" class="r1369 r">commandParameterAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="0ee65f1ccd1b9cf6" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitFileRedirection</a>(<a href="../parser/ast.cs.html#2288e8fa779a0d57" class="t t">FileRedirectionAst</a> <span id="r1370 rd" class="r1370 r">fileRedirectionAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="f9d4f740eba79b71" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitMergingRedirection</a>(<a href="../parser/ast.cs.html#57ad2a29a39e91e6" class="t t">MergingRedirectionAst</a> <span id="r1371 rd" class="r1371 r">mergingRedirectionAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="ed03b2dcf621184e" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitExpandableStringExpression</a>(<a href="../parser/ast.cs.html#dac25e1530bb8b85" class="t t">ExpandableStringExpressionAst</a> <span id="r1372 rd" class="r1372 r">expandableStringExpressionAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="884d2a819ad087d7" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitAttributedExpression</a>(<a href="../parser/ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a> <span id="r1373 rd" class="r1373 r">attributedExpressionAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="4e431a88de4ce1f8" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitBlockStatement</a>(<a href="../parser/ast.cs.html#0a993ec4b360d318" class="t t">BlockStatementAst</a> <span id="r1374 rd" class="r1374 r">blockStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="643b12fd501c4221" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitInvokeMemberExpression</a>(<a href="../parser/ast.cs.html#be11dcb1e53f56b8" class="t t">InvokeMemberExpressionAst</a> <span id="r1375 rd" class="r1375 r">invokeMemberExpressionAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="394d24e93434bcc5" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitUsingExpression</a>(<a href="../parser/ast.cs.html#42d36b88817a807f" class="t t">UsingExpressionAst</a> <span id="r1376 rd" class="r1376 r">usingExpressionAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="cf46e943aa6c1e9e" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitTypeDefinition</a>(<a href="../parser/ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r1377 rd" class="r1377 r">typeDefinitionAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="170e4928c56de000" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitPropertyMember</a>(<a href="../parser/ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a> <span id="r1378 rd" class="r1378 r">propertyMemberAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="fd51bbefb58ef1eb" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitFunctionMember</a>(<a href="../parser/ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a> <span id="r1379 rd" class="r1379 r">functionMemberAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="d30e187a0e7e9311" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitBaseCtorInvokeMemberExpression</a>(<a href="../parser/ast.cs.html#93dc2e4429de8e4e" class="t t">BaseCtorInvokeMemberExpressionAst</a> <span id="r1380 rd" class="r1380 r">baseCtorInvokeMemberExpressionAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="d9b2940f43334e6b" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitUsingStatement</a>(<a href="../parser/ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a> <span id="r1381 rd" class="r1381 r">usingStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="3be8250aa015ec9a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitDynamicKeywordStatement</a>(<a href="../parser/ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a> <span id="r1382 rd" class="r1382 r">dynamicKeywordStatementAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="41919cae944620cd" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitPipelineChain</a>(<a href="../parser/ast.cs.html#56dc1a0918611f9c" class="t t">PipelineChainAst</a> <span id="r1383 rd" class="r1383 r">pipelineChainAst</span>) { <b>return</b> <b>false</b>; }
 
        <b>public object</b> <a id="557adad892c5f514" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitConfigurationDefinition</a>(<a href="../parser/ast.cs.html#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a> <span id="r1384 rd" class="r1384 r">configurationDefinitionAst</span>)
        {
            <b>return</b> <span class="r1384 r">configurationDefinitionAst</span>.<a href="../parser/ast.cs.html#230f823f9866cee2" class="i property">Body</a>.<a href="../parser/ast.cs.html#8ac554ad848f70c0" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>);
        }
 
        <b>public object</b> <a id="cb2b28671ab8f833" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitStatementBlock</a>(<a href="../parser/ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r1385 rd" class="r1385 r">statementBlockAst</span>)
        {
            <b>if</b> (<span class="r1385 r">statementBlockAst</span>.<a href="../parser/ast.cs.html#8a3ec42ea63c1318" class="i property">Traps</a> != <b>null</b>) <b>return</b> <b>false</b>;
            <span class="c">// REVIEW: we could relax this to allow multiple statements</span>
            <b>if</b> (<span class="r1385 r">statementBlockAst</span>.<a href="../parser/ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>.<span class="i">Count</span> &gt; 1) <b>return</b> <b>false</b>;
            <b>var</b> <span id="r1386 rd" class="r1386 r">pipeline</span> = <span class="r1385 r">statementBlockAst</span>.<a href="../parser/ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>.<span class="i">FirstOrDefault</span>();
            <b>return</b> <span class="r1386 r">pipeline</span> != <b>null</b> &amp;&amp; (<b>bool</b>)<span class="r1386 r">pipeline</span>.<span class="i">Accept</span>(<a href="#734c1ec38d499153" class="k">this</a>);
        }
 
        <b>public object</b> <a id="98c2e93ff2dc4e24" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitPipeline</a>(<a href="../parser/ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r1387 rd" class="r1387 r">pipelineAst</span>)
        {
            <a href="../parser/ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r1388 rd" class="r1388 r">expr</span> = <span class="r1387 r">pipelineAst</span>.<a href="../parser/ast.cs.html#df65de159259e5e0" class="i method">GetPureExpression</a>();
            <b>return</b> <span class="r1388 r">expr</span> != <b>null</b> &amp;&amp; (<b>bool</b>)<span class="r1388 r">expr</span>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>);
        }
 
        <b>public object</b> <a id="379098fc33ff5215" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitTernaryExpression</a>(<a href="../parser/ast.cs.html#75320d2e9ca587ab" class="t t">TernaryExpressionAst</a> <span id="r1389 rd" class="r1389 r">ternaryExpressionAst</span>)
        {
            <b>return</b> (<b>bool</b>)<span class="r1389 r">ternaryExpressionAst</span>.<a href="../parser/ast.cs.html#8fe864cc3d568de7" class="i property">Condition</a>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>) &amp;&amp;
                   (<b>bool</b>)<span class="r1389 r">ternaryExpressionAst</span>.<a href="../parser/ast.cs.html#c679b2d23aba3af3" class="i property">IfTrue</a>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>) &amp;&amp;
                   (<b>bool</b>)<span class="r1389 r">ternaryExpressionAst</span>.<a href="../parser/ast.cs.html#6aa8ec2dcb9934c3" class="i property">IfFalse</a>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>);
        }
 
        <b>public object</b> <a id="1d42b00d97c23278" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitBinaryExpression</a>(<a href="../parser/ast.cs.html#f3e3848ef2eae593" class="t t">BinaryExpressionAst</a> <span id="r1390 rd" class="r1390 r">binaryExpressionAst</span>)
        {
            <b>return</b> (<b>bool</b>)<span class="r1390 r">binaryExpressionAst</span>.<a href="../parser/ast.cs.html#e19b481693ff50d7" class="i property">Left</a>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>) &amp;&amp; (<b>bool</b>)<span class="r1390 r">binaryExpressionAst</span>.<a href="../parser/ast.cs.html#c43edc792b1ee433" class="i property">Right</a>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>);
        }
 
        <b>public object</b> <a id="1dafb23d958f94fe" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitUnaryExpression</a>(<a href="../parser/ast.cs.html#ee62c8a99269d267" class="t t">UnaryExpressionAst</a> <span id="r1391 rd" class="r1391 r">unaryExpressionAst</span>)
        {
            <b>return</b> (<b>bool</b>)<span class="r1391 r">unaryExpressionAst</span>.<a href="../parser/ast.cs.html#ca72754d5d4d5410" class="i property">Child</a>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>);
        }
 
        <b>public object</b> <a id="2e2ace7ba5888f94" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitConvertExpression</a>(<a href="../parser/ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a> <span id="r1392 rd" class="r1392 r">convertExpressionAst</span>)
        {
            <b>return</b> (<b>bool</b>)<span class="r1392 r">convertExpressionAst</span>.<a href="../parser/ast.cs.html#b2353777e73e35be" class="i property">Child</a>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>);
        }
 
        <b>public object</b> <a id="54ac3e260ba1a776" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitConstantExpression</a>(<a href="../parser/ast.cs.html#ebd8ad798cde7861" class="t t">ConstantExpressionAst</a> <span id="r1393 rd" class="r1393 r">constantExpressionAst</span>)
        {
            <b>return</b> <b>true</b>;
        }
 
        <b>public object</b> <a id="2b911b65743fc649" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitStringConstantExpression</a>(<a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <span id="r1394 rd" class="r1394 r">stringConstantExpressionAst</span>)
        {
            <b>return</b> <b>true</b>;
        }
 
        <b>public object</b> <a id="d420a23b047c7d90" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitSubExpression</a>(<a href="../parser/ast.cs.html#e6552a77ab32112a" class="t t">SubExpressionAst</a> <span id="r1395 rd" class="r1395 r">subExpressionAst</span>)
        {
            <b>return</b> <span class="r1395 r">subExpressionAst</span>.<a href="../parser/ast.cs.html#ec0bda1def565114" class="i property">SubExpression</a>.<a href="../parser/ast.cs.html#320e0abd734f9b5f" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>);
        }
 
        <b>public object</b> <a id="361790936e651b4d" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitVariableExpression</a>(<a href="../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r1396 rd" class="r1396 r">variableExpressionAst</span>)
        {
            <b>return</b> <b>true</b>;
        }
 
        <b>public object</b> <a id="44b8fe732d7b51e0" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitTypeExpression</a>(<a href="../parser/ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a> <span id="r1397 rd" class="r1397 r">typeExpressionAst</span>)
        {
            <b>return</b> <b>true</b>;
        }
 
        <b>public object</b> <a id="7b6df03804ddda85" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitMemberExpression</a>(<a href="../parser/ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a> <span id="r1398 rd" class="r1398 r">memberExpressionAst</span>)
        {
            <b>return</b> (<b>bool</b>)<span class="r1398 r">memberExpressionAst</span>.<a href="../parser/ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>) &amp;&amp; (<b>bool</b>)<span class="r1398 r">memberExpressionAst</span>.<a href="../parser/ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>);
        }
 
        <b>public object</b> <a id="4a8146ec435d9807" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitIndexExpression</a>(<a href="../parser/ast.cs.html#4587e325068530ec" class="t t">IndexExpressionAst</a> <span id="r1399 rd" class="r1399 r">indexExpressionAst</span>)
        {
            <b>return</b> (<b>bool</b>)<span class="r1399 r">indexExpressionAst</span>.<a href="../parser/ast.cs.html#4340a50f115f7fdd" class="i property">Target</a>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>) &amp;&amp; (<b>bool</b>)<span class="r1399 r">indexExpressionAst</span>.<a href="../parser/ast.cs.html#2e5c6ad17318d78c" class="i property">Index</a>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>);
        }
 
        <b>public object</b> <a id="f6616f1b1a594dbe" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitArrayExpression</a>(<a href="../parser/ast.cs.html#6bb067a9fcfafabf" class="t t">ArrayExpressionAst</a> <span id="r1400 rd" class="r1400 r">arrayExpressionAst</span>)
        {
            <b>return</b> <span class="r1400 r">arrayExpressionAst</span>.<a href="../parser/ast.cs.html#ccfc39397cd3e8e5" class="i property">SubExpression</a>.<a href="../parser/ast.cs.html#320e0abd734f9b5f" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>);
        }
 
        <b>public object</b> <a id="0a6d7d47e63caa78" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitArrayLiteral</a>(<a href="../parser/ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a> <span id="r1401 rd" class="r1401 r">arrayLiteralAst</span>)
        {
            <b>return</b> <span class="r1401 r">arrayLiteralAst</span>.<a href="../parser/ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">All</span>(<span id="r1402 rd" class="r1402 r">e</span> =&gt; (<b>bool</b>)<span class="r1402 r">e</span>.<span class="i">Accept</span>(<a href="#734c1ec38d499153" class="k">this</a>));
        }
 
        <b>public object</b> <a id="491bc5a39297ad51" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitHashtable</a>(<a href="../parser/ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r1403 rd" class="r1403 r">hashtableAst</span>)
        {
            <b>foreach</b> (<b>var</b> <span id="r1404 rd" class="r1404 r">keyValuePair</span> <b>in</b> <span class="r1403 r">hashtableAst</span>.<a href="../parser/ast.cs.html#87313f35bc2b66d9" class="i property">KeyValuePairs</a>)
            {
                <b>if</b> (!(<b>bool</b>)<span class="r1404 r">keyValuePair</span>.<span class="i">Item1</span>.<span class="i">Accept</span>(<a href="#734c1ec38d499153" class="k">this</a>))
                    <b>return</b> <b>false</b>;
                <b>if</b> (!(<b>bool</b>)<span class="r1404 r">keyValuePair</span>.<span class="i">Item2</span>.<span class="i">Accept</span>(<a href="#734c1ec38d499153" class="k">this</a>))
                    <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>public object</b> <a id="08c9e24a2d9345c7" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitScriptBlockExpression</a>(<a href="../parser/ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a> <span id="r1405 rd" class="r1405 r">scriptBlockExpressionAst</span>)
        {
            <b>return</b> <b>true</b>;
        }
 
        <b>public object</b> <a id="6947bff53e058220" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitParenExpression</a>(<a href="../parser/ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a> <span id="r1406 rd" class="r1406 r">parenExpressionAst</span>)
        {
            <b>return</b> <span class="r1406 r">parenExpressionAst</span>.<a href="../parser/ast.cs.html#021e323175cb804d" class="i property">Pipeline</a>.<a href="../parser/ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#734c1ec38d499153" class="k">this</a>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Completes with the property names of the InputObject.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal class</b> <a id="7c6dc9c209e2587f" href="../../R/7c6dc9c209e2587f.html" target="n" data-glyph="2,0" class="t t">PropertyNameCompleter</a> : <a href="ExtensibleCompletion.cs.html#196446d42608eb20" class="t t">IArgumentCompleter</a>
    {
        <b>private readonly string</b> <a id="32f3343a41249631" href="../../R/32f3343a41249631.html" target="n" data-glyph="46,1" class="i field">_parameterNameOfInput</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7c6dc9c209e2587f" class="t t">PropertyNameCompleter</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="4787050eb768b43a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">PropertyNameCompleter</a>()
        {
            <a href="#32f3343a41249631" class="i field">_parameterNameOfInput</a> = <span class="s">&quot;InputObject&quot;</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initializes a new instance of the </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#7c6dc9c209e2587f" class="t t">PropertyNameCompleter</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1407 r">parameterNameOfInput</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the property of the input object for which to complete with property names.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="be214a793f742e0a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="t constructor">PropertyNameCompleter</a>(<b>string</b> <span id="r1407 rd" class="r1407 r">parameterNameOfInput</span>)
        {
            <a href="#32f3343a41249631" class="i field">_parameterNameOfInput</a> = <span class="r1407 r">parameterNameOfInput</span>;
        }
 
        <span class="i">IEnumerable</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt; <a href="ExtensibleCompletion.cs.html#196446d42608eb20" class="t t">IArgumentCompleter</a>.<a href="ExtensibleCompletion.cs.html#415f7c87564c20d6" class="i method">CompleteArgument</a>(
            <b>string</b> <span id="r1408 rd" class="r1408 r">commandName</span>,
            <b>string</b> <span id="r1409 rd" class="r1409 r">parameterName</span>,
            <b>string</b> <span id="r1410 rd" class="r1410 r">wordToComplete</span>,
            <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r1411 rd" class="r1411 r">commandAst</span>,
            <span class="i">IDictionary</span> <span id="r1412 rd" class="r1412 r">fakeBoundParameters</span>)
        {
            <b>if</b> (<span class="r1411 r">commandAst</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is not</b> <a href="../parser/ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r1413 rd" class="r1413 r">pipelineAst</span>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>int</b> <span id="r1414 rd" class="r1414 r">i</span>;
            <b>for</b> (<span class="r1414 r">i</span> = 0; <span class="r1414 r">i</span> &lt; <span class="r1413 r">pipelineAst</span>.<a href="../parser/ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>.<span class="i">Count</span>; <span class="r1414 r">i</span>++)
            {
                <b>if</b> (<span class="r1413 r">pipelineAst</span>.<a href="../parser/ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>[<span class="r1414 r">i</span>] == <span class="r1411 r">commandAst</span>)
                {
                    <b>break</b>;
                }
            }
 
            <a href="../parser/TypeInferenceVisitor.cs.html#475e6219e3f308ae" class="k">var</a> <span id="r1415 rd" class="r1415 r">typeInferenceContext</span> = <b>new</b> <a href="../parser/TypeInferenceVisitor.cs.html#d21938883915911c" class="t constructor">TypeInferenceContext</a>();
            <span class="i">IEnumerable</span>&lt;<a href="../CommandInfo.cs.html#c3ad7c327ac93d6b" class="t t">PSTypeName</a>&gt; <span id="r1416 rd" class="r1416 r">prevType</span>;
            <b>if</b> (<span class="r1414 r">i</span> == 0)
            {
                <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="k">var</a> <span id="r1417 rd" class="r1417 r">parameterAst</span> = (<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>)<span class="r1411 r">commandAst</span>.<span class="i">Find</span>(<span id="r1418 rd" class="r1418 r">ast</span> =&gt; <span class="r1418 r">ast</span> <b>is</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r1419 rd" class="r1419 r">cpa</span> &amp;&amp; <span class="r1419 r">cpa</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a> == <span class="s">&quot;PropertyName&quot;</span>, <b>false</b>);
                <a href="PseudoParameterBinder.cs.html#5ac9244be24c2bbd" class="k">var</a> <span id="r1420 rd" class="r1420 r">pseudoBinding</span> = <b>new</b> <span class="t">PseudoParameterBinder</span>().<a href="PseudoParameterBinder.cs.html#4f331f824f2a1e35" class="i method">DoPseudoParameterBinding</a>(<span class="r1411 r">commandAst</span>, <b>null</b>, <span class="r1417 r">parameterAst</span>, <a href="PseudoParameterBinder.cs.html#9dc50bf5ddf87930" class="t t">PseudoParameterBinder</a>.<a href="PseudoParameterBinder.cs.html#ad6e81c17c696e75" class="t t">BindingType</a>.<a href="PseudoParameterBinder.cs.html#aeae553133a922a5" class="i field">ParameterCompletion</a>);
                <b>if</b> (!<span class="r1420 r">pseudoBinding</span>.<a href="PseudoParameterBinder.cs.html#0890fafe524fd733" class="i property">BoundArguments</a>.<span class="i">TryGetValue</span>(<a href="#32f3343a41249631" class="i field">_parameterNameOfInput</a>, <b>out</b> <b>var</b> <span id="r1421 rd" class="r1421 r">pair</span>) || !<span class="r1421 r">pair</span>.<span class="i">ArgumentSpecified</span>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<span class="r1421 r">pair</span> <b>is</b> <a href="PseudoParameterBinder.cs.html#efefd42679f08437" class="t t">AstPair</a> <span id="r1422 rd" class="r1422 r">astPair</span> &amp;&amp; <span class="r1422 r">astPair</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a> != <b>null</b>)
                {
                    <span class="r1416 r">prevType</span> = <a href="../parser/TypeInferenceVisitor.cs.html#85308821e258515b" class="t t">AstTypeInference</a>.<a href="../parser/TypeInferenceVisitor.cs.html#a161c4fce43bc728" class="i method">InferTypeOf</a>(<span class="r1422 r">astPair</span>.<a href="PseudoParameterBinder.cs.html#310069eab93d5165" class="i property">Argument</a>, <span class="r1415 r">typeInferenceContext</span>, <a href="../parser/TypeInferenceVisitor.cs.html#c79f5fa1494e528d" class="t t">TypeInferenceRuntimePermissions</a>.<a href="../parser/TypeInferenceVisitor.cs.html#8df46f8adea8c4e2" class="i field">AllowSafeEval</a>);
                }
 
                <b>return</b> <b>null</b>;
            }
            <b>else</b>
            {
                <span class="r1416 r">prevType</span> = <a href="../parser/TypeInferenceVisitor.cs.html#85308821e258515b" class="t t">AstTypeInference</a>.<span class="i">InferTypeOf</span>(<span class="r1413 r">pipelineAst</span>.<a href="../parser/ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>[<span class="r1414 r">i</span> - 1], <span class="r1415 r">typeInferenceContext</span>, <a href="../parser/TypeInferenceVisitor.cs.html#c79f5fa1494e528d" class="t t">TypeInferenceRuntimePermissions</a>.<a href="../parser/TypeInferenceVisitor.cs.html#8df46f8adea8c4e2" class="i field">AllowSafeEval</a>);
            }
 
            <b>var</b> <span id="r1423 rd" class="r1423 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="CompletionResult.cs.html#a4c553f80d9e648c" class="t t">CompletionResult</a>&gt;();
 
            <a href="#ef47b689fd4f15e2" class="t t">CompletionCompleters</a>.<span class="i">CompleteMemberByInferredType</span>(<span class="r1415 r">typeInferenceContext</span>, <span class="r1416 r">prevType</span>, <span class="r1423 r">result</span>, <span class="r1410 r">wordToComplete</span> + <span class="s">&quot;*&quot;</span>, <span class="i">filter</span>: <a href="#ef47b689fd4f15e2" class="t t">CompletionCompleters</a>.<span class="i">IsPropertyMember</span>, <span class="i">isStatic</span>: <b>false</b>);
            <b>return</b> <span class="r1423 r">result</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
