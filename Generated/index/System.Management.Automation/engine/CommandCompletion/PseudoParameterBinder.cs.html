<!DOCTYPE html>
<html><head><title>PseudoParameterBinder.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(2003);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/CommandCompletion/PseudoParameterBinder.cs" target="_top">engine\CommandCompletion\PseudoParameterBinder.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Host</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;AstArgumentPair&quot;
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The types for AstParameterArgumentPair.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal enum</b> <a id="90df13caf2b08ff0" href="../../R/90df13caf2b08ff0.html" target="n" data-glyph="20,0" class="t t"><span id="e9755f4ebc5da92e">AstParameterArgumentType</span></a>
    {
        <a id="409b194c1cec01fc" href="../../R/409b194c1cec01fc.html" target="n" data-glyph="24,1" class="i field">AstPair</a> = 0,
        <a id="6caa5fee113f4237" href="../../R/6caa5fee113f4237.html" target="n" data-glyph="24,1" class="i field">Switch</a> = 1,
        <a id="9aaa905ba785afb7" href="../../R/9aaa905ba785afb7.html" target="n" data-glyph="24,1" class="i field">Fake</a> = 2,
        <a id="a7afade9bdc8b534" href="../../R/a7afade9bdc8b534.html" target="n" data-glyph="24,1" class="i field">AstArray</a> = 3,
        <a id="ac5fbd8418f369ff" href="../../R/ac5fbd8418f369ff.html" target="n" data-glyph="24,1" class="i field">PipeObject</a> = 4
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The base class for parameter argument pair.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal abstract class</b> <a id="0a86cacd3f9ecdb3" href="../../R/0a86cacd3f9ecdb3.html" target="n" data-glyph="2,0" class="t t"><span id="066642a1088ee039">AstParameterArgumentPair</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter Ast.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <a id="72c3e7cefee2f768" href="../../R/72c3e7cefee2f768.html" target="n" data-glyph="102,1" class="i property">Parameter</a> { <b>get</b>; <b>protected set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The argument type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a> <a id="aaf48c1f6c018e0c" href="../../R/aaf48c1f6c018e0c.html" target="n" data-glyph="102,1" class="i property">ParameterArgumentType</a> { <b>get</b>; <b>protected set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate if the parameter is specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="ee5926fcf99682f5" href="../../R/ee5926fcf99682f5.html" target="n" data-glyph="102,1" class="i property">ParameterSpecified</a> { <b>get</b>; <b>protected set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate if the parameter is specified.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="20b483ea1bf76f76" href="../../R/20b483ea1bf76f76.html" target="n" data-glyph="102,1" class="i property">ArgumentSpecified</a> { <b>get</b>; <b>protected set</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter name.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="3f07007c27aa3c29" href="../../R/3f07007c27aa3c29.html" target="n" data-glyph="102,1" class="i property">ParameterName</a> { <b>get</b>; <b>protected set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The parameter text.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="069fee2bc4eec7aa" href="../../R/069fee2bc4eec7aa.html" target="n" data-glyph="102,1" class="i property">ParameterText</a> { <b>get</b>; <b>protected set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The argument type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Type</span> <a id="25985364adcae081" href="../../R/25985364adcae081.html" target="n" data-glyph="102,1" class="i property">ArgumentType</a> { <b>get</b>; <b>protected set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represent a parameter argument pair. The argument is a pipeline input object.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="4d0ffcc7e6cb617a" href="../../R/4d0ffcc7e6cb617a.html" target="n" data-glyph="2,0" class="t t">PipeObjectPair</a> : <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>
    {
        <b>internal</b> <a id="16866805d29948d1" href="../../R/16866805d29948d1.html" target="n" data-glyph="74,1" class="t constructor">PipeObjectPair</a>(<b>string</b> <span id="r0 rd" class="r0 r">parameterName</span>, <span class="i">Type</span> <span id="r1 rd" class="r1 r">pipeObjType</span>)
        {
            <b>if</b> (<span class="r0 r">parameterName</span> == <b>null</b>)
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r0 r">parameterName</span>));
 
            <a href="#72c3e7cefee2f768" class="i property">Parameter</a> = <b>null</b>;
            <a href="#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a> = <a href="#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="#ac5fbd8418f369ff" class="i field">PipeObject</a>;
            <a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a> = <b>true</b>;
            <a href="#20b483ea1bf76f76" class="i property">ArgumentSpecified</a> = <b>true</b>;
            <a href="#3f07007c27aa3c29" class="i property">ParameterName</a> = <span class="r0 r">parameterName</span>;
            <a href="#069fee2bc4eec7aa" class="i property">ParameterText</a> = <span class="r0 r">parameterName</span>;
            <a href="#25985364adcae081" class="i property">ArgumentType</a> = <span class="r1 r">pipeObjType</span>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represent a parameter argument pair. The argument is an array of ExpressionAst (remaining</span>
    <span class="c">///</span><span class="c"> arguments)</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="d3a0a7f99c8105c4" href="../../R/d3a0a7f99c8105c4.html" target="n" data-glyph="2,0" class="t t">AstArrayPair</a> : <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>
    {
        <b>internal</b> <a id="0091b1cf49d5f0ec" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">AstArrayPair</a>(<b>string</b> <span id="r2 rd" class="r2 r">parameterName</span>, <span class="i">ICollection</span>&lt;<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r3 rd" class="r3 r">arguments</span>)
        {
            <b>if</b> (<span class="r2 r">parameterName</span> == <b>null</b>)
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r2 r">parameterName</span>));
            <b>if</b> (<span class="r3 r">arguments</span> == <b>null</b> || <span class="r3 r">arguments</span>.<span class="i">Count</span> == 0)
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r3 r">arguments</span>));
 
            <a href="#72c3e7cefee2f768" class="i property">Parameter</a> = <b>null</b>;
            <a href="#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a> = <a href="#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="#a7afade9bdc8b534" class="i field">AstArray</a>;
            <a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a> = <b>true</b>;
            <a href="#20b483ea1bf76f76" class="i property">ArgumentSpecified</a> = <b>true</b>;
            <a href="#3f07007c27aa3c29" class="i property">ParameterName</a> = <span class="r2 r">parameterName</span>;
            <a href="#069fee2bc4eec7aa" class="i property">ParameterText</a> = <span class="r2 r">parameterName</span>;
            <a href="#25985364adcae081" class="i property">ArgumentType</a> = <b>typeof</b>(<span class="i">Array</span>);
 
            <a href="#5ea2ac266039b42b" class="i property">Argument</a> = <span class="r3 r">arguments</span>.<span class="i">ToArray</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>[] <a id="5ea2ac266039b42b" href="../../R/5ea2ac266039b42b.html" target="n" data-glyph="102,1" class="i property">Argument</a> { <b>get</b>; } = <b>null</b>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represent a parameter argument pair. The argument is a fake object.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="5a548350b3d738b5" href="../../R/5a548350b3d738b5.html" target="n" data-glyph="2,0" class="t t">FakePair</a> : <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>
    {
        <b>internal</b> <a id="2e1894ff3ffe5871" href="../../R/2e1894ff3ffe5871.html" target="n" data-glyph="74,1" class="t constructor">FakePair</a>(<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r4 rd" class="r4 r">parameterAst</span>)
        {
            <b>if</b> (<span class="r4 r">parameterAst</span> == <b>null</b>)
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r4 r">parameterAst</span>));
 
            <a href="#72c3e7cefee2f768" class="i property">Parameter</a> = <span class="r4 r">parameterAst</span>;
            <a href="#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a> = <a href="#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="#9aaa905ba785afb7" class="i field">Fake</a>;
            <a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a> = <b>true</b>;
            <a href="#20b483ea1bf76f76" class="i property">ArgumentSpecified</a> = <b>true</b>;
            <a href="#3f07007c27aa3c29" class="i property">ParameterName</a> = <span class="r4 r">parameterAst</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
            <a href="#069fee2bc4eec7aa" class="i property">ParameterText</a> = <span class="r4 r">parameterAst</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
            <a href="#25985364adcae081" class="i property">ArgumentType</a> = <b>typeof</b>(<b>object</b>);
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represent a parameter argument pair. The parameter is a switch parameter.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="4eb6fcc40752a8a5" href="../../R/4eb6fcc40752a8a5.html" target="n" data-glyph="2,0" class="t t">SwitchPair</a> : <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>
    {
        <b>internal</b> <a id="e60552fc77490301" href="../../R/e60552fc77490301.html" target="n" data-glyph="74,1" class="t constructor">SwitchPair</a>(<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r5 rd" class="r5 r">parameterAst</span>)
        {
            <b>if</b> (<span class="r5 r">parameterAst</span> == <b>null</b>)
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r5 r">parameterAst</span>));
 
            <a href="#72c3e7cefee2f768" class="i property">Parameter</a> = <span class="r5 r">parameterAst</span>;
            <a href="#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a> = <a href="#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="#6caa5fee113f4237" class="i field">Switch</a>;
            <a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a> = <b>true</b>;
            <a href="#20b483ea1bf76f76" class="i property">ArgumentSpecified</a> = <b>true</b>;
            <a href="#3f07007c27aa3c29" class="i property">ParameterName</a> = <span class="r5 r">parameterAst</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
            <a href="#069fee2bc4eec7aa" class="i property">ParameterText</a> = <span class="r5 r">parameterAst</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
            <a href="#25985364adcae081" class="i property">ArgumentType</a> = <b>typeof</b>(<b>bool</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="92fcffd9c834f7dd" href="../../R/92fcffd9c834f7dd.html" target="n" data-glyph="102,1" class="i property">Argument</a>
        {
            <b>get</b> { <b>return</b> <b>true</b>; }
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represent a parameter argument pair. It could be a pure argument (no parameter, only argument available);</span>
    <span class="c">///</span><span class="c"> it could be a CommandParameterAst that contains its argument; it also could be a CommandParameterAst with</span>
    <span class="c">///</span><span class="c"> another CommandParameterAst as the argument.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal sealed class</b> <a id="efefd42679f08437" href="../../R/efefd42679f08437.html" target="n" data-glyph="2,0" class="t t">AstPair</a> : <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>
    {
        <b>internal</b> <a id="4ce34437fe8bf249" href="../../R/4ce34437fe8bf249.html" target="n" data-glyph="74,1" class="t constructor">AstPair</a>(<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r6 rd" class="r6 r">parameterAst</span>)
        {
            <b>if</b> (<span class="r6 r">parameterAst</span> == <b>null</b> || <span class="r6 r">parameterAst</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a> == <b>null</b>)
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r6 r">parameterAst</span>));
 
            <a href="#72c3e7cefee2f768" class="i property">Parameter</a> = <span class="r6 r">parameterAst</span>;
            <a href="#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a> = <a href="#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="#409b194c1cec01fc" class="i field">AstPair</a>;
            <a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a> = <b>true</b>;
            <a href="#20b483ea1bf76f76" class="i property">ArgumentSpecified</a> = <b>true</b>;
            <a href="#3f07007c27aa3c29" class="i property">ParameterName</a> = <span class="r6 r">parameterAst</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
            <a href="#069fee2bc4eec7aa" class="i property">ParameterText</a> = <span class="s">&quot;-&quot;</span> + <a href="#3f07007c27aa3c29" class="i property">ParameterName</a> + <span class="s">&quot;:&quot;</span>;
            <a href="#25985364adcae081" class="i property">ArgumentType</a> = <span class="r6 r">parameterAst</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a>.<a href="../parser/ast.cs.html#966dd684e99eeda0" class="i property">StaticType</a>;
 
            <a href="#a8ce790d560597c7" class="i property">ParameterContainsArgument</a> = <b>true</b>;
            <a href="#310069eab93d5165" class="i property">Argument</a> = <span class="r6 r">parameterAst</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a>;
        }
 
        <b>internal</b> <a id="d006b2bc6353ecaa" href="../../R/d006b2bc6353ecaa.html" target="n" data-glyph="74,1" class="t constructor">AstPair</a>(<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r7 rd" class="r7 r">parameterAst</span>, <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r8 rd" class="r8 r">argumentAst</span>)
        {
            <b>if</b> (<span class="r7 r">parameterAst</span> != <b>null</b> &amp;&amp; <span class="r7 r">parameterAst</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a> != <b>null</b>)
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r7 r">parameterAst</span>));
 
            <b>if</b> (<span class="r7 r">parameterAst</span> == <b>null</b> &amp;&amp; <span class="r8 r">argumentAst</span> == <b>null</b>)
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r8 r">argumentAst</span>));
 
            <a href="#72c3e7cefee2f768" class="i property">Parameter</a> = <span class="r7 r">parameterAst</span>;
            <a href="#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a> = <a href="#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="#409b194c1cec01fc" class="i field">AstPair</a>;
            <a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a> = <span class="r7 r">parameterAst</span> != <b>null</b>;
            <a href="#20b483ea1bf76f76" class="i property">ArgumentSpecified</a> = <span class="r8 r">argumentAst</span> != <b>null</b>;
            <a href="#3f07007c27aa3c29" class="i property">ParameterName</a> = <span class="r7 r">parameterAst</span>?.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
            <a href="#069fee2bc4eec7aa" class="i property">ParameterText</a> = <span class="r7 r">parameterAst</span>?.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
            <a href="#25985364adcae081" class="i property">ArgumentType</a> = <span class="r8 r">argumentAst</span>?.<a href="../parser/ast.cs.html#966dd684e99eeda0" class="i property">StaticType</a>;
 
            <a href="#a8ce790d560597c7" class="i property">ParameterContainsArgument</a> = <b>false</b>;
            <a href="#310069eab93d5165" class="i property">Argument</a> = <span class="r8 r">argumentAst</span>;
        }
 
        <b>internal</b> <a id="73103abdc9df9bdb" href="../../R/73103abdc9df9bdb.html" target="n" data-glyph="74,1" class="t constructor">AstPair</a>(<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r9 rd" class="r9 r">parameterAst</span>, <a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r10 rd" class="r10 r">argumentAst</span>)
        {
            <b>if</b> (<span class="r9 r">parameterAst</span> != <b>null</b> &amp;&amp; <span class="r9 r">parameterAst</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a> != <b>null</b>)
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fed5f40dc0075d41" class="i method">NewArgumentException</a>(<b>nameof</b>(<span class="r9 r">parameterAst</span>));
 
            <b>if</b> (<span class="r9 r">parameterAst</span> == <b>null</b> || <span class="r10 r">argumentAst</span> == <b>null</b>)
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r10 r">argumentAst</span>));
 
            <a href="#72c3e7cefee2f768" class="i property">Parameter</a> = <span class="r9 r">parameterAst</span>;
            <a href="#aaf48c1f6c018e0c" class="i property">ParameterArgumentType</a> = <a href="#90df13caf2b08ff0" class="t t">AstParameterArgumentType</a>.<a href="#409b194c1cec01fc" class="i field">AstPair</a>;
            <a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a> = <b>true</b>;
            <a href="#20b483ea1bf76f76" class="i property">ArgumentSpecified</a> = <b>true</b>;
            <a href="#3f07007c27aa3c29" class="i property">ParameterName</a> = <span class="r9 r">parameterAst</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
            <a href="#069fee2bc4eec7aa" class="i property">ParameterText</a> = <span class="r9 r">parameterAst</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
            <a href="#25985364adcae081" class="i property">ArgumentType</a> = <b>typeof</b>(<b>string</b>);
 
            <a href="#a8ce790d560597c7" class="i property">ParameterContainsArgument</a> = <b>false</b>;
            <a href="#310069eab93d5165" class="i property">Argument</a> = <span class="r10 r">argumentAst</span>;
            <a href="#e1c4a25087b9c0e3" class="i property">ArgumentIsCommandParameterAst</a> = <b>true</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate if the argument is contained in the CommandParameterAst.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="a8ce790d560597c7" href="../../R/a8ce790d560597c7.html" target="n" data-glyph="102,1" class="i property">ParameterContainsArgument</a> { <b>get</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate if the argument is of type CommandParameterAst.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="e1c4a25087b9c0e3" href="../../R/e1c4a25087b9c0e3.html" target="n" data-glyph="102,1" class="i property">ArgumentIsCommandParameterAst</a> { <b>get</b>; } = <b>false</b>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <a id="310069eab93d5165" href="../../R/310069eab93d5165.html" target="n" data-glyph="102,1" class="i property">Argument</a> { <b>get</b>; } = <b>null</b>;
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> &quot;AstArgumentPair&quot;
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Runs the PowerShell parameter binding algorithm against a CommandAst,</span>
    <span class="c">///</span><span class="c"> returning information about which parameters were bound.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public static class</b> <a id="b6eface4652c31d3" href="../../R/b6eface4652c31d3.html" target="n" data-glyph="0,0" class="t t">StaticParameterBinder</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Bind a CommandAst to one of PowerShell&#39;s built-in commands.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r11 r">commandAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The CommandAst that represents the command invocation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The StaticBindingResult that represents the binding.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#cae64ef619e0a99a" class="t t">StaticBindingResult</a> <a id="b8b534f57729846f" href="../../R/b8b534f57729846f.html" target="n" data-glyph="72,1" class="i method">BindCommand</a>(<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r11 rd" class="r11 r">commandAst</span>)
        {
            <b>return</b> <a href="#d2b93539d7859acd" class="i method">BindCommand</a>(<span class="r11 r">commandAst</span>, <span class="r12 r">resolve</span>: <b>true</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Bind a CommandAst to the specified command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">commandAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The CommandAst that represents the command invocation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r12 r">resolve</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Boolean to determine whether binding should be syntactic, or should attempt</span>
        <span class="c">///</span><span class="c"> to resolve against an existing command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The StaticBindingResult that represents the binding.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#cae64ef619e0a99a" class="t t">StaticBindingResult</a> <a id="d2b93539d7859acd" href="../../R/d2b93539d7859acd.html" target="n" data-glyph="72,1" class="i method">BindCommand</a>(<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r13 rd" class="r13 r">commandAst</span>, <b>bool</b> <span id="r12 rd" class="r12 r">resolve</span>)
        {
            <b>return</b> <a href="#078ba0a0a68941af" class="i method">BindCommand</a>(<span class="r13 r">commandAst</span>, <span class="r12 r">resolve</span>, <b>null</b>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Bind a CommandAst to the specified command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">commandAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The CommandAst that represents the command invocation.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">resolve</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Boolean to determine whether binding should be syntactic, or should attempt</span>
        <span class="c">///</span><span class="c"> to resolve against an existing command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">desiredParameters</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c">     A string array that represents parameter names of interest. If any of these are specified,</span>
        <span class="c">///</span><span class="c">     then full binding is done.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The StaticBindingResult that represents the binding.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#cae64ef619e0a99a" class="t t">StaticBindingResult</a> <a id="078ba0a0a68941af" href="../../R/078ba0a0a68941af.html" target="n" data-glyph="72,1" class="i method">BindCommand</a>(<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r14 rd" class="r14 r">commandAst</span>, <b>bool</b> <span id="r15 rd" class="r15 r">resolve</span>, <b>string</b>[] <span id="r16 rd" class="r16 r">desiredParameters</span>)
        {
            <span class="c">// If they specified any desired parameters, first quickly check if they are found</span>
            <b>if</b> ((<span class="r16 r">desiredParameters</span> != <b>null</b>) &amp;&amp; (<span class="r16 r">desiredParameters</span>.<span class="i">Length</span> &gt; 0))
            {
                <b>bool</b> <span id="r17 rd" class="r17 r">possiblyHadDesiredParameter</span> = <b>false</b>;
                <b>foreach</b> (<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r18 rd" class="r18 r">commandParameter</span> <b>in</b> <span class="r14 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">OfType</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>&gt;())
                {
                    <b>string</b> <span id="r19 rd" class="r19 r">actualParameterName</span> = <span class="r18 r">commandParameter</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
 
                    <b>foreach</b> (<b>string</b> <span id="r20 rd" class="r20 r">actualParameter</span> <b>in</b> <span class="r16 r">desiredParameters</span>)
                    {
                        <b>if</b> (<span class="r20 r">actualParameter</span>.<span class="i">StartsWith</span>(<span class="r19 r">actualParameterName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="r17 r">possiblyHadDesiredParameter</span> = <b>true</b>;
                            <b>break</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r17 r">possiblyHadDesiredParameter</span>)
                    {
                        <b>break</b>;
                    }
                }
 
                <span class="c">// Quick exit if the desired parameter was not present</span>
                <b>if</b> (!<span class="r17 r">possiblyHadDesiredParameter</span>)
                {
                    <b>return</b> <b>null</b>;
                }
            }
 
            <b>if</b> (!<span class="r15 r">resolve</span>)
            {
                <b>return</b> <b>new</b> <a href="#36a573d59a68cb86" class="t constructor">StaticBindingResult</a>(<span class="r14 r">commandAst</span>, <b>null</b>);
            }
 
            <a href="#5ac9244be24c2bbd" class="t t">PseudoBindingInfo</a> <span id="r21 rd" class="r21 r">pseudoBinding</span> = <b>null</b>;
            <b>if</b> (<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> == <b>null</b>)
            {
                <span class="c">// Handle static binding from a non-PowerShell / C# application</span>
                <span class="c">// DefaultRunspace is a thread static field, so race condition will not happen because different threads will access different instances of &quot;DefaultRunspace&quot;</span>
                <b>if</b> (<a href="#73dfbe06efbf9517" class="i field">t_bindCommandRunspace</a> == <b>null</b>)
                {
                    <span class="c">// Create a mini runspace by remove the types and formats</span>
                    <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r22 rd" class="r22 r">minimalState</span> = <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="../InitialSessionState.cs.html#904bc85f721c6764" class="i method">CreateDefault2</a>();
                    <span class="r22 r">minimalState</span>.<a href="../InitialSessionState.cs.html#0f0c3a5adb4b1776" class="i property">Types</a>.<a href="../InitialSessionState.cs.html#9c6f481e94fc74d5" class="i method">Clear</a>();
                    <span class="r22 r">minimalState</span>.<a href="../InitialSessionState.cs.html#4e7657f066102cad" class="i property">Formats</a>.<a href="../InitialSessionState.cs.html#9c6f481e94fc74d5" class="i method">Clear</a>();
                    <a href="#73dfbe06efbf9517" class="i field">t_bindCommandRunspace</a> = <a href="../hostifaces/ConnectionFactory.cs.html#c5fbe142e4e21218" class="t t">RunspaceFactory</a>.<a href="../hostifaces/ConnectionFactory.cs.html#19132aa2ac867b76" class="i method">CreateRunspace</a>(<span class="r22 r">minimalState</span>);
                    <a href="#73dfbe06efbf9517" class="i field">t_bindCommandRunspace</a>.<a href="../hostifaces/Connection.cs.html#61f55439fb78f2fe" class="i method">Open</a>();
                }
 
                <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> = <a href="#73dfbe06efbf9517" class="i field">t_bindCommandRunspace</a>;
                <span class="c">// Static binding always does argument binding (not argument or parameter completion).</span>
                <span class="r21 r">pseudoBinding</span> = <b>new</b> <span class="t">PseudoParameterBinder</span>().<a href="#4f331f824f2a1e35" class="i method">DoPseudoParameterBinding</a>(<span class="r14 r">commandAst</span>, <b>null</b>, <b>null</b>, <a href="#9dc50bf5ddf87930" class="t t">PseudoParameterBinder</a>.<a href="#ad6e81c17c696e75" class="t t">BindingType</a>.<a href="#e9115d1d31266671" class="i field">ArgumentBinding</a>);
                <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> = <b>null</b>;
            }
            <b>else</b>
            {
                <span class="c">// Static binding always does argument binding (not argument or parameter completion).</span>
                <span class="r21 r">pseudoBinding</span> = <b>new</b> <span class="t">PseudoParameterBinder</span>().<a href="#4f331f824f2a1e35" class="i method">DoPseudoParameterBinding</a>(<span class="r14 r">commandAst</span>, <b>null</b>, <b>null</b>, <a href="#9dc50bf5ddf87930" class="t t">PseudoParameterBinder</a>.<a href="#ad6e81c17c696e75" class="t t">BindingType</a>.<a href="#e9115d1d31266671" class="i field">ArgumentBinding</a>);
            }
 
            <b>return</b> <b>new</b> <a href="#36a573d59a68cb86" class="t constructor">StaticBindingResult</a>(<span class="r14 r">commandAst</span>, <span class="r21 r">pseudoBinding</span>);
        }
 
        [<span class="i">ThreadStatic</span>]
        <b>private static</b> <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <a id="73dfbe06efbf9517" href="../../R/73dfbe06efbf9517.html" target="n" data-glyph="46,1" class="i field">t_bindCommandRunspace</a> = <b>null</b>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents the results of the PowerShell parameter binding process.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="cae64ef619e0a99a" href="../../R/cae64ef619e0a99a.html" target="n" data-glyph="0,0" class="t t">StaticBindingResult</a>
    {
        <b>internal</b> <a id="36a573d59a68cb86" href="../../R/36a573d59a68cb86.html" target="n" data-glyph="74,1" class="t constructor">StaticBindingResult</a>(<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r23 rd" class="r23 r">commandAst</span>, <a href="#5ac9244be24c2bbd" class="t t">PseudoBindingInfo</a> <span id="r24 rd" class="r24 r">bindingInfo</span>)
        {
            <a href="#e54921e80ff4b0b1" class="i property">BoundParameters</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#15f8f4f4f6f1cb09" class="t t">ParameterBindingResult</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#2adc460fbc055cd5" class="i property">BindingExceptions</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#f5ebcc4d4efbbd08" class="t t">StaticBindingError</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <b>if</b> (<span class="r24 r">bindingInfo</span> == <b>null</b>)
            {
                <a href="#e1901fb933a8363d" class="i method">CreateBindingResultForSyntacticBind</a>(<span class="r23 r">commandAst</span>);
            }
            <b>else</b>
            {
                <a href="#62e3d68eeb0250b8" class="i method">CreateBindingResultForSuccessfulBind</a>(<span class="r23 r">commandAst</span>, <span class="r24 r">bindingInfo</span>);
            }
        }
 
        <b>private void</b> <a id="62e3d68eeb0250b8" href="../../R/62e3d68eeb0250b8.html" target="n" data-glyph="76,1" class="i method">CreateBindingResultForSuccessfulBind</a>(<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r25 rd" class="r25 r">commandAst</span>, <a href="#5ac9244be24c2bbd" class="t t">PseudoBindingInfo</a> <span id="r26 rd" class="r26 r">bindingInfo</span>)
        {
            <a href="#654e6d4cecf1fc44" class="i field">_bindingInfo</a> = <span class="r26 r">bindingInfo</span>;
 
            <span class="c">// Check if there is exactly one parameter set valid. In that case,</span>
            <span class="c">// ValidParameterSetFlags is exactly a power of two. Otherwise,</span>
            <span class="c">// add to the binding exceptions.</span>
            <b>bool</b> <span id="r27 rd" class="r27 r">parameterSetSpecified</span> = <span class="r26 r">bindingInfo</span>.<a href="#c06c8a4dc27d4026" class="i property">ValidParameterSetsFlags</a> != <span class="i">UInt32</span>.<span class="i">MaxValue</span>;
            <b>bool</b> <span id="r28 rd" class="r28 r">remainingParameterSetIncludesDefault</span> =
                (<span class="r26 r">bindingInfo</span>.<a href="#b621e7fcaed07b69" class="i property">DefaultParameterSetFlag</a> != 0) &amp;&amp;
                ((<span class="r26 r">bindingInfo</span>.<a href="#c06c8a4dc27d4026" class="i property">ValidParameterSetsFlags</a> &amp; <span class="r26 r">bindingInfo</span>.<a href="#b621e7fcaed07b69" class="i property">DefaultParameterSetFlag</a>) ==
                <span class="r26 r">bindingInfo</span>.<a href="#b621e7fcaed07b69" class="i property">DefaultParameterSetFlag</a>);
 
            <span class="c">// (x &amp; (x -1 ) == 0) is a bit hack to determine if something is</span>
            <span class="c">// exactly a power of two.</span>
            <b>bool</b> <span id="r29 rd" class="r29 r">onlyOneRemainingParameterSet</span> =
                (<span class="r26 r">bindingInfo</span>.<a href="#c06c8a4dc27d4026" class="i property">ValidParameterSetsFlags</a> != 0) &amp;&amp;
                (<span class="r26 r">bindingInfo</span>.<a href="#c06c8a4dc27d4026" class="i property">ValidParameterSetsFlags</a> &amp;
                        (<span class="r26 r">bindingInfo</span>.<a href="#c06c8a4dc27d4026" class="i property">ValidParameterSetsFlags</a> - 1)) == 0;
 
            <b>if</b> (<span class="r27 r">parameterSetSpecified</span> &amp;&amp;
                (!<span class="r28 r">remainingParameterSetIncludesDefault</span>) &amp;&amp;
                (!<span class="r29 r">onlyOneRemainingParameterSet</span>))
            {
                <a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r30 rd" class="r30 r">bindingException</span> =
                    <b>new</b> <span class="t">ParameterBindingException</span>(
                        <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                        <b>null</b>,
                        <b>null</b>,
                        <b>null</b>,
                        <b>null</b>,
                        <b>null</b>,
                        <span class="i">ParameterBinderStrings</span>.<span class="i">AmbiguousParameterSet</span>,
                        <span class="s">&quot;AmbiguousParameterSet&quot;</span>);
                <a href="#2adc460fbc055cd5" class="i property">BindingExceptions</a>.<span class="i">Add</span>(<span class="r25 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[0].<span class="i">Extent</span>.<span class="i">Text</span>,
                    <b>new</b> <span class="t">StaticBindingError</span>(<span class="r25 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[0], <span class="r30 r">bindingException</span>));
            }
 
            <span class="c">// Add error for duplicate parameters</span>
            <b>if</b> (<span class="r26 r">bindingInfo</span>.<a href="#e8b7e6ad67a8adf2" class="i property">DuplicateParameters</a> != <b>null</b>)
            {
                <b>foreach</b> (<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r31 rd" class="r31 r">duplicateParameter</span> <b>in</b> <span class="r26 r">bindingInfo</span>.<a href="#e8b7e6ad67a8adf2" class="i property">DuplicateParameters</a>)
                {
                    <a href="#ea1f93400aba5dd3" class="i method">AddDuplicateParameterBindingException</a>(<span class="r31 r">duplicateParameter</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>);
                }
            }
 
            <span class="c">// Add error for parameters not found</span>
            <b>if</b> (<span class="r26 r">bindingInfo</span>.<a href="#52787ab8ce126866" class="i property">ParametersNotFound</a> != <b>null</b>)
            {
                <b>foreach</b> (<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r32 rd" class="r32 r">parameterNotFound</span> <b>in</b> <span class="r26 r">bindingInfo</span>.<a href="#52787ab8ce126866" class="i property">ParametersNotFound</a>)
                {
                    <a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r33 rd" class="r33 r">bindingException</span> =
                        <b>new</b> <span class="t">ParameterBindingException</span>(
                            <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <b>null</b>,
                            <span class="r32 r">parameterNotFound</span>.<a href="../parser/ast.cs.html#c02cc0fd1f27d9da" class="i property">ErrorPosition</a>,
                            <span class="r32 r">parameterNotFound</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>,
                            <b>null</b>,
                            <b>null</b>,
                            <span class="i">ParameterBinderStrings</span>.<span class="i">NamedParameterNotFound</span>,
                            <span class="s">&quot;NamedParameterNotFound&quot;</span>);
                    <a href="#2adc460fbc055cd5" class="i property">BindingExceptions</a>.<span class="i">Add</span>(<span class="r32 r">parameterNotFound</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <b>new</b> <a href="#00b3ce33f2504d01" class="t constructor">StaticBindingError</a>(<span class="r32 r">parameterNotFound</span>, <span class="r33 r">bindingException</span>));
                }
            }
 
            <span class="c">// Add error for ambiguous parameters</span>
            <b>if</b> (<span class="r26 r">bindingInfo</span>.<a href="#93392c80a0f80091" class="i property">AmbiguousParameters</a> != <b>null</b>)
            {
                <b>foreach</b> (<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r34 rd" class="r34 r">ambiguousParameter</span> <b>in</b> <span class="r26 r">bindingInfo</span>.<a href="#93392c80a0f80091" class="i property">AmbiguousParameters</a>)
                {
                    <a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r35 rd" class="r35 r">bindingException</span> = <span class="r26 r">bindingInfo</span>.<a href="#143337e4f7eb1dc9" class="i property">BindingExceptions</a>[<span class="r34 r">ambiguousParameter</span>];
                    <a href="#2adc460fbc055cd5" class="i property">BindingExceptions</a>.<span class="i">Add</span>(<span class="r34 r">ambiguousParameter</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <b>new</b> <a href="#00b3ce33f2504d01" class="t constructor">StaticBindingError</a>(<span class="r34 r">ambiguousParameter</span>, <span class="r35 r">bindingException</span>));
                }
            }
 
            <span class="c">// Add error for unbound positional parameters</span>
            <b>if</b> (<span class="r26 r">bindingInfo</span>.<a href="#1f5d8bae92d1fc01" class="i property">UnboundArguments</a> != <b>null</b>)
            {
                <b>foreach</b> (<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r36 rd" class="r36 r">unboundArgument</span> <b>in</b> <span class="r26 r">bindingInfo</span>.<a href="#1f5d8bae92d1fc01" class="i property">UnboundArguments</a>)
                {
                    <a href="#efefd42679f08437" class="t t">AstPair</a> <span id="r37 rd" class="r37 r">argument</span> = <span class="r36 r">unboundArgument</span> <b>as</b> <a href="#efefd42679f08437" class="t t">AstPair</a>;
 
                    <a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r38 rd" class="r38 r">bindingException</span> =
                        <b>new</b> <span class="t">ParameterBindingException</span>(
                            <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                            <b>null</b>,
                            <span class="r37 r">argument</span>.<a href="#310069eab93d5165" class="i property">Argument</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <span class="r37 r">argument</span>.<a href="#310069eab93d5165" class="i property">Argument</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>,
                            <b>null</b>,
                            <b>null</b>,
                            <span class="i">ParameterBinderStrings</span>.<span class="i">PositionalParameterNotFound</span>,
                            <span class="s">&quot;PositionalParameterNotFound&quot;</span>);
                    <a href="#2adc460fbc055cd5" class="i property">BindingExceptions</a>.<span class="i">Add</span>(<span class="r37 r">argument</span>.<a href="#310069eab93d5165" class="i property">Argument</a>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>, <b>new</b> <a href="#00b3ce33f2504d01" class="t constructor">StaticBindingError</a>(<span class="r37 r">argument</span>.<a href="#310069eab93d5165" class="i property">Argument</a>, <span class="r38 r">bindingException</span>));
                }
            }
 
            <span class="c">// Process the bound parameters</span>
            <b>if</b> (<span class="r26 r">bindingInfo</span>.<a href="#05127fa9589c0eeb" class="i property">BoundParameters</a> != <b>null</b>)
            {
                <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r39 rd" class="r39 r">item</span> <b>in</b> <span class="r26 r">bindingInfo</span>.<a href="#05127fa9589c0eeb" class="i property">BoundParameters</a>)
                {
                    <a href="../CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a> <span id="r40 rd" class="r40 r">parameter</span> = <span class="r39 r">item</span>.<span class="i">Value</span>.<span class="i">Parameter</span>;
                    <a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r41 rd" class="r41 r">value</span> = <b>null</b>;
                    <b>object</b> <span id="r42 rd" class="r42 r">constantValue</span> = <b>null</b>;
 
                    <span class="c">// This is a single argument</span>
                    <a href="#efefd42679f08437" class="t t">AstPair</a> <span id="r43 rd" class="r43 r">argumentAstPair</span> = <span class="r26 r">bindingInfo</span>.<a href="#0890fafe524fd733" class="i property">BoundArguments</a>[<span class="r39 r">item</span>.<span class="i">Key</span>] <b>as</b> <a href="#efefd42679f08437" class="t t">AstPair</a>;
                    <b>if</b> (<span class="r43 r">argumentAstPair</span> != <b>null</b>)
                    {
                        <span class="r41 r">value</span> = <span class="r43 r">argumentAstPair</span>.<a href="#310069eab93d5165" class="i property">Argument</a>;
                    }
 
                    <span class="c">// This is a parameter that took an argument, as well as ValueFromRemainingArguments.</span>
                    <span class="c">// Merge the arguments into a single fake argument.</span>
                    <a href="#d3a0a7f99c8105c4" class="t t">AstArrayPair</a> <span id="r44 rd" class="r44 r">argumentAstArrayPair</span> = <span class="r26 r">bindingInfo</span>.<a href="#0890fafe524fd733" class="i property">BoundArguments</a>[<span class="r39 r">item</span>.<span class="i">Key</span>] <b>as</b> <a href="#d3a0a7f99c8105c4" class="t t">AstArrayPair</a>;
                    <b>if</b> (<span class="r44 r">argumentAstArrayPair</span> != <b>null</b>)
                    {
                        <span class="i">List</span>&lt;<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r45 rd" class="r45 r">arguments</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;();
                        <b>foreach</b> (<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r46 rd" class="r46 r">expression</span> <b>in</b> <span class="r44 r">argumentAstArrayPair</span>.<a href="#5ea2ac266039b42b" class="i property">Argument</a>)
                        {
                            <a href="../parser/ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a> <span id="r47 rd" class="r47 r">expressionArray</span> = <span class="r46 r">expression</span> <b>as</b> <a href="../parser/ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>;
                            <b>if</b> (<span class="r47 r">expressionArray</span> != <b>null</b>)
                            {
                                <b>foreach</b> (<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r48 rd" class="r48 r">newExpression</span> <b>in</b> <span class="r47 r">expressionArray</span>.<a href="../parser/ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>)
                                {
                                    <span class="r45 r">arguments</span>.<span class="i">Add</span>((<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>)<span class="r48 r">newExpression</span>.<a href="../parser/ast.cs.html#7559dca1878820e8" class="i method">Copy</a>());
                                }
                            }
                            <b>else</b>
                            {
                                <span class="r45 r">arguments</span>.<span class="i">Add</span>((<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>)<span class="r46 r">expression</span>.<a href="../parser/ast.cs.html#7559dca1878820e8" class="i method">Copy</a>());
                            }
                        }
 
                        <span class="c">// Define the virtual extent and virtual ArrayLiteral.</span>
                        <a href="../parser/Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r49 rd" class="r49 r">fakeExtent</span> = <span class="r45 r">arguments</span>[0].<span class="i">Extent</span>;
                        <a href="../parser/ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a> <span id="r50 rd" class="r50 r">fakeArguments</span> = <b>new</b> <span class="t">ArrayLiteralAst</span>(<span class="r49 r">fakeExtent</span>, <span class="r45 r">arguments</span>);
                        <span class="r41 r">value</span> = <span class="r50 r">fakeArguments</span>;
                    }
 
                    <span class="c">// Special handling of switch parameters</span>
                    <b>if</b> (<span class="r40 r">parameter</span>.<a href="../CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a> == <b>typeof</b>(<a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>))
                    {
                        <b>if</b> ((<span class="r41 r">value</span> != <b>null</b>) &amp;&amp;
                            (<b>string</b>.<span class="i">Equals</span>(<span class="s">&quot;$false&quot;</span>, <span class="r41 r">value</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
                        {
                            <b>continue</b>;
                        }
 
                        <span class="r42 r">constantValue</span> = <b>true</b>;
                    }
 
                    <span class="c">// We got a parameter and a value</span>
                    <b>if</b> ((<span class="r41 r">value</span> != <b>null</b>) || (<span class="r42 r">constantValue</span> != <b>null</b>))
                    {
                        <a href="#e54921e80ff4b0b1" class="i property">BoundParameters</a>.<span class="i">Add</span>(<span class="r39 r">item</span>.<span class="i">Key</span>, <b>new</b> <a href="#72484f76d3b6fd53" class="t constructor">ParameterBindingResult</a>(<span class="r40 r">parameter</span>, <span class="r41 r">value</span>, <span class="r42 r">constantValue</span>));
                    }
                    <b>else</b>
                    {
                        <b>bool</b> <span id="r51 rd" class="r51 r">takesValueFromPipeline</span> = <b>false</b>;
                        <b>foreach</b> (<a href="../ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r52 rd" class="r52 r">parameterSet</span> <b>in</b> <span class="r40 r">parameter</span>.<a href="../CompiledCommandParameter.cs.html#6734aa34600c1096" class="i method">GetMatchingParameterSetData</a>(<span class="r26 r">bindingInfo</span>.<a href="#c06c8a4dc27d4026" class="i property">ValidParameterSetsFlags</a>))
                        {
                            <b>if</b> (<span class="r52 r">parameterSet</span>.<a href="../ParameterSetSpecificMetadata.cs.html#6b00e8f2cc8f5221" class="i property">ValueFromPipeline</a>)
                            {
                                <span class="r51 r">takesValueFromPipeline</span> = <b>true</b>;
                                <b>break</b>;
                            }
                        }
 
                        <b>if</b> (!<span class="r51 r">takesValueFromPipeline</span>)
                        {
                            <span class="c">// We have a parameter with no value that isn&#39;t a switch parameter, or input parameter</span>
                            <a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r53 rd" class="r53 r">bindingException</span> =
                                <b>new</b> <span class="t">ParameterBindingException</span>(
                                    <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                                    <b>null</b>,
                                    <span class="r25 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[0].<span class="i">Extent</span>,
                                    <span class="r40 r">parameter</span>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>,
                                    <span class="r40 r">parameter</span>.<a href="../CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>,
                                    <b>null</b>,
                                    <span class="i">ParameterBinderStrings</span>.<span class="i">MissingArgument</span>,
                                    <span class="s">&quot;MissingArgument&quot;</span>);
 
                            <a href="#2adc460fbc055cd5" class="i property">BindingExceptions</a>.<span class="i">Add</span>(<span class="r25 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[0].<span class="i">Extent</span>.<span class="i">Text</span>,
                                <b>new</b> <span class="t">StaticBindingError</span>(<span class="r25 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[0], <span class="r53 r">bindingException</span>));
                        }
                    }
                }
            }
        }
 
        <b>private void</b> <a id="ea1f93400aba5dd3" href="../../R/ea1f93400aba5dd3.html" target="n" data-glyph="76,1" class="i method">AddDuplicateParameterBindingException</a>(<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r54 rd" class="r54 r">duplicateParameter</span>)
        {
            <b>if</b> (<span class="r54 r">duplicateParameter</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r55 rd" class="r55 r">bindingException</span> =
                <b>new</b> <span class="t">ParameterBindingException</span>(
                    <a href="../ErrorPackage.cs.html#0e80a9653d75dd2a" class="t t">ErrorCategory</a>.<a href="../ErrorPackage.cs.html#846d2b572f2c4820" class="i field">InvalidArgument</a>,
                    <b>null</b>,
                    <span class="r54 r">duplicateParameter</span>.<a href="../parser/ast.cs.html#c02cc0fd1f27d9da" class="i property">ErrorPosition</a>,
                    <span class="r54 r">duplicateParameter</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>,
                    <b>null</b>,
                    <b>null</b>,
                    <span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>,
                    <b>nameof</b>(<span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>));
            <span class="c">// if the duplicated Parameter Name appears more than twice, we will ignore as we already have similar bindingException.</span>
            <b>if</b> (!<a href="#2adc460fbc055cd5" class="i property">BindingExceptions</a>.<span class="i">ContainsKey</span>(<span class="r54 r">duplicateParameter</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>))
            {
                <a href="#2adc460fbc055cd5" class="i property">BindingExceptions</a>.<span class="i">Add</span>(<span class="r54 r">duplicateParameter</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <b>new</b> <a href="#00b3ce33f2504d01" class="t constructor">StaticBindingError</a>(<span class="r54 r">duplicateParameter</span>, <span class="r55 r">bindingException</span>));
            }
        }
 
        <b>private</b> <a href="#5ac9244be24c2bbd" class="t t">PseudoBindingInfo</a> <a id="654e6d4cecf1fc44" href="../../R/654e6d4cecf1fc44.html" target="n" data-glyph="46,1" class="i field">_bindingInfo</a> = <b>null</b>;
 
        <b>private void</b> <a id="e1901fb933a8363d" href="../../R/e1901fb933a8363d.html" target="n" data-glyph="76,1" class="i method">CreateBindingResultForSyntacticBind</a>(<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r56 rd" class="r56 r">commandAst</span>)
        {
            <b>bool</b> <span id="r57 rd" class="r57 r">foundCommand</span> = <b>false</b>;
 
            <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r58 rd" class="r58 r">currentParameter</span> = <b>null</b>;
            <b>int</b> <span id="r59 rd" class="r59 r">position</span> = 0;
            <a href="#15f8f4f4f6f1cb09" class="t t">ParameterBindingResult</a> <span id="r60 rd" class="r60 r">bindingResult</span> = <b>new</b> <a href="#5280311cf081262f" class="t constructor">ParameterBindingResult</a>();
 
            <b>foreach</b> (<a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r61 rd" class="r61 r">commandElement</span> <b>in</b> <span class="r56 r">commandAst</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>)
            {
                <span class="c">// Skip the command name</span>
                <b>if</b> (!<span class="r57 r">foundCommand</span>)
                {
                    <span class="r57 r">foundCommand</span> = <b>true</b>;
                    <b>continue</b>;
                }
 
                <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r62 rd" class="r62 r">parameter</span> = <span class="r61 r">commandElement</span> <b>as</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>;
                <b>if</b> (<span class="r62 r">parameter</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r58 r">currentParameter</span> != <b>null</b>)
                    {
                        <span class="c">// Assume it was a switch</span>
                        <a href="#d8e4d204fc92ecee" class="i method">AddSwitch</a>(<span class="r58 r">currentParameter</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <span class="r60 r">bindingResult</span>);
                        <a href="#9cb34f93c5eb0884" class="i method">ResetCurrentParameter</a>(<b>ref</b> <span class="r58 r">currentParameter</span>, <b>ref</b> <span class="r60 r">bindingResult</span>);
                    }
 
                    <span class="c">// If this is an actual parameter, get its name.</span>
                    <b>string</b> <span id="r63 rd" class="r63 r">parameterName</span> = <span class="r62 r">parameter</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>;
                    <span class="r60 r">bindingResult</span>.<a href="#2eb0a9f4c6d73128" class="i property">Value</a> = <span class="r62 r">parameter</span>;
 
                    <span class="c">// If it&#39;s a parameter with argument, add them both to the dictionary</span>
                    <b>if</b> (<span class="r62 r">parameter</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a> != <b>null</b>)
                    {
                        <span class="r60 r">bindingResult</span>.<a href="#2eb0a9f4c6d73128" class="i property">Value</a> = <span class="r62 r">parameter</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a>;
 
                        <a href="#eb9979a361f672f6" class="i method">AddBoundParameter</a>(<span class="r62 r">parameter</span>, <span class="r63 r">parameterName</span>, <span class="r60 r">bindingResult</span>);
                        <a href="#9cb34f93c5eb0884" class="i method">ResetCurrentParameter</a>(<b>ref</b> <span class="r58 r">currentParameter</span>, <b>ref</b> <span class="r60 r">bindingResult</span>);
                    }
                    <span class="c">// Otherwise, it&#39;s just a parameter and the argument is to follow.</span>
                    <b>else</b>
                    {
                        <span class="c">// Store our current parameter</span>
                        <span class="r58 r">currentParameter</span> = <span class="r62 r">parameter</span>;
                    }
                }
                <b>else</b>
                {
                    <span class="c">// This isn&#39;t a parameter, it&#39;s a value for the previous parameter</span>
                    <b>if</b> (<span class="r58 r">currentParameter</span> != <b>null</b>)
                    {
                        <span class="r60 r">bindingResult</span>.<a href="#2eb0a9f4c6d73128" class="i property">Value</a> = <span class="r61 r">commandElement</span>;
                        <a href="#eb9979a361f672f6" class="i method">AddBoundParameter</a>(<span class="r58 r">currentParameter</span>, <span class="r58 r">currentParameter</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <span class="r60 r">bindingResult</span>);
                    }
                    <b>else</b>
                    {
                        <span class="c">// Assume positional</span>
                        <span class="r60 r">bindingResult</span>.<a href="#2eb0a9f4c6d73128" class="i property">Value</a> = <span class="r61 r">commandElement</span>;
                        <span class="i">AddBoundParameter</span>(<b>null</b>, <span class="r59 r">position</span>.<span class="i">ToString</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>), <span class="r60 r">bindingResult</span>);
                        <span class="r59 r">position</span>++;
                    }
 
                    <a href="#9cb34f93c5eb0884" class="i method">ResetCurrentParameter</a>(<b>ref</b> <span class="r58 r">currentParameter</span>, <b>ref</b> <span class="r60 r">bindingResult</span>);
                }
            }
 
            <span class="c">// Catch any extra parameters at the end of the command</span>
            <b>if</b> (<span class="r58 r">currentParameter</span> != <b>null</b>)
            {
                <span class="c">// Assume it was a switch</span>
                <a href="#d8e4d204fc92ecee" class="i method">AddSwitch</a>(<span class="r58 r">currentParameter</span>.<a href="../parser/ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <span class="r60 r">bindingResult</span>);
            }
        }
 
        <b>private void</b> <a id="eb9979a361f672f6" href="../../R/eb9979a361f672f6.html" target="n" data-glyph="76,1" class="i method">AddBoundParameter</a>(<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r64 rd" class="r64 r">parameter</span>, <b>string</b> <span id="r65 rd" class="r65 r">parameterName</span>, <a href="#15f8f4f4f6f1cb09" class="t t">ParameterBindingResult</a> <span id="r66 rd" class="r66 r">bindingResult</span>)
        {
            <b>if</b> (<a href="#e54921e80ff4b0b1" class="i property">BoundParameters</a>.<span class="i">ContainsKey</span>(<span class="r65 r">parameterName</span>))
            {
                <a href="#ea1f93400aba5dd3" class="i method">AddDuplicateParameterBindingException</a>(<span class="r64 r">parameter</span>);
            }
            <b>else</b>
            {
                <a href="#e54921e80ff4b0b1" class="i property">BoundParameters</a>.<span class="i">Add</span>(<span class="r65 r">parameterName</span>, <span class="r66 r">bindingResult</span>);
            }
        }
 
        <b>private static void</b> <a id="9cb34f93c5eb0884" href="../../R/9cb34f93c5eb0884.html" target="n" data-glyph="76,1" class="i method">ResetCurrentParameter</a>(<b>ref</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r67 rd" class="r67 r">currentParameter</span>, <b>ref</b> <a href="#15f8f4f4f6f1cb09" class="t t">ParameterBindingResult</a> <span id="r68 rd" class="r68 r">bindingResult</span>)
        {
            <span class="r67 r">currentParameter</span> = <b>null</b>;
            <span class="r68 r">bindingResult</span> = <b>new</b> <a href="#5280311cf081262f" class="t constructor">ParameterBindingResult</a>();
        }
 
        <b>private void</b> <a id="d8e4d204fc92ecee" href="../../R/d8e4d204fc92ecee.html" target="n" data-glyph="76,1" class="i method">AddSwitch</a>(<b>string</b> <span id="r69 rd" class="r69 r">currentParameter</span>, <a href="#15f8f4f4f6f1cb09" class="t t">ParameterBindingResult</a> <span id="r70 rd" class="r70 r">bindingResult</span>)
        {
            <span class="r70 r">bindingResult</span>.<a href="#852cbd614441cc24" class="i property">ConstantValue</a> = <b>true</b>;
            <a href="#eb9979a361f672f6" class="i method">AddBoundParameter</a>(<b>null</b>, <span class="r69 r">currentParameter</span>, <span class="r70 r">bindingResult</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#15f8f4f4f6f1cb09" class="t t">ParameterBindingResult</a>&gt; <a id="e54921e80ff4b0b1" href="../../R/e54921e80ff4b0b1.html" target="n" data-glyph="102,1" class="i property">BoundParameters</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#f5ebcc4d4efbbd08" class="t t">StaticBindingError</a>&gt; <a id="2adc460fbc055cd5" href="../../R/2adc460fbc055cd5.html" target="n" data-glyph="102,1" class="i property">BindingExceptions</a> { <b>get</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents the binding of a parameter to its argument.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="15f8f4f4f6f1cb09" href="../../R/15f8f4f4f6f1cb09.html" target="n" data-glyph="0,0" class="t t">ParameterBindingResult</a>
    {
        <b>internal</b> <a id="72484f76d3b6fd53" href="../../R/72484f76d3b6fd53.html" target="n" data-glyph="74,1" class="t constructor">ParameterBindingResult</a>(<a href="../CompiledCommandParameter.cs.html#0bb5a64f862f9cc4" class="t t">CompiledCommandParameter</a> <span id="r71 rd" class="r71 r">parameter</span>, <a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r72 rd" class="r72 r">value</span>, <b>object</b> <span id="r73 rd" class="r73 r">constantValue</span>)
        {
            <a href="#15f8f4f4f6f1cb09" class="k">this</a>.<a href="#3258b395d21f428a" class="i property">Parameter</a> = <b>new</b> <a href="../TypeMetadata.cs.html#f52c31fb7fafa0b1" class="t constructor">ParameterMetadata</a>(<span class="r71 r">parameter</span>);
            <a href="#15f8f4f4f6f1cb09" class="k">this</a>.<a href="#2eb0a9f4c6d73128" class="i property">Value</a> = <span class="r72 r">value</span>;
            <a href="#15f8f4f4f6f1cb09" class="k">this</a>.<a href="#852cbd614441cc24" class="i property">ConstantValue</a> = <span class="r73 r">constantValue</span>;
        }
 
        <b>internal</b> <a id="5280311cf081262f" href="../../R/5280311cf081262f.html" target="n" data-glyph="74,1" class="t constructor">ParameterBindingResult</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../TypeMetadata.cs.html#8202ce4164ad3758" class="t t">ParameterMetadata</a> <a id="3258b395d21f428a" href="../../R/3258b395d21f428a.html" target="n" data-glyph="102,1" class="i property">Parameter</a> { <b>get</b>; <b>internal set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public object</b> <a id="852cbd614441cc24" href="../../R/852cbd614441cc24.html" target="n" data-glyph="102,1" class="i property">ConstantValue</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#424f41d3a066dec4" class="i field">_constantValue</a>;
            }
 
            <b>internal set</b>
            {
                <b>if</b> (<b>value</b> != <b>null</b>)
                {
                    <a href="#424f41d3a066dec4" class="i field">_constantValue</a> = <b>value</b>;
                }
            }
        }
 
        <b>private object</b> <a id="424f41d3a066dec4" href="../../R/424f41d3a066dec4.html" target="n" data-glyph="46,1" class="i field">_constantValue</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <a id="2eb0a9f4c6d73128" href="../../R/2eb0a9f4c6d73128.html" target="n" data-glyph="102,1" class="i property">Value</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#eded8dda80f0d57f" class="i field">_value</a>;
            }
 
            <b>internal set</b>
            {
                <a href="#eded8dda80f0d57f" class="i field">_value</a> = <b>value</b>;
 
                <a href="../parser/ast.cs.html#ebd8ad798cde7861" class="t t">ConstantExpressionAst</a> <span id="r74 rd" class="r74 r">constantValueAst</span> = <b>value as</b> <a href="../parser/ast.cs.html#ebd8ad798cde7861" class="t t">ConstantExpressionAst</a>;
                <b>if</b> (<span class="r74 r">constantValueAst</span> != <b>null</b>)
                {
                    <a href="#15f8f4f4f6f1cb09" class="k">this</a>.<a href="#852cbd614441cc24" class="i property">ConstantValue</a> = <span class="r74 r">constantValueAst</span>.<a href="../parser/ast.cs.html#8e2d2054af044253" class="i property">Value</a>;
                }
            }
        }
 
        <b>private</b> <a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <a id="eded8dda80f0d57f" href="../../R/eded8dda80f0d57f.html" target="n" data-glyph="46,1" class="i field">_value</a>;
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents the exception generated by the static parameter binding process.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="f5ebcc4d4efbbd08" href="../../R/f5ebcc4d4efbbd08.html" target="n" data-glyph="0,0" class="t t">StaticBindingError</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a StaticBindingException.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r75 r">commandElement</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The element associated with the exception.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r76 r">exception</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The parameter binding exception that got raised.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="00b3ce33f2504d01" href="../../R/00b3ce33f2504d01.html" target="n" data-glyph="74,1" class="t constructor">StaticBindingError</a>(<a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r75 rd" class="r75 r">commandElement</span>, <a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r76 rd" class="r76 r">exception</span>)
        {
            <a href="#f5ebcc4d4efbbd08" class="k">this</a>.<a href="#e9547b2385e6d9eb" class="i property">CommandElement</a> = <span class="r75 r">commandElement</span>;
            <a href="#f5ebcc4d4efbbd08" class="k">this</a>.<a href="#2b1d2a62d2047196" class="i property">BindingException</a> = <span class="r76 r">exception</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The command element associated with the exception.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <a id="e9547b2385e6d9eb" href="../../R/e9547b2385e6d9eb.html" target="n" data-glyph="102,1" class="i property">CommandElement</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ParameterBindingException that this command element caused.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <a id="2b1d2a62d2047196" href="../../R/2b1d2a62d2047196.html" target="n" data-glyph="102,1" class="i property">BindingException</a> { <b>get</b>; }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;PseudoBindingInfo&quot;
 
    <b>internal enum</b> <a id="32dafa2abbeb3f2b" href="../../R/32dafa2abbeb3f2b.html" target="n" data-glyph="20,0" class="t t"><span id="f94f40e189e1ea7c">PseudoBindingInfoType</span></a>
    {
        <a id="dde67aa5a8134b0c" href="../../R/dde67aa5a8134b0c.html" target="n" data-glyph="24,1" class="i field">PseudoBindingFail</a> = 0,
        <a id="fac4de227da7e29b" href="../../R/fac4de227da7e29b.html" target="n" data-glyph="24,1" class="i field">PseudoBindingSucceed</a> = 1,
    }
 
    <b>internal sealed class</b> <a id="5ac9244be24c2bbd" href="../../R/5ac9244be24c2bbd.html" target="n" data-glyph="2,0" class="t t">PseudoBindingInfo</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pseudo binding succeeded.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r77 r">commandInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r78 r">validParameterSetsFlags</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r79 r">defaultParameterSetFlag</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">boundParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r81 r">unboundParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r82 r">boundArguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">boundPositionalParameter</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">allParsedArguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r85 r">parametersNotFound</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r86 r">ambiguousParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r87 r">bindingExceptions</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r88 r">duplicateParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r89 r">unboundArguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="04bda2b17a75ec09" href="../../R/04bda2b17a75ec09.html" target="n" data-glyph="74,1" class="t constructor">PseudoBindingInfo</a>(
            <a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r77 rd" class="r77 r">commandInfo</span>,
            <b>uint</b> <span id="r78 rd" class="r78 r">validParameterSetsFlags</span>,
            <b>uint</b> <span id="r79 rd" class="r79 r">defaultParameterSetFlag</span>,
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r80 rd" class="r80 r">boundParameters</span>,
            <span class="i">List</span>&lt;<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r81 rd" class="r81 r">unboundParameters</span>,
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r82 rd" class="r82 r">boundArguments</span>,
            <span class="i">Collection</span>&lt;<b>string</b>&gt; <span id="r83 rd" class="r83 r">boundPositionalParameter</span>,
            <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r84 rd" class="r84 r">allParsedArguments</span>,
            <span class="i">Collection</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>&gt; <span id="r85 rd" class="r85 r">parametersNotFound</span>,
            <span class="i">Collection</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>&gt; <span id="r86 rd" class="r86 r">ambiguousParameters</span>,
            <span class="i">Dictionary</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>, <a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>&gt; <span id="r87 rd" class="r87 r">bindingExceptions</span>,
            <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r88 rd" class="r88 r">duplicateParameters</span>,
            <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r89 rd" class="r89 r">unboundArguments</span>)
        {
            <a href="#cfda88784bdbed0a" class="i property">CommandInfo</a> = <span class="r77 r">commandInfo</span>;
            <a href="#be318ae0c4315a2a" class="i property">InfoType</a> = <a href="#32dafa2abbeb3f2b" class="t t">PseudoBindingInfoType</a>.<a href="#fac4de227da7e29b" class="i field">PseudoBindingSucceed</a>;
            <a href="#c06c8a4dc27d4026" class="i property">ValidParameterSetsFlags</a> = <span class="r78 r">validParameterSetsFlags</span>;
            <a href="#b621e7fcaed07b69" class="i property">DefaultParameterSetFlag</a> = <span class="r79 r">defaultParameterSetFlag</span>;
            <a href="#05127fa9589c0eeb" class="i property">BoundParameters</a> = <span class="r80 r">boundParameters</span>;
            <a href="#a765b55f276ef803" class="i property">UnboundParameters</a> = <span class="r81 r">unboundParameters</span>;
            <a href="#0890fafe524fd733" class="i property">BoundArguments</a> = <span class="r82 r">boundArguments</span>;
            <a href="#6b4c12da1a031a6f" class="i property">BoundPositionalParameter</a> = <span class="r83 r">boundPositionalParameter</span>;
            <a href="#e625bf306f80f711" class="i property">AllParsedArguments</a> = <span class="r84 r">allParsedArguments</span>;
            <a href="#52787ab8ce126866" class="i property">ParametersNotFound</a> = <span class="r85 r">parametersNotFound</span>;
            <a href="#93392c80a0f80091" class="i property">AmbiguousParameters</a> = <span class="r86 r">ambiguousParameters</span>;
            <a href="#143337e4f7eb1dc9" class="i property">BindingExceptions</a> = <span class="r87 r">bindingExceptions</span>;
            <a href="#e8b7e6ad67a8adf2" class="i property">DuplicateParameters</a> = <span class="r88 r">duplicateParameters</span>;
            <a href="#1f5d8bae92d1fc01" class="i property">UnboundArguments</a> = <span class="r89 r">unboundArguments</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The pseudo binding failed with parameter set confliction.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r90 r">commandInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r91 r">defaultParameterSetFlag</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r92 r">allParsedArguments</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r93 r">unboundParameters</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal</b> <a id="65ea27d794d58d36" href="../../R/65ea27d794d58d36.html" target="n" data-glyph="74,1" class="t constructor">PseudoBindingInfo</a>(
            <a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <span id="r90 rd" class="r90 r">commandInfo</span>,
            <b>uint</b> <span id="r91 rd" class="r91 r">defaultParameterSetFlag</span>,
            <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r92 rd" class="r92 r">allParsedArguments</span>,
            <span class="i">List</span>&lt;<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <span id="r93 rd" class="r93 r">unboundParameters</span>)
        {
            <a href="#cfda88784bdbed0a" class="i property">CommandInfo</a> = <span class="r90 r">commandInfo</span>;
            <a href="#be318ae0c4315a2a" class="i property">InfoType</a> = <a href="#32dafa2abbeb3f2b" class="t t">PseudoBindingInfoType</a>.<a href="#dde67aa5a8134b0c" class="i field">PseudoBindingFail</a>;
            <a href="#b621e7fcaed07b69" class="i property">DefaultParameterSetFlag</a> = <span class="r91 r">defaultParameterSetFlag</span>;
            <a href="#e625bf306f80f711" class="i property">AllParsedArguments</a> = <span class="r92 r">allParsedArguments</span>;
            <a href="#a765b55f276ef803" class="i property">UnboundParameters</a> = <span class="r93 r">unboundParameters</span>;
        }
 
        <b>internal string</b> <a id="8a99b7a836aade94" href="../../R/8a99b7a836aade94.html" target="n" data-glyph="104,1" class="i property">CommandName</a>
        {
            <b>get</b> { <b>return</b> <a href="#cfda88784bdbed0a" class="i property">CommandInfo</a>.<a href="../CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>; }
        }
 
        <b>internal</b> <a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <a id="cfda88784bdbed0a" href="../../R/cfda88784bdbed0a.html" target="n" data-glyph="104,1" class="i property">CommandInfo</a> { <b>get</b>; }
 
        <b>internal</b> <a href="#32dafa2abbeb3f2b" class="t t">PseudoBindingInfoType</a> <a id="be318ae0c4315a2a" href="../../R/be318ae0c4315a2a.html" target="n" data-glyph="104,1" class="i property">InfoType</a> { <b>get</b>; }
 
        <b>internal uint</b> <a id="c06c8a4dc27d4026" href="../../R/c06c8a4dc27d4026.html" target="n" data-glyph="104,1" class="i property">ValidParameterSetsFlags</a> { <b>get</b>; }
 
        <b>internal uint</b> <a id="b621e7fcaed07b69" href="../../R/b621e7fcaed07b69.html" target="n" data-glyph="104,1" class="i property">DefaultParameterSetFlag</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <a id="05127fa9589c0eeb" href="../../R/05127fa9589c0eeb.html" target="n" data-glyph="104,1" class="i property">BoundParameters</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">List</span>&lt;<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <a id="a765b55f276ef803" href="../../R/a765b55f276ef803.html" target="n" data-glyph="104,1" class="i property">UnboundParameters</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <a id="0890fafe524fd733" href="../../R/0890fafe524fd733.html" target="n" data-glyph="104,1" class="i property">BoundArguments</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <a id="1f5d8bae92d1fc01" href="../../R/1f5d8bae92d1fc01.html" target="n" data-glyph="104,1" class="i property">UnboundArguments</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="6b4c12da1a031a6f" href="../../R/6b4c12da1a031a6f.html" target="n" data-glyph="104,1" class="i property">BoundPositionalParameter</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <a id="e625bf306f80f711" href="../../R/e625bf306f80f711.html" target="n" data-glyph="104,1" class="i property">AllParsedArguments</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>&gt; <a id="52787ab8ce126866" href="../../R/52787ab8ce126866.html" target="n" data-glyph="104,1" class="i property">ParametersNotFound</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>&gt; <a id="93392c80a0f80091" href="../../R/93392c80a0f80091.html" target="n" data-glyph="104,1" class="i property">AmbiguousParameters</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">Dictionary</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>, <a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>&gt; <a id="143337e4f7eb1dc9" href="../../R/143337e4f7eb1dc9.html" target="n" data-glyph="104,1" class="i property">BindingExceptions</a> { <b>get</b>; }
 
        <b>internal</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <a id="e8b7e6ad67a8adf2" href="../../R/e8b7e6ad67a8adf2.html" target="n" data-glyph="104,1" class="i property">DuplicateParameters</a> { <b>get</b>; }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> &quot;PseudoBindingInfo&quot;
 
    <b>internal class</b> <a id="9dc50bf5ddf87930" href="../../R/9dc50bf5ddf87930.html" target="n" data-glyph="2,0" class="t t"><span id="527e91c1e931f7c8">PseudoParameterBinder</span></a>
    {
        <span class="c">/*
        /// &lt;summary&gt;
        /// Get the parameter binding metadata.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;possibleParameterSets&quot;&gt;&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        public Dictionary&lt;ParameterMetadata, ExpressionAst&gt; GetPseudoParameterBinding(out Collection&lt;ParameterSetMetadata&gt; possibleParameterSets)
        {
            ExecutionContext contextFromTls =
                System.Management.Automation.Runspaces.LocalPipeline.GetExecutionContextFromTLS();
            return GetPseudoParameterBinding(out possibleParameterSets, contextFromTls, null);
        }
        */</span>
 
        <b>internal enum</b> <a id="ad6e81c17c696e75" href="../../R/ad6e81c17c696e75.html" target="n" data-glyph="20,1" class="t t"><span id="cb97307af5b85fa0">BindingType</span></a>
        {
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Caller is binding a parameter argument.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="e9115d1d31266671" href="../../R/e9115d1d31266671.html" target="n" data-glyph="24,2" class="i field">ArgumentBinding</a> = 0,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Caller is performing completion on a parameter argument.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="240740e6b3591d03" href="../../R/240740e6b3591d03.html" target="n" data-glyph="24,2" class="i field">ArgumentCompletion</a>,
 
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
            <span class="c">///</span><span class="c"> Caller is performing completion on a parameter name.</span>
            <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
            <a id="aeae553133a922a5" href="../../R/aeae553133a922a5.html" target="n" data-glyph="24,2" class="i field">ParameterCompletion</a>
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get the parameter binding metadata.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r94 r">command</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r95 r">pipeArgumentType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicate the type of the piped-in argument.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r96 r">paramAstAtCursor</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The CommandParameterAst the cursor is pointing at.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">bindingType</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicates whether pseudo binding is for argument binding, argument completion, or parameter completion.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">PseudoBindingInfo.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal</b> <a href="#5ac9244be24c2bbd" class="t t">PseudoBindingInfo</a> <a id="4f331f824f2a1e35" href="../../R/4f331f824f2a1e35.html" target="n" data-glyph="74,1" class="i method">DoPseudoParameterBinding</a>(<a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r94 rd" class="r94 r">command</span>, <span class="i">Type</span> <span id="r95 rd" class="r95 r">pipeArgumentType</span>, <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r96 rd" class="r96 r">paramAstAtCursor</span>, <a href="#ad6e81c17c696e75" class="t t">BindingType</a> <span id="r97 rd" class="r97 r">bindingType</span>)
        {
            <b>if</b> (<span class="r94 r">command</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r94 r">command</span>));
            }
 
            <span class="c">// initialize/reset the private members</span>
            <a href="#34cf7f4b11f987f4" class="i method">InitializeMembers</a>();
            <a href="#abd38937d59c040d" class="i field">_commandAst</a> = <span class="r94 r">command</span>;
            <a href="#93b157a76faecf84" class="i field">_commandElements</a> = <span class="r94 r">command</span>.<a href="../parser/ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>;
            <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r98 rd" class="r98 r">unboundArguments</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt;();
 
            <span class="c">// analyze the command and reparse the arguments</span>
            {
                <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r99 rd" class="r99 r">executionContext</span> = <a href="../hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<a href="../hostifaces/LocalPipeline.cs.html#d3eaa3d3391ed484" class="i method">GetExecutionContextFromTLS</a>();
                <b>if</b> (<span class="r99 r">executionContext</span> != <b>null</b>)
                {
                    <span class="c">// WinBlue: 324316. This limits the interaction of pseudoparameterbinder with the actual host.</span>
                    <a href="#604421adc3cd3152" class="i method">SetTemporaryDefaultHost</a>(<span class="r99 r">executionContext</span>);
 
                    <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>? <span id="r100 rd" class="r100 r">previousLanguageMode</span> = <b>null</b>;
                    <b>try</b>
                    {
                        <span class="c">// Tab expansion is called from a trusted function - we should apply ConstrainedLanguage if necessary.</span>
                        <b>if</b> (<span class="r99 r">executionContext</span>.<a href="../ExecutionContext.cs.html#6ec645dc27615492" class="i property">HasRunspaceEverUsedConstrainedLanguageMode</a>)
                        {
                            <span class="r100 r">previousLanguageMode</span> = <span class="r99 r">executionContext</span>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a>;
                            <span class="r99 r">executionContext</span>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> = <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#9f1205fe78117fc2" class="i field">ConstrainedLanguage</a>;
                        }
 
                        <a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a> = <a href="#8486b45d334d8c7c" class="i method">PrepareCommandElements</a>(<span class="r99 r">executionContext</span>);
                    }
                    <b>finally</b>
                    {
                        <b>if</b> (<span class="r100 r">previousLanguageMode</span>.<span class="i">HasValue</span>)
                        {
                            <span class="r99 r">executionContext</span>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> = <span class="r100 r">previousLanguageMode</span>.<span class="i">Value</span>;
                        }
 
                        <a href="#718a8120aa652064" class="i method">RestoreHost</a>(<span class="r99 r">executionContext</span>);
                    }
                }
            }
 
            <b>if</b> (<a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a> &amp;&amp; (<a href="#3b9e620ffa15a49a" class="i field">_isPipelineInputExpected</a> || <span class="r95 r">pipeArgumentType</span> != <b>null</b>))
            {
                <a href="#d8bd73eaaced3cf7" class="i field">_pipelineInputType</a> = <span class="r95 r">pipeArgumentType</span>;
            }
 
            <a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a> = <a href="#10fbad37442ef51f" class="i method">ParseParameterArguments</a>(<span class="r96 r">paramAstAtCursor</span>);
 
            <b>if</b> (<a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a>)
            {
                <span class="c">// named binding</span>
                <span class="r98 r">unboundArguments</span> = <a href="#1324b5793bd7fa3c" class="i method">BindNamedParameters</a>();
                <a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a> = <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a> != 0;
 
                <span class="c">// positional binding</span>
                <span class="r98 r">unboundArguments</span> = <a href="#b862089bf6685abd" class="i method">BindPositionalParameter</a>(
                    <span class="r98 r">unboundArguments</span>,
                    <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a>,
                    <a href="#405d41a1a8e2e042" class="i field">_defaultParameterSetFlag</a>,
                    <span class="r97 r">bindingType</span>);
 
                <span class="c">// VFRA/pipeline binding if the given command is a binary cmdlet or a script cmdlet</span>
                <b>if</b> (!<a href="#e380c6d981e63c33" class="i field">_function</a>)
                {
                    <span class="r98 r">unboundArguments</span> = <a href="#ec5ff1ea284cf6ed" class="i method">BindRemainingParameters</a>(<span class="r98 r">unboundArguments</span>);
                    <a href="#a1644c76b31a32f2" class="i method">BindPipelineParameters</a>();
                }
 
                <span class="c">// Update available parameter sets based on bound arguments</span>
                <span class="c">// (x &amp; (x -1 ) == 0) is a bit hack to determine if something is</span>
                <span class="c">// exactly a power of two.</span>
                <b>bool</b> <span id="r101 rd" class="r101 r">parameterSetSpecified</span> = (<a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a> != 0) &amp;&amp;
                    (<a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a> != <span class="i">UInt32</span>.<span class="i">MaxValue</span>);
                <b>bool</b> <span id="r102 rd" class="r102 r">onlyOneRemainingParameterSet</span> = (<a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a> != 0) &amp;&amp;
                    (<a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a> &amp; (<a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a> - 1)) == 0;
                <b>if</b> ((<span class="r97 r">bindingType</span> != <a href="#ad6e81c17c696e75" class="t t">BindingType</a>.<a href="#aeae553133a922a5" class="i field">ParameterCompletion</a>) &amp;&amp; <span class="r101 r">parameterSetSpecified</span> &amp;&amp; (!<span class="r102 r">onlyOneRemainingParameterSet</span>))
                {
                    <a href="../CmdletParameterBinderController.cs.html#beea52684e39dd34" class="t t">CmdletParameterBinderController</a>.<span class="i">ResolveParameterSetAmbiguityBasedOnMandatoryParameters</span>(
                        <a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a>,
                        <a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>,
                        <b>null</b>,
                        <b>ref</b> <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a>,
                        <b>null</b>);
                }
            }
 
            <span class="c">// Binding failed</span>
            <b>if</b> (!<a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a>)
            {
                <span class="c">// The command is not a cmdlet, not a script cmdlet, and not a function</span>
                <b>if</b> (<a href="#191f926ce6c0d3a4" class="i field">_bindableParameters</a> == <b>null</b>)
                    <b>return</b> <b>null</b>;
 
                <span class="c">// get all bindable parameters</span>
                <a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>.<span class="i">Clear</span>();
                <a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>.<span class="i">AddRange</span>(<a href="#191f926ce6c0d3a4" class="i field">_bindableParameters</a>.<a href="../MergedCommandParameterMetadata.cs.html#d586f3508cda9bf3" class="i property">BindableParameters</a>.<span class="i">Values</span>);
 
                <b>return</b> <b>new</b> <a href="#65ea27d794d58d36" class="t constructor">PseudoBindingInfo</a>(
                    <a href="#c42e6b90d0a29d48" class="i field">_commandInfo</a>,
                    <a href="#405d41a1a8e2e042" class="i field">_defaultParameterSetFlag</a>,
                    <a href="#78783fa60ec7198a" class="i field">_arguments</a>,
                    <a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>);
            }
 
            <b>return</b> <b>new</b> <a href="#04bda2b17a75ec09" class="t constructor">PseudoBindingInfo</a>(
                <a href="#c42e6b90d0a29d48" class="i field">_commandInfo</a>,
                <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a>,
                <a href="#405d41a1a8e2e042" class="i field">_defaultParameterSetFlag</a>,
                <a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a>,
                <a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>,
                <a href="#5bafd4d13bc8d7df" class="i field">_boundArguments</a>,
                <a href="#f789d0fa8b770c73" class="i field">_boundPositionalParameter</a>,
                <a href="#78783fa60ec7198a" class="i field">_arguments</a>,
                <a href="#917df4363235397c" class="i field">_parametersNotFound</a>,
                <a href="#17b2205fc2a0efb0" class="i field">_ambiguousParameters</a>,
                <a href="#c86fdd66e0d8d163" class="i field">_bindingExceptions</a>,
                <a href="#55598c5354ac3d59" class="i field">_duplicateParameters</a>,
                <span class="r98 r">unboundArguments</span>
                );
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Sets a temporary default host on the ExecutionContext.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r103 r">executionContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ExecutionContext.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="604421adc3cd3152" href="../../R/604421adc3cd3152.html" target="n" data-glyph="76,1" class="i method">SetTemporaryDefaultHost</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r103 rd" class="r103 r">executionContext</span>)
        {
            <b>if</b> (<span class="r103 r">executionContext</span>.<a href="../ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>.<a href="../hostifaces/InternalHost.cs.html#89a9d2ce61a06e7f" class="i property">IsHostRefSet</a>)
            {
                <span class="c">// A temporary host is already set so we need to track and restore here, because</span>
                <span class="c">// setting the host again will overwrite the current one.</span>
                <a href="#66641a1318a37fb5" class="i field">_restoreHost</a> = <span class="r103 r">executionContext</span>.<a href="../ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>.<a href="../hostifaces/InternalHost.cs.html#f25431d0ab961179" class="i property">ExternalHost</a>;
 
                <span class="c">// Revert host back to its original state.</span>
                <span class="r103 r">executionContext</span>.<a href="../ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>.<a href="../hostifaces/InternalHost.cs.html#5a26ee5df20fbaa4" class="i method">RevertHostRef</a>();
            }
 
            <span class="c">// Temporarily set host to default.</span>
            <span class="r103 r">executionContext</span>.<a href="../ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>.<a href="../hostifaces/InternalHost.cs.html#537447f36276d774" class="i method">SetHostRef</a>(<b>new</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="t">DefaultHost</span>(
                <span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>,
                <span class="i">CultureInfo</span>.<span class="i">CurrentUICulture</span>));
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Restores original ExecutionContext host state.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r104 r">executionContext</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">ExecutionContext.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="718a8120aa652064" href="../../R/718a8120aa652064.html" target="n" data-glyph="76,1" class="i method">RestoreHost</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r104 rd" class="r104 r">executionContext</span>)
        {
            <span class="c">// Remove temporary host and revert to original.</span>
            <span class="r104 r">executionContext</span>.<a href="../ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>.<a href="../hostifaces/InternalHost.cs.html#5a26ee5df20fbaa4" class="i method">RevertHostRef</a>();
 
            <span class="c">// Re-apply saved host if any.</span>
            <b>if</b> (<a href="#66641a1318a37fb5" class="i field">_restoreHost</a> != <b>null</b>)
            {
                <span class="r104 r">executionContext</span>.<a href="../ExecutionContext.cs.html#24a4a46de18d1004" class="i property">EngineHostInterface</a>.<a href="../hostifaces/InternalHost.cs.html#537447f36276d774" class="i method">SetHostRef</a>(<a href="#66641a1318a37fb5" class="i field">_restoreHost</a>);
                <a href="#66641a1318a37fb5" class="i field">_restoreHost</a> = <b>null</b>;
            }
        }
 
        <span class="c">// Host to restore.</span>
        <b>private</b> <a href="../hostifaces/MshHost.cs.html#7b79cd90e035740e" class="t t">PSHost</a> <a id="66641a1318a37fb5" href="../../R/66641a1318a37fb5.html" target="n" data-glyph="46,1" class="i field">_restoreHost</a>;
 
        <span class="c">// command ast related states</span>
        <b>private</b> <a href="../parser/ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <a id="abd38937d59c040d" href="../../R/abd38937d59c040d.html" target="n" data-glyph="46,1" class="i field">_commandAst</a>;
        <b>private</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="../parser/ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt; <a id="93b157a76faecf84" href="../../R/93b157a76faecf84.html" target="n" data-glyph="46,1" class="i field">_commandElements</a>;
 
        <span class="c">// binding related states</span>
        <b>private bool</b> <a id="e380c6d981e63c33" href="../../R/e380c6d981e63c33.html" target="n" data-glyph="46,1" class="i field">_function</a> = <b>false</b>;
        <b>private string</b> <a id="9e0642a8972133d3" href="../../R/9e0642a8972133d3.html" target="n" data-glyph="46,1" class="i field">_commandName</a> = <b>null</b>;
        <b>private</b> <a href="../CommandInfo.cs.html#71babe57a99ca852" class="t t">CommandInfo</a> <a id="c42e6b90d0a29d48" href="../../R/c42e6b90d0a29d48.html" target="n" data-glyph="46,1" class="i field">_commandInfo</a> = <b>null</b>;
        <b>private uint</b> <a id="248dae4a8fd162f4" href="../../R/248dae4a8fd162f4.html" target="n" data-glyph="46,1" class="i field">_currentParameterSetFlag</a> = <b>uint</b>.<span class="i">MaxValue</span>;
        <b>private uint</b> <a id="405d41a1a8e2e042" href="../../R/405d41a1a8e2e042.html" target="n" data-glyph="46,1" class="i field">_defaultParameterSetFlag</a> = 0;
        <b>private</b> <a href="../MergedCommandParameterMetadata.cs.html#2ce55afbd6d4dfde" class="t t">MergedCommandParameterMetadata</a> <a id="191f926ce6c0d3a4" href="../../R/191f926ce6c0d3a4.html" target="n" data-glyph="46,1" class="i field">_bindableParameters</a> = <b>null</b>;
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <a id="c02ef3f02058b5b0" href="../../R/c02ef3f02058b5b0.html" target="n" data-glyph="46,1" class="i field">_boundParameters</a>;
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <a id="5bafd4d13bc8d7df" href="../../R/5bafd4d13bc8d7df.html" target="n" data-glyph="46,1" class="i field">_boundArguments</a>;
        <b>private</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <a id="78783fa60ec7198a" href="../../R/78783fa60ec7198a.html" target="n" data-glyph="46,1" class="i field">_arguments</a>;
        <b>private</b> <span class="i">Collection</span>&lt;<b>string</b>&gt; <a id="f789d0fa8b770c73" href="../../R/f789d0fa8b770c73.html" target="n" data-glyph="46,1" class="i field">_boundPositionalParameter</a>;
        <b>private</b> <span class="i">List</span>&lt;<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt; <a id="7859efc528f4a7ca" href="../../R/7859efc528f4a7ca.html" target="n" data-glyph="46,1" class="i field">_unboundParameters</a>;
 
        <span class="c">// tab expansion related states</span>
        <b>private</b> <span class="i">Type</span> <a id="d8bd73eaaced3cf7" href="../../R/d8bd73eaaced3cf7.html" target="n" data-glyph="46,1" class="i field">_pipelineInputType</a> = <b>null</b>;
        <b>private bool</b> <a id="4bb3133c5723cbd8" href="../../R/4bb3133c5723cbd8.html" target="n" data-glyph="46,1" class="i field">_bindingEffective</a> = <b>true</b>;
        <b>private bool</b> <a id="3b9e620ffa15a49a" href="../../R/3b9e620ffa15a49a.html" target="n" data-glyph="46,1" class="i field">_isPipelineInputExpected</a> = <b>false</b>;
        <b>private</b> <span class="i">Collection</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>&gt; <a id="917df4363235397c" href="../../R/917df4363235397c.html" target="n" data-glyph="46,1" class="i field">_parametersNotFound</a>;
        <b>private</b> <span class="i">Collection</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>&gt; <a id="17b2205fc2a0efb0" href="../../R/17b2205fc2a0efb0.html" target="n" data-glyph="46,1" class="i field">_ambiguousParameters</a>;
        <b>private</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <a id="55598c5354ac3d59" href="../../R/55598c5354ac3d59.html" target="n" data-glyph="46,1" class="i field">_duplicateParameters</a>;
        <b>private</b> <span class="i">Dictionary</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>, <a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>&gt; <a id="c86fdd66e0d8d163" href="../../R/c86fdd66e0d8d163.html" target="n" data-glyph="46,1" class="i field">_bindingExceptions</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Initialize collection/dictionary members when it&#39;s necessary.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private void</b> <a id="34cf7f4b11f987f4" href="../../R/34cf7f4b11f987f4.html" target="n" data-glyph="76,1" class="i method">InitializeMembers</a>()
        {
            <span class="c">// Initializing binding related members</span>
            <a href="#e380c6d981e63c33" class="i field">_function</a> = <b>false</b>;
            <a href="#9e0642a8972133d3" class="i field">_commandName</a> = <b>null</b>;
            <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a> = <b>uint</b>.<span class="i">MaxValue</span>;
            <a href="#405d41a1a8e2e042" class="i field">_defaultParameterSetFlag</a> = 0;
            <a href="#191f926ce6c0d3a4" class="i field">_bindableParameters</a> = <b>null</b>;
 
            <span class="c">// reuse the collections/dictionaries</span>
            <a href="#78783fa60ec7198a" class="i field">_arguments</a> ??= <b>new</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt;();
            <a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#5bafd4d13bc8d7df" class="i field">_boundArguments</a> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a> ??= <b>new</b> <span class="i">List</span>&lt;<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt;();
            <a href="#f789d0fa8b770c73" class="i field">_boundPositionalParameter</a> ??= <b>new</b> <span class="i">Collection</span>&lt;<b>string</b>&gt;();
            <a href="#c86fdd66e0d8d163" class="i field">_bindingExceptions</a> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>, <a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>&gt;();
 
            <a href="#78783fa60ec7198a" class="i field">_arguments</a>.<span class="i">Clear</span>();
            <a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a>.<span class="i">Clear</span>();
            <a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>.<span class="i">Clear</span>();
            <a href="#5bafd4d13bc8d7df" class="i field">_boundArguments</a>.<span class="i">Clear</span>();
            <a href="#f789d0fa8b770c73" class="i field">_boundPositionalParameter</a>.<span class="i">Clear</span>();
            <a href="#c86fdd66e0d8d163" class="i field">_bindingExceptions</a>.<span class="i">Clear</span>();
 
            <span class="c">// Initializing tab expansion related members</span>
            <a href="#d8bd73eaaced3cf7" class="i field">_pipelineInputType</a> = <b>null</b>;
            <a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a> = <b>true</b>;
            <a href="#3b9e620ffa15a49a" class="i field">_isPipelineInputExpected</a> = <b>false</b>;
 
            <span class="c">// reuse the collections</span>
            <a href="#917df4363235397c" class="i field">_parametersNotFound</a> ??= <b>new</b> <span class="i">Collection</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>&gt;();
            <a href="#17b2205fc2a0efb0" class="i field">_ambiguousParameters</a> ??= <b>new</b> <span class="i">Collection</span>&lt;<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>&gt;();
            <a href="#55598c5354ac3d59" class="i field">_duplicateParameters</a> ??= <b>new</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt;();
 
            <a href="#917df4363235397c" class="i field">_parametersNotFound</a>.<span class="i">Clear</span>();
            <a href="#17b2205fc2a0efb0" class="i field">_ambiguousParameters</a>.<span class="i">Clear</span>();
            <a href="#55598c5354ac3d59" class="i field">_duplicateParameters</a>.<span class="i">Clear</span>();
        }
 
        <b>private bool</b> <a id="8486b45d334d8c7c" href="../../R/8486b45d334d8c7c.html" target="n" data-glyph="76,1" class="i method">PrepareCommandElements</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r105 rd" class="r105 r">context</span>)
        {
            <b>int</b> <span id="r106 rd" class="r106 r">commandIndex</span> = 0;
            <b>bool</b> <span id="r107 rd" class="r107 r">dotSource</span> = <a href="#abd38937d59c040d" class="i field">_commandAst</a>.<a href="../parser/ast.cs.html#16e18484040f8b6f" class="i property">InvocationOperator</a> == <a href="../parser/token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="../parser/token.cs.html#a9023444a1ee3a84" class="i field">Dot</a>;
 
            <a href="../CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a> <span id="r108 rd" class="r108 r">processor</span> = <b>null</b>;
            <b>string</b> <span id="r109 rd" class="r109 r">commandName</span> = <b>null</b>;
            <b>try</b>
            {
                <span class="r108 r">processor</span> = <a href="#4b628969e673259d" class="i method">PrepareFromAst</a>(<span class="r105 r">context</span>, <b>out</b> <span class="r109 r">commandName</span>) ?? <span class="r105 r">context</span>.<a href="../ExecutionContext.cs.html#df39c8180123370b" class="i method">CreateCommand</a>(<span class="r109 r">commandName</span>, <span class="r107 r">dotSource</span>);
            }
            <b>catch</b> (<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>)
            {
                <span class="c">// Failed to create the CommandProcessor;</span>
                <b>return</b> <b>false</b>;
            }
 
            <a href="../CommandProcessor.cs.html#35bfa3d4fe5f92fc" class="k">var</a> <span id="r110 rd" class="r110 r">commandProcessor</span> = <span class="r108 r">processor</span> <b>as</b> <a href="../CommandProcessor.cs.html#35bfa3d4fe5f92fc" class="t t">CommandProcessor</a>;
            <a href="../ScriptCommandProcessor.cs.html#d9f57c5c0946b36a" class="k">var</a> <span id="r111 rd" class="r111 r">scriptProcessor</span> = <span class="r108 r">processor</span> <b>as</b> <a href="../ScriptCommandProcessor.cs.html#d9f57c5c0946b36a" class="t t">ScriptCommandProcessorBase</a>;
            <b>bool</b> <span id="r112 rd" class="r112 r">implementsDynamicParameters</span> = <span class="r110 r">commandProcessor</span> != <b>null</b> &amp;&amp;
                                               <span class="r110 r">commandProcessor</span>.<a href="../CommandProcessorBase.cs.html#b61b3a9315a42a73" class="i property">CommandInfo</a>.<a href="../CommandInfo.cs.html#2ddc8f9ff0560a66" class="i property">ImplementsDynamicParameters</a>;
 
            <b>var</b> <span id="r113 rd" class="r113 r">argumentsToGetDynamicParameters</span> = <span class="r112 r">implementsDynamicParameters</span>
                                                      ? <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;(<a href="#93b157a76faecf84" class="i field">_commandElements</a>.<span class="i">Count</span>)
                                                      : <b>null</b>;
            <b>if</b> (<span class="r110 r">commandProcessor</span> != <b>null</b> || <span class="r111 r">scriptProcessor</span> != <b>null</b>)
            {
                <span class="c">// Pre-processing the arguments -- command arguments</span>
                <b>for</b> (<span class="r106 r">commandIndex</span>++; <span class="r106 r">commandIndex</span> &lt; <a href="#93b157a76faecf84" class="i field">_commandElements</a>.<span class="i">Count</span>; <span class="r106 r">commandIndex</span>++)
                {
                    <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="k">var</a> <span id="r114 rd" class="r114 r">parameter</span> = <a href="#93b157a76faecf84" class="i field">_commandElements</a>[<span class="r106 r">commandIndex</span>] <b>as</b> <a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>;
                    <b>if</b> (<span class="r114 r">parameter</span> != <b>null</b>)
                    {
                        <b>if</b> (<span class="r113 r">argumentsToGetDynamicParameters</span> != <b>null</b>)
                        {
                            <span class="r113 r">argumentsToGetDynamicParameters</span>.<span class="i">Add</span>(<span class="r114 r">parameter</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>);
                        }
 
                        <a href="#efefd42679f08437" class="t t">AstPair</a> <span id="r115 rd" class="r115 r">parameterArg</span> = <span class="r114 r">parameter</span>.<a href="../parser/ast.cs.html#21fa828caf096206" class="i property">Argument</a> != <b>null</b>
                            ? <b>new</b> <a href="#4ce34437fe8bf249" class="t constructor">AstPair</a>(<span class="r114 r">parameter</span>)
                            : <b>new</b> <a href="#d006b2bc6353ecaa" class="t constructor">AstPair</a>(<span class="r114 r">parameter</span>, (<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>)<b>null</b>);
 
                        <a href="#78783fa60ec7198a" class="i field">_arguments</a>.<span class="i">Add</span>(<span class="r115 r">parameterArg</span>);
                    }
                    <b>else</b>
                    {
                        <a href="../parser/ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r116 rd" class="r116 r">dash</span> = <a href="#93b157a76faecf84" class="i field">_commandElements</a>[<span class="r106 r">commandIndex</span>] <b>as</b> <a href="../parser/ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                        <b>if</b> (<span class="r116 r">dash</span> != <b>null</b> &amp;&amp; <span class="r116 r">dash</span>.<a href="../parser/ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>.<span class="i">Trim</span>().<span class="i">Equals</span>(<span class="s">&quot;-&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="c">// &quot;-&quot; is represented by StringConstantExpressionAst. Most likely the user type a tab here,</span>
                            <span class="c">// and we don&#39;t want it be treated as an argument</span>
                            <b>continue</b>;
                        }
 
                        <a href="../parser/ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r117 rd" class="r117 r">expressionArgument</span> = <a href="#93b157a76faecf84" class="i field">_commandElements</a>[<span class="r106 r">commandIndex</span>] <b>as</b> <a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>;
                        <b>if</b> (<span class="r117 r">expressionArgument</span> != <b>null</b>)
                        {
                            <span class="r113 r">argumentsToGetDynamicParameters</span>?.<span class="i">Add</span>(<span class="r117 r">expressionArgument</span>.<a href="../parser/ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="../parser/Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>);
 
                            <a href="#78783fa60ec7198a" class="i field">_arguments</a>.<span class="i">Add</span>(<b>new</b> <a href="#d006b2bc6353ecaa" class="t constructor">AstPair</a>(<b>null</b>, <span class="r117 r">expressionArgument</span>));
                        }
                    }
                }
            }
 
            <b>if</b> (<span class="r110 r">commandProcessor</span> != <b>null</b>)
            {
                <a href="#e380c6d981e63c33" class="i field">_function</a> = <b>false</b>;
                <b>if</b> (<span class="r112 r">implementsDynamicParameters</span>)
                {
                    <a href="../ParameterBinderController.cs.html#9e4e49a03a43c579" class="t t">ParameterBinderController</a>.<span class="i">AddArgumentsToCommandProcessor</span>(<span class="r110 r">commandProcessor</span>, <span class="r113 r">argumentsToGetDynamicParameters</span>.<span class="i">ToArray</span>());
                    <b>bool</b> <span id="r118 rd" class="r118 r">retryWithNoArgs</span> = <b>false</b>, <span id="r119 rd" class="r119 r">alreadyRetried</span> = <b>false</b>;
 
                    <b>do</b>
                    {
                        <a href="../CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a> <span id="r120 rd" class="r120 r">oldCurrentCommandProcessor</span> = <span class="r105 r">context</span>.<a href="../ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a>;
                        <b>try</b>
                        {
                            <span class="r105 r">context</span>.<a href="../ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a> = <span class="r110 r">commandProcessor</span>;
                            <span class="r110 r">commandProcessor</span>.<a href="../CommandProcessorBase.cs.html#2a4698751cbdab79" class="i method">SetCurrentScopeToExecutionScope</a>();
                            <span class="c">// Run method &quot;BindCommandLineParametersNoValidation&quot; to get all available parameters, including the dynamic</span>
                            <span class="c">// parameters (some of them, not necessarily all. Since we don&#39;t do the actual binding, some dynamic parameters</span>
                            <span class="c">// might not be retrieved).</span>
                            <b>if</b> (!<span class="r118 r">retryWithNoArgs</span>)
                            {
                                <span class="c">// Win8 345299: First try with all unbounded arguments</span>
                                <span class="r110 r">commandProcessor</span>.<a href="../CommandProcessor.cs.html#d32374f55ae81926" class="i property">CmdletParameterBinderController</a>.<a href="../CmdletParameterBinderController.cs.html#50831ff19421d0e9" class="i method">BindCommandLineParametersNoValidation</a>(<span class="r110 r">commandProcessor</span>.<a href="../CommandProcessorBase.cs.html#5bfa2b362a5e8358" class="i field">arguments</a>);
                            }
                            <b>else</b>
                            {
                                <span class="c">// Win8 345299: If the first try ended with ParameterBindingException, try again with no arguments</span>
                                <span class="r119 r">alreadyRetried</span> = <b>true</b>;
                                <span class="r110 r">commandProcessor</span>.<a href="../CommandProcessor.cs.html#d32374f55ae81926" class="i property">CmdletParameterBinderController</a>.<a href="../ParameterBinderController.cs.html#8dfa3bdaa5f53b57" class="i method">ClearUnboundArguments</a>();
                                <span class="r110 r">commandProcessor</span>.<a href="../CommandProcessor.cs.html#d32374f55ae81926" class="i property">CmdletParameterBinderController</a>.<a href="../CmdletParameterBinderController.cs.html#50831ff19421d0e9" class="i method">BindCommandLineParametersNoValidation</a>(<b>new</b> <span class="i">Collection</span>&lt;<a href="../CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>&gt;());
                            }
                        }
                        <b>catch</b> (<a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r121 rd" class="r121 r">e</span>)
                        {
                            <span class="c">// Catch the parameter binding exception thrown when Reparsing the argument.</span>
                            <span class="c">//   &quot;MissingArgument&quot; - a single parameter is matched, but no argument is present</span>
                            <span class="c">//   &quot;AmbiguousParameter&quot; - multiple parameters are matched</span>
                            <span class="c">// When such exceptions are caught, retry again without arguments, so as to get dynamic parameters</span>
                            <span class="c">// based on the current provider</span>
                            <b>if</b> (<span class="r121 r">e</span>.<a href="../../utils/ParameterBinderExceptions.cs.html#d7b59b4ccbb7a15e" class="i property">ErrorId</a> == <span class="s">&quot;MissingArgument&quot;</span> || <span class="r121 r">e</span>.<a href="../../utils/ParameterBinderExceptions.cs.html#d7b59b4ccbb7a15e" class="i property">ErrorId</a> == <span class="s">&quot;AmbiguousParameter&quot;</span>)
                                <span class="r118 r">retryWithNoArgs</span> = <b>true</b>;
                        }
                        <b>catch</b> (<span class="i">Exception</span>)
                        {
                        }
                        <b>finally</b>
                        {
                            <span class="r105 r">context</span>.<a href="../ExecutionContext.cs.html#1146573afe2845c8" class="i property">CurrentCommandProcessor</a> = <span class="r120 r">oldCurrentCommandProcessor</span>;
                            <span class="r110 r">commandProcessor</span>.<a href="../CommandProcessorBase.cs.html#1a8d2d2aeb322b3b" class="i method">RestorePreviousScope</a>();
                        }
                    } <b>while</b> (<span class="r118 r">retryWithNoArgs</span> &amp;&amp; !<span class="r119 r">alreadyRetried</span>);
                }
                <span class="c">// Get all bindable parameters and initialize the _unboundParameters</span>
                <a href="#c42e6b90d0a29d48" class="i field">_commandInfo</a> = <span class="r110 r">commandProcessor</span>.<a href="../CommandProcessorBase.cs.html#b61b3a9315a42a73" class="i property">CommandInfo</a>;
                <a href="#9e0642a8972133d3" class="i field">_commandName</a> = <span class="r110 r">commandProcessor</span>.<a href="../CommandProcessorBase.cs.html#b61b3a9315a42a73" class="i property">CommandInfo</a>.<a href="../CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
                <a href="#191f926ce6c0d3a4" class="i field">_bindableParameters</a> = <span class="r110 r">commandProcessor</span>.<a href="../CommandProcessor.cs.html#d32374f55ae81926" class="i property">CmdletParameterBinderController</a>.<a href="../ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>;
                <a href="#405d41a1a8e2e042" class="i field">_defaultParameterSetFlag</a> = <span class="r110 r">commandProcessor</span>.<a href="../CommandProcessorBase.cs.html#b61b3a9315a42a73" class="i property">CommandInfo</a>.<a href="../CommandInfo.cs.html#6816941cf484edda" class="i property">CommandMetadata</a>.<a href="../CommandMetadata.cs.html#5b69467350bd1a5b" class="i property">DefaultParameterSetFlag</a>;
            }
            <b>else</b> <b>if</b> (<span class="r111 r">scriptProcessor</span> != <b>null</b>)
            {
                <a href="#e380c6d981e63c33" class="i field">_function</a> = <b>true</b>;
                <a href="#c42e6b90d0a29d48" class="i field">_commandInfo</a> = <span class="r111 r">scriptProcessor</span>.<a href="../CommandProcessorBase.cs.html#b61b3a9315a42a73" class="i property">CommandInfo</a>;
                <a href="#9e0642a8972133d3" class="i field">_commandName</a> = <span class="r111 r">scriptProcessor</span>.<a href="../CommandProcessorBase.cs.html#b61b3a9315a42a73" class="i property">CommandInfo</a>.<a href="../CommandInfo.cs.html#02e11b521c500195" class="i property">Name</a>;
                <a href="#191f926ce6c0d3a4" class="i field">_bindableParameters</a> = <span class="r111 r">scriptProcessor</span>.<a href="../ScriptCommandProcessor.cs.html#eb25724ba0e40567" class="i property">ScriptParameterBinderController</a>.<a href="../ParameterBinderController.cs.html#b1da2b94d5ab12b2" class="i property">BindableParameters</a>;
                <a href="#405d41a1a8e2e042" class="i field">_defaultParameterSetFlag</a> = 0;
            }
            <b>else</b>
            {
                <span class="c">// The command is not a function, cmdlet and script cmdlet</span>
                <b>return</b> <b>false</b>;
            }
 
            <a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>.<span class="i">AddRange</span>(<a href="#191f926ce6c0d3a4" class="i field">_bindableParameters</a>.<a href="../MergedCommandParameterMetadata.cs.html#d586f3508cda9bf3" class="i property">BindableParameters</a>.<span class="i">Values</span>);
 
            <span class="c">// Pre-processing the arguments -- pipeline input</span>
            <span class="c">// Check if there is pipeline input</span>
            <a href="../parser/ast.cs.html#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a> <span id="r122 rd" class="r122 r">preCmdBaseAst</span> = <b>null</b>;
            <a href="../parser/ast.cs.html#785915ec8547ce9f" class="k">var</a> <span id="r123 rd" class="r123 r">pipe</span> = <a href="#abd38937d59c040d" class="i field">_commandAst</a>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="../parser/ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a>;
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r123 r">pipe</span> != <b>null</b>, <span class="s">&quot;CommandAst should has a PipelineAst parent&quot;</span>);
            <b>if</b> (<span class="r123 r">pipe</span>.<a href="../parser/ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>.<span class="i">Count</span> &gt; 1)
            {
                <b>foreach</b> (<a href="../parser/ast.cs.html#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a> <span id="r124 rd" class="r124 r">cmdBase</span> <b>in</b> <span class="r123 r">pipe</span>.<a href="../parser/ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>)
                {
                    <b>if</b> (<span class="r124 r">cmdBase</span>.<span class="i">GetHashCode</span>() == <a href="#abd38937d59c040d" class="i field">_commandAst</a>.<span class="i">GetHashCode</span>())
                    {
                        <a href="#3b9e620ffa15a49a" class="i field">_isPipelineInputExpected</a> = <span class="r122 r">preCmdBaseAst</span> != <b>null</b>;
                        <b>if</b> (<a href="#3b9e620ffa15a49a" class="i field">_isPipelineInputExpected</a>)
                            <a href="#d8bd73eaaced3cf7" class="i field">_pipelineInputType</a> = <b>typeof</b>(<b>object</b>);
                        <b>break</b>;
                    }
 
                    <span class="r122 r">preCmdBaseAst</span> = <span class="r124 r">cmdBase</span>;
                }
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private</b> <a href="../CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a> <a id="4b628969e673259d" href="../../R/4b628969e673259d.html" target="n" data-glyph="76,1" class="i method">PrepareFromAst</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r125 rd" class="r125 r">context</span>, <b>out string</b> <span id="r126 rd" class="r126 r">resolvedCommandName</span>)
        {
            <span class="c">// Analyze the Ast</span>
            <a href="../Modules/ScriptAnalysis.cs.html#8fd7ce88c282d95d" class="k">var</a> <span id="r127 rd" class="r127 r">exportVisitor</span> = <b>new</b> <a href="../Modules/ScriptAnalysis.cs.html#8827a1bdef5ff66f" class="t constructor">ExportVisitor</a>(<span class="r128 r">forCompletion</span>: <b>true</b>);
            <a href="../parser/ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r129 rd" class="r129 r">ast</span> = <a href="#abd38937d59c040d" class="i field">_commandAst</a>;
            <b>while</b> (<span class="r129 r">ast</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> != <b>null</b>)
            {
                <span class="r129 r">ast</span> = <span class="r129 r">ast</span>.<a href="../parser/ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
            }
 
            <span class="r129 r">ast</span>.<a href="../parser/ast.cs.html#b97830265ba444e4" class="i method">Visit</a>(<span class="r127 r">exportVisitor</span>);
 
            <a href="../CommandProcessorBase.cs.html#45a6054a3775cde6" class="t t">CommandProcessorBase</a> <span id="r130 rd" class="r130 r">commandProcessor</span> = <b>null</b>;
 
            <span class="r126 r">resolvedCommandName</span> = <a href="#abd38937d59c040d" class="i field">_commandAst</a>.<a href="../parser/ast.cs.html#14cec84b5558d5c6" class="i method">GetCommandName</a>();
            <b>if</b> (<span class="r126 r">resolvedCommandName</span> != <b>null</b>)
            {
                <b>string</b> <span id="r131 rd" class="r131 r">alias</span>;
                <b>int</b> <span id="r132 rd" class="r132 r">resolvedAliasCount</span> = 0;
 
                <b>while</b> (<span class="r127 r">exportVisitor</span>.<a href="../Modules/ScriptAnalysis.cs.html#5233ff15337c6dc2" class="i property">DiscoveredAliases</a>.<span class="i">TryGetValue</span>(<span class="r126 r">resolvedCommandName</span>, <b>out</b> <span class="r131 r">alias</span>))
                {
                    <span class="r132 r">resolvedAliasCount</span> += 1;
                    <b>if</b> (<span class="r132 r">resolvedAliasCount</span> &gt; 5)
                        <b>break</b>;  <span class="c">// give up, assume it&#39;s recursive</span>
                    <span class="r126 r">resolvedCommandName</span> = <span class="r131 r">alias</span>;
                }
 
                <a href="../parser/ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r133 rd" class="r133 r">functionDefinitionAst</span>;
                <b>if</b> (<span class="r127 r">exportVisitor</span>.<a href="../Modules/ScriptAnalysis.cs.html#686b588b5e83aa47" class="i property">DiscoveredFunctions</a>.<span class="i">TryGetValue</span>(<span class="r126 r">resolvedCommandName</span>, <b>out</b> <span class="r133 r">functionDefinitionAst</span>))
                {
                    <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="k">var</a> <span id="r134 rd" class="r134 r">scriptBlock</span> = <b>new</b> <a href="../runtime/CompiledScriptBlock.cs.html#7c5e468d9c460238" class="t constructor">ScriptBlock</a>(<span class="r133 r">functionDefinitionAst</span>, <span class="r133 r">functionDefinitionAst</span>.<a href="../parser/ast.cs.html#705ac8788be4b00f" class="i property">IsFilter</a>);
                    <span class="r130 r">commandProcessor</span> = <a href="../CommandDiscovery.cs.html#04905efdf0510fc2" class="t t">CommandDiscovery</a>.<a href="../CommandDiscovery.cs.html#64c96a250977ad3f" class="i method">CreateCommandProcessorForScript</a>(<span class="r134 r">scriptBlock</span>, <span class="r125 r">context</span>, <b>true</b>, <span class="r125 r">context</span>.<a href="../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>);
                }
            }
 
            <b>return</b> <span class="r130 r">commandProcessor</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parse the arguments to process switch parameters and parameters without a value</span>
        <span class="c">///</span><span class="c"> specified. We always eat the error (such as parameter without value) and continue</span>
        <span class="c">///</span><span class="c"> to do the binding.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r135 r">paramAstAtCursor</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> For parameter completion, if the cursor is pointing at a CommandParameterAst, we</span>
        <span class="c">///</span><span class="c"> should not try exact matching for that CommandParameterAst. This is to handle the</span>
        <span class="c">///</span><span class="c"> following case:</span>
        <span class="c">///</span><span class="c">     Add-Computer -domain(tab)</span>
        <span class="c">///</span><span class="c"> Add-Computer has an alias &quot;Domain&quot; that can exactly match this partial input, but</span>
        <span class="c">///</span><span class="c"> since the user is typing &#39;tab&#39;, the partial input &#39;domain&#39; should not be considered</span>
        <span class="c">///</span><span class="c"> as an exact match. In this case, we don&#39;t try exact matching when calling</span>
        <span class="c">///</span><span class="c"> GetMatchingParameter(..) so as to preserve other possibilities.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="10fbad37442ef51f" href="../../R/10fbad37442ef51f.html" target="n" data-glyph="76,1" class="i method">ParseParameterArguments</a>(<a href="../parser/ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r135 rd" class="r135 r">paramAstAtCursor</span>)
        {
            <b>if</b> (!<a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a>)
                <b>return</b> <a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a>;
 
            <b>var</b> <span id="r136 rd" class="r136 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt;();
            <b>for</b> (<b>int</b> <span id="r137 rd" class="r137 r">index</span> = 0; <span class="r137 r">index</span> &lt; <a href="#78783fa60ec7198a" class="i field">_arguments</a>.<span class="i">Count</span>; <span class="r137 r">index</span>++)
            {
                <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r138 rd" class="r138 r">argument</span> = <a href="#78783fa60ec7198a" class="i field">_arguments</a>[<span class="r137 r">index</span>];
                <b>if</b> (!<span class="r138 r">argument</span>.<a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a> || <span class="r138 r">argument</span>.<a href="#20b483ea1bf76f76" class="i property">ArgumentSpecified</a>)
                {
                    <span class="c">// Add the positional/named arguments back</span>
                    <span class="r136 r">result</span>.<span class="i">Add</span>(<span class="r138 r">argument</span>);
                    <b>continue</b>;
                }
 
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r138 r">argument</span>.<a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a> &amp;&amp; !<span class="r138 r">argument</span>.<a href="#20b483ea1bf76f76" class="i property">ArgumentSpecified</a>,
                    <span class="s">&quot;At this point, the parameters should have no arguments&quot;</span>);
 
                <span class="c">// Now check the parameter name with the bindable parameters</span>
                <b>string</b> <span id="r139 rd" class="r139 r">parameterName</span> = <span class="r138 r">argument</span>.<a href="#3f07007c27aa3c29" class="i property">ParameterName</a>;
                <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r140 rd" class="r140 r">matchingParameter</span> = <b>null</b>;
 
                <b>try</b>
                {
                    <b>bool</b> <span id="r141 rd" class="r141 r">tryExactMatching</span> = <span class="r138 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a> != <span class="r135 r">paramAstAtCursor</span>;
                    <span class="r140 r">matchingParameter</span> = <a href="#191f926ce6c0d3a4" class="i field">_bindableParameters</a>.<a href="../MergedCommandParameterMetadata.cs.html#7f23a99ce96423e1" class="i method">GetMatchingParameter</a>(<span class="r139 r">parameterName</span>, <b>false</b>, <span class="r141 r">tryExactMatching</span>, <b>null</b>);
                }
                <b>catch</b> (<a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a> <span id="r142 rd" class="r142 r">e</span>)
                {
                    <span class="c">// The parameterName is resolved to multiple parameters. The most possible scenario for this</span>
                    <span class="c">// would be the user typing tab to complete a parameter. In this case, we can ignore this</span>
                    <span class="c">// parameter safely.</span>
 
                    <span class="c">// If the next item is a pure argument, we skip it so that it doesn&#39;t get bound</span>
                    <span class="c">// positionally.</span>
                    <b>if</b> (<span class="r137 r">index</span> &lt; <a href="#78783fa60ec7198a" class="i field">_arguments</a>.<span class="i">Count</span> - 1)
                    {
                        <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r143 rd" class="r143 r">nextArg</span> = <a href="#78783fa60ec7198a" class="i field">_arguments</a>[<span class="r137 r">index</span> + 1];
                        <b>if</b> (!<span class="r143 r">nextArg</span>.<a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a> &amp;&amp; <span class="r143 r">nextArg</span>.<a href="#20b483ea1bf76f76" class="i property">ArgumentSpecified</a>)
                        {
                            <span class="r137 r">index</span>++;
                        }
                    }
 
                    <a href="#17b2205fc2a0efb0" class="i field">_ambiguousParameters</a>.<span class="i">Add</span>(<span class="r138 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>);
                    <a href="#c86fdd66e0d8d163" class="i field">_bindingExceptions</a>[<span class="r138 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>] = <span class="r142 r">e</span>;
 
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r140 r">matchingParameter</span> == <b>null</b>)
                {
                    <span class="c">// The parameter cannot be found. The reason could be:</span>
                    <span class="c">// 1. It&#39;s a bynamic parameter, and we cannot retrieve the ParameterMetadata for it</span>
                    <span class="c">//    at this point, since it&#39;s pseudo binding.</span>
                    <span class="c">// 2. The spelling of this parameter is wrong.</span>
                    <span class="c">// We can simply ignore this parameter, but the issue is what to do with the argument</span>
                    <span class="c">// following this parameter (if there is an argument following it). There are two cases:</span>
                    <span class="c">// 1. This parameter is supposed to be a switch parameter. Then the argument following it</span>
                    <span class="c">//    should NOT be ignored.</span>
                    <span class="c">// 2. This parameter is supposed to take an argument. Then the following argument should</span>
                    <span class="c">//    also be ignored</span>
                    <span class="c">// We check the next item. If it&#39;s a pure argument, we give up the binding, because we don&#39;t</span>
                    <span class="c">// know how to deal with it (ignore it? keep it?), and it will affect the accuracy of our</span>
                    <span class="c">// parameter set resolution.</span>
                    <b>if</b> (<span class="r137 r">index</span> &lt; <a href="#78783fa60ec7198a" class="i field">_arguments</a>.<span class="i">Count</span> - 1)
                    {
                        <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r144 rd" class="r144 r">nextArg</span> = <a href="#78783fa60ec7198a" class="i field">_arguments</a>[<span class="r137 r">index</span> + 1];
 
                        <span class="c">// If the next item is a pure argument, we give up the pseudo binding.</span>
                        <b>if</b> (!<span class="r144 r">nextArg</span>.<a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a> &amp;&amp; <span class="r144 r">nextArg</span>.<a href="#20b483ea1bf76f76" class="i property">ArgumentSpecified</a>)
                        {
                            <span class="c">// Testing paramsAstAtCursor ensures we only give up during tab completion,</span>
                            <span class="c">// otherwise we know this is a missing parameter.</span>
                            <b>if</b> (<span class="r135 r">paramAstAtCursor</span> != <b>null</b>)
                            {
                                <span class="c">// Do not use the parsed arguments</span>
                                <a href="#78783fa60ec7198a" class="i field">_arguments</a> = <b>null</b>;
                                <b>return</b> <b>false</b>;
                            }
                            <b>else</b>
                            {
                                <span class="c">// Otherwise, skip the next argument</span>
                                <span class="r137 r">index</span>++;
                                <a href="#917df4363235397c" class="i field">_parametersNotFound</a>.<span class="i">Add</span>(<span class="r138 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>);
                                <b>continue</b>;
                            }
                        }
                    }
 
                    <span class="c">// If the next item is not a pure argument, or the current parameter is the last item,</span>
                    <span class="c">// ignore this parameter and carry on with the binding</span>
                    <a href="#917df4363235397c" class="i field">_parametersNotFound</a>.<span class="i">Add</span>(<span class="r138 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>);
                    <b>continue</b>;
                }
 
                <span class="c">// Check if it&#39;s SwitchParameter</span>
                <b>if</b> (<span class="r140 r">matchingParameter</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a> == <b>typeof</b>(<a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>))
                {
                    <a href="#4eb6fcc40752a8a5" class="t t">SwitchPair</a> <span id="r145 rd" class="r145 r">newArg</span> = <b>new</b> <a href="#e60552fc77490301" class="t constructor">SwitchPair</a>(<span class="r138 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>);
                    <span class="r136 r">result</span>.<span class="i">Add</span>(<span class="r145 r">newArg</span>);
                    <b>continue</b>;
                }
 
                <span class="c">// It&#39;s not a switch parameter, we need to check the next argument</span>
                <b>if</b> (<span class="r137 r">index</span> &lt; <a href="#78783fa60ec7198a" class="i field">_arguments</a>.<span class="i">Count</span> - 1)
                {
                    <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r146 rd" class="r146 r">nextArg</span> = <a href="#78783fa60ec7198a" class="i field">_arguments</a>[<span class="r137 r">index</span> + 1];
                    <b>if</b> (<span class="r146 r">nextArg</span>.<a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a>)
                    {
                        <b>try</b>
                        {
                            <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r147 rd" class="r147 r">nextMatchingParameter</span> =
                                <a href="#191f926ce6c0d3a4" class="i field">_bindableParameters</a>.<a href="../MergedCommandParameterMetadata.cs.html#7f23a99ce96423e1" class="i method">GetMatchingParameter</a>(<span class="r146 r">nextArg</span>.<a href="#3f07007c27aa3c29" class="i property">ParameterName</a>, <b>false</b>, <b>true</b>, <b>null</b>);
                            <span class="c">// The next parameter doesn&#39;t exist. We use it as an argument</span>
                            <b>if</b> (<span class="r147 r">nextMatchingParameter</span> == <b>null</b>)
                            {
                                <a href="#efefd42679f08437" class="t t">AstPair</a> <span id="r148 rd" class="r148 r">newArg</span> = <b>new</b> <a href="#73103abdc9df9bdb" class="t constructor">AstPair</a>(<span class="r138 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>, <span class="r146 r">nextArg</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>);
                                <span class="r136 r">result</span>.<span class="i">Add</span>(<span class="r148 r">newArg</span>);
                                <span class="r137 r">index</span>++;
                            }
                            <b>else</b>
                            {
                                <span class="c">// It&#39;s possible the user is typing tab for argument completion.</span>
                                <span class="c">// We set a fake argument for the current parameter in this case.</span>
                                <a href="#5a548350b3d738b5" class="t t">FakePair</a> <span id="r149 rd" class="r149 r">newArg</span> = <b>new</b> <a href="#2e1894ff3ffe5871" class="t constructor">FakePair</a>(<span class="r138 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>);
                                <span class="r136 r">result</span>.<span class="i">Add</span>(<span class="r149 r">newArg</span>);
                            }
                        }
                        <b>catch</b> (<a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>)
                        {
                            <span class="c">// The next parameter name is ambiguous. We just set</span>
                            <span class="c">// a fake argument for the current parameter.</span>
                            <a href="#5a548350b3d738b5" class="t t">FakePair</a> <span id="r150 rd" class="r150 r">newArg</span> = <b>new</b> <a href="#2e1894ff3ffe5871" class="t constructor">FakePair</a>(<span class="r138 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>);
                            <span class="r136 r">result</span>.<span class="i">Add</span>(<span class="r150 r">newArg</span>);
                        }
                    }
                    <b>else</b>
                    {
                        <span class="c">// The next item is a pure argument.</span>
                        <a href="#efefd42679f08437" class="t t">AstPair</a> <span id="r151 rd" class="r151 r">nextArgument</span> = <span class="r146 r">nextArg</span> <b>as</b> <a href="#efefd42679f08437" class="t t">AstPair</a>;
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r151 r">nextArgument</span> != <b>null</b>, <span class="s">&quot;the next item should be a pure argument here&quot;</span>);
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r151 r">nextArgument</span>.<a href="#20b483ea1bf76f76" class="i property">ArgumentSpecified</a> &amp;&amp; !<span class="r151 r">nextArgument</span>.<a href="#e1c4a25087b9c0e3" class="i property">ArgumentIsCommandParameterAst</a>, <span class="s">&quot;the next item should be a pure argument here&quot;</span>);
 
                        <a href="#efefd42679f08437" class="t t">AstPair</a> <span id="r152 rd" class="r152 r">newArg</span> = <b>new</b> <a href="#d006b2bc6353ecaa" class="t constructor">AstPair</a>(<span class="r138 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>, (<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>)<span class="r151 r">nextArgument</span>.<a href="#310069eab93d5165" class="i property">Argument</a>);
                        <span class="r136 r">result</span>.<span class="i">Add</span>(<span class="r152 r">newArg</span>);
                        <span class="r137 r">index</span>++;
                    }
                }
                <b>else</b>
                {
                    <span class="c">// The current parameter is the last item. Set a fake argument for it</span>
                    <a href="#5a548350b3d738b5" class="t t">FakePair</a> <span id="r153 rd" class="r153 r">newArg</span> = <b>new</b> <a href="#2e1894ff3ffe5871" class="t constructor">FakePair</a>(<span class="r138 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>);
                    <span class="r136 r">result</span>.<span class="i">Add</span>(<span class="r153 r">newArg</span>);
                }
            }
 
            <a href="#78783fa60ec7198a" class="i field">_arguments</a> = <span class="r136 r">result</span>;
            <b>return</b> <b>true</b>;
        }
 
        <b>private</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <a id="1324b5793bd7fa3c" href="../../R/1324b5793bd7fa3c.html" target="n" data-glyph="76,1" class="i method">BindNamedParameters</a>()
        {
            <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r154 rd" class="r154 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt;();
 
            <b>if</b> (!<a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a>)
                <b>return</b> <span class="r154 r">result</span>;
 
            <b>foreach</b> (<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r155 rd" class="r155 r">argument</span> <b>in</b> <a href="#78783fa60ec7198a" class="i field">_arguments</a>)
            {
                <b>if</b> (!<span class="r155 r">argument</span>.<a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a>)
                {
                    <span class="r154 r">result</span>.<span class="i">Add</span>(<span class="r155 r">argument</span>);
                    <b>continue</b>;
                }
 
                <a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r156 rd" class="r156 r">parameter</span> = <b>null</b>;
                <b>try</b>
                {
                    <span class="r156 r">parameter</span> = <a href="#191f926ce6c0d3a4" class="i field">_bindableParameters</a>.<a href="../MergedCommandParameterMetadata.cs.html#7f23a99ce96423e1" class="i method">GetMatchingParameter</a>(<span class="r155 r">argument</span>.<a href="#3f07007c27aa3c29" class="i property">ParameterName</a>, <b>false</b>, <b>true</b>, <b>null</b>);
                }
                <b>catch</b> (<a href="../../utils/ParameterBinderExceptions.cs.html#8e3f022461e43e12" class="t t">ParameterBindingException</a>)
                {
                    <span class="c">// The parameter name is ambiguous. It&#39;s not processed in ParseParameterArguments. Otherwise we</span>
                    <span class="c">// should detect it early. So this argument comes from a CommandParameterAst with argument. We</span>
                    <span class="c">// ignore it and carry on with our binding</span>
                    <a href="#17b2205fc2a0efb0" class="i field">_ambiguousParameters</a>.<span class="i">Add</span>(<span class="r155 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>);
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r156 r">parameter</span> == <b>null</b>)
                {
                    <span class="c">// Cannot find a matching parameter. It&#39;s not processed in ParseParameterArguments. It comes from</span>
                    <span class="c">// a CommandParameterAst with argument. We ignore it and carry on with our binding</span>
                    <a href="#917df4363235397c" class="i field">_parametersNotFound</a>.<span class="i">Add</span>(<span class="r155 r">argument</span>.<a href="#72c3e7cefee2f768" class="i property">Parameter</a>);
                    <b>continue</b>;
                }
 
                <b>if</b> (<a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a>.<span class="i">ContainsKey</span>(<span class="r156 r">parameter</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                {
                    <span class="c">// This parameter is already bound. We ignore it and carry on with the binding.</span>
                    <a href="#55598c5354ac3d59" class="i field">_duplicateParameters</a>.<span class="i">Add</span>(<span class="r155 r">argument</span>);
                    <b>continue</b>;
                }
 
                <span class="c">// The parameter exists and is not bound yet. We assume the binding will always succeed.</span>
                <b>if</b> (<span class="r156 r">parameter</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a> != 0)
                {
                    <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a> &amp;= <span class="r156 r">parameter</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a>;
                }
 
                <a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>.<span class="i">Remove</span>(<span class="r156 r">parameter</span>);
 
                <b>if</b> (!<a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a>.<span class="i">ContainsKey</span>(<span class="r156 r">parameter</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                {
                    <a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a>.<span class="i">Add</span>(<span class="r156 r">parameter</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="r156 r">parameter</span>);
                }
 
                <b>if</b> (!<a href="#5bafd4d13bc8d7df" class="i field">_boundArguments</a>.<span class="i">ContainsKey</span>(<span class="r156 r">parameter</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>))
                {
                    <a href="#5bafd4d13bc8d7df" class="i field">_boundArguments</a>.<span class="i">Add</span>(<span class="r156 r">parameter</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>, <span class="r155 r">argument</span>);
                }
            }
 
            <b>return</b> <span class="r154 r">result</span>;
        }
 
        <b>private</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <a id="b862089bf6685abd" href="../../R/b862089bf6685abd.html" target="n" data-glyph="76,1" class="i method">BindPositionalParameter</a>(
            <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r157 rd" class="r157 r">unboundArguments</span>,
            <b>uint</b> <span id="r158 rd" class="r158 r">validParameterSetFlags</span>,
            <b>uint</b> <span id="r159 rd" class="r159 r">defaultParameterSetFlag</span>,
            <a href="#ad6e81c17c696e75" class="t t">BindingType</a> <span id="r160 rd" class="r160 r">bindingType</span>)
        {
            <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r161 rd" class="r161 r">result</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt;();
 
            <b>if</b> (<a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a> &amp;&amp; <span class="r157 r">unboundArguments</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="i">List</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r162 rd" class="r162 r">unboundArgumentsCollection</span> = <b>new</b> <span class="i">List</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt;(<span class="r157 r">unboundArguments</span>);
                <span class="c">// Get the unbound positional parameters</span>
                <span class="i">SortedDictionary</span>&lt;<b>int</b>, <span class="i">Dictionary</span>&lt;<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="../PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt;&gt; <span id="r163 rd" class="r163 r">positionalParameterDictionary</span>;
                <b>try</b>
                {
                    <span class="r163 r">positionalParameterDictionary</span> =
                        <a href="../ParameterBinderController.cs.html#9e4e49a03a43c579" class="t t">ParameterBinderController</a>.<span class="i">EvaluateUnboundPositionalParameters</span>(<a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>, <span class="r158 r">validParameterSetFlags</span>);
                }
                <b>catch</b> (<span class="i">InvalidOperationException</span>)
                {
                    <span class="c">// This exception is thrown because the binder found two positional parameters</span>
                    <span class="c">// from the same parameter set with the same position defined. The parameter definition</span>
                    <span class="c">// is ambiguous. We give up binding in this case</span>
                    <a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a> = <b>false</b>;
                    <b>return</b> <span class="r161 r">result</span>;
                }
 
                <span class="c">// No positional parameter available</span>
                <b>if</b> (<span class="r163 r">positionalParameterDictionary</span>.<span class="i">Count</span> == 0)
                    <b>return</b> <span class="r157 r">unboundArguments</span>;
 
                <b>int</b> <span id="r164 rd" class="r164 r">unboundArgumentsIndex</span> = 0;
                <b>foreach</b> (<span class="i">Dictionary</span>&lt;<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="../PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt; <span id="r165 rd" class="r165 r">nextPositionalParameters</span> <b>in</b> <span class="r163 r">positionalParameterDictionary</span>.<span class="i">Values</span>)
                {
                    <b>if</b> (<span class="r165 r">nextPositionalParameters</span>.<span class="i">Count</span> == 0)
                    {
                        <b>continue</b>;
                    }
 
                    <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r166 rd" class="r166 r">argument</span> = <a href="#8e9168f2d57acf51" class="i method">GetNextPositionalArgument</a>(
                        <span class="r162 r">unboundArgumentsCollection</span>,
                        <span class="r161 r">result</span>,
                        <b>ref</b> <span class="r164 r">unboundArgumentsIndex</span>);
 
                    <b>if</b> (<span class="r166 r">argument</span> == <b>null</b>)
                    {
                        <b>break</b>;
                    }
 
                    <span class="c">// The positional pseudo binding is processed in two different approaches for parameter completion and parameter argument completion.</span>
                    <span class="c">// - For parameter completion, we do NOT honor the default parameter set, so we can preserve potential parameters as many as possible.</span>
                    <span class="c">//   Example:</span>
                    <span class="c">//           Where-Object PropertyA -&lt;tab&gt;</span>
                    <span class="c">//   If the default parameter is honored, the completion results only contain EQ, because it&#39;s locked to the default set</span>
                    <span class="c">//</span>
                    <span class="c">// - For parameter argument completion, however, we want to honor the default parameter set some times, especially when the argument</span>
                    <span class="c">//   can be bound to the positional parameter from the default set WITHOUT type coercion.</span>
                    <span class="c">//   Example:</span>
                    <span class="c">//           Set-Location c:\win&lt;tab&gt;</span>
                    <span class="c">//   In this scenario, the user actually intends to use -Path implicitly, and we should not preserve the -LiteralPath. But if we fail</span>
                    <span class="c">//   on the attempt with the (default set + no coercion), we should fall back to the (all valid set + with coercion) to preserve possibilities.</span>
                    <span class="c">//   Example:</span>
                    <span class="c">//           Add-Member notep&lt;tab&gt;</span>
                    <span class="c">//   We need presever the -MemberType along with the -NotePropertyName in this case.</span>
                    <span class="c">//</span>
                    <span class="c">// So the algorithm for positional binding is:</span>
                    <span class="c">// - With bindingType == ParameterCompletion</span>
                    <span class="c">//   Skip the attempt with the default set, as well as the attempt with all sets but no coercion.</span>
                    <span class="c">//   Do the positional binding with the (all valid set + with coercion) directly.</span>
                    <span class="c">//</span>
                    <span class="c">// - With bindingType == ArgumentCompletion  (parameter argument completion)</span>
                    <span class="c">//   First try to do positional binding with (default set + no coercion)</span>
                    <span class="c">//   If the first attempt fails, do positional binding with (all valid set + with coercion)</span>
                    <span class="c">//</span>
                    <span class="c">// - With bindingType == ArgumentBinding (parameter argument binding, no completion)</span>
                    <span class="c">//   First try to do positional binding with (default set + no coercion)</span>
                    <span class="c">//   If the first attempt fails, do positional binding with (all valid set + without coercion)</span>
                    <span class="c">//   If the second attempt fails, do positional binding with (all valid set + with coercion)</span>
 
                    <b>bool</b> <span id="r167 rd" class="r167 r">aParameterGetBound</span> = <b>false</b>;
                    <b>if</b> ((<span class="r160 r">bindingType</span> != <a href="#ad6e81c17c696e75" class="t t">BindingType</a>.<a href="#aeae553133a922a5" class="i field">ParameterCompletion</a>) &amp;&amp; ((<span class="r158 r">validParameterSetFlags</span> &amp; <span class="r159 r">defaultParameterSetFlag</span>) != 0))
                    {
                        <span class="c">// Default set, no coercion.</span>
                        <span class="r167 r">aParameterGetBound</span> =
                            <a href="#131121a483708759" class="i method">BindPseudoPositionalParameterInSet</a>(
                                <span class="r159 r">defaultParameterSetFlag</span>,
                                <span class="r165 r">nextPositionalParameters</span>,
                                <span class="r166 r">argument</span>,
                                <b>false</b>);
                    }
 
                    <b>if</b> (!<span class="r167 r">aParameterGetBound</span> &amp;&amp; (<span class="r160 r">bindingType</span> == <a href="#ad6e81c17c696e75" class="t t">BindingType</a>.<a href="#e9115d1d31266671" class="i field">ArgumentBinding</a>))
                    {
                        <span class="c">// All valid sets, no coercion.</span>
                        <span class="r167 r">aParameterGetBound</span> =
                            <a href="#131121a483708759" class="i method">BindPseudoPositionalParameterInSet</a>(
                                <span class="r158 r">validParameterSetFlags</span>,
                                <span class="r165 r">nextPositionalParameters</span>,
                                <span class="r166 r">argument</span>,
                                <b>false</b>);
                    }
 
                    <b>if</b> (!<span class="r167 r">aParameterGetBound</span>)
                    {
                        <span class="c">// All valid sets, with coercion.</span>
                        <span class="r167 r">aParameterGetBound</span> =
                            <a href="#131121a483708759" class="i method">BindPseudoPositionalParameterInSet</a>(
                                <span class="r158 r">validParameterSetFlags</span>,
                                <span class="r165 r">nextPositionalParameters</span>,
                                <span class="r166 r">argument</span>,
                                <b>true</b>);
                    }
 
                    <b>if</b> (!<span class="r167 r">aParameterGetBound</span>)
                    {
                        <span class="r161 r">result</span>.<span class="i">Add</span>(<span class="r166 r">argument</span>);
                    }
                    <b>else</b>
                    {
                        <span class="c">// Update the parameter sets if necessary</span>
                        <b>if</b> (<span class="r158 r">validParameterSetFlags</span> != <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a>)
                        {
                            <span class="r158 r">validParameterSetFlags</span> = <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a>;
                            <a href="../ParameterBinderController.cs.html#9e4e49a03a43c579" class="t t">ParameterBinderController</a>.<a href="../ParameterBinderController.cs.html#478d5b369d26a74b" class="i method">UpdatePositionalDictionary</a>(<span class="r163 r">positionalParameterDictionary</span>, <span class="r158 r">validParameterSetFlags</span>);
                        }
                    }
                }
 
                <b>for</b> (<b>int</b> <span id="r168 rd" class="r168 r">index</span> = <span class="r164 r">unboundArgumentsIndex</span>; <span class="r168 r">index</span> &lt; <span class="r162 r">unboundArgumentsCollection</span>.<span class="i">Count</span>; ++<span class="r168 r">index</span>)
                {
                    <span class="r161 r">result</span>.<span class="i">Add</span>(<span class="r162 r">unboundArgumentsCollection</span>[<span class="r168 r">index</span>]);
                }
            }
 
            <b>return</b> <span class="r161 r">result</span>;
        }
 
        <b>private bool</b> <a id="131121a483708759" href="../../R/131121a483708759.html" target="n" data-glyph="76,1" class="i method">BindPseudoPositionalParameterInSet</a>(
            <b>uint</b> <span id="r169 rd" class="r169 r">validParameterSetFlag</span>,
            <span class="i">Dictionary</span>&lt;<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>, <a href="../PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a>&gt; <span id="r170 rd" class="r170 r">nextPositionalParameters</span>,
            <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r171 rd" class="r171 r">argument</span>,
            <b>bool</b> <span id="r172 rd" class="r172 r">typeConversion</span>)
        {
            <b>bool</b> <span id="r173 rd" class="r173 r">bindingSuccessful</span> = <b>false</b>;
            <b>uint</b> <span id="r174 rd" class="r174 r">localParameterSetFlag</span> = 0;
            <b>foreach</b> (<a href="../PositionalCommandParameter.cs.html#45716f94467b6dd6" class="t t">PositionalCommandParameter</a> <span id="r175 rd" class="r175 r">parameter</span> <b>in</b> <span class="r170 r">nextPositionalParameters</span>.<span class="i">Values</span>)
            {
                <b>foreach</b> (<a href="../ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r176 rd" class="r176 r">parameterSetData</span> <b>in</b> <span class="r175 r">parameter</span>.<a href="../PositionalCommandParameter.cs.html#98c95f23f61d5629" class="i property">ParameterSetData</a>)
                {
                    <span class="c">// Skip it if it&#39;s not in the specified parameter set</span>
                    <b>if</b> ((<span class="r169 r">validParameterSetFlag</span> &amp; <span class="r176 r">parameterSetData</span>.<a href="../ParameterSetSpecificMetadata.cs.html#f78c0b8e1f2ce3b8" class="i property">ParameterSetFlag</a>) == 0 &amp;&amp;
                        !<span class="r176 r">parameterSetData</span>.<a href="../ParameterSetSpecificMetadata.cs.html#4410808f4575d589" class="i property">IsInAllSets</a>)
                    {
                        <b>continue</b>;
                    }
 
                    <b>bool</b> <span id="r177 rd" class="r177 r">result</span> = <b>false</b>;
                    <b>string</b> <span id="r178 rd" class="r178 r">parameterName</span> = <span class="r175 r">parameter</span>.<a href="../PositionalCommandParameter.cs.html#6524ea1b90370421" class="i property">Parameter</a>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>;
                    <span class="i">Type</span> <span id="r179 rd" class="r179 r">parameterType</span> = <span class="r175 r">parameter</span>.<a href="../PositionalCommandParameter.cs.html#6524ea1b90370421" class="i property">Parameter</a>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#d559cbd358d9cd28" class="i property">Type</a>;
                    <span class="i">Type</span> <span id="r180 rd" class="r180 r">argumentType</span> = <span class="r171 r">argument</span>.<a href="#25985364adcae081" class="i property">ArgumentType</a>;
 
                    <span class="c">// 1. the argument type is not known(typeof(object)). we assume the binding always succeeds</span>
                    <span class="c">// 2. the argument type is the same as parameter type, we assume the binding succeeds</span>
                    <span class="c">// 3. the types are not the same, but we allow conversion, we assume the binding succeeds</span>
                    <span class="c">// 4. the types are not the same, and conversion is not allowed, we assume the binding fails</span>
                    <b>if</b> (<span class="r180 r">argumentType</span> == <b>typeof</b>(<b>object</b>))
                        <span class="r173 r">bindingSuccessful</span> = <span class="r177 r">result</span> = <b>true</b>;
                    <b>else</b> <b>if</b> (<a href="#754d8b841f539383" class="i method">IsTypeEquivalent</a>(<span class="r180 r">argumentType</span>, <span class="r179 r">parameterType</span>))
                        <span class="r173 r">bindingSuccessful</span> = <span class="r177 r">result</span> = <b>true</b>;
                    <b>else</b> <b>if</b> (<span class="r172 r">typeConversion</span>)
                        <span class="r173 r">bindingSuccessful</span> = <span class="r177 r">result</span> = <b>true</b>;
 
                    <b>if</b> (<span class="r177 r">result</span>)
                    {
                        <span class="r174 r">localParameterSetFlag</span> |= <span class="r175 r">parameter</span>.<a href="../PositionalCommandParameter.cs.html#6524ea1b90370421" class="i property">Parameter</a>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a>;
                        <a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>.<span class="i">Remove</span>(<span class="r175 r">parameter</span>.<a href="../PositionalCommandParameter.cs.html#6524ea1b90370421" class="i property">Parameter</a>);
 
                        <b>if</b> (!<a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a>.<span class="i">ContainsKey</span>(<span class="r178 r">parameterName</span>))
                        {
                            <a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a>.<span class="i">Add</span>(<span class="r178 r">parameterName</span>, <span class="r175 r">parameter</span>.<a href="../PositionalCommandParameter.cs.html#6524ea1b90370421" class="i property">Parameter</a>);
                            <a href="#f789d0fa8b770c73" class="i field">_boundPositionalParameter</a>.<span class="i">Add</span>(<span class="r178 r">parameterName</span>);
                        }
 
                        <b>if</b> (!<a href="#5bafd4d13bc8d7df" class="i field">_boundArguments</a>.<span class="i">ContainsKey</span>(<span class="r178 r">parameterName</span>))
                        {
                            <a href="#5bafd4d13bc8d7df" class="i field">_boundArguments</a>.<span class="i">Add</span>(<span class="r178 r">parameterName</span>, <span class="r171 r">argument</span>);
                        }
 
                        <b>break</b>;
                    }
                }
            }
 
            <span class="c">// We preserve all possibilities</span>
            <b>if</b> (<span class="r173 r">bindingSuccessful</span> &amp;&amp; <span class="r174 r">localParameterSetFlag</span> != 0)
                <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a> &amp;= <span class="r174 r">localParameterSetFlag</span>;
            <b>return</b> <span class="r173 r">bindingSuccessful</span>;
        }
 
        <b>private static bool</b> <a id="754d8b841f539383" href="../../R/754d8b841f539383.html" target="n" data-glyph="76,1" class="i method">IsTypeEquivalent</a>(<span class="i">Type</span> <span id="r181 rd" class="r181 r">argType</span>, <span class="i">Type</span> <span id="r182 rd" class="r182 r">paramType</span>)
        {
            <b>bool</b> <span id="r183 rd" class="r183 r">result</span> = <b>false</b>;
            <b>if</b> (<span class="r181 r">argType</span> == <span class="r182 r">paramType</span>)
            {
                <span class="r183 r">result</span> = <b>true</b>;
            }
            <b>else</b> <b>if</b> (<span class="r181 r">argType</span>.<span class="i">IsSubclassOf</span>(<span class="r182 r">paramType</span>))
            {
                <span class="r183 r">result</span> = <b>true</b>;
            }
            <b>else</b> <b>if</b> (<span class="r181 r">argType</span> == <span class="r182 r">paramType</span>.<span class="i">GetElementType</span>())
            {
                <span class="r183 r">result</span> = <b>true</b>;
            }
            <b>else</b> <b>if</b> (<span class="r181 r">argType</span>.<span class="i">IsSubclassOf</span>(<b>typeof</b>(<span class="i">Array</span>)) &amp;&amp; <span class="r182 r">paramType</span>.<span class="i">IsSubclassOf</span>(<b>typeof</b>(<span class="i">Array</span>)))
            {
                <span class="r183 r">result</span> = <b>true</b>;
            }
 
            <b>return</b> <span class="r183 r">result</span>;
        }
 
        <b>private static</b> <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <a id="8e9168f2d57acf51" href="../../R/8e9168f2d57acf51.html" target="n" data-glyph="76,1" class="i method">GetNextPositionalArgument</a>(
            <span class="i">List</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r184 rd" class="r184 r">unboundArgumentsCollection</span>,
            <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r185 rd" class="r185 r">nonPositionalArguments</span>,
            <b>ref int</b> <span id="r186 rd" class="r186 r">unboundArgumentsIndex</span>)
        {
            <span class="c">// Find the next positional parameter. An argument without the parameter being</span>
            <span class="c">// specified is considered to be a positional argument</span>
            <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r187 rd" class="r187 r">result</span> = <b>null</b>;
            <b>while</b> (<span class="r186 r">unboundArgumentsIndex</span> &lt; <span class="r184 r">unboundArgumentsCollection</span>.<span class="i">Count</span>)
            {
                <a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r188 rd" class="r188 r">argument</span> = <span class="r184 r">unboundArgumentsCollection</span>[<span class="r186 r">unboundArgumentsIndex</span>++];
                <b>if</b> (<span class="r188 r">argument</span> <b>is</b> <a href="#efefd42679f08437" class="t t">AstPair</a> <span id="r189 rd" class="r189 r">astPair</span>
                    &amp;&amp; <span class="r189 r">astPair</span>.<a href="#310069eab93d5165" class="i property">Argument</a> <b>is</b> <a href="../parser/ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r190 rd" class="r190 r">argumentVariable</span>
                    &amp;&amp; <span class="r190 r">argumentVariable</span>.<a href="../parser/ast.cs.html#7f1485a08eb97fcc" class="i property">Splatted</a>)
                {
                    <b>continue</b>;
                }
 
                <b>if</b> (!<span class="r188 r">argument</span>.<a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a>)
                {
                    <span class="r187 r">result</span> = <span class="r188 r">argument</span>;
                    <b>break</b>;
                }
 
                <span class="r185 r">nonPositionalArguments</span>.<span class="i">Add</span>(<span class="r188 r">argument</span>);
            }
 
            <b>return</b> <span class="r187 r">result</span>;
        }
 
        <b>private</b> <span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <a id="ec5ff1ea284cf6ed" href="../../R/ec5ff1ea284cf6ed.html" target="n" data-glyph="76,1" class="i method">BindRemainingParameters</a>(<span class="i">Collection</span>&lt;<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a>&gt; <span id="r191 rd" class="r191 r">unboundArguments</span>)
        {
            <b>bool</b> <span id="r192 rd" class="r192 r">result</span> = <b>false</b>;
            <b>uint</b> <span id="r193 rd" class="r193 r">localParameterSetFlag</span> = 0;
 
            <b>if</b> (!<a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a> || <span class="r191 r">unboundArguments</span>.<span class="i">Count</span> == 0)
                <b>return</b> <span class="r191 r">unboundArguments</span>;
 
            <span class="i">Collection</span>&lt;<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r194 rd" class="r194 r">argList</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;();
            <b>foreach</b> (<a href="#0a86cacd3f9ecdb3" class="t t">AstParameterArgumentPair</a> <span id="r195 rd" class="r195 r">arg</span> <b>in</b> <span class="r191 r">unboundArguments</span>)
            {
                <a href="#efefd42679f08437" class="t t">AstPair</a> <span id="r196 rd" class="r196 r">realArg</span> = <span class="r195 r">arg</span> <b>as</b> <a href="#efefd42679f08437" class="t t">AstPair</a>;
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r196 r">realArg</span> != <b>null</b> &amp;&amp; !<span class="r196 r">realArg</span>.<a href="#ee5926fcf99682f5" class="i property">ParameterSpecified</a> &amp;&amp; !<span class="r196 r">realArg</span>.<a href="#e1c4a25087b9c0e3" class="i property">ArgumentIsCommandParameterAst</a>,
                    <span class="s">&quot;all unbound arguments left should be pure ExpressionAst arguments&quot;</span>);
                <span class="r194 r">argList</span>.<span class="i">Add</span>((<a href="../parser/ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>)<span class="r196 r">realArg</span>.<a href="#310069eab93d5165" class="i property">Argument</a>);
            }
 
            <b>var</b> <span id="r197 rd" class="r197 r">unboundParametersCopy</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt;(<a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>);
 
            <b>foreach</b> (<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r198 rd" class="r198 r">unboundParam</span> <b>in</b> <span class="r197 r">unboundParametersCopy</span>)
            {
                <b>bool</b> <span id="r199 rd" class="r199 r">isInParameterSet</span> = (<span class="r198 r">unboundParam</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a> &amp; <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a>) != 0 ||
                                        <span class="r198 r">unboundParam</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#28fd649ec0fa1b52" class="i property">IsInAllSets</a>;
                <b>if</b> (!<span class="r199 r">isInParameterSet</span>)
                {
                    <b>continue</b>;
                }
 
                <b>var</b> <span id="r200 rd" class="r200 r">parameterSetDataCollection</span> = <span class="r198 r">unboundParam</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#6734aa34600c1096" class="i method">GetMatchingParameterSetData</a>(<a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a>);
                <b>foreach</b> (<a href="../ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r201 rd" class="r201 r">parameterSetData</span> <b>in</b> <span class="r200 r">parameterSetDataCollection</span>)
                {
                    <b>if</b> (!<span class="r201 r">parameterSetData</span>.<a href="../ParameterSetSpecificMetadata.cs.html#75971da95a085c4f" class="i property">ValueFromRemainingArguments</a>)
                    {
                        <b>continue</b>;
                    }
 
                    <span class="r193 r">localParameterSetFlag</span> |= <span class="r198 r">unboundParam</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a>;
                    <b>string</b> <span id="r202 rd" class="r202 r">parameterName</span> = <span class="r198 r">unboundParam</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>;
                    <a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>.<span class="i">Remove</span>(<span class="r198 r">unboundParam</span>);
 
                    <b>if</b> (!<a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a>.<span class="i">ContainsKey</span>(<span class="r202 r">parameterName</span>))
                    {
                        <a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a>.<span class="i">Add</span>(<span class="r202 r">parameterName</span>, <span class="r198 r">unboundParam</span>);
                    }
 
                    <b>if</b> (!<a href="#5bafd4d13bc8d7df" class="i field">_boundArguments</a>.<span class="i">ContainsKey</span>(<span class="r202 r">parameterName</span>))
                    {
                        <a href="#5bafd4d13bc8d7df" class="i field">_boundArguments</a>.<span class="i">Add</span>(<span class="r202 r">parameterName</span>, <b>new</b> <span class="t">AstArrayPair</span>(<span class="r202 r">parameterName</span>, <span class="r194 r">argList</span>));
                        <span class="r191 r">unboundArguments</span>.<span class="i">Clear</span>();
                    }
 
                    <span class="r192 r">result</span> = <b>true</b>;
                    <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r192 r">result</span> &amp;&amp; <span class="r193 r">localParameterSetFlag</span> != 0)
                <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a> &amp;= <span class="r193 r">localParameterSetFlag</span>;
 
            <b>return</b> <span class="r191 r">unboundArguments</span>;
        }
 
        <b>private void</b> <a id="a1644c76b31a32f2" href="../../R/a1644c76b31a32f2.html" target="n" data-glyph="76,1" class="i method">BindPipelineParameters</a>()
        {
            <b>bool</b> <span id="r203 rd" class="r203 r">result</span> = <b>false</b>;
            <b>uint</b> <span id="r204 rd" class="r204 r">localParameterSetFlag</span> = 0;
 
            <b>if</b> (!<a href="#4bb3133c5723cbd8" class="i field">_bindingEffective</a> || !<a href="#3b9e620ffa15a49a" class="i field">_isPipelineInputExpected</a>)
            {
                <b>return</b>;
            }
 
            <b>var</b> <span id="r205 rd" class="r205 r">unboundParametersCopy</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a>&gt;(<a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>);
 
            <b>foreach</b> (<a href="../MergedCommandParameterMetadata.cs.html#700aeeb16077bb0a" class="t t">MergedCompiledCommandParameter</a> <span id="r206 rd" class="r206 r">unboundParam</span> <b>in</b> <span class="r205 r">unboundParametersCopy</span>)
            {
                <b>if</b> (!<span class="r206 r">unboundParam</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#ad80d097afeb91c4" class="i property">IsPipelineParameterInSomeParameterSet</a>)
                    <b>continue</b>;
 
                <b>bool</b> <span id="r207 rd" class="r207 r">isInParameterSet</span> = (<span class="r206 r">unboundParam</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a> &amp; <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a>) != 0 ||
                                        <span class="r206 r">unboundParam</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#28fd649ec0fa1b52" class="i property">IsInAllSets</a>;
                <b>if</b> (!<span class="r207 r">isInParameterSet</span>)
                {
                    <b>continue</b>;
                }
 
                <b>var</b> <span id="r208 rd" class="r208 r">parameterSetDataCollection</span> = <span class="r206 r">unboundParam</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#6734aa34600c1096" class="i method">GetMatchingParameterSetData</a>(<a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a>);
                <b>foreach</b> (<a href="../ParameterSetSpecificMetadata.cs.html#c4b0e9de62b9ecea" class="t t">ParameterSetSpecificMetadata</a> <span id="r209 rd" class="r209 r">parameterSetData</span> <b>in</b> <span class="r208 r">parameterSetDataCollection</span>)
                {
                    <span class="c">// We don&#39;t assume the &#39;ValueFromPipelineByPropertyName&#39; parameters get bound</span>
                    <b>if</b> (!<span class="r209 r">parameterSetData</span>.<a href="../ParameterSetSpecificMetadata.cs.html#6b00e8f2cc8f5221" class="i property">ValueFromPipeline</a>)
                    {
                        <b>continue</b>;
                    }
 
                    <span class="r204 r">localParameterSetFlag</span> |= <span class="r206 r">unboundParam</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#ab798c503353ae68" class="i property">ParameterSetFlags</a>;
                    <b>string</b> <span id="r210 rd" class="r210 r">parameterName</span> = <span class="r206 r">unboundParam</span>.<a href="../MergedCommandParameterMetadata.cs.html#1d0a6c6d53471af0" class="i property">Parameter</a>.<a href="../CompiledCommandParameter.cs.html#a6029b38dac72768" class="i property">Name</a>;
                    <a href="#7859efc528f4a7ca" class="i field">_unboundParameters</a>.<span class="i">Remove</span>(<span class="r206 r">unboundParam</span>);
 
                    <b>if</b> (!<a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a>.<span class="i">ContainsKey</span>(<span class="r210 r">parameterName</span>))
                    {
                        <a href="#c02ef3f02058b5b0" class="i field">_boundParameters</a>.<span class="i">Add</span>(<span class="r210 r">parameterName</span>, <span class="r206 r">unboundParam</span>);
                    }
 
                    <b>if</b> (!<a href="#5bafd4d13bc8d7df" class="i field">_boundArguments</a>.<span class="i">ContainsKey</span>(<span class="r210 r">parameterName</span>))
                    {
                        <a href="#5bafd4d13bc8d7df" class="i field">_boundArguments</a>.<span class="i">Add</span>(<span class="r210 r">parameterName</span>, <b>new</b> <a href="#16866805d29948d1" class="t constructor">PipeObjectPair</a>(<span class="r210 r">parameterName</span>, <a href="#d8bd73eaaced3cf7" class="i field">_pipelineInputType</a>));
                    }
 
                    <span class="r203 r">result</span> = <b>true</b>;
                    <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r203 r">result</span> &amp;&amp; <span class="r204 r">localParameterSetFlag</span> != 0)
                <a href="#248dae4a8fd162f4" class="i field">_currentParameterSetFlag</a> &amp;= <span class="r204 r">localParameterSetFlag</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
