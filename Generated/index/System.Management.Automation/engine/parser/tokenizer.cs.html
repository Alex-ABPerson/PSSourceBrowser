<!DOCTYPE html>
<html><head><title>tokenizer.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(5099);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/parser/tokenizer.cs" target="_top">engine\parser\tokenizer.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Numerics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Subsystem</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Subsystem</span>.<span class="i n">DSC</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">DesiredStateConfiguration</span>.<span class="i n">Internal</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>
{
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines the name modes for a dynamic keyword. A name expression may be required, optional or not permitted.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="84f739c2f84d69ad" href="../../R/84f739c2f84d69ad.html" target="n" data-glyph="18,0" class="t t"><span id="75875bfd3486b751">DynamicKeywordNameMode</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This keyword does not take a name value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="f4392d4c8185a4f0" href="../../R/f4392d4c8185a4f0.html" target="n" data-glyph="24,1" class="i field">NoName</a> = 0,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name must be present and simple non-empty bare word.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="f6123ea2d4c5e6ea" href="../../R/f6123ea2d4c5e6ea.html" target="n" data-glyph="24,1" class="i field">SimpleNameRequired</a> = 1,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name must be present but can also be an expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="36ae172a002d6bd7" href="../../R/36ae172a002d6bd7.html" target="n" data-glyph="24,1" class="i field">NameRequired</a> = 2,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name may be optionally present, but if it is present, it must be a non-empty bare word.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="dd4d9558e70de62a" href="../../R/dd4d9558e70de62a.html" target="n" data-glyph="24,1" class="i field">SimpleOptionalName</a> = 3,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Name may be optionally present, expression or bare word.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="ba3aaa0c881f40f4" href="../../R/ba3aaa0c881f40f4.html" target="n" data-glyph="24,1" class="i field">OptionalName</a> = 4,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines the body mode for a dynamic keyword. It can be a scriptblock, hashtable or command which means no body.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public enum</b> <a id="dc369c18a439471a" href="../../R/dc369c18a439471a.html" target="n" data-glyph="18,0" class="t t"><span id="8597bf4e7f6619d9">DynamicKeywordBodyMode</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The keyword act like a command.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="a2dc466a9a78cf46" href="../../R/a2dc466a9a78cf46.html" target="n" data-glyph="24,1" class="i field">Command</a> = 0,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The keyword has a scriptblock body.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="57e864f08639804e" href="../../R/57e864f08639804e.html" target="n" data-glyph="24,1" class="i field">ScriptBlock</a> = 1,
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The keyword has hashtable body.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="5da06d8412de17c8" href="../../R/5da06d8412de17c8.html" target="n" data-glyph="24,1" class="i field">Hashtable</a> = 2,
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Defines the schema/behaviour for a dynamic keyword.</span>
    <span class="c">///</span><span class="c"> a constrained.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="c72d6f1daa581d48" href="../../R/c72d6f1daa581d48.html" target="n" data-glyph="0,0" class="t t"><span id="5f2577ceb784b338">DynamicKeyword</span></a>
    {
        <span class="k preprocess">#</span><span class="k preprocess">region</span> static properties/functions
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Defines a dictionary of dynamic keywords, stored in thread-local storage.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt; <a id="a4fdbcc03c7db893" href="../../R/a4fdbcc03c7db893.html" target="n" data-glyph="106,1" class="i property">DynamicKeywords</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#6d3a12c934715da8" class="i field">t_dynamicKeywords</a> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            }
        }
 
        [<span class="i">ThreadStatic</span>]
        <b>private static</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt; <a id="6d3a12c934715da8" href="../../R/6d3a12c934715da8.html" target="n" data-glyph="46,1" class="i field">t_dynamicKeywords</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Stack of DynamicKeywords Cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <span class="i">Stack</span>&lt;<span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt;&gt; <a id="1d25342872eb8c4f" href="../../R/1d25342872eb8c4f.html" target="n" data-glyph="106,1" class="i property">DynamicKeywordsStack</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#993bfd66674346ca" class="i field">t_dynamicKeywordsStack</a> ??= <b>new</b> <span class="i">Stack</span>&lt;<span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt;&gt;();
            }
        }
 
        [<span class="i">ThreadStatic</span>]
        <b>private static</b> <span class="i">Stack</span>&lt;<span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt;&gt; <a id="993bfd66674346ca" href="../../R/993bfd66674346ca.html" target="n" data-glyph="46,1" class="i field">t_dynamicKeywordsStack</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reset the keyword table to a new empty collection.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static void</b> <a id="e3ae68982f2c125a" href="../../R/e3ae68982f2c125a.html" target="n" data-glyph="72,1" class="i method">Reset</a>()
        {
            <a href="#6d3a12c934715da8" class="i field">t_dynamicKeywords</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Push current dynamicKeywords cache into stack.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static void</b> <a id="0cdae039c0460080" href="../../R/0cdae039c0460080.html" target="n" data-glyph="72,1" class="i method">Push</a>()
        {
            <a href="#1d25342872eb8c4f" class="i property">DynamicKeywordsStack</a>.<span class="i">Push</span>(<a href="#6d3a12c934715da8" class="i field">t_dynamicKeywords</a>);
            <a href="#e3ae68982f2c125a" class="i method">Reset</a>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Pop up previous dynamicKeywords cache.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static void</b> <a id="89e041ec233d5707" href="../../R/89e041ec233d5707.html" target="n" data-glyph="72,1" class="i method">Pop</a>()
        {
            <a href="#6d3a12c934715da8" class="i field">t_dynamicKeywords</a> = <a href="#1d25342872eb8c4f" class="i property">DynamicKeywordsStack</a>.<span class="i">Pop</span>();
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <a id="1f19ca15ed12e7d3" href="../../R/1f19ca15ed12e7d3.html" target="n" data-glyph="72,1" class="i method">GetKeyword</a>(<b>string</b> <span id="r0 rd" class="r0 r">name</span>)
        {
            <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <span id="r1 rd" class="r1 r">keywordToReturn</span>;
            <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="#a4fdbcc03c7db893" class="i property">DynamicKeywords</a>.<span class="i">TryGetValue</span>(<span class="r0 r">name</span>, <b>out</b> <span class="r1 r">keywordToReturn</span>);
            <b>return</b> <span class="r1 r">keywordToReturn</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Returns a copied list of all of the existing dynamic keyword definitions.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <span class="i">List</span>&lt;<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt; <a id="037ec5d089661a20" href="../../R/037ec5d089661a20.html" target="n" data-glyph="72,1" class="i method">GetKeyword</a>()
        {
            <b>return</b> <b>new</b> <span class="i">List</span>&lt;<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt;(<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="#a4fdbcc03c7db893" class="i property">DynamicKeywords</a>.<span class="i">Values</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static bool</b> <a id="2af1cc3c0788237c" href="../../R/2af1cc3c0788237c.html" target="n" data-glyph="72,1" class="i method">ContainsKeyword</a>(<b>string</b> <span id="r2 rd" class="r2 r">name</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r2 r">name</span>))
            {
                <a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a> <span id="r3 rd" class="r3 r">e</span> = <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r2 r">name</span>));
                <b>throw</b> <span class="r3 r">e</span>;
            }
 
            <b>return</b> <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="#a4fdbcc03c7db893" class="i property">DynamicKeywords</a>.<span class="i">ContainsKey</span>(<span class="r2 r">name</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r4 r">keywordToAdd</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public static void</b> <a id="1aa0699a8df0ecd2" href="../../R/1aa0699a8df0ecd2.html" target="n" data-glyph="72,1" class="i method">AddKeyword</a>(<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <span id="r4 rd" class="r4 r">keywordToAdd</span>)
        {
            <b>if</b> (<span class="r4 r">keywordToAdd</span> == <b>null</b>)
            {
                <a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a> <span id="r5 rd" class="r5 r">e</span> = <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r4 r">keywordToAdd</span>));
                <b>throw</b> <span class="r5 r">e</span>;
            }
 
            <span class="c">// Allow overwriting of the existing entries</span>
            <b>string</b> <span id="r6 rd" class="r6 r">name</span> = <span class="r4 r">keywordToAdd</span>.<a href="#b4378cc74685de63" class="i property">Keyword</a>;
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r6 r">name</span>))
            {
                <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<span class="s">&quot;keywordToAdd.Keyword&quot;</span>);
            }
 
            <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="#a4fdbcc03c7db893" class="i property">DynamicKeywords</a>.<span class="i">Remove</span>(<span class="r6 r">name</span>);
            <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="#a4fdbcc03c7db893" class="i property">DynamicKeywords</a>.<span class="i">Add</span>(<span class="r6 r">name</span>, <span class="r4 r">keywordToAdd</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Remove a single entry from the dynamic keyword collection</span>
        <span class="c">///</span><span class="c"> and clean up any associated data.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public static void</b> <a id="aa870cf65936a3af" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">RemoveKeyword</a>(<b>string</b> <span id="r7 rd" class="r7 r">name</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r7 r">name</span>))
            {
                <a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a> <span id="r8 rd" class="r8 r">e</span> = <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r7 r">name</span>));
                <b>throw</b> <span class="r8 r">e</span>;
            }
 
            <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="#a4fdbcc03c7db893" class="i property">DynamicKeywords</a>.<span class="i">Remove</span>(<span class="r7 r">name</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if it is a hidden keyword.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">name</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="7e4c6e6aaae4a0c3" href="../../R/7e4c6e6aaae4a0c3.html" target="n" data-glyph="74,1" class="i method">IsHiddenKeyword</a>(<b>string</b> <span id="r9 rd" class="r9 r">name</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r9 r">name</span>))
            {
                <a href="../../utils/MshArgumentNullException.cs.html#efa3789145f41301" class="t t">PSArgumentNullException</a> <span id="r10 rd" class="r10 r">e</span> = <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<a href="../../utils/MshTraceSource.cs.html#fbe67220ad7522a0" class="i method">NewArgumentNullException</a>(<b>nameof</b>(<span class="r9 r">name</span>));
                <b>throw</b> <span class="r10 r">e</span>;
            }
 
            <b>return</b> <a href="#68ad764931ed2a8f" class="i field">s_hiddenDynamicKeywords</a>.<span class="i">Contains</span>(<span class="r9 r">name</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A set of dynamic keywords that are not supposed to be used in script directly.</span>
        <span class="c">///</span><span class="c"> They are for internal use only.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="68ad764931ed2a8f" href="../../R/68ad764931ed2a8f.html" target="n" data-glyph="46,1" class="i field">s_hiddenDynamicKeywords</a> =
            <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>) { <span class="s">&quot;MSFT_Credential&quot;</span> };
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Duplicates the DynamicKeyword.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A copy of the DynamicKeyword.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <a id="652cf530ee20518f" href="../../R/652cf530ee20518f.html" target="n" data-glyph="72,1" class="i method">Copy</a>()
        {
            <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <span id="r11 rd" class="r11 r">keyword</span> = <b>new</b> <span class="t">DynamicKeyword</span>()
            {
                <a href="#9757f90b46da4d4e" class="i property">ImplementingModule</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#9757f90b46da4d4e" class="i property">ImplementingModule</a>,
                <a href="#3a89c893b71586c2" class="i property">ImplementingModuleVersion</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#3a89c893b71586c2" class="i property">ImplementingModuleVersion</a>,
                <a href="#b4378cc74685de63" class="i property">Keyword</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#b4378cc74685de63" class="i property">Keyword</a>,
                <a href="#1ab8fd5746dc90ae" class="i property">ResourceName</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#1ab8fd5746dc90ae" class="i property">ResourceName</a>,
                <a href="#46e96fbd06c2c3af" class="i property">BodyMode</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#46e96fbd06c2c3af" class="i property">BodyMode</a>,
                <a href="#b4ebddb633c81f5b" class="i property">DirectCall</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#b4ebddb633c81f5b" class="i property">DirectCall</a>,
                <a href="#a246b575bebf7355" class="i property">NameMode</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#a246b575bebf7355" class="i property">NameMode</a>,
                <a href="#22566df5302919e2" class="i property">MetaStatement</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#22566df5302919e2" class="i property">MetaStatement</a>,
                <a href="#0478d618518110b3" class="i property">IsReservedKeyword</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#0478d618518110b3" class="i property">IsReservedKeyword</a>,
                <a href="#19d5aaf963addcf9" class="i property">HasReservedProperties</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#19d5aaf963addcf9" class="i property">HasReservedProperties</a>,
                <a href="#49ed139342b9adc4" class="i property">PreParse</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#49ed139342b9adc4" class="i property">PreParse</a>,
                <a href="#fd34ab8e73a2860c" class="i property">PostParse</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#fd34ab8e73a2860c" class="i property">PostParse</a>,
                <a href="#31e7c406e5824274" class="i property">SemanticCheck</a> = <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#31e7c406e5824274" class="i property">SemanticCheck</a>
            };
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="#d3231c99121763c4" class="t t">DynamicKeywordProperty</a>&gt; <span id="r12 rd" class="r12 r">entry</span> <b>in</b> <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#5381d21bcf0af976" class="i property">Properties</a>)
            {
                <span class="r11 r">keyword</span>.<a href="#5381d21bcf0af976" class="i property">Properties</a>.<span class="i">Add</span>(<span class="r12 r">entry</span>.<span class="i">Key</span>, <span class="r12 r">entry</span>.<span class="i">Value</span>);
            }
 
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="#356fa9ee3b2e9e55" class="t t">DynamicKeywordParameter</a>&gt; <span id="r13 rd" class="r13 r">entry</span> <b>in</b> <a href="#c72d6f1daa581d48" class="k">this</a>.<a href="#3f0a567dd3da2e57" class="i property">Parameters</a>)
            {
                <span class="r11 r">keyword</span>.<a href="#3f0a567dd3da2e57" class="i property">Parameters</a>.<span class="i">Add</span>(<span class="r13 r">entry</span>.<span class="i">Key</span>, <span class="r13 r">entry</span>.<span class="i">Value</span>);
            }
 
            <b>return</b> <span class="r11 r">keyword</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the module that implements the function corresponding to this keyword.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="9757f90b46da4d4e" href="../../R/9757f90b46da4d4e.html" target="n" data-glyph="102,1" class="i property">ImplementingModule</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The version of the module that implements the function corresponding to this keyword.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Version</span> <a id="3a89c893b71586c2" href="../../R/3a89c893b71586c2.html" target="n" data-glyph="102,1" class="i property">ImplementingModuleVersion</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The keyword string</span>
        <span class="c">///</span><span class="c"> If an alias qualifier exist, use alias.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="b4378cc74685de63" href="../../R/b4378cc74685de63.html" target="n" data-glyph="102,1" class="i property">Keyword</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The keyword resource name string.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="1ab8fd5746dc90ae" href="../../R/1ab8fd5746dc90ae.html" target="n" data-glyph="102,1" class="i property">ResourceName</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set to true if we should be looking for a scriptblock instead of a hashtable.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#dc369c18a439471a" class="t t">DynamicKeywordBodyMode</a> <a id="46e96fbd06c2c3af" href="../../R/46e96fbd06c2c3af.html" target="n" data-glyph="102,1" class="i property">BodyMode</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If true, then don&#39;t use the marshalled call. Just</span>
        <span class="c">///</span><span class="c"> rewrite the node as a simple direct function call.</span>
        <span class="c">///</span><span class="c"> If NameMode is other than NoName, then the name of the instance</span>
        <span class="c">///</span><span class="c"> will be passed as the parameter -InstanceName.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="b4ebddb633c81f5b" href="../../R/b4ebddb633c81f5b.html" target="n" data-glyph="102,1" class="i property">DirectCall</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> This allows you to specify if the keyword takes a name argument and if so, what form that takes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a> <a id="a246b575bebf7355" href="../../R/a246b575bebf7355.html" target="n" data-glyph="102,1" class="i property">NameMode</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate that the nothing should be added to the AST for this</span>
        <span class="c">///</span><span class="c"> dynamic keyword.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="22566df5302919e2" href="../../R/22566df5302919e2.html" target="n" data-glyph="102,1" class="i property">MetaStatement</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicate that the keyword is reserved for future use by powershell.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="0478d618518110b3" href="../../R/0478d618518110b3.html" target="n" data-glyph="102,1" class="i property">IsReservedKeyword</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Contains the list of properties that are reserved for future use.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="19d5aaf963addcf9" href="../../R/19d5aaf963addcf9.html" target="n" data-glyph="102,1" class="i property">HasReservedProperties</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of the properties allowed for this constuctor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#d3231c99121763c4" class="t t">DynamicKeywordProperty</a>&gt; <a id="5381d21bcf0af976" href="../../R/5381d21bcf0af976.html" target="n" data-glyph="102,1" class="i property">Properties</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#8a47f06f0d513db9" class="i field">_properties</a> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#d3231c99121763c4" class="t t">DynamicKeywordProperty</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            }
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#d3231c99121763c4" class="t t">DynamicKeywordProperty</a>&gt; <a id="8a47f06f0d513db9" href="../../R/8a47f06f0d513db9.html" target="n" data-glyph="46,1" class="i field">_properties</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A list of the parameters allowed for this constuctor.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#356fa9ee3b2e9e55" class="t t">DynamicKeywordParameter</a>&gt; <a id="3f0a567dd3da2e57" href="../../R/3f0a567dd3da2e57.html" target="n" data-glyph="102,1" class="i property">Parameters</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="#5c4e551d74ba20fa" class="i field">_parameters</a> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#356fa9ee3b2e9e55" class="t t">DynamicKeywordParameter</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            }
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#356fa9ee3b2e9e55" class="t t">DynamicKeywordParameter</a>&gt; <a id="5c4e551d74ba20fa" href="../../R/5c4e551d74ba20fa.html" target="n" data-glyph="46,1" class="i field">_parameters</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A custom function that gets executed at parsing time before parsing dynamickeyword block</span>
        <span class="c">///</span><span class="c"> The delegate has one parameter: DynamicKeyword.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Func</span>&lt;<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>, <a href="Parser.cs.html#3b2ee49e322daa35" class="t t">ParseError</a>[]&gt; <a id="49ed139342b9adc4" href="../../R/49ed139342b9adc4.html" target="n" data-glyph="102,1" class="i property">PreParse</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A custom function that gets executed at parsing time after parsing dynamickeyword block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Func</span>&lt;<a href="ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a>, <a href="Parser.cs.html#3b2ee49e322daa35" class="t t">ParseError</a>[]&gt; <a id="fd34ab8e73a2860c" href="../../R/fd34ab8e73a2860c.html" target="n" data-glyph="102,1" class="i property">PostParse</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> A custom function that checks semantic for the given </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a><span class="c">&quot;</span><span class="c">/&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Func</span>&lt;<a href="ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a>, <a href="Parser.cs.html#3b2ee49e322daa35" class="t t">ParseError</a>[]&gt; <a id="31e7c406e5824274" href="../../R/31e7c406e5824274.html" target="n" data-glyph="102,1" class="i property">SemanticCheck</a> { <b>get</b>; <b>set</b>; }
    }
 
    <b>internal static class</b> <a id="c48e0b2e24fa855d" href="../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t">DynamicKeywordExtension</a>
    {
        <b>internal static bool</b> <a id="6c84b21db0c74fe2" href="../../R/6c84b21db0c74fe2.html" target="n" data-glyph="221,1" class="i method">IsMetaDSCResource</a>(<b>this</b> <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <span id="r14 rd" class="r14 r">keyword</span>)
        {
            <b>string</b> <span id="r15 rd" class="r15 r">implementingModule</span> = <span class="r14 r">keyword</span>.<a href="#9757f90b46da4d4e" class="i property">ImplementingModule</a>;
            <b>if</b> (<span class="r15 r">implementingModule</span> != <b>null</b>)
            {
                <a href="../Subsystem/DscSubsystem/ICrossPlatformDsc.cs.html#a3416ac15f89aebb" class="t t">ICrossPlatformDsc</a> <span id="r16 rd" class="r16 r">dscSubsystem</span> = <a href="../Subsystem/SubsystemManager.cs.html#6ddf6a3088da961a" class="t t">SubsystemManager</a>.<a href="../Subsystem/SubsystemManager.cs.html#d2d9d349eedfb603" class="i method">GetSubsystem</a>&lt;<a href="../Subsystem/DscSubsystem/ICrossPlatformDsc.cs.html#a3416ac15f89aebb" class="t t">ICrossPlatformDsc</a>&gt;();
                <b>if</b> (<span class="r16 r">dscSubsystem</span> != <b>null</b>)
                {
                    <span class="r16 r">dscSubsystem</span>.<a href="../Subsystem/DscSubsystem/ICrossPlatformDsc.cs.html#abea395479914acc" class="i method">IsDefaultModuleNameForMetaConfigResource</a>(<span class="r15 r">implementingModule</span>);
                }
                <b>else</b>
                {
                    <b>return</b> <span class="r15 r">implementingModule</span>.<span class="i">Equals</span>(<a href="../../DscSupport/CimDSCParser.cs.html#bfd37d71cb227350" class="t t">DscClassCache</a>.<a href="../../DscSupport/CimDSCParser.cs.html#2e791b70efb80de3" class="i field">DefaultModuleInfoForMetaConfigResource</a>.<span class="i">Item1</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>internal static bool</b> <a id="990d1fccf7a6ba58" href="../../R/../../0000000000.html" target="n" data-glyph="221,1" class="i method">IsCompatibleWithConfigurationType</a>(<b>this</b> <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <span id="r17 rd" class="r17 r">keyword</span>, <a href="ast.cs.html#786dff667907c54f" class="t t">ConfigurationType</a> <span id="r18 rd" class="r18 r">ConfigurationType</span>)
        {
            <b>return</b> ((<span class="r18 r">ConfigurationType</span> == <a href="ast.cs.html#786dff667907c54f" class="t t">ConfigurationType</a>.<a href="ast.cs.html#e1069d3c13089322" class="i field">Meta</a> &amp;&amp; <span class="r17 r">keyword</span>.<a href="#6c84b21db0c74fe2" class="i method">IsMetaDSCResource</a>()) ||
                    (<span class="r18 r">ConfigurationType</span> != <a href="ast.cs.html#786dff667907c54f" class="t t">ConfigurationType</a>.<a href="ast.cs.html#e1069d3c13089322" class="i field">Meta</a> &amp;&amp; !<span class="r17 r">keyword</span>.<a href="#6c84b21db0c74fe2" class="i method">IsMetaDSCResource</a>()));
        }
 
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<b>string</b>&gt;&gt; <a id="6c1d07aab86a68da" href="../../R/6c1d07aab86a68da.html" target="n" data-glyph="46,1" class="i field">s_excludeKeywords</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">List</span>&lt;<b>string</b>&gt;&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
        {
            {<span class="s">@&quot;Node&quot;</span>, <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt; {<span class="s">@&quot;Node&quot;</span>}},
        };
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Get allowed keyword list for a given keyword.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">keyword</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">allowedKeywords</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">NULL if no keyword allowed for a given </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">IEnumerable</span>&lt;<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt; <a id="cffad8c43c76f689" href="../../R/cffad8c43c76f689.html" target="n" data-glyph="221,1" class="i method">GetAllowedKeywords</a>(<b>this</b> <a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <span id="r19 rd" class="r19 r">keyword</span>, <span class="i">IEnumerable</span>&lt;<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt; <span id="r20 rd" class="r20 r">allowedKeywords</span>)
        {
            <b>string</b> <span id="r21 rd" class="r21 r">keywordName</span> = <span class="r19 r">keyword</span>.<a href="#b4378cc74685de63" class="i property">Keyword</a>;
            <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r21 r">keywordName</span>, <span class="s">@&quot;Node&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r22 rd" class="r22 r">excludeKeywords</span>;
                <b>if</b> (<a href="#6c1d07aab86a68da" class="i field">s_excludeKeywords</a>.<span class="i">TryGetValue</span>(<span class="r21 r">keywordName</span>, <b>out</b> <span class="r22 r">excludeKeywords</span>))
                {
                    <b>return</b> <span class="r20 r">allowedKeywords</span>.<span class="i">Where</span>(<span id="r23 rd" class="r23 r">k</span> =&gt; !<span class="r22 r">excludeKeywords</span>.<span class="i">Contains</span>(<span class="r23 r">k</span>.<span class="i">Keyword</span>));
                }
                <b>else</b>
                    <b>return</b> <span class="r20 r">allowedKeywords</span>;
            }
 
            <b>return</b> <b>null</b>;
        }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Metadata about a member property for a dynamic keyword.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="d3231c99121763c4" href="../../R/d3231c99121763c4.html" target="n" data-glyph="0,0" class="t t"><span id="41597d28d7f13ffe">DynamicKeywordProperty</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="1f6c4268727988c7" href="../../R/1f6c4268727988c7.html" target="n" data-glyph="102,1" class="i property">Name</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The required type of the property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="ee8bc84e145d2931" href="../../R/ee8bc84e145d2931.html" target="n" data-glyph="102,1" class="i property">TypeConstraint</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Any attributes that the property has.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="a83f053f9e567559" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Attributes</a>
        {
            <b>get</b> { <b>return</b> <a href="#59f431b2434b8d94" class="i field">_attributes</a> ??= <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(); }
        }
 
        <b>private</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="59f431b2434b8d94" href="../../R/59f431b2434b8d94.html" target="n" data-glyph="46,1" class="i field">_attributes</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> List of strings that may be used as values for this property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="292138791ae38c47" href="../../R/292138791ae38c47.html" target="n" data-glyph="102,1" class="i property">Values</a>
        {
            <b>get</b> { <b>return</b> <a href="#5c9a56d7b31c6d74" class="i field">_values</a> ??= <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;(); }
        }
 
        <b>private</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="5c9a56d7b31c6d74" href="../../R/5c9a56d7b31c6d74.html" target="n" data-glyph="46,1" class="i field">_values</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Mapping the descriptive values to the actual values.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="1a9d98d2588aa02d" href="../../R/1a9d98d2588aa02d.html" target="n" data-glyph="102,1" class="i property">ValueMap</a>
        {
            <b>get</b> { <b>return</b> <a href="#1b5cf74bef75e315" class="i field">_valueMap</a> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>); }
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>string</b>&gt; <a id="1b5cf74bef75e315" href="../../R/1b5cf74bef75e315.html" target="n" data-glyph="46,1" class="i field">_valueMap</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates that this property is mandatory and must be present.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="f2dfcdf74f160f88" href="../../R/f2dfcdf74f160f88.html" target="n" data-glyph="102,1" class="i property">Mandatory</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates that this property is a key.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="e12bd6b71ced59c2" href="../../R/e12bd6b71ced59c2.html" target="n" data-glyph="102,1" class="i property">IsKey</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates a range constraint on the property value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <span class="i">Tuple</span>&lt;<b>int</b>, <b>int</b>&gt; <a id="b9f5f3f31c8a541c" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Range</a> { <b>get</b>; <b>set</b>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Metadata about a parameter for a dynamic keyword. Adds one</span>
    <span class="c">///</span><span class="c"> new property to the base classL Switch for switch parameters</span>
    <span class="c">///</span><span class="c"> (THere is no such thing as a switch property...)</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="356fa9ee3b2e9e55" href="../../R/356fa9ee3b2e9e55.html" target="n" data-glyph="0,0" class="t t"><span id="15e6f3b95f0aa4b6">DynamicKeywordParameter</span></a> : <a href="#d3231c99121763c4" class="t t">DynamicKeywordProperty</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Type if this is a switch parameter and takes no argument.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="7fdb52ddc25038f8" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Switch</a> { <b>get</b>; <b>set</b>; }
    }
 
    <b>internal enum</b> <a id="39faa36c58f275ae" href="../../R/39faa36c58f275ae.html" target="n" data-glyph="20,0" class="t t"><span id="07d1712ad08d9e61">TokenizerMode</span></a>
    {
        <a id="d9f88bf7436b84df" href="../../R/d9f88bf7436b84df.html" target="n" data-glyph="24,1" class="i field">Command</a>,
        <a id="9b6269e007d113c3" href="../../R/9b6269e007d113c3.html" target="n" data-glyph="24,1" class="i field">Expression</a>,
        <a id="2fb25110d5ff3e8b" href="../../R/2fb25110d5ff3e8b.html" target="n" data-glyph="24,1" class="i field">TypeName</a>,
        <a id="2dcac73d38701d80" href="../../R/2dcac73d38701d80.html" target="n" data-glyph="24,1" class="i field">Signature</a>, <span class="c">// i.e. class or method declaration</span>
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Indicates which suffix character(s) are present in the numeric literal being parsed by TryGetNumberValue.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    [<span class="i">Flags</span>]
    <b>internal enum</b> <a id="e31681b07a75f739" href="../../R/e31681b07a75f739.html" target="n" data-glyph="20,0" class="t t"><span id="928c2a0f4cc0fd5e">NumberSuffixFlags</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates no suffix, a raw numeric literal. May be parsed as Int32, Int64, or Double.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="a316a1ebc21c5a21" href="../../R/a316a1ebc21c5a21.html" target="n" data-glyph="24,1" class="i field">None</a> = 0x0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates &#39;u&#39; suffix for unsigned integers. May be parsed as UInt32 or UInt64, depending on the value.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="379c3e532c488690" href="../../R/379c3e532c488690.html" target="n" data-glyph="24,1" class="i field">Unsigned</a> = 0x1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates &#39;y&#39; suffix for signed byte (sbyte) values.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="c9973660084ff789" href="../../R/c9973660084ff789.html" target="n" data-glyph="24,1" class="i field">SignedByte</a> = 0x2,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates &#39;uy&#39; suffix for unsigned byte values.</span>
        <span class="c">///</span><span class="c"> This is a compound value, representing both SignedByte and Unsigned flags being set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="ce6ab8e93185811e" href="../../R/ce6ab8e93185811e.html" target="n" data-glyph="24,1" class="i field">UnsignedByte</a> = 0x3,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates &#39;s&#39; suffix for short (Int16) integers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="2c57f28002eed0e4" href="../../R/2c57f28002eed0e4.html" target="n" data-glyph="24,1" class="i field">Short</a> = 0x4,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates &#39;us&#39; suffix for ushort (UInt16) integers.</span>
        <span class="c">///</span><span class="c"> This is a compound flag value, representing both Unsigned and Short flags being set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="b0da53a1cb2b2626" href="../../R/b0da53a1cb2b2626.html" target="n" data-glyph="24,1" class="i field">UnsignedShort</a> = 0x5,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates &#39;l&#39; suffix for long (Int64) integers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="de9fac127152873b" href="../../R/de9fac127152873b.html" target="n" data-glyph="24,1" class="i field">Long</a> = 0x8,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates &#39;ul&#39; suffix for ulong (UInt64) integers.</span>
        <span class="c">///</span><span class="c"> This is a compound flag value, representing both Unsigned and Long flags being set.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="ede3402395b50145" href="../../R/ede3402395b50145.html" target="n" data-glyph="24,1" class="i field">UnsignedLong</a> = 0x9,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates &#39;d&#39; suffix for decimal (128-bit) real numbers.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="f91b842ea6fa4849" href="../../R/f91b842ea6fa4849.html" target="n" data-glyph="24,1" class="i field">Decimal</a> = 0x10,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates &#39;N&#39; suffix for BigInteger (arbitrarily large integer) numerals.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="7953909b7f4420a8" href="../../R/7953909b7f4420a8.html" target="n" data-glyph="24,1" class="i field">BigInteger</a> = 0x20
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Indicates the format of a numeric literal.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal enum</b> <a id="c7287a05d62564a0" href="../../R/c7287a05d62564a0.html" target="n" data-glyph="20,0" class="t t"><span id="d42a68e87fcb46a9">NumberFormat</span></a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates standard decimal literal, no necessary prefix.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="9984b941fc71be77" href="../../R/9984b941fc71be77.html" target="n" data-glyph="24,1" class="i field">Decimal</a> = 0x0,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates hexadecimal literal, with &#39;0x&#39; prefix.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="2e84f234ea8d22d1" href="../../R/2e84f234ea8d22d1.html" target="n" data-glyph="24,1" class="i field">Hex</a> = 0x1,
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Indicates binary literal, with &#39;0b&#39; prefix.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a id="ece06b9bfb9ceedb" href="../../R/ece06b9bfb9ceedb.html" target="n" data-glyph="24,1" class="i field">Binary</a> = 0x2
    }
 
    <span class="c">//</span>
    <span class="c">// Class used to do a partial snapshot of the state of the tokenizer.</span>
    <span class="c">// This is used for nested scans on the same string.</span>
    <span class="c">//</span>
    <b>internal class</b> <a id="7ca04afa98129e98" href="../../R/7ca04afa98129e98.html" target="n" data-glyph="2,0" class="t t"><span id="658b90b937516316">TokenizerState</span></a>
    {
        <b>internal int</b> <a id="8f14ead52a5dead2" href="../../R/8f14ead52a5dead2.html" target="n" data-glyph="44,1" class="i field">NestedTokensAdjustment</a>;
        <b>internal string</b> <a id="4fb720dd356b8bf3" href="../../R/4fb720dd356b8bf3.html" target="n" data-glyph="44,1" class="i field">Script</a>;
        <b>internal int</b> <a id="229f587f99273cf3" href="../../R/229f587f99273cf3.html" target="n" data-glyph="44,1" class="i field">TokenStart</a>;
        <b>internal int</b> <a id="6ccb48792f361a83" href="../../R/6ccb48792f361a83.html" target="n" data-glyph="44,1" class="i field">CurrentIndex</a>;
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="8d125e0ef3edc43a" href="../../R/8d125e0ef3edc43a.html" target="n" data-glyph="44,1" class="i field">FirstToken</a>;
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="cfd77fa9f732f6ea" href="../../R/cfd77fa9f732f6ea.html" target="n" data-glyph="44,1" class="i field">LastToken</a>;
        <b>internal</b> <span class="i">BitArray</span> <a id="fb88569054514c4b" href="../../R/fb88569054514c4b.html" target="n" data-glyph="44,1" class="i field">SkippedCharOffsets</a>;
        <b>internal</b> <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <a id="e66784b532a2b97d" href="../../R/e66784b532a2b97d.html" target="n" data-glyph="44,1" class="i field">TokenList</a>;
    }
 
    [<span class="i">DebuggerDisplay</span>(<span class="s">&quot;Mode = {Mode}; Script = {_script}&quot;</span>)]
    <b>internal class</b> <a id="fac4dc2d20ae0759" href="../../R/fac4dc2d20ae0759.html" target="n" data-glyph="2,0" class="t t">Tokenizer</a>
    {
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>&gt; <a id="73147b47cbee6e76" href="../../R/73147b47cbee6e76.html" target="n" data-glyph="46,1" class="i field">s_keywordTable</a>
            = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>&gt; <a id="e222a4381ebc97d4" href="../../R/e222a4381ebc97d4.html" target="n" data-glyph="46,1" class="i field">s_operatorTable</a>
            = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <b>private static readonly char</b> <a id="a887df35fd840574" href="../../R/a887df35fd840574.html" target="n" data-glyph="46,1" class="i field">s_invalidChar</a> = <b>char</b>.<span class="i">MaxValue</span>;
        <b>private static readonly int</b> <a id="b88c406da88382e6" href="../../R/b88c406da88382e6.html" target="n" data-glyph="46,1" class="i field">s_maxNumberOfUnicodeHexDigits</a> = 6;
 
        <b>private readonly</b> <a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <a id="723d6161b419cd59" href="../../R/723d6161b419cd59.html" target="n" data-glyph="46,1" class="i field">_parser</a>;
        <b>private</b> <a href="Position.cs.html#6f2c232523d08297" class="t t">PositionHelper</a> <a id="48c59219614a27c6" href="../../R/48c59219614a27c6.html" target="n" data-glyph="46,1" class="i field">_positionHelper</a>;
        <b>private int</b> <a id="5d92fd6f8ab1c2bb" href="../../R/5d92fd6f8ab1c2bb.html" target="n" data-glyph="46,1" class="i field">_nestedTokensAdjustment</a>;
 
        <span class="c">// This BitArray is used to help ensure we get the correct extent in a corner case that looks something like:</span>
        <span class="c">//     $(&quot;&quot;abc&quot;&quot;)</span>
        <span class="c">// In the above, we scan the characters between the parens once and create a token that is scanned later. This</span>
        <span class="c">// first pass scan replaces doubled quotes with single quotes so that a subsequent scan will see: &quot;abc&quot; instead</span>
        <span class="c">// of: &quot;&quot;abc&quot;&quot;.  (This isn&#39;t really necessary, but is done for backwards compatibility.)  If we didn&#39;t track</span>
        <span class="c">// the skipped quotes, we&#39;d generate incorrect extent of the string token on subsequent rescans.</span>
        <b>private</b> <span class="i">BitArray</span> <a id="46de558ea23c5764" href="../../R/46de558ea23c5764.html" target="n" data-glyph="46,1" class="i field">_skippedCharOffsets</a>;
 
        <b>private string</b> <a id="0d494c77d31a8678" href="../../R/0d494c77d31a8678.html" target="n" data-glyph="46,1" class="i field">_script</a>;
        <b>private int</b> <a id="5bd4253c46df22b0" href="../../R/5bd4253c46df22b0.html" target="n" data-glyph="46,1" class="i field">_tokenStart</a>;
        <b>private int</b> <a id="3ba524e6ec6f6c8b" href="../../R/3ba524e6ec6f6c8b.html" target="n" data-glyph="46,1" class="i field">_currentIndex</a>;
        <b>private</b> <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a> <a id="9ada150e23c8f53b" href="../../R/9ada150e23c8f53b.html" target="n" data-glyph="46,1" class="i field">_beginSignatureExtent</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Tables for initialization
 
        <b>private static readonly string</b>[] <a id="e589796cc657afe1" href="../../R/e589796cc657afe1.html" target="n" data-glyph="46,1" class="i field">s_keywordText</a> = <b>new</b> <b>string</b>[] {
        <span class="c">/*1*/</span>    <span class="s">&quot;elseif&quot;</span>,                  <span class="s">&quot;if&quot;</span>,               <span class="s">&quot;else&quot;</span>,             <span class="s">&quot;switch&quot;</span>,                     <span class="c">/*1*/</span>
        <span class="c">/*2*/</span>    <span class="s">&quot;foreach&quot;</span>,                 <span class="s">&quot;from&quot;</span>,             <span class="s">&quot;in&quot;</span>,               <span class="s">&quot;for&quot;</span>,                        <span class="c">/*2*/</span>
        <span class="c">/*3*/</span>    <span class="s">&quot;while&quot;</span>,                   <span class="s">&quot;until&quot;</span>,            <span class="s">&quot;do&quot;</span>,               <span class="s">&quot;try&quot;</span>,                        <span class="c">/*3*/</span>
        <span class="c">/*4*/</span>    <span class="s">&quot;catch&quot;</span>,                   <span class="s">&quot;finally&quot;</span>,          <span class="s">&quot;trap&quot;</span>,             <span class="s">&quot;data&quot;</span>,                       <span class="c">/*4*/</span>
        <span class="c">/*5*/</span>    <span class="s">&quot;return&quot;</span>,                  <span class="s">&quot;continue&quot;</span>,         <span class="s">&quot;break&quot;</span>,            <span class="s">&quot;exit&quot;</span>,                       <span class="c">/*5*/</span>
        <span class="c">/*6*/</span>    <span class="s">&quot;throw&quot;</span>,                   <span class="s">&quot;begin&quot;</span>,            <span class="s">&quot;process&quot;</span>,          <span class="s">&quot;end&quot;</span>,                        <span class="c">/*6*/</span>
        <span class="c">/*7*/</span>    <span class="s">&quot;dynamicparam&quot;</span>,            <span class="s">&quot;function&quot;</span>,         <span class="s">&quot;filter&quot;</span>,           <span class="s">&quot;param&quot;</span>,                      <span class="c">/*7*/</span>
        <span class="c">/*8*/</span>    <span class="s">&quot;class&quot;</span>,                   <span class="s">&quot;define&quot;</span>,           <span class="s">&quot;var&quot;</span>,              <span class="s">&quot;using&quot;</span>,                      <span class="c">/*8*/</span>
        <span class="c">/*9*/</span>    <span class="s">&quot;workflow&quot;</span>,                <span class="s">&quot;parallel&quot;</span>,         <span class="s">&quot;sequence&quot;</span>,         <span class="s">&quot;inlinescript&quot;</span>,               <span class="c">/*9*/</span>
        <span class="c">/*A*/</span>    <span class="s">&quot;configuration&quot;</span>,           <span class="s">&quot;public&quot;</span>,           <span class="s">&quot;private&quot;</span>,          <span class="s">&quot;static&quot;</span>,                     <span class="c">/*A*/</span>
        <span class="c">/*B*/</span>    <span class="s">&quot;interface&quot;</span>,               <span class="s">&quot;enum&quot;</span>,             <span class="s">&quot;namespace&quot;</span>,        <span class="s">&quot;module&quot;</span>,                     <span class="c">/*B*/</span>
        <span class="c">/*C*/</span>    <span class="s">&quot;type&quot;</span>,                    <span class="s">&quot;assembly&quot;</span>,         <span class="s">&quot;command&quot;</span>,          <span class="s">&quot;hidden&quot;</span>,                     <span class="c">/*C*/</span>
        <span class="c">/*D*/</span>    <span class="s">&quot;base&quot;</span>,                    <span class="s">&quot;default&quot;</span>,                                                            <span class="c">/*D*/</span>
        };
 
        <b>private static readonly</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>[] <a id="94799b8eb167fbf8" href="../../R/94799b8eb167fbf8.html" target="n" data-glyph="46,1" class="i field">s_keywordTokenKind</a> = <b>new</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>[] {
        <span class="c">/*1*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b2d298294746ea02" class="i field">ElseIf</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c81edbb275411cf8" class="i field">If</a>,       <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4f659f327f8dcd2c" class="i field">Else</a>,      <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#16bd62526b80a3f2" class="i field">Switch</a>,            <span class="c">/*1*/</span>
        <span class="c">/*2*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5b4aeac56a39476f" class="i field">Foreach</a>,         <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4e63f55d1e632f22" class="i field">From</a>,     <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#93ab1d10ca7f1f77" class="i field">In</a>,        <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#783a6f71a3854549" class="i field">For</a>,               <span class="c">/*2*/</span>
        <span class="c">/*3*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#73bf75a67618407f" class="i field">While</a>,           <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3775e39bd88a79e5" class="i field">Until</a>,    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b1e5a3400d6e1c03" class="i field">Do</a>,        <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fadaef62886f88e2" class="i field">Try</a>,               <span class="c">/*3*/</span>
        <span class="c">/*4*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c84d840825952d7b" class="i field">Catch</a>,           <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4524273aecb9e45c" class="i field">Finally</a>,  <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d05715c602a417ca" class="i field">Trap</a>,      <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#201174c1f7b0fa04" class="i field">Data</a>,              <span class="c">/*4*/</span>
        <span class="c">/*5*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#edc303eb50c77bb8" class="i field">Return</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fe3642108980de67" class="i field">Continue</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#061f2b67dad9bf4f" class="i field">Break</a>,     <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#576951e7d9614f3b" class="i field">Exit</a>,              <span class="c">/*5*/</span>
        <span class="c">/*6*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#580acfa458287a29" class="i field">Throw</a>,           <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#21e2c9fe8b59b672" class="i field">Begin</a>,    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5a3e1e2680f1369f" class="i field">Process</a>,   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#052b72289e97de9a" class="i field">End</a>,               <span class="c">/*6*/</span>
        <span class="c">/*7*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#47d5893abf9a2fb2" class="i field">Dynamicparam</a>,    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3c2a6b9c7f9c912e" class="i field">Function</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#52136afaad8df2b6" class="i field">Filter</a>,    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3dce94013578e058" class="i field">Param</a>,             <span class="c">/*7*/</span>
        <span class="c">/*8*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#00143ac38c888bfa" class="i field">Class</a>,           <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#347b5b545161c618" class="i field">Define</a>,   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f407e8439ffcdefc" class="i field">Var</a>,       <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9e1e77e046f0b0f" class="i field">Using</a>,             <span class="c">/*8*/</span>
        <span class="c">/*9*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#99d9163a866a9433" class="i field">Workflow</a>,        <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#2078224c34fc71d1" class="i field">Parallel</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8b72ef21ced0e588" class="i field">Sequence</a>,  <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7002a360506192c2" class="i field">InlineScript</a>,      <span class="c">/*9*/</span>
        <span class="c">/*A*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c97348c99412133c" class="i field">Configuration</a>,   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#181fb065e30dd1f7" class="i field">Public</a>,   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6ca9381ae482db0a" class="i field">Private</a>,   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c46f4d572b9409c5" class="i field">Static</a>,            <span class="c">/*A*/</span>
        <span class="c">/*B*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d0d7d7f79ed4540d" class="i field">Interface</a>,       <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6db945f74edccb76" class="i field">Enum</a>,     <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#015fb9772cac6b50" class="i field">Namespace</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#28e33e1e928d8428" class="i field">Module</a>,            <span class="c">/*B*/</span>
        <span class="c">/*C*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d9216d9794ad2d67" class="i field">Type</a>,            <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4369a9b7ca950fe3" class="i field">Assembly</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#024a39a4c23da230" class="i field">Command</a>,   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e78a6a229c4b55ce" class="i field">Hidden</a>,            <span class="c">/*C*/</span>
        <span class="c">/*D*/</span>    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d50e353dd6e40631" class="i field">Base</a>,            <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a01b3cf32fcceac9" class="i field">Default</a>,                                                    <span class="c">/*D*/</span>
        };
 
        <b>internal static readonly string</b>[] <a id="d1014122afd4af1c" href="../../R/d1014122afd4af1c.html" target="n" data-glyph="44,1" class="i field">_operatorText</a> = <b>new</b> <b>string</b>[] {
        <span class="c">/*1*/</span>   <span class="s">&quot;bnot&quot;</span>,                 <span class="s">&quot;not&quot;</span>,                  <span class="s">&quot;eq&quot;</span>,                   <span class="s">&quot;ieq&quot;</span>,                    <span class="c">/*1*/</span>
        <span class="c">/*2*/</span>   <span class="s">&quot;ceq&quot;</span>,                  <span class="s">&quot;ne&quot;</span>,                   <span class="s">&quot;ine&quot;</span>,                  <span class="s">&quot;cne&quot;</span>,                    <span class="c">/*2*/</span>
        <span class="c">/*3*/</span>   <span class="s">&quot;ge&quot;</span>,                   <span class="s">&quot;ige&quot;</span>,                  <span class="s">&quot;cge&quot;</span>,                  <span class="s">&quot;gt&quot;</span>,                     <span class="c">/*3*/</span>
        <span class="c">/*4*/</span>   <span class="s">&quot;igt&quot;</span>,                  <span class="s">&quot;cgt&quot;</span>,                  <span class="s">&quot;lt&quot;</span>,                   <span class="s">&quot;ilt&quot;</span>,                    <span class="c">/*4*/</span>
        <span class="c">/*5*/</span>   <span class="s">&quot;clt&quot;</span>,                  <span class="s">&quot;le&quot;</span>,                   <span class="s">&quot;ile&quot;</span>,                  <span class="s">&quot;cle&quot;</span>,                    <span class="c">/*5*/</span>
        <span class="c">/*6*/</span>   <span class="s">&quot;like&quot;</span>,                 <span class="s">&quot;ilike&quot;</span>,                <span class="s">&quot;clike&quot;</span>,                <span class="s">&quot;notlike&quot;</span>,                <span class="c">/*6*/</span>
        <span class="c">/*7*/</span>   <span class="s">&quot;inotlike&quot;</span>,             <span class="s">&quot;cnotlike&quot;</span>,             <span class="s">&quot;match&quot;</span>,                <span class="s">&quot;imatch&quot;</span>,                 <span class="c">/*7*/</span>
        <span class="c">/*8*/</span>   <span class="s">&quot;cmatch&quot;</span>,               <span class="s">&quot;notmatch&quot;</span>,             <span class="s">&quot;inotmatch&quot;</span>,            <span class="s">&quot;cnotmatch&quot;</span>,              <span class="c">/*8*/</span>
        <span class="c">/*9*/</span>   <span class="s">&quot;replace&quot;</span>,              <span class="s">&quot;ireplace&quot;</span>,             <span class="s">&quot;creplace&quot;</span>,             <span class="s">&quot;contains&quot;</span>,               <span class="c">/*9*/</span>
        <span class="c">/*10*/</span>  <span class="s">&quot;icontains&quot;</span>,            <span class="s">&quot;ccontains&quot;</span>,            <span class="s">&quot;notcontains&quot;</span>,          <span class="s">&quot;inotcontains&quot;</span>,           <span class="c">/*10*/</span>
        <span class="c">/*11*/</span>  <span class="s">&quot;cnotcontains&quot;</span>,         <span class="s">&quot;in&quot;</span>,                   <span class="s">&quot;iin&quot;</span>,                  <span class="s">&quot;cin&quot;</span>,                    <span class="c">/*11*/</span>
        <span class="c">/*12*/</span>  <span class="s">&quot;notin&quot;</span>,                <span class="s">&quot;inotin&quot;</span>,               <span class="s">&quot;cnotin&quot;</span>,               <span class="s">&quot;split&quot;</span>,                  <span class="c">/*12*/</span>
        <span class="c">/*13*/</span>  <span class="s">&quot;isplit&quot;</span>,               <span class="s">&quot;csplit&quot;</span>,               <span class="s">&quot;isnot&quot;</span>,                <span class="s">&quot;is&quot;</span>,                     <span class="c">/*13*/</span>
        <span class="c">/*14*/</span>  <span class="s">&quot;as&quot;</span>,                   <span class="s">&quot;f&quot;</span>,                    <span class="s">&quot;and&quot;</span>,                  <span class="s">&quot;band&quot;</span>,                   <span class="c">/*14*/</span>
        <span class="c">/*15*/</span>  <span class="s">&quot;or&quot;</span>,                   <span class="s">&quot;bor&quot;</span>,                  <span class="s">&quot;xor&quot;</span>,                  <span class="s">&quot;bxor&quot;</span>,                   <span class="c">/*15*/</span>
        <span class="c">/*16*/</span>  <span class="s">&quot;join&quot;</span>,                 <span class="s">&quot;shl&quot;</span>,                  <span class="s">&quot;shr&quot;</span>,                                            <span class="c">/*16*/</span>
        };
 
        <b>private static readonly</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>[] <a id="75d68534c4e47e0d" href="../../R/75d68534c4e47e0d.html" target="n" data-glyph="46,1" class="i field">s_operatorTokenKind</a> = <b>new</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>[] {
        <span class="c">/*1*/</span>   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#da0aaa4e75a66f2a" class="i field">Bnot</a>,         <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#95193423aec1ddd7" class="i field">Not</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#654217947abd11a4" class="i field">Ieq</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#654217947abd11a4" class="i field">Ieq</a>,            <span class="c">/*1*/</span>
        <span class="c">/*2*/</span>   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e5bb5a7a24d93ebc" class="i field">Ceq</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#82b3fc4a021370b1" class="i field">Ine</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#82b3fc4a021370b1" class="i field">Ine</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#04b70e3eaa61d27e" class="i field">Cne</a>,            <span class="c">/*2*/</span>
        <span class="c">/*3*/</span>   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6fefd865f09cf1a8" class="i field">Ige</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6fefd865f09cf1a8" class="i field">Ige</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#bc8ca8ef43bf7b4f" class="i field">Cge</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6c26f085506e329b" class="i field">Igt</a>,            <span class="c">/*3*/</span>
        <span class="c">/*4*/</span>   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6c26f085506e329b" class="i field">Igt</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a58601fe1f113b12" class="i field">Cgt</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#371ecc3ecbaec392" class="i field">Ilt</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#371ecc3ecbaec392" class="i field">Ilt</a>,            <span class="c">/*4*/</span>
        <span class="c">/*5*/</span>   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#47f2fc75e6daef97" class="i field">Clt</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#796d7079962597d7" class="i field">Ile</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#796d7079962597d7" class="i field">Ile</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8740d4da8d485dad" class="i field">Cle</a>,            <span class="c">/*5*/</span>
        <span class="c">/*6*/</span>   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c54e36505d9969ea" class="i field">Ilike</a>,        <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c54e36505d9969ea" class="i field">Ilike</a>,        <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#763ad9f2f8eb2f5d" class="i field">Clike</a>,        <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#0b21ff7aee97bf81" class="i field">Inotlike</a>,       <span class="c">/*6*/</span>
        <span class="c">/*7*/</span>   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#0b21ff7aee97bf81" class="i field">Inotlike</a>,     <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#440a0e98089143a6" class="i field">Cnotlike</a>,     <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#34df816720a975fd" class="i field">Imatch</a>,       <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#34df816720a975fd" class="i field">Imatch</a>,         <span class="c">/*7*/</span>
        <span class="c">/*8*/</span>   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa6622aef3429cc2" class="i field">Cmatch</a>,       <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ef6e9e5606d594d5" class="i field">Inotmatch</a>,    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ef6e9e5606d594d5" class="i field">Inotmatch</a>,    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ee8fcf3f41c67c3f" class="i field">Cnotmatch</a>,      <span class="c">/*8*/</span>
        <span class="c">/*9*/</span>   <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9d54d579ae38f45e" class="i field">Ireplace</a>,     <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9d54d579ae38f45e" class="i field">Ireplace</a>,     <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c37a1de4056ff472" class="i field">Creplace</a>,     <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#530d7c9f9fd7e08c" class="i field">Icontains</a>,      <span class="c">/*9*/</span>
        <span class="c">/*10*/</span>  <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#530d7c9f9fd7e08c" class="i field">Icontains</a>,    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fb21c1fe57891ef6" class="i field">Ccontains</a>,    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1166b872b2bf0813" class="i field">Inotcontains</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1166b872b2bf0813" class="i field">Inotcontains</a>,   <span class="c">/*10*/</span>
        <span class="c">/*11*/</span>  <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a99c9e9309b56718" class="i field">Cnotcontains</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f646c012e5d57683" class="i field">Iin</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f646c012e5d57683" class="i field">Iin</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#28b871ac294883c0" class="i field">Cin</a>,            <span class="c">/*11*/</span>
        <span class="c">/*12*/</span>  <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ac47c0af7f6a5134" class="i field">Inotin</a>,       <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ac47c0af7f6a5134" class="i field">Inotin</a>,       <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#51a3343dfd4aa02d" class="i field">Cnotin</a>,       <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#512ad4ecc7f9168c" class="i field">Isplit</a>,         <span class="c">/*12*/</span>
        <span class="c">/*13*/</span>  <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#512ad4ecc7f9168c" class="i field">Isplit</a>,       <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3f80cdd8640b6048" class="i field">Csplit</a>,       <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6499a0b891625abc" class="i field">IsNot</a>,        <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7e2491f4694546b3" class="i field">Is</a>,             <span class="c">/*13*/</span>
        <span class="c">/*14*/</span>  <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#2296173a31893567" class="i field">As</a>,           <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5d102cfc5c0d27e8" class="i field">Format</a>,       <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#14e331a4180e8cfa" class="i field">And</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#742ab03d28efc2a6" class="i field">Band</a>,           <span class="c">/*14*/</span>
        <span class="c">/*15*/</span>  <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#eacefffd17e34bf2" class="i field">Or</a>,           <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9bd33d529c1d4993" class="i field">Bor</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e2a921da8dc5458e" class="i field">Xor</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c6229e7399dcf894" class="i field">Bxor</a>,           <span class="c">/*15*/</span>
        <span class="c">/*16*/</span>  <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#0fae0b73746901d5" class="i field">Join</a>,         <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#683bd53c88e0d334" class="i field">Shl</a>,          <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b807b1f385cda6bc" class="i field">Shr</a>,                                    <span class="c">/*16*/</span>
        };
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Tables for initialization
 
        <b>static</b> <a id="4bb83127b7358701" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">Tokenizer</a>()
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#e589796cc657afe1" class="i field">s_keywordText</a>.<span class="i">Length</span> == <a href="#94799b8eb167fbf8" class="i field">s_keywordTokenKind</a>.<span class="i">Length</span>, <span class="s">&quot;Keyword table sizes must match&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#d1014122afd4af1c" class="i field">_operatorText</a>.<span class="i">Length</span> == <a href="#75d68534c4e47e0d" class="i field">s_operatorTokenKind</a>.<span class="i">Length</span>, <span class="s">&quot;Operator table sizes must match&quot;</span>);
 
            <b>for</b> (<b>int</b> <span id="r24 rd" class="r24 r">i</span> = 0; <span class="r24 r">i</span> &lt; <a href="#e589796cc657afe1" class="i field">s_keywordText</a>.<span class="i">Length</span>; ++<span class="r24 r">i</span>)
            {
                <a href="#73147b47cbee6e76" class="i field">s_keywordTable</a>.<span class="i">Add</span>(<a href="#e589796cc657afe1" class="i field">s_keywordText</a>[<span class="r24 r">i</span>], <a href="#94799b8eb167fbf8" class="i field">s_keywordTokenKind</a>[<span class="r24 r">i</span>]);
            }
 
            <b>for</b> (<b>int</b> <span id="r25 rd" class="r25 r">i</span> = 0; <span class="r25 r">i</span> &lt; <a href="#d1014122afd4af1c" class="i field">_operatorText</a>.<span class="i">Length</span>; ++<span class="r25 r">i</span>)
            {
                <a href="#e222a4381ebc97d4" class="i field">s_operatorTable</a>.<span class="i">Add</span>(<a href="#d1014122afd4af1c" class="i field">_operatorText</a>[<span class="r25 r">i</span>], <a href="#75d68534c4e47e0d" class="i field">s_operatorTokenKind</a>[<span class="r25 r">i</span>]);
            }
 
            <span class="c">// The real signature (in mshsip.cpp) has spaces, but we ignore whitespace when looking</span>
            <span class="c">// for signatures because we only care about things that look like a signature.</span>
            <span class="c">// The hash we compute is intentionally dumb, we want collisions to catch similar strings,</span>
            <span class="c">// so we just sum up the characters.</span>
            <b>const string</b> <span id="r26 rd" class="r26 r">beginSig</span> = <span class="s">&quot;sig#beginsignatureblock&quot;</span>;
            <span class="r26 r">beginSig</span>.<span class="i">Aggregate</span>(0, <b>static</b> (<span id="r27 rd" class="r27 r">current</span>, <span id="r28 rd" class="r28 r">t</span>) =&gt; <span class="r27 r">current</span> + <span class="r28 r">t</span>);
 
            <span class="c">// Spot check to help make sure the arrays are in sync</span>
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#73147b47cbee6e76" class="i field">s_keywordTable</a>[<span class="s">&quot;using&quot;</span>] == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9e1e77e046f0b0f" class="i field">Using</a>, <span class="s">&quot;Keyword table out of sync w/ enum&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#e222a4381ebc97d4" class="i field">s_operatorTable</a>[<span class="s">&quot;join&quot;</span>] == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#0fae0b73746901d5" class="i field">Join</a>, <span class="s">&quot;Operator table out of sync w/ enum&quot;</span>);
        }
 
        <b>internal</b> <a id="52ace7262fad7648" href="../../R/52ace7262fad7648.html" target="n" data-glyph="74,1" class="t constructor">Tokenizer</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r29 rd" class="r29 r">parser</span>)
        {
            <a href="#723d6161b419cd59" class="i field">_parser</a> = <span class="r29 r">parser</span>;
        }
 
        <b>internal</b> <a href="#39faa36c58f275ae" class="t t">TokenizerMode</a> <a id="e8fec060763b56d8" href="../../R/e8fec060763b56d8.html" target="n" data-glyph="104,1" class="i property">Mode</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal bool</b> <a id="cc92b8f58ff56ac5" href="../../R/cc92b8f58ff56ac5.html" target="n" data-glyph="104,1" class="i property">AllowSignedNumbers</a> { <b>get</b>; <b>set</b>; }
 
        <span class="c">// TODO: use auto-properties when making &#39;ternary operator&#39; an official feature.</span>
        <b>private bool</b> <a id="9a3c0716c733a58f" href="../../R/9a3c0716c733a58f.html" target="n" data-glyph="46,1" class="i field">_forceEndNumberOnTernaryOpChars</a>;
 
        <b>internal bool</b> <a id="0259572152f59499" href="../../R/0259572152f59499.html" target="n" data-glyph="104,1" class="i property">ForceEndNumberOnTernaryOpChars</a>
        {
            <b>get</b> { <b>return</b> <a href="#9a3c0716c733a58f" class="i field">_forceEndNumberOnTernaryOpChars</a>; }
            <b>set</b> { <a href="#9a3c0716c733a58f" class="i field">_forceEndNumberOnTernaryOpChars</a> = <b>value</b>; }
        }
 
        <b>internal bool</b> <a id="8103814d5a556488" href="../../R/8103814d5a556488.html" target="n" data-glyph="104,1" class="i property">WantSimpleName</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal bool</b> <a id="73ba79aabc0d9f2b" href="../../R/73ba79aabc0d9f2b.html" target="n" data-glyph="104,1" class="i property">InWorkflowContext</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <a id="233100b0d292a6a3" href="../../R/233100b0d292a6a3.html" target="n" data-glyph="104,1" class="i property">TokenList</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="0b3a6fb9271cc752" href="../../R/0b3a6fb9271cc752.html" target="n" data-glyph="104,1" class="i property">FirstToken</a> { <b>get</b>; <b>private set</b>; }
 
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="830aef4c77937ae5" href="../../R/830aef4c77937ae5.html" target="n" data-glyph="104,1" class="i property">LastToken</a> { <b>get</b>; <b>private set</b>; }
 
        <b>private</b> <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <a id="391d6eec748ef604" href="../../R/391d6eec748ef604.html" target="n" data-glyph="106,1" class="i property">RequiresTokens</a> { <b>get</b>; <b>set</b>; }
 
        <b>private bool</b> <a id="11a31983df5b2639" href="../../R/11a31983df5b2639.html" target="n" data-glyph="76,1" class="i method">InCommandMode</a>() { <b>return</b> <a href="#e8fec060763b56d8" class="i property">Mode</a> == <a href="#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="#d9f88bf7436b84df" class="i field">Command</a>; }
 
        <b>private bool</b> <a id="39741816bda0c4aa" href="../../R/39741816bda0c4aa.html" target="n" data-glyph="76,1" class="i method">InExpressionMode</a>() { <b>return</b> <a href="#e8fec060763b56d8" class="i property">Mode</a> == <a href="#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="#9b6269e007d113c3" class="i field">Expression</a>; }
 
        <b>private bool</b> <a id="6ff55ab34ff1c275" href="../../R/6ff55ab34ff1c275.html" target="n" data-glyph="76,1" class="i method">InTypeNameMode</a>() { <b>return</b> <a href="#e8fec060763b56d8" class="i property">Mode</a> == <a href="#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="#2fb25110d5ff3e8b" class="i field">TypeName</a>; }
 
        <b>private bool</b> <a id="618efa2aea96ae23" href="../../R/618efa2aea96ae23.html" target="n" data-glyph="76,1" class="i method">InSignatureMode</a>() { <b>return</b> <a href="#e8fec060763b56d8" class="i property">Mode</a> == <a href="#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="#2dcac73d38701d80" class="i field">Signature</a>; }
 
        <b>internal void</b> <a id="be909e3e2bc4f0f4" href="../../R/be909e3e2bc4f0f4.html" target="n" data-glyph="74,1" class="i method">Initialize</a>(<b>string</b> <span id="r30 rd" class="r30 r">fileName</span>, <b>string</b> <span id="r31 rd" class="r31 r">input</span>, <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r32 rd" class="r32 r">tokenList</span>)
        {
            <a href="#48c59219614a27c6" class="i field">_positionHelper</a> = <b>new</b> <a href="Position.cs.html#ba46960c6cb6885b" class="t constructor">PositionHelper</a>(<span class="r30 r">fileName</span>, <span class="r31 r">input</span>);
            <a href="#0d494c77d31a8678" class="i field">_script</a> = <span class="r31 r">input</span>;
            <a href="#fac4dc2d20ae0759" class="k">this</a>.<a href="#233100b0d292a6a3" class="i property">TokenList</a> = <span class="r32 r">tokenList</span>;
            <a href="#fac4dc2d20ae0759" class="k">this</a>.<a href="#0b3a6fb9271cc752" class="i property">FirstToken</a> = <b>null</b>;
            <a href="#fac4dc2d20ae0759" class="k">this</a>.<a href="#830aef4c77937ae5" class="i property">LastToken</a> = <b>null</b>;
            <a href="#fac4dc2d20ae0759" class="k">this</a>.<a href="#391d6eec748ef604" class="i property">RequiresTokens</a> = <b>null</b>;
            <a href="#9ada150e23c8f53b" class="i field">_beginSignatureExtent</a> = <b>null</b>;
 
            <span class="i">List</span>&lt;<b>int</b>&gt; <span id="r33 rd" class="r33 r">lineStartMap</span> = <b>new</b> <span class="i">List</span>&lt;<b>int</b>&gt;(100) { 0 };
            <b>for</b> (<b>int</b> <span id="r34 rd" class="r34 r">i</span> = 0; <span class="r34 r">i</span> &lt; <span class="r31 r">input</span>.<span class="i">Length</span>; ++<span class="r34 r">i</span>)
            {
                <b>char</b> <span id="r35 rd" class="r35 r">c</span> = <span class="r31 r">input</span>[<span class="r34 r">i</span>];
 
                <b>if</b> (<span class="r35 r">c</span> == <span class="s">&#39;\r&#39;</span>)
                {
                    <b>if</b> ((<span class="r34 r">i</span> + 1) &lt; <span class="r31 r">input</span>.<span class="i">Length</span> &amp;&amp; <span class="r31 r">input</span>[<span class="r34 r">i</span> + 1] == <span class="s">&#39;\n&#39;</span>)
                    {
                        <span class="r34 r">i</span> += 1;
                    }
 
                    <span class="r33 r">lineStartMap</span>.<span class="i">Add</span>(<span class="r34 r">i</span> + 1);
                }
 
                <b>if</b> (<span class="r35 r">c</span> == <span class="s">&#39;\n&#39;</span>)
                {
                    <span class="r33 r">lineStartMap</span>.<span class="i">Add</span>(<span class="r34 r">i</span> + 1);
                }
            }
 
            <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> = 0;
            <a href="#e8fec060763b56d8" class="i property">Mode</a> = <a href="#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="#d9f88bf7436b84df" class="i field">Command</a>;
 
            <a href="#48c59219614a27c6" class="i field">_positionHelper</a>.<a href="Position.cs.html#36517953a6b4b4e9" class="i property">LineStartMap</a> = <span class="r33 r">lineStartMap</span>.<span class="i">ToArray</span>();
        }
 
        <b>internal</b> <a href="#7ca04afa98129e98" class="t t">TokenizerState</a> <a id="c9153ca32ee89b31" href="../../R/c9153ca32ee89b31.html" target="n" data-glyph="74,1" class="i method">StartNestedScan</a>(<a href="token.cs.html#ea24fc4d8cf7c397" class="t t">UnscannedSubExprToken</a> <span id="r36 rd" class="r36 r">nestedText</span>)
        {
            <a href="#7ca04afa98129e98" class="t t">TokenizerState</a> <span id="r37 rd" class="r37 r">ts</span> = <b>new</b> <span class="t">TokenizerState</span>
            {
                <a href="#6ccb48792f361a83" class="i field">CurrentIndex</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>,
                <a href="#8f14ead52a5dead2" class="i field">NestedTokensAdjustment</a> = <a href="#5d92fd6f8ab1c2bb" class="i field">_nestedTokensAdjustment</a>,
                <a href="#4fb720dd356b8bf3" class="i field">Script</a> = <a href="#0d494c77d31a8678" class="i field">_script</a>,
                <a href="#229f587f99273cf3" class="i field">TokenStart</a> = <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>,
                <a href="#8d125e0ef3edc43a" class="i field">FirstToken</a> = <a href="#0b3a6fb9271cc752" class="i property">FirstToken</a>,
                <a href="#cfd77fa9f732f6ea" class="i field">LastToken</a> = <a href="#830aef4c77937ae5" class="i property">LastToken</a>,
                <a href="#fb88569054514c4b" class="i field">SkippedCharOffsets</a> = <a href="#46de558ea23c5764" class="i field">_skippedCharOffsets</a>,
                <a href="#e66784b532a2b97d" class="i field">TokenList</a> = <a href="#233100b0d292a6a3" class="i property">TokenList</a>,
            };
 
            <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> = 0;
            <a href="#5d92fd6f8ab1c2bb" class="i field">_nestedTokensAdjustment</a> = ((<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<span class="r36 r">nestedText</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>).<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a>;
            <a href="#0d494c77d31a8678" class="i field">_script</a> = <span class="r36 r">nestedText</span>.<a href="token.cs.html#f95f094124370df7" class="i property">Value</a>;
            <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = 0;
            <a href="#46de558ea23c5764" class="i field">_skippedCharOffsets</a> = <span class="r36 r">nestedText</span>.<a href="token.cs.html#61d93766251f7d70" class="i property">SkippedCharOffsets</a>;
            <a href="#233100b0d292a6a3" class="i property">TokenList</a> = (<a href="#233100b0d292a6a3" class="i property">TokenList</a> != <b>null</b>) ? <b>new</b> <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt;() : <b>null</b>;
 
            <b>return</b> <span class="r37 r">ts</span>;
        }
 
        <b>internal void</b> <a id="28dd58bc3bbb1c19" href="../../R/28dd58bc3bbb1c19.html" target="n" data-glyph="74,1" class="i method">FinishNestedScan</a>(<a href="#7ca04afa98129e98" class="t t">TokenizerState</a> <span id="r38 rd" class="r38 r">ts</span>)
        {
            <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> = <span class="r38 r">ts</span>.<a href="#6ccb48792f361a83" class="i field">CurrentIndex</a>;
            <a href="#5d92fd6f8ab1c2bb" class="i field">_nestedTokensAdjustment</a> = <span class="r38 r">ts</span>.<a href="#8f14ead52a5dead2" class="i field">NestedTokensAdjustment</a>;
            <a href="#0d494c77d31a8678" class="i field">_script</a> = <span class="r38 r">ts</span>.<a href="#4fb720dd356b8bf3" class="i field">Script</a>;
            <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <span class="r38 r">ts</span>.<a href="#229f587f99273cf3" class="i field">TokenStart</a>;
            <a href="#0b3a6fb9271cc752" class="i property">FirstToken</a> = <span class="r38 r">ts</span>.<a href="#8d125e0ef3edc43a" class="i field">FirstToken</a>;
            <a href="#830aef4c77937ae5" class="i property">LastToken</a> = <span class="r38 r">ts</span>.<a href="#cfd77fa9f732f6ea" class="i field">LastToken</a>;
            <a href="#46de558ea23c5764" class="i field">_skippedCharOffsets</a> = <span class="r38 r">ts</span>.<a href="#fb88569054514c4b" class="i field">SkippedCharOffsets</a>;
            <a href="#233100b0d292a6a3" class="i property">TokenList</a> = <span class="r38 r">ts</span>.<a href="#e66784b532a2b97d" class="i field">TokenList</a>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Utilities
 
        <b>private char</b> <a id="e241596f9f370f6c" href="../../R/e241596f9f370f6c.html" target="n" data-glyph="76,1" class="i method">GetChar</a>()
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> &gt;= 0, <span class="s">&quot;GetChar reading before start of input.&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> &lt;= <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span> + 1, <span class="s">&quot;GetChar reading after end of input.&quot;</span>);
 
            <span class="c">// Increment _currentIndex, even if it goes over the Length so callers can call UngetChar to unget EOF.</span>
            <b>int</b> <span id="r39 rd" class="r39 r">current</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>++;
            <b>if</b> (<span class="r39 r">current</span> &gt;= <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span>)
            {
                <b>return</b> <span class="s">&#39;\0&#39;</span>;
            }
 
            <b>return</b> <a href="#0d494c77d31a8678" class="i field">_script</a>[<span class="r39 r">current</span>];
        }
 
        <b>private void</b> <a id="af3b8b303cb8fab6" href="../../R/af3b8b303cb8fab6.html" target="n" data-glyph="76,1" class="i method">UngetChar</a>()
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> &gt; 0, <span class="s">&quot;UngetChar ungetting before start of input.&quot;</span>);
 
            <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> -= 1;
        }
 
        <b>private char</b> <a id="fdaab960a2f6bddd" href="../../R/fdaab960a2f6bddd.html" target="n" data-glyph="76,1" class="i method">PeekChar</a>()
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> &gt;= 0 &amp;&amp; <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> &lt;= <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span>, <span class="s">&quot;PeekChar out of range.&quot;</span>);
 
            <b>if</b> (<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> == <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span>)
            {
                <b>return</b> <span class="s">&#39;\0&#39;</span>;
            }
 
            <b>return</b> <a href="#0d494c77d31a8678" class="i field">_script</a>[<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>];
        }
 
        <b>private void</b> <a id="828671ae3fb1ba5d" href="../../R/828671ae3fb1ba5d.html" target="n" data-glyph="76,1" class="i method">SkipChar</a>()
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>((<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> + 1) &lt;= <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span>, <span class="s">&quot;SkipChar can&#39;t skip past EOF&quot;</span>);
 
            <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> += 1;
        }
 
        <b>private bool</b> <a id="91d350b0c4e63776" href="../../R/91d350b0c4e63776.html" target="n" data-glyph="76,1" class="i method">AtEof</a>()
        {
            <b>return</b> <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> &gt; <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span>;
        }
 
        <b>internal static bool</b> <a id="d678726f968b9d52" href="../../R/d678726f968b9d52.html" target="n" data-glyph="74,1" class="i method">IsKeyword</a>(<b>string</b> <span id="r40 rd" class="r40 r">str</span>)
        {
            <b>if</b> (<a href="#73147b47cbee6e76" class="i field">s_keywordTable</a>.<span class="i">ContainsKey</span>(<span class="r40 r">str</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="#2af1cc3c0788237c" class="i method">ContainsKeyword</a>(<span class="r40 r">str</span>) &amp;&amp; !<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="#7e4c6e6aaae4a0c3" class="i method">IsHiddenKeyword</a>(<span class="r40 r">str</span>))
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>internal void</b> <a id="2e4046ce3ce22f0a" href="../../R/2e4046ce3ce22f0a.html" target="n" data-glyph="74,1" class="i method">SkipNewlines</a>(<b>bool</b> <span id="r41 rd" class="r41 r">skipSemis</span>)
        {
        <span class="c">// We normally don&#39;t create any tokens in a Skip method, but the</span>
        <span class="c">// V2 tokenizer api returns newline, semi-colon, and line</span>
        <span class="c">// continuation tokens so we create them as they are encountered.</span>
        <span class="i">again</span>:
            <b>char</b> <span id="r42 rd" class="r42 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            <b>switch</b> (<span class="r42 r">c</span>)
            {
                <b>case</b> <span class="s">&#39; &#39;</span>:
                <b>case</b> <span class="s">&#39;\t&#39;</span>:
                <b>case</b> <span class="s">&#39;\f&#39;</span>:
                <b>case</b> <span class="s">&#39;\v&#39;</span>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#21979a64c5c53fa4" class="i field">NoBreakSpace</a>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#e30fed19a6ee2568" class="i field">NextLine</a>:
                    <a href="#b561da6fab4d3e94" class="i method">SkipWhiteSpace</a>();
                    <b>goto</b> <span class="i">again</span>;
 
                <b>case</b> <span class="s">&#39;\r&#39;</span>:
                <b>case</b> <span class="s">&#39;\n&#39;</span>:
                    <a href="#e45eee6102940ff7" class="i method">ScanNewline</a>(<span class="r42 r">c</span>);
                    <b>goto</b> <span class="i">again</span>;
 
                <b>case</b> <span class="s">&#39;;&#39;</span>:
                    <b>if</b> (<span class="r41 r">skipSemis</span>)
                    {
                        <a href="#0c8f2ebb7580d52b" class="i method">ScanSemicolon</a>();
                        <b>goto</b> <span class="i">again</span>;
                    }
 
                    <b>break</b>;
 
                <b>case</b> <span class="s">&#39;#&#39;</span>:
                    <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 1;
                    <a href="#01c15cab0ce827be" class="i method">ScanLineComment</a>();
                    <b>goto</b> <span class="i">again</span>;
 
                <b>case</b> <span class="s">&#39;&lt;&#39;</span>:
                    <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;#&#39;</span>)
                    {
                        <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 1;
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <a href="#bf5ffcaeeca02d3d" class="i method">ScanBlockComment</a>();
                        <b>goto</b> <span class="i">again</span>;
                    }
 
                    <b>break</b>;
 
                <b>case</b> <span class="s">&#39;`&#39;</span>:
                    <b>char</b> <span id="r43 rd" class="r43 r">c1</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
                    <b>if</b> (<span class="r43 r">c1</span> == <span class="s">&#39;\n&#39;</span> || <span class="r43 r">c1</span> == <span class="s">&#39;\r&#39;</span>)
                    {
                        <a href="#a2fc76cff761a37d" class="i method">ScanLineContinuation</a>(<span class="r43 r">c1</span>);
                        <b>goto</b> <span class="i">again</span>;
                    }
 
                    <b>if</b> (<b>char</b>.<span class="i">IsWhiteSpace</span>(<span class="r43 r">c1</span>))
                    {
                        <a href="#b561da6fab4d3e94" class="i method">SkipWhiteSpace</a>();
                        <b>goto</b> <span class="i">again</span>;
                    }
 
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <b>break</b>;
 
                <b>default</b>:
                    <b>if</b> (<span class="r42 r">c</span>.<a href="CharTraits.cs.html#66538dacee9a61db" class="i method">IsWhitespace</a>())
                    {
                        <a href="#b561da6fab4d3e94" class="i method">SkipWhiteSpace</a>();
                        <b>goto</b> <span class="i">again</span>;
                    }
 
                    <b>break</b>;
            }
 
            <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
        }
 
        <b>private void</b> <a id="b561da6fab4d3e94" href="../../R/b561da6fab4d3e94.html" target="n" data-glyph="76,1" class="i method">SkipWhiteSpace</a>()
        {
            <b>while</b> (<b>true</b>)
            {
                <b>char</b> <span id="r44 rd" class="r44 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                <b>if</b> (!<span class="r44 r">c</span>.<a href="CharTraits.cs.html#66538dacee9a61db" class="i method">IsWhitespace</a>())
                {
                    <b>break</b>;
                }
 
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
            }
        }
 
        <b>private void</b> <a id="e45eee6102940ff7" href="../../R/e45eee6102940ff7.html" target="n" data-glyph="76,1" class="i method">ScanNewline</a>(<b>char</b> <span id="r45 rd" class="r45 r">c</span>)
        {
            <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 1;
            <a href="#236716b27b254929" class="i method">NormalizeCRLF</a>(<span class="r45 r">c</span>);
 
            <span class="c">// Memory optimization: only create the token if it will be stored</span>
            <b>if</b> (<a href="#233100b0d292a6a3" class="i property">TokenList</a> != <b>null</b>)
            {
                <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a>);
            }
        }
 
        <b>private void</b> <a id="0c8f2ebb7580d52b" href="../../R/0c8f2ebb7580d52b.html" target="n" data-glyph="76,1" class="i method">ScanSemicolon</a>()
        {
            <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 1;
 
            <span class="c">// Memory optimization: only create the token if it will be stored</span>
            <b>if</b> (<a href="#233100b0d292a6a3" class="i property">TokenList</a> != <b>null</b>)
            {
                <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>);
            }
        }
 
        <b>private void</b> <a id="a2fc76cff761a37d" href="../../R/a2fc76cff761a37d.html" target="n" data-glyph="76,1" class="i method">ScanLineContinuation</a>(<b>char</b> <span id="r46 rd" class="r46 r">c</span>)
        {
            <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 2;
            <a href="#236716b27b254929" class="i method">NormalizeCRLF</a>(<span class="r46 r">c</span>);
 
            <span class="c">// Memory optimization: only create the token if it will be stored</span>
            <b>if</b> (<a href="#233100b0d292a6a3" class="i property">TokenList</a> != <b>null</b>)
            {
                <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#756695ee247bdc4d" class="i field">LineContinuation</a>);
            }
        }
 
        <b>internal int</b> <a id="820e8f7ae7d9d17c" href="../../R/820e8f7ae7d9d17c.html" target="n" data-glyph="74,1" class="i method">GetRestorePoint</a>()
        {
            <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
            <b>return</b> <a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>().<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a>;
        }
 
        <b>internal void</b> <a id="8de22e02c2949bb8" href="../../R/8de22e02c2949bb8.html" target="n" data-glyph="74,1" class="i method">Resync</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r47 rd" class="r47 r">token</span>)
        {
            <span class="c">// The parser has decided to backtrack and the tokenizer needs to pretend that it&#39;s</span>
            <span class="c">// starting over from the beginning of token.</span>
 
            <a href="#63c4980d7eb834ea" class="i method">Resync</a>(((<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<span class="r47 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>).<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a>);
        }
 
        <b>internal void</b> <a id="63c4980d7eb834ea" href="../../R/63c4980d7eb834ea.html" target="n" data-glyph="74,1" class="i method">Resync</a>(<b>int</b> <span id="r48 rd" class="r48 r">start</span>)
        {
            <b>int</b> <span id="r49 rd" class="r49 r">adjustment</span> = <a href="#5d92fd6f8ab1c2bb" class="i field">_nestedTokensAdjustment</a>;
            <b>if</b> (<a href="#46de558ea23c5764" class="i field">_skippedCharOffsets</a> != <b>null</b>)
            {
                <b>for</b> (<b>int</b> <span id="r50 rd" class="r50 r">i</span> = <a href="#5d92fd6f8ab1c2bb" class="i field">_nestedTokensAdjustment</a>; <span class="r50 r">i</span> &lt; <span class="r48 r">start</span> - 1 &amp;&amp; <span class="r50 r">i</span> &lt; <a href="#46de558ea23c5764" class="i field">_skippedCharOffsets</a>.<span class="i">Length</span>; ++<span class="r50 r">i</span>)
                {
                    <b>if</b> (<a href="#46de558ea23c5764" class="i field">_skippedCharOffsets</a>[<span class="r50 r">i</span>])
                    {
                        <span class="r49 r">adjustment</span> += 1;
                    }
                }
            }
 
            <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> = <span class="r48 r">start</span> - <span class="r49 r">adjustment</span>;
            <b>if</b> (<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> &gt; <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span> + 1)
            {
                <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> = <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span> + 1;
            }
            <b>else</b> <b>if</b> (<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> &lt; 0)
            {
                <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> = 0;
            }
 
            <b>if</b> (<a href="#0b3a6fb9271cc752" class="i property">FirstToken</a> != <b>null</b> &amp;&amp; <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> &lt;= ((<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<a href="#0b3a6fb9271cc752" class="i property">FirstToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>).<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a>)
            {
                <a href="#0b3a6fb9271cc752" class="i property">FirstToken</a> = <b>null</b>;
            }
 
            <b>if</b> (<a href="#233100b0d292a6a3" class="i property">TokenList</a> != <b>null</b> &amp;&amp; <a href="#233100b0d292a6a3" class="i property">TokenList</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// If we were saving tokens, remove all tokens from token to the end of the saved tokens.</span>
                <a href="#c212c03b3a02125e" class="i method">RemoveTokensFromListDuringResync</a>(<a href="#233100b0d292a6a3" class="i property">TokenList</a>, <span class="r48 r">start</span>);
            }
 
            <b>if</b> (<a href="#391d6eec748ef604" class="i property">RequiresTokens</a> != <b>null</b> &amp;&amp; <a href="#391d6eec748ef604" class="i property">RequiresTokens</a>.<span class="i">Count</span> &gt; 0)
            {
                <a href="#c212c03b3a02125e" class="i method">RemoveTokensFromListDuringResync</a>(<a href="#391d6eec748ef604" class="i property">RequiresTokens</a>, <span class="r48 r">start</span>);
            }
        }
 
        <b>internal void</b> <a id="c212c03b3a02125e" href="../../R/c212c03b3a02125e.html" target="n" data-glyph="74,1" class="i method">RemoveTokensFromListDuringResync</a>(<span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r51 rd" class="r51 r">tokenList</span>, <b>int</b> <span id="r52 rd" class="r52 r">start</span>)
        {
            <b>int</b> <span id="r53 rd" class="r53 r">removeFrom</span> = 0;
            <span class="c">// If we were saving tokens, remove all tokens from token to the end of the saved tokens.</span>
            <b>int</b> <span id="r54 rd" class="r54 r">i</span> = <span class="r51 r">tokenList</span>.<span class="i">Count</span> - 1;
            <b>if</b> (<span class="r54 r">i</span> &gt;= 0 &amp;&amp; <span class="r51 r">tokenList</span>[<span class="r54 r">i</span>].<span class="i">Kind</span> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
            {
                <span class="r54 r">i</span> -= 1;
            }
 
            <b>for</b> (; <span class="r54 r">i</span> &gt;= 0; <span class="r54 r">i</span>--)
            {
                <b>if</b> (((<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<span class="r51 r">tokenList</span>[<span class="r54 r">i</span>].<span class="i">Extent</span>).<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a> &lt;= <span class="r52 r">start</span>)
                {
                    <span class="r53 r">removeFrom</span> = <span class="r54 r">i</span> + 1;
                    <b>break</b>;
                }
            }
 
            <span class="r51 r">tokenList</span>.<span class="i">RemoveRange</span>(<span class="r53 r">removeFrom</span>, <span class="r51 r">tokenList</span>.<span class="i">Count</span> - <span class="r53 r">removeFrom</span>);
        }
 
        <b>internal void</b> <a id="6976344d863ce9cd" href="../../R/6976344d863ce9cd.html" target="n" data-glyph="74,1" class="i method">ReplaceSavedTokens</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r55 rd" class="r55 r">firstOldToken</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r56 rd" class="r56 r">lastOldToken</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r57 rd" class="r57 r">newToken</span>)
        {
            <b>int</b> <span id="r58 rd" class="r58 r">startOffset</span> = ((<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<span class="r55 r">firstOldToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>).<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a>;
            <b>int</b> <span id="r59 rd" class="r59 r">endOffset</span> = ((<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<span class="r56 r">lastOldToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>).<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a>;
            <b>int</b> <span id="r60 rd" class="r60 r">lastTokenToReplace</span> = -1;
            <b>for</b> (<b>int</b> <span id="r61 rd" class="r61 r">i</span> = <a href="#233100b0d292a6a3" class="i property">TokenList</a>.<span class="i">Count</span> - 1; <span class="r61 r">i</span> &gt;= 0; <span class="r61 r">i</span>--)
            {
                <b>if</b> (((<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<a href="#233100b0d292a6a3" class="i property">TokenList</a>[<span class="r61 r">i</span>].<span class="i">Extent</span>).<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a> == <span class="r59 r">endOffset</span>)
                {
                    <span class="r60 r">lastTokenToReplace</span> = <span class="r61 r">i</span>;
                    <b>continue</b>;
                }
 
                <b>if</b> (((<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<a href="#233100b0d292a6a3" class="i property">TokenList</a>[<span class="r61 r">i</span>].<span class="i">Extent</span>).<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a> == <span class="r58 r">startOffset</span>)
                {
                    <a href="#233100b0d292a6a3" class="i property">TokenList</a>.<span class="i">RemoveRange</span>(<span class="r61 r">i</span>, <span class="r60 r">lastTokenToReplace</span> - <span class="r61 r">i</span> + 1);
                    <a href="#233100b0d292a6a3" class="i property">TokenList</a>.<span class="i">Insert</span>(<span class="r61 r">i</span>, <span class="r57 r">newToken</span>);
                    <b>break</b>;
                }
            }
        }
 
        <b>private void</b> <a id="236716b27b254929" href="../../R/236716b27b254929.html" target="n" data-glyph="76,1" class="i method">NormalizeCRLF</a>(<b>char</b> <span id="r62 rd" class="r62 r">c</span>)
        {
            <span class="c">// CRs in Windows line endings are ignored</span>
            <b>if</b> (<span class="r62 r">c</span> == <span class="s">&#39;\r&#39;</span> &amp;&amp; <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;\n&#39;</span>)
            {
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
            }
        }
 
        <b>internal void</b> <a id="fd34384505f698b0" href="../../R/fd34384505f698b0.html" target="n" data-glyph="74,1" class="i method">CheckAstIsBeforeSignature</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r63 rd" class="r63 r">ast</span>)
        {
            <b>if</b> (<a href="#9ada150e23c8f53b" class="i field">_beginSignatureExtent</a> == <b>null</b>)
                <b>return</b>;
 
            <b>if</b> (<a href="#9ada150e23c8f53b" class="i field">_beginSignatureExtent</a>.<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a> &lt; <span class="r63 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>)
            {
                <span class="i">ReportError</span>(<span class="r63 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TokenAfterEndOfValidScriptText</span>),
                    <span class="i">ParserStrings</span>.<span class="i">TokenAfterEndOfValidScriptText</span>);
            }
        }
 
        <b>private void</b> <a id="be141eb039a7ef5c" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ReportError</a>(<b>int</b> <span id="r64 rd" class="r64 r">errorOffset</span>, <b>string</b> <span id="r65 rd" class="r65 r">errorId</span>, <b>string</b> <span id="r66 rd" class="r66 r">errorMsg</span>, <b>params object</b>[] <span id="r67 rd" class="r67 r">args</span>)
        {
            <a href="#723d6161b419cd59" class="i field">_parser</a>.<a href="Parser.cs.html#681390f471bef368" class="i method">ReportError</a>(<span class="i">NewScriptExtent</span>(<span class="r64 r">errorOffset</span>, <span class="r64 r">errorOffset</span> + 1), <span class="r65 r">errorId</span>, <span class="r66 r">errorMsg</span>, <span class="r67 r">args</span>);
        }
 
        <b>private void</b> <a id="c217fbd2d118e854" href="../../R/c217fbd2d118e854.html" target="n" data-glyph="76,1" class="i method">ReportError</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r68 rd" class="r68 r">extent</span>, <b>string</b> <span id="r69 rd" class="r69 r">errorId</span>, <b>string</b> <span id="r70 rd" class="r70 r">errorMsg</span>)
        {
            <a href="#723d6161b419cd59" class="i field">_parser</a>.<a href="Parser.cs.html#54fe0fe51414c862" class="i method">ReportError</a>(<span class="r68 r">extent</span>, <span class="r69 r">errorId</span>, <span class="r70 r">errorMsg</span>);
        }
 
        <b>private void</b> <a id="e8806f50b15f04e2" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ReportError</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r71 rd" class="r71 r">extent</span>, <b>string</b> <span id="r72 rd" class="r72 r">errorId</span>, <b>string</b> <span id="r73 rd" class="r73 r">errorMsg</span>, <b>object</b> <span id="r74 rd" class="r74 r">arg</span>)
        {
            <a href="#723d6161b419cd59" class="i field">_parser</a>.<a href="Parser.cs.html#a6ce762ed9f70927" class="i method">ReportError</a>(<span class="r71 r">extent</span>, <span class="r72 r">errorId</span>, <span class="r73 r">errorMsg</span>, <span class="r74 r">arg</span>);
        }
 
        <b>private void</b> <a id="cc2614af7ff7da02" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ReportError</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r75 rd" class="r75 r">extent</span>, <b>string</b> <span id="r76 rd" class="r76 r">errorId</span>, <b>string</b> <span id="r77 rd" class="r77 r">errorMsg</span>, <b>object</b> <span id="r78 rd" class="r78 r">arg1</span>, <b>object</b> <span id="r79 rd" class="r79 r">arg2</span>)
        {
            <a href="#723d6161b419cd59" class="i field">_parser</a>.<a href="Parser.cs.html#98f97ba3d90cdd5e" class="i method">ReportError</a>(<span class="r75 r">extent</span>, <span class="r76 r">errorId</span>, <span class="r77 r">errorMsg</span>, <span class="r78 r">arg1</span>, <span class="r79 r">arg2</span>);
        }
 
        <b>private void</b> <a id="791ae149c1dbf7bf" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ReportIncompleteInput</a>(<b>int</b> <span id="r80 rd" class="r80 r">errorOffset</span>, <b>string</b> <span id="r81 rd" class="r81 r">errorId</span>, <b>string</b> <span id="r82 rd" class="r82 r">errorMsg</span>)
        {
            <a href="#723d6161b419cd59" class="i field">_parser</a>.<a href="Parser.cs.html#d4db672ef75b7aa3" class="i method">ReportIncompleteInput</a>(<a href="#0b0033f23d8d6789" class="i method">NewScriptExtent</a>(<span class="r80 r">errorOffset</span>, <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>), <span class="r81 r">errorId</span>, <span class="r82 r">errorMsg</span>);
        }
 
        <b>private void</b> <a id="ce3bb5e391ca14c3" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ReportIncompleteInput</a>(<b>int</b> <span id="r83 rd" class="r83 r">errorOffset</span>, <b>string</b> <span id="r84 rd" class="r84 r">errorId</span>, <b>string</b> <span id="r85 rd" class="r85 r">errorMsg</span>, <b>object</b> <span id="r86 rd" class="r86 r">arg</span>)
        {
            <a href="#723d6161b419cd59" class="i field">_parser</a>.<a href="Parser.cs.html#b65021a43ed8265f" class="i method">ReportIncompleteInput</a>(<a href="#0b0033f23d8d6789" class="i method">NewScriptExtent</a>(<span class="r83 r">errorOffset</span>, <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>), <span class="r84 r">errorId</span>, <span class="r85 r">errorMsg</span>, <span class="r86 r">arg</span>);
        }
 
        <b>private</b> <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a> <a id="0b0033f23d8d6789" href="../../R/0b0033f23d8d6789.html" target="n" data-glyph="76,1" class="i method">NewScriptExtent</a>(<b>int</b> <span id="r87 rd" class="r87 r">start</span>, <b>int</b> <span id="r88 rd" class="r88 r">end</span>)
        {
            <b>return</b> <b>new</b> <span class="t">InternalScriptExtent</span>(<a href="#48c59219614a27c6" class="i field">_positionHelper</a>, <span class="r87 r">start</span> + <a href="#5d92fd6f8ab1c2bb" class="i field">_nestedTokensAdjustment</a>, <span class="r88 r">end</span> + <a href="#5d92fd6f8ab1c2bb" class="i field">_nestedTokensAdjustment</a>);
        }
 
        <b>internal</b> <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a> <a id="e07f6456e81dea92" href="../../R/e07f6456e81dea92.html" target="n" data-glyph="74,1" class="i method">CurrentExtent</a>()
        {
            <b>int</b> <span id="r89 rd" class="r89 r">start</span> = <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> + <a href="#5d92fd6f8ab1c2bb" class="i field">_nestedTokensAdjustment</a>;
            <b>int</b> <span id="r90 rd" class="r90 r">end</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> + <a href="#5d92fd6f8ab1c2bb" class="i field">_nestedTokensAdjustment</a>;
            <b>if</b> (<a href="#46de558ea23c5764" class="i field">_skippedCharOffsets</a> != <b>null</b>)
            {
                <b>int</b> <span id="r91 rd" class="r91 r">i</span> = <a href="#5d92fd6f8ab1c2bb" class="i field">_nestedTokensAdjustment</a>;
                <b>for</b> (; <span class="r91 r">i</span> &lt; <span class="r89 r">start</span> &amp;&amp; <span class="r91 r">i</span> &lt; <a href="#46de558ea23c5764" class="i field">_skippedCharOffsets</a>.<span class="i">Length</span>; ++<span class="r91 r">i</span>)
                {
                    <b>if</b> (<a href="#46de558ea23c5764" class="i field">_skippedCharOffsets</a>[<span class="r91 r">i</span>])
                    {
                        <span class="r89 r">start</span> += 1;
                        <span class="r90 r">end</span> += 1;
                    }
                }
 
                <b>for</b> (; <span class="r91 r">i</span> &lt; <span class="r90 r">end</span> &amp;&amp; <span class="r91 r">i</span> &lt; <a href="#46de558ea23c5764" class="i field">_skippedCharOffsets</a>.<span class="i">Length</span>; ++<span class="r91 r">i</span>)
                {
                    <b>if</b> (<a href="#46de558ea23c5764" class="i field">_skippedCharOffsets</a>[<span class="r91 r">i</span>])
                    {
                        <span class="r90 r">end</span> += 1;
                    }
                }
            }
 
            <b>return</b> <b>new</b> <a href="Position.cs.html#0b34c128e3d218a0" class="t constructor">InternalScriptExtent</a>(<a href="#48c59219614a27c6" class="i field">_positionHelper</a>, <span class="r89 r">start</span>, <span class="r90 r">end</span>);
        }
 
        <b>internal</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="d94187e9658017e7" href="../../R/d94187e9658017e7.html" target="n" data-glyph="74,1" class="i method">GetScriptExtent</a>()
        {
            <b>return</b> <span class="i">NewScriptExtent</span>(0, <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span>);
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="7735bc9c6bdffe8c" href="../../R/7735bc9c6bdffe8c.html" target="n" data-glyph="76,1" class="i method">NewCommentToken</a>()
        {
            <b>return</b> <a href="#f7b525e97a9ba50d" class="i method">SaveToken</a>(<b>new</b> <a href="token.cs.html#bdf3e1fce1afd274" class="t constructor">Token</a>(<a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>(), <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1be92d0c82164308" class="i field">Comment</a>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>));
        }
 
        <b>private</b> <span class="r92 r t">T</span> <a id="f7b525e97a9ba50d" href="../../R/f7b525e97a9ba50d.html" target="n" data-glyph="76,1" class="i method">SaveToken</a>&lt;<span id="r92 rd t" class="r92 r t">T</span>&gt;(<span class="r92 r t">T</span> <span id="r93 rd" class="r93 r">token</span>) <b>where</b> <span class="r92 r t">T</span> : <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>
        {
            <b>if</b> (<a href="#233100b0d292a6a3" class="i property">TokenList</a> != <b>null</b>)
            {
                <a href="#233100b0d292a6a3" class="i property">TokenList</a>.<span class="i">Add</span>(<span class="r93 r">token</span>);
            }
 
            <span class="c">// Keep track of the first and last token even if we&#39;re not saving tokens</span>
            <span class="c">// for the special variables $$ and $^.</span>
            <b>switch</b> (<span class="r93 r">token</span>.<span class="i">Kind</span>)
            {
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#756695ee247bdc4d" class="i field">LineContinuation</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1be92d0c82164308" class="i field">Comment</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>:
                    <span class="c">// Don&#39;t remember these tokens, they aren&#39;t useful in $$ and $^.</span>
                    <b>break</b>;
                <b>default</b>:
                    <b>if</b> (<a href="#0b3a6fb9271cc752" class="i property">FirstToken</a> == <b>null</b>)
                    {
                        <a href="#0b3a6fb9271cc752" class="i property">FirstToken</a> = <span class="r93 r">token</span>;
                    }
 
                    <a href="#830aef4c77937ae5" class="i property">LastToken</a> = <span class="r93 r">token</span>;
                    <b>break</b>;
            }
 
            <b>return</b> <span class="r93 r">token</span>;
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="966a2f468d703303" href="../../R/966a2f468d703303.html" target="n" data-glyph="76,1" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r94 rd" class="r94 r">kind</span>)
        {
            <b>return</b> <a href="#f7b525e97a9ba50d" class="i method">SaveToken</a>(<b>new</b> <a href="token.cs.html#bdf3e1fce1afd274" class="t constructor">Token</a>(<a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>(), <span class="r94 r">kind</span>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>));
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="8e9151e4fa00b472" href="../../R/8e9151e4fa00b472.html" target="n" data-glyph="76,1" class="i method">NewNumberToken</a>(<b>object</b> <span id="r95 rd" class="r95 r">value</span>)
        {
            <b>return</b> <a href="#f7b525e97a9ba50d" class="i method">SaveToken</a>(<b>new</b> <a href="token.cs.html#53c2620ac37075e2" class="t constructor">NumberToken</a>(<a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>(), <span class="r95 r">value</span>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>));
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="86d60114fc81ff06" href="../../R/86d60114fc81ff06.html" target="n" data-glyph="76,1" class="i method">NewParameterToken</a>(<b>string</b> <span id="r96 rd" class="r96 r">name</span>, <b>bool</b> <span id="r97 rd" class="r97 r">sawColon</span>)
        {
            <b>return</b> <a href="#f7b525e97a9ba50d" class="i method">SaveToken</a>(<b>new</b> <a href="token.cs.html#a0cc153342761eae" class="t constructor">ParameterToken</a>(<a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>(), <span class="r96 r">name</span>, <span class="r97 r">sawColon</span>));
        }
 
        <b>private</b> <a href="token.cs.html#cb1e7cc3b0285414" class="t t">VariableToken</a> <a id="7466f0695516efa1" href="../../R/7466f0695516efa1.html" target="n" data-glyph="76,1" class="i method">NewVariableToken</a>(<a href="../VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r98 rd" class="r98 r">path</span>, <b>bool</b> <span id="r99 rd" class="r99 r">splatted</span>)
        {
            <b>return</b> <a href="#f7b525e97a9ba50d" class="i method">SaveToken</a>(<b>new</b> <a href="token.cs.html#64d154fe249a0a8f" class="t constructor">VariableToken</a>(<a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>(), <span class="r98 r">path</span>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>, <span class="r99 r">splatted</span>));
        }
 
        <b>private</b> <a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a> <a id="fe68a70de84866c6" href="../../R/fe68a70de84866c6.html" target="n" data-glyph="76,1" class="i method">NewStringLiteralToken</a>(<b>string</b> <span id="r100 rd" class="r100 r">value</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r101 rd" class="r101 r">tokenKind</span>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a> <span id="r102 rd" class="r102 r">flags</span>)
        {
            <b>return</b> <a href="#f7b525e97a9ba50d" class="i method">SaveToken</a>(<b>new</b> <a href="token.cs.html#742c87b67f03240f" class="t constructor">StringLiteralToken</a>(<a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>(), <span class="r102 r">flags</span>, <span class="r101 r">tokenKind</span>, <span class="r100 r">value</span>));
        }
 
        <b>private</b> <a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a> <a id="093ebba9b5c93fdd" href="../../R/093ebba9b5c93fdd.html" target="n" data-glyph="76,1" class="i method">NewStringExpandableToken</a>(<b>string</b> <span id="r103 rd" class="r103 r">value</span>, <b>string</b> <span id="r104 rd" class="r104 r">formatString</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r105 rd" class="r105 r">tokenKind</span>, <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r106 rd" class="r106 r">nestedTokens</span>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a> <span id="r107 rd" class="r107 r">flags</span>)
        {
            <b>if</b> (<span class="r106 r">nestedTokens</span> != <b>null</b> &amp;&amp; <span class="r106 r">nestedTokens</span>.<span class="i">Count</span> == 0)
            {
                <span class="r106 r">nestedTokens</span> = <b>null</b>;
            }
            <b>else</b> <b>if</b> ((<span class="r107 r">flags</span> &amp; <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#13098cdbeb144c9e" class="i field">TokenInError</a>) == 0)
            {
                <b>if</b> (<span class="r106 r">nestedTokens</span>.<span class="i">Any</span>(<b>static</b> <span id="r108 rd" class="r108 r">tok</span> =&gt; <span class="r108 r">tok</span>.<span class="i">HasError</span>))
                {
                    <span class="r107 r">flags</span> |= <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#13098cdbeb144c9e" class="i field">TokenInError</a>;
                }
            }
 
            <b>return</b> <a href="#f7b525e97a9ba50d" class="i method">SaveToken</a>(<b>new</b> <a href="token.cs.html#2c064a61a30d528f" class="t constructor">StringExpandableToken</a>(<a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>(), <span class="r105 r">tokenKind</span>, <span class="r103 r">value</span>, <span class="r104 r">formatString</span>, <span class="r106 r">nestedTokens</span>, <span class="r107 r">flags</span>));
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="430e58a6774fde9e" href="../../R/430e58a6774fde9e.html" target="n" data-glyph="76,1" class="i method">NewGenericExpandableToken</a>(<b>string</b> <span id="r109 rd" class="r109 r">value</span>, <b>string</b> <span id="r110 rd" class="r110 r">formatString</span>, <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r111 rd" class="r111 r">nestedTokens</span>)
        {
            <b>return</b> <a href="#093ebba9b5c93fdd" class="i method">NewStringExpandableToken</a>(<span class="r109 r">value</span>, <span class="r110 r">formatString</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1aeb1084525225c9" class="i field">Generic</a>, <span class="r111 r">nestedTokens</span>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>);
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="9bf18f9cffdfc216" href="../../R/9bf18f9cffdfc216.html" target="n" data-glyph="76,1" class="i method">NewGenericToken</a>(<b>string</b> <span id="r112 rd" class="r112 r">value</span>)
        {
            <b>return</b> <a href="#fe68a70de84866c6" class="i method">NewStringLiteralToken</a>(<span class="r112 r">value</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1aeb1084525225c9" class="i field">Generic</a>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>);
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="1752cee27dfb804d" href="../../R/1752cee27dfb804d.html" target="n" data-glyph="76,1" class="i method">NewInputRedirectionToken</a>()
        {
            <b>return</b> <a href="#f7b525e97a9ba50d" class="i method">SaveToken</a>(<b>new</b> <a href="token.cs.html#2f93b86364d89eee" class="t constructor">InputRedirectionToken</a>(<a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>()));
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="4cd2ad70ec5e15b3" href="../../R/4cd2ad70ec5e15b3.html" target="n" data-glyph="76,1" class="i method">NewFileRedirectionToken</a>(<b>int</b> <span id="r113 rd" class="r113 r">from</span>, <b>bool</b> <span id="r114 rd" class="r114 r">append</span>, <b>bool</b> <span id="r115 rd" class="r115 r">fromSpecifiedExplicitly</span>)
        {
            <b>if</b> (<span class="r115 r">fromSpecifiedExplicitly</span> &amp;&amp; <a href="#39741816bda0c4aa" class="i method">InExpressionMode</a>())
            {
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                <b>if</b> (<span class="r114 r">append</span>)
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                }
 
                <b>return</b> <a href="#8e9151e4fa00b472" class="i method">NewNumberToken</a>(<span class="r113 r">from</span>);
            }
 
            <b>return</b> <a href="#f7b525e97a9ba50d" class="i method">SaveToken</a>(<b>new</b> <a href="token.cs.html#cd1a50dee7e8079f" class="t constructor">FileRedirectionToken</a>(<a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>(), (<a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>)<span class="r113 r">from</span>, <span class="r114 r">append</span>));
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="0bbddb075b59f6d3" href="../../R/0bbddb075b59f6d3.html" target="n" data-glyph="76,1" class="i method">NewMergingRedirectionToken</a>(<b>int</b> <span id="r116 rd" class="r116 r">from</span>, <b>int</b> <span id="r117 rd" class="r117 r">to</span>)
        {
            <b>return</b> <a href="#f7b525e97a9ba50d" class="i method">SaveToken</a>(<b>new</b> <a href="token.cs.html#4fe5603985f3d5f3" class="t constructor">MergingRedirectionToken</a>(<a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>(), (<a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>)<span class="r116 r">from</span>, (<a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>)<span class="r117 r">to</span>));
        }
 
        <b>private</b> <a href="token.cs.html#424ba3736e9bca64" class="t t">LabelToken</a> <a id="6298a82760151fba" href="../../R/6298a82760151fba.html" target="n" data-glyph="76,1" class="i method">NewLabelToken</a>(<b>string</b> <span id="r118 rd" class="r118 r">value</span>)
        {
            <b>return</b> <a href="#f7b525e97a9ba50d" class="i method">SaveToken</a>(<b>new</b> <a href="token.cs.html#cf7a4c3220c53dc7" class="t constructor">LabelToken</a>(<a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>(), <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>, <span class="r118 r">value</span>));
        }
 
        <b>internal bool</b> <a id="a297aca912bee2fe" href="../../R/a297aca912bee2fe.html" target="n" data-glyph="74,1" class="i method">IsAtEndOfScript</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r119 rd" class="r119 r">extent</span>, <b>bool</b> <span id="r120 rd" class="r120 r">checkCommentsAndWhitespace</span> = <b>false</b>)
        {
            <a href="Position.cs.html#a988805453837004" class="k">var</a> <span id="r121 rd" class="r121 r">scriptExtent</span> = (<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<span class="r119 r">extent</span>;
            <b>return</b> <span class="r121 r">scriptExtent</span>.<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a> &gt;= <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span>
                || (<span class="r120 r">checkCommentsAndWhitespace</span> &amp;&amp; <a href="#828f27b4af71bf32" class="i method">OnlyWhitespaceOrCommentsAfterExtent</a>(<span class="r121 r">scriptExtent</span>));
        }
 
        <b>private bool</b> <a id="828f27b4af71bf32" href="../../R/828f27b4af71bf32.html" target="n" data-glyph="76,1" class="i method">OnlyWhitespaceOrCommentsAfterExtent</a>(<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a> <span id="r122 rd" class="r122 r">extent</span>)
        {
            <b>for</b> (<b>int</b> <span id="r123 rd" class="r123 r">i</span> = <span class="r122 r">extent</span>.<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a>; <span class="r123 r">i</span> &lt; <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span>; ++<span class="r123 r">i</span>)
            {
                <b>if</b> (<a href="#0d494c77d31a8678" class="i field">_script</a>[<span class="r123 r">i</span>] == <span class="s">&#39;#&#39;</span>)
                {
                    <span class="c">// SkipLineComment will return the position after the comment end</span>
                    <span class="c">// which is either at the end of the file, or a cr or lf.</span>
                    <span class="r123 r">i</span> = <span class="i">SkipLineComment</span>(<span class="r123 r">i</span> + 1) - 1;
                    <b>continue</b>;
                }
 
                <b>if</b> (<a href="#0d494c77d31a8678" class="i field">_script</a>[<span class="r123 r">i</span>] == <span class="s">&#39;&lt;&#39;</span> &amp;&amp; (<span class="r123 r">i</span> + 1) &lt; <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span> &amp;&amp; <a href="#0d494c77d31a8678" class="i field">_script</a>[<span class="r123 r">i</span> + 1] == <span class="s">&#39;#&#39;</span>)
                {
                    <span class="r123 r">i</span> = <span class="i">SkipBlockComment</span>(<span class="r123 r">i</span> + 2) - 1;
                    <b>continue</b>;
                }
 
                <b>if</b> (!<a href="#0d494c77d31a8678" class="i field">_script</a>[<span class="r123 r">i</span>].<span class="i">IsWhitespace</span>())
                {
                    <b>return</b> <b>false</b>;
                }
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>internal bool</b> <a id="51b8c2449f201b9a" href="../../R/51b8c2449f201b9a.html" target="n" data-glyph="74,1" class="i method">IsPipeContinuation</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r124 rd" class="r124 r">extent</span>)
        {
            <span class="c">// If the first non-whitespace &amp; non-comment (regular or block) character following a newline is a pipe, we have</span>
            <span class="c">// pipe continuation.</span>
            <b>return</b> <span class="r124 r">extent</span>.<a href="Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a> &lt; <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span> &amp;&amp; <a href="#ac66434b10c5f9e3" class="i method">ContinuationAfterExtent</a>(<span class="r124 r">extent</span>, <span class="r125 r">continuationChar</span>: <span class="s">&#39;|&#39;</span>);
        }
 
        <b>private bool</b> <a id="ac66434b10c5f9e3" href="../../R/ac66434b10c5f9e3.html" target="n" data-glyph="76,1" class="i method">ContinuationAfterExtent</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r126 rd" class="r126 r">extent</span>, <b>char</b> <span id="r125 rd" class="r125 r">continuationChar</span>)
        {
            <b>bool</b> <span id="r127 rd" class="r127 r">lastNonWhitespaceIsNewline</span> = <b>true</b>;
            <b>int</b> <span id="r128 rd" class="r128 r">i</span> = <span class="r126 r">extent</span>.<a href="Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a>;
 
            <span class="c">// Since some token pattern matching looks for multiple characters (e.g. newline or block comment)</span>
            <span class="c">// we stop searching at _script.Length - 1 and perform one additional check after the while loop.</span>
            <span class="c">// This avoids having to compare i + 1 against the script length in multiple locations inside the</span>
            <span class="c">// loop.</span>
            <b>while</b> (<span class="r128 r">i</span> &lt; <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span> - 1)
            {
                <b>char</b> <span id="r129 rd" class="r129 r">c</span> = <a href="#0d494c77d31a8678" class="i field">_script</a>[<span class="r128 r">i</span>];
 
                <b>if</b> (<span class="r129 r">c</span>.<a href="CharTraits.cs.html#66538dacee9a61db" class="i method">IsWhitespace</a>())
                {
                    <span class="r128 r">i</span>++;
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r129 r">c</span> == <span class="s">&#39;\n&#39;</span>)
                {
                    <b>if</b> (<span class="r127 r">lastNonWhitespaceIsNewline</span>)
                    {
                        <span class="c">// blank or whitespace-only lines are not allowed in automatic line continuation</span>
                        <b>return</b> <b>false</b>;
                    }
 
                    <span class="r127 r">lastNonWhitespaceIsNewline</span> = <b>true</b>;
                    <span class="r128 r">i</span>++;
                    <b>continue</b>;
                }
                <b>else</b> <b>if</b> (<span class="r129 r">c</span> == <span class="s">&#39;\r&#39;</span>)
                {
                    <b>if</b> (<span class="r127 r">lastNonWhitespaceIsNewline</span>)
                    {
                        <span class="c">// blank or whitespace-only lines are not allowed in automatic line continuation</span>
                        <b>return</b> <b>false</b>;
                    }
 
                    <span class="r127 r">lastNonWhitespaceIsNewline</span> = <b>true</b>;
                    <span class="r128 r">i</span> += <a href="#0d494c77d31a8678" class="i field">_script</a>[<span class="r128 r">i</span> + 1] == <span class="s">&#39;\n&#39;</span> ? 2 : 1;
                    <b>continue</b>;
                }
 
                <span class="r127 r">lastNonWhitespaceIsNewline</span> = <b>false</b>;
 
                <b>if</b> (<span class="r129 r">c</span> == <span class="s">&#39;#&#39;</span>)
                {
                    <span class="c">// SkipLineComment will return the position after the comment end</span>
                    <span class="c">// which is either at the end of the file, or a cr or lf.</span>
                    <span class="r128 r">i</span> = <span class="i">SkipLineComment</span>(<span class="r128 r">i</span> + 1);
                    <b>continue</b>;
                }
 
                <b>if</b> (<span class="r129 r">c</span> == <span class="s">&#39;&lt;&#39;</span> &amp;&amp; <a href="#0d494c77d31a8678" class="i field">_script</a>[<span class="r128 r">i</span> + 1] == <span class="s">&#39;#&#39;</span>)
                {
                    <span class="r128 r">i</span> = <span class="i">SkipBlockComment</span>(<span class="r128 r">i</span> + 2);
                    <b>continue</b>;
                }
 
                <b>return</b> <span class="r129 r">c</span> == <span class="r125 r">continuationChar</span>;
            }
 
            <b>return</b> <a href="#0d494c77d31a8678" class="i field">_script</a>[<a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span> - 1] == <span class="r125 r">continuationChar</span>;
        }
 
        <b>private int</b> <a id="259aea842cf465c3" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">SkipLineComment</a>(<b>int</b> <span id="r130 rd" class="r130 r">i</span>)
        {
            <b>for</b> (; <span class="r130 r">i</span> &lt; <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span>; ++<span class="r130 r">i</span>)
            {
                <b>char</b> <span id="r131 rd" class="r131 r">c</span> = <a href="#0d494c77d31a8678" class="i field">_script</a>[<span class="r130 r">i</span>];
 
                <b>if</b> (<span class="r131 r">c</span> == <span class="s">&#39;\r&#39;</span> || <span class="r131 r">c</span> == <span class="s">&#39;\n&#39;</span>)
                {
                    <b>break</b>;
                }
            }
 
            <b>return</b> <span class="r130 r">i</span>;
        }
 
        <b>private int</b> <a id="74ee00342c48d4e2" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">SkipBlockComment</a>(<b>int</b> <span id="r132 rd" class="r132 r">i</span>)
        {
            <b>for</b> (; <span class="r132 r">i</span> &lt; <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span>; ++<span class="r132 r">i</span>)
            {
                <b>char</b> <span id="r133 rd" class="r133 r">c</span> = <a href="#0d494c77d31a8678" class="i field">_script</a>[<span class="r132 r">i</span>];
 
                <b>if</b> (<span class="r133 r">c</span> == <span class="s">&#39;#&#39;</span> &amp;&amp; (<span class="r132 r">i</span> + 1) &lt; <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Length</span> &amp;&amp; <a href="#0d494c77d31a8678" class="i field">_script</a>[<span class="r132 r">i</span> + 1] == <span class="s">&#39;&gt;&#39;</span>)
                {
                    <b>return</b> <span class="r132 r">i</span> + 2;
                }
            }
 
            <b>return</b> <span class="r132 r">i</span>;
        }
 
        <b>private char</b> <a id="097173370ab63237" href="../../R/097173370ab63237.html" target="n" data-glyph="76,1" class="i method">Backtick</a>(<b>char</b> <span id="r134 rd" class="r134 r">c</span>, <b>out char</b> <span id="r135 rd" class="r135 r">surrogateCharacter</span>)
        {
            <span class="r135 r">surrogateCharacter</span> = <a href="#a887df35fd840574" class="i field">s_invalidChar</a>;
 
            <b>switch</b> (<span class="r134 r">c</span>)
            {
                <b>case</b> <span class="s">&#39;0&#39;</span>:
                    <b>return</b> <span class="s">&#39;\0&#39;</span>;
                <b>case</b> <span class="s">&#39;a&#39;</span>:
                    <b>return</b> <span class="s">&#39;\a&#39;</span>;
                <b>case</b> <span class="s">&#39;b&#39;</span>:
                    <b>return</b> <span class="s">&#39;\b&#39;</span>;
                <b>case</b> <span class="s">&#39;e&#39;</span>:
                    <b>return</b> <span class="s">&#39;\u001b&#39;</span>;
                <b>case</b> <span class="s">&#39;f&#39;</span>:
                    <b>return</b> <span class="s">&#39;\f&#39;</span>;
                <b>case</b> <span class="s">&#39;n&#39;</span>:
                    <b>return</b> <span class="s">&#39;\n&#39;</span>;
                <b>case</b> <span class="s">&#39;r&#39;</span>:
                    <b>return</b> <span class="s">&#39;\r&#39;</span>;
                <b>case</b> <span class="s">&#39;t&#39;</span>:
                    <b>return</b> <span class="s">&#39;\t&#39;</span>;
                <b>case</b> <span class="s">&#39;u&#39;</span>:
                    <b>return</b> <a href="#41e11ce22f950989" class="i method">ScanUnicodeEscape</a>(<b>out</b> <span class="r135 r">surrogateCharacter</span>);
                <b>case</b> <span class="s">&#39;v&#39;</span>:
                    <b>return</b> <span class="s">&#39;\v&#39;</span>;
                <b>default</b>:
                    <b>return</b> <span class="r134 r">c</span>;
            }
        }
 
        <b>private char</b> <a id="41e11ce22f950989" href="../../R/41e11ce22f950989.html" target="n" data-glyph="76,1" class="i method">ScanUnicodeEscape</a>(<b>out char</b> <span id="r136 rd" class="r136 r">surrogateCharacter</span>)
        {
            <b>int</b> <span id="r137 rd" class="r137 r">escSeqStartIndex</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 2;
            <span class="r136 r">surrogateCharacter</span> = <a href="#a887df35fd840574" class="i field">s_invalidChar</a>;
 
            <b>char</b> <span id="r138 rd" class="r138 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            <b>if</b> (<span class="r138 r">c</span> != <span class="s">&#39;{&#39;</span>)
            {
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
 
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r139 rd" class="r139 r">errorExtent</span> = <a href="#0b0033f23d8d6789" class="i method">NewScriptExtent</a>(<span class="r137 r">escSeqStartIndex</span>, <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>);
                <span class="i">ReportError</span>(<span class="r139 r">errorExtent</span>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidUnicodeEscapeSequence</span>),
                    <span class="i">ParserStrings</span>.<span class="i">InvalidUnicodeEscapeSequence</span>);
                <b>return</b> <a href="#a887df35fd840574" class="i field">s_invalidChar</a>;
            }
 
            <span class="c">// Scan the rest of the Unicode escape sequence - one to six hex digits terminated plus the closing &#39;}&#39;.</span>
            <b>var</b> <span id="r140 rd" class="r140 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <b>int</b> <span id="r141 rd" class="r141 r">i</span>;
            <b>for</b> (<span class="r141 r">i</span> = 0; <span class="r141 r">i</span> &lt; <a href="#b88c406da88382e6" class="i field">s_maxNumberOfUnicodeHexDigits</a> + 1; <span class="r141 r">i</span>++)
            {
                <span class="r138 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
                <span class="c">// Sequence has been terminated.</span>
                <b>if</b> (<span class="r138 r">c</span> == <span class="s">&#39;}&#39;</span>)
                {
                    <b>if</b> (<span class="r141 r">i</span> == 0)
                    {
                        <span class="c">// Sequence must have at least one hex char.</span>
                        <a href="#7802c95baba16dea" class="i method">Release</a>(<span class="r140 r">sb</span>);
                        <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r142 rd" class="r142 r">errorExtent</span> = <a href="#0b0033f23d8d6789" class="i method">NewScriptExtent</a>(<span class="r137 r">escSeqStartIndex</span>, <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>);
                        <span class="i">ReportError</span>(<span class="r142 r">errorExtent</span>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidUnicodeEscapeSequence</span>),
                            <span class="i">ParserStrings</span>.<span class="i">InvalidUnicodeEscapeSequence</span>);
                        <b>return</b> <a href="#a887df35fd840574" class="i field">s_invalidChar</a>;
                    }
 
                    <b>break</b>;
                }
                <b>else</b> <b>if</b> (!<span class="r138 r">c</span>.<a href="CharTraits.cs.html#35dc0749f42f9bef" class="i method">IsHexDigit</a>())
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
 
                    <a href="#7802c95baba16dea" class="i method">Release</a>(<span class="r140 r">sb</span>);
                    <b>if</b> (<span class="r141 r">i</span> &lt; <a href="#b88c406da88382e6" class="i field">s_maxNumberOfUnicodeHexDigits</a>)
                    {
                        <span class="i">ReportError</span>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidUnicodeEscapeSequence</span>),
                            <span class="i">ParserStrings</span>.<span class="i">InvalidUnicodeEscapeSequence</span>);
                    }
                    <b>else</b>
                    {
                        <span class="i">ReportError</span>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingUnicodeEscapeSequenceTerminator</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingUnicodeEscapeSequenceTerminator</span>);
                    }
 
                    <b>return</b> <a href="#a887df35fd840574" class="i field">s_invalidChar</a>;
                }
                <b>else</b> <b>if</b> (<span class="r141 r">i</span> == <a href="#b88c406da88382e6" class="i field">s_maxNumberOfUnicodeHexDigits</a>)
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
 
                    <a href="#7802c95baba16dea" class="i method">Release</a>(<span class="r140 r">sb</span>);
                    <span class="i">ReportError</span>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TooManyDigitsInUnicodeEscapeSequence</span>),
                        <span class="i">ParserStrings</span>.<span class="i">TooManyDigitsInUnicodeEscapeSequence</span>);
                    <b>return</b> <a href="#a887df35fd840574" class="i field">s_invalidChar</a>;
                }
 
                <span class="r140 r">sb</span>.<span class="i">Append</span>(<span class="r138 r">c</span>);
            }
 
            <b>string</b> <span id="r143 rd" class="r143 r">hexStr</span> = <a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r140 r">sb</span>);
 
            <b>uint</b> <span id="r144 rd" class="r144 r">unicodeValue</span> = <b>uint</b>.<span class="i">Parse</span>(<span class="r143 r">hexStr</span>, <span class="i">NumberStyles</span>.<span class="i">AllowHexSpecifier</span>, <span class="i">NumberFormatInfo</span>.<span class="i">InvariantInfo</span>);
            <b>if</b> (<span class="r144 r">unicodeValue</span> &lt;= <b>char</b>.<span class="i">MaxValue</span>)
            {
                <b>return</b> ((<b>char</b>)<span class="r144 r">unicodeValue</span>);
            }
            <b>else</b> <b>if</b> (<span class="r144 r">unicodeValue</span> &lt;= 0x10FFFF)
            {
                <b>return</b> <a href="#0a3c83f5943d8ac7" class="i method">GetCharsFromUtf32</a>(<span class="r144 r">unicodeValue</span>, <b>out</b> <span class="r136 r">surrogateCharacter</span>);
            }
            <b>else</b>
            {
                <span class="c">// Place the error indicator under only the hex digits in the esc sequence.</span>
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r145 rd" class="r145 r">errorExtent</span> = <span class="i">NewScriptExtent</span>(<span class="r137 r">escSeqStartIndex</span> + 3, <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 1);
                <span class="i">ReportError</span>(<span class="r145 r">errorExtent</span>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidUnicodeEscapeSequenceValue</span>),
                    <span class="i">ParserStrings</span>.<span class="i">InvalidUnicodeEscapeSequenceValue</span>);
                <b>return</b> <a href="#a887df35fd840574" class="i field">s_invalidChar</a>;
            }
        }
 
        <b>private static char</b> <a id="0a3c83f5943d8ac7" href="../../R/0a3c83f5943d8ac7.html" target="n" data-glyph="76,1" class="i method">GetCharsFromUtf32</a>(<b>uint</b> <span id="r146 rd" class="r146 r">codepoint</span>, <b>out char</b> <span id="r147 rd" class="r147 r">lowSurrogate</span>)
        {
            <b>if</b> (<span class="r146 r">codepoint</span> &lt; (<b>uint</b>)0x00010000)
            {
                <span class="r147 r">lowSurrogate</span> = <a href="#a887df35fd840574" class="i field">s_invalidChar</a>;
                <b>return</b> (<b>char</b>)<span class="r146 r">codepoint</span>;
            }
            <b>else</b>
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>((<span class="r146 r">codepoint</span> &gt; 0x0000FFFF) &amp;&amp; (<span class="r146 r">codepoint</span> &lt;= 0x0010FFFF), <span class="s">&quot;Codepoint is out of range for a surrogate pair&quot;</span>);
                <span class="r147 r">lowSurrogate</span> = (<b>char</b>)((<span class="r146 r">codepoint</span> - 0x00010000) % 0x0400 + 0xDC00);
                <b>return</b> (<b>char</b>)((<span class="r146 r">codepoint</span> - 0x00010000) / 0x0400 + 0xD800);
            }
        }
 
        <b>private void</b> <a id="576ba912e8730a78" href="../../R/576ba912e8730a78.html" target="n" data-glyph="76,1" class="i method">ScanToEndOfCommentLine</a>(<b>out bool</b> <span id="r148 rd" class="r148 r">sawBeginSig</span>, <b>out bool</b> <span id="r149 rd" class="r149 r">matchedRequires</span>)
        {
            <span class="c">// When we get here, we are scanning a line comment.  To avoid rescanning,</span>
            <span class="c">// we look for a script signature while we scan to the end of the line.</span>
            <span class="c">//</span>
            <span class="c">// We want to find both real signatures and fake signatures, with the goal of disallowing any</span>
            <span class="c">// code after anything that looks like a signature because people often stop reading a script</span>
            <span class="c">// once they see a signature - making it relatively easy to &quot;hide&quot; trojan like code in a script</span>
            <span class="c">// after a fake signature.</span>
            <span class="c">//</span>
            <span class="c">// To &quot;match&quot; a signature, we compare its similarity (using Levenshtein Distance) to find</span>
            <span class="c">// comments that look confusingly similar to the actual signature block (mapping to lowercase,</span>
            <span class="c">// and ignoring spaces).</span>
            <span class="c">//</span>
            <span class="c">// At the same time, we also want to match #requires.  We do this with a simple state machine,</span>
            <span class="c">// incrementing the state as we continue to match, or set requiresMatchState to -1 if we failed to match.</span>
 
            <b>var</b> <span id="r150 rd" class="r150 r">commentLine</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
 
            <b>int</b> <span id="r151 rd" class="r151 r">requiresMatchState</span> = 0;
            <span class="r149 r">matchedRequires</span> = <b>false</b>;
            <b>while</b> (<b>true</b>)
            {
                <b>char</b> <span id="r152 rd" class="r152 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
                <b>if</b> (!<span class="r152 r">c</span>.<a href="CharTraits.cs.html#66538dacee9a61db" class="i method">IsWhitespace</a>())
                {
                    <span class="r150 r">commentLine</span>.<span class="i">Append</span>(<span class="r152 r">c</span>);
                }
 
                <b>switch</b> (<span class="r152 r">c</span>)
                {
                    <b>case</b> <span class="s">&#39;e&#39;</span>:
                    <b>case</b> <span class="s">&#39;E&#39;</span>:
                        <b>if</b> (<span class="r151 r">requiresMatchState</span> == 1 || <span class="r151 r">requiresMatchState</span> == 6)
                            <span class="r151 r">requiresMatchState</span> += 1;
                        <b>else</b>
                            <span class="r151 r">requiresMatchState</span> = -1;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;i&#39;</span>:
                    <b>case</b> <span class="s">&#39;I&#39;</span>:
                        <b>if</b> (<span class="r151 r">requiresMatchState</span> == 4)
                            <span class="r151 r">requiresMatchState</span> += 1;
                        <b>else</b>
                            <span class="r151 r">requiresMatchState</span> = -1;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;q&#39;</span>:
                    <b>case</b> <span class="s">&#39;Q&#39;</span>:
                        <b>if</b> (<span class="r151 r">requiresMatchState</span> == 2)
                            <span class="r151 r">requiresMatchState</span> += 1;
                        <b>else</b>
                            <span class="r151 r">requiresMatchState</span> = -1;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;r&#39;</span>:
                    <b>case</b> <span class="s">&#39;R&#39;</span>:
                        <b>if</b> (<span class="r151 r">requiresMatchState</span> == 0 || <span class="r151 r">requiresMatchState</span> == 5)
                            <span class="r151 r">requiresMatchState</span> += 1;
                        <b>else</b>
                            <span class="r151 r">requiresMatchState</span> = -1;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;s&#39;</span>:
                    <b>case</b> <span class="s">&#39;S&#39;</span>:
                        <b>if</b> (<span class="r151 r">requiresMatchState</span> == 7)
                            <span class="r149 r">matchedRequires</span> = <b>true</b>;
                        <b>else</b>
                            <span class="r151 r">requiresMatchState</span> = -1;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;u&#39;</span>:
                    <b>case</b> <span class="s">&#39;U&#39;</span>:
                        <b>if</b> (<span class="r151 r">requiresMatchState</span> == 3)
                            <span class="r151 r">requiresMatchState</span> += 1;
                        <b>else</b>
                            <span class="r151 r">requiresMatchState</span> = -1;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;\0&#39;</span>:
                        <b>if</b> (<a href="#91d350b0c4e63776" class="i method">AtEof</a>())
                        {
                            <b>goto</b> <b>case</b> <span class="s">&#39;\n&#39;</span>;
                        }
 
                        <b>goto</b> <b>default</b>;
                    <b>case</b> <span class="s">&#39;\r&#39;</span>:
                    <b>case</b> <span class="s">&#39;\n&#39;</span>:
                        <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
 
                        <span class="c">// Detect a line comment that disguises itself to look like the beginning of a signature block.</span>
                        <span class="c">// This could be used to hide code at the bottom of a script, since people might assume there is nothing else after the signature.</span>
                        <span class="c">//</span>
                        <span class="c">// The token similarity threshold was chosen by instrumenting the tokenizer and</span>
                        <span class="c">// analyzing every comment from PoshCode, Technet Script Center, and Windows.</span>
                        <span class="c">//</span>
                        <span class="c">// The closest comments above &quot;10&quot; had a score of 11, which are marginal and</span>
                        <span class="c">// appropriately close to being tricky.</span>
                        <span class="c">//</span>
                        <span class="c">// # END BEGIN SCRIPT BLOCK</span>
                        <span class="c">// # SET TEXT SIGNATURE</span>
                        <span class="c">//</span>
                        <span class="c">// Below 11 were only actual signature blocks:</span>
                        <span class="c">//</span>
                        <span class="c">// # SIG # END SIGNATURE BLOCK</span>
                        <span class="c">// # SIG # BEGIN SIGNATURE BLOCK</span>
                        <span class="c">//</span>
                        <span class="c">// There were only 279 (out of 269,387) comments with a similarity of 11,12,13,14, or 15.</span>
                        <span class="c">// At a similarity of 16-77, there were thousands of comments per similarity bucket.</span>
 
                        <b>const string</b> <span id="r153 rd" class="r153 r">beginSignatureTextNoSpace</span> = <span class="s">&quot;sig#beginsignatureblock\n&quot;</span>;
                        <b>const int</b> <span id="r154 rd" class="r154 r">beginTokenSimilarityThreshold</span> = 10;
 
                        <b>const int</b> <span id="r155 rd" class="r155 r">beginTokenSimilarityUpperBound</span> = 34; <span class="c">// beginSignatureTextNoSpace.Length + beginTokenSimilarityThreshold</span>
                        <b>const int</b> <span id="r156 rd" class="r156 r">beginTokenSimilarityLowerBound</span> = 14; <span class="c">// beginSignatureTextNoSpace.Length - beginTokenSimilarityThreshold</span>
 
                        <span class="c">// Quick exit - the comment line is more than &#39;threshold&#39; longer, or is less than &#39;threshold&#39; shorter. Therefore,</span>
                        <span class="c">// its similarity will be over the threshold.</span>
                        <b>if</b> (<span class="r150 r">commentLine</span>.<span class="i">Length</span> &gt; <span class="r155 r">beginTokenSimilarityUpperBound</span> || <span class="r150 r">commentLine</span>.<span class="i">Length</span> &lt; <span class="r156 r">beginTokenSimilarityLowerBound</span>)
                        {
                            <span class="r148 r">sawBeginSig</span> = <b>false</b>;
                        }
                        <b>else</b>
                        {
                            <span class="c">// Perf note - the GetStringSimilarity function is able to evaluate approximately 50kb of pure comments</span>
                            <span class="c">// (1000 lines, each of length between 10 and 80 characters) in about 40ms, compared to 6ms it took to</span>
                            <span class="c">// doing the error-prone hashing approach we had implemented before.</span>
                            <span class="c">//</span>
                            <span class="c">// The average script is 14% comments and parses in about 5.05 ms with this algorithm,</span>
                            <span class="c">// about 4.45 ms with the more simplistic algorithm.</span>
 
                            <b>string</b> <span id="r157 rd" class="r157 r">commentLineComparison</span> = <span class="r150 r">commentLine</span>.<span class="i">ToString</span>().<span class="i">ToLowerInvariant</span>();
                            <b>if</b> (<a href="#8a4ce2e429c802f8" class="i field">_beginTokenSimilarity2dArray</a> == <b>null</b>)
                            {
                                <span class="c">// Create the 2 dimensional array for edit distance calculation if it hasn&#39;t been created yet.</span>
                                <a href="#8a4ce2e429c802f8" class="i field">_beginTokenSimilarity2dArray</a> = <b>new</b> <b>int</b>[<span class="r155 r">beginTokenSimilarityUpperBound</span> + 1, <span class="r153 r">beginSignatureTextNoSpace</span>.<span class="i">Length</span> + 1];
                            }
                            <b>else</b>
                            {
                                <span class="c">// Zero out the 2 dimensional array before using it.</span>
                                <span class="i">Array</span>.<span class="i">Clear</span>(<a href="#8a4ce2e429c802f8" class="i field">_beginTokenSimilarity2dArray</a>, 0, <a href="#8a4ce2e429c802f8" class="i field">_beginTokenSimilarity2dArray</a>.<span class="i">Length</span>);
                            }
 
                            <b>int</b> <span id="r158 rd" class="r158 r">sawBeginTokenSimilarity</span> = <a href="#93225b39eb315d41" class="i method">GetStringSimilarity</a>(<span class="r157 r">commentLineComparison</span>, <span class="r153 r">beginSignatureTextNoSpace</span>, <a href="#8a4ce2e429c802f8" class="i field">_beginTokenSimilarity2dArray</a>);
                            <span class="r148 r">sawBeginSig</span> = <span class="r158 r">sawBeginTokenSimilarity</span> &lt; <span class="r154 r">beginTokenSimilarityThreshold</span>;
                        }
 
                        <a href="#7802c95baba16dea" class="i method">Release</a>(<span class="r150 r">commentLine</span>);
                        <b>return</b>;
                    <b>default</b>:
                        <span class="r151 r">requiresMatchState</span> = -1;
                        <b>break</b>;
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Utilities
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Object reuse
 
        <span class="c">// A two-dimensional integer array reused for calculating string similarity.</span>
        <b>private int</b>[,] <a id="8a4ce2e429c802f8" href="../../R/8a4ce2e429c802f8.html" target="n" data-glyph="46,1" class="i field">_beginTokenSimilarity2dArray</a>;
 
        <b>private readonly</b> <span class="i">Queue</span>&lt;<span class="i">StringBuilder</span>&gt; <a id="88f870444eda3f51" href="../../R/88f870444eda3f51.html" target="n" data-glyph="46,1" class="i field">_stringBuilders</a> = <b>new</b> <span class="i">Queue</span>&lt;<span class="i">StringBuilder</span>&gt;();
 
        <b>private</b> <span class="i">StringBuilder</span> <a id="479e3a3f4579df93" href="../../R/479e3a3f4579df93.html" target="n" data-glyph="76,1" class="i method">GetStringBuilder</a>()
        {
            <b>return</b> <a href="#88f870444eda3f51" class="i field">_stringBuilders</a>.<span class="i">Count</span> == 0 ? <b>new</b> <span class="i">StringBuilder</span>() : <a href="#88f870444eda3f51" class="i field">_stringBuilders</a>.<span class="i">Dequeue</span>();
        }
 
        <b>private void</b> <a id="7802c95baba16dea" href="../../R/7802c95baba16dea.html" target="n" data-glyph="76,1" class="i method">Release</a>(<span class="i">StringBuilder</span> <span id="r159 rd" class="r159 r">sb</span>)
        {
            <span class="c">// We don&#39;t want to cache too much, so limit to 10 string builders</span>
            <span class="c">// and don&#39;t keep any that have &gt; 1kb</span>
            <b>if</b> (<a href="#88f870444eda3f51" class="i field">_stringBuilders</a>.<span class="i">Count</span> &lt; 10 &amp;&amp; <span class="r159 r">sb</span>.<span class="i">Capacity</span> &lt; 1024)
            {
                <span class="r159 r">sb</span>.<span class="i">Clear</span>();
                <a href="#88f870444eda3f51" class="i field">_stringBuilders</a>.<span class="i">Enqueue</span>(<span class="r159 r">sb</span>);
            }
        }
 
        <b>private string</b> <a id="b38ed6a5a1dd9bb7" href="../../R/b38ed6a5a1dd9bb7.html" target="n" data-glyph="76,1" class="i method">GetStringAndRelease</a>(<span class="i">StringBuilder</span> <span id="r160 rd" class="r160 r">sb</span>)
        {
            <b>var</b> <span id="r161 rd" class="r161 r">result</span> = <span class="r160 r">sb</span>.<span class="i">ToString</span>();
            <a href="#7802c95baba16dea" class="i method">Release</a>(<span class="r160 r">sb</span>);
            <b>return</b> <span class="r161 r">result</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Object reuse
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Comments
 
        <b>private void</b> <a id="01c15cab0ce827be" href="../../R/01c15cab0ce827be.html" target="n" data-glyph="76,1" class="i method">ScanLineComment</a>()
        {
            <b>bool</b> <span id="r162 rd" class="r162 r">sawBeginSig</span>;
            <b>bool</b> <span id="r163 rd" class="r163 r">matchedRequires</span>;
            <a href="#576ba912e8730a78" class="i method">ScanToEndOfCommentLine</a>(<b>out</b> <span class="r162 r">sawBeginSig</span>, <b>out</b> <span class="r163 r">matchedRequires</span>);
            <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r164 rd" class="r164 r">token</span> = <a href="#7735bc9c6bdffe8c" class="i method">NewCommentToken</a>();
            <b>if</b> (<span class="r162 r">sawBeginSig</span>)
            {
                <a href="#9ada150e23c8f53b" class="i field">_beginSignatureExtent</a> = <a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>();
            }
            <b>else</b> <b>if</b> (<span class="r163 r">matchedRequires</span> &amp;&amp; <a href="#5d92fd6f8ab1c2bb" class="i field">_nestedTokensAdjustment</a> == 0)
            {
                <b>if</b> (<a href="#391d6eec748ef604" class="i property">RequiresTokens</a> == <b>null</b>)
                    <a href="#391d6eec748ef604" class="i property">RequiresTokens</a> = <b>new</b> <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt;();
                <a href="#391d6eec748ef604" class="i property">RequiresTokens</a>.<span class="i">Add</span>(<span class="r164 r">token</span>);
            }
        }
 
        <b>private void</b> <a id="bf5ffcaeeca02d3d" href="../../R/bf5ffcaeeca02d3d.html" target="n" data-glyph="76,1" class="i method">ScanBlockComment</a>()
        {
            <b>int</b> <span id="r165 rd" class="r165 r">errorIndex</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 2;
            <b>while</b> (<b>true</b>)
            {
                <b>char</b> <span id="r166 rd" class="r166 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
                <b>if</b> (<span class="r166 r">c</span> == <span class="s">&#39;#&#39;</span> &amp;&amp; <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;&gt;&#39;</span>)
                {
                    <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                    <b>break</b>;
                }
 
                <b>if</b> (<span class="r166 r">c</span> == <span class="s">&#39;\r&#39;</span>)
                {
                    <a href="#236716b27b254929" class="i method">NormalizeCRLF</a>(<span class="r166 r">c</span>);
                }
                <b>else</b> <b>if</b> (<span class="r166 r">c</span> == <span class="s">&#39;\0&#39;</span> &amp;&amp; <a href="#91d350b0c4e63776" class="i method">AtEof</a>())
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <span class="i">ReportIncompleteInput</span>(<span class="r165 r">errorIndex</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingTerminatorMultiLineComment</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingTerminatorMultiLineComment</span>);
                    <b>break</b>;
                }
            }
 
            <a href="#7735bc9c6bdffe8c" class="i method">NewCommentToken</a>();
        }
 
        <span class="c">// Implementation of the Levenshtein Distance algorithm</span>
        <span class="c">// https://en.wikipedia.org/wiki/Levenshtein_distance</span>
        <b>private static int</b> <a id="93225b39eb315d41" href="../../R/93225b39eb315d41.html" target="n" data-glyph="76,1" class="i method">GetStringSimilarity</a>(<b>string</b> <span id="r167 rd" class="r167 r">first</span>, <b>string</b> <span id="r168 rd" class="r168 r">second</span>, <b>int</b>[,] <span id="r169 rd" class="r169 r">distanceMap</span> = <b>null</b>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r167 r">first</span>) &amp;&amp; !<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r168 r">second</span>), <span class="s">&quot;Caller never calls us with empty strings&quot;</span>);
 
            <span class="c">// Store a distance map to store the number of edits required to</span>
            <span class="c">// convert the first &lt;row&gt; letters of First to the first &lt;column&gt;</span>
            <span class="c">// letters of Second.</span>
            <span class="r169 r">distanceMap</span> ??= <b>new</b> <b>int</b>[<span class="r167 r">first</span>.<span class="i">Length</span> + 1, <span class="r168 r">second</span>.<span class="i">Length</span> + 1];
 
            <span class="c">// Initialize the first row and column of the matrix - the number</span>
            <span class="c">// of edits required when one of the strings is empty is just</span>
            <span class="c">// the length of the non-empty string</span>
            <b>for</b> (<b>int</b> <span id="r170 rd" class="r170 r">row</span> = 0; <span class="r170 r">row</span> &lt;= <span class="r167 r">first</span>.<span class="i">Length</span>; <span class="r170 r">row</span>++)
            {
                <span class="r169 r">distanceMap</span>[<span class="r170 r">row</span>, 0] = <span class="r170 r">row</span>;
            }
 
            <b>for</b> (<b>int</b> <span id="r171 rd" class="r171 r">column</span> = 0; <span class="r171 r">column</span> &lt;= <span class="r168 r">second</span>.<span class="i">Length</span>; <span class="r171 r">column</span>++)
            {
                <span class="r169 r">distanceMap</span>[0, <span class="r171 r">column</span>] = <span class="r171 r">column</span>;
            }
 
            <span class="c">// Visit all prefixes and determine the minimum edit distance</span>
            <b>for</b> (<b>int</b> <span id="r172 rd" class="r172 r">row</span> = 1; <span class="r172 r">row</span> &lt;= <span class="r167 r">first</span>.<span class="i">Length</span>; <span class="r172 r">row</span>++)
            {
                <b>for</b> (<b>int</b> <span id="r173 rd" class="r173 r">column</span> = 1; <span class="r173 r">column</span> &lt;= <span class="r168 r">second</span>.<span class="i">Length</span>; <span class="r173 r">column</span>++)
                {
                    <span class="c">// If these two characters are the same, then</span>
                    <span class="c">// The edit distance is the same as it was for the</span>
                    <span class="c">// two shorter substrings without this character.</span>
                    <b>if</b> (<span class="r167 r">first</span>[<span class="r172 r">row</span> - 1] == <span class="r168 r">second</span>[<span class="r173 r">column</span> - 1])
                    {
                        <span class="r169 r">distanceMap</span>[<span class="r172 r">row</span>, <span class="r173 r">column</span>] = <span class="r169 r">distanceMap</span>[<span class="r172 r">row</span> - 1, <span class="r173 r">column</span> - 1];
                    }
                    <b>else</b>
                    {
                        <span class="c">// Otherwise, the edit distance is the minimum</span>
                        <span class="c">// of doing an addition of a character, a deletion</span>
                        <span class="c">// of a character, or a substitution of a character</span>
                        <span class="r169 r">distanceMap</span>[<span class="r172 r">row</span>, <span class="r173 r">column</span>] = <span class="i">Math</span>.<span class="i">Min</span>(
                            <span class="i">Math</span>.<span class="i">Min</span>(
                                <span class="r169 r">distanceMap</span>[<span class="r172 r">row</span> - 1, <span class="r173 r">column</span>] + 1,
                                <span class="r169 r">distanceMap</span>[<span class="r172 r">row</span>, <span class="r173 r">column</span> - 1] + 1),
                                <span class="r169 r">distanceMap</span>[<span class="r172 r">row</span> - 1, <span class="r173 r">column</span> - 1] + 1);
                    }
                }
            }
 
            <b>return</b> <span class="r169 r">distanceMap</span>[<span class="r167 r">first</span>.<span class="i">Length</span>, <span class="r168 r">second</span>.<span class="i">Length</span>];
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Requires
 
        <b>internal</b> <a href="ast.cs.html#829bb35b0576766a" class="t t">ScriptRequirements</a> <a id="a39ef7e7f8af6bad" href="../../R/a39ef7e7f8af6bad.html" target="n" data-glyph="74,1" class="i method">GetScriptRequirements</a>()
        {
            <b>if</b> (<a href="#391d6eec748ef604" class="i property">RequiresTokens</a> == <b>null</b>)
                <b>return</b> <b>null</b>;
 
            <span class="c">// Make sure a nested scan of the #requires lines don&#39;t affect our processing here.</span>
            <b>var</b> <span id="r174 rd" class="r174 r">requiresTokens</span> = <a href="#391d6eec748ef604" class="i property">RequiresTokens</a>.<span class="i">ToArray</span>();
            <a href="#391d6eec748ef604" class="i property">RequiresTokens</a> = <b>null</b>;
 
            <b>string</b> <span id="r175 rd" class="r175 r">requiredShellId</span> = <b>null</b>;
            <span class="i">Version</span> <span id="r176 rd" class="r176 r">requiredVersion</span> = <b>null</b>;
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r177 rd" class="r177 r">requiredEditions</span> = <b>null</b>;
            <span class="i">List</span>&lt;<a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt; <span id="r178 rd" class="r178 r">requiredModules</span> = <b>null</b>;
            <span class="i">List</span>&lt;<a href="../ExternalScriptInfo.cs.html#b11a97aaaf8c5e31" class="t t">PSSnapInSpecification</a>&gt; <span id="r179 rd" class="r179 r">requiredSnapins</span> = <b>null</b>;
            <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r180 rd" class="r180 r">requiredAssemblies</span> = <b>null</b>;
            <b>bool</b> <span id="r181 rd" class="r181 r">requiresElevation</span> = <b>false</b>;
 
            <b>foreach</b> (<b>var</b> <span id="r182 rd" class="r182 r">token</span> <b>in</b> <span class="r174 r">requiresTokens</span>)
            {
                <a href="Position.cs.html#a988805453837004" class="k">var</a> <span id="r183 rd" class="r183 r">requiresExtent</span> = <b>new</b> <span class="t">InternalScriptExtent</span>(<a href="#48c59219614a27c6" class="i field">_positionHelper</a>, <span class="r182 r">token</span>.<span class="i">Extent</span>.<span class="i">StartOffset</span> + 1, <span class="r182 r">token</span>.<span class="i">Extent</span>.<span class="i">EndOffset</span>);
                <a href="#7ca04afa98129e98" class="k">var</a> <span id="r184 rd" class="r184 r">state</span> = <a href="#c9153ca32ee89b31" class="i method">StartNestedScan</a>(<b>new</b> <a href="token.cs.html#0dfa73ba0ab7b817" class="t constructor">UnscannedSubExprToken</a>(<span class="r183 r">requiresExtent</span>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>, <span class="r183 r">requiresExtent</span>.<a href="Position.cs.html#a15f0499578d1f1d" class="i property">Text</a>, <b>null</b>));
                <a href="ast.cs.html#a310aaa1e0374ddd" class="k">var</a> <span id="r185 rd" class="r185 r">commandAst</span> = <a href="#723d6161b419cd59" class="i field">_parser</a>.<a href="Parser.cs.html#e1eadfb26e3b4083" class="i method">CommandRule</a>(<span class="r186 r">forDynamicKeyword</span>: <b>false</b>) <b>as</b> <a href="ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>;
                <a href="#723d6161b419cd59" class="i field">_parser</a>.<a href="Parser.cs.html#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> = <b>null</b>;
                <a href="#28dd58bc3bbb1c19" class="i method">FinishNestedScan</a>(<span class="r184 r">state</span>);
 
                <b>string</b> <span id="r187 rd" class="r187 r">snapinName</span> = <b>null</b>;
                <span class="i">Version</span> <span id="r188 rd" class="r188 r">snapinVersion</span> = <b>null</b>;
 
                <b>if</b> (<span class="r185 r">commandAst</span> != <b>null</b>)
                {
                    <b>var</b> <span id="r189 rd" class="r189 r">commandName</span> = <span class="r185 r">commandAst</span>.<a href="ast.cs.html#14cec84b5558d5c6" class="i method">GetCommandName</a>();
                    <b>if</b> (!<b>string</b>.<span class="i">Equals</span>(<span class="r189 r">commandName</span>, <span class="s">&quot;requires&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="i">ReportError</span>(<span class="r185 r">commandAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">DiscoveryExceptions</span>.<span class="i">ScriptRequiresInvalidFormat</span>),
                            <span class="i">DiscoveryExceptions</span>.<span class="i">ScriptRequiresInvalidFormat</span>);
                    }
 
                    <b>var</b> <span id="r190 rd" class="r190 r">snapinSpecified</span> = <b>false</b>;
                    <b>for</b> (<b>int</b> <span id="r191 rd" class="r191 r">i</span> = 1; <span class="r191 r">i</span> &lt; <span class="r185 r">commandAst</span>.<a href="ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span>; <span class="r191 r">i</span>++)
                    {
                        <a href="ast.cs.html#b97c3b8b32a8faec" class="k">var</a> <span id="r192 rd" class="r192 r">parameter</span> = <span class="r185 r">commandAst</span>.<a href="ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[<span class="r191 r">i</span>] <b>as</b> <a href="ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>;
 
                        <b>if</b> (<span class="r192 r">parameter</span> != <b>null</b> &amp;&amp;
                            <a href="#95d85ee9040be855" class="i field">PSSnapinToken</a>.<span class="i">StartsWith</span>(<span class="r192 r">parameter</span>.<a href="ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <span class="r190 r">snapinSpecified</span> = <b>true</b>;
                            <b>if</b> (<span class="r179 r">requiredSnapins</span> == <b>null</b>)
                            {
                                <span class="r179 r">requiredSnapins</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../ExternalScriptInfo.cs.html#b11a97aaaf8c5e31" class="t t">PSSnapInSpecification</a>&gt;();
                            }
 
                            <b>break</b>;
                        }
                    }
 
                    <b>for</b> (<b>int</b> <span id="r193 rd" class="r193 r">i</span> = 1; <span class="r193 r">i</span> &lt; <span class="r185 r">commandAst</span>.<a href="ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span>; <span class="r193 r">i</span>++)
                    {
                        <a href="ast.cs.html#b97c3b8b32a8faec" class="k">var</a> <span id="r194 rd" class="r194 r">parameter</span> = <span class="r185 r">commandAst</span>.<a href="ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[<span class="r193 r">i</span>] <b>as</b> <a href="ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>;
                        <b>if</b> (<span class="r194 r">parameter</span> != <b>null</b>)
                        {
                            <a href="#3deea80e5ec6c45f" class="i method">HandleRequiresParameter</a>(<span class="r194 r">parameter</span>, <span class="r185 r">commandAst</span>.<a href="ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>, <span class="r190 r">snapinSpecified</span>,
                                <b>ref</b> <span class="r193 r">i</span>, <b>ref</b> <span class="r187 r">snapinName</span>, <b>ref</b> <span class="r188 r">snapinVersion</span>,
                                <b>ref</b> <span class="r175 r">requiredShellId</span>, <b>ref</b> <span class="r176 r">requiredVersion</span>, <b>ref</b> <span class="r177 r">requiredEditions</span>, <b>ref</b> <span class="r178 r">requiredModules</span>, <b>ref</b> <span class="r180 r">requiredAssemblies</span>, <b>ref</b> <span class="r181 r">requiresElevation</span>);
                        }
                        <b>else</b>
                        {
                            <span class="i">ReportError</span>(<span class="r185 r">commandAst</span>.<a href="ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[<span class="r193 r">i</span>].<span class="i">Extent</span>,
                                <b>nameof</b>(<span class="i">DiscoveryExceptions</span>.<span class="i">ScriptRequiresInvalidFormat</span>),
                                <span class="i">DiscoveryExceptions</span>.<span class="i">ScriptRequiresInvalidFormat</span>);
                        }
                    }
 
                    <b>if</b> (<span class="r187 r">snapinName</span> != <b>null</b>)
                    {
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="../../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a>.<a href="../../singleshell/config/MshSnapinInfo.cs.html#153f92aef8175cd9" class="i method">IsPSSnapinIdValid</a>(<span class="r187 r">snapinName</span>), <span class="s">&quot;we shouldn&#39;t set snapinName if it wasn&#39;t valid&quot;</span>);
                        <span class="r179 r">requiredSnapins</span>.<span class="i">Add</span>(<b>new</b> <a href="../ExternalScriptInfo.cs.html#3602a76aee89c1c7" class="t constructor">PSSnapInSpecification</a>(<span class="r187 r">snapinName</span>) { <a href="../ExternalScriptInfo.cs.html#be5392c38732c5dc" class="i property">Version</a> = <span class="r188 r">snapinVersion</span> });
                    }
                }
            }
 
            <b>return</b> <b>new</b> <span class="t">ScriptRequirements</span>
            {
                <a href="ast.cs.html#3b5a4c855ccf6268" class="i property">RequiredApplicationId</a> = <span class="r175 r">requiredShellId</span>,
                <a href="ast.cs.html#157ab9c15f178cbb" class="i property">RequiredPSVersion</a> = <span class="r176 r">requiredVersion</span>,
                <a href="ast.cs.html#b2758c401ba81fa0" class="i property">RequiredPSEditions</a> = <span class="r177 r">requiredEditions</span> != <b>null</b>
                                                    ? <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<b>string</b>&gt;(<span class="r177 r">requiredEditions</span>)
                                                    : <a href="ast.cs.html#829bb35b0576766a" class="t t">ScriptRequirements</a>.<a href="ast.cs.html#1b0a118e59898f3c" class="i field">EmptyEditionCollection</a>,
                <a href="ast.cs.html#8585577fef49b313" class="i property">RequiresPSSnapIns</a> = <span class="r179 r">requiredSnapins</span> != <b>null</b>
                                                   ? <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="../ExternalScriptInfo.cs.html#b11a97aaaf8c5e31" class="t t">PSSnapInSpecification</a>&gt;(<span class="r179 r">requiredSnapins</span>)
                                                   : <a href="ast.cs.html#829bb35b0576766a" class="t t">ScriptRequirements</a>.<a href="ast.cs.html#52529f049b26f9b3" class="i field">EmptySnapinCollection</a>,
                <a href="ast.cs.html#799c9d9fc3077468" class="i property">RequiredAssemblies</a> = <span class="r180 r">requiredAssemblies</span> != <b>null</b>
                                                    ? <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<b>string</b>&gt;(<span class="r180 r">requiredAssemblies</span>)
                                                    : <a href="ast.cs.html#829bb35b0576766a" class="t t">ScriptRequirements</a>.<a href="ast.cs.html#99f85dd334439f4b" class="i field">EmptyAssemblyCollection</a>,
                <a href="ast.cs.html#8cb98a6ac41d8433" class="i property">RequiredModules</a> = <span class="r178 r">requiredModules</span> != <b>null</b>
                                                    ? <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt;(<span class="r178 r">requiredModules</span>)
                                                    : <a href="ast.cs.html#829bb35b0576766a" class="t t">ScriptRequirements</a>.<a href="ast.cs.html#58e359adcc7454c6" class="i field">EmptyModuleCollection</a>,
                <a href="ast.cs.html#e47f1f838c92f68f" class="i property">IsElevationRequired</a> = <span class="r181 r">requiresElevation</span>
            };
        }
 
        <b>private const string</b> <a id="ec8ed88516b4768c" href="../../R/ec8ed88516b4768c.html" target="n" data-glyph="10,1" class="i field">shellIDToken</a> = <span class="s">&quot;shellid&quot;</span>;
        <b>private const string</b> <a id="95d85ee9040be855" href="../../R/95d85ee9040be855.html" target="n" data-glyph="10,1" class="i field">PSSnapinToken</a> = <span class="s">&quot;pssnapin&quot;</span>;
        <b>private const string</b> <a id="20e97b06d4c089c6" href="../../R/20e97b06d4c089c6.html" target="n" data-glyph="10,1" class="i field">versionToken</a> = <span class="s">&quot;version&quot;</span>;
        <b>private const string</b> <a id="9812d03e063d7f8e" href="../../R/9812d03e063d7f8e.html" target="n" data-glyph="10,1" class="i field">editionToken</a> = <span class="s">&quot;psedition&quot;</span>;
        <b>private const string</b> <a id="d1d61cf6c56316b7" href="../../R/d1d61cf6c56316b7.html" target="n" data-glyph="10,1" class="i field">assemblyToken</a> = <span class="s">&quot;assembly&quot;</span>;
        <b>private const string</b> <a id="b097175a24e5022d" href="../../R/b097175a24e5022d.html" target="n" data-glyph="10,1" class="i field">modulesToken</a> = <span class="s">&quot;modules&quot;</span>;
        <b>private const string</b> <a id="9250c1b53c1c1db8" href="../../R/9250c1b53c1c1db8.html" target="n" data-glyph="10,1" class="i field">elevationToken</a> = <span class="s">&quot;runasadministrator&quot;</span>;
 
        <b>private void</b> <a id="3deea80e5ec6c45f" href="../../R/3deea80e5ec6c45f.html" target="n" data-glyph="76,1" class="i method">HandleRequiresParameter</a>(<a href="ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r195 rd" class="r195 r">parameter</span>,
                                             <span class="i">ReadOnlyCollection</span>&lt;<a href="ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt; <span id="r196 rd" class="r196 r">commandElements</span>,
                                             <b>bool</b> <span id="r197 rd" class="r197 r">snapinSpecified</span>,
                                             <b>ref int</b> <span id="r198 rd" class="r198 r">index</span>,
                                             <b>ref string</b> <span id="r199 rd" class="r199 r">snapinName</span>,
                                             <b>ref</b> <span class="i">Version</span> <span id="r200 rd" class="r200 r">snapinVersion</span>,
                                             <b>ref string</b> <span id="r201 rd" class="r201 r">requiredShellId</span>,
                                             <b>ref</b> <span class="i">Version</span> <span id="r202 rd" class="r202 r">requiredVersion</span>,
                                             <b>ref</b> <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r203 rd" class="r203 r">requiredEditions</span>,
                                             <b>ref</b> <span class="i">List</span>&lt;<a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt; <span id="r204 rd" class="r204 r">requiredModules</span>,
                                             <b>ref</b> <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r205 rd" class="r205 r">requiredAssemblies</span>,
                                             <b>ref bool</b> <span id="r206 rd" class="r206 r">requiresElevation</span>)
        {
            <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r207 rd" class="r207 r">argumentAst</span> = <span class="r195 r">parameter</span>.<a href="ast.cs.html#21fa828caf096206" class="i property">Argument</a> ?? (<span class="r198 r">index</span> + 1 &lt; <span class="r196 r">commandElements</span>.<span class="i">Count</span> ? <span class="r196 r">commandElements</span>[++<span class="r198 r">index</span>] : <b>null</b>);
 
            <b>if</b> (<a href="#9250c1b53c1c1db8" class="i field">elevationToken</a>.<span class="i">StartsWith</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r206 r">requiresElevation</span> = <b>true</b>;
                <b>if</b> (<span class="r207 r">argumentAst</span> != <b>null</b>)
                {
                    <span class="i">ReportError</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ParameterCannotHaveArgument</span>),
                        <span class="i">ParserStrings</span>.<span class="i">ParameterCannotHaveArgument</span>,
                        <span class="r195 r">parameter</span>.<a href="ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>);
                }
 
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r207 r">argumentAst</span> == <b>null</b>)
            {
                <span class="i">ReportError</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ParameterRequiresArgument</span>),
                    <span class="i">ParserStrings</span>.<span class="i">ParameterRequiresArgument</span>,
                    <span class="r195 r">parameter</span>.<a href="ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>);
                <b>return</b>;
            }
 
            <b>object</b> <span id="r208 rd" class="r208 r">argumentValue</span>;
            <b>if</b> (!<a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<a href="ConstantValues.cs.html#594e7e13f898b0a1" class="i method">IsConstant</a>(<span class="r207 r">argumentAst</span>, <b>out</b> <span class="r208 r">argumentValue</span>, <span class="r209 r">forRequires</span>: <b>true</b>))
            {
                <span class="i">ReportError</span>(<span class="r207 r">argumentAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiresArgumentMustBeConstant</span>),
                    <span class="i">ParserStrings</span>.<span class="i">RequiresArgumentMustBeConstant</span>);
                <b>return</b>;
            }
 
            <b>if</b> (<a href="#ec8ed88516b4768c" class="i field">shellIDToken</a>.<span class="i">StartsWith</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<span class="r201 r">requiredShellId</span> != <b>null</b>)
                {
                    <span class="i">ReportError</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>),
                        <span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>,
                        <b>null</b>,
                        <a href="#ec8ed88516b4768c" class="i field">shellIDToken</a>);
                    <b>return</b>;
                }
 
                <b>if</b> (<span class="r208 r">argumentValue</span> <b>is not string</b>)
                {
                    <span class="i">ReportError</span>(<span class="r207 r">argumentAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiresInvalidStringArgument</span>),
                        <span class="i">ParserStrings</span>.<span class="i">RequiresInvalidStringArgument</span>,
                        <a href="#ec8ed88516b4768c" class="i field">shellIDToken</a>);
                    <b>return</b>;
                }
 
                <span class="r201 r">requiredShellId</span> = (<b>string</b>)<span class="r208 r">argumentValue</span>;
            }
            <b>else</b> <b>if</b> (<a href="#95d85ee9040be855" class="i field">PSSnapinToken</a>.<span class="i">StartsWith</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<span class="r208 r">argumentValue</span> <b>is not string</b>)
                {
                    <span class="i">ReportError</span>(<span class="r207 r">argumentAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiresInvalidStringArgument</span>),
                        <span class="i">ParserStrings</span>.<span class="i">RequiresInvalidStringArgument</span>,
                        <a href="#95d85ee9040be855" class="i field">PSSnapinToken</a>);
                    <b>return</b>;
                }
 
                <b>if</b> (<span class="r199 r">snapinName</span> != <b>null</b>)
                {
                    <span class="i">ReportError</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>),
                        <span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>,
                        <b>null</b>,
                        <a href="#95d85ee9040be855" class="i field">PSSnapinToken</a>);
                    <b>return</b>;
                }
 
                <b>if</b> (!<a href="../../singleshell/config/MshSnapinInfo.cs.html#571fb5b01a41502f" class="t t">PSSnapInInfo</a>.<a href="../../singleshell/config/MshSnapinInfo.cs.html#153f92aef8175cd9" class="i method">IsPSSnapinIdValid</a>((<b>string</b>)<span class="r208 r">argumentValue</span>))
                {
                    <span class="i">ReportError</span>(<span class="r207 r">argumentAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">MshSnapInCmdletResources</span>.<span class="i">InvalidPSSnapInName</span>),
                        <span class="i">MshSnapInCmdletResources</span>.<span class="i">InvalidPSSnapInName</span>);
                    <b>return</b>;
                }
 
                <span class="r199 r">snapinName</span> = (<b>string</b>)<span class="r208 r">argumentValue</span>;
            }
            <b>else</b> <b>if</b> (<a href="#9812d03e063d7f8e" class="i field">editionToken</a>.<span class="i">StartsWith</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<span class="r203 r">requiredEditions</span> != <b>null</b>)
                {
                    <span class="i">ReportError</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>),
                        <span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>,
                        <b>null</b>,
                        <a href="#9812d03e063d7f8e" class="i field">editionToken</a>);
                    <b>return</b>;
                }
 
                <b>if</b> (<span class="r208 r">argumentValue</span> <b>is string</b> || <span class="r208 r">argumentValue</span> <b>is not</b> <span class="i">IEnumerable</span>)
                {
                    <span class="r203 r">requiredEditions</span> = <a href="#1629e37d4df78ba3" class="i method">HandleRequiresPSEditionArgument</a>(<span class="r207 r">argumentAst</span>, <span class="r208 r">argumentValue</span>, <b>ref</b> <span class="r203 r">requiredEditions</span>);
                }
                <b>else</b>
                {
                    <b>foreach</b> (<b>var</b> <span id="r210 rd" class="r210 r">arg</span> <b>in</b> (<span class="i">IEnumerable</span>)<span class="r208 r">argumentValue</span>)
                    {
                        <span class="r203 r">requiredEditions</span> = <span class="i">HandleRequiresPSEditionArgument</span>(<span class="r207 r">argumentAst</span>, <span class="r210 r">arg</span>, <b>ref</b> <span class="r203 r">requiredEditions</span>);
                    }
                }
            }
            <b>else</b> <b>if</b> (<a href="#20e97b06d4c089c6" class="i field">versionToken</a>.<span class="i">StartsWith</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>var</b> <span id="r211 rd" class="r211 r">argumentText</span> = <span class="r208 r">argumentValue</span> <b>as string</b> ?? <span class="r207 r">argumentAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>;
                <b>var</b> <span id="r212 rd" class="r212 r">version</span> = <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<span class="i">StringToVersion</span>(<span class="r211 r">argumentText</span>);
                <b>if</b> (<span class="r212 r">version</span> == <b>null</b>)
                {
                    <span class="i">ReportError</span>(<span class="r207 r">argumentAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiresVersionInvalid</span>),
                        <span class="i">ParserStrings</span>.<span class="i">RequiresVersionInvalid</span>);
                    <b>return</b>;
                }
 
                <b>if</b> (<span class="r197 r">snapinSpecified</span>)
                {
                    <b>if</b> (<span class="r200 r">snapinVersion</span> != <b>null</b>)
                    {
                        <span class="i">ReportError</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>),
                            <span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>,
                            <b>null</b>,
                            <a href="#20e97b06d4c089c6" class="i field">versionToken</a>);
                        <b>return</b>;
                    }
 
                    <span class="r200 r">snapinVersion</span> = <span class="r212 r">version</span>;
                }
                <b>else</b>
                {
                    <b>if</b> (<span class="r202 r">requiredVersion</span> != <b>null</b> &amp;&amp; !<span class="r202 r">requiredVersion</span>.<span class="i">Equals</span>(<span class="r212 r">version</span>))
                    {
                        <span class="i">ReportError</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>),
                            <span class="i">ParameterBinderStrings</span>.<span class="i">ParameterAlreadyBound</span>,
                            <b>null</b>,
                            <a href="#20e97b06d4c089c6" class="i field">versionToken</a>);
                        <b>return</b>;
                    }
 
                    <span class="r202 r">requiredVersion</span> = <span class="r212 r">version</span>;
                }
            }
            <b>else</b> <b>if</b> (<a href="#d1d61cf6c56316b7" class="i field">assemblyToken</a>.<span class="i">StartsWith</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<span class="r208 r">argumentValue</span> <b>is string</b> || <span class="r208 r">argumentValue</span> <b>is not</b> <span class="i">IEnumerable</span>)
                {
                    <span class="r205 r">requiredAssemblies</span> = <a href="#f90c010e3bea86c5" class="i method">HandleRequiresAssemblyArgument</a>(<span class="r207 r">argumentAst</span>, <span class="r208 r">argumentValue</span>, <span class="r205 r">requiredAssemblies</span>);
                }
                <b>else</b>
                {
                    <b>foreach</b> (<b>var</b> <span id="r213 rd" class="r213 r">arg</span> <b>in</b> (<span class="i">IEnumerable</span>)<span class="r208 r">argumentValue</span>)
                    {
                        <span class="r205 r">requiredAssemblies</span> = <span class="i">HandleRequiresAssemblyArgument</span>(<span class="r207 r">argumentAst</span>, <span class="r213 r">arg</span>, <span class="r205 r">requiredAssemblies</span>);
                    }
                }
            }
            <b>else</b> <b>if</b> (<a href="#b097175a24e5022d" class="i field">modulesToken</a>.<span class="i">StartsWith</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>var</b> <span id="r214 rd" class="r214 r">enumerable</span> = <span class="r208 r">argumentValue</span> <b>as object</b>[] ?? <b>new</b>[] { <span class="r208 r">argumentValue</span> };
                <b>foreach</b> (<b>var</b> <span id="r215 rd" class="r215 r">arg</span> <b>in</b> <span class="r214 r">enumerable</span>)
                {
                    <a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a> <span id="r216 rd" class="r216 r">moduleSpecification</span>;
                    <b>try</b>
                    {
                        <span class="r216 r">moduleSpecification</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>&lt;<a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt;(<span class="r215 r">arg</span>);
                    }
                    <b>catch</b> (<span class="i">InvalidCastException</span> <span id="r217 rd" class="r217 r">e</span>)
                    {
                        <span class="i">ReportError</span>(<span class="r207 r">argumentAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiresModuleInvalid</span>),
                            <span class="i">ParserStrings</span>.<span class="i">RequiresModuleInvalid</span>,
                            <span class="r217 r">e</span>.<span class="i">Message</span>);
                        <b>return</b>;
                    }
                    <b>catch</b> (<span class="i">ArgumentException</span> <span id="r218 rd" class="r218 r">e</span>)
                    {
                        <span class="i">ReportError</span>(<span class="r207 r">argumentAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiresModuleInvalid</span>),
                            <span class="i">ParserStrings</span>.<span class="i">RequiresModuleInvalid</span>,
                            <span class="r218 r">e</span>.<span class="i">Message</span>);
                        <b>return</b>;
                    }
 
                    <b>if</b> (<span class="r204 r">requiredModules</span> == <b>null</b>)
                        <span class="r204 r">requiredModules</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>&gt;();
                    <span class="r204 r">requiredModules</span>.<span class="i">Add</span>(<span class="r216 r">moduleSpecification</span>);
                }
            }
            <b>else</b>
            {
                <span class="i">ReportError</span>(<span class="r195 r">parameter</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">DiscoveryExceptions</span>.<span class="i">ScriptRequiresInvalidFormat</span>),
                    <span class="i">DiscoveryExceptions</span>.<span class="i">ScriptRequiresInvalidFormat</span>);
            }
        }
 
        <b>private</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="f90c010e3bea86c5" href="../../R/f90c010e3bea86c5.html" target="n" data-glyph="76,1" class="i method">HandleRequiresAssemblyArgument</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r219 rd" class="r219 r">argumentAst</span>, <b>object</b> <span id="r220 rd" class="r220 r">arg</span>, <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r221 rd" class="r221 r">requiredAssemblies</span>)
        {
            <b>if</b> (<span class="r220 r">arg</span> <b>is not string</b>)
            {
                <span class="i">ReportError</span>(<span class="r219 r">argumentAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiresInvalidStringArgument</span>),
                    <span class="i">ParserStrings</span>.<span class="i">RequiresInvalidStringArgument</span>,
                    <a href="#d1d61cf6c56316b7" class="i field">assemblyToken</a>);
            }
            <b>else</b>
            {
                <b>if</b> (<span class="r221 r">requiredAssemblies</span> == <b>null</b>)
                    <span class="r221 r">requiredAssemblies</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
                <b>if</b> (!<span class="r221 r">requiredAssemblies</span>.<span class="i">Contains</span>((<b>string</b>)<span class="r220 r">arg</span>))
                {
                    <span class="r221 r">requiredAssemblies</span>.<span class="i">Add</span>((<b>string</b>)<span class="r220 r">arg</span>);
                }
            }
 
            <b>return</b> <span class="r221 r">requiredAssemblies</span>;
        }
 
        <b>private</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="1629e37d4df78ba3" href="../../R/1629e37d4df78ba3.html" target="n" data-glyph="76,1" class="i method">HandleRequiresPSEditionArgument</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r222 rd" class="r222 r">argumentAst</span>, <b>object</b> <span id="r223 rd" class="r223 r">arg</span>, <b>ref</b> <span class="i">List</span>&lt;<b>string</b>&gt; <span id="r224 rd" class="r224 r">requiredEditions</span>)
        {
            <b>if</b> (<span class="r223 r">arg</span> <b>is not string</b>)
            {
                <span class="i">ReportError</span>(<span class="r222 r">argumentAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiresInvalidStringArgument</span>),
                    <span class="i">ParserStrings</span>.<span class="i">RequiresInvalidStringArgument</span>,
                    <a href="#9812d03e063d7f8e" class="i field">editionToken</a>);
            }
            <b>else</b>
            {
                <b>if</b> (<span class="r224 r">requiredEditions</span> == <b>null</b>)
                    <span class="r224 r">requiredEditions</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
 
                <b>var</b> <span id="r225 rd" class="r225 r">edition</span> = (<b>string</b>)<span class="r223 r">arg</span>;
                <b>if</b> (!<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#86d8f503fbbc2c67" class="i method">IsValidPSEditionValue</a>(<span class="r225 r">edition</span>))
                {
                    <span class="i">ReportError</span>(<span class="r222 r">argumentAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiresPSEditionInvalid</span>),
                        <span class="i">ParserStrings</span>.<span class="i">RequiresPSEditionInvalid</span>,
                        <a href="#9812d03e063d7f8e" class="i field">editionToken</a>);
                }
 
                <b>if</b> (!<span class="r224 r">requiredEditions</span>.<span class="i">Contains</span>(<span class="r225 r">edition</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r224 r">requiredEditions</span>.<span class="i">Add</span>(<span class="r225 r">edition</span>);
                }
                <b>else</b>
                {
                    <span class="i">ReportError</span>(<span class="r222 r">argumentAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiresPSEditionValueIsAlreadySpecified</span>),
                        <span class="i">ParserStrings</span>.<span class="i">RequiresPSEditionValueIsAlreadySpecified</span>,
                        <a href="#9812d03e063d7f8e" class="i field">editionToken</a>);
                }
            }
 
            <b>return</b> <span class="r224 r">requiredEditions</span>;
        }
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Requires
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Comments
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Strings
 
        <span class="c">// When processing a verbatim command argument, read until the end</span>
        <span class="c">// of line completely ignoring all PowerShell semantics.</span>
        <b>internal</b> <a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a> <a id="4b703256d9c4df51" href="../../R/4b703256d9c4df51.html" target="n" data-glyph="74,1" class="i method">GetVerbatimCommandArgument</a>()
        {
            <a href="#b561da6fab4d3e94" class="i method">SkipWhiteSpace</a>();
            <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
 
            <b>bool</b> <span id="r226 rd" class="r226 r">inQuotes</span> = <b>false</b>;
            <b>while</b> (<b>true</b>)
            {
                <b>char</b> <span id="r227 rd" class="r227 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
                <b>if</b> (<span class="r227 r">c</span> == <span class="s">&#39;\r&#39;</span> || <span class="r227 r">c</span> == <span class="s">&#39;\n&#39;</span> || (<span class="r227 r">c</span> == <span class="s">&#39;\0&#39;</span> &amp;&amp; <a href="#91d350b0c4e63776" class="i method">AtEof</a>()))
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <b>break</b>;
                }
 
                <b>if</b> (<span class="r227 r">c</span>.<a href="CharTraits.cs.html#07f0a28c4f50e364" class="i method">IsDoubleQuote</a>())
                {
                    <span class="r226 r">inQuotes</span> = !<span class="r226 r">inQuotes</span>;
                    <b>continue</b>;
                }
 
                <b>if</b> (!<span class="r226 r">inQuotes</span> &amp;&amp; (<span class="r227 r">c</span> == <span class="s">&#39;|&#39;</span> || (<span class="r227 r">c</span> == <span class="s">&#39;&amp;&#39;</span> &amp;&amp; !<a href="#91d350b0c4e63776" class="i method">AtEof</a>() &amp;&amp; <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;&amp;&#39;</span>)))
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <b>break</b>;
                }
            }
 
            <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a> <span id="r228 rd" class="r228 r">currentExtent</span> = <a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>();
            <b>string</b> <span id="r229 rd" class="r229 r">tokenValue</span> = <span class="r228 r">currentExtent</span>.<a href="Position.cs.html#a15f0499578d1f1d" class="i property">Text</a>;
            <b>return</b> <a href="#fe68a70de84866c6" class="i method">NewStringLiteralToken</a>(<span class="r229 r">tokenValue</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1aeb1084525225c9" class="i field">Generic</a>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>);
        }
 
        <b>private</b> <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a> <a id="36ffa9efbde92055" href="../../R/36ffa9efbde92055.html" target="n" data-glyph="76,1" class="i method">ScanStringLiteral</a>(<span class="i">StringBuilder</span> <span id="r230 rd" class="r230 r">sb</span>)
        {
            <b>int</b> <span id="r231 rd" class="r231 r">errorIndex</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 1;
            <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a> <span id="r232 rd" class="r232 r">flags</span> = <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>;
 
            <b>char</b> <span id="r233 rd" class="r233 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            <b>while</b> (<span class="r233 r">c</span> != <span class="s">&#39;\0&#39;</span> || !<a href="#91d350b0c4e63776" class="i method">AtEof</a>())
            {
                <b>if</b> (<span class="r233 r">c</span>.<a href="CharTraits.cs.html#b40a10af036c9eeb" class="i method">IsSingleQuote</a>())
                {
                    <span class="c">// Check for 2 quotes in a row.  If so, the first is the &quot;escape&quot;</span>
                    <span class="c">// and append the second quote.  Otherwise, we&#39;re done collecting.</span>
                    <b>if</b> (!<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>().<a href="CharTraits.cs.html#b40a10af036c9eeb" class="i method">IsSingleQuote</a>())
                    {
                        <b>break</b>;
                    }
 
                    <span class="r233 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
                }
 
                <span class="r230 r">sb</span>.<span class="i">Append</span>(<span class="r233 r">c</span>);
                <span class="r233 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            }
 
            <b>if</b> (<span class="r233 r">c</span> == <span class="s">&#39;\0&#39;</span>)
            {
                <span class="c">// error - reached end of input without seeing terminator</span>
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                <span class="i">ReportIncompleteInput</span>(<span class="r231 r">errorIndex</span>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TerminatorExpectedAtEndOfString</span>),
                    <span class="i">ParserStrings</span>.<span class="i">TerminatorExpectedAtEndOfString</span>,
                    <span class="s">&quot;&#39;&quot;</span>);
                <span class="r232 r">flags</span> = <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#13098cdbeb144c9e" class="i field">TokenInError</a>;
            }
 
            <b>return</b> <span class="r232 r">flags</span>;
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="e7d69b728f1adf04" href="../../R/e7d69b728f1adf04.html" target="n" data-glyph="76,1" class="i method">ScanStringLiteral</a>()
        {
            <b>var</b> <span id="r234 rd" class="r234 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <a href="token.cs.html#fb1c35b7167e0165" class="k">var</a> <span id="r235 rd" class="r235 r">flags</span> = <a href="#36ffa9efbde92055" class="i method">ScanStringLiteral</a>(<span class="r234 r">sb</span>);
            <b>return</b> <a href="#fe68a70de84866c6" class="i method">NewStringLiteralToken</a>(<a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r234 r">sb</span>), <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#0c560abdae080116" class="i field">StringLiteral</a>, <span class="r235 r">flags</span>);
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="2f2c0a7ac65774c3" href="../../R/2f2c0a7ac65774c3.html" target="n" data-glyph="76,1" class="i method">ScanSubExpression</a>(<b>bool</b> <span id="r236 rd" class="r236 r">hereString</span>)
        {
            <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
            <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 2;
            <b>var</b> <span id="r237 rd" class="r237 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <span class="r237 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;$(&quot;</span>);
            <b>int</b> <span id="r238 rd" class="r238 r">parenCount</span> = 1;
            <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a> <span id="r239 rd" class="r239 r">flags</span> = <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>;
            <b>bool</b> <span id="r240 rd" class="r240 r">scanning</span> = <b>true</b>;
            <span class="i">List</span>&lt;<b>int</b>&gt; <span id="r241 rd" class="r241 r">skippedCharOffsets</span> = <b>new</b> <span class="i">List</span>&lt;<b>int</b>&gt;();
            <b>while</b> (<span class="r240 r">scanning</span>)
            {
                <b>char</b> <span id="r242 rd" class="r242 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
                <b>switch</b> (<span class="r242 r">c</span>)
                {
                    <b>case</b> <span class="s">&#39;(&#39;</span>:
                        <span class="r237 r">sb</span>.<span class="i">Append</span>(<span class="r242 r">c</span>);
                        ++<span class="r238 r">parenCount</span>;
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&#39;)&#39;</span>:
                        <span class="r237 r">sb</span>.<span class="i">Append</span>(<span class="r242 r">c</span>);
                        <b>if</b> (--<span class="r238 r">parenCount</span> == 0)
                        {
                            <span class="r240 r">scanning</span> = <b>false</b>;
                        }
 
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&#39;`&#39;</span>:
                    <b>case</b> <span class="s">&#39;&quot;&#39;</span>:
                    <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#6749fb0434683e1c" class="i field">QuoteDoubleLeft</a>:
                    <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#4c212a52dfd2ded6" class="i field">QuoteDoubleRight</a>:
                    <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#8ee35cea65b6cbb9" class="i field">QuoteLowDoubleLeft</a>:
                        <b>char</b> <span id="r243 rd" class="r243 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                        <b>if</b> (!<span class="r236 r">hereString</span> &amp;&amp; <span class="r243 r">c1</span>.<a href="CharTraits.cs.html#07f0a28c4f50e364" class="i method">IsDoubleQuote</a>())
                        {
                            <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                            <span class="r237 r">sb</span>.<span class="i">Append</span>(<span class="r243 r">c1</span>);
                            <span class="r241 r">skippedCharOffsets</span>.<span class="i">Add</span>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 2 + <a href="#5d92fd6f8ab1c2bb" class="i field">_nestedTokensAdjustment</a>);
                        }
                        <b>else</b>
                        {
                            <span class="r237 r">sb</span>.<span class="i">Append</span>(<span class="r242 r">c</span>);
                        }
 
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&#39;\0&#39;</span>:
                        <b>if</b> (!<a href="#91d350b0c4e63776" class="i method">AtEof</a>())
                            <b>goto</b> <b>default</b>;
 
                        <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        <span class="i">ReportIncompleteInput</span>(<a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">IncompleteDollarSubexpressionReference</span>),
                            <span class="i">ParserStrings</span>.<span class="i">IncompleteDollarSubexpressionReference</span>);
                        <span class="r239 r">flags</span> = <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#13098cdbeb144c9e" class="i field">TokenInError</a>;
                        <span class="r240 r">scanning</span> = <b>false</b>;
                        <b>break</b>;
 
                    <b>default</b>:
                        <span class="r237 r">sb</span>.<span class="i">Append</span>(<span class="r242 r">c</span>);
                        <b>break</b>;
                }
            }
 
            <span class="i">BitArray</span> <span id="r244 rd" class="r244 r">skippedCharBitArray</span>;
            <b>if</b> (<span class="r241 r">skippedCharOffsets</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r244 r">skippedCharBitArray</span> = <b>new</b> <span class="i">BitArray</span>(<span class="r241 r">skippedCharOffsets</span>.<span class="i">Last</span>() + 1);
                <b>foreach</b> (<b>int</b> <span id="r245 rd" class="r245 r">i</span> <b>in</b> <span class="r241 r">skippedCharOffsets</span>)
                {
                    <span class="r244 r">skippedCharBitArray</span>.<span class="i">Set</span>(<span class="r245 r">i</span>, <b>true</b>);
                }
            }
            <b>else</b>
            {
                <span class="r244 r">skippedCharBitArray</span> = <a href="#46de558ea23c5764" class="i field">_skippedCharOffsets</a>;
            }
 
            <a href="Position.cs.html#a988805453837004" class="k">var</a> <span id="r246 rd" class="r246 r">extent</span> = <a href="#e07f6456e81dea92" class="i method">CurrentExtent</a>();
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                (<span class="r246 r">extent</span>.<a href="Position.cs.html#a15f0499578d1f1d" class="i property">Text</a>[0] == <span class="s">&#39;$&#39;</span> &amp;&amp; <span class="r246 r">extent</span>.<a href="Position.cs.html#a15f0499578d1f1d" class="i property">Text</a>[1] == <span class="s">&#39;(&#39;</span> &amp;&amp; <span class="r246 r">extent</span>.<a href="Position.cs.html#a15f0499578d1f1d" class="i property">Text</a>[<span class="r246 r">extent</span>.<a href="Position.cs.html#a15f0499578d1f1d" class="i property">Text</a>.<span class="i">Length</span> - 1] == <span class="s">&#39;)&#39;</span>) || (<span class="r239 r">flags</span> &amp; <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#13098cdbeb144c9e" class="i field">TokenInError</a>) != 0,
                <span class="s">&quot;Extent computed incorrectly.&quot;</span>);
            <b>return</b> <b>new</b> <a href="token.cs.html#0dfa73ba0ab7b817" class="t constructor">UnscannedSubExprToken</a>(<span class="r246 r">extent</span>, <span class="r239 r">flags</span>, <a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r237 r">sb</span>), <span class="r244 r">skippedCharBitArray</span>);
        }
 
        <b>private</b> <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a> <a id="b9906cfc8623a9d2" href="../../R/b9906cfc8623a9d2.html" target="n" data-glyph="76,1" class="i method">ScanStringExpandable</a>(<span class="i">StringBuilder</span> <span id="r247 rd" class="r247 r">sb</span>, <span class="i">StringBuilder</span> <span id="r248 rd" class="r248 r">formatSb</span>, <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r249 rd" class="r249 r">nestedTokens</span>)
        {
            <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a> <span id="r250 rd" class="r250 r">flags</span> = <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>;
            <b>int</b> <span id="r251 rd" class="r251 r">errorIndex</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 1;
 
            <b>char</b> <span id="r252 rd" class="r252 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            <b>for</b> (; <span class="r252 r">c</span> != <span class="s">&#39;\0&#39;</span> || !<a href="#91d350b0c4e63776" class="i method">AtEof</a>(); <span class="r252 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>())
            {
                <b>if</b> (<span class="r252 r">c</span>.<a href="CharTraits.cs.html#07f0a28c4f50e364" class="i method">IsDoubleQuote</a>())
                {
                    <span class="c">// Check for 2 quotes in a row.  If so, the first is the &quot;escape&quot;</span>
                    <span class="c">// and append the second quote.  Otherwise, we&#39;re done collecting.</span>
                    <b>if</b> (!<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>().<a href="CharTraits.cs.html#07f0a28c4f50e364" class="i method">IsDoubleQuote</a>())
                    {
                        <b>break</b>;
                    }
 
                    <span class="r252 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
                }
                <b>else</b> <b>if</b> (<span class="r252 r">c</span> == <span class="s">&#39;$&#39;</span>)
                {
                    <b>if</b> (<a href="#aa6fc2eede1cbf8c" class="i method">ScanDollarInStringExpandable</a>(<span class="r247 r">sb</span>, <span class="r248 r">formatSb</span>, <b>false</b>, <span class="r249 r">nestedTokens</span>))
                    {
                        <b>continue</b>;
                    }
                }
                <b>else</b> <b>if</b> (<span class="r252 r">c</span> == <span class="s">&#39;`&#39;</span>)
                {
                    <span class="c">// If end of input, go ahead and append the backtick and issue an error later</span>
                    <b>char</b> <span id="r253 rd" class="r253 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                    <b>if</b> (<span class="r253 r">c1</span> != 0)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <span class="r252 r">c</span> = <a href="#097173370ab63237" class="i method">Backtick</a>(<span class="r253 r">c1</span>, <b>out char</b> <span id="r254 rd" class="r254 r">surrogateCharacter</span>);
                        <b>if</b> (<span class="r254 r">surrogateCharacter</span> != <a href="#a887df35fd840574" class="i field">s_invalidChar</a>)
                        {
                            <span class="r247 r">sb</span>.<span class="i">Append</span>(<span class="r252 r">c</span>).<span class="i">Append</span>(<span class="r254 r">surrogateCharacter</span>);
                            <span class="r248 r">formatSb</span>.<span class="i">Append</span>(<span class="r252 r">c</span>).<span class="i">Append</span>(<span class="r254 r">surrogateCharacter</span>);
                            <b>continue</b>;
                        }
                    }
                }
 
                <b>if</b> (<span class="r252 r">c</span> == <span class="s">&#39;{&#39;</span> || <span class="r252 r">c</span> == <span class="s">&#39;}&#39;</span>)
                {
                    <span class="c">// In the format string, we need to double up the curlies because we&#39;re</span>
                    <span class="c">// replacing variable references and sub-expressions with the appropriate</span>
                    <span class="c">// format expression for string.Format.</span>
                    <span class="r248 r">formatSb</span>.<span class="i">Append</span>(<span class="r252 r">c</span>);
                }
 
                <span class="r247 r">sb</span>.<span class="i">Append</span>(<span class="r252 r">c</span>);
                <span class="r248 r">formatSb</span>.<span class="i">Append</span>(<span class="r252 r">c</span>);
            }
 
            <b>if</b> (<span class="r252 r">c</span> == <span class="s">&#39;\0&#39;</span>)
            {
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                <span class="i">ReportIncompleteInput</span>(<span class="r251 r">errorIndex</span>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TerminatorExpectedAtEndOfString</span>),
                    <span class="i">ParserStrings</span>.<span class="i">TerminatorExpectedAtEndOfString</span>,
                    <span class="s">&quot;\&quot;&quot;</span>);
                <span class="r250 r">flags</span> = <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#13098cdbeb144c9e" class="i field">TokenInError</a>;
            }
 
            <b>return</b> <span class="r250 r">flags</span>;
        }
 
        <span class="c">// Returns true if a variable or sub-expression is successfully scanned, false otherwise.</span>
        <b>private bool</b> <a id="aa6fc2eede1cbf8c" href="../../R/aa6fc2eede1cbf8c.html" target="n" data-glyph="76,1" class="i method">ScanDollarInStringExpandable</a>(<span class="i">StringBuilder</span> <span id="r255 rd" class="r255 r">sb</span>, <span class="i">StringBuilder</span> <span id="r256 rd" class="r256 r">formatSb</span>, <b>bool</b> <span id="r257 rd" class="r257 r">hereString</span>, <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r258 rd" class="r258 r">nestedTokens</span>)
        {
            <b>int</b> <span id="r259 rd" class="r259 r">dollarIndex</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 1;
            <b>char</b> <span id="r260 rd" class="r260 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
            <b>int</b> <span id="r261 rd" class="r261 r">saveTokenStart</span> = <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>;
            <a href="#39faa36c58f275ae" class="k">var</a> <span id="r262 rd" class="r262 r">oldTokenizerMode</span> = <a href="#e8fec060763b56d8" class="i property">Mode</a>;
            <b>var</b> <span id="r263 rd" class="r263 r">oldTokenList</span> = <a href="#233100b0d292a6a3" class="i property">TokenList</a>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r264 rd" class="r264 r">nestedToken</span> = <b>null</b>;
 
            <b>try</b>
            {
                <span class="c">// None of these tokens should be saved</span>
                <a href="#233100b0d292a6a3" class="i property">TokenList</a> = <b>null</b>;
                <a href="#e8fec060763b56d8" class="i property">Mode</a> = <a href="#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="#9b6269e007d113c3" class="i field">Expression</a>;
 
                <b>if</b> (<span class="r260 r">c1</span> == <span class="s">&#39;(&#39;</span>)
                {
                    <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                    <span class="r264 r">nestedToken</span> = <a href="#2f2c0a7ac65774c3" class="i method">ScanSubExpression</a>(<span class="r257 r">hereString</span>);
                }
                <b>else</b> <b>if</b> (<span class="r260 r">c1</span>.<a href="CharTraits.cs.html#7fd21417f3842df0" class="i method">IsVariableStart</a>() || <span class="r260 r">c1</span> == <span class="s">&#39;{&#39;</span>)
                {
                    <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 1;
                    <span class="r264 r">nestedToken</span> = <a href="#82e9bcbd128cc0c9" class="i method">ScanVariable</a>(<b>false</b>, <b>true</b>);
                }
            }
            <b>finally</b>
            {
                <a href="#233100b0d292a6a3" class="i property">TokenList</a> = <span class="r263 r">oldTokenList</span>;
                <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <span class="r261 r">saveTokenStart</span>;
                <a href="#e8fec060763b56d8" class="i property">Mode</a> = <span class="r262 r">oldTokenizerMode</span>;
            }
 
            <b>if</b> (<span class="r264 r">nestedToken</span> != <b>null</b>)
            {
                <span class="r255 r">sb</span>.<span class="i">Append</span>(<a href="#0d494c77d31a8678" class="i field">_script</a>, <span class="r259 r">dollarIndex</span>, <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - <span class="r259 r">dollarIndex</span>);
                <span class="r256 r">formatSb</span>.<span class="i">Append</span>(<span class="s">&#39;{&#39;</span>);
                <span class="r256 r">formatSb</span>.<span class="i">Append</span>(<span class="r258 r">nestedTokens</span>.<span class="i">Count</span>);
                <span class="r256 r">formatSb</span>.<span class="i">Append</span>(<span class="s">&#39;}&#39;</span>);
                <span class="r258 r">nestedTokens</span>.<span class="i">Add</span>(<span class="r264 r">nestedToken</span>);
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// Make sure we didn&#39;t consume anything because we didn&#39;t find</span>
            <span class="c">// any nested tokens (no variable or subexpression.)</span>
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="r260 r">c1</span>, <span class="s">&quot;We accidently consumed a character we shouldn&#39;t have.&quot;</span>);
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="b29f1c5c1c905246" href="../../R/b29f1c5c1c905246.html" target="n" data-glyph="76,1" class="i method">ScanStringExpandable</a>()
        {
            <b>var</b> <span id="r265 rd" class="r265 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <b>var</b> <span id="r266 rd" class="r266 r">formatSb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r267 rd" class="r267 r">nestedTokens</span> = <b>new</b> <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt;();
 
            <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a> <span id="r268 rd" class="r268 r">flags</span> = <a href="#b9906cfc8623a9d2" class="i method">ScanStringExpandable</a>(<span class="r265 r">sb</span>, <span class="r266 r">formatSb</span>, <span class="r267 r">nestedTokens</span>);
            <b>return</b> <a href="#093ebba9b5c93fdd" class="i method">NewStringExpandableToken</a>(<a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r265 r">sb</span>), <a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r266 r">formatSb</span>), <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4e0d26e8d7050abc" class="i field">StringExpandable</a>, <span class="r267 r">nestedTokens</span>, <span class="r268 r">flags</span>);
        }
 
        <b>private bool</b> <a id="d825823ebef45607" href="../../R/d825823ebef45607.html" target="n" data-glyph="76,1" class="i method">ScanAfterHereStringHeader</a>(<b>string</b> <span id="r269 rd" class="r269 r">header</span>)
        {
            <span class="c">// On entry, we&#39;ve see the header.  We allow whitespace and require a newline before the actual string starts</span>
            <b>int</b> <span id="r270 rd" class="r270 r">headerOffset</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 2;
 
            <b>char</b> <span id="r271 rd" class="r271 r">c</span>;
            <b>do</b>
            {
                <span class="r271 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            } <b>while</b> (<span class="r271 r">c</span>.<a href="CharTraits.cs.html#66538dacee9a61db" class="i method">IsWhitespace</a>());
 
            <b>if</b> (<span class="r271 r">c</span> == <span class="s">&#39;\r&#39;</span>)
            {
                <a href="#236716b27b254929" class="i method">NormalizeCRLF</a>(<span class="r271 r">c</span>);
            }
            <b>else</b> <b>if</b> (<span class="r271 r">c</span> != <span class="s">&#39;\n&#39;</span>)
            {
                <b>if</b> (<span class="r271 r">c</span> == <span class="s">&#39;\0&#39;</span> &amp;&amp; <a href="#91d350b0c4e63776" class="i method">AtEof</a>())
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <span class="i">ReportIncompleteInput</span>(<span class="r270 r">headerOffset</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TerminatorExpectedAtEndOfString</span>),
                        <span class="i">ParserStrings</span>.<span class="i">TerminatorExpectedAtEndOfString</span>,
                        <b>string</b>.<span class="i">Concat</span>(<span class="r269 r">header</span>[1], <span class="s">&#39;@&#39;</span>));
                    <b>return</b> <b>false</b>;
                }
 
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
 
                <span class="c">// ErrorRecovery: just ignore the characters and look for a terminator.  If no terminator is found, resume</span>
                <span class="c">// scanning at the end of the line.  Don&#39;t skip the newline so we have a newline to terminate the current</span>
                <span class="c">// expression.</span>
 
                <span class="i">ReportError</span>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedCharactersAfterHereStringHeader</span>),
                    <span class="i">ParserStrings</span>.<span class="i">UnexpectedCharactersAfterHereStringHeader</span>);
 
                <b>while</b> (<b>true</b>)
                {
                    <span class="r271 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
                    <b>if</b> (<span class="r271 r">c</span> == <span class="r269 r">header</span>[1] &amp;&amp; (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;@&#39;</span>))
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>break</b>;
                    }
 
                    <b>if</b> (<span class="r271 r">c</span> == <span class="s">&#39;\r&#39;</span> || <span class="r271 r">c</span> == <span class="s">&#39;\n&#39;</span> || (<span class="r271 r">c</span> == <span class="s">&#39;\0&#39;</span> &amp;&amp; <a href="#91d350b0c4e63776" class="i method">AtEof</a>()))
                    {
                        <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        <b>break</b>;
                    }
                }
 
                <b>return</b> <b>false</b>;
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private bool</b> <a id="563d58087f564458" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ScanPossibleHereStringFooter</a>(<span class="i">Func</span>&lt;<b>char</b>, <b>bool</b>&gt; <span id="r272 rd" class="r272 r">test</span>, <span class="i">Action</span>&lt;<b>char</b>&gt; <span id="r273 rd" class="r273 r">appendChar</span>, <b>ref int</b> <span id="r274 rd" class="r274 r">falseFooterOffset</span>)
        {
            <b>char</b> <span id="r275 rd" class="r275 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
            <span class="c">// First, check if we found the real terminator.</span>
            <b>if</b> (<span class="r272 r">test</span>(<span class="r275 r">c</span>) &amp;&amp; <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;@&#39;</span>)
            {
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <b>return</b> <b>true</b>;
            }
 
            <span class="c">// Catch whitespace before the terminator so we can issue</span>
            <span class="c">// a better error message than &quot;missing terminator&quot;.</span>
 
            <b>while</b> (<span class="r275 r">c</span>.<a href="CharTraits.cs.html#66538dacee9a61db" class="i method">IsWhitespace</a>())
            {
                <span class="r273 r">appendChar</span>(<span class="r275 r">c</span>);
                <span class="r275 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            }
 
            <b>if</b> (<span class="r275 r">c</span> == <span class="s">&#39;\r&#39;</span> || <span class="r275 r">c</span> == <span class="s">&#39;\n&#39;</span> || (<span class="r275 r">c</span> == <span class="s">&#39;\0&#39;</span> &amp;&amp; <a href="#91d350b0c4e63776" class="i method">AtEof</a>()))
            {
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<span class="r272 r">test</span>(<span class="r275 r">c</span>) &amp;&amp; <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;@&#39;</span>)
            {
                <span class="r273 r">appendChar</span>(<span class="r275 r">c</span>);
                <b>if</b> (<span class="r274 r">falseFooterOffset</span> == -1)
                {
                    <span class="c">// If we don&#39;t find a real footer, we&#39;ll use this position</span>
                    <span class="c">// to give a helpful error message.</span>
                    <span class="r274 r">falseFooterOffset</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 1;
                }
 
                <span class="r273 r">appendChar</span>(<a href="#e241596f9f370f6c" class="i method">GetChar</a>());  <span class="c">// append the &#39;@&#39;</span>
            }
            <b>else</b>
            {
                <span class="c">// Unget the character, it might be a &#39;$&#39; or &#39;`&#39; and if we&#39;re in a expandable here string, the caller must</span>
                <span class="c">// handle the character.</span>
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="2418625acf039188" href="../../R/2418625acf039188.html" target="n" data-glyph="76,1" class="i method">ScanHereStringLiteral</a>()
        {
            <span class="c">// On entry, we&#39;ve see @&#39;.  Remember the position in case we reach the end of file and want</span>
            <span class="c">// to use this position as the error position.</span>
            <b>int</b> <span id="r276 rd" class="r276 r">headerOffset</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 2;
            <b>int</b> <span id="r277 rd" class="r277 r">falseFooterOffset</span> = -1;
 
            <b>if</b> (!<a href="#d825823ebef45607" class="i method">ScanAfterHereStringHeader</a>(<span class="s">&quot;@&#39;&quot;</span>))
            {
                <b>return</b> <span class="i">NewStringLiteralToken</span>(<b>string</b>.<span class="i">Empty</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a6a2bdb661c2a296" class="i field">HereStringLiteral</a>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#13098cdbeb144c9e" class="i field">TokenInError</a>);
            }
 
            <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a> <span id="r278 rd" class="r278 r">flags</span> = <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>;
            <b>var</b> <span id="r279 rd" class="r279 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <span class="i">Action</span>&lt;<b>char</b>&gt; <span id="r280 rd" class="r280 r">appendChar</span> = <span id="r281 rd" class="r281 r">c</span> =&gt; <span class="r279 r">sb</span>.<span class="i">Append</span>(<span class="r281 r">c</span>);
            <b>if</b> (!<span class="i">ScanPossibleHereStringFooter</span>(<a href="CharTraits.cs.html#867648384ea9c435" class="t t">CharExtensions</a>.<span class="i">IsSingleQuote</span>, <span class="r280 r">appendChar</span>, <b>ref</b> <span class="r277 r">falseFooterOffset</span>))
            {
                <b>while</b> (<b>true</b>)
                {
                    <b>char</b> <span id="r282 rd" class="r282 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
                    <b>if</b> (<span class="r282 r">c</span> == <span class="s">&#39;\r&#39;</span> || <span class="r282 r">c</span> == <span class="s">&#39;\n&#39;</span>)
                    {
                        <span class="c">// Remember the length, we may remove this newline (which is 1 or 2 characters).</span>
                        <b>int</b> <span id="r283 rd" class="r283 r">length</span> = <span class="r279 r">sb</span>.<span class="i">Length</span>;
 
                        <span class="r279 r">sb</span>.<span class="i">Append</span>(<span class="r282 r">c</span>);
                        <b>if</b> (<span class="r282 r">c</span> == <span class="s">&#39;\r&#39;</span> &amp;&amp; <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;\n&#39;</span>)
                        {
                            <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                            <span class="r279 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;\n&#39;</span>);
                        }
 
                        <b>if</b> (<span class="i">ScanPossibleHereStringFooter</span>(<a href="CharTraits.cs.html#867648384ea9c435" class="t t">CharExtensions</a>.<span class="i">IsSingleQuote</span>, <span class="r280 r">appendChar</span>, <b>ref</b> <span class="r277 r">falseFooterOffset</span>))
                        {
                            <span class="c">// Remove the last newline appended.</span>
                            <span class="r279 r">sb</span>.<span class="i">Length</span> = <span class="r283 r">length</span>;
                            <b>break</b>;
                        }
                    }
                    <b>else</b> <b>if</b> (<span class="r282 r">c</span> != <span class="s">&#39;\0&#39;</span> || !<a href="#91d350b0c4e63776" class="i method">AtEof</a>())
                    {
                        <span class="r279 r">sb</span>.<span class="i">Append</span>(<span class="r282 r">c</span>);
                    }
                    <b>else</b>
                    {
                        <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        <b>if</b> (<span class="r277 r">falseFooterOffset</span> != -1)
                        {
                            <span class="i">ReportIncompleteInput</span>(<span class="r277 r">falseFooterOffset</span>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">WhitespaceBeforeHereStringFooter</span>),
                                <span class="i">ParserStrings</span>.<span class="i">WhitespaceBeforeHereStringFooter</span>);
                        }
                        <b>else</b>
                        {
                            <span class="i">ReportIncompleteInput</span>(<span class="r276 r">headerOffset</span>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TerminatorExpectedAtEndOfString</span>),
                                <span class="i">ParserStrings</span>.<span class="i">TerminatorExpectedAtEndOfString</span>,
                                <span class="s">&quot;&#39;@&quot;</span>);
                        }
 
                        <span class="r278 r">flags</span> = <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#13098cdbeb144c9e" class="i field">TokenInError</a>;
                        <b>break</b>;
                    }
                }
            }
 
            <b>return</b> <a href="#fe68a70de84866c6" class="i method">NewStringLiteralToken</a>(<a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r279 r">sb</span>), <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a6a2bdb661c2a296" class="i field">HereStringLiteral</a>, <span class="r278 r">flags</span>);
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="d3f67fcfa3844895" href="../../R/d3f67fcfa3844895.html" target="n" data-glyph="76,1" class="i method">ScanHereStringExpandable</a>()
        {
            <span class="c">// On entry, we&#39;ve see @&#39;.  Remember the position in case we reach the end of file and want</span>
            <span class="c">// to use this position as the error position.</span>
            <b>int</b> <span id="r284 rd" class="r284 r">headerOffset</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 2;
 
            <b>if</b> (!<a href="#d825823ebef45607" class="i method">ScanAfterHereStringHeader</a>(<span class="s">&quot;@\&quot;&quot;</span>))
            {
                <b>return</b> <span class="i">NewStringExpandableToken</span>(<b>string</b>.<span class="i">Empty</span>, <b>string</b>.<span class="i">Empty</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b3843759239f0c51" class="i field">HereStringExpandable</a>, <b>null</b>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#13098cdbeb144c9e" class="i field">TokenInError</a>);
            }
 
            <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a> <span id="r285 rd" class="r285 r">flags</span> = <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>;
            <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r286 rd" class="r286 r">nestedTokens</span> = <b>new</b> <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt;();
            <b>int</b> <span id="r287 rd" class="r287 r">falseFooterOffset</span> = -1;
            <b>var</b> <span id="r288 rd" class="r288 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <b>var</b> <span id="r289 rd" class="r289 r">formatSb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <span class="i">Action</span>&lt;<b>char</b>&gt; <span id="r290 rd" class="r290 r">appendChar</span> = <span id="r291 rd" class="r291 r">c</span> =&gt; { <span class="r288 r">sb</span>.<span class="i">Append</span>(<span class="r291 r">c</span>); <span class="r289 r">formatSb</span>.<span class="i">Append</span>(<span class="r291 r">c</span>); };
            <b>if</b> (!<span class="i">ScanPossibleHereStringFooter</span>(<a href="CharTraits.cs.html#867648384ea9c435" class="t t">CharExtensions</a>.<span class="i">IsDoubleQuote</span>, <span class="r290 r">appendChar</span>, <b>ref</b> <span class="r287 r">falseFooterOffset</span>))
            {
                <b>while</b> (<b>true</b>)
                {
                    <b>char</b> <span id="r292 rd" class="r292 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
                    <b>if</b> (<span class="r292 r">c</span> == <span class="s">&#39;\r&#39;</span> || <span class="r292 r">c</span> == <span class="s">&#39;\n&#39;</span>)
                    {
                        <span class="c">// Remember the length, we may remove this newline (which is 1 or 2 characters).</span>
                        <b>int</b> <span id="r293 rd" class="r293 r">length</span> = <span class="r288 r">sb</span>.<span class="i">Length</span>;
                        <b>int</b> <span id="r294 rd" class="r294 r">formatLength</span> = <span class="r289 r">formatSb</span>.<span class="i">Length</span>;
 
                        <span class="r288 r">sb</span>.<span class="i">Append</span>(<span class="r292 r">c</span>);
                        <span class="r289 r">formatSb</span>.<span class="i">Append</span>(<span class="r292 r">c</span>);
                        <b>if</b> (<span class="r292 r">c</span> == <span class="s">&#39;\r&#39;</span> &amp;&amp; <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;\n&#39;</span>)
                        {
                            <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                            <span class="r288 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;\n&#39;</span>);
                            <span class="r289 r">formatSb</span>.<span class="i">Append</span>(<span class="s">&#39;\n&#39;</span>);
                        }
 
                        <b>if</b> (<span class="i">ScanPossibleHereStringFooter</span>(<a href="CharTraits.cs.html#867648384ea9c435" class="t t">CharExtensions</a>.<span class="i">IsDoubleQuote</span>, <span class="r290 r">appendChar</span>, <b>ref</b> <span class="r287 r">falseFooterOffset</span>))
                        {
                            <span class="c">// Remove the last newline appended.</span>
                            <span class="r288 r">sb</span>.<span class="i">Length</span> = <span class="r293 r">length</span>;
                            <span class="r289 r">formatSb</span>.<span class="i">Length</span> = <span class="r294 r">formatLength</span>;
                            <b>break</b>;
                        }
 
                        <b>continue</b>;
                    }
 
                    <b>if</b> (<span class="r292 r">c</span> == <span class="s">&#39;$&#39;</span>)
                    {
                        <b>if</b> (<a href="#aa6fc2eede1cbf8c" class="i method">ScanDollarInStringExpandable</a>(<span class="r288 r">sb</span>, <span class="r289 r">formatSb</span>, <b>true</b>, <span class="r286 r">nestedTokens</span>))
                        {
                            <b>continue</b>;
                        }
                    }
                    <b>else</b> <b>if</b> (<span class="r292 r">c</span> == <span class="s">&#39;`&#39;</span>)
                    {
                        <span class="c">// If end of input, go ahead and append the backtick and issue an error later</span>
                        <b>char</b> <span id="r295 rd" class="r295 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                        <b>if</b> (<span class="r295 r">c1</span> != 0)
                        {
                            <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                            <span class="r292 r">c</span> = <a href="#097173370ab63237" class="i method">Backtick</a>(<span class="r295 r">c1</span>, <b>out char</b> <span id="r296 rd" class="r296 r">surrogateCharacter</span>);
                            <b>if</b> (<span class="r296 r">surrogateCharacter</span> != <a href="#a887df35fd840574" class="i field">s_invalidChar</a>)
                            {
                                <span class="r288 r">sb</span>.<span class="i">Append</span>(<span class="r292 r">c</span>).<span class="i">Append</span>(<span class="r296 r">surrogateCharacter</span>);
                                <span class="r289 r">formatSb</span>.<span class="i">Append</span>(<span class="r292 r">c</span>).<span class="i">Append</span>(<span class="r296 r">surrogateCharacter</span>);
                                <b>continue</b>;
                            }
                        }
                    }
 
                    <b>if</b> (<span class="r292 r">c</span> == <span class="s">&#39;{&#39;</span> || <span class="r292 r">c</span> == <span class="s">&#39;}&#39;</span>)
                    {
                        <span class="c">// In the format string, we need to double up the curlies because we&#39;re</span>
                        <span class="c">// replacing variable references and sub-expressions with the appropriate</span>
                        <span class="c">// format expression for string.Format.</span>
                        <span class="r289 r">formatSb</span>.<span class="i">Append</span>(<span class="r292 r">c</span>);
                    }
 
                    <b>if</b> (<span class="r292 r">c</span> != <span class="s">&#39;\0&#39;</span> || !<a href="#91d350b0c4e63776" class="i method">AtEof</a>())
                    {
                        <span class="r288 r">sb</span>.<span class="i">Append</span>(<span class="r292 r">c</span>);
                        <span class="r289 r">formatSb</span>.<span class="i">Append</span>(<span class="r292 r">c</span>);
                    }
                    <b>else</b>
                    {
                        <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        <b>if</b> (<span class="r287 r">falseFooterOffset</span> != -1)
                        {
                            <span class="i">ReportIncompleteInput</span>(<span class="r287 r">falseFooterOffset</span>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">WhitespaceBeforeHereStringFooter</span>),
                                <span class="i">ParserStrings</span>.<span class="i">WhitespaceBeforeHereStringFooter</span>);
                        }
                        <b>else</b>
                        {
                            <span class="i">ReportIncompleteInput</span>(<span class="r284 r">headerOffset</span>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TerminatorExpectedAtEndOfString</span>),
                                <span class="i">ParserStrings</span>.<span class="i">TerminatorExpectedAtEndOfString</span>,
                                <span class="s">&quot;\&quot;@&quot;</span>);
                        }
 
                        <span class="r285 r">flags</span> = <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#13098cdbeb144c9e" class="i field">TokenInError</a>;
                        <b>break</b>;
                    }
                }
            }
 
            <b>return</b> <a href="#093ebba9b5c93fdd" class="i method">NewStringExpandableToken</a>(<a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r288 r">sb</span>), <a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r289 r">formatSb</span>), <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b3843759239f0c51" class="i field">HereStringExpandable</a>, <span class="r286 r">nestedTokens</span>, <span class="r285 r">flags</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Strings
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Variables
 
        <span class="c">// Scan a variable - the first character ($ or @) has been consumed already.</span>
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="82e9bcbd128cc0c9" href="../../R/82e9bcbd128cc0c9.html" target="n" data-glyph="76,1" class="i method">ScanVariable</a>(<b>bool</b> <span id="r297 rd" class="r297 r">splatted</span>, <b>bool</b> <span id="r298 rd" class="r298 r">inStringExpandable</span>)
        {
            <b>int</b> <span id="r299 rd" class="r299 r">errorStartPosition</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
 
            <b>var</b> <span id="r300 rd" class="r300 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <b>char</b> <span id="r301 rd" class="r301 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
            <a href="../VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r302 rd" class="r302 r">path</span>;
            <b>if</b> (<span class="r301 r">c</span> == <span class="s">&#39;{&#39;</span>)
            {
                <span class="c">// Braced variable</span>
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<span class="r297 r">splatted</span>, <span class="s">&quot;Splatting is not supported with braced variables.&quot;</span>);
 
                <b>while</b> (<b>true</b>)
                {
                    <span class="r301 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
                    <b>switch</b> (<span class="r301 r">c</span>)
                    {
                        <b>case</b> <span class="s">&#39;}&#39;</span>:
                            <b>goto</b> <span class="i">end_braced_variable_scan</span>;
                        <b>case</b> <span class="s">&#39;`&#39;</span>:
                            {
                                <b>char</b> <span id="r303 rd" class="r303 r">c1</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
                                <b>if</b> (<span class="r303 r">c1</span> == <span class="s">&#39;\0&#39;</span> &amp;&amp; <a href="#91d350b0c4e63776" class="i method">AtEof</a>())
                                {
                                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                                    <b>goto</b> <span class="i">end_braced_variable_scan</span>;
                                }
 
                                <span class="r301 r">c</span> = <a href="#097173370ab63237" class="i method">Backtick</a>(<span class="r303 r">c1</span>, <b>out char</b> <span id="r304 rd" class="r304 r">surrogateCharacter</span>);
                                <b>if</b> (<span class="r304 r">surrogateCharacter</span> != <a href="#a887df35fd840574" class="i field">s_invalidChar</a>)
                                {
                                    <span class="r300 r">sb</span>.<span class="i">Append</span>(<span class="r301 r">c</span>).<span class="i">Append</span>(<span class="r304 r">surrogateCharacter</span>);
                                    <b>continue</b>;
                                }
 
                                <b>break</b>;
                            }
                        <b>case</b> <span class="s">&#39;&quot;&#39;</span>:
                        <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#6749fb0434683e1c" class="i field">QuoteDoubleLeft</a>:
                        <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#4c212a52dfd2ded6" class="i field">QuoteDoubleRight</a>:
                        <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#8ee35cea65b6cbb9" class="i field">QuoteLowDoubleLeft</a>:
                            <b>if</b> (<span class="r298 r">inStringExpandable</span>)
                            {
                                <b>char</b> <span id="r305 rd" class="r305 r">c1</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
                                <b>if</b> (<span class="r305 r">c1</span> == <span class="s">&#39;\0&#39;</span> &amp;&amp; <a href="#91d350b0c4e63776" class="i method">AtEof</a>())
                                {
                                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                                    <b>goto</b> <span class="i">end_braced_variable_scan</span>;
                                }
 
                                <b>if</b> (<span class="r305 r">c1</span>.<a href="CharTraits.cs.html#07f0a28c4f50e364" class="i method">IsDoubleQuote</a>())
                                {
                                    <span class="r301 r">c</span> = <span class="r305 r">c1</span>;
                                }
                                <b>else</b>
                                {
                                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                                }
                            }
 
                            <b>break</b>;
                        <b>case</b> <span class="s">&#39;{&#39;</span>:
                            <span class="i">ReportError</span>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">OpenBraceNeedsToBeBackTickedInVariableName</span>),
                                <span class="i">ParserStrings</span>.<span class="i">OpenBraceNeedsToBeBackTickedInVariableName</span>);
                            <b>break</b>;
                        <b>case</b> <span class="s">&#39;\0&#39;</span>:
                            <b>if</b> (<a href="#91d350b0c4e63776" class="i method">AtEof</a>())
                            {
                                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                                <b>goto</b> <span class="i">end_braced_variable_scan</span>;
                            }
 
                            <b>break</b>;
                    }
 
                    <span class="r300 r">sb</span>.<span class="i">Append</span>(<span class="r301 r">c</span>);
                }
 
            <span class="i">end_braced_variable_scan</span>:
 
                <b>string</b> <span id="r306 rd" class="r306 r">name</span> = <a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r300 r">sb</span>);
                <b>if</b> (<span class="r301 r">c</span> != <span class="s">&#39;}&#39;</span>)
                {
                    <span class="i">ReportIncompleteInput</span>(<span class="r299 r">errorStartPosition</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">IncompleteDollarVariableReference</span>),
                        <span class="i">ParserStrings</span>.<span class="i">IncompleteDollarVariableReference</span>);
                }
 
                <b>if</b> (<span class="r306 r">name</span>.<span class="i">Length</span> == 0)
                {
                    <b>if</b> (<span class="r301 r">c</span> == <span class="s">&#39;}&#39;</span>)
                    {
                        <span class="i">ReportError</span>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 1,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EmptyVariableReference</span>),
                            <span class="i">ParserStrings</span>.<span class="i">EmptyVariableReference</span>);
                    }
 
                    <span class="r306 r">name</span> = <span class="s">&quot;:Error:&quot;</span>;
                }
 
                <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>())
                {
                    <b>char</b> <span id="r307 rd" class="r307 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
 
                    <span class="c">// A &#39;.&#39; or &#39;[&#39; after the variable name in command mode is an operator, not part of the current token.</span>
                    <b>if</b> (!<span class="r307 r">c1</span>.<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>() &amp;&amp; <span class="r307 r">c1</span> != <span class="s">&#39;.&#39;</span> &amp;&amp; <span class="r307 r">c1</span> != <span class="s">&#39;[&#39;</span>)
                    {
                        <span class="c">// The simple way to get this variable included in the nested tokens is to just start</span>
                        <span class="c">// scanning all over again, but from the context of scanning a generic token.</span>
                        <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> = <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>;
                        <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>());
                    }
                }
 
                <span class="r302 r">path</span> = <b>new</b> <a href="../VariablePath.cs.html#6f51a22b7d168e83" class="t constructor">VariablePath</a>(<span class="r306 r">name</span>);
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r302 r">path</span>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>))
                {
                    <span class="c">// Enable if we decide we still need to support</span>
                    <span class="c">//     &quot;${}&quot;  or &quot;$var:&quot;</span>
                    <span class="c">// if (inStringExpandable)</span>
                    <span class="c">// {</span>
                    <span class="c">//    return NewToken(TokenKind.Unknown);</span>
                    <span class="c">// }</span>
 
                    <span class="i">ReportError</span>(<a href="#0b0033f23d8d6789" class="i method">NewScriptExtent</a>(<a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>, <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidBracedVariableReference</span>),
                        <span class="i">ParserStrings</span>.<span class="i">InvalidBracedVariableReference</span>);
                }
 
                <b>return</b> <a href="#7466f0695516efa1" class="i method">NewVariableToken</a>(<span class="r302 r">path</span>, <b>false</b>);
            }
 
            <b>if</b> (!<span class="r301 r">c</span>.<a href="CharTraits.cs.html#7fd21417f3842df0" class="i method">IsVariableStart</a>())
            {
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                <span class="r300 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;$&#39;</span>);
                <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<span class="r300 r">sb</span>);
            }
 
            <span class="c">// Normal variable, not braced.</span>
            <span class="r300 r">sb</span>.<span class="i">Append</span>(<span class="r301 r">c</span>);
 
            <span class="c">// $$, $?, and $^ can only be single character variables.  Otherwise keep scanning.</span>
            <b>if</b> (!(<span class="r301 r">c</span> == <span class="s">&#39;$&#39;</span> || <span class="r301 r">c</span> == <span class="s">&#39;?&#39;</span> || <span class="r301 r">c</span> == <span class="s">&#39;^&#39;</span>))
            {
                <b>bool</b> <span id="r308 rd" class="r308 r">scanning</span> = <b>true</b>;
                <b>while</b> (<span class="r308 r">scanning</span>)
                {
                    <span class="r301 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
                    <b>switch</b> (<span class="r301 r">c</span>)
                    {
                        <b>case</b> <span class="s">&#39;a&#39;</span>:
                        <b>case</b> <span class="s">&#39;b&#39;</span>:
                        <b>case</b> <span class="s">&#39;c&#39;</span>:
                        <b>case</b> <span class="s">&#39;d&#39;</span>:
                        <b>case</b> <span class="s">&#39;e&#39;</span>:
                        <b>case</b> <span class="s">&#39;f&#39;</span>:
                        <b>case</b> <span class="s">&#39;g&#39;</span>:
                        <b>case</b> <span class="s">&#39;h&#39;</span>:
                        <b>case</b> <span class="s">&#39;i&#39;</span>:
                        <b>case</b> <span class="s">&#39;j&#39;</span>:
                        <b>case</b> <span class="s">&#39;k&#39;</span>:
                        <b>case</b> <span class="s">&#39;l&#39;</span>:
                        <b>case</b> <span class="s">&#39;m&#39;</span>:
                        <b>case</b> <span class="s">&#39;n&#39;</span>:
                        <b>case</b> <span class="s">&#39;o&#39;</span>:
                        <b>case</b> <span class="s">&#39;p&#39;</span>:
                        <b>case</b> <span class="s">&#39;q&#39;</span>:
                        <b>case</b> <span class="s">&#39;r&#39;</span>:
                        <b>case</b> <span class="s">&#39;s&#39;</span>:
                        <b>case</b> <span class="s">&#39;t&#39;</span>:
                        <b>case</b> <span class="s">&#39;u&#39;</span>:
                        <b>case</b> <span class="s">&#39;v&#39;</span>:
                        <b>case</b> <span class="s">&#39;w&#39;</span>:
                        <b>case</b> <span class="s">&#39;x&#39;</span>:
                        <b>case</b> <span class="s">&#39;y&#39;</span>:
                        <b>case</b> <span class="s">&#39;z&#39;</span>:
                        <b>case</b> <span class="s">&#39;A&#39;</span>:
                        <b>case</b> <span class="s">&#39;B&#39;</span>:
                        <b>case</b> <span class="s">&#39;C&#39;</span>:
                        <b>case</b> <span class="s">&#39;D&#39;</span>:
                        <b>case</b> <span class="s">&#39;E&#39;</span>:
                        <b>case</b> <span class="s">&#39;F&#39;</span>:
                        <b>case</b> <span class="s">&#39;G&#39;</span>:
                        <b>case</b> <span class="s">&#39;H&#39;</span>:
                        <b>case</b> <span class="s">&#39;I&#39;</span>:
                        <b>case</b> <span class="s">&#39;J&#39;</span>:
                        <b>case</b> <span class="s">&#39;K&#39;</span>:
                        <b>case</b> <span class="s">&#39;L&#39;</span>:
                        <b>case</b> <span class="s">&#39;M&#39;</span>:
                        <b>case</b> <span class="s">&#39;N&#39;</span>:
                        <b>case</b> <span class="s">&#39;O&#39;</span>:
                        <b>case</b> <span class="s">&#39;P&#39;</span>:
                        <b>case</b> <span class="s">&#39;Q&#39;</span>:
                        <b>case</b> <span class="s">&#39;R&#39;</span>:
                        <b>case</b> <span class="s">&#39;S&#39;</span>:
                        <b>case</b> <span class="s">&#39;T&#39;</span>:
                        <b>case</b> <span class="s">&#39;U&#39;</span>:
                        <b>case</b> <span class="s">&#39;V&#39;</span>:
                        <b>case</b> <span class="s">&#39;W&#39;</span>:
                        <b>case</b> <span class="s">&#39;X&#39;</span>:
                        <b>case</b> <span class="s">&#39;Y&#39;</span>:
                        <b>case</b> <span class="s">&#39;Z&#39;</span>:
                        <b>case</b> <span class="s">&#39;0&#39;</span>:
                        <b>case</b> <span class="s">&#39;1&#39;</span>:
                        <b>case</b> <span class="s">&#39;2&#39;</span>:
                        <b>case</b> <span class="s">&#39;3&#39;</span>:
                        <b>case</b> <span class="s">&#39;4&#39;</span>:
                        <b>case</b> <span class="s">&#39;5&#39;</span>:
                        <b>case</b> <span class="s">&#39;6&#39;</span>:
                        <b>case</b> <span class="s">&#39;7&#39;</span>:
                        <b>case</b> <span class="s">&#39;8&#39;</span>:
                        <b>case</b> <span class="s">&#39;9&#39;</span>:
                        <b>case</b> <span class="s">&#39;_&#39;</span>:
                        <b>case</b> <span class="s">&#39;?&#39;</span>:
                            <span class="r300 r">sb</span>.<span class="i">Append</span>(<span class="r301 r">c</span>);
                            <b>break</b>;
 
                        <b>case</b> <span class="s">&#39;:&#39;</span>:
                            <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;:&#39;</span>)
                            {
                                <span class="c">// Something like $a::b is static member access</span>
                                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                                <span class="r308 r">scanning</span> = <b>false</b>;
                            }
                            <b>else</b>
                            {
                                <span class="r300 r">sb</span>.<span class="i">Append</span>(<span class="r301 r">c</span>);
                            }
 
                            <b>break</b>;
 
                        <b>case</b> <span class="s">&#39;\0&#39;</span>:
                        <b>case</b> <span class="s">&#39;\t&#39;</span>:
                        <b>case</b> <span class="s">&#39;\r&#39;</span>:
                        <b>case</b> <span class="s">&#39;\n&#39;</span>:
                        <b>case</b> <span class="s">&#39; &#39;</span>:
                        <b>case</b> <span class="s">&#39;&amp;&#39;</span>:
                        <b>case</b> <span class="s">&#39;(&#39;</span>:
                        <b>case</b> <span class="s">&#39;)&#39;</span>:
                        <b>case</b> <span class="s">&#39;,&#39;</span>:
                        <b>case</b> <span class="s">&#39;;&#39;</span>:
                        <b>case</b> <span class="s">&#39;{&#39;</span>:
                        <b>case</b> <span class="s">&#39;}&#39;</span>:
                        <b>case</b> <span class="s">&#39;|&#39;</span>:
                        <span class="c">// The above cases would also be handled correctly below in the default case,</span>
                        <span class="c">// but we can avoid extra checks on some of these characters which commonly</span>
                        <span class="c">// occur after a variable.</span>
                        <b>case</b> <span class="s">&#39;.&#39;</span>:
                        <b>case</b> <span class="s">&#39;[&#39;</span>:
                        <span class="c">// Something like $a.b or $a[1].</span>
                        <b>case</b> <span class="s">&#39;=&#39;</span>:
                            <span class="c">// Something like $a=</span>
                            <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                            <span class="r308 r">scanning</span> = <b>false</b>;
                            <b>break</b>;
 
                        <b>default</b>:
                            <b>if</b> (<b>char</b>.<span class="i">IsLetterOrDigit</span>(<span class="r301 r">c</span>))
                            {
                                <span class="r300 r">sb</span>.<span class="i">Append</span>(<span class="r301 r">c</span>);
                            }
                            <b>else</b> <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; !<span class="r301 r">c</span>.<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>())
                            {
                                <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> = <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>;
                                <span class="r300 r">sb</span>.<span class="i">Clear</span>();
                                <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<span class="r300 r">sb</span>);
                            }
                            <b>else</b>
                            {
                                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                                <span class="r308 r">scanning</span> = <b>false</b>;
                            }
 
                            <b>break</b>;
                    }
                }
            }
            <b>else</b> <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; !<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>().<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>())
            {
                <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> = <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>;
                <span class="r300 r">sb</span>.<span class="i">Clear</span>();
                <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<span class="r300 r">sb</span>);
            }
 
            <span class="r302 r">path</span> = <b>new</b> <a href="../VariablePath.cs.html#6f51a22b7d168e83" class="t constructor">VariablePath</a>(<a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r300 r">sb</span>));
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r302 r">path</span>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>))
            {
                <b>string</b> <span id="r309 rd" class="r309 r">errorId</span>;
                <b>string</b> <span id="r310 rd" class="r310 r">errorMsg</span>;
                <b>if</b> (<span class="r302 r">path</span>.<a href="../VariablePath.cs.html#70f672ec2e5c2bcb" class="i property">IsDriveQualified</a>)
                {
                    <span class="r309 r">errorId</span> = <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidVariableReferenceWithDrive</span>);
                    <span class="r310 r">errorMsg</span> = <span class="i">ParserStrings</span>.<span class="i">InvalidVariableReferenceWithDrive</span>;
                }
                <b>else</b>
                {
                    <span class="r309 r">errorId</span> = <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidVariableReference</span>);
                    <span class="r310 r">errorMsg</span> = <span class="i">ParserStrings</span>.<span class="i">InvalidVariableReference</span>;
                }
 
                <a href="#c217fbd2d118e854" class="i method">ReportError</a>(<a href="#0b0033f23d8d6789" class="i method">NewScriptExtent</a>(<a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>, <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>), <span class="r309 r">errorId</span>, <span class="r310 r">errorMsg</span>);
            }
 
            <b>return</b> <a href="#7466f0695516efa1" class="i method">NewVariableToken</a>(<span class="r302 r">path</span>, <span class="r297 r">splatted</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Variables
 
        <span class="c">// Scan either a parameter or an operator, in either case it must start with a dash.</span>
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="719cc827220e1eeb" href="../../R/719cc827220e1eeb.html" target="n" data-glyph="76,1" class="i method">ScanParameter</a>()
        {
            <b>var</b> <span id="r311 rd" class="r311 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
 
            <b>bool</b> <span id="r312 rd" class="r312 r">scanning</span> = <b>true</b>;
            <b>bool</b> <span id="r313 rd" class="r313 r">sawColonAtEnd</span> = <b>false</b>;
            <b>while</b> (<span class="r312 r">scanning</span>)
            {
                <b>char</b> <span id="r314 rd" class="r314 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
                <b>if</b> (<span class="r314 r">c</span>.<a href="CharTraits.cs.html#66538dacee9a61db" class="i method">IsWhitespace</a>())
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <b>break</b>;
                }
 
                <b>switch</b> (<span class="r314 r">c</span>)
                {
                    <b>case</b> <span class="s">&#39;{&#39;</span>:
                    <b>case</b> <span class="s">&#39;}&#39;</span>:
                    <b>case</b> <span class="s">&#39;(&#39;</span>:
                    <b>case</b> <span class="s">&#39;)&#39;</span>:
                    <b>case</b> <span class="s">&#39;;&#39;</span>:
                    <b>case</b> <span class="s">&#39;,&#39;</span>:
                    <b>case</b> <span class="s">&#39;|&#39;</span>:
                    <b>case</b> <span class="s">&#39;&amp;&#39;</span>:
                    <b>case</b> <span class="s">&#39;.&#39;</span>:
                    <b>case</b> <span class="s">&#39;[&#39;</span>:
                    <b>case</b> <span class="s">&#39;\r&#39;</span>:
                    <b>case</b> <span class="s">&#39;\n&#39;</span>:
                    <b>case</b> <span class="s">&#39;\0&#39;</span>:
                        <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        <span class="r312 r">scanning</span> = <b>false</b>;
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&#39;:&#39;</span>:
                        <span class="r312 r">scanning</span> = <b>false</b>;
                        <span class="r313 r">sawColonAtEnd</span> = <b>true</b>;
                        <b>if</b> (!<a href="#11a31983df5b2639" class="i method">InCommandMode</a>())
                        {
                            <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        }
 
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&#39;a&#39;</span>:
                    <b>case</b> <span class="s">&#39;b&#39;</span>:
                    <b>case</b> <span class="s">&#39;c&#39;</span>:
                    <b>case</b> <span class="s">&#39;d&#39;</span>:
                    <b>case</b> <span class="s">&#39;e&#39;</span>:
                    <b>case</b> <span class="s">&#39;f&#39;</span>:
                    <b>case</b> <span class="s">&#39;g&#39;</span>:
                    <b>case</b> <span class="s">&#39;h&#39;</span>:
                    <b>case</b> <span class="s">&#39;i&#39;</span>:
                    <b>case</b> <span class="s">&#39;j&#39;</span>:
                    <b>case</b> <span class="s">&#39;k&#39;</span>:
                    <b>case</b> <span class="s">&#39;l&#39;</span>:
                    <b>case</b> <span class="s">&#39;m&#39;</span>:
                    <b>case</b> <span class="s">&#39;n&#39;</span>:
                    <b>case</b> <span class="s">&#39;o&#39;</span>:
                    <b>case</b> <span class="s">&#39;p&#39;</span>:
                    <b>case</b> <span class="s">&#39;q&#39;</span>:
                    <b>case</b> <span class="s">&#39;r&#39;</span>:
                    <b>case</b> <span class="s">&#39;s&#39;</span>:
                    <b>case</b> <span class="s">&#39;t&#39;</span>:
                    <b>case</b> <span class="s">&#39;u&#39;</span>:
                    <b>case</b> <span class="s">&#39;v&#39;</span>:
                    <b>case</b> <span class="s">&#39;w&#39;</span>:
                    <b>case</b> <span class="s">&#39;x&#39;</span>:
                    <b>case</b> <span class="s">&#39;y&#39;</span>:
                    <b>case</b> <span class="s">&#39;z&#39;</span>:
                    <b>case</b> <span class="s">&#39;A&#39;</span>:
                    <b>case</b> <span class="s">&#39;B&#39;</span>:
                    <b>case</b> <span class="s">&#39;C&#39;</span>:
                    <b>case</b> <span class="s">&#39;D&#39;</span>:
                    <b>case</b> <span class="s">&#39;E&#39;</span>:
                    <b>case</b> <span class="s">&#39;F&#39;</span>:
                    <b>case</b> <span class="s">&#39;G&#39;</span>:
                    <b>case</b> <span class="s">&#39;H&#39;</span>:
                    <b>case</b> <span class="s">&#39;I&#39;</span>:
                    <b>case</b> <span class="s">&#39;J&#39;</span>:
                    <b>case</b> <span class="s">&#39;K&#39;</span>:
                    <b>case</b> <span class="s">&#39;L&#39;</span>:
                    <b>case</b> <span class="s">&#39;M&#39;</span>:
                    <b>case</b> <span class="s">&#39;N&#39;</span>:
                    <b>case</b> <span class="s">&#39;O&#39;</span>:
                    <b>case</b> <span class="s">&#39;P&#39;</span>:
                    <b>case</b> <span class="s">&#39;Q&#39;</span>:
                    <b>case</b> <span class="s">&#39;R&#39;</span>:
                    <b>case</b> <span class="s">&#39;S&#39;</span>:
                    <b>case</b> <span class="s">&#39;T&#39;</span>:
                    <b>case</b> <span class="s">&#39;U&#39;</span>:
                    <b>case</b> <span class="s">&#39;V&#39;</span>:
                    <b>case</b> <span class="s">&#39;W&#39;</span>:
                    <b>case</b> <span class="s">&#39;X&#39;</span>:
                    <b>case</b> <span class="s">&#39;Y&#39;</span>:
                    <b>case</b> <span class="s">&#39;Z&#39;</span>:
                        <span class="r311 r">sb</span>.<span class="i">Append</span>(<span class="r314 r">c</span>);
                        <b>break</b>;
 
                    <b>case</b> <span class="s">&#39;\&#39;&#39;</span>:
                    <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#37d4552d6f6b71b8" class="i field">QuoteSingleLeft</a>:
                    <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#0657e636cbc8d3b3" class="i field">QuoteSingleRight</a>:
                    <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#a146d94e822b7f44" class="i field">QuoteSingleBase</a>:
                    <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#aa260f61c9b57e5a" class="i field">QuoteReversed</a>:
                    <b>case</b> <span class="s">&#39;&quot;&#39;</span>:
                    <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#6749fb0434683e1c" class="i field">QuoteDoubleLeft</a>:
                    <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#4c212a52dfd2ded6" class="i field">QuoteDoubleRight</a>:
                    <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#8ee35cea65b6cbb9" class="i field">QuoteLowDoubleLeft</a>:
                        <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>())
                        {
                            <span class="c">// Quotes are never part of a parameter.  Treat the token as an argument.</span>
                            <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                            <span class="r311 r">sb</span>.<span class="i">Insert</span>(0, <a href="#0d494c77d31a8678" class="i field">_script</a>[<a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>]); <span class="c">// Insert the &#39;-&#39; that we skipped.</span>
                            <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<span class="r311 r">sb</span>);
                        }
 
                        <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        <span class="r312 r">scanning</span> = <b>false</b>;
                        <b>break</b>;
 
                    <b>default</b>:
                        <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>())
                        {
                            <span class="r311 r">sb</span>.<span class="i">Append</span>(<span class="r314 r">c</span>);
                        }
                        <b>else</b>
                        {
                            <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                            <span class="r312 r">scanning</span> = <b>false</b>;
                        }
 
                        <b>break</b>;
                }
            }
 
            <b>var</b> <span id="r315 rd" class="r315 r">str</span> = <a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r311 r">sb</span>);
 
            <b>if</b> (<a href="#39741816bda0c4aa" class="i method">InExpressionMode</a>())
            {
                <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r316 rd" class="r316 r">operatorKind</span>;
                <b>if</b> (<a href="#e222a4381ebc97d4" class="i field">s_operatorTable</a>.<span class="i">TryGetValue</span>(<span class="r315 r">str</span>, <b>out</b> <span class="r316 r">operatorKind</span>))
                {
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<span class="r316 r">operatorKind</span>);
                }
            }
 
            <b>if</b> (<span class="r315 r">str</span>.<span class="i">Length</span> == 0)
            {
                <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#069476ae2e7b4442" class="i field">Minus</a>);
            }
 
            <b>return</b> <a href="#86d60114fc81ff06" class="i method">NewParameterToken</a>(<span class="r315 r">str</span>, <span class="r313 r">sawColonAtEnd</span>);
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="030bd055c04a0c09" href="../../R/030bd055c04a0c09.html" target="n" data-glyph="76,1" class="i method">CheckOperatorInCommandMode</a>(<b>char</b> <span id="r317 rd" class="r317 r">c</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r318 rd" class="r318 r">tokenKind</span>)
        {
            <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; !<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>().<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>())
            {
                <b>return</b> <a href="#a09d4027e4467cf2" class="i method">ScanGenericToken</a>(<span class="r317 r">c</span>);
            }
 
            <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<span class="r318 r">tokenKind</span>);
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="e1c8d6814ceade41" href="../../R/e1c8d6814ceade41.html" target="n" data-glyph="76,1" class="i method">CheckOperatorInCommandMode</a>(<b>char</b> <span id="r319 rd" class="r319 r">c1</span>, <b>char</b> <span id="r320 rd" class="r320 r">c2</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r321 rd" class="r321 r">tokenKind</span>)
        {
            <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; !<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>().<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>())
            {
                <b>var</b> <span id="r322 rd" class="r322 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
                <span class="r322 r">sb</span>.<span class="i">Append</span>(<span class="r319 r">c1</span>);
                <span class="r322 r">sb</span>.<span class="i">Append</span>(<span class="r320 r">c2</span>);
                <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<span class="r322 r">sb</span>);
            }
 
            <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<span class="r321 r">tokenKind</span>);
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="a09d4027e4467cf2" href="../../R/a09d4027e4467cf2.html" target="n" data-glyph="76,1" class="i method">ScanGenericToken</a>(<b>char</b> <span id="r323 rd" class="r323 r">firstChar</span>)
        {
            <b>var</b> <span id="r324 rd" class="r324 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <span class="r324 r">sb</span>.<span class="i">Append</span>(<span class="r323 r">firstChar</span>);
            <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<span class="r324 r">sb</span>);
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="ec0759647513e69f" href="../../R/ec0759647513e69f.html" target="n" data-glyph="76,1" class="i method">ScanGenericToken</a>(<b>char</b> <span id="r325 rd" class="r325 r">firstChar</span>, <b>char</b> <span id="r326 rd" class="r326 r">surrogateCharacter</span>)
        {
            <b>var</b> <span id="r327 rd" class="r327 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <span class="r327 r">sb</span>.<span class="i">Append</span>(<span class="r325 r">firstChar</span>);
            <b>if</b> (<span class="r326 r">surrogateCharacter</span> != <a href="#a887df35fd840574" class="i field">s_invalidChar</a>)
            {
                <span class="r327 r">sb</span>.<span class="i">Append</span>(<span class="r326 r">surrogateCharacter</span>);
            }
 
            <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<span class="r327 r">sb</span>);
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="fc690270657c8c3a" href="../../R/fc690270657c8c3a.html" target="n" data-glyph="76,1" class="i method">ScanGenericToken</a>(<span class="i">StringBuilder</span> <span id="r328 rd" class="r328 r">sb</span>)
        {
            <span class="c">// On entry, we&#39;ve already scanned an unknown number of characters</span>
            <span class="c">// and found a character that didn&#39;t end the token, but made the</span>
            <span class="c">// token something other than what we thought it was.  Examples:</span>
            <span class="c">//    77z   &lt;= it looks like a number, but the &#39;z&#39; makes it an argument</span>
            <span class="c">//    $+    &lt;= it looks like a variable, but the &#39;+&#39; makes it an argument</span>
            <span class="c">//</span>
            <span class="c">// A generic token is typically either command name or command argument</span>
            <span class="c">// (though a generic token is accepted in other places, such as a hash key</span>
            <span class="c">// or function name.)</span>
            <span class="c">//</span>
            <span class="c">// A generic token can be taken literally or treated as an expandable</span>
            <span class="c">// string, depending on the context.  A command argument would treat</span>
            <span class="c">// a generic token as an expandable string whereas a command name would</span>
            <span class="c">// not.</span>
            <span class="c">//</span>
            <span class="c">// We optimize for the command argument case - if we find anything expandable,</span>
            <span class="c">// we continue processing assuming the string is expandable, so we&#39;ll tokenize</span>
            <span class="c">// sub-expressions and variable names.  This would be considered extra work</span>
            <span class="c">// if the token was a command name, so we assume that will happen rarely, and</span>
            <span class="c">// indeed, &#39;$&#39; is not commonly used in command names.</span>
 
            <span class="c">// Make sure our token does not start with any of these characters.</span>
            <span class="c">// Contract.Requires(Contract.ForAll(&quot;{}()@#;,|&amp;\r\n\t &quot;, c1 =&gt; sb[0] != c1));</span>
 
            <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r329 rd" class="r329 r">nestedTokens</span> = <b>new</b> <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt;();
            <b>var</b> <span id="r330 rd" class="r330 r">formatSb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <span class="r330 r">formatSb</span>.<span class="i">Append</span>(<span class="r328 r">sb</span>);
 
            <b>char</b> <span id="r331 rd" class="r331 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            <b>for</b> (; !<span class="r331 r">c</span>.<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>(); <span class="r331 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>())
            {
                <b>if</b> (<span class="r331 r">c</span> == <span class="s">&#39;`&#39;</span>)
                {
                    <span class="c">// If end of input, we&#39;ll just append the backtick - there should be no error.</span>
                    <b>char</b> <span id="r332 rd" class="r332 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                    <b>if</b> (<span class="r332 r">c1</span> != 0)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <span class="r331 r">c</span> = <a href="#097173370ab63237" class="i method">Backtick</a>(<span class="r332 r">c1</span>, <b>out char</b> <span id="r333 rd" class="r333 r">surrogateCharacter</span>);
                        <b>if</b> (<span class="r333 r">surrogateCharacter</span> != <a href="#a887df35fd840574" class="i field">s_invalidChar</a>)
                        {
                            <span class="r328 r">sb</span>.<span class="i">Append</span>(<span class="r331 r">c</span>).<span class="i">Append</span>(<span class="r333 r">surrogateCharacter</span>);
                            <span class="r330 r">formatSb</span>.<span class="i">Append</span>(<span class="r331 r">c</span>).<span class="i">Append</span>(<span class="r333 r">surrogateCharacter</span>);
                            <b>continue</b>;
                        }
                    }
                }
                <b>else</b> <b>if</b> (<span class="r331 r">c</span>.<a href="CharTraits.cs.html#b40a10af036c9eeb" class="i method">IsSingleQuote</a>())
                {
                    <b>int</b> <span id="r334 rd" class="r334 r">len</span> = <span class="r328 r">sb</span>.<span class="i">Length</span>;
                    <a href="#36ffa9efbde92055" class="i method">ScanStringLiteral</a>(<span class="r328 r">sb</span>);
                    <b>for</b> (<b>int</b> <span id="r335 rd" class="r335 r">i</span> = <span class="r334 r">len</span>; <span class="r335 r">i</span> &lt; <span class="r328 r">sb</span>.<span class="i">Length</span>; ++<span class="r335 r">i</span>)
                    {
                        <span class="r330 r">formatSb</span>.<span class="i">Append</span>(<span class="r328 r">sb</span>[<span class="r335 r">i</span>]);
                    }
 
                    <b>continue</b>;
                }
                <b>else</b> <b>if</b> (<span class="r331 r">c</span>.<a href="CharTraits.cs.html#07f0a28c4f50e364" class="i method">IsDoubleQuote</a>())
                {
                    <a href="#b9906cfc8623a9d2" class="i method">ScanStringExpandable</a>(<span class="r328 r">sb</span>, <span class="r330 r">formatSb</span>, <span class="r329 r">nestedTokens</span>);
                    <b>continue</b>;
                }
                <b>else</b> <b>if</b> (<span class="r331 r">c</span> == <span class="s">&#39;$&#39;</span>)
                {
                    <b>if</b> (<a href="#aa6fc2eede1cbf8c" class="i method">ScanDollarInStringExpandable</a>(<span class="r328 r">sb</span>, <span class="r330 r">formatSb</span>, <b>false</b>, <span class="r329 r">nestedTokens</span>))
                    {
                        <b>continue</b>;
                    }
                }
 
                <span class="r328 r">sb</span>.<span class="i">Append</span>(<span class="r331 r">c</span>);
                <span class="r330 r">formatSb</span>.<span class="i">Append</span>(<span class="r331 r">c</span>);
                <b>if</b> (<span class="r331 r">c</span> == <span class="s">&#39;{&#39;</span> || <span class="r331 r">c</span> == <span class="s">&#39;}&#39;</span>)
                {
                    <span class="r330 r">formatSb</span>.<span class="i">Append</span>(<span class="r331 r">c</span>);
                }
            }
 
            <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
 
            <b>var</b> <span id="r336 rd" class="r336 r">str</span> = <a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r328 r">sb</span>);
            <b>if</b> (<span class="r329 r">nestedTokens</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>return</b> <a href="#430e58a6774fde9e" class="i method">NewGenericExpandableToken</a>(<span class="r336 r">str</span>, <a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r330 r">formatSb</span>), <span class="r329 r">nestedTokens</span>);
            }
 
            <a href="#7802c95baba16dea" class="i method">Release</a>(<span class="r330 r">formatSb</span>);
 
            <b>if</b> (<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="#2af1cc3c0788237c" class="i method">ContainsKeyword</a>(<span class="r336 r">str</span>) &amp;&amp; !<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="#7e4c6e6aaae4a0c3" class="i method">IsHiddenKeyword</a>(<span class="r336 r">str</span>))
            {
                <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e7868dd662d25e11" class="i field">DynamicKeyword</a>);
            }
 
            <b>return</b> <a href="#9bf18f9cffdfc216" class="i method">NewGenericToken</a>(<span class="r336 r">str</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Numbers
 
        <b>private void</b> <a id="b3836b57966251ea" href="../../R/b3836b57966251ea.html" target="n" data-glyph="76,1" class="i method">ScanHexDigits</a>(<span class="i">StringBuilder</span> <span id="r337 rd" class="r337 r">sb</span>)
        {
            <b>char</b> <span id="r338 rd" class="r338 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
            <b>while</b> (<span class="r338 r">c</span>.<a href="CharTraits.cs.html#35dc0749f42f9bef" class="i method">IsHexDigit</a>())
            {
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <span class="r337 r">sb</span>.<span class="i">Append</span>(<span class="r338 r">c</span>);
                <span class="r338 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
            }
        }
 
        <b>private int</b> <a id="07ccbfce2ca34bf4" href="../../R/07ccbfce2ca34bf4.html" target="n" data-glyph="76,1" class="i method">ScanDecimalDigits</a>(<span class="i">StringBuilder</span> <span id="r339 rd" class="r339 r">sb</span>)
        {
            <b>int</b> <span id="r340 rd" class="r340 r">countDigits</span> = 0;
            <b>char</b> <span id="r341 rd" class="r341 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
            <b>while</b> (<span class="r341 r">c</span>.<a href="CharTraits.cs.html#9aa2253860d75a43" class="i method">IsDecimalDigit</a>())
            {
                <span class="r340 r">countDigits</span> += 1;
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <span class="r339 r">sb</span>.<span class="i">Append</span>(<span class="r341 r">c</span>);
                <span class="r341 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
            }
 
            <b>return</b> <span class="r340 r">countDigits</span>;
        }
 
        <b>private void</b> <a id="bec3ebeda50638da" href="../../R/bec3ebeda50638da.html" target="n" data-glyph="76,1" class="i method">ScanBinaryDigits</a>(<span class="i">StringBuilder</span> <span id="r342 rd" class="r342 r">sb</span>)
        {
            <b>char</b> <span id="r343 rd" class="r343 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
            <b>while</b> (<span class="r343 r">c</span>.<a href="CharTraits.cs.html#ce87a870c05cc47b" class="i method">IsBinaryDigit</a>())
            {
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <span class="r342 r">sb</span>.<span class="i">Append</span>(<span class="r343 r">c</span>);
                <span class="r343 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
            }
        }
 
        <b>private void</b> <a id="64fb5a681f12850b" href="../../R/64fb5a681f12850b.html" target="n" data-glyph="76,1" class="i method">ScanExponent</a>(<span class="i">StringBuilder</span> <span id="r344 rd" class="r344 r">sb</span>, <b>ref int</b> <span id="r345 rd" class="r345 r">signIndex</span>, <b>ref bool</b> <span id="r346 rd" class="r346 r">notNumber</span>)
        {
            <b>char</b> <span id="r347 rd" class="r347 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
            <b>if</b> (<span class="r347 r">c</span> == <span class="s">&#39;+&#39;</span> || <span class="r347 r">c</span>.<a href="CharTraits.cs.html#7ecfc2477f403174" class="i method">IsDash</a>())
            {
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <span class="c">// Append the sign - but remember where it was appended.  If we really</span>
                <span class="c">// do have a number, we&#39;ll replace en-dash/em-dash/horizontal-bar with dash,</span>
                <span class="c">// but if it&#39;s a generic token, we don&#39;t want to do the replacement.</span>
                <span class="r345 r">signIndex</span> = <span class="r344 r">sb</span>.<span class="i">Length</span>;
                <span class="r344 r">sb</span>.<span class="i">Append</span>(<span class="r347 r">c</span>);
            }
 
            <b>if</b> (<a href="#07ccbfce2ca34bf4" class="i method">ScanDecimalDigits</a>(<span class="r344 r">sb</span>) == 0)
            {
                <span class="r346 r">notNumber</span> = <b>true</b>;
            }
        }
 
        <b>private void</b> <a id="6b4866c5ac56d681" href="../../R/6b4866c5ac56d681.html" target="n" data-glyph="76,1" class="i method">ScanNumberAfterDot</a>(<span class="i">StringBuilder</span> <span id="r348 rd" class="r348 r">sb</span>, <b>ref int</b> <span id="r349 rd" class="r349 r">signIndex</span>, <b>ref bool</b> <span id="r350 rd" class="r350 r">notNumber</span>)
        {
            <a href="#07ccbfce2ca34bf4" class="i method">ScanDecimalDigits</a>(<span class="r348 r">sb</span>);
            <span class="c">// No need to verify we saw a digit here.</span>
            <span class="c">//    1.e1 is valid</span>
            <span class="c">//    .e1 is not, but ScanDot ensures the next character is a digit</span>
 
            <b>char</b> <span id="r351 rd" class="r351 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
            <b>if</b> (<span class="r351 r">c</span> == <span class="s">&#39;e&#39;</span> || <span class="r351 r">c</span> == <span class="s">&#39;E&#39;</span>)
            {
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <span class="r348 r">sb</span>.<span class="i">Append</span>(<span class="r351 r">c</span>);
                <a href="#64fb5a681f12850b" class="i method">ScanExponent</a>(<span class="r348 r">sb</span>, <b>ref</b> <span class="r349 r">signIndex</span>, <b>ref</b> <span class="r350 r">notNumber</span>);
            }
        }
 
        <b>private static bool</b> <a id="a9a80a4b628efc88" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">TryGetNumberValue</a>(
            <span class="i">ReadOnlySpan</span>&lt;<b>char</b>&gt; <span id="r352 rd" class="r352 r">strNum</span>,
            <a href="#c7287a05d62564a0" class="t t">NumberFormat</a> <span id="r353 rd" class="r353 r">format</span>,
            <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a> <span id="r354 rd" class="r354 r">suffix</span>,
            <b>bool</b> <span id="r355 rd" class="r355 r">real</span>,
            <b>long</b> <span id="r356 rd" class="r356 r">multiplier</span>,
            <b>out object</b> <span id="r357 rd" class="r357 r">result</span>)
        {
            <b>checked</b>
            {
                <b>try</b>
                {
                    <span class="i">NumberStyles</span> <span id="r358 rd" class="r358 r">style</span> = <span class="i">NumberStyles</span>.<span class="i">AllowLeadingSign</span>
                        | <span class="i">NumberStyles</span>.<span class="i">AllowDecimalPoint</span>
                        | <span class="i">NumberStyles</span>.<span class="i">AllowExponent</span>;
 
                    <b>if</b> (<span class="r355 r">real</span>)
                    {
                        <span class="c">// Decimal parser does not accept hex literals, and &#39;d&#39; is a valid hex character, so will</span>
                        <span class="c">// never be read as Decimal literal</span>
                        <span class="c">// e.g., 0x1d == 29</span>
                        <b>if</b> (<span class="r354 r">suffix</span> == <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#f91b842ea6fa4849" class="i field">Decimal</a>)
                        {
                            <b>if</b> (<b>decimal</b>.<span class="i">TryParse</span>(<span class="r352 r">strNum</span>, <span class="r358 r">style</span>, <span class="i">NumberFormatInfo</span>.<span class="i">InvariantInfo</span>, <b>out decimal</b> <span id="r359 rd" class="r359 r">d</span>))
                            {
                                <span class="r357 r">result</span> = <span class="r359 r">d</span> * <span class="r356 r">multiplier</span>;
                                <b>return</b> <b>true</b>;
                            }
 
                            <span class="r357 r">result</span> = <b>null</b>;
                            <b>return</b> <b>false</b>;
                        }
 
                        <b>if</b> (<b>double</b>.<span class="i">TryParse</span>(<span class="r352 r">strNum</span>, <span class="r358 r">style</span>, <span class="i">NumberFormatInfo</span>.<span class="i">InvariantInfo</span>, <b>out double</b> <span id="r360 rd" class="r360 r">doubleValue</span>))
                        {
                            <span class="c">// TryParse incorrectly return +0 when the result should be -0, so check for that case</span>
                            <b>if</b> (<span class="r360 r">doubleValue</span> == 0.0 &amp;&amp; <span class="r352 r">strNum</span>[0] == <span class="s">&#39;-&#39;</span>)
                            {
                                <span class="r360 r">doubleValue</span> = -0.0;
                            }
 
                            <span class="r360 r">doubleValue</span> *= <span class="r356 r">multiplier</span>;
                            <b>switch</b> (<span class="r354 r">suffix</span>)
                            {
                                <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#a316a1ebc21c5a21" class="i field">None</a>:
                                    <span class="r357 r">result</span> = <span class="r360 r">doubleValue</span>;
                                    <b>return</b> <b>true</b>;
                                <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#c9973660084ff789" class="i field">SignedByte</a>:
                                    <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#3fe8963e3122fe70" class="i method">TryCast</a>(<span class="r360 r">doubleValue</span>.<a href="../Utils.cs.html#885164d8b80cf459" class="i method">AsBigInt</a>(), <b>out sbyte</b> <span id="r361 rd" class="r361 r">sb</span>))
                                    {
                                        <span class="r357 r">result</span> = <span class="r361 r">sb</span>;
                                        <b>return</b> <b>true</b>;
                                    }
 
                                    <b>break</b>;
                                <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#ce6ab8e93185811e" class="i field">UnsignedByte</a>:
                                    <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#e3922f530b7cdb88" class="i method">TryCast</a>(<span class="r360 r">doubleValue</span>.<a href="../Utils.cs.html#885164d8b80cf459" class="i method">AsBigInt</a>(), <b>out byte</b> <span id="r362 rd" class="r362 r">b</span>))
                                    {
                                        <span class="r357 r">result</span> = <span class="r362 r">b</span>;
                                        <b>return</b> <b>true</b>;
                                    }
 
                                    <b>break</b>;
                                <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#2c57f28002eed0e4" class="i field">Short</a>:
                                    <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#817e92e6a6568ad3" class="i method">TryCast</a>(<span class="r360 r">doubleValue</span>.<a href="../Utils.cs.html#885164d8b80cf459" class="i method">AsBigInt</a>(), <b>out short</b> <span id="r363 rd" class="r363 r">s</span>))
                                    {
                                        <span class="r357 r">result</span> = <span class="r363 r">s</span>;
                                        <b>return</b> <b>true</b>;
                                    }
 
                                    <b>break</b>;
                                <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#de9fac127152873b" class="i field">Long</a>:
                                    <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#602fcab7e62015c7" class="i method">TryCast</a>(<span class="r360 r">doubleValue</span>.<a href="../Utils.cs.html#885164d8b80cf459" class="i method">AsBigInt</a>(), <b>out long</b> <span id="r364 rd" class="r364 r">l</span>))
                                    {
                                        <span class="r357 r">result</span> = <span class="r364 r">l</span>;
                                        <b>return</b> <b>true</b>;
                                    }
 
                                    <b>break</b>;
                                <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#b0da53a1cb2b2626" class="i field">UnsignedShort</a>:
                                    <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#987b9e08295ada65" class="i method">TryCast</a>(<span class="r360 r">doubleValue</span>.<a href="../Utils.cs.html#885164d8b80cf459" class="i method">AsBigInt</a>(), <b>out ushort</b> <span id="r365 rd" class="r365 r">us</span>))
                                    {
                                        <span class="r357 r">result</span> = <span class="r365 r">us</span>;
                                        <b>return</b> <b>true</b>;
                                    }
 
                                    <b>break</b>;
                                <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#379c3e532c488690" class="i field">Unsigned</a>:
                                    <span class="i">BigInteger</span> <span id="r366 rd" class="r366 r">testValue</span> = <span class="r360 r">doubleValue</span>.<a href="../Utils.cs.html#885164d8b80cf459" class="i method">AsBigInt</a>();
                                    <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#a3991df57b5c7dbe" class="i method">TryCast</a>(<span class="r366 r">testValue</span>, <b>out uint</b> <span id="r367 rd" class="r367 r">u</span>))
                                    {
                                        <span class="r357 r">result</span> = <span class="r367 r">u</span>;
                                        <b>return</b> <b>true</b>;
                                    }
                                    <b>else</b> <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#7655988a5f31128a" class="i method">TryCast</a>(<span class="r366 r">testValue</span>, <b>out ulong</b> <span id="r368 rd" class="r368 r">ul</span>))
                                    {
                                        <span class="r357 r">result</span> = <span class="r368 r">ul</span>;
                                        <b>return</b> <b>true</b>;
                                    }
 
                                    <b>break</b>;
                                <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#ede3402395b50145" class="i field">UnsignedLong</a>:
                                    <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#7655988a5f31128a" class="i method">TryCast</a>(<span class="r360 r">doubleValue</span>.<a href="../Utils.cs.html#885164d8b80cf459" class="i method">AsBigInt</a>(), <b>out ulong</b> <span id="r369 rd" class="r369 r">ulValue</span>))
                                    {
                                        <span class="r357 r">result</span> = <span class="r369 r">ulValue</span>;
                                        <b>return</b> <b>true</b>;
                                    }
 
                                    <b>break</b>;
                                <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#7953909b7f4420a8" class="i field">BigInteger</a>:
                                    <span class="r357 r">result</span> = <span class="r360 r">doubleValue</span>.<a href="../Utils.cs.html#885164d8b80cf459" class="i method">AsBigInt</a>();
                                    <b>return</b> <b>true</b>;
                            }
 
                            <span class="c">// Invalid NumberSuffixFlags combination, or outside bounds of specified type.</span>
                            <span class="r357 r">result</span> = <b>null</b>;
                            <b>return</b> <b>false</b>;
                        }
 
                        <span class="c">// TryParse for real numeric literal failed</span>
                        <span class="r357 r">result</span> = <b>null</b>;
                        <b>return</b> <b>false</b>;
                    }
 
                    <span class="i">BigInteger</span> <span id="r370 rd" class="r370 r">bigValue</span>;
 
                    <b>switch</b> (<span class="r353 r">format</span>)
                    {
                        <b>case</b> <a href="#c7287a05d62564a0" class="t t">NumberFormat</a>.<a href="#2e84f234ea8d22d1" class="i field">Hex</a>:
                            <b>if</b> (!<span class="r352 r">strNum</span>[0].<span class="i">IsHexDigit</span>())
                            {
                                <b>if</b> (<span class="r352 r">strNum</span>[0] == <span class="s">&#39;-&#39;</span>)
                                {
                                    <span class="r356 r">multiplier</span> = -<span class="r356 r">multiplier</span>;
                                }
 
                                <span class="c">// Remove leading char (expected: - or +)</span>
                                <span class="r352 r">strNum</span> = <span class="r352 r">strNum</span>.<span class="i">Slice</span>(1);
                            }
 
                            <span class="c">// If we&#39;re expecting a sign bit, remove the leading 0 added in ScanNumberHelper</span>
                            <b>if</b> (!<span class="r354 r">suffix</span>.<span class="i">HasFlag</span>(<a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#379c3e532c488690" class="i field">Unsigned</a>))
                            {
                                <b>var</b> <span id="r371 rd" class="r371 r">expectedLength</span> = <span class="r354 r">suffix</span> <b>switch</b>
                                {
                                    <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#c9973660084ff789" class="i field">SignedByte</a> =&gt; 2,
                                    <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#2c57f28002eed0e4" class="i field">Short</a> =&gt; 4,
                                    <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#de9fac127152873b" class="i field">Long</a> =&gt; 16,
                                    <span class="c">// No suffix flag can mean int or long depending on input string length</span>
                                    <b>_</b> =&gt; <span class="r352 r">strNum</span>.<span class="i">Length</span> &lt; 16 ? 8 : 16
                                };
 
                                <b>if</b> (<span class="r352 r">strNum</span>.<span class="i">Length</span> == <span class="r371 r">expectedLength</span> + 1)
                                {
                                    <span class="r352 r">strNum</span> = <span class="r352 r">strNum</span>.<span class="i">Slice</span>(1);
                                }
                            }
 
                            <span class="r358 r">style</span> = <span class="i">NumberStyles</span>.<span class="i">AllowHexSpecifier</span>;
                            <b>if</b> (!<span class="i">BigInteger</span>.<span class="i">TryParse</span>(<span class="r352 r">strNum</span>, <span class="r358 r">style</span>, <span class="i">NumberFormatInfo</span>.<span class="i">InvariantInfo</span>, <b>out</b> <span class="r370 r">bigValue</span>))
                            {
                                <span class="r357 r">result</span> = <b>null</b>;
                                <b>return</b> <b>false</b>;
                            }
 
                            <span class="c">// If we have a hex literal denoting (u)int64, treat it as such, even if the value is low</span>
                            <b>if</b> (<span class="r352 r">strNum</span>.<span class="i">Length</span> == 16 &amp;&amp; (<span class="r354 r">suffix</span> == <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#a316a1ebc21c5a21" class="i field">None</a> || <span class="r354 r">suffix</span> == <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#379c3e532c488690" class="i field">Unsigned</a>))
                            {
                                <span class="r354 r">suffix</span> |= <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#de9fac127152873b" class="i field">Long</a>;
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="#c7287a05d62564a0" class="t t">NumberFormat</a>.<a href="#ece06b9bfb9ceedb" class="i field">Binary</a>:
                            <b>if</b> (!<span class="r352 r">strNum</span>[0].<span class="i">IsBinaryDigit</span>())
                            {
                                <b>if</b> (<span class="r352 r">strNum</span>[0] == <span class="s">&#39;-&#39;</span>)
                                {
                                    <span class="r356 r">multiplier</span> = -<span class="r356 r">multiplier</span>;
                                }
 
                                <span class="c">// Remove leading char (expected: - or +)</span>
                                <span class="r352 r">strNum</span> = <span class="r352 r">strNum</span>.<span class="i">Slice</span>(1);
                            }
 
                            <span class="r370 r">bigValue</span> = <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<span class="i">ParseBinary</span>(<span class="r352 r">strNum</span>, <span class="r354 r">suffix</span>.<span class="i">HasFlag</span>(<a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#379c3e532c488690" class="i field">Unsigned</a>));
 
                            <span class="c">// If we have a binary literal denoting (u)int64, treat it as such</span>
                            <b>if</b> (<span class="r352 r">strNum</span>.<span class="i">Length</span> == 64 &amp;&amp; (<span class="r354 r">suffix</span> == <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#a316a1ebc21c5a21" class="i field">None</a> || <span class="r354 r">suffix</span> == <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#379c3e532c488690" class="i field">Unsigned</a>))
                            {
                                <span class="r354 r">suffix</span> |= <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#de9fac127152873b" class="i field">Long</a>;
                            }
 
                            <b>break</b>;
                        <b>default</b>:
                            <span class="r358 r">style</span> = <span class="i">NumberStyles</span>.<span class="i">AllowLeadingSign</span>;
                            <b>if</b> (!<span class="i">BigInteger</span>.<span class="i">TryParse</span>(<span class="r352 r">strNum</span>, <span class="r358 r">style</span>, <span class="i">NumberFormatInfo</span>.<span class="i">InvariantInfo</span>, <b>out</b> <span class="r370 r">bigValue</span>))
                            {
                                <span class="r357 r">result</span> = <b>null</b>;
                                <b>return</b> <b>false</b>;
                            }
 
                            <b>break</b>;
                    }
 
                    <span class="c">// Apply multiplier before attempting casting to prevent overflow</span>
                    <span class="r370 r">bigValue</span> *= <span class="r356 r">multiplier</span>;
 
                    <b>switch</b> (<span class="r354 r">suffix</span>)
                    {
                        <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#c9973660084ff789" class="i field">SignedByte</a>:
                            <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#3fe8963e3122fe70" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out sbyte</b> <span id="r372 rd" class="r372 r">sb</span>))
                            {
                                <span class="r357 r">result</span> = <span class="r372 r">sb</span>;
                                <b>return</b> <b>true</b>;
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#ce6ab8e93185811e" class="i field">UnsignedByte</a>:
                            <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#e3922f530b7cdb88" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out byte</b> <span id="r373 rd" class="r373 r">b</span>))
                            {
                                <span class="r357 r">result</span> = <span class="r373 r">b</span>;
                                <b>return</b> <b>true</b>;
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#2c57f28002eed0e4" class="i field">Short</a>:
                            <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#817e92e6a6568ad3" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out short</b> <span id="r374 rd" class="r374 r">s</span>))
                            {
                                <span class="r357 r">result</span> = <span class="r374 r">s</span>;
                                <b>return</b> <b>true</b>;
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#de9fac127152873b" class="i field">Long</a>:
                            <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#602fcab7e62015c7" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out long</b> <span id="r375 rd" class="r375 r">l</span>))
                            {
                                <span class="r357 r">result</span> = <span class="r375 r">l</span>;
                                <b>return</b> <b>true</b>;
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#b0da53a1cb2b2626" class="i field">UnsignedShort</a>:
                            <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#987b9e08295ada65" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out ushort</b> <span id="r376 rd" class="r376 r">us</span>))
                            {
                                <span class="r357 r">result</span> = <span class="r376 r">us</span>;
                                <b>return</b> <b>true</b>;
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#379c3e532c488690" class="i field">Unsigned</a>:
                            <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#a3991df57b5c7dbe" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out uint</b> <span id="r377 rd" class="r377 r">u</span>))
                            {
                                <span class="r357 r">result</span> = <span class="r377 r">u</span>;
                                <b>return</b> <b>true</b>;
                            }
                            <b>else</b> <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#7655988a5f31128a" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out ulong</b> <span id="r378 rd" class="r378 r">ul</span>))
                            {
                                <span class="r357 r">result</span> = <span class="r378 r">ul</span>;
                                <b>return</b> <b>true</b>;
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#ede3402395b50145" class="i field">UnsignedLong</a>:
                            <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#7655988a5f31128a" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out ulong</b> <span id="r379 rd" class="r379 r">ulValue</span>))
                            {
                                <span class="r357 r">result</span> = <span class="r379 r">ulValue</span>;
                                <b>return</b> <b>true</b>;
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#f91b842ea6fa4849" class="i field">Decimal</a>:
                            <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#acaa7e986dd8380a" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out decimal</b> <span id="r380 rd" class="r380 r">dm</span>))
                            {
                                <span class="r357 r">result</span> = <span class="r380 r">dm</span>;
                                <b>return</b> <b>true</b>;
                            }
 
                            <b>break</b>;
                        <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#7953909b7f4420a8" class="i field">BigInteger</a>:
                            <span class="r357 r">result</span> = <span class="r370 r">bigValue</span>;
                            <b>return</b> <b>true</b>;
                        <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#a316a1ebc21c5a21" class="i field">None</a>:
                            <span class="c">// Type not specified; fit value into narrowest signed type available, int32 minimum</span>
                            <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#6b23b38eb72b93f0" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out int</b> <span id="r381 rd" class="r381 r">i</span>))
                            {
                                <span class="r357 r">result</span> = <span class="r381 r">i</span>;
                                <b>return</b> <b>true</b>;
                            }
 
                            <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#602fcab7e62015c7" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out long</b> <span id="r382 rd" class="r382 r">lValue</span>))
                            {
                                <span class="r357 r">result</span> = <span class="r382 r">lValue</span>;
                                <b>return</b> <b>true</b>;
                            }
 
                            <span class="c">// Result is too big for anything else; fallback to decimal or double</span>
                            <b>if</b> (<span class="r353 r">format</span> == <a href="#c7287a05d62564a0" class="t t">NumberFormat</a>.<a href="#9984b941fc71be77" class="i field">Decimal</a>)
                            {
                                <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#acaa7e986dd8380a" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out decimal</b> <span id="r383 rd" class="r383 r">dmValue</span>))
                                {
                                    <span class="r357 r">result</span> = <span class="r383 r">dmValue</span>;
                                    <b>return</b> <b>true</b>;
                                }
 
                                <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#1266456bbae7e4dc" class="i method">TryCast</a>(<span class="r370 r">bigValue</span>, <b>out double</b> <span id="r384 rd" class="r384 r">d</span>))
                                {
                                    <span class="r357 r">result</span> = <span class="r384 r">d</span>;
                                    <b>return</b> <b>true</b>;
                                }
                            }
 
                            <span class="c">// Hex or Binary value, too big for generic non-suffixed parsing</span>
                            <span class="r357 r">result</span> = <b>null</b>;
                            <b>return</b> <b>false</b>;
                    }
 
                    <span class="c">// Value cannot be contained in type specified by suffix, or invalid suffix flags.</span>
                    <span class="r357 r">result</span> = <b>null</b>;
                    <b>return</b> <b>false</b>;
                }
                <b>catch</b> (<span class="i">Exception</span>)
                {
                }
            }
 
            <span class="r357 r">result</span> = <b>null</b>;
            <b>return</b> <b>false</b>;
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="ddd2155133c982de" href="../../R/ddd2155133c982de.html" target="n" data-glyph="76,1" class="i method">ScanNumber</a>(<b>char</b> <span id="r385 rd" class="r385 r">firstChar</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r385 r">firstChar</span> == <span class="s">&#39;.&#39;</span> || (<span class="r385 r">firstChar</span> &gt;= <span class="s">&#39;0&#39;</span> &amp;&amp; <span class="r385 r">firstChar</span> &lt;= <span class="s">&#39;9&#39;</span>)
                || (<a href="#cc92b8f58ff56ac5" class="i property">AllowSignedNumbers</a> &amp;&amp; (<span class="r385 r">firstChar</span> == <span class="s">&#39;+&#39;</span> || <span class="r385 r">firstChar</span>.<a href="CharTraits.cs.html#7ecfc2477f403174" class="i method">IsDash</a>())), <span class="s">&quot;Number must start with &#39;.&#39;, &#39;-&#39;, or digit.&quot;</span>);
 
            <b>string</b> <span id="r386 rd" class="r386 r">strNum</span> = <a href="#e97447a899e0e81c" class="i method">ScanNumberHelper</a>(<span class="r385 r">firstChar</span>, <b>out</b> <a href="#c7287a05d62564a0" class="t t">NumberFormat</a> <span id="r387 rd" class="r387 r">format</span>, <b>out</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a> <span id="r388 rd" class="r388 r">suffix</span>, <b>out bool</b> <span id="r389 rd" class="r389 r">real</span>, <b>out long</b> <span id="r390 rd" class="r390 r">multiplier</span>);
 
            <span class="c">// the token is not a number. i.e. 77z.exe</span>
            <b>if</b> (<span class="r386 r">strNum</span> == <b>null</b>)
            {
                <span class="c">// Rescan the characters, this is simpler than keeping track of the suffix, multiplier, and 0x prefix.</span>
                <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> = <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>;
                <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>());
            }
 
            <b>object</b> <span id="r391 rd" class="r391 r">value</span>;
            <b>if</b> (!<span class="i">TryGetNumberValue</span>(<span class="r386 r">strNum</span>, <span class="r387 r">format</span>, <span class="r388 r">suffix</span>, <span class="r389 r">real</span>, <span class="r390 r">multiplier</span>, <b>out</b> <span class="r391 r">value</span>))
            {
                <b>if</b> (!<a href="#39741816bda0c4aa" class="i method">InExpressionMode</a>())
                {
                    <span class="c">// Rescan the characters, this is simpler than keeping track of the dashes and the hex prefix.</span>
                    <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> = <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>;
                    <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>());
                }
 
                <span class="i">ReportError</span>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">BadNumericConstant</span>),
                    <span class="i">ParserStrings</span>.<span class="i">BadNumericConstant</span>,
                    <a href="#0d494c77d31a8678" class="i field">_script</a>.<span class="i">Substring</span>(<a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>, <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>));
            }
 
            <b>return</b> <a href="#8e9151e4fa00b472" class="i method">NewNumberToken</a>(<span class="r391 r">value</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Scans a numeric string to determine its characteristics.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r392 r">firstChar</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The first character.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r393 r">format</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicate if it&#39;s a hex, binary, or decimal number.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r394 r">suffix</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicate the format suffix.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r395 r">real</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicate if the number is real (non-integer).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r396 r">multiplier</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Indicate the specified multiplier.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return null if the token is not a number</span>
        <span class="c">///</span><span class="c"> OR</span>
        <span class="c">///</span><span class="c"> Return the string format of the number.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private string</b> <a id="e97447a899e0e81c" href="../../R/e97447a899e0e81c.html" target="n" data-glyph="76,1" class="i method">ScanNumberHelper</a>(<b>char</b> <span id="r392 rd" class="r392 r">firstChar</span>, <b>out</b> <a href="#c7287a05d62564a0" class="t t">NumberFormat</a> <span id="r393 rd" class="r393 r">format</span>, <b>out</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a> <span id="r394 rd" class="r394 r">suffix</span>, <b>out bool</b> <span id="r395 rd" class="r395 r">real</span>, <b>out long</b> <span id="r396 rd" class="r396 r">multiplier</span>)
        {
            <span class="r393 r">format</span> = <a href="#c7287a05d62564a0" class="t t">NumberFormat</a>.<a href="#9984b941fc71be77" class="i field">Decimal</a>;
            <span class="r394 r">suffix</span> = <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#a316a1ebc21c5a21" class="i field">None</a>;
            <span class="r395 r">real</span> = <b>false</b>;
            <span class="r396 r">multiplier</span> = 1;
 
            <b>bool</b> <span id="r397 rd" class="r397 r">notNumber</span> = <b>false</b>;
            <b>int</b> <span id="r398 rd" class="r398 r">signIndex</span> = -1;
            <b>char</b> <span id="r399 rd" class="r399 r">c</span>;
            <b>var</b> <span id="r400 rd" class="r400 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
 
            <b>if</b> (<span class="r392 r">firstChar</span>.<a href="CharTraits.cs.html#7ecfc2477f403174" class="i method">IsDash</a>() || <span class="r392 r">firstChar</span> == <span class="s">&#39;+&#39;</span>)
            {
                <span class="r400 r">sb</span>.<span class="i">Append</span>(<span class="r392 r">firstChar</span>);
                <span class="r392 r">firstChar</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            }
 
            <b>if</b> (<span class="r392 r">firstChar</span> == <span class="s">&#39;.&#39;</span>)
            {
                <span class="r400 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;.&#39;</span>);
                <a href="#6b4866c5ac56d681" class="i method">ScanNumberAfterDot</a>(<span class="r400 r">sb</span>, <b>ref</b> <span class="r398 r">signIndex</span>, <b>ref</b> <span class="r397 r">notNumber</span>);
                <span class="r395 r">real</span> = <b>true</b>;
            }
            <b>else</b>
            {
                <span class="r399 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                <b>bool</b> <span id="r401 rd" class="r401 r">isHexOrBinary</span> = <span class="r392 r">firstChar</span> == <span class="s">&#39;0&#39;</span> &amp;&amp; (<span class="r399 r">c</span> == <span class="s">&#39;x&#39;</span> || <span class="r399 r">c</span> == <span class="s">&#39;X&#39;</span> || <span class="r399 r">c</span> == <span class="s">&#39;b&#39;</span> || <span class="r399 r">c</span> == <span class="s">&#39;B&#39;</span>);
 
                <b>if</b> (<span class="r401 r">isHexOrBinary</span>)
                {
                    <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
 
                    <b>switch</b> (<span class="r399 r">c</span>)
                    {
                        <b>case</b> <span class="s">&#39;x&#39;</span>:
                        <b>case</b> <span class="s">&#39;X&#39;</span>:
                            <span class="r400 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;0&#39;</span>); <span class="c">// Prepend a 0 to the number before any numeric digits are added</span>
                            <a href="#b3836b57966251ea" class="i method">ScanHexDigits</a>(<span class="r400 r">sb</span>);
                            <b>if</b> (<span class="r400 r">sb</span>.<span class="i">Length</span> == 0)
                            {
                                <span class="r397 r">notNumber</span> = <b>true</b>;
                            }
 
                            <span class="r393 r">format</span> = <a href="#c7287a05d62564a0" class="t t">NumberFormat</a>.<a href="#2e84f234ea8d22d1" class="i field">Hex</a>;
                            <b>break</b>;
                        <b>case</b> <span class="s">&#39;b&#39;</span>:
                        <b>case</b> <span class="s">&#39;B&#39;</span>:
                            <a href="#bec3ebeda50638da" class="i method">ScanBinaryDigits</a>(<span class="r400 r">sb</span>);
                            <b>if</b> (<span class="r400 r">sb</span>.<span class="i">Length</span> == 0)
                            {
                                <span class="r397 r">notNumber</span> = <b>true</b>;
                            }
 
                            <span class="r393 r">format</span> = <a href="#c7287a05d62564a0" class="t t">NumberFormat</a>.<a href="#ece06b9bfb9ceedb" class="i field">Binary</a>;
                            <b>break</b>;
                    }
                }
                <b>else</b>
                {
                    <span class="r400 r">sb</span>.<span class="i">Append</span>(<span class="r392 r">firstChar</span>);
                    <a href="#07ccbfce2ca34bf4" class="i method">ScanDecimalDigits</a>(<span class="r400 r">sb</span>);
                    <span class="r399 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                    <b>switch</b> (<span class="r399 r">c</span>)
                    {
                        <b>case</b> <span class="s">&#39;.&#39;</span>:
                            <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                            <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;.&#39;</span>)
                            {
                                <span class="c">// We just found the range operator, so unget the first dot so</span>
                                <span class="c">// we can stop scanning as a number.</span>
                                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                            }
                            <b>else</b>
                            {
                                <span class="r400 r">sb</span>.<span class="i">Append</span>(<span class="r399 r">c</span>);
                                <span class="r395 r">real</span> = <b>true</b>;
                                <a href="#6b4866c5ac56d681" class="i method">ScanNumberAfterDot</a>(<span class="r400 r">sb</span>, <b>ref</b> <span class="r398 r">signIndex</span>, <b>ref</b> <span class="r397 r">notNumber</span>);
                            }
 
                            <b>break</b>;
                        <b>case</b> <span class="s">&#39;E&#39;</span>:
                        <b>case</b> <span class="s">&#39;e&#39;</span>:
                            <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                            <span class="r400 r">sb</span>.<span class="i">Append</span>(<span class="r399 r">c</span>);
                            <span class="r395 r">real</span> = <b>true</b>;
                            <a href="#64fb5a681f12850b" class="i method">ScanExponent</a>(<span class="r400 r">sb</span>, <b>ref</b> <span class="r398 r">signIndex</span>, <b>ref</b> <span class="r397 r">notNumber</span>);
                            <b>break</b>;
                    }
                }
            }
 
            <span class="r399 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
            <b>if</b> (<span class="r399 r">c</span>.<a href="CharTraits.cs.html#c4f112696fab578a" class="i method">IsTypeSuffix</a>())
            {
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <b>switch</b> (<span class="r399 r">c</span>)
                {
                    <b>case</b> <span class="s">&#39;u&#39;</span>:
                    <b>case</b> <span class="s">&#39;U&#39;</span>:
                        <span class="r394 r">suffix</span> |= <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#379c3e532c488690" class="i field">Unsigned</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;s&#39;</span>:
                    <b>case</b> <span class="s">&#39;S&#39;</span>:
                        <span class="r394 r">suffix</span> |= <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#2c57f28002eed0e4" class="i field">Short</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;l&#39;</span>:
                    <b>case</b> <span class="s">&#39;L&#39;</span>:
                        <span class="r394 r">suffix</span> |= <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#de9fac127152873b" class="i field">Long</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;d&#39;</span>:
                    <b>case</b> <span class="s">&#39;D&#39;</span>:
                        <span class="r394 r">suffix</span> |= <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#f91b842ea6fa4849" class="i field">Decimal</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;y&#39;</span>:
                    <b>case</b> <span class="s">&#39;Y&#39;</span>:
                        <span class="r394 r">suffix</span> |= <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#c9973660084ff789" class="i field">SignedByte</a>;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;n&#39;</span>:
                    <b>case</b> <span class="s">&#39;N&#39;</span>:
                        <span class="r394 r">suffix</span> |= <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#7953909b7f4420a8" class="i field">BigInteger</a>;
                        <b>break</b>;
                    <b>default</b>:
                        <span class="r397 r">notNumber</span> = <b>true</b>;
                        <b>break</b>;
                }
 
                <span class="r399 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
 
                <b>if</b> (<span class="r399 r">c</span>.<a href="CharTraits.cs.html#c4f112696fab578a" class="i method">IsTypeSuffix</a>())
                {
                    <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                    <b>switch</b> (<span class="r394 r">suffix</span>)
                    {
                        <b>case</b> <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#379c3e532c488690" class="i field">Unsigned</a>:
                            <b>switch</b> (<span class="r399 r">c</span>)
                            {
                                <b>case</b> <span class="s">&#39;l&#39;</span>:
                                <b>case</b> <span class="s">&#39;L&#39;</span>:
                                    <span class="r394 r">suffix</span> |= <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#de9fac127152873b" class="i field">Long</a>;
                                    <b>break</b>;
                                <b>case</b> <span class="s">&#39;s&#39;</span>:
                                <b>case</b> <span class="s">&#39;S&#39;</span>:
                                    <span class="r394 r">suffix</span> |= <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#2c57f28002eed0e4" class="i field">Short</a>;
                                    <b>break</b>;
                                <b>case</b> <span class="s">&#39;y&#39;</span>:
                                <b>case</b> <span class="s">&#39;Y&#39;</span>:
                                    <span class="r394 r">suffix</span> |= <a href="#e31681b07a75f739" class="t t">NumberSuffixFlags</a>.<a href="#c9973660084ff789" class="i field">SignedByte</a>;
                                    <b>break</b>;
                                <b>default</b>:
                                    <span class="r397 r">notNumber</span> = <b>true</b>;
                                    <b>break</b>;
                            }
 
                            <b>break</b>;
                        <b>default</b>:
                            <span class="r397 r">notNumber</span> = <b>true</b>;
                            <b>break</b>;
                    }
 
                    <span class="r399 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                }
            }
 
            <b>if</b> (<span class="r399 r">c</span>.<a href="CharTraits.cs.html#e4b2a2899967d8cb" class="i method">IsMultiplierStart</a>())
            {
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
 
                <b>switch</b> (<span class="r399 r">c</span>)
                {
                    <b>case</b> <span class="s">&#39;k&#39;</span>:
                    <b>case</b> <span class="s">&#39;K&#39;</span>:
                        <span class="r396 r">multiplier</span> = 1024;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;m&#39;</span>:
                    <b>case</b> <span class="s">&#39;M&#39;</span>:
                        <span class="r396 r">multiplier</span> = 1024 * 1024;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;g&#39;</span>:
                    <b>case</b> <span class="s">&#39;G&#39;</span>:
                        <span class="r396 r">multiplier</span> = 1024 * 1024 * 1024;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;t&#39;</span>:
                    <b>case</b> <span class="s">&#39;T&#39;</span>:
                        <span class="r396 r">multiplier</span> = 1024L * 1024 * 1024 * 1024;
                        <b>break</b>;
                    <b>case</b> <span class="s">&#39;p&#39;</span>:
                    <b>case</b> <span class="s">&#39;P&#39;</span>:
                        <span class="r396 r">multiplier</span> = 1024L * 1024 * 1024 * 1024 * 1024;
                        <b>break</b>;
                }
 
                <b>char</b> <span id="r402 rd" class="r402 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                <b>if</b> (<span class="r402 r">c1</span> == <span class="s">&#39;b&#39;</span> || <span class="r402 r">c1</span> == <span class="s">&#39;B&#39;</span>)
                {
                    <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                    <span class="r399 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                }
                <b>else</b>
                {
                    <span class="r397 r">notNumber</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (!<span class="r399 r">c</span>.<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>())
            {
                <b>if</b> (!<a href="#39741816bda0c4aa" class="i method">InExpressionMode</a>() || !<span class="r399 r">c</span>.<a href="CharTraits.cs.html#ef0d71c9d49fe671" class="i method">ForceStartNewTokenAfterNumber</a>(<a href="#0259572152f59499" class="i property">ForceEndNumberOnTernaryOpChars</a>))
                {
                    <span class="r397 r">notNumber</span> = <b>true</b>;
                }
            }
 
            <b>if</b> (<span class="r397 r">notNumber</span>)
            {
                <a href="#7802c95baba16dea" class="i method">Release</a>(<span class="r400 r">sb</span>);
                <b>return</b> <b>null</b>;
            }
 
            <span class="c">// TryParse won&#39;t accept odd dashes for a sign, so replace them.</span>
            <b>if</b> (<span class="r398 r">signIndex</span> != -1 &amp;&amp; <span class="r400 r">sb</span>[<span class="r398 r">signIndex</span>] != <span class="s">&#39;-&#39;</span> &amp;&amp; <span class="r400 r">sb</span>[<span class="r398 r">signIndex</span>].<span class="i">IsDash</span>())
            {
                <span class="r400 r">sb</span>[<span class="r398 r">signIndex</span>] = <span class="s">&#39;-&#39;</span>;
            }
 
            <b>if</b> (<span class="r400 r">sb</span>[0] != <span class="s">&#39;-&#39;</span> &amp;&amp; <span class="r400 r">sb</span>[0].<span class="i">IsDash</span>())
            {
                <span class="r400 r">sb</span>[0] = <span class="s">&#39;-&#39;</span>;
            }
 
            <b>return</b> <a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r400 r">sb</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Numbers
 
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="3af92499058b9e05" href="../../R/3af92499058b9e05.html" target="n" data-glyph="74,1" class="i method">GetMemberAccessOperator</a>(<b>bool</b> <span id="r403 rd" class="r403 r">allowLBracket</span>)
        {
            <span class="c">// No skipping whitespace here - whitespace isn&#39;t allowed before member access operators.</span>
            <span class="c">// We do skip multi-line comments though, they are allowed (mostly for backwards compatibility.)</span>
 
            <b>char</b> <span id="r404 rd" class="r404 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
 
            <b>while</b> (<span class="r404 r">c</span> == <span class="s">&#39;&lt;&#39;</span>)
            {
                <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;#&#39;</span>)
                {
                    <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                    <a href="#bf5ffcaeeca02d3d" class="i method">ScanBlockComment</a>();
                    <span class="r404 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                }
                <b>else</b>
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <b>return</b> <b>null</b>;
                }
            }
 
            <b>if</b> (<span class="r404 r">c</span> == <span class="s">&#39;.&#39;</span>)
            {
                <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <span class="r404 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                <b>if</b> (<span class="r404 r">c</span> != <span class="s">&#39;.&#39;</span>)
                {
                    <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; (<span class="r404 r">c</span>.<a href="CharTraits.cs.html#66538dacee9a61db" class="i method">IsWhitespace</a>() || <span class="r404 r">c</span> == <span class="s">&#39;\0&#39;</span> || <span class="r404 r">c</span> == <span class="s">&#39;\r&#39;</span> || <span class="r404 r">c</span> == <span class="s">&#39;\n&#39;</span>))
                    {
                        <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        <b>return</b> <b>null</b>;
                    }
 
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9023444a1ee3a84" class="i field">Dot</a>);
                }
 
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r404 r">c</span> == <span class="s">&#39;:&#39;</span>)
            {
                <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <span class="r404 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                <b>if</b> (<span class="r404 r">c</span> == <span class="s">&#39;:&#39;</span>)
                {
                    <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                    <span class="r404 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                    <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; (<span class="r404 r">c</span>.<a href="CharTraits.cs.html#66538dacee9a61db" class="i method">IsWhitespace</a>() || <span class="r404 r">c</span> == <span class="s">&#39;\0&#39;</span> || <span class="r404 r">c</span> == <span class="s">&#39;\r&#39;</span> || <span class="r404 r">c</span> == <span class="s">&#39;\n&#39;</span>))
                    {
                        <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        <b>return</b> <b>null</b>;
                    }
 
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ba396ba04fe0fde5" class="i field">ColonColon</a>);
                }
 
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r404 r">c</span> == <span class="s">&#39;[&#39;</span> &amp;&amp; <span class="r403 r">allowLBracket</span>)
            {
                <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>);
            }
 
            <b>if</b> (<span class="r404 r">c</span> == <span class="s">&#39;?&#39;</span>)
            {
                <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <span class="r404 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                <b>if</b> (<span class="r404 r">c</span> == <span class="s">&#39;.&#39;</span>)
                {
                    <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#97da13a8bbbf83e2" class="i field">QuestionDot</a>);
                }
                <b>else</b> <b>if</b> (<span class="r404 r">c</span> == <span class="s">&#39;[&#39;</span> &amp;&amp; <span class="r403 r">allowLBracket</span>)
                {
                    <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ccf850170f25476f" class="i field">QuestionLBracket</a>);
                }
 
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="554579c509994635" href="../../R/554579c509994635.html" target="n" data-glyph="74,1" class="i method">GetInvokeMemberOpenParen</a>()
        {
            <span class="c">// No skipping whitespace here - whitespace isn&#39;t allowed before the open paren of a function invocation.</span>
            <b>var</b> <span id="r405 rd" class="r405 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
            <b>if</b> (<span class="r405 r">c</span> == <span class="s">&#39;(&#39;</span>)
            {
                <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>);
            }
 
            <b>if</b> (<span class="r405 r">c</span> == <span class="s">&#39;{&#39;</span>)
            {
                <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="68cf8b1df706f946" href="../../R/68cf8b1df706f946.html" target="n" data-glyph="74,1" class="i method">GetLBracket</a>()
        {
            <span class="c">// We know we want a &#39;[&#39; token or no token.  We are in a context where we expect an attribute/type constraint</span>
            <span class="c">// and allow any whitespace/comments before the &#39;[&#39;, but nothing else (the caller has already skipped newlines</span>
            <span class="c">// if appropriate.)  This is handled specially because in command mode, a generic token may begin with &#39;[&#39;, but</span>
            <span class="c">// we don&#39;t want anything more than the &#39;[&#39;.</span>
 
            <span class="c">// Remember where we started.  In some rare cases, we may need to sync back to make things a little</span>
            <span class="c">// simpler in the parser.</span>
 
            <b>int</b> <span id="r406 rd" class="r406 r">resyncPoint</span> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
            <b>bool</b> <span id="r407 rd" class="r407 r">resyncIfMemberAccess</span> = <b>false</b>;
        <span class="i">again</span>:
            <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
            <b>char</b> <span id="r408 rd" class="r408 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            <b>switch</b> (<span class="r408 r">c</span>)
            {
                <b>case</b> <span class="s">&#39; &#39;</span>:
                <b>case</b> <span class="s">&#39;\t&#39;</span>:
                <b>case</b> <span class="s">&#39;\f&#39;</span>:
                <b>case</b> <span class="s">&#39;\v&#39;</span>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#21979a64c5c53fa4" class="i field">NoBreakSpace</a>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#e30fed19a6ee2568" class="i field">NextLine</a>:
                    <span class="r407 r">resyncIfMemberAccess</span> = <b>true</b>;
                    <a href="#b561da6fab4d3e94" class="i method">SkipWhiteSpace</a>();
                    <b>goto</b> <span class="i">again</span>;
 
                <b>case</b> <span class="s">&#39;#&#39;</span>:
                    <span class="r407 r">resyncIfMemberAccess</span> = <b>true</b>;
                    <a href="#01c15cab0ce827be" class="i method">ScanLineComment</a>();
                    <b>goto</b> <span class="i">again</span>;
 
                <b>case</b> <span class="s">&#39;&lt;&#39;</span>:
                    <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;#&#39;</span>)
                    {
                        <span class="c">// We resync if we find any whitespace, but only if the whitespace occurs after a</span>
                        <span class="c">// multi-line comment (rationale: backwards compatibility.)</span>
                        <span class="r407 r">resyncIfMemberAccess</span> = <b>false</b>;
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <a href="#bf5ffcaeeca02d3d" class="i method">ScanBlockComment</a>();
                        <b>goto</b> <span class="i">again</span>;
                    }
 
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <b>break</b>;
 
                <b>case</b> <span class="s">&#39;[&#39;</span>:
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>);
 
                <b>case</b> <span class="s">&#39;.&#39;</span>:
                <b>case</b> <span class="s">&#39;:&#39;</span>:
                    <span class="c">// We don&#39;t call resync here unless we might have a member access token, in which case</span>
                    <span class="c">// we want to rescan the comments to ensure there is no whitespace between the expression</span>
                    <span class="c">// and the member access token.  The resync here should rarely do much other than move</span>
                    <span class="c">// the _currentIndex because there will rarely be any comment tokens after the closing &#39;]&#39;</span>
                    <span class="c">// in an attribute and the member access token.</span>
                    <b>if</b> (<span class="r407 r">resyncIfMemberAccess</span>)
                    {
                        <a href="#63c4980d7eb834ea" class="i method">Resync</a>(<span class="r406 r">resyncPoint</span>);
                    }
                    <b>else</b>
                    {
                        <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    }
 
                    <b>break</b>;
 
                <b>default</b>:
                    <b>if</b> (<span class="r408 r">c</span>.<a href="CharTraits.cs.html#66538dacee9a61db" class="i method">IsWhitespace</a>())
                    {
                        <span class="r407 r">resyncIfMemberAccess</span> = <b>true</b>;
                        <a href="#b561da6fab4d3e94" class="i method">SkipWhiteSpace</a>();
                        <b>goto</b> <span class="i">again</span>;
                    }
 
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <b>break</b>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="35298b93cdc9f7dc" href="../../R/35298b93cdc9f7dc.html" target="n" data-glyph="76,1" class="i method">ScanDot</a>()
        {
            <b>char</b> <span id="r409 rd" class="r409 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
            <b>if</b> (<span class="r409 r">c</span> == <span class="s">&#39;.&#39;</span>)
            {
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <span class="r409 r">c</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; !<span class="r409 r">c</span>.<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>())
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();  <span class="c">// Unget the second dot, let ScanGenericToken consume it.</span>
                    <b>return</b> <a href="#a09d4027e4467cf2" class="i method">ScanGenericToken</a>(<span class="s">&#39;.&#39;</span>);
                }
 
                <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7e27eae9f0abe570" class="i field">DotDot</a>);
            }
 
            <b>if</b> (<span class="r409 r">c</span>.<a href="CharTraits.cs.html#9aa2253860d75a43" class="i method">IsDecimalDigit</a>())
            {
                <b>return</b> <a href="#ddd2155133c982de" class="i method">ScanNumber</a>(<span class="s">&#39;.&#39;</span>);
            }
 
            <span class="c">// The following are all dotting commands, not a command starting with dot:</span>
            <span class="c">//     .$command</span>
            <span class="c">//     .&quot;command with spaces&quot;</span>
            <span class="c">//     .&#39;command with spaces&#39;</span>
            <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; !<span class="r409 r">c</span>.<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>() &amp;&amp; <span class="r409 r">c</span> != <span class="s">&#39;$&#39;</span> &amp;&amp; <span class="r409 r">c</span> != <span class="s">&#39;&quot;&#39;</span> &amp;&amp; <span class="r409 r">c</span> != <span class="s">&#39;\&#39;&#39;</span>)
            {
                <b>return</b> <a href="#a09d4027e4467cf2" class="i method">ScanGenericToken</a>(<span class="s">&#39;.&#39;</span>);
            }
 
            <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9023444a1ee3a84" class="i field">Dot</a>);
        }
 
        <span class="c">// The first character is an ascii letter.  We could be scanning a keyword,</span>
        <span class="c">// a command name or argument, or a method or property name.</span>
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="28030d2d334c063a" href="../../R/28030d2d334c063a.html" target="n" data-glyph="76,1" class="i method">ScanIdentifier</a>(<b>char</b> <span id="r410 rd" class="r410 r">firstChar</span>)
        {
            <b>var</b> <span id="r411 rd" class="r411 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
            <b>char</b> <span id="r412 rd" class="r412 r">c</span>;
            <span class="r411 r">sb</span>.<span class="i">Append</span>(<span class="r410 r">firstChar</span>);
 
            <b>while</b> (<b>true</b>)
            {
                <span class="r412 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
                <b>if</b> (<span class="r412 r">c</span>.<a href="CharTraits.cs.html#ddc89dd7c4d780d5" class="i method">IsIdentifierFollow</a>())
                {
                    <span class="r411 r">sb</span>.<span class="i">Append</span>(<span class="r412 r">c</span>);
                }
                <b>else</b>
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <b>break</b>;
                }
            }
 
            <span class="c">// In typename mode, we want, well, typenames.</span>
            <b>if</b> (<a href="#6ff55ab34ff1c275" class="i method">InTypeNameMode</a>())
            {
                <a href="#7802c95baba16dea" class="i method">Release</a>(<span class="r411 r">sb</span>);
                <b>return</b> <a href="#38651795dbb38829" class="i method">ScanTypeName</a>();
            }
 
            <span class="c">// In expression mode, we only want simple identifiers so we&#39;re done,</span>
            <span class="c">// but in command mode, we keep scanning if the current character</span>
            <span class="c">// doesn&#39;t terminate the token.</span>
            <b>if</b> (!<a href="#8103814d5a556488" class="i property">WantSimpleName</a> &amp;&amp; <a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; !<span class="r412 r">c</span>.<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>())
            {
                <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<span class="r411 r">sb</span>);
            }
 
            <b>if</b> (!<a href="#8103814d5a556488" class="i property">WantSimpleName</a> &amp;&amp; (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() || <a href="#618efa2aea96ae23" class="i method">InSignatureMode</a>()))
            {
                <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r413 rd" class="r413 r">tokenKind</span>;
                <b>var</b> <span id="r414 rd" class="r414 r">ident</span> = <a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r411 r">sb</span>);
                <span class="r411 r">sb</span> = <b>null</b>;
                <b>if</b> (<a href="#73147b47cbee6e76" class="i field">s_keywordTable</a>.<span class="i">TryGetValue</span>(<span class="r414 r">ident</span>, <b>out</b> <span class="r413 r">tokenKind</span>))
                {
                    <b>if</b> (<span class="r413 r">tokenKind</span> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7002a360506192c2" class="i field">InlineScript</a> || <a href="#73ba79aabc0d9f2b" class="i property">InWorkflowContext</a>)
                        <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<span class="r413 r">tokenKind</span>);
                }
 
                <b>if</b> (<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="#2af1cc3c0788237c" class="i method">ContainsKeyword</a>(<span class="r414 r">ident</span>) &amp;&amp; !<a href="#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="#7e4c6e6aaae4a0c3" class="i method">IsHiddenKeyword</a>(<span class="r414 r">ident</span>))
                {
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e7868dd662d25e11" class="i field">DynamicKeyword</a>);
                }
            }
 
            <b>if</b> (<span class="r411 r">sb</span> != <b>null</b>)
                <a href="#7802c95baba16dea" class="i method">Release</a>(<span class="r411 r">sb</span>);
            <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Type Names
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="38651795dbb38829" href="../../R/38651795dbb38829.html" target="n" data-glyph="76,1" class="i method">ScanTypeName</a>()
        {
            <b>while</b> (<b>true</b>)
            {
                <b>char</b> <span id="r415 rd" class="r415 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
                <b>switch</b> (<span class="r415 r">c</span>)
                {
                    <b>case</b> <span class="s">&#39;.&#39;</span>:
                    <b>case</b> <span class="s">&#39;`&#39;</span>:
                    <b>case</b> <span class="s">&#39;_&#39;</span>:
                    <b>case</b> <span class="s">&#39;+&#39;</span>:
                    <b>case</b> <span class="s">&#39;#&#39;</span>:
                    <b>case</b> <span class="s">&#39;\\&#39;</span>:
                        <b>continue</b>;
                    <b>default</b>:
                        <b>if</b> (<b>char</b>.<span class="i">IsLetterOrDigit</span>(<span class="r415 r">c</span>))
                        {
                            <b>continue</b>;
                        }
 
                        <b>break</b>;
                }
 
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                <b>break</b>;
            }
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r416 rd" class="r416 r">result</span> = <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a>);
            <span class="r416 r">result</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> |= <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#5f165a9a05394b87" class="i field">TypeName</a>;
            <b>return</b> <span class="r416 r">result</span>;
        }
 
        <b>private void</b> <a id="5d69bf9401d881c8" href="../../R/5d69bf9401d881c8.html" target="n" data-glyph="76,1" class="i method">ScanAssemblyNameSpecToken</a>(<span class="i">StringBuilder</span> <span id="r417 rd" class="r417 r">sb</span>)
        {
            <span class="c">// Whitespace, &#39;,&#39;, &#39;=&#39;, &#39;]&#39;, and newlines terminate a token.</span>
 
            <a href="#b561da6fab4d3e94" class="i method">SkipWhiteSpace</a>();
 
            <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
            <b>while</b> (<b>true</b>)
            {
                <b>char</b> <span id="r418 rd" class="r418 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
                <b>if</b> (<span class="r418 r">c</span>.<a href="CharTraits.cs.html#5169026447b5e3fe" class="i method">ForceStartNewTokenInAssemblyNameSpec</a>())
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <b>break</b>;
                }
 
                <span class="r417 r">sb</span>.<span class="i">Append</span>(<span class="r418 r">c</span>);
            }
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r419 rd" class="r419 r">token</span> = <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a>);
            <span class="r419 r">token</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> |= <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#5f165a9a05394b87" class="i field">TypeName</a>;
            <a href="#b561da6fab4d3e94" class="i method">SkipWhiteSpace</a>();
        }
 
        <b>internal string</b> <a id="a322ff38d3963f0c" href="../../R/a322ff38d3963f0c.html" target="n" data-glyph="74,1" class="i method">GetAssemblyNameSpec</a>()
        {
            <span class="c">// G  assembly-name-spec:</span>
            <span class="c">// G      assembly-name</span>
            <span class="c">// G      assembly-name   &#39;,&#39;   assembly-properties</span>
            <span class="c">// G  assembly-name:</span>
            <span class="c">// G      assembly-token</span>
            <span class="c">// G  assembly-properties:</span>
            <span class="c">// G      assembly-property</span>
            <span class="c">// G      assembly-properties   &#39;,&#39;   assembly-property</span>
            <span class="c">// G  assembly-property:</span>
            <span class="c">// G      assembly-property-name   &#39;=&#39;   assembly-property-value</span>
            <span class="c">// G  assembly-property-name:  one of</span>
            <span class="c">// G      &#39;Version&#39;</span>
            <span class="c">// G      &#39;PublicKey&#39;</span>
            <span class="c">// G      &#39;PublicKeyToken&#39;</span>
            <span class="c">// G      &#39;Culture&#39;</span>
            <span class="c">// G      &#39;Custom&#39;</span>
            <span class="c">// G  assembly-property:</span>
            <span class="c">// G      assembly-token</span>
            <span class="c">// G  assembly-token:</span>
            <span class="c">// G      any sequence of characters not ending in whitespace, newlines, &#39;,&#39;, &#39;=&#39;, or &#39;]&#39;.</span>
 
            <span class="c">// The above grammar is specified by the CLR (except assembly-token).  We defer validation to the CLR, but</span>
            <span class="c">// use the above grammar to collect the name of the assembly.</span>
 
            <b>var</b> <span id="r420 rd" class="r420 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
 
            <span class="c">// Assembly name first, followed by optional properties.</span>
            <a href="#5d69bf9401d881c8" class="i method">ScanAssemblyNameSpecToken</a>(<span class="r420 r">sb</span>);
 
            <b>while</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;,&#39;</span>)
            {
                <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
                <span class="r420 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>);
 
                <a href="#5d69bf9401d881c8" class="i method">ScanAssemblyNameSpecToken</a>(<span class="r420 r">sb</span>);
                <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;=&#39;</span>)
                {
                    <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
                    <span class="r420 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;=&#39;</span>);
                    <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                    <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d78e08594ff6b79a" class="i field">Equals</a>);
                    <a href="#5d69bf9401d881c8" class="i method">ScanAssemblyNameSpecToken</a>(<span class="r420 r">sb</span>);
                }
                <span class="c">// else error?</span>
            }
 
            <b>return</b> <a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r420 r">sb</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Type Names
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="3f29a48f1f6996cb" href="../../R/3f29a48f1f6996cb.html" target="n" data-glyph="76,1" class="i method">ScanLabel</a>()
        {
            <b>var</b> <span id="r421 rd" class="r421 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
 
            <b>char</b> <span id="r422 rd" class="r422 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            <b>if</b> (!<span class="r422 r">c</span>.<a href="CharTraits.cs.html#3da65727cac30c4f" class="i method">IsIdentifierStart</a>())
            {
                <span class="c">// Must be a generic token then</span>
                <span class="r421 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;:&#39;</span>);
                <b>if</b> (<span class="r422 r">c</span> == <span class="s">&#39;\0&#39;</span>)
                {
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <b>return</b> <a href="#9bf18f9cffdfc216" class="i method">NewGenericToken</a>(<a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r421 r">sb</span>));
                }
 
                <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<span class="r421 r">sb</span>);
            }
 
            <b>while</b> (<span class="r422 r">c</span>.<a href="CharTraits.cs.html#ddc89dd7c4d780d5" class="i method">IsIdentifierFollow</a>())
            {
                <span class="r421 r">sb</span>.<span class="i">Append</span>(<span class="r422 r">c</span>);
                <span class="r422 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            }
 
            <span class="c">// In command mode, we keep scanning if the current character</span>
            <span class="c">// doesn&#39;t terminate the token.</span>
            <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; !<span class="r422 r">c</span>.<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>())
            {
                <span class="r421 r">sb</span>.<span class="i">Insert</span>(0, <span class="s">&#39;:&#39;</span>);
                <span class="r421 r">sb</span>.<span class="i">Append</span>(<span class="r422 r">c</span>);
                <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<span class="r421 r">sb</span>);
            }
 
            <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
            <b>return</b> <a href="#6298a82760151fba" class="i method">NewLabelToken</a>(<a href="#b38ed6a5a1dd9bb7" class="i method">GetStringAndRelease</a>(<span class="r421 r">sb</span>));
        }
 
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="afe5746238887d1f" href="../../R/afe5746238887d1f.html" target="n" data-glyph="74,1" class="i method">NextToken</a>()
        {
            <b>char</b> <span id="r423 rd" class="r423 r">c1</span>;
 
        <span class="i">again</span>:
            <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> = <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>;
            <b>char</b> <span id="r424 rd" class="r424 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
            <b>switch</b> (<span class="r424 r">c</span>)
            {
                <b>case</b> <span class="s">&#39; &#39;</span>:
                <b>case</b> <span class="s">&#39;\t&#39;</span>:
                <b>case</b> <span class="s">&#39;\f&#39;</span>:
                <b>case</b> <span class="s">&#39;\v&#39;</span>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#21979a64c5c53fa4" class="i field">NoBreakSpace</a>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#e30fed19a6ee2568" class="i field">NextLine</a>:
                    <a href="#b561da6fab4d3e94" class="i method">SkipWhiteSpace</a>();
                    <b>goto</b> <span class="i">again</span>;
 
                <b>case</b> <span class="s">&#39;\&#39;&#39;</span>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#37d4552d6f6b71b8" class="i field">QuoteSingleLeft</a>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#0657e636cbc8d3b3" class="i field">QuoteSingleRight</a>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#a146d94e822b7f44" class="i field">QuoteSingleBase</a>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#aa260f61c9b57e5a" class="i field">QuoteReversed</a>:
                    <b>return</b> <a href="#e7d69b728f1adf04" class="i method">ScanStringLiteral</a>();
 
                <b>case</b> <span class="s">&#39;&quot;&#39;</span>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#6749fb0434683e1c" class="i field">QuoteDoubleLeft</a>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#4c212a52dfd2ded6" class="i field">QuoteDoubleRight</a>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#8ee35cea65b6cbb9" class="i field">QuoteLowDoubleLeft</a>:
                    <b>return</b> <a href="#b29f1c5c1c905246" class="i method">ScanStringExpandable</a>();
 
                <b>case</b> <span class="s">&#39;@&#39;</span>:
                    <span class="c">// Could be start of hash literal, array operator, multi-line string, splatted variable</span>
                    <span class="r423 r">c1</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;{&#39;</span>)
                    {
                        <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ad46aed3b80ba825" class="i field">AtCurly</a>);
                    }
 
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;(&#39;</span>)
                    {
                        <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#cf388c7cb0667161" class="i field">AtParen</a>);
                    }
 
                    <b>if</b> (<span class="r423 r">c1</span>.<a href="CharTraits.cs.html#b40a10af036c9eeb" class="i method">IsSingleQuote</a>())
                    {
                        <b>return</b> <a href="#2418625acf039188" class="i method">ScanHereStringLiteral</a>();
                    }
 
                    <b>if</b> (<span class="r423 r">c1</span>.<a href="CharTraits.cs.html#07f0a28c4f50e364" class="i method">IsDoubleQuote</a>())
                    {
                        <b>return</b> <a href="#d3f67fcfa3844895" class="i method">ScanHereStringExpandable</a>();
                    }
 
                    <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                    <b>if</b> (<span class="r423 r">c1</span>.<a href="CharTraits.cs.html#7fd21417f3842df0" class="i method">IsVariableStart</a>())
                    {
                        <b>return</b> <a href="#82e9bcbd128cc0c9" class="i method">ScanVariable</a>(<b>true</b>, <b>false</b>);
                    }
 
                    <span class="i">ReportError</span>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> - 1,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnrecognizedToken</span>),
                        <span class="i">ParserStrings</span>.<span class="i">UnrecognizedToken</span>);
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a>);
 
                <b>case</b> <span class="s">&#39;#&#39;</span>:
                    <a href="#01c15cab0ce827be" class="i method">ScanLineComment</a>();
                    <b>goto</b> <span class="i">again</span>;
 
                <b>case</b> <span class="s">&#39;\n&#39;</span>:
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a>);
 
                <b>case</b> <span class="s">&#39;\r&#39;</span>:
                    <a href="#236716b27b254929" class="i method">NormalizeCRLF</a>(<span class="r424 r">c</span>);
                    <b>goto</b> <b>case</b> <span class="s">&#39;\n&#39;</span>;
 
                <b>case</b> <span class="s">&#39;`&#39;</span>:
                    <span class="r423 r">c1</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;\r&#39;</span>)
                    {
                        <a href="#236716b27b254929" class="i method">NormalizeCRLF</a>(<span class="r423 r">c1</span>);
                    }
 
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;\n&#39;</span> || <span class="r423 r">c1</span> == <span class="s">&#39;\r&#39;</span>)
                    {
                        <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#756695ee247bdc4d" class="i field">LineContinuation</a>);
                        <b>goto</b> <span class="i">again</span>;
                    }
 
                    <b>if</b> (<b>char</b>.<span class="i">IsWhiteSpace</span>(<span class="r423 r">c1</span>))
                    {
                        <a href="#b561da6fab4d3e94" class="i method">SkipWhiteSpace</a>();
                        <b>goto</b> <span class="i">again</span>;
                    }
 
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;\0&#39;</span> &amp;&amp; <a href="#91d350b0c4e63776" class="i method">AtEof</a>())
                    {
                        <span class="i">ReportIncompleteInput</span>(<a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">IncompleteString</span>),
                            <span class="i">ParserStrings</span>.<span class="i">IncompleteString</span>);
 
                        <span class="c">// Unget the EOF so we can return an EOF token.</span>
                        <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        <b>goto</b> <span class="i">again</span>;
                    }
 
                    <span class="r424 r">c</span> = <a href="#097173370ab63237" class="i method">Backtick</a>(<span class="r423 r">c1</span>, <b>out char</b> <span id="r425 rd" class="r425 r">surrogateCharacter</span>);
                    <b>return</b> <a href="#ec0759647513e69f" class="i method">ScanGenericToken</a>(<span class="r424 r">c</span>, <span class="r425 r">surrogateCharacter</span>);
 
                <b>case</b> <span class="s">&#39;=&#39;</span>:
                    <b>return</b> <a href="#030bd055c04a0c09" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d78e08594ff6b79a" class="i field">Equals</a>);
 
                <b>case</b> <span class="s">&#39;+&#39;</span>:
                    <span class="r423 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;+&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>return</b> <a href="#e1c8d6814ceade41" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <span class="r423 r">c1</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#93a18b78948c1c09" class="i field">PlusPlus</a>);
                    }
 
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;=&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>return</b> <a href="#e1c8d6814ceade41" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <span class="r423 r">c1</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f6d4a910265412a7" class="i field">PlusEquals</a>);
                    }
 
                    <b>if</b> (<a href="#cc92b8f58ff56ac5" class="i property">AllowSignedNumbers</a> &amp;&amp; (<b>char</b>.<span class="i">IsDigit</span>(<span class="r423 r">c1</span>) || <span class="r423 r">c1</span> == <span class="s">&#39;.&#39;</span>))
                    {
                        <b>return</b> <a href="#ddd2155133c982de" class="i method">ScanNumber</a>(<span class="r424 r">c</span>);
                    }
 
                    <b>return</b> <a href="#030bd055c04a0c09" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#28a6ab38fe6894ea" class="i field">Plus</a>);
 
                <b>case</b> <span class="s">&#39;-&#39;</span>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#ef9ac06e401a673c" class="i field">EmDash</a>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#aa627aed80250005" class="i field">EnDash</a>:
                <b>case</b> <a href="CharTraits.cs.html#fea06244aa67c768" class="t t">SpecialChars</a>.<a href="CharTraits.cs.html#e57620788a73961c" class="i field">HorizontalBar</a>:
                    <span class="r423 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                    <b>if</b> (<span class="r423 r">c1</span>.<a href="CharTraits.cs.html#7ecfc2477f403174" class="i method">IsDash</a>())
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>return</b> <a href="#e1c8d6814ceade41" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <span class="r423 r">c1</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3d9a9ff2e958417f" class="i field">MinusMinus</a>);
                    }
 
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;=&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>return</b> <a href="#e1c8d6814ceade41" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <span class="r423 r">c1</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#dcd923ca24260759" class="i field">MinusEquals</a>);
                    }
 
                    <b>if</b> (<b>char</b>.<span class="i">IsLetter</span>(<span class="r423 r">c1</span>) || <span class="r423 r">c1</span> == <span class="s">&#39;_&#39;</span> || <span class="r423 r">c1</span> == <span class="s">&#39;?&#39;</span>)
                    {
                        <b>return</b> <a href="#719cc827220e1eeb" class="i method">ScanParameter</a>();
                    }
 
                    <b>if</b> (<a href="#cc92b8f58ff56ac5" class="i property">AllowSignedNumbers</a> &amp;&amp; (<b>char</b>.<span class="i">IsDigit</span>(<span class="r423 r">c1</span>) || <span class="r423 r">c1</span> == <span class="s">&#39;.&#39;</span>))
                    {
                        <b>return</b> <a href="#ddd2155133c982de" class="i method">ScanNumber</a>(<span class="r424 r">c</span>);
                    }
 
                    <b>return</b> <a href="#030bd055c04a0c09" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#069476ae2e7b4442" class="i field">Minus</a>);
 
                <b>case</b> <span class="s">&#39;*&#39;</span>:
                    <span class="r423 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;=&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>return</b> <a href="#e1c8d6814ceade41" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <span class="r423 r">c1</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6c49c2a3b761110c" class="i field">MultiplyEquals</a>);
                    }
 
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;&gt;&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <span class="r423 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                        <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;&gt;&#39;</span>)
                        {
                            <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                            <b>return</b> <a href="#4cd2ad70ec5e15b3" class="i method">NewFileRedirectionToken</a>(0, <span class="r114 r">append</span>: <b>true</b>, <span class="r115 r">fromSpecifiedExplicitly</span>: <b>false</b>);
                        }
 
                        <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;&amp;&#39;</span>)
                        {
                            <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                            <span class="r423 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                            <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;1&#39;</span>)
                            {
                                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                                <b>return</b> <a href="#0bbddb075b59f6d3" class="i method">NewMergingRedirectionToken</a>(0, 1);
                            }
 
                            <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        }
 
                        <b>return</b> <a href="#4cd2ad70ec5e15b3" class="i method">NewFileRedirectionToken</a>(0, <span class="r114 r">append</span>: <b>false</b>, <span class="r115 r">fromSpecifiedExplicitly</span>: <b>false</b>);
                    }
 
                    <b>return</b> <a href="#030bd055c04a0c09" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#79806bba953290ee" class="i field">Multiply</a>);
 
                <b>case</b> <span class="s">&#39;/&#39;</span>:
                    <span class="r423 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;=&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>return</b> <a href="#e1c8d6814ceade41" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <span class="r423 r">c1</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8436da4645d15749" class="i field">DivideEquals</a>);
                    }
 
                    <b>return</b> <a href="#030bd055c04a0c09" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3173796303cdf797" class="i field">Divide</a>);
 
                <b>case</b> <span class="s">&#39;%&#39;</span>:
                    <span class="r423 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;=&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>return</b> <a href="#e1c8d6814ceade41" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <span class="r423 r">c1</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b2b9a8b28974d084" class="i field">RemainderEquals</a>);
                    }
 
                    <b>return</b> <a href="#030bd055c04a0c09" class="i method">CheckOperatorInCommandMode</a>(<span class="r424 r">c</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b338c928ef07e8ea" class="i field">Rem</a>);
 
                <b>case</b> <span class="s">&#39;$&#39;</span>:
                    <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;(&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#daaf3713e66e6f30" class="i field">DollarParen</a>);
                    }
 
                    <b>return</b> <a href="#82e9bcbd128cc0c9" class="i method">ScanVariable</a>(<b>false</b>, <b>false</b>);
 
                <b>case</b> <span class="s">&#39;&lt;&#39;</span>:
                    <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;#&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <a href="#bf5ffcaeeca02d3d" class="i method">ScanBlockComment</a>();
                        <b>goto</b> <span class="i">again</span>;
                    }
 
                    <b>return</b> <a href="#1752cee27dfb804d" class="i method">NewInputRedirectionToken</a>();
 
                <b>case</b> <span class="s">&#39;&gt;&#39;</span>:
                    <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;&gt;&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>return</b> <a href="#4cd2ad70ec5e15b3" class="i method">NewFileRedirectionToken</a>(1, <span class="r114 r">append</span>: <b>true</b>, <span class="r115 r">fromSpecifiedExplicitly</span>: <b>false</b>);
                    }
 
                    <b>return</b> <a href="#4cd2ad70ec5e15b3" class="i method">NewFileRedirectionToken</a>(1, <span class="r114 r">append</span>: <b>false</b>, <span class="r115 r">fromSpecifiedExplicitly</span>: <b>false</b>);
 
                <b>case</b> <span class="s">&#39;a&#39;</span>:
                <b>case</b> <span class="s">&#39;b&#39;</span>:
                <b>case</b> <span class="s">&#39;c&#39;</span>:
                <b>case</b> <span class="s">&#39;d&#39;</span>:
                <b>case</b> <span class="s">&#39;e&#39;</span>:
                <b>case</b> <span class="s">&#39;f&#39;</span>:
                <b>case</b> <span class="s">&#39;g&#39;</span>:
                <b>case</b> <span class="s">&#39;h&#39;</span>:
                <b>case</b> <span class="s">&#39;i&#39;</span>:
                <b>case</b> <span class="s">&#39;j&#39;</span>:
                <b>case</b> <span class="s">&#39;k&#39;</span>:
                <b>case</b> <span class="s">&#39;l&#39;</span>:
                <b>case</b> <span class="s">&#39;m&#39;</span>:
                <b>case</b> <span class="s">&#39;n&#39;</span>:
                <b>case</b> <span class="s">&#39;o&#39;</span>:
                <b>case</b> <span class="s">&#39;p&#39;</span>:
                <b>case</b> <span class="s">&#39;q&#39;</span>:
                <b>case</b> <span class="s">&#39;r&#39;</span>:
                <b>case</b> <span class="s">&#39;s&#39;</span>:
                <b>case</b> <span class="s">&#39;t&#39;</span>:
                <b>case</b> <span class="s">&#39;u&#39;</span>:
                <b>case</b> <span class="s">&#39;v&#39;</span>:
                <b>case</b> <span class="s">&#39;w&#39;</span>:
                <b>case</b> <span class="s">&#39;x&#39;</span>:
                <b>case</b> <span class="s">&#39;y&#39;</span>:
                <b>case</b> <span class="s">&#39;z&#39;</span>:
                <b>case</b> <span class="s">&#39;A&#39;</span>:
                <b>case</b> <span class="s">&#39;B&#39;</span>:
                <b>case</b> <span class="s">&#39;C&#39;</span>:
                <b>case</b> <span class="s">&#39;D&#39;</span>:
                <b>case</b> <span class="s">&#39;E&#39;</span>:
                <b>case</b> <span class="s">&#39;F&#39;</span>:
                <b>case</b> <span class="s">&#39;G&#39;</span>:
                <b>case</b> <span class="s">&#39;H&#39;</span>:
                <b>case</b> <span class="s">&#39;I&#39;</span>:
                <b>case</b> <span class="s">&#39;J&#39;</span>:
                <b>case</b> <span class="s">&#39;K&#39;</span>:
                <b>case</b> <span class="s">&#39;L&#39;</span>:
                <b>case</b> <span class="s">&#39;M&#39;</span>:
                <b>case</b> <span class="s">&#39;N&#39;</span>:
                <b>case</b> <span class="s">&#39;O&#39;</span>:
                <b>case</b> <span class="s">&#39;P&#39;</span>:
                <b>case</b> <span class="s">&#39;Q&#39;</span>:
                <b>case</b> <span class="s">&#39;R&#39;</span>:
                <b>case</b> <span class="s">&#39;S&#39;</span>:
                <b>case</b> <span class="s">&#39;T&#39;</span>:
                <b>case</b> <span class="s">&#39;U&#39;</span>:
                <b>case</b> <span class="s">&#39;V&#39;</span>:
                <b>case</b> <span class="s">&#39;W&#39;</span>:
                <b>case</b> <span class="s">&#39;X&#39;</span>:
                <b>case</b> <span class="s">&#39;Y&#39;</span>:
                <b>case</b> <span class="s">&#39;Z&#39;</span>:
                <b>case</b> <span class="s">&#39;_&#39;</span>:
                    <b>return</b> <a href="#28030d2d334c063a" class="i method">ScanIdentifier</a>(<span class="r424 r">c</span>);
 
                <b>case</b> <span class="s">&#39;(&#39;</span>:
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>);
                <b>case</b> <span class="s">&#39;)&#39;</span>:
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>);
                <b>case</b> <span class="s">&#39;[&#39;</span>:
                    <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; !<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>().<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>())
                    {
                        <b>return</b> <a href="#a09d4027e4467cf2" class="i method">ScanGenericToken</a>(<span class="s">&#39;[&#39;</span>);
                    }
 
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>);
                <b>case</b> <span class="s">&#39;]&#39;</span>:
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>);
                <b>case</b> <span class="s">&#39;{&#39;</span>:
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>);
                <b>case</b> <span class="s">&#39;}&#39;</span>:
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>);
                <b>case</b> <span class="s">&#39;.&#39;</span>:
                    <b>return</b> <a href="#35298b93cdc9f7dc" class="i method">ScanDot</a>();
                <b>case</b> <span class="s">&#39;;&#39;</span>:
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>);
                <b>case</b> <span class="s">&#39;,&#39;</span>:
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>);
 
                <b>case</b> <span class="s">&#39;0&#39;</span>:
                <b>case</b> <span class="s">&#39;7&#39;</span>:
                <b>case</b> <span class="s">&#39;8&#39;</span>:
                <b>case</b> <span class="s">&#39;9&#39;</span>:
                    <b>return</b> <a href="#ddd2155133c982de" class="i method">ScanNumber</a>(<span class="r424 r">c</span>);
 
                <b>case</b> <span class="s">&#39;1&#39;</span>:
                <b>case</b> <span class="s">&#39;2&#39;</span>:
                <b>case</b> <span class="s">&#39;3&#39;</span>:
                <b>case</b> <span class="s">&#39;4&#39;</span>:
                <b>case</b> <span class="s">&#39;5&#39;</span>:
                <b>case</b> <span class="s">&#39;6&#39;</span>:
                    <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;&gt;&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <span class="r423 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                        <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;&gt;&#39;</span>)
                        {
                            <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                            <b>return</b> <span class="i">NewFileRedirectionToken</span>(<span class="r424 r">c</span> - <span class="s">&#39;0&#39;</span>, <span class="i">append</span>: <b>true</b>, <span class="i">fromSpecifiedExplicitly</span>: <b>true</b>);
                        }
 
                        <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;&amp;&#39;</span>)
                        {
                            <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                            <span class="r423 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                            <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;1&#39;</span> || <span class="r423 r">c1</span> == <span class="s">&#39;2&#39;</span>)
                            {
                                <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                                <b>return</b> <span class="i">NewMergingRedirectionToken</span>(<span class="r424 r">c</span> - <span class="s">&#39;0&#39;</span>, <span class="r423 r">c1</span> - <span class="s">&#39;0&#39;</span>);
                            }
 
                            <a href="#af3b8b303cb8fab6" class="i method">UngetChar</a>();
                        }
 
                        <b>return</b> <span class="i">NewFileRedirectionToken</span>(<span class="r424 r">c</span> - <span class="s">&#39;0&#39;</span>, <span class="i">append</span>: <b>false</b>, <span class="i">fromSpecifiedExplicitly</span>: <b>true</b>);
                    }
 
                    <b>return</b> <a href="#ddd2155133c982de" class="i method">ScanNumber</a>(<span class="r424 r">c</span>);
 
                <b>case</b> <span class="s">&#39;&amp;&#39;</span>:
                    <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;&amp;&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#074f3be81f88796f" class="i field">AndAnd</a>);
                    }
 
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ed112ae477a73c36" class="i field">Ampersand</a>);
 
                <b>case</b> <span class="s">&#39;|&#39;</span>:
                    <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;|&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a07cbb74e75a87a" class="i field">OrOr</a>);
                    }
 
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f09193da35fa965b" class="i field">Pipe</a>);
 
                <b>case</b> <span class="s">&#39;!&#39;</span>:
                    <span class="r423 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
                    <b>if</b> ((<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; !<span class="r423 r">c1</span>.<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>()) ||
                        (<a href="#39741816bda0c4aa" class="i method">InExpressionMode</a>() &amp;&amp; <span class="r423 r">c1</span>.<a href="CharTraits.cs.html#3da65727cac30c4f" class="i method">IsIdentifierStart</a>()))
                    {
                        <b>return</b> <a href="#a09d4027e4467cf2" class="i method">ScanGenericToken</a>(<span class="r424 r">c</span>);
                    }
 
                    <b>if</b> (<a href="#39741816bda0c4aa" class="i method">InExpressionMode</a>() &amp;&amp; (<b>char</b>.<span class="i">IsDigit</span>(<span class="r423 r">c1</span>) || <span class="r423 r">c1</span> == <span class="s">&#39;.&#39;</span>))
                    {
                        <span class="c">// check if the next token is actually a number</span>
                        <b>string</b> <span id="r426 rd" class="r426 r">strNum</span> = <a href="#e97447a899e0e81c" class="i method">ScanNumberHelper</a>(<span class="r424 r">c</span>, <b>out _</b>, <b>out _</b>, <b>out _</b>, <b>out _</b>);
                        <span class="c">// rescan characters after the check</span>
                        <a href="#3ba524e6ec6f6c8b" class="i field">_currentIndex</a> = <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a>;
                        <span class="r424 r">c</span> = <a href="#e241596f9f370f6c" class="i method">GetChar</a>();
 
                        <b>if</b> (<span class="r426 r">strNum</span> == <b>null</b>)
                        {
                            <b>return</b> <a href="#a09d4027e4467cf2" class="i method">ScanGenericToken</a>(<span class="r424 r">c</span>);
                        }
                    }
 
                    <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6190040d2f0e7bc3" class="i field">Exclaim</a>);
 
                <b>case</b> <span class="s">&#39;:&#39;</span>:
                    <b>if</b> (<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>() == <span class="s">&#39;:&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>() &amp;&amp; !<a href="#8103814d5a556488" class="i property">WantSimpleName</a> &amp;&amp; !<a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>().<a href="CharTraits.cs.html#86c844f840916fdb" class="i method">ForceStartNewToken</a>())
                        {
                            <b>var</b> <span id="r427 rd" class="r427 r">sb</span> = <a href="#479e3a3f4579df93" class="i method">GetStringBuilder</a>();
                            <span class="r427 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;::&quot;</span>);
                            <b>return</b> <a href="#fc690270657c8c3a" class="i method">ScanGenericToken</a>(<span class="r427 r">sb</span>);
                        }
 
                        <b>return</b> <a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ba396ba04fe0fde5" class="i field">ColonColon</a>);
                    }
 
                    <b>if</b> (<a href="#11a31983df5b2639" class="i method">InCommandMode</a>())
                    {
                        <b>return</b> <a href="#3f29a48f1f6996cb" class="i method">ScanLabel</a>();
                    }
 
                    <b>return</b> <a href="#fac4dc2d20ae0759" class="k">this</a>.<a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a3c2c007e625be62" class="i field">Colon</a>);
 
                <b>case</b> <span class="s">&#39;?&#39;</span> <b>when</b> <a href="#39741816bda0c4aa" class="i method">InExpressionMode</a>():
                    <span class="r423 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
 
                    <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;?&#39;</span>)
                    {
                        <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                        <span class="r423 r">c1</span> = <a href="#fdaab960a2f6bddd" class="i method">PeekChar</a>();
 
                        <b>if</b> (<span class="r423 r">c1</span> == <span class="s">&#39;=&#39;</span>)
                        {
                            <a href="#828671ae3fb1ba5d" class="i method">SkipChar</a>();
                            <b>return</b> <a href="#fac4dc2d20ae0759" class="k">this</a>.<a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1dd8745359c5084d" class="i field">QuestionQuestionEquals</a>);
                        }
 
                        <b>return</b> <a href="#fac4dc2d20ae0759" class="k">this</a>.<a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c1e8f77a51d492eb" class="i field">QuestionQuestion</a>);
                    }
 
                    <b>return</b> <a href="#fac4dc2d20ae0759" class="k">this</a>.<a href="#966a2f468d703303" class="i method">NewToken</a>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#59fc719fefc40227" class="i field">QuestionMark</a>);
 
                <b>case</b> <span class="s">&#39;\0&#39;</span>:
                    <b>if</b> (<a href="#91d350b0c4e63776" class="i method">AtEof</a>())
                    {
                        <b>return</b> <a href="#f7b525e97a9ba50d" class="i method">SaveToken</a>(<b>new</b> <a href="token.cs.html#bdf3e1fce1afd274" class="t constructor">Token</a>(<span class="i">NewScriptExtent</span>(<a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> + 1, <a href="#5bd4253c46df22b0" class="i field">_tokenStart</a> + 1), <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>));
                    }
 
                    <b>return</b> <a href="#a09d4027e4467cf2" class="i method">ScanGenericToken</a>(<span class="r424 r">c</span>);
 
                <b>default</b>:
                    <b>if</b> (<span class="r424 r">c</span>.<a href="CharTraits.cs.html#66538dacee9a61db" class="i method">IsWhitespace</a>())
                    {
                        <a href="#b561da6fab4d3e94" class="i method">SkipWhiteSpace</a>();
                        <b>goto</b> <span class="i">again</span>;
                    }
 
                    <b>if</b> (<b>char</b>.<span class="i">IsLetter</span>(<span class="r424 r">c</span>))
                    {
                        <b>return</b> <a href="#28030d2d334c063a" class="i method">ScanIdentifier</a>(<span class="r424 r">c</span>);
                    }
 
                    <b>return</b> <a href="#a09d4027e4467cf2" class="i method">ScanGenericToken</a>(<span class="r424 r">c</span>);
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
