<!DOCTYPE html>
<html><head><title>SemanticChecks.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(2403);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/parser/SemanticChecks.cs" target="_top">engine\parser\SemanticChecks.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>.<span class="i">Expressions</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Subsystem</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Subsystem</span>.<span class="i n">DSC</span>;
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">DesiredStateConfiguration</span>.<span class="i n">Internal</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>
{
    <b>internal sealed class</b> <a id="20ff17b776f5a22d" href="../../R/20ff17b776f5a22d.html" target="n" data-glyph="2,0" class="t t">SemanticChecks</a> : <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a>, <a href="PreOrderVisitor.cs.html#787ad664e4913a86" class="t t">IAstPostVisitHandler</a>
    {
        <b>private readonly</b> <a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <a id="546ca3508218075d" href="../../R/546ca3508218075d.html" target="n" data-glyph="46,1" class="i field">_parser</a>;
 
        <b>private static readonly</b> <a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a> <a id="880cbf0bcfd99414" href="../../R/880cbf0bcfd99414.html" target="n" data-glyph="46,1" class="i field">s_isConstantAttributeArgVisitor</a> = <b>new</b> <span class="t">IsConstantValueVisitor</span>
        {
            <a href="ConstantValues.cs.html#62950fd764d65202" class="i property">CheckingAttributeArgument</a> = <b>true</b>,
        };
 
        <b>private static readonly</b> <a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a> <a id="e72629617afaab8c" href="../../R/e72629617afaab8c.html" target="n" data-glyph="46,1" class="i field">s_isConstantAttributeArgForClassVisitor</a> = <b>new</b> <span class="t">IsConstantValueVisitor</span>
        {
            <a href="ConstantValues.cs.html#62950fd764d65202" class="i property">CheckingAttributeArgument</a> = <b>true</b>,
            <a href="ConstantValues.cs.html#ffd62840b31d4eae" class="i property">CheckingClassAttributeArguments</a> = <b>true</b>
        };
 
        <b>private readonly</b> <span class="i">Stack</span>&lt;<a href="ast.cs.html#6092492a0585632c" class="t t">MemberAst</a>&gt; <a id="cd856ddc7105c343" href="../../R/cd856ddc7105c343.html" target="n" data-glyph="46,1" class="i field">_memberScopeStack</a>;
        <b>private readonly</b> <span class="i">Stack</span>&lt;<a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a>&gt; <a id="04904f9127a2bdaa" href="../../R/04904f9127a2bdaa.html" target="n" data-glyph="46,1" class="i field">_scopeStack</a>;
 
        <b>internal static void</b> <a id="585e0d8f25cb1d38" href="../../R/585e0d8f25cb1d38.html" target="n" data-glyph="74,1" class="i method">CheckAst</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r0 rd" class="r0 r">parser</span>, <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r1 rd" class="r1 r">ast</span>)
        {
            <a href="#20ff17b776f5a22d" class="t t">SemanticChecks</a> <span id="r2 rd" class="r2 r">semanticChecker</span> = <b>new</b> <a href="#a9f1fe3acb7cf470" class="t constructor">SemanticChecks</a>(<span class="r0 r">parser</span>);
            <span class="r2 r">semanticChecker</span>.<a href="#04904f9127a2bdaa" class="i field">_scopeStack</a>.<span class="i">Push</span>(<span class="r1 r">ast</span>);
            <span class="r1 r">ast</span>.<a href="ast.cs.html#360723934e684b68" class="i method">InternalVisit</a>(<span class="r2 r">semanticChecker</span>);
            <span class="r2 r">semanticChecker</span>.<a href="#04904f9127a2bdaa" class="i field">_scopeStack</a>.<span class="i">Pop</span>();
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r2 r">semanticChecker</span>.<a href="#cd856ddc7105c343" class="i field">_memberScopeStack</a>.<span class="i">Count</span> == 0, <span class="s">&quot;Unbalanced push/pop of member scope stack&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r2 r">semanticChecker</span>.<a href="#04904f9127a2bdaa" class="i field">_scopeStack</a>.<span class="i">Count</span> == 0, <span class="s">&quot;Unbalanced push/pop of scope stack&quot;</span>);
        }
 
        <b>private</b> <a id="a9f1fe3acb7cf470" href="../../R/a9f1fe3acb7cf470.html" target="n" data-glyph="76,1" class="t constructor">SemanticChecks</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r3 rd" class="r3 r">parser</span>)
        {
            <a href="#546ca3508218075d" class="i field">_parser</a> = <span class="r3 r">parser</span>;
            <a href="#cd856ddc7105c343" class="i field">_memberScopeStack</a> = <b>new</b> <span class="i">Stack</span>&lt;<a href="ast.cs.html#6092492a0585632c" class="t t">MemberAst</a>&gt;();
            <a href="#04904f9127a2bdaa" class="i field">_scopeStack</a> = <b>new</b> <span class="i">Stack</span>&lt;<a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a>&gt;();
        }
 
        <b>private bool</b> <a id="756aac413dc7e40c" href="../../R/756aac413dc7e40c.html" target="n" data-glyph="76,1" class="i method">AnalyzingStaticMember</a>()
        {
            <a href="ast.cs.html#6092492a0585632c" class="t t">MemberAst</a> <span id="r4 rd" class="r4 r">currentMember</span>;
            <b>if</b> (<a href="#cd856ddc7105c343" class="i field">_memberScopeStack</a>.<span class="i">Count</span> == 0 || (<span class="r4 r">currentMember</span> = <a href="#cd856ddc7105c343" class="i field">_memberScopeStack</a>.<span class="i">Peek</span>()) == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <a href="ast.cs.html#0c4f2db9a681a977" class="k">var</a> <span id="r5 rd" class="r5 r">fnMemberAst</span> = <span class="r4 r">currentMember</span> <b>as</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>;
            <b>return</b> <span class="r5 r">fnMemberAst</span> != <b>null</b> ? <span class="r5 r">fnMemberAst</span>.<a href="ast.cs.html#d453a785cf1ce2d4" class="i property">IsStatic</a> : ((<a href="ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a>)<span class="r4 r">currentMember</span>).<a href="ast.cs.html#a4fccd8c1d834725" class="i property">IsStatic</a>;
        }
 
        <b>private static bool</b> <a id="7d0ce99493959699" href="../../R/7d0ce99493959699.html" target="n" data-glyph="76,1" class="i method">IsValidAttributeArgument</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r6 rd" class="r6 r">ast</span>, <a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a> <span id="r7 rd" class="r7 r">visitor</span>)
        {
            <b>return</b> (<b>bool</b>)<span class="r6 r">ast</span>.<a href="ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<span class="r7 r">visitor</span>);
        }
 
        <b>private static</b> (<b>string</b> <span class="i">id</span>, <b>string</b> <span class="i">msg</span>) <a id="5f69074147e08173" href="../../R/5f69074147e08173.html" target="n" data-glyph="76,1" class="i method">GetNonConstantAttributeArgErrorExpr</a>(<a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a> <span id="r8 rd" class="r8 r">visitor</span>)
        {
            <b>if</b> (<span class="r8 r">visitor</span>.<a href="ConstantValues.cs.html#ffd62840b31d4eae" class="i property">CheckingClassAttributeArguments</a>)
            {
                <b>return</b> (<b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ParameterAttributeArgumentNeedsToBeConstant</span>),
                    <span class="i">ParserStrings</span>.<span class="i">ParameterAttributeArgumentNeedsToBeConstant</span>);
            }
 
            <b>return</b> (<b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ParameterAttributeArgumentNeedsToBeConstantOrScriptBlock</span>),
                <span class="i">ParserStrings</span>.<span class="i">ParameterAttributeArgumentNeedsToBeConstantOrScriptBlock</span>);
        }
 
        <b>private void</b> <a id="781b1b75e893c0ec" href="../../R/781b1b75e893c0ec.html" target="n" data-glyph="76,1" class="i method">CheckForDuplicateParameters</a>(<span class="i">ReadOnlyCollection</span>&lt;<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <span id="r9 rd" class="r9 r">parameters</span>)
        {
            <b>if</b> (<span class="r9 r">parameters</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r10 rd" class="r10 r">parametersSet</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
                <b>foreach</b> (<b>var</b> <span id="r11 rd" class="r11 r">parameter</span> <b>in</b> <span class="r9 r">parameters</span>)
                {
                    <b>string</b> <span id="r12 rd" class="r12 r">parameterName</span> = <span class="r11 r">parameter</span>.<span class="i">Name</span>.<span class="i">VariablePath</span>.<span class="i">UserPath</span>;
                    <b>if</b> (<span class="r10 r">parametersSet</span>.<span class="i">Contains</span>(<span class="r12 r">parameterName</span>))
                    {
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r11 r">parameter</span>.<span class="i">Name</span>.<span class="i">Extent</span>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DuplicateFormalParameter</span>),
                            <span class="i">ParserStrings</span>.<span class="i">DuplicateFormalParameter</span>,
                            <span class="r12 r">parameterName</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r10 r">parametersSet</span>.<span class="i">Add</span>(<span class="r12 r">parameterName</span>);
                    }
 
                    <b>var</b> <span id="r13 rd" class="r13 r">voidConstraint</span> =
                        <span class="r11 r">parameter</span>.<span class="i">Attributes</span>.<span class="i">OfType</span>&lt;<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;().<span class="i">FirstOrDefault</span>(<b>static</b> <span id="r14 rd" class="r14 r">t</span> =&gt; <b>typeof</b>(<b>void</b>) == <span class="r14 r">t</span>.<span class="i">TypeName</span>.<span class="i">GetReflectionType</span>());
 
                    <b>if</b> (<span class="r13 r">voidConstraint</span> != <b>null</b>)
                    {
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r13 r">voidConstraint</span>.<span class="i">Extent</span>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">VoidTypeConstraintNotAllowed</span>),
                            <span class="i">ParserStrings</span>.<span class="i">VoidTypeConstraintNotAllowed</span>);
                    }
                }
            }
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="6aea34440aec20c3" href="../../R/6aea34440aec20c3.html" target="n" data-glyph="72,1" class="i method">VisitParamBlock</a>(<a href="ast.cs.html#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r15 rd" class="r15 r">paramBlockAst</span>)
        {
            <a href="#781b1b75e893c0ec" class="i method">CheckForDuplicateParameters</a>(<span class="r15 r">paramBlockAst</span>.<a href="ast.cs.html#ffac8f01ede94077" class="i property">Parameters</a>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="9328b4392ac1908c" href="../../R/9328b4392ac1908c.html" target="n" data-glyph="72,1" class="i method">VisitTypeConstraint</a>(<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r16 rd" class="r16 r">typeConstraintAst</span>)
        {
            <a href="#f6210ab6083ade61" class="i method">CheckArrayTypeNameDepth</a>(<span class="r16 r">typeConstraintAst</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>, <span class="r16 r">typeConstraintAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#546ca3508218075d" class="i field">_parser</a>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="bc17b9d55be587c7" href="../../R/bc17b9d55be587c7.html" target="n" data-glyph="72,1" class="i method">VisitAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r17 rd" class="r17 r">attributeAst</span>)
        {
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r18 rd" class="r18 r">names</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <b>bool</b> <span id="r19 rd" class="r19 r">checkingAttributeOnClass</span> = <b>false</b>;
            <span class="i">AttributeTargets</span> <span id="r20 rd" class="r20 r">attributeTargets</span> = <b>default</b>(<span class="i">AttributeTargets</span>);
 
            <a href="ast.cs.html#d47621d83efd14de" class="k">var</a> <span id="r21 rd" class="r21 r">parent</span> = <span class="r17 r">attributeAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
            <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r22 rd" class="r22 r">typeDefinitionAst</span> = <span class="r21 r">parent</span> <b>as</b> <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>;
            <b>if</b> (<span class="r22 r">typeDefinitionAst</span> != <b>null</b>)
            {
                <span class="r19 r">checkingAttributeOnClass</span> = <b>true</b>;
                <span class="r20 r">attributeTargets</span> = <span class="r22 r">typeDefinitionAst</span>.<a href="ast.cs.html#db380593e8b5ec71" class="i property">IsClass</a>
                    ? <span class="i">AttributeTargets</span>.<span class="i">Class</span>
                    : <span class="r22 r">typeDefinitionAst</span>.<a href="ast.cs.html#26f9adfa0f5150bd" class="i property">IsEnum</a>
                        ? <span class="i">AttributeTargets</span>.<span class="i">Enum</span>
                        : <span class="i">AttributeTargets</span>.<span class="i">Interface</span>;
            }
            <b>else</b> <b>if</b> (<span class="r21 r">parent</span> <b>is</b> <a href="ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a>)
            {
                <span class="r19 r">checkingAttributeOnClass</span> = <b>true</b>;
                <span class="r20 r">attributeTargets</span> = <span class="i">AttributeTargets</span>.<span class="i">Property</span> | <span class="i">AttributeTargets</span>.<span class="i">Field</span>;
            }
            <b>else</b>
            {
                <a href="ast.cs.html#0c4f2db9a681a977" class="k">var</a> <span id="r23 rd" class="r23 r">functionMemberAst</span> = <span class="r21 r">parent</span> <b>as</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>;
                <b>if</b> (<span class="r23 r">functionMemberAst</span> != <b>null</b>)
                {
                    <span class="r19 r">checkingAttributeOnClass</span> = <b>true</b>;
                    <span class="r20 r">attributeTargets</span> = <span class="r23 r">functionMemberAst</span>.<a href="ast.cs.html#4faa75be8a2eed76" class="i property">IsConstructor</a>
                        ? <span class="i">AttributeTargets</span>.<span class="i">Constructor</span>
                        : <span class="i">AttributeTargets</span>.<span class="i">Method</span>;
                }
                <b>else</b> <b>if</b> (<span class="r21 r">parent</span> <b>is</b> <a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a> &amp;&amp; <a href="#cd856ddc7105c343" class="i field">_memberScopeStack</a>.<span class="i">Peek</span>() <b>is</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>)
                {
                    <span class="r19 r">checkingAttributeOnClass</span> = <b>true</b>;
 
                    <span class="c">// TODO: we aren&#39;t actually generating any attributes in the class metadata</span>
                    <span class="r20 r">attributeTargets</span> = <span class="i">AttributeTargets</span>.<span class="i">Parameter</span>;
                }
            }
 
            <a href="ConstantValues.cs.html#763a3f726666bcfe" class="k">var</a> <span id="r24 rd" class="r24 r">constantValueVisitor</span> = <span class="r19 r">checkingAttributeOnClass</span>
                ? <a href="#e72629617afaab8c" class="i field">s_isConstantAttributeArgForClassVisitor</a>
                : <a href="#880cbf0bcfd99414" class="i field">s_isConstantAttributeArgVisitor</a>;
 
            <b>if</b> (<span class="r19 r">checkingAttributeOnClass</span>)
            {
                <b>var</b> <span id="r25 rd" class="r25 r">attributeType</span> = <span class="r17 r">attributeAst</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#32e4c2eb2fe24684" class="i method">GetReflectionAttributeType</a>();
                <b>if</b> (<span class="r25 r">attributeType</span> == <b>null</b>)
                {
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#546ca3508218075d" class="i field">_parser</a>.<a href="Parser.cs.html#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Count</span> &gt; 0, <span class="s">&quot;Symbol resolve should have reported error already&quot;</span>);
                }
                <b>else</b>
                {
                    <b>var</b> <span id="r26 rd" class="r26 r">usage</span> = <span class="r25 r">attributeType</span>.<span class="i">GetCustomAttribute</span>&lt;<span class="i">AttributeUsageAttribute</span>&gt;(<b>true</b>);
                    <b>if</b> (<span class="r26 r">usage</span> != <b>null</b> &amp;&amp; (<span class="r26 r">usage</span>.<span class="i">ValidOn</span> &amp; <span class="r20 r">attributeTargets</span>) == 0)
                    {
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r17 r">attributeAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">AttributeNotAllowedOnDeclaration</span>),
                            <span class="i">ParserStrings</span>.<span class="i">AttributeNotAllowedOnDeclaration</span>,
                            <a href="../../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r25 r">attributeType</span>),
                            <span class="r26 r">usage</span>.<span class="i">ValidOn</span>);
                    }
 
                    <b>foreach</b> (<b>var</b> <span id="r27 rd" class="r27 r">namedArg</span> <b>in</b> <span class="r17 r">attributeAst</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a>)
                    {
                        <b>var</b> <span id="r28 rd" class="r28 r">name</span> = <span class="r27 r">namedArg</span>.<span class="i">ArgumentName</span>;
                        <b>var</b> <span id="r29 rd" class="r29 r">members</span> = <span class="r25 r">attributeType</span>.<span class="i">GetMember</span>(<span class="r28 r">name</span>, <span class="i">MemberTypes</span>.<span class="i">Field</span> | <span class="i">MemberTypes</span>.<span class="i">Property</span>,
                            <span class="i">BindingFlags</span>.<span class="i">IgnoreCase</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span> |
                            <span class="i">BindingFlags</span>.<span class="i">FlattenHierarchy</span>);
                        <b>if</b> (<span class="r29 r">members</span>.<span class="i">Length</span> != 1
                            || (<span class="r29 r">members</span>[0] <b>is not</b> <span class="i">PropertyInfo</span> &amp;&amp; <span class="r29 r">members</span>[0] <b>is not</b> <span class="i">FieldInfo</span>))
                        {
                            <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r27 r">namedArg</span>.<span class="i">Extent</span>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">PropertyNotFoundForAttribute</span>),
                                <span class="i">ParserStrings</span>.<span class="i">PropertyNotFoundForAttribute</span>,
                                <span class="r28 r">name</span>,
                                <a href="../../P/6fbe6ac0a6a7f8d2.html#6fbe6ac0a6a7f8d2" class="t t">ToStringCodeMethods</a>.<span class="i">Type</span>(<span class="r25 r">attributeType</span>),
                                <span class="i">GetValidNamedAttributeProperties</span>(<span class="r25 r">attributeType</span>));
 
                            <b>continue</b>;
                        }
 
                        <b>var</b> <span id="r30 rd" class="r30 r">propertyInfo</span> = <span class="r29 r">members</span>[0] <b>as</b> <span class="i">PropertyInfo</span>;
                        <b>if</b> (<span class="r30 r">propertyInfo</span> != <b>null</b>)
                        {
                            <b>if</b> (<span class="r30 r">propertyInfo</span>.<span class="i">GetSetMethod</span>() == <b>null</b>)
                            {
                                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r27 r">namedArg</span>.<span class="i">Extent</span>,
                                    <b>nameof</b>(<span class="i">ExtendedTypeSystem</span>.<span class="i">ReadOnlyProperty</span>),
                                    <span class="i">ExtendedTypeSystem</span>.<span class="i">ReadOnlyProperty</span>,
                                    <span class="r28 r">name</span>);
                            }
 
                            <b>continue</b>;
                        }
 
                        <b>var</b> <span id="r31 rd" class="r31 r">fieldInfo</span> = (<span class="i">FieldInfo</span>)<span class="r29 r">members</span>[0];
                        <b>if</b> (<span class="r31 r">fieldInfo</span>.<span class="i">IsInitOnly</span> || <span class="r31 r">fieldInfo</span>.<span class="i">IsLiteral</span>)
                        {
                            <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r27 r">namedArg</span>.<span class="i">Extent</span>,
                                <b>nameof</b>(<span class="i">ExtendedTypeSystem</span>.<span class="i">ReadOnlyProperty</span>),
                                <span class="i">ExtendedTypeSystem</span>.<span class="i">ReadOnlyProperty</span>,
                                <span class="r28 r">name</span>);
                        }
                    }
                }
            }
 
            <b>foreach</b> (<b>var</b> <span id="r32 rd" class="r32 r">namedArg</span> <b>in</b> <span class="r17 r">attributeAst</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a>)
            {
                <b>string</b> <span id="r33 rd" class="r33 r">name</span> = <span class="r32 r">namedArg</span>.<span class="i">ArgumentName</span>;
                <b>if</b> (<span class="r18 r">names</span>.<span class="i">Contains</span>(<span class="r33 r">name</span>))
                {
                    <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r32 r">namedArg</span>.<span class="i">Extent</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DuplicateNamedArgument</span>),
                        <span class="i">ParserStrings</span>.<span class="i">DuplicateNamedArgument</span>,
                        <span class="r33 r">name</span>);
                }
                <b>else</b>
                {
                    <span class="r18 r">names</span>.<span class="i">Add</span>(<span class="r33 r">name</span>);
 
                    <b>if</b> (!<span class="r32 r">namedArg</span>.<span class="i">ExpressionOmitted</span> &amp;&amp; !<span class="i">IsValidAttributeArgument</span>(<span class="r32 r">namedArg</span>.<span class="i">Argument</span>, <span class="r24 r">constantValueVisitor</span>))
                    {
                        <b>var</b> <span id="r34 rd" class="r34 r">error</span> = <a href="#5f69074147e08173" class="i method">GetNonConstantAttributeArgErrorExpr</a>(<span class="r24 r">constantValueVisitor</span>);
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r32 r">namedArg</span>.<span class="i">Argument</span>.<span class="i">Extent</span>, <span class="r34 r">error</span>.<span class="i">id</span>, <span class="r34 r">error</span>.<span class="i">msg</span>);
                    }
                }
            }
 
            <b>foreach</b> (<b>var</b> <span id="r35 rd" class="r35 r">posArg</span> <b>in</b> <span class="r17 r">attributeAst</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>)
            {
                <b>if</b> (!<span class="i">IsValidAttributeArgument</span>(<span class="r35 r">posArg</span>, <span class="r24 r">constantValueVisitor</span>))
                {
                    <b>var</b> <span id="r36 rd" class="r36 r">error</span> = <a href="#5f69074147e08173" class="i method">GetNonConstantAttributeArgErrorExpr</a>(<span class="r24 r">constantValueVisitor</span>);
                    <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r35 r">posArg</span>.<span class="i">Extent</span>, <span class="r36 r">error</span>.<span class="i">id</span>, <span class="r36 r">error</span>.<span class="i">msg</span>);
                }
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>private static string</b> <a id="d931224ac4809fb1" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetValidNamedAttributeProperties</a>(<span class="i">Type</span> <span id="r37 rd" class="r37 r">attributeType</span>)
        {
            <b>var</b> <span id="r38 rd" class="r38 r">propertyNames</span> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;();
            <span class="i">PropertyInfo</span>[] <span id="r39 rd" class="r39 r">properties</span> = <span class="r37 r">attributeType</span>.<span class="i">GetProperties</span>(<span class="i">BindingFlags</span>.<span class="i">IgnoreCase</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span> | <span class="i">BindingFlags</span>.<span class="i">FlattenHierarchy</span>);
            <b>for</b> (<b>int</b> <span id="r40 rd" class="r40 r">i</span> = 0; <span class="r40 r">i</span> &lt; <span class="r39 r">properties</span>.<span class="i">Length</span>; <span class="r40 r">i</span>++)
            {
                <span class="i">PropertyInfo</span> <span id="r41 rd" class="r41 r">propertyInfo</span> = <span class="r39 r">properties</span>[<span class="r40 r">i</span>];
                <b>if</b> (<span class="r41 r">propertyInfo</span>.<span class="i">GetSetMethod</span>() != <b>null</b>)
                {
                    <span class="r38 r">propertyNames</span>.<span class="i">Add</span>(<span class="r41 r">propertyInfo</span>.<span class="i">Name</span>);
                }
            }
 
            <span class="i">FieldInfo</span>[] <span id="r42 rd" class="r42 r">fields</span> = <span class="r37 r">attributeType</span>.<span class="i">GetFields</span>(<span class="i">BindingFlags</span>.<span class="i">IgnoreCase</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">Instance</span> | <span class="i">BindingFlags</span>.<span class="i">FlattenHierarchy</span>);
            <b>for</b> (<b>int</b> <span id="r43 rd" class="r43 r">i</span> = 0; <span class="r43 r">i</span> &lt; <span class="r42 r">fields</span>.<span class="i">Length</span>; <span class="r43 r">i</span>++)
            {
                <span class="i">FieldInfo</span> <span id="r44 rd" class="r44 r">fieldInfo</span> = <span class="r42 r">fields</span>[<span class="r43 r">i</span>];
                <b>if</b> (!<span class="r44 r">fieldInfo</span>.<span class="i">IsInitOnly</span> &amp;&amp; !<span class="r44 r">fieldInfo</span>.<span class="i">IsLiteral</span>)
                {
                    <span class="r38 r">propertyNames</span>.<span class="i">Add</span>(<span class="r44 r">fieldInfo</span>.<span class="i">Name</span>);
                }
            }
 
            <b>return</b> <b>string</b>.<span class="i">Join</span>(<span class="s">&quot;, &quot;</span>, <span class="r38 r">propertyNames</span>);
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="0300ef9a5ff41efb" href="../../R/0300ef9a5ff41efb.html" target="n" data-glyph="72,1" class="i method">VisitParameter</a>(<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a> <span id="r45 rd" class="r45 r">parameterAst</span>)
        {
            <b>bool</b> <span id="r46 rd" class="r46 r">isClassMethod</span> = <span class="r45 r">parameterAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>;
            <b>bool</b> <span id="r47 rd" class="r47 r">isParamTypeDefined</span> = <b>false</b>;
            <b>foreach</b> (<a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a> <span id="r48 rd" class="r48 r">attribute</span> <b>in</b> <span class="r45 r">parameterAst</span>.<a href="ast.cs.html#5f4fbe2ccc8004ce" class="i property">Attributes</a>)
            {
                <b>if</b> (<span class="r48 r">attribute</span> <b>is</b> <a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>)
                {
                    <b>if</b> (<span class="r48 r">attribute</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>.<span class="i">Equals</span>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#09ceaaf5116a37fd" class="i field">OrderedAttribute</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r48 r">attribute</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">OrderedAttributeOnlyOnHashLiteralNode</span>),
                            <span class="i">ParserStrings</span>.<span class="i">OrderedAttributeOnlyOnHashLiteralNode</span>,
                            <span class="r48 r">attribute</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>);
                    }
                    <b>else</b>
                    {
                        <b>if</b> (<span class="r46 r">isClassMethod</span>)
                        {
                            <span class="c">// attribute represent parameter type.</span>
                            <b>if</b> (<span class="r47 r">isParamTypeDefined</span>)
                            {
                                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r48 r">attribute</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MultipleTypeConstraintsOnMethodParam</span>),
                                    <span class="i">ParserStrings</span>.<span class="i">MultipleTypeConstraintsOnMethodParam</span>);
                            }
 
                            <span class="r47 r">isParamTypeDefined</span> = <b>true</b>;
                        }
                    }
                }
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="f2519c1aa3ddac0d" href="../../R/f2519c1aa3ddac0d.html" target="n" data-glyph="72,1" class="i method">VisitTypeExpression</a>(<a href="ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a> <span id="r49 rd" class="r49 r">typeExpressionAst</span>)
        {
            <a href="#f6210ab6083ade61" class="i method">CheckArrayTypeNameDepth</a>(<span class="r49 r">typeExpressionAst</span>.<a href="ast.cs.html#c43447ab6269441a" class="i property">TypeName</a>, <span class="r49 r">typeExpressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <a href="#546ca3508218075d" class="i field">_parser</a>);
 
            <span class="c">// If this is access to the [Type] class, it may be suspicious</span>
            <b>if</b> (<b>typeof</b>(<span class="i">Type</span>) == <span class="r49 r">typeExpressionAst</span>.<a href="ast.cs.html#c43447ab6269441a" class="i property">TypeName</a>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>())
            {
                <a href="#f87d30c6816bba4f" class="i method">MarkAstParentsAsSuspicious</a>(<span class="r49 r">typeExpressionAst</span>);
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>internal static void</b> <a id="f6210ab6083ade61" href="../../R/f6210ab6083ade61.html" target="n" data-glyph="74,1" class="i method">CheckArrayTypeNameDepth</a>(<a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r50 rd" class="r50 r">typeName</span>, <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r51 rd" class="r51 r">extent</span>, <a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r52 rd" class="r52 r">parser</span>)
        {
            <b>int</b> <span id="r53 rd" class="r53 r">count</span> = 0;
            <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r54 rd" class="r54 r">type</span> = <span class="r50 r">typeName</span>;
            <b>while</b> (<span class="r54 r">type</span> <b>is not</b> <a href="ast.cs.html#83b43c1855a09e15" class="t t">TypeName</a>)
            {
                <span class="r53 r">count</span>++;
                <b>if</b> (<span class="r53 r">count</span> &gt; 200)
                {
                    <span class="r52 r">parser</span>.<span class="i">ReportError</span>(<span class="r51 r">extent</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ScriptTooComplicated</span>),
                        <span class="i">ParserStrings</span>.<span class="i">ScriptTooComplicated</span>);
                    <b>break</b>;
                }
 
                <b>if</b> (<span class="r54 r">type</span> <b>is</b> <a href="ast.cs.html#8588eb9308b68261" class="t t">ArrayTypeName</a>)
                {
                    <span class="r54 r">type</span> = ((<a href="ast.cs.html#8588eb9308b68261" class="t t">ArrayTypeName</a>)<span class="r54 r">type</span>).<a href="ast.cs.html#0f81729ec1838610" class="i property">ElementType</a>;
                }
                <b>else</b>
                {
                    <b>break</b>;
                }
            }
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="5673059811ad9429" href="../../R/5673059811ad9429.html" target="n" data-glyph="72,1" class="i method">VisitTypeDefinition</a>(<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r55 rd" class="r55 r">typeDefinitionAst</span>)
        {
            <a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r56 rd" class="r56 r">dscResourceAttributeAst</span> = <b>null</b>;
            <b>for</b> (<b>int</b> <span id="r57 rd" class="r57 r">i</span> = 0; <span class="r57 r">i</span> &lt; <span class="r55 r">typeDefinitionAst</span>.<a href="ast.cs.html#9bd8b4fdfddab8c7" class="i property">Attributes</a>.<span class="i">Count</span>; <span class="r57 r">i</span>++)
            {
                <b>var</b> <span id="r58 rd" class="r58 r">attr</span> = <span class="r55 r">typeDefinitionAst</span>.<a href="ast.cs.html#9bd8b4fdfddab8c7" class="i property">Attributes</a>[<span class="r57 r">i</span>];
                <b>if</b> (<span class="r58 r">attr</span>.<span class="i">TypeName</span>.<span class="i">GetReflectionAttributeType</span>() == <b>typeof</b>(<a href="../Attributes.cs.html#07160ce4e78c3181" class="t t">DscResourceAttribute</a>))
                {
                    <span class="r56 r">dscResourceAttributeAst</span> = <span class="r58 r">attr</span>;
                    <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r56 r">dscResourceAttributeAst</span> != <b>null</b>)
            {
                <a href="#ab5e2b836ac3fb6d" class="t t">DscResourceChecker</a>.<a href="#b9befd380e57da89" class="i method">CheckType</a>(<a href="#546ca3508218075d" class="i field">_parser</a>, <span class="r55 r">typeDefinitionAst</span>, <span class="r56 r">dscResourceAttributeAst</span>);
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="1b150c0fa437e885" href="../../R/1b150c0fa437e885.html" target="n" data-glyph="72,1" class="i method">VisitFunctionMember</a>(<a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a> <span id="r59 rd" class="r59 r">functionMemberAst</span>)
        {
            <a href="#cd856ddc7105c343" class="i field">_memberScopeStack</a>.<span class="i">Push</span>(<span class="r59 r">functionMemberAst</span>);
 
            <a href="ast.cs.html#6f963589327835a4" class="k">var</a> <span id="r60 rd" class="r60 r">body</span> = <span class="r59 r">functionMemberAst</span>.<a href="ast.cs.html#0cea07df0e8f92c9" class="i property">Body</a>;
            <b>if</b> (<span class="r60 r">body</span>.<a href="ast.cs.html#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>)
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r60 r">body</span>.<a href="ast.cs.html#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ParamBlockNotAllowedInMethod</span>),
                    <span class="i">ParserStrings</span>.<span class="i">ParamBlockNotAllowedInMethod</span>);
            }
 
            <b>if</b> (<span class="r60 r">body</span>.<a href="ast.cs.html#08794a618a2d04ac" class="i property">BeginBlock</a> != <b>null</b> ||
                <span class="r60 r">body</span>.<a href="ast.cs.html#8940fb8f9b3e6444" class="i property">ProcessBlock</a> != <b>null</b> ||
                <span class="r60 r">body</span>.<a href="ast.cs.html#4549d1761658a004" class="i property">DynamicParamBlock</a> != <b>null</b> ||
                !<span class="r60 r">body</span>.<a href="ast.cs.html#958e631868900aba" class="i property">EndBlock</a>.<a href="ast.cs.html#4b76ccd3ee5695b7" class="i property">Unnamed</a>)
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="Parser.cs.html#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r60 r">body</span>.<a href="ast.cs.html#4549d1761658a004" class="i property">DynamicParamBlock</a>, <span class="r60 r">body</span>.<a href="ast.cs.html#08794a618a2d04ac" class="i property">BeginBlock</a>, <span class="r60 r">body</span>.<a href="ast.cs.html#8940fb8f9b3e6444" class="i property">ProcessBlock</a>, <span class="r60 r">body</span>.<a href="ast.cs.html#958e631868900aba" class="i property">EndBlock</a>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">NamedBlockNotAllowedInMethod</span>),
                    <span class="i">ParserStrings</span>.<span class="i">NamedBlockNotAllowedInMethod</span>);
            }
 
            <b>if</b> (<span class="r59 r">functionMemberAst</span>.<a href="ast.cs.html#4faa75be8a2eed76" class="i property">IsConstructor</a> &amp;&amp; <span class="r59 r">functionMemberAst</span>.<a href="ast.cs.html#9f5c50ce429b8578" class="i property">ReturnType</a> != <b>null</b>)
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r59 r">functionMemberAst</span>.<a href="ast.cs.html#9f5c50ce429b8578" class="i property">ReturnType</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ConstructorCantHaveReturnType</span>),
                    <span class="i">ParserStrings</span>.<span class="i">ConstructorCantHaveReturnType</span>);
            }
 
            <span class="c">// Analysis determines if all paths return and do data flow for variables.</span>
            <b>var</b> <span id="r61 rd" class="r61 r">allCodePathsReturned</span> = <a href="VariableAnalysis.cs.html#3d310869db3a3b73" class="t t">VariableAnalysis</a>.<a href="VariableAnalysis.cs.html#6ae980febb55feeb" class="i method">AnalyzeMemberFunction</a>(<span class="r59 r">functionMemberAst</span>);
            <b>if</b> (!<span class="r61 r">allCodePathsReturned</span> &amp;&amp; !<span class="r59 r">functionMemberAst</span>.<a href="ast.cs.html#89500cf38f3e53f4" class="i method">IsReturnTypeVoid</a>())
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r59 r">functionMemberAst</span>.<a href="ast.cs.html#7383b4996970fa8a" class="i property">NameExtent</a> ?? <span class="r59 r">functionMemberAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MethodHasCodePathNotReturn</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MethodHasCodePathNotReturn</span>);
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="034cfd378fcd4947" href="../../R/034cfd378fcd4947.html" target="n" data-glyph="72,1" class="i method">VisitFunctionDefinition</a>(<a href="ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r62 rd" class="r62 r">functionDefinitionAst</span>)
        {
            <b>if</b> (<span class="r62 r">functionDefinitionAst</span>.<a href="ast.cs.html#653a0e4bf79364c2" class="i property">Parameters</a> != <b>null</b>
                &amp;&amp; <span class="r62 r">functionDefinitionAst</span>.<a href="ast.cs.html#201bce3cfc040274" class="i property">Body</a>.<a href="ast.cs.html#3fd8788db62344d2" class="i property">ParamBlock</a> != <b>null</b>)
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r62 r">functionDefinitionAst</span>.<a href="ast.cs.html#201bce3cfc040274" class="i property">Body</a>.<a href="ast.cs.html#3fd8788db62344d2" class="i property">ParamBlock</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">OnlyOneParameterListAllowed</span>),
                    <span class="i">ParserStrings</span>.<span class="i">OnlyOneParameterListAllowed</span>);
            }
            <b>else</b> <b>if</b> (<span class="r62 r">functionDefinitionAst</span>.<a href="ast.cs.html#653a0e4bf79364c2" class="i property">Parameters</a> != <b>null</b>)
            {
                <a href="#781b1b75e893c0ec" class="i method">CheckForDuplicateParameters</a>(<span class="r62 r">functionDefinitionAst</span>.<a href="ast.cs.html#653a0e4bf79364c2" class="i property">Parameters</a>);
            }
 
            <b>if</b> (<span class="r62 r">functionDefinitionAst</span>.<a href="ast.cs.html#d87e1032aa3dac41" class="i property">IsWorkflow</a>)
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r62 r">functionDefinitionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">WorkflowNotSupportedInPowerShellCore</span>),
                    <span class="i">ParserStrings</span>.<span class="i">WorkflowNotSupportedInPowerShellCore</span>);
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="bab5ffe0cf25f50c" href="../../R/bab5ffe0cf25f50c.html" target="n" data-glyph="72,1" class="i method">VisitSwitchStatement</a>(<a href="ast.cs.html#4d96f6c979a5266e" class="t t">SwitchStatementAst</a> <span id="r63 rd" class="r63 r">switchStatementAst</span>)
        {
            <span class="c">// Parallel flag not allowed</span>
            <b>if</b> ((<span class="r63 r">switchStatementAst</span>.<a href="ast.cs.html#aaca019540ac3d40" class="i property">Flags</a> &amp; <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#ef0ad3b1b1c543cb" class="i field">Parallel</a>) == <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#ef0ad3b1b1c543cb" class="i field">Parallel</a>)
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(
                    <span class="r63 r">switchStatementAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">KeywordParameterReservedForFutureUse</span>),
                    <span class="i">ParserStrings</span>.<span class="i">KeywordParameterReservedForFutureUse</span>,
                    <span class="s">&quot;switch&quot;</span>,
                    <span class="s">&quot;parallel&quot;</span>);
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>private static</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="3661e3d7028e48ce" href="../../R/3661e3d7028e48ce.html" target="n" data-glyph="76,1" class="i method">GetConstantDataStatementAllowedCommands</a>(<a href="ast.cs.html#37c175482122764b" class="t t">DataStatementAst</a> <span id="r64 rd" class="r64 r">dataStatementAst</span>)
        {
            <b>yield</b> <b>return</b> <span class="s">&quot;ConvertFrom-StringData&quot;</span>;
            <b>foreach</b> (<b>var</b> <span id="r65 rd" class="r65 r">allowed</span> <b>in</b> <span class="r64 r">dataStatementAst</span>.<a href="ast.cs.html#11fb9d287a8e9308" class="i property">CommandsAllowed</a>)
            {
                <b>yield</b> <b>return</b> ((<a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)<span class="r65 r">allowed</span>).<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>;
            }
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="253a068950c8a30f" href="../../R/253a068950c8a30f.html" target="n" data-glyph="72,1" class="i method">VisitDataStatement</a>(<a href="ast.cs.html#37c175482122764b" class="t t">DataStatementAst</a> <span id="r66 rd" class="r66 r">dataStatementAst</span>)
        {
            <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r67 rd" class="r67 r">allowedCommands</span> =
                <span class="r66 r">dataStatementAst</span>.<a href="ast.cs.html#fd85adecda14b40c" class="i property">HasNonConstantAllowedCommand</a> ? <b>null</b> : <a href="#3661e3d7028e48ce" class="i method">GetConstantDataStatementAllowedCommands</a>(<span class="r66 r">dataStatementAst</span>);
            <a href="#7c9c4e1c1c4e828d" class="t t">RestrictedLanguageChecker</a> <span id="r68 rd" class="r68 r">checker</span> = <b>new</b> <a href="#83c5d1ad64eb6f9a" class="t constructor">RestrictedLanguageChecker</a>(<a href="#546ca3508218075d" class="i field">_parser</a>, <span class="r67 r">allowedCommands</span>, <b>null</b>, <b>false</b>);
            <span class="r66 r">dataStatementAst</span>.<a href="ast.cs.html#75dab9efd3d1b59e" class="i property">Body</a>.<a href="ast.cs.html#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r68 r">checker</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="a7baed7910a29369" href="../../R/a7baed7910a29369.html" target="n" data-glyph="72,1" class="i method">VisitForEachStatement</a>(<a href="ast.cs.html#9ae6aa2909fef7b0" class="t t">ForEachStatementAst</a> <span id="r69 rd" class="r69 r">forEachStatementAst</span>)
        {
            <span class="c">// Parallel flag not allowed</span>
            <b>if</b> ((<span class="r69 r">forEachStatementAst</span>.<a href="ast.cs.html#ceac4fea87d6a65a" class="i property">Flags</a> &amp; <a href="ast.cs.html#23c2c283246ee841" class="t t">ForEachFlags</a>.<a href="ast.cs.html#15784204dbd0f70a" class="i field">Parallel</a>) == <a href="ast.cs.html#23c2c283246ee841" class="t t">ForEachFlags</a>.<a href="ast.cs.html#15784204dbd0f70a" class="i field">Parallel</a>)
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(
                    <span class="r69 r">forEachStatementAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">KeywordParameterReservedForFutureUse</span>),
                    <span class="i">ParserStrings</span>.<span class="i">KeywordParameterReservedForFutureUse</span>,
                    <span class="s">&quot;foreach&quot;</span>,
                    <span class="s">&quot;parallel&quot;</span>);
            }
 
            <b>if</b> (<span class="r69 r">forEachStatementAst</span>.<a href="ast.cs.html#5ff3ea0ed041de61" class="i property">ThrottleLimit</a> != <b>null</b>)
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(
                    <span class="r69 r">forEachStatementAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">KeywordParameterReservedForFutureUse</span>),
                    <span class="i">ParserStrings</span>.<span class="i">KeywordParameterReservedForFutureUse</span>,
                    <span class="s">&quot;foreach&quot;</span>,
                    <span class="s">&quot;throttlelimit&quot;</span>);
            }
 
            <span class="c">// Throttle limit must be combined with Parallel flag</span>
            <b>if</b> ((<span class="r69 r">forEachStatementAst</span>.<a href="ast.cs.html#5ff3ea0ed041de61" class="i property">ThrottleLimit</a> != <b>null</b>) &amp;&amp;
                ((<span class="r69 r">forEachStatementAst</span>.<a href="ast.cs.html#ceac4fea87d6a65a" class="i property">Flags</a> &amp; <a href="ast.cs.html#23c2c283246ee841" class="t t">ForEachFlags</a>.<a href="ast.cs.html#15784204dbd0f70a" class="i field">Parallel</a>) != <a href="ast.cs.html#23c2c283246ee841" class="t t">ForEachFlags</a>.<a href="ast.cs.html#15784204dbd0f70a" class="i field">Parallel</a>))
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(
                    <span class="r69 r">forEachStatementAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ThrottleLimitRequiresParallelFlag</span>),
                    <span class="i">ParserStrings</span>.<span class="i">ThrottleLimitRequiresParallelFlag</span>);
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="48fa7376f3b3f52c" href="../../R/48fa7376f3b3f52c.html" target="n" data-glyph="72,1" class="i method">VisitTryStatement</a>(<a href="ast.cs.html#9827b5d12d62be7f" class="t t">TryStatementAst</a> <span id="r70 rd" class="r70 r">tryStatementAst</span>)
        {
            <b>if</b> (<span class="r70 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>.<span class="i">Count</span> &lt;= 1) <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
 
            <b>for</b> (<b>int</b> <span id="r71 rd" class="r71 r">i</span> = 0; <span class="r71 r">i</span> &lt; <span class="r70 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>.<span class="i">Count</span> - 1; ++<span class="r71 r">i</span>)
            {
                <a href="ast.cs.html#fafbccc59f688c0e" class="t t">CatchClauseAst</a> <span id="r72 rd" class="r72 r">block1</span> = <span class="r70 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>[<span class="r71 r">i</span>];
                <b>for</b> (<b>int</b> <span id="r73 rd" class="r73 r">j</span> = <span class="r71 r">i</span> + 1; <span class="r73 r">j</span> &lt; <span class="r70 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>.<span class="i">Count</span>; ++<span class="r73 r">j</span>)
                {
                    <a href="ast.cs.html#fafbccc59f688c0e" class="t t">CatchClauseAst</a> <span id="r74 rd" class="r74 r">block2</span> = <span class="r70 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>[<span class="r73 r">j</span>];
 
                    <b>if</b> (<span class="r72 r">block1</span>.<a href="ast.cs.html#98a314e6e3800ec9" class="i property">IsCatchAll</a>)
                    {
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="Parser.cs.html#c6ad43b3028af740" class="i method">Before</a>(<span class="r74 r">block2</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EmptyCatchNotLast</span>),
                            <span class="i">ParserStrings</span>.<span class="i">EmptyCatchNotLast</span>);
                        <b>break</b>;
                    }
 
                    <b>if</b> (<span class="r74 r">block2</span>.<a href="ast.cs.html#98a314e6e3800ec9" class="i property">IsCatchAll</a>) <b>continue</b>;
 
                    <b>foreach</b> (<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r75 rd" class="r75 r">typeLiteral1</span> <b>in</b> <span class="r72 r">block1</span>.<a href="ast.cs.html#965c23dce819c035" class="i property">CatchTypes</a>)
                    {
                        <span class="i">Type</span> <span id="r76 rd" class="r76 r">type1</span> = <span class="r75 r">typeLiteral1</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
                        <span class="c">// If the type can&#39;t be resolved yet, there isn&#39;t much we can do, so skip it.</span>
                        <b>if</b> (<span class="r76 r">type1</span> == <b>null</b>)
                            <b>continue</b>;
 
                        <b>foreach</b> (<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r77 rd" class="r77 r">typeLiteral2</span> <b>in</b> <span class="r74 r">block2</span>.<a href="ast.cs.html#965c23dce819c035" class="i property">CatchTypes</a>)
                        {
                            <span class="i">Type</span> <span id="r78 rd" class="r78 r">type2</span> = <span class="r77 r">typeLiteral2</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
                            <span class="c">// If the type can&#39;t be resolved yet, there isn&#39;t much we can do, so skip it.</span>
                            <b>if</b> (<span class="r78 r">type2</span> == <b>null</b>)
                                <b>continue</b>;
 
                            <b>if</b> (<span class="r76 r">type1</span> == <span class="r78 r">type2</span> || <span class="r78 r">type2</span>.<span class="i">IsSubclassOf</span>(<span class="r76 r">type1</span>))
                            {
                                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r77 r">typeLiteral2</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ExceptionTypeAlreadyCaught</span>),
                                    <span class="i">ParserStrings</span>.<span class="i">ExceptionTypeAlreadyCaught</span>,
                                    <span class="r78 r">type2</span>.<span class="i">FullName</span>);
                            }
                        }
                    }
                }
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check that label exists inside the method.</span>
        <span class="c">///</span><span class="c"> Only call it, when label is present and can be calculated in compile time.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r79 r">ast</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">BreakStatementAst or ContinueStatementAst.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r80 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Label name. Can be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="81f16d85f66e2e77" href="../../R/81f16d85f66e2e77.html" target="n" data-glyph="76,1" class="i method">CheckLabelExists</a>(<a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r79 rd" class="r79 r">ast</span>, <b>string</b> <span id="r80 rd" class="r80 r">label</span>)
        {
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r80 r">label</span>))
            {
                <b>return</b>;
            }
 
            <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r81 rd" class="r81 r">parent</span>;
            <b>for</b> (<span class="r81 r">parent</span> = <span class="r79 r">ast</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>; <span class="r81 r">parent</span> != <b>null</b>; <span class="r81 r">parent</span> = <span class="r81 r">parent</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>)
            {
                <b>if</b> (<span class="r81 r">parent</span> <b>is</b> <a href="ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a>)
                {
                    <b>if</b> (<span class="r81 r">parent</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>)
                    {
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r79 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">LabelNotFound</span>),
                            <span class="i">ParserStrings</span>.<span class="i">LabelNotFound</span>,
                            <span class="r80 r">label</span>);
                    }
 
                    <b>break</b>;
                }
 
                <a href="ast.cs.html#931b3c793b175596" class="k">var</a> <span id="r82 rd" class="r82 r">loop</span> = <span class="r81 r">parent</span> <b>as</b> <a href="ast.cs.html#931b3c793b175596" class="t t">LoopStatementAst</a>;
                <b>if</b> (<span class="r82 r">loop</span> != <b>null</b>)
                {
                    <b>if</b> (<a href="../lang/parserutils.cs.html#7aca1395e161031c" class="t t">LoopFlowException</a>.<span class="i">MatchLoopLabel</span>(<span class="r80 r">label</span>, <span class="r82 r">loop</span>.<a href="ast.cs.html#6e78c18e515b91da" class="i property">Label</a> ?? <b>string</b>.<span class="i">Empty</span>))
                        <b>break</b>;
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check that flow doesn&#39;t leave finally.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r83 r">ast</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r84 r">label</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If label is null, either it&#39;s a break/continue to an unknown label</span>
        <span class="c">///</span><span class="c"> (and unknown does not mean not specified, it means it&#39;s an expression we can&#39;t evaluate) or we have a return statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="cfa38cf9e71f47b9" href="../../R/cfa38cf9e71f47b9.html" target="n" data-glyph="76,1" class="i method">CheckForFlowOutOfFinally</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r83 rd" class="r83 r">ast</span>, <b>string</b> <span id="r84 rd" class="r84 r">label</span>)
        {
            <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r85 rd" class="r85 r">parent</span>;
            <b>for</b> (<span class="r85 r">parent</span> = <span class="r83 r">ast</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>; <span class="r85 r">parent</span> != <b>null</b>; <span class="r85 r">parent</span> = <span class="r85 r">parent</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>)
            {
                <b>if</b> (<span class="r85 r">parent</span> <b>is</b> <a href="ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a> || <span class="r85 r">parent</span> <b>is</b> <a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a> || <span class="r85 r">parent</span> <b>is</b> <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a>)
                {
                    <span class="c">// Script blocks, traps, and named blocks are all top level asts for a complete method,</span>
                    <span class="c">// so if we didn&#39;t find a try/catch, the control flow is just leaving the method,</span>
                    <span class="c">// it is not leaving some finally, even if the script lock/trap is nested in the finally.</span>
                    <b>break</b>;
                }
 
                <span class="c">// If label is not null, we have a break/continue where we know the loop label at compile</span>
                <span class="c">// time. If we can match the label before finding the finally, then we&#39;re not flowing out</span>
                <span class="c">// of the finally.</span>
                <b>if</b> (<span class="r84 r">label</span> != <b>null</b> &amp;&amp; <span class="r85 r">parent</span> <b>is</b> <a href="ast.cs.html#056fe4b6395c295c" class="t t">LabeledStatementAst</a>)
                {
                    <b>if</b> (<a href="../lang/parserutils.cs.html#7aca1395e161031c" class="t t">LoopFlowException</a>.<span class="i">MatchLoopLabel</span>(<span class="r84 r">label</span>, ((<a href="ast.cs.html#056fe4b6395c295c" class="t t">LabeledStatementAst</a>)<span class="r85 r">parent</span>).<a href="ast.cs.html#6e78c18e515b91da" class="i property">Label</a> ?? <b>string</b>.<span class="i">Empty</span>))
                        <b>break</b>;
                }
 
                <a href="ast.cs.html#268644c84b225866" class="k">var</a> <span id="r86 rd" class="r86 r">stmtBlock</span> = <span class="r85 r">parent</span> <b>as</b> <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a>;
                <b>if</b> (<span class="r86 r">stmtBlock</span> != <b>null</b>)
                {
                    <a href="ast.cs.html#9827b5d12d62be7f" class="k">var</a> <span id="r87 rd" class="r87 r">tryStatementAst</span> = <span class="r86 r">stmtBlock</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="ast.cs.html#9827b5d12d62be7f" class="t t">TryStatementAst</a>;
                    <b>if</b> (<span class="r87 r">tryStatementAst</span> != <b>null</b> &amp;&amp; <span class="r87 r">tryStatementAst</span>.<a href="ast.cs.html#56a1309fed36b070" class="i property">Finally</a> == <span class="r86 r">stmtBlock</span>)
                    {
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r83 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ControlLeavingFinally</span>),
                            <span class="i">ParserStrings</span>.<span class="i">ControlLeavingFinally</span>);
                        <b>break</b>;
                    }
                }
            }
        }
 
        <b>private static string</b> <a id="c260025ad8effbfb" href="../../R/c260025ad8effbfb.html" target="n" data-glyph="76,1" class="i method">GetLabel</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r88 rd" class="r88 r">expr</span>)
        {
            <span class="c">// We only return null from this method if the label is unknown.  If no label is specified,</span>
            <span class="c">// we just use the empty string.</span>
            <b>if</b> (<span class="r88 r">expr</span> == <b>null</b>)
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r89 rd" class="r89 r">str</span> = <span class="r88 r">expr</span> <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
            <b>return</b> <span class="r89 r">str</span>?.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="f3d06786ad97e9ef" href="../../R/f3d06786ad97e9ef.html" target="n" data-glyph="72,1" class="i method">VisitBreakStatement</a>(<a href="ast.cs.html#410610c8cad1e99b" class="t t">BreakStatementAst</a> <span id="r90 rd" class="r90 r">breakStatementAst</span>)
        {
            <b>string</b> <span id="r91 rd" class="r91 r">label</span> = <a href="#c260025ad8effbfb" class="i method">GetLabel</a>(<span class="r90 r">breakStatementAst</span>.<a href="ast.cs.html#d09d51ee2cd8ffec" class="i property">Label</a>);
            <a href="#cfa38cf9e71f47b9" class="i method">CheckForFlowOutOfFinally</a>(<span class="r90 r">breakStatementAst</span>, <span class="r91 r">label</span>);
            <a href="#81f16d85f66e2e77" class="i method">CheckLabelExists</a>(<span class="r90 r">breakStatementAst</span>, <span class="r91 r">label</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="121eef5c30ab1f7e" href="../../R/121eef5c30ab1f7e.html" target="n" data-glyph="72,1" class="i method">VisitContinueStatement</a>(<a href="ast.cs.html#f8a733d027117fbc" class="t t">ContinueStatementAst</a> <span id="r92 rd" class="r92 r">continueStatementAst</span>)
        {
            <b>string</b> <span id="r93 rd" class="r93 r">label</span> = <a href="#c260025ad8effbfb" class="i method">GetLabel</a>(<span class="r92 r">continueStatementAst</span>.<a href="ast.cs.html#2085acb39f31fba8" class="i property">Label</a>);
            <a href="#cfa38cf9e71f47b9" class="i method">CheckForFlowOutOfFinally</a>(<span class="r92 r">continueStatementAst</span>, <span class="r93 r">label</span>);
            <a href="#81f16d85f66e2e77" class="i method">CheckLabelExists</a>(<span class="r92 r">continueStatementAst</span>, <span class="r93 r">label</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>private void</b> <a id="709d6200d0b8c1e9" href="../../R/709d6200d0b8c1e9.html" target="n" data-glyph="76,1" class="i method">CheckForReturnStatement</a>(<a href="ast.cs.html#ba60713bd71ce457" class="t t">ReturnStatementAst</a> <span id="r94 rd" class="r94 r">ast</span>)
        {
            <b>if</b> (!(<a href="#cd856ddc7105c343" class="i field">_memberScopeStack</a>.<span class="i">Peek</span>() <b>is</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a> <span id="r95 rd" class="r95 r">functionMemberAst</span>))
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r94 r">ast</span>.<a href="ast.cs.html#5b77ce523f7a0a91" class="i property">Pipeline</a> != <b>null</b>)
            {
                <b>if</b> (<span class="r95 r">functionMemberAst</span>.<a href="ast.cs.html#89500cf38f3e53f4" class="i method">IsReturnTypeVoid</a>())
                {
                    <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r94 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">VoidMethodHasReturn</span>),
                        <span class="i">ParserStrings</span>.<span class="i">VoidMethodHasReturn</span>);
                }
            }
            <b>else</b>
            {
                <b>if</b> (!<span class="r95 r">functionMemberAst</span>.<a href="ast.cs.html#89500cf38f3e53f4" class="i method">IsReturnTypeVoid</a>())
                {
                    <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r94 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">NonVoidMethodMissingReturnValue</span>),
                        <span class="i">ParserStrings</span>.<span class="i">NonVoidMethodMissingReturnValue</span>);
                }
            }
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="c9ea4ab14af5697c" href="../../R/c9ea4ab14af5697c.html" target="n" data-glyph="72,1" class="i method">VisitReturnStatement</a>(<a href="ast.cs.html#ba60713bd71ce457" class="t t">ReturnStatementAst</a> <span id="r96 rd" class="r96 r">returnStatementAst</span>)
        {
            <a href="#cfa38cf9e71f47b9" class="i method">CheckForFlowOutOfFinally</a>(<span class="r96 r">returnStatementAst</span>, <b>null</b>);
            <a href="#709d6200d0b8c1e9" class="i method">CheckForReturnStatement</a>(<span class="r96 r">returnStatementAst</span>);
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if the ast is a valid target for assignment.  If not, the action reportError is called.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r97 r">ast</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The target of an assignment.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r98 r">simpleAssignment</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if the operator &#39;=&#39; is used, false otherwise (e.g. false on &#39;+=&#39; or &#39;++&#39;.).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r99 r">reportError</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The action called to report any errors.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private void</b> <a id="a03643e7c715c24e" href="../../R/a03643e7c715c24e.html" target="n" data-glyph="76,1" class="i method">CheckAssignmentTarget</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r97 rd" class="r97 r">ast</span>, <b>bool</b> <span id="r98 rd" class="r98 r">simpleAssignment</span>, <span class="i">Action</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r99 rd" class="r99 r">reportError</span>)
        {
            <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a> <span id="r100 rd" class="r100 r">arrayLiteralAst</span> = <span class="r97 r">ast</span> <b>as</b> <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>;
            <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r101 rd" class="r101 r">errorAst</span> = <b>null</b>;
            <b>if</b> (<span class="r100 r">arrayLiteralAst</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r98 r">simpleAssignment</span>)
                {
                    <a href="#a9a3a06aa3e09159" class="i method">CheckArrayLiteralAssignment</a>(<span class="r100 r">arrayLiteralAst</span>, <span class="r99 r">reportError</span>);
                }
                <b>else</b>
                {
                    <span class="r101 r">errorAst</span> = <span class="r100 r">arrayLiteralAst</span>;
                }
            }
            <b>else</b>
            {
                <a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a> <span id="r102 rd" class="r102 r">parenExpressionAst</span> = <span class="r97 r">ast</span> <b>as</b> <a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a>;
                <b>if</b> (<span class="r102 r">parenExpressionAst</span> != <b>null</b>)
                {
                    <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r103 rd" class="r103 r">expr</span> = <span class="r102 r">parenExpressionAst</span>.<a href="ast.cs.html#021e323175cb804d" class="i property">Pipeline</a>.<a href="ast.cs.html#158661f5f6c8db6d" class="i method">GetPureExpression</a>();
                    <b>if</b> (<span class="r103 r">expr</span> == <b>null</b>)
                    {
                        <span class="r101 r">errorAst</span> = <span class="r102 r">parenExpressionAst</span>.<a href="ast.cs.html#021e323175cb804d" class="i property">Pipeline</a>;
                    }
                    <b>else</b>
                    {
                        <a href="#a03643e7c715c24e" class="i method">CheckAssignmentTarget</a>(<span class="r103 r">expr</span>, <span class="r98 r">simpleAssignment</span>, <span class="r99 r">reportError</span>);
                    }
                }
                <b>else</b> <b>if</b> (<span class="r97 r">ast</span> <b>is not</b> <a href="ast.cs.html#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>)
                {
                    <span class="r101 r">errorAst</span> = <span class="r97 r">ast</span>;
                }
                <b>else</b> <b>if</b> (<span class="r97 r">ast</span> <b>is</b> <a href="ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a> <span id="r104 rd" class="r104 r">memberExprAst</span> &amp;&amp; <span class="r104 r">memberExprAst</span>.<a href="ast.cs.html#2009b5bf3ceaa685" class="i property">NullConditional</a>)
                {
                    <span class="r101 r">errorAst</span> = <span class="r97 r">ast</span>;
                }
                <b>else</b> <b>if</b> (<span class="r97 r">ast</span> <b>is</b> <a href="ast.cs.html#4587e325068530ec" class="t t">IndexExpressionAst</a> <span id="r105 rd" class="r105 r">indexExprAst</span> &amp;&amp; <span class="r105 r">indexExprAst</span>.<a href="ast.cs.html#bc0ffb37ea25c82b" class="i property">NullConditional</a>)
                {
                    <span class="r101 r">errorAst</span> = <span class="r97 r">ast</span>;
                }
                <b>else</b> <b>if</b> (<span class="r97 r">ast</span> <b>is</b> <a href="ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>)
                {
                    <span class="c">// Check for multiple types combined with [ref].</span>
                    <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r106 rd" class="r106 r">expr</span> = <span class="r97 r">ast</span>;
                    <b>int</b> <span id="r107 rd" class="r107 r">converts</span> = 0;
                    <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r108 rd" class="r108 r">errorPosition</span> = <b>null</b>;
                    <span class="i">Type</span> <span id="r109 rd" class="r109 r">lastConvertType</span> = <b>null</b>;
                    <b>while</b> (<span class="r106 r">expr</span> <b>is</b> <a href="ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>)
                    {
                        <a href="ast.cs.html#49daf252fdb62723" class="k">var</a> <span id="r110 rd" class="r110 r">convertExpr</span> = <span class="r106 r">expr</span> <b>as</b> <a href="ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a>;
                        <b>if</b> (<span class="r110 r">convertExpr</span> != <b>null</b>)
                        {
                            <span class="r107 r">converts</span> += 1;
                            <span class="r109 r">lastConvertType</span> = <span class="r110 r">convertExpr</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
                            <b>if</b> (<b>typeof</b>(<a href="../MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>) == <span class="r109 r">lastConvertType</span>)
                            {
                                <span class="r108 r">errorPosition</span> = <span class="r110 r">convertExpr</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                            }
                            <b>else</b> <b>if</b> (<b>typeof</b>(<b>void</b>) == <span class="r109 r">lastConvertType</span>)
                            {
                                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r110 r">convertExpr</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">VoidTypeConstraintNotAllowed</span>),
                                    <span class="i">ParserStrings</span>.<span class="i">VoidTypeConstraintNotAllowed</span>);
                            }
                        }
 
                        <span class="r106 r">expr</span> = ((<a href="ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>)<span class="r106 r">expr</span>).<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a>;
                    }
 
                    <b>if</b> ((<span class="r108 r">errorPosition</span> != <b>null</b>) &amp;&amp; <span class="r107 r">converts</span> &gt; 1)
                    {
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r108 r">errorPosition</span>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ReferenceNeedsToBeByItselfInTypeConstraint</span>),
                            <span class="i">ParserStrings</span>.<span class="i">ReferenceNeedsToBeByItselfInTypeConstraint</span>);
                    }
                    <b>else</b>
                    {
                        <a href="ast.cs.html#248562b22b336dec" class="k">var</a> <span id="r111 rd" class="r111 r">varExprAst</span> = <span class="r106 r">expr</span> <b>as</b> <a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>;
                        <b>if</b> (<span class="r111 r">varExprAst</span> != <b>null</b>)
                        {
                            <a href="../VariablePath.cs.html#41e5b41974741cc5" class="k">var</a> <span id="r112 rd" class="r112 r">varPath</span> = <span class="r111 r">varExprAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>;
                            <b>if</b> (<span class="r112 r">varPath</span>.<a href="../VariablePath.cs.html#6af6d06d3e3c5d67" class="i property">IsVariable</a> &amp;&amp; <span class="r112 r">varPath</span>.<a href="VariableAnalysis.cs.html#e3b11791a094c005" class="i method">IsAnyLocal</a>())
                            {
                                <b>var</b> <span id="r113 rd" class="r113 r">specialIndex</span> = 0;
                                <b>while</b> (<span class="r113 r">specialIndex</span> &lt; (<b>int</b>)<a href="../SpecialVariables.cs.html#1c6f2efd91287b59" class="t t">AutomaticVariable</a>.<a href="../SpecialVariables.cs.html#d64e69972d70be92" class="i field">NumberOfAutomaticVariables</a>)
                                {
                                    <b>if</b> (<span class="r112 r">varPath</span>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>.<span class="i">Equals</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#2e947723b75287da" class="i field">AutomaticVariables</a>[<span class="r113 r">specialIndex</span>], <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                    {
                                        <b>var</b> <span id="r114 rd" class="r114 r">expectedType</span> = <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#6729b0cd3aff6afe" class="i field">AutomaticVariableTypes</a>[<span class="r113 r">specialIndex</span>];
                                        <b>if</b> (<span class="r114 r">expectedType</span> != <span class="r109 r">lastConvertType</span>)
                                        {
                                            <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r97 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">AssignmentStatementToAutomaticNotSupported</span>),
                                                <span class="i">ParserStrings</span>.<span class="i">AssignmentStatementToAutomaticNotSupported</span>,
                                                <span class="r112 r">varPath</span>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>,
                                                <span class="r114 r">expectedType</span>);
                                        }
 
                                        <b>break</b>;
                                    }
 
                                    <span class="r113 r">specialIndex</span> += 1;
                                }
                            }
                        }
 
                        <a href="#a03643e7c715c24e" class="i method">CheckAssignmentTarget</a>(<span class="r106 r">expr</span>, <span class="r98 r">simpleAssignment</span>, <span class="r99 r">reportError</span>);
                    }
                }
            }
 
            <b>if</b> (<span class="r101 r">errorAst</span> != <b>null</b>)
            {
                <span class="r99 r">reportError</span>(<span class="r101 r">errorAst</span>);
            }
        }
 
        <b>private void</b> <a id="a9a3a06aa3e09159" href="../../R/a9a3a06aa3e09159.html" target="n" data-glyph="76,1" class="i method">CheckArrayLiteralAssignment</a>(<a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a> <span id="r115 rd" class="r115 r">ast</span>, <span class="i">Action</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r116 rd" class="r116 r">reportError</span>)
        {
            <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
            <b>foreach</b> (<b>var</b> <span id="r117 rd" class="r117 r">element</span> <b>in</b> <span class="r115 r">ast</span>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>)
            {
                <span class="i">CheckAssignmentTarget</span>(<span class="r117 r">element</span>, <b>true</b>, <span class="r116 r">reportError</span>);
            }
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="e3e9513b1682a3dc" href="../../R/e3e9513b1682a3dc.html" target="n" data-glyph="72,1" class="i method">VisitAssignmentStatement</a>(<a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a> <span id="r118 rd" class="r118 r">assignmentStatementAst</span>)
        {
            <span class="c">// Make sure LHS is something that can be assigned to.</span>
            <span class="i">CheckAssignmentTarget</span>(<span class="r118 r">assignmentStatementAst</span>.<a href="ast.cs.html#737e87d58bda06dc" class="i property">Left</a>, <span class="r118 r">assignmentStatementAst</span>.<a href="ast.cs.html#2712fe866a1a962b" class="i property">Operator</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d78e08594ff6b79a" class="i field">Equals</a>,
                <span id="r119 rd" class="r119 r">ast</span> =&gt; <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r119 r">ast</span>.<span class="i">Extent</span>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidLeftHandSide</span>),
                    <span class="i">ParserStrings</span>.<span class="i">InvalidLeftHandSide</span>));
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="c949efc35a4509ed" href="../../R/c949efc35a4509ed.html" target="n" data-glyph="72,1" class="i method">VisitBinaryExpression</a>(<a href="ast.cs.html#f3e3848ef2eae593" class="t t">BinaryExpressionAst</a> <span id="r120 rd" class="r120 r">binaryExpressionAst</span>)
        {
            <b>if</b> (<span class="r120 r">binaryExpressionAst</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#074f3be81f88796f" class="i field">AndAnd</a>
                || <span class="r120 r">binaryExpressionAst</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a07cbb74e75a87a" class="i field">OrOr</a>)
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r120 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidEndOfLine</span>),
                    <span class="i">ParserStrings</span>.<span class="i">InvalidEndOfLine</span>,
                    <span class="r120 r">binaryExpressionAst</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="fb1db4bc1c3f06f1" href="../../R/fb1db4bc1c3f06f1.html" target="n" data-glyph="72,1" class="i method">VisitUnaryExpression</a>(<a href="ast.cs.html#ee62c8a99269d267" class="t t">UnaryExpressionAst</a> <span id="r121 rd" class="r121 r">unaryExpressionAst</span>)
        {
            <b>switch</b> (<span class="r121 r">unaryExpressionAst</span>.<a href="ast.cs.html#1ce84eccd8a75fa0" class="i property">TokenKind</a>)
            {
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#93a18b78948c1c09" class="i field">PlusPlus</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a49966ed41b2bd06" class="i field">PostfixPlusPlus</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3d9a9ff2e958417f" class="i field">MinusMinus</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a3018df4a2c2998" class="i field">PostfixMinusMinus</a>:
                    <span class="i">CheckAssignmentTarget</span>(<span class="r121 r">unaryExpressionAst</span>.<a href="ast.cs.html#ca72754d5d4d5410" class="i property">Child</a>, <b>false</b>,
                        <span id="r122 rd" class="r122 r">ast</span> =&gt; <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r122 r">ast</span>.<span class="i">Extent</span>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">OperatorRequiresVariableOrProperty</span>),
                            <span class="i">ParserStrings</span>.<span class="i">OperatorRequiresVariableOrProperty</span>,
                            <span class="r121 r">unaryExpressionAst</span>.<a href="ast.cs.html#1ce84eccd8a75fa0" class="i property">TokenKind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>()));
                    <b>break</b>;
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="1b1913b541068a31" href="../../R/1b1913b541068a31.html" target="n" data-glyph="72,1" class="i method">VisitConvertExpression</a>(<a href="ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a> <span id="r123 rd" class="r123 r">convertExpressionAst</span>)
        {
            <b>if</b> (<span class="r123 r">convertExpressionAst</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>.<span class="i">Equals</span>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#09ceaaf5116a37fd" class="i field">OrderedAttribute</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<span class="r123 r">convertExpressionAst</span>.<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a> <b>is not</b> <a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a>)
                {
                    <span class="c">// We allow the ordered attribute only on hashliteral node.</span>
                    <span class="c">// This check covers the following scenario</span>
                    <span class="c">//   $a = [ordered]10</span>
                    <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r123 r">convertExpressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">OrderedAttributeOnlyOnHashLiteralNode</span>),
                        <span class="i">ParserStrings</span>.<span class="i">OrderedAttributeOnlyOnHashLiteralNode</span>,
                        <span class="r123 r">convertExpressionAst</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>);
                }
            }
 
            <b>if</b> (<b>typeof</b>(<a href="../MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>) == <span class="r123 r">convertExpressionAst</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>())
            {
                <span class="c">// Check for [ref][ref]</span>
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r124 rd" class="r124 r">child</span> = <span class="r123 r">convertExpressionAst</span>.<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a>;
                <b>bool</b> <span id="r125 rd" class="r125 r">multipleRefs</span> = <b>false</b>;
                <b>while</b> (<b>true</b>)
                {
                    <a href="ast.cs.html#434eb922ec6ac95b" class="k">var</a> <span id="r126 rd" class="r126 r">childAttrExpr</span> = <span class="r124 r">child</span> <b>as</b> <a href="ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>;
                    <b>if</b> (<span class="r126 r">childAttrExpr</span> != <b>null</b>)
                    {
                        <a href="ast.cs.html#49daf252fdb62723" class="k">var</a> <span id="r127 rd" class="r127 r">childConvert</span> = <span class="r126 r">childAttrExpr</span> <b>as</b> <a href="ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a>;
                        <b>if</b> (<span class="r127 r">childConvert</span> != <b>null</b> &amp;&amp; <b>typeof</b>(<a href="../MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>) == <span class="r127 r">childConvert</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>())
                        {
                            <span class="r125 r">multipleRefs</span> = <b>true</b>;
                            <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r127 r">childConvert</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ReferenceNeedsToBeByItselfInTypeSequence</span>),
                                                <span class="i">ParserStrings</span>.<span class="i">ReferenceNeedsToBeByItselfInTypeSequence</span>);
                        }
 
                        <span class="r124 r">child</span> = <span class="r126 r">childAttrExpr</span>.<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a>;
                        <b>continue</b>;
                    }
 
                    <b>break</b>;
                }
 
                <span class="c">// Check for [int][ref], but don&#39;t add an extra error for [ref][ref].</span>
                <a href="ast.cs.html#434eb922ec6ac95b" class="k">var</a> <span id="r128 rd" class="r128 r">parent</span> = <span class="r123 r">convertExpressionAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>;
                <b>while</b> (<span class="r128 r">parent</span> != <b>null</b>)
                {
                    <a href="ast.cs.html#49daf252fdb62723" class="k">var</a> <span id="r129 rd" class="r129 r">parentConvert</span> = <span class="r128 r">parent</span> <b>as</b> <a href="ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a>;
                    <b>if</b> (<span class="r129 r">parentConvert</span> != <b>null</b> &amp;&amp; !<span class="r125 r">multipleRefs</span>)
                    {
                        <b>if</b> (<b>typeof</b>(<a href="../MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>) == <span class="r129 r">parentConvert</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>())
                        {
                            <b>break</b>;
                        }
 
                        <span class="c">// Don&#39;t complain if on the lhs of an assign, there is a different error message, and</span>
                        <span class="c">// that is checked as part of assignment.</span>
                        <a href="ast.cs.html#d47621d83efd14de" class="k">var</a> <span id="r130 rd" class="r130 r">ast</span> = <span class="r128 r">parent</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                        <b>bool</b> <span id="r131 rd" class="r131 r">skipError</span> = <b>false</b>;
                        <b>while</b> (<span class="r130 r">ast</span> != <b>null</b>)
                        {
                            <a href="ast.cs.html#da5f345864f42e06" class="k">var</a> <span id="r132 rd" class="r132 r">statementAst</span> = <span class="r130 r">ast</span> <b>as</b> <a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a>;
                            <b>if</b> (<span class="r132 r">statementAst</span> != <b>null</b>)
                            {
                                <span class="r131 r">skipError</span> = <span class="r132 r">statementAst</span>.<a href="ast.cs.html#737e87d58bda06dc" class="i property">Left</a>.<span class="i">Find</span>(<span id="r133 rd" class="r133 r">ast1</span> =&gt; <span class="r133 r">ast1</span> == <span class="r123 r">convertExpressionAst</span>, <span class="i">searchNestedScriptBlocks</span>: <b>true</b>) != <b>null</b>;
                                <b>break</b>;
                            }
 
                            <b>if</b> (<span class="r130 r">ast</span> <b>is</b> <a href="ast.cs.html#f4da818a29387c5d" class="t t">CommandExpressionAst</a>)
                            {
                                <b>break</b>;
                            }
 
                            <span class="r130 r">ast</span> = <span class="r130 r">ast</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                        }
 
                        <b>if</b> (!<span class="r131 r">skipError</span>)
                        {
                            <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r123 r">convertExpressionAst</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ReferenceNeedsToBeLastTypeInTypeConversion</span>),
                                                <span class="i">ParserStrings</span>.<span class="i">ReferenceNeedsToBeLastTypeInTypeConversion</span>);
                        }
                    }
 
                    <span class="r128 r">parent</span> = <span class="r128 r">parent</span>.<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a> <b>as</b> <a href="ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>;
                }
            }
 
            <span class="c">// Converting to Type is suspicious</span>
            <b>if</b> (<b>typeof</b>(<span class="i">Type</span>) == <span class="r123 r">convertExpressionAst</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>())
            {
                <a href="#f87d30c6816bba4f" class="i method">MarkAstParentsAsSuspicious</a>(<span class="r123 r">convertExpressionAst</span>);
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="0f331976e02d26d4" href="../../R/0f331976e02d26d4.html" target="n" data-glyph="72,1" class="i method">VisitUsingExpression</a>(<a href="ast.cs.html#42d36b88817a807f" class="t t">UsingExpressionAst</a> <span id="r134 rd" class="r134 r">usingExpressionAst</span>)
        {
            <span class="c">// The parser will parse anything that could start with a variable when</span>
            <span class="c">// creating a UsingExpressionAst, but we will only support &quot;simple&quot;</span>
            <span class="c">// property and array references with no side effects.</span>
 
            <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r135 rd" class="r135 r">exprAst</span> = <span class="r134 r">usingExpressionAst</span>.<a href="ast.cs.html#eb8bbf44ea3ab101" class="i property">SubExpression</a>;
            <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r136 rd" class="r136 r">badExpr</span> = <a href="#c95ea85846f5bf78" class="i method">CheckUsingExpression</a>(<span class="r135 r">exprAst</span>);
            <b>if</b> (<span class="r136 r">badExpr</span> != <b>null</b>)
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r136 r">badExpr</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidUsingExpression</span>),
                    <span class="i">ParserStrings</span>.<span class="i">InvalidUsingExpression</span>);
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="c95ea85846f5bf78" href="../../R/c95ea85846f5bf78.html" target="n" data-glyph="76,1" class="i method">CheckUsingExpression</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r137 rd" class="r137 r">exprAst</span>)
        {
            <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
            <b>if</b> (<span class="r137 r">exprAst</span> <b>is</b> <a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="ast.cs.html#a3e8bc64452a67d0" class="k">var</a> <span id="r138 rd" class="r138 r">memberExpr</span> = <span class="r137 r">exprAst</span> <b>as</b> <a href="ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a>;
            <b>if</b> (<span class="r138 r">memberExpr</span> != <b>null</b>
                &amp;&amp; <span class="r138 r">memberExpr</span> <b>is not</b> <a href="ast.cs.html#be11dcb1e53f56b8" class="t t">InvokeMemberExpressionAst</a>
                &amp;&amp; <span class="r138 r">memberExpr</span>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a> <b>is</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)
            {
                <b>return</b> <a href="#c95ea85846f5bf78" class="i method">CheckUsingExpression</a>(<span class="r138 r">memberExpr</span>.<a href="ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>);
            }
 
            <a href="ast.cs.html#4587e325068530ec" class="k">var</a> <span id="r139 rd" class="r139 r">indexExpr</span> = <span class="r137 r">exprAst</span> <b>as</b> <a href="ast.cs.html#4587e325068530ec" class="t t">IndexExpressionAst</a>;
            <b>if</b> (<span class="r139 r">indexExpr</span> != <b>null</b>)
            {
                <b>if</b> (!<a href="#7d0ce99493959699" class="i method">IsValidAttributeArgument</a>(<span class="r139 r">indexExpr</span>.<a href="ast.cs.html#2e5c6ad17318d78c" class="i property">Index</a>, <a href="#880cbf0bcfd99414" class="i field">s_isConstantAttributeArgVisitor</a>))
                {
                    <b>return</b> <span class="r139 r">indexExpr</span>.<a href="ast.cs.html#2e5c6ad17318d78c" class="i property">Index</a>;
                }
 
                <b>return</b> <a href="#c95ea85846f5bf78" class="i method">CheckUsingExpression</a>(<span class="r139 r">indexExpr</span>.<a href="ast.cs.html#4340a50f115f7fdd" class="i property">Target</a>);
            }
 
            <b>return</b> <span class="r137 r">exprAst</span>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="a3826ec3591e3414" href="../../R/a3826ec3591e3414.html" target="n" data-glyph="72,1" class="i method">VisitVariableExpression</a>(<a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r140 rd" class="r140 r">variableExpressionAst</span>)
        {
            <b>if</b> (<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#7f1485a08eb97fcc" class="i property">Splatted</a>
                &amp;&amp; <span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is not</b> <a href="ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>
                &amp;&amp; <span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is not</b> <a href="ast.cs.html#42d36b88817a807f" class="t t">UsingExpressionAst</a>)
            {
                <b>if</b> (<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a> &amp;&amp; <span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>)
                {
                    <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">SplattingNotPermittedInArgumentList</span>),
                        <span class="i">ParserStrings</span>.<span class="i">SplattingNotPermittedInArgumentList</span>,
                        <span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>);
                }
                <b>else</b>
                {
                    <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">SplattingNotPermitted</span>),
                        <span class="i">ParserStrings</span>.<span class="i">SplattingNotPermitted</span>,
                        <span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>);
                }
            }
 
            <b>if</b> (<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#6af6d06d3e3c5d67" class="i property">IsVariable</a>)
            {
                <b>if</b> (<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d2fd06bce4ae1ac6" class="i property">TupleIndex</a> == <a href="VariableAnalysis.cs.html#3d310869db3a3b73" class="t t">VariableAnalysis</a>.<a href="VariableAnalysis.cs.html#1df8fb0284c85f3f" class="i field">ForceDynamic</a>
                    &amp;&amp; !<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#b89fc366bed34f46" class="i property">Assigned</a>
                    &amp;&amp; !<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#d9aea63a59fab144" class="i property">IsGlobal</a>
                    &amp;&amp; !<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#371f4864f3877b8e" class="i property">IsScript</a>
                    &amp;&amp; !<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#1f31fa8ef6d4e586" class="i method">IsConstantVariable</a>()
                    &amp;&amp; !<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#9417bfc8d8bc6ef0" class="i method">IsImplicitVariableAccessibleInClassMethod</a>(<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>))
                {
                    <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">VariableNotLocal</span>),
                        <span class="i">ParserStrings</span>.<span class="i">VariableNotLocal</span>);
                }
            }
 
            <b>if</b> (<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>.<span class="i">Equals</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#e7c9d57b99950a65" class="i field">This</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <b>if</b> (<a href="#756aac413dc7e40c" class="i method">AnalyzingStaticMember</a>())
                {
                    <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">NonStaticMemberAccessInStaticMember</span>),
                        <span class="i">ParserStrings</span>.<span class="i">NonStaticMemberAccessInStaticMember</span>,
                        <span class="r140 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>);
                }
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="6dfe9383c6615ba3" href="../../R/6dfe9383c6615ba3.html" target="n" data-glyph="72,1" class="i method">VisitHashtable</a>(<a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r141 rd" class="r141 r">hashtableAst</span>)
        {
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r142 rd" class="r142 r">keys</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<b>var</b> <span id="r143 rd" class="r143 r">entry</span> <b>in</b> <span class="r141 r">hashtableAst</span>.<a href="ast.cs.html#87313f35bc2b66d9" class="i property">KeyValuePairs</a>)
            {
                <a href="ast.cs.html#ebd8ad798cde7861" class="k">var</a> <span id="r144 rd" class="r144 r">keyStrAst</span> = <span class="r143 r">entry</span>.<span class="i">Item1</span> <b>as</b> <a href="ast.cs.html#ebd8ad798cde7861" class="t t">ConstantExpressionAst</a>;
                <b>if</b> (<span class="r144 r">keyStrAst</span> != <b>null</b>)
                {
                    <b>var</b> <span id="r145 rd" class="r145 r">keyStr</span> = <span class="r144 r">keyStrAst</span>.<a href="ast.cs.html#8e2d2054af044253" class="i property">Value</a>.<span class="i">ToString</span>();
                    <b>if</b> (<span class="r142 r">keys</span>.<span class="i">Contains</span>(<span class="r145 r">keyStr</span>))
                    {
                        <b>string</b> <span id="r146 rd" class="r146 r">errorId</span>;
                        <b>string</b> <span id="r147 rd" class="r147 r">errorMsg</span>;
                        <b>if</b> (<span class="r141 r">hashtableAst</span>.<a href="ast.cs.html#6706cae89a393ac3" class="i property">IsSchemaElement</a>)
                        {
                            <span class="r146 r">errorId</span> = <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DuplicatePropertyInInstanceDefinition</span>);
                            <span class="r147 r">errorMsg</span> = <span class="i">ParserStrings</span>.<span class="i">DuplicatePropertyInInstanceDefinition</span>;
                        }
                        <b>else</b>
                        {
                            <span class="r146 r">errorId</span> = <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DuplicateKeyInHashLiteral</span>);
                            <span class="r147 r">errorMsg</span> = <span class="i">ParserStrings</span>.<span class="i">DuplicateKeyInHashLiteral</span>;
                        }
 
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r143 r">entry</span>.<span class="i">Item1</span>.<span class="i">Extent</span>, <span class="r146 r">errorId</span>, <span class="r147 r">errorMsg</span>, <span class="r145 r">keyStr</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r142 r">keys</span>.<span class="i">Add</span>(<span class="r145 r">keyStr</span>);
                    }
                }
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="f9b6481a4c898eef" href="../../R/f9b6481a4c898eef.html" target="n" data-glyph="72,1" class="i method">VisitAttributedExpression</a>(<a href="ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a> <span id="r148 rd" class="r148 r">attributedExpressionAst</span>)
        {
            <span class="c">// The attribute (and not the entire expression) is used for the error extent.</span>
            <a href="ast.cs.html#35c989f6a7b4eace" class="k">var</a> <span id="r149 rd" class="r149 r">errorAst</span> = <span class="r148 r">attributedExpressionAst</span>.<a href="ast.cs.html#29f1db02fe3920d7" class="i property">Attribute</a>;
            <b>while</b> (<span class="r148 r">attributedExpressionAst</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r148 r">attributedExpressionAst</span>.<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a> <b>is</b> <a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>)
                {
                    <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
                }
 
                <span class="r148 r">attributedExpressionAst</span> = <span class="r148 r">attributedExpressionAst</span>.<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a> <b>as</b> <a href="ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>;
            }
 
            <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r149 r">errorAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedAttribute</span>),
                <span class="i">ParserStrings</span>.<span class="i">UnexpectedAttribute</span>,
                <span class="r149 r">errorAst</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="7cabdeb4bfbdde3b" href="../../R/7cabdeb4bfbdde3b.html" target="n" data-glyph="72,1" class="i method">VisitBlockStatement</a>(<a href="ast.cs.html#0a993ec4b360d318" class="t t">BlockStatementAst</a> <span id="r150 rd" class="r150 r">blockStatementAst</span>)
        {
            <b>if</b> (<span class="r150 r">blockStatementAst</span>.<a href="ast.cs.html#af9f0cd8f2a43a97" class="i method">IsInWorkflow</a>())
            {
                <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            }
 
            <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r150 r">blockStatementAst</span>.<a href="ast.cs.html#340b3bead04c5562" class="i property">Kind</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedKeyword</span>),
                <span class="i">ParserStrings</span>.<span class="i">UnexpectedKeyword</span>,
                <span class="r150 r">blockStatementAst</span>.<a href="ast.cs.html#340b3bead04c5562" class="i property">Kind</a>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="25d7cc53ab79bc34" href="../../R/25d7cc53ab79bc34.html" target="n" data-glyph="72,1" class="i method">VisitMemberExpression</a>(<a href="ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a> <span id="r151 rd" class="r151 r">memberExpressionAst</span>)
        {
            <a href="#662e90ffde7025b4" class="i method">CheckMemberAccess</a>(<span class="r151 r">memberExpressionAst</span>);
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="9becaa599e9c1acd" href="../../R/9becaa599e9c1acd.html" target="n" data-glyph="72,1" class="i method">VisitInvokeMemberExpression</a>(<a href="ast.cs.html#be11dcb1e53f56b8" class="t t">InvokeMemberExpressionAst</a> <span id="r152 rd" class="r152 r">memberExpressionAst</span>)
        {
            <a href="#662e90ffde7025b4" class="i method">CheckMemberAccess</a>(<span class="r152 r">memberExpressionAst</span>);
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>private static void</b> <a id="662e90ffde7025b4" href="../../R/662e90ffde7025b4.html" target="n" data-glyph="76,1" class="i method">CheckMemberAccess</a>(<a href="ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a> <span id="r153 rd" class="r153 r">ast</span>)
        {
            <span class="c">// If the member access is not constant, it may be considered suspicious</span>
            <b>if</b> (<span class="r153 r">ast</span>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a> <b>is not</b> <a href="ast.cs.html#ebd8ad798cde7861" class="t t">ConstantExpressionAst</a>)
            {
                <a href="#f87d30c6816bba4f" class="i method">MarkAstParentsAsSuspicious</a>(<span class="r153 r">ast</span>);
            }
 
            <a href="ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a> <span id="r154 rd" class="r154 r">typeExpression</span> = <span class="r153 r">ast</span>.<a href="ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a> <b>as</b> <a href="ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a>;
 
            <span class="c">// If this is static access on a variable, it may be suspicious</span>
            <b>if</b> (<span class="r153 r">ast</span>.<a href="ast.cs.html#b882770eb12defeb" class="i property">Static</a> &amp;&amp; (<span class="r154 r">typeExpression</span> == <b>null</b>))
            {
                <a href="#f87d30c6816bba4f" class="i method">MarkAstParentsAsSuspicious</a>(<span class="r153 r">ast</span>);
            }
        }
 
        <span class="c">// Mark all of the parents of an AST as suspicious</span>
        <b>private static void</b> <a id="f87d30c6816bba4f" href="../../R/f87d30c6816bba4f.html" target="n" data-glyph="76,1" class="i method">MarkAstParentsAsSuspicious</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r155 rd" class="r155 r">ast</span>)
        {
            <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r156 rd" class="r156 r">targetAst</span> = <span class="r155 r">ast</span>;
            <a href="ast.cs.html#d47621d83efd14de" class="k">var</a> <span id="r157 rd" class="r157 r">parent</span> = <span class="r155 r">ast</span>;
 
            <b>while</b> (<span class="r157 r">parent</span> != <b>null</b>)
            {
                <span class="r156 r">targetAst</span> = <span class="r157 r">parent</span>;
                <span class="r156 r">targetAst</span>.<a href="ast.cs.html#6c2f95c8b079b507" class="i property">HasSuspiciousContent</a> = <b>true</b>;
 
                <span class="r157 r">parent</span> = <span class="r157 r">parent</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
            }
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="8b9ba6542ad011e0" href="../../R/8b9ba6542ad011e0.html" target="n" data-glyph="72,1" class="i method">VisitScriptBlock</a>(<a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r158 rd" class="r158 r">scriptBlockAst</span>)
        {
            <a href="#04904f9127a2bdaa" class="i field">_scopeStack</a>.<span class="i">Push</span>(<span class="r158 r">scriptBlockAst</span>);
            <b>if</b> (<span class="r158 r">scriptBlockAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> == <b>null</b>
                || <span class="r158 r">scriptBlockAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a>
                || <span class="r158 r">scriptBlockAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is not</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>)
            {
                <a href="#cd856ddc7105c343" class="i field">_memberScopeStack</a>.<span class="i">Push</span>(<b>null</b>);
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="2367b565e1b0e45c" href="../../R/2367b565e1b0e45c.html" target="n" data-glyph="72,1" class="i method">VisitScriptBlockExpression</a>(<a href="ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a> <span id="r159 rd" class="r159 r">scriptBlockExpressionAst</span>)
        {
            <a href="ast.cs.html#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a> <span id="r160 rd" class="r160 r">configAst</span> = <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>.<a href="ast.cs.html#4ec2535310b60c23" class="i method">GetAncestorAst</a>&lt;<a href="ast.cs.html#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a>&gt;(<span class="r159 r">scriptBlockExpressionAst</span>);
            <span class="c">//</span>
            <span class="c">// Check within a configuration statement, if there is undefined DSC resources (DynamicKeyword) was used</span>
            <span class="c">// for example,</span>
            <span class="c">//</span>
            <span class="c">//      Configuration TestConfig</span>
            <span class="c">//      {</span>
            <span class="c">//          SomeDSCResource bla</span>
            <span class="c">//          {</span>
            <span class="c">//              Property = &quot;value&quot;</span>
            <span class="c">//          }</span>
            <span class="c">//      }</span>
            <span class="c">//</span>
            <span class="c">// SomeDSCResource is not default DSC Resource, in this case, a parse error should be generated to</span>
            <span class="c">// indicate that SomeDSCResource is not defined. Parser generates a command call (CommandAst) to function</span>
            <span class="c">// &quot;SomeDSCResource&quot; followed by a ScriptBlockExpressionAst. Following code check if there are patterns</span>
            <span class="c">// that one ScriptBlockExpressionAst follows a CommandAst, and report Parser error(s) if true.</span>
            <span class="c">//</span>
            <b>if</b> (<span class="r160 r">configAst</span> != <b>null</b>)
            {
                <a href="ast.cs.html#d47621d83efd14de" class="k">var</a> <span id="r161 rd" class="r161 r">ast</span> = <span class="r159 r">scriptBlockExpressionAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>; <span class="c">// Traverse all ancestor ast to find NamedBlockAst</span>
                <a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r162 rd" class="r162 r">statementAst</span> = <b>null</b>; <span class="c">// The nearest ancestor PipelineAst of the &#39;scriptBlockExpressionAst&#39;</span>
                <b>int</b> <span id="r163 rd" class="r163 r">ancestorNodeLevel</span> = 0; <span class="c">// The nearest ancestor PipelineAst should be two level above the &#39;scriptBlockExpressionAst&#39;</span>
                <b>while</b> ((<span class="r161 r">ast</span> != <b>null</b>) &amp;&amp; (<span class="r163 r">ancestorNodeLevel</span> &lt;= 2))
                {
                    <span class="c">//</span>
                    <span class="c">// Find nearest ancestor NamedBlockAst</span>
                    <span class="c">//</span>
                    <a href="ast.cs.html#61c97c02c53bf32d" class="k">var</a> <span id="r164 rd" class="r164 r">namedBlockedAst</span> = <span class="r161 r">ast</span> <b>as</b> <a href="ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a>;
                    <b>if</b> ((<span class="r164 r">namedBlockedAst</span> != <b>null</b>) &amp;&amp; (<span class="r162 r">statementAst</span> != <b>null</b>) &amp;&amp; (<span class="r163 r">ancestorNodeLevel</span> == 2))
                    {
                        <b>int</b> <span id="r165 rd" class="r165 r">index</span> = <span class="r164 r">namedBlockedAst</span>.<a href="ast.cs.html#496f71fcd5c4e6a1" class="i property">Statements</a>.<span class="i">IndexOf</span>(<span class="r162 r">statementAst</span>);
                        <b>if</b> (<span class="r165 r">index</span> &gt; 0)
                        {
                            <span class="c">//</span>
                            <span class="c">// Check if previous Statement is CommandAst</span>
                            <span class="c">//</span>
                            <a href="ast.cs.html#785915ec8547ce9f" class="k">var</a> <span id="r166 rd" class="r166 r">pipelineAst</span> = <span class="r164 r">namedBlockedAst</span>.<a href="ast.cs.html#496f71fcd5c4e6a1" class="i property">Statements</a>[<span class="r165 r">index</span> - 1] <b>as</b> <a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a>;
                            <b>if</b> (<span class="r166 r">pipelineAst</span> != <b>null</b> &amp;&amp; <span class="r166 r">pipelineAst</span>.<a href="ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>.<span class="i">Count</span> == 1)
                            {
                                <a href="ast.cs.html#a310aaa1e0374ddd" class="k">var</a> <span id="r167 rd" class="r167 r">commandAst</span> = <span class="r166 r">pipelineAst</span>.<a href="ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>[0] <b>as</b> <a href="ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>;
                                <b>if</b> (<span class="r167 r">commandAst</span> != <b>null</b> &amp;&amp;
                                    <span class="r167 r">commandAst</span>.<a href="ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>.<span class="i">Count</span> &lt;= 2 &amp;&amp;
                                    <span class="r167 r">commandAst</span>.<a href="ast.cs.html#38c09f0576bc413e" class="i property">DefiningKeyword</a> == <b>null</b>)
                                {
                                    <span class="c">// Here indicates a CommandAst followed by a ScriptBlockExpression,</span>
                                    <span class="c">// which is invalid if the DSC resource is not defined</span>
                                    <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r168 rd" class="r168 r">commandNameAst</span> = <span class="r167 r">commandAst</span>.<a href="ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>[0] <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                                    <b>if</b> (<span class="r168 r">commandNameAst</span> != <b>null</b>)
                                    {
                                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r168 r">commandNameAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ResourceNotDefined</span>),
                                            <span class="i">ParserStrings</span>.<span class="i">ResourceNotDefined</span>,
                                            <span class="r168 r">commandNameAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>);
                                    }
                                }
                            }
                        }
 
                        <b>break</b>;
                    }
 
                    <span class="r162 r">statementAst</span> = <span class="r161 r">ast</span> <b>as</b> <a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a>;
                    <span class="r163 r">ancestorNodeLevel</span>++;
                    <span class="r161 r">ast</span> = <span class="r161 r">ast</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                }
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="99d9919164b14602" href="../../R/99d9919164b14602.html" target="n" data-glyph="72,1" class="i method">VisitUsingStatement</a>(<a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a> <span id="r169 rd" class="r169 r">usingStatementAst</span>)
        {
            <b>bool</b> <span id="r170 rd" class="r170 r">usingKindSupported</span> = <span class="r169 r">usingStatementAst</span>.<a href="ast.cs.html#4b031903ea1b04ed" class="i property">UsingStatementKind</a> == <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#8c39b25da17c5e31" class="i field">Namespace</a> ||
                                      <span class="r169 r">usingStatementAst</span>.<a href="ast.cs.html#4b031903ea1b04ed" class="i property">UsingStatementKind</a> == <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#98acf874996a057c" class="i field">Assembly</a> ||
                                      <span class="r169 r">usingStatementAst</span>.<a href="ast.cs.html#4b031903ea1b04ed" class="i property">UsingStatementKind</a> == <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#4e97afe747960a96" class="i field">Module</a>;
            <b>if</b> (!<span class="r170 r">usingKindSupported</span> ||
                <span class="r169 r">usingStatementAst</span>.<a href="ast.cs.html#3d935e2cfb8a27f1" class="i property">Alias</a> != <b>null</b>)
            {
                <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r169 r">usingStatementAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UsingStatementNotSupported</span>),
                    <span class="i">ParserStrings</span>.<span class="i">UsingStatementNotSupported</span>);
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="91dd6f03b1bc7aa3" href="../../R/91dd6f03b1bc7aa3.html" target="n" data-glyph="72,1" class="i method">VisitConfigurationDefinition</a>(<a href="ast.cs.html#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a> <span id="r171 rd" class="r171 r">configurationDefinitionAst</span>)
        {
            <span class="c">//</span>
            <span class="c">// Check if the ScriptBlockAst contains NamedBlockAst other than the End block</span>
            <span class="c">//</span>
            <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r172 rd" class="r172 r">configBody</span> = <span class="r171 r">configurationDefinitionAst</span>.<a href="ast.cs.html#230f823f9866cee2" class="i property">Body</a>.<a href="ast.cs.html#3155915865e15c92" class="i property">ScriptBlock</a>;
            <b>if</b> (<span class="r172 r">configBody</span>.<a href="ast.cs.html#08794a618a2d04ac" class="i property">BeginBlock</a> != <b>null</b> || <span class="r172 r">configBody</span>.<a href="ast.cs.html#8940fb8f9b3e6444" class="i property">ProcessBlock</a> != <b>null</b> || <span class="r172 r">configBody</span>.<a href="ast.cs.html#4549d1761658a004" class="i property">DynamicParamBlock</a> != <b>null</b>)
            {
                <b>var</b> <span id="r173 rd" class="r173 r">unsupportedNamedBlocks</span> = <b>new</b> <a href="ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a>[] { <span class="r172 r">configBody</span>.<a href="ast.cs.html#08794a618a2d04ac" class="i property">BeginBlock</a>, <span class="r172 r">configBody</span>.<a href="ast.cs.html#8940fb8f9b3e6444" class="i property">ProcessBlock</a>, <span class="r172 r">configBody</span>.<a href="ast.cs.html#4549d1761658a004" class="i property">DynamicParamBlock</a> };
                <b>foreach</b> (<a href="ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r174 rd" class="r174 r">namedBlock</span> <b>in</b> <span class="r173 r">unsupportedNamedBlocks</span>)
                {
                    <b>if</b> (<span class="r174 r">namedBlock</span> != <b>null</b>)
                    {
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r174 r">namedBlock</span>.<a href="ast.cs.html#8ddb2aaad2172b52" class="i property">OpenCurlyExtent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnsupportedNamedBlockInConfiguration</span>),
                            <span class="i">ParserStrings</span>.<span class="i">UnsupportedNamedBlockInConfiguration</span>);
                    }
                }
 
                <span class="c">// ToRemove: No need to continue the parsing if there is no EndBlock, check if (configBody.EndBlock == null)</span>
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="8efe67b9e1e2be66" href="../../R/8efe67b9e1e2be66.html" target="n" data-glyph="72,1" class="i method">VisitDynamicKeywordStatement</a>(<a href="ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a> <span id="r175 rd" class="r175 r">dynamicKeywordStatementAst</span>)
        {
            <span class="c">//////////////////////////////////////////////////////////////////////////////////</span>
            <span class="c">// If a custom action was provided. then invoke it</span>
            <span class="c">//////////////////////////////////////////////////////////////////////////////////</span>
            <b>if</b> (<span class="r175 r">dynamicKeywordStatementAst</span>.<a href="ast.cs.html#0f0688a599c6de89" class="i property">Keyword</a>.<a href="tokenizer.cs.html#31e7c406e5824274" class="i property">SemanticCheck</a> != <b>null</b>)
            {
                <b>try</b>
                {
                    <a href="Parser.cs.html#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r176 rd" class="r176 r">errors</span> = <span class="r175 r">dynamicKeywordStatementAst</span>.<a href="ast.cs.html#0f0688a599c6de89" class="i property">Keyword</a>.<span class="i">SemanticCheck</span>(<span class="r175 r">dynamicKeywordStatementAst</span>);
                    <b>if</b> (<span class="r176 r">errors</span> != <b>null</b> &amp;&amp; <span class="r176 r">errors</span>.<span class="i">Length</span> &gt; 0)
                        <span class="r176 r">errors</span>.<span class="i">ToList</span>().<span class="i">ForEach</span>(<span id="r177 rd" class="r177 r">e</span> =&gt; <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r177 r">e</span>));
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r178 rd" class="r178 r">e</span>)
                {
                    <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r175 r">dynamicKeywordStatementAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DynamicKeywordSemanticCheckException</span>),
                        <span class="i">ParserStrings</span>.<span class="i">DynamicKeywordSemanticCheckException</span>,
                        <span class="r175 r">dynamicKeywordStatementAst</span>.<a href="ast.cs.html#0f0688a599c6de89" class="i property">Keyword</a>.<a href="tokenizer.cs.html#1ab8fd5746dc90ae" class="i property">ResourceName</a>,
                        <span class="r178 r">e</span>.<span class="i">ToString</span>());
                }
            }
 
            <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <span id="r179 rd" class="r179 r">keyword</span> = <span class="r175 r">dynamicKeywordStatementAst</span>.<a href="ast.cs.html#0f0688a599c6de89" class="i property">Keyword</a>;
            <a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r180 rd" class="r180 r">hashtable</span> = <span class="r175 r">dynamicKeywordStatementAst</span>.<a href="ast.cs.html#f158e061c28b7505" class="i property">BodyExpression</a> <b>as</b> <a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a>;
            <b>if</b> (<span class="r180 r">hashtable</span> != <b>null</b>)
            {
                <span class="c">//</span>
                <span class="c">// If it&#39;s a hash table, validate that only valid members have been specified.</span>
                <span class="c">//</span>
                <b>foreach</b> (<b>var</b> <span id="r181 rd" class="r181 r">keyValueTuple</span> <b>in</b> <span class="r180 r">hashtable</span>.<a href="ast.cs.html#87313f35bc2b66d9" class="i property">KeyValuePairs</a>)
                {
                    <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r182 rd" class="r182 r">propName</span> = <span class="r181 r">keyValueTuple</span>.<span class="i">Item1</span> <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                    <b>if</b> (<span class="r182 r">propName</span> == <b>null</b>)
                    {
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r181 r">keyValueTuple</span>.<span class="i">Item1</span>.<span class="i">Extent</span>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ConfigurationInvalidPropertyName</span>),
                            <span class="i">ParserStrings</span>.<span class="i">ConfigurationInvalidPropertyName</span>,
                            <span class="r175 r">dynamicKeywordStatementAst</span>.<a href="ast.cs.html#914807ae6c6aa6f9" class="i property">FunctionName</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                            <span class="r181 r">keyValueTuple</span>.<span class="i">Item1</span>.<span class="i">Extent</span>);
                    }
                    <b>else</b> <b>if</b> (!<span class="r179 r">keyword</span>.<a href="tokenizer.cs.html#5381d21bcf0af976" class="i property">Properties</a>.<span class="i">ContainsKey</span>(<span class="r182 r">propName</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>))
                    {
                        <span class="i">IOrderedEnumerable</span>&lt;<b>string</b>&gt; <span id="r183 rd" class="r183 r">tableKeys</span> = <span class="r179 r">keyword</span>.<a href="tokenizer.cs.html#5381d21bcf0af976" class="i property">Properties</a>.<span class="i">Keys</span>
                            .<span class="i">OrderBy</span>(<b>static</b> <span id="r184 rd" class="r184 r">key</span> =&gt; <span class="r184 r">key</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r182 r">propName</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidInstanceProperty</span>),
                            <span class="i">ParserStrings</span>.<span class="i">InvalidInstanceProperty</span>,
                            <span class="r182 r">propName</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>,
                            <b>string</b>.<span class="i">Join</span>(<span class="s">&quot;&#39;, &#39;&quot;</span>, <span class="r183 r">tableKeys</span>));
                    }
                }
            }
 
            <span class="c">//</span>
            <span class="c">// Check compatibility between DSC Resource and Configuration</span>
            <span class="c">//</span>
            <a href="ast.cs.html#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a> <span id="r185 rd" class="r185 r">configAst</span> = <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>.<a href="ast.cs.html#4ec2535310b60c23" class="i method">GetAncestorAst</a>&lt;<a href="ast.cs.html#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a>&gt;(<span class="r175 r">dynamicKeywordStatementAst</span>);
            <b>if</b> (<span class="r185 r">configAst</span> != <b>null</b>)
            {
                <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <span id="r186 rd" class="r186 r">nameAst</span> = <span class="r175 r">dynamicKeywordStatementAst</span>.<a href="ast.cs.html#783dff95585ad1fe" class="i property">CommandElements</a>[0] <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r186 r">nameAst</span> != <b>null</b>, <span class="s">&quot;nameAst should never be null&quot;</span>);
                <b>var</b> <span id="r187 rd" class="r187 r">extentText</span> = <span class="r186 r">nameAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>.<span class="i">Trim</span>();
                <a href="../Subsystem/DscSubsystem/ICrossPlatformDsc.cs.html#a3416ac15f89aebb" class="t t">ICrossPlatformDsc</a> <span id="r188 rd" class="r188 r">dscSubsystem</span> = <a href="../Subsystem/SubsystemManager.cs.html#6ddf6a3088da961a" class="t t">SubsystemManager</a>.<a href="../Subsystem/SubsystemManager.cs.html#d2d9d349eedfb603" class="i method">GetSubsystem</a>&lt;<a href="../Subsystem/DscSubsystem/ICrossPlatformDsc.cs.html#a3416ac15f89aebb" class="t t">ICrossPlatformDsc</a>&gt;();
                <b>var</b> <span id="r189 rd" class="r189 r">extentTextIsASystemResourceName</span> = (<span class="r188 r">dscSubsystem</span> != <b>null</b>) ? <span class="r188 r">dscSubsystem</span>.<span class="i">IsSystemResourceName</span>(<span class="r187 r">extentText</span>) : <a href="../../DscSupport/CimDSCParser.cs.html#bfd37d71cb227350" class="t t">DscClassCache</a>.<a href="../../DscSupport/CimDSCParser.cs.html#e2f03a2c829bbdce" class="i field">SystemResourceNames</a>.<span class="i">Contains</span>(<span class="r187 r">extentText</span>);
                <b>if</b> (!<span class="r189 r">extentTextIsASystemResourceName</span>)
                {
                    <b>if</b> (<span class="r185 r">configAst</span>.<a href="ast.cs.html#22d89775bd538a61" class="i property">ConfigurationType</a> == <a href="ast.cs.html#786dff667907c54f" class="t t">ConfigurationType</a>.<a href="ast.cs.html#e1069d3c13089322" class="i field">Meta</a> &amp;&amp; !<span class="r175 r">dynamicKeywordStatementAst</span>.<a href="ast.cs.html#0f0688a599c6de89" class="i property">Keyword</a>.<a href="tokenizer.cs.html#6c84b21db0c74fe2" class="i method">IsMetaDSCResource</a>())
                    {
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r186 r">nameAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RegularResourceUsedInMetaConfig</span>),
                            <span class="i">ParserStrings</span>.<span class="i">RegularResourceUsedInMetaConfig</span>,
                            <span class="r186 r">nameAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>);
                    }
                    <b>else</b> <b>if</b> (<span class="r185 r">configAst</span>.<a href="ast.cs.html#22d89775bd538a61" class="i property">ConfigurationType</a> != <a href="ast.cs.html#786dff667907c54f" class="t t">ConfigurationType</a>.<a href="ast.cs.html#e1069d3c13089322" class="i field">Meta</a> &amp;&amp; <span class="r175 r">dynamicKeywordStatementAst</span>.<a href="ast.cs.html#0f0688a599c6de89" class="i property">Keyword</a>.<a href="tokenizer.cs.html#6c84b21db0c74fe2" class="i method">IsMetaDSCResource</a>())
                    {
                        <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r186 r">nameAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MetaConfigurationUsedInRegularConfig</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MetaConfigurationUsedInRegularConfig</span>,
                            <span class="r186 r">nameAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>);
                    }
                }
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="826ece0adf611dde" href="../../R/826ece0adf611dde.html" target="n" data-glyph="72,1" class="i method">VisitPropertyMember</a>(<a href="ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a> <span id="r190 rd" class="r190 r">propertyMemberAst</span>)
        {
            <b>if</b> (<span class="r190 r">propertyMemberAst</span>.<a href="ast.cs.html#15850665413648cb" class="i property">PropertyType</a> != <b>null</b>)
            {
                <span class="c">// Type must be resolved, but if it&#39;s not, the error was reported by the symbol resolver.</span>
                <b>var</b> <span id="r191 rd" class="r191 r">type</span> = <span class="r190 r">propertyMemberAst</span>.<a href="ast.cs.html#15850665413648cb" class="i property">PropertyType</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
 
                <b>if</b> (<span class="r191 r">type</span> != <b>null</b> &amp;&amp; (<span class="r191 r">type</span> == <b>typeof</b>(<b>void</b>) || <span class="r191 r">type</span>.<span class="i">IsGenericTypeDefinition</span>))
                {
                    <a href="#546ca3508218075d" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r190 r">propertyMemberAst</span>.<a href="ast.cs.html#15850665413648cb" class="i property">PropertyType</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TypeNotAllowedForProperty</span>),
                        <span class="i">ParserStrings</span>.<span class="i">TypeNotAllowedForProperty</span>,
                        <span class="r190 r">propertyMemberAst</span>.<a href="ast.cs.html#15850665413648cb" class="i property">PropertyType</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>);
                }
            }
 
            <a href="#cd856ddc7105c343" class="i field">_memberScopeStack</a>.<span class="i">Push</span>(<span class="r190 r">propertyMemberAst</span>);
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public void</b> <a id="bcf5ecea2f9fd8d1" href="../../R/bcf5ecea2f9fd8d1.html" target="n" data-glyph="72,1" class="i method">PostVisit</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r192 rd" class="r192 r">ast</span>)
        {
            <a href="ast.cs.html#6f963589327835a4" class="k">var</a> <span id="r193 rd" class="r193 r">scriptBlockAst</span> = <span class="r192 r">ast</span> <b>as</b> <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a>;
            <b>if</b> (<span class="r193 r">scriptBlockAst</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r193 r">scriptBlockAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> == <b>null</b>
                    || <span class="r193 r">scriptBlockAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a>
                    || <span class="r193 r">scriptBlockAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is not</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>)
                {
                    <a href="#cd856ddc7105c343" class="i field">_memberScopeStack</a>.<span class="i">Pop</span>();
                }
 
                <a href="#04904f9127a2bdaa" class="i field">_scopeStack</a>.<span class="i">Pop</span>();
                <span class="r193 r">scriptBlockAst</span>.<a href="ast.cs.html#cfdef203b60231c5" class="i property">PostParseChecksPerformed</a> = <b>true</b>;
                <span class="c">// at this moment, we could use different parser for the initial syntax check</span>
                <span class="c">// and this _parser for semantic check.</span>
                <span class="c">// that&#39;s why &#39;|=&#39; instead of just &#39;=&#39;.</span>
                <span class="r193 r">scriptBlockAst</span>.<a href="ast.cs.html#5152487ebaa7a76b" class="i property">HadErrors</a> |= <a href="#546ca3508218075d" class="i field">_parser</a>.<a href="Parser.cs.html#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Count</span> &gt; 0;
            }
            <b>else</b> <b>if</b> (<span class="r192 r">ast</span> <b>is</b> <a href="ast.cs.html#6092492a0585632c" class="t t">MemberAst</a>)
            {
                <a href="#cd856ddc7105c343" class="i field">_memberScopeStack</a>.<span class="i">Pop</span>();
            }
        }
    }
 
    <b>internal static class</b> <a id="ab5e2b836ac3fb6d" href="../../R/ab5e2b836ac3fb6d.html" target="n" data-glyph="2,0" class="t t">DscResourceChecker</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if it is a qualified DSC resource type.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r194 r">parser</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r195 r">typeDefinitionAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r196 r">dscResourceAttributeAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="b9befd380e57da89" href="../../R/b9befd380e57da89.html" target="n" data-glyph="74,1" class="i method">CheckType</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r194 rd" class="r194 r">parser</span>, <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r195 rd" class="r195 r">typeDefinitionAst</span>, <a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r196 rd" class="r196 r">dscResourceAttributeAst</span>)
        {
            <b>bool</b> <span id="r197 rd" class="r197 r">hasSet</span> = <b>false</b>;
            <b>bool</b> <span id="r198 rd" class="r198 r">hasTest</span> = <b>false</b>;
            <b>bool</b> <span id="r199 rd" class="r199 r">hasGet</span> = <b>false</b>;
            <b>bool</b> <span id="r200 rd" class="r200 r">hasDefaultCtor</span> = <b>false</b>;
            <b>bool</b> <span id="r201 rd" class="r201 r">hasNonDefaultCtor</span> = <b>false</b>;
            <b>bool</b> <span id="r202 rd" class="r202 r">hasKey</span> = <b>false</b>;
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r196 r">dscResourceAttributeAst</span> != <b>null</b>, <span class="s">&quot;CheckType called only for DSC resources. dscResourceAttributeAst must be non-null.&quot;</span>);
 
            <b>foreach</b> (<b>var</b> <span id="r203 rd" class="r203 r">member</span> <b>in</b> <span class="r195 r">typeDefinitionAst</span>.<a href="ast.cs.html#9f439131b4d83a32" class="i property">Members</a>)
            {
                <a href="ast.cs.html#0c4f2db9a681a977" class="k">var</a> <span id="r204 rd" class="r204 r">functionMemberAst</span> = <span class="r203 r">member</span> <b>as</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>;
 
                <b>if</b> (<span class="r204 r">functionMemberAst</span> != <b>null</b>)
                {
                    <a href="#48f86daa2af4d23c" class="i method">CheckSet</a>(<span class="r204 r">functionMemberAst</span>, <b>ref</b> <span class="r197 r">hasSet</span>);
                    <a href="#68ed9f8747d898f8" class="i method">CheckGet</a>(<span class="r194 r">parser</span>, <span class="r204 r">functionMemberAst</span>, <b>ref</b> <span class="r199 r">hasGet</span>);
                    <a href="#a33adff7d53dac34" class="i method">CheckTest</a>(<span class="r204 r">functionMemberAst</span>, <b>ref</b> <span class="r198 r">hasTest</span>);
 
                    <b>if</b> (<span class="r204 r">functionMemberAst</span>.<a href="ast.cs.html#4faa75be8a2eed76" class="i property">IsConstructor</a> &amp;&amp; !<span class="r204 r">functionMemberAst</span>.<a href="ast.cs.html#d453a785cf1ce2d4" class="i property">IsStatic</a>)
                    {
                        <b>if</b> (<span class="r204 r">functionMemberAst</span>.<a href="ast.cs.html#f958ae4f9695b021" class="i property">Parameters</a>.<span class="i">Count</span> == 0)
                        {
                            <span class="r200 r">hasDefaultCtor</span> = <b>true</b>;
                        }
                        <b>else</b>
                        {
                            <span class="r201 r">hasNonDefaultCtor</span> = <b>true</b>;
                        }
                    }
                }
                <b>else</b>
                {
                    <a href="ast.cs.html#88ad8abafd061e97" class="k">var</a> <span id="r205 rd" class="r205 r">propertyMemberAst</span> = (<a href="ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a>)<span class="r203 r">member</span>;
                    <a href="#ab9faaaba45c653c" class="i method">CheckKey</a>(<span class="r194 r">parser</span>, <span class="r205 r">propertyMemberAst</span>, <b>ref</b> <span class="r202 r">hasKey</span>);
                }
            }
 
            <b>if</b> (<span class="r195 r">typeDefinitionAst</span>.<a href="ast.cs.html#10a87071659a5887" class="i property">BaseTypes</a> != <b>null</b> &amp;&amp; (!<span class="r197 r">hasSet</span> || !<span class="r199 r">hasGet</span> || !<span class="r198 r">hasTest</span> || !<span class="r202 r">hasKey</span>))
            {
                <a href="#b65efe8d4561a3e0" class="i method">LookupRequiredMembers</a>(<span class="r194 r">parser</span>, <span class="r195 r">typeDefinitionAst</span>, <b>ref</b> <span class="r197 r">hasSet</span>, <b>ref</b> <span class="r199 r">hasGet</span>, <b>ref</b> <span class="r198 r">hasTest</span>, <b>ref</b> <span class="r202 r">hasKey</span>);
            }
 
            <b>var</b> <span id="r206 rd" class="r206 r">name</span> = <span class="r195 r">typeDefinitionAst</span>.<a href="ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>;
 
            <b>if</b> (!<span class="r197 r">hasSet</span>)
            {
                <span class="r194 r">parser</span>.<span class="i">ReportError</span>(<span class="r196 r">dscResourceAttributeAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DscResourceMissingSetMethod</span>),
                    <span class="i">ParserStrings</span>.<span class="i">DscResourceMissingSetMethod</span>,
                    <span class="r206 r">name</span>);
            }
 
            <b>if</b> (!<span class="r199 r">hasGet</span>)
            {
                <span class="r194 r">parser</span>.<span class="i">ReportError</span>(<span class="r196 r">dscResourceAttributeAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DscResourceMissingGetMethod</span>),
                    <span class="i">ParserStrings</span>.<span class="i">DscResourceMissingGetMethod</span>,
                    <span class="r206 r">name</span>);
            }
 
            <b>if</b> (!<span class="r198 r">hasTest</span>)
            {
                <span class="r194 r">parser</span>.<span class="i">ReportError</span>(<span class="r196 r">dscResourceAttributeAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DscResourceMissingTestMethod</span>),
                    <span class="i">ParserStrings</span>.<span class="i">DscResourceMissingTestMethod</span>,
                    <span class="r206 r">name</span>);
            }
 
            <b>if</b> (!<span class="r200 r">hasDefaultCtor</span> &amp;&amp; <span class="r201 r">hasNonDefaultCtor</span>)
            {
                <span class="r194 r">parser</span>.<span class="i">ReportError</span>(<span class="r196 r">dscResourceAttributeAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DscResourceMissingDefaultConstructor</span>),
                    <span class="i">ParserStrings</span>.<span class="i">DscResourceMissingDefaultConstructor</span>,
                    <span class="r206 r">name</span>);
            }
 
            <b>if</b> (!<span class="r202 r">hasKey</span>)
            {
                <span class="r194 r">parser</span>.<span class="i">ReportError</span>(<span class="r196 r">dscResourceAttributeAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DscResourceMissingKeyProperty</span>),
                    <span class="i">ParserStrings</span>.<span class="i">DscResourceMissingKeyProperty</span>,
                    <span class="r206 r">name</span>);
            }
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Look up all the way up until find all the required members.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r207 r">parser</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r208 r">typeDefinitionAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The type definition ast of the DSC resource type.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r209 r">hasSet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Flag to indicate if the class contains Set method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r210 r">hasGet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Flag to indicate if the class contains Get method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r211 r">hasTest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Flag to indicate if the class contains Test method.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r212 r">hasKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Flag to indicate if the class contains Key property.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="b65efe8d4561a3e0" href="../../R/b65efe8d4561a3e0.html" target="n" data-glyph="76,1" class="i method">LookupRequiredMembers</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r207 rd" class="r207 r">parser</span>, <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r208 rd" class="r208 r">typeDefinitionAst</span>, <b>ref bool</b> <span id="r209 rd" class="r209 r">hasSet</span>, <b>ref bool</b> <span id="r210 rd" class="r210 r">hasGet</span>, <b>ref bool</b> <span id="r211 rd" class="r211 r">hasTest</span>, <b>ref bool</b> <span id="r212 rd" class="r212 r">hasKey</span>)
        {
            <b>if</b> (<span class="r208 r">typeDefinitionAst</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r209 r">hasSet</span> &amp;&amp; <span class="r210 r">hasGet</span> &amp;&amp; <span class="r211 r">hasTest</span> &amp;&amp; <span class="r212 r">hasKey</span>)
            {
                <b>return</b>;
            }
 
            <b>foreach</b> (<b>var</b> <span id="r213 rd" class="r213 r">baseType</span> <b>in</b> <span class="r208 r">typeDefinitionAst</span>.<a href="ast.cs.html#10a87071659a5887" class="i property">BaseTypes</a>)
            {
                <b>if</b> (!(<span class="r213 r">baseType</span>.<span class="i">TypeName</span> <b>is</b> <a href="ast.cs.html#83b43c1855a09e15" class="t t">TypeName</a> <span id="r214 rd" class="r214 r">baseTypeName</span>))
                {
                    <b>continue</b>;
                }
 
                <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r215 rd" class="r215 r">baseTypeDefinitionAst</span> = <span class="r214 r">baseTypeName</span>.<a href="ast.cs.html#6cfa32d15ba13d9d" class="i field">_typeDefinitionAst</a>;
                <b>if</b> (<span class="r215 r">baseTypeDefinitionAst</span> == <b>null</b> || !<span class="r215 r">baseTypeDefinitionAst</span>.<a href="ast.cs.html#db380593e8b5ec71" class="i property">IsClass</a>)
                {
                    <b>continue</b>;
                }
 
                <b>foreach</b> (<b>var</b> <span id="r216 rd" class="r216 r">member</span> <b>in</b> <span class="r215 r">baseTypeDefinitionAst</span>.<a href="ast.cs.html#9f439131b4d83a32" class="i property">Members</a>)
                {
                    <a href="ast.cs.html#0c4f2db9a681a977" class="k">var</a> <span id="r217 rd" class="r217 r">functionMemberAst</span> = <span class="r216 r">member</span> <b>as</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>;
                    <b>if</b> (<span class="r217 r">functionMemberAst</span> != <b>null</b>)
                    {
                        <a href="#48f86daa2af4d23c" class="i method">CheckSet</a>(<span class="r217 r">functionMemberAst</span>, <b>ref</b> <span class="r209 r">hasSet</span>);
                        <a href="#68ed9f8747d898f8" class="i method">CheckGet</a>(<span class="r207 r">parser</span>, <span class="r217 r">functionMemberAst</span>, <b>ref</b> <span class="r210 r">hasGet</span>);
                        <a href="#a33adff7d53dac34" class="i method">CheckTest</a>(<span class="r217 r">functionMemberAst</span>, <b>ref</b> <span class="r211 r">hasTest</span>);
                    }
                    <b>else</b>
                    {
                        <a href="ast.cs.html#88ad8abafd061e97" class="k">var</a> <span id="r218 rd" class="r218 r">propertyMemberAst</span> = (<a href="ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a>)<span class="r216 r">member</span>;
                        <a href="#ab9faaaba45c653c" class="i method">CheckKey</a>(<span class="r207 r">parser</span>, <span class="r218 r">propertyMemberAst</span>, <b>ref</b> <span class="r212 r">hasKey</span>);
                    }
                }
 
                <b>if</b> (<span class="r215 r">baseTypeDefinitionAst</span>.<a href="ast.cs.html#10a87071659a5887" class="i property">BaseTypes</a> != <b>null</b> &amp;&amp; (!<span class="r209 r">hasSet</span> || !<span class="r210 r">hasGet</span> || !<span class="r211 r">hasTest</span> || !<span class="r212 r">hasKey</span>))
                {
                    <a href="#b65efe8d4561a3e0" class="i method">LookupRequiredMembers</a>(<span class="r207 r">parser</span>, <span class="r215 r">baseTypeDefinitionAst</span>, <b>ref</b> <span class="r209 r">hasSet</span>, <b>ref</b> <span class="r210 r">hasGet</span>, <b>ref</b> <span class="r211 r">hasTest</span>, <b>ref</b> <span class="r212 r">hasKey</span>);
                }
            }
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if it is a Get method with correct return type and signature.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r219 r">parser</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r220 r">functionMemberAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The function member AST.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r221 r">hasGet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if it is a Get method with qualified return type and signature; otherwise, false.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="68ed9f8747d898f8" href="../../R/68ed9f8747d898f8.html" target="n" data-glyph="76,1" class="i method">CheckGet</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r219 rd" class="r219 r">parser</span>, <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a> <span id="r220 rd" class="r220 r">functionMemberAst</span>, <b>ref bool</b> <span id="r221 rd" class="r221 r">hasGet</span>)
        {
            <b>if</b> (<span class="r221 r">hasGet</span>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r220 r">functionMemberAst</span>.<a href="ast.cs.html#4a93ad116ed68e0e" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Get&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                <span class="r220 r">functionMemberAst</span>.<a href="ast.cs.html#f958ae4f9695b021" class="i property">Parameters</a>.<span class="i">Count</span> == 0)
            {
                <b>if</b> (<span class="r220 r">functionMemberAst</span>.<a href="ast.cs.html#9f5c50ce429b8578" class="i property">ReturnType</a> != <b>null</b>)
                {
                    <span class="c">// Return type is of the class we&#39;re defined in</span>
                    <span class="c">// it must return the class type, or array of the class type.</span>
                    <a href="ast.cs.html#8588eb9308b68261" class="k">var</a> <span id="r222 rd" class="r222 r">arrayTypeName</span> = <span class="r220 r">functionMemberAst</span>.<a href="ast.cs.html#9f5c50ce429b8578" class="i property">ReturnType</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a> <b>as</b> <a href="ast.cs.html#8588eb9308b68261" class="t t">ArrayTypeName</a>;
                    <a href="ast.cs.html#83b43c1855a09e15" class="k">var</a> <span id="r223 rd" class="r223 r">typeName</span> =
                        (<span class="r222 r">arrayTypeName</span> != <b>null</b> ? <span class="r222 r">arrayTypeName</span>.<a href="ast.cs.html#0f81729ec1838610" class="i property">ElementType</a> : <span class="r220 r">functionMemberAst</span>.<a href="ast.cs.html#9f5c50ce429b8578" class="i property">ReturnType</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>) <b>as</b>
                            <a href="ast.cs.html#83b43c1855a09e15" class="t t">TypeName</a>;
                    <b>if</b> (<span class="r223 r">typeName</span> == <b>null</b> || <span class="r223 r">typeName</span>.<a href="ast.cs.html#6cfa32d15ba13d9d" class="i field">_typeDefinitionAst</a> != <span class="r220 r">functionMemberAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>)
                    {
                        <span class="r219 r">parser</span>.<span class="i">ReportError</span>(<span class="r220 r">functionMemberAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DscResourceInvalidGetMethod</span>),
                            <span class="i">ParserStrings</span>.<span class="i">DscResourceInvalidGetMethod</span>,
                            ((<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>)<span class="r220 r">functionMemberAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>).<a href="ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>);
                    }
                }
                <b>else</b>
                {
                    <span class="r219 r">parser</span>.<span class="i">ReportError</span>(<span class="r220 r">functionMemberAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DscResourceInvalidGetMethod</span>),
                        <span class="i">ParserStrings</span>.<span class="i">DscResourceInvalidGetMethod</span>,
                        ((<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>)<span class="r220 r">functionMemberAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>).<a href="ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>);
                }
                <span class="c">// Set hasGet to true to stop look up; it may have invalid get</span>
                <span class="r221 r">hasGet</span> = <b>true</b>;
                <b>return</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if it is a Test method with correct return type and signature.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r224 r">functionMemberAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The function member AST.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r225 r">hasTest</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if it is a Test method with qualified return type and signature; otherwise, false.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="a33adff7d53dac34" href="../../R/a33adff7d53dac34.html" target="n" data-glyph="76,1" class="i method">CheckTest</a>(<a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a> <span id="r224 rd" class="r224 r">functionMemberAst</span>, <b>ref bool</b> <span id="r225 rd" class="r225 r">hasTest</span>)
        {
            <b>if</b> (<span class="r225 r">hasTest</span>) <b>return</b>;
            <span class="r225 r">hasTest</span> = (<span class="r224 r">functionMemberAst</span>.<a href="ast.cs.html#4a93ad116ed68e0e" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Test&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                    <span class="r224 r">functionMemberAst</span>.<a href="ast.cs.html#f958ae4f9695b021" class="i property">Parameters</a>.<span class="i">Count</span> == 0 &amp;&amp;
                    <span class="r224 r">functionMemberAst</span>.<a href="ast.cs.html#9f5c50ce429b8578" class="i property">ReturnType</a> != <b>null</b> &amp;&amp;
                    <span class="r224 r">functionMemberAst</span>.<a href="ast.cs.html#9f5c50ce429b8578" class="i property">ReturnType</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>() == <b>typeof</b>(<b>bool</b>));
        }
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Check if it is a Set method with correct return type and signature.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r226 r">functionMemberAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The function member AST.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r227 r">hasSet</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if it is a Set method with qualified return type and signature; otherwise, false.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="48f86daa2af4d23c" href="../../R/48f86daa2af4d23c.html" target="n" data-glyph="76,1" class="i method">CheckSet</a>(<a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a> <span id="r226 rd" class="r226 r">functionMemberAst</span>, <b>ref bool</b> <span id="r227 rd" class="r227 r">hasSet</span>)
        {
            <b>if</b> (<span class="r227 r">hasSet</span>) <b>return</b>;
            <span class="r227 r">hasSet</span> = (<span class="r226 r">functionMemberAst</span>.<a href="ast.cs.html#4a93ad116ed68e0e" class="i property">Name</a>.<span class="i">Equals</span>(<span class="s">&quot;Set&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp;
                    <span class="r226 r">functionMemberAst</span>.<a href="ast.cs.html#f958ae4f9695b021" class="i property">Parameters</a>.<span class="i">Count</span> == 0 &amp;&amp;
                    <span class="r226 r">functionMemberAst</span>.<a href="ast.cs.html#89500cf38f3e53f4" class="i method">IsReturnTypeVoid</a>());
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if it is a key property.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r228 r">parser</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r229 r">propertyMemberAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The property member AST.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r230 r">hasKey</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if it is a key property; otherwise, false.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private static void</b> <a id="ab9faaaba45c653c" href="../../R/ab9faaaba45c653c.html" target="n" data-glyph="76,1" class="i method">CheckKey</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r228 rd" class="r228 r">parser</span>, <a href="ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a> <span id="r229 rd" class="r229 r">propertyMemberAst</span>, <b>ref bool</b> <span id="r230 rd" class="r230 r">hasKey</span>)
        {
            <b>foreach</b> (<b>var</b> <span id="r231 rd" class="r231 r">attr</span> <b>in</b> <span class="r229 r">propertyMemberAst</span>.<a href="ast.cs.html#8ea99b56a0b0002a" class="i property">Attributes</a>)
            {
                <b>if</b> (<span class="r231 r">attr</span>.<span class="i">TypeName</span>.<span class="i">GetReflectionAttributeType</span>() == <b>typeof</b>(<a href="../Attributes.cs.html#4f12f4e96778ea95" class="t t">DscPropertyAttribute</a>))
                {
                    <b>foreach</b> (<b>var</b> <span id="r232 rd" class="r232 r">na</span> <b>in</b> <span class="r231 r">attr</span>.<span class="i">NamedArguments</span>)
                    {
                        <b>if</b> (<span class="r232 r">na</span>.<span class="i">ArgumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;Key&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>object</b> <span id="r233 rd" class="r233 r">attrArgValue</span>;
                            <b>if</b> (<a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<span class="i">IsConstant</span>(<span class="r232 r">na</span>.<span class="i">Argument</span>, <b>out</b> <span class="r233 r">attrArgValue</span>, <span class="i">forAttribute</span>: <b>true</b>, <span class="i">forRequires</span>: <b>false</b>)
                                &amp;&amp; <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#7b42a860769a8de5" class="i method">IsTrue</a>(<span class="r233 r">attrArgValue</span>))
                            {
                                <span class="r230 r">hasKey</span> = <b>true</b>;
 
                                <b>bool</b> <span id="r234 rd" class="r234 r">keyPropertyTypeAllowed</span> = <b>false</b>;
                                <a href="ast.cs.html#34b9d5dbbaca964d" class="k">var</a> <span id="r235 rd" class="r235 r">propertyType</span> = <span class="r229 r">propertyMemberAst</span>.<a href="ast.cs.html#15850665413648cb" class="i property">PropertyType</a>;
                                <b>if</b> (<span class="r235 r">propertyType</span> != <b>null</b>)
                                {
                                    <a href="ast.cs.html#83b43c1855a09e15" class="t t">TypeName</a> <span id="r236 rd" class="r236 r">typeName</span> = <span class="r235 r">propertyType</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a> <b>as</b> <a href="ast.cs.html#83b43c1855a09e15" class="t t">TypeName</a>;
                                    <b>if</b> (<span class="r236 r">typeName</span> != <b>null</b>)
                                    {
                                        <b>var</b> <span id="r237 rd" class="r237 r">type</span> = <span class="r236 r">typeName</span>.<a href="ast.cs.html#0ef2ca70518b0aa3" class="i method">GetReflectionType</a>();
                                        <b>if</b> (<span class="r237 r">type</span> != <b>null</b>)
                                        {
                                            <span class="r234 r">keyPropertyTypeAllowed</span> = <span class="r237 r">type</span> == <b>typeof</b>(<b>string</b>) || <span class="r237 r">type</span>.<a href="../../utils/ExtensionMethods.cs.html#f85f4778e486006c" class="i method">IsInteger</a>();
                                        }
                                        <b>else</b>
                                        {
                                            <a href="ast.cs.html#d7f0bc21c0f10879" class="k">var</a> <span id="r238 rd" class="r238 r">typeDefinitionAst</span> = <span class="r236 r">typeName</span>.<a href="ast.cs.html#6cfa32d15ba13d9d" class="i field">_typeDefinitionAst</a>;
                                            <b>if</b> (<span class="r238 r">typeDefinitionAst</span> != <b>null</b>)
                                            {
                                                <span class="r234 r">keyPropertyTypeAllowed</span> = <span class="r238 r">typeDefinitionAst</span>.<a href="ast.cs.html#26f9adfa0f5150bd" class="i property">IsEnum</a>;
                                            }
                                        }
                                    }
                                }
 
                                <b>if</b> (!<span class="r234 r">keyPropertyTypeAllowed</span>)
                                {
                                    <span class="r228 r">parser</span>.<span class="i">ReportError</span>(<span class="r229 r">propertyMemberAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DscResourceInvalidKeyProperty</span>),
                                        <span class="i">ParserStrings</span>.<span class="i">DscResourceInvalidKeyProperty</span>);
                                }
 
                                <b>return</b>;
                            }
                        }
                    }
                }
            }
        }
    }
 
    <b>internal class</b> <a id="7c9c4e1c1c4e828d" href="../../R/7c9c4e1c1c4e828d.html" target="n" data-glyph="2,0" class="t t">RestrictedLanguageChecker</a> : <a href="PreOrderVisitor.cs.html#0053fb584ec578aa" class="t t">AstVisitor</a>
    {
        <b>private readonly</b> <a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <a id="54c14b48de011558" href="../../R/54c14b48de011558.html" target="n" data-glyph="46,1" class="i field">_parser</a>;
        <b>private readonly</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="8512ef5ed27b669b" href="../../R/8512ef5ed27b669b.html" target="n" data-glyph="46,1" class="i field">_allowedCommands</a>;
        <b>private readonly</b> <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <a id="a6721ee37d82b246" href="../../R/a6721ee37d82b246.html" target="n" data-glyph="46,1" class="i field">_allowedVariables</a>;
        <b>private readonly bool</b> <a id="254a6524aa9aaad4" href="../../R/254a6524aa9aaad4.html" target="n" data-glyph="46,1" class="i field">_allVariablesAreAllowed</a>;
        <b>private readonly bool</b> <a id="136be1eeb4bc495b" href="../../R/136be1eeb4bc495b.html" target="n" data-glyph="46,1" class="i field">_allowEnvironmentVariables</a>;
 
        <b>internal</b> <a id="83c5d1ad64eb6f9a" href="../../R/83c5d1ad64eb6f9a.html" target="n" data-glyph="74,1" class="t constructor">RestrictedLanguageChecker</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r239 rd" class="r239 r">parser</span>, <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r240 rd" class="r240 r">allowedCommands</span>, <span class="i">IEnumerable</span>&lt;<b>string</b>&gt; <span id="r241 rd" class="r241 r">allowedVariables</span>, <b>bool</b> <span id="r242 rd" class="r242 r">allowEnvironmentVariables</span>)
        {
            <a href="#54c14b48de011558" class="i field">_parser</a> = <span class="r239 r">parser</span>;
            <a href="#8512ef5ed27b669b" class="i field">_allowedCommands</a> = <span class="r240 r">allowedCommands</span>;
 
            <b>if</b> (<span class="r241 r">allowedVariables</span> != <b>null</b>)
            {
                <span class="c">// A single &#39;*&#39; allows any variable to be used. The use of a single &#39;*&#39; aligns with the</span>
                <span class="c">// way SessionState.Applications and SessionState.Scripts lists work.</span>
                <b>var</b> <span id="r243 rd" class="r243 r">allowedVariablesList</span> = <span class="r241 r">allowedVariables</span> <b>as</b> <span class="i">IList</span>&lt;<b>string</b>&gt; ?? <span class="r241 r">allowedVariables</span>.<span class="i">ToList</span>();
                <b>if</b> (<span class="r243 r">allowedVariablesList</span>.<span class="i">Count</span> == 1 &amp;&amp; <span class="r243 r">allowedVariablesList</span>.<span class="i">Contains</span>(<span class="s">&quot;*&quot;</span>))
                {
                    <a href="#254a6524aa9aaad4" class="i field">_allVariablesAreAllowed</a> = <b>true</b>;
                }
                <b>else</b>
                {
                    <span class="c">// Allowed variables are the union of the default variables plus any the caller has passed in.</span>
                    <a href="#a6721ee37d82b246" class="i field">_allowedVariables</a> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<a href="#b57c3e6cb502d94e" class="i field">s_defaultAllowedVariables</a>).<span class="i">Union</span>(<span class="r243 r">allowedVariablesList</span>);
                }
            }
            <b>else</b>
            {
                <a href="#a6721ee37d82b246" class="i field">_allowedVariables</a> = <a href="#b57c3e6cb502d94e" class="i field">s_defaultAllowedVariables</a>;
            }
 
            <a href="#136be1eeb4bc495b" class="i field">_allowEnvironmentVariables</a> = <span class="r242 r">allowEnvironmentVariables</span>;
        }
 
        <b>private bool</b> <a id="ae71e7302288eb5a" href="../../R/ae71e7302288eb5a.html" target="n" data-glyph="106,1" class="i property">FoundError</a>
        {
            [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Performance&quot;</span>, <span class="s">&quot;CA1811:AvoidUncalledPrivateCode&quot;</span>)]
            <b>get</b>;
            <b>set</b>;
        }
 
        <b>internal static void</b> <a id="d7593a1e894cebea" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CheckDataStatementLanguageModeAtRuntime</a>(<a href="ast.cs.html#37c175482122764b" class="t t">DataStatementAst</a> <span id="r244 rd" class="r244 r">dataStatementAst</span>, <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r245 rd" class="r245 r">executionContext</span>)
        {
            <span class="c">// If we get here, we have already determined the data statement invokes commands, so</span>
            <span class="c">// we only need to check the language mode.</span>
            <b>if</b> (<span class="r245 r">executionContext</span>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> == <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#9f1205fe78117fc2" class="i field">ConstrainedLanguage</a>)
            {
                <a href="Parser.cs.html#bbf5e856fb3215c5" class="k">var</a> <span id="r246 rd" class="r246 r">parser</span> = <b>new</b> <a href="Parser.cs.html#aee2c3138d83ea53" class="t constructor">Parser</a>();
                <span class="r246 r">parser</span>.<span class="i">ReportError</span>(<span class="r244 r">dataStatementAst</span>.<a href="ast.cs.html#11fb9d287a8e9308" class="i property">CommandsAllowed</a>[0].<span class="i">Extent</span>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DataSectionAllowedCommandDisallowed</span>),
                    <span class="i">ParserStrings</span>.<span class="i">DataSectionAllowedCommandDisallowed</span>);
                <b>throw</b> <b>new</b> <span class="t">ParseException</span>(<span class="r246 r">parser</span>.<a href="Parser.cs.html#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">ToArray</span>());
            }
        }
 
        <b>internal static void</b> <a id="91953a7eeaf72e2c" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CheckDataStatementAstAtRuntime</a>(<a href="ast.cs.html#37c175482122764b" class="t t">DataStatementAst</a> <span id="r247 rd" class="r247 r">dataStatementAst</span>, <b>string</b>[] <span id="r248 rd" class="r248 r">allowedCommands</span>)
        {
            <a href="Parser.cs.html#bbf5e856fb3215c5" class="k">var</a> <span id="r249 rd" class="r249 r">parser</span> = <b>new</b> <a href="Parser.cs.html#aee2c3138d83ea53" class="t constructor">Parser</a>();
            <a href="#7c9c4e1c1c4e828d" class="k">var</a> <span id="r250 rd" class="r250 r">rlc</span> = <b>new</b> <span class="t">RestrictedLanguageChecker</span>(<span class="r249 r">parser</span>, <span class="r248 r">allowedCommands</span>, <b>null</b>, <b>false</b>);
            <span class="r247 r">dataStatementAst</span>.<a href="ast.cs.html#75dab9efd3d1b59e" class="i property">Body</a>.<a href="ast.cs.html#21211804510b17d0" class="i method">InternalVisit</a>(<span class="r250 r">rlc</span>);
            <b>if</b> (<span class="r249 r">parser</span>.<a href="Parser.cs.html#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Count</span> &gt; 0)
            {
                <b>throw</b> <b>new</b> <span class="t">ParseException</span>(<span class="r249 r">parser</span>.<a href="Parser.cs.html#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">ToArray</span>());
            }
        }
 
        <b>internal static void</b> <a id="a9d34e47b69b30a7" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">EnsureUtilityModuleLoaded</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r251 rd" class="r251 r">context</span>)
        {
            <a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#8acffd0f963a3fa1" class="i method">EnsureModuleLoaded</a>(<span class="s">&quot;Microsoft.PowerShell.Utility&quot;</span>, <span class="r251 r">context</span>);
        }
 
        <b>private void</b> <a id="dcefa3c632014cf0" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ReportError</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r252 rd" class="r252 r">ast</span>, <b>string</b> <span id="r253 rd" class="r253 r">errorId</span>, <b>string</b> <span id="r254 rd" class="r254 r">errorMsg</span>, <b>params object</b>[] <span id="r255 rd" class="r255 r">args</span>)
        {
            <a href="#a23c4933befcf9c8" class="i method">ReportError</a>(<span class="r252 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r253 r">errorId</span>, <span class="r254 r">errorMsg</span>, <span class="r255 r">args</span>);
            <a href="#ae71e7302288eb5a" class="i property">FoundError</a> = <b>true</b>;
        }
 
        <b>private void</b> <a id="a23c4933befcf9c8" href="../../R/a23c4933befcf9c8.html" target="n" data-glyph="76,1" class="i method">ReportError</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r256 rd" class="r256 r">extent</span>, <b>string</b> <span id="r257 rd" class="r257 r">errorId</span>, <b>string</b> <span id="r258 rd" class="r258 r">errorMsg</span>, <b>params object</b>[] <span id="r259 rd" class="r259 r">args</span>)
        {
            <a href="#54c14b48de011558" class="i field">_parser</a>.<a href="Parser.cs.html#681390f471bef368" class="i method">ReportError</a>(<span class="r256 r">extent</span>, <span class="r257 r">errorId</span>, <span class="r258 r">errorMsg</span>, <span class="r259 r">args</span>);
            <a href="#ae71e7302288eb5a" class="i property">FoundError</a> = <b>true</b>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="d31b06bc2425d53f" href="../../R/d31b06bc2425d53f.html" target="n" data-glyph="72,1" class="i method">VisitScriptBlock</a>(<a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r260 rd" class="r260 r">scriptBlockAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r260 r">scriptBlockAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ScriptBlockNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">ScriptBlockNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="e9544af441567a42" href="../../R/e9544af441567a42.html" target="n" data-glyph="72,1" class="i method">VisitParamBlock</a>(<a href="ast.cs.html#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r261 rd" class="r261 r">paramBlockAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r261 r">paramBlockAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ParameterDeclarationNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">ParameterDeclarationNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="ed1e41f17117def9" href="../../R/ed1e41f17117def9.html" target="n" data-glyph="72,1" class="i method">VisitNamedBlock</a>(<a href="ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r262 rd" class="r262 r">namedBlockAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#136be1eeb4bc495b" class="i field">_allowEnvironmentVariables</a> || <a href="#ae71e7302288eb5a" class="i property">FoundError</a>, <span class="s">&quot;VisitScriptBlock should have already reported an error&quot;</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>private void</b> <a id="afc2a13fb32b4899" href="../../R/afc2a13fb32b4899.html" target="n" data-glyph="76,1" class="i method">CheckTypeName</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r263 rd" class="r263 r">ast</span>, <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r264 rd" class="r264 r">typename</span>)
        {
            <span class="i">Type</span> <span id="r265 rd" class="r265 r">type</span> = <span class="r264 r">typename</span>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
 
            <span class="c">// Only allow simple types of arrays of simple types as defined by System.Typecode</span>
            <span class="c">// The permitted types are: Empty, Object, DBNull, Boolean, Char, SByte, Byte,</span>
            <span class="c">// Int16, UInt16, Int32, UInt32, Int64, UInt64, Single, Double, Decimal, DateTime, String</span>
            <span class="c">// We reject anything with a typecode or element typecode of object...</span>
            <span class="c">// If we couldn&#39;t resolve the type, then it&#39;s definitely an error.</span>
            <b>if</b> (<span class="r265 r">type</span> == <b>null</b> || ((<span class="r265 r">type</span>.<span class="i">IsArray</span> ? <span class="r265 r">type</span>.<span class="i">GetElementType</span>() : <span class="r265 r">type</span>).<span class="i">GetTypeCode</span>() == <span class="i">TypeCode</span>.<span class="i">Object</span>))
            {
                <span class="i">ReportError</span>(<span class="r263 r">ast</span>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TypeNotAllowedInDataSection</span>),
                    <span class="i">ParserStrings</span>.<span class="i">TypeNotAllowedInDataSection</span>,
                    <span class="r264 r">typename</span>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>);
            }
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="22b282791125430c" href="../../R/22b282791125430c.html" target="n" data-glyph="72,1" class="i method">VisitTypeConstraint</a>(<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r266 rd" class="r266 r">typeConstraintAst</span>)
        {
            <a href="#afc2a13fb32b4899" class="i method">CheckTypeName</a>(<span class="r266 r">typeConstraintAst</span>, <span class="r266 r">typeConstraintAst</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="d87e6ba1b588d373" href="../../R/d87e6ba1b588d373.html" target="n" data-glyph="72,1" class="i method">VisitAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r267 rd" class="r267 r">attributeAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#ae71e7302288eb5a" class="i property">FoundError</a>, <span class="s">&quot;an error should have been reported elsewhere, making this redunant&quot;</span>);
            <span class="i">ReportError</span>(<span class="r267 r">attributeAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">AttributeNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">AttributeNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="74a72847b1c04065" href="../../R/74a72847b1c04065.html" target="n" data-glyph="72,1" class="i method">VisitParameter</a>(<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a> <span id="r268 rd" class="r268 r">parameterAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#ae71e7302288eb5a" class="i property">FoundError</a>, <span class="s">&quot;VisitParamBlock or VisitFunctionDeclaration should have already reported an error&quot;</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="353697f0001ad317" href="../../R/353697f0001ad317.html" target="n" data-glyph="72,1" class="i method">VisitTypeExpression</a>(<a href="ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a> <span id="r269 rd" class="r269 r">typeExpressionAst</span>)
        {
            <a href="#afc2a13fb32b4899" class="i method">CheckTypeName</a>(<span class="r269 r">typeExpressionAst</span>, <span class="r269 r">typeExpressionAst</span>.<a href="ast.cs.html#c43447ab6269441a" class="i property">TypeName</a>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="3d8568343e79fb9c" href="../../R/3d8568343e79fb9c.html" target="n" data-glyph="72,1" class="i method">VisitFunctionDefinition</a>(<a href="ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r270 rd" class="r270 r">functionDefinitionAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r270 r">functionDefinitionAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">FunctionDeclarationNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">FunctionDeclarationNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="e71caf944ac91961" href="../../R/e71caf944ac91961.html" target="n" data-glyph="72,1" class="i method">VisitStatementBlock</a>(<a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r271 rd" class="r271 r">statementBlockAst</span>)
        {
            <span class="c">// Accepted if no traps and each statement is accepted.</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="d1412f4d13d7a0f1" href="../../R/d1412f4d13d7a0f1.html" target="n" data-glyph="72,1" class="i method">VisitIfStatement</a>(<a href="ast.cs.html#5371982d66a6137d" class="t t">IfStatementAst</a> <span id="r272 rd" class="r272 r">ifStmtAst</span>)
        {
            <span class="c">// If statements are accepted if their conditions and bodies are accepted.</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="d82b5a4a138bd3cf" href="../../R/d82b5a4a138bd3cf.html" target="n" data-glyph="72,1" class="i method">VisitTrap</a>(<a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a> <span id="r273 rd" class="r273 r">trapStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r273 r">trapStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TrapStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">TrapStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="f409ecb3de7719cb" href="../../R/f409ecb3de7719cb.html" target="n" data-glyph="72,1" class="i method">VisitSwitchStatement</a>(<a href="ast.cs.html#4d96f6c979a5266e" class="t t">SwitchStatementAst</a> <span id="r274 rd" class="r274 r">switchStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r274 r">switchStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">SwitchStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">SwitchStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="d12d629aa921d2d3" href="../../R/d12d629aa921d2d3.html" target="n" data-glyph="72,1" class="i method">VisitDataStatement</a>(<a href="ast.cs.html#37c175482122764b" class="t t">DataStatementAst</a> <span id="r275 rd" class="r275 r">dataStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r275 r">dataStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DataSectionStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">DataSectionStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="dff3f3c3df3df550" href="../../R/dff3f3c3df3df550.html" target="n" data-glyph="72,1" class="i method">VisitForEachStatement</a>(<a href="ast.cs.html#9ae6aa2909fef7b0" class="t t">ForEachStatementAst</a> <span id="r276 rd" class="r276 r">forEachStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r276 r">forEachStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ForeachStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">ForeachStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="5104bc1811c2c789" href="../../R/5104bc1811c2c789.html" target="n" data-glyph="72,1" class="i method">VisitDoWhileStatement</a>(<a href="ast.cs.html#b2d1fe560ff56deb" class="t t">DoWhileStatementAst</a> <span id="r277 rd" class="r277 r">doWhileStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r277 r">doWhileStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DoWhileStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">DoWhileStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="280013ec3cc2685c" href="../../R/280013ec3cc2685c.html" target="n" data-glyph="72,1" class="i method">VisitForStatement</a>(<a href="ast.cs.html#4ca51f16f7c100d4" class="t t">ForStatementAst</a> <span id="r278 rd" class="r278 r">forStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r278 r">forStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ForWhileStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">ForWhileStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="947aeaac9bc2e819" href="../../R/947aeaac9bc2e819.html" target="n" data-glyph="72,1" class="i method">VisitWhileStatement</a>(<a href="ast.cs.html#4e9a52b62ed8b2b1" class="t t">WhileStatementAst</a> <span id="r279 rd" class="r279 r">whileStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r279 r">whileStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ForWhileStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">ForWhileStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="cd4f38314d9e621a" href="../../R/cd4f38314d9e621a.html" target="n" data-glyph="72,1" class="i method">VisitCatchClause</a>(<a href="ast.cs.html#fafbccc59f688c0e" class="t t">CatchClauseAst</a> <span id="r280 rd" class="r280 r">catchClauseAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#ae71e7302288eb5a" class="i property">FoundError</a>, <span class="s">&quot;VisitTryStatement should have reported an error&quot;</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="ba190df22ad49017" href="../../R/ba190df22ad49017.html" target="n" data-glyph="72,1" class="i method">VisitTryStatement</a>(<a href="ast.cs.html#9827b5d12d62be7f" class="t t">TryStatementAst</a> <span id="r281 rd" class="r281 r">tryStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r281 r">tryStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TryStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">TryStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="81c2119bb49c5e5c" href="../../R/81c2119bb49c5e5c.html" target="n" data-glyph="72,1" class="i method">VisitBreakStatement</a>(<a href="ast.cs.html#410610c8cad1e99b" class="t t">BreakStatementAst</a> <span id="r282 rd" class="r282 r">breakStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r282 r">breakStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">FlowControlStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">FlowControlStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="6b91a3435bb87008" href="../../R/6b91a3435bb87008.html" target="n" data-glyph="72,1" class="i method">VisitContinueStatement</a>(<a href="ast.cs.html#f8a733d027117fbc" class="t t">ContinueStatementAst</a> <span id="r283 rd" class="r283 r">continueStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r283 r">continueStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">FlowControlStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">FlowControlStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="32bc3618b7dae8e3" href="../../R/32bc3618b7dae8e3.html" target="n" data-glyph="72,1" class="i method">VisitReturnStatement</a>(<a href="ast.cs.html#ba60713bd71ce457" class="t t">ReturnStatementAst</a> <span id="r284 rd" class="r284 r">returnStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r284 r">returnStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">FlowControlStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">FlowControlStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="1378922419388be9" href="../../R/1378922419388be9.html" target="n" data-glyph="72,1" class="i method">VisitExitStatement</a>(<a href="ast.cs.html#c410ad4dd51f9687" class="t t">ExitStatementAst</a> <span id="r285 rd" class="r285 r">exitStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r285 r">exitStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">FlowControlStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">FlowControlStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="7bd8abd92d498ea5" href="../../R/7bd8abd92d498ea5.html" target="n" data-glyph="72,1" class="i method">VisitThrowStatement</a>(<a href="ast.cs.html#07e9c4f5bce4153b" class="t t">ThrowStatementAst</a> <span id="r286 rd" class="r286 r">throwStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r286 r">throwStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">FlowControlStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">FlowControlStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="d434497f0dfc3423" href="../../R/d434497f0dfc3423.html" target="n" data-glyph="72,1" class="i method">VisitDoUntilStatement</a>(<a href="ast.cs.html#d641b5faf306abeb" class="t t">DoUntilStatementAst</a> <span id="r287 rd" class="r287 r">doUntilStatementAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r287 r">doUntilStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DoWhileStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">DoWhileStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="96ec853d923575f0" href="../../R/96ec853d923575f0.html" target="n" data-glyph="72,1" class="i method">VisitAssignmentStatement</a>(<a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a> <span id="r288 rd" class="r288 r">assignmentStatementAst</span>)
        {
            <span class="c">// Assignments are never allowed.</span>
            <span class="i">ReportError</span>(<span class="r288 r">assignmentStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">AssignmentStatementNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">AssignmentStatementNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="14c9ca3c3308931a" href="../../R/14c9ca3c3308931a.html" target="n" data-glyph="72,1" class="i method">VisitPipeline</a>(<a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r289 rd" class="r289 r">pipelineAst</span>)
        {
            <span class="c">// A pipeline is accepted if every command in the pipeline is accepted.</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="2f70270d0b1f4f83" href="../../R/2f70270d0b1f4f83.html" target="n" data-glyph="72,1" class="i method">VisitCommand</a>(<a href="ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r290 rd" class="r290 r">commandAst</span>)
        {
            <span class="c">// Commands are allowed if arguments are allowed, no redirection, no dotting</span>
 
            <span class="c">// If _allowedCommands is null, any command is allowed, otherwise</span>
            <span class="c">// we must check the command name.</span>
 
            <b>if</b> (<span class="r290 r">commandAst</span>.<a href="ast.cs.html#16e18484040f8b6f" class="i property">InvocationOperator</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9023444a1ee3a84" class="i field">Dot</a>)
            {
                <span class="i">ReportError</span>(<span class="r290 r">commandAst</span>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DotSourcingNotSupportedInDataSection</span>),
                    <span class="i">ParserStrings</span>.<span class="i">DotSourcingNotSupportedInDataSection</span>);
                <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            }
 
            <b>if</b> (<a href="#8512ef5ed27b669b" class="i field">_allowedCommands</a> == <b>null</b>)
                <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
 
            <b>string</b> <span id="r291 rd" class="r291 r">commandName</span> = <span class="r290 r">commandAst</span>.<a href="ast.cs.html#14cec84b5558d5c6" class="i method">GetCommandName</a>();
            <b>if</b> (<span class="r291 r">commandName</span> == <b>null</b>)
            {
                <b>if</b> (<span class="r290 r">commandAst</span>.<a href="ast.cs.html#16e18484040f8b6f" class="i property">InvocationOperator</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ed112ae477a73c36" class="i field">Ampersand</a>)
                {
                    <span class="i">ReportError</span>(<span class="r290 r">commandAst</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">OperatorNotSupportedInDataSection</span>),
                        <span class="i">ParserStrings</span>.<span class="i">OperatorNotSupportedInDataSection</span>,
                        <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ed112ae477a73c36" class="i field">Ampersand</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                }
                <b>else</b>
                {
                    <span class="i">ReportError</span>(<span class="r290 r">commandAst</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">CmdletNotInAllowedListForDataSection</span>),
                        <span class="i">ParserStrings</span>.<span class="i">CmdletNotInAllowedListForDataSection</span>,
                        <span class="r290 r">commandAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>);
                }
 
                <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            }
 
            <b>if</b> (<a href="#8512ef5ed27b669b" class="i field">_allowedCommands</a>.<span class="i">Any</span>(<span id="r292 rd" class="r292 r">allowedCommand</span> =&gt; <span class="r292 r">allowedCommand</span>.<span class="i">Equals</span>(<span class="r291 r">commandName</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)))
            {
                <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            }
 
            <span class="i">ReportError</span>(<span class="r290 r">commandAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">CmdletNotInAllowedListForDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">CmdletNotInAllowedListForDataSection</span>,
                <span class="r291 r">commandName</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="a30e0ae52dc8a332" href="../../R/a30e0ae52dc8a332.html" target="n" data-glyph="72,1" class="i method">VisitCommandExpression</a>(<a href="ast.cs.html#f4da818a29387c5d" class="t t">CommandExpressionAst</a> <span id="r293 rd" class="r293 r">commandExpressionAst</span>)
        {
            <span class="c">// allowed if the child expression is allowed</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="65977975b00aeb27" href="../../R/65977975b00aeb27.html" target="n" data-glyph="72,1" class="i method">VisitCommandParameter</a>(<a href="ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r294 rd" class="r294 r">commandParameterAst</span>)
        {
            <span class="c">// allowed if there is no argument, or if the optional argument is allowed</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="fec9bb877802c89f" href="../../R/fec9bb877802c89f.html" target="n" data-glyph="72,1" class="i method">VisitMergingRedirection</a>(<a href="ast.cs.html#57ad2a29a39e91e6" class="t t">MergingRedirectionAst</a> <span id="r295 rd" class="r295 r">mergingRedirectionAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r295 r">mergingRedirectionAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RedirectionNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">RedirectionNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="4945ac152b879ff8" href="../../R/4945ac152b879ff8.html" target="n" data-glyph="72,1" class="i method">VisitFileRedirection</a>(<a href="ast.cs.html#2288e8fa779a0d57" class="t t">FileRedirectionAst</a> <span id="r296 rd" class="r296 r">fileRedirectionAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r296 r">fileRedirectionAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RedirectionNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">RedirectionNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="bd131d5299810129" href="../../R/bd131d5299810129.html" target="n" data-glyph="72,1" class="i method">VisitBinaryExpression</a>(<a href="ast.cs.html#f3e3848ef2eae593" class="t t">BinaryExpressionAst</a> <span id="r297 rd" class="r297 r">binaryExpressionAst</span>)
        {
            <span class="c">// match and notmatch disallowed because they can set $matches</span>
            <span class="c">// -join/-split disallowed because they can be used in tandem to build very large strings, like:</span>
            <span class="c">//    -split (-split ( (&#39;a&#39;,&#39;a&#39;) -join &quot; a a a a a &quot;) -join &quot; a a a a a &quot;)</span>
            <span class="c">// -replace disallowed because it too can be used to build very large strings, like:</span>
            <span class="c">//    (&#39;x&#39; -replace &#39;.&#39;,&#39;xx&#39;) -replace &#39;.&#39;,&#39;xx&#39;</span>
            <span class="c">// -as disallowed because it can invoke arbitrary code (similar to why some casts are disallowed,</span>
            <span class="c">//    but -as is completely disallowed because in some cases, we don&#39;t know the type at parse time.</span>
            <span class="c">// Format disallowed because of unbounded results, like (&quot;{0,&quot; + 1MB + &quot;:0}&quot;) -f 1</span>
            <span class="c">// Range disallowed because it has iteration semantics.</span>
 
            <b>if</b> (<span class="r297 r">binaryExpressionAst</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a>.<a href="token.cs.html#84def6774d758bed" class="i method">HasTrait</a>(<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#d6998268e436d710" class="i field">DisallowedInRestrictedMode</a>))
            {
                <span class="i">ReportError</span>(<span class="r297 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">OperatorNotSupportedInDataSection</span>),
                    <span class="i">ParserStrings</span>.<span class="i">OperatorNotSupportedInDataSection</span>,
                    <span class="r297 r">binaryExpressionAst</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="eafe927ad6aac2ea" href="../../R/eafe927ad6aac2ea.html" target="n" data-glyph="72,1" class="i method">VisitUnaryExpression</a>(<a href="ast.cs.html#ee62c8a99269d267" class="t t">UnaryExpressionAst</a> <span id="r298 rd" class="r298 r">unaryExpressionAst</span>)
        {
            <b>if</b> (<span class="r298 r">unaryExpressionAst</span>.<a href="ast.cs.html#1ce84eccd8a75fa0" class="i property">TokenKind</a>.<a href="token.cs.html#84def6774d758bed" class="i method">HasTrait</a>(<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#d6998268e436d710" class="i field">DisallowedInRestrictedMode</a>))
            {
                <span class="i">ReportError</span>(<span class="r298 r">unaryExpressionAst</span>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">OperatorNotSupportedInDataSection</span>),
                    <span class="i">ParserStrings</span>.<span class="i">OperatorNotSupportedInDataSection</span>,
                    <span class="r298 r">unaryExpressionAst</span>.<a href="ast.cs.html#1ce84eccd8a75fa0" class="i property">TokenKind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="bf6319fe2b562beb" href="../../R/bf6319fe2b562beb.html" target="n" data-glyph="72,1" class="i method">VisitConvertExpression</a>(<a href="ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a> <span id="r299 rd" class="r299 r">convertExpressionAst</span>)
        {
            <span class="c">// Convert is allowed if the type and child is allowed.</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="fd1c59488d14ed0c" href="../../R/fd1c59488d14ed0c.html" target="n" data-glyph="72,1" class="i method">VisitConstantExpression</a>(<a href="ast.cs.html#ebd8ad798cde7861" class="t t">ConstantExpressionAst</a> <span id="r300 rd" class="r300 r">constantExpressionAst</span>)
        {
            <span class="c">// Constants are allowed.</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="cdb8a429d52a1c24" href="../../R/cdb8a429d52a1c24.html" target="n" data-glyph="72,1" class="i method">VisitStringConstantExpression</a>(<a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <span id="r301 rd" class="r301 r">stringConstantExpressionAst</span>)
        {
            <span class="c">// Constants are allowed.</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="34c8e5275f0b6fc8" href="../../R/34c8e5275f0b6fc8.html" target="n" data-glyph="72,1" class="i method">VisitSubExpression</a>(<a href="ast.cs.html#e6552a77ab32112a" class="t t">SubExpressionAst</a> <span id="r302 rd" class="r302 r">subExpressionAst</span>)
        {
            <span class="c">// Sub expression is allowed if the statement block is allowed.</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="c63b70a857ed86d8" href="../../R/c63b70a857ed86d8.html" target="n" data-glyph="72,1" class="i method">VisitUsingExpression</a>(<a href="ast.cs.html#42d36b88817a807f" class="t t">UsingExpressionAst</a> <span id="r303 rd" class="r303 r">usingExpressionAst</span>)
        {
            <span class="c">// Using expression is allowed if the sub-expression is allowed.</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>private static readonly</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt; <a id="b57c3e6cb502d94e" href="../../R/b57c3e6cb502d94e.html" target="n" data-glyph="46,1" class="i field">s_defaultAllowedVariables</a> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>)
                                                                    {<span class="s">&quot;PSCulture&quot;</span>, <span class="s">&quot;PSUICulture&quot;</span>, <span class="s">&quot;true&quot;</span>, <span class="s">&quot;false&quot;</span>, <span class="s">&quot;null&quot;</span>};
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="2267f68adbe12867" href="../../R/2267f68adbe12867.html" target="n" data-glyph="72,1" class="i method">VisitVariableExpression</a>(<a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r304 rd" class="r304 r">variableExpressionAst</span>)
        {
            <a href="../VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r305 rd" class="r305 r">varPath</span> = <span class="r304 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>;
 
            <span class="c">// If the variable is in the list, or the _allVariablesAreAllowed field is set, continue processing</span>
            <b>if</b> (<a href="#254a6524aa9aaad4" class="i field">_allVariablesAreAllowed</a> || <a href="#a6721ee37d82b246" class="i field">_allowedVariables</a>.<span class="i">Contains</span>(<span class="r305 r">varPath</span>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>))
                <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
 
            <b>if</b> (<a href="#136be1eeb4bc495b" class="i field">_allowEnvironmentVariables</a>)
            {
                <span class="c">// Allow access to environment when processing module manifests</span>
                <b>if</b> (<span class="r305 r">varPath</span>.<a href="../VariablePath.cs.html#70f672ec2e5c2bcb" class="i property">IsDriveQualified</a> &amp;&amp; <span class="r305 r">varPath</span>.<a href="../VariablePath.cs.html#88c3e3f5b3aa0d19" class="i property">DriveName</a>.<span class="i">Equals</span>(<span class="s">&quot;env&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
            }
 
            <b>string</b> <span id="r306 rd" class="r306 r">resourceArg</span>;
            <b>if</b> (<span class="i">ReferenceEquals</span>(<a href="#a6721ee37d82b246" class="i field">_allowedVariables</a>, <a href="#b57c3e6cb502d94e" class="i field">s_defaultAllowedVariables</a>))
            {
                <span class="r306 r">resourceArg</span> = <span class="i">ParserStrings</span>.<span class="i">DefaultAllowedVariablesInDataSection</span>;
            }
            <b>else</b>
            {
                <span class="i">StringBuilder</span> <span id="r307 rd" class="r307 r">argBuilder</span> = <b>new</b> <span class="i">StringBuilder</span>();
                <b>bool</b> <span id="r308 rd" class="r308 r">first</span> = <b>true</b>;
 
                <b>foreach</b> (<b>string</b> <span id="r309 rd" class="r309 r">varName</span> <b>in</b> <a href="#a6721ee37d82b246" class="i field">_allowedVariables</a>)
                {
                    <b>if</b> (<span class="r308 r">first</span>)
                        <span class="r308 r">first</span> = <b>false</b>;
                    <b>else</b>
                        <span class="r307 r">argBuilder</span>.<span class="i">Append</span>(<span class="s">&quot;, &quot;</span>);
 
                    <span class="r307 r">argBuilder</span>.<span class="i">Append</span>(<span class="s">&#39;$&#39;</span>);
                    <span class="r307 r">argBuilder</span>.<span class="i">Append</span>(<span class="r309 r">varName</span>);
                }
 
                <span class="r306 r">resourceArg</span> = <span class="r307 r">argBuilder</span>.<span class="i">ToString</span>();
            }
 
            <span class="i">ReportError</span>(<span class="r304 r">variableExpressionAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">VariableReferenceNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">VariableReferenceNotSupportedInDataSection</span>,
                <span class="r306 r">resourceArg</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="c127b5772483e758" href="../../R/c127b5772483e758.html" target="n" data-glyph="72,1" class="i method">VisitMemberExpression</a>(<a href="ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a> <span id="r310 rd" class="r310 r">memberExpressionAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r310 r">memberExpressionAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">PropertyReferenceNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">PropertyReferenceNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="6cbf901d23f2fb38" href="../../R/6cbf901d23f2fb38.html" target="n" data-glyph="72,1" class="i method">VisitInvokeMemberExpression</a>(<a href="ast.cs.html#be11dcb1e53f56b8" class="t t">InvokeMemberExpressionAst</a> <span id="r311 rd" class="r311 r">methodCallAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r311 r">methodCallAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MethodCallNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">MethodCallNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="b42a910aed993093" href="../../R/b42a910aed993093.html" target="n" data-glyph="72,1" class="i method">VisitArrayExpression</a>(<a href="ast.cs.html#6bb067a9fcfafabf" class="t t">ArrayExpressionAst</a> <span id="r312 rd" class="r312 r">arrayExpressionAst</span>)
        {
            <span class="c">// Safe (if children are allowed)</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="c66583a459b0d0dd" href="../../R/c66583a459b0d0dd.html" target="n" data-glyph="72,1" class="i method">VisitArrayLiteral</a>(<a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a> <span id="r313 rd" class="r313 r">arrayLiteralAst</span>)
        {
            <span class="c">// Allowed if elements are allowed.</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="591765ab155d5e02" href="../../R/591765ab155d5e02.html" target="n" data-glyph="72,1" class="i method">VisitHashtable</a>(<a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r314 rd" class="r314 r">hashtableAst</span>)
        {
            <span class="c">// Hash literals are accepted if the keys and values are accepted.</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="176cc52f8d3b102e" href="../../R/176cc52f8d3b102e.html" target="n" data-glyph="72,1" class="i method">VisitScriptBlockExpression</a>(<a href="ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a> <span id="r315 rd" class="r315 r">scriptBlockExpressionAst</span>)
        {
            <span class="i">ReportError</span>(<span class="r315 r">scriptBlockExpressionAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ScriptBlockNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">ScriptBlockNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="1c362c09d60efe8c" href="../../R/1c362c09d60efe8c.html" target="n" data-glyph="72,1" class="i method">VisitParenExpression</a>(<a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a> <span id="r316 rd" class="r316 r">parenExpressionAst</span>)
        {
            <span class="c">// allowed if the child pipeline is allowed.</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="1af1e68c224510cf" href="../../R/1af1e68c224510cf.html" target="n" data-glyph="72,1" class="i method">VisitExpandableStringExpression</a>(<a href="ast.cs.html#dac25e1530bb8b85" class="t t">ExpandableStringExpressionAst</a> <span id="r317 rd" class="r317 r">expandableStringExpressionAst</span>)
        {
            <span class="c">// REVIEW: it should be OK to allow these, since the ast now would visit the nested expressions and catch the errors.</span>
            <span class="c">// Not allowed since most variables are not allowed</span>
            <span class="c">// ReportError(expandableStringExpressionAst, () =&gt; ParserStrings.ExpandableStringNotSupportedInDataSection);</span>
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="9906b7b585911d1d" href="../../R/9906b7b585911d1d.html" target="n" data-glyph="72,1" class="i method">VisitIndexExpression</a>(<a href="ast.cs.html#4587e325068530ec" class="t t">IndexExpressionAst</a> <span id="r318 rd" class="r318 r">indexExpressionAst</span>)
        {
            <span class="c">// Array references are never allowed.  They could turn into function calls.</span>
            <span class="i">ReportError</span>(<span class="r318 r">indexExpressionAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ArrayReferenceNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">ArrayReferenceNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="7d60de70ef6b7f0a" href="../../R/7d60de70ef6b7f0a.html" target="n" data-glyph="72,1" class="i method">VisitAttributedExpression</a>(<a href="ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a> <span id="r319 rd" class="r319 r">attributedExpressionAst</span>)
        {
            <span class="c">// Attributes are not allowed, they may code in attribute constructors.</span>
            <span class="i">ReportError</span>(<span class="r319 r">attributedExpressionAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">AttributeNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">AttributeNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="af65359568289b77" href="../../R/af65359568289b77.html" target="n" data-glyph="72,1" class="i method">VisitBlockStatement</a>(<a href="ast.cs.html#0a993ec4b360d318" class="t t">BlockStatementAst</a> <span id="r320 rd" class="r320 r">blockStatementAst</span>)
        {
            <span class="c">// Keyword blocks are not allowed</span>
            <span class="i">ReportError</span>(<span class="r320 r">blockStatementAst</span>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ParallelAndSequenceBlockNotSupportedInDataSection</span>),
                <span class="i">ParserStrings</span>.<span class="i">ParallelAndSequenceBlockNotSupportedInDataSection</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="27c061433ada7036" href="../../R/27c061433ada7036.html" target="n" data-glyph="72,1" class="i method">VisitNamedAttributeArgument</a>(<a href="ast.cs.html#283d46191e6456a4" class="t t">NamedAttributeArgumentAst</a> <span id="r321 rd" class="r321 r">namedAttributeArgumentAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#ae71e7302288eb5a" class="i property">FoundError</a>, <span class="s">&quot;VisitAttributedExpression or VisitParameter or VisitParamBlock should have issued an error.&quot;</span>);
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
    }
}
</pre></td></tr></table></div></body></html>
