<!DOCTYPE html>
<html><head><title>Compiler.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(7036);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/parser/Compiler.cs" target="_top">engine\parser\Compiler.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Specialized</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Dynamic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>.<span class="i">Expressions</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Interpreter</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>.<span class="i">RegularExpressions</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>
{
    <b>using</b> <span class="i">KeyValuePair</span> = <span class="i">Tuple</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>, <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt;;
    <b>using</b> <span class="i">IfClause</span> = <span class="i">Tuple</span>&lt;<a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a>, <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a>&gt;;
 
    <b>internal static class</b> <a id="7281bb41069e8d62" href="../../R/7281bb41069e8d62.html" target="n" data-glyph="2,0" class="t t">CachedReflectionInfo</a>
    {
        <span class="c">// ReSharper disable InconsistentNaming</span>
        <b>internal const</b> <span class="i">BindingFlags</span> <a id="fe89073d609a457a" href="../../R/fe89073d609a457a.html" target="n" data-glyph="8,1" class="i field">InstanceFlags</a> = <span class="i">BindingFlags</span>.<span class="i">Instance</span> | <span class="i">BindingFlags</span>.<span class="i">NonPublic</span>;
        <b>internal const</b> <span class="i">BindingFlags</span> <a id="b1d43be8b220700c" href="../../R/b1d43be8b220700c.html" target="n" data-glyph="8,1" class="i field">StaticFlags</a> = <span class="i">BindingFlags</span>.<span class="i">Static</span> | <span class="i">BindingFlags</span>.<span class="i">NonPublic</span>;
        <b>internal const</b> <span class="i">BindingFlags</span> <a id="cf19696d28c5ae21" href="../../R/cf19696d28c5ae21.html" target="n" data-glyph="8,1" class="i field">StaticPublicFlags</a> = <span class="i">BindingFlags</span>.<span class="i">Static</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span>;
        <b>internal const</b> <span class="i">BindingFlags</span> <a id="ae109a46a4fa4db9" href="../../R/ae109a46a4fa4db9.html" target="n" data-glyph="8,1" class="i field">InstancePublicFlags</a> = <span class="i">BindingFlags</span>.<span class="i">Instance</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span>;
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="c2ed1032888972a2" href="../../R/c2ed1032888972a2.html" target="n" data-glyph="44,1" class="i field">ObjectList_ctor</a> =
            <b>typeof</b>(<span class="i">List</span>&lt;<b>object</b>&gt;).<span class="i">GetConstructor</span>(<span class="i">Type</span>.<span class="i">EmptyTypes</span>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="a3abf685331a16bb" href="../../R/a3abf685331a16bb.html" target="n" data-glyph="44,1" class="i field">ObjectList_ToArray</a> =
            <b>typeof</b>(<span class="i">List</span>&lt;<b>object</b>&gt;).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">List</span>&lt;<b>object</b>&gt;.<span class="i">ToArray</span>), <span class="i">Type</span>.<span class="i">EmptyTypes</span>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="92da8e8e3b9aa2b8" href="../../R/92da8e8e3b9aa2b8.html" target="n" data-glyph="44,1" class="i field">ArrayOps_GetMDArrayValue</a> =
            <b>typeof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>.<span class="i">GetMDArrayValue</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="ecffc532d73edd94" href="../../R/ecffc532d73edd94.html" target="n" data-glyph="44,1" class="i field">ArrayOps_GetMDArrayValueOrSlice</a> =
            <b>typeof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>.<span class="i">GetMDArrayValueOrSlice</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="5195da915115ed33" href="../../R/5195da915115ed33.html" target="n" data-glyph="44,1" class="i field">ArrayOps_GetNonIndexable</a> =
            <b>typeof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>.<span class="i">GetNonIndexable</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="4f0af9e268afdbc6" href="../../R/4f0af9e268afdbc6.html" target="n" data-glyph="44,1" class="i field">ArrayOps_IndexStringMessage</a> =
            <b>typeof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>.<span class="i">IndexStringMessage</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="68c9d45a92da9ef1" href="../../R/68c9d45a92da9ef1.html" target="n" data-glyph="44,1" class="i field">ArrayOps_Multiply</a> =
            <b>typeof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>.<span class="i">Multiply</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="baf71e0e6efe266a" href="../../R/baf71e0e6efe266a.html" target="n" data-glyph="44,1" class="i field">ArrayOps_SetMDArrayValue</a> =
            <b>typeof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>.<span class="i">SetMDArrayValue</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="2c82148f1c223438" href="../../R/2c82148f1c223438.html" target="n" data-glyph="44,1" class="i field">ArrayOps_SlicingIndex</a> =
            <b>typeof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/ArrayOps.cs.html#5cf5725d7bfacd81" class="t t">ArrayOps</a>.<span class="i">SlicingIndex</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="cb435ee088efa4b0" href="../../R/cb435ee088efa4b0.html" target="n" data-glyph="44,1" class="i field">BreakException_ctor</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#8b17292837a7f9fe" class="t t">BreakException</a>).<span class="i">GetConstructor</span>(<a href="#fe89073d609a457a" class="i field">InstanceFlags</a>, <b>null</b>, <span class="i">CallingConventions</span>.<span class="i">Standard</span>, <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>string</b>) }, <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="993ec92d0a5baaf8" href="../../R/993ec92d0a5baaf8.html" target="n" data-glyph="44,1" class="i field">CharOps_CompareIeq</a> =
            <b>typeof</b>(<a href="../runtime/Operations/NumericOps.cs.html#88852ca408ad1a4b" class="t t">CharOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/NumericOps.cs.html#88852ca408ad1a4b" class="t t">CharOps</a>.<span class="i">CompareIeq</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="de842d2f1859b375" href="../../R/de842d2f1859b375.html" target="n" data-glyph="44,1" class="i field">CharOps_CompareIne</a> =
            <b>typeof</b>(<a href="../runtime/Operations/NumericOps.cs.html#88852ca408ad1a4b" class="t t">CharOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/NumericOps.cs.html#88852ca408ad1a4b" class="t t">CharOps</a>.<span class="i">CompareIne</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="8e0e212ec96eb163" href="../../R/8e0e212ec96eb163.html" target="n" data-glyph="44,1" class="i field">CharOps_CompareStringIeq</a> =
            <b>typeof</b>(<a href="../runtime/Operations/NumericOps.cs.html#88852ca408ad1a4b" class="t t">CharOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/NumericOps.cs.html#88852ca408ad1a4b" class="t t">CharOps</a>.<span class="i">CompareStringIeq</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="20bde489096ac662" href="../../R/20bde489096ac662.html" target="n" data-glyph="44,1" class="i field">CharOps_CompareStringIne</a> =
            <b>typeof</b>(<a href="../runtime/Operations/NumericOps.cs.html#88852ca408ad1a4b" class="t t">CharOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/NumericOps.cs.html#88852ca408ad1a4b" class="t t">CharOps</a>.<span class="i">CompareStringIne</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="ef68c30f8acb5177" href="../../R/ef68c30f8acb5177.html" target="n" data-glyph="44,1" class="i field">CommandParameterInternal_CreateArgument</a> =
            <b>typeof</b>(<a href="../CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateArgument</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="195ec62902920d23" href="../../R/195ec62902920d23.html" target="n" data-glyph="44,1" class="i field">CommandParameterInternal_CreateParameter</a> =
            <b>typeof</b>(<a href="../CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameter</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="2a0f8b0d12c5e68e" href="../../R/2a0f8b0d12c5e68e.html" target="n" data-glyph="44,1" class="i field">CommandParameterInternal_CreateParameterWithArgument</a> =
            <b>typeof</b>(<a href="../CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>.<span class="i">CreateParameterWithArgument</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="128a5a3c25771a1b" href="../../R/128a5a3c25771a1b.html" target="n" data-glyph="44,1" class="i field">CommandRedirection_UnbindForExpression</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#51c59304e4c48b1e" class="t t">CommandRedirection</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#51c59304e4c48b1e" class="t t">CommandRedirection</a>.<span class="i">UnbindForExpression</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="121e16a97b675aa5" href="../../R/121e16a97b675aa5.html" target="n" data-glyph="44,1" class="i field">ContinueException_ctor</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#bef3416feb6ab79b" class="t t">ContinueException</a>).<span class="i">GetConstructor</span>(<a href="#fe89073d609a457a" class="i field">InstanceFlags</a>, <b>null</b>, <span class="i">CallingConventions</span>.<span class="i">Standard</span>, <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>string</b>) }, <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="484b94d4bdfa9e07" href="../../R/484b94d4bdfa9e07.html" target="n" data-glyph="44,1" class="i field">Convert_ChangeType</a> =
            <b>typeof</b>(<span class="i">Convert</span>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">Convert</span>.<span class="i">ChangeType</span>), <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>object</b>), <b>typeof</b>(<span class="i">Type</span>) });
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="e64a64c752430072" href="../../R/e64a64c752430072.html" target="n" data-glyph="44,1" class="i field">Debugger_EnterScriptFunction</a> =
            <b>typeof</b>(<a href="../debugger/debugger.cs.html#0d95bb604662e23b" class="t t">ScriptDebugger</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../debugger/debugger.cs.html#0d95bb604662e23b" class="t t">ScriptDebugger</a>.<span class="i">EnterScriptFunction</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="15ca70a792a7b046" href="../../R/15ca70a792a7b046.html" target="n" data-glyph="44,1" class="i field">Debugger_ExitScriptFunction</a> =
            <b>typeof</b>(<a href="../debugger/debugger.cs.html#0d95bb604662e23b" class="t t">ScriptDebugger</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../debugger/debugger.cs.html#0d95bb604662e23b" class="t t">ScriptDebugger</a>.<span class="i">ExitScriptFunction</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="a62ef515b21207df" href="../../R/a62ef515b21207df.html" target="n" data-glyph="44,1" class="i field">Debugger_OnSequencePointHit</a> =
            <b>typeof</b>(<a href="../debugger/debugger.cs.html#0d95bb604662e23b" class="t t">ScriptDebugger</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../debugger/debugger.cs.html#0d95bb604662e23b" class="t t">ScriptDebugger</a>.<span class="i">OnSequencePointHit</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="1e41b46b4c87ee53" href="../../R/1e41b46b4c87ee53.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_AddEnumerable</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">AddEnumerable</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="cd51aa4186c89ac0" href="../../R/cd51aa4186c89ac0.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_AddObject</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">AddObject</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="44b55abb1a05a3f5" href="../../R/44b55abb1a05a3f5.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_Compare</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">Compare</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="4c2cd8582367a5c3" href="../../R/4c2cd8582367a5c3.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_GetEnumerator</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">GetEnumerator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="e35b74ca507b94da" href="../../R/e35b74ca507b94da.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_GetCOMEnumerator</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">GetCOMEnumerator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="390cb5dc6abf2ac0" href="../../R/390cb5dc6abf2ac0.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_GetGenericEnumerator</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">GetGenericEnumerator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="fc7a0c4c669442af" href="../../R/fc7a0c4c669442af.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_GetSlice</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">GetSlice</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="c1fd7d22222b7601" href="../../R/c1fd7d22222b7601.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_MethodInvoker</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">MethodInvoker</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="b001fffaf39caaad" href="../../R/b001fffaf39caaad.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_Where</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">Where</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="8613c6242756ee2f" href="../../R/8613c6242756ee2f.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_ForEach</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">ForEach</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="7a845f32cb513c53" href="../../R/7a845f32cb513c53.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_Multiply</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">Multiply</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="bcfdfc818ba89e99" href="../../R/bcfdfc818ba89e99.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_PropertyGetter</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">PropertyGetter</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="8db14ea056a86501" href="../../R/8db14ea056a86501.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_SlicingIndex</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">SlicingIndex</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="3cd823932b07f5d3" href="../../R/3cd823932b07f5d3.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_ToArray</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">ToArray</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="d49591e592e4a683" href="../../R/d49591e592e4a683.html" target="n" data-glyph="44,1" class="i field">EnumerableOps_WriteEnumerableToPipe</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#3856cc8435546884" class="t t">EnumerableOps</a>.<span class="i">WriteEnumerableToPipe</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="353a972acd7c31f5" href="../../R/353a972acd7c31f5.html" target="n" data-glyph="44,1" class="i field">ErrorRecord__ctor</a> =
            <b>typeof</b>(<a href="../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>).<span class="i">GetConstructor</span>(
                <a href="#fe89073d609a457a" class="i field">InstanceFlags</a> | <span class="i">BindingFlags</span>.<span class="i">Public</span>,
                <b>null</b>,
                <span class="i">CallingConventions</span>.<span class="i">Standard</span>,
                <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<a href="../ErrorPackage.cs.html#fe2b46733a081db9" class="t t">ErrorRecord</a>), <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>) },
                <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="786cdc6c563f5cd2" href="../../R/786cdc6c563f5cd2.html" target="n" data-glyph="44,1" class="i field">Exception_Message</a> =
            <b>typeof</b>(<span class="i">Exception</span>).<span class="i">GetProperty</span>(<b>nameof</b>(<span class="i">Exception</span>.<span class="i">Message</span>));
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="8da10b470305ec34" href="../../R/8da10b470305ec34.html" target="n" data-glyph="44,1" class="i field">ExceptionHandlingOps_CheckActionPreference</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>.<span class="i">CheckActionPreference</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="2b3fe2b6d05918e6" href="../../R/2b3fe2b6d05918e6.html" target="n" data-glyph="44,1" class="i field">ExceptionHandlingOps_ConvertToArgumentConversionException</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>.<span class="i">ConvertToArgumentConversionException</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="042b22aba6483b3c" href="../../R/042b22aba6483b3c.html" target="n" data-glyph="44,1" class="i field">ExceptionHandlingOps_ConvertToException</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>.<span class="i">ConvertToException</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="333c817a08775c10" href="../../R/333c817a08775c10.html" target="n" data-glyph="44,1" class="i field">ExceptionHandlingOps_ConvertToMethodInvocationException</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>.<span class="i">ConvertToMethodInvocationException</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="5ea4e94605c73e80" href="../../R/5ea4e94605c73e80.html" target="n" data-glyph="44,1" class="i field">ExceptionHandlingOps_FindMatchingHandler</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>.<span class="i">FindMatchingHandler</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="6f9bb282c8acbb19" href="../../R/6f9bb282c8acbb19.html" target="n" data-glyph="44,1" class="i field">ExceptionHandlingOps_RestoreStoppingPipeline</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>.<span class="i">RestoreStoppingPipeline</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="2c4e70a5a6e9c190" href="../../R/2c4e70a5a6e9c190.html" target="n" data-glyph="44,1" class="i field">ExceptionHandlingOps_SuspendStoppingPipeline</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>.<span class="i">SuspendStoppingPipeline</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="1398b28ba5332ee2" href="../../R/1398b28ba5332ee2.html" target="n" data-glyph="44,1" class="i field">ExecutionContext_CurrentExceptionBeingHandled</a> =
            <b>typeof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#e379042dcc553e8d" class="i property">CurrentExceptionBeingHandled</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">FieldInfo</span> <a id="de19a3cfacfdbca9" href="../../R/de19a3cfacfdbca9.html" target="n" data-glyph="44,1" class="i field">ExecutionContext_Debugger</a> =
            <b>typeof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>).<span class="i">GetField</span>(<b>nameof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#4dc9c33caa8ec2df" class="i field">_debugger</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">FieldInfo</span> <a id="6e2f6824a0f390d1" href="../../R/6e2f6824a0f390d1.html" target="n" data-glyph="44,1" class="i field">ExecutionContext_DebuggingMode</a> =
            <b>typeof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>).<span class="i">GetField</span>(<b>nameof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#00e6fdde4b76eb15" class="i field">_debuggingMode</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="a7f8c6f9891fd821" href="../../R/a7f8c6f9891fd821.html" target="n" data-glyph="44,1" class="i field">ExecutionContext_ExceptionHandlerInEnclosingStatementBlock</a> =
            <b>typeof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#1d9a57911a3915e8" class="i property">PropagateExceptionsToEnclosingStatementBlock</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="69e8d4ddc89962f4" href="../../R/69e8d4ddc89962f4.html" target="n" data-glyph="44,1" class="i field">ExecutionContext_IsStrictVersion</a> =
            <b>typeof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<span class="i">IsStrictVersion</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="62b97ea0876c7d79" href="../../R/62b97ea0876c7d79.html" target="n" data-glyph="44,1" class="i field">ExecutionContext_QuestionMarkVariableValue</a> =
            <b>typeof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#1086e67bac3e5c3a" class="i property">QuestionMarkVariableValue</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="de071e360a3c75b6" href="../../R/de071e360a3c75b6.html" target="n" data-glyph="44,1" class="i field">ExecutionContext_LanguageMode</a> =
            <b>typeof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="f42ef04bf2478e6a" href="../../R/f42ef04bf2478e6a.html" target="n" data-glyph="44,1" class="i field">ExecutionContext_EngineIntrinsics</a> =
            <b>typeof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#27c4e82ba7216ff8" class="i property">EngineIntrinsics</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="15871c42691bd5e9" href="../../R/15871c42691bd5e9.html" target="n" data-glyph="44,1" class="i field">FileRedirection_BindForExpression</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c7517235984e3035" class="t t">FileRedirection</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c7517235984e3035" class="t t">FileRedirection</a>.<span class="i">BindForExpression</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="1acafd7333f0e704" href="../../R/1acafd7333f0e704.html" target="n" data-glyph="44,1" class="i field">FileRedirection_CallDoCompleteForExpression</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c7517235984e3035" class="t t">FileRedirection</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c7517235984e3035" class="t t">FileRedirection</a>.<span class="i">CallDoCompleteForExpression</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="2b17bcbb5e2d60f3" href="../../R/2b17bcbb5e2d60f3.html" target="n" data-glyph="44,1" class="i field">FileRedirection_ctor</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c7517235984e3035" class="t t">FileRedirection</a>).<span class="i">GetConstructor</span>(
                <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>,
                <b>null</b>,
                <span class="i">CallingConventions</span>.<span class="i">Standard</span>,
                <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>), <b>typeof</b>(<b>bool</b>), <b>typeof</b>(<b>string</b>) },
                <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="da99f0039214b1a4" href="../../R/da99f0039214b1a4.html" target="n" data-glyph="44,1" class="i field">FileRedirection_Dispose</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c7517235984e3035" class="t t">FileRedirection</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c7517235984e3035" class="t t">FileRedirection</a>.<span class="i">Dispose</span>));
 
        <b>internal static readonly</b> <span class="i">FieldInfo</span> <a id="484f998e9ae6f79f" href="../../R/484f998e9ae6f79f.html" target="n" data-glyph="44,1" class="i field">FunctionContext__currentSequencePointIndex</a> =
            <b>typeof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>).<span class="i">GetField</span>(<b>nameof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>.<a href="#16213bb1bf477e12" class="i field">_currentSequencePointIndex</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">FieldInfo</span> <a id="c3a98276549d8c66" href="../../R/c3a98276549d8c66.html" target="n" data-glyph="44,1" class="i field">FunctionContext__executionContext</a> =
            <b>typeof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>).<span class="i">GetField</span>(<b>nameof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>.<a href="#86d08ccdd0602a1b" class="i field">_executionContext</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">FieldInfo</span> <a id="42ef6b8faf533098" href="../../R/42ef6b8faf533098.html" target="n" data-glyph="44,1" class="i field">FunctionContext__functionName</a> =
            <b>typeof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>).<span class="i">GetField</span>(<b>nameof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>.<a href="#cf35fafd088fea9b" class="i field">_functionName</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">FieldInfo</span> <a id="311ba784690f9640" href="../../R/311ba784690f9640.html" target="n" data-glyph="44,1" class="i field">FunctionContext__localsTuple</a> =
            <b>typeof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>).<span class="i">GetField</span>(<b>nameof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>.<a href="#23a9d5ac6a3b086b" class="i field">_localsTuple</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">FieldInfo</span> <a id="6d8360b4ef0b27b9" href="../../R/6d8360b4ef0b27b9.html" target="n" data-glyph="44,1" class="i field">FunctionContext__outputPipe</a> =
            <b>typeof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>).<span class="i">GetField</span>(<b>nameof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>.<a href="#6c44d518392049f0" class="i field">_outputPipe</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="7727f63cf7933933" href="../../R/7727f63cf7933933.html" target="n" data-glyph="44,1" class="i field">FunctionContext_PopTrapHandlers</a> =
            <b>typeof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>.<span class="i">PopTrapHandlers</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="d5519931e1bab90f" href="../../R/d5519931e1bab90f.html" target="n" data-glyph="44,1" class="i field">FunctionContext_PushTrapHandlers</a> =
            <b>typeof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>.<span class="i">PushTrapHandlers</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="f722b8e96a04816e" href="../../R/f722b8e96a04816e.html" target="n" data-glyph="44,1" class="i field">FunctionOps_DefineFunction</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#93bd1ee19751b89a" class="t t">FunctionOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#93bd1ee19751b89a" class="t t">FunctionOps</a>.<span class="i">DefineFunction</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="b35174be980baa73" href="../../R/b35174be980baa73.html" target="n" data-glyph="44,1" class="i field">Hashtable_ctor</a> =
            <b>typeof</b>(<span class="i">Hashtable</span>).<span class="i">GetConstructor</span>(
                <span class="i">BindingFlags</span>.<span class="i">Instance</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span>,
                <b>null</b>,
                <span class="i">CallingConventions</span>.<span class="i">Standard</span>,
                <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>int</b>), <b>typeof</b>(<span class="i">IEqualityComparer</span>) },
                <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="97a19fdbe3466006" href="../../R/97a19fdbe3466006.html" target="n" data-glyph="44,1" class="i field">HashtableOps_Add</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#f57bbcaaadf6738d" class="t t">HashtableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#f57bbcaaadf6738d" class="t t">HashtableOps</a>.<span class="i">Add</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="411d506374ee97b8" href="../../R/411d506374ee97b8.html" target="n" data-glyph="44,1" class="i field">HashtableOps_AddKeyValuePair</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#f57bbcaaadf6738d" class="t t">HashtableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#f57bbcaaadf6738d" class="t t">HashtableOps</a>.<span class="i">AddKeyValuePair</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="16793d35fc75692b" href="../../R/16793d35fc75692b.html" target="n" data-glyph="44,1" class="i field">ICollection_Count</a> =
            <b>typeof</b>(<span class="i">ICollection</span>).<span class="i">GetProperty</span>(<b>nameof</b>(<span class="i">ICollection</span>.<span class="i">Count</span>));
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="332d947d7b69ea95" href="../../R/332d947d7b69ea95.html" target="n" data-glyph="44,1" class="i field">IComparable_CompareTo</a> =
            <b>typeof</b>(<span class="i">IComparable</span>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">IComparable</span>.<span class="i">CompareTo</span>));
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="b4515ba4e179b7fb" href="../../R/b4515ba4e179b7fb.html" target="n" data-glyph="44,1" class="i field">IDisposable_Dispose</a> =
            <b>typeof</b>(<span class="i">IDisposable</span>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">IDisposable</span>.<span class="i">Dispose</span>));
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="6f928f7817a7ff84" href="../../R/6f928f7817a7ff84.html" target="n" data-glyph="44,1" class="i field">IEnumerable_GetEnumerator</a> =
            <b>typeof</b>(<span class="i">IEnumerable</span>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">IEnumerable</span>.<span class="i">GetEnumerator</span>));
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="bee7aefc0941b149" href="../../R/bee7aefc0941b149.html" target="n" data-glyph="44,1" class="i field">IEnumerator_Current</a> =
            <b>typeof</b>(<span class="i">IEnumerator</span>).<span class="i">GetProperty</span>(<b>nameof</b>(<span class="i">IEnumerator</span>.<span class="i">Current</span>));
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="7f3d3c7d1634dc0d" href="../../R/7f3d3c7d1634dc0d.html" target="n" data-glyph="44,1" class="i field">IEnumerator_MoveNext</a> =
            <b>typeof</b>(<span class="i">IEnumerator</span>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">IEnumerator</span>.<span class="i">MoveNext</span>));
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="92fbbf3266e95071" href="../../R/92fbbf3266e95071.html" target="n" data-glyph="44,1" class="i field">IList_get_Item</a> =
            <b>typeof</b>(<span class="i">IList</span>).<span class="i">GetMethod</span>(<span class="s">&quot;get_Item&quot;</span>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="da166005df553588" href="../../R/da166005df553588.html" target="n" data-glyph="44,1" class="i field">InterpreterError_NewInterpreterException</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="b72ce5bb406731be" href="../../R/b72ce5bb406731be.html" target="n" data-glyph="44,1" class="i field">InterpreterError_NewInterpreterExceptionWithInnerException</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterExceptionWithInnerException</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="f7d695c0330a8940" href="../../R/f7d695c0330a8940.html" target="n" data-glyph="44,1" class="i field">LanguagePrimitives_GetInvalidCastMessages</a> =
            <b>typeof</b>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">GetInvalidCastMessages</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="3dae8f6f568e4e16" href="../../R/3dae8f6f568e4e16.html" target="n" data-glyph="44,1" class="i field">LanguagePrimitives_IsNull</a> =
            <b>typeof</b>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">IsNull</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="7c6872852f680527" href="../../R/7c6872852f680527.html" target="n" data-glyph="44,1" class="i field">LanguagePrimitives_ThrowInvalidCastException</a> =
            <b>typeof</b>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ThrowInvalidCastException</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="96e648a9a51ca253" href="../../R/96e648a9a51ca253.html" target="n" data-glyph="44,1" class="i field">LocalPipeline_GetExecutionContextFromTLS</a> =
            <b>typeof</b>(<a href="../hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../hostifaces/LocalPipeline.cs.html#4ecb13103c10f113" class="t t">LocalPipeline</a>.<span class="i">GetExecutionContextFromTLS</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="d69f0b5d1a319bf0" href="../../R/d69f0b5d1a319bf0.html" target="n" data-glyph="44,1" class="i field">LoopFlowException_MatchLabel</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#7aca1395e161031c" class="t t">LoopFlowException</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#7aca1395e161031c" class="t t">LoopFlowException</a>.<span class="i">MatchLabel</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="554079b715c85ce9" href="../../R/554079b715c85ce9.html" target="n" data-glyph="44,1" class="i field">MergingRedirection_BindForExpression</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#0d1f9eedf9f41271" class="t t">MergingRedirection</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#0d1f9eedf9f41271" class="t t">MergingRedirection</a>.<span class="i">BindForExpression</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="1c44fd79df4afcc1" href="../../R/1c44fd79df4afcc1.html" target="n" data-glyph="44,1" class="i field">MethodException_ctor</a> =
            <b>typeof</b>(<a href="../ExtendedTypeSystemException.cs.html#4961d7a0f93a8280" class="t t">MethodException</a>).<span class="i">GetConstructor</span>(
                <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>,
                <b>null</b>,
                <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>string</b>), <b>typeof</b>(<span class="i">Exception</span>), <b>typeof</b>(<b>string</b>), <b>typeof</b>(<b>object</b>[]) },
                <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="5e5572070af1f94c" href="../../R/5e5572070af1f94c.html" target="n" data-glyph="44,1" class="i field">MutableTuple_IsValueSet</a> =
            <b>typeof</b>(<a href="../runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a>.<span class="i">IsValueSet</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="fe4e5e7d2bcc0146" href="../../R/fe4e5e7d2bcc0146.html" target="n" data-glyph="44,1" class="i field">Object_Equals</a> =
            <b>typeof</b>(<b>object</b>).<span class="i">GetMethod</span>(<b>nameof</b>(<b>object</b>.<span class="i">Equals</span>), <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>object</b>) });
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="44666aa8053a8199" href="../../R/44666aa8053a8199.html" target="n" data-glyph="44,1" class="i field">OrderedDictionary_ctor</a> =
            <b>typeof</b>(<span class="i">OrderedDictionary</span>).<span class="i">GetConstructor</span>(
                <span class="i">BindingFlags</span>.<span class="i">Instance</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span>,
                <b>null</b>,
                <span class="i">CallingConventions</span>.<span class="i">Standard</span>,
                <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>int</b>), <b>typeof</b>(<span class="i">IEqualityComparer</span>) },
                <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="c86601f53d43c91c" href="../../R/c86601f53d43c91c.html" target="n" data-glyph="44,1" class="i field">Parser_ScanNumber</a> =
            <b>typeof</b>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a>.<span class="i">ScanNumber</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="d135b695626d342e" href="../../R/d135b695626d342e.html" target="n" data-glyph="44,1" class="i field">ParserOps_ContainsOperatorCompiled</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<span class="i">ContainsOperatorCompiled</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="412cbd6e2de9069f" href="../../R/412cbd6e2de9069f.html" target="n" data-glyph="44,1" class="i field">ParserOps_ImplicitOp</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<span class="i">ImplicitOp</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="936c144c5fe90238" href="../../R/936c144c5fe90238.html" target="n" data-glyph="44,1" class="i field">ParserOps_JoinOperator</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<span class="i">JoinOperator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="1ab64edf541e0804" href="../../R/1ab64edf541e0804.html" target="n" data-glyph="44,1" class="i field">ParserOps_LikeOperator</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<span class="i">LikeOperator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="51d77b7cc5ad3cfc" href="../../R/51d77b7cc5ad3cfc.html" target="n" data-glyph="44,1" class="i field">ParserOps_MatchOperator</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<span class="i">MatchOperator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="d5b5c96c3c0eb753" href="../../R/d5b5c96c3c0eb753.html" target="n" data-glyph="44,1" class="i field">ParserOps_RangeOperator</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<span class="i">RangeOperator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="6d034b2ff43d9189" href="../../R/6d034b2ff43d9189.html" target="n" data-glyph="44,1" class="i field">ParserOps_GetRangeEnumerator</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<span class="i">GetRangeEnumerator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="36d014a8fc8820f4" href="../../R/36d014a8fc8820f4.html" target="n" data-glyph="44,1" class="i field">ParserOps_ReplaceOperator</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<span class="i">ReplaceOperator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="5c42deff2cb6fe8c" href="../../R/5c42deff2cb6fe8c.html" target="n" data-glyph="44,1" class="i field">ParserOps_SplitOperator</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<span class="i">SplitOperator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="9513b6d04ccab760" href="../../R/9513b6d04ccab760.html" target="n" data-glyph="44,1" class="i field">ParserOps_UnaryJoinOperator</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<span class="i">UnaryJoinOperator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="af7719e76cf6730c" href="../../R/af7719e76cf6730c.html" target="n" data-glyph="44,1" class="i field">ParserOps_UnarySplitOperator</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<span class="i">UnarySplitOperator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="ec27b92751d03933" href="../../R/ec27b92751d03933.html" target="n" data-glyph="44,1" class="i field">Pipe_ctor</a> =
            <b>typeof</b>(<a href="../Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a>).<span class="i">GetConstructor</span>(<a href="#fe89073d609a457a" class="i field">InstanceFlags</a>, <b>null</b>, <span class="i">CallingConventions</span>.<span class="i">Standard</span>, <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<span class="i">List</span>&lt;<b>object</b>&gt;) }, <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="ef3aead21a321eba" href="../../R/ef3aead21a321eba.html" target="n" data-glyph="44,1" class="i field">Pipe_Add</a> =
            <b>typeof</b>(<a href="../Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a>.<span class="i">Add</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="252b3e0e32bf12b9" href="../../R/252b3e0e32bf12b9.html" target="n" data-glyph="44,1" class="i field">Pipe_SetVariableListForTemporaryPipe</a> =
            <b>typeof</b>(<a href="../Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a>.<span class="i">SetVariableListForTemporaryPipe</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="e94085b46a59e850" href="../../R/e94085b46a59e850.html" target="n" data-glyph="44,1" class="i field">PipelineOps_CheckAutomationNullInCommandArgument</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>.<span class="i">CheckAutomationNullInCommandArgument</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="fa946d729be26e44" href="../../R/fa946d729be26e44.html" target="n" data-glyph="44,1" class="i field">PipelineOps_CheckAutomationNullInCommandArgumentArray</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>.<span class="i">CheckAutomationNullInCommandArgumentArray</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="02f1013c307917f0" href="../../R/02f1013c307917f0.html" target="n" data-glyph="44,1" class="i field">PipelineOps_CheckForInterrupts</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>.<span class="i">CheckForInterrupts</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="3b25cdcf1be28152" href="../../R/3b25cdcf1be28152.html" target="n" data-glyph="44,1" class="i field">PipelineOps_GetExitException</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>.<span class="i">GetExitException</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="95dfa6e24fac1473" href="../../R/95dfa6e24fac1473.html" target="n" data-glyph="44,1" class="i field">PipelineOps_FlushPipe</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>.<span class="i">FlushPipe</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="eb123eb5584251b6" href="../../R/eb123eb5584251b6.html" target="n" data-glyph="44,1" class="i field">PipelineOps_InvokePipeline</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>.<span class="i">InvokePipeline</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="0f6da4509de170b7" href="../../R/0f6da4509de170b7.html" target="n" data-glyph="44,1" class="i field">PipelineOps_InvokePipelineInBackground</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>.<span class="i">InvokePipelineInBackground</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="c72ffa1171395d06" href="../../R/c72ffa1171395d06.html" target="n" data-glyph="44,1" class="i field">PipelineOps_Nop</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>.<span class="i">Nop</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="f6995ac2d8b37cdd" href="../../R/f6995ac2d8b37cdd.html" target="n" data-glyph="44,1" class="i field">PipelineOps_PipelineResult</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>.<span class="i">PipelineResult</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="32a3b87e98bb20e1" href="../../R/32a3b87e98bb20e1.html" target="n" data-glyph="44,1" class="i field">PipelineOps_ClearPipe</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>.<span class="i">ClearPipe</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="e6291b84399cb9a3" href="../../R/e6291b84399cb9a3.html" target="n" data-glyph="44,1" class="i field">PSGetDynamicMemberBinder_GetIDictionaryMember</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#1315cad8e76711f9" class="t t">PSGetDynamicMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#1315cad8e76711f9" class="t t">PSGetDynamicMemberBinder</a>.<span class="i">GetIDictionaryMember</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="12f929af33da7404" href="../../R/12f929af33da7404.html" target="n" data-glyph="44,1" class="i field">PSGetMemberBinder_CloneMemberInfo</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<span class="i">CloneMemberInfo</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="1109ad016629fabc" href="../../R/1109ad016629fabc.html" target="n" data-glyph="44,1" class="i field">PSGetMemberBinder_GetAdaptedValue</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<span class="i">GetAdaptedValue</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="c7f82df6c45ce2a2" href="../../R/c7f82df6c45ce2a2.html" target="n" data-glyph="44,1" class="i field">PSGetMemberBinder_GetTypeTableFromTLS</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<span class="i">GetTypeTableFromTLS</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="9bbb82d1153782ef" href="../../R/9bbb82d1153782ef.html" target="n" data-glyph="44,1" class="i field">PSGetMemberBinder_IsTypeNameSame</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<span class="i">IsTypeNameSame</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="5806a8f8dd4c6295" href="../../R/5806a8f8dd4c6295.html" target="n" data-glyph="44,1" class="i field">PSGetMemberBinder_TryGetGenericDictionaryValue</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<span class="i">TryGetGenericDictionaryValue</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="9d70b40f06dc0a2b" href="../../R/9d70b40f06dc0a2b.html" target="n" data-glyph="44,1" class="i field">PSGetMemberBinder_TryGetInstanceMember</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<span class="i">TryGetInstanceMember</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="0c63d64f54deb7cb" href="../../R/0c63d64f54deb7cb.html" target="n" data-glyph="44,1" class="i field">PSGetMemberBinder_TryGetIDictionaryValue</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<span class="i">TryGetIDictionaryValue</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="609b54d8ff8dd30c" href="../../R/609b54d8ff8dd30c.html" target="n" data-glyph="44,1" class="i field">PSInvokeMemberBinder_InvokeAdaptedMember</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>.<span class="i">InvokeAdaptedMember</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="b6b7d5e637a1bef8" href="../../R/b6b7d5e637a1bef8.html" target="n" data-glyph="44,1" class="i field">PSInvokeMemberBinder_InvokeAdaptedSetMember</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>.<span class="i">InvokeAdaptedSetMember</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="a521c5ae1d37f3a6" href="../../R/a521c5ae1d37f3a6.html" target="n" data-glyph="44,1" class="i field">PSInvokeMemberBinder_IsHeterogeneousArray</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>.<span class="i">IsHeterogeneousArray</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="7a1f7f25ac7d66db" href="../../R/7a1f7f25ac7d66db.html" target="n" data-glyph="44,1" class="i field">PSInvokeMemberBinder_IsHomogenousArray</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>.<span class="i">IsHomogenousArray</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="2f601f9a9f86eb4c" href="../../R/2f601f9a9f86eb4c.html" target="n" data-glyph="44,1" class="i field">PSInvokeMemberBinder_TryGetInstanceMethod</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>.<span class="i">TryGetInstanceMethod</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="ee9256a1c534a1be" href="../../R/ee9256a1c534a1be.html" target="n" data-glyph="44,1" class="i field">PSMethodInfo_Invoke</a> =
            <b>typeof</b>(<a href="../MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../MshMemberInfo.cs.html#19eeb66bf76c933c" class="t t">PSMethodInfo</a>.<span class="i">Invoke</span>));
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="e617ae2e1e630dea" href="../../R/e617ae2e1e630dea.html" target="n" data-glyph="44,1" class="i field">PSNoteProperty_Value</a> =
            <b>typeof</b>(<a href="../MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="../MshMemberInfo.cs.html#964f2480da01a02c" class="t t">PSNoteProperty</a>.<a href="../MshMemberInfo.cs.html#0426306a39cc419e" class="i property">Value</a>));
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="95ba8d8e80c2ae2b" href="../../R/95ba8d8e80c2ae2b.html" target="n" data-glyph="44,1" class="i field">PSObject_Base</a> =
            <b>typeof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">Base</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="e1407712ae736ff8" href="../../R/e1407712ae736ff8.html" target="n" data-glyph="44,1" class="i field">PSObject_BaseObject</a> =
            <b>typeof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#d854d13536b70a12" class="i property">BaseObject</a>));
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="37ca152e8a9e51ee" href="../../R/37ca152e8a9e51ee.html" target="n" data-glyph="44,1" class="i field">PSObject_IsDeserialized</a> =
            <b>typeof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<a href="../MshObject.cs.html#598b509cd0dd9b32" class="i property">IsDeserialized</a>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="806767df08e07155" href="../../R/806767df08e07155.html" target="n" data-glyph="44,1" class="i field">PSObject_ToStringParser</a> =
            <b>typeof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>.<span class="i">ToStringParser</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>, <b>null</b>, <b>new</b>[] { <b>typeof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>), <b>typeof</b>(<b>object</b>) }, <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="ae2d8aa8c127cd82" href="../../R/ae2d8aa8c127cd82.html" target="n" data-glyph="44,1" class="i field">PSReference_Value</a> =
            <b>typeof</b>(<a href="../MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="../MshReference.cs.html#7363a2660b89f253" class="t t">PSReference</a>.<a href="../MshReference.cs.html#a5028a25660cef18" class="i property">Value</a>));
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="77bcdf22030ffdf8" href="../../R/77bcdf22030ffdf8.html" target="n" data-glyph="44,1" class="i field">PSScriptMethod_InvokeScript</a> =
            <b>typeof</b>(<a href="../MshMemberInfo.cs.html#2332c149036fdcf2" class="t t">PSScriptMethod</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../MshMemberInfo.cs.html#2332c149036fdcf2" class="t t">PSScriptMethod</a>.<span class="i">InvokeScript</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="f05e92262c6fc7a9" href="../../R/f05e92262c6fc7a9.html" target="n" data-glyph="44,1" class="i field">PSScriptProperty_InvokeGetter</a> =
            <b>typeof</b>(<a href="../MshMemberInfo.cs.html#b68884f0eb8d8ebb" class="t t">PSScriptProperty</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../MshMemberInfo.cs.html#b68884f0eb8d8ebb" class="t t">PSScriptProperty</a>.<span class="i">InvokeGetter</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="efe53272332c15db" href="../../R/efe53272332c15db.html" target="n" data-glyph="44,1" class="i field">PSScriptProperty_InvokeSetter</a> =
            <b>typeof</b>(<a href="../MshMemberInfo.cs.html#b68884f0eb8d8ebb" class="t t">PSScriptProperty</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../MshMemberInfo.cs.html#b68884f0eb8d8ebb" class="t t">PSScriptProperty</a>.<span class="i">InvokeSetter</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="a9003d6e24f537e1" href="../../R/a9003d6e24f537e1.html" target="n" data-glyph="44,1" class="i field">PSSetMemberBinder_SetAdaptedValue</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#b33a3e4647e9ce8d" class="t t">PSSetMemberBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#b33a3e4647e9ce8d" class="t t">PSSetMemberBinder</a>.<span class="i">SetAdaptedValue</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="3031372c6294ebd9" href="../../R/3031372c6294ebd9.html" target="n" data-glyph="44,1" class="i field">PSVariableAssignmentBinder_CopyInstanceMembersOfValueType</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#0cc44259d9b27d72" class="t t">PSVariableAssignmentBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#0cc44259d9b27d72" class="t t">PSVariableAssignmentBinder</a>.<span class="i">CopyInstanceMembersOfValueType</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">FieldInfo</span> <a id="57bb460934ceda52" href="../../R/57bb460934ceda52.html" target="n" data-glyph="44,1" class="i field">PSVariableAssignmentBinder__mutableValueWithInstanceMemberVersion</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#0cc44259d9b27d72" class="t t">PSVariableAssignmentBinder</a>).<span class="i">GetField</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#0cc44259d9b27d72" class="t t">PSVariableAssignmentBinder</a>.<a href="../runtime/Binding/Binders.cs.html#6375ed9a6bada9ef" class="i field">s_mutableValueWithInstanceMemberVersion</a>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="aa6e9cbe951d2396" href="../../R/aa6e9cbe951d2396.html" target="n" data-glyph="44,1" class="i field">PSCreateInstanceBinder_IsTargetTypeNonPublic</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#b69e0408238caa22" class="t t">PSCreateInstanceBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#b69e0408238caa22" class="t t">PSCreateInstanceBinder</a>.<span class="i">IsTargetTypeNonPublic</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="c516aa9258d6469b" href="../../R/c516aa9258d6469b.html" target="n" data-glyph="44,1" class="i field">PSCreateInstanceBinder_IsTargetTypeByRefLike</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#b69e0408238caa22" class="t t">PSCreateInstanceBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#b69e0408238caa22" class="t t">PSCreateInstanceBinder</a>.<span class="i">IsTargetTypeByRefLike</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="8ed43e8480240c4c" href="../../R/8ed43e8480240c4c.html" target="n" data-glyph="44,1" class="i field">PSCreateInstanceBinder_GetTargetTypeName</a> =
            <b>typeof</b>(<a href="../runtime/Binding/Binders.cs.html#b69e0408238caa22" class="t t">PSCreateInstanceBinder</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Binding/Binders.cs.html#b69e0408238caa22" class="t t">PSCreateInstanceBinder</a>.<span class="i">GetTargetTypeName</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="def9780cb2b9823b" href="../../R/def9780cb2b9823b.html" target="n" data-glyph="44,1" class="i field">ReservedNameMembers_GeneratePSAdaptedMemberSet</a> =
            <b>typeof</b>(<a href="../MshMemberInfo.cs.html#9e8766e9d9196812" class="t t">ReservedNameMembers</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../MshMemberInfo.cs.html#9e8766e9d9196812" class="t t">ReservedNameMembers</a>.<span class="i">GeneratePSAdaptedMemberSet</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="4e73d310dd1b2509" href="../../R/4e73d310dd1b2509.html" target="n" data-glyph="44,1" class="i field">ReservedNameMembers_GeneratePSBaseMemberSet</a> =
            <b>typeof</b>(<a href="../MshMemberInfo.cs.html#9e8766e9d9196812" class="t t">ReservedNameMembers</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../MshMemberInfo.cs.html#9e8766e9d9196812" class="t t">ReservedNameMembers</a>.<span class="i">GeneratePSBaseMemberSet</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="fc5114a16c3a13f3" href="../../R/fc5114a16c3a13f3.html" target="n" data-glyph="44,1" class="i field">ReservedNameMembers_GeneratePSExtendedMemberSet</a> =
            <b>typeof</b>(<a href="../MshMemberInfo.cs.html#9e8766e9d9196812" class="t t">ReservedNameMembers</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../MshMemberInfo.cs.html#9e8766e9d9196812" class="t t">ReservedNameMembers</a>.<span class="i">GeneratePSExtendedMemberSet</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="60400a7f31f75359" href="../../R/60400a7f31f75359.html" target="n" data-glyph="44,1" class="i field">ReservedNameMembers_GeneratePSObjectMemberSet</a> =
            <b>typeof</b>(<a href="../MshMemberInfo.cs.html#9e8766e9d9196812" class="t t">ReservedNameMembers</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../MshMemberInfo.cs.html#9e8766e9d9196812" class="t t">ReservedNameMembers</a>.<span class="i">GeneratePSObjectMemberSet</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="322f6b679fcdc6df" href="../../R/322f6b679fcdc6df.html" target="n" data-glyph="44,1" class="i field">ReservedNameMembers_PSTypeNames</a> =
            <b>typeof</b>(<a href="../MshMemberInfo.cs.html#9e8766e9d9196812" class="t t">ReservedNameMembers</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../MshMemberInfo.cs.html#9e8766e9d9196812" class="t t">ReservedNameMembers</a>.<span class="i">PSTypeNames</span>));
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="635cdc612dc416ed" href="../../R/635cdc612dc416ed.html" target="n" data-glyph="44,1" class="i field">RestrictedLanguageChecker_CheckDataStatementLanguageModeAtRuntime</a> =
            <b>typeof</b>(<a href="SemanticChecks.cs.html#7c9c4e1c1c4e828d" class="t t">RestrictedLanguageChecker</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="SemanticChecks.cs.html#7c9c4e1c1c4e828d" class="t t">RestrictedLanguageChecker</a>.<span class="i">CheckDataStatementLanguageModeAtRuntime</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="166fa812d91edfc0" href="../../R/166fa812d91edfc0.html" target="n" data-glyph="44,1" class="i field">RestrictedLanguageChecker_CheckDataStatementAstAtRuntime</a> =
            <b>typeof</b>(<a href="SemanticChecks.cs.html#7c9c4e1c1c4e828d" class="t t">RestrictedLanguageChecker</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="SemanticChecks.cs.html#7c9c4e1c1c4e828d" class="t t">RestrictedLanguageChecker</a>.<span class="i">CheckDataStatementAstAtRuntime</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="6a0ebb1490c40147" href="../../R/6a0ebb1490c40147.html" target="n" data-glyph="44,1" class="i field">RestrictedLanguageChecker_EnsureUtilityModuleLoaded</a> =
            <b>typeof</b>(<a href="SemanticChecks.cs.html#7c9c4e1c1c4e828d" class="t t">RestrictedLanguageChecker</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="SemanticChecks.cs.html#7c9c4e1c1c4e828d" class="t t">RestrictedLanguageChecker</a>.<span class="i">EnsureUtilityModuleLoaded</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="0cdfa3fd4b12ba2d" href="../../R/0cdfa3fd4b12ba2d.html" target="n" data-glyph="44,1" class="i field">ReturnException_ctor</a> =
            <b>typeof</b>(<a href="../lang/parserutils.cs.html#d6097919ed356bbf" class="t t">ReturnException</a>).<span class="i">GetConstructor</span>(<a href="#fe89073d609a457a" class="i field">InstanceFlags</a>, <b>null</b>, <span class="i">CallingConventions</span>.<span class="i">Standard</span>, <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>object</b>) }, <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">PropertyInfo</span> <a id="b261c6a9d0b55c2d" href="../../R/b261c6a9d0b55c2d.html" target="n" data-glyph="44,1" class="i field">RuntimeException_ErrorRecord</a> =
            <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>).<span class="i">GetProperty</span>(<b>nameof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>.<a href="../../utils/RuntimeException.cs.html#de1b3b901d918614" class="i property">ErrorRecord</a>));
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="4f6af0cfeb2c7169" href="../../R/4f6af0cfeb2c7169.html" target="n" data-glyph="44,1" class="i field">ScriptBlock_DoInvokeReturnAsIs</a> =
            <b>typeof</b>(<a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<span class="i">DoInvokeReturnAsIs</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="89862304af92dc04" href="../../R/89862304af92dc04.html" target="n" data-glyph="44,1" class="i field">ScriptBlock_InvokeAsDelegateHelper</a> =
            <b>typeof</b>(<a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<span class="i">InvokeAsDelegateHelper</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="9859243f4bad96d3" href="../../R/9859243f4bad96d3.html" target="n" data-glyph="44,1" class="i field">ScriptBlockExpressionWrapper_GetScriptBlock</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#70b8e343b58443aa" class="t t">ScriptBlockExpressionWrapper</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#70b8e343b58443aa" class="t t">ScriptBlockExpressionWrapper</a>.<span class="i">GetScriptBlock</span>), <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>);
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="4287f2a124c4e87d" href="../../R/4287f2a124c4e87d.html" target="n" data-glyph="44,1" class="i field">SetValueException_ctor</a> =
            <b>typeof</b>(<a href="../ExtendedTypeSystemException.cs.html#8f44bde8a24c50c0" class="t t">SetValueException</a>).<span class="i">GetConstructor</span>(
                <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>,
                <b>null</b>,
                <b>new</b>[] { <b>typeof</b>(<b>string</b>), <b>typeof</b>(<span class="i">Exception</span>), <b>typeof</b>(<b>string</b>), <b>typeof</b>(<b>object</b>[]) },
                <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="f8342ce08ab7434c" href="../../R/f8342ce08ab7434c.html" target="n" data-glyph="44,1" class="i field">GetValueException_ctor</a> =
            <b>typeof</b>(<a href="../ExtendedTypeSystemException.cs.html#396f7c7b826437d7" class="t t">GetValueException</a>).<span class="i">GetConstructor</span>(
                <a href="#fe89073d609a457a" class="i field">InstanceFlags</a>,
                <b>null</b>,
                <b>new</b>[] { <b>typeof</b>(<b>string</b>), <b>typeof</b>(<span class="i">Exception</span>), <b>typeof</b>(<b>string</b>), <b>typeof</b>(<b>object</b>[]) },
                <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="13cb74ac176c87c3" href="../../R/13cb74ac176c87c3.html" target="n" data-glyph="44,1" class="i field">StreamReader_ctor</a> =
            <b>typeof</b>(<span class="i">StreamReader</span>).<span class="i">GetConstructor</span>(<b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>string</b>) });
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="0ff6546096b237c7" href="../../R/0ff6546096b237c7.html" target="n" data-glyph="44,1" class="i field">StreamReader_ReadLine</a> =
            <b>typeof</b>(<span class="i">StreamReader</span>).<span class="i">GetMethod</span>(<b>nameof</b>(<span class="i">StreamReader</span>.<span class="i">ReadLine</span>), <span class="i">Type</span>.<span class="i">EmptyTypes</span>);
 
        <b>internal static readonly</b> <span class="i">ConstructorInfo</span> <a id="fe72c39073e0fc61" href="../../R/fe72c39073e0fc61.html" target="n" data-glyph="44,1" class="i field">String_ctor_char_int</a> =
            <b>typeof</b>(<b>string</b>).<span class="i">GetConstructor</span>(<b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>char</b>), <b>typeof</b>(<b>int</b>) });
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="b233abaa53a3fbb9" href="../../R/b233abaa53a3fbb9.html" target="n" data-glyph="44,1" class="i field">String_Concat_String</a> =
            <b>typeof</b>(<b>string</b>).<span class="i">GetMethod</span>(
                <b>nameof</b>(<b>string</b>.<span class="i">Concat</span>),
                <a href="#cf19696d28c5ae21" class="i field">StaticPublicFlags</a>, <b>null</b>,
                <span class="i">CallingConventions</span>.<span class="i">Standard</span>,
                <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>string</b>), <b>typeof</b>(<b>string</b>) },
                <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="169ddb8c1dce49f8" href="../../R/169ddb8c1dce49f8.html" target="n" data-glyph="44,1" class="i field">String_Equals</a> =
            <b>typeof</b>(<b>string</b>).<span class="i">GetMethod</span>(
                <b>nameof</b>(<b>string</b>.<span class="i">Equals</span>),
                <a href="#cf19696d28c5ae21" class="i field">StaticPublicFlags</a>,
                <b>null</b>,
                <span class="i">CallingConventions</span>.<span class="i">Standard</span>,
                <b>new</b> <span class="i">Type</span>[] { <b>typeof</b>(<b>string</b>), <b>typeof</b>(<b>string</b>), <b>typeof</b>(<span class="i">StringComparison</span>) },
                <b>null</b>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="e392c062f090aa28" href="../../R/e392c062f090aa28.html" target="n" data-glyph="44,1" class="i field">StringOps_Compare</a> =
            <b>typeof</b>(<a href="../runtime/Operations/StringOps.cs.html#7c884be4f45f4067" class="t t">StringOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/StringOps.cs.html#7c884be4f45f4067" class="t t">StringOps</a>.<span class="i">Compare</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="7f4e76c5368ddc35" href="../../R/7f4e76c5368ddc35.html" target="n" data-glyph="44,1" class="i field">StringOps_Equals</a> =
            <b>typeof</b>(<a href="../runtime/Operations/StringOps.cs.html#7c884be4f45f4067" class="t t">StringOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/StringOps.cs.html#7c884be4f45f4067" class="t t">StringOps</a>.<span class="i">Equals</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="5af60761a513c293" href="../../R/5af60761a513c293.html" target="n" data-glyph="44,1" class="i field">StringOps_FormatOperator</a> =
            <b>typeof</b>(<a href="../runtime/Operations/StringOps.cs.html#7c884be4f45f4067" class="t t">StringOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/StringOps.cs.html#7c884be4f45f4067" class="t t">StringOps</a>.<span class="i">FormatOperator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="ed1796e2745d3b16" href="../../R/ed1796e2745d3b16.html" target="n" data-glyph="44,1" class="i field">StringOps_Multiply</a> =
            <b>typeof</b>(<a href="../runtime/Operations/StringOps.cs.html#7c884be4f45f4067" class="t t">StringOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/StringOps.cs.html#7c884be4f45f4067" class="t t">StringOps</a>.<span class="i">Multiply</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="2b437b06fc777c0b" href="../../R/2b437b06fc777c0b.html" target="n" data-glyph="44,1" class="i field">SwitchOps_ConditionSatisfiedRegex</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c0f67e394cf08e0b" class="t t">SwitchOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c0f67e394cf08e0b" class="t t">SwitchOps</a>.<span class="i">ConditionSatisfiedRegex</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="e544440f7db35cfa" href="../../R/e544440f7db35cfa.html" target="n" data-glyph="44,1" class="i field">SwitchOps_ConditionSatisfiedWildcard</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c0f67e394cf08e0b" class="t t">SwitchOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c0f67e394cf08e0b" class="t t">SwitchOps</a>.<span class="i">ConditionSatisfiedWildcard</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="19c4c2a77e2707fb" href="../../R/19c4c2a77e2707fb.html" target="n" data-glyph="44,1" class="i field">SwitchOps_ResolveFilePath</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c0f67e394cf08e0b" class="t t">SwitchOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c0f67e394cf08e0b" class="t t">SwitchOps</a>.<span class="i">ResolveFilePath</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="a7bab9666f5275cb" href="../../R/a7bab9666f5275cb.html" target="n" data-glyph="44,1" class="i field">TypeOps_AsOperator</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<span class="i">AsOperator</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="ae8fab35fd50590d" href="../../R/ae8fab35fd50590d.html" target="n" data-glyph="44,1" class="i field">TypeOps_AddPowerShellTypesToTheScope</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<span class="i">AddPowerShellTypesToTheScope</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="1a9f84c88257ec0e" href="../../R/1a9f84c88257ec0e.html" target="n" data-glyph="44,1" class="i field">TypeOps_InitPowerShellTypesAtRuntime</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<span class="i">InitPowerShellTypesAtRuntime</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="8084538051e92616" href="../../R/8084538051e92616.html" target="n" data-glyph="44,1" class="i field">TypeOps_SetCurrentTypeResolutionState</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<span class="i">SetCurrentTypeResolutionState</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="1c2f02241bddf8c8" href="../../R/1c2f02241bddf8c8.html" target="n" data-glyph="44,1" class="i field">TypeOps_SetAssemblyDefiningPSTypes</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<span class="i">SetAssemblyDefiningPSTypes</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="4b2eee90ef5a2176" href="../../R/4b2eee90ef5a2176.html" target="n" data-glyph="44,1" class="i field">TypeOps_IsInstance</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<span class="i">IsInstance</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="c5cefd491e42dea3" href="../../R/c5cefd491e42dea3.html" target="n" data-glyph="44,1" class="i field">TypeOps_ResolveTypeName</a> =
            <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<span class="i">ResolveTypeName</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="02d883a008c0f925" href="../../R/02d883a008c0f925.html" target="n" data-glyph="44,1" class="i field">VariableOps_GetUsingValue</a> =
            <b>typeof</b>(<a href="../runtime/Operations/VariableOps.cs.html#d5ccea9fa7bfb556" class="t t">VariableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/VariableOps.cs.html#d5ccea9fa7bfb556" class="t t">VariableOps</a>.<span class="i">GetUsingValue</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="ee5326e69fe6331a" href="../../R/ee5326e69fe6331a.html" target="n" data-glyph="44,1" class="i field">VariableOps_GetVariableAsRef</a> =
            <b>typeof</b>(<a href="../runtime/Operations/VariableOps.cs.html#d5ccea9fa7bfb556" class="t t">VariableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/VariableOps.cs.html#d5ccea9fa7bfb556" class="t t">VariableOps</a>.<span class="i">GetVariableAsRef</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="841755fa04d3973c" href="../../R/841755fa04d3973c.html" target="n" data-glyph="44,1" class="i field">VariableOps_GetVariableValue</a> =
            <b>typeof</b>(<a href="../runtime/Operations/VariableOps.cs.html#d5ccea9fa7bfb556" class="t t">VariableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/VariableOps.cs.html#d5ccea9fa7bfb556" class="t t">VariableOps</a>.<span class="i">GetVariableValue</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="45cd1e24836f5236" href="../../R/45cd1e24836f5236.html" target="n" data-glyph="44,1" class="i field">VariableOps_GetAutomaticVariableValue</a> =
            <b>typeof</b>(<a href="../runtime/Operations/VariableOps.cs.html#d5ccea9fa7bfb556" class="t t">VariableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/VariableOps.cs.html#d5ccea9fa7bfb556" class="t t">VariableOps</a>.<span class="i">GetAutomaticVariableValue</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="ba739a56c51dad1f" href="../../R/ba739a56c51dad1f.html" target="n" data-glyph="44,1" class="i field">VariableOps_SetVariableValue</a> =
            <b>typeof</b>(<a href="../runtime/Operations/VariableOps.cs.html#d5ccea9fa7bfb556" class="t t">VariableOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/VariableOps.cs.html#d5ccea9fa7bfb556" class="t t">VariableOps</a>.<span class="i">SetVariableValue</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="7b916c30b8c14002" href="../../R/7b916c30b8c14002.html" target="n" data-glyph="44,1" class="i field">Utils_IsComObject</a> =
            <b>typeof</b>(<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<span class="i">IsComObject</span>), <a href="#b1d43be8b220700c" class="i field">StaticFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="1499eb326cb9ec72" href="../../R/1499eb326cb9ec72.html" target="n" data-glyph="44,1" class="i field">ClassOps_ValidateSetProperty</a> =
            <b>typeof</b>(<a href="../runtime/Operations/ClassOps.cs.html#b0981b6177f8dc22" class="t t">ClassOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/ClassOps.cs.html#b0981b6177f8dc22" class="t t">ClassOps</a>.<span class="i">ValidateSetProperty</span>), <a href="#cf19696d28c5ae21" class="i field">StaticPublicFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="d4b9811c565166fd" href="../../R/d4b9811c565166fd.html" target="n" data-glyph="44,1" class="i field">ClassOps_CallBaseCtor</a> =
            <b>typeof</b>(<a href="../runtime/Operations/ClassOps.cs.html#b0981b6177f8dc22" class="t t">ClassOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/ClassOps.cs.html#b0981b6177f8dc22" class="t t">ClassOps</a>.<span class="i">CallBaseCtor</span>), <a href="#cf19696d28c5ae21" class="i field">StaticPublicFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="a01cf4e6c7e573fc" href="../../R/a01cf4e6c7e573fc.html" target="n" data-glyph="44,1" class="i field">ClassOps_CallMethodNonVirtually</a> =
            <b>typeof</b>(<a href="../runtime/Operations/ClassOps.cs.html#b0981b6177f8dc22" class="t t">ClassOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/ClassOps.cs.html#b0981b6177f8dc22" class="t t">ClassOps</a>.<span class="i">CallMethodNonVirtually</span>), <a href="#cf19696d28c5ae21" class="i field">StaticPublicFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="e1bb6c820b85ac75" href="../../R/e1bb6c820b85ac75.html" target="n" data-glyph="44,1" class="i field">ClassOps_CallVoidMethodNonVirtually</a> =
            <b>typeof</b>(<a href="../runtime/Operations/ClassOps.cs.html#b0981b6177f8dc22" class="t t">ClassOps</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../runtime/Operations/ClassOps.cs.html#b0981b6177f8dc22" class="t t">ClassOps</a>.<span class="i">CallVoidMethodNonVirtually</span>), <a href="#cf19696d28c5ae21" class="i field">StaticPublicFlags</a>);
 
        <b>internal static readonly</b> <span class="i">MethodInfo</span> <a id="05239b78c88ac1a4" href="../../R/05239b78c88ac1a4.html" target="n" data-glyph="44,1" class="i field">ArgumentTransformationAttribute_Transform</a> =
            <b>typeof</b>(<a href="../Attributes.cs.html#80472519ecf33cf1" class="t t">ArgumentTransformationAttribute</a>).<span class="i">GetMethod</span>(<b>nameof</b>(<a href="../Attributes.cs.html#80472519ecf33cf1" class="t t">ArgumentTransformationAttribute</a>.<span class="i">Transform</span>), <a href="#ae109a46a4fa4db9" class="i field">InstancePublicFlags</a>);
        <span class="c">// ReSharper restore InconsistentNaming</span>
    }
 
    <b>internal static class</b> <a id="38ca030cfcd33569" href="../../R/38ca030cfcd33569.html" target="n" data-glyph="2,0" class="t t">ExpressionCache</a>
    {
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="03f60a93eeec7a4b" href="../../R/03f60a93eeec7a4b.html" target="n" data-glyph="44,1" class="i field">NullConstant</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>);
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="7b63a499a59a20bd" href="../../R/7b63a499a59a20bd.html" target="n" data-glyph="44,1" class="i field">NullExecutionContext</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="d46c13d14b303a61" href="../../R/d46c13d14b303a61.html" target="n" data-glyph="44,1" class="i field">NullPSObject</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="7a1bf8e3ab612a78" href="../../R/7a1bf8e3ab612a78.html" target="n" data-glyph="44,1" class="i field">NullEnumerator</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<span class="i">IEnumerator</span>));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="635c2cd971f6dfae" href="../../R/635c2cd971f6dfae.html" target="n" data-glyph="44,1" class="i field">NullExtent</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="e15d44a06302fa69" href="../../R/e15d44a06302fa69.html" target="n" data-glyph="44,1" class="i field">NullTypeTable</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<a href="../../P/a09d9b2cb7b1f0db.html#a09d9b2cb7b1f0db" class="t t">TypeTable</a>));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="23d7e035ce13afbe" href="../../R/../../0000000000.html" target="n" data-glyph="44,1" class="i field">NullFormatProvider</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<span class="i">IFormatProvider</span>));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="7f0ebe7c58832085" href="../../R/7f0ebe7c58832085.html" target="n" data-glyph="44,1" class="i field">NullObjectArray</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<b>object</b>[]));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="84591f5e881dc39e" href="../../R/84591f5e881dc39e.html" target="n" data-glyph="44,1" class="i field">AutomationNullConstant</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<a href="../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>, <b>typeof</b>(<b>object</b>));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="04e1410c375231ac" href="../../R/04e1410c375231ac.html" target="n" data-glyph="44,1" class="i field">NullCommandRedirections</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#51c59304e4c48b1e" class="t t">CommandRedirection</a>[][]));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="0e2fa552fb153d79" href="../../R/0e2fa552fb153d79.html" target="n" data-glyph="44,1" class="i field">NullTypeArray</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<span class="i">Type</span>[]));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="bebe5451f0389888" href="../../R/bebe5451f0389888.html" target="n" data-glyph="44,1" class="i field">NullType</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<span class="i">Type</span>));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="9c8b73128fe65551" href="../../R/9c8b73128fe65551.html" target="n" data-glyph="44,1" class="i field">NullDelegateArray</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;[]));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="d0f7748e7e164cb1" href="../../R/d0f7748e7e164cb1.html" target="n" data-glyph="44,1" class="i field">NullPipe</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>new</b> <a href="../Pipe.cs.html#c1592456b1ff42b5" class="t constructor">Pipe</a> { <a href="../Pipe.cs.html#8ef98c4ec55d7204" class="i property">NullPipe</a> = <b>true</b> });
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="fc034c3ee2a5ee52" href="../../R/fc034c3ee2a5ee52.html" target="n" data-glyph="44,1" class="i field">ConstEmptyString</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>string</b>.<span class="i">Empty</span>);
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="8e856f76e62e2ba5" href="../../R/8e856f76e62e2ba5.html" target="n" data-glyph="44,1" class="i field">CompareOptionsIgnoreCase</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="i">CompareOptions</span>.<span class="i">IgnoreCase</span>);
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="a826ebdedc45c1fa" href="../../R/a826ebdedc45c1fa.html" target="n" data-glyph="44,1" class="i field">CompareOptionsNone</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="i">CompareOptions</span>.<span class="i">None</span>);
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="35b47bde317ce874" href="../../R/35b47bde317ce874.html" target="n" data-glyph="44,1" class="i field">Ordinal</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="i">StringComparison</span>.<span class="i">Ordinal</span>);
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="1a63ed7b35442a0a" href="../../R/1a63ed7b35442a0a.html" target="n" data-glyph="44,1" class="i field">InvariantCulture</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="5baeb89f5a8827ce" href="../../R/5baeb89f5a8827ce.html" target="n" data-glyph="44,1" class="i field">OrdinalIgnoreCaseComparer</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>, <b>typeof</b>(<span class="i">StringComparer</span>));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="8e19b9a6aeb74d9f" href="../../R/8e19b9a6aeb74d9f.html" target="n" data-glyph="44,1" class="i field">CatchAllType</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>.<a href="../runtime/Operations/MiscOps.cs.html#442e10289fb2ec35" class="t t">CatchAll</a>), <b>typeof</b>(<span class="i">Type</span>));
        <span class="c">// Empty expression is used at the end of blocks to give them the void expression result</span>
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="8c8caf15be3b9240" href="../../R/8c8caf15be3b9240.html" target="n" data-glyph="44,1" class="i field">Empty</a> = <span class="i">Expression</span>.<span class="i">Empty</span>();
 
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="a5a9149c45a2dbfc" href="../../R/a5a9149c45a2dbfc.html" target="n" data-glyph="44,1" class="i field">GetExecutionContextFromTLS</a> =
            <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#96e648a9a51ca253" class="i field">LocalPipeline_GetExecutionContextFromTLS</a>);
 
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="35879747cffe04dc" href="../../R/35879747cffe04dc.html" target="n" data-glyph="44,1" class="i field">BoxedTrue</a> = <span class="i">Expression</span>.<span class="i">Field</span>(<b>null</b>, <b>typeof</b>(<a href="../runtime/Operations/NumericOps.cs.html#a75d534e5fa18108" class="t t">Boxed</a>).<span class="i">GetField</span>(<span class="s">&quot;True&quot;</span>, <span class="i">BindingFlags</span>.<span class="i">Static</span> | <span class="i">BindingFlags</span>.<span class="i">NonPublic</span>));
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="07397be9f58aa70d" href="../../R/07397be9f58aa70d.html" target="n" data-glyph="44,1" class="i field">BoxedFalse</a> = <span class="i">Expression</span>.<span class="i">Field</span>(<b>null</b>, <b>typeof</b>(<a href="../runtime/Operations/NumericOps.cs.html#a75d534e5fa18108" class="t t">Boxed</a>).<span class="i">GetField</span>(<span class="s">&quot;False&quot;</span>, <span class="i">BindingFlags</span>.<span class="i">Static</span> | <span class="i">BindingFlags</span>.<span class="i">NonPublic</span>));
 
        <b>private static readonly</b> <span class="i">Expression</span>[] <a id="b23b524d5306cc42" href="../../R/b23b524d5306cc42.html" target="n" data-glyph="46,1" class="i field">s_intConstants</a> = <b>new</b> <span class="i">Expression</span>[102];
 
        <b>internal static</b> <span class="i">Expression</span> <a id="9f6df0bb7efa2829" href="../../R/9f6df0bb7efa2829.html" target="n" data-glyph="74,1" class="i method">Constant</a>(<b>int</b> <span id="r0 rd" class="r0 r">i</span>)
        {
            <span class="c">// We cache -1..100, anything else don&#39;t bother caching</span>
            <b>if</b> (<span class="r0 r">i</span> &lt; -1 || <span class="r0 r">i</span> &gt; 100)
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r0 r">i</span>);
            }
 
            <span class="i">Expression</span> <span id="r1 rd" class="r1 r">result</span> = <a href="#b23b524d5306cc42" class="i field">s_intConstants</a>[<span class="r0 r">i</span> + 1];
            <b>if</b> (<span class="r1 r">result</span> == <b>null</b>)
            {
                <span class="r1 r">result</span> = <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r0 r">i</span>);
                <a href="#b23b524d5306cc42" class="i field">s_intConstants</a>[<span class="r0 r">i</span> + 1] = <span class="r1 r">result</span>;
            }
 
            <b>return</b> <span class="r1 r">result</span>;
        }
 
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="135da39507c8f0ad" href="../../R/135da39507c8f0ad.html" target="n" data-glyph="44,1" class="i field">TrueConstant</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>true</b>);
        <b>internal static readonly</b> <span class="i">Expression</span> <a id="b391c2b08d02e390" href="../../R/b391c2b08d02e390.html" target="n" data-glyph="44,1" class="i field">FalseConstant</a> = <span class="i">Expression</span>.<span class="i">Constant</span>(<b>false</b>);
 
        <b>internal static</b> <span class="i">Expression</span> <a id="8ae9528048f248a7" href="../../R/8ae9528048f248a7.html" target="n" data-glyph="74,1" class="i method">Constant</a>(<b>bool</b> <span id="r2 rd" class="r2 r">b</span>)
        {
            <b>return</b> <span class="r2 r">b</span> ? <a href="#135da39507c8f0ad" class="i field">TrueConstant</a> : <a href="#b391c2b08d02e390" class="i field">FalseConstant</a>;
        }
    }
 
    <b>internal static class</b> <a id="ee33c16b0a7676a0" href="../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t">ExpressionExtensions</a>
    {
        <b>internal static</b> <span class="i">Expression</span> <a id="623da12beb9db704" href="../../R/623da12beb9db704.html" target="n" data-glyph="221,1" class="i method">Convert</a>(<b>this</b> <span class="i">Expression</span> <span id="r3 rd" class="r3 r">expr</span>, <span class="i">Type</span> <span id="r4 rd" class="r4 r">type</span>)
        {
            <b>if</b> (<span class="r3 r">expr</span>.<span class="i">Type</span> == <span class="r4 r">type</span>)
            {
                <b>return</b> <span class="r3 r">expr</span>;
            }
 
            <b>if</b> (<span class="r3 r">expr</span>.<span class="i">Type</span> == <b>typeof</b>(<b>void</b>))
            {
                <span class="c">// If we&#39;re converting from void, use $null instead to figure the conversion.</span>
                <span class="r3 r">expr</span> = <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>;
            }
 
            <a href="../LanguagePrimitives.cs.html#7366d8a93041350f" class="k">var</a> <span id="r5 rd" class="r5 r">conversion</span> = <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">GetConversionRank</span>(<span class="r3 r">expr</span>.<span class="i">Type</span>, <span class="r4 r">type</span>);
            <b>if</b> (<span class="r5 r">conversion</span> == <a href="../LanguagePrimitives.cs.html#7366d8a93041350f" class="t t">ConversionRank</a>.<a href="../LanguagePrimitives.cs.html#6a83ff53b2a840f5" class="i field">Assignable</a>)
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Convert</span>(<span class="r3 r">expr</span>, <span class="r4 r">type</span>);
            }
 
            <b>if</b> (<span class="r4 r">type</span>.<span class="i">ContainsGenericParameters</span> || <span class="r4 r">type</span>.<span class="i">IsByRefLike</span>)
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#7c6872852f680527" class="i field">LanguagePrimitives_ThrowInvalidCastException</a>,
                    <span class="r3 r">expr</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r4 r">type</span>, <b>typeof</b>(<span class="i">Type</span>)));
            }
 
            <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#97a1cf18399e4247" class="t t">PSConvertBinder</a>.<a href="../runtime/Binding/Binders.cs.html#eda18cf3e4f03bf5" class="i method">Get</a>(<span class="r4 r">type</span>), <span class="r4 r">type</span>, <span class="r3 r">expr</span>);
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="664379b8310751e4" href="../../R/664379b8310751e4.html" target="n" data-glyph="221,1" class="i method">Cast</a>(<b>this</b> <span class="i">Expression</span> <span id="r6 rd" class="r6 r">expr</span>, <span class="i">Type</span> <span id="r7 rd" class="r7 r">type</span>)
        {
            <b>if</b> (<span class="r6 r">expr</span>.<span class="i">Type</span> == <span class="r7 r">type</span>)
            {
                <b>return</b> <span class="r6 r">expr</span>;
            }
 
            <b>if</b> ((<span class="r6 r">expr</span>.<span class="i">Type</span>.<span class="i">IsFloating</span>() || <span class="r6 r">expr</span>.<span class="i">Type</span> == <b>typeof</b>(<b>decimal</b>)) &amp;&amp; <span class="r7 r">type</span>.<span class="i">IsPrimitive</span>)
            {
                <span class="c">// Convert correctly handles most &quot;primitive&quot; conversions for PowerShell,</span>
                <span class="c">// but it does not correctly handle floating point.</span>
                <span class="r6 r">expr</span> = <span class="i">Expression</span>.<span class="i">Call</span>(
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#484b94d4bdfa9e07" class="i field">Convert_ChangeType</a>,
                    <span class="i">Expression</span>.<span class="i">Convert</span>(<span class="r6 r">expr</span>, <b>typeof</b>(<b>object</b>)),
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r7 r">type</span>, <b>typeof</b>(<span class="i">Type</span>)));
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Convert</span>(<span class="r6 r">expr</span>, <span class="r7 r">type</span>);
        }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">ENABLE_BINDER_DEBUG_LOGGING</span>
<span class="e">        internal static string ToDebugString(this Expression expr)
        {
            using (var writer = new StringWriter(CultureInfo.InvariantCulture))
            {
                DebugViewWriter.WriteTo(expr, writer);
                return writer.ToString();
            }
        }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
    }
 
    <b>internal class</b> <a id="aa4ec5dd36f7e2eb" href="../../R/aa4ec5dd36f7e2eb.html" target="n" data-glyph="2,0" class="t t"><span id="c83ef588f7ffb8b9">FunctionContext</span></a>
    {
        <b>internal</b> <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a> <a id="4980a1f93a561cb3" href="../../R/4980a1f93a561cb3.html" target="n" data-glyph="44,1" class="i field">_scriptBlock</a>;
        <b>internal string</b> <a id="95a73081cffaa015" href="../../R/95a73081cffaa015.html" target="n" data-glyph="44,1" class="i field">_file</a>;
        <b>internal bool</b> <a id="f9539890beb6e765" href="../../R/f9539890beb6e765.html" target="n" data-glyph="44,1" class="i field">_debuggerHidden</a>;
        <b>internal bool</b> <a id="f82ab745f95a8791" href="../../R/f82ab745f95a8791.html" target="n" data-glyph="44,1" class="i field">_debuggerStepThrough</a>;
        <b>internal</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>[] <a id="354889e302c1693c" href="../../R/354889e302c1693c.html" target="n" data-glyph="44,1" class="i field">_sequencePoints</a>;
        <b>internal</b> <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <a id="86d08ccdd0602a1b" href="../../R/86d08ccdd0602a1b.html" target="n" data-glyph="44,1" class="i field">_executionContext</a>;
        <b>internal</b> <a href="../Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a> <a id="6c44d518392049f0" href="../../R/6c44d518392049f0.html" target="n" data-glyph="44,1" class="i field">_outputPipe</a>;
        <b>internal</b> <span class="i">BitArray</span> <a id="cc249a58ac34eb70" href="../../R/cc249a58ac34eb70.html" target="n" data-glyph="44,1" class="i field">_breakPoints</a>;
        <b>internal</b> <span class="i">List</span>&lt;<a href="../debugger/Breakpoint.cs.html#8289c87b2cf2e5fd" class="t t">LineBreakpoint</a>&gt; <a id="18b1921c6a906819" href="../../R/18b1921c6a906819.html" target="n" data-glyph="44,1" class="i field">_boundBreakpoints</a>;
        <b>internal int</b> <a id="16213bb1bf477e12" href="../../R/16213bb1bf477e12.html" target="n" data-glyph="44,1" class="i field">_currentSequencePointIndex</a>;
        <b>internal</b> <a href="../runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a> <a id="23a9d5ac6a3b086b" href="../../R/23a9d5ac6a3b086b.html" target="n" data-glyph="44,1" class="i field">_localsTuple</a>;
        <b>internal</b> <span class="i">List</span>&lt;<span class="i">Tuple</span>&lt;<span class="i">Type</span>[], <span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;[], <span class="i">Type</span>[]&gt;&gt; <a id="8df161901eca9056" href="../../R/8df161901eca9056.html" target="n" data-glyph="44,1" class="i field">_traps</a> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Tuple</span>&lt;<span class="i">Type</span>[], <span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;[], <span class="i">Type</span>[]&gt;&gt;();
        <b>internal string</b> <a id="cf35fafd088fea9b" href="../../R/cf35fafd088fea9b.html" target="n" data-glyph="44,1" class="i field">_functionName</a>;
 
        <b>internal</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="5ed77de1a1fe863f" href="../../R/5ed77de1a1fe863f.html" target="n" data-glyph="104,1" class="i property">CurrentPosition</a>
        {
            <b>get</b> { <b>return</b> <a href="#354889e302c1693c" class="i field">_sequencePoints</a> != <b>null</b> ? <a href="#354889e302c1693c" class="i field">_sequencePoints</a>[<a href="#16213bb1bf477e12" class="i field">_currentSequencePointIndex</a>] : <a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>; }
        }
 
        <b>internal void</b> <a id="5ec9e5f7bbdb6342" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">PushTrapHandlers</a>(<span class="i">Type</span>[] <span id="r8 rd" class="r8 r">type</span>, <span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;[] <span id="r9 rd" class="r9 r">handler</span>, <span class="i">Type</span>[] <span id="r10 rd" class="r10 r">tupleType</span>)
        {
            <a href="#8df161901eca9056" class="i field">_traps</a>.<span class="i">Add</span>(<span class="i">Tuple</span>.<span class="i">Create</span>(<span class="r8 r">type</span>, <span class="r9 r">handler</span>, <span class="r10 r">tupleType</span>));
        }
 
        <b>internal void</b> <a id="2ddc5eb98d16c5a1" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">PopTrapHandlers</a>()
        {
            <a href="#8df161901eca9056" class="i field">_traps</a>.<span class="i">RemoveAt</span>(<a href="#8df161901eca9056" class="i field">_traps</a>.<span class="i">Count</span> - 1);
        }
    }
 
    <b>internal class</b> <a id="8bdfc042f41c96c5" href="../../R/8bdfc042f41c96c5.html" target="n" data-glyph="2,0" class="t t">Compiler</a> : <a href="AstVisitor.cs.html#92b75e0afbdd3cf3" class="t t">ICustomAstVisitor2</a>
    {
        <b>internal static readonly</b> <span class="i">ParameterExpression</span> <a id="19a26e33d480616b" href="../../R/19a26e33d480616b.html" target="n" data-glyph="44,1" class="i field">s_executionContextParameter</a>;
        <b>internal static readonly</b> <span class="i">ParameterExpression</span> <a id="a155db4f24ac5d42" href="../../R/a155db4f24ac5d42.html" target="n" data-glyph="44,1" class="i field">s_functionContext</a>;
        <b>private static readonly</b> <span class="i">ParameterExpression</span> <a id="f0e2b48eb0cbdbad" href="../../R/f0e2b48eb0cbdbad.html" target="n" data-glyph="46,1" class="i field">s_returnPipe</a>;
        <b>private static readonly</b> <span class="i">Expression</span> <a id="ab3f5f777a49c851" href="../../R/ab3f5f777a49c851.html" target="n" data-glyph="46,1" class="i field">s_notDollarQuestion</a>;
        <b>private static readonly</b> <span class="i">Expression</span> <a id="de9feee0a42f7758" href="../../R/de9feee0a42f7758.html" target="n" data-glyph="46,1" class="i field">s_getDollarQuestion</a>;
        <b>private static readonly</b> <span class="i">Expression</span> <a id="569b451340efd095" href="../../R/569b451340efd095.html" target="n" data-glyph="46,1" class="i field">s_setDollarQuestionToTrue</a>;
        <b>private static readonly</b> <span class="i">Expression</span> <a id="2adea26bac49ee2f" href="../../R/2adea26bac49ee2f.html" target="n" data-glyph="46,1" class="i field">s_callCheckForInterrupts</a>;
        <b>private static readonly</b> <span class="i">Expression</span> <a id="ad66a442944d59df" href="../../R/ad66a442944d59df.html" target="n" data-glyph="46,1" class="i field">s_getCurrentPipe</a>;
        <b>private static readonly</b> <span class="i">Expression</span> <a id="a6b2b6aa258ffb38" href="../../R/a6b2b6aa258ffb38.html" target="n" data-glyph="46,1" class="i field">s_currentExceptionBeingHandled</a>;
        <b>private static readonly</b> <span class="i">CatchBlock</span> <a id="e882e88ed6326a81" href="../../R/e882e88ed6326a81.html" target="n" data-glyph="46,1" class="i field">s_catchFlowControl</a>;
 
        <b>private static readonly</b> <span class="i">CatchBlock</span>[] <a id="5cd7a558b5b2f627" href="../../R/5cd7a558b5b2f627.html" target="n" data-glyph="46,1" class="i field">s_stmtCatchHandlers</a>;
        <b>internal static readonly</b> <span class="i">Type</span> <a id="50f3467ff6c08485" href="../../R/50f3467ff6c08485.html" target="n" data-glyph="44,1" class="i field">DottedLocalsTupleType</a> = <a href="../runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a>.<a href="../runtime/MutableTuple.cs.html#e57876649d4502e3" class="i method">MakeTupleType</a>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#6729b0cd3aff6afe" class="i field">AutomaticVariableTypes</a>);
 
        <b>internal static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>int</b>&gt; <a id="8a3b323becd5e9eb" href="../../R/8a3b323becd5e9eb.html" target="n" data-glyph="44,1" class="i field">DottedLocalsNameIndexMap</a> =
            <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>int</b>&gt;(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#6729b0cd3aff6afe" class="i field">AutomaticVariableTypes</a>.<span class="i">Length</span>, <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <b>internal static readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>int</b>&gt; <a id="53f2953cbecb6154" href="../../R/53f2953cbecb6154.html" target="n" data-glyph="44,1" class="i field">DottedScriptCmdletLocalsNameIndexMap</a> =
            <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <b>int</b>&gt;(
                <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#6729b0cd3aff6afe" class="i field">AutomaticVariableTypes</a>.<span class="i">Length</span> + <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#2ad4ebba0d8352d4" class="i field">PreferenceVariableTypes</a>.<span class="i">Length</span>,
                <span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
        <b>static</b> <a id="f466157043f66dc6" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t method">Compiler</a>()
        {
            <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>), <span class="s">&quot;funcContext&quot;</span>);
            <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a> = <span class="i">Expression</span>.<span class="i">Variable</span>(<b>typeof</b>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a>), <span class="s">&quot;context&quot;</span>);
 
            <a href="#de9feee0a42f7758" class="i field">s_getDollarQuestion</a> = <span class="i">Expression</span>.<span class="i">Property</span>(<a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#62b97ea0876c7d79" class="i field">ExecutionContext_QuestionMarkVariableValue</a>);
 
            <a href="#ab3f5f777a49c851" class="i field">s_notDollarQuestion</a> = <span class="i">Expression</span>.<span class="i">Not</span>(<a href="#de9feee0a42f7758" class="i field">s_getDollarQuestion</a>);
 
            <a href="#569b451340efd095" class="i field">s_setDollarQuestionToTrue</a> = <span class="i">Expression</span>.<span class="i">Assign</span>(
                <a href="#de9feee0a42f7758" class="i field">s_getDollarQuestion</a>,
                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#135da39507c8f0ad" class="i field">TrueConstant</a>);
 
            <a href="#2adea26bac49ee2f" class="i field">s_callCheckForInterrupts</a> = <span class="i">Expression</span>.<span class="i">Call</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#02f1013c307917f0" class="i field">PipelineOps_CheckForInterrupts</a>,
                <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>);
 
            <a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a> = <span class="i">Expression</span>.<span class="i">Field</span>(<a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#6d8360b4ef0b27b9" class="i field">FunctionContext__outputPipe</a>);
            <a href="#f0e2b48eb0cbdbad" class="i field">s_returnPipe</a> = <span class="i">Expression</span>.<span class="i">Variable</span>(<a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>.<span class="i">Type</span>, <span class="s">&quot;returnPipe&quot;</span>);
 
            <b>var</b> <span id="r11 rd" class="r11 r">exception</span> = <span class="i">Expression</span>.<span class="i">Variable</span>(<b>typeof</b>(<span class="i">Exception</span>), <span class="s">&quot;exception&quot;</span>);
 
            <a href="#e882e88ed6326a81" class="i field">s_catchFlowControl</a> = <span class="i">Expression</span>.<span class="i">Catch</span>(<b>typeof</b>(<a href="../lang/parserutils.cs.html#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>), <span class="i">Expression</span>.<span class="i">Rethrow</span>());
            <b>var</b> <span id="r12 rd" class="r12 r">catchAll</span> = <span class="i">Expression</span>.<span class="i">Catch</span>(
                <span class="r11 r">exception</span>,
                <span class="i">Expression</span>.<span class="i">Block</span>(
                    <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#8da10b470305ec34" class="i field">ExceptionHandlingOps_CheckActionPreference</a>,
                        <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>, <span class="r11 r">exception</span>)));
            <a href="#5cd7a558b5b2f627" class="i field">s_stmtCatchHandlers</a> = <b>new</b> <span class="i">CatchBlock</span>[] { <a href="#e882e88ed6326a81" class="i field">s_catchFlowControl</a>, <span class="r12 r">catchAll</span> };
 
            <a href="#a6b2b6aa258ffb38" class="i field">s_currentExceptionBeingHandled</a> = <span class="i">Expression</span>.<span class="i">Property</span>(
                <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#1398b28ba5332ee2" class="i field">ExecutionContext_CurrentExceptionBeingHandled</a>);
 
            <b>int</b> <span id="r13 rd" class="r13 r">i</span>;
            <b>for</b> (<span class="r13 r">i</span> = 0; <span class="r13 r">i</span> &lt; <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#2e947723b75287da" class="i field">AutomaticVariables</a>.<span class="i">Length</span>; ++<span class="r13 r">i</span>)
            {
                <a href="#8a3b323becd5e9eb" class="i field">DottedLocalsNameIndexMap</a>.<span class="i">Add</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#2e947723b75287da" class="i field">AutomaticVariables</a>[<span class="r13 r">i</span>], <span class="r13 r">i</span>);
                <a href="#53f2953cbecb6154" class="i field">DottedScriptCmdletLocalsNameIndexMap</a>.<span class="i">Add</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#2e947723b75287da" class="i field">AutomaticVariables</a>[<span class="r13 r">i</span>], <span class="r13 r">i</span>);
            }
 
            <b>for</b> (<span class="r13 r">i</span> = 0; <span class="r13 r">i</span> &lt; <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#9116a45d77f35b10" class="i field">PreferenceVariables</a>.<span class="i">Length</span>; ++<span class="r13 r">i</span>)
            {
                <a href="#53f2953cbecb6154" class="i field">DottedScriptCmdletLocalsNameIndexMap</a>.<span class="i">Add</span>(
                    <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#9116a45d77f35b10" class="i field">PreferenceVariables</a>[<span class="r13 r">i</span>],
                    <span class="r13 r">i</span> + (<b>int</b>)<a href="../SpecialVariables.cs.html#1c6f2efd91287b59" class="t t">AutomaticVariable</a>.<a href="../SpecialVariables.cs.html#d64e69972d70be92" class="i field">NumberOfAutomaticVariables</a>);
            }
 
            <a href="#c66254218b170d12" class="i field">s_builtinAttributeGenerator</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../Attributes.cs.html#67a775c242618ea6" class="t t">CmdletBindingAttribute</a>), <span class="i">NewCmdletBindingAttribute</span>);
            <a href="#c66254218b170d12" class="i field">s_builtinAttributeGenerator</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a>), <span class="i">NewExperimentalAttribute</span>);
            <a href="#c66254218b170d12" class="i field">s_builtinAttributeGenerator</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>), <span class="i">NewParameterAttribute</span>);
            <a href="#c66254218b170d12" class="i field">s_builtinAttributeGenerator</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../Attributes.cs.html#c50a02cd2178a292" class="t t">OutputTypeAttribute</a>), <span class="i">NewOutputTypeAttribute</span>);
            <a href="#c66254218b170d12" class="i field">s_builtinAttributeGenerator</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../Attributes.cs.html#0fd790dcae0b5382" class="t t">AliasAttribute</a>), <span class="i">NewAliasAttribute</span>);
            <a href="#c66254218b170d12" class="i field">s_builtinAttributeGenerator</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../Attributes.cs.html#33a6a027748d30a4" class="t t">ValidateSetAttribute</a>), <span class="i">NewValidateSetAttribute</span>);
            <a href="#c66254218b170d12" class="i field">s_builtinAttributeGenerator</a>.<span class="i">Add</span>(<b>typeof</b>(<span class="i">DebuggerHiddenAttribute</span>), <span class="i">NewDebuggerHiddenAttribute</span>);
            <a href="#c66254218b170d12" class="i field">s_builtinAttributeGenerator</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../Attributes.cs.html#30630ef4e72decfd" class="t t">ValidateNotNullAttribute</a>), <span class="i">NewValidateNotNullAttribute</span>);
            <a href="#c66254218b170d12" class="i field">s_builtinAttributeGenerator</a>.<span class="i">Add</span>(<b>typeof</b>(<a href="../Attributes.cs.html#6046c0828ea7bcf9" class="t t">ValidateNotNullOrEmptyAttribute</a>), <span class="i">NewValidateNotNullOrEmptyAttribute</span>);
        }
 
        <b>private</b> <a id="fa2dc33b1b4ec7bd" href="../../R/fa2dc33b1b4ec7bd.html" target="n" data-glyph="76,1" class="t constructor">Compiler</a>(<span class="i">List</span>&lt;<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>&gt; <span id="r14 rd" class="r14 r">sequencePoints</span>, <span class="i">Dictionary</span>&lt;<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>, <b>int</b>&gt; <span id="r15 rd" class="r15 r">sequencePointIndexMap</span>)
        {
            <a href="#be6f1ba488dac21b" class="i field">_sequencePoints</a> = <span class="r14 r">sequencePoints</span>;
            <a href="#f8a0435f5353a62a" class="i field">_sequencePointIndexMap</a> = <span class="r15 r">sequencePointIndexMap</span>;
        }
 
        <b>internal</b> <a id="b6cc6d8d9723112a" href="../../R/b6cc6d8d9723112a.html" target="n" data-glyph="74,1" class="t constructor">Compiler</a>()
        {
            <a href="#be6f1ba488dac21b" class="i field">_sequencePoints</a> = <b>new</b> <span class="i">List</span>&lt;<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>&gt;();
            <a href="#f8a0435f5353a62a" class="i field">_sequencePointIndexMap</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>, <b>int</b>&gt;();
        }
 
        <b>internal bool</b> <a id="afdf1b538daea434" href="../../R/afdf1b538daea434.html" target="n" data-glyph="104,1" class="i property">CompilingConstantExpression</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal bool</b> <a id="57ac2e55a5b17eb3" href="../../R/57ac2e55a5b17eb3.html" target="n" data-glyph="104,1" class="i property">Optimize</a> { <b>get</b>; <b>private set</b>; }
 
        <b>internal</b> <span class="i">Type</span> <a id="5d2d67fd5d17c19b" href="../../R/5d2d67fd5d17c19b.html" target="n" data-glyph="104,1" class="i property">LocalVariablesTupleType</a> { <b>get</b>; <b>private set</b>; }
 
        <b>internal</b> <span class="i">ParameterExpression</span> <a id="60079b222ae29e0d" href="../../R/60079b222ae29e0d.html" target="n" data-glyph="104,1" class="i property">LocalVariablesParameter</a> { <b>get</b>; <b>private set</b>; }
 
        <b>private</b> <span class="i">SymbolDocumentInfo</span> <a id="2807a84cb0b61e38" href="../../R/2807a84cb0b61e38.html" target="n" data-glyph="46,1" class="i field">_debugSymbolDocument</a>;
        <b>internal</b> <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <a id="b91585e4adf5dd44" href="../../R/b91585e4adf5dd44.html" target="n" data-glyph="44,1" class="i field">_memberFunctionType</a>;
        <b>private bool</b> <a id="3647e83d7c60a8f3" href="../../R/3647e83d7c60a8f3.html" target="n" data-glyph="46,1" class="i field">_compilingTrap</a>;
        <b>private bool</b> <a id="3133d55c945a52aa" href="../../R/3133d55c945a52aa.html" target="n" data-glyph="46,1" class="i field">_compilingSingleExpression</a>;
        <b>private bool</b> <a id="1502a03e3576ca9a" href="../../R/1502a03e3576ca9a.html" target="n" data-glyph="46,1" class="i field">_compilingScriptCmdlet</a>;
        <b>private string</b> <a id="5cd149086434fa25" href="../../R/5cd149086434fa25.html" target="n" data-glyph="46,1" class="i field">_currentFunctionName</a>;
        <b>private int</b> <a id="6fecf39186823e1e" href="../../R/6fecf39186823e1e.html" target="n" data-glyph="46,1" class="i field">_switchTupleIndex</a> = <a href="VariableAnalysis.cs.html#3d310869db3a3b73" class="t t">VariableAnalysis</a>.<a href="VariableAnalysis.cs.html#6aefafdf223b7beb" class="i field">Unanalyzed</a>;
        <b>private int</b> <a id="0ae9e05f0dbd60e7" href="../../R/0ae9e05f0dbd60e7.html" target="n" data-glyph="46,1" class="i field">_foreachTupleIndex</a> = <a href="VariableAnalysis.cs.html#3d310869db3a3b73" class="t t">VariableAnalysis</a>.<a href="VariableAnalysis.cs.html#6aefafdf223b7beb" class="i field">Unanalyzed</a>;
        <b>private readonly</b> <span class="i">List</span>&lt;<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>&gt; <a id="be6f1ba488dac21b" href="../../R/be6f1ba488dac21b.html" target="n" data-glyph="46,1" class="i field">_sequencePoints</a>;
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>, <b>int</b>&gt; <a id="f8a0435f5353a62a" href="../../R/f8a0435f5353a62a.html" target="n" data-glyph="46,1" class="i field">_sequencePointIndexMap</a>;
        <b>private int</b> <a id="bbc2448f2228e671" href="../../R/bbc2448f2228e671.html" target="n" data-glyph="46,1" class="i field">_stmtCount</a>;
 
        <b>internal bool</b> <a id="e116f57a129b16bc" href="../../R/e116f57a129b16bc.html" target="n" data-glyph="104,1" class="i property">CompilingMemberFunction</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <a href="ast.cs.html#19743eab765b38bd" class="t t">SpecialMemberFunctionType</a> <a id="c3fa23b2c44834ed" href="../../R/c3fa23b2c44834ed.html" target="n" data-glyph="104,1" class="i property">SpecialMemberFunctionType</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <span class="i">Type</span> <a id="0956e73d835184c4" href="../../R/0956e73d835184c4.html" target="n" data-glyph="104,1" class="i property">MemberFunctionReturnType</a>
        {
            <b>get</b>
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#e116f57a129b16bc" class="i property">CompilingMemberFunction</a>, <span class="s">&quot;Return not only set for member functions&quot;</span>);
                <b>return</b> <a href="#353f682f10e11518" class="i field">_memberFunctionReturnType</a>;
            }
 
            <b>set</b>
            {
                <a href="#353f682f10e11518" class="i field">_memberFunctionReturnType</a> = <b>value</b>;
            }
        }
 
        <b>private</b> <span class="i">Type</span> <a id="353f682f10e11518" href="../../R/353f682f10e11518.html" target="n" data-glyph="46,1" class="i field">_memberFunctionReturnType</a>;
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Helpers for AST Compile methods
 
        <b>internal</b> <span class="i">Expression</span> <a id="5795855cf17e55b6" href="../../R/5795855cf17e55b6.html" target="n" data-glyph="74,1" class="i method">Compile</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r16 rd" class="r16 r">ast</span>)
        {
            <b>return</b> (<span class="i">Expression</span>)<span class="r16 r">ast</span>.<a href="ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#8bdfc042f41c96c5" class="k">this</a>);
        }
 
        <b>internal</b> <span class="i">Expression</span> <a id="918593282571f172" href="../../R/918593282571f172.html" target="n" data-glyph="74,1" class="i method">CompileExpressionOperand</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r17 rd" class="r17 r">exprAst</span>)
        {
            <b>var</b> <span id="r18 rd" class="r18 r">result</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r17 r">exprAst</span>);
            <b>if</b> (<span class="r18 r">result</span>.<span class="i">Type</span> == <b>typeof</b>(<b>void</b>))
            {
                <span class="r18 r">result</span> = <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r18 r">result</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>);
            }
 
            <b>return</b> <span class="r18 r">result</span>;
        }
 
        <b>private</b> <span class="i">IEnumerable</span>&lt;<span class="i">Expression</span>&gt; <a id="9c2dff8d9d959240" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CompileInvocationArguments</a>(<span class="i">IReadOnlyList</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r19 rd" class="r19 r">arguments</span>)
        {
            <b>if</b> (<span class="r19 r">arguments</span> <b>is null</b> || <span class="r19 r">arguments</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<span class="i">Expression</span>&gt;();
            }
 
            <b>var</b> <span id="r20 rd" class="r20 r">result</span> = <b>new</b> <span class="i">Expression</span>[<span class="r19 r">arguments</span>.<span class="i">Count</span>];
            <b>for</b> (<b>int</b> <span id="r21 rd" class="r21 r">i</span> = 0; <span class="r21 r">i</span> &lt; <span class="r20 r">result</span>.<span class="i">Length</span>; <span class="r21 r">i</span>++)
            {
                <span class="r20 r">result</span>[<span class="r21 r">i</span>] = <span class="i">CompileExpressionOperand</span>(<span class="r19 r">arguments</span>[<span class="r21 r">i</span>]);
            }
 
            <b>return</b> <span class="r20 r">result</span>;
        }
 
        <b>internal</b> <span class="i">Expression</span> <a id="e705d7767bd0f6e1" href="../../R/e705d7767bd0f6e1.html" target="n" data-glyph="74,1" class="i method">ReduceAssignment</a>(<a href="ast.cs.html#1a23a5e08e419be9" class="t t">ISupportsAssignment</a> <span id="r22 rd" class="r22 r">left</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r23 rd" class="r23 r">tokenKind</span>, <span class="i">Expression</span> <span id="r24 rd" class="r24 r">right</span>)
        {
            <a href="ast.cs.html#41e026a3563ae47a" class="t t">IAssignableValue</a> <span id="r25 rd" class="r25 r">av</span> = <span class="r22 r">left</span>.<a href="ast.cs.html#2a53987d0bdfbaff" class="i method">GetAssignableValue</a>();
            <span class="i">ExpressionType</span> <span id="r26 rd" class="r26 r">et</span> = <span class="i">ExpressionType</span>.<span class="i">Extension</span>;
 
            <b>switch</b> (<span class="r23 r">tokenKind</span>)
            {
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d78e08594ff6b79a" class="i field">Equals</a>: <b>return</b> <span class="r25 r">av</span>.<a href="ast.cs.html#e85a96ce4e1c229b" class="i method">SetValue</a>(<a href="#8bdfc042f41c96c5" class="k">this</a>, <span class="r24 r">right</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f6d4a910265412a7" class="i field">PlusEquals</a>: <span class="r26 r">et</span> = <span class="i">ExpressionType</span>.<span class="i">Add</span>; <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#dcd923ca24260759" class="i field">MinusEquals</a>: <span class="r26 r">et</span> = <span class="i">ExpressionType</span>.<span class="i">Subtract</span>; <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6c49c2a3b761110c" class="i field">MultiplyEquals</a>: <span class="r26 r">et</span> = <span class="i">ExpressionType</span>.<span class="i">Multiply</span>; <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8436da4645d15749" class="i field">DivideEquals</a>: <span class="r26 r">et</span> = <span class="i">ExpressionType</span>.<span class="i">Divide</span>; <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b2b9a8b28974d084" class="i field">RemainderEquals</a>: <span class="r26 r">et</span> = <span class="i">ExpressionType</span>.<span class="i">Modulo</span>; <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1dd8745359c5084d" class="i field">QuestionQuestionEquals</a>: <span class="r26 r">et</span> = <span class="i">ExpressionType</span>.<span class="i">Coalesce</span>; <b>break</b>;
            }
 
            <b>var</b> <span id="r27 rd" class="r27 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <b>var</b> <span id="r28 rd" class="r28 r">temps</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt;();
            <b>var</b> <span id="r29 rd" class="r29 r">getExpr</span> = <span class="r25 r">av</span>.<a href="ast.cs.html#68362cbeefdedafa" class="i method">GetValue</a>(<a href="#8bdfc042f41c96c5" class="k">this</a>, <span class="r27 r">exprs</span>, <span class="r28 r">temps</span>);
 
            <b>if</b> (<span class="r26 r">et</span> == <span class="i">ExpressionType</span>.<span class="i">Coalesce</span>)
            {
                <span class="r27 r">exprs</span>.<span class="i">Add</span>(<span class="r25 r">av</span>.<a href="ast.cs.html#e85a96ce4e1c229b" class="i method">SetValue</a>(<a href="#8bdfc042f41c96c5" class="k">this</a>, <span class="i">Coalesce</span>(<span class="r29 r">getExpr</span>, <span class="r24 r">right</span>)));
            }
            <b>else</b>
            {
                <span class="r27 r">exprs</span>.<span class="i">Add</span>(<span class="r25 r">av</span>.<span class="i">SetValue</span>(<a href="#8bdfc042f41c96c5" class="k">this</a>, <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<a href="../runtime/Binding/Binders.cs.html#0adc292a0fe88585" class="i method">Get</a>(<span class="r26 r">et</span>), <b>typeof</b>(<b>object</b>), <span class="r29 r">getExpr</span>, <span class="r24 r">right</span>)));
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r28 r">temps</span>, <span class="r27 r">exprs</span>);
        }
 
        <b>private static</b> <span class="i">Expression</span> <a id="400fe7a726896ae7" href="../../R/400fe7a726896ae7.html" target="n" data-glyph="76,1" class="i method">Coalesce</a>(<span class="i">Expression</span> <span id="r30 rd" class="r30 r">left</span>, <span class="i">Expression</span> <span id="r31 rd" class="r31 r">right</span>)
        {
            <span class="i">Type</span> <span id="r32 rd" class="r32 r">leftType</span> = <span class="r30 r">left</span>.<span class="i">Type</span>;
 
            <b>if</b> (<span class="r32 r">leftType</span>.<span class="i">IsValueType</span>)
            {
                <b>return</b> <span class="r30 r">left</span>;
            }
            <b>else</b>
            {
                <span class="i">ParameterExpression</span> <span id="r33 rd" class="r33 r">lhsStoreVar</span> = <span class="i">Expression</span>.<span class="i">Variable</span>(<b>typeof</b>(<b>object</b>));
                <b>var</b> <span id="r34 rd" class="r34 r">blockParameters</span> = <b>new</b> <span class="i">ParameterExpression</span>[] { <span class="r33 r">lhsStoreVar</span> };
                <b>var</b> <span id="r35 rd" class="r35 r">blockStatements</span> = <b>new</b> <span class="i">Expression</span>[]
                {
                    <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r33 r">lhsStoreVar</span>, <span class="r30 r">left</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>))),
                    <span class="i">Expression</span>.<span class="i">Condition</span>(
                        <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#3dae8f6f568e4e16" class="i field">LanguagePrimitives_IsNull</a>, <span class="r33 r">lhsStoreVar</span>),
                        <span class="r31 r">right</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r33 r">lhsStoreVar</span>),
                };
 
                <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(
                    <b>typeof</b>(<b>object</b>),
                    <span class="r34 r">blockParameters</span>,
                    <span class="r35 r">blockStatements</span>);
            }
        }
 
        <b>internal</b> <span class="i">Expression</span> <a id="719f3e105a567e40" href="../../R/719f3e105a567e40.html" target="n" data-glyph="74,1" class="i method">GetLocal</a>(<b>int</b> <span id="r36 rd" class="r36 r">tupleIndex</span>)
        {
            <span class="i">Expression</span> <span id="r37 rd" class="r37 r">result</span> = <a href="#60079b222ae29e0d" class="i property">LocalVariablesParameter</a>;
            <b>foreach</b> (<b>var</b> <span id="r38 rd" class="r38 r">property</span> <b>in</b> <a href="../runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a>.<a href="../runtime/MutableTuple.cs.html#7b3f5dc3830e707f" class="i method">GetAccessPath</a>(<a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a>, <span class="r36 r">tupleIndex</span>))
            {
                <span class="r37 r">result</span> = <span class="i">Expression</span>.<span class="i">Property</span>(<span class="r37 r">result</span>, <span class="r38 r">property</span>);
            }
 
            <b>return</b> <span class="r37 r">result</span>;
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="54c1ba9deed7cb66" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CallGetVariable</a>(<span class="i">Expression</span> <span id="r39 rd" class="r39 r">variablePath</span>, <a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r40 rd" class="r40 r">varAst</span>)
        {
            <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#841755fa04d3973c" class="i field">VariableOps_GetVariableValue</a>,
                <span class="r39 r">variablePath</span>,
                <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r40 r">varAst</span>).<span class="i">Cast</span>(<b>typeof</b>(<a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>)));
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="a278a1b38b4a344a" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CallSetVariable</a>(<span class="i">Expression</span> <span id="r41 rd" class="r41 r">variablePath</span>, <span class="i">Expression</span> <span id="r42 rd" class="r42 r">rhs</span>, <span class="i">Expression</span> <span id="r43 rd" class="r43 r">attributes</span> = <b>null</b>)
        {
            <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#ba739a56c51dad1f" class="i field">VariableOps_SetVariableValue</a>,
                <span class="r41 r">variablePath</span>, <span class="r42 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                <span class="r43 r">attributes</span> ?? <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>.<span class="i">Cast</span>(<b>typeof</b>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>[])));
        }
 
        <b>internal</b> <span class="i">Expression</span> <a id="8da777d02b4dbc3b" href="../../R/8da777d02b4dbc3b.html" target="n" data-glyph="74,1" class="i method">GetAutomaticVariable</a>(<a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r44 rd" class="r44 r">varAst</span>)
        {
            <span class="c">// Generate, in psuedo code:</span>
            <span class="c">//</span>
            <span class="c">//     return (localsTuple.IsValueSet(tupleIndex)</span>
            <span class="c">//          ? localsTuple.ItemXXX</span>
            <span class="c">//          : VariableOps.GetAutomaticVariable(tupleIndex, executionContextParameter);</span>
            <span class="c">//</span>
            <span class="c">// We could be smarter about the generated code.  For example:</span>
            <span class="c">//</span>
            <span class="c">//     * $PSCmdlet - always set if the script uses cmdletbinding.</span>
            <span class="c">//     * $_ - always set in process and end block, otherwise need dynamic checks.</span>
            <span class="c">//     * $this - can never know if it&#39;s set, always need above psuedo code.</span>
            <span class="c">//     * $input - also can never know - it&#39;s always set from a command process, but not necessarily set from ScriptBlock.Invoke.</span>
            <span class="c">//</span>
            <span class="c">// These optimizations are not yet performed.</span>
            <span class="c">//</span>
            <b>int</b> <span id="r45 rd" class="r45 r">tupleIndex</span> = <span class="r44 r">varAst</span>.<a href="ast.cs.html#d2fd06bce4ae1ac6" class="i property">TupleIndex</a>;
            <b>var</b> <span id="r46 rd" class="r46 r">expr</span> = <a href="#719f3e105a567e40" class="i method">GetLocal</a>(<span class="r45 r">tupleIndex</span>);
            <b>var</b> <span id="r47 rd" class="r47 r">callGetAutomaticVariable</span> = <span class="i">Expression</span>.<span class="i">Call</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#45cd1e24836f5236" class="i field">VariableOps_GetAutomaticVariableValue</a>,
                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(<span class="r45 r">tupleIndex</span>),
                <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r44 r">varAst</span>)).<span class="i">Convert</span>(<span class="r46 r">expr</span>.<span class="i">Type</span>);
            <b>if</b> (!<a href="#57ac2e55a5b17eb3" class="i property">Optimize</a>)
                <b>return</b> <span class="r47 r">callGetAutomaticVariable</span>;
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Condition</span>(
                <span class="i">Expression</span>.<span class="i">Call</span>(
                    <a href="#60079b222ae29e0d" class="i property">LocalVariablesParameter</a>,
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#5e5572070af1f94c" class="i field">MutableTuple_IsValueSet</a>,
                    <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(<span class="r45 r">tupleIndex</span>)),
                <span class="r46 r">expr</span>,
                <span class="r47 r">callGetAutomaticVariable</span>);
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="ecc174ef7eb7ef85" href="../../R/ecc174ef7eb7ef85.html" target="n" data-glyph="74,1" class="i method">CallStringEquals</a>(<span class="i">Expression</span> <span id="r48 rd" class="r48 r">left</span>, <span class="i">Expression</span> <span id="r49 rd" class="r49 r">right</span>, <b>bool</b> <span id="r50 rd" class="r50 r">ignoreCase</span>)
        {
            <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#7f4e76c5368ddc35" class="i field">StringOps_Equals</a>,
                <span class="r48 r">left</span>,
                <span class="r49 r">right</span>,
                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#1a63ed7b35442a0a" class="i field">InvariantCulture</a>,
                <span class="r50 r">ignoreCase</span> ? <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8e856f76e62e2ba5" class="i field">CompareOptionsIgnoreCase</a> : <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#a826ebdedc45c1fa" class="i field">CompareOptionsNone</a>);
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="5a5c94283e952580" href="../../R/5a5c94283e952580.html" target="n" data-glyph="74,1" class="i method">IsStrictMode</a>(<b>int</b> <span id="r51 rd" class="r51 r">version</span>, <span class="i">Expression</span> <span id="r52 rd" class="r52 r">executionContext</span> = <b>null</b>)
        {
            <b>if</b> (<span class="r52 r">executionContext</span> == <b>null</b>)
            {
                <span class="r52 r">executionContext</span> = <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#7b63a499a59a20bd" class="i field">NullExecutionContext</a>;
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#69e8d4ddc89962f4" class="i field">ExecutionContext_IsStrictVersion</a>,
                <span class="r52 r">executionContext</span>,
                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(<span class="r51 r">version</span>));
        }
 
        <b>private int</b> <a id="319aa081bb450665" href="../../R/319aa081bb450665.html" target="n" data-glyph="76,1" class="i method">AddSequencePoint</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r53 rd" class="r53 r">extent</span>)
        {
            <span class="c">// Make sure we don&#39;t add the same extent to the sequence point list twice.</span>
            <b>if</b> (!<a href="#f8a0435f5353a62a" class="i field">_sequencePointIndexMap</a>.<span class="i">TryGetValue</span>(<span class="r53 r">extent</span>, <b>out int</b> <span id="r54 rd" class="r54 r">index</span>))
            {
                <a href="#be6f1ba488dac21b" class="i field">_sequencePoints</a>.<span class="i">Add</span>(<span class="r53 r">extent</span>);
                <span class="r54 r">index</span> = <a href="#be6f1ba488dac21b" class="i field">_sequencePoints</a>.<span class="i">Count</span> - 1;
                <a href="#f8a0435f5353a62a" class="i field">_sequencePointIndexMap</a>.<span class="i">Add</span>(<span class="r53 r">extent</span>, <span class="r54 r">index</span>);
            }
 
            <b>return</b> <span class="r54 r">index</span>;
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="1dacc885a3fff678" href="../../R/1dacc885a3fff678.html" target="n" data-glyph="76,1" class="i method">UpdatePosition</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r55 rd" class="r55 r">ast</span>)
        {
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r56 rd" class="r56 r">extent</span> = <span class="r55 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
            <b>int</b> <span id="r57 rd" class="r57 r">index</span> = <a href="#319aa081bb450665" class="i method">AddSequencePoint</a>(<span class="r56 r">extent</span>);
 
            <span class="c">// If we just added the first sequence point, then we don&#39;t want to check for breakpoints - we&#39;ll do that</span>
            <span class="c">// in EnterScriptFunction.</span>
            <span class="c">// Except for while/do loops, in this case we want to check breakpoints on the first sequence point since it</span>
            <span class="c">// will be executed multiple times.</span>
            <b>return</b> (<span class="r57 r">index</span> == 0 &amp;&amp; !<a href="#71764a6db953172b" class="i field">_generatingWhileOrDoLoop</a>)
                       ? <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>
                       : <b>new</b> <span class="t">UpdatePositionExpr</span>(<span class="r56 r">extent</span>, <span class="r57 r">index</span>, <a href="#2807a84cb0b61e38" class="i field">_debugSymbolDocument</a>, !<a href="#3133d55c945a52aa" class="i field">_compilingSingleExpression</a>);
        }
 
        <b>private int</b> <a id="db41cd103544d027" href="../../R/db41cd103544d027.html" target="n" data-glyph="46,1" class="i field">_tempCounter</a>;
 
        <b>internal</b> <span class="i">ParameterExpression</span> <a id="c4c74ae83f907a1d" href="../../R/c4c74ae83f907a1d.html" target="n" data-glyph="74,1" class="i method">NewTemp</a>(<span class="i">Type</span> <span id="r58 rd" class="r58 r">type</span>, <b>string</b> <span id="r59 rd" class="r59 r">name</span>)
        {
            <b>return</b> <span class="i">Expression</span>.<span class="i">Variable</span>(<span class="r58 r">type</span>, <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;{0}{1}&quot;</span>, <span class="r59 r">name</span>, <a href="#db41cd103544d027" class="i field">_tempCounter</a>++));
        }
 
        <b>internal static</b> <span class="i">Type</span> <a id="05c0f8960f453cab" href="../../R/05c0f8960f453cab.html" target="n" data-glyph="74,1" class="i method">GetTypeConstraintForMethodResolution</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r60 rd" class="r60 r">expr</span>)
        {
            <b>while</b> (<span class="r60 r">expr</span> <b>is</b> <a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a>)
            {
                <span class="r60 r">expr</span> = ((<a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a>)<span class="r60 r">expr</span>).<a href="ast.cs.html#021e323175cb804d" class="i property">Pipeline</a>.<a href="ast.cs.html#158661f5f6c8db6d" class="i method">GetPureExpression</a>();
            }
 
            <a href="ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a> <span id="r61 rd" class="r61 r">firstConvert</span> = <b>null</b>;
            <b>while</b> (<span class="r60 r">expr</span> <b>is</b> <a href="ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>)
            {
                <b>if</b> (<span class="r60 r">expr</span> <b>is</b> <a href="ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a> &amp;&amp; !((<a href="ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a>)<span class="r60 r">expr</span>).<a href="ast.cs.html#74a22010f70cd6e1" class="i method">IsRef</a>())
                {
                    <span class="r61 r">firstConvert</span> = (<a href="ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a>)<span class="r60 r">expr</span>;
                    <b>break</b>;
                }
 
                <span class="r60 r">expr</span> = ((<a href="ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a>)<span class="r60 r">expr</span>).<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a>;
            }
 
            <b>return</b> <span class="r61 r">firstConvert</span>?.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
        }
 
        <b>internal static</b> <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <a id="bd18d1c8d492dde3" href="../../R/bd18d1c8d492dde3.html" target="n" data-glyph="74,1" class="i method">CombineTypeConstraintForMethodResolution</a>(<span class="i">Type</span> <span id="r62 rd" class="r62 r">targetType</span>, <span class="i">Type</span> <span id="r63 rd" class="r63 r">argType</span>)
        {
            <b>if</b> (<span class="r62 r">targetType</span> == <b>null</b> &amp;&amp; <span class="r63 r">argType</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <b>new</b> <a href="../MshMemberInfo.cs.html#e0097e977bce3ab9" class="t constructor">PSMethodInvocationConstraints</a>(<span class="r62 r">targetType</span>, <b>new</b>[] { <span class="r63 r">argType</span> });
        }
 
        <b>internal static</b> <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <a id="c6088d2e71d4479c" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CombineTypeConstraintForMethodResolution</a>(<span class="i">Type</span> <span id="r64 rd" class="r64 r">targetType</span>, <span class="i">Type</span>[] <span id="r65 rd" class="r65 r">argTypes</span>)
        {
            <b>if</b> (<span class="r64 r">targetType</span> == <b>null</b> &amp;&amp; (<span class="r65 r">argTypes</span> == <b>null</b> || <span class="r65 r">argTypes</span>.<span class="i">Length</span> == 0))
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <b>new</b> <a href="../MshMemberInfo.cs.html#e0097e977bce3ab9" class="t constructor">PSMethodInvocationConstraints</a>(<span class="r64 r">targetType</span>, <span class="r65 r">argTypes</span>);
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="e7f2cb89dd2953e5" href="../../R/e7f2cb89dd2953e5.html" target="n" data-glyph="74,1" class="i method">ConvertValue</a>(<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r66 rd" class="r66 r">typeConstraint</span>, <span class="i">Expression</span> <span id="r67 rd" class="r67 r">expr</span>)
        {
            <a href="ast.cs.html#a422e1772da6dbc8" class="k">var</a> <span id="r68 rd" class="r68 r">typeName</span> = <span class="r66 r">typeConstraint</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>;
            <b>var</b> <span id="r69 rd" class="r69 r">toType</span> = <span class="r68 r">typeName</span>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
            <b>if</b> (<span class="r69 r">toType</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r69 r">toType</span> == <b>typeof</b>(<b>void</b>))
                {
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<b>typeof</b>(<b>void</b>), <span class="r67 r">expr</span>);
                }
 
                <b>return</b> <span class="r67 r">expr</span>.<span class="i">Convert</span>(<span class="r69 r">toType</span>);
            }
 
            <span class="c">// typeName can&#39;t be resolved at compile time, so defer resolution until runtime.</span>
            <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                <a href="../runtime/Binding/Binders.cs.html#248d1515946e67ce" class="t t">PSDynamicConvertBinder</a>.<a href="../runtime/Binding/Binders.cs.html#911ee0315415b304" class="i method">Get</a>(),
                <b>typeof</b>(<b>object</b>),
                <span class="i">Expression</span>.<span class="i">Call</span>(
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#c5cefd491e42dea3" class="i field">TypeOps_ResolveTypeName</a>,
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r68 r">typeName</span>),
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r68 r">typeName</span>.<a href="ast.cs.html#2b8e897172d31016" class="i property">Extent</a>)),
                <span class="r67 r">expr</span>);
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="adb8a45abd1e4e34" href="../../R/adb8a45abd1e4e34.html" target="n" data-glyph="74,1" class="i method">ConvertValue</a>(<span class="i">Expression</span> <span id="r70 rd" class="r70 r">expr</span>, <span class="i">List</span>&lt;<a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt; <span id="r71 rd" class="r71 r">conversions</span>)
        {
            <b>for</b> (<b>int</b> <span id="r72 rd" class="r72 r">index</span> = 0; <span class="r72 r">index</span> &lt; <span class="r71 r">conversions</span>.<span class="i">Count</span>; <span class="r72 r">index</span>++)
            {
                <a href="ast.cs.html#34b9d5dbbaca964d" class="k">var</a> <span id="r73 rd" class="r73 r">typeConstraint</span> = <span class="r71 r">conversions</span>[<span class="r72 r">index</span>] <b>as</b> <a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>;
                <b>if</b> (<span class="r73 r">typeConstraint</span> != <b>null</b>)
                {
                    <span class="r70 r">expr</span> = <a href="#e7f2cb89dd2953e5" class="i method">ConvertValue</a>(<span class="r73 r">typeConstraint</span>, <span class="r70 r">expr</span>);
                }
            }
 
            <b>return</b> <span class="r70 r">expr</span>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Helpers for AST Compile methods
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Parameter Metadata
 
        <b>internal static</b> <a href="../PseudoParameters.cs.html#d55a14219c7e096c" class="t t">RuntimeDefinedParameterDictionary</a> <a id="8ad349e7ea45c522" href="../../R/8ad349e7ea45c522.html" target="n" data-glyph="74,1" class="i method">GetParameterMetaData</a>(<span class="i">ReadOnlyCollection</span>&lt;<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <span id="r74 rd" class="r74 r">parameters</span>, <b>bool</b> <span id="r75 rd" class="r75 r">automaticPositions</span>, <b>ref bool</b> <span id="r76 rd" class="r76 r">usesCmdletBinding</span>)
        {
            <a href="../PseudoParameters.cs.html#d55a14219c7e096c" class="k">var</a> <span id="r77 rd" class="r77 r">runtimeDefinedParamDict</span> = <b>new</b> <a href="../PseudoParameters.cs.html#fe6fd05e3511357a" class="t constructor">RuntimeDefinedParameterDictionary</a>();
            <b>var</b> <span id="r78 rd" class="r78 r">runtimeDefinedParamList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="../PseudoParameters.cs.html#68fb670c5eb25328" class="t t">RuntimeDefinedParameter</a>&gt;(<span class="r74 r">parameters</span>.<span class="i">Count</span>);
            <b>var</b> <span id="r79 rd" class="r79 r">customParameterSet</span> = <b>false</b>;
            <b>for</b> (<b>int</b> <span id="r80 rd" class="r80 r">index</span> = 0; <span class="r80 r">index</span> &lt; <span class="r74 r">parameters</span>.<span class="i">Count</span>; <span class="r80 r">index</span>++)
            {
                <b>var</b> <span id="r81 rd" class="r81 r">param</span> = <span class="r74 r">parameters</span>[<span class="r80 r">index</span>];
                <a href="../PseudoParameters.cs.html#68fb670c5eb25328" class="k">var</a> <span id="r82 rd" class="r82 r">rdp</span> = <span class="i">GetRuntimeDefinedParameter</span>(<span class="r81 r">param</span>, <b>ref</b> <span class="r79 r">customParameterSet</span>, <b>ref</b> <span class="r76 r">usesCmdletBinding</span>);
                <b>if</b> (<span class="r82 r">rdp</span> != <b>null</b>)
                {
                    <span class="r78 r">runtimeDefinedParamList</span>.<span class="i">Add</span>(<span class="r82 r">rdp</span>);
                    <span class="r77 r">runtimeDefinedParamDict</span>.<span class="i">Add</span>(<span class="r81 r">param</span>.<span class="i">Name</span>.<span class="i">VariablePath</span>.<span class="i">UserPath</span>, <span class="r82 r">rdp</span>);
                }
            }
 
            <b>int</b> <span id="r83 rd" class="r83 r">pos</span> = 0;
            <b>if</b> (<span class="r75 r">automaticPositions</span> &amp;&amp; !<span class="r79 r">customParameterSet</span>)
            {
                <b>for</b> (<b>int</b> <span id="r84 rd" class="r84 r">index</span> = 0; <span class="r84 r">index</span> &lt; <span class="r78 r">runtimeDefinedParamList</span>.<span class="i">Count</span>; <span class="r84 r">index</span>++)
                {
                    <b>var</b> <span id="r85 rd" class="r85 r">rdp</span> = <span class="r78 r">runtimeDefinedParamList</span>[<span class="r84 r">index</span>];
                    <a href="../Attributes.cs.html#3d5ed915c8442ad6" class="k">var</a> <span id="r86 rd" class="r86 r">paramAttribute</span> = (<a href="../Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>)<span class="r85 r">rdp</span>.<span class="i">Attributes</span>.<span class="i">First</span>(<b>static</b> <span id="r87 rd" class="r87 r">attr</span> =&gt; <span class="r87 r">attr</span> <b>is</b> <a href="../Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>);
                    <b>if</b> (<span class="r85 r">rdp</span>.<span class="i">ParameterType</span> != <b>typeof</b>(<a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>))
                    {
                        <span class="r86 r">paramAttribute</span>.<a href="../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = <span class="r83 r">pos</span>++;
                    }
                }
            }
 
            <span class="r77 r">runtimeDefinedParamDict</span>.<a href="../PseudoParameters.cs.html#188173533cedce98" class="i property">Data</a> = <span class="r78 r">runtimeDefinedParamList</span>.<span class="i">ToArray</span>();
            <b>return</b> <span class="r77 r">runtimeDefinedParamDict</span>;
        }
 
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">CallInfo</span>, <span class="i">Delegate</span>&gt; <a id="7dde791ef5e4f903" href="../../R/7dde791ef5e4f903.html" target="n" data-glyph="46,1" class="i field">s_attributeGeneratorCache</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">CallInfo</span>, <span class="i">Delegate</span>&gt;();
        <b>private static readonly</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <span class="i">Func</span>&lt;<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>, <span class="i">Attribute</span>&gt;&gt; <a id="c66254218b170d12" href="../../R/c66254218b170d12.html" target="n" data-glyph="46,1" class="i field">s_builtinAttributeGenerator</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<span class="i">Type</span>, <span class="i">Func</span>&lt;<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>, <span class="i">Attribute</span>&gt;&gt;(10);
 
        <b>private static</b> <span class="i">Delegate</span> <a id="2bc04c5908d99083" href="../../R/2bc04c5908d99083.html" target="n" data-glyph="76,1" class="i method">GetAttributeGenerator</a>(<span class="i">CallInfo</span> <span id="r88 rd" class="r88 r">callInfo</span>)
        {
            <span class="i">Delegate</span> <span id="r89 rd" class="r89 r">result</span>;
            <b>lock</b> (<a href="#7dde791ef5e4f903" class="i field">s_attributeGeneratorCache</a>)
            {
                <b>if</b> (!<a href="#7dde791ef5e4f903" class="i field">s_attributeGeneratorCache</a>.<span class="i">TryGetValue</span>(<span class="r88 r">callInfo</span>, <b>out</b> <span class="r89 r">result</span>))
                {
                    <a href="../runtime/Binding/Binders.cs.html#ba17a6f992bccb93" class="k">var</a> <span id="r90 rd" class="r90 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#ba17a6f992bccb93" class="t t">PSAttributeGenerator</a>.<a href="../runtime/Binding/Binders.cs.html#5ae79abef6263745" class="i method">Get</a>(<span class="r88 r">callInfo</span>);
 
                    <b>var</b> <span id="r91 rd" class="r91 r">parameters</span> = <b>new</b> <span class="i">ParameterExpression</span>[<span class="r88 r">callInfo</span>.<span class="i">ArgumentCount</span> + 1];
                    <b>for</b> (<b>int</b> <span id="r92 rd" class="r92 r">i</span> = 0; <span class="r92 r">i</span> &lt; <span class="r91 r">parameters</span>.<span class="i">Length</span>; ++<span class="r92 r">i</span>)
                    {
                        <span class="r91 r">parameters</span>[<span class="r92 r">i</span>] = <span class="i">Expression</span>.<span class="i">Variable</span>(<b>typeof</b>(<b>object</b>));
                    }
 
                    <span class="r89 r">result</span> = <span class="i">Expression</span>.<span class="i">Lambda</span>(<span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r90 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r91 r">parameters</span>), <span class="r91 r">parameters</span>).<span class="i">Compile</span>();
                    <a href="#7dde791ef5e4f903" class="i field">s_attributeGeneratorCache</a>.<span class="i">Add</span>(<span class="r88 r">callInfo</span>, <span class="r89 r">result</span>);
                }
            }
 
            <b>return</b> <span class="r89 r">result</span>;
        }
 
        <b>private static readonly</b> <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <b>int</b>&gt;&gt; <a id="b9e7e7c34af69ec2" href="../../R/b9e7e7c34af69ec2.html" target="n" data-glyph="46,1" class="i field">s_attrArgToIntConverter</a> =
            <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <b>int</b>&gt;&gt;.<span class="i">Create</span>(<a href="../runtime/Binding/Binders.cs.html#97a1cf18399e4247" class="t t">PSConvertBinder</a>.<span class="i">Get</span>(<b>typeof</b>(<b>int</b>)));
 
        <b>internal static readonly</b> <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <b>string</b>&gt;&gt; <a id="55e13c53e393f877" href="../../R/55e13c53e393f877.html" target="n" data-glyph="44,1" class="i field">s_attrArgToStringConverter</a> =
            <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <b>string</b>&gt;&gt;.<span class="i">Create</span>(<a href="../runtime/Binding/Binders.cs.html#97a1cf18399e4247" class="t t">PSConvertBinder</a>.<span class="i">Get</span>(<b>typeof</b>(<b>string</b>)));
 
        <b>private static readonly</b> <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <b>string</b>[]&gt;&gt; <a id="e17522c792336625" href="../../R/e17522c792336625.html" target="n" data-glyph="46,1" class="i field">s_attrArgToStringArrayConverter</a> =
            <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <b>string</b>[]&gt;&gt;.<span class="i">Create</span>(<a href="../runtime/Binding/Binders.cs.html#97a1cf18399e4247" class="t t">PSConvertBinder</a>.<span class="i">Get</span>(<b>typeof</b>(<b>string</b>[])));
 
        <b>private static readonly</b> <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <b>bool</b>&gt;&gt; <a id="ab8a0437b8b895d3" href="../../R/ab8a0437b8b895d3.html" target="n" data-glyph="46,1" class="i field">s_attrArgToBoolConverter</a> =
            <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <b>bool</b>&gt;&gt;.<span class="i">Create</span>(<a href="../runtime/Binding/Binders.cs.html#97a1cf18399e4247" class="t t">PSConvertBinder</a>.<span class="i">Get</span>(<b>typeof</b>(<b>bool</b>)));
 
        <b>private static readonly</b> <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <a href="../CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>&gt;&gt; <a id="93e57bb5addfe855" href="../../R/93e57bb5addfe855.html" target="n" data-glyph="46,1" class="i field">s_attrArgToConfirmImpactConverter</a> =
            <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <a href="../CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>&gt;&gt;.<span class="i">Create</span>(<a href="../runtime/Binding/Binders.cs.html#97a1cf18399e4247" class="t t">PSConvertBinder</a>.<span class="i">Get</span>(<b>typeof</b>(<a href="../CommandBase.cs.html#ba94675b57c6d6e9" class="t t">ConfirmImpact</a>)));
 
        <b>private static readonly</b> <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <a href="../remoting/common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a>&gt;&gt; <a id="822158063cac182d" href="../../R/822158063cac182d.html" target="n" data-glyph="46,1" class="i field">s_attrArgToRemotingCapabilityConverter</a> =
            <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <a href="../remoting/common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a>&gt;&gt;.<span class="i">Create</span>(<a href="../runtime/Binding/Binders.cs.html#97a1cf18399e4247" class="t t">PSConvertBinder</a>.<span class="i">Get</span>(<b>typeof</b>(<a href="../remoting/common/misc.cs.html#59e8ed9184274cab" class="t t">RemotingCapability</a>)));
 
        <b>private static readonly</b> <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <a href="../ExperimentalFeature/ExperimentalFeature.cs.html#7c48b7b0fa5fcf50" class="t t">ExperimentAction</a>&gt;&gt; <a id="7096abe043d2e577" href="../../R/7096abe043d2e577.html" target="n" data-glyph="46,1" class="i field">s_attrArgToExperimentActionConverter</a> =
            <span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <a href="../ExperimentalFeature/ExperimentalFeature.cs.html#7c48b7b0fa5fcf50" class="t t">ExperimentAction</a>&gt;&gt;.<span class="i">Create</span>(<a href="../runtime/Binding/Binders.cs.html#97a1cf18399e4247" class="t t">PSConvertBinder</a>.<span class="i">Get</span>(<b>typeof</b>(<a href="../ExperimentalFeature/ExperimentalFeature.cs.html#7c48b7b0fa5fcf50" class="t t">ExperimentAction</a>)));
 
        <b>private static readonly</b> <a href="ConstantValues.cs.html#2a167202840f224e" class="t t">ConstantValueVisitor</a> <a id="7aab2dbbe9a1b5be" href="../../R/7aab2dbbe9a1b5be.html" target="n" data-glyph="46,1" class="i field">s_cvv</a> = <b>new</b> <span class="t">ConstantValueVisitor</span> { <a href="ConstantValues.cs.html#1ccd283df010f4e4" class="i property">AttributeArgument</a> = <b>true</b> };
 
        <b>private static void</b> <a id="cfa86123a0d7bb09" href="../../R/cfa86123a0d7bb09.html" target="n" data-glyph="76,1" class="i method">CheckNoPositionalArgs</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r93 rd" class="r93 r">ast</span>)
        {
            <b>var</b> <span id="r94 rd" class="r94 r">positionalArgCount</span> = <span class="r93 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span>;
            <b>if</b> (<span class="r94 r">positionalArgCount</span> &gt; 0)
            {
                <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(
                    <b>null</b>,
                    <b>typeof</b>(<a href="../ExtendedTypeSystemException.cs.html#4961d7a0f93a8280" class="t t">MethodException</a>),
                    <span class="r93 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <span class="s">&quot;MethodCountCouldNotFindBest&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodArgumentCountException</span>,
                    <span class="s">&quot;.ctor&quot;</span>,
                    <span class="r94 r">positionalArgCount</span>);
            }
        }
 
        <b>private static void</b> <a id="4275a98bcdef3a96" href="../../R/4275a98bcdef3a96.html" target="n" data-glyph="76,1" class="i method">CheckNoNamedArgs</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r95 rd" class="r95 r">ast</span>)
        {
            <b>if</b> (<span class="r95 r">ast</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a>.<span class="i">Count</span> &gt; 0)
            {
                <b>var</b> <span id="r96 rd" class="r96 r">namedArg</span> = <span class="r95 r">ast</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a>[0];
                <b>var</b> <span id="r97 rd" class="r97 r">argumentName</span> = <span class="r96 r">namedArg</span>.<span class="i">ArgumentName</span>;
                <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(
                    <span class="r96 r">namedArg</span>,
                    <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                    <span class="r96 r">namedArg</span>.<span class="i">Extent</span>,
                    <span class="s">&quot;PropertyNotFoundForType&quot;</span>,
                    <span class="i">ParserStrings</span>.<span class="i">PropertyNotFoundForType</span>,
                    <span class="r97 r">argumentName</span>,
                    <b>typeof</b>(<a href="../Attributes.cs.html#67a775c242618ea6" class="t t">CmdletBindingAttribute</a>));
            }
        }
 
        <b>private static</b> (<b>string</b>, <a href="../ExperimentalFeature/ExperimentalFeature.cs.html#7c48b7b0fa5fcf50" class="t t">ExperimentAction</a>) <a id="118f434e8bf5748d" href="../../R/118f434e8bf5748d.html" target="n" data-glyph="76,1" class="i method">GetFeatureNameAndAction</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r98 rd" class="r98 r">ast</span>)
        {
            <b>var</b> <span id="r99 rd" class="r99 r">argValue0</span> = <span class="r98 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>[0].<span class="i">Accept</span>(<a href="#7aab2dbbe9a1b5be" class="i field">s_cvv</a>);
            <b>var</b> <span id="r100 rd" class="r100 r">argValue1</span> = <span class="r98 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>[1].<span class="i">Accept</span>(<a href="#7aab2dbbe9a1b5be" class="i field">s_cvv</a>);
 
            <b>var</b> <span id="r101 rd" class="r101 r">featureName</span> = <a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>.<span class="i">Target</span>(<a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>, <span class="r99 r">argValue0</span>);
            <b>var</b> <span id="r102 rd" class="r102 r">action</span> = <a href="#7096abe043d2e577" class="i field">s_attrArgToExperimentActionConverter</a>.<span class="i">Target</span>(<a href="#7096abe043d2e577" class="i field">s_attrArgToExperimentActionConverter</a>, <span class="r100 r">argValue1</span>);
            <b>return</b> (<span class="r101 r">featureName</span>, <span class="r102 r">action</span>);
        }
 
        <b>private static</b> <span class="i">Attribute</span> <a id="e3c7b194c35047c8" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NewCmdletBindingAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r103 rd" class="r103 r">ast</span>)
        {
            <a href="#cfa86123a0d7bb09" class="i method">CheckNoPositionalArgs</a>(<span class="r103 r">ast</span>);
 
            <a href="../Attributes.cs.html#67a775c242618ea6" class="k">var</a> <span id="r104 rd" class="r104 r">result</span> = <b>new</b> <span class="t">CmdletBindingAttribute</span>();
 
            <b>foreach</b> (<b>var</b> <span id="r105 rd" class="r105 r">namedArg</span> <b>in</b> <span class="r103 r">ast</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a>)
            {
                <b>var</b> <span id="r106 rd" class="r106 r">argValue</span> = <span class="r105 r">namedArg</span>.<span class="i">Argument</span>.<span class="i">Accept</span>(<a href="#7aab2dbbe9a1b5be" class="i field">s_cvv</a>);
                <b>var</b> <span id="r107 rd" class="r107 r">argumentName</span> = <span class="r105 r">namedArg</span>.<span class="i">ArgumentName</span>;
                <b>if</b> (<span class="r107 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;DefaultParameterSetName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r104 r">result</span>.<a href="../Attributes.cs.html#7bcab566998127aa" class="i property">DefaultParameterSetName</a> = <a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>.<span class="i">Target</span>(<a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>, <span class="r106 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r107 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;HelpUri&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r104 r">result</span>.<a href="../Attributes.cs.html#b86e0f84f57581eb" class="i property">HelpUri</a> = <a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>.<span class="i">Target</span>(<a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>, <span class="r106 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r107 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;SupportsShouldProcess&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r104 r">result</span>.<a href="../Attributes.cs.html#a74bb3710497b882" class="i property">SupportsShouldProcess</a> = <a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>.<span class="i">Target</span>(<a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>, <span class="r106 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r107 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;PositionalBinding&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r104 r">result</span>.<a href="../Attributes.cs.html#923927e48096d1bb" class="i property">PositionalBinding</a> = <a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>.<span class="i">Target</span>(<a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>, <span class="r106 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r107 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;ConfirmImpact&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r104 r">result</span>.<a href="../Attributes.cs.html#050b5caee084ffcc" class="i property">ConfirmImpact</a> = <a href="#93e57bb5addfe855" class="i field">s_attrArgToConfirmImpactConverter</a>.<span class="i">Target</span>(<a href="#93e57bb5addfe855" class="i field">s_attrArgToConfirmImpactConverter</a>, <span class="r106 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r107 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;SupportsTransactions&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r104 r">result</span>.<a href="../Attributes.cs.html#171f9a9c636aad16" class="i property">SupportsTransactions</a> = <a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>.<span class="i">Target</span>(<a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>, <span class="r106 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r107 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;SupportsPaging&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r104 r">result</span>.<a href="../Attributes.cs.html#1dd714e8974c7fe0" class="i property">SupportsPaging</a> = <a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>.<span class="i">Target</span>(<a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>, <span class="r106 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r107 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;RemotingCapability&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r104 r">result</span>.<a href="../Attributes.cs.html#94d7a58858c6cd15" class="i property">RemotingCapability</a> = <a href="#822158063cac182d" class="i field">s_attrArgToRemotingCapabilityConverter</a>.<span class="i">Target</span>(<a href="#822158063cac182d" class="i field">s_attrArgToRemotingCapabilityConverter</a>, <span class="r106 r">argValue</span>);
                }
                <b>else</b>
                {
                    <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(
                        <span class="r105 r">namedArg</span>,
                        <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                        <span class="r105 r">namedArg</span>.<span class="i">Extent</span>,
                        <span class="s">&quot;PropertyNotFoundForType&quot;</span>,
                        <span class="i">ParserStrings</span>.<span class="i">PropertyNotFoundForType</span>,
                        <span class="r107 r">argumentName</span>,
                        <b>typeof</b>(<a href="../Attributes.cs.html#67a775c242618ea6" class="t t">CmdletBindingAttribute</a>));
                }
            }
 
            <b>return</b> <span class="r104 r">result</span>;
        }
 
        <b>private static</b> <span class="i">Attribute</span> <a id="d5c15261ddcb29fc" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NewExperimentalAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r108 rd" class="r108 r">ast</span>)
        {
            <b>int</b> <span id="r109 rd" class="r109 r">positionalArgCount</span> = <span class="r108 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span>;
            <b>if</b> (<span class="r109 r">positionalArgCount</span> != 2)
            {
                <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(
                    <span class="i">targetObject</span>: <b>null</b>,
                    <b>typeof</b>(<a href="../ExtendedTypeSystemException.cs.html#4961d7a0f93a8280" class="t t">MethodException</a>),
                    <span class="r108 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <span class="s">&quot;MethodCountCouldNotFindBest&quot;</span>,
                    <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodArgumentCountException</span>,
                    <span class="s">&quot;.ctor&quot;</span>,
                    <span class="r109 r">positionalArgCount</span>);
            }
 
            (<b>string</b> <span id="r110 rd" class="r110 r">name</span>, <a href="../ExperimentalFeature/ExperimentalFeature.cs.html#7c48b7b0fa5fcf50" class="t t">ExperimentAction</a> <span id="r111 rd" class="r111 r">action</span>) = <a href="#118f434e8bf5748d" class="i method">GetFeatureNameAndAction</a>(<span class="r108 r">ast</span>);
            <b>return</b> <b>new</b> <a href="../ExperimentalFeature/ExperimentalFeature.cs.html#3e93452abcbb4300" class="t constructor">ExperimentalAttribute</a>(<span class="r110 r">name</span>, <span class="r111 r">action</span>);
        }
 
        <b>private static</b> <span class="i">Attribute</span> <a id="73ee449a494fa5eb" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NewParameterAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r112 rd" class="r112 r">ast</span>)
        {
            <a href="../Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a> <span id="r113 rd" class="r113 r">result</span>;
            <b>int</b> <span id="r114 rd" class="r114 r">positionalArgCount</span> = <span class="r112 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span>;
            <b>switch</b> (<span class="r114 r">positionalArgCount</span>)
            {
                <b>case</b> 0:
                    <span class="r113 r">result</span> = <b>new</b> <a href="../Attributes.cs.html#5a7647804c8ceec5" class="t constructor">ParameterAttribute</a>();
                    <b>break</b>;
                <b>case</b> 2:
                    (<b>string</b> <span id="r115 rd" class="r115 r">name</span>, <a href="../ExperimentalFeature/ExperimentalFeature.cs.html#7c48b7b0fa5fcf50" class="t t">ExperimentAction</a> <span id="r116 rd" class="r116 r">action</span>) = <a href="#118f434e8bf5748d" class="i method">GetFeatureNameAndAction</a>(<span class="r112 r">ast</span>);
                    <span class="r113 r">result</span> = <b>new</b> <a href="../Attributes.cs.html#c12ff081c9b8136a" class="t constructor">ParameterAttribute</a>(<span class="r115 r">name</span>, <span class="r116 r">action</span>);
                    <b>break</b>;
                <b>default</b>:
                    <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(
                        <span class="i">targetObject</span>: <b>null</b>,
                        <b>typeof</b>(<a href="../ExtendedTypeSystemException.cs.html#4961d7a0f93a8280" class="t t">MethodException</a>),
                        <span class="r112 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <span class="s">&quot;MethodCountCouldNotFindBest&quot;</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">MethodArgumentCountException</span>,
                        <span class="s">&quot;.ctor&quot;</span>,
                        <span class="r114 r">positionalArgCount</span>);
            }
 
            <b>foreach</b> (<b>var</b> <span id="r117 rd" class="r117 r">namedArg</span> <b>in</b> <span class="r112 r">ast</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a>)
            {
                <b>var</b> <span id="r118 rd" class="r118 r">argValue</span> = <span class="r117 r">namedArg</span>.<span class="i">Argument</span>.<span class="i">Accept</span>(<a href="#7aab2dbbe9a1b5be" class="i field">s_cvv</a>);
                <b>var</b> <span id="r119 rd" class="r119 r">argumentName</span> = <span class="r117 r">namedArg</span>.<span class="i">ArgumentName</span>;
 
                <b>if</b> (<span class="r119 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;Position&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r113 r">result</span>.<a href="../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> = <a href="#b9e7e7c34af69ec2" class="i field">s_attrArgToIntConverter</a>.<span class="i">Target</span>(<a href="#b9e7e7c34af69ec2" class="i field">s_attrArgToIntConverter</a>, <span class="r118 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r119 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;ParameterSetName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r113 r">result</span>.<a href="../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a> = <a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>.<span class="i">Target</span>(<a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>, <span class="r118 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r119 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;Mandatory&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r113 r">result</span>.<a href="../Attributes.cs.html#d5ad471518092731" class="i property">Mandatory</a> = <a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>.<span class="i">Target</span>(<a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>, <span class="r118 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r119 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;ValueFromPipeline&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r113 r">result</span>.<a href="../Attributes.cs.html#4afbf5921ff6e967" class="i property">ValueFromPipeline</a> = <a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>.<span class="i">Target</span>(<a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>, <span class="r118 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r119 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;ValueFromPipelineByPropertyName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r113 r">result</span>.<a href="../Attributes.cs.html#aded474eaec9cde8" class="i property">ValueFromPipelineByPropertyName</a> = <a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>.<span class="i">Target</span>(<a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>, <span class="r118 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r119 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;ValueFromRemainingArguments&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r113 r">result</span>.<a href="../Attributes.cs.html#b706e4aa5f357f6a" class="i property">ValueFromRemainingArguments</a> = <a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>.<span class="i">Target</span>(<a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>, <span class="r118 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r119 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;HelpMessage&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r113 r">result</span>.<a href="../Attributes.cs.html#1ea1a618dbf069dc" class="i property">HelpMessage</a> = <a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>.<span class="i">Target</span>(<a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>, <span class="r118 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r119 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;HelpMessageBaseName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r113 r">result</span>.<a href="../Attributes.cs.html#2f9601faf9b1be05" class="i property">HelpMessageBaseName</a> = <a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>.<span class="i">Target</span>(<a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>, <span class="r118 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r119 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;HelpMessageResourceId&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r113 r">result</span>.<a href="../Attributes.cs.html#92a3ab71e21da3c3" class="i property">HelpMessageResourceId</a> = <a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>.<span class="i">Target</span>(<a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>, <span class="r118 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r119 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;DontShow&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r113 r">result</span>.<a href="../Attributes.cs.html#aece56bfac51ced8" class="i property">DontShow</a> = <a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>.<span class="i">Target</span>(<a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>, <span class="r118 r">argValue</span>);
                }
                <b>else</b>
                {
                    <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(
                        <span class="r117 r">namedArg</span>,
                        <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                        <span class="r117 r">namedArg</span>.<span class="i">Extent</span>,
                        <span class="s">&quot;PropertyNotFoundForType&quot;</span>,
                        <span class="i">ParserStrings</span>.<span class="i">PropertyNotFoundForType</span>,
                        <span class="r119 r">argumentName</span>,
                        <b>typeof</b>(<a href="../Attributes.cs.html#67a775c242618ea6" class="t t">CmdletBindingAttribute</a>));
                }
            }
 
            <b>return</b> <span class="r113 r">result</span>;
        }
 
        <b>private static</b> <span class="i">Attribute</span> <a id="9527c6c9d426ead5" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NewOutputTypeAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r120 rd" class="r120 r">ast</span>)
        {
            <a href="../Attributes.cs.html#c50a02cd2178a292" class="t t">OutputTypeAttribute</a> <span id="r121 rd" class="r121 r">result</span>;
            <b>if</b> (<span class="r120 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span> == 0)
            {
                <span class="r121 r">result</span> = <b>new</b> <span class="t">OutputTypeAttribute</span>(<span class="i">Array</span>.<span class="i">Empty</span>&lt;<b>string</b>&gt;());
            }
            <b>else</b> <b>if</b> (<span class="r120 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span> == 1)
            {
                <a href="ast.cs.html#bf258955590d49b7" class="k">var</a> <span id="r122 rd" class="r122 r">typeArg</span> = <span class="r120 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>[0] <b>as</b> <a href="ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a>;
                <b>if</b> (<span class="r122 r">typeArg</span> != <b>null</b>)
                {
                    <b>var</b> <span id="r123 rd" class="r123 r">type</span> = <a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<a href="../runtime/Operations/MiscOps.cs.html#d4354a46a82a388e" class="i method">ResolveTypeName</a>(<span class="r122 r">typeArg</span>.<a href="ast.cs.html#c43447ab6269441a" class="i property">TypeName</a>, <span class="r122 r">typeArg</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>);
                    <span class="r121 r">result</span> = <b>new</b> <a href="../Attributes.cs.html#f58f5d649ed00faf" class="t constructor">OutputTypeAttribute</a>(<span class="r123 r">type</span>);
                }
                <b>else</b>
                {
                    <b>var</b> <span id="r124 rd" class="r124 r">argValue</span> = <span class="r120 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>[0].<span class="i">Accept</span>(<a href="#7aab2dbbe9a1b5be" class="i field">s_cvv</a>);
                    <span class="r121 r">result</span> = <b>new</b> <span class="t">OutputTypeAttribute</span>(<a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>.<span class="i">Target</span>(<a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>, <span class="r124 r">argValue</span>));
                }
            }
            <b>else</b>
            {
                <b>var</b> <span id="r125 rd" class="r125 r">args</span> = <b>new</b> <b>object</b>[<span class="r120 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span>];
                <b>for</b> (<b>int</b> <span id="r126 rd" class="r126 r">i</span> = 0; <span class="r126 r">i</span> &lt; <span class="r120 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span>; <span class="r126 r">i</span>++)
                {
                    <b>var</b> <span id="r127 rd" class="r127 r">positionalArgument</span> = <span class="r120 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>[<span class="r126 r">i</span>];
                    <a href="ast.cs.html#bf258955590d49b7" class="k">var</a> <span id="r128 rd" class="r128 r">typeArg</span> = <span class="r127 r">positionalArgument</span> <b>as</b> <a href="ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a>;
                    <span class="r125 r">args</span>[<span class="r126 r">i</span>] = <span class="r128 r">typeArg</span> != <b>null</b>
                        ? <a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<a href="../runtime/Operations/MiscOps.cs.html#d4354a46a82a388e" class="i method">ResolveTypeName</a>(<span class="r128 r">typeArg</span>.<a href="ast.cs.html#c43447ab6269441a" class="i property">TypeName</a>, <span class="r128 r">typeArg</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>)
                        : <span class="r127 r">positionalArgument</span>.<span class="i">Accept</span>(<a href="#7aab2dbbe9a1b5be" class="i field">s_cvv</a>);
                }
 
                <b>if</b> (<span class="r125 r">args</span>[0] <b>is</b> <span class="i">Type</span>)
                {
                    <span class="r121 r">result</span> = <b>new</b> <a href="../Attributes.cs.html#92019260be6d667e" class="t constructor">OutputTypeAttribute</a>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<span class="i">Type</span>[]&gt;(<span class="r125 r">args</span>));
                }
                <b>else</b>
                {
                    <span class="r121 r">result</span> = <b>new</b> <a href="../Attributes.cs.html#e14c48ead546f0b1" class="t constructor">OutputTypeAttribute</a>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#8b9327b10b12742d" class="i method">ConvertTo</a>&lt;<b>string</b>[]&gt;(<span class="r125 r">args</span>));
                }
            }
 
            <b>foreach</b> (<b>var</b> <span id="r129 rd" class="r129 r">namedArg</span> <b>in</b> <span class="r120 r">ast</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a>)
            {
                <b>var</b> <span id="r130 rd" class="r130 r">argValue</span> = <span class="r129 r">namedArg</span>.<span class="i">Argument</span>.<span class="i">Accept</span>(<a href="#7aab2dbbe9a1b5be" class="i field">s_cvv</a>);
                <b>var</b> <span id="r131 rd" class="r131 r">argumentName</span> = <span class="r129 r">namedArg</span>.<span class="i">ArgumentName</span>;
 
                <b>if</b> (<span class="r131 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;ParameterSetName&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r121 r">result</span>.<a href="../Attributes.cs.html#0f118c29e97e12b3" class="i property">ParameterSetName</a> = <a href="#e17522c792336625" class="i field">s_attrArgToStringArrayConverter</a>.<span class="i">Target</span>(<a href="#e17522c792336625" class="i field">s_attrArgToStringArrayConverter</a>, <span class="r130 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r131 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;ProviderCmdlet&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r121 r">result</span>.<a href="../Attributes.cs.html#d8d80d601118095c" class="i property">ProviderCmdlet</a> = <a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>.<span class="i">Target</span>(<a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>, <span class="r130 r">argValue</span>);
                }
                <b>else</b>
                {
                    <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(
                        <span class="r129 r">namedArg</span>,
                        <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                        <span class="r129 r">namedArg</span>.<span class="i">Extent</span>,
                        <span class="s">&quot;PropertyNotFoundForType&quot;</span>,
                        <span class="i">ParserStrings</span>.<span class="i">PropertyNotFoundForType</span>,
                        <span class="r131 r">argumentName</span>,
                        <b>typeof</b>(<a href="../Attributes.cs.html#67a775c242618ea6" class="t t">CmdletBindingAttribute</a>));
                }
            }
 
            <b>return</b> <span class="r121 r">result</span>;
        }
 
        <b>private static</b> <span class="i">Attribute</span> <a id="4d396ddf3dad7a08" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NewAliasAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r132 rd" class="r132 r">ast</span>)
        {
            <a href="#4275a98bcdef3a96" class="i method">CheckNoNamedArgs</a>(<span class="r132 r">ast</span>);
 
            <b>var</b> <span id="r133 rd" class="r133 r">args</span> = <b>new</b> <b>string</b>[<span class="r132 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span>];
            <b>for</b> (<b>int</b> <span id="r134 rd" class="r134 r">i</span> = 0; <span class="r134 r">i</span> &lt; <span class="r132 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span>; <span class="r134 r">i</span>++)
            {
                <span class="r133 r">args</span>[<span class="r134 r">i</span>] = <a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>.<span class="i">Target</span>(
                    <a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>,
                    <span class="r132 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>[<span class="r134 r">i</span>].<span class="i">Accept</span>(<a href="#7aab2dbbe9a1b5be" class="i field">s_cvv</a>));
            }
 
            <b>return</b> <b>new</b> <a href="../Attributes.cs.html#1eaa751706f9a59a" class="t constructor">AliasAttribute</a>(<span class="r133 r">args</span>);
        }
 
        <b>private static</b> <span class="i">Attribute</span> <a id="276bed6d431ab870" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NewValidateSetAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r135 rd" class="r135 r">ast</span>)
        {
            <a href="../Attributes.cs.html#33a6a027748d30a4" class="t t">ValidateSetAttribute</a> <span id="r136 rd" class="r136 r">result</span>;
 
            <span class="c">// &#39;ValidateSet([CustomGeneratorType], IgnoreCase=$false)&#39; is supported in scripts.</span>
            <b>if</b> (<span class="r135 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span> == 1 &amp;&amp; <span class="r135 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>[0] <b>is</b> <a href="ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a> <span id="r137 rd" class="r137 r">generatorTypeAst</span>)
            {
                <b>var</b> <span id="r138 rd" class="r138 r">generatorType</span> = <a href="TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="TypeResolver.cs.html#6b551d638ac1965a" class="i method">ResolveITypeName</a>(<span class="r137 r">generatorTypeAst</span>.<a href="ast.cs.html#c43447ab6269441a" class="i property">TypeName</a>, <b>out</b> <span class="i">Exception</span> <span id="r139 rd" class="r139 r">exception</span>);
                <b>if</b> (<span class="r138 r">generatorType</span> != <b>null</b>)
                {
                    <span class="r136 r">result</span> = <b>new</b> <a href="../Attributes.cs.html#fc09dc4794e0f1e7" class="t constructor">ValidateSetAttribute</a>(<span class="r138 r">generatorType</span>);
                }
                <b>else</b>
                {
                    <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterExceptionWithInnerException</span>(
                        <span class="r135 r">ast</span>,
                        <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                        <span class="r135 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <span class="s">&quot;TypeNotFound&quot;</span>,
                        <span class="i">ParserStrings</span>.<span class="i">TypeNotFound</span>,
                        <span class="r139 r">exception</span>,
                        <span class="r137 r">generatorTypeAst</span>.<a href="ast.cs.html#c43447ab6269441a" class="i property">TypeName</a>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>,
                        <b>typeof</b>(<span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../Attributes.cs.html#261d29581b0d1a37" class="t t">IValidateSetValuesGenerator</a>).<span class="i">FullName</span>);
                }
            }
            <b>else</b>
            {
                <span class="c">// &#39;ValidateSet(&quot;value1&quot;,&quot;value2&quot;, IgnoreCase=$false)&#39; is supported in scripts.</span>
                <b>var</b> <span id="r140 rd" class="r140 r">args</span> = <b>new</b> <b>string</b>[<span class="r135 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span>];
                <b>for</b> (<b>int</b> <span id="r141 rd" class="r141 r">i</span> = 0; <span class="r141 r">i</span> &lt; <span class="r135 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span>; <span class="r141 r">i</span>++)
                {
                    <span class="r140 r">args</span>[<span class="r141 r">i</span>] = <a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>.<span class="i">Target</span>(
                        <a href="#55e13c53e393f877" class="i field">s_attrArgToStringConverter</a>,
                        <span class="r135 r">ast</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>[<span class="r141 r">i</span>].<span class="i">Accept</span>(<a href="#7aab2dbbe9a1b5be" class="i field">s_cvv</a>));
                }
 
                <span class="r136 r">result</span> = <b>new</b> <a href="../Attributes.cs.html#e156071d7c94ccee" class="t constructor">ValidateSetAttribute</a>(<span class="r140 r">args</span>);
            }
 
            <b>foreach</b> (<b>var</b> <span id="r142 rd" class="r142 r">namedArg</span> <b>in</b> <span class="r135 r">ast</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a>)
            {
                <b>var</b> <span id="r143 rd" class="r143 r">argValue</span> = <span class="r142 r">namedArg</span>.<span class="i">Argument</span>.<span class="i">Accept</span>(<a href="#7aab2dbbe9a1b5be" class="i field">s_cvv</a>);
                <b>var</b> <span id="r144 rd" class="r144 r">argumentName</span> = <span class="r142 r">namedArg</span>.<span class="i">ArgumentName</span>;
                <b>if</b> (<span class="r144 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;IgnoreCase&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r136 r">result</span>.<a href="../Attributes.cs.html#90833178fccd6012" class="i property">IgnoreCase</a> = <a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>.<span class="i">Target</span>(<a href="#ab8a0437b8b895d3" class="i field">s_attrArgToBoolConverter</a>, <span class="r143 r">argValue</span>);
                }
                <b>else</b> <b>if</b> (<span class="r144 r">argumentName</span>.<span class="i">Equals</span>(<span class="s">&quot;ErrorMessage&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="r136 r">result</span>.<a href="../Attributes.cs.html#34f76f6dcc39b86d" class="i property">ErrorMessage</a> = <span class="r143 r">argValue</span>.<span class="i">ToString</span>();
                }
                <b>else</b>
                {
                    <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(
                        <span class="r142 r">namedArg</span>,
                        <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                        <span class="r142 r">namedArg</span>.<span class="i">Extent</span>,
                        <span class="s">&quot;PropertyNotFoundForType&quot;</span>,
                        <span class="i">ParserStrings</span>.<span class="i">PropertyNotFoundForType</span>,
                        <span class="r144 r">argumentName</span>,
                        <b>typeof</b>(<a href="../Attributes.cs.html#67a775c242618ea6" class="t t">CmdletBindingAttribute</a>));
                }
            }
 
            <b>return</b> <span class="r136 r">result</span>;
        }
 
        <b>private static</b> <span class="i">Attribute</span> <a id="f0b29f06a783af85" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NewDebuggerHiddenAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r145 rd" class="r145 r">ast</span>)
        {
            <a href="#cfa86123a0d7bb09" class="i method">CheckNoPositionalArgs</a>(<span class="r145 r">ast</span>);
            <a href="#4275a98bcdef3a96" class="i method">CheckNoNamedArgs</a>(<span class="r145 r">ast</span>);
            <b>return</b> <b>new</b> <span class="i">DebuggerHiddenAttribute</span>();
        }
 
        <b>private static</b> <span class="i">Attribute</span> <a id="4086413c673e2d5f" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NewValidateNotNullOrEmptyAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r146 rd" class="r146 r">ast</span>)
        {
            <a href="#cfa86123a0d7bb09" class="i method">CheckNoPositionalArgs</a>(<span class="r146 r">ast</span>);
            <a href="#4275a98bcdef3a96" class="i method">CheckNoNamedArgs</a>(<span class="r146 r">ast</span>);
            <b>return</b> <b>new</b> <span class="t">ValidateNotNullOrEmptyAttribute</span>();
        }
 
        <b>private static</b> <span class="i">Attribute</span> <a id="6de53b468375cf92" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NewValidateNotNullAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r147 rd" class="r147 r">ast</span>)
        {
            <a href="#cfa86123a0d7bb09" class="i method">CheckNoPositionalArgs</a>(<span class="r147 r">ast</span>);
            <a href="#4275a98bcdef3a96" class="i method">CheckNoNamedArgs</a>(<span class="r147 r">ast</span>);
            <b>return</b> <b>new</b> <span class="t">ValidateNotNullAttribute</span>();
        }
 
        <b>internal static</b> <span class="i">Attribute</span> <a id="cc9b80635c765212" href="../../R/cc9b80635c765212.html" target="n" data-glyph="74,1" class="i method">GetAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r148 rd" class="r148 r">attributeAst</span>)
        {
            <b>var</b> <span id="r149 rd" class="r149 r">attributeType</span> = <span class="r148 r">attributeAst</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#32e4c2eb2fe24684" class="i method">GetReflectionAttributeType</a>();
            <b>if</b> (<span class="r149 r">attributeType</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(
                    <span class="r148 r">attributeAst</span>,
                    <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                    <span class="r148 r">attributeAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <span class="s">&quot;CustomAttributeTypeNotFound&quot;</span>,
                    <span class="i">ParserStrings</span>.<span class="i">CustomAttributeTypeNotFound</span>,
                    <span class="r148 r">attributeAst</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>);
            }
 
            <span class="i">Func</span>&lt;<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>, <span class="i">Attribute</span>&gt; <span id="r150 rd" class="r150 r">generator</span>;
            <b>if</b> (<a href="#c66254218b170d12" class="i field">s_builtinAttributeGenerator</a>.<span class="i">TryGetValue</span>(<span class="r149 r">attributeType</span>, <b>out</b> <span class="r150 r">generator</span>))
            {
                <b>return</b> <span class="r150 r">generator</span>(<span class="r148 r">attributeAst</span>);
            }
 
            <b>var</b> <span id="r151 rd" class="r151 r">positionalArgCount</span> = <span class="r148 r">attributeAst</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span>;
            <b>var</b> <span id="r152 rd" class="r152 r">argumentNames</span> = <span class="r148 r">attributeAst</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a>.<span class="i">Select</span>(<b>static</b> <span id="r153 rd" class="r153 r">name</span> =&gt; <span class="r153 r">name</span>.<span class="i">ArgumentName</span>).<span class="i">ToArray</span>();
            <b>var</b> <span id="r154 rd" class="r154 r">totalArgCount</span> = <span class="r151 r">positionalArgCount</span> + <span class="r152 r">argumentNames</span>.<span class="i">Length</span>;
            <b>var</b> <span id="r155 rd" class="r155 r">callInfo</span> = <b>new</b> <span class="i">CallInfo</span>(<span class="r154 r">totalArgCount</span>, <span class="r152 r">argumentNames</span>);
 
            <b>var</b> <span id="r156 rd" class="r156 r">delegateArgs</span> = <b>new</b> <b>object</b>[<span class="r154 r">totalArgCount</span> + 1];
            <span class="r156 r">delegateArgs</span>[0] = <span class="r149 r">attributeType</span>;
 
            <b>int</b> <span id="r157 rd" class="r157 r">i</span> = 1;
            <b>for</b> (<b>int</b> <span id="r158 rd" class="r158 r">index</span> = 0; <span class="r158 r">index</span> &lt; <span class="r148 r">attributeAst</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>.<span class="i">Count</span>; <span class="r158 r">index</span>++)
            {
                <b>var</b> <span id="r159 rd" class="r159 r">posArg</span> = <span class="r148 r">attributeAst</span>.<a href="ast.cs.html#0ad84283990f3553" class="i property">PositionalArguments</a>[<span class="r158 r">index</span>];
                <span class="r156 r">delegateArgs</span>[<span class="r157 r">i</span>++] = <span class="r159 r">posArg</span>.<span class="i">Accept</span>(<a href="#7aab2dbbe9a1b5be" class="i field">s_cvv</a>);
            }
 
            <b>for</b> (<b>int</b> <span id="r160 rd" class="r160 r">index</span> = 0; <span class="r160 r">index</span> &lt; <span class="r148 r">attributeAst</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a>.<span class="i">Count</span>; <span class="r160 r">index</span>++)
            {
                <b>var</b> <span id="r161 rd" class="r161 r">namedArg</span> = <span class="r148 r">attributeAst</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a>[<span class="r160 r">index</span>];
                <span class="r156 r">delegateArgs</span>[<span class="r157 r">i</span>++] = <span class="r161 r">namedArg</span>.<span class="i">Argument</span>.<span class="i">Accept</span>(<a href="#7aab2dbbe9a1b5be" class="i field">s_cvv</a>);
            }
 
            <b>try</b>
            {
                <b>return</b> (<span class="i">Attribute</span>)<a href="#2bc04c5908d99083" class="i method">GetAttributeGenerator</a>(<span class="r155 r">callInfo</span>).<span class="i">DynamicInvoke</span>(<span class="r156 r">delegateArgs</span>);
            }
            <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r162 rd" class="r162 r">tie</span>)
            {
                <span class="c">// Unwrap the wrapped exception</span>
                <b>var</b> <span id="r163 rd" class="r163 r">innerException</span> = <span class="r162 r">tie</span>.<span class="i">InnerException</span>;
                <a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="k">var</a> <span id="r164 rd" class="r164 r">rte</span> = <span class="r163 r">innerException</span> <b>as</b> <a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>;
                <b>if</b> (<span class="r164 r">rte</span> == <b>null</b>)
                {
                    <span class="r164 r">rte</span> = <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterExceptionWithInnerException</span>(
                        <b>null</b>,
                        <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                        <span class="r148 r">attributeAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <span class="s">&quot;ExceptionConstructingAttribute&quot;</span>,
                        <span class="i">ExtendedTypeSystem</span>.<span class="i">ExceptionConstructingAttribute</span>,
                        <span class="r163 r">innerException</span>,
                        <span class="r163 r">innerException</span>.<span class="i">Message</span>,
                        <span class="r148 r">attributeAst</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>);
                }
 
                <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">UpdateExceptionErrorRecordPosition</span>(<span class="r164 r">rte</span>, <span class="r148 r">attributeAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>);
                <b>throw</b> <span class="r164 r">rte</span>;
            }
        }
 
        <b>internal static</b> <span class="i">Attribute</span> <a id="c75a25cfd3c34811" href="../../R/c75a25cfd3c34811.html" target="n" data-glyph="74,1" class="i method">GetAttribute</a>(<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r165 rd" class="r165 r">typeConstraintAst</span>)
        {
            <span class="i">Type</span> <span id="r166 rd" class="r166 r">type</span> = <b>null</b>;
            <a href="ast.cs.html#17ce99e65ddcd5ec" class="k">var</a> <span id="r167 rd" class="r167 r">ihct</span> = <span class="r165 r">typeConstraintAst</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a> <b>as</b> <a href="ast.cs.html#17ce99e65ddcd5ec" class="t t">ISupportsTypeCaching</a>;
            <b>if</b> (<span class="r167 r">ihct</span> != <b>null</b>)
            {
                <span class="r166 r">type</span> = <span class="r167 r">ihct</span>.<a href="ast.cs.html#d64781556b926659" class="i property">CachedType</a>;
            }
 
            <b>if</b> (<span class="r166 r">type</span> == <b>null</b>)
            {
                <span class="r166 r">type</span> = <a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<a href="../runtime/Operations/MiscOps.cs.html#d4354a46a82a388e" class="i method">ResolveTypeName</a>(<span class="r165 r">typeConstraintAst</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>, <span class="r165 r">typeConstraintAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>);
                <b>if</b> (<span class="r167 r">ihct</span> != <b>null</b>)
                {
                    <span class="r167 r">ihct</span>.<a href="ast.cs.html#d64781556b926659" class="i property">CachedType</a> = <span class="r166 r">type</span>;
                }
            }
 
            <b>return</b> <b>new</b> <a href="../ArgumentTypeConverterAttribute.cs.html#7a2e0d514535296f" class="t constructor">ArgumentTypeConverterAttribute</a>(<span class="r166 r">type</span>);
        }
 
        <b>private static</b> <a href="../PseudoParameters.cs.html#68fb670c5eb25328" class="t t">RuntimeDefinedParameter</a> <a id="abac79433d053606" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetRuntimeDefinedParameter</a>(<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a> <span id="r168 rd" class="r168 r">parameterAst</span>, <b>ref bool</b> <span id="r169 rd" class="r169 r">customParameterSet</span>, <b>ref bool</b> <span id="r170 rd" class="r170 r">usesCmdletBinding</span>)
        {
            <b>var</b> <span id="r171 rd" class="r171 r">attributes</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Attribute</span>&gt;(<span class="r168 r">parameterAst</span>.<a href="ast.cs.html#5f4fbe2ccc8004ce" class="i property">Attributes</a>.<span class="i">Count</span>);
            <b>bool</b> <span id="r172 rd" class="r172 r">hasParameterAttribute</span> = <b>false</b>;
            <b>bool</b> <span id="r173 rd" class="r173 r">hasEnabledParamAttribute</span> = <b>false</b>;
            <b>bool</b> <span id="r174 rd" class="r174 r">hasSeenExpAttribute</span> = <b>false</b>;
 
            <b>for</b> (<b>int</b> <span id="r175 rd" class="r175 r">index</span> = 0; <span class="r175 r">index</span> &lt; <span class="r168 r">parameterAst</span>.<a href="ast.cs.html#5f4fbe2ccc8004ce" class="i property">Attributes</a>.<span class="i">Count</span>; <span class="r175 r">index</span>++)
            {
                <b>var</b> <span id="r176 rd" class="r176 r">attributeAst</span> = <span class="r168 r">parameterAst</span>.<a href="ast.cs.html#5f4fbe2ccc8004ce" class="i property">Attributes</a>[<span class="r175 r">index</span>];
                <b>var</b> <span id="r177 rd" class="r177 r">attribute</span> = <span class="r176 r">attributeAst</span>.<span class="i">GetAttribute</span>();
 
                <b>if</b> (<span class="r177 r">attribute</span> <b>is</b> <a href="../ExperimentalFeature/ExperimentalFeature.cs.html#a9ee2c313b8e7ce8" class="t t">ExperimentalAttribute</a> <span id="r178 rd" class="r178 r">expAttribute</span>)
                {
                    <span class="c">// Only honor the first seen experimental attribute, ignore the others.</span>
                    <b>if</b> (!<span class="r174 r">hasSeenExpAttribute</span> &amp;&amp; <span class="r178 r">expAttribute</span>.<a href="../ExperimentalFeature/ExperimentalFeature.cs.html#5f379d0c61d42350" class="i property">ToHide</a>)
                    {
                        <b>return</b> <b>null</b>;
                    }
 
                    <span class="c">// Do not add experimental attributes to the attribute list.</span>
                    <span class="r174 r">hasSeenExpAttribute</span> = <b>true</b>;
                    <b>continue</b>;
                }
                <b>else</b> <b>if</b> (<span class="r177 r">attribute</span> <b>is</b> <a href="../Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a> <span id="r179 rd" class="r179 r">paramAttribute</span>)
                {
                    <span class="r172 r">hasParameterAttribute</span> = <b>true</b>;
                    <b>if</b> (<span class="r179 r">paramAttribute</span>.<a href="../Attributes.cs.html#b197f16689e3db67" class="i property">ToHide</a>)
                    {
                        <b>continue</b>;
                    }
 
                    <span class="r173 r">hasEnabledParamAttribute</span> = <b>true</b>;
                    <span class="r170 r">usesCmdletBinding</span> = <b>true</b>;
                    <b>if</b> (<span class="r179 r">paramAttribute</span>.<a href="../Attributes.cs.html#19ccfeb1cdbdb967" class="i property">Position</a> != <b>int</b>.<span class="i">MinValue</span> ||
                        !<span class="r179 r">paramAttribute</span>.<a href="../Attributes.cs.html#91bee819daab0925" class="i property">ParameterSetName</a>.<span class="i">Equals</span>(
                            <a href="../Attributes.cs.html#3d5ed915c8442ad6" class="t t">ParameterAttribute</a>.<a href="../Attributes.cs.html#5cb6a6d49034b66c" class="i field">AllParameterSets</a>,
                            <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                    {
                        <span class="r169 r">customParameterSet</span> = <b>true</b>;
                    }
                }
 
                <span class="r171 r">attributes</span>.<span class="i">Add</span>(<span class="r177 r">attribute</span>);
            }
 
            <span class="c">// If all &#39;ParameterAttribute&#39; declared for the parameter are hidden due to</span>
            <span class="c">// an experimental feature, then the parameter should be ignored.</span>
            <b>if</b> (<span class="r172 r">hasParameterAttribute</span> &amp;&amp; !<span class="r173 r">hasEnabledParamAttribute</span>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="r171 r">attributes</span>.<span class="i">Reverse</span>();
            <b>if</b> (!<span class="r172 r">hasParameterAttribute</span>)
            {
                <span class="r171 r">attributes</span>.<span class="i">Insert</span>(0, <b>new</b> <a href="../Attributes.cs.html#5a7647804c8ceec5" class="t constructor">ParameterAttribute</a>());
            }
 
            <a href="../PseudoParameters.cs.html#68fb670c5eb25328" class="k">var</a> <span id="r180 rd" class="r180 r">result</span> = <b>new</b> <a href="../PseudoParameters.cs.html#deffc0fe032d6eab" class="t constructor">RuntimeDefinedParameter</a>(<span class="r168 r">parameterAst</span>.<a href="ast.cs.html#ba2fe0223eb09f0d" class="i property">Name</a>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>, <span class="r168 r">parameterAst</span>.<a href="ast.cs.html#a41281d1e358ea79" class="i property">StaticType</a>,
                                                     <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Attribute</span>&gt;(<span class="r171 r">attributes</span>));
 
            <b>if</b> (<span class="r168 r">parameterAst</span>.<a href="ast.cs.html#d0773d8161160fae" class="i property">DefaultValue</a> != <b>null</b>)
            {
                <b>object</b> <span id="r181 rd" class="r181 r">constantValue</span>;
                <b>if</b> (<a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<a href="ConstantValues.cs.html#594e7e13f898b0a1" class="i method">IsConstant</a>(<span class="r168 r">parameterAst</span>.<a href="ast.cs.html#d0773d8161160fae" class="i property">DefaultValue</a>, <b>out</b> <span class="r181 r">constantValue</span>))
                {
                    <span class="r180 r">result</span>.<a href="../PseudoParameters.cs.html#de6715664001bb38" class="i property">Value</a> = <span class="r181 r">constantValue</span>;
                }
                <b>else</b>
                {
                    <span class="c">// Expression isn&#39;t constant, create a wrapper that holds the ast, and if necessary,</span>
                    <span class="c">// will cache a delegate to evaluate the default value.</span>
                    <span class="r180 r">result</span>.<a href="../PseudoParameters.cs.html#de6715664001bb38" class="i property">Value</a> = <b>new</b> <span class="t">DefaultValueExpressionWrapper</span> { <a href="#d0bc1f840cc0d383" class="i property">Expression</a> = <span class="r168 r">parameterAst</span>.<a href="ast.cs.html#d0773d8161160fae" class="i property">DefaultValue</a> };
                }
            }
            <b>else</b>
            {
                <b>object</b> <span id="r182 rd" class="r182 r">defaultValue</span>;
                <b>if</b> (<a href="#78e2d1281fd0bd6c" class="i method">TryGetDefaultParameterValue</a>(<span class="r168 r">parameterAst</span>.<a href="ast.cs.html#a41281d1e358ea79" class="i property">StaticType</a>, <b>out</b> <span class="r182 r">defaultValue</span>) &amp;&amp; <span class="r182 r">defaultValue</span> != <b>null</b>)
                {
                    <span class="c">// Skip setting the value when defaultValue is null because if we do call the setter,</span>
                    <span class="c">// we&#39;ll try converting null to the parameter, which we might not want, e.g. if the parameter is [ref].</span>
                    <span class="r180 r">result</span>.<a href="../PseudoParameters.cs.html#de6715664001bb38" class="i property">Value</a> = <span class="r182 r">defaultValue</span>;
                }
            }
 
            <b>return</b> <span class="r180 r">result</span>;
        }
 
        <b>internal static bool</b> <a id="78e2d1281fd0bd6c" href="../../R/78e2d1281fd0bd6c.html" target="n" data-glyph="74,1" class="i method">TryGetDefaultParameterValue</a>(<span class="i">Type</span> <span id="r183 rd" class="r183 r">type</span>, <b>out object</b> <span id="r184 rd" class="r184 r">value</span>)
        {
            <b>if</b> (<span class="r183 r">type</span> == <b>typeof</b>(<b>string</b>))
            {
                <span class="r184 r">value</span> = <b>string</b>.<span class="i">Empty</span>;
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r183 r">type</span>.<span class="i">IsClass</span>)
            {
                <span class="r184 r">value</span> = <b>null</b>;
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r183 r">type</span> == <b>typeof</b>(<b>bool</b>))
            {
                <span class="r184 r">value</span> = <a href="../runtime/Operations/NumericOps.cs.html#a75d534e5fa18108" class="t t">Boxed</a>.<a href="../runtime/Operations/NumericOps.cs.html#36bb5cda34c8ae7d" class="i field">False</a>;
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r183 r">type</span> == <b>typeof</b>(<a href="../MshCmdlet.cs.html#8260026027378f6c" class="t t">SwitchParameter</a>))
            {
                <span class="r184 r">value</span> = <b>new</b> <a href="../MshCmdlet.cs.html#bc9e109b8e1a51f1" class="t constructor">SwitchParameter</a>(<b>false</b>);
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#e25b1c6d235a82c5" class="i method">IsNumeric</a>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#b95fb4b37c36d13d" class="i method">GetTypeCode</a>(<span class="r183 r">type</span>)) &amp;&amp; !<span class="r183 r">type</span>.<span class="i">IsEnum</span>)
            {
                <span class="r184 r">value</span> = 0;
                <b>return</b> <b>true</b>;
            }
 
            <span class="r184 r">value</span> = <b>null</b>;
            <b>return</b> <b>false</b>;
        }
 
        <b>internal class</b> <a id="1bc376c4f871461b" href="../../R/1bc376c4f871461b.html" target="n" data-glyph="2,1" class="t t"><span id="2d540734e493335b">DefaultValueExpressionWrapper</span></a>
        {
            <b>internal</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="d0bc1f840cc0d383" href="../../R/d0bc1f840cc0d383.html" target="n" data-glyph="104,2" class="i property">Expression</a> { <b>get</b>; <b>set</b>; }
 
            <b>private</b> <span class="i">Func</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>, <b>object</b>&gt; <a id="ac978469786f152b" href="../../R/ac978469786f152b.html" target="n" data-glyph="46,2" class="i field">_delegate</a>;
            <b>private</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>[] <a id="d27b0ef7144b57fb" href="../../R/d27b0ef7144b57fb.html" target="n" data-glyph="46,2" class="i field">_sequencePoints</a>;
            <b>private</b> <span class="i">Type</span> <a id="318b636c1ac491b8" href="../../R/318b636c1ac491b8.html" target="n" data-glyph="46,2" class="i field">LocalsTupleType</a>;
 
            <b>internal object</b> <a id="d71913e518ec5671" href="../../R/d71913e518ec5671.html" target="n" data-glyph="74,2" class="i method">GetValue</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r185 rd" class="r185 r">context</span>, <a href="../../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r186 rd" class="r186 r">sessionStateInternal</span>, <span class="i">IDictionary</span> <span id="r187 rd" class="r187 r">usingValues</span> = <b>null</b>)
            {
                <b>lock</b> (<a href="#1bc376c4f871461b" class="k">this</a>)
                {
                    <span class="c">// Code written as part of a default value in a parameter is considered trusted</span>
                    <b>return</b> <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#33484676455dddcc" class="i method">GetExpressionValue</a>(
                        <a href="#1bc376c4f871461b" class="k">this</a>.<a href="#d0bc1f840cc0d383" class="i property">Expression</a>,
                        <b>true</b>,
                        <span class="r185 r">context</span>,
                        <span class="r186 r">sessionStateInternal</span>,
                        <span class="r187 r">usingValues</span>,
                        <b>ref</b> <a href="#ac978469786f152b" class="i field">_delegate</a>,
                        <b>ref</b> <a href="#d27b0ef7144b57fb" class="i field">_sequencePoints</a>,
                        <b>ref</b> <a href="#318b636c1ac491b8" class="i field">LocalsTupleType</a>);
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Parameter Metadata
 
        <span class="c">// This is the main entry point for turning an AST into compiled code.</span>
        <b>internal void</b> <a id="ab988fb229ec4a74" href="../../R/ab988fb229ec4a74.html" target="n" data-glyph="74,1" class="i method">Compile</a>(<a href="../runtime/CompiledScriptBlock.cs.html#a80c8ca7922183a5" class="t t">CompiledScriptBlockData</a> <span id="r188 rd" class="r188 r">scriptBlock</span>, <b>bool</b> <span id="r189 rd" class="r189 r">optimize</span>)
        {
            <a href="ast.cs.html#063cc8bbea9e10f2" class="k">var</a> <span id="r190 rd" class="r190 r">body</span> = <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#4fc4e37b6267d386" class="i property">Ast</a>;
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                <span class="r190 r">body</span> <b>is</b> <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> || <span class="r190 r">body</span> <b>is</b> <a href="ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> || <span class="r190 r">body</span> <b>is</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a> || <span class="r190 r">body</span> <b>is</b> <a href="ast.cs.html#542e4087fd3a0dac" class="t t">CompilerGeneratedMemberFunctionAst</a>,
                <span class="s">&quot;Caller to verify ast is correct type.&quot;</span>);
 
            <a href="ast.cs.html#d47621d83efd14de" class="k">var</a> <span id="r191 rd" class="r191 r">ast</span> = (<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>)<span class="r190 r">body</span>;
            <a href="#57ac2e55a5b17eb3" class="i property">Optimize</a> = <span class="r189 r">optimize</span>;
            <a href="#1502a03e3576ca9a" class="i field">_compilingScriptCmdlet</a> = <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#a6b53fb28ca80b16" class="i property">UsesCmdletBinding</a>;
 
            <b>var</b> <span id="r192 rd" class="r192 r">fileName</span> = <span class="r191 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#e933edecd2b0cc1d" class="i property">File</a>;
            <b>if</b> (<span class="r192 r">fileName</span> != <b>null</b>)
            {
                <a href="#2807a84cb0b61e38" class="i field">_debugSymbolDocument</a> = <span class="i">Expression</span>.<span class="i">SymbolDocument</span>(<span class="r192 r">fileName</span>);
            }
 
            <b>var</b> <span id="r193 rd" class="r193 r">details</span> = <a href="VariableAnalysis.cs.html#3d310869db3a3b73" class="t t">VariableAnalysis</a>.<span class="i">Analyze</span>(<span class="r190 r">body</span>, !<span class="r189 r">optimize</span>, <a href="#1502a03e3576ca9a" class="i field">_compilingScriptCmdlet</a>);
            <a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a> = <span class="r193 r">details</span>.<span class="i">Item1</span>;
            <b>var</b> <span id="r194 rd" class="r194 r">nameToIndexMap</span> = <span class="r193 r">details</span>.<span class="i">Item2</span>;
 
            <b>if</b> (!<span class="r194 r">nameToIndexMap</span>.<span class="i">TryGetValue</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#c6964a35f7b6545f" class="i field">@switch</a>, <b>out</b> <a href="#6fecf39186823e1e" class="i field">_switchTupleIndex</a>))
            {
                <a href="#6fecf39186823e1e" class="i field">_switchTupleIndex</a> = <a href="VariableAnalysis.cs.html#3d310869db3a3b73" class="t t">VariableAnalysis</a>.<a href="VariableAnalysis.cs.html#1df8fb0284c85f3f" class="i field">ForceDynamic</a>;
            }
 
            <b>if</b> (!<span class="r194 r">nameToIndexMap</span>.<span class="i">TryGetValue</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#0b26037366c6e99a" class="i field">@foreach</a>, <b>out</b> <a href="#0ae9e05f0dbd60e7" class="i field">_foreachTupleIndex</a>))
            {
                <a href="#0ae9e05f0dbd60e7" class="i field">_foreachTupleIndex</a> = <a href="VariableAnalysis.cs.html#3d310869db3a3b73" class="t t">VariableAnalysis</a>.<a href="VariableAnalysis.cs.html#1df8fb0284c85f3f" class="i field">ForceDynamic</a>;
            }
 
            <a href="#60079b222ae29e0d" class="i property">LocalVariablesParameter</a> = <span class="i">Expression</span>.<span class="i">Variable</span>(<a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a>, <span class="s">&quot;locals&quot;</span>);
 
            <a href="ast.cs.html#0c4f2db9a681a977" class="k">var</a> <span id="r195 rd" class="r195 r">functionMemberAst</span> = <span class="r191 r">ast</span> <b>as</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>;
            <b>if</b> (<span class="r195 r">functionMemberAst</span> != <b>null</b>)
            {
                <a href="#e116f57a129b16bc" class="i property">CompilingMemberFunction</a> = <b>true</b>;
                <a href="#0956e73d835184c4" class="i property">MemberFunctionReturnType</a> = <span class="r195 r">functionMemberAst</span>.<a href="ast.cs.html#d04a04ffd2e70981" class="i method">GetReturnType</a>();
                <a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a> = (<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>)<span class="r195 r">functionMemberAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                <a href="#c3fa23b2c44834ed" class="i property">SpecialMemberFunctionType</a> = <a href="ast.cs.html#19743eab765b38bd" class="t t">SpecialMemberFunctionType</a>.<a href="ast.cs.html#0c187d0aa304e82a" class="i field">None</a>;
                <b>if</b> (<span class="r195 r">functionMemberAst</span>.<a href="ast.cs.html#4a93ad116ed68e0e" class="i property">Name</a>.<span class="i">Equals</span>(<a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>.<a href="ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="c">// TODO: default argument support</span>
                    <b>var</b> <span id="r196 rd" class="r196 r">parameters</span> = ((<a href="ast.cs.html#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a>)<span class="r195 r">functionMemberAst</span>.<a href="ast.cs.html#0cea07df0e8f92c9" class="i property">Body</a>).<a href="ast.cs.html#57fef4bbca7ab95c" class="i property">Parameters</a>;
                    <b>if</b> (<span class="r196 r">parameters</span> == <b>null</b> || <span class="r196 r">parameters</span>.<span class="i">Count</span> == 0)
                    {
                        <a href="#c3fa23b2c44834ed" class="i property">SpecialMemberFunctionType</a> = <span class="r195 r">functionMemberAst</span>.<a href="ast.cs.html#d453a785cf1ce2d4" class="i property">IsStatic</a>
                            ? <a href="ast.cs.html#19743eab765b38bd" class="t t">SpecialMemberFunctionType</a>.<a href="ast.cs.html#b78a27783df5b515" class="i field">StaticConstructor</a>
                            : <a href="ast.cs.html#19743eab765b38bd" class="t t">SpecialMemberFunctionType</a>.<a href="ast.cs.html#2db5275de9fc26b7" class="i field">DefaultConstructor</a>;
                    }
                }
            }
            <b>else</b>
            {
                <a href="ast.cs.html#542e4087fd3a0dac" class="k">var</a> <span id="r197 rd" class="r197 r">generatedMemberFunctionAst</span> = <span class="r191 r">ast</span> <b>as</b> <a href="ast.cs.html#542e4087fd3a0dac" class="t t">CompilerGeneratedMemberFunctionAst</a>;
                <b>if</b> (<span class="r197 r">generatedMemberFunctionAst</span> != <b>null</b>)
                {
                    <a href="#e116f57a129b16bc" class="i property">CompilingMemberFunction</a> = <b>true</b>;
                    <a href="#c3fa23b2c44834ed" class="i property">SpecialMemberFunctionType</a> = <span class="r197 r">generatedMemberFunctionAst</span>.<a href="ast.cs.html#48a124828c4da2d7" class="i property">Type</a>;
                    <a href="#0956e73d835184c4" class="i property">MemberFunctionReturnType</a> = <b>typeof</b>(<b>void</b>);
                    <a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a> = <span class="r197 r">generatedMemberFunctionAst</span>.<a href="ast.cs.html#99051ed8c3d7385d" class="i property">DefiningType</a>;
                }
            }
 
            <span class="r190 r">body</span>.<a href="ast.cs.html#b25d4ae40ae3a393" class="i property">Body</a>.<a href="ast.cs.html#d18edcf2ee519956" class="i method">Accept</a>(<a href="#8bdfc042f41c96c5" class="k">this</a>);
 
            <b>if</b> (<a href="#be6f1ba488dac21b" class="i field">_sequencePoints</a>.<span class="i">Count</span> == 0)
            {
                <span class="c">// Uncommon, but possible if a script is empty, or if it only defines functions.</span>
                <span class="c">// In this case, add the entire body as a sequence point.  Debugging won&#39;t stop</span>
                <span class="c">// on this sequence point, but it makes it safe to access the CurrentPosition</span>
                <span class="c">// property in FunctionContext (which can happen if there are exceptions</span>
                <span class="c">// defining the functions.)</span>
                <a href="#319aa081bb450665" class="i method">AddSequencePoint</a>(<span class="r191 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>);
            }
 
            <a href="../runtime/CompiledScriptBlock.cs.html#85d3cce0f94dc5cc" class="k">var</a> <span id="r198 rd" class="r198 r">compileInterpretChoice</span> = (<a href="#bbc2448f2228e671" class="i field">_stmtCount</a> &gt; 300) ? <a href="../runtime/CompiledScriptBlock.cs.html#85d3cce0f94dc5cc" class="t t">CompileInterpretChoice</a>.<a href="../runtime/CompiledScriptBlock.cs.html#c5f98f2c635b066b" class="i field">NeverCompile</a> : <a href="../runtime/CompiledScriptBlock.cs.html#85d3cce0f94dc5cc" class="t t">CompileInterpretChoice</a>.<a href="../runtime/CompiledScriptBlock.cs.html#947d7b82b1184fc9" class="i field">CompileOnDemand</a>;
 
            <b>if</b> (<span class="r189 r">optimize</span>)
            {
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#c18d520d763b6c11" class="i property">DynamicParamBlock</a> = <a href="#ed9a22974869d42c" class="i method">CompileTree</a>(<a href="#4974fd3aa1eb9d4c" class="i field">_dynamicParamBlockLambda</a>, <span class="r198 r">compileInterpretChoice</span>);
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#9913dea66272cc70" class="i property">BeginBlock</a> = <a href="#ed9a22974869d42c" class="i method">CompileTree</a>(<a href="#8cf5db88793d4ed0" class="i field">_beginBlockLambda</a>, <span class="r198 r">compileInterpretChoice</span>);
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#81b0289e5e379546" class="i property">ProcessBlock</a> = <a href="#ed9a22974869d42c" class="i method">CompileTree</a>(<a href="#7427d7f613b45375" class="i field">_processBlockLambda</a>, <span class="r198 r">compileInterpretChoice</span>);
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#6210fa92a7dbeebe" class="i property">EndBlock</a> = <a href="#ed9a22974869d42c" class="i method">CompileTree</a>(<a href="#da90e7d280e40a9b" class="i field">_endBlockLambda</a>, <span class="r198 r">compileInterpretChoice</span>);
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#e19b7f75e9ba3109" class="i property">LocalsMutableTupleType</a> = <a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a>;
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#96022acf251075a0" class="i property">LocalsMutableTupleCreator</a> = <a href="../runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a>.<a href="../runtime/MutableTuple.cs.html#91da31d86831552d" class="i method">TupleCreator</a>(<a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a>);
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#e200f548c2cb062b" class="i property">NameToIndexMap</a> = <span class="r194 r">nameToIndexMap</span>;
            }
            <b>else</b>
            {
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#ef7c60a2857843dc" class="i property">UnoptimizedDynamicParamBlock</a> = <a href="#ed9a22974869d42c" class="i method">CompileTree</a>(<a href="#4974fd3aa1eb9d4c" class="i field">_dynamicParamBlockLambda</a>, <span class="r198 r">compileInterpretChoice</span>);
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#22c1e1d6bb481504" class="i property">UnoptimizedBeginBlock</a> = <a href="#ed9a22974869d42c" class="i method">CompileTree</a>(<a href="#8cf5db88793d4ed0" class="i field">_beginBlockLambda</a>, <span class="r198 r">compileInterpretChoice</span>);
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#efa61db3d10b1e5f" class="i property">UnoptimizedProcessBlock</a> = <a href="#ed9a22974869d42c" class="i method">CompileTree</a>(<a href="#7427d7f613b45375" class="i field">_processBlockLambda</a>, <span class="r198 r">compileInterpretChoice</span>);
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#3255522102eddb54" class="i property">UnoptimizedEndBlock</a> = <a href="#ed9a22974869d42c" class="i method">CompileTree</a>(<a href="#da90e7d280e40a9b" class="i field">_endBlockLambda</a>, <span class="r198 r">compileInterpretChoice</span>);
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#365d21fb5ac6f9e6" class="i property">UnoptimizedLocalsMutableTupleType</a> = <a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a>;
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#60d93a32e14ee515" class="i property">UnoptimizedLocalsMutableTupleCreator</a> = <a href="../runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a>.<a href="../runtime/MutableTuple.cs.html#91da31d86831552d" class="i method">TupleCreator</a>(<a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a>);
            }
 
            <span class="c">// The sequence points are identical optimized or not.  Regardless, we want to ensure</span>
            <span class="c">// that the list is unique no matter when the property is accessed, so make sure it is set just once.</span>
            <b>if</b> (<span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#f7bd45487f76d285" class="i property">SequencePoints</a> == <b>null</b>)
            {
                <span class="r188 r">scriptBlock</span>.<a href="../runtime/CompiledScriptBlock.cs.html#f7bd45487f76d285" class="i property">SequencePoints</a> = <a href="#be6f1ba488dac21b" class="i field">_sequencePoints</a>.<span class="i">ToArray</span>();
            }
        }
 
        <b>private static</b> <span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt; <a id="ed9a22974869d42c" href="../../R/ed9a22974869d42c.html" target="n" data-glyph="76,1" class="i method">CompileTree</a>(<span class="i">Expression</span>&lt;<span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;&gt; <span id="r199 rd" class="r199 r">lambda</span>, <a href="../runtime/CompiledScriptBlock.cs.html#85d3cce0f94dc5cc" class="t t">CompileInterpretChoice</a> <span id="r200 rd" class="r200 r">compileInterpretChoice</span>)
        {
            <b>if</b> (<span class="r199 r">lambda</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r200 r">compileInterpretChoice</span> == <a href="../runtime/CompiledScriptBlock.cs.html#85d3cce0f94dc5cc" class="t t">CompileInterpretChoice</a>.<a href="../runtime/CompiledScriptBlock.cs.html#b2e9faa10199a7ac" class="i field">AlwaysCompile</a>)
            {
                <b>return</b> <span class="r199 r">lambda</span>.<span class="i">Compile</span>();
            }
 
            <span class="c">// threshold is # of times the script must run before we decide to compile</span>
            <span class="c">// NeverCompile sets the threshold to int.MaxValue, so theoretically we might compile</span>
            <span class="c">// at some point, but it&#39;s very unlikely.</span>
            <b>int</b> <span id="r201 rd" class="r201 r">threshold</span> = (<span class="r200 r">compileInterpretChoice</span> == <a href="../runtime/CompiledScriptBlock.cs.html#85d3cce0f94dc5cc" class="t t">CompileInterpretChoice</a>.<a href="../runtime/CompiledScriptBlock.cs.html#c5f98f2c635b066b" class="i field">NeverCompile</a>) ? <b>int</b>.<span class="i">MaxValue</span> : -1;
            <b>var</b> <span id="r202 rd" class="r202 r">deleg</span> = <b>new</b> <a href="../interpreter/LightCompiler.cs.html#5a5c9f16bfc515bd" class="t constructor">LightCompiler</a>(<span class="r201 r">threshold</span>).<span class="i">CompileTop</span>(<span class="r199 r">lambda</span>).<a href="../interpreter/LightDelegateCreator.cs.html#00eae77d47d5a1e7" class="i method">CreateDelegate</a>();
            <b>return</b> (<span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;)<span class="r202 r">deleg</span>;
        }
 
        <b>internal static object</b> <a id="e64c031d9d5607aa" href="../../R/e64c031d9d5607aa.html" target="n" data-glyph="74,1" class="i method">GetExpressionValue</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r203 rd" class="r203 r">expressionAst</span>, <b>bool</b> <span id="r204 rd" class="r204 r">isTrustedInput</span>, <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r205 rd" class="r205 r">context</span>, <span class="i">IDictionary</span> <span id="r206 rd" class="r206 r">usingValues</span> = <b>null</b>)
        {
            <b>return</b> <a href="#2cd655dab8161b90" class="i method">GetExpressionValue</a>(<span class="r203 r">expressionAst</span>, <span class="r204 r">isTrustedInput</span>, <span class="r205 r">context</span>, <b>null</b>, <span class="r206 r">usingValues</span>);
        }
 
        <b>internal static object</b> <a id="2cd655dab8161b90" href="../../R/2cd655dab8161b90.html" target="n" data-glyph="74,1" class="i method">GetExpressionValue</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r207 rd" class="r207 r">expressionAst</span>, <b>bool</b> <span id="r208 rd" class="r208 r">isTrustedInput</span>, <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r209 rd" class="r209 r">context</span>, <a href="../../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r210 rd" class="r210 r">sessionStateInternal</span>, <span class="i">IDictionary</span> <span id="r211 rd" class="r211 r">usingValues</span> = <b>null</b>)
        {
            <span class="i">Func</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>, <b>object</b>&gt; <span id="r212 rd" class="r212 r">lambda</span> = <b>null</b>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>[] <span id="r213 rd" class="r213 r">sequencePoints</span> = <b>null</b>;
            <span class="i">Type</span> <span id="r214 rd" class="r214 r">localsTupleType</span> = <b>null</b>;
            <b>return</b> <a href="#33484676455dddcc" class="i method">GetExpressionValue</a>(<span class="r207 r">expressionAst</span>, <span class="r208 r">isTrustedInput</span>, <span class="r209 r">context</span>, <span class="r210 r">sessionStateInternal</span>, <span class="r211 r">usingValues</span>, <b>ref</b> <span class="r212 r">lambda</span>, <b>ref</b> <span class="r213 r">sequencePoints</span>, <b>ref</b> <span class="r214 r">localsTupleType</span>);
        }
 
        <b>private static object</b> <a id="33484676455dddcc" href="../../R/33484676455dddcc.html" target="n" data-glyph="76,1" class="i method">GetExpressionValue</a>(
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r215 rd" class="r215 r">expressionAst</span>,
            <b>bool</b> <span id="r216 rd" class="r216 r">isTrustedInput</span>,
            <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r217 rd" class="r217 r">context</span>,
            <a href="../../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r218 rd" class="r218 r">sessionStateInternal</span>,
            <span class="i">IDictionary</span> <span id="r219 rd" class="r219 r">usingValues</span>,
            <b>ref</b> <span class="i">Func</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>, <b>object</b>&gt; <span id="r220 rd" class="r220 r">lambda</span>,
            <b>ref</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>[] <span id="r221 rd" class="r221 r">sequencePoints</span>,
            <b>ref</b> <span class="i">Type</span> <span id="r222 rd" class="r222 r">localsTupleType</span>)
        {
            <b>object</b> <span id="r223 rd" class="r223 r">constantValue</span>;
            <b>if</b> (<a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<a href="ConstantValues.cs.html#594e7e13f898b0a1" class="i method">IsConstant</a>(<span class="r215 r">expressionAst</span>, <b>out</b> <span class="r223 r">constantValue</span>))
            {
                <b>return</b> <span class="r223 r">constantValue</span>;
            }
 
            <span class="c">// If this isn&#39;t trusted input, then just return.</span>
            <b>if</b> (!<span class="r216 r">isTrustedInput</span>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="c">// Can&#39;t be exposed to untrusted input - exposing private variable names / etc. could be</span>
            <span class="c">// information disclosure.</span>
            <a href="ast.cs.html#248562b22b336dec" class="k">var</a> <span id="r224 rd" class="r224 r">variableAst</span> = <span class="r215 r">expressionAst</span> <b>as</b> <a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>;
            <b>if</b> (<span class="r224 r">variableAst</span> != <b>null</b>)
            {
                <span class="c">// We can avoid creating a lambda for the common case of a simple variable expression.</span>
                <b>return</b> <a href="../runtime/Operations/VariableOps.cs.html#d5ccea9fa7bfb556" class="t t">VariableOps</a>.<a href="../runtime/Operations/VariableOps.cs.html#95ebbb7039f5ef2d" class="i method">GetVariableValue</a>(<span class="r224 r">variableAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>, <span class="r217 r">context</span>, <span class="r224 r">variableAst</span>);
            }
 
            <span class="c">// Can&#39;t be exposed to untrusted input - invoking arbitrary code could result in remote code</span>
            <span class="c">// execution.</span>
            <b>if</b> (<span class="r220 r">lambda</span> == <b>null</b>)
            {
                <span class="r220 r">lambda</span> = (<b>new</b> <a href="#b6cc6d8d9723112a" class="t constructor">Compiler</a>()).<a href="#654c4ea4773b40bd" class="i method">CompileSingleExpression</a>(<span class="r215 r">expressionAst</span>, <b>out</b> <span class="r221 r">sequencePoints</span>, <b>out</b> <span class="r222 r">localsTupleType</span>);
            }
 
            <a href="../../P/2dc1bd90a8299178.html#2dc1bd90a8299178" class="t t">SessionStateInternal</a> <span id="r225 rd" class="r225 r">oldSessionState</span> = <span class="r217 r">context</span>.<a href="../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a>;
            <b>try</b>
            {
                <b>if</b> (<span class="r218 r">sessionStateInternal</span> != <b>null</b> &amp;&amp; <span class="r217 r">context</span>.<a href="../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a> != <span class="r218 r">sessionStateInternal</span>)
                {
                    <span class="c">// If we&#39;re running a function from a module, we need to evaluate the initializers in the</span>
                    <span class="c">// module context, not the callers context...</span>
                    <span class="r217 r">context</span>.<a href="../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a> = <span class="r218 r">sessionStateInternal</span>;
                }
 
                <b>var</b> <span id="r226 rd" class="r226 r">resultList</span> = <b>new</b> <span class="i">List</span>&lt;<b>object</b>&gt;();
                <a href="../Pipe.cs.html#59f1a03e60a5aa51" class="k">var</a> <span id="r227 rd" class="r227 r">pipe</span> = <b>new</b> <a href="../Pipe.cs.html#99288ee09b9642bb" class="t constructor">Pipe</a>(<span class="r226 r">resultList</span>);
                <b>try</b>
                {
                    <a href="#aa4ec5dd36f7e2eb" class="k">var</a> <span id="r228 rd" class="r228 r">functionContext</span> = <b>new</b> <span class="t">FunctionContext</span>
                    {
                        <a href="#354889e302c1693c" class="i field">_sequencePoints</a> = <span class="r221 r">sequencePoints</span>,
                        <a href="#86d08ccdd0602a1b" class="i field">_executionContext</a> = <span class="r217 r">context</span>,
                        <a href="#95a73081cffaa015" class="i field">_file</a> = <span class="r215 r">expressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#e933edecd2b0cc1d" class="i property">File</a>,
                        <a href="#6c44d518392049f0" class="i field">_outputPipe</a> = <span class="r227 r">pipe</span>,
                        <a href="#23a9d5ac6a3b086b" class="i field">_localsTuple</a> = <a href="../runtime/MutableTuple.cs.html#d4c692d6a8bac31d" class="t t">MutableTuple</a>.<a href="../runtime/MutableTuple.cs.html#32166b6659de79e2" class="i method">MakeTuple</a>(<span class="r222 r">localsTupleType</span>, <a href="#8a3b323becd5e9eb" class="i field">DottedLocalsNameIndexMap</a>)
                    };
                    <b>if</b> (<span class="r219 r">usingValues</span> != <b>null</b>)
                    {
                        <a href="../ParameterBinderBase.cs.html#9382e45706fdb782" class="k">var</a> <span id="r229 rd" class="r229 r">boundParameters</span> = <b>new</b> <a href="../ParameterBinderBase.cs.html#ba0fe6b0a6fa9eab" class="t constructor">PSBoundParametersDictionary</a> { <a href="../ParameterBinderBase.cs.html#a1b19c52ca59759e" class="i property">ImplicitUsingParameters</a> = <span class="r219 r">usingValues</span> };
                        <span class="r228 r">functionContext</span>.<a href="#23a9d5ac6a3b086b" class="i field">_localsTuple</a>.<a href="../runtime/MutableTuple.cs.html#b596dd33aa0e3dbc" class="i method">SetAutomaticVariable</a>(<a href="../SpecialVariables.cs.html#1c6f2efd91287b59" class="t t">AutomaticVariable</a>.<a href="../SpecialVariables.cs.html#93a934b8cba4991e" class="i field">PSBoundParameters</a>, <span class="r229 r">boundParameters</span>, <span class="r217 r">context</span>);
                    }
 
                    <b>var</b> <span id="r230 rd" class="r230 r">result</span> = <span class="r220 r">lambda</span>(<span class="r228 r">functionContext</span>);
                    <b>if</b> (<span class="r230 r">result</span> == <a href="../AutomationNull.cs.html#681fbea4c40e4af1" class="t t">AutomationNull</a>.<a href="../AutomationNull.cs.html#1cf7e193da582896" class="i property">Value</a>)
                    {
                        <b>return</b> <span class="r226 r">resultList</span>.<span class="i">Count</span> == 0 ? <b>null</b> : <a href="../runtime/Operations/MiscOps.cs.html#533f892ba25eaa2f" class="t t">PipelineOps</a>.<a href="../runtime/Operations/MiscOps.cs.html#fc7796c24644bad1" class="i method">PipelineResult</a>(<span class="r226 r">resultList</span>);
                    }
 
                    <b>return</b> <span class="r230 r">result</span>;
                }
                <b>catch</b> (<span class="i">TargetInvocationException</span> <span id="r231 rd" class="r231 r">tie</span>)
                {
                    <b>throw</b> <span class="r231 r">tie</span>.<span class="i">InnerException</span>;
                }
            }
            <b>catch</b> (<a href="../lang/parserutils.cs.html#4ea179424ce76612" class="t t">TerminateException</a>)
            {
                <span class="c">// the debugger is terminating the execution; bubble up the exception</span>
                <b>throw</b>;
            }
            <b>catch</b> (<a href="../lang/parserutils.cs.html#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>)
            {
                <span class="c">// ignore break, continue and return exceptions</span>
                <b>return</b> <b>null</b>;
            }
            <b>finally</b>
            {
                <span class="r217 r">context</span>.<a href="../ExecutionContext.cs.html#07982205e4a6a726" class="i property">EngineSessionState</a> = <span class="r225 r">oldSessionState</span>;
            }
        }
 
        <b>private</b> <span class="i">Func</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>, <b>object</b>&gt; <a id="654c4ea4773b40bd" href="../../R/654c4ea4773b40bd.html" target="n" data-glyph="76,1" class="i method">CompileSingleExpression</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r232 rd" class="r232 r">expressionAst</span>, <b>out</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>[] <span id="r233 rd" class="r233 r">sequencePoints</span>, <b>out</b> <span class="i">Type</span> <span id="r234 rd" class="r234 r">localsTupleType</span>)
        {
            <a href="#57ac2e55a5b17eb3" class="i property">Optimize</a> = <b>false</b>;
            <a href="#3133d55c945a52aa" class="i field">_compilingSingleExpression</a> = <b>true</b>;
 
            <b>var</b> <span id="r235 rd" class="r235 r">details</span> = <a href="VariableAnalysis.cs.html#3d310869db3a3b73" class="t t">VariableAnalysis</a>.<a href="VariableAnalysis.cs.html#a502acc6e8971360" class="i method">AnalyzeExpression</a>(<span class="r232 r">expressionAst</span>);
            <a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a> = <span class="r234 r">localsTupleType</span> = <span class="r235 r">details</span>.<span class="i">Item1</span>;
            <a href="#60079b222ae29e0d" class="i property">LocalVariablesParameter</a> = <span class="i">Expression</span>.<span class="i">Variable</span>(<a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a>, <span class="s">&quot;locals&quot;</span>);
            <a href="#6f06eb7483b8e7f7" class="i field">_returnTarget</a> = <span class="i">Expression</span>.<span class="i">Label</span>(<b>typeof</b>(<b>object</b>), <span class="s">&quot;returnTarget&quot;</span>);
            <a href="#4b32d559427de642" class="i field">_loopTargets</a>.<span class="i">Clear</span>();
 
            <b>var</b> <span id="r236 rd" class="r236 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <b>var</b> <span id="r237 rd" class="r237 r">temps</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt; { <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>, <a href="#60079b222ae29e0d" class="i property">LocalVariablesParameter</a> };
            <a href="#8dcc6e6589206af3" class="i method">GenerateFunctionProlog</a>(<span class="r236 r">exprs</span>, <span class="r237 r">temps</span>, <b>null</b>);
            <b>int</b> <span id="r238 rd" class="r238 r">index</span> = <a href="#319aa081bb450665" class="i method">AddSequencePoint</a>(<span class="r232 r">expressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>);
            <span class="r236 r">exprs</span>.<span class="i">Add</span>(<b>new</b> <a href="#0c9779f3c88dad20" class="t constructor">UpdatePositionExpr</a>(<span class="r232 r">expressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r238 r">index</span>, <a href="#2807a84cb0b61e38" class="i field">_debugSymbolDocument</a>, <span class="r239 r">checkBreakpoints</span>: <b>true</b>));
            <b>var</b> <span id="r240 rd" class="r240 r">result</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r232 r">expressionAst</span>).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>));
            <span class="r236 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<a href="#6f06eb7483b8e7f7" class="i field">_returnTarget</a>, <span class="r240 r">result</span>));
            <b>var</b> <span id="r241 rd" class="r241 r">body</span> = <span class="i">Expression</span>.<span class="i">Block</span>(<b>new</b>[] { <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>, <a href="#60079b222ae29e0d" class="i property">LocalVariablesParameter</a> }, <span class="r236 r">exprs</span>);
            <b>var</b> <span id="r242 rd" class="r242 r">parameters</span> = <b>new</b>[] { <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a> };
            <span class="r233 r">sequencePoints</span> = <a href="#be6f1ba488dac21b" class="i field">_sequencePoints</a>.<span class="i">ToArray</span>();
            <b>return</b> <span class="i">Expression</span>.<span class="i">Lambda</span>&lt;<span class="i">Func</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>, <b>object</b>&gt;&gt;(<span class="r241 r">body</span>, <span class="r242 r">parameters</span>).<span class="i">Compile</span>();
        }
 
        <b>private sealed class</b> <a id="e1dd4df3a5568da8" href="../../R/e1dd4df3a5568da8.html" target="n" data-glyph="4,1" class="t t">LoopGotoTargets</a>
        {
            <b>internal</b> <a id="6cc69c6fe295835f" href="../../R/../../0000000000.html" target="n" data-glyph="74,2" class="t constructor">LoopGotoTargets</a>(<b>string</b> <span id="r243 rd" class="r243 r">label</span>, <span class="i">LabelTarget</span> <span id="r244 rd" class="r244 r">breakLabel</span>, <span class="i">LabelTarget</span> <span id="r245 rd" class="r245 r">continueLabel</span>)
            {
                <a href="#e1dd4df3a5568da8" class="k">this</a>.<a href="#a0977a4080405078" class="i property">Label</a> = <span class="r243 r">label</span>;
                <a href="#e1dd4df3a5568da8" class="k">this</a>.<a href="#c667ebefe7a347b5" class="i property">BreakLabel</a> = <span class="r244 r">breakLabel</span>;
                <a href="#e1dd4df3a5568da8" class="k">this</a>.<a href="#0c0c16247bb72edc" class="i property">ContinueLabel</a> = <span class="r245 r">continueLabel</span>;
            }
 
            <b>internal string</b> <a id="a0977a4080405078" href="../../R/a0977a4080405078.html" target="n" data-glyph="104,2" class="i property">Label</a> { <b>get</b>; }
 
            <b>internal</b> <span class="i">LabelTarget</span> <a id="0c0c16247bb72edc" href="../../R/0c0c16247bb72edc.html" target="n" data-glyph="104,2" class="i property">ContinueLabel</a> { <b>get</b>; }
 
            <b>internal</b> <span class="i">LabelTarget</span> <a id="c667ebefe7a347b5" href="../../R/c667ebefe7a347b5.html" target="n" data-glyph="104,2" class="i property">BreakLabel</a> { <b>get</b>; }
        }
 
        <b>private</b> <span class="i">LabelTarget</span> <a id="6f06eb7483b8e7f7" href="../../R/6f06eb7483b8e7f7.html" target="n" data-glyph="46,1" class="i field">_returnTarget</a>;
        <b>private</b> <span class="i">Expression</span>&lt;<span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;&gt; <a id="4974fd3aa1eb9d4c" href="../../R/4974fd3aa1eb9d4c.html" target="n" data-glyph="46,1" class="i field">_dynamicParamBlockLambda</a>;
        <b>private</b> <span class="i">Expression</span>&lt;<span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;&gt; <a id="8cf5db88793d4ed0" href="../../R/8cf5db88793d4ed0.html" target="n" data-glyph="46,1" class="i field">_beginBlockLambda</a>;
        <b>private</b> <span class="i">Expression</span>&lt;<span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;&gt; <a id="7427d7f613b45375" href="../../R/7427d7f613b45375.html" target="n" data-glyph="46,1" class="i field">_processBlockLambda</a>;
        <b>private</b> <span class="i">Expression</span>&lt;<span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;&gt; <a id="da90e7d280e40a9b" href="../../R/da90e7d280e40a9b.html" target="n" data-glyph="46,1" class="i field">_endBlockLambda</a>;
 
        <b>private readonly</b> <span class="i">List</span>&lt;<a href="#e1dd4df3a5568da8" class="t t">LoopGotoTargets</a>&gt; <a id="4b32d559427de642" href="../../R/4b32d559427de642.html" target="n" data-glyph="46,1" class="i field">_loopTargets</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#e1dd4df3a5568da8" class="t t">LoopGotoTargets</a>&gt;();
        <b>private bool</b> <a id="71764a6db953172b" href="../../R/71764a6db953172b.html" target="n" data-glyph="46,1" class="i field">_generatingWhileOrDoLoop</a>;
 
        <b>private enum</b> <a id="da8abc3dab8cdcf2" href="../../R/da8abc3dab8cdcf2.html" target="n" data-glyph="22,1" class="t t"><span id="89a6a0d4d74aaf0d">CaptureAstContext</span></a>
        {
            <a id="2ae33340eb67d1d1" href="../../R/2ae33340eb67d1d1.html" target="n" data-glyph="24,2" class="i field">Condition</a>,
            <a id="052596a192f2302b" href="../../R/052596a192f2302b.html" target="n" data-glyph="24,2" class="i field">Enumerable</a>,
            <a id="8ca51373a8261dd1" href="../../R/8ca51373a8261dd1.html" target="n" data-glyph="24,2" class="i field">AssignmentWithResultPreservation</a>,
            <a id="a62dd487e94fcb40" href="../../R/a62dd487e94fcb40.html" target="n" data-glyph="24,2" class="i field">AssignmentWithoutResultPreservation</a>
        }
 
        <b>private delegate void</b> <a id="017a41e3db42549c" href="../../R/017a41e3db42549c.html" target="n" data-glyph="16,1" class="t t"><span id="d44f301706d3d6f1">MergeRedirectExprs</span></a>(<span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r246 rd" class="r246 r">exprs</span>, <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r247 rd" class="r247 r">finallyExprs</span>);
 
        <b>private</b> <span class="i">Expression</span> <a id="a57518533e3fe99b" href="../../R/a57518533e3fe99b.html" target="n" data-glyph="76,1" class="i method">CaptureAstResults</a>(
            <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r248 rd" class="r248 r">ast</span>,
            <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a> <span id="r249 rd" class="r249 r">context</span>,
            <a href="#017a41e3db42549c" class="t t">MergeRedirectExprs</a> <span id="r250 rd" class="r250 r">generateRedirectExprs</span> = <b>null</b>)
        {
            <span class="i">Expression</span> <span id="r251 rd" class="r251 r">result</span>;
 
            <span class="c">// We&#39;ll generate code like:</span>
            <span class="c">//  try {</span>
            <span class="c">//    oldPipe = funcContext.OutputPipe;</span>
            <span class="c">//    resultList = new List&lt;object&gt;();</span>
            <span class="c">//    resultListPipe = new Pipe(resultList);</span>
            <span class="c">//    funcContext.OutputPipe = resultListPipe;</span>
            <span class="c">//    &lt;optionally add merge redirection expressions&gt;</span>
            <span class="c">//    expression...</span>
            <span class="c">//  } finally {</span>
            <span class="c">//    FlushPipe(oldPipe, resultList);</span>
            <span class="c">//    funcContext.OutputPipe = oldPipe;</span>
            <span class="c">//  }</span>
            <span class="c">//</span>
            <b>var</b> <span id="r252 rd" class="r252 r">temps</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt;();
            <b>var</b> <span id="r253 rd" class="r253 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <b>var</b> <span id="r254 rd" class="r254 r">catches</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">CatchBlock</span>&gt;();
            <b>var</b> <span id="r255 rd" class="r255 r">finallyExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
 
            <b>var</b> <span id="r256 rd" class="r256 r">oldPipe</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<a href="../Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a>), <span class="s">&quot;oldPipe&quot;</span>);
            <b>var</b> <span id="r257 rd" class="r257 r">resultList</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<span class="i">List</span>&lt;<b>object</b>&gt;), <span class="s">&quot;resultList&quot;</span>);
            <span class="r252 r">temps</span>.<span class="i">Add</span>(<span class="r257 r">resultList</span>);
            <span class="r252 r">temps</span>.<span class="i">Add</span>(<span class="r256 r">oldPipe</span>);
            <span class="r253 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r256 r">oldPipe</span>, <a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>));
            <span class="r253 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r257 r">resultList</span>, <span class="i">Expression</span>.<span class="i">New</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#c2ed1032888972a2" class="i field">ObjectList_ctor</a>)));
            <span class="r253 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>, <span class="i">Expression</span>.<span class="i">New</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#ec27b92751d03933" class="i field">Pipe_ctor</a>, <span class="r257 r">resultList</span>)));
            <span class="r253 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Call</span>(<span class="r256 r">oldPipe</span>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#252b3e0e32bf12b9" class="i field">Pipe_SetVariableListForTemporaryPipe</a>, <a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>));
 
            <span class="c">// Add merge redirection expressions if delegate is provided.</span>
            <span class="r250 r">generateRedirectExprs</span>?.<a href="#b35c6802cf50e50b" class="i method">Invoke</a>(<span class="r253 r">exprs</span>, <span class="r255 r">finallyExprs</span>);
 
            <span class="r253 r">exprs</span>.<span class="i">Add</span>(<a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r248 r">ast</span>));
 
            <b>switch</b> (<span class="r249 r">context</span>)
            {
                <b>case</b> <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#8ca51373a8261dd1" class="i field">AssignmentWithResultPreservation</a>:
                <b>case</b> <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>:
                    <span class="r251 r">result</span> = <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#f6995ac2d8b37cdd" class="i field">PipelineOps_PipelineResult</a>, <span class="r257 r">resultList</span>);
 
                    <span class="c">// Clear the temporary pipe in case of exception, if we are not required to preserve the results</span>
                    <b>if</b> (<span class="r249 r">context</span> == <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>)
                    {
                        <b>var</b> <span id="r258 rd" class="r258 r">catchExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;
                                         {
                                             <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#32a3b87e98bb20e1" class="i field">PipelineOps_ClearPipe</a>, <span class="r257 r">resultList</span>),
                                             <span class="i">Expression</span>.<span class="i">Rethrow</span>(),
                                             <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<b>object</b>))
                                         };
 
                        <span class="r254 r">catches</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Catch</span>(<b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="i">Expression</span>.<span class="i">Block</span>(<b>typeof</b>(<b>object</b>), <span class="r258 r">catchExprs</span>)));
                    }
 
                    <span class="c">// PipelineResult might get skipped in some circumstances due to a FlowControlException thrown out, in which case</span>
                    <span class="c">// we write to the oldPipe. This can happen in cases like:</span>
                    <span class="c">//     $(1;2;return 3)</span>
                    <span class="r255 r">finallyExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#95dfa6e24fac1473" class="i field">PipelineOps_FlushPipe</a>, <span class="r256 r">oldPipe</span>, <span class="r257 r">resultList</span>));
                    <b>break</b>;
                <b>case</b> <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#2ae33340eb67d1d1" class="i field">Condition</a>:
                    <span class="r251 r">result</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#41db08c5cb57ba77" class="t t">PSPipelineResultToBoolBinder</a>.<a href="../runtime/Binding/Binders.cs.html#3a8ed25018fec703" class="i method">Get</a>(), <b>typeof</b>(<b>bool</b>), <span class="r257 r">resultList</span>);
                    <b>break</b>;
                <b>case</b> <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#052596a192f2302b" class="i field">Enumerable</a>:
                    <span class="r251 r">result</span> = <span class="r257 r">resultList</span>;
                    <b>break</b>;
                <b>default</b>:
                    <b>throw</b> <b>new</b> <span class="i">ArgumentOutOfRangeException</span>(<b>nameof</b>(<span class="r249 r">context</span>));
            }
 
            <span class="r255 r">finallyExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>, <span class="r256 r">oldPipe</span>));
            <span class="r253 r">exprs</span>.<span class="i">Add</span>(<span class="r251 r">result</span>);
 
            <b>if</b> (<span class="r254 r">catches</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(
                    <span class="r252 r">temps</span>.<span class="i">ToArray</span>(),
                    <span class="i">Expression</span>.<span class="i">TryCatchFinally</span>(
                        <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r253 r">exprs</span>),
                        <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r255 r">finallyExprs</span>),
                        <span class="r254 r">catches</span>.<span class="i">ToArray</span>()));
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(
                    <span class="r252 r">temps</span>.<span class="i">ToArray</span>(),
                    <span class="i">Expression</span>.<span class="i">TryFinally</span>(
                        <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r253 r">exprs</span>),
                        <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r255 r">finallyExprs</span>)));
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="8eeb0b1d71700eac" href="../../R/8eeb0b1d71700eac.html" target="n" data-glyph="76,1" class="i method">CaptureStatementResultsHelper</a>(
            <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r259 rd" class="r259 r">stmt</span>,
            <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a> <span id="r260 rd" class="r260 r">context</span>,
            <a href="#017a41e3db42549c" class="t t">MergeRedirectExprs</a> <span id="r261 rd" class="r261 r">generateRedirectExprs</span>)
        {
            <a href="ast.cs.html#f4da818a29387c5d" class="k">var</a> <span id="r262 rd" class="r262 r">commandExpressionAst</span> = <span class="r259 r">stmt</span> <b>as</b> <a href="ast.cs.html#f4da818a29387c5d" class="t t">CommandExpressionAst</a>;
            <b>if</b> (<span class="r262 r">commandExpressionAst</span> != <b>null</b>)
            {
                <b>if</b> (<span class="r262 r">commandExpressionAst</span>.<a href="ast.cs.html#7d87854c277c8363" class="i property">Redirections</a>.<span class="i">Count</span> &gt; 0)
                {
                    <b>return</b> <a href="#14a0a997f6484957" class="i method">GetRedirectedExpression</a>(<span class="r262 r">commandExpressionAst</span>, <span class="r263 r">captureForInput</span>: <b>true</b>);
                }
 
                <b>return</b> <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r262 r">commandExpressionAst</span>.<a href="ast.cs.html#5e5388d1f86139f7" class="i property">Expression</a>);
            }
 
            <a href="ast.cs.html#da5f345864f42e06" class="k">var</a> <span id="r264 rd" class="r264 r">assignmentStatementAst</span> = <span class="r259 r">stmt</span> <b>as</b> <a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a>;
            <b>if</b> (<span class="r264 r">assignmentStatementAst</span> != <b>null</b>)
            {
                <b>var</b> <span id="r265 rd" class="r265 r">expr</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r264 r">assignmentStatementAst</span>);
                <b>if</b> (<span class="r259 r">stmt</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is</b> <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a>)
                {
                    <span class="r265 r">expr</span> = <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r265 r">expr</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>);
                }
 
                <b>return</b> <span class="r265 r">expr</span>;
            }
 
            <a href="ast.cs.html#785915ec8547ce9f" class="k">var</a> <span id="r266 rd" class="r266 r">pipelineAst</span> = <span class="r259 r">stmt</span> <b>as</b> <a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a>;
            <span class="c">// If it&#39;s a pipeline that isn&#39;t being backgrounded, try to optimize expression</span>
            <b>if</b> (<span class="r266 r">pipelineAst</span> != <b>null</b> &amp;&amp; !<span class="r266 r">pipelineAst</span>.<a href="ast.cs.html#552590fec9ffecb9" class="i property">Background</a>)
            {
                <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r267 rd" class="r267 r">expr</span> = <span class="r266 r">pipelineAst</span>.<a href="ast.cs.html#df65de159259e5e0" class="i method">GetPureExpression</a>();
                <b>if</b> (<span class="r267 r">expr</span> != <b>null</b>)
                {
                    <b>return</b> <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r267 r">expr</span>);
                }
            }
 
            <b>return</b> <a href="#a57518533e3fe99b" class="i method">CaptureAstResults</a>(<span class="r259 r">stmt</span>, <span class="r260 r">context</span>, <span class="r261 r">generateRedirectExprs</span>);
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="fed19bee56918521" href="../../R/fed19bee56918521.html" target="n" data-glyph="76,1" class="i method">CaptureStatementResults</a>(
            <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r268 rd" class="r268 r">stmt</span>,
            <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a> <span id="r269 rd" class="r269 r">context</span>,
            <a href="#017a41e3db42549c" class="t t">MergeRedirectExprs</a> <span id="r270 rd" class="r270 r">generateRedirectExprs</span> = <b>null</b>)
        {
            <b>var</b> <span id="r271 rd" class="r271 r">result</span> = <a href="#8eeb0b1d71700eac" class="i method">CaptureStatementResultsHelper</a>(<span class="r268 r">stmt</span>, <span class="r269 r">context</span>, <span class="r270 r">generateRedirectExprs</span>);
 
            <span class="c">// If we&#39;re generating code for a condition and the condition contains some command invocation,</span>
            <span class="c">// we want to be sure that $? is set to true even if the condition fails, e.g.:</span>
            <span class="c">//     if (get-command foo -ea SilentlyContinue) { foo }</span>
            <span class="c">//     $?  # never $false here</span>
            <span class="c">// Many conditions don&#39;t invoke commands though, and in trivial empty loops, setting $? = $true</span>
            <span class="c">// does have a measurable impact, so only set $? = $true if the condition might change $? to $false.</span>
            <span class="c">// We do this after evaluating the condition so that you could do something like:</span>
            <span class="c">//    if ((dir file1,file2 -ea SilentlyContinue) -and $?) { &lt;# files both exist, otherwise $? would be $false if 0 or 1 files existed #&gt; }</span>
            <span class="c">//</span>
            <b>if</b> (<span class="r269 r">context</span> == <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#2ae33340eb67d1d1" class="i field">Condition</a> &amp;&amp; <a href="AstVisitor.cs.html#5298c9a8d6287f90" class="t t">AstSearcher</a>.<span class="i">FindFirst</span>(<span class="r268 r">stmt</span>, <b>static</b> <span id="r272 rd" class="r272 r">ast</span> =&gt; <span class="r272 r">ast</span> <b>is</b> <a href="ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>, <span class="i">searchNestedScriptBlocks</span>: <b>false</b>) != <b>null</b>)
            {
                <b>var</b> <span id="r273 rd" class="r273 r">tmp</span> = <span class="i">NewTemp</span>(<span class="r271 r">result</span>.<span class="i">Type</span>, <span class="s">&quot;condTmp&quot;</span>);
                <span class="r271 r">result</span> = <span class="i">Expression</span>.<span class="i">Block</span>(
                    <b>new</b>[] { <span class="r273 r">tmp</span> },
                    <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r273 r">tmp</span>, <span class="r271 r">result</span>),
                    <a href="#569b451340efd095" class="i field">s_setDollarQuestionToTrue</a>,
                    <span class="r273 r">tmp</span>);
            }
 
            <b>return</b> <span class="r271 r">result</span>;
        }
 
        <b>internal</b> <span class="i">Expression</span> <a id="fd7d0a43cbb942fa" href="../../R/fd7d0a43cbb942fa.html" target="n" data-glyph="74,1" class="i method">CallAddPipe</a>(<span class="i">Expression</span> <span id="r274 rd" class="r274 r">expr</span>, <span class="i">Expression</span> <span id="r275 rd" class="r275 r">pipe</span>)
        {
            <b>if</b> (!<a href="../runtime/Binding/Binders.cs.html#e3fd1907f899e2b7" class="t t">PSEnumerableBinder</a>.<span class="i">IsStaticTypePossiblyEnumerable</span>(<span class="r274 r">expr</span>.<span class="i">Type</span>))
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(<span class="r275 r">pipe</span>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#ef3aead21a321eba" class="i field">Pipe_Add</a>, <span class="r274 r">expr</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)));
            }
 
            <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#419edde3d12cfa53" class="t t">PSPipeWriterBinder</a>.<a href="../runtime/Binding/Binders.cs.html#6673eb761c739fa1" class="i method">Get</a>(), <b>typeof</b>(<b>void</b>), <span class="r274 r">expr</span>, <span class="r275 r">pipe</span>, <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>);
        }
 
        <b>public object</b> <a id="e207ab7ff18f9db2" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitErrorStatement</a>(<a href="ast.cs.html#e02a155b7afded8b" class="t t">ErrorStatementAst</a> <span id="r276 rd" class="r276 r">errorStatementAst</span>)
        {
            <b>return</b> <b>null</b>;
        }
 
        <b>public object</b> <a id="0f9fa9102aa2478f" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitErrorExpression</a>(<a href="ast.cs.html#bdf2b3276843e0c2" class="t t">ErrorExpressionAst</a> <span id="r277 rd" class="r277 r">errorExpressionAst</span>)
        {
            <b>return</b> <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(1);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Script Blocks
 
        <b>public object</b> <a id="24e130172048380e" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitScriptBlock</a>(<a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r278 rd" class="r278 r">scriptBlockAst</span>)
        {
            <a href="ast.cs.html#dd61b2a7b388405b" class="k">var</a> <span id="r279 rd" class="r279 r">funcDefn</span> = <span class="r278 r">scriptBlockAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a>;
            <b>var</b> <span id="r280 rd" class="r280 r">funcName</span> = (<span class="r279 r">funcDefn</span> != <b>null</b>) ? <span class="r279 r">funcDefn</span>.<a href="ast.cs.html#951cc91108156df0" class="i property">Name</a> : <span class="s">&quot;&lt;ScriptBlock&gt;&quot;</span>;
 
            <a href="ast.cs.html#6f963589327835a4" class="k">var</a> <span id="r281 rd" class="r281 r">rootForDefiningTypesAndUsings</span> = <span class="r278 r">scriptBlockAst</span>.<span class="i">Find</span>(<b>static</b> <span id="r282 rd" class="r282 r">ast</span> =&gt; <span class="r282 r">ast</span> <b>is</b> <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> || <span class="r282 r">ast</span> <b>is</b> <a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a>, <b>true</b>) != <b>null</b>
                ? <span class="r278 r">scriptBlockAst</span>
                : <b>null</b>;
 
            <b>if</b> (<span class="r278 r">scriptBlockAst</span>.<a href="ast.cs.html#4549d1761658a004" class="i property">DynamicParamBlock</a> != <b>null</b>)
            {
                <a href="#4974fd3aa1eb9d4c" class="i field">_dynamicParamBlockLambda</a> = <span class="i">CompileNamedBlock</span>(<span class="r278 r">scriptBlockAst</span>.<a href="ast.cs.html#4549d1761658a004" class="i property">DynamicParamBlock</a>, <span class="r280 r">funcName</span> + <span class="s">&quot;&lt;DynamicParam&gt;&quot;</span>, <span class="r281 r">rootForDefiningTypesAndUsings</span>);
                <span class="r281 r">rootForDefiningTypesAndUsings</span> = <b>null</b>;
            }
 
            <span class="c">// Skip param block - nothing to generate, defaults get generated when generating parameter metadata.</span>
            <b>if</b> (<span class="r278 r">scriptBlockAst</span>.<a href="ast.cs.html#08794a618a2d04ac" class="i property">BeginBlock</a> != <b>null</b>)
            {
                <a href="#8cf5db88793d4ed0" class="i field">_beginBlockLambda</a> = <span class="i">CompileNamedBlock</span>(<span class="r278 r">scriptBlockAst</span>.<a href="ast.cs.html#08794a618a2d04ac" class="i property">BeginBlock</a>, <span class="r280 r">funcName</span> + <span class="s">&quot;&lt;Begin&gt;&quot;</span>, <span class="r281 r">rootForDefiningTypesAndUsings</span>);
                <span class="r281 r">rootForDefiningTypesAndUsings</span> = <b>null</b>;
            }
 
            <b>if</b> (<span class="r278 r">scriptBlockAst</span>.<a href="ast.cs.html#8940fb8f9b3e6444" class="i property">ProcessBlock</a> != <b>null</b>)
            {
                <b>var</b> <span id="r283 rd" class="r283 r">processFuncName</span> = <span class="r280 r">funcName</span>;
                <b>if</b> (!<span class="r278 r">scriptBlockAst</span>.<a href="ast.cs.html#8940fb8f9b3e6444" class="i property">ProcessBlock</a>.<a href="ast.cs.html#4b76ccd3ee5695b7" class="i property">Unnamed</a>)
                {
                    <span class="r283 r">processFuncName</span> = <span class="r280 r">funcName</span> + <span class="s">&quot;&lt;Process&gt;&quot;</span>;
                }
 
                <a href="#7427d7f613b45375" class="i field">_processBlockLambda</a> = <a href="#67abed8feabba0f7" class="i method">CompileNamedBlock</a>(<span class="r278 r">scriptBlockAst</span>.<a href="ast.cs.html#8940fb8f9b3e6444" class="i property">ProcessBlock</a>, <span class="r283 r">processFuncName</span>, <span class="r281 r">rootForDefiningTypesAndUsings</span>);
                <span class="r281 r">rootForDefiningTypesAndUsings</span> = <b>null</b>;
            }
 
            <b>if</b> (<span class="r278 r">scriptBlockAst</span>.<a href="ast.cs.html#958e631868900aba" class="i property">EndBlock</a> != <b>null</b>)
            {
                <b>if</b> (!<span class="r278 r">scriptBlockAst</span>.<a href="ast.cs.html#958e631868900aba" class="i property">EndBlock</a>.<a href="ast.cs.html#4b76ccd3ee5695b7" class="i property">Unnamed</a>)
                {
                    <span class="r280 r">funcName</span> += <span class="s">&quot;&lt;End&gt;&quot;</span>;
                }
 
                <a href="#da90e7d280e40a9b" class="i field">_endBlockLambda</a> = <a href="#67abed8feabba0f7" class="i method">CompileNamedBlock</a>(<span class="r278 r">scriptBlockAst</span>.<a href="ast.cs.html#958e631868900aba" class="i property">EndBlock</a>, <span class="r280 r">funcName</span>, <span class="r281 r">rootForDefiningTypesAndUsings</span>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private</b> <span class="i">Expression</span>&lt;<span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;&gt; <a id="67abed8feabba0f7" href="../../R/67abed8feabba0f7.html" target="n" data-glyph="76,1" class="i method">CompileNamedBlock</a>(<a href="ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r284 rd" class="r284 r">namedBlockAst</span>, <b>string</b> <span id="r285 rd" class="r285 r">funcName</span>, <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r286 rd" class="r286 r">rootForDefiningTypes</span>)
        {
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r287 rd" class="r287 r">entryExtent</span> = <b>null</b>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r288 rd" class="r288 r">exitExtent</span> = <b>null</b>;
            <b>if</b> (<span class="r284 r">namedBlockAst</span>.<a href="ast.cs.html#4b76ccd3ee5695b7" class="i property">Unnamed</a>)
            {
                <span class="c">// Get extent from the function or scriptblock expression parent, if any.</span>
                <a href="ast.cs.html#6f963589327835a4" class="k">var</a> <span id="r289 rd" class="r289 r">scriptBlock</span> = (<a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a>)<span class="r284 r">namedBlockAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a>;
                <b>if</b> (<span class="r289 r">scriptBlock</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> != <b>null</b> &amp;&amp; <span class="r289 r">scriptBlock</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a> <b>is</b> <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)
                {
                    <span class="c">// We must have curlies at the start/end.</span>
                    <a href="Position.cs.html#a988805453837004" class="k">var</a> <span id="r290 rd" class="r290 r">scriptExtent</span> = (<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<span class="r289 r">scriptBlock</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                    <span class="r287 r">entryExtent</span> = <b>new</b> <span class="t">InternalScriptExtent</span>(<span class="r290 r">scriptExtent</span>.<a href="Position.cs.html#efcbc0d78353af5a" class="i property">PositionHelper</a>, <span class="r290 r">scriptExtent</span>.<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a>, <span class="r290 r">scriptExtent</span>.<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a> + 1);
                    <span class="r288 r">exitExtent</span> = <b>new</b> <span class="t">InternalScriptExtent</span>(<span class="r290 r">scriptExtent</span>.<a href="Position.cs.html#efcbc0d78353af5a" class="i property">PositionHelper</a>, <span class="r290 r">scriptExtent</span>.<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a> - 1, <span class="r290 r">scriptExtent</span>.<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a>);
                }
            }
            <b>else</b>
            {
                <span class="r287 r">entryExtent</span> = <span class="r284 r">namedBlockAst</span>.<a href="ast.cs.html#8ddb2aaad2172b52" class="i property">OpenCurlyExtent</a>;
                <span class="r288 r">exitExtent</span> = <span class="r284 r">namedBlockAst</span>.<a href="ast.cs.html#93f6b4a0e3e6cc04" class="i property">CloseCurlyExtent</a>;
            }
 
            <b>return</b> <a href="#40e15f6ec6046ca8" class="i method">CompileSingleLambda</a>(<span class="r284 r">namedBlockAst</span>.<a href="ast.cs.html#496f71fcd5c4e6a1" class="i property">Statements</a>, <span class="r284 r">namedBlockAst</span>.<a href="ast.cs.html#2b645ddd993169db" class="i property">Traps</a>, <span class="r285 r">funcName</span>, <span class="r287 r">entryExtent</span>, <span class="r288 r">exitExtent</span>, <span class="r286 r">rootForDefiningTypes</span>);
        }
 
        <b>private</b> <span class="i">Tuple</span>&lt;<span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;, <span class="i">Type</span>&gt; <a id="62811ccc6d1c8f5b" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">CompileTrap</a>(<a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a> <span id="r291 rd" class="r291 r">trap</span>)
        {
            <a href="#8bdfc042f41c96c5" class="k">var</a> <span id="r292 rd" class="r292 r">compiler</span> = <b>new</b> <a href="#fa2dc33b1b4ec7bd" class="t constructor">Compiler</a>(<a href="#be6f1ba488dac21b" class="i field">_sequencePoints</a>, <a href="#f8a0435f5353a62a" class="i field">_sequencePointIndexMap</a>) { <a href="#3647e83d7c60a8f3" class="i field">_compilingTrap</a> = <b>true</b> };
            <b>string</b> <span id="r293 rd" class="r293 r">funcName</span> = <a href="#5cd149086434fa25" class="i field">_currentFunctionName</a> + <span class="s">&quot;&lt;trap&gt;&quot;</span>;
            <b>if</b> (<span class="r291 r">trap</span>.<a href="ast.cs.html#81f0443bf2950d57" class="i property">TrapType</a> != <b>null</b>)
            {
                <span class="r293 r">funcName</span> += <span class="s">&quot;&lt;&quot;</span> + <span class="r291 r">trap</span>.<a href="ast.cs.html#81f0443bf2950d57" class="i property">TrapType</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#d299e8e1674e18ab" class="i property">Name</a> + <span class="s">&quot;&gt;&quot;</span>;
            }
 
            <span class="c">// We generate code as though we&#39;re dotting the trap, but in reality we don&#39;t dot it,</span>
            <span class="c">// a new scope is always created.  The code gen for dotting means we can avoid passing</span>
            <span class="c">// around the array of local variable names.  We assume traps don&#39;t need to perform well,</span>
            <span class="c">// and that they rarely if ever actually create any local variables.  We still do the</span>
            <span class="c">// variable analysis though because we must mark automatic variables like $_.</span>
            <b>var</b> <span id="r294 rd" class="r294 r">analysis</span> = <a href="VariableAnalysis.cs.html#3d310869db3a3b73" class="t t">VariableAnalysis</a>.<a href="VariableAnalysis.cs.html#7aada80719bf6a01" class="i method">AnalyzeTrap</a>(<span class="r291 r">trap</span>);
 
            <span class="r292 r">compiler</span>.<a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a> = <span class="r294 r">analysis</span>.<span class="i">Item1</span>;
            <span class="r292 r">compiler</span>.<a href="#60079b222ae29e0d" class="i property">LocalVariablesParameter</a> = <span class="i">Expression</span>.<span class="i">Variable</span>(<span class="r292 r">compiler</span>.<a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a>, <span class="s">&quot;locals&quot;</span>);
 
            <b>var</b> <span id="r295 rd" class="r295 r">lambda</span> = <span class="r292 r">compiler</span>.<a href="#40e15f6ec6046ca8" class="i method">CompileSingleLambda</a>(<span class="r291 r">trap</span>.<a href="ast.cs.html#f46fffb1c902252d" class="i property">Body</a>.<a href="ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>, <span class="r291 r">trap</span>.<a href="ast.cs.html#f46fffb1c902252d" class="i property">Body</a>.<a href="ast.cs.html#8a3ec42ea63c1318" class="i property">Traps</a>, <span class="r293 r">funcName</span>, <b>null</b>, <b>null</b>, <b>null</b>);
            <b>return</b> <span class="i">Tuple</span>.<span class="i">Create</span>(<span class="r295 r">lambda</span>.<span class="i">Compile</span>(), <span class="r292 r">compiler</span>.<a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a>);
        }
 
        <b>private</b> <span class="i">Expression</span>&lt;<span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;&gt; <a id="40e15f6ec6046ca8" href="../../R/40e15f6ec6046ca8.html" target="n" data-glyph="76,1" class="i method">CompileSingleLambda</a>(
            <span class="i">ReadOnlyCollection</span>&lt;<a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <span id="r296 rd" class="r296 r">statements</span>,
            <span class="i">ReadOnlyCollection</span>&lt;<a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt; <span id="r297 rd" class="r297 r">traps</span>,
            <b>string</b> <span id="r298 rd" class="r298 r">funcName</span>,
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r299 rd" class="r299 r">entryExtent</span>,
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r300 rd" class="r300 r">exitExtent</span>,
            <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r301 rd" class="r301 r">rootForDefiningTypesAndUsings</span>)
        {
            <a href="#5cd149086434fa25" class="i field">_currentFunctionName</a> = <span class="r298 r">funcName</span>;
 
            <a href="#4b32d559427de642" class="i field">_loopTargets</a>.<span class="i">Clear</span>();
 
            <a href="#6f06eb7483b8e7f7" class="i field">_returnTarget</a> = <span class="i">Expression</span>.<span class="i">Label</span>(<span class="s">&quot;returnTarget&quot;</span>);
            <b>var</b> <span id="r302 rd" class="r302 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <b>var</b> <span id="r303 rd" class="r303 r">temps</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt;();
 
            <a href="#8dcc6e6589206af3" class="i method">GenerateFunctionProlog</a>(<span class="r302 r">exprs</span>, <span class="r303 r">temps</span>, <span class="r299 r">entryExtent</span>);
 
            <b>if</b> (<span class="r301 r">rootForDefiningTypesAndUsings</span> != <b>null</b>)
            {
                <a href="#26622681017eca2f" class="i method">GenerateTypesAndUsings</a>(<span class="r301 r">rootForDefiningTypesAndUsings</span>, <span class="r302 r">exprs</span>);
            }
 
            <b>var</b> <span id="r304 rd" class="r304 r">actualBodyExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
 
            <b>if</b> (<a href="#e116f57a129b16bc" class="i property">CompilingMemberFunction</a>)
            {
                <span class="r303 r">temps</span>.<span class="i">Add</span>(<a href="#f0e2b48eb0cbdbad" class="i field">s_returnPipe</a>);
            }
 
            <a href="#de2c28a71e25c894" class="i method">CompileStatementListWithTraps</a>(<span class="r296 r">statements</span>, <span class="r297 r">traps</span>, <span class="r304 r">actualBodyExprs</span>, <span class="r303 r">temps</span>);
 
            <span class="r302 r">exprs</span>.<span class="i">AddRange</span>(<span class="r304 r">actualBodyExprs</span>);
 
            <span class="c">// We always add the return label even if it&#39;s unused - that way it doesn&#39;t matter what the last</span>
            <span class="c">// expression is in the body - the full body will always have void type.</span>
            <span class="r302 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<a href="#6f06eb7483b8e7f7" class="i field">_returnTarget</a>));
 
            <a href="#0123d909e0b889f7" class="i method">GenerateFunctionEpilog</a>(<span class="r302 r">exprs</span>, <span class="r300 r">exitExtent</span>);
 
            <span class="r303 r">temps</span>.<span class="i">Add</span>(<a href="#60079b222ae29e0d" class="i property">LocalVariablesParameter</a>);
            <span class="i">Expression</span> <span id="r305 rd" class="r305 r">body</span> = <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r303 r">temps</span>, <span class="r302 r">exprs</span>);
 
            <span class="c">// A return from a normal block is just that - a simple return (no exception).</span>
            <span class="c">// A return from a trap turns into an exception because the trap is compiled into a different lambda, yet</span>
            <span class="c">// the return from the trap must return from the function containing the trap.  So we wrap the full</span>
            <span class="c">// body of regular begin/process/end blocks with a try/catch so a return from the trap returns</span>
            <span class="c">// to the right place.  We can avoid also avoid generating the catch if we know there aren&#39;t any traps.</span>
            <b>if</b> (!<a href="#3647e83d7c60a8f3" class="i field">_compilingTrap</a> &amp;&amp;
                ((<span class="r297 r">traps</span> != <b>null</b> &amp;&amp; <span class="r297 r">traps</span>.<span class="i">Count</span> &gt; 0)
                || <span class="r296 r">statements</span>.<span class="i">Any</span>(<b>static</b> <span id="r306 rd" class="r306 r">stmt</span> =&gt; <a href="AstVisitor.cs.html#5298c9a8d6287f90" class="t t">AstSearcher</a>.<span class="i">Contains</span>(<span class="r306 r">stmt</span>, <b>static</b> <span id="r307 rd" class="r307 r">ast</span> =&gt; <span class="r307 r">ast</span> <b>is</b> <a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a>, <span class="i">searchNestedScriptBlocks</span>: <b>false</b>))))
            {
                <span class="r305 r">body</span> = <span class="i">Expression</span>.<span class="i">Block</span>(
                    <b>new</b>[] { <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a> },
                    <span class="i">Expression</span>.<span class="i">TryCatchFinally</span>(
                        <span class="r305 r">body</span>,
                        <span class="i">Expression</span>.<span class="i">Call</span>(
                            <span class="i">Expression</span>.<span class="i">Field</span>(<a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#de19a3cfacfdbca9" class="i field">ExecutionContext_Debugger</a>),
                            <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#15ca70a792a7b046" class="i field">Debugger_ExitScriptFunction</a>),
                        <span class="i">Expression</span>.<span class="i">Catch</span>(<b>typeof</b>(<a href="../lang/parserutils.cs.html#d6097919ed356bbf" class="t t">ReturnException</a>), <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>)));
            }
            <b>else</b>
            {
                <span class="c">// Either no traps, or we&#39;re compiling a trap - either way don&#39;t catch the ReturnException.</span>
                <span class="r305 r">body</span> = <span class="i">Expression</span>.<span class="i">Block</span>(
                    <b>new</b>[] { <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a> },
                    <span class="i">Expression</span>.<span class="i">TryFinally</span>(
                        <span class="r305 r">body</span>,
                        <span class="i">Expression</span>.<span class="i">Call</span>(
                            <span class="i">Expression</span>.<span class="i">Field</span>(<a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#de19a3cfacfdbca9" class="i field">ExecutionContext_Debugger</a>),
                            <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#15ca70a792a7b046" class="i field">Debugger_ExitScriptFunction</a>)));
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Lambda</span>&lt;<span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;&gt;(<span class="r305 r">body</span>, <span class="r298 r">funcName</span>, <b>new</b>[] { <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a> });
        }
 
        <b>private static void</b> <a id="26622681017eca2f" href="../../R/26622681017eca2f.html" target="n" data-glyph="76,1" class="i method">GenerateTypesAndUsings</a>(<a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r308 rd" class="r308 r">rootForDefiningTypesAndUsings</span>, <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r309 rd" class="r309 r">exprs</span>)
        {
            <span class="c">// We don&#39;t postpone load assemblies, import modules from &#39;using&#39; to the moment, when enclosed scriptblock is executed.</span>
            <span class="c">// We do loading, when root of the script is compiled.</span>
            <span class="c">// This allow us to avoid creating 10 different classes in this situation:</span>
            <span class="c">// 1..10 | ForEach-Object { class C {} }</span>
            <span class="c">// But it&#39;s possible that we are loading something from the codepaths that we never execute.</span>
 
            <span class="c">// If Parent of rootForDefiningTypesAndUsings is not null, then we already defined all types, when Visit a parent ScriptBlock</span>
            <b>if</b> (<span class="r308 r">rootForDefiningTypesAndUsings</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> == <b>null</b>)
            {
                <b>if</b> (<span class="r308 r">rootForDefiningTypesAndUsings</span>.<a href="ast.cs.html#c707ba0b01460c10" class="i property">UsingStatements</a>.<span class="i">Count</span> &gt; 0)
                {
                    <b>bool</b> <span id="r310 rd" class="r310 r">allUsingsAreNamespaces</span> = <span class="r308 r">rootForDefiningTypesAndUsings</span>.<a href="ast.cs.html#c707ba0b01460c10" class="i property">UsingStatements</a>.<span class="i">All</span>(<b>static</b> <span id="r311 rd" class="r311 r">us</span> =&gt; <span class="r311 r">us</span>.<span class="i">UsingStatementKind</span> == <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#8c39b25da17c5e31" class="i field">Namespace</a>);
                    <span class="i">GenerateLoadUsings</span>(<span class="r308 r">rootForDefiningTypesAndUsings</span>.<a href="ast.cs.html#c707ba0b01460c10" class="i property">UsingStatements</a>, <span class="r310 r">allUsingsAreNamespaces</span>, <span class="r309 r">exprs</span>);
                }
 
                <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>[] <span id="r312 rd" class="r312 r">typeAsts</span> =
                    <span class="r308 r">rootForDefiningTypesAndUsings</span>.<span class="i">FindAll</span>(<b>static</b> <span id="r313 rd" class="r313 r">ast</span> =&gt; <span class="r313 r">ast</span> <b>is</b> <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>, <b>true</b>)
                        .<span class="i">Cast</span>&lt;<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt;()
                        .<span class="i">ToArray</span>();
 
                <b>if</b> (<span class="r312 r">typeAsts</span>.<span class="i">Length</span> &gt; 0)
                {
                    <b>var</b> <span id="r314 rd" class="r314 r">assembly</span> = <a href="#6284f6efd4f2ee7b" class="i method">DefinePowerShellTypes</a>(<span class="r308 r">rootForDefiningTypesAndUsings</span>, <span class="r312 r">typeAsts</span>);
                    <span class="r309 r">exprs</span>.<span class="i">Add</span>(
                        <span class="i">Expression</span>.<span class="i">Call</span>(
                            <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#1c2f02241bddf8c8" class="i field">TypeOps_SetAssemblyDefiningPSTypes</a>,
                            <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>,
                            <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r314 r">assembly</span>)));
 
                    <span class="r309 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#1a9f84c88257ec0e" class="i field">TypeOps_InitPowerShellTypesAtRuntime</a>, <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r312 r">typeAsts</span>)));
                }
            }
 
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt; <span id="r315 rd" class="r315 r">typesToAddToScope</span> =
                <span class="r308 r">rootForDefiningTypesAndUsings</span>.<span class="i">FindAll</span>(<b>static</b> <span id="r316 rd" class="r316 r">ast</span> =&gt; <span class="r316 r">ast</span> <b>is</b> <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>, <b>false</b>)
                    .<span class="i">Cast</span>&lt;<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt;()
                    .<span class="i">ToDictionary</span>(<b>static</b> <span id="r317 rd" class="r317 r">type</span> =&gt; <span class="r317 r">type</span>.<span class="i">Name</span>);
            <b>if</b> (<span class="r315 r">typesToAddToScope</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r309 r">exprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#ae8fab35fd50590d" class="i field">TypeOps_AddPowerShellTypesToTheScope</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r315 r">typesToAddToScope</span>),
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r318 r">usingStatements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Using statement asts.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r319 r">allUsingsAreNamespaces</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">This flag allow us some optimizations, if usings don&#39;t have assemblies and modules.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r320 r">exprs</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>internal static void</b> <a id="f7629065bebc37de" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">GenerateLoadUsings</a>(<span class="i">IEnumerable</span>&lt;<a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <span id="r318 rd" class="r318 r">usingStatements</span>, <b>bool</b> <span id="r319 rd" class="r319 r">allUsingsAreNamespaces</span>, <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r320 rd" class="r320 r">exprs</span>)
        {
            <a href="TypeResolver.cs.html#55992be0fa5b3b24" class="t t">TypeResolutionState</a> <span id="r321 rd" class="r321 r">trs</span>;
            <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt; <span id="r322 rd" class="r322 r">typesToAdd</span> = <b>null</b>;
            <b>if</b> (<span class="r319 r">allUsingsAreNamespaces</span>)
            {
                <span class="r321 r">trs</span> = <b>new</b> <a href="TypeResolver.cs.html#da3e3447d7715cbe" class="t constructor">TypeResolutionState</a>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<a href="../runtime/Operations/MiscOps.cs.html#9e4b772b40fc12c1" class="i method">GetNamespacesForTypeResolutionState</a>(<span class="r318 r">usingStatements</span>), <b>null</b>);
            }
            <b>else</b>
            {
                <span class="i">Assembly</span>[] <span id="r323 rd" class="r323 r">assemblies</span>;
                <span class="r322 r">typesToAdd</span> = <a href="#64fb723de356e418" class="i method">LoadUsingsImpl</a>(<span class="r318 r">usingStatements</span>, <b>out</b> <span class="r323 r">assemblies</span>);
                <span class="r321 r">trs</span> = <b>new</b> <a href="TypeResolver.cs.html#da3e3447d7715cbe" class="t constructor">TypeResolutionState</a>(
                    <a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<a href="../runtime/Operations/MiscOps.cs.html#9e4b772b40fc12c1" class="i method">GetNamespacesForTypeResolutionState</a>(<span class="r318 r">usingStatements</span>),
                    <span class="r323 r">assemblies</span>);
            }
 
            <span class="r320 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Call</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#8084538051e92616" class="i field">TypeOps_SetCurrentTypeResolutionState</a>,
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r321 r">trs</span>), <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>));
            <b>if</b> (<span class="r322 r">typesToAdd</span> != <b>null</b> &amp;&amp; <span class="r322 r">typesToAdd</span>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r320 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Call</span>(
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#ae8fab35fd50590d" class="i field">TypeOps_AddPowerShellTypesToTheScope</a>,
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r322 r">typesToAdd</span>), <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>));
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Bake types and creates a dynamic assembly.</span>
        <span class="c">///</span><span class="c"> This method should be called only for rootAsts (i.e. script file root ScriptBlockAst).</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r324 r">rootForDefiningTypes</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r325 r">typeAsts</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Non-empty array of TypeDefinitionAst.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Assembly with defined types.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static</b> <span class="i">Assembly</span> <a id="6284f6efd4f2ee7b" href="../../R/6284f6efd4f2ee7b.html" target="n" data-glyph="74,1" class="i method">DefinePowerShellTypes</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r324 rd" class="r324 r">rootForDefiningTypes</span>, <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>[] <span id="r325 rd" class="r325 r">typeAsts</span>)
        {
            <span class="c">// TODO(sevoroby): this Diagnostic is conceptually right.</span>
            <span class="c">// BUT It triggers, when we define type in an InitialSessionState and use it later in two different PowerShell instances.</span>
            <span class="c">// Diagnostics.Assert(typeAsts[0].Type == null, &quot;We must not call DefinePowerShellTypes twice for the same TypeDefinitionAsts&quot;);</span>
            <b>if</b> (<span class="r325 r">typeAsts</span>[0].<a href="ast.cs.html#238185060b3af590" class="i property">Type</a> != <b>null</b>)
            {
                <span class="c">// We treat Type as a mutable buffer field and wipe it here to start definitions from scratch.</span>
 
                <span class="c">// I didn&#39;t find any real scenario when it can cause problems, except multi-threaded environment, which is rear and out-of-scope for now.</span>
                <span class="c">// Potentially, we can fix it with Ast.Copy() and rewiring ITypeName references for the whole tree.</span>
                <b>foreach</b> (<a href="ast.cs.html#d7f0bc21c0f10879" class="k">var</a> <span id="r326 rd" class="r326 r">typeDefinitionAst</span> <b>in</b> <span class="r325 r">typeAsts</span>)
                {
                    <span class="r326 r">typeDefinitionAst</span>.<a href="ast.cs.html#238185060b3af590" class="i property">Type</a> = <b>null</b>;
                }
            }
 
            <span class="c">// This is a short term solution - all error messages produced by creating the types should happen</span>
            <span class="c">// at parse time, not runtime.</span>
            <a href="Parser.cs.html#bbf5e856fb3215c5" class="k">var</a> <span id="r327 rd" class="r327 r">parser</span> = <b>new</b> <a href="Parser.cs.html#aee2c3138d83ea53" class="t constructor">Parser</a>();
            <b>var</b> <span id="r328 rd" class="r328 r">assembly</span> = <a href="PSType.cs.html#6158471889fabd77" class="t t">TypeDefiner</a>.<a href="PSType.cs.html#aafd472f58bb18cc" class="i method">DefineTypes</a>(<span class="r327 r">parser</span>, <span class="r324 r">rootForDefiningTypes</span>, <span class="r325 r">typeAsts</span>);
            <b>if</b> (<span class="r327 r">parser</span>.<a href="Parser.cs.html#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// wipe types, if there are any errors.</span>
                <b>foreach</b> (<a href="ast.cs.html#d7f0bc21c0f10879" class="k">var</a> <span id="r329 rd" class="r329 r">typeDefinitionAst</span> <b>in</b> <span class="r325 r">typeAsts</span>)
                {
                    <span class="r329 r">typeDefinitionAst</span>.<a href="ast.cs.html#238185060b3af590" class="i property">Type</a> = <b>null</b>;
                }
 
                <b>throw</b> <b>new</b> <span class="t">ParseException</span>(<span class="r327 r">parser</span>.<a href="Parser.cs.html#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">ToArray</span>());
            }
 
            <b>return</b> <span class="r328 r">assembly</span>;
        }
 
        <b>private static</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt; <a id="64fb723de356e418" href="../../R/64fb723de356e418.html" target="n" data-glyph="76,1" class="i method">LoadUsingsImpl</a>(<span class="i">IEnumerable</span>&lt;<a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <span id="r330 rd" class="r330 r">usingAsts</span>, <b>out</b> <span class="i">Assembly</span>[] <span id="r331 rd" class="r331 r">assemblies</span>)
        {
            <b>var</b> <span id="r332 rd" class="r332 r">asms</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Assembly</span>&gt;();
            <b>var</b> <span id="r333 rd" class="r333 r">types</span> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
 
            <b>foreach</b> (<b>var</b> <span id="r334 rd" class="r334 r">usingStmt</span> <b>in</b> <span class="r330 r">usingAsts</span>)
            {
                <b>switch</b> (<span class="r334 r">usingStmt</span>.<span class="i">UsingStatementKind</span>)
                {
                    <b>case</b> <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#98acf874996a057c" class="i field">Assembly</a>:
                        <span class="r332 r">asms</span>.<span class="i">Add</span>(<span class="i">LoadAssembly</span>(<span class="r334 r">usingStmt</span>.<span class="i">Name</span>.<span class="i">Value</span>, <span class="r334 r">usingStmt</span>.<span class="i">Extent</span>.<span class="i">File</span>));
                        <b>break</b>;
                    <b>case</b> <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#68fe72ea611e4f8d" class="i field">Command</a>:
                        <b>break</b>;
                    <b>case</b> <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#4e97afe747960a96" class="i field">Module</a>:
                        <a href="../Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="k">var</a> <span id="r335 rd" class="r335 r">module</span> = <span class="i">LoadModule</span>(<span class="r334 r">usingStmt</span>.<span class="i">ModuleInfo</span>);
                        <b>if</b> (<span class="r335 r">module</span> != <b>null</b>)
                        {
                            <b>if</b> (<span class="r335 r">module</span>.<a href="../Modules/PSModuleInfo.cs.html#7adbb859c851b2e4" class="i property">ImplementingAssembly</a> != <b>null</b>)
                            {
                                <span class="r332 r">asms</span>.<span class="i">Add</span>(<span class="r335 r">module</span>.<a href="../Modules/PSModuleInfo.cs.html#7adbb859c851b2e4" class="i property">ImplementingAssembly</a>);
                            }
 
                            <b>var</b> <span id="r336 rd" class="r336 r">exportedTypes</span> = <span class="r335 r">module</span>.<a href="../Modules/PSModuleInfo.cs.html#7d3f55f45bfcc4cc" class="i method">GetExportedTypeDefinitions</a>();
                            <span class="i">PopulateRuntimeTypes</span>(<span class="r334 r">usingStmt</span>.<span class="i">ModuleInfo</span>.<span class="i">GetExportedTypeDefinitions</span>(), <span class="r336 r">exportedTypes</span>);
                            <b>foreach</b> (<b>var</b> <span id="r337 rd" class="r337 r">nameTypePair</span> <b>in</b> <span class="r336 r">exportedTypes</span>)
                            {
                                <span class="r333 r">types</span>[<a href="SymbolResolver.cs.html#2121410b8db29d18" class="t t">SymbolResolver</a>.<span class="i">GetModuleQualifiedName</span>(<span class="r335 r">module</span>.<a href="../Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>, <span class="r337 r">nameTypePair</span>.<span class="i">Key</span>)] = <span class="r337 r">nameTypePair</span>.<span class="i">Value</span>;
                            }
                        }
 
                        <b>break</b>;
                    <b>case</b> <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#8c39b25da17c5e31" class="i field">Namespace</a>:
                        <b>break</b>;
                    <b>case</b> <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#32e92208f14046ce" class="i field">Type</a>:
                        <b>break</b>;
                    <b>default</b>:
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<b>false</b>, <span class="s">&quot;Unknown enum value &quot;</span> + <span class="r334 r">usingStmt</span>.<span class="i">UsingStatementKind</span> + <span class="s">&quot; for UsingStatementKind&quot;</span>);
                        <b>break</b>;
                }
            }
 
            <span class="r331 r">assemblies</span> = <span class="r332 r">asms</span>.<span class="i">ToArray</span>();
            <b>return</b> <span class="r333 r">types</span>;
        }
 
        <b>private static void</b> <a id="66710451b1ae1991" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">PopulateRuntimeTypes</a>(<span class="i">ReadOnlyDictionary</span>&lt;<b>string</b>, <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt; <span id="r338 rd" class="r338 r">parseTimeTypes</span>, <span class="i">ReadOnlyDictionary</span>&lt;<b>string</b>, <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt; <span id="r339 rd" class="r339 r">runtimeTypes</span>)
        {
            <b>foreach</b> (<span class="i">KeyValuePair</span>&lt;<b>string</b>, <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>&gt; <span id="r340 rd" class="r340 r">parseTypePair</span> <b>in</b> <span class="r338 r">parseTimeTypes</span>)
            {
                <span class="c">// We only need to populate types, if ASTs are not reused. Otherwise it&#39;s already populated.</span>
                <b>if</b> (<span class="r340 r">parseTypePair</span>.<span class="i">Value</span>.<span class="i">Type</span> == <b>null</b>)
                {
                    <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r341 rd" class="r341 r">typeDefinitionAst</span>;
                    <b>if</b> (!<span class="r339 r">runtimeTypes</span>.<span class="i">TryGetValue</span>(<span class="r340 r">parseTypePair</span>.<span class="i">Key</span>, <b>out</b> <span class="r341 r">typeDefinitionAst</span>))
                    {
                        <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(
                            <span class="r340 r">parseTypePair</span>.<span class="i">Value</span>,
                            <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                            <span class="r340 r">parseTypePair</span>.<span class="i">Value</span>.<span class="i">Extent</span>,
                            <span class="s">&quot;TypeNotFound&quot;</span>,
                            <span class="i">ParserStrings</span>.<span class="i">TypeNotFound</span>,
                            <span class="r340 r">parseTypePair</span>.<span class="i">Value</span>.<span class="i">Name</span>);
                    }
 
                    <span class="r340 r">parseTypePair</span>.<span class="i">Value</span>.<span class="i">Type</span> = <span class="r341 r">typeDefinitionAst</span>.<a href="ast.cs.html#238185060b3af590" class="i property">Type</a>;
                }
            }
        }
 
        <b>private static</b> <span class="i">Assembly</span> <a id="8e6203a18dbd9fb9" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">LoadAssembly</a>(<b>string</b> <span id="r342 rd" class="r342 r">assemblyName</span>, <b>string</b> <span id="r343 rd" class="r343 r">scriptFileName</span>)
        {
            <b>var</b> <span id="r344 rd" class="r344 r">assemblyFileName</span> = <span class="r342 r">assemblyName</span>;
            <span class="i">Assembly</span> <span id="r345 rd" class="r345 r">assembly</span> = <b>null</b>;
            <b>try</b>
            {
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r343 r">scriptFileName</span>) &amp;&amp; !<span class="i">Path</span>.<span class="i">IsPathRooted</span>(<span class="r344 r">assemblyFileName</span>))
                {
                    <span class="r344 r">assemblyFileName</span> = <span class="i">Path</span>.<span class="i">GetDirectoryName</span>(<span class="r343 r">scriptFileName</span>) + <span class="s">&quot;\\&quot;</span> + <span class="r344 r">assemblyFileName</span>;
                }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span>
<span class="e">                if (!File.Exists(assemblyFileName))
                {
                    Microsoft.CodeAnalysis.GlobalAssemblyCache.ResolvePartialName(assemblyName, out assemblyFileName);
                }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
                <b>if</b> (<span class="i">File</span>.<span class="i">Exists</span>(<span class="r344 r">assemblyFileName</span>))
                {
                    <span class="r345 r">assembly</span> = <span class="i">Assembly</span>.<span class="i">LoadFrom</span>(<span class="r344 r">assemblyFileName</span>);
                }
            }
            <b>catch</b>
            {
            }
 
            <b>if</b> (<span class="r345 r">assembly</span> == <b>null</b>)
            {
                <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(
                    <span class="r342 r">assemblyName</span>,
                    <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                    <b>null</b>,
                    <span class="s">&quot;ErrorLoadingAssembly&quot;</span>,
                    <span class="i">ParserStrings</span>.<span class="i">ErrorLoadingAssembly</span>,
                    <span class="r342 r">assemblyName</span>);
            }
 
            <b>return</b> <span class="r345 r">assembly</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Take module info of module that can be already loaded or not and loads it.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r346 r">originalModuleInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Module to load.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Module info of the same module, but loaded.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private static</b> <a href="../Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <a id="2006e980f2988d58" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">LoadModule</a>(<a href="../Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r346 rd" class="r346 r">originalModuleInfo</span>)
        {
            <span class="c">// originalModuleInfo is created during parse time and may not contain [System.Type] types exported from the module.</span>
            <span class="c">// At this moment, we need to actually load the module and create types.</span>
            <span class="c">// We want to load **exactly the same module** as we used at parse time.</span>
            <span class="c">// And avoid the module resolution logic that can lead to another module (if something changed on the file system).</span>
            <span class="c">// So, we load the module by the file path, not by module specification (ModuleName, RequiredVersion).</span>
            <b>var</b> <span id="r347 rd" class="r347 r">modulePath</span> = <span class="r346 r">originalModuleInfo</span>.<a href="../Modules/PSModuleInfo.cs.html#82fc7c994af5e4ca" class="i property">Path</a>;
            <a href="../CmdletInfo.cs.html#9492ffc9968f644d" class="k">var</a> <span id="r348 rd" class="r348 r">commandInfo</span> = <b>new</b> <span class="t">CmdletInfo</span>(<span class="s">&quot;Import-Module&quot;</span>, <b>typeof</b>(<a href="../Modules/ImportModuleCommand.cs.html#4a6e75cbbfb65b34" class="t t">ImportModuleCommand</a>));
            <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="k">var</a> <span id="r349 rd" class="r349 r">ps</span> = <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#1c6a51d3c837bb4d" class="i method">Create</a>(<a href="../hostifaces/PowerShell.cs.html#c3c0f0e5e0b337ff" class="t t">RunspaceMode</a>.<a href="../hostifaces/PowerShell.cs.html#75d224de5df87e75" class="i field">CurrentRunspace</a>)
                .<a href="../hostifaces/PowerShell.cs.html#cc3df9bf3b89f740" class="i method">AddCommand</a>(<span class="r348 r">commandInfo</span>)
                .<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;Name&quot;</span>, <span class="r347 r">modulePath</span>)
                .<a href="../hostifaces/PowerShell.cs.html#ad181c9dec5e4ffa" class="i method">AddParameter</a>(<span class="s">&quot;PassThru&quot;</span>);
            <b>var</b> <span id="r350 rd" class="r350 r">moduleInfo</span> = <span class="r349 r">ps</span>.<a href="../hostifaces/PowerShell.cs.html#11053e110c66cae7" class="i method">Invoke</a>&lt;<a href="../Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>&gt;();
 
            <span class="c">// It&#39;s possible that &#39;ps.HadErrors == true&#39; while the error stream is empty. That would happen if</span>
            <span class="c">// one or more non-terminating errors happen when running the module script and ErrorAction is set</span>
            <span class="c">// to &#39;SilentlyContinue&#39;. In such case, the errors would not be written to the error stream.</span>
            <span class="c">// It&#39;s OK to treat the module loading as successful in this case because the non-terminating errors</span>
            <span class="c">// are explicitly handled with &#39;SilentlyContinue&#39; action, which means they don&#39;t block the loading.</span>
            <b>if</b> (<span class="r349 r">ps</span>.<a href="../hostifaces/PowerShell.cs.html#55e1a13ecd52fcd0" class="i property">HadErrors</a> &amp;&amp; <span class="r349 r">ps</span>.<a href="../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../hostifaces/PowerShell.cs.html#ae04a604c26c6f7d" class="i property">Error</a>.<a href="../hostifaces/PSDataCollection.cs.html#e7cb43bbebbb4aca" class="i property">Count</a> &gt; 0)
            {
                <a href="../ErrorPackage.cs.html#fe2b46733a081db9" class="k">var</a> <span id="r351 rd" class="r351 r">errorRecord</span> = <span class="r349 r">ps</span>.<a href="../hostifaces/PowerShell.cs.html#622ebeade9b6ada7" class="i property">Streams</a>.<a href="../hostifaces/PowerShell.cs.html#ae04a604c26c6f7d" class="i property">Error</a>[0];
                <b>throw</b> <a href="../lang/parserutils.cs.html#c1bdb7faf235a7b7" class="t t">InterpreterError</a>.<span class="i">NewInterpreterException</span>(
                    <span class="r347 r">modulePath</span>,
                    <b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>),
                    <b>null</b>,
                    <span class="r351 r">errorRecord</span>.<a href="../ErrorPackage.cs.html#80d40f16f77d32bb" class="i property">FullyQualifiedErrorId</a>,
                    <span class="r351 r">errorRecord</span>.<a href="../ErrorPackage.cs.html#cab659be098926dd" class="i method">ToString</a>());
            }
 
            <b>if</b> (<span class="r350 r">moduleInfo</span>.<span class="i">Count</span> == 1)
            {
                <b>return</b> <span class="r350 r">moduleInfo</span>[0];
            }
            <b>else</b>
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;We should load exactly one module from the provided original module&quot;</span>);
                <b>return</b> <b>null</b>;
            }
        }
 
        <b>private void</b> <a id="8dcc6e6589206af3" href="../../R/8dcc6e6589206af3.html" target="n" data-glyph="76,1" class="i method">GenerateFunctionProlog</a>(<span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r352 rd" class="r352 r">exprs</span>, <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt; <span id="r353 rd" class="r353 r">temps</span>, <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r354 rd" class="r354 r">entryExtent</span>)
        {
            <span class="r352 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(
                <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                <span class="i">Expression</span>.<span class="i">Field</span>(<a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#c3a98276549d8c66" class="i field">FunctionContext__executionContext</a>)));
            <span class="r352 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(
                <a href="#60079b222ae29e0d" class="i property">LocalVariablesParameter</a>,
                <span class="i">Expression</span>.<span class="i">Field</span>(<a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#311ba784690f9640" class="i field">FunctionContext__localsTuple</a>).<span class="i">Cast</span>(<a href="#8bdfc042f41c96c5" class="k">this</a>.<a href="#5d2d67fd5d17c19b" class="i property">LocalVariablesTupleType</a>)));
 
            <span class="c">// Compiling a single expression (a default argument, or an locally evaluated argument in a ScriptBlock=&gt;PowerShell conversion)</span>
            <span class="c">// does not support debugging, so skip calling EnterScriptFunction.</span>
            <b>if</b> (!<a href="#3133d55c945a52aa" class="i field">_compilingSingleExpression</a>)
            {
                <span class="r352 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(
                    <span class="i">Expression</span>.<span class="i">Field</span>(<a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#42ef6b8faf533098" class="i field">FunctionContext__functionName</a>),
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<a href="#5cd149086434fa25" class="i field">_currentFunctionName</a>)));
 
                <b>if</b> (<span class="r354 r">entryExtent</span> != <b>null</b>)
                {
                    <b>int</b> <span id="r355 rd" class="r355 r">index</span> = <a href="#319aa081bb450665" class="i method">AddSequencePoint</a>(<span class="r354 r">entryExtent</span>);
                    <span class="r352 r">exprs</span>.<span class="i">Add</span>(<b>new</b> <a href="#0c9779f3c88dad20" class="t constructor">UpdatePositionExpr</a>(<span class="r354 r">entryExtent</span>, <span class="r355 r">index</span>, <a href="#2807a84cb0b61e38" class="i field">_debugSymbolDocument</a>, <span class="r239 r">checkBreakpoints</span>: <b>false</b>));
                }
 
                <span class="r352 r">exprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">Call</span>(
                        <span class="i">Expression</span>.<span class="i">Field</span>(<a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#de19a3cfacfdbca9" class="i field">ExecutionContext_Debugger</a>),
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#e64a64c752430072" class="i field">Debugger_EnterScriptFunction</a>,
                        <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>));
            }
 
            <b>if</b> (<a href="#e116f57a129b16bc" class="i property">CompilingMemberFunction</a>)
            {
                <span class="c">// Member functions don&#39;t write to the pipeline, they return values.</span>
                <span class="c">// Set the default pipe to the null pipe, but remember the pipe parameter</span>
                <span class="c">// so when we do compile the return statement, we can write to it&#39;s pipe.</span>
                <span class="r352 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#f0e2b48eb0cbdbad" class="i field">s_returnPipe</a>, <a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>));
                <span class="r352 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#d0f7748e7e164cb1" class="i field">NullPipe</a>));
 
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>.<a href="ast.cs.html#238185060b3af590" class="i property">Type</a> != <b>null</b>, <span class="s">&quot;Member function type should not be null&quot;</span>);
                <b>var</b> <span id="r356 rd" class="r356 r">ourThis</span> = <a href="#c4c74ae83f907a1d" class="i method">NewTemp</a>(<a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>.<a href="ast.cs.html#238185060b3af590" class="i property">Type</a>, <span class="s">&quot;this&quot;</span>);
                <span class="r353 r">temps</span>.<span class="i">Add</span>(<span class="r356 r">ourThis</span>);
                <span class="r352 r">exprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">Assign</span>(
                        <span class="r356 r">ourThis</span>,
                        <span class="i">GetLocal</span>(<span class="i">Array</span>.<span class="i">IndexOf</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#2e947723b75287da" class="i field">AutomaticVariables</a>, <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#e7c9d57b99950a65" class="i field">This</a>)).<a href="#664379b8310751e4" class="i method">Cast</a>(<a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>.<a href="ast.cs.html#238185060b3af590" class="i property">Type</a>)));
 
                <b>switch</b> (<a href="#c3fa23b2c44834ed" class="i property">SpecialMemberFunctionType</a>)
                {
                    <b>case</b> <a href="ast.cs.html#19743eab765b38bd" class="t t">SpecialMemberFunctionType</a>.<a href="ast.cs.html#2db5275de9fc26b7" class="i field">DefaultConstructor</a>:
                        <span class="r352 r">exprs</span>.<span class="i">Add</span>(<span class="i">InitializeMemberProperties</span>(<span class="r356 r">ourThis</span>));
                        <b>break</b>;
                    <b>case</b> <a href="ast.cs.html#19743eab765b38bd" class="t t">SpecialMemberFunctionType</a>.<a href="ast.cs.html#b78a27783df5b515" class="i field">StaticConstructor</a>:
                        <span class="r352 r">exprs</span>.<span class="i">Add</span>(<a href="#02178439b09abd09" class="i method">InitializeMemberProperties</a>(<span class="r357 r">ourThis</span>: <b>null</b>));
                        <b>break</b>;
                }
            }
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="02178439b09abd09" href="../../R/02178439b09abd09.html" target="n" data-glyph="76,1" class="i method">InitializeMemberProperties</a>(<span class="i">Expression</span> <span id="r357 rd" class="r357 r">ourThis</span>)
        {
            <b>var</b> <span id="r358 rd" class="r358 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <b>bool</b> <span id="r359 rd" class="r359 r">wantStatic</span> = <span class="r357 r">ourThis</span> == <b>null</b>;
            <b>var</b> <span id="r360 rd" class="r360 r">bindingFlags</span> = <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">NonPublic</span> | (<span class="r359 r">wantStatic</span> ? <span class="i">BindingFlags</span>.<span class="i">Static</span> : <span class="i">BindingFlags</span>.<span class="i">Instance</span>);
            <b>foreach</b> (<b>var</b> <span id="r361 rd" class="r361 r">propertyMember</span> <b>in</b> <a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>.<a href="ast.cs.html#9f439131b4d83a32" class="i property">Members</a>.<span class="i">OfType</span>&lt;<a href="ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a>&gt;())
            {
                <b>if</b> (<span class="r361 r">propertyMember</span>.<span class="i">InitialValue</span> == <b>null</b> || <span class="r361 r">propertyMember</span>.<span class="i">IsStatic</span> != <span class="r359 r">wantStatic</span>)
                {
                    <b>continue</b>;
                }
 
                <b>var</b> <span id="r362 rd" class="r362 r">extent</span> = <span class="r361 r">propertyMember</span>.<span class="i">InitialValue</span>.<span class="i">Extent</span>;
                <b>int</b> <span id="r363 rd" class="r363 r">index</span> = <span class="i">AddSequencePoint</span>(<span class="r362 r">extent</span>);
                <span class="r358 r">exprs</span>.<span class="i">Add</span>(<b>new</b> <span class="t">UpdatePositionExpr</span>(<span class="r362 r">extent</span>, <span class="r363 r">index</span>, <a href="#2807a84cb0b61e38" class="i field">_debugSymbolDocument</a>, <span class="i">checkBreakpoints</span>: <b>false</b>));
                <b>var</b> <span id="r364 rd" class="r364 r">property</span> = <a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>.<a href="ast.cs.html#238185060b3af590" class="i property">Type</a>.<span class="i">GetProperty</span>(<span class="r361 r">propertyMember</span>.<span class="i">Name</span>, <span class="r360 r">bindingFlags</span>);
                <span class="r358 r">exprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">Assign</span>(
                        <span class="i">Expression</span>.<span class="i">Property</span>(<span class="r357 r">ourThis</span>, <span class="r364 r">property</span>),
                        <span class="i">Compile</span>(<span class="r361 r">propertyMember</span>.<span class="i">InitialValue</span>).<span class="i">Convert</span>(<span class="r364 r">property</span>.<span class="i">PropertyType</span>)));
            }
 
            <span class="r358 r">exprs</span>.<span class="i">Add</span>(<a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>);
            <b>return</b> <span class="i">Expression</span>.<span class="i">TryCatch</span>(<span class="i">Expression</span>.<span class="i">Block</span>(<span class="r358 r">exprs</span>), <a href="#5cd7a558b5b2f627" class="i field">s_stmtCatchHandlers</a>);
        }
 
        <b>private void</b> <a id="0123d909e0b889f7" href="../../R/0123d909e0b889f7.html" target="n" data-glyph="76,1" class="i method">GenerateFunctionEpilog</a>(<span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r365 rd" class="r365 r">exprs</span>, <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r366 rd" class="r366 r">exitExtent</span>)
        {
            <b>if</b> (<span class="r366 r">exitExtent</span> != <b>null</b>)
            {
                <span class="r365 r">exprs</span>.<span class="i">Add</span>(<a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<b>new</b> <a href="ast.cs.html#d9a5b055bdfedfca" class="t constructor">SequencePointAst</a>(<span class="r366 r">exitExtent</span>)));
            }
        }
 
        <b>public object</b> <a id="a7ec8b5a9ad7772d" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitTypeConstraint</a>(<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r367 rd" class="r367 r">typeConstraintAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Nothing to generate for a type constraint&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>public object</b> <a id="6a7b05930ddd6d1a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r368 rd" class="r368 r">attributeAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Nothing to generate for an attribute&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>public object</b> <a id="615195105c45aa6a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitNamedAttributeArgument</a>(<a href="ast.cs.html#283d46191e6456a4" class="t t">NamedAttributeArgumentAst</a> <span id="r369 rd" class="r369 r">namedAttributeArgumentAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Nothing to generate for a named attribute argument&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>public object</b> <a id="bbe8b86c3b3fe5c7" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitParameter</a>(<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a> <span id="r370 rd" class="r370 r">parameterAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Nothing to generate for a parameter&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>public object</b> <a id="3cf907a902ab7242" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitParamBlock</a>(<a href="ast.cs.html#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r371 rd" class="r371 r">paramBlockAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Nothing to generate for a parameter block&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>public object</b> <a id="d9a195e59f57713c" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitNamedBlock</a>(<a href="ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r372 rd" class="r372 r">namedBlockAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;NamedBlockAst is handled specially, not via the visitor.&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>public object</b> <a id="de0be61026350613" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitStatementBlock</a>(<a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r373 rd" class="r373 r">statementBlockAst</span>)
        {
            <b>var</b> <span id="r374 rd" class="r374 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <b>var</b> <span id="r375 rd" class="r375 r">temps</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt;();
            <a href="#de2c28a71e25c894" class="i method">CompileStatementListWithTraps</a>(<span class="r373 r">statementBlockAst</span>.<a href="ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>, <span class="r373 r">statementBlockAst</span>.<a href="ast.cs.html#8a3ec42ea63c1318" class="i property">Traps</a>, <span class="r374 r">exprs</span>, <span class="r375 r">temps</span>);
            <b>if</b> (<span class="r374 r">exprs</span>.<span class="i">Count</span> == 0)
            {
                <span class="r374 r">exprs</span>.<span class="i">Add</span>(<a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>);
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<b>typeof</b>(<b>void</b>), <span class="r375 r">temps</span>, <span class="r374 r">exprs</span>);
        }
 
        <b>private int</b> <a id="316830f524d6fa48" href="../../R/316830f524d6fa48.html" target="n" data-glyph="46,1" class="i field">_trapNestingCount</a>;
 
        <b>private void</b> <a id="de2c28a71e25c894" href="../../R/de2c28a71e25c894.html" target="n" data-glyph="76,1" class="i method">CompileStatementListWithTraps</a>(
            <span class="i">ReadOnlyCollection</span>&lt;<a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <span id="r376 rd" class="r376 r">statements</span>,
            <span class="i">ReadOnlyCollection</span>&lt;<a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt; <span id="r377 rd" class="r377 r">traps</span>,
            <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r378 rd" class="r378 r">exprs</span>,
            <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt; <span id="r379 rd" class="r379 r">temps</span>)
        {
            <b>if</b> (<span class="r376 r">statements</span>.<span class="i">Count</span> == 0)
            {
                <span class="r378 r">exprs</span>.<span class="i">Add</span>(<a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>);
                <b>return</b>;
            }
 
            <b>var</b> <span id="r380 rd" class="r380 r">originalExprs</span> = <span class="r378 r">exprs</span>;
 
            <span class="i">Expression</span> <span id="r381 rd" class="r381 r">handlerInScope</span>;
            <span class="i">ParameterExpression</span> <span id="r382 rd" class="r382 r">oldActiveHandler</span>;
            <span class="i">ParameterExpression</span> <span id="r383 rd" class="r383 r">trapHandlersPushed</span>;
            <b>if</b> (<span class="r377 r">traps</span> != <b>null</b>)
            {
                <span class="c">// If the statement block has any traps, we&#39;ll generate code like:</span>
                <span class="c">//     try {</span>
                <span class="c">//         oldActiveHandler = executionContext.PropagateExceptionsToEnclosingStatementBlock;</span>
                <span class="c">//         executionContext.PropagateExceptionsToEnclosingStatementBlock = true;</span>
                <span class="c">//         functionContext.PushTrapHandlers(</span>
                <span class="c">//             new Type[] { trapTypes },</span>
                <span class="c">//             new Action&lt;FunctionContext&gt;[] { trapDelegates },</span>
                <span class="c">//             new Type[] { trapLocalTupleTypes });</span>
                <span class="c">//         trapHandlersPushed = true</span>
                <span class="c">//</span>
                <span class="c">//         statements</span>
                <span class="c">//     } finally {</span>
                <span class="c">//         executionContext.PropagateExceptionsToEnclosingStatementBlock = oldActiveHandler;</span>
                <span class="c">//         if (trapHandlersPushed) {</span>
                <span class="c">//             functionContext.PopTrapHandlers()</span>
                <span class="c">//         }</span>
                <span class="c">//     }</span>
                <span class="c">//</span>
                <span class="c">// We use a runtime check on popping because in some rare cases, PushTrapHandlers might not</span>
                <span class="c">// get called (e.g. if a trap handler specifies a type that doesn&#39;t exist, like trap [baddtype]{}).</span>
                <span class="c">// We don&#39;t want to pop if we didn&#39;t push.</span>
                <span class="r378 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
 
                <span class="r381 r">handlerInScope</span> = <span class="i">Expression</span>.<span class="i">Property</span>(
                    <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#a7f8c6f9891fd821" class="i field">ExecutionContext_ExceptionHandlerInEnclosingStatementBlock</a>);
                <span class="r382 r">oldActiveHandler</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<b>bool</b>), <span class="s">&quot;oldActiveHandler&quot;</span>);
 
                <span class="r378 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r382 r">oldActiveHandler</span>, <span class="r381 r">handlerInScope</span>));
                <span class="r378 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r381 r">handlerInScope</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>)));
 
                <b>var</b> <span id="r384 rd" class="r384 r">trapTypes</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
                <b>var</b> <span id="r385 rd" class="r385 r">trapDelegates</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Action</span>&lt;<a href="#aa4ec5dd36f7e2eb" class="t t">FunctionContext</a>&gt;&gt;();
                <b>var</b> <span id="r386 rd" class="r386 r">trapTupleType</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Type</span>&gt;();
                <b>for</b> (<b>int</b> <span id="r387 rd" class="r387 r">index</span> = 0; <span class="r387 r">index</span> &lt; <span class="r377 r">traps</span>.<span class="i">Count</span>; <span class="r387 r">index</span>++)
                {
                    <b>var</b> <span id="r388 rd" class="r388 r">trap</span> = <span class="r377 r">traps</span>[<span class="r387 r">index</span>];
                    <span class="r384 r">trapTypes</span>.<span class="i">Add</span>(<span class="r388 r">trap</span>.<span class="i">TrapType</span> != <b>null</b>
                                      ? <span class="i">CompileTypeName</span>(<span class="r388 r">trap</span>.<span class="i">TrapType</span>.<span class="i">TypeName</span>, <span class="r388 r">trap</span>.<span class="i">TrapType</span>.<span class="i">Extent</span>)
                                      : <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8e19b9a6aeb74d9f" class="i field">CatchAllType</a>);
                    <b>var</b> <span id="r389 rd" class="r389 r">tuple</span> = <span class="i">CompileTrap</span>(<span class="r388 r">trap</span>);
                    <span class="r385 r">trapDelegates</span>.<span class="i">Add</span>(<span class="r389 r">tuple</span>.<span class="i">Item1</span>);
                    <span class="r386 r">trapTupleType</span>.<span class="i">Add</span>(<span class="r389 r">tuple</span>.<span class="i">Item2</span>);
                }
 
                <span class="r378 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Call</span>(
                    <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#d5519931e1bab90f" class="i field">FunctionContext_PushTrapHandlers</a>,
                    <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<span class="i">Type</span>), <span class="r384 r">trapTypes</span>),
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r385 r">trapDelegates</span>.<span class="i">ToArray</span>()),
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r386 r">trapTupleType</span>.<span class="i">ToArray</span>())));
                <span class="r383 r">trapHandlersPushed</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<b>bool</b>), <span class="s">&quot;trapHandlersPushed&quot;</span>);
                <span class="r378 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r383 r">trapHandlersPushed</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>)));
                <a href="#316830f524d6fa48" class="i field">_trapNestingCount</a> += 1;
            }
            <b>else</b>
            {
                <span class="r382 r">oldActiveHandler</span> = <b>null</b>;
                <span class="r381 r">handlerInScope</span> = <b>null</b>;
                <span class="r383 r">trapHandlersPushed</span> = <b>null</b>;
 
                <b>if</b> (<a href="#316830f524d6fa48" class="i field">_trapNestingCount</a> &gt; 0)
                {
                    <span class="c">// If this statement block has no traps, but a parent block does, we need to make sure that process the</span>
                    <span class="c">// trap at the correct level in case we continue.  For example:</span>
                    <span class="c">//     trap { continue }</span>
                    <span class="c">//     if (1) {</span>
                    <span class="c">//         throw 1</span>
                    <span class="c">//         &quot;Shouldn&#39;t continue here&quot;</span>
                    <span class="c">//     }</span>
                    <span class="c">//     &quot;Should continue here&quot;</span>
                    <span class="c">// In this example, the trap just continues, but we want to continue after the &#39;if&#39; statement, not after</span>
                    <span class="c">// the &#39;throw&#39; statement.</span>
                    <span class="c">// We push null onto the active trap handlers to let ExceptionHandlingOps.CheckActionPreference know it</span>
                    <span class="c">// shouldn&#39;t process traps (but should still query the user if appropriate), and just rethrow so we can</span>
                    <span class="c">// unwind to the block with the trap.</span>
                    <span class="r378 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
 
                    <span class="r378 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>,
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#d5519931e1bab90f" class="i field">FunctionContext_PushTrapHandlers</a>,
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#0e2fa552fb153d79" class="i field">NullTypeArray</a>,
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9c8b73128fe65551" class="i field">NullDelegateArray</a>,
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#0e2fa552fb153d79" class="i field">NullTypeArray</a>));
                    <span class="r383 r">trapHandlersPushed</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<b>bool</b>), <span class="s">&quot;trapHandlersPushed&quot;</span>);
                    <span class="r378 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r383 r">trapHandlersPushed</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>)));
                }
            }
 
            <a href="#bbc2448f2228e671" class="i field">_stmtCount</a> += <span class="r376 r">statements</span>.<span class="i">Count</span>;
 
            <span class="c">// If there is a single statement, we just wrap it in try/catch (to handle traps and/or prompting based on</span>
            <span class="c">// $ErrorActionPreference.</span>
            <span class="c">//</span>
            <span class="c">// If there are multiple statements, we could wrap each statement in try/catch, but it&#39;s more efficient</span>
            <span class="c">// to have a single try/catch around the entire block.</span>
            <span class="c">//</span>
            <span class="c">// The interpreter handles a large number or try/catches fine, but the JIT fails miserably because it uses</span>
            <span class="c">// an exponential algorithm.</span>
            <span class="c">//</span>
            <span class="c">// Because a trap or user prompting can have us stop the erroneous statement, but continue to the next</span>
            <span class="c">// statement, we need to generate code like this:</span>
            <span class="c">//</span>
            <span class="c">//     dispatchIndex = 0;</span>
            <span class="c">// DispatchNextStatementTarget:</span>
            <span class="c">//     try {</span>
            <span class="c">//         switch (dispatchIndex) {</span>
            <span class="c">//         case 0: goto L0;</span>
            <span class="c">//         case 1: goto L1;</span>
            <span class="c">//         case 2: goto L2;</span>
            <span class="c">//         }</span>
            <span class="c">// L0:     dispatchIndex = 1;</span>
            <span class="c">//         statement1;</span>
            <span class="c">// L1:     dispatchIndex = 2;</span>
            <span class="c">//         statement2;</span>
            <span class="c">//     } catch (FlowControlException) {</span>
            <span class="c">//         throw;</span>
            <span class="c">//     } catch (Exception e) {</span>
            <span class="c">//         ExceptionHandlingOps.CheckActionPreference(functionContext, e);</span>
            <span class="c">//         goto DispatchNextStatementTarget;</span>
            <span class="c">//     }</span>
            <span class="c">// L2:</span>
            <span class="c">//</span>
            <span class="c">// This approach makes JIT possible (but still slow) for large functions and it speeds up the light</span>
            <span class="c">// compile (interpreter compile) by about 80%.</span>
            <b>if</b> (<span class="r376 r">statements</span>.<span class="i">Count</span> == 1)
            {
                <b>var</b> <span id="r390 rd" class="r390 r">exprList</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;(3);
                <span class="i">CompileTrappableExpression</span>(<span class="r390 r">exprList</span>, <span class="r376 r">statements</span>[0]);
                <span class="r390 r">exprList</span>.<span class="i">Add</span>(<a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>);
                <b>var</b> <span id="r391 rd" class="r391 r">expr</span> = <span class="i">Expression</span>.<span class="i">TryCatch</span>(<span class="i">Expression</span>.<span class="i">Block</span>(<span class="r390 r">exprList</span>), <a href="#5cd7a558b5b2f627" class="i field">s_stmtCatchHandlers</a>);
                <span class="r378 r">exprs</span>.<span class="i">Add</span>(<span class="r391 r">expr</span>);
            }
            <b>else</b>
            {
                <b>var</b> <span id="r392 rd" class="r392 r">switchCases</span> = <b>new</b> <span class="i">SwitchCase</span>[<span class="r376 r">statements</span>.<span class="i">Count</span> + 1];
                <b>var</b> <span id="r393 rd" class="r393 r">dispatchTargets</span> = <b>new</b> <span class="i">LabelTarget</span>[<span class="r376 r">statements</span>.<span class="i">Count</span> + 1];
                <b>for</b> (<b>int</b> <span id="r394 rd" class="r394 r">i</span> = 0; <span class="r394 r">i</span> &lt;= <span class="r376 r">statements</span>.<span class="i">Count</span>; <span class="r394 r">i</span>++)
                {
                    <span class="r393 r">dispatchTargets</span>[<span class="r394 r">i</span>] = <span class="i">Expression</span>.<span class="i">Label</span>();
                    <span class="r392 r">switchCases</span>[<span class="r394 r">i</span>] = <span class="i">Expression</span>.<span class="i">SwitchCase</span>(
                        <span class="i">Expression</span>.<span class="i">Goto</span>(<span class="r393 r">dispatchTargets</span>[<span class="r394 r">i</span>]),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(<span class="r394 r">i</span>));
                }
 
                <b>var</b> <span id="r395 rd" class="r395 r">dispatchIndex</span> = <span class="i">Expression</span>.<span class="i">Variable</span>(<b>typeof</b>(<b>int</b>), <span class="s">&quot;stmt&quot;</span>);
                <span class="r379 r">temps</span>.<span class="i">Add</span>(<span class="r395 r">dispatchIndex</span>);
                <span class="r378 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r395 r">dispatchIndex</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(0)));
 
                <b>var</b> <span id="r396 rd" class="r396 r">dispatchNextStatementTarget</span> = <span class="i">Expression</span>.<span class="i">Label</span>();
                <span class="r378 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r396 r">dispatchNextStatementTarget</span>));
 
                <b>var</b> <span id="r397 rd" class="r397 r">tryBodyExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
                <span class="r397 r">tryBodyExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Switch</span>(<span class="r395 r">dispatchIndex</span>, <span class="r392 r">switchCases</span>));
 
                <b>for</b> (<b>int</b> <span id="r398 rd" class="r398 r">i</span> = 0; <span class="r398 r">i</span> &lt; <span class="r376 r">statements</span>.<span class="i">Count</span>; <span class="r398 r">i</span>++)
                {
                    <span class="r397 r">tryBodyExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r393 r">dispatchTargets</span>[<span class="r398 r">i</span>]));
                    <span class="r397 r">tryBodyExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r395 r">dispatchIndex</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<span class="i">Constant</span>(<span class="r398 r">i</span> + 1)));
                    <span class="i">CompileTrappableExpression</span>(<span class="r397 r">tryBodyExprs</span>, <span class="r376 r">statements</span>[<span class="r398 r">i</span>]);
                }
 
                <span class="r397 r">tryBodyExprs</span>.<span class="i">Add</span>(<a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>);
 
                <b>var</b> <span id="r399 rd" class="r399 r">exception</span> = <span class="i">Expression</span>.<span class="i">Variable</span>(<b>typeof</b>(<span class="i">Exception</span>), <span class="s">&quot;exception&quot;</span>);
                <b>var</b> <span id="r400 rd" class="r400 r">callCheckActionPreference</span> = <span class="i">Expression</span>.<span class="i">Call</span>(
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#8da10b470305ec34" class="i field">ExceptionHandlingOps_CheckActionPreference</a>,
                    <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>,
                    <span class="r399 r">exception</span>);
                <b>var</b> <span id="r401 rd" class="r401 r">catchAll</span> = <span class="i">Expression</span>.<span class="i">Catch</span>(
                    <span class="r399 r">exception</span>,
                    <span class="i">Expression</span>.<span class="i">Block</span>(
                        <span class="r400 r">callCheckActionPreference</span>,
                        <span class="i">Expression</span>.<span class="i">Goto</span>(<span class="r396 r">dispatchNextStatementTarget</span>)));
 
                <b>var</b> <span id="r402 rd" class="r402 r">expr</span> = <span class="i">Expression</span>.<span class="i">TryCatch</span>(
                    <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r397 r">tryBodyExprs</span>),
                    <b>new</b> <span class="i">CatchBlock</span>[] { <a href="#e882e88ed6326a81" class="i field">s_catchFlowControl</a>, <span class="r401 r">catchAll</span> });
                <span class="r378 r">exprs</span>.<span class="i">Add</span>(<span class="r402 r">expr</span>);
                <span class="r378 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r393 r">dispatchTargets</span>[<span class="r376 r">statements</span>.<span class="i">Count</span>]));
            }
 
            <b>if</b> (<a href="#316830f524d6fa48" class="i field">_trapNestingCount</a> &gt; 0)
            {
                <b>var</b> <span id="r403 rd" class="r403 r">parameterExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt;();
                <b>var</b> <span id="r404 rd" class="r404 r">finallyBlockExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
                <b>if</b> (<span class="r382 r">oldActiveHandler</span> != <b>null</b>)
                {
                    <span class="r403 r">parameterExprs</span>.<span class="i">Add</span>(<span class="r382 r">oldActiveHandler</span>);
                    <span class="r404 r">finallyBlockExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r381 r">handlerInScope</span>, <span class="r382 r">oldActiveHandler</span>));
                }
 
                <span class="r403 r">parameterExprs</span>.<span class="i">Add</span>(<span class="r383 r">trapHandlersPushed</span>);
                <span class="r404 r">finallyBlockExprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">IfThen</span>(<span class="r383 r">trapHandlersPushed</span>, <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#7727f63cf7933933" class="i field">FunctionContext_PopTrapHandlers</a>)));
 
                <span class="r380 r">originalExprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r403 r">parameterExprs</span>, <span class="i">Expression</span>.<span class="i">TryFinally</span>(<span class="i">Expression</span>.<span class="i">Block</span>(<span class="r378 r">exprs</span>), <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r404 r">finallyBlockExprs</span>))));
            }
 
            <b>if</b> (<span class="r377 r">traps</span> != <b>null</b>)
            {
                <a href="#316830f524d6fa48" class="i field">_trapNestingCount</a> -= 1;
            }
        }
 
        <b>private void</b> <a id="b02c5768712a395a" href="../../R/b02c5768712a395a.html" target="n" data-glyph="76,1" class="i method">CompileTrappableExpression</a>(<span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r405 rd" class="r405 r">exprList</span>, <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r406 rd" class="r406 r">stmt</span>)
        {
            <b>var</b> <span id="r407 rd" class="r407 r">expr</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r406 r">stmt</span>);
            <span class="r405 r">exprList</span>.<span class="i">Add</span>(<span class="r407 r">expr</span>);
 
            <b>if</b> (<a href="#7dfc3d004babeae0" class="i method">ShouldSetExecutionStatusToSuccess</a>(<span class="r406 r">stmt</span>))
            {
                <span class="r405 r">exprList</span>.<span class="i">Add</span>(<a href="#569b451340efd095" class="i field">s_setDollarQuestionToTrue</a>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines whether a statement must have an explicit setting</span>
        <span class="c">///</span><span class="c"> for $? = $true after it by the compiler.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r408 r">statementAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The statement to examine.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True is the compiler should add the success setting, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="7dfc3d004babeae0" href="../../R/7dfc3d004babeae0.html" target="n" data-glyph="76,1" class="i method">ShouldSetExecutionStatusToSuccess</a>(<a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r408 rd" class="r408 r">statementAst</span>)
        {
            <span class="c">// Simple overload fan out</span>
            <b>switch</b> (<span class="r408 r">statementAst</span>)
            {
                <b>case</b> <a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r409 rd" class="r409 r">pipelineAst</span>:
                    <b>return</b> <a href="#4187351ddbb07519" class="i method">ShouldSetExecutionStatusToSuccess</a>(<span class="r409 r">pipelineAst</span>);
                <b>case</b> <a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a> <span id="r410 rd" class="r410 r">assignmentStatementAst</span>:
                    <b>return</b> <a href="#d29240bfa859412e" class="i method">ShouldSetExecutionStatusToSuccess</a>(<span class="r410 r">assignmentStatementAst</span>);
                <b>default</b>:
                    <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines whether a pipeline must have an explicit setting</span>
        <span class="c">///</span><span class="c"> for $? = $true after it by the compiler.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r411 r">pipelineAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The pipeline to examine.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True is the compiler should add the success setting, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="4187351ddbb07519" href="../../R/4187351ddbb07519.html" target="n" data-glyph="76,1" class="i method">ShouldSetExecutionStatusToSuccess</a>(<a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r411 rd" class="r411 r">pipelineAst</span>)
        {
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r412 rd" class="r412 r">expressionAst</span> = <a href="#9baf78ff906f6945" class="i method">GetSingleExpressionFromPipeline</a>(<span class="r411 r">pipelineAst</span>);
 
            <span class="c">// If the pipeline is not a single expression, it will set $?</span>
            <b>if</b> (<span class="r412 r">expressionAst</span> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <span class="c">// Expressions may still set $? themselves, so dig deeper</span>
            <b>return</b> <a href="#876122237ca761ab" class="i method">ShouldSetExecutionStatusToSuccess</a>(<span class="r412 r">expressionAst</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If the pipeline contains a single expression, the expression is returned, otherwise null is returned.</span>
        <span class="c">///</span><span class="c"> This method is different from </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a>.<a href="ast.cs.html#df65de159259e5e0" class="i method">GetPureExpression</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> in that it allows the single</span>
        <span class="c">///</span><span class="c"> expression to have redirections.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private static</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="9baf78ff906f6945" href="../../R/9baf78ff906f6945.html" target="n" data-glyph="76,1" class="i method">GetSingleExpressionFromPipeline</a>(<a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r413 rd" class="r413 r">pipelineAst</span>)
        {
            <b>var</b> <span id="r414 rd" class="r414 r">pipelineElements</span> = <span class="r413 r">pipelineAst</span>.<a href="ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>;
            <b>if</b> (<span class="r414 r">pipelineElements</span>.<span class="i">Count</span> == 1 &amp;&amp; <span class="r414 r">pipelineElements</span>[0] <b>is</b> <a href="ast.cs.html#f4da818a29387c5d" class="t t">CommandExpressionAst</a> <span id="r415 rd" class="r415 r">expr</span>)
            {
                <b>return</b> <span class="r415 r">expr</span>.<a href="ast.cs.html#5e5388d1f86139f7" class="i property">Expression</a>;
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines whether an assignment statement must have an explicit setting</span>
        <span class="c">///</span><span class="c"> for $? = $true after it by the compiler.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r416 r">assignmentStatementAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The assignment statement to examine.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True is the compiler should add the success setting, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="d29240bfa859412e" href="../../R/d29240bfa859412e.html" target="n" data-glyph="76,1" class="i method">ShouldSetExecutionStatusToSuccess</a>(<a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a> <span id="r416 rd" class="r416 r">assignmentStatementAst</span>)
        {
            <span class="c">// Get right-most RHS in cases like $x = $y = &lt;expr&gt;</span>
            <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r417 rd" class="r417 r">innerRhsStatementAst</span> = <span class="r416 r">assignmentStatementAst</span>.<a href="ast.cs.html#ca8f4cbe093f3036" class="i property">Right</a>;
            <b>while</b> (<span class="r417 r">innerRhsStatementAst</span> <b>is</b> <a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a> <span id="r418 rd" class="r418 r">rhsAssignmentAst</span>)
            {
                <span class="r417 r">innerRhsStatementAst</span> = <span class="r418 r">rhsAssignmentAst</span>.<a href="ast.cs.html#ca8f4cbe093f3036" class="i property">Right</a>;
            }
 
            <span class="c">// Simple assignments to pure expressions may need $? set, so examine the RHS statement for pure expressions</span>
            <b>switch</b> (<span class="r417 r">innerRhsStatementAst</span>)
            {
                <b>case</b> <a href="ast.cs.html#f4da818a29387c5d" class="t t">CommandExpressionAst</a> <span id="r419 rd" class="r419 r">commandExpression</span>:
                    <b>return</b> <a href="#876122237ca761ab" class="i method">ShouldSetExecutionStatusToSuccess</a>(<span class="r419 r">commandExpression</span>.<a href="ast.cs.html#5e5388d1f86139f7" class="i property">Expression</a>);
 
                <b>case</b> <a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r420 rd" class="r420 r">rhsPipelineAst</span>:
                    <b>return</b> <a href="#4187351ddbb07519" class="i method">ShouldSetExecutionStatusToSuccess</a>(<span class="r420 r">rhsPipelineAst</span>);
 
                <b>default</b>:
                    <b>return</b> <b>false</b>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Determines whether an expression in a statement must have an explicit setting</span>
        <span class="c">///</span><span class="c"> for $? = $true after it by the compiler.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r421 r">expressionAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The expression to examine.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">True is the compiler should add the success setting, false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="876122237ca761ab" href="../../R/876122237ca761ab.html" target="n" data-glyph="76,1" class="i method">ShouldSetExecutionStatusToSuccess</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r421 rd" class="r421 r">expressionAst</span>)
        {
            <b>switch</b> (<span class="r421 r">expressionAst</span>)
            {
                <b>case</b> <a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a> <span id="r422 rd" class="r422 r">parenExpression</span>:
                    <span class="c">// Pipelines in paren expressions that are just pure expressions will need $? set</span>
                    <span class="c">// e.g. (&quot;Hi&quot;), vs (Test-Path ./here.txt)</span>
                    <b>return</b> <a href="#7dfc3d004babeae0" class="i method">ShouldSetExecutionStatusToSuccess</a>(<span class="r422 r">parenExpression</span>.<a href="ast.cs.html#021e323175cb804d" class="i property">Pipeline</a>);
 
                <b>case</b> <a href="ast.cs.html#e6552a77ab32112a" class="t t">SubExpressionAst</a> <span id="r423 rd" class="r423 r">subExpressionAst</span>:
                    <span class="c">// Subexpressions generally set $? since they encapsulate a statement block</span>
                    <span class="c">// But $() requires an explicit setting</span>
                    <b>return</b> <span class="r423 r">subExpressionAst</span>.<a href="ast.cs.html#ec0bda1def565114" class="i property">SubExpression</a>.<a href="ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>.<span class="i">Count</span> == 0;
 
                <b>case</b> <a href="ast.cs.html#6bb067a9fcfafabf" class="t t">ArrayExpressionAst</a> <span id="r424 rd" class="r424 r">arrayExpressionAst</span>:
                    <span class="c">// ArrayExpressionAsts and SubExpressionAsts must be treated differently,</span>
                    <span class="c">// since they are optimised for a single expression differently.</span>
                    <span class="c">// A SubExpressionAst with a single expression in it has the $? = $true added,</span>
                    <span class="c">// but the optimisation drills deeper for ArrayExpressionAsts,</span>
                    <span class="c">// meaning we must inspect the expression itself in these cases</span>
 
                    <b>switch</b> (<span class="r424 r">arrayExpressionAst</span>.<a href="ast.cs.html#ccfc39397cd3e8e5" class="i property">SubExpression</a>.<a href="ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>.<span class="i">Count</span>)
                    {
                        <b>case</b> 0:
                            <span class="c">// @() needs $? set</span>
                            <b>return</b> <b>true</b>;
 
                        <b>case</b> 1:
                            <span class="c">// Single expressions with a trap are handled as statements</span>
                            <span class="c">// For example: @(trap { continue } &quot;Value&quot;)</span>
                            <b>if</b> (<span class="r424 r">arrayExpressionAst</span>.<a href="ast.cs.html#ccfc39397cd3e8e5" class="i property">SubExpression</a>.<a href="ast.cs.html#8a3ec42ea63c1318" class="i property">Traps</a> != <b>null</b>)
                            {
                                <b>return</b> <b>false</b>;
                            }
 
                            <span class="c">// Pure, single statement expressions need $? set</span>
                            <span class="c">// For example @(&quot;One&quot;) and @(&quot;One&quot;, &quot;Two&quot;)</span>
                            <b>return</b> <span class="i">ShouldSetExecutionStatusToSuccess</span>(<span class="r424 r">arrayExpressionAst</span>.<a href="ast.cs.html#ccfc39397cd3e8e5" class="i property">SubExpression</a>.<a href="ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>[0]);
 
                        <b>default</b>:
                            <span class="c">// Arrays with multiple statements in them will have $? set</span>
                            <b>return</b> <b>false</b>;
                    }
 
                <b>default</b>:
                    <b>return</b> <b>true</b>;
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Script Blocks
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Statements
 
        <b>public object</b> <a id="35f60dfed46282a7" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitTypeDefinition</a>(<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r425 rd" class="r425 r">typeDefinitionAst</span>)
        {
            <b>return</b> <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>;
        }
 
        <b>public object</b> <a id="2774e43fa72e240f" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitPropertyMember</a>(<a href="ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a> <span id="r426 rd" class="r426 r">propertyMemberAst</span>)
        {
            <b>return</b> <b>null</b>;
        }
 
        <b>public object</b> <a id="9867e22c07c7dfd5" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitFunctionMember</a>(<a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a> <span id="r427 rd" class="r427 r">functionMemberAst</span>)
        {
            <b>return</b> <b>null</b>;
        }
 
        <b>public object</b> <a id="c500ef004924a5e2" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitBaseCtorInvokeMemberExpression</a>(<a href="ast.cs.html#93dc2e4429de8e4e" class="t t">BaseCtorInvokeMemberExpressionAst</a> <span id="r428 rd" class="r428 r">baseCtorInvokeMemberExpressionAst</span>)
        {
            <b>var</b> <span id="r429 rd" class="r429 r">target</span> = <a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r428 r">baseCtorInvokeMemberExpressionAst</span>.<a href="ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>);
            <b>var</b> <span id="r430 rd" class="r430 r">args</span> = <span class="i">CompileInvocationArguments</span>(<span class="r428 r">baseCtorInvokeMemberExpressionAst</span>.<a href="ast.cs.html#0f1554608efc28f3" class="i property">Arguments</a>);
            <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="k">var</a> <span id="r431 rd" class="r431 r">baseCtorCallConstraints</span> = <a href="#322f55259ef8201e" class="i method">GetInvokeMemberConstraints</a>(<span class="r428 r">baseCtorInvokeMemberExpressionAst</span>);
            <b>return</b> <a href="#bef669cf1d7de21c" class="i method">InvokeBaseCtorMethod</a>(<span class="r431 r">baseCtorCallConstraints</span>, <span class="r429 r">target</span>, <span class="r430 r">args</span>);
        }
 
        <b>public object</b> <a id="25c8d10899b8e57e" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitUsingStatement</a>(<a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a> <span id="r432 rd" class="r432 r">usingStatementAst</span>)
        {
            <b>return</b> <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>;
        }
 
        <b>public object</b> <a id="de809fd49f8f6dd9" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitConfigurationDefinition</a>(<a href="ast.cs.html#d0b13bd03366725b" class="t t">ConfigurationDefinitionAst</a> <span id="r433 rd" class="r433 r">configurationAst</span>)
        {
            <b>return</b> <a href="#8bdfc042f41c96c5" class="k">this</a>.<a href="#ea1046c64ed522f1" class="i method">VisitPipeline</a>(<span class="r433 r">configurationAst</span>.<a href="ast.cs.html#d297296cd1fef10d" class="i method">GenerateSetItemPipelineAst</a>());
        }
 
        <b>public object</b> <a id="0c5830140cdfe91b" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitDynamicKeywordStatement</a>(<a href="ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a> <span id="r434 rd" class="r434 r">dynamicKeywordAst</span>)
        {
            <b>if</b> (<span class="r434 r">dynamicKeywordAst</span>.<a href="ast.cs.html#0f0688a599c6de89" class="i property">Keyword</a>.<a href="tokenizer.cs.html#22566df5302919e2" class="i property">MetaStatement</a>)
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Empty</span>();
            }
 
            <b>return</b> <a href="#8bdfc042f41c96c5" class="k">this</a>.<a href="#ea1046c64ed522f1" class="i method">VisitPipeline</a>(<span class="r434 r">dynamicKeywordAst</span>.<a href="ast.cs.html#a2a95b69bc885ea0" class="i method">GenerateCommandCallPipelineAst</a>());
        }
 
        <b>public object</b> <a id="bbe6b5d35570f406" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitFunctionDefinition</a>(<a href="ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r435 rd" class="r435 r">functionDefinitionAst</span>)
        {
            <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#f722b8e96a04816e" class="i field">FunctionOps_DefineFunction</a>,
                <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r435 r">functionDefinitionAst</span>),
                <span class="i">Expression</span>.<span class="i">Constant</span>(<b>new</b> <a href="../runtime/Operations/MiscOps.cs.html#a58e9f637412d31b" class="t constructor">ScriptBlockExpressionWrapper</a>(<span class="r435 r">functionDefinitionAst</span>)));
        }
 
        <b>public object</b> <a id="af9b1f57f4a0ddd8" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitIfStatement</a>(<a href="ast.cs.html#5371982d66a6137d" class="t t">IfStatementAst</a> <span id="r436 rd" class="r436 r">ifStmtAst</span>)
        {
            <b>int</b> <span id="r437 rd" class="r437 r">clauseCount</span> = <span class="r436 r">ifStmtAst</span>.<a href="ast.cs.html#7467cf9a24b469f1" class="i property">Clauses</a>.<span class="i">Count</span>;
 
            <b>var</b> <span id="r438 rd" class="r438 r">exprs</span> = <b>new</b> <span class="i">Tuple</span>&lt;<span class="i">Expression</span>, <span class="i">Expression</span>&gt;[<span class="r437 r">clauseCount</span>];
            <b>for</b> (<b>int</b> <span id="r439 rd" class="r439 r">i</span> = 0; <span class="r439 r">i</span> &lt; <span class="r437 r">clauseCount</span>; ++<span class="r439 r">i</span>)
            {
                <span class="i">IfClause</span> <span id="r440 rd" class="r440 r">ifClause</span> = <span class="r436 r">ifStmtAst</span>.<a href="ast.cs.html#7467cf9a24b469f1" class="i property">Clauses</a>[<span class="r439 r">i</span>];
                <b>var</b> <span id="r441 rd" class="r441 r">cond</span> = <span class="i">UpdatePositionForInitializerOrCondition</span>(
                    <span class="r440 r">ifClause</span>.<span class="i">Item1</span>,
                    <span class="i">CaptureStatementResults</span>(<span class="r440 r">ifClause</span>.<span class="i">Item1</span>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#2ae33340eb67d1d1" class="i field">Condition</a>).<span class="i">Convert</span>(<b>typeof</b>(<b>bool</b>)));
                <b>var</b> <span id="r442 rd" class="r442 r">body</span> = <span class="i">Compile</span>(<span class="r440 r">ifClause</span>.<span class="i">Item2</span>);
                <span class="r438 r">exprs</span>[<span class="r439 r">i</span>] = <span class="i">Tuple</span>.<span class="i">Create</span>(<span class="r441 r">cond</span>, <span class="r442 r">body</span>);
            }
 
            <span class="i">Expression</span> <span id="r443 rd" class="r443 r">elseExpr</span> = <b>null</b>;
            <b>if</b> (<span class="r436 r">ifStmtAst</span>.<a href="ast.cs.html#6cff2184cfb69977" class="i property">ElseClause</a> != <b>null</b>)
            {
                <span class="r443 r">elseExpr</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r436 r">ifStmtAst</span>.<a href="ast.cs.html#6cff2184cfb69977" class="i property">ElseClause</a>);
            }
 
            <span class="i">Expression</span> <span id="r444 rd" class="r444 r">result</span> = <b>null</b>;
            <b>for</b> (<b>int</b> <span id="r445 rd" class="r445 r">i</span> = <span class="r437 r">clauseCount</span> - 1; <span class="r445 r">i</span> &gt;= 0; --<span class="r445 r">i</span>)
            {
                <b>var</b> <span id="r446 rd" class="r446 r">cond</span> = <span class="r438 r">exprs</span>[<span class="r445 r">i</span>].<span class="i">Item1</span>;
                <b>var</b> <span id="r447 rd" class="r447 r">body</span> = <span class="r438 r">exprs</span>[<span class="r445 r">i</span>].<span class="i">Item2</span>;
                <b>if</b> (<span class="r443 r">elseExpr</span> != <b>null</b>)
                {
                    <span class="r444 r">result</span> = <span class="r443 r">elseExpr</span> = <span class="i">Expression</span>.<span class="i">IfThenElse</span>(<span class="r446 r">cond</span>, <span class="r447 r">body</span>, <span class="r443 r">elseExpr</span>);
                }
                <b>else</b>
                {
                    <span class="r444 r">result</span> = <span class="r443 r">elseExpr</span> = <span class="i">Expression</span>.<span class="i">IfThen</span>(<span class="r446 r">cond</span>, <span class="r447 r">body</span>);
                }
            }
 
            <b>return</b> <span class="r444 r">result</span>;
        }
 
        <b>public object</b> <a id="b4f1ce564aa720c5" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitTrap</a>(<a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a> <span id="r448 rd" class="r448 r">trapStatementAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Traps are not visited directly.&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>public object</b> <a id="76a806d68fa7d2fe" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitAssignmentStatement</a>(<a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a> <span id="r449 rd" class="r449 r">assignmentStatementAst</span>)
        {
            <b>return</b> <a href="#e8ec24b53e7f9f8d" class="i method">CompileAssignment</a>(<span class="r449 r">assignmentStatementAst</span>);
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="e8ec24b53e7f9f8d" href="../../R/e8ec24b53e7f9f8d.html" target="n" data-glyph="76,1" class="i method">CompileAssignment</a>(
            <a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a> <span id="r450 rd" class="r450 r">assignmentStatementAst</span>,
            <a href="#017a41e3db42549c" class="t t">MergeRedirectExprs</a> <span id="r451 rd" class="r451 r">generateRedirectExprs</span> = <b>null</b>)
        {
            <a href="ast.cs.html#0e44bc9125134006" class="k">var</a> <span id="r452 rd" class="r452 r">arrayLHS</span> = <span class="r450 r">assignmentStatementAst</span>.<a href="ast.cs.html#737e87d58bda06dc" class="i property">Left</a> <b>as</b> <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>;
            <a href="ast.cs.html#a9797c05604b61e8" class="k">var</a> <span id="r453 rd" class="r453 r">parenExpressionAst</span> = <span class="r450 r">assignmentStatementAst</span>.<a href="ast.cs.html#737e87d58bda06dc" class="i property">Left</a> <b>as</b> <a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a>;
            <b>if</b> (<span class="r453 r">parenExpressionAst</span> != <b>null</b>)
            {
                <span class="r452 r">arrayLHS</span> = <span class="r453 r">parenExpressionAst</span>.<a href="ast.cs.html#021e323175cb804d" class="i property">Pipeline</a>.<a href="ast.cs.html#158661f5f6c8db6d" class="i method">GetPureExpression</a>() <b>as</b> <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>;
            }
 
            <span class="c">// If assigning to an array, then we prefer an enumerable result because we use an IList</span>
            <span class="c">// to generate the assignments, no sense in converting to object[], or worse, returning a</span>
            <span class="c">// single object.</span>
            <span class="c">// We should not preserve the partial output if exception is thrown when evaluating right-hand-side expression.</span>
            <span class="i">Expression</span> <span id="r454 rd" class="r454 r">rightExpr</span> = <a href="#fed19bee56918521" class="i method">CaptureStatementResults</a>(
                <span class="r450 r">assignmentStatementAst</span>.<a href="ast.cs.html#ca8f4cbe093f3036" class="i property">Right</a>,
                <span class="r452 r">arrayLHS</span> != <b>null</b> ? <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#052596a192f2302b" class="i field">Enumerable</a> : <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>,
                <span class="r451 r">generateRedirectExprs</span>);
 
            <b>if</b> (<span class="r452 r">arrayLHS</span> != <b>null</b>)
            {
                <span class="r454 r">rightExpr</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#de8eb85637e55a23" class="t t">PSArrayAssignmentRHSBinder</a>.<span class="i">Get</span>(<span class="r452 r">arrayLHS</span>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">Count</span>), <b>typeof</b>(<span class="i">IList</span>), <span class="r454 r">rightExpr</span>);
            }
 
            <b>var</b> <span id="r455 rd" class="r455 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;
                        {
                            <span class="c">// Set current position in case of errors.</span>
                            <a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r450 r">assignmentStatementAst</span>),
                            <a href="#e705d7767bd0f6e1" class="i method">ReduceAssignment</a>(
                                (<a href="ast.cs.html#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>)<span class="r450 r">assignmentStatementAst</span>.<a href="ast.cs.html#737e87d58bda06dc" class="i property">Left</a>,
                                <span class="r450 r">assignmentStatementAst</span>.<a href="ast.cs.html#2712fe866a1a962b" class="i property">Operator</a>,
                                <span class="r454 r">rightExpr</span>)
                        };
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r455 r">exprs</span>);
        }
 
        <b>public object</b> <a id="05f0ddbfe7931f55" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitPipelineChain</a>(<a href="ast.cs.html#56dc1a0918611f9c" class="t t">PipelineChainAst</a> <span id="r456 rd" class="r456 r">pipelineChainAst</span>)
        {
            <span class="c">// If the statement chain is backgrounded,</span>
            <span class="c">// we defer that to the background operation call</span>
            <b>if</b> (<span class="r456 r">pipelineChainAst</span>.<a href="ast.cs.html#ee72132d90340648" class="i property">Background</a>)
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#0f6da4509de170b7" class="i field">PipelineOps_InvokePipelineInBackground</a>,
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r456 r">pipelineChainAst</span>),
                    <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>);
            }
 
            <span class="c">// We want to generate code like:</span>
            <span class="c">//</span>
            <span class="c">// dispatchIndex = 0;</span>
            <span class="c">// DispatchNextStatementTarget:</span>
            <span class="c">//     try {</span>
            <span class="c">//         switch (dispatchIndex) {</span>
            <span class="c">//         case 0: goto L0;</span>
            <span class="c">//         case 1: goto L1;</span>
            <span class="c">//         case 2: goto L2;</span>
            <span class="c">//         }</span>
            <span class="c">// L0:     dispatchIndex = 1;</span>
            <span class="c">//         pipeline1;</span>
            <span class="c">// L1:     dispatchIndex = 2;</span>
            <span class="c">//         if ($?) pipeline2;</span>
            <span class="c">// L2:     dispatchIndex = 3;</span>
            <span class="c">//         if ($?) pipeline3;</span>
            <span class="c">//         ...</span>
            <span class="c">//     } catch (FlowControlException) {</span>
            <span class="c">//         throw;</span>
            <span class="c">//     } catch (Exception e) {</span>
            <span class="c">//         ExceptionHandlingOps.CheckActionPreference(functionContext, e);</span>
            <span class="c">//         goto DispatchNextStatementTarget;</span>
            <span class="c">//     }</span>
            <span class="c">// LN:</span>
            <span class="c">//</span>
            <span class="c">// Note that we deliberately do not push trap handlers</span>
            <span class="c">// so that those can be handled by the enclosing statement block instead.</span>
 
            <b>var</b> <span id="r457 rd" class="r457 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
 
            <span class="c">// A pipeline chain is left-hand-side deep,</span>
            <span class="c">// so to compile from left to right, we need to start from the leaf</span>
            <span class="c">// and roll back up to the top, being the right-most element in the chain</span>
            <a href="ast.cs.html#56dc1a0918611f9c" class="t t">PipelineChainAst</a> <span id="r458 rd" class="r458 r">currentChain</span> = <span class="r456 r">pipelineChainAst</span>;
            <b>while</b> (<span class="r458 r">currentChain</span>.<a href="ast.cs.html#6762de62f426f4e6" class="i property">LhsPipelineChain</a> <b>is</b> <a href="ast.cs.html#56dc1a0918611f9c" class="t t">PipelineChainAst</a> <span id="r459 rd" class="r459 r">lhsPipelineChain</span>)
            {
                <span class="r458 r">currentChain</span> = <span class="r459 r">lhsPipelineChain</span>;
            }
 
            <span class="c">// int chainIndex = 0;</span>
            <span class="i">ParameterExpression</span> <span id="r460 rd" class="r460 r">dispatchIndex</span> = <span class="i">Expression</span>.<span class="i">Variable</span>(<b>typeof</b>(<b>int</b>), <b>nameof</b>(<span class="r460 r">dispatchIndex</span>));
            <b>var</b> <span id="r461 rd" class="r461 r">temps</span> = <b>new</b> <span class="i">ParameterExpression</span>[] { <span class="r460 r">dispatchIndex</span> };
            <span class="r457 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r460 r">dispatchIndex</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(0)));
 
            <span class="c">// DispatchNextTargetStatement:</span>
            <span class="i">LabelTarget</span> <span id="r462 rd" class="r462 r">dispatchNextStatementTargetLabel</span> = <span class="i">Expression</span>.<span class="i">Label</span>();
            <span class="r457 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r462 r">dispatchNextStatementTargetLabel</span>));
 
            <span class="c">// try statement body</span>
            <b>var</b> <span id="r463 rd" class="r463 r">switchCases</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">SwitchCase</span>&gt;();
            <b>var</b> <span id="r464 rd" class="r464 r">dispatchTargets</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">LabelTarget</span>&gt;();
            <b>var</b> <span id="r465 rd" class="r465 r">tryBodyExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;()
            {
                <b>null</b>, <span class="c">// Add a slot for the inital switch/case that we&#39;ll come back to</span>
            };
 
            <span class="c">// L0: dispatchIndex = 1; pipeline1</span>
            <span class="i">LabelTarget</span> <span id="r466 rd" class="r466 r">label0</span> = <span class="i">Expression</span>.<span class="i">Label</span>();
            <span class="r464 r">dispatchTargets</span>.<span class="i">Add</span>(<span class="r466 r">label0</span>);
            <span class="r463 r">switchCases</span>.<span class="i">Add</span>(
                <span class="i">Expression</span>.<span class="i">SwitchCase</span>(
                    <span class="i">Expression</span>.<span class="i">Goto</span>(<span class="r466 r">label0</span>),
                    <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(0)));
            <span class="r465 r">tryBodyExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r466 r">label0</span>));
            <span class="r465 r">tryBodyExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r460 r">dispatchIndex</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(1)));
            <span class="r465 r">tryBodyExprs</span>.<span class="i">Add</span>(<a href="#def2175bfbe0c957" class="i method">CompilePipelineChainElement</a>((<a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a>)<span class="r458 r">currentChain</span>.<a href="ast.cs.html#6762de62f426f4e6" class="i property">LhsPipelineChain</a>));
 
            <span class="c">// Remainder of try statement body</span>
            <span class="c">// L1: dispatchIndex = 2; if ($?) pipeline2;</span>
            <span class="c">// ...</span>
            <b>int</b> <span id="r467 rd" class="r467 r">chainIndex</span> = 1;
            <b>do</b>
            {
                <span class="c">// Record label and switch case for later use</span>
                <span class="i">LabelTarget</span> <span id="r468 rd" class="r468 r">currentLabel</span> = <span class="i">Expression</span>.<span class="i">Label</span>();
                <span class="r464 r">dispatchTargets</span>.<span class="i">Add</span>(<span class="r468 r">currentLabel</span>);
                <span class="r463 r">switchCases</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">SwitchCase</span>(
                        <span class="i">Expression</span>.<span class="i">Goto</span>(<span class="r468 r">currentLabel</span>),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(<span class="r467 r">chainIndex</span>)));
 
                <span class="c">// Add label and dispatchIndex for current pipeline</span>
                <span class="r465 r">tryBodyExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r468 r">currentLabel</span>));
                <span class="r465 r">tryBodyExprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">Assign</span>(
                        <span class="r460 r">dispatchIndex</span>,
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<span class="i">Constant</span>(<span class="r467 r">chainIndex</span> + 1)));
 
                <span class="c">// Increment chain index for next iteration</span>
                <span class="r467 r">chainIndex</span>++;
 
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                    <span class="r458 r">currentChain</span>.<a href="ast.cs.html#8f367d5ba0b83448" class="i property">Operator</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#074f3be81f88796f" class="i field">AndAnd</a> || <span class="r458 r">currentChain</span>.<a href="ast.cs.html#8f367d5ba0b83448" class="i property">Operator</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a07cbb74e75a87a" class="i field">OrOr</a>,
                    <span class="s">&quot;Chain operators must be either &amp;&amp; or ||&quot;</span>);
 
                <span class="i">Expression</span> <span id="r469 rd" class="r469 r">dollarQuestionCheck</span> = <span class="r458 r">currentChain</span>.<a href="ast.cs.html#8f367d5ba0b83448" class="i property">Operator</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#074f3be81f88796f" class="i field">AndAnd</a>
                    ? <a href="#de9feee0a42f7758" class="i field">s_getDollarQuestion</a>
                    : <a href="#ab3f5f777a49c851" class="i field">s_notDollarQuestion</a>;
 
                <span class="r465 r">tryBodyExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">IfThen</span>(<span class="r469 r">dollarQuestionCheck</span>, <a href="#def2175bfbe0c957" class="i method">CompilePipelineChainElement</a>(<span class="r458 r">currentChain</span>.<a href="ast.cs.html#2bd325bbf09cdf8f" class="i property">RhsPipeline</a>)));
 
                <span class="r458 r">currentChain</span> = <span class="r458 r">currentChain</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>as</b> <a href="ast.cs.html#56dc1a0918611f9c" class="t t">PipelineChainAst</a>;
            }
            <b>while</b> (<span class="r458 r">currentChain</span> != <b>null</b>);
 
            <span class="c">// Add empty expression to make the block value void</span>
            <span class="r465 r">tryBodyExprs</span>.<span class="i">Add</span>(<a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>);
 
            <span class="c">// Create the final label that follows the entire try/catch</span>
            <span class="i">LabelTarget</span> <span id="r470 rd" class="r470 r">afterLabel</span> = <span class="i">Expression</span>.<span class="i">Label</span>();
            <span class="r463 r">switchCases</span>.<span class="i">Add</span>(
                <span class="i">Expression</span>.<span class="i">SwitchCase</span>(
                    <span class="i">Expression</span>.<span class="i">Goto</span>(<span class="r470 r">afterLabel</span>),
                    <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(<span class="r467 r">chainIndex</span>)));
 
            <span class="c">// Now set the switch/case that belongs at the top</span>
            <span class="r465 r">tryBodyExprs</span>[0] = <span class="i">Expression</span>.<span class="i">Switch</span>(<span class="r460 r">dispatchIndex</span>, <span class="r463 r">switchCases</span>.<span class="i">ToArray</span>());
 
            <span class="c">// Create the catch block for flow control and action preference</span>
            <span class="i">ParameterExpression</span> <span id="r471 rd" class="r471 r">exception</span> = <span class="i">Expression</span>.<span class="i">Variable</span>(<b>typeof</b>(<span class="i">Exception</span>), <b>nameof</b>(<span class="r471 r">exception</span>));
            <span class="i">MethodCallExpression</span> <span id="r472 rd" class="r472 r">callCheckActionPreference</span> = <span class="i">Expression</span>.<span class="i">Call</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#8da10b470305ec34" class="i field">ExceptionHandlingOps_CheckActionPreference</a>,
                <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>,
                <span class="r471 r">exception</span>);
            <span class="i">CatchBlock</span> <span id="r473 rd" class="r473 r">catchAll</span> = <span class="i">Expression</span>.<span class="i">Catch</span>(
                <span class="r471 r">exception</span>,
                <span class="i">Expression</span>.<span class="i">Block</span>(
                    <span class="r472 r">callCheckActionPreference</span>,
                    <span class="i">Expression</span>.<span class="i">Goto</span>(<span class="r462 r">dispatchNextStatementTargetLabel</span>)));
 
            <span class="i">TryExpression</span> <span id="r474 rd" class="r474 r">expr</span> = <span class="i">Expression</span>.<span class="i">TryCatch</span>(
                <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r465 r">tryBodyExprs</span>),
                <b>new</b> <span class="i">CatchBlock</span>[] { <a href="#e882e88ed6326a81" class="i field">s_catchFlowControl</a>, <span class="r473 r">catchAll</span> });
 
            <span class="r457 r">exprs</span>.<span class="i">Add</span>(<span class="r474 r">expr</span>);
            <span class="r457 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r470 r">afterLabel</span>));
 
            <span class="i">BlockExpression</span> <span id="r475 rd" class="r475 r">fullyExpandedBlock</span> = <span class="i">Expression</span>.<span class="i">Block</span>(<b>typeof</b>(<b>void</b>), <span class="r461 r">temps</span>, <span class="r457 r">exprs</span>);
 
            <b>return</b> <span class="r475 r">fullyExpandedBlock</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Compile a pipeline as an element in a pipeline chain.</span>
        <span class="c">///</span><span class="c"> Needed since pure expressions won&#39;t set $? after them.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">seealso</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#b02c5768712a395a" class="i method">CompileTrappableExpression</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> which does something similar.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r476 r">pipelineAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The pipeline in the pipeline chain to compile to an expression.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The compiled expression to execute the pipeline.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Expression</span> <a id="def2175bfbe0c957" href="../../R/def2175bfbe0c957.html" target="n" data-glyph="76,1" class="i method">CompilePipelineChainElement</a>(<a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r476 rd" class="r476 r">pipelineAst</span>)
        {
            <b>if</b> (<a href="#4187351ddbb07519" class="i method">ShouldSetExecutionStatusToSuccess</a>(<span class="r476 r">pipelineAst</span>))
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r476 r">pipelineAst</span>), <a href="#569b451340efd095" class="i field">s_setDollarQuestionToTrue</a>);
            }
 
            <b>return</b> <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r476 r">pipelineAst</span>);
        }
 
        <b>public object</b> <a id="ea1046c64ed522f1" href="../../R/ea1046c64ed522f1.html" target="n" data-glyph="72,1" class="i method">VisitPipeline</a>(<a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r477 rd" class="r477 r">pipelineAst</span>)
        {
            <b>var</b> <span id="r478 rd" class="r478 r">temps</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt;();
            <b>var</b> <span id="r479 rd" class="r479 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
 
            <b>if</b> (<span class="r477 r">pipelineAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is not</b> <a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a> &amp;&amp; <span class="r477 r">pipelineAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is not</b> <a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a>)
            {
                <span class="c">// If the parent is an assignment, we&#39;ve already added a sequence point, don&#39;t add another.</span>
                <span class="r479 r">exprs</span>.<span class="i">Add</span>(<a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r477 r">pipelineAst</span>));
            }
 
            <b>if</b> (<span class="r477 r">pipelineAst</span>.<a href="ast.cs.html#552590fec9ffecb9" class="i property">Background</a>)
            {
                <span class="i">Expression</span> <span id="r480 rd" class="r480 r">invokeBackgroundPipe</span> = <span class="i">Expression</span>.<span class="i">Call</span>(
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#0f6da4509de170b7" class="i field">PipelineOps_InvokePipelineInBackground</a>,
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r477 r">pipelineAst</span>),
                    <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>);
                <span class="r479 r">exprs</span>.<span class="i">Add</span>(<span class="r480 r">invokeBackgroundPipe</span>);
            }
            <b>else</b>
            {
                <b>var</b> <span id="r481 rd" class="r481 r">pipeElements</span> = <span class="r477 r">pipelineAst</span>.<a href="ast.cs.html#edccd333bf2ee4d5" class="i property">PipelineElements</a>;
                <a href="ast.cs.html#f4da818a29387c5d" class="k">var</a> <span id="r482 rd" class="r482 r">firstCommandExpr</span> = <span class="r481 r">pipeElements</span>[0] <b>as</b> <a href="ast.cs.html#f4da818a29387c5d" class="t t">CommandExpressionAst</a>;
 
                <b>if</b> (<span class="r482 r">firstCommandExpr</span> != <b>null</b> &amp;&amp; <span class="r481 r">pipeElements</span>.<span class="i">Count</span> == 1)
                {
                    <b>if</b> (<span class="r482 r">firstCommandExpr</span>.<a href="ast.cs.html#7d87854c277c8363" class="i property">Redirections</a>.<span class="i">Count</span> &gt; 0)
                    {
                        <span class="r479 r">exprs</span>.<span class="i">Add</span>(<a href="#14a0a997f6484957" class="i method">GetRedirectedExpression</a>(<span class="r482 r">firstCommandExpr</span>, <span class="r263 r">captureForInput</span>: <b>false</b>));
                    }
                    <b>else</b>
                    {
                        <span class="r479 r">exprs</span>.<span class="i">Add</span>(<a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r482 r">firstCommandExpr</span>));
                    }
                }
                <b>else</b>
                {
                    <span class="i">Expression</span> <span id="r483 rd" class="r483 r">input</span>;
                    <b>int</b> <span id="r484 rd" class="r484 r">i</span>, <span id="r485 rd" class="r485 r">commandsInPipe</span>;
 
                    <b>if</b> (<span class="r482 r">firstCommandExpr</span> != <b>null</b>)
                    {
                        <b>if</b> (<span class="r482 r">firstCommandExpr</span>.<a href="ast.cs.html#7d87854c277c8363" class="i property">Redirections</a>.<span class="i">Count</span> &gt; 0)
                        {
                            <span class="r483 r">input</span> = <a href="#14a0a997f6484957" class="i method">GetRedirectedExpression</a>(<span class="r482 r">firstCommandExpr</span>, <span class="r263 r">captureForInput</span>: <b>true</b>);
                        }
                        <b>else</b>
                        {
                            <span class="r483 r">input</span> = <a href="#40ca15cc8eff8987" class="i method">GetRangeEnumerator</a>(<span class="r482 r">firstCommandExpr</span>.<a href="ast.cs.html#5e5388d1f86139f7" class="i property">Expression</a>) ??
                                    <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r482 r">firstCommandExpr</span>.<a href="ast.cs.html#5e5388d1f86139f7" class="i property">Expression</a>);
                        }
 
                        <b>if</b> (<span class="r483 r">input</span>.<span class="i">Type</span> == <b>typeof</b>(<b>void</b>))
                        {
                            <span class="r483 r">input</span> = <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r483 r">input</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#84591f5e881dc39e" class="i field">AutomationNullConstant</a>);
                        }
 
                        <span class="r484 r">i</span> = 1;
                        <span class="r485 r">commandsInPipe</span> = <span class="r481 r">pipeElements</span>.<span class="i">Count</span> - 1;
                    }
                    <b>else</b>
                    {
                        <span class="c">// Compiled code normally never sees AutomationNull.  We use that value</span>
                        <span class="c">// here so that we can tell the difference b/w $null and no input when</span>
                        <span class="c">// starting the pipeline, in other words, PipelineOps.InvokePipe will</span>
                        <span class="c">// not pass this value to the pipe.</span>
                        <span class="r483 r">input</span> = <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#84591f5e881dc39e" class="i field">AutomationNullConstant</a>;
                        <span class="r484 r">i</span> = 0;
                        <span class="r485 r">commandsInPipe</span> = <span class="r481 r">pipeElements</span>.<span class="i">Count</span>;
                    }
 
                    <span class="i">Expression</span>[] <span id="r486 rd" class="r486 r">pipelineExprs</span> = <b>new</b> <span class="i">Expression</span>[<span class="r485 r">commandsInPipe</span>];
                    <a href="ast.cs.html#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>[] <span id="r487 rd" class="r487 r">pipeElementAsts</span> = <b>new</b> <a href="ast.cs.html#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>[<span class="r485 r">commandsInPipe</span>];
                    <b>var</b> <span id="r488 rd" class="r488 r">commandRedirections</span> = <b>new</b> <b>object</b>[<span class="r485 r">commandsInPipe</span>];
 
                    <b>for</b> (<b>int</b> <span id="r489 rd" class="r489 r">j</span> = 0; <span class="r484 r">i</span> &lt; <span class="r481 r">pipeElements</span>.<span class="i">Count</span>; ++<span class="r484 r">i</span>, ++<span class="r489 r">j</span>)
                    {
                        <b>var</b> <span id="r490 rd" class="r490 r">pipeElement</span> = <span class="r481 r">pipeElements</span>[<span class="r484 r">i</span>];
                        <span class="r486 r">pipelineExprs</span>[<span class="r489 r">j</span>] = <span class="i">Compile</span>(<span class="r490 r">pipeElement</span>);
 
                        <span class="r488 r">commandRedirections</span>[<span class="r489 r">j</span>] = <span class="i">GetCommandRedirections</span>(<span class="r490 r">pipeElement</span>);
                        <span class="r487 r">pipeElementAsts</span>[<span class="r489 r">j</span>] = <span class="r490 r">pipeElement</span>;
                    }
 
                    <span class="c">// The redirections are passed as a CommandRedirection[][] - one dimension for each command in the pipe,</span>
                    <span class="c">// one dimension because each command may have multiple redirections.  Here we create the array for</span>
                    <span class="c">// each command in the pipe, either a compile time constant or created at runtime if necessary.</span>
                    <span class="i">Expression</span> <span id="r491 rd" class="r491 r">redirectionExpr</span>;
                    <b>if</b> (<span class="r488 r">commandRedirections</span>.<span class="i">Any</span>(<b>static</b> <span id="r492 rd" class="r492 r">r</span> =&gt; <span class="r492 r">r</span> <b>is</b> <span class="i">Expression</span>))
                    {
                        <span class="c">// If any command redirections are non-constant, commandRedirections will have a Linq.Expression in it,</span>
                        <span class="c">// in which case we must create the array at runtime</span>
                        <span class="r491 r">redirectionExpr</span> =
                            <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(
                                <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#51c59304e4c48b1e" class="t t">CommandRedirection</a>[]),
                                <span class="r488 r">commandRedirections</span>.<span class="i">Select</span>(<b>static</b> <span id="r493 rd" class="r493 r">r</span> =&gt; (<span class="r493 r">r</span> <b>as</b> <span class="i">Expression</span>) ?? <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r493 r">r</span>, <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#51c59304e4c48b1e" class="t t">CommandRedirection</a>[]))));
                    }
                    <b>else</b> <b>if</b> (<span class="r488 r">commandRedirections</span>.<span class="i">Any</span>(<b>static</b> <span id="r494 rd" class="r494 r">r</span> =&gt; <span class="r494 r">r</span> != <b>null</b>))
                    {
                        <span class="c">// There were redirections, but all were compile time constant, so build the array at compile time.</span>
                        <span class="r491 r">redirectionExpr</span> =
                            <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r488 r">commandRedirections</span>.<span class="i">Map</span>(<b>static</b> <span id="r495 rd" class="r495 r">r</span> =&gt; <span class="r495 r">r</span> <b>as</b> <a href="../runtime/Operations/MiscOps.cs.html#51c59304e4c48b1e" class="t t">CommandRedirection</a>[]));
                    }
                    <b>else</b>
                    {
                        <span class="c">// No redirections.</span>
                        <span class="r491 r">redirectionExpr</span> = <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#04e1410c375231ac" class="i field">NullCommandRedirections</a>;
                    }
 
                    <b>if</b> (<span class="r482 r">firstCommandExpr</span> != <b>null</b>)
                    {
                        <b>var</b> <span id="r496 rd" class="r496 r">inputTemp</span> = <span class="i">Expression</span>.<span class="i">Variable</span>(<span class="r483 r">input</span>.<span class="i">Type</span>);
                        <span class="r478 r">temps</span>.<span class="i">Add</span>(<span class="r496 r">inputTemp</span>);
                        <span class="r479 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r496 r">inputTemp</span>, <span class="r483 r">input</span>));
                        <span class="r483 r">input</span> = <span class="r496 r">inputTemp</span>;
                    }
 
                    <span class="i">Expression</span> <span id="r497 rd" class="r497 r">invokePipe</span> = <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#eb123eb5584251b6" class="i field">PipelineOps_InvokePipeline</a>,
                        <span class="r483 r">input</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r482 r">firstCommandExpr</span> != <b>null</b> ? <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#b391c2b08d02e390" class="i field">FalseConstant</a> : <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#135da39507c8f0ad" class="i field">TrueConstant</a>,
                        <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<a href="../CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>[]), <span class="r486 r">pipelineExprs</span>),
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r487 r">pipeElementAsts</span>),
                        <span class="r491 r">redirectionExpr</span>,
                        <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>);
                    <span class="r479 r">exprs</span>.<span class="i">Add</span>(<span class="r497 r">invokePipe</span>);
                }
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r478 r">temps</span>, <span class="r479 r">exprs</span>);
        }
 
        <b>private object</b> <a id="0449bacd0a737dcc" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GetCommandRedirections</a>(<a href="ast.cs.html#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a> <span id="r498 rd" class="r498 r">command</span>)
        {
            <b>int</b> <span id="r499 rd" class="r499 r">count</span> = <span class="r498 r">command</span>.<a href="ast.cs.html#7d87854c277c8363" class="i property">Redirections</a>.<span class="i">Count</span>;
            <b>if</b> (<span class="r499 r">count</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
 
            <span class="c">// Most redirections will be instances of CommandRedirection, but non-constant filenames</span>
            <span class="c">// will generated a Linq.Expression, so we store objects.</span>
            <b>object</b>[] <span id="r500 rd" class="r500 r">compiledRedirections</span> = <b>new</b> <b>object</b>[<span class="r499 r">count</span>];
            <b>for</b> (<b>int</b> <span id="r501 rd" class="r501 r">i</span> = 0; <span class="r501 r">i</span> &lt; <span class="r499 r">count</span>; ++<span class="r501 r">i</span>)
            {
                <span class="r500 r">compiledRedirections</span>[<span class="r501 r">i</span>] = <span class="r498 r">command</span>.<a href="ast.cs.html#7d87854c277c8363" class="i property">Redirections</a>[<span class="r501 r">i</span>].<span class="i">Accept</span>(<a href="#8bdfc042f41c96c5" class="k">this</a>);
            }
 
            <span class="c">// If there were any non-constant expressions, we must generate the array at runtime.</span>
            <b>if</b> (<span class="r500 r">compiledRedirections</span>.<span class="i">Any</span>(<b>static</b> <span id="r502 rd" class="r502 r">r</span> =&gt; <span class="r502 r">r</span> <b>is</b> <span class="i">Expression</span>))
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(
                    <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#51c59304e4c48b1e" class="t t">CommandRedirection</a>),
                    <span class="r500 r">compiledRedirections</span>.<span class="i">Select</span>(<b>static</b> <span id="r503 rd" class="r503 r">r</span> =&gt; (<span class="r503 r">r</span> <b>as</b> <span class="i">Expression</span>) ?? <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r503 r">r</span>)));
            }
 
            <span class="c">// Otherwise, we can use a compile time constant array.</span>
            <b>return</b> <span class="r500 r">compiledRedirections</span>.<span class="i">Map</span>(<b>static</b> <span id="r504 rd" class="r504 r">r</span> =&gt; (<a href="../runtime/Operations/MiscOps.cs.html#51c59304e4c48b1e" class="t t">CommandRedirection</a>)<span class="r504 r">r</span>);
        }
 
        <span class="c">// A redirected expression requires extra work because there is no CommandProcessor or PipelineProcessor</span>
        <span class="c">// created to pass the redirections to, so we must change the redirections in the ExecutionContext</span>
        <span class="c">// directly.</span>
        <b>private</b> <span class="i">Expression</span> <a id="14a0a997f6484957" href="../../R/14a0a997f6484957.html" target="n" data-glyph="76,1" class="i method">GetRedirectedExpression</a>(<a href="ast.cs.html#f4da818a29387c5d" class="t t">CommandExpressionAst</a> <span id="r505 rd" class="r505 r">commandExpr</span>, <b>bool</b> <span id="r263 rd" class="r263 r">captureForInput</span>)
        {
            <span class="c">// Generate code like:</span>
            <span class="c">//</span>
            <span class="c">//   try {</span>
            <span class="c">//       oldPipe = funcContext.OutputPipe;</span>
            <span class="c">//       funcContext.OutputPipe = outputFileRedirection.BindForExpression(executionContext);</span>
            <span class="c">//       tmp = nonOutputFileRedirection.BindForExpression(executionContext);</span>
            <span class="c">//       tmp1 = mergingRedirection.BindForExpression(executionContext, funcContext.OutputPipe);</span>
            <span class="c">//       funcContext.OutputPipe.Add(expression...);</span>
            <span class="c">//   } finally {</span>
            <span class="c">//       nonOutputFileRedirection.UnbindForExpression(tmp);</span>
            <span class="c">//       mergingRedirection.UnbindForExpression(tmp1);</span>
            <span class="c">//       nonOutputFileRedirection.Dispose();</span>
            <span class="c">//       outputFileRedirection.Dispose();</span>
            <span class="c">//       funcContext.OutputPipe = oldPipe;</span>
            <span class="c">//   }</span>
            <span class="c">//</span>
            <span class="c">// In the above psuedo-code, any of {outputFileRedirection, nonOutputFileRedirection, mergingRedirection} may</span>
            <span class="c">// not exist, but the order is preserved, so that file redirections go before merging redirections (so that</span>
            <span class="c">// funcContext.OutputPipe has the correct value when setting up merging.)</span>
            <span class="c">//</span>
            <b>var</b> <span id="r506 rd" class="r506 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <b>var</b> <span id="r507 rd" class="r507 r">temps</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt;();
            <b>var</b> <span id="r508 rd" class="r508 r">finallyExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
 
            <span class="c">// For the output stream, we change funcContext.OutputPipe so all output goes to the file.</span>
            <span class="c">// Currently output can only be redirected to a file stream.</span>
            <b>bool</b> <span id="r509 rd" class="r509 r">outputRedirected</span> =
                <span class="r505 r">commandExpr</span>.<a href="ast.cs.html#7d87854c277c8363" class="i property">Redirections</a>.<span class="i">Any</span>(<b>static</b> <span id="r510 rd" class="r510 r">r</span> =&gt; <span class="r510 r">r</span> <b>is</b> <a href="ast.cs.html#2288e8fa779a0d57" class="t t">FileRedirectionAst</a> &amp;&amp;
                                                  (<span class="r510 r">r</span>.<span class="i">FromStream</span> == <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="ast.cs.html#eef57f42e4c4012c" class="i field">Output</a> || <span class="r510 r">r</span>.<span class="i">FromStream</span> == <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="ast.cs.html#e7ee7b8a1be15429" class="i field">All</a>));
 
            <span class="i">ParameterExpression</span> <span id="r511 rd" class="r511 r">resultList</span> = <b>null</b>;
            <span class="i">ParameterExpression</span> <span id="r512 rd" class="r512 r">oldPipe</span> = <b>null</b>;
            <a href="ast.cs.html#e6552a77ab32112a" class="k">var</a> <span id="r513 rd" class="r513 r">subExpr</span> = <span class="r505 r">commandExpr</span>.<a href="ast.cs.html#5e5388d1f86139f7" class="i property">Expression</a> <b>as</b> <a href="ast.cs.html#e6552a77ab32112a" class="t t">SubExpressionAst</a>;
            <b>if</b> (<span class="r513 r">subExpr</span> != <b>null</b> &amp;&amp; <span class="r263 r">captureForInput</span>)
            {
                <span class="r512 r">oldPipe</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<a href="../Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a>), <span class="s">&quot;oldPipe&quot;</span>);
                <span class="r511 r">resultList</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<span class="i">List</span>&lt;<b>object</b>&gt;), <span class="s">&quot;resultList&quot;</span>);
                <span class="r507 r">temps</span>.<span class="i">Add</span>(<span class="r511 r">resultList</span>);
                <span class="r507 r">temps</span>.<span class="i">Add</span>(<span class="r512 r">oldPipe</span>);
                <span class="r506 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r512 r">oldPipe</span>, <a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>));
                <span class="r506 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r511 r">resultList</span>, <span class="i">Expression</span>.<span class="i">New</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#c2ed1032888972a2" class="i field">ObjectList_ctor</a>)));
                <span class="r506 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>, <span class="i">Expression</span>.<span class="i">New</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#ec27b92751d03933" class="i field">Pipe_ctor</a>, <span class="r511 r">resultList</span>)));
                <span class="r506 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Call</span>(<span class="r512 r">oldPipe</span>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#252b3e0e32bf12b9" class="i field">Pipe_SetVariableListForTemporaryPipe</a>, <a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>));
            }
 
            <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r514 rd" class="r514 r">extraFileRedirectExprs</span> = <b>null</b>;
 
            <span class="c">// We must generate the code for output redirection to a file before any merging redirections</span>
            <span class="c">// because merging redirections will use funcContext.OutputPipe as the value to merge to, so defer merging</span>
            <span class="c">// redirections until file redirections are done.</span>
            <b>foreach</b> (<b>var</b> <span id="r515 rd" class="r515 r">fileRedirectionAst</span> <b>in</b> <span class="r505 r">commandExpr</span>.<a href="ast.cs.html#7d87854c277c8363" class="i property">Redirections</a>.<span class="i">OfType</span>&lt;<a href="ast.cs.html#2288e8fa779a0d57" class="t t">FileRedirectionAst</a>&gt;())
            {
                <span class="c">// This will simply return a Linq.Expression representing the redirection.</span>
                <b>var</b> <span id="r516 rd" class="r516 r">compiledRedirection</span> = <span class="i">VisitFileRedirection</span>(<span class="r515 r">fileRedirectionAst</span>);
 
                <b>if</b> (<span class="r514 r">extraFileRedirectExprs</span> == <b>null</b>)
                {
                    <span class="r514 r">extraFileRedirectExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;(<span class="r505 r">commandExpr</span>.<a href="ast.cs.html#7d87854c277c8363" class="i property">Redirections</a>.<span class="i">Count</span>);
                }
 
                <span class="c">// Hold the current &#39;FileRedirection&#39; instance for later use</span>
                <b>var</b> <span id="r517 rd" class="r517 r">redirectionExpr</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#c7517235984e3035" class="t t">FileRedirection</a>), <span class="s">&quot;fileRedirection&quot;</span>);
                <span class="r507 r">temps</span>.<span class="i">Add</span>(<span class="r517 r">redirectionExpr</span>);
                <span class="r506 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r517 r">redirectionExpr</span>, (<span class="i">Expression</span>)<span class="r516 r">compiledRedirection</span>));
 
                <span class="c">// We must save the old streams so they can be restored later.</span>
                <b>var</b> <span id="r518 rd" class="r518 r">savedPipes</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<a href="../Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a>[]), <span class="s">&quot;savedPipes&quot;</span>);
                <span class="r507 r">temps</span>.<span class="i">Add</span>(<span class="r518 r">savedPipes</span>);
                <span class="r506 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(
                    <span class="r518 r">savedPipes</span>,
                    <span class="i">Expression</span>.<span class="i">Call</span>(<span class="r517 r">redirectionExpr</span>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#15871c42691bd5e9" class="i field">FileRedirection_BindForExpression</a>, <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>)));
 
                <span class="c">// We need to call &#39;DoComplete&#39; on the file redirection pipeline processor after writing the stream output to redirection pipe,</span>
                <span class="c">// so that the &#39;EndProcessing&#39; method of &#39;Out-File&#39; would be called as expected.</span>
                <span class="c">// Expressions for this purpose are kept in &#39;extraFileRedirectExprs&#39; and will be used later.</span>
                <span class="r514 r">extraFileRedirectExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Call</span>(<span class="r517 r">redirectionExpr</span>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#1acafd7333f0e704" class="i field">FileRedirection_CallDoCompleteForExpression</a>));
 
                <span class="c">// The &#39;UnBind&#39; and &#39;Dispose&#39; operations on &#39;FileRedirection&#39; objects must be done in the reverse order of &#39;Bind&#39; operations.</span>
                <span class="c">// Namely, it should be done is this order:</span>
                <span class="c">//   try {</span>
                <span class="c">//       // The order is A, B</span>
                <span class="c">//       fileRedirectionA = new FileRedirection(..)</span>
                <span class="c">//       fileRedirectionA.BindForExpression()</span>
                <span class="c">//       fileRedirectionB = new FileRedirection(..)</span>
                <span class="c">//       fileRedirectionB.BindForExpression()</span>
                <span class="c">//       ...</span>
                <span class="c">//   } finally {</span>
                <span class="c">//       // The oder must be B, A</span>
                <span class="c">//       fileRedirectionB.UnBind()</span>
                <span class="c">//       fileRedirectionB.Dispose()</span>
                <span class="c">//       fileRedirectionA.UnBind()</span>
                <span class="c">//       fileRedirectionA.Dispose()</span>
                <span class="c">//   }</span>
                <span class="c">//</span>
                <span class="c">// Otherwise, the original pipe might not be correctly restored in the end. For example,</span>
                <span class="c">// &#39;1 *&gt; b.txt &gt; a.txt; 123&#39; would result in the following error when evaluating &#39;123&#39;:</span>
                <span class="c">//   &quot;Cannot perform operation because object &quot;PipelineProcessor&quot; has already been disposed&quot;</span>
                <span class="r508 r">finallyExprs</span>.<span class="i">Insert</span>(0, <span class="i">Expression</span>.<span class="i">Call</span>(
                    <span class="r517 r">redirectionExpr</span>.<span class="i">Cast</span>(<b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#51c59304e4c48b1e" class="t t">CommandRedirection</a>)),
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#128a5a3c25771a1b" class="i field">CommandRedirection_UnbindForExpression</a>,
                    <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>,
                    <span class="r518 r">savedPipes</span>));
 
                <span class="c">// In either case, we must dispose of the redirection or file handles won&#39;t get released.</span>
                <span class="r508 r">finallyExprs</span>.<span class="i">Insert</span>(1, <span class="i">Expression</span>.<span class="i">Call</span>(<span class="r517 r">redirectionExpr</span>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#da99f0039214b1a4" class="i field">FileRedirection_Dispose</a>));
            }
 
            <span class="i">Expression</span> <span id="r519 rd" class="r519 r">result</span> = <b>null</b>;
            <a href="ast.cs.html#a9797c05604b61e8" class="k">var</a> <span id="r520 rd" class="r520 r">parenExpr</span> = <span class="r505 r">commandExpr</span>.<a href="ast.cs.html#5e5388d1f86139f7" class="i property">Expression</a> <b>as</b> <a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a>;
            <b>if</b> (<span class="r520 r">parenExpr</span> != <b>null</b>)
            {
                <span class="c">// Special processing for paren expressions that capture output.</span>
                <span class="c">// Insert any merge redirect expressions during paren expression compilation.</span>
                <a href="ast.cs.html#da5f345864f42e06" class="k">var</a> <span id="r521 rd" class="r521 r">assignmentStatementAst</span> = <span class="r520 r">parenExpr</span>.<a href="ast.cs.html#021e323175cb804d" class="i property">Pipeline</a> <b>as</b> <a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a>;
                <b>if</b> (<span class="r521 r">assignmentStatementAst</span> != <b>null</b>)
                {
                    <span class="r519 r">result</span> = <span class="i">CompileAssignment</span>(
                        <span class="r521 r">assignmentStatementAst</span>,
                        (<span id="r522 rd" class="r522 r">mergeExprs</span>, <span id="r523 rd" class="r523 r">mergeFinallyExprs</span>) =&gt; <a href="#dc01ee66cf690d72" class="i method">AddMergeRedirectionExpressions</a>(<span class="r505 r">commandExpr</span>.<a href="ast.cs.html#7d87854c277c8363" class="i property">Redirections</a>, <span class="r507 r">temps</span>, <span class="r522 r">mergeExprs</span>, <span class="r523 r">mergeFinallyExprs</span>));
                }
                <b>else</b>
                {
                    <b>bool</b> <span id="r524 rd" class="r524 r">shouldPreserveResultInCaseofException</span> = <span class="r520 r">parenExpr</span>.<a href="ast.cs.html#9735bf42b0a863cd" class="i method">ShouldPreserveOutputInCaseOfException</a>();
                    <span class="r519 r">result</span> = <span class="i">CaptureAstResults</span>(
                        <span class="r520 r">parenExpr</span>.<a href="ast.cs.html#021e323175cb804d" class="i property">Pipeline</a>,
                        <span class="r524 r">shouldPreserveResultInCaseofException</span>
                                ? <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#8ca51373a8261dd1" class="i field">AssignmentWithResultPreservation</a>
                                : <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>,
                        (<span id="r525 rd" class="r525 r">mergeExprs</span>, <span id="r526 rd" class="r526 r">mergeFinallyExprs</span>) =&gt; <a href="#dc01ee66cf690d72" class="i method">AddMergeRedirectionExpressions</a>(<span class="r505 r">commandExpr</span>.<a href="ast.cs.html#7d87854c277c8363" class="i property">Redirections</a>, <span class="r507 r">temps</span>, <span class="r525 r">mergeExprs</span>, <span class="r526 r">mergeFinallyExprs</span>));
                }
            }
            <b>else</b> <b>if</b> (<span class="r513 r">subExpr</span> != <b>null</b>)
            {
                <span class="c">// Include any redirection merging.</span>
                <a href="#dc01ee66cf690d72" class="i method">AddMergeRedirectionExpressions</a>(<span class="r505 r">commandExpr</span>.<a href="ast.cs.html#7d87854c277c8363" class="i property">Redirections</a>, <span class="r507 r">temps</span>, <span class="r506 r">exprs</span>, <span class="r508 r">finallyExprs</span>);
 
                <span class="r506 r">exprs</span>.<span class="i">Add</span>(<a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r513 r">subExpr</span>.<a href="ast.cs.html#ec0bda1def565114" class="i property">SubExpression</a>));
                <b>if</b> (<span class="r511 r">resultList</span> != <b>null</b>)
                {
                    <span class="c">// If there is no resultList, we wrote our results of the subexpression directly to the pipe</span>
                    <span class="c">// instead of being collected to be written here.</span>
                    <span class="r519 r">result</span> = <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#f6995ac2d8b37cdd" class="i field">PipelineOps_PipelineResult</a>, <span class="r511 r">resultList</span>);
                }
            }
            <b>else</b>
            {
                <span class="c">// Include any redirection merging.</span>
                <a href="#dc01ee66cf690d72" class="i method">AddMergeRedirectionExpressions</a>(<span class="r505 r">commandExpr</span>.<a href="ast.cs.html#7d87854c277c8363" class="i property">Redirections</a>, <span class="r507 r">temps</span>, <span class="r506 r">exprs</span>, <span class="r508 r">finallyExprs</span>);
 
                <span class="r519 r">result</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r505 r">commandExpr</span>.<a href="ast.cs.html#5e5388d1f86139f7" class="i property">Expression</a>);
            }
 
            <b>if</b> (<span class="r519 r">result</span> != <b>null</b>)
            {
                <b>if</b> (!<span class="r509 r">outputRedirected</span> &amp;&amp; <span class="r263 r">captureForInput</span>)
                {
                    <span class="c">// If we are capturing the input (for code like:  $foo.Bar() 2&gt;&amp;1 | downstream), then we must</span>
                    <span class="c">// capture the expression results, unless output was redirected to a file because in that case,</span>
                    <span class="c">// the output can go straight to a file.</span>
                    <span class="r506 r">exprs</span>.<span class="i">Add</span>(<span class="r519 r">result</span>);
                }
                <b>else</b>
                {
                    <span class="r506 r">exprs</span>.<span class="i">Add</span>(<a href="#fd7d0a43cbb942fa" class="i method">CallAddPipe</a>(<span class="r519 r">result</span>, <a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>));
 
                    <span class="c">// Make sure the result of the expression we return is AutomationNull.Value.</span>
                    <span class="r506 r">exprs</span>.<span class="i">Add</span>(<a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#84591f5e881dc39e" class="i field">AutomationNullConstant</a>);
                }
            }
 
            <b>if</b> (<span class="r514 r">extraFileRedirectExprs</span> != <b>null</b>)
            {
                <span class="c">// Now that the redirection is done, we need to call &#39;DoComplete&#39; on the file redirection pipeline processors.</span>
                <span class="c">// Exception may be thrown when running &#39;DoComplete&#39;, but we don&#39;t want the exception to affect the cleanup</span>
                <span class="c">// work in &#39;finallyExprs&#39;. We generate the following code to make sure it does what we want.</span>
                <span class="c">//   try {</span>
                <span class="c">//       try {</span>
                <span class="c">//           exprs</span>
                <span class="c">//       } finally {</span>
                <span class="c">//           extraFileRedirectExprs</span>
                <span class="c">//       }</span>
                <span class="c">//   finally {</span>
                <span class="c">//       finallyExprs</span>
                <span class="c">//   }</span>
                <b>var</b> <span id="r527 rd" class="r527 r">wrapExpr</span> = <span class="i">Expression</span>.<span class="i">TryFinally</span>(<span class="i">Expression</span>.<span class="i">Block</span>(<span class="r506 r">exprs</span>), <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r514 r">extraFileRedirectExprs</span>));
                <span class="r506 r">exprs</span>.<span class="i">Clear</span>();
                <span class="r506 r">exprs</span>.<span class="i">Add</span>(<span class="r527 r">wrapExpr</span>);
            }
 
            <b>if</b> (<span class="r512 r">oldPipe</span> != <b>null</b>)
            {
                <span class="c">// If a temporary pipe was created at the beginning, we should restore the original pipe in the</span>
                <span class="c">// very end of the finally block. Otherwise, s_getCurrentPipe may be messed up by the following</span>
                <span class="c">// file redirection unbind operation.</span>
                <span class="c">// For example:</span>
                <span class="c">//    function foo</span>
                <span class="c">//    {</span>
                <span class="c">//       [cmdletbinding()]</span>
                <span class="c">//       param()</span>
                <span class="c">//       $(gcm NoExist) &gt; test.txt | % { $_ }  ## file redirect with new temp pipe</span>
                <span class="c">//       &quot;hello&quot;</span>
                <span class="c">//    }</span>
                <span class="c">// before this change, running &#39;foo&#39; will not write out &#39;hello&#39;.</span>
                <span class="r508 r">finallyExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>, <span class="r512 r">oldPipe</span>));
            }
 
            <b>if</b> (<span class="r508 r">finallyExprs</span>.<span class="i">Count</span> != 0)
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r507 r">temps</span>.<span class="i">ToArray</span>(), <span class="i">Expression</span>.<span class="i">TryFinally</span>(<span class="i">Expression</span>.<span class="i">Block</span>(<span class="r506 r">exprs</span>), <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r508 r">finallyExprs</span>)));
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r507 r">temps</span>.<span class="i">ToArray</span>(), <span class="r506 r">exprs</span>);
        }
 
        <b>private void</b> <a id="dc01ee66cf690d72" href="../../R/dc01ee66cf690d72.html" target="n" data-glyph="76,1" class="i method">AddMergeRedirectionExpressions</a>(
            <span class="i">ReadOnlyCollection</span>&lt;<a href="ast.cs.html#62235daca4a9c495" class="t t">RedirectionAst</a>&gt; <span id="r528 rd" class="r528 r">redirections</span>,
            <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt; <span id="r529 rd" class="r529 r">temps</span>,
            <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r530 rd" class="r530 r">exprs</span>,
            <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r531 rd" class="r531 r">finallyExprs</span>)
        {
            <b>foreach</b> (<b>var</b> <span id="r532 rd" class="r532 r">mergingRedirectionAst</span> <b>in</b> <span class="r528 r">redirections</span>.<span class="i">OfType</span>&lt;<a href="ast.cs.html#57ad2a29a39e91e6" class="t t">MergingRedirectionAst</a>&gt;())
            {
                <b>var</b> <span id="r533 rd" class="r533 r">savedPipes</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<a href="../Pipe.cs.html#59f1a03e60a5aa51" class="t t">Pipe</a>[]), <span class="s">&quot;savedPipes&quot;</span>);
                <span class="r529 r">temps</span>.<span class="i">Add</span>(<span class="r533 r">savedPipes</span>);
                <b>var</b> <span id="r534 rd" class="r534 r">redirectionExpr</span> = <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="i">VisitMergingRedirection</span>(<span class="r532 r">mergingRedirectionAst</span>));
                <span class="r530 r">exprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r533 r">savedPipes</span>,
                                      <span class="i">Expression</span>.<span class="i">Call</span>(
                                          <span class="r534 r">redirectionExpr</span>,
                                            <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#554079b715c85ce9" class="i field">MergingRedirection_BindForExpression</a>,
                                            <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                                            <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>)));
 
                <span class="c">// Undo merging redirections first (so file redirections get undone after).</span>
                <span class="r531 r">finallyExprs</span>.<span class="i">Insert</span>(0, <span class="i">Expression</span>.<span class="i">Call</span>(
                    <span class="r534 r">redirectionExpr</span>.<span class="i">Cast</span>(<b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#51c59304e4c48b1e" class="t t">CommandRedirection</a>)),
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#128a5a3c25771a1b" class="i field">CommandRedirection_UnbindForExpression</a>,
                    <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>,
                    <span class="r533 r">savedPipes</span>));
            }
        }
 
        <b>public object</b> <a id="d27fe5d17afccb99" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitMergingRedirection</a>(<a href="ast.cs.html#57ad2a29a39e91e6" class="t t">MergingRedirectionAst</a> <span id="r535 rd" class="r535 r">mergingRedirectionAst</span>)
        {
            <span class="c">// Most Visit* methods return a Linq.Expression, this method being an exception.  VisitPipeline</span>
            <span class="c">// may be able to pass a compile time array of redirections if all of the redirections are</span>
            <span class="c">// constant.  Merging redirections never vary at runtime, so there is no sense in deferring</span>
            <span class="c">// the creation of the merging object until runtime.</span>
            <b>return</b> <b>new</b> <a href="../runtime/Operations/MiscOps.cs.html#15a7e77385afa90a" class="t constructor">MergingRedirection</a>(<span class="r535 r">mergingRedirectionAst</span>.<a href="ast.cs.html#54d26a89dbf0384f" class="i property">FromStream</a>, <span class="r535 r">mergingRedirectionAst</span>.<a href="ast.cs.html#f0ccba0030de4284" class="i property">ToStream</a>);
        }
 
        <b>public object</b> <a id="246ae7dfef0c28bf" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitFileRedirection</a>(<a href="ast.cs.html#2288e8fa779a0d57" class="t t">FileRedirectionAst</a> <span id="r536 rd" class="r536 r">fileRedirectionAst</span>)
        {
            <span class="i">Expression</span> <span id="r537 rd" class="r537 r">fileNameExpr</span>;
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r538 rd" class="r538 r">strConst</span> = <span class="r536 r">fileRedirectionAst</span>.<a href="ast.cs.html#387c7bd2fd1d9d89" class="i property">Location</a> <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
            <b>if</b> (<span class="r538 r">strConst</span> != <b>null</b>)
            {
                <span class="c">// When the filename is a constant, we still must generate a new FileRedirection</span>
                <span class="c">// at runtime because we can&#39;t keep a cached object in the closure because the object</span>
                <span class="c">// is disposed after executing the command.</span>
                <span class="r537 r">fileNameExpr</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r538 r">strConst</span>);
            }
            <b>else</b>
            {
                <span class="c">// The filename is not constant, so we must generate code to evaluate the filename at runtime.</span>
                <span class="r537 r">fileNameExpr</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                    <a href="../runtime/Binding/Binders.cs.html#db2e7c67b332caf6" class="t t">PSToStringBinder</a>.<a href="../runtime/Binding/Binders.cs.html#7a771c568a738822" class="i method">Get</a>(),
                    <b>typeof</b>(<b>string</b>),
                    <a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r536 r">fileRedirectionAst</span>.<a href="ast.cs.html#387c7bd2fd1d9d89" class="i property">Location</a>),
                    <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>);
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">New</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#2b17bcbb5e2d60f3" class="i field">FileRedirection_ctor</a>,
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r536 r">fileRedirectionAst</span>.<a href="ast.cs.html#54d26a89dbf0384f" class="i property">FromStream</a>),
                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<span class="r536 r">fileRedirectionAst</span>.<a href="ast.cs.html#394a80d552aaa2ca" class="i property">Append</a>),
                <span class="r537 r">fileNameExpr</span>);
        }
 
        <b>public object</b> <a id="80a564df179f7718" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitCommand</a>(<a href="ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a> <span id="r539 rd" class="r539 r">commandAst</span>)
        {
            <b>var</b> <span id="r540 rd" class="r540 r">commandElements</span> = <span class="r539 r">commandAst</span>.<a href="ast.cs.html#f3fdfe686fb0ef19" class="i property">CommandElements</a>;
            <span class="i">Expression</span>[] <span id="r541 rd" class="r541 r">elementExprs</span> = <b>new</b> <span class="i">Expression</span>[<span class="r540 r">commandElements</span>.<span class="i">Count</span>];
 
            <b>for</b> (<b>int</b> <span id="r542 rd" class="r542 r">i</span> = 0; <span class="r542 r">i</span> &lt; <span class="r540 r">commandElements</span>.<span class="i">Count</span>; ++<span class="r542 r">i</span>)
            {
                <b>var</b> <span id="r543 rd" class="r543 r">element</span> = <span class="r540 r">commandElements</span>[<span class="r542 r">i</span>];
                <b>if</b> (<span class="r543 r">element</span> <b>is</b> <a href="ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a>)
                {
                    <span class="r541 r">elementExprs</span>[<span class="r542 r">i</span>] = <span class="i">Compile</span>(<span class="r543 r">element</span>);
                }
                <b>else</b>
                {
                    <b>var</b> <span id="r544 rd" class="r544 r">splatTest</span> = <span class="r543 r">element</span>;
                    <b>bool</b> <span id="r545 rd" class="r545 r">splatted</span> = <b>false</b>;
 
                    <a href="ast.cs.html#42d36b88817a807f" class="t t">UsingExpressionAst</a> <span id="r546 rd" class="r546 r">usingExpression</span> = <span class="r543 r">element</span> <b>as</b> <a href="ast.cs.html#42d36b88817a807f" class="t t">UsingExpressionAst</a>;
                    <b>if</b> (<span class="r546 r">usingExpression</span> != <b>null</b>)
                    {
                        <span class="r544 r">splatTest</span> = <span class="r546 r">usingExpression</span>.<a href="ast.cs.html#eb8bbf44ea3ab101" class="i property">SubExpression</a>;
                    }
 
                    <a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r547 rd" class="r547 r">variableExpression</span> = <span class="r544 r">splatTest</span> <b>as</b> <a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>;
                    <b>if</b> (<span class="r547 r">variableExpression</span> != <b>null</b>)
                    {
                        <span class="r545 r">splatted</span> = <span class="r547 r">variableExpression</span>.<a href="ast.cs.html#7f1485a08eb97fcc" class="i property">Splatted</a>;
                    }
 
                    <span class="r541 r">elementExprs</span>[<span class="r542 r">i</span>] = <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#ef68c30f8acb5177" class="i field">CommandParameterInternal_CreateArgument</a>,
                        <span class="i">Expression</span>.<span class="i">Convert</span>(<span class="i">GetCommandArgumentExpression</span>(<span class="r543 r">element</span>), <b>typeof</b>(<b>object</b>)),
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r543 r">element</span>),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<span class="r545 r">splatted</span>));
                }
            }
 
            <span class="i">Expression</span> <span id="r548 rd" class="r548 r">result</span> = <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<a href="../CommandParameter.cs.html#4e36e2c205cfc418" class="t t">CommandParameterInternal</a>), <span class="r541 r">elementExprs</span>);
 
            <b>if</b> (<span class="r540 r">commandElements</span>.<span class="i">Count</span> == 2 &amp;&amp; <span class="r540 r">commandElements</span>[1] <b>is</b> <a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a>)
            {
                <span class="c">// If they used method invocation syntax, we want a strict mode error.  We can&#39;t</span>
                <span class="c">// check that at compile time as it might change at runtime, so we&#39;ll add a runtime check.</span>
                <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r549 rd" class="r549 r">args</span> = ((<a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a>)<span class="r540 r">commandElements</span>[1]).<a href="ast.cs.html#021e323175cb804d" class="i property">Pipeline</a>.<a href="ast.cs.html#158661f5f6c8db6d" class="i method">GetPureExpression</a>();
                <b>if</b> (<span class="r549 r">args</span> <b>is</b> <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>)
                {
                    <b>if</b> (<span class="r540 r">commandElements</span>[0].<span class="i">Extent</span>.<span class="i">EndColumnNumber</span> == <span class="r540 r">commandElements</span>[1].<span class="i">Extent</span>.<span class="i">StartColumnNumber</span>
                        &amp;&amp; <span class="r540 r">commandElements</span>[0].<span class="i">Extent</span>.<span class="i">EndLineNumber</span> == <span class="r540 r">commandElements</span>[1].<span class="i">Extent</span>.<span class="i">StartLineNumber</span>)
                    {
                        <span class="c">// no whitespace b/w command name and paren, add a strict mode check</span>
                        <span class="r548 r">result</span> = <span class="i">Expression</span>.<span class="i">Block</span>(
                            <span class="i">Expression</span>.<span class="i">IfThen</span>(
                                <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">IsStrictMode</span>(2, <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>),
                                <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">ThrowRuntimeError</span>(<span class="s">&quot;StrictModeFunctionCallWithParens&quot;</span>, <span class="i">ParserStrings</span>.<span class="i">StrictModeFunctionCallWithParens</span>)),
                            <span class="r548 r">result</span>);
                    }
                }
            }
 
            <b>return</b> <span class="r548 r">result</span>;
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="4632bfae21bd4f4c" href="../../R/4632bfae21bd4f4c.html" target="n" data-glyph="76,1" class="i method">GetCommandArgumentExpression</a>(<a href="ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r550 rd" class="r550 r">element</span>)
        {
            <a href="ast.cs.html#ebd8ad798cde7861" class="k">var</a> <span id="r551 rd" class="r551 r">constElement</span> = <span class="r550 r">element</span> <b>as</b> <a href="ast.cs.html#ebd8ad798cde7861" class="t t">ConstantExpressionAst</a>;
            <b>if</b> (<span class="r551 r">constElement</span> != <b>null</b>
                &amp;&amp; (<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#e25b1c6d235a82c5" class="i method">IsNumeric</a>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#b95fb4b37c36d13d" class="i method">GetTypeCode</a>(<span class="r551 r">constElement</span>.<a href="ast.cs.html#499ea06e07fb9bb8" class="i property">StaticType</a>))
                || <span class="r551 r">constElement</span>.<a href="ast.cs.html#499ea06e07fb9bb8" class="i property">StaticType</a> == <b>typeof</b>(<span class="i n">System</span>.<span class="i">Numerics</span>.<span class="i">BigInteger</span>)))
            {
                <b>var</b> <span id="r552 rd" class="r552 r">commandArgumentText</span> = <span class="r551 r">constElement</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>;
                <b>if</b> (!<span class="r552 r">commandArgumentText</span>.<span class="i">Equals</span>(<span class="r551 r">constElement</span>.<a href="ast.cs.html#8e2d2054af044253" class="i property">Value</a>.<span class="i">ToString</span>(), <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                {
                    <span class="c">// If the ToString on the constant would differ from what the user specified, then wrap the</span>
                    <span class="c">// value so we can recover the actual argument text.</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Constant</span>(<a href="../lang/parserutils.cs.html#c3c23681c37cee0a" class="t t">ParserOps</a>.<a href="../lang/parserutils.cs.html#f49d09f3854546b1" class="i method">WrappedNumber</a>(<span class="r551 r">constElement</span>.<a href="ast.cs.html#8e2d2054af044253" class="i property">Value</a>, <span class="r552 r">commandArgumentText</span>));
                }
            }
 
            <b>var</b> <span id="r553 rd" class="r553 r">result</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r550 r">element</span>);
            <b>if</b> (<span class="r553 r">result</span>.<span class="i">Type</span> == <b>typeof</b>(<b>object</b>[]))
            {
                <span class="r553 r">result</span> = <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#fa946d729be26e44" class="i field">PipelineOps_CheckAutomationNullInCommandArgumentArray</a>, <span class="r553 r">result</span>);
            }
            <b>else</b> <b>if</b> (<span class="r551 r">constElement</span> == <b>null</b> &amp;&amp; <span class="r553 r">result</span>.<span class="i">Type</span> == <b>typeof</b>(<b>object</b>))
            {
                <span class="r553 r">result</span> = <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#e94085b46a59e850" class="i field">PipelineOps_CheckAutomationNullInCommandArgument</a>, <span class="r553 r">result</span>);
            }
 
            <b>return</b> <span class="r553 r">result</span>;
        }
 
        <b>public object</b> <a id="3fc364e95bd3f5be" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitCommandExpression</a>(<a href="ast.cs.html#f4da818a29387c5d" class="t t">CommandExpressionAst</a> <span id="r554 rd" class="r554 r">commandExpressionAst</span>)
        {
            <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r555 rd" class="r555 r">child</span> = <span class="r554 r">commandExpressionAst</span>.<a href="ast.cs.html#5e5388d1f86139f7" class="i property">Expression</a>;
            <b>var</b> <span id="r556 rd" class="r556 r">expr</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r555 r">child</span>);
            <a href="ast.cs.html#ee62c8a99269d267" class="k">var</a> <span id="r557 rd" class="r557 r">unary</span> = <span class="r555 r">child</span> <b>as</b> <a href="ast.cs.html#ee62c8a99269d267" class="t t">UnaryExpressionAst</a>;
            <b>if</b> ((<span class="r557 r">unary</span> != <b>null</b> &amp;&amp; <span class="r557 r">unary</span>.<a href="ast.cs.html#1ce84eccd8a75fa0" class="i property">TokenKind</a>.<a href="token.cs.html#84def6774d758bed" class="i method">HasTrait</a>(<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#9bce357215c17689" class="i field">PrefixOrPostfixOperator</a>)) || <span class="r556 r">expr</span>.<span class="i">Type</span> == <b>typeof</b>(<b>void</b>))
            {
                <b>return</b> <span class="r556 r">expr</span>;
            }
 
            <b>return</b> <a href="#fd7d0a43cbb942fa" class="i method">CallAddPipe</a>(<span class="r556 r">expr</span>, <a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>);
        }
 
        <b>public object</b> <a id="fe39eeeec981f29d" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitCommandParameter</a>(<a href="ast.cs.html#b97c3b8b32a8faec" class="t t">CommandParameterAst</a> <span id="r558 rd" class="r558 r">commandParameterAst</span>)
        {
            <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r559 rd" class="r559 r">arg</span> = <span class="r558 r">commandParameterAst</span>.<a href="ast.cs.html#21fa828caf096206" class="i property">Argument</a>;
            <a href="Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r560 rd" class="r560 r">errorPos</span> = <span class="r558 r">commandParameterAst</span>.<a href="ast.cs.html#c02cc0fd1f27d9da" class="i property">ErrorPosition</a>;
            <b>if</b> (<span class="r559 r">arg</span> != <b>null</b>)
            {
                <b>bool</b> <span id="r561 rd" class="r561 r">spaceAfterParameter</span> = <span class="r560 r">errorPos</span>.<a href="Position.cs.html#ccd649a5269e237d" class="i property">EndLineNumber</a> != <span class="r559 r">arg</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a> ||
                                           <span class="r560 r">errorPos</span>.<a href="Position.cs.html#155675f601d14734" class="i property">EndColumnNumber</a> != <span class="r559 r">arg</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>;
                <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#2a0f8b0d12c5e68e" class="i field">CommandParameterInternal_CreateParameterWithArgument</a>,
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r558 r">commandParameterAst</span>),
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r558 r">commandParameterAst</span>.<a href="ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>),
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r560 r">errorPos</span>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>),
                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r559 r">arg</span>),
                    <span class="i">Expression</span>.<span class="i">Convert</span>(<a href="#4632bfae21bd4f4c" class="i method">GetCommandArgumentExpression</a>(<span class="r559 r">arg</span>), <b>typeof</b>(<b>object</b>)),
                    <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<span class="r561 r">spaceAfterParameter</span>),
                    <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>false</b>));
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#195ec62902920d23" class="i field">CommandParameterInternal_CreateParameter</a>,
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r558 r">commandParameterAst</span>.<a href="ast.cs.html#0a26f1be6b3fd748" class="i property">ParameterName</a>),
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r560 r">errorPos</span>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>),
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r558 r">commandParameterAst</span>));
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="d9379e1339fed7c3" href="../../R/d9379e1339fed7c3.html" target="n" data-glyph="74,1" class="i method">ThrowRuntimeError</a>(<b>string</b> <span id="r562 rd" class="r562 r">errorID</span>, <b>string</b> <span id="r563 rd" class="r563 r">resourceString</span>, <b>params</b> <span class="i">Expression</span>[] <span id="r564 rd" class="r564 r">exceptionArgs</span>)
        {
            <b>return</b> <span class="i">ThrowRuntimeError</span>(<span class="r562 r">errorID</span>, <span class="r563 r">resourceString</span>, <b>typeof</b>(<b>object</b>), <span class="r564 r">exceptionArgs</span>);
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="e69f1bdfde36f991" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ThrowRuntimeError</a>(<b>string</b> <span id="r565 rd" class="r565 r">errorID</span>, <b>string</b> <span id="r566 rd" class="r566 r">resourceString</span>, <span class="i">Type</span> <span id="r567 rd" class="r567 r">throwResultType</span>, <b>params</b> <span class="i">Expression</span>[] <span id="r568 rd" class="r568 r">exceptionArgs</span>)
        {
            <b>return</b> <span class="i">ThrowRuntimeError</span>(<b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="r565 r">errorID</span>, <span class="r566 r">resourceString</span>, <span class="r567 r">throwResultType</span>, <span class="r568 r">exceptionArgs</span>);
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="ee4c306856803ce1" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ThrowRuntimeError</a>(<span class="i">Type</span> <span id="r569 rd" class="r569 r">exceptionType</span>, <b>string</b> <span id="r570 rd" class="r570 r">errorID</span>, <b>string</b> <span id="r571 rd" class="r571 r">resourceString</span>, <span class="i">Type</span> <span id="r572 rd" class="r572 r">throwResultType</span>, <b>params</b> <span class="i">Expression</span>[] <span id="r573 rd" class="r573 r">exceptionArgs</span>)
        {
            <b>var</b> <span id="r574 rd" class="r574 r">exceptionArgArray</span> = <span class="r573 r">exceptionArgs</span> != <b>null</b>
                                        ? <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<b>object</b>), <span class="r573 r">exceptionArgs</span>.<span class="i">Select</span>(<b>static</b> <span id="r575 rd" class="r575 r">e</span> =&gt; <span class="r575 r">e</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>))))
                                        : <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>;
            <span class="i">Expression</span>[] <span id="r576 rd" class="r576 r">argExprs</span> = <b>new</b> <span class="i">Expression</span>[]
            {
                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>,                        <span class="c">// targetObject</span>
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r569 r">exceptionType</span>, <b>typeof</b>(<span class="i">Type</span>)),    <span class="c">// exceptionType</span>
                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#635c2cd971f6dfae" class="i field">NullExtent</a>,                          <span class="c">// errorPosition</span>
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r570 r">errorID</span>),                        <span class="c">// ErrorID</span>
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r571 r">resourceString</span>),                 <span class="c">// error message</span>
                <span class="r574 r">exceptionArgArray</span>                                    <span class="c">// args to use when formatting error message</span>
            };
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Throw</span>(
                <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#da166005df553588" class="i field">InterpreterError_NewInterpreterException</a>, <span class="r576 r">argExprs</span>),
                <span class="r572 r">throwResultType</span>);
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="d7e50d126e067b5f" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ThrowRuntimeErrorWithInnerException</a>(
            <b>string</b> <span id="r577 rd" class="r577 r">errorID</span>,
            <b>string</b> <span id="r578 rd" class="r578 r">resourceString</span>,
            <span class="i">Expression</span> <span id="r579 rd" class="r579 r">innerException</span>,
            <b>params</b> <span class="i">Expression</span>[] <span id="r580 rd" class="r580 r">exceptionArgs</span>)
        {
            <b>return</b> <span class="i">ThrowRuntimeErrorWithInnerException</span>(<span class="r577 r">errorID</span>, <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r578 r">resourceString</span>), <span class="r579 r">innerException</span>, <b>typeof</b>(<b>object</b>), <span class="r580 r">exceptionArgs</span>);
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="18497675e197757e" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">ThrowRuntimeErrorWithInnerException</a>(
            <b>string</b> <span id="r581 rd" class="r581 r">errorID</span>,
            <span class="i">Expression</span> <span id="r582 rd" class="r582 r">resourceString</span>,
            <span class="i">Expression</span> <span id="r583 rd" class="r583 r">innerException</span>,
            <span class="i">Type</span> <span id="r584 rd" class="r584 r">throwResultType</span>,
            <b>params</b> <span class="i">Expression</span>[] <span id="r585 rd" class="r585 r">exceptionArgs</span>)
        {
            <b>var</b> <span id="r586 rd" class="r586 r">exceptionArgArray</span> = <span class="r585 r">exceptionArgs</span> != <b>null</b>
                                        ? <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<b>object</b>), <span class="r585 r">exceptionArgs</span>)
                                        : <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>;
            <span class="i">Expression</span>[] <span id="r587 rd" class="r587 r">argExprs</span> = <b>new</b> <span class="i">Expression</span>[]
            {
                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>,                                   <span class="c">// targetObject</span>
                <span class="i">Expression</span>.<span class="i">Constant</span>(<b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <b>typeof</b>(<span class="i">Type</span>)),    <span class="c">// exceptionType</span>
                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#635c2cd971f6dfae" class="i field">NullExtent</a>,                                     <span class="c">// errorPosition</span>
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r581 r">errorID</span>),                                   <span class="c">// ErrorID</span>
                <span class="r582 r">resourceString</span>,                                                 <span class="c">// error message</span>
                <span class="r583 r">innerException</span>,                                                 <span class="c">// innerException</span>
                <span class="r586 r">exceptionArgArray</span>                                               <span class="c">// args to use when formatting error message</span>
            };
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Throw</span>(
                <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#b72ce5bb406731be" class="i field">InterpreterError_NewInterpreterExceptionWithInnerException</a>, <span class="r587 r">argExprs</span>),
                <span class="r584 r">throwResultType</span>);
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="7f85b71f6e706023" href="../../R/7f85b71f6e706023.html" target="n" data-glyph="74,1" class="i method">CreateThrow</a>(<span class="i">Type</span> <span id="r588 rd" class="r588 r">resultType</span>, <span class="i">Type</span> <span id="r589 rd" class="r589 r">exception</span>, <span class="i">Type</span>[] <span id="r590 rd" class="r590 r">exceptionArgTypes</span>, <b>params object</b>[] <span id="r591 rd" class="r591 r">exceptionArgs</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r590 r">exceptionArgTypes</span>.<span class="i">Length</span> == <span class="r591 r">exceptionArgs</span>.<span class="i">Length</span>, <span class="s">&quot;types count must match args count for constructor call.&quot;</span>);
 
            <span class="i">Expression</span>[] <span id="r592 rd" class="r592 r">argExprs</span> = <b>new</b> <span class="i">Expression</span>[<span class="r591 r">exceptionArgs</span>.<span class="i">Length</span>];
            <b>for</b> (<b>int</b> <span id="r593 rd" class="r593 r">i</span> = 0; <span class="r593 r">i</span> &lt; <span class="r591 r">exceptionArgs</span>.<span class="i">Length</span>; <span class="r593 r">i</span>++)
            {
                <b>object</b> <span id="r594 rd" class="r594 r">o</span> = <span class="r591 r">exceptionArgs</span>[<span class="r593 r">i</span>];
                <span class="i">Expression</span> <span id="r595 rd" class="r595 r">e</span> = <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r594 r">o</span>, <span class="r590 r">exceptionArgTypes</span>[<span class="r593 r">i</span>]);
                <span class="r592 r">argExprs</span>[<span class="r593 r">i</span>] = <span class="r595 r">e</span>;
            }
 
            <b>const</b> <span class="i">BindingFlags</span> <span id="r596 rd" class="r596 r">Flags</span> = <span class="i">BindingFlags</span>.<span class="i">Instance</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">NonPublic</span>;
            <span class="i">ConstructorInfo</span> <span id="r597 rd" class="r597 r">constructor</span> = <span class="r589 r">exception</span>.<span class="i">GetConstructor</span>(<span class="r596 r">Flags</span>, <b>null</b>, <span class="i">CallingConventions</span>.<span class="i">Any</span>, <span class="r590 r">exceptionArgTypes</span>, <b>null</b>);
            <b>if</b> (<span class="r597 r">constructor</span> == <b>null</b>)
            {
                <b>throw</b> <b>new</b> <a href="../../utils/MshArgumentException.cs.html#095568dc2e26cb6e" class="t constructor">PSArgumentException</a>(<span class="s">&quot;Type doesn&#39;t have constructor with a given signature&quot;</span>);
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Throw</span>(<span class="i">Expression</span>.<span class="i">New</span>(<span class="r597 r">constructor</span>, <span class="r592 r">argExprs</span>), <span class="r588 r">resultType</span>);
        }
 
        <b>internal static</b> <span class="i">Expression</span> <a id="21b097f5ed418df9" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CreateThrow</a>(<span class="i">Type</span> <span id="r598 rd" class="r598 r">resultType</span>, <span class="i">Type</span> <span id="r599 rd" class="r599 r">exception</span>, <b>params object</b>[] <span id="r600 rd" class="r600 r">exceptionArgs</span>)
        {
            <span class="i">Type</span>[] <span id="r601 rd" class="r601 r">argTypes</span> = <span class="i">Type</span>.<span class="i">EmptyTypes</span>;
            <b>if</b> (<span class="r600 r">exceptionArgs</span> != <b>null</b>)
            {
                <span class="r601 r">argTypes</span> = <b>new</b> <span class="i">Type</span>[<span class="r600 r">exceptionArgs</span>.<span class="i">Length</span>];
                <b>for</b> (<b>int</b> <span id="r602 rd" class="r602 r">i</span> = 0; <span class="r602 r">i</span> &lt; <span class="r600 r">exceptionArgs</span>.<span class="i">Length</span>; <span class="r602 r">i</span>++)
                {
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r600 r">exceptionArgs</span>[<span class="r602 r">i</span>] != <b>null</b>, <span class="s">&quot;Can&#39;t deduce argument type from null&quot;</span>);
                    <span class="r601 r">argTypes</span>[<span class="r602 r">i</span>] = <span class="r600 r">exceptionArgs</span>[<span class="r602 r">i</span>].<span class="i">GetType</span>();
                }
            }
 
            <b>return</b> <a href="#7f85b71f6e706023" class="i method">CreateThrow</a>(<span class="r598 r">resultType</span>, <span class="r599 r">exception</span>, <span class="r601 r">argTypes</span>, <span class="r600 r">exceptionArgs</span>);
        }
 
        <b>public object</b> <a id="c5b312c8e5b47788" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitSwitchStatement</a>(<a href="ast.cs.html#4d96f6c979a5266e" class="t t">SwitchStatementAst</a> <span id="r603 rd" class="r603 r">switchStatementAst</span>)
        {
            <a href="#165aab6cc04f9303" class="k">var</a> <span id="r604 rd" class="r604 r">avs</span> = <b>new</b> <a href="#3144e6a2eb6c2eb6" class="t constructor">AutomaticVarSaver</a>(<a href="#8bdfc042f41c96c5" class="k">this</a>, <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#d68ec187d548de92" class="i field">UnderbarVarPath</a>, (<b>int</b>)<a href="../SpecialVariables.cs.html#1c6f2efd91287b59" class="t t">AutomaticVariable</a>.<a href="../SpecialVariables.cs.html#3599fdc9d261201f" class="i field">Underbar</a>);
            <b>var</b> <span id="r605 rd" class="r605 r">temps</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt;();
            <span class="i">ParameterExpression</span> <span id="r606 rd" class="r606 r">skipDefault</span> = <b>null</b>;
            <b>if</b> (<span class="r603 r">switchStatementAst</span>.<a href="ast.cs.html#c977933db5bdc245" class="i property">Default</a> != <b>null</b>)
            {
                <span class="r606 r">skipDefault</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<b>bool</b>), <span class="s">&quot;skipDefault&quot;</span>);
                <span class="r605 r">temps</span>.<span class="i">Add</span>(<span class="r606 r">skipDefault</span>);
            }
 
            <b>var</b> <span id="r607 rd" class="r607 r">switchBodyGenerator</span> = <a href="#5e11e279399cdda9" class="i method">GetSwitchBodyGenerator</a>(<span class="r603 r">switchStatementAst</span>, <span class="r604 r">avs</span>, <span class="r606 r">skipDefault</span>);
 
            <b>if</b> ((<span class="r603 r">switchStatementAst</span>.<a href="ast.cs.html#aaca019540ac3d40" class="i property">Flags</a> &amp; <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#298af185be79cfea" class="i field">File</a>) != 0)
            {
                <span class="c">// Generate:</span>
                <span class="c">//</span>
                <span class="c">//    string path = SwitchOps.ResolveFilePath(cond.Extent, cond, context);</span>
                <span class="c">//    StreamReader sr = null;</span>
                <span class="c">//    try</span>
                <span class="c">//    {</span>
                <span class="c">//        sr = new StreamReader(path);</span>
                <span class="c">//        string line;</span>
                <span class="c">//        while ((line = sr.ReadLine()) != null)</span>
                <span class="c">//        {</span>
                <span class="c">//            $_ = line</span>
                <span class="c">//            test clauses</span>
                <span class="c">//        }</span>
                <span class="c">//    }</span>
                <span class="c">//    catch (FlowControlException) { throw; }</span>
                <span class="c">//    catch (Exception exception)</span>
                <span class="c">//    {</span>
                <span class="c">//        CommandProcessorBase.CheckForSevereException(exception);</span>
                <span class="c">//        // &quot;The file could not be read:&quot; + fne.Message</span>
                <span class="c">//        throw InterpreterError.NewInterpreterExceptionWithInnerException(path, typeof(RuntimeException),</span>
                <span class="c">//            cond.Extent, &quot;FileReadError&quot;, ParserStrings.FileReadError, exception, exception.Message);</span>
                <span class="c">//    }</span>
                <span class="c">//    finally</span>
                <span class="c">//    {</span>
                <span class="c">//        if (sr != null) sr.Dispose();</span>
                <span class="c">//    }</span>
                <b>var</b> <span id="r608 rd" class="r608 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
 
                <b>var</b> <span id="r609 rd" class="r609 r">path</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<b>string</b>), <span class="s">&quot;path&quot;</span>);
                <span class="r605 r">temps</span>.<span class="i">Add</span>(<span class="r609 r">path</span>);
 
                <span class="r608 r">exprs</span>.<span class="i">Add</span>(<a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r603 r">switchStatementAst</span>.<a href="ast.cs.html#933ad75377815bca" class="i property">Condition</a>));
 
                <span class="c">// We should not preserve the partial output if exception is thrown when evaluating the condition.</span>
                <b>var</b> <span id="r610 rd" class="r610 r">cond</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                    <a href="../runtime/Binding/Binders.cs.html#db2e7c67b332caf6" class="t t">PSToStringBinder</a>.<a href="../runtime/Binding/Binders.cs.html#7a771c568a738822" class="i method">Get</a>(),
                    <b>typeof</b>(<b>string</b>),
                    <a href="#fed19bee56918521" class="i method">CaptureStatementResults</a>(<span class="r603 r">switchStatementAst</span>.<a href="ast.cs.html#933ad75377815bca" class="i property">Condition</a>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>),
                    <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>);
                <span class="r608 r">exprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">Assign</span>(
                        <span class="r609 r">path</span>,
                        <span class="i">Expression</span>.<span class="i">Call</span>(
                            <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#19c4c2a77e2707fb" class="i field">SwitchOps_ResolveFilePath</a>,
                            <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r603 r">switchStatementAst</span>.<a href="ast.cs.html#933ad75377815bca" class="i property">Condition</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>),
                            <span class="r610 r">cond</span>,
                            <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>)));
 
                <b>var</b> <span id="r611 rd" class="r611 r">tryBodyExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
 
                <b>var</b> <span id="r612 rd" class="r612 r">streamReader</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<span class="i">StreamReader</span>), <span class="s">&quot;streamReader&quot;</span>);
                <b>var</b> <span id="r613 rd" class="r613 r">line</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<b>string</b>), <span class="s">&quot;line&quot;</span>);
                <span class="r605 r">temps</span>.<span class="i">Add</span>(<span class="r612 r">streamReader</span>);
                <span class="r605 r">temps</span>.<span class="i">Add</span>(<span class="r613 r">line</span>);
 
                <span class="r611 r">tryBodyExprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r612 r">streamReader</span>, <span class="i">Expression</span>.<span class="i">New</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#13cb74ac176c87c3" class="i field">StreamReader_ctor</a>, <span class="r609 r">path</span>)));
                <b>var</b> <span id="r614 rd" class="r614 r">loopTest</span> =
                    <span class="i">Expression</span>.<span class="i">NotEqual</span>(
                        <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r613 r">line</span>, <span class="i">Expression</span>.<span class="i">Call</span>(<span class="r612 r">streamReader</span>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#0ff6546096b237c7" class="i field">StreamReader_ReadLine</a>)).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>);
 
                <span class="r611 r">tryBodyExprs</span>.<span class="i">Add</span>(<span class="r604 r">avs</span>.<a href="#8a259f231ef9add7" class="i method">SaveAutomaticVar</a>());
                <span class="r611 r">tryBodyExprs</span>.<span class="i">Add</span>(
                    <span class="i">GenerateWhileLoop</span>(
                        <span class="r603 r">switchStatementAst</span>.<a href="ast.cs.html#6e78c18e515b91da" class="i property">Label</a>,
                        () =&gt; <span class="r614 r">loopTest</span>,
                        (<span id="r615 rd" class="r615 r">loopBody</span>, <span id="r616 rd" class="r616 r">breakTarget</span>, <span id="r617 rd" class="r617 r">continueTarget</span>) =&gt; <span class="r607 r">switchBodyGenerator</span>(<span class="r615 r">loopBody</span>, <span class="r613 r">line</span>)));
                <b>var</b> <span id="r618 rd" class="r618 r">tryBlock</span> = <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r611 r">tryBodyExprs</span>);
                <b>var</b> <span id="r619 rd" class="r619 r">finallyBlock</span> = <span class="i">Expression</span>.<span class="i">Block</span>(
                    <span class="i">Expression</span>.<span class="i">IfThen</span>(
                        <span class="i">Expression</span>.<span class="i">NotEqual</span>(<span class="r612 r">streamReader</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>),
                        <span class="i">Expression</span>.<span class="i">Call</span>(<span class="r612 r">streamReader</span>.<span class="i">Cast</span>(<b>typeof</b>(<span class="i">IDisposable</span>)), <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#b4515ba4e179b7fb" class="i field">IDisposable_Dispose</a>)),
                    <span class="r604 r">avs</span>.<a href="#2dccc766e8722eb7" class="i method">RestoreAutomaticVar</a>());
                <b>var</b> <span id="r620 rd" class="r620 r">exception</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<span class="i">Exception</span>), <span class="s">&quot;exception&quot;</span>);
                <b>var</b> <span id="r621 rd" class="r621 r">catchAllBlock</span> = <span class="i">Expression</span>.<span class="i">Block</span>(
                    <span class="r618 r">tryBlock</span>.<span class="i">Type</span>,
                    <span class="i">ThrowRuntimeErrorWithInnerException</span>(
                        <span class="s">&quot;FileReadError&quot;</span>,
                        <span class="i">ParserStrings</span>.<span class="i">FileReadError</span>,
                        <span class="r620 r">exception</span>,
                        <span class="i">Expression</span>.<span class="i">Property</span>(<span class="r620 r">exception</span>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#786cdc6c563f5cd2" class="i field">Exception_Message</a>)));
 
                <span class="r608 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">TryCatchFinally</span>(
                    <span class="r618 r">tryBlock</span>, <span class="r619 r">finallyBlock</span>,
                    <b>new</b>[]
                    {
                        <span class="i">Expression</span>.<span class="i">Catch</span>(<b>typeof</b>(<a href="../lang/parserutils.cs.html#a3a2a71cfea9c3b1" class="t t">FlowControlException</a>), <span class="i">Expression</span>.<span class="i">Rethrow</span>(<span class="r618 r">tryBlock</span>.<span class="i">Type</span>)),
                        <span class="i">Expression</span>.<span class="i">Catch</span>(<span class="r620 r">exception</span>, <span class="r621 r">catchAllBlock</span>)
                    }));
 
                <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r605 r">temps</span>.<span class="i">Concat</span>(<span class="r604 r">avs</span>.<a href="#7481fc94ce0492e3" class="i method">GetTemps</a>()), <span class="r608 r">exprs</span>);
            }
 
            <span class="c">// We convert:</span>
            <span class="c">//     switch ($enumerable) {}</span>
            <span class="c">// Into:</span>
            <span class="c">//     $switch = GetEnumerator $enumerable</span>
            <span class="c">//     if ($switch == $null)</span>
            <span class="c">//     {</span>
            <span class="c">//         $switch  = (new object[] { $enumerable }).GetEnumerator()</span>
            <span class="c">//     }</span>
            <span class="c">// REVIEW: should we consider this form of switch a loop for the purposes of deciding</span>
            <span class="c">// to compile or not?  I have a feeling the loop form is uncommon and compiling isn&#39;t worth it.</span>
            <span class="c">//</span>
            <b>var</b> <span id="r622 rd" class="r622 r">tryStmt</span> = <span class="i">Expression</span>.<span class="i">TryFinally</span>(
                <span class="i">Expression</span>.<span class="i">Block</span>(
                    <span class="r604 r">avs</span>.<a href="#8a259f231ef9add7" class="i method">SaveAutomaticVar</a>(),
                    <span class="i">GenerateIteratorStatement</span>(
                        <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#686dbddfffeb44e1" class="i field">switchVarPath</a>,
                        () =&gt; <a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r603 r">switchStatementAst</span>.<a href="ast.cs.html#933ad75377815bca" class="i property">Condition</a>),
                        <a href="#6fecf39186823e1e" class="i field">_switchTupleIndex</a>,
                        <span class="r603 r">switchStatementAst</span>,
                        <span class="r607 r">switchBodyGenerator</span>)),
                <span class="r604 r">avs</span>.<a href="#2dccc766e8722eb7" class="i method">RestoreAutomaticVar</a>());
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r605 r">temps</span>.<span class="i">Concat</span>(<span class="r604 r">avs</span>.<a href="#7481fc94ce0492e3" class="i method">GetTemps</a>()), <span class="r622 r">tryStmt</span>);
        }
 
        <b>private</b> <span class="i">Action</span>&lt;<span class="i">List</span>&lt;<span class="i">Expression</span>&gt;, <span class="i">Expression</span>&gt; <a id="5e11e279399cdda9" href="../../R/5e11e279399cdda9.html" target="n" data-glyph="76,1" class="i method">GetSwitchBodyGenerator</a>(<a href="ast.cs.html#4d96f6c979a5266e" class="t t">SwitchStatementAst</a> <span id="r623 rd" class="r623 r">switchStatementAst</span>, <a href="#165aab6cc04f9303" class="t t">AutomaticVarSaver</a> <span id="r624 rd" class="r624 r">avs</span>, <span class="i">ParameterExpression</span> <span id="r625 rd" class="r625 r">skipDefault</span>)
        {
            <b>return</b> (<span id="r626 rd" class="r626 r">exprs</span>, <span id="r627 rd" class="r627 r">newValue</span>) =&gt;
                   {
                       <a href="../runtime/Binding/Binders.cs.html#6a4f21f786cbab8f" class="k">var</a> <span id="r628 rd" class="r628 r">clauseEvalBinder</span> = <a href="../runtime/Binding/Binders.cs.html#6a4f21f786cbab8f" class="t t">PSSwitchClauseEvalBinder</a>.<a href="../runtime/Binding/Binders.cs.html#d3bbd1d19860c918" class="i method">Get</a>(<span class="r623 r">switchStatementAst</span>.<a href="ast.cs.html#aaca019540ac3d40" class="i property">Flags</a>);
                       <span class="r626 r">exprs</span>.<span class="i">Add</span>(<span class="r624 r">avs</span>.<span class="i">SetNewValue</span>(<span class="r627 r">newValue</span>));
 
                       <b>if</b> (<span class="r625 r">skipDefault</span> != <b>null</b>)
                       {
                           <span class="r626 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r625 r">skipDefault</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>false</b>)));
                       }
 
                       <a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a> <span id="r629 rd" class="r629 r">iscvv</span> = <b>new</b> <span class="t">IsConstantValueVisitor</span>();
                       <a href="ConstantValues.cs.html#2a167202840f224e" class="t t">ConstantValueVisitor</a> <span id="r630 rd" class="r630 r">cvv</span> = <b>new</b> <span class="t">ConstantValueVisitor</span>();
 
                       <b>int</b> <span id="r631 rd" class="r631 r">clauseCount</span> = <span class="r623 r">switchStatementAst</span>.<a href="ast.cs.html#297d524de4c5c69a" class="i property">Clauses</a>.<span class="i">Count</span>;
                       <b>for</b> (<b>int</b> <span id="r632 rd" class="r632 r">i</span> = 0; <span class="r632 r">i</span> &lt; <span class="r631 r">clauseCount</span>; <span class="r632 r">i</span>++)
                       {
                           <b>var</b> <span id="r633 rd" class="r633 r">clause</span> = <span class="r623 r">switchStatementAst</span>.<a href="ast.cs.html#297d524de4c5c69a" class="i property">Clauses</a>[<span class="r632 r">i</span>];
 
                           <span class="i">Expression</span> <span id="r634 rd" class="r634 r">test</span>;
                           <b>object</b> <span id="r635 rd" class="r635 r">constValue</span> = ((<b>bool</b>)<span class="r633 r">clause</span>.<span class="i">Item1</span>.<span class="i">Accept</span>(<span class="r629 r">iscvv</span>)) ? <span class="r633 r">clause</span>.<span class="i">Item1</span>.<span class="i">Accept</span>(<span class="r630 r">cvv</span>) : <b>null</b>;
                           <b>if</b> (<span class="r635 r">constValue</span> <b>is</b> <a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>)
                           {
                               <b>var</b> <span id="r636 rd" class="r636 r">call</span> = <span class="i">Expression</span>.<span class="i">Call</span>(<span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r635 r">constValue</span>),
                                                           <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#4f6af0cfeb2c7169" class="i field">ScriptBlock_DoInvokeReturnAsIs</a>,
                               <span class="c">/*useLocalScope=*/</span>         <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>),
                               <span class="c">/*errorHandlingBehavior=*/</span> <span class="i">Expression</span>.<span class="i">Constant</span>(<a href="../../P/eea83b421baeaca4.html#eea83b421baeaca4" class="t t">ScriptBlock</a>.<a href="../lang/scriptblock.cs.html#10c045824f712272" class="t t">ErrorHandlingBehavior</a>.<a href="../lang/scriptblock.cs.html#df0061919fb37a15" class="i field">WriteToExternalErrorPipe</a>),
                               <span class="c">/*dollarUnder=*/</span>           <a href="#719f3e105a567e40" class="i method">GetLocal</a>((<b>int</b>)<a href="../SpecialVariables.cs.html#1c6f2efd91287b59" class="t t">AutomaticVariable</a>.<a href="../SpecialVariables.cs.html#3599fdc9d261201f" class="i field">Underbar</a>).<span class="i">Convert</span>(<b>typeof</b>(<b>object</b>)),
                               <span class="c">/*input=*/</span>                 <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#84591f5e881dc39e" class="i field">AutomationNullConstant</a>,
                               <span class="c">/*scriptThis=*/</span>            <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#84591f5e881dc39e" class="i field">AutomationNullConstant</a>,
                               <span class="c">/*args=*/</span>                  <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#7f0ebe7c58832085" class="i field">NullObjectArray</a>);
                               <span class="r634 r">test</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#97a1cf18399e4247" class="t t">PSConvertBinder</a>.<span class="i">Get</span>(<b>typeof</b>(<b>bool</b>)), <b>typeof</b>(<b>bool</b>), <span class="r636 r">call</span>);
                           }
                           <b>else</b> <b>if</b> (<span class="r635 r">constValue</span> != <b>null</b>)
                           {
                               <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a> <span id="r637 rd" class="r637 r">flags</span> = <span class="r623 r">switchStatementAst</span>.<a href="ast.cs.html#aaca019540ac3d40" class="i property">Flags</a>;
                               <span class="i">Expression</span> <span id="r638 rd" class="r638 r">conditionExpr</span> = <span class="r635 r">constValue</span> <b>is</b> <span class="i">Regex</span> || <span class="r635 r">constValue</span> <b>is</b> <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>
                                                    ? (<span class="i">Expression</span>)<span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r635 r">constValue</span>)
                                                    : <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                                                            <a href="../runtime/Binding/Binders.cs.html#db2e7c67b332caf6" class="t t">PSToStringBinder</a>.<a href="../runtime/Binding/Binders.cs.html#7a771c568a738822" class="i method">Get</a>(),
                                                            <b>typeof</b>(<b>string</b>),
                                                            (<span class="r635 r">constValue</span> <b>is</b> <span class="i">Type</span>)
                                                                ? <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r635 r">constValue</span>, <b>typeof</b>(<span class="i">Type</span>))
                                                                : <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r635 r">constValue</span>),
                                                            <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>);
                               <span class="i">Expression</span> <span id="r639 rd" class="r639 r">currentAsString</span> =
                                   <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#db2e7c67b332caf6" class="t t">PSToStringBinder</a>.<a href="../runtime/Binding/Binders.cs.html#7a771c568a738822" class="i method">Get</a>(), <b>typeof</b>(<b>string</b>), <a href="#719f3e105a567e40" class="i method">GetLocal</a>((<b>int</b>)<a href="../SpecialVariables.cs.html#1c6f2efd91287b59" class="t t">AutomaticVariable</a>.<a href="../SpecialVariables.cs.html#3599fdc9d261201f" class="i field">Underbar</a>),
                                                             <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>);
                               <b>if</b> ((<span class="r637 r">flags</span> &amp; <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#6c98f78beaa551f0" class="i field">Regex</a>) != 0 || <span class="r635 r">constValue</span> <b>is</b> <span class="i">Regex</span>)
                               {
                                   <span class="r634 r">test</span> = <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#2b437b06fc777c0b" class="i field">SwitchOps_ConditionSatisfiedRegex</a>,
                                       <span class="c">/*caseSensitive=*/</span> <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>((<span class="r637 r">flags</span> &amp; <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#5612873142e6f4be" class="i field">CaseSensitive</a>) != 0),
                                       <span class="c">/*condition=*/</span>     <span class="r638 r">conditionExpr</span>,
                                       <span class="c">/*errorPosition=*/</span> <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r633 r">clause</span>.<span class="i">Item1</span>.<span class="i">Extent</span>),
                                       <span class="c">/*str=*/</span>           <span class="r639 r">currentAsString</span>,
                                       <span class="c">/*context=*/</span>       <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>);
                               }
                               <b>else</b> <b>if</b> ((<span class="r637 r">flags</span> &amp; <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#8c2beda7309b3ae0" class="i field">Wildcard</a>) != 0 || <span class="r635 r">constValue</span> <b>is</b> <a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>)
                               {
                                   <span class="c">// It would be a little better to just build the wildcard at compile time, but</span>
                                   <span class="c">// the runtime method must exist when variable cases are involved.</span>
                                   <span class="r634 r">test</span> = <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#e544440f7db35cfa" class="i field">SwitchOps_ConditionSatisfiedWildcard</a>,
                                       <span class="c">/*caseSensitive=*/</span> <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>((<span class="r637 r">flags</span> &amp; <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#5612873142e6f4be" class="i field">CaseSensitive</a>) != 0),
                                       <span class="c">/*condition=*/</span>     <span class="r638 r">conditionExpr</span>,
                                       <span class="c">/*str=*/</span>           <span class="r639 r">currentAsString</span>,
                                       <span class="c">/*context=*/</span>       <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>);
                               }
                               <b>else</b>
                               {
                                   <span class="r634 r">test</span> = <a href="#ecc174ef7eb7ef85" class="i method">CallStringEquals</a>(<span class="r638 r">conditionExpr</span>, <span class="r639 r">currentAsString</span>, ((<span class="r637 r">flags</span> &amp; <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#5612873142e6f4be" class="i field">CaseSensitive</a>) == 0));
                               }
                           }
                           <b>else</b>
                           {
                               <b>var</b> <span id="r640 rd" class="r640 r">cond</span> = <span class="i">Compile</span>(<span class="r633 r">clause</span>.<span class="i">Item1</span>);
                               <span class="r634 r">test</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                                    <span class="r628 r">clauseEvalBinder</span>,
                                    <b>typeof</b>(<b>bool</b>),
                                    <span class="r640 r">cond</span>,
                                    <a href="#719f3e105a567e40" class="i method">GetLocal</a>((<b>int</b>)<a href="../SpecialVariables.cs.html#1c6f2efd91287b59" class="t t">AutomaticVariable</a>.<a href="../SpecialVariables.cs.html#3599fdc9d261201f" class="i field">Underbar</a>),
                                    <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>);
                           }
 
                           <span class="r626 r">exprs</span>.<span class="i">Add</span>(<span class="i">UpdatePosition</span>(<span class="r633 r">clause</span>.<span class="i">Item1</span>));
                           <b>if</b> (<span class="r625 r">skipDefault</span> != <b>null</b>)
                           {
                               <span class="r626 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">IfThen</span>(
                                   <span class="r634 r">test</span>,
                                   <span class="i">Expression</span>.<span class="i">Block</span>(<span class="i">Compile</span>(<span class="r633 r">clause</span>.<span class="i">Item2</span>),
                                                    <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r625 r">skipDefault</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>)))));
                           }
                           <b>else</b>
                           {
                               <span class="r626 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">IfThen</span>(<span class="r634 r">test</span>, <span class="i">Compile</span>(<span class="r633 r">clause</span>.<span class="i">Item2</span>)));
                           }
                       }
 
                       <b>if</b> (<span class="r625 r">skipDefault</span> != <b>null</b>)
                       {
                           <span class="r626 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">IfThen</span>(<span class="i">Expression</span>.<span class="i">Not</span>(<span class="r625 r">skipDefault</span>), <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r623 r">switchStatementAst</span>.<a href="ast.cs.html#c977933db5bdc245" class="i property">Default</a>)));
                       }
                   };
        }
 
        <b>public object</b> <a id="5b60290951413799" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitDataStatement</a>(<a href="ast.cs.html#37c175482122764b" class="t t">DataStatementAst</a> <span id="r641 rd" class="r641 r">dataStatementAst</span>)
        {
            <span class="c">// We&#39;ll generate the following:</span>
            <span class="c">//</span>
            <span class="c">// try</span>
            <span class="c">// {</span>
            <span class="c">//     oldLanguageMode = context.LanguageMode;</span>
            <span class="c">//     CheckLanguageMode (if necessary, only if SupportedCommands specified)</span>
            <span class="c">//     CheckAllowedCommands (if necessary, it may have been done at parse time if possible)</span>
            <span class="c">//     context.LanguageMode = PSLanguageMode.RestrictedLanguage;</span>
            <span class="c">//     either:</span>
            <span class="c">//         dataStatementAst.Variable = execute body</span>
            <span class="c">//     or if the variable name was not specified:</span>
            <span class="c">//         execute body, writing results to the current output pipe</span>
            <span class="c">// }</span>
            <span class="c">// finally</span>
            <span class="c">// {</span>
            <span class="c">//     context.LanguageMode = oldLanguageMode;</span>
            <span class="c">// }</span>
            <b>var</b> <span id="r642 rd" class="r642 r">oldLanguageMode</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>), <span class="s">&quot;oldLanguageMode&quot;</span>);
            <b>var</b> <span id="r643 rd" class="r643 r">languageModePropertyExpr</span> = <span class="i">Expression</span>.<span class="i">Property</span>(<a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#de071e360a3c75b6" class="i field">ExecutionContext_LanguageMode</a>);
 
            <b>var</b> <span id="r644 rd" class="r644 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;
                {
                    <span class="c">// Save old language mode before doing anything else so if there is an exception, we don&#39;t</span>
                    <span class="c">// &quot;restore&quot; the language mode to an uninitialized value (which happens to be &quot;full&quot; mode.</span>
                    <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r642 r">oldLanguageMode</span>, <span class="r643 r">languageModePropertyExpr</span>),
 
                    <a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r641 r">dataStatementAst</span>),
 
                    <span class="c">// Auto-import utility module if needed, so that ConvertFrom-StringData isn&#39;t set to RestrictedLanguage</span>
                    <span class="c">// by the data section.</span>
                    <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#6a0ebb1490c40147" class="i field">RestrictedLanguageChecker_EnsureUtilityModuleLoaded</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>)
                };
 
            <b>if</b> (<span class="r641 r">dataStatementAst</span>.<a href="ast.cs.html#11fb9d287a8e9308" class="i property">CommandsAllowed</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// If CommandsAllowed was specified, we need to check the language mode - the data section runs</span>
                <span class="c">// in restricted language mode and we don&#39;t want to allow disallowed commands to run if we were in</span>
                <span class="c">// constrained language mode.</span>
                <span class="r644 r">exprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#635cdc612dc416ed" class="i field">RestrictedLanguageChecker_CheckDataStatementLanguageModeAtRuntime</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r641 r">dataStatementAst</span>),
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>));
            }
 
            <b>if</b> (<span class="r641 r">dataStatementAst</span>.<a href="ast.cs.html#fd85adecda14b40c" class="i property">HasNonConstantAllowedCommand</a>)
            {
                <span class="c">// We couldn&#39;t check the commands allowed at parse time, so we must do so at runtime</span>
                <span class="r644 r">exprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#166fa812d91edfc0" class="i field">RestrictedLanguageChecker_CheckDataStatementAstAtRuntime</a>,
                                    <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r641 r">dataStatementAst</span>),
                                    <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<b>string</b>),
                                                            <span class="r641 r">dataStatementAst</span>.<a href="ast.cs.html#11fb9d287a8e9308" class="i property">CommandsAllowed</a>.<span class="i">Select</span>(<span id="r645 rd" class="r645 r">elem</span> =&gt; <span class="i">Compile</span>(<span class="r645 r">elem</span>).<span class="i">Convert</span>(<b>typeof</b>(<b>string</b>))))));
            }
 
            <span class="r644 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r643 r">languageModePropertyExpr</span>, <span class="i">Expression</span>.<span class="i">Constant</span>(<a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#ea8105287b8c6b25" class="i field">RestrictedLanguage</a>)));
 
            <span class="c">// If we&#39;ll be assigning directly, we need to capture the value, otherwise just write to the current output pipe.</span>
            <span class="c">// We should not preserve the partial output if exception is thrown when evaluating the body expr.</span>
            <b>var</b> <span id="r646 rd" class="r646 r">dataExpr</span> = <span class="r641 r">dataStatementAst</span>.<a href="ast.cs.html#9eb92e727e59a7eb" class="i property">Variable</a> != <b>null</b>
                               ? <a href="#a57518533e3fe99b" class="i method">CaptureAstResults</a>(<span class="r641 r">dataStatementAst</span>.<a href="ast.cs.html#75dab9efd3d1b59e" class="i property">Body</a>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>))
                               : <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r641 r">dataStatementAst</span>.<a href="ast.cs.html#75dab9efd3d1b59e" class="i property">Body</a>);
            <span class="r644 r">exprs</span>.<span class="i">Add</span>(<span class="r646 r">dataExpr</span>);
 
            <b>var</b> <span id="r647 rd" class="r647 r">block</span> = <span class="i">Expression</span>.<span class="i">Block</span>(
                <b>new</b>[] { <span class="r642 r">oldLanguageMode</span> },
                <span class="i">Expression</span>.<span class="i">TryFinally</span>(<span class="i">Expression</span>.<span class="i">Block</span>(<span class="r644 r">exprs</span>), <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r643 r">languageModePropertyExpr</span>, <span class="r642 r">oldLanguageMode</span>)));
 
            <b>if</b> (<span class="r641 r">dataStatementAst</span>.<a href="ast.cs.html#9eb92e727e59a7eb" class="i property">Variable</a> != <b>null</b>)
            {
                <b>return</b> <span class="r641 r">dataStatementAst</span>.<a href="ast.cs.html#5f228d7fc0478b96" class="i property">TupleIndex</a> &lt; 0
                    ? <span class="i">CallSetVariable</span>(<span class="i">Expression</span>.<span class="i">Constant</span>(<b>new</b> <span class="t">VariablePath</span>(<span class="s">&quot;local:&quot;</span> + <span class="r641 r">dataStatementAst</span>.<a href="ast.cs.html#9eb92e727e59a7eb" class="i property">Variable</a>)), <span class="r647 r">block</span>)
                    : <span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#719f3e105a567e40" class="i method">GetLocal</a>(<span class="r641 r">dataStatementAst</span>.<a href="ast.cs.html#5f228d7fc0478b96" class="i property">TupleIndex</a>), <span class="r647 r">block</span>);
            }
 
            <b>return</b> <span class="r647 r">block</span>;
        }
 
        <b>private static</b> <span class="i">CatchBlock</span>[] <a id="29ad1db6cbb399b3" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GenerateLoopBreakContinueCatchBlocks</a>(<b>string</b> <span id="r648 rd" class="r648 r">label</span>, <span class="i">LabelTarget</span> <span id="r649 rd" class="r649 r">breakLabel</span>, <span class="i">LabelTarget</span> <span id="r650 rd" class="r650 r">continueLabel</span>)
        {
            <b>var</b> <span id="r651 rd" class="r651 r">breakExceptionVar</span> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<a href="../lang/parserutils.cs.html#8b17292837a7f9fe" class="t t">BreakException</a>));
            <b>var</b> <span id="r652 rd" class="r652 r">continueExceptionVar</span> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<a href="../lang/parserutils.cs.html#bef3416feb6ab79b" class="t t">ContinueException</a>));
            <b>return</b> <b>new</b>[]
            {
                <span class="c">// catch (BreakException ev) { if (ev.MatchLabel(loopStatement.Label) { goto breakTarget; } throw; }</span>
                <span class="i">Expression</span>.<span class="i">Catch</span>(
                    <span class="r651 r">breakExceptionVar</span>,
                    <span class="i">Expression</span>.<span class="i">IfThenElse</span>(
                        <span class="i">Expression</span>.<span class="i">Call</span>(<span class="r651 r">breakExceptionVar</span>,
                                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#d69f0b5d1a319bf0" class="i field">LoopFlowException_MatchLabel</a>,
                                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r648 r">label</span> ?? <b>string</b>.<span class="i">Empty</span>, <b>typeof</b>(<b>string</b>))),
                        <span class="i">Expression</span>.<span class="i">Break</span>(<span class="r649 r">breakLabel</span>),
                        <span class="i">Expression</span>.<span class="i">Rethrow</span>())),
 
                <span class="c">// catch (ContinueException ev) { if (ev.MatchLabel(loopStatement.Label) { goto continueTarget; } throw; }</span>
                <span class="i">Expression</span>.<span class="i">Catch</span>(
                    <span class="r652 r">continueExceptionVar</span>,
                    <span class="i">Expression</span>.<span class="i">IfThenElse</span>(
                        <span class="i">Expression</span>.<span class="i">Call</span>(
                            <span class="r652 r">continueExceptionVar</span>,
                            <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#d69f0b5d1a319bf0" class="i field">LoopFlowException_MatchLabel</a>,
                            <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r648 r">label</span> ?? <b>string</b>.<span class="i">Empty</span>, <b>typeof</b>(<b>string</b>))),
                        <span class="i">Expression</span>.<span class="i">Continue</span>(<span class="r650 r">continueLabel</span>),
                        <span class="i">Expression</span>.<span class="i">Rethrow</span>()))
            };
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="ed3a4dd906f729f0" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GenerateWhileLoop</a>(<b>string</b> <span id="r653 rd" class="r653 r">loopLabel</span>,
                                             <span class="i">Func</span>&lt;<span class="i">Expression</span>&gt; <span id="r654 rd" class="r654 r">generateCondition</span>,
                                             <span class="i">Action</span>&lt;<span class="i">List</span>&lt;<span class="i">Expression</span>&gt;, <span class="i">LabelTarget</span>, <span class="i">LabelTarget</span>&gt; <span id="r655 rd" class="r655 r">generateLoopBody</span>,
                                             <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r656 rd" class="r656 r">continueAst</span> = <b>null</b>)
        {
            <span class="c">// If continueAst is not null, generate:</span>
            <span class="c">//    LoopTop:</span>
            <span class="c">//    if (condition)</span>
            <span class="c">//    {</span>
            <span class="c">//        try {</span>
            <span class="c">//            loop body</span>
            <span class="c">//            // break -&gt; goto BreakTarget</span>
            <span class="c">//            // continue -&gt; goto ContinueTarget</span>
            <span class="c">//        } catch (BreakException be) {</span>
            <span class="c">//            if (be.MatchLabel(loopLabel)) goto BreakTarget;</span>
            <span class="c">//            throw;</span>
            <span class="c">//        } catch (ContinueException ce) {</span>
            <span class="c">//            if (ce.MatchLabel(loopLabel)) goto ContinueTarget;</span>
            <span class="c">//            throw;</span>
            <span class="c">//        }</span>
            <span class="c">//    ContinueTarget:</span>
            <span class="c">//            continueAction</span>
            <span class="c">//            goto LoopTop:</span>
            <span class="c">//    }</span>
            <span class="c">//    :BreakTarget</span>
            <span class="c">//</span>
            <span class="c">// If continueAst is null, generate:</span>
            <span class="c">//    ContinueTarget:</span>
            <span class="c">//    if (condition)</span>
            <span class="c">//    {</span>
            <span class="c">//        try {</span>
            <span class="c">//            loop body</span>
            <span class="c">//            // break -&gt; goto BreakTarget</span>
            <span class="c">//            // continue -&gt; goto ContinueTarget</span>
            <span class="c">//            goto ContinueTarget</span>
            <span class="c">//        } catch (BreakException be) {</span>
            <span class="c">//            if (be.MatchLabel(loopLabel)) goto BreakTarget;</span>
            <span class="c">//            throw;</span>
            <span class="c">//        } catch (ContinueException ce) {</span>
            <span class="c">//            if (ce.MatchLabel(loopLabel)) goto ContinueTarget;</span>
            <span class="c">//            throw;</span>
            <span class="c">//        }</span>
            <span class="c">//    }</span>
            <span class="c">//    :BreakTarget</span>
            <b>int</b> <span id="r657 rd" class="r657 r">preStmtCount</span> = <a href="#bbc2448f2228e671" class="i field">_stmtCount</a>;
 
            <b>var</b> <span id="r658 rd" class="r658 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <b>var</b> <span id="r659 rd" class="r659 r">continueLabel</span> = <span class="i">Expression</span>.<span class="i">Label</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r653 r">loopLabel</span>) ? <span class="r653 r">loopLabel</span> + <span class="s">&quot;Continue&quot;</span> : <span class="s">&quot;continue&quot;</span>);
            <b>var</b> <span id="r660 rd" class="r660 r">breakLabel</span> = <span class="i">Expression</span>.<span class="i">Label</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r653 r">loopLabel</span>) ? <span class="r653 r">loopLabel</span> + <span class="s">&quot;Break&quot;</span> : <span class="s">&quot;break&quot;</span>);
            <a href="#391edada7945f19a" class="k">var</a> <span id="r661 rd" class="r661 r">enterLoop</span> = <b>new</b> <span class="t">EnterLoopExpression</span>();
 
            <b>var</b> <span id="r662 rd" class="r662 r">loopTop</span> = (<span class="r656 r">continueAst</span> != <b>null</b>)
                              ? <span class="i">Expression</span>.<span class="i">Label</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r653 r">loopLabel</span>) ? <span class="r653 r">loopLabel</span> + <span class="s">&quot;LoopTop&quot;</span> : <span class="s">&quot;looptop&quot;</span>)
                              : <span class="r659 r">continueLabel</span>;
 
            <span class="r658 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r662 r">loopTop</span>));
            <span class="r658 r">exprs</span>.<span class="i">Add</span>(<span class="r661 r">enterLoop</span>);
 
            <b>var</b> <span id="r663 rd" class="r663 r">loopBodyExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <span class="r663 r">loopBodyExprs</span>.<span class="i">Add</span>(<a href="#2adea26bac49ee2f" class="i field">s_callCheckForInterrupts</a>);
 
            <a href="#4b32d559427de642" class="i field">_loopTargets</a>.<span class="i">Add</span>(<b>new</b> <span class="t">LoopGotoTargets</span>(<span class="r653 r">loopLabel</span> ?? <b>string</b>.<span class="i">Empty</span>, <span class="r660 r">breakLabel</span>, <span class="r659 r">continueLabel</span>));
            <a href="#71764a6db953172b" class="i field">_generatingWhileOrDoLoop</a> = <b>true</b>;
            <span class="r655 r">generateLoopBody</span>(<span class="r663 r">loopBodyExprs</span>, <span class="r660 r">breakLabel</span>, <span class="r659 r">continueLabel</span>);
            <a href="#71764a6db953172b" class="i field">_generatingWhileOrDoLoop</a> = <b>false</b>;
            <b>if</b> (<span class="r656 r">continueAst</span> == <b>null</b>)
            {
                <span class="r663 r">loopBodyExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Goto</span>(<span class="r662 r">loopTop</span>));
            }
 
            <a href="#4b32d559427de642" class="i field">_loopTargets</a>.<span class="i">RemoveAt</span>(<a href="#4b32d559427de642" class="i field">_loopTargets</a>.<span class="i">Count</span> - 1);
 
            <span class="i">Expression</span> <span id="r664 rd" class="r664 r">loopBody</span> =
                <span class="i">Expression</span>.<span class="i">TryCatch</span>(<span class="i">Expression</span>.<span class="i">Block</span>(<span class="r663 r">loopBodyExprs</span>), <span class="i">GenerateLoopBreakContinueCatchBlocks</span>(<span class="r653 r">loopLabel</span>, <span class="r660 r">breakLabel</span>, <span class="r659 r">continueLabel</span>));
            <b>if</b> (<span class="r656 r">continueAst</span> != <b>null</b>)
            {
                <b>var</b> <span id="r665 rd" class="r665 r">x</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
                <span class="r665 r">x</span>.<span class="i">Add</span>(<span class="r664 r">loopBody</span>);
                <span class="r665 r">x</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r659 r">continueLabel</span>));
                <b>if</b> (<span class="r656 r">continueAst</span>.<a href="ast.cs.html#158661f5f6c8db6d" class="i method">GetPureExpression</a>() != <b>null</b>)
                {
                    <span class="c">// Assignments generate the code to update the position automatically,</span>
                    <span class="c">// but pre/post increments don&#39;t, so we add it here explicitly.</span>
                    <span class="r665 r">x</span>.<span class="i">Add</span>(<a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r656 r">continueAst</span>));
                }
 
                <span class="c">// We should not preserve the partial output if exception is thrown when evaluating the continueAst.</span>
                <span class="r665 r">x</span>.<span class="i">Add</span>(<a href="#fed19bee56918521" class="i method">CaptureStatementResults</a>(<span class="r656 r">continueAst</span>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>));
                <span class="r665 r">x</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Goto</span>(<span class="r662 r">loopTop</span>));
                <span class="r664 r">loopBody</span> = <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r665 r">x</span>);
            }
 
            <b>if</b> (<span class="r654 r">generateCondition</span> != <b>null</b>)
            {
                <span class="r658 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">IfThen</span>(<span class="r654 r">generateCondition</span>().<span class="i">Convert</span>(<b>typeof</b>(<b>bool</b>)), <span class="r664 r">loopBody</span>));
            }
            <b>else</b>
            {
                <span class="r658 r">exprs</span>.<span class="i">Add</span>(<span class="r664 r">loopBody</span>);
            }
 
            <span class="r658 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r660 r">breakLabel</span>));
            <span class="r661 r">enterLoop</span>.<a href="#4edf44af0199a839" class="i property">LoopStatementCount</a> = <a href="#bbc2448f2228e671" class="i field">_stmtCount</a> - <span class="r657 r">preStmtCount</span>;
            <b>return</b> <span class="r661 r">enterLoop</span>.<a href="#e884d35aa76358e8" class="i property">Loop</a> = <b>new</b> <span class="t">PowerShellLoopExpression</span>(<span class="r658 r">exprs</span>);
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="b731a66c7ec8d164" href="../../R/b731a66c7ec8d164.html" target="n" data-glyph="76,1" class="i method">GenerateDoLoop</a>(<a href="ast.cs.html#931b3c793b175596" class="t t">LoopStatementAst</a> <span id="r666 rd" class="r666 r">loopStatement</span>)
        {
            <span class="c">// Generate code like:</span>
            <span class="c">//    :RepeatTarget</span>
            <span class="c">//    try {</span>
            <span class="c">//       loop body</span>
            <span class="c">//       // break -&gt; goto BreakTarget</span>
            <span class="c">//       // continue -&gt; goto TestBlock</span>
            <span class="c">//    } catch (BreakException be) {</span>
            <span class="c">//        if (be.MatchLabel(loopLabel))</span>
            <span class="c">//             goto BreakTarget;</span>
            <span class="c">//        throw;</span>
            <span class="c">//    } catch (ContinueException ce) {</span>
            <span class="c">//        if (ce.MatchLabel(loopLabel))</span>
            <span class="c">//            goto ContinueTarget;</span>
            <span class="c">//        throw;</span>
            <span class="c">//    }</span>
            <span class="c">//    :ContinueTarget</span>
            <span class="c">//    if (condition)</span>
            <span class="c">//    {</span>
            <span class="c">//        goto RepeatTarget</span>
            <span class="c">//    }</span>
            <span class="c">//    :BreakTarget</span>
            <span class="c">//</span>
            <b>int</b> <span id="r667 rd" class="r667 r">preStmtCount</span> = <a href="#bbc2448f2228e671" class="i field">_stmtCount</a>;
 
            <b>string</b> <span id="r668 rd" class="r668 r">loopLabel</span> = <span class="r666 r">loopStatement</span>.<a href="ast.cs.html#6e78c18e515b91da" class="i property">Label</a>;
            <b>var</b> <span id="r669 rd" class="r669 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <b>var</b> <span id="r670 rd" class="r670 r">repeatLabel</span> = <span class="i">Expression</span>.<span class="i">Label</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r668 r">loopLabel</span>) ? <span class="r668 r">loopLabel</span> : <b>null</b>);
            <b>var</b> <span id="r671 rd" class="r671 r">continueLabel</span> = <span class="i">Expression</span>.<span class="i">Label</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r668 r">loopLabel</span>) ? <span class="r668 r">loopLabel</span> + <span class="s">&quot;Continue&quot;</span> : <span class="s">&quot;continue&quot;</span>);
            <b>var</b> <span id="r672 rd" class="r672 r">breakLabel</span> = <span class="i">Expression</span>.<span class="i">Label</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r668 r">loopLabel</span>) ? <span class="r668 r">loopLabel</span> + <span class="s">&quot;Break&quot;</span> : <span class="s">&quot;break&quot;</span>);
            <a href="#391edada7945f19a" class="k">var</a> <span id="r673 rd" class="r673 r">enterLoopExpression</span> = <b>new</b> <span class="t">EnterLoopExpression</span>();
 
            <span class="r669 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r670 r">repeatLabel</span>));
            <span class="r669 r">exprs</span>.<span class="i">Add</span>(<span class="r673 r">enterLoopExpression</span>);
 
            <a href="#4b32d559427de642" class="i field">_loopTargets</a>.<span class="i">Add</span>(<b>new</b> <span class="t">LoopGotoTargets</span>(<span class="r668 r">loopLabel</span> ?? <b>string</b>.<span class="i">Empty</span>, <span class="r672 r">breakLabel</span>, <span class="r671 r">continueLabel</span>));
            <a href="#71764a6db953172b" class="i field">_generatingWhileOrDoLoop</a> = <b>true</b>;
            <b>var</b> <span id="r674 rd" class="r674 r">loopBodyExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;
                                {
                                    <a href="#2adea26bac49ee2f" class="i field">s_callCheckForInterrupts</a>,
                                    <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r666 r">loopStatement</span>.<a href="ast.cs.html#246ea985df627fa9" class="i property">Body</a>),
                                    <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>
                                };
            <a href="#71764a6db953172b" class="i field">_generatingWhileOrDoLoop</a> = <b>false</b>;
            <a href="#4b32d559427de642" class="i field">_loopTargets</a>.<span class="i">RemoveAt</span>(<a href="#4b32d559427de642" class="i field">_loopTargets</a>.<span class="i">Count</span> - 1);
 
            <span class="r669 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">TryCatch</span>(
                <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r674 r">loopBodyExprs</span>),
                <span class="i">GenerateLoopBreakContinueCatchBlocks</span>(<span class="r668 r">loopLabel</span>, <span class="r672 r">breakLabel</span>, <span class="r671 r">continueLabel</span>)));
            <span class="r669 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r671 r">continueLabel</span>));
            <b>var</b> <span id="r675 rd" class="r675 r">test</span> = <a href="#fed19bee56918521" class="i method">CaptureStatementResults</a>(<span class="r666 r">loopStatement</span>.<a href="ast.cs.html#933ad75377815bca" class="i property">Condition</a>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#2ae33340eb67d1d1" class="i field">Condition</a>).<span class="i">Convert</span>(<b>typeof</b>(<b>bool</b>));
            <b>if</b> (<span class="r666 r">loopStatement</span> <b>is</b> <a href="ast.cs.html#d641b5faf306abeb" class="t t">DoUntilStatementAst</a>)
            {
                <span class="r675 r">test</span> = <span class="i">Expression</span>.<span class="i">Not</span>(<span class="r675 r">test</span>);
            }
 
            <span class="r675 r">test</span> = <a href="#67340597819c9db4" class="i method">UpdatePositionForInitializerOrCondition</a>(<span class="r666 r">loopStatement</span>.<a href="ast.cs.html#933ad75377815bca" class="i property">Condition</a>, <span class="r675 r">test</span>);
            <span class="r669 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">IfThen</span>(<span class="r675 r">test</span>, <span class="i">Expression</span>.<span class="i">Goto</span>(<span class="r670 r">repeatLabel</span>)));
            <span class="r669 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Label</span>(<span class="r672 r">breakLabel</span>));
 
            <span class="r673 r">enterLoopExpression</span>.<a href="#4edf44af0199a839" class="i property">LoopStatementCount</a> = <a href="#bbc2448f2228e671" class="i field">_stmtCount</a> - <span class="r667 r">preStmtCount</span>;
            <b>return</b> <span class="r673 r">enterLoopExpression</span>.<a href="#e884d35aa76358e8" class="i property">Loop</a> = <b>new</b> <span class="t">PowerShellLoopExpression</span>(<span class="r669 r">exprs</span>);
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="a6f87220f1fb5877" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GenerateIteratorStatement</a>(
            <a href="../VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r676 rd" class="r676 r">iteratorVariablePath</span>,
            <span class="i">Func</span>&lt;<span class="i">Expression</span>&gt; <span id="r677 rd" class="r677 r">generateMoveNextUpdatePosition</span>,
            <b>int</b> <span id="r678 rd" class="r678 r">iteratorTupleIndex</span>,
            <a href="ast.cs.html#056fe4b6395c295c" class="t t">LabeledStatementAst</a> <span id="r679 rd" class="r679 r">stmt</span>,
            <span class="i">Action</span>&lt;<span class="i">List</span>&lt;<span class="i">Expression</span>&gt;, <span class="i">Expression</span>&gt; <span id="r680 rd" class="r680 r">generateBody</span>)
        {
            <span class="c">// We convert:</span>
            <span class="c">//     foreach ($x in $enumerable) {}</span>
            <span class="c">// Into:</span>
            <span class="c">//     try</span>
            <span class="c">//     {</span>
            <span class="c">//         $oldforeach = $foreach</span>
            <span class="c">//         $enumerable = condition</span>
            <span class="c">//         $foreach = GetEnumerator $enumerable</span>
            <span class="c">//         if ($foreach == $null &amp;&amp; $enumerable != $null)</span>
            <span class="c">//         {</span>
            <span class="c">//             $foreach  = (new object[] { $enumerable }).GetEnumerator()</span>
            <span class="c">//         }</span>
            <span class="c">//         if ($foreach != $null)</span>
            <span class="c">//         {</span>
            <span class="c">//             while ($foreach.MoveNext())</span>
            <span class="c">//             {</span>
            <span class="c">//                 $x = $foreach.Current</span>
            <span class="c">//             }</span>
            <span class="c">//         }</span>
            <span class="c">//    }</span>
            <span class="c">//    finally</span>
            <span class="c">//    {</span>
            <span class="c">//        $foreach = $oldforeach</span>
            <span class="c">//    }</span>
            <span class="c">// The translation for switch is similar.</span>
            <span class="c">//</span>
            <b>var</b> <span id="r681 rd" class="r681 r">temps</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt;();
            <b>var</b> <span id="r682 rd" class="r682 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <a href="#165aab6cc04f9303" class="k">var</a> <span id="r683 rd" class="r683 r">avs</span> = <b>new</b> <a href="#3144e6a2eb6c2eb6" class="t constructor">AutomaticVarSaver</a>(<a href="#8bdfc042f41c96c5" class="k">this</a>, <span class="r676 r">iteratorVariablePath</span>, <span class="r678 r">iteratorTupleIndex</span>);
            <b>bool</b> <span id="r684 rd" class="r684 r">generatingForeach</span> = <span class="r679 r">stmt</span> <b>is</b> <a href="ast.cs.html#9ae6aa2909fef7b0" class="t t">ForEachStatementAst</a>;
 
            <span class="r682 r">exprs</span>.<span class="i">Add</span>(<span class="r683 r">avs</span>.<a href="#8a259f231ef9add7" class="i method">SaveAutomaticVar</a>());
 
            <span class="c">// $enumerable = condition</span>
            <span class="c">// $foreach/$switch = GetEnumerator $enumerable</span>
            <b>var</b> <span id="r685 rd" class="r685 r">enumerable</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<b>object</b>), <span class="s">&quot;enumerable&quot;</span>);
            <span class="r681 r">temps</span>.<span class="i">Add</span>(<span class="r685 r">enumerable</span>);
 
            <span class="c">// Update position to make it safe to access &#39;CurrentPosition&#39; property in FunctionContext in case</span>
            <span class="c">// that the evaluation of &#39;stmt.Condition&#39; throws exception.</span>
            <b>if</b> (<span class="r684 r">generatingForeach</span>)
            {
                <span class="c">// For foreach statement, we want the debugger to stop at &#39;stmt.Condition&#39; before evaluating it.</span>
                <span class="c">// The debugger will stop at &#39;stmt.Condition&#39; only once. The following enumeration will stop at</span>
                <span class="c">// the foreach variable.</span>
                <span class="r682 r">exprs</span>.<span class="i">Add</span>(<a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r679 r">stmt</span>.<a href="ast.cs.html#933ad75377815bca" class="i property">Condition</a>));
            }
            <b>else</b>
            {
                <span class="c">// For switch statement, we don&#39;t want the debugger to stop at &#39;stmt.Condition&#39; before evaluating it.</span>
                <span class="c">// The following enumeration will stop at &#39;stmt.Condition&#39; again, and we don&#39;t want the debugger to</span>
                <span class="c">// stop at &#39;stmt.Condition&#39; twice before getting into one of its case clauses.</span>
                <a href="Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r686 rd" class="r686 r">extent</span> = <span class="r679 r">stmt</span>.<a href="ast.cs.html#933ad75377815bca" class="i property">Condition</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                <b>int</b> <span id="r687 rd" class="r687 r">index</span> = <a href="#319aa081bb450665" class="i method">AddSequencePoint</a>(<span class="r686 r">extent</span>);
                <span class="r682 r">exprs</span>.<span class="i">Add</span>(<b>new</b> <a href="#0c9779f3c88dad20" class="t constructor">UpdatePositionExpr</a>(<span class="r686 r">extent</span>, <span class="r687 r">index</span>, <a href="#2807a84cb0b61e38" class="i field">_debugSymbolDocument</a>, <span class="r239 r">checkBreakpoints</span>: <b>false</b>));
            }
 
            <span class="r682 r">exprs</span>.<span class="i">Add</span>(
                <span class="i">Expression</span>.<span class="i">Assign</span>(
                    <span class="r685 r">enumerable</span>,
                    <a href="#40ca15cc8eff8987" class="i method">GetRangeEnumerator</a>(<span class="r679 r">stmt</span>.<a href="ast.cs.html#933ad75377815bca" class="i property">Condition</a>.<a href="ast.cs.html#158661f5f6c8db6d" class="i method">GetPureExpression</a>()) ?? <a href="#fed19bee56918521" class="i method">CaptureStatementResults</a>(<span class="r679 r">stmt</span>.<a href="ast.cs.html#933ad75377815bca" class="i property">Condition</a>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#052596a192f2302b" class="i field">Enumerable</a>).<span class="i">Convert</span>(<b>typeof</b>(<b>object</b>))));
 
            <b>var</b> <span id="r688 rd" class="r688 r">iteratorTemp</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<span class="i">IEnumerator</span>), <span class="r676 r">iteratorVariablePath</span>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>);
            <span class="r681 r">temps</span>.<span class="i">Add</span>(<span class="r688 r">iteratorTemp</span>);
            <span class="r682 r">exprs</span>.<span class="i">Add</span>(
                <span class="i">Expression</span>.<span class="i">Assign</span>(
                    <span class="r688 r">iteratorTemp</span>,
                    <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#e3fd1907f899e2b7" class="t t">PSEnumerableBinder</a>.<a href="../runtime/Binding/Binders.cs.html#5b720d77314adf15" class="i method">Get</a>(), <b>typeof</b>(<span class="i">IEnumerator</span>), <span class="r685 r">enumerable</span>)));
 
            <span class="c">// In a foreach, generate:</span>
            <span class="c">//     if ($foreach == $null &amp;&amp; $enumerable != $null)</span>
            <span class="c">//     {</span>
            <span class="c">//         $foreach = (new object[] { $enumerable }).GetEnumerator()</span>
            <span class="c">//     }</span>
            <span class="c">// In a switch, generate:</span>
            <span class="c">//     if ($switch == $null)</span>
            <span class="c">//     {</span>
            <span class="c">//         $switch = (new object[] { $enumerable }).GetEnumerator()</span>
            <span class="c">//     }</span>
            <b>var</b> <span id="r689 rd" class="r689 r">testNeedScalarToEnumerable</span> =
                <span class="r684 r">generatingForeach</span>
                    ? <span class="i">Expression</span>.<span class="i">AndAlso</span>(
                        <span class="i">Expression</span>.<span class="i">Equal</span>(<span class="r688 r">iteratorTemp</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>),
                        <span class="i">Expression</span>.<span class="i">NotEqual</span>(<span class="r685 r">enumerable</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>))
                    : <span class="i">Expression</span>.<span class="i">Equal</span>(<span class="r688 r">iteratorTemp</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>);
            <b>var</b> <span id="r690 rd" class="r690 r">scalarToEnumerable</span> =
                <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r688 r">iteratorTemp</span>,
                    <span class="i">Expression</span>.<span class="i">Call</span>(<span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<b>object</b>),
                                        <span class="i">Expression</span>.<span class="i">Convert</span>(<span class="r685 r">enumerable</span>, <b>typeof</b>(<b>object</b>))),
                                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#6f928f7817a7ff84" class="i field">IEnumerable_GetEnumerator</a>));
            <span class="r682 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">IfThen</span>(<span class="r689 r">testNeedScalarToEnumerable</span>, <span class="r690 r">scalarToEnumerable</span>));
            <span class="r682 r">exprs</span>.<span class="i">Add</span>(<span class="r683 r">avs</span>.<span class="i">SetNewValue</span>(<span class="r688 r">iteratorTemp</span>));
 
            <b>var</b> <span id="r691 rd" class="r691 r">moveNext</span> = <span class="i">Expression</span>.<span class="i">Block</span>(
                    <span class="r677 r">generateMoveNextUpdatePosition</span>(),
                    <span class="i">Expression</span>.<span class="i">Call</span>(<span class="r688 r">iteratorTemp</span>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#7f3d3c7d1634dc0d" class="i field">IEnumerator_MoveNext</a>));
 
            <b>var</b> <span id="r692 rd" class="r692 r">loop</span> = <span class="i">GenerateWhileLoop</span>(
                <span class="r679 r">stmt</span>.<a href="ast.cs.html#6e78c18e515b91da" class="i property">Label</a>,
                () =&gt; <span class="r691 r">moveNext</span>,
                (<span id="r693 rd" class="r693 r">loopBody</span>, <span id="r694 rd" class="r694 r">breakTarget</span>, <span id="r695 rd" class="r695 r">continueTarget</span>) =&gt; <span class="r680 r">generateBody</span>(<span class="r693 r">loopBody</span>, <span class="i">Expression</span>.<span class="i">Property</span>(<span class="r688 r">iteratorTemp</span>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#bee7aefc0941b149" class="i field">IEnumerator_Current</a>)));
 
            <span class="c">// With a foreach, the enumerator may never get assigned, in which case we skip the loop entirely.</span>
            <span class="c">// Generate that test.</span>
            <span class="c">// With a switch, the switch body is never skipped, so skip generating that test, and skip creating</span>
            <span class="c">// target block.</span>
            <b>if</b> (<span class="r684 r">generatingForeach</span>)
            {
                <span class="r682 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">IfThen</span>(<span class="i">Expression</span>.<span class="i">NotEqual</span>(<span class="r688 r">iteratorTemp</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>), <span class="r692 r">loop</span>));
            }
            <b>else</b>
            {
                <span class="r682 r">exprs</span>.<span class="i">Add</span>(<span class="r692 r">loop</span>);
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(
                <span class="r681 r">temps</span>.<span class="i">Concat</span>(<span class="r683 r">avs</span>.<a href="#7481fc94ce0492e3" class="i method">GetTemps</a>()),
                <span class="i">Expression</span>.<span class="i">TryFinally</span>(<span class="i">Expression</span>.<span class="i">Block</span>(<span class="r682 r">exprs</span>), <span class="r683 r">avs</span>.<a href="#2dccc766e8722eb7" class="i method">RestoreAutomaticVar</a>()));
        }
 
        <b>public object</b> <a id="7375d5712a868383" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitForEachStatement</a>(<a href="ast.cs.html#9ae6aa2909fef7b0" class="t t">ForEachStatementAst</a> <span id="r696 rd" class="r696 r">forEachStatementAst</span>)
        {
            <span class="c">// We convert:</span>
            <span class="c">//     foreach ($x in $enumerable) {}</span>
            <span class="c">// Into:</span>
            <span class="c">//     $foreach = GetEnumerator $enumerable</span>
            <span class="c">//     if ($foreach == $null &amp;&amp; $enumerable != $null)</span>
            <span class="c">//     {</span>
            <span class="c">//         $foreach  = (new object[] { $enumerable }).GetEnumerator()</span>
            <span class="c">//     }</span>
            <span class="c">//     if ($foreach != $null)</span>
            <span class="c">//     {</span>
            <span class="c">//         while ($foreach.MoveNext())</span>
            <span class="c">//         {</span>
            <span class="c">//             $x = $foreach.Current</span>
            <span class="c">//         }</span>
            <span class="c">//     }</span>
            <span class="i">Action</span>&lt;<span class="i">List</span>&lt;<span class="i">Expression</span>&gt;, <span class="i">Expression</span>&gt; <span id="r697 rd" class="r697 r">loopBodyGenerator</span> =
                (<span id="r698 rd" class="r698 r">exprs</span>, <span id="r699 rd" class="r699 r">newValue</span>) =&gt;
                {
                    <span class="r698 r">exprs</span>.<span class="i">Add</span>(<span class="i">ReduceAssignment</span>(<span class="r696 r">forEachStatementAst</span>.<a href="ast.cs.html#913a1ea5efca1400" class="i property">Variable</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d78e08594ff6b79a" class="i field">Equals</a>, <span class="r699 r">newValue</span>));
                    <span class="r698 r">exprs</span>.<span class="i">Add</span>(<a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r696 r">forEachStatementAst</span>.<a href="ast.cs.html#246ea985df627fa9" class="i property">Body</a>));
                };
 
            <b>return</b> <span class="i">GenerateIteratorStatement</span>(
                <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#c408ef1bd6951229" class="i field">foreachVarPath</a>,
                () =&gt; <a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r696 r">forEachStatementAst</span>.<a href="ast.cs.html#913a1ea5efca1400" class="i property">Variable</a>),
                <a href="#0ae9e05f0dbd60e7" class="i field">_foreachTupleIndex</a>,
                <span class="r696 r">forEachStatementAst</span>,
                <span class="r697 r">loopBodyGenerator</span>);
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="40ca15cc8eff8987" href="../../R/40ca15cc8eff8987.html" target="n" data-glyph="76,1" class="i method">GetRangeEnumerator</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r700 rd" class="r700 r">condExpr</span>)
        {
            <b>if</b> (<span class="r700 r">condExpr</span> != <b>null</b>)
            {
                <a href="ast.cs.html#f3e3848ef2eae593" class="k">var</a> <span id="r701 rd" class="r701 r">binaryExpr</span> = <span class="r700 r">condExpr</span> <b>as</b> <a href="ast.cs.html#f3e3848ef2eae593" class="t t">BinaryExpressionAst</a>;
                <b>if</b> (<span class="r701 r">binaryExpr</span> != <b>null</b> &amp;&amp; <span class="r701 r">binaryExpr</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7e27eae9f0abe570" class="i field">DotDot</a>)
                {
                    <span class="i">Expression</span> <span id="r702 rd" class="r702 r">lhs</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r701 r">binaryExpr</span>.<a href="ast.cs.html#e19b481693ff50d7" class="i property">Left</a>);
                    <span class="i">Expression</span> <span id="r703 rd" class="r703 r">rhs</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r701 r">binaryExpr</span>.<a href="ast.cs.html#c43edc792b1ee433" class="i property">Right</a>);
 
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#6d034b2ff43d9189" class="i field">ParserOps_GetRangeEnumerator</a>,
                        <span class="r702 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r703 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)));
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="67340597819c9db4" href="../../R/67340597819c9db4.html" target="n" data-glyph="76,1" class="i method">UpdatePositionForInitializerOrCondition</a>(<a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r704 rd" class="r704 r">pipelineBaseAst</span>, <span class="i">Expression</span> <span id="r705 rd" class="r705 r">initializerOrCondition</span>)
        {
            <b>if</b> (<span class="r704 r">pipelineBaseAst</span> <b>is</b> <a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r706 rd" class="r706 r">pipelineAst</span> &amp;&amp; !<span class="r706 r">pipelineAst</span>.<a href="ast.cs.html#552590fec9ffecb9" class="i property">Background</a> &amp;&amp; <span class="r706 r">pipelineAst</span>.<a href="ast.cs.html#df65de159259e5e0" class="i method">GetPureExpression</a>() != <b>null</b>)
            {
                <span class="c">// If the initializer or condition is a pure expression (CommandExpressionAst without redirection),</span>
                <span class="c">// then we need to add a sequence point. If it&#39;s an AssignmentStatementAst, we don&#39;t need to add</span>
                <span class="c">// sequence point here because one will be added when processing the AssignmentStatementAst.</span>
                <span class="r705 r">initializerOrCondition</span> = <span class="i">Expression</span>.<span class="i">Block</span>(<a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r704 r">pipelineBaseAst</span>), <span class="r705 r">initializerOrCondition</span>);
            }
 
            <b>return</b> <span class="r705 r">initializerOrCondition</span>;
        }
 
        <b>public object</b> <a id="8b7adf0a6749b61a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitDoWhileStatement</a>(<a href="ast.cs.html#b2d1fe560ff56deb" class="t t">DoWhileStatementAst</a> <span id="r707 rd" class="r707 r">doWhileStatementAst</span>)
        {
            <b>return</b> <a href="#b731a66c7ec8d164" class="i method">GenerateDoLoop</a>(<span class="r707 r">doWhileStatementAst</span>);
        }
 
        <b>public object</b> <a id="5e9786e9d0cec14b" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitDoUntilStatement</a>(<a href="ast.cs.html#d641b5faf306abeb" class="t t">DoUntilStatementAst</a> <span id="r708 rd" class="r708 r">doUntilStatementAst</span>)
        {
            <b>return</b> <a href="#b731a66c7ec8d164" class="i method">GenerateDoLoop</a>(<span class="r708 r">doUntilStatementAst</span>);
        }
 
        <b>public object</b> <a id="fbb3021fab132c44" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitForStatement</a>(<a href="ast.cs.html#4ca51f16f7c100d4" class="t t">ForStatementAst</a> <span id="r709 rd" class="r709 r">forStatementAst</span>)
        {
            <span class="c">// We should not preserve the partial output if exception is thrown when evaluating the initializer.</span>
            <span class="i">Expression</span> <span id="r710 rd" class="r710 r">init</span> = <b>null</b>;
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r711 rd" class="r711 r">initializer</span> = <span class="r709 r">forStatementAst</span>.<a href="ast.cs.html#942ba53dacb0f05a" class="i property">Initializer</a>;
            <b>if</b> (<span class="r711 r">initializer</span> != <b>null</b>)
            {
                <span class="r710 r">init</span> = <a href="#fed19bee56918521" class="i method">CaptureStatementResults</a>(<span class="r711 r">initializer</span>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>);
                <span class="r710 r">init</span> = <a href="#67340597819c9db4" class="i method">UpdatePositionForInitializerOrCondition</a>(<span class="r711 r">initializer</span>, <span class="r710 r">init</span>);
            }
 
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r712 rd" class="r712 r">condition</span> = <span class="r709 r">forStatementAst</span>.<a href="ast.cs.html#933ad75377815bca" class="i property">Condition</a>;
            <b>var</b> <span id="r713 rd" class="r713 r">generateCondition</span> = <span class="r712 r">condition</span> != <b>null</b>
                ? () =&gt; <a href="#67340597819c9db4" class="i method">UpdatePositionForInitializerOrCondition</a>(<span class="r712 r">condition</span>, <a href="#fed19bee56918521" class="i method">CaptureStatementResults</a>(<span class="r712 r">condition</span>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#2ae33340eb67d1d1" class="i field">Condition</a>))
                : (<span class="i">Func</span>&lt;<span class="i">Expression</span>&gt;)<b>null</b>;
 
            <b>var</b> <span id="r714 rd" class="r714 r">loop</span> = <span class="i">GenerateWhileLoop</span>(
                <span class="r709 r">forStatementAst</span>.<a href="ast.cs.html#6e78c18e515b91da" class="i property">Label</a>,
                <span class="r713 r">generateCondition</span>,
                (<span id="r715 rd" class="r715 r">loopBody</span>, <span id="r716 rd" class="r716 r">breakTarget</span>, <span id="r717 rd" class="r717 r">continueTarget</span>) =&gt; <span class="r715 r">loopBody</span>.<span class="i">Add</span>(<a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r709 r">forStatementAst</span>.<a href="ast.cs.html#246ea985df627fa9" class="i property">Body</a>)),
                <span class="r709 r">forStatementAst</span>.<a href="ast.cs.html#48de440e240c2649" class="i property">Iterator</a>);
 
            <b>if</b> (<span class="r710 r">init</span> != <b>null</b>)
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r710 r">init</span>, <span class="r714 r">loop</span>);
            }
 
            <b>return</b> <span class="r714 r">loop</span>;
        }
 
        <b>public object</b> <a id="9e911c9421a0be14" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitWhileStatement</a>(<a href="ast.cs.html#4e9a52b62ed8b2b1" class="t t">WhileStatementAst</a> <span id="r718 rd" class="r718 r">whileStatementAst</span>)
        {
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r719 rd" class="r719 r">condition</span> = <span class="r718 r">whileStatementAst</span>.<a href="ast.cs.html#933ad75377815bca" class="i property">Condition</a>;
            <b>return</b> <span class="i">GenerateWhileLoop</span>(
                <span class="r718 r">whileStatementAst</span>.<a href="ast.cs.html#6e78c18e515b91da" class="i property">Label</a>,
                () =&gt; <a href="#67340597819c9db4" class="i method">UpdatePositionForInitializerOrCondition</a>(<span class="r719 r">condition</span>, <a href="#fed19bee56918521" class="i method">CaptureStatementResults</a>(<span class="r719 r">condition</span>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#2ae33340eb67d1d1" class="i field">Condition</a>)),
                (<span id="r720 rd" class="r720 r">loopBody</span>, <span id="r721 rd" class="r721 r">breakTarget</span>, <span id="r722 rd" class="r722 r">continueTarget</span>) =&gt; <span class="r720 r">loopBody</span>.<span class="i">Add</span>(<a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r718 r">whileStatementAst</span>.<a href="ast.cs.html#246ea985df627fa9" class="i property">Body</a>)));
        }
 
        <b>public object</b> <a id="93005daee4c5b5c5" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitCatchClause</a>(<a href="ast.cs.html#fafbccc59f688c0e" class="t t">CatchClauseAst</a> <span id="r723 rd" class="r723 r">catchClauseAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;the catch body is visited directly from VisitTryStatement.&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <span class="c">// This helper class is used to help save and restore the value of an automatic variable that is set</span>
        <span class="c">// as part of executing some statement, then restored to it&#39;s previous value after the statement completes.</span>
        <span class="c">//</span>
        <span class="c">// The basic idea is, if the automatic var has a value in the current frame, save it and restore it.</span>
        <span class="c">// If the automatic var has no value in the current frame, then we set the variable&#39;s value to $null</span>
        <span class="c">// after leaving the stmt.</span>
        <span class="c">//</span>
        <span class="c">// The psuedo-code:</span>
        <span class="c">//</span>
        <span class="c">//    try {</span>
        <span class="c">//        oldValue = (localSet.Get(automaticVar)) ? locals.ItemNNN : null;</span>
        <span class="c">//        locals.ItemNNN = newValue</span>
        <span class="c">//        localsSet.Set(automaticVar, true);</span>
        <span class="c">//        any code</span>
        <span class="c">//    } finally {</span>
        <span class="c">//        locals.ItemNNN = oldValue;</span>
        <span class="c">//    }</span>
        <span class="c">//</span>
        <span class="c">// This is a little convoluted because an automatic variable isn&#39;t necessarily set.</span>
        <b>private sealed class</b> <a id="165aab6cc04f9303" href="../../R/165aab6cc04f9303.html" target="n" data-glyph="4,1" class="t t">AutomaticVarSaver</a>
        {
            <b>private readonly</b> <a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <a id="1c63046346b7fd9e" href="../../R/1c63046346b7fd9e.html" target="n" data-glyph="46,2" class="i field">_compiler</a>;
            <b>private readonly int</b> <a id="bb7ffc1aeea62513" href="../../R/bb7ffc1aeea62513.html" target="n" data-glyph="46,2" class="i field">_automaticVar</a>;
            <b>private readonly</b> <a href="../VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <a id="8eb1ea867893c75a" href="../../R/8eb1ea867893c75a.html" target="n" data-glyph="46,2" class="i field">_autoVarPath</a>;
            <b>private</b> <span class="i">ParameterExpression</span> <a id="b34f75b431045c23" href="../../R/b34f75b431045c23.html" target="n" data-glyph="46,2" class="i field">_oldValue</a>;
 
            <b>internal</b> <a id="3144e6a2eb6c2eb6" href="../../R/3144e6a2eb6c2eb6.html" target="n" data-glyph="74,2" class="t constructor">AutomaticVarSaver</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r724 rd" class="r724 r">compiler</span>, <a href="../VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r725 rd" class="r725 r">autoVarPath</span>, <b>int</b> <span id="r726 rd" class="r726 r">automaticVar</span>)
            {
                <a href="#1c63046346b7fd9e" class="i field">_compiler</a> = <span class="r724 r">compiler</span>;
                <a href="#8eb1ea867893c75a" class="i field">_autoVarPath</a> = <span class="r725 r">autoVarPath</span>;
                <a href="#bb7ffc1aeea62513" class="i field">_automaticVar</a> = <span class="r726 r">automaticVar</span>;
            }
 
            <b>internal</b> <span class="i">IEnumerable</span>&lt;<span class="i">ParameterExpression</span>&gt; <a id="7481fc94ce0492e3" href="../../R/7481fc94ce0492e3.html" target="n" data-glyph="74,2" class="i method">GetTemps</a>()
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#b34f75b431045c23" class="i field">_oldValue</a> != <b>null</b>, <span class="s">&quot;caller to only call GetTemps after calling SaveAutomaticVar&quot;</span>);
                <b>yield</b> <b>return</b> <a href="#b34f75b431045c23" class="i field">_oldValue</a>;
            }
 
            <b>internal</b> <span class="i">Expression</span> <a id="8a259f231ef9add7" href="../../R/8a259f231ef9add7.html" target="n" data-glyph="74,2" class="i method">SaveAutomaticVar</a>()
            {
                <b>var</b> <span id="r727 rd" class="r727 r">getValueExpr</span> = <a href="#bb7ffc1aeea62513" class="i field">_automaticVar</a> &lt; 0
                                       ? <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">CallGetVariable</span>(<span class="i">Expression</span>.<span class="i">Constant</span>(<a href="#8eb1ea867893c75a" class="i field">_autoVarPath</a>), <b>null</b>)
                                       : <a href="#1c63046346b7fd9e" class="i field">_compiler</a>.<a href="#719f3e105a567e40" class="i method">GetLocal</a>(<a href="#bb7ffc1aeea62513" class="i field">_automaticVar</a>);
                <a href="#b34f75b431045c23" class="i field">_oldValue</a> = <a href="#1c63046346b7fd9e" class="i field">_compiler</a>.<span class="i">NewTemp</span>(<span class="r727 r">getValueExpr</span>.<span class="i">Type</span>, <span class="s">&quot;old_&quot;</span> + <a href="#8eb1ea867893c75a" class="i field">_autoVarPath</a>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>);
                <b>return</b> <span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#b34f75b431045c23" class="i field">_oldValue</a>, <span class="r727 r">getValueExpr</span>);
            }
 
            <b>internal</b> <span class="i">Expression</span> <a id="64cc81d0a89fcae9" href="../../R/../../0000000000.html" target="n" data-glyph="74,2" class="i method">SetNewValue</a>(<span class="i">Expression</span> <span id="r728 rd" class="r728 r">newValue</span>)
            {
                <b>if</b> (<a href="#bb7ffc1aeea62513" class="i field">_automaticVar</a> &lt; 0)
                {
                    <b>return</b> <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">CallSetVariable</span>(<span class="i">Expression</span>.<span class="i">Constant</span>(<a href="#8eb1ea867893c75a" class="i field">_autoVarPath</a>), <span class="r728 r">newValue</span>);
                }
 
                <b>return</b> <span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#1c63046346b7fd9e" class="i field">_compiler</a>.<a href="#719f3e105a567e40" class="i method">GetLocal</a>(<a href="#bb7ffc1aeea62513" class="i field">_automaticVar</a>), <span class="r728 r">newValue</span>);
            }
 
            <b>internal</b> <span class="i">Expression</span> <a id="2dccc766e8722eb7" href="../../R/2dccc766e8722eb7.html" target="n" data-glyph="74,2" class="i method">RestoreAutomaticVar</a>()
            {
                <b>if</b> (<a href="#bb7ffc1aeea62513" class="i field">_automaticVar</a> &lt; 0)
                {
                    <b>return</b> <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">CallSetVariable</span>(<span class="i">Expression</span>.<span class="i">Constant</span>(<a href="#8eb1ea867893c75a" class="i field">_autoVarPath</a>), <a href="#b34f75b431045c23" class="i field">_oldValue</a>);
                }
 
                <b>return</b> <span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#1c63046346b7fd9e" class="i field">_compiler</a>.<a href="#719f3e105a567e40" class="i method">GetLocal</a>(<a href="#bb7ffc1aeea62513" class="i field">_automaticVar</a>), <a href="#b34f75b431045c23" class="i field">_oldValue</a>);
            }
        }
 
        <b>public object</b> <a id="4baaf3ca4971f9ad" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitTryStatement</a>(<a href="ast.cs.html#9827b5d12d62be7f" class="t t">TryStatementAst</a> <span id="r729 rd" class="r729 r">tryStatementAst</span>)
        {
            <b>var</b> <span id="r730 rd" class="r730 r">temps</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt;();
            <b>var</b> <span id="r731 rd" class="r731 r">tryBlockExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <b>var</b> <span id="r732 rd" class="r732 r">finallyBlockExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
 
            <span class="c">// We must set $ExecutionContext.PropagateExceptionsToEnclosingStatementBlock = $true so we don&#39;t prompt</span>
            <span class="c">// if an exception is raised, and we must restore the previous value when leaving because we can&#39;t</span>
            <span class="c">// know if we&#39;re dynamically executing code guarded by a try/catch.</span>
            <b>var</b> <span id="r733 rd" class="r733 r">oldActiveHandler</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<b>bool</b>), <span class="s">&quot;oldActiveHandler&quot;</span>);
            <span class="r730 r">temps</span>.<span class="i">Add</span>(<span class="r733 r">oldActiveHandler</span>);
            <b>var</b> <span id="r734 rd" class="r734 r">handlerInScope</span> = <span class="i">Expression</span>.<span class="i">Property</span>(
                <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#a7f8c6f9891fd821" class="i field">ExecutionContext_ExceptionHandlerInEnclosingStatementBlock</a>);
            <span class="r731 r">tryBlockExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r733 r">oldActiveHandler</span>, <span class="r734 r">handlerInScope</span>));
            <span class="r731 r">tryBlockExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r734 r">handlerInScope</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>)));
            <span class="r732 r">finallyBlockExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r734 r">handlerInScope</span>, <span class="r733 r">oldActiveHandler</span>));
 
            <a href="#de2c28a71e25c894" class="i method">CompileStatementListWithTraps</a>(<span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#591cd17e760ea038" class="i property">Body</a>.<a href="ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>, <span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#591cd17e760ea038" class="i property">Body</a>.<a href="ast.cs.html#8a3ec42ea63c1318" class="i property">Traps</a>, <span class="r731 r">tryBlockExprs</span>, <span class="r730 r">temps</span>);
 
            <b>var</b> <span id="r735 rd" class="r735 r">catches</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">CatchBlock</span>&gt;();
 
            <b>if</b> (<span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>.<span class="i">Count</span> == 1 &amp;&amp; <span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>[0].<span class="i">IsCatchAll</span>)
            {
                <span class="c">// Generate:</span>
                <span class="c">//    catch (RuntimeException rte)</span>
                <span class="c">//    {</span>
                <span class="c">//        oldrte = context.CurrentExceptionBeingHandled</span>
                <span class="c">//        context.CurrentExceptionBeingHandled = rte</span>
                <span class="c">//        oldDollarUnder = $_</span>
                <span class="c">//        $_ = new ErrorRecord(rte.ErrorRecord, rte)</span>
                <span class="c">//        try {</span>
                <span class="c">//            user catch code</span>
                <span class="c">//        } finally {</span>
                <span class="c">//            $_ = oldDollarUnder</span>
                <span class="c">//            context.CurrentExceptionBeingHandled = oldrte</span>
                <span class="c">//        }</span>
                <a href="#165aab6cc04f9303" class="t t">AutomaticVarSaver</a> <span id="r736 rd" class="r736 r">avs</span> = <b>new</b> <a href="#3144e6a2eb6c2eb6" class="t constructor">AutomaticVarSaver</a>(
                    <a href="#8bdfc042f41c96c5" class="k">this</a>, <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#d68ec187d548de92" class="i field">UnderbarVarPath</a>,
                    (<b>int</b>)<a href="../SpecialVariables.cs.html#1c6f2efd91287b59" class="t t">AutomaticVariable</a>.<a href="../SpecialVariables.cs.html#3599fdc9d261201f" class="i field">Underbar</a>);
                <b>var</b> <span id="r737 rd" class="r737 r">rte</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="s">&quot;rte&quot;</span>);
                <b>var</b> <span id="r738 rd" class="r738 r">oldrte</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="s">&quot;oldrte&quot;</span>);
                <b>var</b> <span id="r739 rd" class="r739 r">errorRecord</span> = <span class="i">Expression</span>.<span class="i">New</span>(
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#353a972acd7c31f5" class="i field">ErrorRecord__ctor</a>,
                    <span class="i">Expression</span>.<span class="i">Property</span>(<span class="r737 r">rte</span>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#b261c6a9d0b55c2d" class="i field">RuntimeException_ErrorRecord</a>),
                    <span class="r737 r">rte</span>);
                <b>var</b> <span id="r740 rd" class="r740 r">catchExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;
                                    {
                                        <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r738 r">oldrte</span>, <a href="#a6b2b6aa258ffb38" class="i field">s_currentExceptionBeingHandled</a>),
                                        <span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#a6b2b6aa258ffb38" class="i field">s_currentExceptionBeingHandled</a>, <span class="r737 r">rte</span>),
                                        <span class="r736 r">avs</span>.<a href="#8a259f231ef9add7" class="i method">SaveAutomaticVar</a>(),
                                        <span class="r736 r">avs</span>.<span class="i">SetNewValue</span>(<span class="r739 r">errorRecord</span>)
                                    };
                <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r741 rd" class="r741 r">statementBlock</span> = <span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>[0].<span class="i">Body</span>;
                <a href="#de2c28a71e25c894" class="i method">CompileStatementListWithTraps</a>(<span class="r741 r">statementBlock</span>.<a href="ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>, <span class="r741 r">statementBlock</span>.<a href="ast.cs.html#8a3ec42ea63c1318" class="i property">Traps</a>, <span class="r740 r">catchExprs</span>, <span class="r730 r">temps</span>);
 
                <b>var</b> <span id="r742 rd" class="r742 r">tf</span> = <span class="i">Expression</span>.<span class="i">TryFinally</span>(
                    <span class="i">Expression</span>.<span class="i">Block</span>(<b>typeof</b>(<b>void</b>), <span class="r740 r">catchExprs</span>),
                    <span class="i">Expression</span>.<span class="i">Block</span>(<b>typeof</b>(<b>void</b>), <span class="r736 r">avs</span>.<a href="#2dccc766e8722eb7" class="i method">RestoreAutomaticVar</a>(), <span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#a6b2b6aa258ffb38" class="i field">s_currentExceptionBeingHandled</a>, <span class="r738 r">oldrte</span>)));
 
                <span class="r735 r">catches</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Catch</span>(<b>typeof</b>(<a href="../../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>), <span class="i">Expression</span>.<span class="i">Rethrow</span>()));
                <span class="r735 r">catches</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Catch</span>(<span class="r737 r">rte</span>, <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r736 r">avs</span>.<a href="#7481fc94ce0492e3" class="i method">GetTemps</a>().<span class="i">Append</span>(<span class="r738 r">oldrte</span>).<span class="i">ToArray</span>(), <span class="r742 r">tf</span>)));
            }
            <b>else</b> <b>if</b> (<span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="c">// We can&#39;t generate a try/catch in quite the way one might expect for a few reasons:</span>
                <span class="c">//     * At compile time, we may not have loaded the types that are being caught</span>
                <span class="c">//     * We wrap exceptions in a RuntimeException so they can carry a position.</span>
                <span class="c">//</span>
                <span class="c">// Instead, we generate something like:</span>
                <span class="c">//     try {}</span>
                <span class="c">//     catch (RuntimeException re) {</span>
                <span class="c">//         try</span>
                <span class="c">//         {</span>
                <span class="c">//             oldexception = context.CurrentExceptionBeingHandled</span>
                <span class="c">//             context.CurrentExceptionBeingHandled = re</span>
                <span class="c">//             old_ = $_</span>
                <span class="c">//             $_ = re.ErrorRecord</span>
                <span class="c">//             switch (ExceptionHandlingOps.FindMatchingHandler(re, types))</span>
                <span class="c">//             {</span>
                <span class="c">//             case 0:</span>
                <span class="c">//                  /* first handler */</span>
                <span class="c">//                  break;</span>
                <span class="c">//             case 1:</span>
                <span class="c">//             case 2:</span>
                <span class="c">//                  /* second handler (we do allow a single handler for multiple types) */</span>
                <span class="c">//                  break;</span>
                <span class="c">//             default:</span>
                <span class="c">//                  /* no matching handler, but could be a trap or user might want prompting */</span>
                <span class="c">//                  /* will rethrow the exception if that&#39;s what we need to do */</span>
                <span class="c">//                  ExceptionHandlingOps.CheckActionPreference(functionContext, exception);</span>
                <span class="c">//             }</span>
                <span class="c">//         } finally {</span>
                <span class="c">//             $_ = old_</span>
                <span class="c">//             context.CurrentExceptionBeingHandled = oldexception</span>
                <span class="c">//         }</span>
                <span class="c">//     }</span>
 
                <span class="c">// Try to get the types at compile time.  We could end up with nulls in this array, we&#39;ll handle</span>
                <span class="c">// that with runtime code.</span>
                <b>int</b> <span id="r743 rd" class="r743 r">countTypes</span> = 0;
                <b>for</b> (<b>int</b> <span id="r744 rd" class="r744 r">index</span> = 0; <span class="r744 r">index</span> &lt; <span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>.<span class="i">Count</span>; <span class="r744 r">index</span>++)
                {
                    <b>var</b> <span id="r745 rd" class="r745 r">c</span> = <span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>[<span class="r744 r">index</span>];
 
                    <span class="c">// If CatchTypes.Count is empty, we still want to count the catch all handler.</span>
                    <span class="r743 r">countTypes</span> += <span class="i">Math</span>.<span class="i">Max</span>(<span class="r745 r">c</span>.<span class="i">CatchTypes</span>.<span class="i">Count</span>, 1);
                }
 
                <b>var</b> <span id="r746 rd" class="r746 r">catchTypes</span> = <b>new</b> <span class="i">Type</span>[<span class="r743 r">countTypes</span>];
                <span class="i">Expression</span> <span id="r747 rd" class="r747 r">catchTypesExpr</span> = <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r746 r">catchTypes</span>);
                <b>var</b> <span id="r748 rd" class="r748 r">dynamicCatchTypes</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
                <b>var</b> <span id="r749 rd" class="r749 r">cases</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">SwitchCase</span>&gt;();
                <b>int</b> <span id="r750 rd" class="r750 r">handlerTypeIndex</span> = 0;
                <b>int</b> <span id="r751 rd" class="r751 r">i</span> = 0;
 
                <b>var</b> <span id="r752 rd" class="r752 r">exception</span> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>));
                <b>for</b> (<b>int</b> <span id="r753 rd" class="r753 r">index</span> = 0; <span class="r753 r">index</span> &lt; <span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>.<span class="i">Count</span>; <span class="r753 r">index</span>++)
                {
                    <b>var</b> <span id="r754 rd" class="r754 r">c</span> = <span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#29d08ecdd9ce8b5a" class="i property">CatchClauses</a>[<span class="r753 r">index</span>];
                    <b>if</b> (<span class="r754 r">c</span>.<span class="i">IsCatchAll</span>)
                    {
                        <span class="r746 r">catchTypes</span>[<span class="r751 r">i</span>] = <b>typeof</b>(<a href="../runtime/Operations/MiscOps.cs.html#2b2e6cffbdd33d20" class="t t">ExceptionHandlingOps</a>.<a href="../runtime/Operations/MiscOps.cs.html#442e10289fb2ec35" class="t t">CatchAll</a>);
                    }
                    <b>else</b>
                    {
                        <b>for</b> (<b>int</b> <span id="r755 rd" class="r755 r">index1</span> = 0; <span class="r755 r">index1</span> &lt; <span class="r754 r">c</span>.<span class="i">CatchTypes</span>.<span class="i">Count</span>; <span class="r755 r">index1</span>++)
                        {
                            <b>var</b> <span id="r756 rd" class="r756 r">ct</span> = <span class="r754 r">c</span>.<span class="i">CatchTypes</span>[<span class="r755 r">index1</span>];
                            <span class="r746 r">catchTypes</span>[<span class="r751 r">i</span>] = <span class="r756 r">ct</span>.<span class="i">TypeName</span>.<span class="i">GetReflectionType</span>();
                            <b>if</b> (<span class="r746 r">catchTypes</span>[<span class="r751 r">i</span>] == <b>null</b>)
                            {
                                <span class="c">// Type needs to be resolved at runtime, so we&#39;ll use code like:</span>
                                <span class="c">//</span>
                                <span class="c">// if (catchTypes[i] == null) catchTypes[i] = ResolveTypeName(ct.TypeName)</span>
                                <span class="c">//</span>
                                <span class="c">// We use a constant array, resolve just once (unless it fails) to prevent re-resolving</span>
                                <span class="c">// each time it executes.</span>
                                <b>var</b> <span id="r757 rd" class="r757 r">indexExpr</span> = <span class="i">Expression</span>.<span class="i">ArrayAccess</span>(<span class="r747 r">catchTypesExpr</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(<span class="r751 r">i</span>));
                                <span class="r748 r">dynamicCatchTypes</span>.<span class="i">Add</span>(
                                    <span class="i">Expression</span>.<span class="i">IfThen</span>(
                                        <span class="i">Expression</span>.<span class="i">Equal</span>(<span class="r757 r">indexExpr</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#bebe5451f0389888" class="i field">NullType</a>),
                                        <span class="i">Expression</span>.<span class="i">Assign</span>(
                                            <span class="r757 r">indexExpr</span>,
                                            <span class="i">Expression</span>.<span class="i">Call</span>(
                                                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#c5cefd491e42dea3" class="i field">TypeOps_ResolveTypeName</a>,
                                                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r756 r">ct</span>.<span class="i">TypeName</span>),
                                                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r756 r">ct</span>.<span class="i">Extent</span>)))));
                            }
 
                            <span class="r751 r">i</span> += 1;
                        }
                    }
 
                    <span class="c">// Wrap the body in a void block so all cases have the same type.</span>
                    <b>var</b> <span id="r758 rd" class="r758 r">catchBody</span> = <span class="i">Expression</span>.<span class="i">Block</span>(<b>typeof</b>(<b>void</b>), <span class="i">Compile</span>(<span class="r754 r">c</span>.<span class="i">Body</span>));
 
                    <b>if</b> (<span class="r754 r">c</span>.<span class="i">IsCatchAll</span>)
                    {
                        <span class="r749 r">cases</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">SwitchCase</span>(<span class="r758 r">catchBody</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(<span class="r750 r">handlerTypeIndex</span>)));
                        <span class="r750 r">handlerTypeIndex</span> += 1;
                    }
                    <b>else</b>
                    {
                        <span class="r749 r">cases</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">SwitchCase</span>(<span class="r758 r">catchBody</span>,
                                                        <span class="i">Enumerable</span>.<span class="i">Range</span>(<span class="r750 r">handlerTypeIndex</span>, <span class="r754 r">c</span>.<span class="i">CatchTypes</span>.<span class="i">Count</span>).<span class="i">Select</span>(<a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<span class="i">Constant</span>)));
                        <span class="r750 r">handlerTypeIndex</span> += <span class="r754 r">c</span>.<span class="i">CatchTypes</span>.<span class="i">Count</span>;
                    }
                }
 
                <b>if</b> (<span class="r748 r">dynamicCatchTypes</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="c">// This might be worth a strict-mode check - if there was a typo, the typo isn&#39;t discovered until</span>
                    <span class="c">// the first time an exception is raised, which is rather unfortunate.</span>
                    <span class="r747 r">catchTypesExpr</span> = <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r748 r">dynamicCatchTypes</span>.<span class="i">Append</span>(<span class="r747 r">catchTypesExpr</span>));
                }
 
                <a href="#165aab6cc04f9303" class="t t">AutomaticVarSaver</a> <span id="r759 rd" class="r759 r">avs</span> = <b>new</b> <a href="#3144e6a2eb6c2eb6" class="t constructor">AutomaticVarSaver</a>(<a href="#8bdfc042f41c96c5" class="k">this</a>, <a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#d68ec187d548de92" class="i field">UnderbarVarPath</a>, (<b>int</b>)<a href="../SpecialVariables.cs.html#1c6f2efd91287b59" class="t t">AutomaticVariable</a>.<a href="../SpecialVariables.cs.html#3599fdc9d261201f" class="i field">Underbar</a>);
                <b>var</b> <span id="r760 rd" class="r760 r">swCond</span> = <span class="i">Expression</span>.<span class="i">Call</span>(
                    <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#5ea4e94605c73e80" class="i field">ExceptionHandlingOps_FindMatchingHandler</a>,
                    <a href="#60079b222ae29e0d" class="i property">LocalVariablesParameter</a>,
                    <span class="r752 r">exception</span>,
                    <span class="r747 r">catchTypesExpr</span>,
                    <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>);
                <b>var</b> <span id="r761 rd" class="r761 r">oldexception</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<a href="../../utils/RuntimeException.cs.html#bd88f263eb295545" class="t t">RuntimeException</a>), <span class="s">&quot;oldrte&quot;</span>);
 
                <b>var</b> <span id="r762 rd" class="r762 r">tf</span> = <span class="i">Expression</span>.<span class="i">TryFinally</span>(
                    <span class="i">Expression</span>.<span class="i">Block</span>(
                        <b>typeof</b>(<b>void</b>),
                        <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r761 r">oldexception</span>, <a href="#a6b2b6aa258ffb38" class="i field">s_currentExceptionBeingHandled</a>),
                        <span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#a6b2b6aa258ffb38" class="i field">s_currentExceptionBeingHandled</a>, <span class="r752 r">exception</span>),
                        <span class="r759 r">avs</span>.<a href="#8a259f231ef9add7" class="i method">SaveAutomaticVar</a>(),
                        <span class="c">// $_ is set in the call to ExceptionHandlingOps.FindMatchingHandler</span>
                        <span class="i">Expression</span>.<span class="i">Switch</span>(
                            <span class="r760 r">swCond</span>,
                            <span class="i">Expression</span>.<span class="i">Call</span>(
                                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#8da10b470305ec34" class="i field">ExceptionHandlingOps_CheckActionPreference</a>,
                                <a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>, <span class="r752 r">exception</span>),
                            <span class="r749 r">cases</span>.<span class="i">ToArray</span>())),
                    <span class="i">Expression</span>.<span class="i">Block</span>(
                        <span class="r759 r">avs</span>.<a href="#2dccc766e8722eb7" class="i method">RestoreAutomaticVar</a>(),
                        <span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#a6b2b6aa258ffb38" class="i field">s_currentExceptionBeingHandled</a>, <span class="r761 r">oldexception</span>)));
 
                <span class="r735 r">catches</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Catch</span>(<b>typeof</b>(<a href="../../utils/ExecutionExceptions.cs.html#1b159d1cae338f33" class="t t">PipelineStoppedException</a>), <span class="i">Expression</span>.<span class="i">Rethrow</span>()));
                <span class="r735 r">catches</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Catch</span>(<span class="r752 r">exception</span>, <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r759 r">avs</span>.<a href="#7481fc94ce0492e3" class="i method">GetTemps</a>().<span class="i">Append</span>(<span class="r761 r">oldexception</span>).<span class="i">ToArray</span>(), <span class="r762 r">tf</span>)));
            }
 
            <b>if</b> (<span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#56a1309fed36b070" class="i property">Finally</a> != <b>null</b>)
            {
                <span class="c">// Generate:</span>
                <span class="c">//     oldIsStopping = ExceptionHandlingOps.SuspendStoppingPipeline(executionContext);</span>
                <span class="c">//     try {</span>
                <span class="c">//         user finally statements</span>
                <span class="c">//     } finally {</span>
                <span class="c">//         ExceptionHandlingOps.RestoreStoppingPipeline(executionContext, oldIsStopping);</span>
                <span class="c">//     }</span>
                <b>var</b> <span id="r763 rd" class="r763 r">oldIsStopping</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<b>bool</b>), <span class="s">&quot;oldIsStopping&quot;</span>);
                <span class="r730 r">temps</span>.<span class="i">Add</span>(<span class="r763 r">oldIsStopping</span>);
                <span class="r732 r">finallyBlockExprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">Assign</span>(
                        <span class="r763 r">oldIsStopping</span>,
                        <span class="i">Expression</span>.<span class="i">Call</span>(
                            <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#2c4e70a5a6e9c190" class="i field">ExceptionHandlingOps_SuspendStoppingPipeline</a>,
                            <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>)));
                <b>var</b> <span id="r764 rd" class="r764 r">nestedFinallyExprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
                <a href="#de2c28a71e25c894" class="i method">CompileStatementListWithTraps</a>(
                    <span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#56a1309fed36b070" class="i property">Finally</a>.<a href="ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>,
                    <span class="r729 r">tryStatementAst</span>.<a href="ast.cs.html#56a1309fed36b070" class="i property">Finally</a>.<a href="ast.cs.html#8a3ec42ea63c1318" class="i property">Traps</a>,
                    <span class="r764 r">nestedFinallyExprs</span>,
                    <span class="r730 r">temps</span>);
                <b>if</b> (<span class="r764 r">nestedFinallyExprs</span>.<span class="i">Count</span> == 0)
                {
                    <span class="r764 r">nestedFinallyExprs</span>.<span class="i">Add</span>(<a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>);
                }
 
                <span class="r732 r">finallyBlockExprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Block</span>(
                    <span class="i">Expression</span>.<span class="i">TryFinally</span>(
                        <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r764 r">nestedFinallyExprs</span>),
                        <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#6f9bb282c8acbb19" class="i field">ExceptionHandlingOps_RestoreStoppingPipeline</a>, <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>, <span class="r763 r">oldIsStopping</span>))));
            }
 
            <span class="c">// Our result must have void type, so make sure it does.</span>
            <b>if</b> (<span class="r731 r">tryBlockExprs</span>[<span class="r731 r">tryBlockExprs</span>.<span class="i">Count</span> - 1].<span class="i">Type</span> != <b>typeof</b>(<b>void</b>))
            {
                <span class="r731 r">tryBlockExprs</span>.<span class="i">Add</span>(<a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>);
            }
 
            <b>if</b> (<span class="r735 r">catches</span>.<span class="i">Count</span> &gt; 0)
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(
                    <span class="r730 r">temps</span>.<span class="i">ToArray</span>(),
                    <span class="i">Expression</span>.<span class="i">TryCatchFinally</span>(
                        <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r731 r">tryBlockExprs</span>),
                        <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r732 r">finallyBlockExprs</span>),
                        <span class="r735 r">catches</span>.<span class="i">ToArray</span>()));
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(
                <span class="r730 r">temps</span>.<span class="i">ToArray</span>(),
                <span class="i">Expression</span>.<span class="i">TryFinally</span>(
                    <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r731 r">tryBlockExprs</span>),
                    <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r732 r">finallyBlockExprs</span>)));
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="bb09ddb3f9315792" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">GenerateBreakOrContinue</a>(
            <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r765 rd" class="r765 r">ast</span>,
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r766 rd" class="r766 r">label</span>,
            <span class="i">Func</span>&lt;<a href="#e1dd4df3a5568da8" class="t t">LoopGotoTargets</a>, <span class="i">LabelTarget</span>&gt; <span id="r767 rd" class="r767 r">fieldSelector</span>,
            <span class="i">Func</span>&lt;<span class="i">LabelTarget</span>, <span class="i">Expression</span>&gt; <span id="r768 rd" class="r768 r">exprGenerator</span>,
            <span class="i">ConstructorInfo</span> <span id="r769 rd" class="r769 r">nonLocalExceptionCtor</span>)
        {
            <span class="i">LabelTarget</span> <span id="r770 rd" class="r770 r">labelTarget</span> = <b>null</b>;
            <span class="i">Expression</span> <span id="r771 rd" class="r771 r">labelExpr</span> = <b>null</b>;
            <b>if</b> (<span class="r766 r">label</span> != <b>null</b>)
            {
                <span class="r771 r">labelExpr</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r766 r">label</span>);
                <b>if</b> (<a href="#4b32d559427de642" class="i field">_loopTargets</a>.<span class="i">Count</span> &gt; 0)
                {
                    <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r772 rd" class="r772 r">labelStrAst</span> = <span class="r766 r">label</span> <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                    <b>if</b> (<span class="r772 r">labelStrAst</span> != <b>null</b>)
                    {
                        <span class="r770 r">labelTarget</span> = (<b>from</b> <span class="i">t</span> <b>in</b> <a href="#4b32d559427de642" class="i field">_loopTargets</a>
                                       <b>where</b> <span class="i">t</span>.<span class="i">Label</span>.<span class="i">Equals</span>(<span class="r772 r">labelStrAst</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>)
                                       <b>select</b> <span class="r767 r">fieldSelector</span>(<span class="i">t</span>)).<span class="i">LastOrDefault</span>();
                    }
                }
            }
            <b>else</b> <b>if</b> (<a href="#4b32d559427de642" class="i field">_loopTargets</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r770 r">labelTarget</span> = <span class="r767 r">fieldSelector</span>(<a href="#4b32d559427de642" class="i field">_loopTargets</a>[<a href="#4b32d559427de642" class="i field">_loopTargets</a>.<span class="i">Count</span> - 1]);
            }
 
            <span class="i">Expression</span> <span id="r773 rd" class="r773 r">result</span>;
            <b>if</b> (<span class="r770 r">labelTarget</span> != <b>null</b>)
            {
                <span class="r773 r">result</span> = <span class="r768 r">exprGenerator</span>(<span class="r770 r">labelTarget</span>);
            }
            <b>else</b>
            {
                <span class="r771 r">labelExpr</span> ??= <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#fc034c3ee2a5ee52" class="i field">ConstEmptyString</a>;
                <span class="r773 r">result</span> = <span class="i">Expression</span>.<span class="i">Throw</span>(<span class="i">Expression</span>.<span class="i">New</span>(<span class="r769 r">nonLocalExceptionCtor</span>, <span class="r771 r">labelExpr</span>.<span class="i">Convert</span>(<b>typeof</b>(<b>string</b>))));
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r765 r">ast</span>), <span class="r773 r">result</span>);
        }
 
        <b>public object</b> <a id="7f240847c01abf75" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitBreakStatement</a>(<a href="ast.cs.html#410610c8cad1e99b" class="t t">BreakStatementAst</a> <span id="r774 rd" class="r774 r">breakStatementAst</span>)
        {
            <b>return</b> <span class="i">GenerateBreakOrContinue</span>(
                <span class="r774 r">breakStatementAst</span>,
                <span class="r774 r">breakStatementAst</span>.<a href="ast.cs.html#d09d51ee2cd8ffec" class="i property">Label</a>,
                <span id="r775 rd" class="r775 r">lgt</span> =&gt; <span class="r775 r">lgt</span>.<span class="i">BreakLabel</span>,
                <span class="i">Expression</span>.<span class="i">Break</span>,
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#cb435ee088efa4b0" class="i field">BreakException_ctor</a>);
        }
 
        <b>public object</b> <a id="77fd5fa021bd25ac" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitContinueStatement</a>(<a href="ast.cs.html#f8a733d027117fbc" class="t t">ContinueStatementAst</a> <span id="r776 rd" class="r776 r">continueStatementAst</span>)
        {
            <b>return</b> <span class="i">GenerateBreakOrContinue</span>(
                <span class="r776 r">continueStatementAst</span>,
                <span class="r776 r">continueStatementAst</span>.<a href="ast.cs.html#2085acb39f31fba8" class="i property">Label</a>,
                <span id="r777 rd" class="r777 r">lgt</span> =&gt; <span class="r777 r">lgt</span>.<span class="i">ContinueLabel</span>,
                <span class="i">Expression</span>.<span class="i">Continue</span>,
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#121e16a97b675aa5" class="i field">ContinueException_ctor</a>);
        }
 
        <b>public object</b> <a id="c371be4ef82c9325" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitReturnStatement</a>(<a href="ast.cs.html#ba60713bd71ce457" class="t t">ReturnStatementAst</a> <span id="r778 rd" class="r778 r">returnStatementAst</span>)
        {
            <span class="c">// If we&#39;re returning from a trap, we must raise an exception because the trap is a distinct method, but we want</span>
            <span class="c">// to return from the function containing the trap, not just the trap itself.</span>
            <span class="i">Expression</span> <span id="r779 rd" class="r779 r">returnExpr</span>;
            <b>if</b> (<a href="#3647e83d7c60a8f3" class="i field">_compilingTrap</a>)
            {
                <span class="r779 r">returnExpr</span> = <span class="i">Expression</span>.<span class="i">Throw</span>(<span class="i">Expression</span>.<span class="i">New</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#0cdfa3fd4b12ba2d" class="i field">ReturnException_ctor</a>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#84591f5e881dc39e" class="i field">AutomationNullConstant</a>));
            }
            <b>else</b>
            {
                <span class="r779 r">returnExpr</span> = <span class="i">Expression</span>.<span class="i">Return</span>(<a href="#6f06eb7483b8e7f7" class="i field">_returnTarget</a>,
                                               <a href="#6f06eb7483b8e7f7" class="i field">_returnTarget</a>.<span class="i">Type</span> == <b>typeof</b>(<b>object</b>)
                                                   ? <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#84591f5e881dc39e" class="i field">AutomationNullConstant</a>
                                                   : <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>);
            }
 
            <b>if</b> (<span class="r778 r">returnStatementAst</span>.<a href="ast.cs.html#5b77ce523f7a0a91" class="i property">Pipeline</a> != <b>null</b>)
            {
                <a href="ast.cs.html#86812479028959b8" class="k">var</a> <span id="r780 rd" class="r780 r">pipe</span> = <span class="r778 r">returnStatementAst</span>.<a href="ast.cs.html#5b77ce523f7a0a91" class="i property">Pipeline</a>;
                <a href="ast.cs.html#da5f345864f42e06" class="k">var</a> <span id="r781 rd" class="r781 r">assignmentStatementAst</span> = <span class="r780 r">pipe</span> <b>as</b> <a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a>;
 
                <span class="i">Expression</span> <span id="r782 rd" class="r782 r">returnValue</span>;
                <b>if</b> (<a href="#e116f57a129b16bc" class="i property">CompilingMemberFunction</a>)
                {
                    <span class="c">// We used a null pipe for the function body, but for the return statement,</span>
                    <span class="c">// we need to write to the pipe passed to our dynamic method so InvokeAsMemberFunction</span>
                    <span class="c">// can get the return value to return it.</span>
                    <span class="r782 r">returnValue</span> = <a href="#fed19bee56918521" class="i method">CaptureStatementResults</a>(<span class="r778 r">returnStatementAst</span>.<a href="ast.cs.html#5b77ce523f7a0a91" class="i property">Pipeline</a>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>);
                    <b>if</b> (<a href="#0956e73d835184c4" class="i property">MemberFunctionReturnType</a> != <b>typeof</b>(<b>void</b>))
                    {
                        <span class="c">// Write directly to the pipe - don&#39;t use the dynamic site (CallAddPipe) as that could enumerate.</span>
                        <span class="r782 r">returnValue</span> = <span class="i">Expression</span>.<span class="i">Call</span>(
                            <a href="#f0e2b48eb0cbdbad" class="i field">s_returnPipe</a>,
                            <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#ef3aead21a321eba" class="i field">Pipe_Add</a>,
                            <span class="r782 r">returnValue</span>.<a href="#623da12beb9db704" class="i method">Convert</a>(<a href="#0956e73d835184c4" class="i property">MemberFunctionReturnType</a>).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)));
                    }
 
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r778 r">returnStatementAst</span>.<a href="ast.cs.html#5b77ce523f7a0a91" class="i property">Pipeline</a>),
                                            <span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>, <a href="#f0e2b48eb0cbdbad" class="i field">s_returnPipe</a>),
                                            <span class="r782 r">returnValue</span>,
                                            <span class="r779 r">returnExpr</span>);
                }
 
                <span class="r782 r">returnValue</span> = <span class="r781 r">assignmentStatementAst</span> != <b>null</b>
                    ? <a href="#fd7d0a43cbb942fa" class="i method">CallAddPipe</a>(<a href="#e8ec24b53e7f9f8d" class="i method">CompileAssignment</a>(<span class="r781 r">assignmentStatementAst</span>), <a href="#ad66a442944d59df" class="i field">s_getCurrentPipe</a>)
                    : <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r780 r">pipe</span>);
 
                <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r782 r">returnValue</span>, <span class="r779 r">returnExpr</span>);
            }
 
            <b>return</b> <span class="r779 r">returnExpr</span>;
        }
 
        <b>public object</b> <a id="d68b7858c73c5a99" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitExitStatement</a>(<a href="ast.cs.html#c410ad4dd51f9687" class="t t">ExitStatementAst</a> <span id="r783 rd" class="r783 r">exitStatementAst</span>)
        {
            <span class="c">// We should not preserve the partial output if exception is thrown when evaluating exitStmt.pipeline.</span>
            <span class="i">Expression</span> <span id="r784 rd" class="r784 r">exitCode</span> = <span class="r783 r">exitStatementAst</span>.<a href="ast.cs.html#5677dd38c48037f7" class="i property">Pipeline</a> != <b>null</b>
                                      ? <a href="#fed19bee56918521" class="i method">CaptureStatementResults</a>(<span class="r783 r">exitStatementAst</span>.<a href="ast.cs.html#5677dd38c48037f7" class="i property">Pipeline</a>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>)
                                      : <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(0);
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(
                <a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r783 r">exitStatementAst</span>),
                <span class="i">Expression</span>.<span class="i">Throw</span>(<span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#3b25cdcf1be28152" class="i field">PipelineOps_GetExitException</a>,
                                                 <span class="r784 r">exitCode</span>.<span class="i">Convert</span>(<b>typeof</b>(<b>object</b>))),
                                 <b>typeof</b>(<b>void</b>)));
        }
 
        <b>public object</b> <a id="14407c33b081f382" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitThrowStatement</a>(<a href="ast.cs.html#07e9c4f5bce4153b" class="t t">ThrowStatementAst</a> <span id="r785 rd" class="r785 r">throwStatementAst</span>)
        {
            <span class="c">// We should not preserve the partial output if exception is thrown when evaluating throwStmt.pipeline.</span>
            <span class="i">Expression</span> <span id="r786 rd" class="r786 r">throwExpr</span> = <span class="r785 r">throwStatementAst</span>.<a href="ast.cs.html#a1d97c46b4459087" class="i property">IsRethrow</a>
                                       ? <a href="#a6b2b6aa258ffb38" class="i field">s_currentExceptionBeingHandled</a>
                                       : (<span class="r785 r">throwStatementAst</span>.<a href="ast.cs.html#4e6ffefc40942042" class="i property">Pipeline</a> == <b>null</b>)
                                             ? <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>
                                             : <a href="#fed19bee56918521" class="i method">CaptureStatementResults</a>(<span class="r785 r">throwStatementAst</span>.<a href="ast.cs.html#4e6ffefc40942042" class="i property">Pipeline</a>,
                                                                       <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>);
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(
                <a href="#1dacc885a3fff678" class="i method">UpdatePosition</a>(<span class="r785 r">throwStatementAst</span>),
                <span class="i">Expression</span>.<span class="i">Throw</span>(<span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#042b22aba6483b3c" class="i field">ExceptionHandlingOps_ConvertToException</a>,
                                                 <span class="r786 r">throwExpr</span>.<span class="i">Convert</span>(<b>typeof</b>(<b>object</b>)),
                                                 <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r785 r">throwStatementAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>),
                                                 <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r785 r">throwStatementAst</span>.<a href="ast.cs.html#a1d97c46b4459087" class="i property">IsRethrow</a>))));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Statements
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Expressions
 
        <b>public</b> <span class="i">Expression</span> <a id="1e8074d900e80a31" href="../../R/1e8074d900e80a31.html" target="n" data-glyph="72,1" class="i method">GenerateCallContains</a>(<span class="i">Expression</span> <span id="r787 rd" class="r787 r">lhs</span>, <span class="i">Expression</span> <span id="r788 rd" class="r788 r">rhs</span>, <b>bool</b> <span id="r789 rd" class="r789 r">ignoreCase</span>)
        {
            <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#d135b695626d342e" class="i field">ParserOps_ContainsOperatorCompiled</a>,
                <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <span class="i">IEnumerator</span>&gt;&gt;.<span class="i">Create</span>(<a href="../runtime/Binding/Binders.cs.html#e3fd1907f899e2b7" class="t t">PSEnumerableBinder</a>.<a href="../runtime/Binding/Binders.cs.html#5b720d77314adf15" class="i method">Get</a>())),
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="i">CallSite</span>&lt;<span class="i">Func</span>&lt;<span class="i">CallSite</span>, <b>object</b>, <b>object</b>, <b>object</b>&gt;&gt;.<span class="i">Create</span>(
                    <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">Equal</span>, <span class="r789 r">ignoreCase</span>, <span class="i">scalarCompare</span>: <b>true</b>))),
                <span class="r787 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                <span class="r788 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)));
        }
 
        <b>public object</b> <a id="6550dbf5e509d72c" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitTernaryExpression</a>(<a href="ast.cs.html#75320d2e9ca587ab" class="t t">TernaryExpressionAst</a> <span id="r790 rd" class="r790 r">ternaryExpressionAst</span>)
        {
            <b>var</b> <span id="r791 rd" class="r791 r">expr</span> = <span class="i">Expression</span>.<span class="i">Condition</span>(
                <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r790 r">ternaryExpressionAst</span>.<a href="ast.cs.html#8fe864cc3d568de7" class="i property">Condition</a>).<span class="i">Convert</span>(<b>typeof</b>(<b>bool</b>)),
                <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r790 r">ternaryExpressionAst</span>.<a href="ast.cs.html#c679b2d23aba3af3" class="i property">IfTrue</a>).<span class="i">Convert</span>(<b>typeof</b>(<b>object</b>)),
                <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r790 r">ternaryExpressionAst</span>.<a href="ast.cs.html#6aa8ec2dcb9934c3" class="i property">IfFalse</a>).<span class="i">Convert</span>(<b>typeof</b>(<b>object</b>)));
 
            <b>return</b> <span class="r791 r">expr</span>;
        }
 
        <b>public object</b> <a id="e36f9c4f6799eb0e" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitBinaryExpression</a>(<a href="ast.cs.html#f3e3848ef2eae593" class="t t">BinaryExpressionAst</a> <span id="r792 rd" class="r792 r">binaryExpressionAst</span>)
        {
            <b>object</b> <span id="r793 rd" class="r793 r">constantValue</span>;
            <b>if</b> (!<a href="#afdf1b538daea434" class="i property">CompilingConstantExpression</a> &amp;&amp; <a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<a href="ConstantValues.cs.html#594e7e13f898b0a1" class="i method">IsConstant</a>(<span class="r792 r">binaryExpressionAst</span>, <b>out</b> <span class="r793 r">constantValue</span>))
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r793 r">constantValue</span>);
            }
 
            <span class="i">DynamicMetaObjectBinder</span> <span id="r794 rd" class="r794 r">binder</span>;
            <b>var</b> <span id="r795 rd" class="r795 r">lhs</span> = <a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#e19b481693ff50d7" class="i property">Left</a>);
            <b>var</b> <span id="r796 rd" class="r796 r">rhs</span> = <a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#c43edc792b1ee433" class="i property">Right</a>);
 
            <b>switch</b> (<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a>)
            {
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#14e331a4180e8cfa" class="i field">And</a>:
                    <b>return</b> <span class="i">Expression</span>.<span class="i">AndAlso</span>(<span class="r795 r">lhs</span>.<span class="i">Convert</span>(<b>typeof</b>(<b>bool</b>)), <span class="r796 r">rhs</span>.<span class="i">Convert</span>(<b>typeof</b>(<b>bool</b>)));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#eacefffd17e34bf2" class="i field">Or</a>:
                    <b>return</b> <span class="i">Expression</span>.<span class="i">OrElse</span>(<span class="r795 r">lhs</span>.<span class="i">Convert</span>(<b>typeof</b>(<b>bool</b>)), <span class="r796 r">rhs</span>.<span class="i">Convert</span>(<b>typeof</b>(<b>bool</b>)));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7e2491f4694546b3" class="i field">Is</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6499a0b891625abc" class="i field">IsNot</a>:
                    <b>if</b> (<span class="r796 r">rhs</span> <b>is</b> <span class="i">ConstantExpression</span> &amp;&amp; <span class="r796 r">rhs</span>.<span class="i">Type</span> == <b>typeof</b>(<span class="i">Type</span>))
                    {
                        <b>var</b> <span id="r797 rd" class="r797 r">isType</span> = (<span class="i">Type</span>)((<span class="i">ConstantExpression</span>)<span class="r796 r">rhs</span>).<span class="i">Value</span>;
                        <b>if</b> (<span class="r797 r">isType</span> != <b>typeof</b>(<a href="../MshObject.cs.html#4a84ee8edc4d53a0" class="t t">PSCustomObject</a>) &amp;&amp; <span class="r797 r">isType</span> != <b>typeof</b>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a>))
                        {
                            <span class="r795 r">lhs</span> = <span class="r795 r">lhs</span>.<span class="i">Type</span>.<span class="i">IsValueType</span> ? <span class="r795 r">lhs</span> : <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#95ba8d8e80c2ae2b" class="i field">PSObject_Base</a>, <span class="r795 r">lhs</span>);
                            <b>if</b> (<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7e2491f4694546b3" class="i field">Is</a>)
                            {
                                <b>return</b> <span class="i">Expression</span>.<span class="i">TypeIs</span>(<span class="r795 r">lhs</span>, <span class="r797 r">isType</span>);
                            }
 
                            <b>return</b> <span class="i">Expression</span>.<span class="i">Not</span>(<span class="i">Expression</span>.<span class="i">TypeIs</span>(<span class="r795 r">lhs</span>, <span class="r797 r">isType</span>));
                        }
                    }
 
                    <span class="i">Expression</span> <span id="r798 rd" class="r798 r">result</span> = <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#4b2eee90ef5a2176" class="i field">TypeOps_IsInstance</a>, <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)), <span class="r796 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)));
                    <b>if</b> (<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6499a0b891625abc" class="i field">IsNot</a>)
                    {
                        <span class="r798 r">result</span> = <span class="i">Expression</span>.<span class="i">Not</span>(<span class="r798 r">result</span>);
                    }
 
                    <b>return</b> <span class="r798 r">result</span>;
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#2296173a31893567" class="i field">As</a>:
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#a7bab9666f5275cb" class="i field">TypeOps_AsOperator</a>, <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)), <span class="r796 r">rhs</span>.<span class="i">Convert</span>(<b>typeof</b>(<span class="i">Type</span>)));
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7e27eae9f0abe570" class="i field">DotDot</a>:
                    <span class="c">// We could generate faster code using Expression.Dynamic with a binder.</span>
                    <span class="c">// Currently, type checks are done in ParserOps.RangeOperator at runtime every time</span>
                    <span class="c">// a range operator is used. By replacing with Expression.Dynamic and a binder, the</span>
                    <span class="c">// type check is done only once when you repeatedly execute the same line in script.</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#d5b5c96c3c0eb753" class="i field">ParserOps_RangeOperator</a>, <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)), <span class="r796 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)));
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#79806bba953290ee" class="i field">Multiply</a>:
                    <b>if</b> (<span class="r795 r">lhs</span>.<span class="i">Type</span> == <b>typeof</b>(<b>double</b>) &amp;&amp; <span class="r796 r">rhs</span>.<span class="i">Type</span> == <b>typeof</b>(<b>double</b>))
                    {
                        <b>return</b> <span class="i">Expression</span>.<span class="i">Multiply</span>(<span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                    }
 
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">Multiply</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3173796303cdf797" class="i field">Divide</a>:
                    <b>if</b> (<span class="r795 r">lhs</span>.<span class="i">Type</span> == <b>typeof</b>(<b>double</b>) &amp;&amp; <span class="r796 r">rhs</span>.<span class="i">Type</span> == <b>typeof</b>(<b>double</b>))
                    {
                        <b>return</b> <span class="i">Expression</span>.<span class="i">Divide</span>(<span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                    }
 
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">Divide</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b338c928ef07e8ea" class="i field">Rem</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">Modulo</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#28a6ab38fe6894ea" class="i field">Plus</a>:
                    <b>if</b> (<span class="r795 r">lhs</span>.<span class="i">Type</span> == <b>typeof</b>(<b>double</b>) &amp;&amp; <span class="r796 r">rhs</span>.<span class="i">Type</span> == <b>typeof</b>(<b>double</b>))
                    {
                        <b>return</b> <span class="i">Expression</span>.<span class="i">Add</span>(<span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                    }
 
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">Add</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#069476ae2e7b4442" class="i field">Minus</a>:
                    <b>if</b> (<span class="r795 r">lhs</span>.<span class="i">Type</span> == <b>typeof</b>(<b>double</b>) &amp;&amp; <span class="r796 r">rhs</span>.<span class="i">Type</span> == <b>typeof</b>(<b>double</b>))
                    {
                        <b>return</b> <span class="i">Expression</span>.<span class="i">Subtract</span>(<span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                    }
 
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">Subtract</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5d102cfc5c0d27e8" class="i field">Format</a>:
                    <b>if</b> (<span class="r795 r">lhs</span>.<span class="i">Type</span> != <b>typeof</b>(<b>string</b>))
                    {
                        <span class="r795 r">lhs</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#db2e7c67b332caf6" class="t t">PSToStringBinder</a>.<a href="../runtime/Binding/Binders.cs.html#7a771c568a738822" class="i method">Get</a>(), <b>typeof</b>(<b>string</b>), <span class="r795 r">lhs</span>, <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>);
                    }
 
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#5af60761a513c293" class="i field">StringOps_FormatOperator</a>, <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e2a921da8dc5458e" class="i field">Xor</a>:
                    <b>return</b> <span class="i">Expression</span>.<span class="i">NotEqual</span>(<span class="r795 r">lhs</span>.<span class="i">Convert</span>(<b>typeof</b>(<b>bool</b>)), <span class="r796 r">rhs</span>.<span class="i">Convert</span>(<b>typeof</b>(<b>bool</b>)));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#683bd53c88e0d334" class="i field">Shl</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">LeftShift</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b807b1f385cda6bc" class="i field">Shr</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">RightShift</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#742ab03d28efc2a6" class="i field">Band</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">And</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9bd33d529c1d4993" class="i field">Bor</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">Or</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c6229e7399dcf894" class="i field">Bxor</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">ExclusiveOr</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#0fae0b73746901d5" class="i field">Join</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#936c144c5fe90238" class="i field">ParserOps_JoinOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r796 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#654217947abd11a4" class="i field">Ieq</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">Equal</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#82b3fc4a021370b1" class="i field">Ine</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">NotEqual</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6fefd865f09cf1a8" class="i field">Ige</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">GreaterThanOrEqual</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6c26f085506e329b" class="i field">Igt</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">GreaterThan</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#371ecc3ecbaec392" class="i field">Ilt</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">LessThan</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#796d7079962597d7" class="i field">Ile</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">LessThanOrEqual</span>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c54e36505d9969ea" class="i field">Ilike</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#1ab64edf541e0804" class="i field">ParserOps_LikeOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#27a2d623dbd430be" class="i method">GetLikeRHSOperand</a>(<a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>, <span class="r796 r">rhs</span>).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#0b21ff7aee97bf81" class="i field">Inotlike</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#1ab64edf541e0804" class="i field">ParserOps_LikeOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#27a2d623dbd430be" class="i method">GetLikeRHSOperand</a>(<a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#2d0521a6986208d3" class="i field">IgnoreCase</a>, <span class="r796 r">rhs</span>).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#34df816720a975fd" class="i field">Imatch</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#51d77b7cc5ad3cfc" class="i field">ParserOps_MatchOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r796 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>false</b>),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ef6e9e5606d594d5" class="i field">Inotmatch</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#51d77b7cc5ad3cfc" class="i field">ParserOps_MatchOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r796 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9d54d579ae38f45e" class="i field">Ireplace</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#36d014a8fc8820f4" class="i field">ParserOps_ReplaceOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r796 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#530d7c9f9fd7e08c" class="i field">Icontains</a>:
                    <b>return</b> <a href="#1e8074d900e80a31" class="i method">GenerateCallContains</a>(<span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>, <b>true</b>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1166b872b2bf0813" class="i field">Inotcontains</a>:
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Not</span>(<a href="#1e8074d900e80a31" class="i method">GenerateCallContains</a>(<span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>, <b>true</b>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f646c012e5d57683" class="i field">Iin</a>:
                    <b>return</b> <a href="#1e8074d900e80a31" class="i method">GenerateCallContains</a>(<span class="r796 r">rhs</span>, <span class="r795 r">lhs</span>, <b>true</b>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ac47c0af7f6a5134" class="i field">Inotin</a>:
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Not</span>(<a href="#1e8074d900e80a31" class="i method">GenerateCallContains</a>(<span class="r796 r">rhs</span>, <span class="r795 r">lhs</span>, <b>true</b>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#512ad4ecc7f9168c" class="i field">Isplit</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#5c42deff2cb6fe8c" class="i field">ParserOps_SplitOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r796 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e5bb5a7a24d93ebc" class="i field">Ceq</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">Equal</span>, <b>false</b>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#04b70e3eaa61d27e" class="i field">Cne</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">NotEqual</span>, <b>false</b>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#bc8ca8ef43bf7b4f" class="i field">Cge</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">GreaterThanOrEqual</span>, <b>false</b>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a58601fe1f113b12" class="i field">Cgt</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">GreaterThan</span>, <b>false</b>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#47f2fc75e6daef97" class="i field">Clt</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">LessThan</span>, <b>false</b>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8740d4da8d485dad" class="i field">Cle</a>:
                    <span class="r794 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">LessThanOrEqual</span>, <b>false</b>);
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r794 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#763ad9f2f8eb2f5d" class="i field">Clike</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#1ab64edf541e0804" class="i field">ParserOps_LikeOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#27a2d623dbd430be" class="i method">GetLikeRHSOperand</a>(<a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#b202e40981b139f5" class="i field">None</a>, <span class="r796 r">rhs</span>).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#440a0e98089143a6" class="i field">Cnotlike</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#1ab64edf541e0804" class="i field">ParserOps_LikeOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#27a2d623dbd430be" class="i method">GetLikeRHSOperand</a>(<a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a>.<a href="../regex.cs.html#b202e40981b139f5" class="i field">None</a>, <span class="r796 r">rhs</span>).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#d9e9940dedef2ba7" class="i property">Operator</a>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa6622aef3429cc2" class="i field">Cmatch</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#51d77b7cc5ad3cfc" class="i field">ParserOps_MatchOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r796 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>false</b>),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>false</b>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ee8fcf3f41c67c3f" class="i field">Cnotmatch</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#51d77b7cc5ad3cfc" class="i field">ParserOps_MatchOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r796 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>false</b>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c37a1de4056ff472" class="i field">Creplace</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#36d014a8fc8820f4" class="i field">ParserOps_ReplaceOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r796 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>false</b>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fb21c1fe57891ef6" class="i field">Ccontains</a>:
                    <b>return</b> <a href="#1e8074d900e80a31" class="i method">GenerateCallContains</a>(<span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>, <b>false</b>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a99c9e9309b56718" class="i field">Cnotcontains</a>:
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Not</span>(<a href="#1e8074d900e80a31" class="i method">GenerateCallContains</a>(<span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>, <b>false</b>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#28b871ac294883c0" class="i field">Cin</a>:
                    <b>return</b> <a href="#1e8074d900e80a31" class="i method">GenerateCallContains</a>(<span class="r796 r">rhs</span>, <span class="r795 r">lhs</span>, <b>false</b>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#51a3343dfd4aa02d" class="i field">Cnotin</a>:
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Not</span>(<a href="#1e8074d900e80a31" class="i method">GenerateCallContains</a>(<span class="r796 r">rhs</span>, <span class="r795 r">lhs</span>, <b>false</b>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3f80cdd8640b6048" class="i field">Csplit</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#5c42deff2cb6fe8c" class="i field">ParserOps_SplitOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r792 r">binaryExpressionAst</span>.<a href="ast.cs.html#df8f322e70353a62" class="i property">ErrorPosition</a>),
                        <span class="r795 r">lhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r796 r">rhs</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>false</b>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c1e8f77a51d492eb" class="i field">QuestionQuestion</a>:
                    <b>return</b> <a href="#400fe7a726896ae7" class="i method">Coalesce</a>(<span class="r795 r">lhs</span>, <span class="r796 r">rhs</span>);
            }
 
            <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="s">&quot;Unknown token in binary operator.&quot;</span>);
        }
 
        <b>private static</b> <span class="i">Expression</span> <a id="27a2d623dbd430be" href="../../R/27a2d623dbd430be.html" target="n" data-glyph="76,1" class="i method">GetLikeRHSOperand</a>(<a href="../regex.cs.html#4e788ab2470b3632" class="t t">WildcardOptions</a> <span id="r799 rd" class="r799 r">options</span>, <span class="i">Expression</span> <span id="r800 rd" class="r800 r">expr</span>)
        {
            <b>if</b> (!(<span class="r800 r">expr</span> <b>is</b> <span class="i">ConstantExpression</span> <span id="r801 rd" class="r801 r">constExpr</span>))
            {
                <b>return</b> <span class="r800 r">expr</span>;
            }
 
            <b>if</b> (!(<span class="r801 r">constExpr</span>.<span class="i">Value</span> <b>is string</b> <span id="r802 rd" class="r802 r">val</span>))
            {
                <b>return</b> <span class="r800 r">expr</span>;
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Constant</span>(<a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#03cc3ceece086129" class="i method">Get</a>(<span class="r802 r">val</span>, <span class="r799 r">options</span>));
        }
 
        <b>public object</b> <a id="6faaba18ae8e8271" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitUnaryExpression</a>(<a href="ast.cs.html#ee62c8a99269d267" class="t t">UnaryExpressionAst</a> <span id="r803 rd" class="r803 r">unaryExpressionAst</span>)
        {
            <b>object</b> <span id="r804 rd" class="r804 r">constantValue</span>;
            <b>if</b> (!<a href="#afdf1b538daea434" class="i property">CompilingConstantExpression</a> &amp;&amp; <a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<a href="ConstantValues.cs.html#594e7e13f898b0a1" class="i method">IsConstant</a>(<span class="r803 r">unaryExpressionAst</span>, <b>out</b> <span class="r804 r">constantValue</span>))
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r804 r">constantValue</span>);
            }
 
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r805 rd" class="r805 r">child</span> = <span class="r803 r">unaryExpressionAst</span>.<a href="ast.cs.html#ca72754d5d4d5410" class="i property">Child</a>;
            <b>switch</b> (<span class="r803 r">unaryExpressionAst</span>.<a href="ast.cs.html#1ce84eccd8a75fa0" class="i property">TokenKind</a>)
            {
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6190040d2f0e7bc3" class="i field">Exclaim</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#95193423aec1ddd7" class="i field">Not</a>:
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#ee39afdcd24db6ca" class="t t">PSUnaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">Not</span>), <b>typeof</b>(<b>object</b>), <a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r805 r">child</span>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#069476ae2e7b4442" class="i field">Minus</a>:
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                        <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">Subtract</span>),
                        <b>typeof</b>(<b>object</b>),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(0),
                        <a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r805 r">child</span>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#28a6ab38fe6894ea" class="i field">Plus</a>:
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                        <a href="../runtime/Binding/Binders.cs.html#7b0e984617ab5e15" class="t t">PSBinaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">Add</span>),
                        <b>typeof</b>(<b>object</b>),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(0),
                        <a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r805 r">child</span>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#da0aaa4e75a66f2a" class="i field">Bnot</a>:
                    <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                        <a href="../runtime/Binding/Binders.cs.html#ee39afdcd24db6ca" class="t t">PSUnaryOperationBinder</a>.<span class="i">Get</span>(<span class="i">ExpressionType</span>.<span class="i">OnesComplement</span>),
                        <b>typeof</b>(<b>object</b>),
                        <a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r805 r">child</span>));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#93a18b78948c1c09" class="i field">PlusPlus</a>:
                    <b>return</b> <a href="#c196f25198a6e1d0" class="i method">CompileIncrementOrDecrement</a>(<span class="r805 r">child</span>, 1, <b>true</b>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3d9a9ff2e958417f" class="i field">MinusMinus</a>:
                    <b>return</b> <span class="i">CompileIncrementOrDecrement</span>(<span class="r805 r">child</span>, -1, <b>true</b>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a49966ed41b2bd06" class="i field">PostfixPlusPlus</a>:
                    <b>return</b> <a href="#c196f25198a6e1d0" class="i method">CompileIncrementOrDecrement</a>(<span class="r805 r">child</span>, 1, <b>false</b>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a3018df4a2c2998" class="i field">PostfixMinusMinus</a>:
                    <b>return</b> <span class="i">CompileIncrementOrDecrement</span>(<span class="r805 r">child</span>, -1, <b>false</b>);
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#0fae0b73746901d5" class="i field">Join</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#9513b6d04ccab760" class="i field">ParserOps_UnaryJoinOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r803 r">unaryExpressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>),
                        (<a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r805 r">child</span>)).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)));
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#512ad4ecc7f9168c" class="i field">Isplit</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3f80cdd8640b6048" class="i field">Csplit</a>:
                    <span class="c">// TODO: replace this with faster code</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#af7719e76cf6730c" class="i field">ParserOps_UnarySplitOperator</a>,
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r803 r">unaryExpressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>),
                        (<a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r805 r">child</span>)).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)));
            }
 
            <b>throw</b> <b>new</b> <span class="i">InvalidOperationException</span>(<span class="s">&quot;Unknown token in unary operator.&quot;</span>);
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="c196f25198a6e1d0" href="../../R/c196f25198a6e1d0.html" target="n" data-glyph="76,1" class="i method">CompileIncrementOrDecrement</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r806 rd" class="r806 r">exprAst</span>, <b>int</b> <span id="r807 rd" class="r807 r">valueToAdd</span>, <b>bool</b> <span id="r808 rd" class="r808 r">prefix</span>)
        {
            <a href="ast.cs.html#41e026a3563ae47a" class="k">var</a> <span id="r809 rd" class="r809 r">av</span> = ((<a href="ast.cs.html#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>)<span class="r806 r">exprAst</span>).<a href="ast.cs.html#2a53987d0bdfbaff" class="i method">GetAssignableValue</a>();
            <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt; <span id="r810 rd" class="r810 r">temps</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt;();
            <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r811 rd" class="r811 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <span class="i">ParameterExpression</span> <span id="r812 rd" class="r812 r">tmp</span>;
            <span class="i">Expression</span> <span id="r813 rd" class="r813 r">beforeVal</span> = <span class="r809 r">av</span>.<a href="ast.cs.html#68362cbeefdedafa" class="i method">GetValue</a>(<a href="#8bdfc042f41c96c5" class="k">this</a>, <span class="r811 r">exprs</span>, <span class="r810 r">temps</span>);
            <b>if</b> (<span class="r808 r">prefix</span>)
            {
                <b>var</b> <span id="r814 rd" class="r814 r">newValue</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                    <a href="../runtime/Binding/Binders.cs.html#ee39afdcd24db6ca" class="t t">PSUnaryOperationBinder</a>.<span class="i">Get</span>(<span class="r807 r">valueToAdd</span> == 1 ? <span class="i">ExpressionType</span>.<span class="i">Increment</span> : <span class="i">ExpressionType</span>.<span class="i">Decrement</span>),
                    <b>typeof</b>(<b>object</b>),
                    <span class="r813 r">beforeVal</span>);
                <span class="r812 r">tmp</span> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<span class="r814 r">newValue</span>.<span class="i">Type</span>);
                <span class="r811 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r812 r">tmp</span>, <span class="r814 r">newValue</span>));
                <span class="r811 r">exprs</span>.<span class="i">Add</span>(<span class="r809 r">av</span>.<span class="i">SetValue</span>(<a href="#8bdfc042f41c96c5" class="k">this</a>, <span class="r812 r">tmp</span>));
                <span class="r811 r">exprs</span>.<span class="i">Add</span>(<span class="r812 r">tmp</span>);
            }
            <b>else</b>
            {
                <span class="r812 r">tmp</span> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<span class="r813 r">beforeVal</span>.<span class="i">Type</span>);
                <span class="r811 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r812 r">tmp</span>, <span class="r813 r">beforeVal</span>));
                <b>var</b> <span id="r815 rd" class="r815 r">newValue</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                    <a href="../runtime/Binding/Binders.cs.html#ee39afdcd24db6ca" class="t t">PSUnaryOperationBinder</a>.<span class="i">Get</span>(<span class="r807 r">valueToAdd</span> == 1 ? <span class="i">ExpressionType</span>.<span class="i">Increment</span> : <span class="i">ExpressionType</span>.<span class="i">Decrement</span>),
                    <b>typeof</b>(<b>object</b>),
                    <span class="r812 r">tmp</span>);
                <span class="r811 r">exprs</span>.<span class="i">Add</span>(<span class="r809 r">av</span>.<span class="i">SetValue</span>(<a href="#8bdfc042f41c96c5" class="k">this</a>, <span class="r815 r">newValue</span>));
                <b>if</b> (<span class="r812 r">tmp</span>.<span class="i">Type</span>.<span class="i">IsValueType</span>)
                {
                    <span class="c">// This is the result of the expression - it might be unused, but we don&#39;t bother knowing if it is used or not.</span>
                    <span class="r811 r">exprs</span>.<span class="i">Add</span>(<span class="r812 r">tmp</span>);
                }
                <b>else</b>
                {
                    <span class="c">// For backwards compatibility, return 0 when the pre-incremented value was null.  We do the check after</span>
                    <span class="c">// the increment because this value isn&#39;t always used, so it might be removed as dead code, and we can</span>
                    <span class="c">// thus avoid adding an extra if test in some common cases (e.g. a for loop frequently uses ++ as the iteration</span>
                    <span class="c">// expression.</span>
                    <span class="r811 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Condition</span>(
                        <span class="i">Expression</span>.<span class="i">Equal</span>(<span class="r812 r">tmp</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>),
                        <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(0).<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)),
                        <span class="r812 r">tmp</span>));
                }
            }
 
            <span class="r810 r">temps</span>.<span class="i">Add</span>(<span class="r812 r">tmp</span>);
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r810 r">temps</span>, <span class="r811 r">exprs</span>);
        }
 
        <b>public object</b> <a id="9864842311b75a94" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitConvertExpression</a>(<a href="ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a> <span id="r816 rd" class="r816 r">convertExpressionAst</span>)
        {
            <b>object</b> <span id="r817 rd" class="r817 r">constantValue</span>;
            <b>if</b> (!<a href="#afdf1b538daea434" class="i property">CompilingConstantExpression</a> &amp;&amp; <a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<a href="ConstantValues.cs.html#594e7e13f898b0a1" class="i method">IsConstant</a>(<span class="r816 r">convertExpressionAst</span>, <b>out</b> <span class="r817 r">constantValue</span>))
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r817 r">constantValue</span>);
            }
 
            <a href="ast.cs.html#a422e1772da6dbc8" class="k">var</a> <span id="r818 rd" class="r818 r">typeName</span> = <span class="r816 r">convertExpressionAst</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>;
            <a href="ast.cs.html#fd6e450f68cfd52b" class="k">var</a> <span id="r819 rd" class="r819 r">hashTableAst</span> = <span class="r816 r">convertExpressionAst</span>.<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a> <b>as</b> <a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a>;
            <span class="i">Expression</span> <span id="r820 rd" class="r820 r">childExpr</span> = <b>null</b>;
            <b>if</b> (<span class="r819 r">hashTableAst</span> != <b>null</b>)
            {
                <b>var</b> <span id="r821 rd" class="r821 r">temp</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<span class="i">OrderedDictionary</span>), <span class="s">&quot;orderedDictionary&quot;</span>);
                <b>if</b> (<span class="r818 r">typeName</span>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>.<span class="i">Equals</span>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#09ceaaf5116a37fd" class="i field">OrderedAttribute</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(
                        <b>typeof</b>(<span class="i">OrderedDictionary</span>),
                        <b>new</b>[] { <span class="r821 r">temp</span> },
                        <a href="#b66c73d015083718" class="i method">BuildHashtable</a>(<span class="r819 r">hashTableAst</span>.<a href="ast.cs.html#87313f35bc2b66d9" class="i property">KeyValuePairs</a>, <span class="r821 r">temp</span>, <span class="r822 r">ordered</span>: <b>true</b>));
                }
 
                <b>if</b> (<span class="r818 r">typeName</span>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>.<span class="i">Equals</span>(<span class="s">&quot;PSCustomObject&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <span class="c">// pure laziness here - we should construct the PSObject directly.  Instead, we&#39;re relying on the conversion</span>
                    <span class="c">// to create the PSObject from an OrderedDictionary.</span>
                    <span class="r820 r">childExpr</span> = <span class="i">Expression</span>.<span class="i">Block</span>(
                        <b>typeof</b>(<span class="i">OrderedDictionary</span>),
                        <b>new</b>[] { <span class="r821 r">temp</span> },
                        <a href="#b66c73d015083718" class="i method">BuildHashtable</a>(<span class="r819 r">hashTableAst</span>.<a href="ast.cs.html#87313f35bc2b66d9" class="i property">KeyValuePairs</a>, <span class="r821 r">temp</span>, <span class="r822 r">ordered</span>: <b>true</b>));
                }
            }
 
            <b>if</b> (<span class="r816 r">convertExpressionAst</span>.<a href="ast.cs.html#74a22010f70cd6e1" class="i method">IsRef</a>())
            {
                <a href="ast.cs.html#248562b22b336dec" class="k">var</a> <span id="r823 rd" class="r823 r">varExpr</span> = <span class="r816 r">convertExpressionAst</span>.<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a> <b>as</b> <a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>;
                <b>if</b> (<span class="r823 r">varExpr</span> != <b>null</b> &amp;&amp; <span class="r823 r">varExpr</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#6af6d06d3e3c5d67" class="i property">IsVariable</a> &amp;&amp; !<span class="r823 r">varExpr</span>.<a href="ast.cs.html#1f31fa8ef6d4e586" class="i method">IsConstantVariable</a>())
                {
                    <span class="c">// We&#39;ll wrap the variable in a PSReference, but not the constant variables ($true, $false, $null) because those</span>
                    <span class="c">// can&#39;t be changed.</span>
                    <span class="i">IEnumerable</span>&lt;<span class="i">PropertyInfo</span>&gt; <span id="r824 rd" class="r824 r">unused1</span>;
                    <b>bool</b> <span id="r825 rd" class="r825 r">unused2</span>;
                    <b>var</b> <span id="r826 rd" class="r826 r">varType</span> = <span class="r823 r">varExpr</span>.<a href="ast.cs.html#66a67f0fdaef4b7f" class="i method">GetVariableType</a>(<a href="#8bdfc042f41c96c5" class="k">this</a>, <b>out</b> <span class="r824 r">unused1</span>, <b>out</b> <span class="r825 r">unused2</span>);
                    <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                        <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#ee5326e69fe6331a" class="i field">VariableOps_GetVariableAsRef</a>,
                        <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r823 r">varExpr</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>),
                        <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                        <span class="r826 r">varType</span> != <b>null</b> &amp;&amp; <span class="r826 r">varType</span> != <b>typeof</b>(<b>object</b>)
                            ? <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r826 r">varType</span>, <b>typeof</b>(<span class="i">Type</span>))
                            : <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#bebe5451f0389888" class="i field">NullType</a>);
                }
            }
 
            <b>if</b> (<span class="r820 r">childExpr</span> == <b>null</b>)
            {
                <span class="r820 r">childExpr</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r816 r">convertExpressionAst</span>.<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a>);
            }
 
            <b>if</b> (<span class="r818 r">typeName</span>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>.<span class="i">Equals</span>(<span class="s">&quot;PSCustomObject&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="c">// We can&#39;t use the normal PSConvertBinder because it is strongly typed, and we</span>
                <span class="c">// play some funny games with the PSCustomObject type (externally, it&#39;s just an</span>
                <span class="c">// alias for PSObject, internally we do other stuff with it.)</span>
                <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#7a6ccd9565a4ccb0" class="t t">PSCustomObjectConverter</a>.<a href="../runtime/Binding/Binders.cs.html#184d492f98264989" class="i method">Get</a>(), <b>typeof</b>(<b>object</b>), <span class="r820 r">childExpr</span>);
            }
 
            <b>return</b> <a href="#e7f2cb89dd2953e5" class="i method">ConvertValue</a>(<span class="r816 r">convertExpressionAst</span>.<a href="ast.cs.html#ecb5959c230c5865" class="i property">Type</a>, <span class="r820 r">childExpr</span>);
        }
 
        <b>public object</b> <a id="04519f10d44669b2" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitConstantExpression</a>(<a href="ast.cs.html#ebd8ad798cde7861" class="t t">ConstantExpressionAst</a> <span id="r827 rd" class="r827 r">constantExpressionAst</span>)
        {
            <b>return</b> <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r827 r">constantExpressionAst</span>.<a href="ast.cs.html#8e2d2054af044253" class="i property">Value</a>);
        }
 
        <b>public object</b> <a id="34c78a15ee325b41" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitStringConstantExpression</a>(<a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <span id="r828 rd" class="r828 r">stringConstantExpressionAst</span>)
        {
            <b>return</b> <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r828 r">stringConstantExpressionAst</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>);
        }
 
        <b>public object</b> <a id="8d28dd262bbd0146" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitSubExpression</a>(<a href="ast.cs.html#e6552a77ab32112a" class="t t">SubExpressionAst</a> <span id="r829 rd" class="r829 r">subExpressionAst</span>)
        {
            <b>if</b> (<span class="r829 r">subExpressionAst</span>.<a href="ast.cs.html#ec0bda1def565114" class="i property">SubExpression</a>.<a href="ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>.<span class="i">Count</span> == 0)
            {
                <span class="c">// This seems wrong, but is compatible with V2.</span>
                <b>return</b> <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>;
            }
 
            <span class="c">// SubExpression and ParenExpression are two special cases for handling the partial output while exception</span>
            <span class="c">// is thrown. For example, the output of $(1; throw 2) should be 1 and the error record with message &#39;2&#39;;</span>
            <span class="c">// but the output of $(1; throw 2).Length should just be the error record with message &#39;2&#39;.</span>
            <b>bool</b> <span id="r830 rd" class="r830 r">shouldPreserveResultInCaseofException</span> = <span class="r829 r">subExpressionAst</span>.<a href="ast.cs.html#9735bf42b0a863cd" class="i method">ShouldPreserveOutputInCaseOfException</a>();
            <b>return</b> <a href="#a57518533e3fe99b" class="i method">CaptureAstResults</a>(
                <span class="r829 r">subExpressionAst</span>.<a href="ast.cs.html#ec0bda1def565114" class="i property">SubExpression</a>,
                <span class="r830 r">shouldPreserveResultInCaseofException</span>
                    ? <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#8ca51373a8261dd1" class="i field">AssignmentWithResultPreservation</a>
                    : <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>);
        }
 
        <b>public object</b> <a id="edf412a1d5504ae1" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitUsingExpression</a>(<a href="ast.cs.html#42d36b88817a807f" class="t t">UsingExpressionAst</a> <span id="r831 rd" class="r831 r">usingExpression</span>)
        {
            <b>string</b> <span id="r832 rd" class="r832 r">usingExprKey</span> = <a href="../../utils/PsUtils.cs.html#2010e19f156f8c91" class="t t">PsUtils</a>.<a href="../../utils/PsUtils.cs.html#924437b3f1b094ad" class="i method">GetUsingExpressionKey</a>(<span class="r831 r">usingExpression</span>);
            <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#02d883a008c0f925" class="i field">VariableOps_GetUsingValue</a>, <a href="#60079b222ae29e0d" class="i property">LocalVariablesParameter</a>,
                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r832 r">usingExprKey</span>),
                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(<span class="r831 r">usingExpression</span>.<a href="ast.cs.html#4ab6dd3c695bb345" class="i property">RuntimeUsingIndex</a>),
                <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>);
        }
 
        <b>public object</b> <a id="a09bf19f91a25276" href="../../R/a09bf19f91a25276.html" target="n" data-glyph="72,1" class="i method">VisitVariableExpression</a>(<a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a> <span id="r833 rd" class="r833 r">variableExpressionAst</span>)
        {
            <a href="../VariablePath.cs.html#41e5b41974741cc5" class="k">var</a> <span id="r834 rd" class="r834 r">varPath</span> = <span class="r833 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>;
            <b>if</b> (<span class="r834 r">varPath</span>.<a href="../VariablePath.cs.html#6af6d06d3e3c5d67" class="i property">IsVariable</a>)
            {
                <span class="c">// Generate constants for variables that really are constant.</span>
                <b>if</b> (<span class="r834 r">varPath</span>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>.<span class="i">Equals</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#d67486c961066178" class="i field">Null</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>;
                }
 
                <b>if</b> (<span class="r834 r">varPath</span>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>.<span class="i">Equals</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#bc3a5c92bd98b407" class="i field">True</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>true</b>);
                }
 
                <b>if</b> (<span class="r834 r">varPath</span>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>.<span class="i">Equals</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#0d63e40a08074c09" class="i field">False</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>return</b> <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>false</b>);
                }
            }
 
            <b>int</b> <span id="r835 rd" class="r835 r">tupleIndex</span> = <span class="r833 r">variableExpressionAst</span>.<a href="ast.cs.html#d2fd06bce4ae1ac6" class="i property">TupleIndex</a>;
            <b>if</b> (<span class="r833 r">variableExpressionAst</span>.<a href="ast.cs.html#9290d5785ce9caf6" class="i property">Automatic</a>)
            {
                <b>if</b> (<span class="r833 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>.<span class="i">Equals</span>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#b6629e76bb57ad85" class="i field">Question</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                {
                    <b>if</b> (<a href="#57ac2e55a5b17eb3" class="i property">Optimize</a>)
                    {
                        <b>return</b> <span class="i">Expression</span>.<span class="i">Property</span>(<a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#62b97ea0876c7d79" class="i field">ExecutionContext_QuestionMarkVariableValue</a>);
                    }
 
                    <span class="c">// Unoptimized - need to check for breakpoints, so just get the variable, etc.</span>
                    <b>return</b> <span class="i">CallGetVariable</span>(<span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r833 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>), <span class="r833 r">variableExpressionAst</span>);
                }
 
                <b>return</b> <a href="#8da777d02b4dbc3b" class="i method">GetAutomaticVariable</a>(<span class="r833 r">variableExpressionAst</span>);
            }
 
            <b>if</b> (<span class="r835 r">tupleIndex</span> &lt; 0)
            {
                <b>return</b> <span class="i">CallGetVariable</span>(<span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r833 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>), <span class="r833 r">variableExpressionAst</span>);
            }
 
            <b>return</b> <a href="#719f3e105a567e40" class="i method">GetLocal</a>(<span class="r835 r">tupleIndex</span>);
        }
 
        <b>internal</b> <span class="i">Expression</span> <a id="b14126e5546aa1c2" href="../../R/b14126e5546aa1c2.html" target="n" data-glyph="74,1" class="i method">CompileTypeName</a>(<a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r836 rd" class="r836 r">typeName</span>, <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r837 rd" class="r837 r">errorPos</span>)
        {
            <span class="i">Type</span> <span id="r838 rd" class="r838 r">type</span>;
            <b>try</b>
            {
                <span class="c">// If creating the type throws an exception, just defer that error until runtime.</span>
                <span class="r838 r">type</span> = <span class="r836 r">typeName</span>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
            }
            <b>catch</b> (<span class="i">Exception</span>)
            {
                <span class="r838 r">type</span> = <b>null</b>;
            }
 
            <b>if</b> (<span class="r838 r">type</span> != <b>null</b>)
            {
                <b>return</b> <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r838 r">type</span>, <b>typeof</b>(<span class="i">Type</span>));
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#c5cefd491e42dea3" class="i field">TypeOps_ResolveTypeName</a>,
                                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r836 r">typeName</span>),
                                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r837 r">errorPos</span>));
        }
 
        <b>public object</b> <a id="f487f1a1d260751c" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitTypeExpression</a>(<a href="ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a> <span id="r839 rd" class="r839 r">typeExpressionAst</span>)
        {
            <b>return</b> <a href="#b14126e5546aa1c2" class="i method">CompileTypeName</a>(<span class="r839 r">typeExpressionAst</span>.<a href="ast.cs.html#c43447ab6269441a" class="i property">TypeName</a>, <span class="r839 r">typeExpressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>);
        }
 
        <b>public object</b> <a id="6a9bb3ec8485c033" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitMemberExpression</a>(<a href="ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a> <span id="r840 rd" class="r840 r">memberExpressionAst</span>)
        {
            <span class="c">// Getting a static member is much simpler because we can ignore instance</span>
            <span class="c">// and type table members and we only have one adapter - .Net.  So we&#39;ll</span>
            <span class="c">// avoid a dynamic expression if possible.</span>
            <b>if</b> (<span class="r840 r">memberExpressionAst</span>.<a href="ast.cs.html#b882770eb12defeb" class="i property">Static</a> &amp;&amp; (<span class="r840 r">memberExpressionAst</span>.<a href="ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a> <b>is</b> <a href="ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a>))
            {
                <b>var</b> <span id="r841 rd" class="r841 r">type</span> = ((<a href="ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a>)<span class="r840 r">memberExpressionAst</span>.<a href="ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>).<a href="ast.cs.html#c43447ab6269441a" class="i property">TypeName</a>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
                <b>if</b> (<span class="r841 r">type</span> != <b>null</b> &amp;&amp; !<span class="r841 r">type</span>.<span class="i">IsGenericTypeDefinition</span>)
                {
                    <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r842 rd" class="r842 r">member</span> = <span class="r840 r">memberExpressionAst</span>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a> <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                    <b>if</b> (<span class="r842 r">member</span> != <b>null</b>)
                    {
                        <span class="c">// We skip Methods because the adapter wraps them in a PSMethod and it&#39;s not a common scenario.</span>
                        <b>var</b> <span id="r843 rd" class="r843 r">memberInfo</span> = <span class="r841 r">type</span>.<span class="i">GetMember</span>(
                                                <span class="r842 r">member</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>,
                                                <span class="i">MemberTypes</span>.<span class="i">Field</span> | <span class="i">MemberTypes</span>.<span class="i">Property</span>,
                                                <span class="i">BindingFlags</span>.<span class="i">IgnoreCase</span> | <span class="i">BindingFlags</span>.<span class="i">Public</span> | <span class="i">BindingFlags</span>.<span class="i">Static</span> | <span class="i">BindingFlags</span>.<span class="i">FlattenHierarchy</span>);
                        <b>if</b> (<span class="r843 r">memberInfo</span>.<span class="i">Length</span> == 1)
                        {
                            <b>var</b> <span id="r844 rd" class="r844 r">propertyInfo</span> = <span class="r843 r">memberInfo</span>[0] <b>as</b> <span class="i">PropertyInfo</span>;
                            <b>if</b> (<span class="r844 r">propertyInfo</span> != <b>null</b>)
                            {
                                <b>if</b> (<span class="r844 r">propertyInfo</span>.<span class="i">PropertyType</span>.<span class="i">IsByRefLike</span>)
                                {
                                    <span class="c">// ByRef-like types are not boxable and should be used only on stack.</span>
                                    <b>return</b> <span class="i">Expression</span>.<span class="i">Throw</span>(
                                        <span class="i">Expression</span>.<span class="i">New</span>(
                                            <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#f8342ce08ab7434c" class="i field">GetValueException_ctor</a>,
                                            <span class="i">Expression</span>.<span class="i">Constant</span>(<b>nameof</b>(<span class="i">ExtendedTypeSystem</span>.<span class="i">CannotAccessByRefLikePropertyOrField</span>)),
                                            <span class="i">Expression</span>.<span class="i">Constant</span>(<b>null</b>, <b>typeof</b>(<span class="i">Exception</span>)),
                                            <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="i">ExtendedTypeSystem</span>.<span class="i">CannotAccessByRefLikePropertyOrField</span>),
                                            <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(
                                                <b>typeof</b>(<b>object</b>),
                                                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r844 r">propertyInfo</span>.<span class="i">Name</span>),
                                                <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r844 r">propertyInfo</span>.<span class="i">PropertyType</span>, <b>typeof</b>(<span class="i">Type</span>)))),
                                        <b>typeof</b>(<b>object</b>));
                                }
 
                                <b>if</b> (<span class="r844 r">propertyInfo</span>.<span class="i">CanRead</span>)
                                {
                                    <b>return</b> <span class="i">Expression</span>.<span class="i">Property</span>(<b>null</b>, <span class="r844 r">propertyInfo</span>);
                                }
                                <span class="c">// else let the dynamic site generate the error - this is rare anyway</span>
                            }
                            <b>else</b>
                            {
                                <span class="c">// Field cannot be of a ByRef-like type unless it&#39;s an instance member of a ref struct.</span>
                                <span class="c">// So we don&#39;t need to check &#39;IsByRefLike&#39; for static field access.</span>
                                <b>return</b> <span class="i">Expression</span>.<span class="i">Field</span>(<b>null</b>, (<span class="i">FieldInfo</span>)<span class="r843 r">memberInfo</span>[0]);
                            }
                        }
                    }
                }
            }
 
            <b>var</b> <span id="r845 rd" class="r845 r">target</span> = <a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r840 r">memberExpressionAst</span>.<a href="ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>);
 
            <span class="c">// If the ?. operator is used for null conditional check, add the null conditional expression.</span>
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r846 rd" class="r846 r">memberNameAst</span> = <span class="r840 r">memberExpressionAst</span>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a> <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
            <span class="i">Expression</span> <span id="r847 rd" class="r847 r">memberAccessExpr</span> = <span class="r846 r">memberNameAst</span> != <b>null</b>
                ? <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<a href="../runtime/Binding/Binders.cs.html#1a244dc8a883f132" class="i method">Get</a>(<span class="r846 r">memberNameAst</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>, <span class="r840 r">memberExpressionAst</span>.<a href="ast.cs.html#b882770eb12defeb" class="i property">Static</a>), <b>typeof</b>(<b>object</b>), <span class="r845 r">target</span>)
                : <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#1315cad8e76711f9" class="t t">PSGetDynamicMemberBinder</a>.<a href="../runtime/Binding/Binders.cs.html#db0a6b7ddb3fd4d9" class="i method">Get</a>(<a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>, <span class="r840 r">memberExpressionAst</span>.<a href="ast.cs.html#b882770eb12defeb" class="i property">Static</a>), <b>typeof</b>(<b>object</b>), <span class="r845 r">target</span>, <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r840 r">memberExpressionAst</span>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a>));
 
            <b>return</b> <span class="r840 r">memberExpressionAst</span>.<a href="ast.cs.html#2009b5bf3ceaa685" class="i property">NullConditional</a> ? <a href="#27340dce607ac501" class="i method">GetNullConditionalWrappedExpression</a>(<span class="r845 r">target</span>, <span class="r847 r">memberAccessExpr</span>) : <span class="r847 r">memberAccessExpr</span>;
        }
 
        <b>internal static</b> <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <a id="1bac37d06a9a447c" href="../../R/1bac37d06a9a447c.html" target="n" data-glyph="74,1" class="i method">GetInvokeMemberConstraints</a>(<a href="ast.cs.html#be11dcb1e53f56b8" class="t t">InvokeMemberExpressionAst</a> <span id="r848 rd" class="r848 r">invokeMemberExpressionAst</span>)
        {
            <b>var</b> <span id="r849 rd" class="r849 r">arguments</span> = <span class="r848 r">invokeMemberExpressionAst</span>.<a href="ast.cs.html#0f1554608efc28f3" class="i property">Arguments</a>;
            <b>var</b> <span id="r850 rd" class="r850 r">targetTypeConstraint</span> = <a href="#05c0f8960f453cab" class="i method">GetTypeConstraintForMethodResolution</a>(<span class="r848 r">invokeMemberExpressionAst</span>.<a href="ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>);
            <b>return</b> <span class="i">CombineTypeConstraintForMethodResolution</span>(
                    <span class="r850 r">targetTypeConstraint</span>,
                    <span class="r849 r">arguments</span>?.<span class="i">Select</span>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">GetTypeConstraintForMethodResolution</span>).<span class="i">ToArray</span>());
        }
 
        <b>internal static</b> <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <a id="322f55259ef8201e" href="../../R/322f55259ef8201e.html" target="n" data-glyph="74,1" class="i method">GetInvokeMemberConstraints</a>(<a href="ast.cs.html#93dc2e4429de8e4e" class="t t">BaseCtorInvokeMemberExpressionAst</a> <span id="r851 rd" class="r851 r">invokeMemberExpressionAst</span>)
        {
            <span class="i">Type</span> <span id="r852 rd" class="r852 r">targetTypeConstraint</span> = <b>null</b>;
            <b>var</b> <span id="r853 rd" class="r853 r">arguments</span> = <span class="r851 r">invokeMemberExpressionAst</span>.<a href="ast.cs.html#0f1554608efc28f3" class="i property">Arguments</a>;
            <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r854 rd" class="r854 r">typeDefinitionAst</span> = <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>.<a href="ast.cs.html#1fc90b0e58babd9d" class="i method">GetAncestorTypeDefinitionAst</a>(<span class="r851 r">invokeMemberExpressionAst</span>);
            <b>if</b> (<span class="r854 r">typeDefinitionAst</span> != <b>null</b>)
            {
                <span class="r852 r">targetTypeConstraint</span> = (<span class="r854 r">typeDefinitionAst</span> <b>as</b> <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>).<a href="ast.cs.html#238185060b3af590" class="i property">Type</a>.<span class="i">BaseType</span>;
            }
            <b>else</b>
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;BaseCtorInvokeMemberExpressionAst must be used only inside TypeDefinitionAst&quot;</span>);
            }
 
            <b>return</b> <span class="i">CombineTypeConstraintForMethodResolution</span>(
                    <span class="r852 r">targetTypeConstraint</span>,
                    <span class="r853 r">arguments</span>?.<span class="i">Select</span>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<span class="i">GetTypeConstraintForMethodResolution</span>).<span class="i">ToArray</span>());
        }
 
        <b>internal</b> <span class="i">Expression</span> <a id="d9cd66647e70eede" href="../../R/d9cd66647e70eede.html" target="n" data-glyph="74,1" class="i method">InvokeMember</a>(
            <b>string</b> <span id="r855 rd" class="r855 r">name</span>,
            <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r856 rd" class="r856 r">constraints</span>,
            <span class="i">Expression</span> <span id="r857 rd" class="r857 r">target</span>,
            <span class="i">IEnumerable</span>&lt;<span class="i">Expression</span>&gt; <span id="r858 rd" class="r858 r">args</span>,
            <b>bool</b> <span id="r859 rd" class="r859 r">@static</span>,
            <b>bool</b> <span id="r860 rd" class="r860 r">propertySet</span>,
            <b>bool</b> <span id="r861 rd" class="r861 r">nullConditional</span> = <b>false</b>)
        {
            <b>var</b> <span id="r862 rd" class="r862 r">callInfo</span> = <b>new</b> <span class="i">CallInfo</span>(<span class="r858 r">args</span>.<span class="i">Count</span>());
            <b>var</b> <span id="r863 rd" class="r863 r">classScope</span> = <a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>?.<a href="ast.cs.html#238185060b3af590" class="i property">Type</a>;
            <b>var</b> <span id="r864 rd" class="r864 r">binder</span> = <span class="r855 r">name</span>.<span class="i">Equals</span>(<span class="s">&quot;new&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp; <span class="r859 r">@static</span>
                ? (<span class="i">CallSiteBinder</span>)<a href="../runtime/Binding/Binders.cs.html#b69e0408238caa22" class="t t">PSCreateInstanceBinder</a>.<a href="../runtime/Binding/Binders.cs.html#5f3d565cf1fbe2b5" class="i method">Get</a>(<span class="r862 r">callInfo</span>, <span class="r856 r">constraints</span>, <span class="r865 r">publicTypeOnly</span>: <b>true</b>)
                : <a href="../runtime/Binding/Binders.cs.html#0e3dce2a001305f0" class="t t">PSInvokeMemberBinder</a>.<span class="i">Get</span>(<span class="r855 r">name</span>, <span class="r862 r">callInfo</span>, <span class="r859 r">@static</span>, <span class="r860 r">propertySet</span>, <span class="r856 r">constraints</span>, <span class="r863 r">classScope</span>);
 
            <b>var</b> <span id="r866 rd" class="r866 r">dynamicExprFromBinder</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r864 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r858 r">args</span>.<span class="i">Prepend</span>(<span class="r857 r">target</span>));
 
            <b>return</b> <span class="r861 r">nullConditional</span> ? <span class="i">GetNullConditionalWrappedExpression</span>(<span class="r857 r">target</span>, <span class="r866 r">dynamicExprFromBinder</span>) : <span class="r866 r">dynamicExprFromBinder</span>;
        }
 
        <b>private static</b> <span class="i">Expression</span> <a id="bef669cf1d7de21c" href="../../R/bef669cf1d7de21c.html" target="n" data-glyph="76,1" class="i method">InvokeBaseCtorMethod</a>(<a href="../MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r867 rd" class="r867 r">constraints</span>, <span class="i">Expression</span> <span id="r868 rd" class="r868 r">target</span>, <span class="i">IEnumerable</span>&lt;<span class="i">Expression</span>&gt; <span id="r869 rd" class="r869 r">args</span>)
        {
            <b>var</b> <span id="r870 rd" class="r870 r">callInfo</span> = <b>new</b> <span class="i">CallInfo</span>(<span class="r869 r">args</span>.<span class="i">Count</span>());
            <a href="../runtime/Binding/Binders.cs.html#ea209d8b05b0d799" class="k">var</a> <span id="r871 rd" class="r871 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#ea209d8b05b0d799" class="t t">PSInvokeBaseCtorBinder</a>.<a href="../runtime/Binding/Binders.cs.html#5ad01a4a81f20728" class="i method">Get</a>(<span class="r870 r">callInfo</span>, <span class="r867 r">constraints</span>);
            <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r871 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r869 r">args</span>.<span class="i">Prepend</span>(<span class="r868 r">target</span>));
        }
 
        <b>internal</b> <span class="i">Expression</span> <a id="cb4e7eaf190715a8" href="../../R/cb4e7eaf190715a8.html" target="n" data-glyph="74,1" class="i method">InvokeDynamicMember</a>(
            <span class="i">Expression</span> <span id="r872 rd" class="r872 r">memberNameExpr</span>,
            <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <span id="r873 rd" class="r873 r">constraints</span>,
            <span class="i">Expression</span> <span id="r874 rd" class="r874 r">target</span>,
            <span class="i">IEnumerable</span>&lt;<span class="i">Expression</span>&gt; <span id="r875 rd" class="r875 r">args</span>,
            <b>bool</b> <span id="r876 rd" class="r876 r">@static</span>,
            <b>bool</b> <span id="r877 rd" class="r877 r">propertySet</span>,
            <b>bool</b> <span id="r878 rd" class="r878 r">nullConditional</span> = <b>false</b>)
        {
            <a href="../runtime/Binding/Binders.cs.html#f6e38f6a1de3f60b" class="k">var</a> <span id="r879 rd" class="r879 r">binder</span> = <a href="../runtime/Binding/Binders.cs.html#f6e38f6a1de3f60b" class="t t">PSInvokeDynamicMemberBinder</a>.<a href="../runtime/Binding/Binders.cs.html#fa8157c24f78c2a6" class="i method">Get</a>(<b>new</b> <span class="i">CallInfo</span>(<span class="r875 r">args</span>.<span class="i">Count</span>()), <a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>, <span class="r876 r">@static</span>, <span class="r877 r">propertySet</span>, <span class="r873 r">constraints</span>);
            <b>var</b> <span id="r880 rd" class="r880 r">dynamicExprFromBinder</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r879 r">binder</span>, <b>typeof</b>(<b>object</b>), <span class="r875 r">args</span>.<span class="i">Prepend</span>(<span class="r872 r">memberNameExpr</span>).<span class="i">Prepend</span>(<span class="r874 r">target</span>));
 
            <b>return</b> <span class="r878 r">nullConditional</span> ? <span class="i">GetNullConditionalWrappedExpression</span>(<span class="r874 r">target</span>, <span class="r880 r">dynamicExprFromBinder</span>) : <span class="r880 r">dynamicExprFromBinder</span>;
        }
 
        <b>public object</b> <a id="6b4a05944e4f4c6d" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitInvokeMemberExpression</a>(<a href="ast.cs.html#be11dcb1e53f56b8" class="t t">InvokeMemberExpressionAst</a> <span id="r881 rd" class="r881 r">invokeMemberExpressionAst</span>)
        {
            <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="k">var</a> <span id="r882 rd" class="r882 r">constraints</span> = <a href="#1bac37d06a9a447c" class="i method">GetInvokeMemberConstraints</a>(<span class="r881 r">invokeMemberExpressionAst</span>);
 
            <b>var</b> <span id="r883 rd" class="r883 r">target</span> = <a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r881 r">invokeMemberExpressionAst</span>.<a href="ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>);
            <b>var</b> <span id="r884 rd" class="r884 r">args</span> = <span class="i">CompileInvocationArguments</span>(<span class="r881 r">invokeMemberExpressionAst</span>.<a href="ast.cs.html#0f1554608efc28f3" class="i property">Arguments</a>);
 
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r885 rd" class="r885 r">memberNameAst</span> = <span class="r881 r">invokeMemberExpressionAst</span>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a> <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
            <b>if</b> (<span class="r885 r">memberNameAst</span> != <b>null</b>)
            {
                <b>return</b> <a href="#d9cd66647e70eede" class="i method">InvokeMember</a>(
                    <span class="r885 r">memberNameAst</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>,
                    <span class="r882 r">constraints</span>,
                    <span class="r883 r">target</span>,
                    <span class="r884 r">args</span>,
                    <span class="r881 r">invokeMemberExpressionAst</span>.<a href="ast.cs.html#b882770eb12defeb" class="i property">Static</a>,
                    <span class="r860 r">propertySet</span>: <b>false</b>,
                    <span class="r881 r">invokeMemberExpressionAst</span>.<a href="ast.cs.html#2009b5bf3ceaa685" class="i property">NullConditional</a>);
            }
 
            <b>var</b> <span id="r886 rd" class="r886 r">memberNameExpr</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r881 r">invokeMemberExpressionAst</span>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a>);
            <b>return</b> <a href="#cb4e7eaf190715a8" class="i method">InvokeDynamicMember</a>(<span class="r886 r">memberNameExpr</span>, <span class="r882 r">constraints</span>, <span class="r883 r">target</span>, <span class="r884 r">args</span>, <span class="r881 r">invokeMemberExpressionAst</span>.<a href="ast.cs.html#b882770eb12defeb" class="i property">Static</a>, <span class="r877 r">propertySet</span>: <b>false</b>, <span class="r881 r">invokeMemberExpressionAst</span>.<a href="ast.cs.html#2009b5bf3ceaa685" class="i property">NullConditional</a>);
        }
 
        <b>public object</b> <a id="f5cf716d5b90cc31" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitArrayExpression</a>(<a href="ast.cs.html#6bb067a9fcfafabf" class="t t">ArrayExpressionAst</a> <span id="r887 rd" class="r887 r">arrayExpressionAst</span>)
        {
            <span class="i">Expression</span> <span id="r888 rd" class="r888 r">values</span> = <b>null</b>;
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r889 rd" class="r889 r">pureExprAst</span> = <b>null</b>;
 
            <a href="ast.cs.html#268644c84b225866" class="k">var</a> <span id="r890 rd" class="r890 r">subExpr</span> = <span class="r887 r">arrayExpressionAst</span>.<a href="ast.cs.html#ccfc39397cd3e8e5" class="i property">SubExpression</a>;
            <b>if</b> (<span class="r890 r">subExpr</span>.<a href="ast.cs.html#8a3ec42ea63c1318" class="i property">Traps</a> == <b>null</b>)
            {
                <b>if</b> (<span class="r890 r">subExpr</span>.<a href="ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>.<span class="i">Count</span> == 1)
                {
                    <a href="ast.cs.html#86812479028959b8" class="k">var</a> <span id="r891 rd" class="r891 r">pipelineBase</span> = <span class="r890 r">subExpr</span>.<a href="ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>[0] <b>as</b> <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a>;
                    <b>if</b> (<span class="r891 r">pipelineBase</span> != <b>null</b>)
                    {
                        <span class="r889 r">pureExprAst</span> = <span class="r891 r">pipelineBase</span>.<a href="ast.cs.html#158661f5f6c8db6d" class="i method">GetPureExpression</a>();
                        <b>if</b> (<span class="r889 r">pureExprAst</span> != <b>null</b>)
                        {
                            <span class="r888 r">values</span> = <a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r889 r">pureExprAst</span>);
                        }
                    }
                }
                <b>else</b> <b>if</b> (<span class="r890 r">subExpr</span>.<a href="ast.cs.html#2d53956b12d128eb" class="i property">Statements</a>.<span class="i">Count</span> == 0)
                {
                    <span class="c">// A dynamic site can&#39;t take void - but a void value is just an empty array.</span>
                    <b>return</b> <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<b>object</b>));
                }
            }
 
            <span class="r888 r">values</span> ??= <a href="#a57518533e3fe99b" class="i method">CaptureAstResults</a>(<span class="r890 r">subExpr</span>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#052596a192f2302b" class="i field">Enumerable</a>);
 
            <b>if</b> (<span class="r889 r">pureExprAst</span> <b>is</b> <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>)
            {
                <span class="c">// If the pure expression is ArrayLiteralAst, just return the result.</span>
                <b>return</b> <span class="r888 r">values</span>;
            }
 
            <b>if</b> (<span class="r888 r">values</span>.<span class="i">Type</span>.<span class="i">IsPrimitive</span> || <span class="r888 r">values</span>.<span class="i">Type</span> == <b>typeof</b>(<b>string</b>))
            {
                <span class="c">// Slight optimization - no need for a dynamic site.  We could special case other</span>
                <span class="c">// types as well, but it&#39;s probably not worth it.</span>
                <b>return</b> <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<b>object</b>), <span class="r888 r">values</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)));
            }
 
            <b>if</b> (<span class="r888 r">values</span>.<span class="i">Type</span> == <b>typeof</b>(<b>void</b>))
            {
                <span class="c">// A dynamic site can&#39;t take void - but a void value is just an empty array.</span>
                <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r888 r">values</span>, <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<b>object</b>)));
            }
 
            <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#6451a9aa35b72f04" class="t t">PSToObjectArrayBinder</a>.<a href="../runtime/Binding/Binders.cs.html#099ce4d32e868b7c" class="i method">Get</a>(), <b>typeof</b>(<b>object</b>[]), <span class="r888 r">values</span>);
        }
 
        <b>public object</b> <a id="77b542914f791abd" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitArrayLiteral</a>(<a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a> <span id="r892 rd" class="r892 r">arrayLiteralAst</span>)
        {
            <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r893 rd" class="r893 r">elementValues</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;(<span class="r892 r">arrayLiteralAst</span>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">Count</span>);
            <b>foreach</b> (<b>var</b> <span id="r894 rd" class="r894 r">element</span> <b>in</b> <span class="r892 r">arrayLiteralAst</span>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>)
            {
                <b>var</b> <span id="r895 rd" class="r895 r">elementValue</span> = <span class="i">Compile</span>(<span class="r894 r">element</span>);
                <span class="r893 r">elementValues</span>.<span class="i">Add</span>(<span class="r895 r">elementValue</span>.<span class="i">Type</span> != <b>typeof</b>(<b>void</b>) ? <span class="r895 r">elementValue</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>)) : <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r895 r">elementValue</span>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#84591f5e881dc39e" class="i field">AutomationNullConstant</a>));
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(<b>typeof</b>(<b>object</b>), <span class="r893 r">elementValues</span>);
        }
 
        <b>private</b> <span class="i">IEnumerable</span>&lt;<span class="i">Expression</span>&gt; <a id="b66c73d015083718" href="../../R/b66c73d015083718.html" target="n" data-glyph="76,1" class="i method">BuildHashtable</a>(<span class="i">ReadOnlyCollection</span>&lt;<span class="i">KeyValuePair</span>&gt; <span id="r896 rd" class="r896 r">keyValuePairs</span>, <span class="i">ParameterExpression</span> <span id="r897 rd" class="r897 r">temp</span>, <b>bool</b> <span id="r822 rd" class="r822 r">ordered</span>)
        {
            <b>yield</b> <b>return</b> <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r897 r">temp</span>,
                <span class="i">Expression</span>.<span class="i">New</span>(<span class="r822 r">ordered</span> ? <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#44666aa8053a8199" class="i field">OrderedDictionary_ctor</a> : <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#b35174be980baa73" class="i field">Hashtable_ctor</a>,
                                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<span class="i">Constant</span>(<span class="r896 r">keyValuePairs</span>.<span class="i">Count</span>),
                                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#5baeb89f5a8827ce" class="i field">OrdinalIgnoreCaseComparer</a>.<span class="i">Cast</span>(<b>typeof</b>(<span class="i">IEqualityComparer</span>))));
            <b>for</b> (<b>int</b> <span id="r898 rd" class="r898 r">index</span> = 0; <span class="r898 r">index</span> &lt; <span class="r896 r">keyValuePairs</span>.<span class="i">Count</span>; <span class="r898 r">index</span>++)
            {
                <b>var</b> <span id="r899 rd" class="r899 r">keyValuePair</span> = <span class="r896 r">keyValuePairs</span>[<span class="r898 r">index</span>];
                <span class="i">Expression</span> <span id="r900 rd" class="r900 r">key</span> = <span class="i">Expression</span>.<span class="i">Convert</span>(<span class="i">Compile</span>(<span class="r899 r">keyValuePair</span>.<span class="i">Item1</span>), <b>typeof</b>(<b>object</b>));
 
                <span class="c">// We should not preserve the partial output if exception is thrown when evaluating the value.</span>
                <span class="i">Expression</span> <span id="r901 rd" class="r901 r">value</span> =
                    <span class="i">Expression</span>.<span class="i">Convert</span>(<span class="i">CaptureStatementResults</span>(<span class="r899 r">keyValuePair</span>.<span class="i">Item2</span>, <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>), <b>typeof</b>(<b>object</b>));
                <span class="i">Expression</span> <span id="r902 rd" class="r902 r">errorExtent</span> = <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r899 r">keyValuePair</span>.<span class="i">Item1</span>.<span class="i">Extent</span>);
                <b>yield</b> <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#411d506374ee97b8" class="i field">HashtableOps_AddKeyValuePair</a>, <span class="r897 r">temp</span>, <span class="r900 r">key</span>, <span class="r901 r">value</span>, <span class="r902 r">errorExtent</span>);
            }
 
            <b>yield</b> <b>return</b> <span class="r897 r">temp</span>;
        }
 
        <b>public object</b> <a id="d3a168527ed81776" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitHashtable</a>(<a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r903 rd" class="r903 r">hashtableAst</span>)
        {
            <b>var</b> <span id="r904 rd" class="r904 r">temp</span> = <span class="i">NewTemp</span>(<b>typeof</b>(<span class="i">Hashtable</span>), <span class="s">&quot;hashtable&quot;</span>);
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(
                <b>typeof</b>(<span class="i">Hashtable</span>),
                <b>new</b>[] { <span class="r904 r">temp</span> },
                <a href="#b66c73d015083718" class="i method">BuildHashtable</a>(<span class="r903 r">hashtableAst</span>.<a href="ast.cs.html#87313f35bc2b66d9" class="i property">KeyValuePairs</a>, <span class="r904 r">temp</span>, <span class="r822 r">ordered</span>: <b>false</b>));
        }
 
        <b>public object</b> <a id="2271eea132457d5c" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitScriptBlockExpression</a>(<a href="ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a> <span id="r905 rd" class="r905 r">scriptBlockExpressionAst</span>)
        {
            <span class="c">// The script block is not visited until it is executed, executing a script block expression node simply</span>
            <span class="c">// builds a new script block without analyzing it.</span>
            <span class="c">//</span>
            <span class="c">// A wrapper is returned so we can cache the script block and return clones that are pre-compiled if</span>
            <span class="c">// the expression is evaluated more than once (e.g. in a loop, or if the containing function/script</span>
            <span class="c">// is called again.)</span>
            <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(
                                <span class="i">Expression</span>.<span class="i">Constant</span>(<b>new</b> <a href="../runtime/Operations/MiscOps.cs.html#a58e9f637412d31b" class="t constructor">ScriptBlockExpressionWrapper</a>(<span class="r905 r">scriptBlockExpressionAst</span>.<a href="ast.cs.html#3155915865e15c92" class="i property">ScriptBlock</a>)),
                                <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#9859243f4bad96d3" class="i field">ScriptBlockExpressionWrapper_GetScriptBlock</a>,
                                <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>,
                                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8ae9528048f248a7" class="i method">Constant</a>(<b>false</b>));
        }
 
        <b>public object</b> <a id="29494a5634da5ea9" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitParenExpression</a>(<a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a> <span id="r906 rd" class="r906 r">parenExpressionAst</span>)
        {
            <a href="ast.cs.html#86812479028959b8" class="k">var</a> <span id="r907 rd" class="r907 r">pipe</span> = <span class="r906 r">parenExpressionAst</span>.<a href="ast.cs.html#021e323175cb804d" class="i property">Pipeline</a>;
            <a href="ast.cs.html#da5f345864f42e06" class="k">var</a> <span id="r908 rd" class="r908 r">assignmentStatementAst</span> = <span class="r907 r">pipe</span> <b>as</b> <a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a>;
 
            <b>if</b> (<span class="r908 r">assignmentStatementAst</span> != <b>null</b>)
            {
                <b>return</b> <a href="#e8ec24b53e7f9f8d" class="i method">CompileAssignment</a>(<span class="r908 r">assignmentStatementAst</span>);
            }
 
            <span class="c">// SubExpression and ParenExpression are two special cases for handling the partial output while exception</span>
            <span class="c">// is thrown. For example, function bar { 1; throw 2 }, the output of (bar) should be 1 and the error record with message &#39;2&#39;;</span>
            <span class="c">// but the output of (bar).Length should just be the error record with message &#39;2&#39;.</span>
            <b>bool</b> <span id="r909 rd" class="r909 r">shouldPreserveOutputInCaseOfException</span> = <span class="r906 r">parenExpressionAst</span>.<a href="ast.cs.html#9735bf42b0a863cd" class="i method">ShouldPreserveOutputInCaseOfException</a>();
            <b>return</b> <a href="#fed19bee56918521" class="i method">CaptureStatementResults</a>(
                    <span class="r907 r">pipe</span>,
                    <span class="r909 r">shouldPreserveOutputInCaseOfException</span>
                        ? <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#8ca51373a8261dd1" class="i field">AssignmentWithResultPreservation</a>
                        : <a href="#da8abc3dab8cdcf2" class="t t">CaptureAstContext</a>.<a href="#a62dd487e94fcb40" class="i field">AssignmentWithoutResultPreservation</a>);
        }
 
        <b>public object</b> <a id="d0b8fa90b0032480" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitExpandableStringExpression</a>(<a href="ast.cs.html#dac25e1530bb8b85" class="t t">ExpandableStringExpressionAst</a> <span id="r910 rd" class="r910 r">expandableStringExpressionAst</span>)
        {
            <b>var</b> <span id="r911 rd" class="r911 r">left</span> = <span class="i">Expression</span>.<span class="i">Constant</span>(<span class="r910 r">expandableStringExpressionAst</span>.<a href="ast.cs.html#b2f43eb7778a1d9a" class="i property">FormatExpression</a>);
            <b>var</b> <span id="r912 rd" class="r912 r">nestedAsts</span> = <span class="r910 r">expandableStringExpressionAst</span>.<a href="ast.cs.html#7a52821c53f08528" class="i property">NestedExpressions</a>;
            <a href="../runtime/Binding/Binders.cs.html#db2e7c67b332caf6" class="k">var</a> <span id="r913 rd" class="r913 r">toStringBinder</span> = <a href="../runtime/Binding/Binders.cs.html#db2e7c67b332caf6" class="t t">PSToStringBinder</a>.<a href="../runtime/Binding/Binders.cs.html#7a771c568a738822" class="i method">Get</a>();
            <b>var</b> <span id="r914 rd" class="r914 r">right</span> = <span class="i">Expression</span>.<span class="i">NewArrayInit</span>(
                                    <b>typeof</b>(<b>string</b>),
                                    <span class="r912 r">nestedAsts</span>.<span class="i">Select</span>(<span id="r915 rd" class="r915 r">e</span> =&gt; <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<span class="r913 r">toStringBinder</span>, <b>typeof</b>(<b>string</b>), <span class="i">Compile</span>(<span class="r915 r">e</span>), <a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>)));
            <b>return</b> <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#5af60761a513c293" class="i field">StringOps_FormatOperator</a>, <span class="r911 r">left</span>, <span class="r914 r">right</span>);
        }
 
        <b>public object</b> <a id="2fba43132332a65e" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitIndexExpression</a>(<a href="ast.cs.html#4587e325068530ec" class="t t">IndexExpressionAst</a> <span id="r916 rd" class="r916 r">indexExpressionAst</span>)
        {
            <b>var</b> <span id="r917 rd" class="r917 r">targetExpr</span> = <a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r916 r">indexExpressionAst</span>.<a href="ast.cs.html#4340a50f115f7fdd" class="i property">Target</a>);
 
            <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r918 rd" class="r918 r">index</span> = <span class="r916 r">indexExpressionAst</span>.<a href="ast.cs.html#2e5c6ad17318d78c" class="i property">Index</a>;
            <a href="ast.cs.html#0e44bc9125134006" class="k">var</a> <span id="r919 rd" class="r919 r">arrayLiteral</span> = (<span class="r918 r">index</span> <b>as</b> <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>);
            <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="k">var</a> <span id="r920 rd" class="r920 r">constraints</span> = <a href="#bd18d1c8d492dde3" class="i method">CombineTypeConstraintForMethodResolution</a>(
                                <a href="#05c0f8960f453cab" class="i method">GetTypeConstraintForMethodResolution</a>(<span class="r916 r">indexExpressionAst</span>.<a href="ast.cs.html#4340a50f115f7fdd" class="i property">Target</a>),
                                <a href="#05c0f8960f453cab" class="i method">GetTypeConstraintForMethodResolution</a>(<span class="r918 r">index</span>));
 
            <span class="c">// An array literal is either:</span>
            <span class="c">//    $x[1,2]</span>
            <span class="c">// or</span>
            <span class="c">//    $x[,1]</span>
            <span class="c">// In the former case, the user is requesting an array slice.  In the latter case, they index expression is likely</span>
            <span class="c">// an array (dynamically determined) and they don&#39;t want an array slice, they want to use the array as the index</span>
            <span class="c">// expression.</span>
            <span class="i">Expression</span> <span id="r921 rd" class="r921 r">indexingExpr</span> = <span class="r919 r">arrayLiteral</span> != <b>null</b> &amp;&amp; <span class="r919 r">arrayLiteral</span>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">Count</span> &gt; 1
                ? <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                    <a href="../runtime/Binding/Binders.cs.html#f5f4b5dd1e81524d" class="t t">PSGetIndexBinder</a>.<span class="i">Get</span>(<span class="r919 r">arrayLiteral</span>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">Count</span>, <span class="r920 r">constraints</span>),
                    <b>typeof</b>(<b>object</b>),
                    <span class="r919 r">arrayLiteral</span>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">Select</span>(<span class="i">CompileExpressionOperand</span>).<span class="i">Prepend</span>(<span class="r917 r">targetExpr</span>))
                : <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                    <a href="../runtime/Binding/Binders.cs.html#f5f4b5dd1e81524d" class="t t">PSGetIndexBinder</a>.<a href="../runtime/Binding/Binders.cs.html#b40e91138efa4156" class="i method">Get</a>(<span class="r922 r">argCount</span>: 1, <span class="r920 r">constraints</span>),
                    <b>typeof</b>(<b>object</b>),
                    <span class="r917 r">targetExpr</span>,
                    <a href="#918593282571f172" class="i method">CompileExpressionOperand</a>(<span class="r918 r">index</span>));
 
            <b>return</b> <span class="r916 r">indexExpressionAst</span>.<a href="ast.cs.html#bc0ffb37ea25c82b" class="i property">NullConditional</a> ? <a href="#27340dce607ac501" class="i method">GetNullConditionalWrappedExpression</a>(<span class="r917 r">targetExpr</span>, <span class="r921 r">indexingExpr</span>) : <span class="r921 r">indexingExpr</span>;
        }
 
        <b>private static</b> <span class="i">Expression</span> <a id="27340dce607ac501" href="../../R/27340dce607ac501.html" target="n" data-glyph="76,1" class="i method">GetNullConditionalWrappedExpression</a>(<span class="i">Expression</span> <span id="r923 rd" class="r923 r">targetExpr</span>, <span class="i">Expression</span> <span id="r924 rd" class="r924 r">memberAccessExpression</span>)
        {
            <b>return</b> <span class="i">Expression</span>.<span class="i">Condition</span>(
                <span class="i">Expression</span>.<span class="i">Call</span>(<a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#3dae8f6f568e4e16" class="i field">LanguagePrimitives_IsNull</a>, <span class="r923 r">targetExpr</span>.<span class="i">Cast</span>(<b>typeof</b>(<b>object</b>))),
                <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#03f60a93eeec7a4b" class="i field">NullConstant</a>,
                <span class="r924 r">memberAccessExpression</span>);
        }
 
        <b>public object</b> <a id="21a2e49a51d3c791" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitAttributedExpression</a>(<a href="ast.cs.html#434eb922ec6ac95b" class="t t">AttributedExpressionAst</a> <span id="r925 rd" class="r925 r">attributedExpressionAst</span>)
        {
            <b>return</b> <span class="r925 r">attributedExpressionAst</span>.<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a>.<a href="ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#8bdfc042f41c96c5" class="k">this</a>);
        }
 
        <b>public object</b> <a id="f1f9639b0b12dd5c" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">VisitBlockStatement</a>(<a href="ast.cs.html#0a993ec4b360d318" class="t t">BlockStatementAst</a> <span id="r926 rd" class="r926 r">blockStatementAst</span>)
        {
            <b>return</b> <b>null</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Expressions
    }
 
    <b>internal class</b> <a id="6bc510d784c8e6ee" href="../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="3c7e0dac9c0697bb">MemberAssignableValue</span></a> : <a href="ast.cs.html#41e026a3563ae47a" class="t t">IAssignableValue</a>
    {
        <b>internal</b> <a href="ast.cs.html#a3e8bc64452a67d0" class="t t">MemberExpressionAst</a> <a id="636d42a34963f483" href="../../R/636d42a34963f483.html" target="n" data-glyph="104,1" class="i property">MemberExpression</a> { <b>get</b>; <b>set</b>; }
 
        <b>private</b> <span class="i">Expression</span> <a id="1361f63647eff687" href="../../R/1361f63647eff687.html" target="n" data-glyph="106,1" class="i property">CachedTarget</a> { <b>get</b>; <b>set</b>; }
 
        <b>private</b> <span class="i">Expression</span> <a id="63a7772cbd50c3d9" href="../../R/63a7772cbd50c3d9.html" target="n" data-glyph="106,1" class="i property">CachedPropertyExpr</a> { <b>get</b>; <b>set</b>; }
 
        <b>private</b> <span class="i">Expression</span> <a id="7d636a1bf21c7328" href="../../R/7d636a1bf21c7328.html" target="n" data-glyph="76,1" class="i method">GetTargetExpr</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r927 rd" class="r927 r">compiler</span>)
        {
            <b>return</b> <span class="r927 r">compiler</span>.<a href="#5795855cf17e55b6" class="i method">Compile</a>(<a href="#636d42a34963f483" class="i property">MemberExpression</a>.<a href="ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>);
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="7a8900ff557c09f8" href="../../R/7a8900ff557c09f8.html" target="n" data-glyph="76,1" class="i method">GetPropertyExpr</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r928 rd" class="r928 r">compiler</span>)
        {
            <b>return</b> <span class="r928 r">compiler</span>.<a href="#5795855cf17e55b6" class="i method">Compile</a>(<a href="#636d42a34963f483" class="i property">MemberExpression</a>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a>);
        }
 
        <b>public</b> <span class="i">Expression</span> <a id="4f1b6963598efce1" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetValue</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r929 rd" class="r929 r">compiler</span>, <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r930 rd" class="r930 r">exprs</span>, <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt; <span id="r931 rd" class="r931 r">temps</span>)
        {
            <b>var</b> <span id="r932 rd" class="r932 r">target</span> = <a href="#7d636a1bf21c7328" class="i method">GetTargetExpr</a>(<span class="r929 r">compiler</span>);
            <b>var</b> <span id="r933 rd" class="r933 r">targetTemp</span> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<span class="r932 r">target</span>.<span class="i">Type</span>);
            <span class="r931 r">temps</span>.<span class="i">Add</span>(<span class="r933 r">targetTemp</span>);
            <a href="#1361f63647eff687" class="i property">CachedTarget</a> = <span class="r933 r">targetTemp</span>;
            <span class="r930 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r933 r">targetTemp</span>, <span class="r932 r">target</span>));
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r934 rd" class="r934 r">memberNameAst</span> = <a href="#636d42a34963f483" class="i property">MemberExpression</a>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a> <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
            <b>if</b> (<span class="r934 r">memberNameAst</span> != <b>null</b>)
            {
                <b>string</b> <span id="r935 rd" class="r935 r">name</span> = <span class="r934 r">memberNameAst</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>;
                <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#ef1a94f6eb6abfd5" class="t t">PSGetMemberBinder</a>.<a href="../runtime/Binding/Binders.cs.html#1a244dc8a883f132" class="i method">Get</a>(<span class="r935 r">name</span>, <span class="r929 r">compiler</span>.<a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>, <a href="#636d42a34963f483" class="i property">MemberExpression</a>.<a href="ast.cs.html#b882770eb12defeb" class="i property">Static</a>), <b>typeof</b>(<b>object</b>), <span class="r933 r">targetTemp</span>);
            }
 
            <b>var</b> <span id="r936 rd" class="r936 r">propertyExpr</span> = <a href="#7a8900ff557c09f8" class="i method">GetPropertyExpr</a>(<span class="r929 r">compiler</span>);
            <b>var</b> <span id="r937 rd" class="r937 r">propertyNameTemp</span> = <span class="i">Expression</span>.<span class="i">Parameter</span>(<span class="r936 r">propertyExpr</span>.<span class="i">Type</span>);
            <span class="r931 r">temps</span>.<span class="i">Add</span>(<span class="r937 r">propertyNameTemp</span>);
            <span class="r930 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r937 r">propertyNameTemp</span>, <span class="r929 r">compiler</span>.<a href="#5795855cf17e55b6" class="i method">Compile</a>(<a href="#636d42a34963f483" class="i property">MemberExpression</a>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a>)));
            <a href="#63a7772cbd50c3d9" class="i property">CachedPropertyExpr</a> = <span class="r937 r">propertyNameTemp</span>;
            <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#1315cad8e76711f9" class="t t">PSGetDynamicMemberBinder</a>.<a href="../runtime/Binding/Binders.cs.html#db0a6b7ddb3fd4d9" class="i method">Get</a>(<span class="r929 r">compiler</span>.<a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>, <a href="#636d42a34963f483" class="i property">MemberExpression</a>.<a href="ast.cs.html#b882770eb12defeb" class="i property">Static</a>), <b>typeof</b>(<b>object</b>), <span class="r933 r">targetTemp</span>, <span class="r937 r">propertyNameTemp</span>);
        }
 
        <b>public</b> <span class="i">Expression</span> <a id="a740c0ac638de018" href="../../R/a740c0ac638de018.html" target="n" data-glyph="72,1" class="i method">SetValue</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r938 rd" class="r938 r">compiler</span>, <span class="i">Expression</span> <span id="r939 rd" class="r939 r">rhs</span>)
        {
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r940 rd" class="r940 r">memberNameAst</span> = <a href="#636d42a34963f483" class="i property">MemberExpression</a>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a> <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
            <b>if</b> (<span class="r940 r">memberNameAst</span> != <b>null</b>)
            {
                <b>string</b> <span id="r941 rd" class="r941 r">name</span> = <span class="r940 r">memberNameAst</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>;
                <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                                            <a href="../runtime/Binding/Binders.cs.html#b33a3e4647e9ce8d" class="t t">PSSetMemberBinder</a>.<a href="../runtime/Binding/Binders.cs.html#eafd84b96ec1230d" class="i method">Get</a>(<span class="r941 r">name</span>, <span class="r938 r">compiler</span>.<a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>, <a href="#636d42a34963f483" class="i property">MemberExpression</a>.<a href="ast.cs.html#b882770eb12defeb" class="i property">Static</a>),
                                            <b>typeof</b>(<b>object</b>),
                                            <a href="#1361f63647eff687" class="i property">CachedTarget</a> ?? <a href="#7d636a1bf21c7328" class="i method">GetTargetExpr</a>(<span class="r938 r">compiler</span>), <span class="r939 r">rhs</span>);
            }
 
            <b>return</b> <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                                        <a href="../runtime/Binding/Binders.cs.html#c09acad10da15de3" class="t t">PSSetDynamicMemberBinder</a>.<a href="../runtime/Binding/Binders.cs.html#a8cb678f50d1b667" class="i method">Get</a>(<span class="r938 r">compiler</span>.<a href="#b91585e4adf5dd44" class="i field">_memberFunctionType</a>, <a href="#636d42a34963f483" class="i property">MemberExpression</a>.<a href="ast.cs.html#b882770eb12defeb" class="i property">Static</a>),
                                        <b>typeof</b>(<b>object</b>),
                                        <a href="#1361f63647eff687" class="i property">CachedTarget</a> ?? <a href="#7d636a1bf21c7328" class="i method">GetTargetExpr</a>(<span class="r938 r">compiler</span>),
                                        <a href="#63a7772cbd50c3d9" class="i property">CachedPropertyExpr</a> ?? <a href="#7a8900ff557c09f8" class="i method">GetPropertyExpr</a>(<span class="r938 r">compiler</span>), <span class="r939 r">rhs</span>);
        }
    }
 
    <b>internal class</b> <a id="c96e9c2f430dee77" href="../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="251bcf4378d827cb">InvokeMemberAssignableValue</span></a> : <a href="ast.cs.html#41e026a3563ae47a" class="t t">IAssignableValue</a>
    {
        <b>internal</b> <a href="ast.cs.html#be11dcb1e53f56b8" class="t t">InvokeMemberExpressionAst</a> <a id="ec12079d65f74048" href="../../R/ec12079d65f74048.html" target="n" data-glyph="104,1" class="i property">InvokeMemberExpressionAst</a> { <b>get</b>; <b>set</b>; }
 
        <b>private</b> <span class="i">ParameterExpression</span> <a id="9d3bfb7e78ff65ce" href="../../R/9d3bfb7e78ff65ce.html" target="n" data-glyph="46,1" class="i field">_targetExprTemp</a>;
        <b>private</b> <span class="i">ParameterExpression</span> <a id="fe385fd97f8c38f6" href="../../R/fe385fd97f8c38f6.html" target="n" data-glyph="46,1" class="i field">_memberNameExprTemp</a>;
        <b>private</b> <span class="i">IEnumerable</span>&lt;<span class="i">ParameterExpression</span>&gt; <a id="b04f590d29abc216" href="../../R/b04f590d29abc216.html" target="n" data-glyph="46,1" class="i field">_argExprTemps</a>;
 
        <b>private</b> <span class="i">Expression</span> <a id="f766d3575e4cc71d" href="../../R/f766d3575e4cc71d.html" target="n" data-glyph="76,1" class="i method">GetTargetExpr</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r942 rd" class="r942 r">compiler</span>)
        {
            <b>return</b> <a href="#9d3bfb7e78ff65ce" class="i field">_targetExprTemp</a> ?? <span class="r942 r">compiler</span>.<a href="#5795855cf17e55b6" class="i method">Compile</a>(<a href="#ec12079d65f74048" class="i property">InvokeMemberExpressionAst</a>.<a href="ast.cs.html#22340c1f7f19ecba" class="i property">Expression</a>);
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="e72186199b032b50" href="../../R/e72186199b032b50.html" target="n" data-glyph="76,1" class="i method">GetMemberNameExpr</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r943 rd" class="r943 r">compiler</span>)
        {
            <b>return</b> <a href="#fe385fd97f8c38f6" class="i field">_memberNameExprTemp</a> ?? <span class="r943 r">compiler</span>.<a href="#5795855cf17e55b6" class="i method">Compile</a>(<a href="#ec12079d65f74048" class="i property">InvokeMemberExpressionAst</a>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a>);
        }
 
        <b>private</b> <span class="i">IEnumerable</span>&lt;<span class="i">Expression</span>&gt; <a id="f337fdc492afb76f" href="../../R/f337fdc492afb76f.html" target="n" data-glyph="76,1" class="i method">GetArgumentExprs</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r944 rd" class="r944 r">compiler</span>)
        {
            <b>if</b> (<a href="#b04f590d29abc216" class="i field">_argExprTemps</a> != <b>null</b>)
            {
                <b>return</b> <a href="#b04f590d29abc216" class="i field">_argExprTemps</a>;
            }
 
            <span class="i">ReadOnlyCollection</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r945 rd" class="r945 r">arguments</span> = <a href="#ec12079d65f74048" class="i property">InvokeMemberExpressionAst</a>.<a href="ast.cs.html#0f1554608efc28f3" class="i property">Arguments</a>;
 
            <b>if</b> (<span class="r945 r">arguments</span> <b>is null</b> || <span class="r945 r">arguments</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <span class="i">Array</span>.<span class="i">Empty</span>&lt;<span class="i">Expression</span>&gt;();
            }
 
            <b>var</b> <span id="r946 rd" class="r946 r">result</span> = <b>new</b> <span class="i">Expression</span>[<span class="r945 r">arguments</span>.<span class="i">Count</span>];
            <b>for</b> (<b>int</b> <span id="r947 rd" class="r947 r">i</span> = 0; <span class="r947 r">i</span> &lt; <span class="r946 r">result</span>.<span class="i">Length</span>; <span class="r947 r">i</span>++)
            {
                <span class="r946 r">result</span>[<span class="r947 r">i</span>] = <span class="r944 r">compiler</span>.<span class="i">Compile</span>(<span class="r945 r">arguments</span>[<span class="r947 r">i</span>]);
            }
 
            <b>return</b> <span class="r946 r">result</span>;
        }
 
        <b>public</b> <span class="i">Expression</span> <a id="b52c387697e52433" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetValue</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r948 rd" class="r948 r">compiler</span>, <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r949 rd" class="r949 r">exprs</span>, <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt; <span id="r950 rd" class="r950 r">temps</span>)
        {
            <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="k">var</a> <span id="r951 rd" class="r951 r">constraints</span> = <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#1bac37d06a9a447c" class="i method">GetInvokeMemberConstraints</a>(<a href="#ec12079d65f74048" class="i property">InvokeMemberExpressionAst</a>);
 
            <b>var</b> <span id="r952 rd" class="r952 r">targetExpr</span> = <a href="#f766d3575e4cc71d" class="i method">GetTargetExpr</a>(<span class="r948 r">compiler</span>);
            <a href="#9d3bfb7e78ff65ce" class="i field">_targetExprTemp</a> = <span class="i">Expression</span>.<span class="i">Variable</span>(<span class="r952 r">targetExpr</span>.<span class="i">Type</span>);
            <span class="r949 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#9d3bfb7e78ff65ce" class="i field">_targetExprTemp</a>, <span class="r952 r">targetExpr</span>));
            <b>int</b> <span id="r953 rd" class="r953 r">exprsIndex</span> = <span class="r949 r">exprs</span>.<span class="i">Count</span>;
 
            <b>var</b> <span id="r954 rd" class="r954 r">args</span> = <a href="#f337fdc492afb76f" class="i method">GetArgumentExprs</a>(<span class="r948 r">compiler</span>);
            <a href="#b04f590d29abc216" class="i field">_argExprTemps</a> = <span class="r954 r">args</span>.<span class="i">Select</span>(<b>static</b> <span id="r955 rd" class="r955 r">arg</span> =&gt; <span class="i">Expression</span>.<span class="i">Variable</span>(<span class="r955 r">arg</span>.<span class="i">Type</span>)).<span class="i">ToArray</span>();
            <span class="r949 r">exprs</span>.<span class="i">AddRange</span>(<span class="r954 r">args</span>.<span class="i">Zip</span>(<a href="#b04f590d29abc216" class="i field">_argExprTemps</a>, <b>static</b> (<span id="r956 rd" class="r956 r">arg</span>, <span id="r957 rd" class="r957 r">temp</span>) =&gt; <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r957 r">temp</span>, <span class="r956 r">arg</span>)));
 
            <span class="r950 r">temps</span>.<span class="i">Add</span>(<a href="#9d3bfb7e78ff65ce" class="i field">_targetExprTemp</a>);
            <b>int</b> <span id="r958 rd" class="r958 r">tempsIndex</span> = <span class="r950 r">temps</span>.<span class="i">Count</span>;
            <span class="r950 r">temps</span>.<span class="i">AddRange</span>(<a href="#b04f590d29abc216" class="i field">_argExprTemps</a>);
 
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r959 rd" class="r959 r">memberNameAst</span> = <a href="#ec12079d65f74048" class="i property">InvokeMemberExpressionAst</a>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a> <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
            <b>if</b> (<span class="r959 r">memberNameAst</span> != <b>null</b>)
            {
                <b>return</b> <span class="r948 r">compiler</span>.<span class="i">InvokeMember</span>(<span class="r959 r">memberNameAst</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <span class="r951 r">constraints</span>, <a href="#9d3bfb7e78ff65ce" class="i field">_targetExprTemp</a>, <a href="#b04f590d29abc216" class="i field">_argExprTemps</a>, <span class="i">@static</span>: <b>false</b>, <span class="i">propertySet</span>: <b>false</b>);
            }
 
            <b>var</b> <span id="r960 rd" class="r960 r">memberNameExpr</span> = <a href="#e72186199b032b50" class="i method">GetMemberNameExpr</a>(<span class="r948 r">compiler</span>);
            <a href="#fe385fd97f8c38f6" class="i field">_memberNameExprTemp</a> = <span class="i">Expression</span>.<span class="i">Variable</span>(<span class="r960 r">memberNameExpr</span>.<span class="i">Type</span>);
 
            <span class="r949 r">exprs</span>.<span class="i">Insert</span>(<span class="r953 r">exprsIndex</span>, <span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#fe385fd97f8c38f6" class="i field">_memberNameExprTemp</a>, <span class="r960 r">memberNameExpr</span>));
            <span class="r950 r">temps</span>.<span class="i">Insert</span>(<span class="r958 r">tempsIndex</span>, <a href="#fe385fd97f8c38f6" class="i field">_memberNameExprTemp</a>);
 
            <b>return</b> <span class="r948 r">compiler</span>.<span class="i">InvokeDynamicMember</span>(<a href="#fe385fd97f8c38f6" class="i field">_memberNameExprTemp</a>, <span class="r951 r">constraints</span>, <a href="#9d3bfb7e78ff65ce" class="i field">_targetExprTemp</a>, <a href="#b04f590d29abc216" class="i field">_argExprTemps</a>, <span class="i">@static</span>: <b>false</b>, <span class="i">propertySet</span>: <b>false</b>);
        }
 
        <b>public</b> <span class="i">Expression</span> <a id="30a3e1906ad5d3df" href="../../R/30a3e1906ad5d3df.html" target="n" data-glyph="72,1" class="i method">SetValue</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r961 rd" class="r961 r">compiler</span>, <span class="i">Expression</span> <span id="r962 rd" class="r962 r">rhs</span>)
        {
            <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="k">var</a> <span id="r963 rd" class="r963 r">constraints</span> = <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#1bac37d06a9a447c" class="i method">GetInvokeMemberConstraints</a>(<a href="#ec12079d65f74048" class="i property">InvokeMemberExpressionAst</a>);
 
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r964 rd" class="r964 r">memberNameAst</span> = <a href="#ec12079d65f74048" class="i property">InvokeMemberExpressionAst</a>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a> <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
            <b>var</b> <span id="r965 rd" class="r965 r">target</span> = <a href="#f766d3575e4cc71d" class="i method">GetTargetExpr</a>(<span class="r961 r">compiler</span>);
            <b>var</b> <span id="r966 rd" class="r966 r">args</span> = <a href="#f337fdc492afb76f" class="i method">GetArgumentExprs</a>(<span class="r961 r">compiler</span>);
            <b>if</b> (<span class="r964 r">memberNameAst</span> != <b>null</b>)
            {
                <b>return</b> <span class="r961 r">compiler</span>.<span class="i">InvokeMember</span>(<span class="r964 r">memberNameAst</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <span class="r963 r">constraints</span>, <span class="r965 r">target</span>, <span class="r966 r">args</span>.<span class="i">Append</span>(<span class="r962 r">rhs</span>), <span class="i">@static</span>: <b>false</b>, <span class="i">propertySet</span>: <b>true</b>);
            }
 
            <b>var</b> <span id="r967 rd" class="r967 r">memberNameExpr</span> = <a href="#e72186199b032b50" class="i method">GetMemberNameExpr</a>(<span class="r961 r">compiler</span>);
            <b>return</b> <span class="r961 r">compiler</span>.<span class="i">InvokeDynamicMember</span>(<span class="r967 r">memberNameExpr</span>, <span class="r963 r">constraints</span>, <span class="r965 r">target</span>, <span class="r966 r">args</span>.<span class="i">Append</span>(<span class="r962 r">rhs</span>), <span class="i">@static</span>: <b>false</b>, <span class="i">propertySet</span>: <b>true</b>);
        }
    }
 
    <b>internal class</b> <a id="afe83ed225635474" href="../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="28f88d1d854cbc23">IndexAssignableValue</span></a> : <a href="ast.cs.html#41e026a3563ae47a" class="t t">IAssignableValue</a>
    {
        <b>internal</b> <a href="ast.cs.html#4587e325068530ec" class="t t">IndexExpressionAst</a> <a id="b7bb4e8a058ec024" href="../../R/b7bb4e8a058ec024.html" target="n" data-glyph="104,1" class="i property">IndexExpressionAst</a> { <b>get</b>; <b>set</b>; }
 
        <b>private</b> <span class="i">ParameterExpression</span> <a id="921d846136d188a4" href="../../R/921d846136d188a4.html" target="n" data-glyph="46,1" class="i field">_targetExprTemp</a>;
        <b>private</b> <span class="i">ParameterExpression</span> <a id="8da078da1c83abeb" href="../../R/8da078da1c83abeb.html" target="n" data-glyph="46,1" class="i field">_indexExprTemp</a>;
 
        <b>private</b> <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="t t">PSMethodInvocationConstraints</a> <a id="696d727a46ba649e" href="../../R/696d727a46ba649e.html" target="n" data-glyph="76,1" class="i method">GetInvocationConstraints</a>()
        {
            <b>return</b> <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#bd18d1c8d492dde3" class="i method">CombineTypeConstraintForMethodResolution</a>(
                                <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#05c0f8960f453cab" class="i method">GetTypeConstraintForMethodResolution</a>(<a href="#b7bb4e8a058ec024" class="i property">IndexExpressionAst</a>.<a href="ast.cs.html#4340a50f115f7fdd" class="i property">Target</a>),
                                <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#05c0f8960f453cab" class="i method">GetTypeConstraintForMethodResolution</a>(<a href="#b7bb4e8a058ec024" class="i property">IndexExpressionAst</a>.<a href="ast.cs.html#2e5c6ad17318d78c" class="i property">Index</a>));
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="41e23a9c829b5ae2" href="../../R/41e23a9c829b5ae2.html" target="n" data-glyph="76,1" class="i method">GetTargetExpr</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r968 rd" class="r968 r">compiler</span>)
        {
            <b>return</b> <a href="#921d846136d188a4" class="i field">_targetExprTemp</a> ?? <span class="r968 r">compiler</span>.<a href="#5795855cf17e55b6" class="i method">Compile</a>(<a href="#b7bb4e8a058ec024" class="i property">IndexExpressionAst</a>.<a href="ast.cs.html#4340a50f115f7fdd" class="i property">Target</a>);
        }
 
        <b>private</b> <span class="i">Expression</span> <a id="c8908229cc01c8a7" href="../../R/c8908229cc01c8a7.html" target="n" data-glyph="76,1" class="i method">GetIndexExpr</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r969 rd" class="r969 r">compiler</span>)
        {
            <b>return</b> <a href="#8da078da1c83abeb" class="i field">_indexExprTemp</a> ?? <span class="r969 r">compiler</span>.<a href="#5795855cf17e55b6" class="i method">Compile</a>(<a href="#b7bb4e8a058ec024" class="i property">IndexExpressionAst</a>.<a href="ast.cs.html#2e5c6ad17318d78c" class="i property">Index</a>);
        }
 
        <b>public</b> <span class="i">Expression</span> <a id="9e0a92098dafab49" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetValue</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r970 rd" class="r970 r">compiler</span>, <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r971 rd" class="r971 r">exprs</span>, <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt; <span id="r972 rd" class="r972 r">temps</span>)
        {
            <b>var</b> <span id="r973 rd" class="r973 r">targetExpr</span> = <span class="r970 r">compiler</span>.<a href="#5795855cf17e55b6" class="i method">Compile</a>(<a href="#b7bb4e8a058ec024" class="i property">IndexExpressionAst</a>.<a href="ast.cs.html#4340a50f115f7fdd" class="i property">Target</a>);
            <a href="#921d846136d188a4" class="i field">_targetExprTemp</a> = <span class="i">Expression</span>.<span class="i">Variable</span>(<span class="r973 r">targetExpr</span>.<span class="i">Type</span>);
            <span class="r972 r">temps</span>.<span class="i">Add</span>(<a href="#921d846136d188a4" class="i field">_targetExprTemp</a>);
            <span class="r971 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#921d846136d188a4" class="i field">_targetExprTemp</a>, <span class="r973 r">targetExpr</span>));
 
            <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r974 rd" class="r974 r">index</span> = <a href="#b7bb4e8a058ec024" class="i property">IndexExpressionAst</a>.<a href="ast.cs.html#2e5c6ad17318d78c" class="i property">Index</a>;
            <a href="ast.cs.html#0e44bc9125134006" class="k">var</a> <span id="r975 rd" class="r975 r">arrayLiteral</span> = <span class="r974 r">index</span> <b>as</b> <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>;
            <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="k">var</a> <span id="r976 rd" class="r976 r">constraints</span> = <a href="#696d727a46ba649e" class="i method">GetInvocationConstraints</a>();
            <span class="i">Expression</span> <span id="r977 rd" class="r977 r">result</span>;
            <b>if</b> (<span class="r975 r">arrayLiteral</span> != <b>null</b>)
            {
                <span class="c">// If assignment to slices were allowed, we&#39;d need to save the elements in temps</span>
                <span class="c">// like we do when doing normal assignment (below).  But it&#39;s not allowed, so it</span>
                <span class="c">// doesn&#39;t matter.</span>
                <span class="r977 r">result</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#f5f4b5dd1e81524d" class="t t">PSGetIndexBinder</a>.<span class="i">Get</span>(<span class="r975 r">arrayLiteral</span>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">Count</span>, <span class="r976 r">constraints</span>),
                                                   <b>typeof</b>(<b>object</b>),
                                                   <span class="r975 r">arrayLiteral</span>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">Select</span>(<span class="r970 r">compiler</span>.<span class="i">Compile</span>).<span class="i">Prepend</span>(<a href="#921d846136d188a4" class="i field">_targetExprTemp</a>));
            }
            <b>else</b>
            {
                <b>var</b> <span id="r978 rd" class="r978 r">indexExpr</span> = <span class="r970 r">compiler</span>.<a href="#5795855cf17e55b6" class="i method">Compile</a>(<span class="r974 r">index</span>);
                <a href="#8da078da1c83abeb" class="i field">_indexExprTemp</a> = <span class="i">Expression</span>.<span class="i">Variable</span>(<span class="r978 r">indexExpr</span>.<span class="i">Type</span>);
                <span class="r972 r">temps</span>.<span class="i">Add</span>(<a href="#8da078da1c83abeb" class="i field">_indexExprTemp</a>);
                <span class="r971 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<a href="#8da078da1c83abeb" class="i field">_indexExprTemp</a>, <span class="r978 r">indexExpr</span>));
                <span class="r977 r">result</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#f5f4b5dd1e81524d" class="t t">PSGetIndexBinder</a>.<a href="../runtime/Binding/Binders.cs.html#b40e91138efa4156" class="i method">Get</a>(1, <span class="r976 r">constraints</span>), <b>typeof</b>(<b>object</b>), <a href="#921d846136d188a4" class="i field">_targetExprTemp</a>, <a href="#8da078da1c83abeb" class="i field">_indexExprTemp</a>);
            }
 
            <b>return</b> <span class="r977 r">result</span>;
        }
 
        <b>public</b> <span class="i">Expression</span> <a id="a33c32d8dc0988e2" href="../../R/a33c32d8dc0988e2.html" target="n" data-glyph="72,1" class="i method">SetValue</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r979 rd" class="r979 r">compiler</span>, <span class="i">Expression</span> <span id="r980 rd" class="r980 r">rhs</span>)
        {
            <span class="c">// Save the rhs for multi-assign, i.e. $x = $y[0] = 2</span>
            <span class="c">// This seems wrong though - the value $y[0] should be assigned to $x, not 2.</span>
            <span class="c">// It&#39;s not often they would be different values, but if a conversion is involved, they could</span>
            <span class="c">// be.  At any rate, V2 did it this way, so we do as well.</span>
            <b>var</b> <span id="r981 rd" class="r981 r">temp</span> = <span class="i">Expression</span>.<span class="i">Variable</span>(<span class="r980 r">rhs</span>.<span class="i">Type</span>);
 
            <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r982 rd" class="r982 r">index</span> = <a href="#b7bb4e8a058ec024" class="i property">IndexExpressionAst</a>.<a href="ast.cs.html#2e5c6ad17318d78c" class="i property">Index</a>;
            <a href="ast.cs.html#0e44bc9125134006" class="k">var</a> <span id="r983 rd" class="r983 r">arrayLiteral</span> = <span class="r982 r">index</span> <b>as</b> <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>;
            <a href="../MshMemberInfo.cs.html#27663bce603069bd" class="k">var</a> <span id="r984 rd" class="r984 r">constraints</span> = <a href="#696d727a46ba649e" class="i method">GetInvocationConstraints</a>();
            <b>var</b> <span id="r985 rd" class="r985 r">targetExpr</span> = <a href="#41e23a9c829b5ae2" class="i method">GetTargetExpr</a>(<span class="r979 r">compiler</span>);
            <span class="i">Expression</span> <span id="r986 rd" class="r986 r">setExpr</span>;
            <b>if</b> (<span class="r983 r">arrayLiteral</span> != <b>null</b>)
            {
                <span class="r986 r">setExpr</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                                                <a href="../runtime/Binding/Binders.cs.html#4efa6869376d725f" class="t t">PSSetIndexBinder</a>.<span class="i">Get</span>(<span class="r983 r">arrayLiteral</span>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">Count</span>, <span class="r984 r">constraints</span>),
                                                <b>typeof</b>(<b>object</b>),
                                                <span class="r983 r">arrayLiteral</span>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">Select</span>(<span class="r979 r">compiler</span>.<span class="i">Compile</span>).<span class="i">Prepend</span>(<span class="r985 r">targetExpr</span>).<span class="i">Append</span>(<span class="r981 r">temp</span>));
            }
            <b>else</b>
            {
                <span class="r986 r">setExpr</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(
                                                <a href="../runtime/Binding/Binders.cs.html#4efa6869376d725f" class="t t">PSSetIndexBinder</a>.<a href="../runtime/Binding/Binders.cs.html#f4014536e121a2b0" class="i method">Get</a>(1, <span class="r984 r">constraints</span>),
                                                <b>typeof</b>(<b>object</b>),
                                                <span class="r985 r">targetExpr</span>,
                                                <a href="#c8908229cc01c8a7" class="i method">GetIndexExpr</a>(<span class="r979 r">compiler</span>),
                                                <span class="r981 r">temp</span>);
            }
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<b>new</b>[] { <span class="r981 r">temp</span> }, <span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r981 r">temp</span>, <span class="r980 r">rhs</span>), <span class="r986 r">setExpr</span>, <span class="r981 r">temp</span>);
        }
    }
 
    <b>internal class</b> <a id="c1df55c84a14d399" href="../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="5563489540ee7bb8">ArrayAssignableValue</span></a> : <a href="ast.cs.html#41e026a3563ae47a" class="t t">IAssignableValue</a>
    {
        <b>internal</b> <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a> <a id="bc5abcb4f50e2342" href="../../R/bc5abcb4f50e2342.html" target="n" data-glyph="104,1" class="i property">ArrayLiteral</a> { <b>get</b>; <b>set</b>; }
 
        <b>public</b> <span class="i">Expression</span> <a id="388797c981cee2cf" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetValue</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r987 rd" class="r987 r">compiler</span>, <span class="i">List</span>&lt;<span class="i">Expression</span>&gt; <span id="r988 rd" class="r988 r">exprs</span>, <span class="i">List</span>&lt;<span class="i">ParameterExpression</span>&gt; <span id="r989 rd" class="r989 r">temps</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Array assignment does not support read/modify/write operators&quot;</span>);
            <b>return</b> <b>null</b>;
        }
 
        <b>public</b> <span class="i">Expression</span> <a id="a1261240d0d718fc" href="../../R/a1261240d0d718fc.html" target="n" data-glyph="72,1" class="i method">SetValue</a>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a> <span id="r990 rd" class="r990 r">compiler</span>, <span class="i">Expression</span> <span id="r991 rd" class="r991 r">rhs</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r991 r">rhs</span>.<span class="i">Type</span> == <b>typeof</b>(<span class="i">IList</span>), <span class="s">&quot;Code generation must ensure we have an IList to assign from.&quot;</span>);
            <b>var</b> <span id="r992 rd" class="r992 r">rhsTemp</span> = <span class="i">Expression</span>.<span class="i">Variable</span>(<span class="r991 r">rhs</span>.<span class="i">Type</span>);
 
            <b>int</b> <span id="r993 rd" class="r993 r">count</span> = <a href="#bc5abcb4f50e2342" class="i property">ArrayLiteral</a>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">Count</span>;
            <b>var</b> <span id="r994 rd" class="r994 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <span class="r994 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">Assign</span>(<span class="r992 r">rhsTemp</span>, <span class="r991 r">rhs</span>));
            <b>for</b> (<b>int</b> <span id="r995 rd" class="r995 r">i</span> = 0; <span class="r995 r">i</span> &lt; <span class="r993 r">count</span>; ++<span class="r995 r">i</span>)
            {
                <span class="i">Expression</span> <span id="r996 rd" class="r996 r">indexedRHS</span> = <span class="i">Expression</span>.<span class="i">Call</span>(<span class="r992 r">rhsTemp</span>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#92fbbf3266e95071" class="i field">IList_get_Item</a>, <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(<span class="r995 r">i</span>));
                <b>var</b> <span id="r997 rd" class="r997 r">lhsElement</span> = <a href="#bc5abcb4f50e2342" class="i property">ArrayLiteral</a>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>[<span class="r995 r">i</span>];
                <a href="ast.cs.html#0e44bc9125134006" class="k">var</a> <span id="r998 rd" class="r998 r">nestedArrayLHS</span> = <span class="r997 r">lhsElement</span> <b>as</b> <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>;
                <a href="ast.cs.html#a9797c05604b61e8" class="k">var</a> <span id="r999 rd" class="r999 r">parenExpressionAst</span> = <span class="r997 r">lhsElement</span> <b>as</b> <a href="ast.cs.html#a9797c05604b61e8" class="t t">ParenExpressionAst</a>;
                <b>if</b> (<span class="r999 r">parenExpressionAst</span> != <b>null</b>)
                {
                    <span class="r998 r">nestedArrayLHS</span> = <span class="r999 r">parenExpressionAst</span>.<a href="ast.cs.html#021e323175cb804d" class="i property">Pipeline</a>.<a href="ast.cs.html#158661f5f6c8db6d" class="i method">GetPureExpression</a>() <b>as</b> <a href="ast.cs.html#0e44bc9125134006" class="t t">ArrayLiteralAst</a>;
                }
 
                <b>if</b> (<span class="r998 r">nestedArrayLHS</span> != <b>null</b>)
                {
                    <span class="c">// Need to turn the rhs into an IList</span>
                    <span class="r996 r">indexedRHS</span> = <span class="i">DynamicExpression</span>.<span class="i">Dynamic</span>(<a href="../runtime/Binding/Binders.cs.html#de8eb85637e55a23" class="t t">PSArrayAssignmentRHSBinder</a>.<span class="i">Get</span>(<span class="r998 r">nestedArrayLHS</span>.<a href="ast.cs.html#1b2cdef74794d8b9" class="i property">Elements</a>.<span class="i">Count</span>), <b>typeof</b>(<span class="i">IList</span>), <span class="r996 r">indexedRHS</span>);
                }
 
                <span class="r994 r">exprs</span>.<span class="i">Add</span>(<span class="r990 r">compiler</span>.<a href="#e705d7767bd0f6e1" class="i method">ReduceAssignment</a>((<a href="ast.cs.html#1a23a5e08e419be9" class="t t">ISupportsAssignment</a>)<span class="r997 r">lhsElement</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d78e08594ff6b79a" class="i field">Equals</a>, <span class="r996 r">indexedRHS</span>));
            }
 
            <span class="c">// Add the temp as the last expression for chained assignment, i.e. $x = $y,$z = 1,2</span>
            <span class="r994 r">exprs</span>.<span class="i">Add</span>(<span class="r992 r">rhsTemp</span>);
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<b>new</b>[] { <span class="r992 r">rhsTemp</span> }, <span class="r994 r">exprs</span>);
        }
    }
 
    <b>internal class</b> <a id="0fe6cf831dd0d23e" href="../../R/0fe6cf831dd0d23e.html" target="n" data-glyph="2,0" class="t t">PowerShellLoopExpression</a> : <span class="i">Expression</span>, <span class="i n">Interpreter</span>.<a href="../interpreter/Instruction.cs.html#44a3c60caeaca4e2" class="t t">IInstructionProvider</a>
    {
        <b>public override bool</b> <a id="0cf76223edf917ba" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">CanReduce</a> { <b>get</b> { <b>return</b> <b>true</b>; } }
 
        <b>public override</b> <span class="i">Type</span> <a id="08ec15cdded278fb" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Type</a> { <b>get</b> { <b>return</b> <b>typeof</b>(<b>void</b>); } }
 
        <b>public override</b> <span class="i">ExpressionType</span> <a id="d6d8d90db752c60c" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">NodeType</a> { <b>get</b> { <b>return</b> <span class="i">ExpressionType</span>.<span class="i">Extension</span>; } }
 
        <b>private readonly</b> <span class="i">IEnumerable</span>&lt;<span class="i">Expression</span>&gt; <a id="d2ecc9958dd5b683" href="../../R/d2ecc9958dd5b683.html" target="n" data-glyph="46,1" class="i field">_exprs</a>;
 
        <b>internal</b> <a id="22ae1f151f4ee81f" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="t constructor">PowerShellLoopExpression</a>(<span class="i">IEnumerable</span>&lt;<span class="i">Expression</span>&gt; <span id="r1000 rd" class="r1000 r">exprs</span>)
        {
            <a href="#d2ecc9958dd5b683" class="i field">_exprs</a> = <span class="r1000 r">exprs</span>;
        }
 
        <b>public override</b> <span class="i">Expression</span> <a id="0a71a9b77fc2a479" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Reduce</a>()
        {
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<a href="#d2ecc9958dd5b683" class="i field">_exprs</a>);
        }
 
        <b>public void</b> <a id="5082a9264bc92520" href="../../R/5082a9264bc92520.html" target="n" data-glyph="72,1" class="i method">AddInstructions</a>(<a href="../interpreter/LightCompiler.cs.html#bee3a40ad9cb3a51" class="t t">LightCompiler</a> <span id="r1001 rd" class="r1001 r">compiler</span>)
        {
            <a href="../interpreter/ControlFlowInstructions.cs.html#0f90d2d9a80cea70" class="t t">EnterLoopInstruction</a> <span id="r1002 rd" class="r1002 r">enterLoop</span> = <b>null</b>;
 
            <span class="r1001 r">compiler</span>.<a href="../interpreter/LightCompiler.cs.html#119a2de7d43af550" class="i method">PushLabelBlock</a>(<a href="../interpreter/LabelInfo.cs.html#afb555aa7e7afb57" class="t t">LabelScopeKind</a>.<a href="../interpreter/LabelInfo.cs.html#e28f597c40679df5" class="i field">Statement</a>);
 
            <span class="c">// emit loop body:</span>
            <b>foreach</b> (<b>var</b> <span id="r1003 rd" class="r1003 r">expr</span> <b>in</b> <a href="#d2ecc9958dd5b683" class="i field">_exprs</a>)
            {
                <span class="r1001 r">compiler</span>.<span class="i">CompileAsVoid</span>(<span class="r1003 r">expr</span>);
                <a href="#391edada7945f19a" class="k">var</a> <span id="r1004 rd" class="r1004 r">enterLoopExpression</span> = <span class="r1003 r">expr</span> <b>as</b> <a href="#391edada7945f19a" class="t t">EnterLoopExpression</a>;
                <b>if</b> (<span class="r1004 r">enterLoopExpression</span> != <b>null</b>)
                {
                    <span class="r1002 r">enterLoop</span> = <span class="r1004 r">enterLoopExpression</span>.<a href="#a7d878cc4c2fee5e" class="i property">EnterLoopInstruction</a>;
                }
            }
 
            <span class="r1001 r">compiler</span>.<a href="../interpreter/LightCompiler.cs.html#2063b4bb64f206cb" class="i method">PopLabelBlock</a>(<a href="../interpreter/LabelInfo.cs.html#afb555aa7e7afb57" class="t t">LabelScopeKind</a>.<a href="../interpreter/LabelInfo.cs.html#e28f597c40679df5" class="i field">Statement</a>);
 
            <span class="c">// If enterLoop is null, we will never JIT compile the loop.</span>
            <b>if</b> (<span class="r1002 r">enterLoop</span> != <b>null</b>)
            {
                <span class="r1002 r">enterLoop</span>.<a href="../interpreter/ControlFlowInstructions.cs.html#42cff5ed5341fa7a" class="i method">FinishLoop</a>(<span class="r1001 r">compiler</span>.<a href="../interpreter/LightCompiler.cs.html#ee17248c84b78fba" class="i property">Instructions</a>.<a href="../interpreter/InstructionList.cs.html#24931d1c75ab071c" class="i property">Count</a>);
            }
        }
    }
 
    <b>internal class</b> <a id="391edada7945f19a" href="../../R/391edada7945f19a.html" target="n" data-glyph="2,0" class="t t"><span id="3b33c81267fa7111">EnterLoopExpression</span></a> : <span class="i">Expression</span>, <span class="i n">Interpreter</span>.<a href="../interpreter/Instruction.cs.html#44a3c60caeaca4e2" class="t t">IInstructionProvider</a>
    {
        <b>public override bool</b> <a id="a5b0d78d09dab98a" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">CanReduce</a> { <b>get</b> { <b>return</b> <b>true</b>; } }
 
        <b>public override</b> <span class="i">Type</span> <a id="8ca39e58c33f5e1c" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Type</a> { <b>get</b> { <b>return</b> <b>typeof</b>(<b>void</b>); } }
 
        <b>public override</b> <span class="i">ExpressionType</span> <a id="aae8982f57c77914" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">NodeType</a> { <b>get</b> { <b>return</b> <span class="i">ExpressionType</span>.<span class="i">Extension</span>; } }
 
        <b>public override</b> <span class="i">Expression</span> <a id="84c6f0a431956dca" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Reduce</a>()
        {
            <b>return</b> <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>;
        }
 
        <b>internal</b> <b>new</b> <a href="#0fe6cf831dd0d23e" class="t t">PowerShellLoopExpression</a> <a id="e884d35aa76358e8" href="../../R/e884d35aa76358e8.html" target="n" data-glyph="104,1" class="i property">Loop</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal</b> <a href="../interpreter/ControlFlowInstructions.cs.html#0f90d2d9a80cea70" class="t t">EnterLoopInstruction</a> <a id="a7d878cc4c2fee5e" href="../../R/a7d878cc4c2fee5e.html" target="n" data-glyph="104,1" class="i property">EnterLoopInstruction</a> { <b>get</b>; <b>private set</b>; }
 
        <b>internal int</b> <a id="4edf44af0199a839" href="../../R/4edf44af0199a839.html" target="n" data-glyph="104,1" class="i property">LoopStatementCount</a> { <b>get</b>; <b>set</b>; }
 
        <b>public void</b> <a id="fe9c2b65278e0922" href="../../R/fe9c2b65278e0922.html" target="n" data-glyph="72,1" class="i method">AddInstructions</a>(<a href="../interpreter/LightCompiler.cs.html#bee3a40ad9cb3a51" class="t t">LightCompiler</a> <span id="r1005 rd" class="r1005 r">compiler</span>)
        {
            <span class="c">// The EnterLoopInstruction is the instruction the interpreter uses to track the number of iterations a loop</span>
            <span class="c">// has executed and the instruction that kicks of the background compilation.</span>
            <span class="c">// If the statement count is too high, JIT takes too much time/resources to compile, so</span>
            <span class="c">// we just skip it.  By not emitting a EnterLoopInstruction, we&#39;ll never attempt to JIT the loop body.</span>
            <b>if</b> (<a href="#4edf44af0199a839" class="i property">LoopStatementCount</a> &lt; 300)
            {
                <span class="c">// Start compilation after 16 iterations of the loop.</span>
                <a href="#a7d878cc4c2fee5e" class="i property">EnterLoopInstruction</a> = <b>new</b> <a href="../interpreter/ControlFlowInstructions.cs.html#14b4778c9b8316fb" class="t constructor">EnterLoopInstruction</a>(<a href="#e884d35aa76358e8" class="i property">Loop</a>, <span class="r1005 r">compiler</span>.<a href="../interpreter/LightCompiler.cs.html#6bf1d8730c4bbd8c" class="i property">Locals</a>, 16, <span class="r1005 r">compiler</span>.<a href="../interpreter/LightCompiler.cs.html#ee17248c84b78fba" class="i property">Instructions</a>.<a href="../interpreter/InstructionList.cs.html#24931d1c75ab071c" class="i property">Count</a>);
                <span class="r1005 r">compiler</span>.<a href="../interpreter/LightCompiler.cs.html#ee17248c84b78fba" class="i property">Instructions</a>.<a href="../interpreter/InstructionList.cs.html#0b00ded9c3d1e7c5" class="i method">Emit</a>(<a href="#a7d878cc4c2fee5e" class="i property">EnterLoopInstruction</a>);
            }
        }
    }
 
    <b>internal class</b> <a id="10e982817be6c5a9" href="../../R/10e982817be6c5a9.html" target="n" data-glyph="2,0" class="t t">UpdatePositionExpr</a> : <span class="i">Expression</span>, <span class="i n">Interpreter</span>.<a href="../interpreter/Instruction.cs.html#44a3c60caeaca4e2" class="t t">IInstructionProvider</a>
    {
        <b>public override bool</b> <a id="1ee20f8e77ee93bf" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">CanReduce</a> { <b>get</b> { <b>return</b> <b>true</b>; } }
 
        <b>public override</b> <span class="i">Type</span> <a id="3da2d5b9c29d6b7d" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Type</a> { <b>get</b> { <b>return</b> <b>typeof</b>(<b>void</b>); } }
 
        <b>public override</b> <span class="i">ExpressionType</span> <a id="519e6aaf2a997f30" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">NodeType</a> { <b>get</b> { <b>return</b> <span class="i">ExpressionType</span>.<span class="i">Extension</span>; } }
 
        <b>private readonly</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="0e5276dd91b9d6dc" href="../../R/0e5276dd91b9d6dc.html" target="n" data-glyph="46,1" class="i field">_extent</a>;
        <b>private readonly</b> <span class="i">SymbolDocumentInfo</span> <a id="93604a9628ced1ca" href="../../R/93604a9628ced1ca.html" target="n" data-glyph="46,1" class="i field">_debugSymbolDocument</a>;
        <b>private readonly int</b> <a id="463591c7c551b2c6" href="../../R/463591c7c551b2c6.html" target="n" data-glyph="46,1" class="i field">_sequencePoint</a>;
        <b>private readonly bool</b> <a id="e78d9a2cc530efef" href="../../R/e78d9a2cc530efef.html" target="n" data-glyph="46,1" class="i field">_checkBreakpoints</a>;
 
        <b>public</b> <a id="0c9779f3c88dad20" href="../../R/0c9779f3c88dad20.html" target="n" data-glyph="72,1" class="t constructor">UpdatePositionExpr</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r1006 rd" class="r1006 r">extent</span>, <b>int</b> <span id="r1007 rd" class="r1007 r">sequencePoint</span>, <span class="i">SymbolDocumentInfo</span> <span id="r1008 rd" class="r1008 r">debugSymbolDocument</span>, <b>bool</b> <span id="r239 rd" class="r239 r">checkBreakpoints</span>)
        {
            <a href="#0e5276dd91b9d6dc" class="i field">_extent</a> = <span class="r1006 r">extent</span>;
            <a href="#e78d9a2cc530efef" class="i field">_checkBreakpoints</a> = <span class="r239 r">checkBreakpoints</span>;
            <a href="#93604a9628ced1ca" class="i field">_debugSymbolDocument</a> = <span class="r1008 r">debugSymbolDocument</span>;
            <a href="#463591c7c551b2c6" class="i field">_sequencePoint</a> = <span class="r1007 r">sequencePoint</span>;
        }
 
        <b>public override</b> <span class="i">Expression</span> <a id="64e27c3b3b855fd0" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Reduce</a>()
        {
            <b>var</b> <span id="r1009 rd" class="r1009 r">exprs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">Expression</span>&gt;();
            <b>if</b> (<a href="#93604a9628ced1ca" class="i field">_debugSymbolDocument</a> != <b>null</b>)
            {
                <span class="r1009 r">exprs</span>.<span class="i">Add</span>(<span class="i">Expression</span>.<span class="i">DebugInfo</span>(<a href="#93604a9628ced1ca" class="i field">_debugSymbolDocument</a>, <a href="#0e5276dd91b9d6dc" class="i field">_extent</a>.<a href="Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a>, <a href="#0e5276dd91b9d6dc" class="i field">_extent</a>.<a href="Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>, <a href="#0e5276dd91b9d6dc" class="i field">_extent</a>.<a href="Position.cs.html#ccd649a5269e237d" class="i property">EndLineNumber</a>, <a href="#0e5276dd91b9d6dc" class="i field">_extent</a>.<a href="Position.cs.html#155675f601d14734" class="i property">EndColumnNumber</a>));
            }
 
            <span class="r1009 r">exprs</span>.<span class="i">Add</span>(
                <span class="i">Expression</span>.<span class="i">Assign</span>(
                    <span class="i">Expression</span>.<span class="i">Field</span>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#484f998e9ae6f79f" class="i field">FunctionContext__currentSequencePointIndex</a>),
                    <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(<a href="#463591c7c551b2c6" class="i field">_sequencePoint</a>)));
 
            <b>if</b> (<a href="#e78d9a2cc530efef" class="i field">_checkBreakpoints</a>)
            {
                <span class="r1009 r">exprs</span>.<span class="i">Add</span>(
                    <span class="i">Expression</span>.<span class="i">IfThen</span>(
                        <span class="i">Expression</span>.<span class="i">GreaterThan</span>(
                            <span class="i">Expression</span>.<span class="i">Field</span>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#6e2f6824a0f390d1" class="i field">ExecutionContext_DebuggingMode</a>),
                            <a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#9f6df0bb7efa2829" class="i method">Constant</a>(0)),
                        <span class="i">Expression</span>.<span class="i">Call</span>(
                            <span class="i">Expression</span>.<span class="i">Field</span>(<a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#19a26e33d480616b" class="i field">s_executionContextParameter</a>, <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#de19a3cfacfdbca9" class="i field">ExecutionContext_Debugger</a>),
                            <a href="#7281bb41069e8d62" class="t t">CachedReflectionInfo</a>.<a href="#a62ef515b21207df" class="i field">Debugger_OnSequencePointHit</a>,
                            <a href="#8bdfc042f41c96c5" class="t t">Compiler</a>.<a href="#a155db4f24ac5d42" class="i field">s_functionContext</a>)));
            }
 
            <span class="r1009 r">exprs</span>.<span class="i">Add</span>(<a href="#38ca030cfcd33569" class="t t">ExpressionCache</a>.<a href="#8c8caf15be3b9240" class="i field">Empty</a>);
 
            <b>return</b> <span class="i">Expression</span>.<span class="i">Block</span>(<span class="r1009 r">exprs</span>);
        }
 
        <b>public void</b> <a id="b4dadb2b6d54a295" href="../../R/b4dadb2b6d54a295.html" target="n" data-glyph="72,1" class="i method">AddInstructions</a>(<a href="../interpreter/LightCompiler.cs.html#bee3a40ad9cb3a51" class="t t">LightCompiler</a> <span id="r1010 rd" class="r1010 r">compiler</span>)
        {
            <span class="r1010 r">compiler</span>.<a href="../interpreter/LightCompiler.cs.html#ee17248c84b78fba" class="i property">Instructions</a>.<a href="../interpreter/InstructionList.cs.html#0b00ded9c3d1e7c5" class="i method">Emit</a>(<a href="../interpreter/PowerShellInstructions.cs.html#a76a3aabb38ed98b" class="t t">UpdatePositionInstruction</a>.<a href="../interpreter/PowerShellInstructions.cs.html#fc65de37cab42cb6" class="i method">Create</a>(<a href="#463591c7c551b2c6" class="i field">_sequencePoint</a>, <a href="#e78d9a2cc530efef" class="i field">_checkBreakpoints</a>));
        }
    }
}
</pre></td></tr></table></div></body></html>
