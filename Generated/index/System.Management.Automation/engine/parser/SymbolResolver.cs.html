<!DOCTYPE html>
<html><head><title>SymbolResolver.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(767);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/parser/SymbolResolver.cs" target="_top">engine\parser\SymbolResolver.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>.<span class="i">Expressions</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
 
<b>using</b> <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">Commands</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>
{
    <b>internal enum</b> <a id="cb138e30acb53b66" href="../../R/cb138e30acb53b66.html" target="n" data-glyph="20,0" class="t t"><span id="40cb2454efa95966">ScopeType</span></a>
    {
        <a id="a216d1255d8e6143" href="../../R/a216d1255d8e6143.html" target="n" data-glyph="24,1" class="i field">Type</a>,           <span class="c">// class or enum</span>
        <a id="908a98a97f6319fc" href="../../R/908a98a97f6319fc.html" target="n" data-glyph="24,1" class="i field">Method</a>,         <span class="c">// class method</span>
        <a id="bc9af434f6caf6c1" href="../../R/bc9af434f6caf6c1.html" target="n" data-glyph="24,1" class="i field">Function</a>,       <span class="c">// function</span>
        <a id="5a3a47019b5e7f02" href="../../R/5a3a47019b5e7f02.html" target="n" data-glyph="24,1" class="i field">ScriptBlock</a>     <span class="c">// script or anonymous script block</span>
    }
 
    <b>internal class</b> <a id="9aadf41346ae58b0" href="../../R/9aadf41346ae58b0.html" target="n" data-glyph="2,0" class="t t">TypeLookupResult</a>
    {
        <b>public</b> <a id="32aaef674b187f42" href="../../R/32aaef674b187f42.html" target="n" data-glyph="72,1" class="t constructor">TypeLookupResult</a>(<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r0 rd" class="r0 r">type</span> = <b>null</b>)
        {
            <a href="#ccec929682fe12fa" class="i property">Type</a> = <span class="r0 r">type</span>;
        }
 
        <b>public</b> <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <a id="ccec929682fe12fa" href="../../R/ccec929682fe12fa.html" target="n" data-glyph="102,1" class="i property">Type</a> { <b>get</b>; <b>set</b>; }
 
        <b>public</b> <span class="i">List</span>&lt;<b>string</b>&gt; <a id="04d22a012ddf4ad3" href="../../R/04d22a012ddf4ad3.html" target="n" data-glyph="102,1" class="i property">ExternalNamespaces</a> { <b>get</b>; <b>set</b>; }
 
        <b>public bool</b> <a id="fff91371050b2e0d" href="../../R/fff91371050b2e0d.html" target="n" data-glyph="72,1" class="i method">IsAmbiguous</a>()
        {
            <b>return</b> (<a href="#04d22a012ddf4ad3" class="i property">ExternalNamespaces</a> != <b>null</b> &amp;&amp; <a href="#04d22a012ddf4ad3" class="i property">ExternalNamespaces</a>.<span class="i">Count</span> &gt; 1);
        }
    }
 
    <b>internal class</b> <a id="d4b54002a3e61c59" href="../../R/d4b54002a3e61c59.html" target="n" data-glyph="2,0" class="t t">Scope</a>
    {
        <b>internal</b> <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <a id="7b7192f3d549060f" href="../../R/7b7192f3d549060f.html" target="n" data-glyph="44,1" class="i field">_ast</a>;
        <b>internal</b> <a href="#cb138e30acb53b66" class="t t">ScopeType</a> <a id="e0f0b009fb03ea48" href="../../R/e0f0b009fb03ea48.html" target="n" data-glyph="44,1" class="i field">_scopeType</a>;
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> TypeTable maps namespace (currently it&#39;s module name) to the types under this namespace.</span>
        <span class="c">///</span><span class="c"> For the types defined in the current namespace (module) we use CURRENT_NAMESPACE as a namespace.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#9aadf41346ae58b0" class="t t">TypeLookupResult</a>&gt; <a id="e9f721c9584ba66d" href="../../R/e9f721c9584ba66d.html" target="n" data-glyph="46,1" class="i field">_typeTable</a>;
        <b>private readonly</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <a id="69f03aee7a81da45" href="../../R/69f03aee7a81da45.html" target="n" data-glyph="46,1" class="i field">_variableTable</a>;
 
        <b>internal</b> <a id="be88eb8661ea5ff9" href="../../R/be88eb8661ea5ff9.html" target="n" data-glyph="74,1" class="t constructor">Scope</a>(<a href="ast.cs.html#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a> <span id="r1 rd" class="r1 r">ast</span>, <a href="#cb138e30acb53b66" class="t t">ScopeType</a> <span id="r2 rd" class="r2 r">scopeType</span>)
        {
            <a href="#7b7192f3d549060f" class="i field">_ast</a> = (<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>)<span class="r1 r">ast</span>;
            <a href="#e0f0b009fb03ea48" class="i field">_scopeType</a> = <span class="r2 r">scopeType</span>;
            <a href="#e9f721c9584ba66d" class="i field">_typeTable</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#9aadf41346ae58b0" class="t t">TypeLookupResult</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#69f03aee7a81da45" class="i field">_variableTable</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
        }
 
        <b>internal</b> <a id="7f62f2bd0a27d15e" href="../../R/7f62f2bd0a27d15e.html" target="n" data-glyph="74,1" class="t constructor">Scope</a>(<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r3 rd" class="r3 r">typeDefinition</span>)
        {
            <a href="#7b7192f3d549060f" class="i field">_ast</a> = <span class="r3 r">typeDefinition</span>;
            <a href="#e0f0b009fb03ea48" class="i field">_scopeType</a> = <a href="#cb138e30acb53b66" class="t t">ScopeType</a>.<a href="#a216d1255d8e6143" class="i field">Type</a>;
            <a href="#e9f721c9584ba66d" class="i field">_typeTable</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="#9aadf41346ae58b0" class="t t">TypeLookupResult</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <a href="#69f03aee7a81da45" class="i field">_variableTable</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="i">StringComparer</span>.<span class="i">OrdinalIgnoreCase</span>);
            <b>foreach</b> (<b>var</b> <span id="r4 rd" class="r4 r">member</span> <b>in</b> <span class="r3 r">typeDefinition</span>.<a href="ast.cs.html#9f439131b4d83a32" class="i property">Members</a>)
            {
                <a href="ast.cs.html#88ad8abafd061e97" class="k">var</a> <span id="r5 rd" class="r5 r">propertyMember</span> = <span class="r4 r">member</span> <b>as</b> <a href="ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a>;
                <b>if</b> (<span class="r5 r">propertyMember</span> != <b>null</b>)
                {
                    <span class="c">// Duplicate members are an error, but we catch that later after all types</span>
                    <span class="c">// have been resolved.  We could report errors for properties here, but</span>
                    <span class="c">// we couldn&#39;t compare methods because overloads can&#39;t be compared until types</span>
                    <span class="c">// are resolved.</span>
                    <b>if</b> (!<a href="#69f03aee7a81da45" class="i field">_variableTable</a>.<span class="i">ContainsKey</span>(<span class="r5 r">propertyMember</span>.<a href="ast.cs.html#d93cd0c92947c0b5" class="i property">Name</a>))
                    {
                        <a href="#69f03aee7a81da45" class="i field">_variableTable</a>.<span class="i">Add</span>(<span class="r5 r">propertyMember</span>.<a href="ast.cs.html#d93cd0c92947c0b5" class="i property">Name</a>, <span class="r5 r">propertyMember</span>);
                    }
                }
            }
        }
 
        <b>internal void</b> <a id="6df3d87a723e2454" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">AddType</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r6 rd" class="r6 r">parser</span>, <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r7 rd" class="r7 r">typeDefinitionAst</span>)
        {
            <a href="#9aadf41346ae58b0" class="t t">TypeLookupResult</a> <span id="r8 rd" class="r8 r">result</span>;
            <b>if</b> (<a href="#e9f721c9584ba66d" class="i field">_typeTable</a>.<span class="i">TryGetValue</span>(<span class="r7 r">typeDefinitionAst</span>.<a href="ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>, <b>out</b> <span class="r8 r">result</span>))
            {
                <b>if</b> (<span class="r8 r">result</span>.<a href="#04d22a012ddf4ad3" class="i property">ExternalNamespaces</a> != <b>null</b>)
                {
                    <span class="c">// override external type by the type defined in the current namespace</span>
                    <span class="r8 r">result</span>.<a href="#04d22a012ddf4ad3" class="i property">ExternalNamespaces</a> = <b>null</b>;
                    <span class="r8 r">result</span>.<a href="#ccec929682fe12fa" class="i property">Type</a> = <span class="r7 r">typeDefinitionAst</span>;
                }
                <b>else</b>
                {
                    <span class="r6 r">parser</span>.<span class="i">ReportError</span>(<span class="r7 r">typeDefinitionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MemberAlreadyDefined</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MemberAlreadyDefined</span>,
                        <span class="r7 r">typeDefinitionAst</span>.<a href="ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>);
                }
            }
            <b>else</b>
            {
                <a href="#e9f721c9584ba66d" class="i field">_typeTable</a>.<span class="i">Add</span>(<span class="r7 r">typeDefinitionAst</span>.<a href="ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>, <b>new</b> <a href="#32aaef674b187f42" class="t constructor">TypeLookupResult</a>(<span class="r7 r">typeDefinitionAst</span>));
            }
        }
 
        <b>internal void</b> <a id="afa4160fe969f40f" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">AddTypeFromUsingModule</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r9 rd" class="r9 r">parser</span>, <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r10 rd" class="r10 r">typeDefinitionAst</span>, <a href="../Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r11 rd" class="r11 r">moduleInfo</span>)
        {
            <a href="#9aadf41346ae58b0" class="t t">TypeLookupResult</a> <span id="r12 rd" class="r12 r">result</span>;
            <b>if</b> (<a href="#e9f721c9584ba66d" class="i field">_typeTable</a>.<span class="i">TryGetValue</span>(<span class="r10 r">typeDefinitionAst</span>.<a href="ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>, <b>out</b> <span class="r12 r">result</span>))
            {
                <b>if</b> (<span class="r12 r">result</span>.<a href="#04d22a012ddf4ad3" class="i property">ExternalNamespaces</a> != <b>null</b>)
                {
                    <span class="c">// override external type by the type defined in the current namespace</span>
                    <span class="r12 r">result</span>.<a href="#04d22a012ddf4ad3" class="i property">ExternalNamespaces</a>.<span class="i">Add</span>(<span class="r11 r">moduleInfo</span>.<a href="../Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>);
                }
            }
            <b>else</b>
            {
                <a href="#9aadf41346ae58b0" class="k">var</a> <span id="r13 rd" class="r13 r">newLookupEntry</span> = <b>new</b> <a href="#32aaef674b187f42" class="t constructor">TypeLookupResult</a>(<span class="r10 r">typeDefinitionAst</span>)
                {
                    <a href="#04d22a012ddf4ad3" class="i property">ExternalNamespaces</a> = <b>new</b> <span class="i">List</span>&lt;<b>string</b>&gt;()
                };
                <span class="r13 r">newLookupEntry</span>.<a href="#04d22a012ddf4ad3" class="i property">ExternalNamespaces</a>.<span class="i">Add</span>(<span class="r11 r">moduleInfo</span>.<a href="../Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>);
                <a href="#e9f721c9584ba66d" class="i field">_typeTable</a>.<span class="i">Add</span>(<span class="r10 r">typeDefinitionAst</span>.<a href="ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>, <span class="r13 r">newLookupEntry</span>);
            }
 
            <b>string</b> <span id="r14 rd" class="r14 r">fullName</span> = <a href="#2121410b8db29d18" class="t t">SymbolResolver</a>.<a href="#23a04f4e5d5ccf22" class="i method">GetModuleQualifiedName</a>(<span class="r11 r">moduleInfo</span>.<a href="../Modules/PSModuleInfo.cs.html#19beded88c944eb9" class="i property">Name</a>, <span class="r10 r">typeDefinitionAst</span>.<a href="ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>);
            <b>if</b> (<a href="#e9f721c9584ba66d" class="i field">_typeTable</a>.<span class="i">TryGetValue</span>(<span class="r14 r">fullName</span>, <b>out</b> <span class="r12 r">result</span>))
            {
                <span class="r9 r">parser</span>.<span class="i">ReportError</span>(<span class="r10 r">typeDefinitionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MemberAlreadyDefined</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MemberAlreadyDefined</span>,
                    <span class="r14 r">fullName</span>);
            }
            <b>else</b>
            {
                <a href="#e9f721c9584ba66d" class="i field">_typeTable</a>.<span class="i">Add</span>(<span class="r14 r">fullName</span>, <b>new</b> <a href="#32aaef674b187f42" class="t constructor">TypeLookupResult</a>(<span class="r10 r">typeDefinitionAst</span>));
            }
        }
 
        <b>internal</b> <a href="#9aadf41346ae58b0" class="t t">TypeLookupResult</a> <a id="594976457caf6a62" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">LookupType</a>(<a href="ast.cs.html#83b43c1855a09e15" class="t t">TypeName</a> <span id="r15 rd" class="r15 r">typeName</span>)
        {
            <b>if</b> (<span class="r15 r">typeName</span>.<a href="ast.cs.html#e32629caa327873e" class="i property">AssemblyName</a> != <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="#9aadf41346ae58b0" class="t t">TypeLookupResult</a> <span id="r16 rd" class="r16 r">typeLookupResult</span>;
            <a href="#e9f721c9584ba66d" class="i field">_typeTable</a>.<span class="i">TryGetValue</span>(<span class="r15 r">typeName</span>.<a href="ast.cs.html#a9592c89dfa9c9ad" class="i property">Name</a>, <b>out</b> <span class="r16 r">typeLookupResult</span>);
            <b>return</b> <span class="r16 r">typeLookupResult</span>;
        }
 
        <b>public</b> <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <a id="6fbf52dda9f931ce" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">LookupVariable</a>(<a href="../VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r17 rd" class="r17 r">variablePath</span>)
        {
            <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r18 rd" class="r18 r">variabledefinition</span>;
            <a href="#69f03aee7a81da45" class="i field">_variableTable</a>.<span class="i">TryGetValue</span>(<span class="r17 r">variablePath</span>.<a href="../VariablePath.cs.html#45529674e4735f30" class="i property">UserPath</a>, <b>out</b> <span class="r18 r">variabledefinition</span>);
            <b>return</b> <span class="r18 r">variabledefinition</span>;
        }
    }
 
    <b>internal class</b> <a id="695cfbbdc0585501" href="../../R/695cfbbdc0585501.html" target="n" data-glyph="2,0" class="t t">SymbolTable</a>
    {
        <b>internal readonly</b> <span class="i">List</span>&lt;<a href="#d4b54002a3e61c59" class="t t">Scope</a>&gt; <a id="939bf31e2510e170" href="../../R/939bf31e2510e170.html" target="n" data-glyph="44,1" class="i field">_scopes</a>;
        <b>internal readonly</b> <a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <a id="ad3ce8750167c6d4" href="../../R/ad3ce8750167c6d4.html" target="n" data-glyph="44,1" class="i field">_parser</a>;
 
        <b>internal</b> <a id="eb3f97950f10fc6f" href="../../R/eb3f97950f10fc6f.html" target="n" data-glyph="74,1" class="t constructor">SymbolTable</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r19 rd" class="r19 r">parser</span>)
        {
            <a href="#939bf31e2510e170" class="i field">_scopes</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#d4b54002a3e61c59" class="t t">Scope</a>&gt;();
            <a href="#ad3ce8750167c6d4" class="i field">_parser</a> = <span class="r19 r">parser</span>;
        }
 
        <b>internal void</b> <a id="fc8b0762edc3d8d6" href="../../R/fc8b0762edc3d8d6.html" target="n" data-glyph="74,1" class="i method">AddTypesInScope</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r20 rd" class="r20 r">ast</span>)
        {
            <span class="c">// On entering a scope, we first add all the types defined in this scope (but not any nested scopes)</span>
            <span class="c">// This way, we can support types that refer to each other, e.g.</span>
            <span class="c">//     class C1 { [C2]$x }</span>
            <span class="c">//     class C2 { [C1]$c1 }</span>
 
            <b>var</b> <span id="r21 rd" class="r21 r">types</span> = <span class="r20 r">ast</span>.<span class="i">FindAll</span>(<b>static</b> <span id="r22 rd" class="r22 r">x</span> =&gt; <span class="r22 r">x</span> <b>is</b> <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>, <span class="i">searchNestedScriptBlocks</span>: <b>false</b>);
            <b>foreach</b> (<b>var</b> <span id="r23 rd" class="r23 r">type</span> <b>in</b> <span class="r21 r">types</span>)
            {
                <a href="#3696d5bc4698bf69" class="i method">AddType</a>((<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>)<span class="r23 r">type</span>);
            }
        }
 
        <b>internal void</b> <a id="8bea64de6d6360f7" href="../../R/8bea64de6d6360f7.html" target="n" data-glyph="74,1" class="i method">EnterScope</a>(<a href="ast.cs.html#063cc8bbea9e10f2" class="t t">IParameterMetadataProvider</a> <span id="r24 rd" class="r24 r">ast</span>, <a href="#cb138e30acb53b66" class="t t">ScopeType</a> <span id="r25 rd" class="r25 r">scopeType</span>)
        {
            <a href="#d4b54002a3e61c59" class="k">var</a> <span id="r26 rd" class="r26 r">scope</span> = <b>new</b> <a href="#be88eb8661ea5ff9" class="t constructor">Scope</a>(<span class="r24 r">ast</span>, <span class="r25 r">scopeType</span>);
            <a href="#939bf31e2510e170" class="i field">_scopes</a>.<span class="i">Add</span>(<span class="r26 r">scope</span>);
            <a href="#fc8b0762edc3d8d6" class="i method">AddTypesInScope</a>((<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>)<span class="r24 r">ast</span>);
        }
 
        <b>internal void</b> <a id="6f9816f7304ad81c" href="../../R/6f9816f7304ad81c.html" target="n" data-glyph="74,1" class="i method">EnterScope</a>(<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r27 rd" class="r27 r">typeDefinition</span>)
        {
            <a href="#d4b54002a3e61c59" class="k">var</a> <span id="r28 rd" class="r28 r">scope</span> = <b>new</b> <a href="#7f62f2bd0a27d15e" class="t constructor">Scope</a>(<span class="r27 r">typeDefinition</span>);
            <a href="#939bf31e2510e170" class="i field">_scopes</a>.<span class="i">Add</span>(<span class="r28 r">scope</span>);
            <a href="#fc8b0762edc3d8d6" class="i method">AddTypesInScope</a>(<span class="r27 r">typeDefinition</span>);
        }
 
        <b>internal void</b> <a id="7a8bc3eb2f3f5ceb" href="../../R/7a8bc3eb2f3f5ceb.html" target="n" data-glyph="74,1" class="i method">LeaveScope</a>()
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#939bf31e2510e170" class="i field">_scopes</a>.<span class="i">Count</span> &gt; 0, <span class="s">&quot;Scope stack can&#39;t be empty when leaving a scope&quot;</span>);
            <a href="#939bf31e2510e170" class="i field">_scopes</a>.<span class="i">RemoveAt</span>(<a href="#939bf31e2510e170" class="i field">_scopes</a>.<span class="i">Count</span> - 1);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add Type to the symbol Table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r29 r">typeDefinitionAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="3696d5bc4698bf69" href="../../R/3696d5bc4698bf69.html" target="n" data-glyph="72,1" class="i method">AddType</a>(<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r29 rd" class="r29 r">typeDefinitionAst</span>)
        {
            <a href="#939bf31e2510e170" class="i field">_scopes</a>[<a href="#939bf31e2510e170" class="i field">_scopes</a>.<span class="i">Count</span> - 1].<span class="i">AddType</span>(<a href="#ad3ce8750167c6d4" class="i field">_parser</a>, <span class="r29 r">typeDefinitionAst</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Add Type from the different module to the symbol Table.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r30 r">typeDefinitionAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r31 r">moduleInfo</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public void</b> <a id="90d1a801b2880b88" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">AddTypeFromUsingModule</a>(<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r30 rd" class="r30 r">typeDefinitionAst</span>, <a href="../Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a> <span id="r31 rd" class="r31 r">moduleInfo</span>)
        {
            <a href="#939bf31e2510e170" class="i field">_scopes</a>[<a href="#939bf31e2510e170" class="i field">_scopes</a>.<span class="i">Count</span> - 1].<span class="i">AddTypeFromUsingModule</span>(<a href="#ad3ce8750167c6d4" class="i field">_parser</a>, <span class="r30 r">typeDefinitionAst</span>, <span class="r31 r">moduleInfo</span>);
        }
 
        <b>public</b> <a href="#9aadf41346ae58b0" class="t t">TypeLookupResult</a> <a id="f81e9144635bfa90" href="../../R/f81e9144635bfa90.html" target="n" data-glyph="72,1" class="i method">LookupType</a>(<a href="ast.cs.html#83b43c1855a09e15" class="t t">TypeName</a> <span id="r32 rd" class="r32 r">typeName</span>)
        {
            <a href="#9aadf41346ae58b0" class="t t">TypeLookupResult</a> <span id="r33 rd" class="r33 r">result</span> = <b>null</b>;
            <b>for</b> (<b>int</b> <span id="r34 rd" class="r34 r">i</span> = <a href="#939bf31e2510e170" class="i field">_scopes</a>.<span class="i">Count</span> - 1; <span class="r34 r">i</span> &gt;= 0; <span class="r34 r">i</span>--)
            {
                <span class="r33 r">result</span> = <a href="#939bf31e2510e170" class="i field">_scopes</a>[<span class="r34 r">i</span>].<span class="i">LookupType</span>(<span class="r32 r">typeName</span>);
                <b>if</b> (<span class="r33 r">result</span> != <b>null</b>)
                    <b>break</b>;
            }
 
            <b>return</b> <span class="r33 r">result</span>;
        }
 
        <b>public</b> <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <a id="c1324c52547db8c9" href="../../R/c1324c52547db8c9.html" target="n" data-glyph="72,1" class="i method">LookupVariable</a>(<a href="../VariablePath.cs.html#41e5b41974741cc5" class="t t">VariablePath</a> <span id="r35 rd" class="r35 r">variablePath</span>)
        {
            <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r36 rd" class="r36 r">result</span> = <b>null</b>;
            <b>for</b> (<b>int</b> <span id="r37 rd" class="r37 r">i</span> = <a href="#939bf31e2510e170" class="i field">_scopes</a>.<span class="i">Count</span> - 1; <span class="r37 r">i</span> &gt;= 0; <span class="r37 r">i</span>--)
            {
                <span class="r36 r">result</span> = <a href="#939bf31e2510e170" class="i field">_scopes</a>[<span class="r37 r">i</span>].<span class="i">LookupVariable</span>(<span class="r35 r">variablePath</span>);
                <b>if</b> (<span class="r36 r">result</span> != <b>null</b>)
                    <b>break</b>;
            }
 
            <b>return</b> <span class="r36 r">result</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return the most deep typeDefinitionAst in the current context.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">TypeDefinitionAst or null, if currently not in type definition.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public</b> <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <a id="cde1386d49ee6676" href="../../R/cde1386d49ee6676.html" target="n" data-glyph="72,1" class="i method">GetCurrentTypeDefinitionAst</a>()
        {
            <b>for</b> (<b>int</b> <span id="r38 rd" class="r38 r">i</span> = <a href="#939bf31e2510e170" class="i field">_scopes</a>.<span class="i">Count</span> - 1; <span class="r38 r">i</span> &gt;= 0; <span class="r38 r">i</span>--)
            {
                <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r39 rd" class="r39 r">ast</span> = <a href="#939bf31e2510e170" class="i field">_scopes</a>[<span class="r38 r">i</span>].<span class="i">_ast</span> <b>as</b> <a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a>;
                <b>if</b> (<span class="r39 r">ast</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r39 r">ast</span>;
                }
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>public bool</b> <a id="776bec40f86a5b87" href="../../R/776bec40f86a5b87.html" target="n" data-glyph="72,1" class="i method">IsInMethodScope</a>()
        {
            <b>return</b> <a href="#939bf31e2510e170" class="i field">_scopes</a>[<a href="#939bf31e2510e170" class="i field">_scopes</a>.<span class="i">Count</span> - 1].<span class="i">_scopeType</span> == <a href="#cb138e30acb53b66" class="t t">ScopeType</a>.<a href="#908a98a97f6319fc" class="i field">Method</a>;
        }
    }
 
    <b>internal sealed class</b> <a id="2121410b8db29d18" href="../../R/2121410b8db29d18.html" target="n" data-glyph="2,0" class="t t">SymbolResolver</a> : <a href="PreOrderVisitor.cs.html#7dcb07b4ea546586" class="t t">AstVisitor2</a>, <a href="PreOrderVisitor.cs.html#787ad664e4913a86" class="t t">IAstPostVisitHandler</a>
    {
        <b>private readonly</b> <a href="#a4665648688fced0" class="t t">SymbolResolvePostActionVisitor</a> <a id="b16675caa213893d" href="../../R/b16675caa213893d.html" target="n" data-glyph="46,1" class="i field">_symbolResolvePostActionVisitor</a>;
        <b>internal readonly</b> <a href="#695cfbbdc0585501" class="t t">SymbolTable</a> <a id="afa29fa6510795c7" href="../../R/afa29fa6510795c7.html" target="n" data-glyph="44,1" class="i field">_symbolTable</a>;
        <b>internal readonly</b> <a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <a id="5595ef0ee022bf4e" href="../../R/5595ef0ee022bf4e.html" target="n" data-glyph="44,1" class="i field">_parser</a>;
        <b>internal readonly</b> <a href="TypeResolver.cs.html#55992be0fa5b3b24" class="t t">TypeResolutionState</a> <a id="6a80414177b4d673" href="../../R/6a80414177b4d673.html" target="n" data-glyph="44,1" class="i field">_typeResolutionState</a>;
 
        [<span class="i">ThreadStatic</span>]
        <b>private static</b> <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="cde2092a46001b07" href="../../R/cde2092a46001b07.html" target="n" data-glyph="46,1" class="i field">t_usingStatementResolvePowerShell</a>;
 
        <b>private static</b> <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <a id="9fe9b04ba0f18f38" href="../../R/9fe9b04ba0f18f38.html" target="n" data-glyph="106,1" class="i property">UsingStatementResolvePowerShell</a>
        {
            <b>get</b>
            {
                <span class="c">// The goal is to re-use runspaces, because creating runspace is an expensive part in creating PowerShell instance.</span>
                <b>if</b> (<a href="#cde2092a46001b07" class="i field">t_usingStatementResolvePowerShell</a> == <b>null</b>)
                {
                    <b>if</b> (<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> != <b>null</b>)
                    {
                        <a href="#cde2092a46001b07" class="i field">t_usingStatementResolvePowerShell</a> = <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#1c6a51d3c837bb4d" class="i method">Create</a>(<a href="../hostifaces/PowerShell.cs.html#c3c0f0e5e0b337ff" class="t t">RunspaceMode</a>.<a href="../hostifaces/PowerShell.cs.html#75d224de5df87e75" class="i field">CurrentRunspace</a>);
                    }
                    <b>else</b>
                    {
                        <span class="c">// Create empty iss and populate only commands, that we want to use.</span>
                        <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a> <span id="r40 rd" class="r40 r">iss</span> = <a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="../InitialSessionState.cs.html#6aee0258f9ef7599" class="i method">Create</a>();
                        <span class="r40 r">iss</span>.<a href="../InitialSessionState.cs.html#2d45d0b0db0079ba" class="i property">Commands</a>.<a href="../InitialSessionState.cs.html#048e6fba5da66395" class="i method">Add</a>(<b>new</b> <span class="t">SessionStateCmdletEntry</span>(<span class="s">&quot;Get-Module&quot;</span>, <b>typeof</b>(<a href="../Modules/GetModuleCommand.cs.html#6f6537067f4dfc41" class="t t">GetModuleCommand</a>), <b>null</b>));
                        <a href="../InitialSessionState.cs.html#236a07b6fd3f0e39" class="k">var</a> <span id="r41 rd" class="r41 r">sessionStateProviderEntry</span> = <b>new</b> <span class="t">SessionStateProviderEntry</span>(<a href="../../P/64a92af39f1cd630.html#64a92af39f1cd630" class="t t">FileSystemProvider</a>.<a href="../../namespaces/FileSystemProvider.cs.html#10b665caf52d3382" class="i field">ProviderName</a>, <b>typeof</b>(<a href="../../P/64a92af39f1cd630.html#64a92af39f1cd630" class="t t">FileSystemProvider</a>), <b>null</b>);
                        <b>var</b> <span id="r42 rd" class="r42 r">snapin</span> = <a href="../../singleshell/config/MshSnapinInfo.cs.html#b036b8d90fff7faa" class="t t">PSSnapInReader</a>.<a href="../../singleshell/config/MshSnapinInfo.cs.html#e508dc80c5619134" class="i method">ReadEnginePSSnapIns</a>().<span class="i">FirstOrDefault</span>(<b>static</b> <span id="r43 rd" class="r43 r">snapIn</span> =&gt; <span class="r43 r">snapIn</span>.<span class="i">Name</span>.<span class="i">Equals</span>(<span class="s">&quot;Microsoft.PowerShell.Core&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
                        <span class="r41 r">sessionStateProviderEntry</span>.<span class="i">SetPSSnapIn</span>(<span class="r42 r">snapin</span>);
                        <span class="r40 r">iss</span>.<a href="../InitialSessionState.cs.html#901a2e8b67c4db16" class="i property">Providers</a>.<a href="../InitialSessionState.cs.html#048e6fba5da66395" class="i method">Add</a>(<span class="r41 r">sessionStateProviderEntry</span>);
                        <a href="#cde2092a46001b07" class="i field">t_usingStatementResolvePowerShell</a> = <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#f41a8c4815429c5e" class="i method">Create</a>(<span class="r40 r">iss</span>);
                    }
                }
                <b>else</b> <b>if</b> (<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> != <b>null</b> &amp;&amp; <a href="#cde2092a46001b07" class="i field">t_usingStatementResolvePowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a> != <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>)
                {
                    <a href="#cde2092a46001b07" class="i field">t_usingStatementResolvePowerShell</a> = <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#1c6a51d3c837bb4d" class="i method">Create</a>(<a href="../hostifaces/PowerShell.cs.html#c3c0f0e5e0b337ff" class="t t">RunspaceMode</a>.<a href="../hostifaces/PowerShell.cs.html#75d224de5df87e75" class="i field">CurrentRunspace</a>);
                }
 
                <b>return</b> <a href="#cde2092a46001b07" class="i field">t_usingStatementResolvePowerShell</a>;
            }
        }
 
        <b>private</b> <a id="877822b4d56f6872" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="t constructor">SymbolResolver</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r44 rd" class="r44 r">parser</span>, <a href="TypeResolver.cs.html#55992be0fa5b3b24" class="t t">TypeResolutionState</a> <span id="r45 rd" class="r45 r">typeResolutionState</span>)
        {
            <a href="#afa29fa6510795c7" class="i field">_symbolTable</a> = <b>new</b> <a href="#eb3f97950f10fc6f" class="t constructor">SymbolTable</a>(<span class="r44 r">parser</span>);
            <a href="#5595ef0ee022bf4e" class="i field">_parser</a> = <span class="r44 r">parser</span>;
            <a href="#6a80414177b4d673" class="i field">_typeResolutionState</a> = <span class="r45 r">typeResolutionState</span>;
            <a href="#b16675caa213893d" class="i field">_symbolResolvePostActionVisitor</a> = <b>new</b> <span class="t">SymbolResolvePostActionVisitor</span> { <a href="#d267f9ed45fe1192" class="i field">_symbolResolver</a> = <a href="#2121410b8db29d18" class="k">this</a> };
        }
 
        <b>internal static void</b> <a id="99b86e22d2f31cb0" href="../../R/99b86e22d2f31cb0.html" target="n" data-glyph="74,1" class="i method">ResolveSymbols</a>(<a href="Parser.cs.html#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r46 rd" class="r46 r">parser</span>, <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r47 rd" class="r47 r">scriptBlockAst</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r47 r">scriptBlockAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> == <b>null</b>, <span class="s">&quot;Can only resolve starting from the root&quot;</span>);
 
            <b>var</b> <span id="r48 rd" class="r48 r">usingState</span> = <span class="r47 r">scriptBlockAst</span>.<a href="ast.cs.html#c707ba0b01460c10" class="i property">UsingStatements</a>.<span class="i">Count</span> &gt; 0
                ? <b>new</b> <a href="TypeResolver.cs.html#da3e3447d7715cbe" class="t constructor">TypeResolutionState</a>(<a href="../runtime/Operations/MiscOps.cs.html#1953a14dee44eb19" class="t t">TypeOps</a>.<span class="i">GetNamespacesForTypeResolutionState</span>(<span class="r47 r">scriptBlockAst</span>.<a href="ast.cs.html#c707ba0b01460c10" class="i property">UsingStatements</a>), <a href="TypeResolver.cs.html#55992be0fa5b3b24" class="t t">TypeResolutionState</a>.<a href="TypeResolver.cs.html#033134ff91b978e0" class="i field">emptyAssemblies</a>)
                : <a href="TypeResolver.cs.html#55992be0fa5b3b24" class="t t">TypeResolutionState</a>.<a href="TypeResolver.cs.html#140e18e0d186d2d7" class="i method">GetDefaultUsingState</a>(<b>null</b>);
            <a href="#2121410b8db29d18" class="k">var</a> <span id="r49 rd" class="r49 r">resolver</span> = <b>new</b> <span class="t">SymbolResolver</span>(<span class="r46 r">parser</span>, <span class="r48 r">usingState</span>);
            <span class="r49 r">resolver</span>.<a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#8bea64de6d6360f7" class="i method">EnterScope</a>(<span class="r47 r">scriptBlockAst</span>, <a href="#cb138e30acb53b66" class="t t">ScopeType</a>.<a href="#5a3a47019b5e7f02" class="i field">ScriptBlock</a>);
            <span class="r47 r">scriptBlockAst</span>.<a href="ast.cs.html#b97830265ba444e4" class="i method">Visit</a>(<span class="r49 r">resolver</span>);
            <span class="r49 r">resolver</span>.<a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#7a8bc3eb2f3f5ceb" class="i method">LeaveScope</a>();
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r49 r">resolver</span>.<a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#939bf31e2510e170" class="i field">_scopes</a>.<span class="i">Count</span> == 0, <span class="s">&quot;Somebody missed removing a scope&quot;</span>);
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="3b82ecd0cfbc9b70" href="../../R/3b82ecd0cfbc9b70.html" target="n" data-glyph="72,1" class="i method">VisitTypeDefinition</a>(<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r50 rd" class="r50 r">typeDefinitionAst</span>)
        {
            <a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#6f9816f7304ad81c" class="i method">EnterScope</a>(<span class="r50 r">typeDefinitionAst</span>);
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="304e28dcf441f5ff" href="../../R/304e28dcf441f5ff.html" target="n" data-glyph="72,1" class="i method">VisitScriptBlockExpression</a>(<a href="ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a> <span id="r51 rd" class="r51 r">scriptBlockExpressionAst</span>)
        {
            <a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#8bea64de6d6360f7" class="i method">EnterScope</a>(<span class="r51 r">scriptBlockExpressionAst</span>.<a href="ast.cs.html#3155915865e15c92" class="i property">ScriptBlock</a>, <a href="#cb138e30acb53b66" class="t t">ScopeType</a>.<a href="#5a3a47019b5e7f02" class="i field">ScriptBlock</a>);
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="120ac933984af51b" href="../../R/120ac933984af51b.html" target="n" data-glyph="72,1" class="i method">VisitFunctionDefinition</a>(<a href="ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r52 rd" class="r52 r">functionDefinitionAst</span>)
        {
            <b>if</b> (<span class="r52 r">functionDefinitionAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is not</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>)
            {
                <a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#8bea64de6d6360f7" class="i method">EnterScope</a>(<span class="r52 r">functionDefinitionAst</span>.<a href="ast.cs.html#201bce3cfc040274" class="i property">Body</a>, <a href="#cb138e30acb53b66" class="t t">ScopeType</a>.<a href="#bc9af434f6caf6c1" class="i field">Function</a>);
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="93589829cd628e0a" href="../../R/93589829cd628e0a.html" target="n" data-glyph="72,1" class="i method">VisitPropertyMember</a>(<a href="ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a> <span id="r53 rd" class="r53 r">propertyMemberAst</span>)
        {
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="93ed4aee5204af43" href="../../R/93ed4aee5204af43.html" target="n" data-glyph="72,1" class="i method">VisitFunctionMember</a>(<a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a> <span id="r54 rd" class="r54 r">functionMemberAst</span>)
        {
            <a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#8bea64de6d6360f7" class="i method">EnterScope</a>(<span class="r54 r">functionMemberAst</span>.<a href="ast.cs.html#0cea07df0e8f92c9" class="i property">Body</a>, <a href="#cb138e30acb53b66" class="t t">ScopeType</a>.<a href="#908a98a97f6319fc" class="i field">Method</a>);
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="d12ec74a88f01c7c" href="../../R/d12ec74a88f01c7c.html" target="n" data-glyph="72,1" class="i method">VisitAssignmentStatement</a>(<a href="ast.cs.html#da5f345864f42e06" class="t t">AssignmentStatementAst</a> <span id="r55 rd" class="r55 r">assignmentStatementAst</span>)
        {
            <b>if</b> (<a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#776bec40f86a5b87" class="i method">IsInMethodScope</a>())
            {
                <b>var</b> <span id="r56 rd" class="r56 r">targets</span> = <span class="r55 r">assignmentStatementAst</span>.<a href="ast.cs.html#118f31ee174579ad" class="i method">GetAssignmentTargets</a>().<span class="i">ToArray</span>();
                <b>foreach</b> (<b>var</b> <span id="r57 rd" class="r57 r">expressionAst</span> <b>in</b> <span class="r56 r">targets</span>)
                {
                    <b>var</b> <span id="r58 rd" class="r58 r">expression</span> = <span class="r57 r">expressionAst</span>;
                    <a href="ast.cs.html#248562b22b336dec" class="k">var</a> <span id="r59 rd" class="r59 r">variableExpressionAst</span> = <span class="r58 r">expression</span> <b>as</b> <a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>;
                    <b>while</b> (<span class="r59 r">variableExpressionAst</span> == <b>null</b> &amp;&amp; <span class="r58 r">expression</span> != <b>null</b>)
                    {
                        <a href="ast.cs.html#49daf252fdb62723" class="k">var</a> <span id="r60 rd" class="r60 r">convertExpressionAst</span> = <span class="r58 r">expression</span> <b>as</b> <a href="ast.cs.html#49daf252fdb62723" class="t t">ConvertExpressionAst</a>;
                        <b>if</b> (<span class="r60 r">convertExpressionAst</span> != <b>null</b>)
                        {
                            <span class="r58 r">expression</span> = <span class="r60 r">convertExpressionAst</span>.<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a>;
                            <span class="r59 r">variableExpressionAst</span> = <span class="r60 r">convertExpressionAst</span>.<a href="ast.cs.html#b2353777e73e35be" class="i property">Child</a> <b>as</b> <a href="ast.cs.html#248562b22b336dec" class="t t">VariableExpressionAst</a>;
                        }
                        <b>else</b>
                        {
                            <b>break</b>;
                        }
                    }
 
                    <b>if</b> (<span class="r59 r">variableExpressionAst</span> != <b>null</b> &amp;&amp; <span class="r59 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>.<a href="../VariablePath.cs.html#6af6d06d3e3c5d67" class="i property">IsVariable</a>)
                    {
                        <a href="ast.cs.html#d47621d83efd14de" class="k">var</a> <span id="r61 rd" class="r61 r">ast</span> = <a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#c1324c52547db8c9" class="i method">LookupVariable</a>(<span class="r59 r">variableExpressionAst</span>.<a href="ast.cs.html#d094d170ef781837" class="i property">VariablePath</a>);
                        <a href="ast.cs.html#88ad8abafd061e97" class="k">var</a> <span id="r62 rd" class="r62 r">propertyMember</span> = <span class="r61 r">ast</span> <b>as</b> <a href="ast.cs.html#88ad8abafd061e97" class="t t">PropertyMemberAst</a>;
                        <b>if</b> (<span class="r62 r">propertyMember</span> != <b>null</b>)
                        {
                            <b>if</b> (<span class="r62 r">propertyMember</span>.<a href="ast.cs.html#a4fccd8c1d834725" class="i property">IsStatic</a>)
                            {
                                <a href="ast.cs.html#d7f0bc21c0f10879" class="k">var</a> <span id="r63 rd" class="r63 r">typeAst</span> = <a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#cde1386d49ee6676" class="i method">GetCurrentTypeDefinitionAst</a>();
                                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r63 r">typeAst</span> != <b>null</b>, <span class="s">&quot;Method scopes can exist only inside type definitions.&quot;</span>);
 
                                <b>string</b> <span id="r64 rd" class="r64 r">typeString</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;[{0}]::&quot;</span>, <span class="r63 r">typeAst</span>.<a href="ast.cs.html#b2edb6e99afb6054" class="i property">Name</a>);
                                <a href="#5595ef0ee022bf4e" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r59 r">variableExpressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingTypeInStaticPropertyAssignment</span>),
                                    <span class="i">ParserStrings</span>.<span class="i">MissingTypeInStaticPropertyAssignment</span>,
                                    <span class="r64 r">typeString</span>,
                                    <span class="r62 r">propertyMember</span>.<a href="ast.cs.html#d93cd0c92947c0b5" class="i property">Name</a>);
                            }
                            <b>else</b>
                            {
                                <a href="#5595ef0ee022bf4e" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r59 r">variableExpressionAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingThis</span>),
                                    <span class="i">ParserStrings</span>.<span class="i">MissingThis</span>,
                                    <span class="s">&quot;$this.&quot;</span>,
                                    <span class="r62 r">propertyMember</span>.<a href="ast.cs.html#d93cd0c92947c0b5" class="i property">Name</a>);
                            }
                        }
                    }
                }
                <span class="c">// TODO: static look for alias and function.</span>
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="dce1bf2c0238e271" href="../../R/dce1bf2c0238e271.html" target="n" data-glyph="72,1" class="i method">VisitTypeExpression</a>(<a href="ast.cs.html#bf258955590d49b7" class="t t">TypeExpressionAst</a> <span id="r65 rd" class="r65 r">typeExpressionAst</span>)
        {
            <a href="#704b8d1ae33a756b" class="i method">DispatchTypeName</a>(<span class="r65 r">typeExpressionAst</span>.<a href="ast.cs.html#c43447ab6269441a" class="i property">TypeName</a>, <span class="r66 r">genericArgumentCount</span>: 0, <span class="r67 r">isAttribute</span>: <b>false</b>);
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="8e37e9f0272cb1f6" href="../../R/8e37e9f0272cb1f6.html" target="n" data-glyph="72,1" class="i method">VisitTypeConstraint</a>(<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r68 rd" class="r68 r">typeConstraintAst</span>)
        {
            <a href="#704b8d1ae33a756b" class="i method">DispatchTypeName</a>(<span class="r68 r">typeConstraintAst</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>, <span class="r66 r">genericArgumentCount</span>: 0, <span class="r67 r">isAttribute</span>: <b>false</b>);
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Resolves using module to a collection of PSModuleInfos. Doesn&#39;t throw.</span>
        <span class="c">///</span><span class="c"> PSModuleInfo objects are returned in the right order: i.e. if multiply versions of the module</span>
        <span class="c">///</span><span class="c"> is presented on the system and user didn&#39;t specify version, we will return all of them, but newer one would go first.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r69 r">usingStatementAst</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Using statement.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r70 r">exception</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">If exception happens, return exception object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r71 r">wildcardCharactersUsed</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> True if in the module name uses wildcardCharacter.</span>
        <span class="c">///</span><span class="c"> We don&#39;t want to resolve any wild-cards in using module.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r72 r">isConstant</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">True if module hashtable contains constant value (it&#39;s our requirement).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">Modules, if can resolve it. null if any problems happens.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <span class="i">Collection</span>&lt;<a href="../Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>&gt; <a id="b880798731e18381" href="../../R/b880798731e18381.html" target="n" data-glyph="76,1" class="i method">GetModulesFromUsingModule</a>(<a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a> <span id="r69 rd" class="r69 r">usingStatementAst</span>, <b>out</b> <span class="i">Exception</span> <span id="r70 rd" class="r70 r">exception</span>, <b>out bool</b> <span id="r71 rd" class="r71 r">wildcardCharactersUsed</span>, <b>out bool</b> <span id="r72 rd" class="r72 r">isConstant</span>)
        {
            <span class="r70 r">exception</span> = <b>null</b>;
            <span class="r71 r">wildcardCharactersUsed</span> = <b>false</b>;
            <span class="r72 r">isConstant</span> = <b>true</b>;
 
            <span class="c">// fullyQualifiedName can be string or hashtable</span>
            <b>object</b> <span id="r73 rd" class="r73 r">fullyQualifiedName</span>;
            <b>if</b> (<span class="r69 r">usingStatementAst</span>.<a href="ast.cs.html#4109993f1afb989e" class="i property">ModuleSpecification</a> != <b>null</b>)
            {
                <b>object</b> <span id="r74 rd" class="r74 r">resultObject</span>;
                <b>if</b> (!<a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<a href="ConstantValues.cs.html#594e7e13f898b0a1" class="i method">IsConstant</a>(<span class="r69 r">usingStatementAst</span>.<a href="ast.cs.html#4109993f1afb989e" class="i property">ModuleSpecification</a>, <b>out</b> <span class="r74 r">resultObject</span>, <span class="r75 r">forAttribute</span>: <b>false</b>, <span class="r76 r">forRequires</span>: <b>true</b>))
                {
                    <span class="r72 r">isConstant</span> = <b>false</b>;
                    <b>return</b> <b>null</b>;
                }
 
                <b>var</b> <span id="r77 rd" class="r77 r">hashtable</span> = <span class="r74 r">resultObject</span> <b>as</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Hashtable</span>;
                <a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="k">var</a> <span id="r78 rd" class="r78 r">ms</span> = <b>new</b> <a href="../Modules/ModuleSpecification.cs.html#a06529b49cc6cb36" class="t constructor">ModuleSpecification</a>();
                <span class="r70 r">exception</span> = <a href="../Modules/ModuleSpecification.cs.html#1fd961b021940b6a" class="t t">ModuleSpecification</a>.<span class="i">ModuleSpecificationInitHelper</span>(<span class="r78 r">ms</span>, <span class="r77 r">hashtable</span>);
                <b>if</b> (<span class="r70 r">exception</span> != <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <b>if</b> (<a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r78 r">ms</span>.<a href="../Modules/ModuleSpecification.cs.html#148bbf163788664b" class="i property">Name</a>))
                {
                    <span class="r71 r">wildcardCharactersUsed</span> = <b>true</b>;
                    <b>return</b> <b>null</b>;
                }
 
                <span class="r73 r">fullyQualifiedName</span> = <span class="r78 r">ms</span>;
            }
            <b>else</b>
            {
                <b>string</b> <span id="r79 rd" class="r79 r">fullyQualifiedNameStr</span> = <span class="r69 r">usingStatementAst</span>.<a href="ast.cs.html#02967e77bbe69be3" class="i property">Name</a>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>;
 
                <b>if</b> (<a href="../regex.cs.html#d450e739ff28e660" class="t t">WildcardPattern</a>.<a href="../regex.cs.html#f9cf207fdd565080" class="i method">ContainsWildcardCharacters</a>(<span class="r79 r">fullyQualifiedNameStr</span>))
                {
                    <span class="r71 r">wildcardCharactersUsed</span> = <b>true</b>;
                    <b>return</b> <b>null</b>;
                }
 
                <span class="c">// case 1: relative path. Relative for file in the same folder should include .\ or ./</span>
                <b>bool</b> <span id="r80 rd" class="r80 r">isPath</span> = <span class="r79 r">fullyQualifiedNameStr</span>.<span class="i">Contains</span>(<span class="s">&#39;\\&#39;</span>) || <span class="r79 r">fullyQualifiedNameStr</span>.<span class="i">Contains</span>(<span class="s">&#39;/&#39;</span>);
                <b>if</b> (<span class="r80 r">isPath</span> &amp;&amp; !<a href="../../namespaces/LocationGlobber.cs.html#6387d90abe0ca584" class="t t">LocationGlobber</a>.<a href="../../namespaces/LocationGlobber.cs.html#4cd70f3f191704a0" class="i method">IsAbsolutePath</a>(<span class="r79 r">fullyQualifiedNameStr</span>))
                {
                    <b>string</b> <span id="r81 rd" class="r81 r">rootPath</span> = <span class="i">Path</span>.<span class="i">GetDirectoryName</span>(<a href="#5595ef0ee022bf4e" class="i field">_parser</a>.<a href="Parser.cs.html#b95552b4b6eec94f" class="i field">_fileName</a>);
                    <b>if</b> (<span class="r81 r">rootPath</span> != <b>null</b>)
                    {
                        <span class="r79 r">fullyQualifiedNameStr</span> = <span class="i">Path</span>.<span class="i">Combine</span>(<span class="r81 r">rootPath</span>, <span class="r79 r">fullyQualifiedNameStr</span>);
                    }
                }
 
                <span class="c">// case 2: Module by name</span>
                <span class="c">// case 3: Absolute Path</span>
                <span class="c">// We don&#39;t need to do anything for these cases, FullyQualifiedName already handle it.</span>
 
                <span class="r73 r">fullyQualifiedName</span> = <span class="r79 r">fullyQualifiedNameStr</span>;
            }
 
            <a href="../CmdletInfo.cs.html#9492ffc9968f644d" class="k">var</a> <span id="r82 rd" class="r82 r">commandInfo</span> = <b>new</b> <span class="t">CmdletInfo</span>(<span class="s">&quot;Get-Module&quot;</span>, <b>typeof</b>(<a href="../Modules/GetModuleCommand.cs.html#6f6537067f4dfc41" class="t t">GetModuleCommand</a>));
            <span class="c">// TODO(sevoroby): we should consider an async call with cancellation here.</span>
            <a href="#9fe9b04ba0f18f38" class="i property">UsingStatementResolvePowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#7bde27452e045465" class="i property">Commands</a>.<a href="../hostifaces/PSCommand.cs.html#15970659c9fe6157" class="i method">Clear</a>();
            <b>try</b>
            {
                <b>return</b> <a href="#9fe9b04ba0f18f38" class="i property">UsingStatementResolvePowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#cc3df9bf3b89f740" class="i method">AddCommand</a>(<span class="r82 r">commandInfo</span>)
                    .<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;FullyQualifiedName&quot;</span>, <span class="r73 r">fullyQualifiedName</span>)
                    .<a href="../hostifaces/PowerShell.cs.html#40674f99a3618f4b" class="i method">AddParameter</a>(<span class="s">&quot;ListAvailable&quot;</span>, <b>true</b>)
                    .<a href="../hostifaces/PowerShell.cs.html#11053e110c66cae7" class="i method">Invoke</a>&lt;<a href="../Modules/PSModuleInfo.cs.html#4885a82159eebf7b" class="t t">PSModuleInfo</a>&gt;();
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r83 rd" class="r83 r">e</span>)
            {
                <span class="r70 r">exception</span> = <span class="r83 r">e</span>;
                <b>return</b> <b>null</b>;
            }
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="beb219306cb7c958" href="../../R/beb219306cb7c958.html" target="n" data-glyph="72,1" class="i method">VisitUsingStatement</a>(<a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a> <span id="r84 rd" class="r84 r">usingStatementAst</span>)
        {
            <b>if</b> (<span class="r84 r">usingStatementAst</span>.<a href="ast.cs.html#4b031903ea1b04ed" class="i property">UsingStatementKind</a> == <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#4e97afe747960a96" class="i field">Module</a>)
            {
                <span class="i">Exception</span> <span id="r85 rd" class="r85 r">exception</span>;
                <b>bool</b> <span id="r86 rd" class="r86 r">wildcardCharactersUsed</span>;
                <b>bool</b> <span id="r87 rd" class="r87 r">isConstant</span>;
                <b>var</b> <span id="r88 rd" class="r88 r">moduleInfo</span> = <a href="#b880798731e18381" class="i method">GetModulesFromUsingModule</a>(<span class="r84 r">usingStatementAst</span>, <b>out</b> <span class="r85 r">exception</span>, <b>out</b> <span class="r86 r">wildcardCharactersUsed</span>, <b>out</b> <span class="r87 r">isConstant</span>);
                <b>if</b> (!<span class="r87 r">isConstant</span>)
                {
                    <a href="#5595ef0ee022bf4e" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r84 r">usingStatementAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiresArgumentMustBeConstant</span>),
                        <span class="i">ParserStrings</span>.<span class="i">RequiresArgumentMustBeConstant</span>);
                }
                <b>else</b> <b>if</b> (<span class="r85 r">exception</span> != <b>null</b>)
                {
                    <span class="c">// we re-using RequiresModuleInvalid string, semantic is very similar so it&#39;s fine to do that.</span>
                    <a href="#5595ef0ee022bf4e" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r84 r">usingStatementAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiresModuleInvalid</span>),
                        <span class="i">ParserStrings</span>.<span class="i">RequiresModuleInvalid</span>,
                        <span class="r85 r">exception</span>.<span class="i">Message</span>);
                }
                <b>else</b> <b>if</b> (<span class="r86 r">wildcardCharactersUsed</span>)
                {
                    <a href="#5595ef0ee022bf4e" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r84 r">usingStatementAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">WildCardModuleNameError</span>),
                        <span class="i">ParserStrings</span>.<span class="i">WildCardModuleNameError</span>);
                }
                <b>else</b> <b>if</b> (<span class="r88 r">moduleInfo</span> != <b>null</b> &amp;&amp; <span class="r88 r">moduleInfo</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="c">// it&#39;s ok, if we get more then one module. They are already sorted in the right order</span>
                    <span class="c">// we just need to use the first one</span>
 
                    <span class="c">// We must add the same objects (in sense of object refs) to usingStatementAst typeTable and to symbolTable.</span>
                    <span class="c">// Later, this same TypeDefinitionAsts would be used in DefineTypes(), by the module, where it was imported from at compile time.</span>
                    <b>var</b> <span id="r89 rd" class="r89 r">exportedTypes</span> = <span class="r84 r">usingStatementAst</span>.<span class="i">DefineImportedModule</span>(<span class="r88 r">moduleInfo</span>[0]);
                    <b>foreach</b> (<b>var</b> <span id="r90 rd" class="r90 r">typePairs</span> <b>in</b> <span class="r89 r">exportedTypes</span>)
                    {
                        <a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<span class="i">AddTypeFromUsingModule</span>(<span class="r90 r">typePairs</span>.<span class="i">Value</span>, <span class="r88 r">moduleInfo</span>[0]);
                    }
                }
                <b>else</b>
                {
                    <span class="c">// if there is no exception, but we didn&#39;t find the module then it&#39;s not present</span>
                    <b>string</b> <span id="r91 rd" class="r91 r">moduleText</span> = <span class="r84 r">usingStatementAst</span>.<a href="ast.cs.html#02967e77bbe69be3" class="i property">Name</a> != <b>null</b> ? <span class="r84 r">usingStatementAst</span>.<a href="ast.cs.html#02967e77bbe69be3" class="i property">Name</a>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a> : <span class="r84 r">usingStatementAst</span>.<a href="ast.cs.html#4109993f1afb989e" class="i property">ModuleSpecification</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>;
                    <a href="#5595ef0ee022bf4e" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r84 r">usingStatementAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ModuleNotFoundDuringParse</span>),
                        <span class="i">ParserStrings</span>.<span class="i">ModuleNotFoundDuringParse</span>,
                        <span class="r91 r">moduleText</span>);
                }
            }
 
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>public override</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a> <a id="7c7db3985f7441bd" href="../../R/7c7db3985f7441bd.html" target="n" data-glyph="72,1" class="i method">VisitAttribute</a>(<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r92 rd" class="r92 r">attributeAst</span>)
        {
            <a href="#704b8d1ae33a756b" class="i method">DispatchTypeName</a>(<span class="r92 r">attributeAst</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>, <span class="r66 r">genericArgumentCount</span>: 0, <span class="r67 r">isAttribute</span>: <b>true</b>);
            <b>return</b> <a href="PreOrderVisitor.cs.html#1a6b8cf9a4c6249a" class="t t">AstVisitAction</a>.<a href="PreOrderVisitor.cs.html#eaa9a8bac592128a" class="i field">Continue</a>;
        }
 
        <b>private bool</b> <a id="704b8d1ae33a756b" href="../../R/704b8d1ae33a756b.html" target="n" data-glyph="76,1" class="i method">DispatchTypeName</a>(<a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r93 rd" class="r93 r">type</span>, <b>int</b> <span id="r66 rd" class="r66 r">genericArgumentCount</span>, <b>bool</b> <span id="r67 rd" class="r67 r">isAttribute</span>)
        {
            <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
            <a href="ast.cs.html#83b43c1855a09e15" class="k">var</a> <span id="r94 rd" class="r94 r">typeName</span> = <span class="r93 r">type</span> <b>as</b> <a href="ast.cs.html#83b43c1855a09e15" class="t t">TypeName</a>;
            <b>if</b> (<span class="r94 r">typeName</span> != <b>null</b>)
            {
                <b>return</b> <a href="#67c5ab54eda048df" class="i method">VisitTypeName</a>(<span class="r94 r">typeName</span>, <span class="r66 r">genericArgumentCount</span>, <span class="r67 r">isAttribute</span>);
            }
            <b>else</b>
            {
                <a href="ast.cs.html#8588eb9308b68261" class="k">var</a> <span id="r95 rd" class="r95 r">arrayTypeName</span> = <span class="r93 r">type</span> <b>as</b> <a href="ast.cs.html#8588eb9308b68261" class="t t">ArrayTypeName</a>;
                <b>if</b> (<span class="r95 r">arrayTypeName</span> != <b>null</b>)
                {
                    <b>return</b> <a href="#8b28a0258b07033c" class="i method">VisitArrayTypeName</a>(<span class="r95 r">arrayTypeName</span>);
                }
                <b>else</b>
                {
                    <a href="ast.cs.html#d3e3939e37307477" class="k">var</a> <span id="r96 rd" class="r96 r">genericTypeName</span> = <span class="r93 r">type</span> <b>as</b> <a href="ast.cs.html#d3e3939e37307477" class="t t">GenericTypeName</a>;
                    <b>if</b> (<span class="r96 r">genericTypeName</span> != <b>null</b>)
                    {
                        <b>return</b> <a href="#f25ddc865290f50f" class="i method">VisitGenericTypeName</a>(<span class="r96 r">genericTypeName</span>);
                    }
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private bool</b> <a id="8b28a0258b07033c" href="../../R/8b28a0258b07033c.html" target="n" data-glyph="76,1" class="i method">VisitArrayTypeName</a>(<a href="ast.cs.html#8588eb9308b68261" class="t t">ArrayTypeName</a> <span id="r97 rd" class="r97 r">arrayTypeName</span>)
        {
            <b>bool</b> <span id="r98 rd" class="r98 r">resolved</span> = <a href="#704b8d1ae33a756b" class="i method">DispatchTypeName</a>(<span class="r97 r">arrayTypeName</span>.<a href="ast.cs.html#0f81729ec1838610" class="i property">ElementType</a>, <span class="r66 r">genericArgumentCount</span>: 0, <span class="r67 r">isAttribute</span>: <b>false</b>);
            <b>if</b> (<span class="r98 r">resolved</span>)
            {
                <b>var</b> <span id="r99 rd" class="r99 r">resolvedType</span> = <span class="r97 r">arrayTypeName</span>.<a href="ast.cs.html#64b2a4d530b6ea36" class="i method">GetReflectionType</a>();
                <a href="TypeResolver.cs.html#bfedb6d1965806c6" class="t t">TypeCache</a>.<a href="TypeResolver.cs.html#6553890b1701ceca" class="i method">Add</a>(<span class="r97 r">arrayTypeName</span>, <a href="#6a80414177b4d673" class="i field">_typeResolutionState</a>, <span class="r99 r">resolvedType</span>);
            }
 
            <b>return</b> <span class="r98 r">resolved</span>;
        }
 
        <b>private bool</b> <a id="67c5ab54eda048df" href="../../R/67c5ab54eda048df.html" target="n" data-glyph="76,1" class="i method">VisitTypeName</a>(<a href="ast.cs.html#83b43c1855a09e15" class="t t">TypeName</a> <span id="r100 rd" class="r100 r">typeName</span>, <b>int</b> <span id="r101 rd" class="r101 r">genericArgumentCount</span>, <b>bool</b> <span id="r102 rd" class="r102 r">isAttribute</span>)
        {
            <a href="#9aadf41346ae58b0" class="k">var</a> <span id="r103 rd" class="r103 r">classDefn</span> = <a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#f81e9144635bfa90" class="i method">LookupType</a>(<span class="r100 r">typeName</span>);
 
            <b>if</b> (<span class="r103 r">classDefn</span> != <b>null</b> &amp;&amp; <span class="r103 r">classDefn</span>.<a href="#fff91371050b2e0d" class="i method">IsAmbiguous</a>())
            {
                <a href="#5595ef0ee022bf4e" class="i field">_parser</a>.<span class="i">ReportError</span>(<span class="r100 r">typeName</span>.<a href="ast.cs.html#1ce6d6f63fe6922f" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">AmbiguousTypeReference</span>),
                    <span class="i">ParserStrings</span>.<span class="i">AmbiguousTypeReference</span>,
                    <span class="r100 r">typeName</span>.<a href="ast.cs.html#a9592c89dfa9c9ad" class="i property">Name</a>,
                    <span class="i">GetModuleQualifiedName</span>(<span class="r103 r">classDefn</span>.<a href="#04d22a012ddf4ad3" class="i property">ExternalNamespaces</a>[0], <span class="r100 r">typeName</span>.<a href="ast.cs.html#a9592c89dfa9c9ad" class="i property">Name</a>),
                    <span class="i">GetModuleQualifiedName</span>(<span class="r103 r">classDefn</span>.<a href="#04d22a012ddf4ad3" class="i property">ExternalNamespaces</a>[1], <span class="r100 r">typeName</span>.<a href="ast.cs.html#a9592c89dfa9c9ad" class="i property">Name</a>));
            }
            <b>else</b> <b>if</b> (<span class="r103 r">classDefn</span> != <b>null</b> &amp;&amp; <span class="r101 r">genericArgumentCount</span> == 0)
            {
                <span class="r100 r">typeName</span>.<a href="ast.cs.html#bdc0f0e8930989ab" class="i method">SetTypeDefinition</a>(<span class="r103 r">classDefn</span>.<a href="#ccec929682fe12fa" class="i property">Type</a>);
            }
            <b>else</b>
            {
                <span class="i">Exception</span> <span id="r104 rd" class="r104 r">e</span>;
                <a href="TypeResolver.cs.html#55992be0fa5b3b24" class="t t">TypeResolutionState</a> <span id="r105 rd" class="r105 r">trs</span> = <span class="r101 r">genericArgumentCount</span> &gt; 0 || <span class="r102 r">isAttribute</span>
                    ? <b>new</b> <a href="TypeResolver.cs.html#02c7bbffeaaa844e" class="t constructor">TypeResolutionState</a>(<a href="#6a80414177b4d673" class="i field">_typeResolutionState</a>, <span class="r101 r">genericArgumentCount</span>, <span class="r102 r">isAttribute</span>)
                    : <a href="#6a80414177b4d673" class="i field">_typeResolutionState</a>;
 
                <b>var</b> <span id="r106 rd" class="r106 r">type</span> = <a href="TypeResolver.cs.html#f665f2b4b8d028cd" class="t t">TypeResolver</a>.<a href="TypeResolver.cs.html#a61c87d9e27d6f91" class="i method">ResolveTypeNameWithContext</a>(<span class="r100 r">typeName</span>, <b>out</b> <span class="r104 r">e</span>, <b>null</b>, <span class="r105 r">trs</span>);
                <b>if</b> (<span class="r106 r">type</span> == <b>null</b>)
                {
                    <b>if</b> (<a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#cde1386d49ee6676" class="i method">GetCurrentTypeDefinitionAst</a>() != <b>null</b>)
                    {
                        <span class="c">// [ordered] is an attribute, but it&#39;s looks like a type constraint.</span>
                        <b>if</b> (!<span class="r100 r">typeName</span>.<a href="ast.cs.html#5d27e8e58d692064" class="i property">FullName</a>.<span class="i">Equals</span>(<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#09ceaaf5116a37fd" class="i field">OrderedAttribute</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                        {
                            <b>string</b> <span id="r107 rd" class="r107 r">errorId</span>;
                            <b>string</b> <span id="r108 rd" class="r108 r">errorMsg</span>;
                            <b>if</b> (<span class="r102 r">isAttribute</span>)
                            {
                                <span class="r107 r">errorId</span> = <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">CustomAttributeTypeNotFound</span>);
                                <span class="r108 r">errorMsg</span> = <span class="i">ParserStrings</span>.<span class="i">CustomAttributeTypeNotFound</span>;
                            }
                            <b>else</b>
                            {
                                <span class="r107 r">errorId</span> = <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TypeNotFound</span>);
                                <span class="r108 r">errorMsg</span> = <span class="i">ParserStrings</span>.<span class="i">TypeNotFound</span>;
                            }
 
                            <a href="#5595ef0ee022bf4e" class="i field">_parser</a>.<a href="Parser.cs.html#a6ce762ed9f70927" class="i method">ReportError</a>(<span class="r100 r">typeName</span>.<a href="ast.cs.html#1ce6d6f63fe6922f" class="i property">Extent</a>, <span class="r107 r">errorId</span>, <span class="r108 r">errorMsg</span>, <span class="r100 r">typeName</span>.<a href="ast.cs.html#a9592c89dfa9c9ad" class="i property">Name</a>);
                        }
                    }
                }
                <b>else</b>
                {
                    ((<a href="ast.cs.html#17ce99e65ddcd5ec" class="t t">ISupportsTypeCaching</a>)<span class="r100 r">typeName</span>).<a href="ast.cs.html#d64781556b926659" class="i property">CachedType</a> = <span class="r106 r">type</span>;
                    <b>return</b> <b>true</b>;
                }
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private bool</b> <a id="f25ddc865290f50f" href="../../R/f25ddc865290f50f.html" target="n" data-glyph="76,1" class="i method">VisitGenericTypeName</a>(<a href="ast.cs.html#d3e3939e37307477" class="t t">GenericTypeName</a> <span id="r109 rd" class="r109 r">genericTypeName</span>)
        {
            <b>var</b> <span id="r110 rd" class="r110 r">foundType</span> = <a href="TypeResolver.cs.html#bfedb6d1965806c6" class="t t">TypeCache</a>.<a href="TypeResolver.cs.html#e38c7967b73a39e6" class="i method">Lookup</a>(<span class="r109 r">genericTypeName</span>, <a href="#6a80414177b4d673" class="i field">_typeResolutionState</a>);
            <b>if</b> (<span class="r110 r">foundType</span> != <b>null</b>)
            {
                ((<a href="ast.cs.html#17ce99e65ddcd5ec" class="t t">ISupportsTypeCaching</a>)<span class="r109 r">genericTypeName</span>).<a href="ast.cs.html#d64781556b926659" class="i property">CachedType</a> = <span class="r110 r">foundType</span>;
                <b>return</b> <b>true</b>;
            }
 
            <b>bool</b> <span id="r111 rd" class="r111 r">resolved</span> = <b>true</b>;
            <span class="r111 r">resolved</span> &amp;= <span class="i">DispatchTypeName</span>(<span class="r109 r">genericTypeName</span>.<a href="ast.cs.html#a0e9895f5c1358ce" class="i property">TypeName</a>, <span class="r109 r">genericTypeName</span>.<a href="ast.cs.html#c3319d29a1b29f46" class="i property">GenericArguments</a>.<span class="i">Count</span>, <span class="i">isAttribute</span>: <b>false</b>);
            <b>foreach</b> (<b>var</b> <span id="r112 rd" class="r112 r">typeArg</span> <b>in</b> <span class="r109 r">genericTypeName</span>.<a href="ast.cs.html#c3319d29a1b29f46" class="i property">GenericArguments</a>)
            {
                <span class="r111 r">resolved</span> &amp;= <span class="i">DispatchTypeName</span>(<span class="r112 r">typeArg</span>, <span class="i">genericArgumentCount</span>: 0, <span class="i">isAttribute</span>: <b>false</b>);
            }
 
            <b>if</b> (<span class="r111 r">resolved</span>)
            {
                <b>var</b> <span id="r113 rd" class="r113 r">resolvedType</span> = <span class="r109 r">genericTypeName</span>.<a href="ast.cs.html#d837bccc47d979c3" class="i method">GetReflectionType</a>();
                <a href="TypeResolver.cs.html#bfedb6d1965806c6" class="t t">TypeCache</a>.<a href="TypeResolver.cs.html#6553890b1701ceca" class="i method">Add</a>(<span class="r109 r">genericTypeName</span>, <a href="#6a80414177b4d673" class="i field">_typeResolutionState</a>, <span class="r113 r">resolvedType</span>);
            }
 
            <b>return</b> <span class="r111 r">resolved</span>;
        }
 
        <b>public void</b> <a id="4760cbf4b06bc8d9" href="../../R/4760cbf4b06bc8d9.html" target="n" data-glyph="72,1" class="i method">PostVisit</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r114 rd" class="r114 r">ast</span>)
        {
            <span class="r114 r">ast</span>.<a href="ast.cs.html#71efa3501b9475f2" class="i method">Accept</a>(<a href="#b16675caa213893d" class="i field">_symbolResolvePostActionVisitor</a>);
        }
 
        <b>internal static string</b> <a id="23a04f4e5d5ccf22" href="../../R/23a04f4e5d5ccf22.html" target="n" data-glyph="74,1" class="i method">GetModuleQualifiedName</a>(<b>string</b> <span id="r115 rd" class="r115 r">namespaceName</span>, <b>string</b> <span id="r116 rd" class="r116 r">typeName</span>)
        {
            <b>const char</b> <span id="r117 rd" class="r117 r">NAMESPACE_SEPARATOR</span> = <span class="s">&#39;.&#39;</span>;
            <b>return</b> <span class="r115 r">namespaceName</span> + <span class="r117 r">NAMESPACE_SEPARATOR</span> + <span class="r116 r">typeName</span>;
        }
    }
 
    <b>internal class</b> <a id="a4665648688fced0" href="../../R/a4665648688fced0.html" target="n" data-glyph="2,0" class="t t"><span id="0297db153853ae2c">SymbolResolvePostActionVisitor</span></a> : <a href="AstVisitor.cs.html#f97242cf93f58915" class="t t">DefaultCustomAstVisitor2</a>
    {
        <b>internal</b> <a href="#2121410b8db29d18" class="t t">SymbolResolver</a> <a id="d267f9ed45fe1192" href="../../R/d267f9ed45fe1192.html" target="n" data-glyph="44,1" class="i field">_symbolResolver</a>;
 
        <b>public override object</b> <a id="2173f0e80a6ae21d" href="../../R/2173f0e80a6ae21d.html" target="n" data-glyph="72,1" class="i method">VisitFunctionDefinition</a>(<a href="ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r118 rd" class="r118 r">functionDefinitionAst</span>)
        {
            <b>if</b> (<span class="r118 r">functionDefinitionAst</span>.<a href="ast.cs.html#faf9ad7a55f1cc57" class="i property">Parent</a> <b>is not</b> <a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a>)
            {
                <a href="#d267f9ed45fe1192" class="i field">_symbolResolver</a>.<a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#7a8bc3eb2f3f5ceb" class="i method">LeaveScope</a>();
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>public override object</b> <a id="3c65cf6fefd0db60" href="../../R/3c65cf6fefd0db60.html" target="n" data-glyph="72,1" class="i method">VisitScriptBlockExpression</a>(<a href="ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a> <span id="r119 rd" class="r119 r">scriptBlockExpressionAst</span>)
        {
            <a href="#d267f9ed45fe1192" class="i field">_symbolResolver</a>.<a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#7a8bc3eb2f3f5ceb" class="i method">LeaveScope</a>();
            <b>return</b> <b>null</b>;
        }
 
        <b>public override object</b> <a id="192ac0e23d5de3f6" href="../../R/192ac0e23d5de3f6.html" target="n" data-glyph="72,1" class="i method">VisitTypeDefinition</a>(<a href="ast.cs.html#d7f0bc21c0f10879" class="t t">TypeDefinitionAst</a> <span id="r120 rd" class="r120 r">typeDefinitionAst</span>)
        {
            <a href="#d267f9ed45fe1192" class="i field">_symbolResolver</a>.<a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#7a8bc3eb2f3f5ceb" class="i method">LeaveScope</a>();
            <b>return</b> <b>null</b>;
        }
 
        <b>public override object</b> <a id="ea630d1ae9a0cd50" href="../../R/ea630d1ae9a0cd50.html" target="n" data-glyph="72,1" class="i method">VisitFunctionMember</a>(<a href="ast.cs.html#0c4f2db9a681a977" class="t t">FunctionMemberAst</a> <span id="r121 rd" class="r121 r">functionMemberAst</span>)
        {
            <a href="#d267f9ed45fe1192" class="i field">_symbolResolver</a>.<a href="#afa29fa6510795c7" class="i field">_symbolTable</a>.<a href="#7a8bc3eb2f3f5ceb" class="i method">LeaveScope</a>();
            <b>return</b> <b>null</b>;
        }
    }
}
</pre></td></tr></table></div></body></html>
