<!DOCTYPE html>
<html><head><title>Position.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(812);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/parser/Position.cs" target="_top">engine\parser\Position.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Text</span>;
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">STANDALONE</span>
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Internal</span>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>
{
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Public Interfaces
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents a single point in a script.  The script may come from a file or interactive input.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>public interface</b> <a id="fb2ad3feb9004d98" href="../../R/fb2ad3feb9004d98.html" target="n" data-glyph="48,0" class="t t">IScriptPosition</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the file, or if the script did not come from a file, then null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>string</b>? <a id="cfe1a8e9608e5ac4" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">File</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The line number of the position, with the value 1 being the first line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>int</b> <a id="d4acfffbdddc618b" href="../../R/d4acfffbdddc618b.html" target="n" data-glyph="102,1" class="i property">LineNumber</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The column number of the position, with the value 1 being the first column.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>int</b> <a id="adb21ecf0073d187" href="../../R/adb21ecf0073d187.html" target="n" data-glyph="102,1" class="i property">ColumnNumber</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The offset from the beginning of the script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>int</b> <a id="cd3280d5f1045b06" href="../../R/cd3280d5f1045b06.html" target="n" data-glyph="102,1" class="i property">Offset</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The complete text of the line that this position is included on.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>string</b> <a id="5498933e478f6930" href="../../R/5498933e478f6930.html" target="n" data-glyph="102,1" class="i property">Line</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The complete script that this position is included in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>string</b>? <a id="b2c2e7d614605592" href="../../R/b2c2e7d614605592.html" target="n" data-glyph="72,1" class="i method">GetFullScript</a>();
    }
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">restore</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents the a span of text in a script.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">enable</span>
    <b>public interface</b> <a id="bbc751d075344454" href="../../R/bbc751d075344454.html" target="n" data-glyph="48,0" class="t t">IScriptExtent</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The filename the extent includes, or null if the extent is not included in any file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>string</b>? <a id="e933edecd2b0cc1d" href="../../R/e933edecd2b0cc1d.html" target="n" data-glyph="102,1" class="i property">File</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The starting position of the extent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a> <a id="88220ab61fd15a4b" href="../../R/88220ab61fd15a4b.html" target="n" data-glyph="102,1" class="i property">StartScriptPosition</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The end position of the extent.  This position is actually 1 character past the end of the extent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a> <a id="b8cb5655f70ff8ee" href="../../R/b8cb5655f70ff8ee.html" target="n" data-glyph="102,1" class="i property">EndScriptPosition</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The line number at the beginning of the extent, with the value 1 being the first line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>int</b> <a id="cc356dc28b41997d" href="../../R/cc356dc28b41997d.html" target="n" data-glyph="102,1" class="i property">StartLineNumber</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The column number at the beginning of the extent, with the value 1 being the first column.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>int</b> <a id="8fcbdc214acf2f0f" href="../../R/8fcbdc214acf2f0f.html" target="n" data-glyph="102,1" class="i property">StartColumnNumber</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The line number at the end of the extent, with the value 1 being the first line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>int</b> <a id="ccd649a5269e237d" href="../../R/ccd649a5269e237d.html" target="n" data-glyph="102,1" class="i property">EndLineNumber</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The column number at the end of the extent, with the value 1 being the first column.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>int</b> <a id="155675f601d14734" href="../../R/155675f601d14734.html" target="n" data-glyph="102,1" class="i property">EndColumnNumber</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script text that the extent includes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>string</b> <a id="43ce932d9225bc9c" href="../../R/43ce932d9225bc9c.html" target="n" data-glyph="102,1" class="i property">Text</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The starting offset of the extent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>int</b> <a id="14e0029eb01de3bb" href="../../R/14e0029eb01de3bb.html" target="n" data-glyph="102,1" class="i property">StartOffset</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The ending offset of the extent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>int</b> <a id="ca890c6b6bd34ec4" href="../../R/ca890c6b6bd34ec4.html" target="n" data-glyph="102,1" class="i property">EndOffset</a> { <b>get</b>; }
    }
<span class="k preprocess">#</span><span class="k preprocess">nullable</span> <span class="k preprocess">restore</span>
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A few utility functions for script positions.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>internal static class</b> <a id="5892e754643a6045" href="../../R/5892e754643a6045.html" target="n" data-glyph="2,0" class="t t">PositionUtilities</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a unique position representing an empty or missing position.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a> <a id="215709b8a6e59c79" href="../../R/215709b8a6e59c79.html" target="n" data-glyph="102,1" class="i property">EmptyPosition</a> { <b>get</b>; } = <b>new</b> <span class="t">EmptyScriptPosition</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a unique extent representing an empty or missing extent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public static</b> <a href="#bbc751d075344454" class="t t">IScriptExtent</a> <a id="01bfb713b57f7955" href="../../R/01bfb713b57f7955.html" target="n" data-glyph="102,1" class="i property">EmptyExtent</a> { <b>get</b>; } = <b>new</b> <span class="t">EmptyScriptExtent</span>();
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a message that looks like:</span>
        <span class="c">///</span>
        <span class="c">///</span><span class="c">     At {filename}:{line} char:{column}</span>
        <span class="c">///</span><span class="c">     + $x + @y</span>
        <span class="c">///</span><span class="c">     +    ~</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="a5bde72c0431231a" href="../../R/a5bde72c0431231a.html" target="n" data-glyph="74,1" class="i method">VerboseMessage</a>(<a href="#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r0 rd" class="r0 r">position</span>)
        {
            <b>if</b> (<a href="#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="#01bfb713b57f7955" class="i property">EmptyExtent</a>.<span class="i">Equals</span>(<span class="r0 r">position</span>))
            {
                <b>return</b> <b>string</b>.<span class="i">Empty</span>;
            }
 
            <b>string</b> <span id="r1 rd" class="r1 r">fileName</span> = <span class="r0 r">position</span>.<a href="#e933edecd2b0cc1d" class="i property">File</a>;
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r1 r">fileName</span>))
            {
                <span class="r1 r">fileName</span> = <span class="i">ParserStrings</span>.<span class="i">TextForWordLine</span>;
            }
 
            <b>string</b> <span id="r2 rd" class="r2 r">sourceLine</span> = <span class="r0 r">position</span>.<a href="#88220ab61fd15a4b" class="i property">StartScriptPosition</a>.<a href="#5498933e478f6930" class="i property">Line</a>.<span class="i">TrimEnd</span>();
 
            <b>string</b> <span id="r3 rd" class="r3 r">message</span> = <b>string</b>.<span class="i">Empty</span>;
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r2 r">sourceLine</span>))
            {
                <b>int</b> <span id="r4 rd" class="r4 r">spacesBeforeError</span> = <span class="r0 r">position</span>.<a href="#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a> - 1;
                <b>int</b> <span id="r5 rd" class="r5 r">errorLength</span> = (<span class="r0 r">position</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a> == <span class="r0 r">position</span>.<a href="#ccd649a5269e237d" class="i property">EndLineNumber</a> &amp;&amp; <span class="r0 r">position</span>.<a href="#155675f601d14734" class="i property">EndColumnNumber</a> &lt;= <span class="r2 r">sourceLine</span>.<span class="i">Length</span> + 1)
                                      ? <span class="r0 r">position</span>.<a href="#155675f601d14734" class="i property">EndColumnNumber</a> - <span class="r0 r">position</span>.<a href="#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>
                                      : <span class="r2 r">sourceLine</span>.<span class="i">Length</span> - <span class="r0 r">position</span>.<a href="#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a> + 1;
 
                <span class="c">// Expand tabs before figuring out if we need to truncate the line</span>
                <b>if</b> (<span class="r2 r">sourceLine</span>.<span class="i">Contains</span>(<span class="s">&#39;\t&#39;</span>))
                {
                    <b>var</b> <span id="r6 rd" class="r6 r">copyLine</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="r2 r">sourceLine</span>.<span class="i">Length</span> * 2);
 
                    <b>var</b> <span id="r7 rd" class="r7 r">beforeError</span> = <span class="r2 r">sourceLine</span>.<span class="i">Substring</span>(0, <span class="r4 r">spacesBeforeError</span>).<span class="i">Replace</span>(<span class="s">&quot;\t&quot;</span>, <span class="s">&quot;    &quot;</span>);
                    <b>var</b> <span id="r8 rd" class="r8 r">error</span> = <span class="r2 r">sourceLine</span>.<span class="i">Substring</span>(<span class="r4 r">spacesBeforeError</span>, <span class="r5 r">errorLength</span>).<span class="i">Replace</span>(<span class="s">&quot;\t&quot;</span>, <span class="s">&quot;    &quot;</span>);
 
                    <span class="r6 r">copyLine</span>.<span class="i">Append</span>(<span class="r7 r">beforeError</span>);
                    <span class="r6 r">copyLine</span>.<span class="i">Append</span>(<span class="r8 r">error</span>);
                    <span class="r6 r">copyLine</span>.<span class="i">Append</span>(<span class="r2 r">sourceLine</span>.<span class="i">Substring</span>(<span class="r4 r">spacesBeforeError</span> + <span class="r5 r">errorLength</span>).<span class="i">Replace</span>(<span class="s">&quot;\t&quot;</span>, <span class="s">&quot;    &quot;</span>));
 
                    <span class="r4 r">spacesBeforeError</span> = <span class="r7 r">beforeError</span>.<span class="i">Length</span>;
                    <span class="r5 r">errorLength</span> = <span class="r8 r">error</span>.<span class="i">Length</span>;
                    <span class="r2 r">sourceLine</span> = <span class="r6 r">copyLine</span>.<span class="i">ToString</span>();
                }
 
                <span class="c">// Max width is 69 because:</span>
                <span class="c">//   * sometimes PowerShell is opened with width 80</span>
                <span class="c">//   * we always prepend &quot;+ &quot;</span>
                <span class="c">//   * we sometimes prepend &quot;... &quot;</span>
                <span class="c">//   * we sometimes append &quot; ...&quot;</span>
                <span class="c">//   * wrapping kicks in if we hit the width exactly, so -1 to avoid that.</span>
                <b>const int</b> <span id="r9 rd" class="r9 r">maxLineLength</span> = 69;
                <b>bool</b> <span id="r10 rd" class="r10 r">needsPrefixDots</span> = <b>false</b>;
                <b>bool</b> <span id="r11 rd" class="r11 r">needsSuffixDots</span> = <b>false</b>;
 
                <b>int</b> <span id="r12 rd" class="r12 r">lineLength</span> = <span class="r2 r">sourceLine</span>.<span class="i">Length</span>;
                <b>var</b> <span id="r13 rd" class="r13 r">sb</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="r2 r">sourceLine</span>.<span class="i">Length</span> * 2 + 4);
                <b>if</b> (<span class="r12 r">lineLength</span> &gt; <span class="r9 r">maxLineLength</span>)
                {
                    <span class="c">// Need to truncate - include as much of the error as we can, but with</span>
                    <span class="c">// some preceding context if possible.</span>
 
                    <b>int</b> <span id="r14 rd" class="r14 r">totalPrefix</span> = <span class="r4 r">spacesBeforeError</span>;
                    <b>int</b> <span id="r15 rd" class="r15 r">prefix</span> = <span class="i">Math</span>.<span class="i">Min</span>(<span class="r14 r">totalPrefix</span>, 12);
 
                    <b>int</b> <span id="r16 rd" class="r16 r">totalSuffix</span> = <span class="r12 r">lineLength</span> - <span class="r5 r">errorLength</span> - <span class="r4 r">spacesBeforeError</span>;
                    <b>int</b> <span id="r17 rd" class="r17 r">suffix</span> = <span class="i">Math</span>.<span class="i">Min</span>(<span class="r16 r">totalSuffix</span>, 8);
 
                    <b>int</b> <span id="r18 rd" class="r18 r">candidateLength</span> = <span class="r15 r">prefix</span> + <span class="r5 r">errorLength</span> + <span class="r17 r">suffix</span>;
                    <b>if</b> (<span class="r18 r">candidateLength</span> &gt;= <span class="r9 r">maxLineLength</span>)
                    {
                        <span class="c">// Too long.  The suffix is truncated automatically by</span>
                        <span class="c">// the Substring call, but we might need some of the</span>
                        <span class="c">// squiggles removed as well.</span>
                        <b>if</b> (<span class="r15 r">prefix</span> + <span class="r5 r">errorLength</span> &gt;= <span class="r9 r">maxLineLength</span>)
                        {
                            <span class="r5 r">errorLength</span> = <span class="r9 r">maxLineLength</span> - <span class="r15 r">prefix</span>;
                        }
 
                        <span class="r11 r">needsSuffixDots</span> = <b>true</b>;
                    }
                    <b>else</b>
                    {
                        <span class="c">// We can shift prefix to suffix or vice versa to fill in</span>
                        <span class="c">// more of the line.  Prefer shifting to prefix.</span>
                        <b>int</b> <span id="r19 rd" class="r19 r">prefixAvailable</span> = <span class="r14 r">totalPrefix</span> - <span class="r15 r">prefix</span>;
                        <b>if</b> (<span class="r19 r">prefixAvailable</span> &gt; 0)
                        {
                            <span class="r15 r">prefix</span> += <span class="i">Math</span>.<span class="i">Min</span>(<span class="r19 r">prefixAvailable</span>, <span class="r9 r">maxLineLength</span> - <span class="r18 r">candidateLength</span>);
                            <span class="r18 r">candidateLength</span> = <span class="r15 r">prefix</span> + <span class="r5 r">errorLength</span> + <span class="r17 r">suffix</span>;
                        }
 
                        <b>if</b> (<span class="r18 r">candidateLength</span> &lt; <span class="r9 r">maxLineLength</span> &amp;&amp; <span class="r16 r">totalSuffix</span> &gt; 0)
                        {
                            <span class="r17 r">suffix</span> += <span class="i">Math</span>.<span class="i">Min</span>(<span class="r16 r">totalSuffix</span>, <span class="r9 r">maxLineLength</span> - <span class="r18 r">candidateLength</span>);
                        }
 
                        <span class="r11 r">needsSuffixDots</span> = (<span class="r17 r">suffix</span> &lt; <span class="r16 r">totalSuffix</span>);
                    }
 
                    <span class="r10 r">needsPrefixDots</span> = (<span class="r15 r">prefix</span> &lt; <span class="r14 r">totalPrefix</span>);
 
                    <b>var</b> <span id="r20 rd" class="r20 r">startIndex</span> = <span class="i">Math</span>.<span class="i">Max</span>(<span class="r4 r">spacesBeforeError</span> - <span class="r15 r">prefix</span>, 0);
                    <span class="r2 r">sourceLine</span> = <span class="r2 r">sourceLine</span>.<span class="i">Substring</span>(<span class="r20 r">startIndex</span>, <span class="r9 r">maxLineLength</span>);
                    <span class="r4 r">spacesBeforeError</span> = <span class="i">Math</span>.<span class="i">Min</span>(<span class="r4 r">spacesBeforeError</span>, <span class="r15 r">prefix</span>);
                    <span class="r5 r">errorLength</span> = <span class="i">Math</span>.<span class="i">Min</span>(<span class="r5 r">errorLength</span>, <span class="r9 r">maxLineLength</span> - <span class="r4 r">spacesBeforeError</span>);
                }
 
                <b>if</b> (<span class="r10 r">needsPrefixDots</span>)
                {
                    <span class="r13 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;\u2026 &quot;</span>); <span class="c">// Unicode ellipsis character</span>
                }
 
                <span class="r13 r">sb</span>.<span class="i">Append</span>(<span class="r2 r">sourceLine</span>);
 
                <b>if</b> (<span class="r11 r">needsSuffixDots</span>)
                {
                    <span class="r13 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot; \u2026&quot;</span>); <span class="c">// Unicode ellipsis character</span>
                }
 
                <span class="r13 r">sb</span>.<span class="i">Append</span>(<span class="i">Environment</span>.<span class="i">NewLine</span>);
                <span class="r13 r">sb</span>.<span class="i">Append</span>(<span class="s">&quot;+ &quot;</span>);
                <span class="r13 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39; &#39;</span>, <span class="r4 r">spacesBeforeError</span> + (<span class="r10 r">needsPrefixDots</span> ? 2 : 0));
                <span class="c">// errorLength of 0 happens at EOF - always write out 1.</span>
                <span class="r13 r">sb</span>.<span class="i">Append</span>(<span class="s">&#39;~&#39;</span>, <span class="r5 r">errorLength</span> &gt; 0 ? <span class="r5 r">errorLength</span> : 1);
 
                <span class="r3 r">message</span> = <span class="r13 r">sb</span>.<span class="i">ToString</span>();
            }
 
            <b>return</b> <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(
                <span class="i">ParserStrings</span>.<span class="i">TextForPositionMessage</span>,
                <span class="r1 r">fileName</span>,
                <span class="r0 r">position</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a>,
                <span class="r0 r">position</span>.<a href="#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>,
                <span class="r3 r">message</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Return a message that looks like:</span>
        <span class="c">///</span><span class="c">     12+ $x + </span><span class="c">&amp;lt;</span><span class="c">&amp;lt;</span><span class="c">&amp;lt;</span><span class="c">&amp;lt;</span><span class="c"> $b.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>internal static string</b> <a id="1971b4e1913f3b5f" href="../../R/1971b4e1913f3b5f.html" target="n" data-glyph="74,1" class="i method">BriefMessage</a>(<a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a> <span id="r21 rd" class="r21 r">position</span>)
        {
            <span class="i">StringBuilder</span> <span id="r22 rd" class="r22 r">message</span> = <b>new</b> <span class="i">StringBuilder</span>(<span class="r21 r">position</span>.<a href="#5498933e478f6930" class="i property">Line</a>);
            <b>if</b> (<span class="r21 r">position</span>.<a href="#adb21ecf0073d187" class="i property">ColumnNumber</a> &gt; <span class="r22 r">message</span>.<span class="i">Length</span>)
            {
                <span class="r22 r">message</span>.<span class="i">Append</span>(<span class="s">&quot; &lt;&lt;&lt;&lt; &quot;</span>);
            }
            <b>else</b>
            {
                <span class="r22 r">message</span>.<span class="i">Insert</span>(<span class="r21 r">position</span>.<a href="#adb21ecf0073d187" class="i property">ColumnNumber</a> - 1, <span class="s">&quot; &gt;&gt;&gt;&gt; &quot;</span>);
            }
 
            <b>return</b> <a href="../../utils/StringUtil.cs.html#9499fba345e707ac" class="t t">StringUtil</a>.<span class="i">Format</span>(<span class="i">ParserStrings</span>.<span class="i">TraceScriptLineMessage</span>, <span class="r21 r">position</span>.<a href="#d4acfffbdddc618b" class="i property">LineNumber</a>, <span class="r22 r">message</span>.<span class="i">ToString</span>());
        }
 
        <b>internal static</b> <a href="#bbc751d075344454" class="t t">IScriptExtent</a> <a id="3a471aebe5496de1" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">NewScriptExtent</a>(<a href="#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r23 rd" class="r23 r">start</span>, <a href="#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r24 rd" class="r24 r">end</span>)
        {
            <b>if</b> (<span class="r23 r">start</span> == <span class="r24 r">end</span>)
            {
                <b>return</b> <span class="r23 r">start</span>;
            }
 
            <b>if</b> (<span class="r23 r">start</span> == <a href="#01bfb713b57f7955" class="i property">EmptyExtent</a>)
            {
                <b>return</b> <span class="r24 r">end</span>;
            }
 
            <b>if</b> (<span class="r24 r">end</span> == <a href="#01bfb713b57f7955" class="i property">EmptyExtent</a>)
            {
                <b>return</b> <span class="r23 r">start</span>;
            }
 
            <a href="#a988805453837004" class="t t">InternalScriptExtent</a> <span id="r25 rd" class="r25 r">startExtent</span> = <span class="r23 r">start</span> <b>as</b> <a href="#a988805453837004" class="t t">InternalScriptExtent</a>;
            <a href="#a988805453837004" class="t t">InternalScriptExtent</a> <span id="r26 rd" class="r26 r">endExtent</span> = <span class="r24 r">end</span> <b>as</b> <a href="#a988805453837004" class="t t">InternalScriptExtent</a>;
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r25 r">startExtent</span> != <b>null</b> &amp;&amp; <span class="r26 r">endExtent</span> != <b>null</b>, <span class="s">&quot;This function only handles internal and empty extents&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r25 r">startExtent</span>.<a href="#efcbc0d78353af5a" class="i property">PositionHelper</a> == <span class="r26 r">endExtent</span>.<a href="#efcbc0d78353af5a" class="i property">PositionHelper</a>, <span class="s">&quot;Extents must be from same source&quot;</span>);
 
            <b>return</b> <b>new</b> <a href="#0b34c128e3d218a0" class="t constructor">InternalScriptExtent</a>(<span class="r25 r">startExtent</span>.<a href="#efcbc0d78353af5a" class="i property">PositionHelper</a>, <span class="r25 r">startExtent</span>.<a href="#a439c4119678d493" class="i property">StartOffset</a>, <span class="r26 r">endExtent</span>.<a href="#fc9692125234532d" class="i property">EndOffset</a>);
        }
 
        <b>internal static bool</b> <a id="be9d5c916419a157" href="../../R/be9d5c916419a157.html" target="n" data-glyph="221,1" class="i method">IsBefore</a>(<b>this</b> <a href="#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r27 rd" class="r27 r">extentToTest</span>, <a href="#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r28 rd" class="r28 r">startExtent</span>)
        {
            <b>if</b> (<span class="r27 r">extentToTest</span>.<a href="#ccd649a5269e237d" class="i property">EndLineNumber</a> &lt; <span class="r28 r">startExtent</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r27 r">extentToTest</span>.<a href="#ccd649a5269e237d" class="i property">EndLineNumber</a> == <span class="r28 r">startExtent</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a>)
            {
                <b>return</b> <span class="r27 r">extentToTest</span>.<a href="#155675f601d14734" class="i property">EndColumnNumber</a> &lt;= <span class="r28 r">startExtent</span>.<a href="#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>internal static bool</b> <a id="73f0a8e3210ea8f9" href="../../R/73f0a8e3210ea8f9.html" target="n" data-glyph="221,1" class="i method">IsAfter</a>(<b>this</b> <a href="#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r29 rd" class="r29 r">extentToTest</span>, <a href="#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r30 rd" class="r30 r">endExtent</span>)
        {
            <b>if</b> (<span class="r29 r">extentToTest</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a> &gt; <span class="r30 r">endExtent</span>.<a href="#ccd649a5269e237d" class="i property">EndLineNumber</a>)
            {
                <b>return</b> <b>true</b>;
            }
 
            <b>if</b> (<span class="r29 r">extentToTest</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a> == <span class="r30 r">endExtent</span>.<a href="#ccd649a5269e237d" class="i property">EndLineNumber</a>)
            {
                <b>return</b> <span class="r29 r">extentToTest</span>.<a href="#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a> &gt;= <span class="r30 r">endExtent</span>.<a href="#155675f601d14734" class="i property">EndColumnNumber</a>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>internal static bool</b> <a id="82c1f5e7b0f904bc" href="../../R/82c1f5e7b0f904bc.html" target="n" data-glyph="221,1" class="i method">IsWithin</a>(<b>this</b> <a href="#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r31 rd" class="r31 r">extentToTest</span>, <a href="#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r32 rd" class="r32 r">extent</span>)
        {
            <b>return</b> <span class="r31 r">extentToTest</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a> &gt;= <span class="r32 r">extent</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a> &amp;&amp;
                   <span class="r31 r">extentToTest</span>.<a href="#ccd649a5269e237d" class="i property">EndLineNumber</a> &lt;= <span class="r32 r">extent</span>.<a href="#ccd649a5269e237d" class="i property">EndLineNumber</a> &amp;&amp;
                   <span class="r31 r">extentToTest</span>.<a href="#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a> &gt;= <span class="r32 r">extent</span>.<a href="#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a> &amp;&amp;
                   <span class="r31 r">extentToTest</span>.<a href="#155675f601d14734" class="i property">EndColumnNumber</a> &lt;= <span class="r32 r">extent</span>.<a href="#155675f601d14734" class="i property">EndColumnNumber</a>;
        }
 
        <b>internal static bool</b> <a id="9108f27478721caf" href="../../R/9108f27478721caf.html" target="n" data-glyph="221,1" class="i method">IsAfter</a>(<b>this</b> <a href="#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r33 rd" class="r33 r">extent</span>, <b>int</b> <span id="r34 rd" class="r34 r">line</span>, <b>int</b> <span id="r35 rd" class="r35 r">column</span>)
        {
            <b>if</b> (<span class="r34 r">line</span> &lt; <span class="r33 r">extent</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a>)
                <b>return</b> <b>true</b>;
 
            <b>return</b> (<span class="r34 r">line</span> == <span class="r33 r">extent</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a> &amp;&amp; <span class="r35 r">column</span> &lt; <span class="r33 r">extent</span>.<a href="#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>);
        }
 
        <b>internal static bool</b> <a id="065318b7ef648f38" href="../../R/065318b7ef648f38.html" target="n" data-glyph="221,1" class="i method">ContainsLineAndColumn</a>(<b>this</b> <a href="#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r36 rd" class="r36 r">extent</span>, <b>int</b> <span id="r37 rd" class="r37 r">line</span>, <b>int</b> <span id="r38 rd" class="r38 r">column</span>)
        {
            <b>if</b> (<span class="r36 r">extent</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a> == <span class="r37 r">line</span>)
            {
                <b>if</b> (<span class="r38 r">column</span> == 0) <b>return</b> <b>true</b>;
                <b>if</b> (<span class="r38 r">column</span> &gt;= <span class="r36 r">extent</span>.<a href="#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>)
                {
                    <b>if</b> (<span class="r36 r">extent</span>.<a href="#ccd649a5269e237d" class="i property">EndLineNumber</a> != <span class="r36 r">extent</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a>) <b>return</b> <b>true</b>;
                    <b>return</b> (<span class="r38 r">column</span> &lt; <span class="r36 r">extent</span>.<a href="#155675f601d14734" class="i property">EndColumnNumber</a>);
                }
 
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (<span class="r36 r">extent</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a> &gt; <span class="r37 r">line</span>)
                <b>return</b> <b>false</b>;
 
            <b>if</b> (<span class="r37 r">line</span> &gt; <span class="r36 r">extent</span>.<a href="#ccd649a5269e237d" class="i property">EndLineNumber</a>)
                <b>return</b> <b>false</b>;
 
            <b>if</b> (<span class="r36 r">extent</span>.<a href="#ccd649a5269e237d" class="i property">EndLineNumber</a> == <span class="r37 r">line</span>)
                <b>return</b> <span class="r38 r">column</span> &lt; <span class="r36 r">extent</span>.<a href="#155675f601d14734" class="i property">EndColumnNumber</a>;
 
            <b>return</b> <b>true</b>;
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Public Interfaces
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Internal Position
 
    <b>internal class</b> <a id="6f2c232523d08297" href="../../R/6f2c232523d08297.html" target="n" data-glyph="2,0" class="t t">PositionHelper</a>
    {
        <b>private int</b>[] <a id="71038c3dd8e509da" href="../../R/71038c3dd8e509da.html" target="n" data-glyph="46,1" class="i field">_lineStartMap</a>;
 
        <b>internal</b> <a id="ba46960c6cb6885b" href="../../R/ba46960c6cb6885b.html" target="n" data-glyph="74,1" class="t constructor">PositionHelper</a>(<b>string</b> <span id="r39 rd" class="r39 r">filename</span>, <b>string</b> <span id="r40 rd" class="r40 r">scriptText</span>)
        {
            <a href="#0bd2236adba4af04" class="i property">File</a> = <span class="r39 r">filename</span>;
            <a href="#958ffb1fac11c41f" class="i property">ScriptText</a> = <span class="r40 r">scriptText</span>;
        }
 
        <b>internal string</b> <a id="958ffb1fac11c41f" href="../../R/958ffb1fac11c41f.html" target="n" data-glyph="104,1" class="i property">ScriptText</a> { <b>get</b>; }
 
        <b>internal int</b>[] <a id="36517953a6b4b4e9" href="../../R/36517953a6b4b4e9.html" target="n" data-glyph="104,1" class="i property">LineStartMap</a>
        {
            <b>set</b> { <a href="#71038c3dd8e509da" class="i field">_lineStartMap</a> = <b>value</b>; }
        }
 
        <b>public string</b> <a id="0bd2236adba4af04" href="../../R/0bd2236adba4af04.html" target="n" data-glyph="102,1" class="i property">File</a> { <b>get</b>; }
 
        <b>internal int</b> <a id="f9392ccbd51676a8" href="../../R/f9392ccbd51676a8.html" target="n" data-glyph="74,1" class="i method">LineFromOffset</a>(<b>int</b> <span id="r41 rd" class="r41 r">offset</span>)
        {
            <b>int</b> <span id="r42 rd" class="r42 r">line</span> = <span class="i">Array</span>.<span class="i">BinarySearch</span>&lt;<b>int</b>&gt;(<a href="#71038c3dd8e509da" class="i field">_lineStartMap</a>, <span class="r41 r">offset</span>);
            <b>if</b> (<span class="r42 r">line</span> &lt; 0)
            {
                <span class="r42 r">line</span> = ~<span class="r42 r">line</span> - 1;
            }
 
            <b>return</b> <span class="r42 r">line</span> + 1;
        }
 
        <b>internal int</b> <a id="d1096135d6c1dc2b" href="../../R/d1096135d6c1dc2b.html" target="n" data-glyph="74,1" class="i method">ColumnFromOffset</a>(<b>int</b> <span id="r43 rd" class="r43 r">offset</span>)
        {
            <b>return</b> <span class="r43 r">offset</span> - <a href="#71038c3dd8e509da" class="i field">_lineStartMap</a>[<a href="#f9392ccbd51676a8" class="i method">LineFromOffset</a>(<span class="r43 r">offset</span>) - 1] + 1;
        }
 
        <b>internal string</b> <a id="645fe79f88b67081" href="../../R/645fe79f88b67081.html" target="n" data-glyph="74,1" class="i method">Text</a>(<b>int</b> <span id="r44 rd" class="r44 r">line</span>)
        {
            <b>int</b> <span id="r45 rd" class="r45 r">start</span> = <a href="#71038c3dd8e509da" class="i field">_lineStartMap</a>[<span class="r44 r">line</span> - 1];
            <b>if</b> (<span class="r44 r">line</span> &lt; <a href="#71038c3dd8e509da" class="i field">_lineStartMap</a>.<span class="i">Length</span>)
            {
                <b>int</b> <span id="r46 rd" class="r46 r">length</span> = <a href="#71038c3dd8e509da" class="i field">_lineStartMap</a>[<span class="r44 r">line</span>] - <span class="r45 r">start</span>;
                <b>return</b> <a href="#958ffb1fac11c41f" class="i property">ScriptText</a>.<span class="i">Substring</span>(<span class="r45 r">start</span>, <span class="r46 r">length</span>);
            }
 
            <b>return</b> <a href="#958ffb1fac11c41f" class="i property">ScriptText</a>.<span class="i">Substring</span>(<span class="r45 r">start</span>);
        }
    }
 
    <b>internal sealed class</b> <a id="ded1553e3f2b51f3" href="../../R/ded1553e3f2b51f3.html" target="n" data-glyph="2,0" class="t t">InternalScriptPosition</a> : <a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a>
    {
        <b>private readonly</b> <a href="#6f2c232523d08297" class="t t">PositionHelper</a> <a id="3ae4f955a5855f4f" href="../../R/3ae4f955a5855f4f.html" target="n" data-glyph="46,1" class="i field">_positionHelper</a>;
 
        <b>internal</b> <a id="b19bdcc105c3cc54" href="../../R/b19bdcc105c3cc54.html" target="n" data-glyph="74,1" class="t constructor">InternalScriptPosition</a>(<a href="#6f2c232523d08297" class="t t">PositionHelper</a> <span id="r47 rd" class="r47 r">_positionHelper</span>, <b>int</b> <span id="r48 rd" class="r48 r">offset</span>)
        {
            <a href="#ded1553e3f2b51f3" class="k">this</a>.<a href="#3ae4f955a5855f4f" class="i field">_positionHelper</a> = <span class="r47 r">_positionHelper</span>;
            <a href="#ae983dad2327d7fd" class="i property">Offset</a> = <span class="r48 r">offset</span>;
        }
 
        <b>public string</b> <a id="303013cf2592c86f" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">File</a> { <b>get</b> { <b>return</b> <a href="#3ae4f955a5855f4f" class="i field">_positionHelper</a>.<a href="#0bd2236adba4af04" class="i property">File</a>; } }
 
        <b>public int</b> <a id="a47344765b95bb24" href="../../R/a47344765b95bb24.html" target="n" data-glyph="102,1" class="i property">LineNumber</a> { <b>get</b> { <b>return</b> <a href="#3ae4f955a5855f4f" class="i field">_positionHelper</a>.<a href="#f9392ccbd51676a8" class="i method">LineFromOffset</a>(<a href="#ae983dad2327d7fd" class="i property">Offset</a>); } }
 
        <b>public int</b> <a id="8439168fb445ca23" href="../../R/8439168fb445ca23.html" target="n" data-glyph="102,1" class="i property">ColumnNumber</a> { <b>get</b> { <b>return</b> <a href="#3ae4f955a5855f4f" class="i field">_positionHelper</a>.<a href="#d1096135d6c1dc2b" class="i method">ColumnFromOffset</a>(<a href="#ae983dad2327d7fd" class="i property">Offset</a>); } }
 
        <b>public string</b> <a id="af6d09e63ea9cf69" href="../../R/af6d09e63ea9cf69.html" target="n" data-glyph="102,1" class="i property">Line</a> { <b>get</b> { <b>return</b> <a href="#3ae4f955a5855f4f" class="i field">_positionHelper</a>.<a href="#645fe79f88b67081" class="i method">Text</a>(<a href="#a47344765b95bb24" class="i property">LineNumber</a>); } }
 
        <b>public int</b> <a id="ae983dad2327d7fd" href="../../R/ae983dad2327d7fd.html" target="n" data-glyph="102,1" class="i property">Offset</a> { <b>get</b>; }
 
        <b>internal</b> <a href="#ded1553e3f2b51f3" class="t t">InternalScriptPosition</a> <a id="5e4a9fe01b81c852" href="../../R/5e4a9fe01b81c852.html" target="n" data-glyph="74,1" class="i method">CloneWithNewOffset</a>(<b>int</b> <span id="r49 rd" class="r49 r">offset</span>)
        {
            <b>return</b> <b>new</b> <a href="#b19bdcc105c3cc54" class="t constructor">InternalScriptPosition</a>(<a href="#3ae4f955a5855f4f" class="i field">_positionHelper</a>, <span class="r49 r">offset</span>);
        }
 
        <b>public string</b> <a id="6be89d1cfde9b503" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetFullScript</a>()
        {
            <b>return</b> <a href="#3ae4f955a5855f4f" class="i field">_positionHelper</a>.<a href="#958ffb1fac11c41f" class="i property">ScriptText</a>;
        }
    }
 
    <b>internal sealed class</b> <a id="a988805453837004" href="../../R/a988805453837004.html" target="n" data-glyph="2,0" class="t t">InternalScriptExtent</a> : <a href="#bbc751d075344454" class="t t">IScriptExtent</a>
    {
        <b>internal</b> <a id="0b34c128e3d218a0" href="../../R/0b34c128e3d218a0.html" target="n" data-glyph="74,1" class="t constructor">InternalScriptExtent</a>(<a href="#6f2c232523d08297" class="t t">PositionHelper</a> <span id="r50 rd" class="r50 r">_positionHelper</span>, <b>int</b> <span id="r51 rd" class="r51 r">startOffset</span>, <b>int</b> <span id="r52 rd" class="r52 r">endOffset</span>)
        {
            <a href="#a988805453837004" class="k">this</a>.<a href="#efcbc0d78353af5a" class="i property">PositionHelper</a> = <span class="r50 r">_positionHelper</span>;
            <a href="#a439c4119678d493" class="i property">StartOffset</a> = <span class="r51 r">startOffset</span>;
            <a href="#fc9692125234532d" class="i property">EndOffset</a> = <span class="r52 r">endOffset</span>;
        }
 
        <b>public string</b> <a id="098ec3639c171673" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">File</a>
        {
            <b>get</b> { <b>return</b> <a href="#efcbc0d78353af5a" class="i property">PositionHelper</a>.<a href="#0bd2236adba4af04" class="i property">File</a>; }
        }
 
        <b>public</b> <a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a> <a id="85043a9b36669ec9" href="../../R/85043a9b36669ec9.html" target="n" data-glyph="102,1" class="i property">StartScriptPosition</a>
        {
            <b>get</b> { <b>return</b> <b>new</b> <a href="#b19bdcc105c3cc54" class="t constructor">InternalScriptPosition</a>(<a href="#efcbc0d78353af5a" class="i property">PositionHelper</a>, <a href="#a439c4119678d493" class="i property">StartOffset</a>); }
        }
 
        <b>public</b> <a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a> <a id="ddce00d8783a5b39" href="../../R/ddce00d8783a5b39.html" target="n" data-glyph="102,1" class="i property">EndScriptPosition</a>
        {
            <b>get</b> { <b>return</b> <b>new</b> <a href="#b19bdcc105c3cc54" class="t constructor">InternalScriptPosition</a>(<a href="#efcbc0d78353af5a" class="i property">PositionHelper</a>, <a href="#fc9692125234532d" class="i property">EndOffset</a>); }
        }
 
        <b>public int</b> <a id="01a0eaead9519b6b" href="../../R/01a0eaead9519b6b.html" target="n" data-glyph="102,1" class="i property">StartLineNumber</a>
        {
            <b>get</b> { <b>return</b> <a href="#efcbc0d78353af5a" class="i property">PositionHelper</a>.<a href="#f9392ccbd51676a8" class="i method">LineFromOffset</a>(<a href="#a439c4119678d493" class="i property">StartOffset</a>); }
        }
 
        <b>public int</b> <a id="6f6435861543116e" href="../../R/6f6435861543116e.html" target="n" data-glyph="102,1" class="i property">StartColumnNumber</a>
        {
            <b>get</b> { <b>return</b> <a href="#efcbc0d78353af5a" class="i property">PositionHelper</a>.<a href="#d1096135d6c1dc2b" class="i method">ColumnFromOffset</a>(<a href="#a439c4119678d493" class="i property">StartOffset</a>); }
        }
 
        <b>public int</b> <a id="8abff0fc84ac08a0" href="../../R/8abff0fc84ac08a0.html" target="n" data-glyph="102,1" class="i property">EndLineNumber</a>
        {
            <b>get</b> { <b>return</b> <a href="#efcbc0d78353af5a" class="i property">PositionHelper</a>.<a href="#f9392ccbd51676a8" class="i method">LineFromOffset</a>(<a href="#fc9692125234532d" class="i property">EndOffset</a>); }
        }
 
        <b>public int</b> <a id="16f8441f4b0d6df7" href="../../R/16f8441f4b0d6df7.html" target="n" data-glyph="102,1" class="i property">EndColumnNumber</a>
        {
            <b>get</b> { <b>return</b> <a href="#efcbc0d78353af5a" class="i property">PositionHelper</a>.<a href="#d1096135d6c1dc2b" class="i method">ColumnFromOffset</a>(<a href="#fc9692125234532d" class="i property">EndOffset</a>); }
        }
 
        <b>public string</b> <a id="a15f0499578d1f1d" href="../../R/a15f0499578d1f1d.html" target="n" data-glyph="102,1" class="i property">Text</a>
        {
            <b>get</b>
            {
                <span class="c">// StartOffset can be &gt; the length for the EOF token.</span>
                <b>if</b> (<a href="#a439c4119678d493" class="i property">StartOffset</a> &gt; <a href="#efcbc0d78353af5a" class="i property">PositionHelper</a>.<a href="#958ffb1fac11c41f" class="i property">ScriptText</a>.<span class="i">Length</span>)
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
 
                <b>return</b> <a href="#efcbc0d78353af5a" class="i property">PositionHelper</a>.<a href="#958ffb1fac11c41f" class="i property">ScriptText</a>.<span class="i">Substring</span>(<a href="#a439c4119678d493" class="i property">StartOffset</a>, <a href="#fc9692125234532d" class="i property">EndOffset</a> - <a href="#a439c4119678d493" class="i property">StartOffset</a>);
            }
        }
 
        <b>public override string</b> <a id="d2868e1bed82e2d1" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="#a15f0499578d1f1d" class="i property">Text</a>;
        }
 
        <b>internal</b> <a href="#6f2c232523d08297" class="t t">PositionHelper</a> <a id="efcbc0d78353af5a" href="../../R/efcbc0d78353af5a.html" target="n" data-glyph="104,1" class="i property">PositionHelper</a> { <b>get</b>; }
 
        <b>public int</b> <a id="a439c4119678d493" href="../../R/a439c4119678d493.html" target="n" data-glyph="102,1" class="i property">StartOffset</a> { <b>get</b>; }
 
        <b>public int</b> <a id="fc9692125234532d" href="../../R/fc9692125234532d.html" target="n" data-glyph="102,1" class="i property">EndOffset</a> { <b>get</b>; }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Internal Position
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;Empty&quot; Positions
 
    <b>internal sealed class</b> <a id="194c995932d4f48f" href="../../R/../../0000000000.html" target="n" data-glyph="2,0" class="t t"><span id="65f9b3f6b308265c">EmptyScriptPosition</span></a> : <a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a>
    {
        <b>public string</b> <a id="70ef3b57f6739ea4" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">File</a> { <b>get</b> { <b>return</b> <b>null</b>; } }
 
        <b>public int</b> <a id="7558d00e5873fd2c" href="../../R/7558d00e5873fd2c.html" target="n" data-glyph="102,1" class="i property">LineNumber</a> { <b>get</b> { <b>return</b> 0; } }
 
        <b>public int</b> <a id="55cea132952a37bd" href="../../R/55cea132952a37bd.html" target="n" data-glyph="102,1" class="i property">ColumnNumber</a> { <b>get</b> { <b>return</b> 0; } }
 
        <b>public int</b> <a id="3738892123c52ba5" href="../../R/3738892123c52ba5.html" target="n" data-glyph="102,1" class="i property">Offset</a> { <b>get</b> { <b>return</b> 0; } }
 
        <b>public string</b> <a id="c3c2f043318ae62b" href="../../R/c3c2f043318ae62b.html" target="n" data-glyph="102,1" class="i property">Line</a> { <b>get</b> { <b>return</b> <b>string</b>.<span class="i">Empty</span>; } }
 
        <b>public string</b> <a id="8b362488d183e973" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetFullScript</a>() { <b>return</b> <b>null</b>; }
    }
 
    <b>internal sealed class</b> <a id="9b361bb7f5af38a5" href="../../R/9b361bb7f5af38a5.html" target="n" data-glyph="2,0" class="t t"><span id="b7b930505091120f">EmptyScriptExtent</span></a> : <a href="#bbc751d075344454" class="t t">IScriptExtent</a>
    {
        <b>public string</b> <a id="bf1535f6b87be7b5" href="../../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">File</a> { <b>get</b> { <b>return</b> <b>null</b>; } }
 
        <b>public</b> <a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a> <a id="949fe3f57227ffc1" href="../../R/949fe3f57227ffc1.html" target="n" data-glyph="102,1" class="i property">StartScriptPosition</a> { <b>get</b> { <b>return</b> <a href="#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="#215709b8a6e59c79" class="i property">EmptyPosition</a>; } }
 
        <b>public</b> <a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a> <a id="584920dc279d4f5b" href="../../R/584920dc279d4f5b.html" target="n" data-glyph="102,1" class="i property">EndScriptPosition</a> { <b>get</b> { <b>return</b> <a href="#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="#215709b8a6e59c79" class="i property">EmptyPosition</a>; } }
 
        <b>public int</b> <a id="51e9f064b90c3f37" href="../../R/51e9f064b90c3f37.html" target="n" data-glyph="102,1" class="i property">StartLineNumber</a> { <b>get</b> { <b>return</b> 0; } }
 
        <b>public int</b> <a id="7b2dde0f959b0729" href="../../R/7b2dde0f959b0729.html" target="n" data-glyph="102,1" class="i property">StartColumnNumber</a> { <b>get</b> { <b>return</b> 0; } }
 
        <b>public int</b> <a id="8512a35a617f6fb7" href="../../R/8512a35a617f6fb7.html" target="n" data-glyph="102,1" class="i property">EndLineNumber</a> { <b>get</b> { <b>return</b> 0; } }
 
        <b>public int</b> <a id="602666f8efa37e30" href="../../R/602666f8efa37e30.html" target="n" data-glyph="102,1" class="i property">EndColumnNumber</a> { <b>get</b> { <b>return</b> 0; } }
 
        <b>public int</b> <a id="bd71063ebf3a870c" href="../../R/bd71063ebf3a870c.html" target="n" data-glyph="102,1" class="i property">StartOffset</a> { <b>get</b> { <b>return</b> 0; } }
 
        <b>public int</b> <a id="1caf2aea79a07b20" href="../../R/1caf2aea79a07b20.html" target="n" data-glyph="102,1" class="i property">EndOffset</a> { <b>get</b> { <b>return</b> 0; } }
 
        <b>public string</b> <a id="e9bd9b6a4162f125" href="../../R/e9bd9b6a4162f125.html" target="n" data-glyph="102,1" class="i property">Text</a> { <b>get</b> { <b>return</b> <b>string</b>.<span class="i">Empty</span>; } }
 
        <b>public override bool</b> <a id="f59305e56467d18a" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Equals</a>(<b>object</b> <span id="r53 rd" class="r53 r">obj</span>)
        {
            <b>if</b> (!(<span class="r53 r">obj</span> <b>is</b> <a href="#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r54 rd" class="r54 r">otherPosition</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> ((<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r54 r">otherPosition</span>.<a href="#e933edecd2b0cc1d" class="i property">File</a>)) &amp;&amp;
                (<span class="r54 r">otherPosition</span>.<a href="#cc356dc28b41997d" class="i property">StartLineNumber</a> == <a href="#51e9f064b90c3f37" class="i property">StartLineNumber</a>) &amp;&amp;
                (<span class="r54 r">otherPosition</span>.<a href="#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a> == <a href="#7b2dde0f959b0729" class="i property">StartColumnNumber</a>) &amp;&amp;
                (<span class="r54 r">otherPosition</span>.<a href="#ccd649a5269e237d" class="i property">EndLineNumber</a> == <a href="#8512a35a617f6fb7" class="i property">EndLineNumber</a>) &amp;&amp;
                (<span class="r54 r">otherPosition</span>.<a href="#155675f601d14734" class="i property">EndColumnNumber</a> == <a href="#602666f8efa37e30" class="i property">EndColumnNumber</a>) &amp;&amp;
                (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r54 r">otherPosition</span>.<a href="#43ce932d9225bc9c" class="i property">Text</a>)))
            {
                <b>return</b> <b>true</b>;
            }
            <b>else</b>
            {
                <b>return</b> <b>false</b>;
            }
        }
 
        <b>public override int</b> <a id="fbe1edbf968511b6" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHashCode</a>()
        {
            <b>return</b> <b>base</b>.<span class="i">GetHashCode</span>();
        }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> &quot;Empty&quot; Positions
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> Represents a single point in a script.  The script may come from a file or interactive input.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="391058fa374c4cba" href="../../R/391058fa374c4cba.html" target="n" data-glyph="0,0" class="t t">ScriptPosition</a> : <a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a>
    {
        <b>private readonly string</b> <a id="d59600bfea453028" href="../../R/d59600bfea453028.html" target="n" data-glyph="46,1" class="i field">_fullScript</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new script position, which represents a point in a script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r55 r">scriptName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the file, or if the script did not come from a file, then null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r56 r">scriptLineNumber</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The line number of the position, with the value 1 being the first line.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r57 r">offsetInLine</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The column number of the position, with the value 1 being the first column.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r58 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The complete text of the line that this position is included on.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>)]
        <b>public</b> <a id="40eb7f8097372724" href="../../R/40eb7f8097372724.html" target="n" data-glyph="72,1" class="t constructor">ScriptPosition</a>(<b>string</b> <span id="r55 rd" class="r55 r">scriptName</span>, <b>int</b> <span id="r56 rd" class="r56 r">scriptLineNumber</span>, <b>int</b> <span id="r57 rd" class="r57 r">offsetInLine</span>, <b>string</b> <span id="r58 rd" class="r58 r">line</span>)
        {
            <a href="#84857ca2fe98ae7d" class="i property">File</a> = <span class="r55 r">scriptName</span>;
            <a href="#342f2d7621fb1fe0" class="i property">LineNumber</a> = <span class="r56 r">scriptLineNumber</span>;
            <a href="#802740858436a96c" class="i property">ColumnNumber</a> = <span class="r57 r">offsetInLine</span>;
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r58 r">line</span>))
            {
                <a href="#5c545a423a81bc47" class="i property">Line</a> = <b>string</b>.<span class="i">Empty</span>;
            }
            <b>else</b>
            {
                <a href="#5c545a423a81bc47" class="i property">Line</a> = <span class="r58 r">line</span>;
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new script position, which represents a point in a script.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r59 r">scriptName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the file, or if the script did not come from a file, then null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r60 r">scriptLineNumber</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The line number of the position, with the value 1 being the first line.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r61 r">offsetInLine</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The column number of the position, with the value 1 being the first column.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r62 r">line</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The complete text of the line that this position is included on.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r63 r">fullScript</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The complete script text.  Optional, can be null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i">SuppressMessage</span>(<span class="s">&quot;Microsoft.Naming&quot;</span>, <span class="s">&quot;CA1702:CompoundWordsShouldBeCasedCorrectly&quot;</span>)]
        <b>public</b> <a id="9d3079b4badc16cd" href="../../R/9d3079b4badc16cd.html" target="n" data-glyph="72,1" class="t constructor">ScriptPosition</a>(
            <b>string</b> <span id="r59 rd" class="r59 r">scriptName</span>,
            <b>int</b> <span id="r60 rd" class="r60 r">scriptLineNumber</span>,
            <b>int</b> <span id="r61 rd" class="r61 r">offsetInLine</span>,
            <b>string</b> <span id="r62 rd" class="r62 r">line</span>,
            <b>string</b> <span id="r63 rd" class="r63 r">fullScript</span>)
            : <a href="#40eb7f8097372724" class="k">this</a>(<span class="r59 r">scriptName</span>, <span class="r60 r">scriptLineNumber</span>, <span class="r61 r">offsetInLine</span>, <span class="r62 r">line</span>)
        {
            <a href="#d59600bfea453028" class="i field">_fullScript</a> = <span class="r63 r">fullScript</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the file, or if the script did not come from a file, then null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="84857ca2fe98ae7d" href="../../R/84857ca2fe98ae7d.html" target="n" data-glyph="102,1" class="i property">File</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The line number of the position, with the value 1 being the first line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="342f2d7621fb1fe0" href="../../R/342f2d7621fb1fe0.html" target="n" data-glyph="102,1" class="i property">LineNumber</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The column number of the position, with the value 1 being the first column.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="802740858436a96c" href="../../R/802740858436a96c.html" target="n" data-glyph="102,1" class="i property">ColumnNumber</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The offset from the beginning of the script, always return 0.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="c07325c47be541c5" href="../../R/c07325c47be541c5.html" target="n" data-glyph="102,1" class="i property">Offset</a> { <b>get</b> { <b>return</b> 0; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The complete text of the line that this position is included on.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="5c545a423a81bc47" href="../../R/5c545a423a81bc47.html" target="n" data-glyph="102,1" class="i property">Line</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The complete script that this position is included in.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="1cb25c8fc8dc1534" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetFullScript</a>() { <b>return</b> <a href="#d59600bfea453028" class="i field">_fullScript</a>; }
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> A script extent used to customize the display of error location information.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="2baf81cbd0f80531" href="../../R/2baf81cbd0f80531.html" target="n" data-glyph="0,0" class="t t">ScriptExtent</a> : <a href="#bbc751d075344454" class="t t">IScriptExtent</a>
    {
        <b>private</b> <a href="#391058fa374c4cba" class="t t">ScriptPosition</a> <a id="b397dad66e3b7ed6" href="../../R/b397dad66e3b7ed6.html" target="n" data-glyph="46,1" class="i field">_startPosition</a>;
        <b>private</b> <a href="#391058fa374c4cba" class="t t">ScriptPosition</a> <a id="da67709ab58e9657" href="../../R/da67709ab58e9657.html" target="n" data-glyph="46,1" class="i field">_endPosition</a>;
 
        <b>private</b> <a id="a12e7c1380e5c9d4" href="../../R/a12e7c1380e5c9d4.html" target="n" data-glyph="76,1" class="t constructor">ScriptExtent</a>()
        {
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new ScriptExtent class.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a id="da6958ef7491b809" href="../../R/da6958ef7491b809.html" target="n" data-glyph="72,1" class="t constructor">ScriptExtent</a>(<a href="#391058fa374c4cba" class="t t">ScriptPosition</a> <span id="r64 rd" class="r64 r">startPosition</span>, <a href="#391058fa374c4cba" class="t t">ScriptPosition</a> <span id="r65 rd" class="r65 r">endPosition</span>)
        {
            <a href="#b397dad66e3b7ed6" class="i field">_startPosition</a> = <span class="r64 r">startPosition</span>;
            <a href="#da67709ab58e9657" class="i field">_endPosition</a> = <span class="r65 r">endPosition</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The name of the file, or if the script did not come from a file, then null.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="5101338d68d9177e" href="../../R/5101338d68d9177e.html" target="n" data-glyph="102,1" class="i property">File</a> { <b>get</b> { <b>return</b> <a href="#b397dad66e3b7ed6" class="i field">_startPosition</a>.<a href="#84857ca2fe98ae7d" class="i property">File</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The starting position of the extent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a> <a id="889144243666d3df" href="../../R/889144243666d3df.html" target="n" data-glyph="102,1" class="i property">StartScriptPosition</a> { <b>get</b> { <b>return</b> <a href="#b397dad66e3b7ed6" class="i field">_startPosition</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The end position of the extent.  This position is actually 1 character past the end of the extent.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="#fb2ad3feb9004d98" class="t t">IScriptPosition</a> <a id="6660284eb1fd2eb0" href="../../R/6660284eb1fd2eb0.html" target="n" data-glyph="102,1" class="i property">EndScriptPosition</a> { <b>get</b> { <b>return</b> <a href="#da67709ab58e9657" class="i field">_endPosition</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The line number at the beginning of the extent, with the value 1 being the first line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="23a9fa406db010c3" href="../../R/23a9fa406db010c3.html" target="n" data-glyph="102,1" class="i property">StartLineNumber</a> { <b>get</b> { <b>return</b> <a href="#b397dad66e3b7ed6" class="i field">_startPosition</a>.<a href="#342f2d7621fb1fe0" class="i property">LineNumber</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The column number at the beginning of the extent, with the value 1 being the first column.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="3884396a31d405f0" href="../../R/3884396a31d405f0.html" target="n" data-glyph="102,1" class="i property">StartColumnNumber</a> { <b>get</b> { <b>return</b> <a href="#b397dad66e3b7ed6" class="i field">_startPosition</a>.<a href="#802740858436a96c" class="i property">ColumnNumber</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The line number at the end of the extent, with the value 1 being the first line.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="a8bd4a42c78f45c4" href="../../R/a8bd4a42c78f45c4.html" target="n" data-glyph="102,1" class="i property">EndLineNumber</a> { <b>get</b> { <b>return</b> <a href="#da67709ab58e9657" class="i field">_endPosition</a>.<a href="#342f2d7621fb1fe0" class="i property">LineNumber</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The column number at the end of the extent, with the value 1 being the first column.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="4fb6265973014bdd" href="../../R/4fb6265973014bdd.html" target="n" data-glyph="102,1" class="i property">EndColumnNumber</a> { <b>get</b> { <b>return</b> <a href="#da67709ab58e9657" class="i field">_endPosition</a>.<a href="#802740858436a96c" class="i property">ColumnNumber</a>; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The start offset (always returns 0)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="e7f642f5777b8a02" href="../../R/e7f642f5777b8a02.html" target="n" data-glyph="102,1" class="i property">StartOffset</a> { <b>get</b> { <b>return</b> 0; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The end offset (always returns 0)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public int</b> <a id="168aaedd6758a476" href="../../R/168aaedd6758a476.html" target="n" data-glyph="102,1" class="i property">EndOffset</a> { <b>get</b> { <b>return</b> 0; } }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> The script text that the extent includes.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="9a92aecc05d826e3" href="../../R/9a92aecc05d826e3.html" target="n" data-glyph="102,1" class="i property">Text</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#4fb6265973014bdd" class="i property">EndColumnNumber</a> &gt; 0)
                {
                    <b>if</b> (<a href="#23a9fa406db010c3" class="i property">StartLineNumber</a> == <a href="#a8bd4a42c78f45c4" class="i property">EndLineNumber</a>)
                    {
                        <b>return</b> <a href="#b397dad66e3b7ed6" class="i field">_startPosition</a>.<a href="#5c545a423a81bc47" class="i property">Line</a>.<span class="i">Substring</span>(<a href="#b397dad66e3b7ed6" class="i field">_startPosition</a>.<a href="#802740858436a96c" class="i property">ColumnNumber</a> - 1,
                                                             <a href="#da67709ab58e9657" class="i field">_endPosition</a>.<a href="#802740858436a96c" class="i property">ColumnNumber</a> - <a href="#b397dad66e3b7ed6" class="i field">_startPosition</a>.<a href="#802740858436a96c" class="i property">ColumnNumber</a>);
                    }
 
                    <b>return</b> <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>, <span class="s">&quot;{0}...{1}&quot;</span>,
                                         <a href="#b397dad66e3b7ed6" class="i field">_startPosition</a>.<a href="#5c545a423a81bc47" class="i property">Line</a>.<span class="i">Substring</span>(<a href="#b397dad66e3b7ed6" class="i field">_startPosition</a>.<a href="#802740858436a96c" class="i property">ColumnNumber</a>),
                                         <a href="#da67709ab58e9657" class="i field">_endPosition</a>.<a href="#5c545a423a81bc47" class="i property">Line</a>.<span class="i">Substring</span>(0, <a href="#da67709ab58e9657" class="i field">_endPosition</a>.<a href="#802740858436a96c" class="i property">ColumnNumber</a>));
                }
                <b>else</b>
                {
                    <b>return</b> <b>string</b>.<span class="i">Empty</span>;
                }
            }
        }
 
        <b>internal void</b> <a id="2f4502bd5d538e02" href="../../R/2f4502bd5d538e02.html" target="n" data-glyph="74,1" class="i method">ToPSObjectForRemoting</a>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r66 rd" class="r66 r">dest</span>)
        {
            <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>(<span class="r66 r">dest</span>, <span class="s">&quot;ScriptExtent_File&quot;</span>, () =&gt; <a href="#5101338d68d9177e" class="i property">File</a>);
            <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>(<span class="r66 r">dest</span>, <span class="s">&quot;ScriptExtent_StartLineNumber&quot;</span>, () =&gt; <a href="#23a9fa406db010c3" class="i property">StartLineNumber</a>);
            <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>(<span class="r66 r">dest</span>, <span class="s">&quot;ScriptExtent_StartColumnNumber&quot;</span>, () =&gt; <a href="#3884396a31d405f0" class="i property">StartColumnNumber</a>);
            <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>(<span class="r66 r">dest</span>, <span class="s">&quot;ScriptExtent_EndLineNumber&quot;</span>, () =&gt; <a href="#a8bd4a42c78f45c4" class="i property">EndLineNumber</a>);
            <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#88b19073d823ce05" class="t t">RemotingEncoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#751212fa1b208b35" class="i method">AddNoteProperty</a>(<span class="r66 r">dest</span>, <span class="s">&quot;ScriptExtent_EndColumnNumber&quot;</span>, () =&gt; <a href="#4fb6265973014bdd" class="i property">EndColumnNumber</a>);
        }
 
        <b>private void</b> <a id="a347e4220e088b9d" href="../../R/a347e4220e088b9d.html" target="n" data-glyph="76,1" class="i method">PopulateFromSerializedInfo</a>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r67 rd" class="r67 r">serializedScriptExtent</span>)
        {
            <b>string</b> <span id="r68 rd" class="r68 r">file</span> = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>string</b>&gt;(<span class="r67 r">serializedScriptExtent</span>, <span class="s">&quot;ScriptExtent_File&quot;</span>);
            <b>int</b> <span id="r69 rd" class="r69 r">startLineNumber</span> = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r67 r">serializedScriptExtent</span>, <span class="s">&quot;ScriptExtent_StartLineNumber&quot;</span>);
            <b>int</b> <span id="r70 rd" class="r70 r">startColumnNumber</span> = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r67 r">serializedScriptExtent</span>, <span class="s">&quot;ScriptExtent_StartColumnNumber&quot;</span>);
            <b>int</b> <span id="r71 rd" class="r71 r">endLineNumber</span> = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r67 r">serializedScriptExtent</span>, <span class="s">&quot;ScriptExtent_EndLineNumber&quot;</span>);
            <b>int</b> <span id="r72 rd" class="r72 r">endColumnNumber</span> = <a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#6f71f8c4cc2ac041" class="t t">RemotingDecoder</a>.<a href="../remoting/common/WireDataFormat/EncodeAndDecode.cs.html#d3fee447c77dfb3b" class="i method">GetPropertyValue</a>&lt;<b>int</b>&gt;(<span class="r67 r">serializedScriptExtent</span>, <span class="s">&quot;ScriptExtent_EndColumnNumber&quot;</span>);
 
            <a href="#391058fa374c4cba" class="t t">ScriptPosition</a> <span id="r73 rd" class="r73 r">startPosition</span> = <b>new</b> <a href="#40eb7f8097372724" class="t constructor">ScriptPosition</a>(<span class="r68 r">file</span>, <span class="r69 r">startLineNumber</span>, <span class="r70 r">startColumnNumber</span>, <b>null</b>);
            <a href="#391058fa374c4cba" class="t t">ScriptPosition</a> <span id="r74 rd" class="r74 r">endPosition</span> = <b>new</b> <a href="#40eb7f8097372724" class="t constructor">ScriptPosition</a>(<span class="r68 r">file</span>, <span class="r71 r">endLineNumber</span>, <span class="r72 r">endColumnNumber</span>, <b>null</b>);
 
            <a href="#b397dad66e3b7ed6" class="i field">_startPosition</a> = <span class="r73 r">startPosition</span>;
            <a href="#da67709ab58e9657" class="i field">_endPosition</a> = <span class="r74 r">endPosition</span>;
        }
 
        <b>internal static</b> <a href="#2baf81cbd0f80531" class="t t">ScriptExtent</a> <a id="075c6281733095ac" href="../../R/075c6281733095ac.html" target="n" data-glyph="74,1" class="i method">FromPSObjectForRemoting</a>(<a href="../MshObject.cs.html#a3c2513aa3da07fa" class="t t">PSObject</a> <span id="r75 rd" class="r75 r">serializedScriptExtent</span>)
        {
            <a href="#2baf81cbd0f80531" class="t t">ScriptExtent</a> <span id="r76 rd" class="r76 r">extent</span> = <b>new</b> <a href="#a12e7c1380e5c9d4" class="t constructor">ScriptExtent</a>();
            <span class="r76 r">extent</span>.<a href="#a347e4220e088b9d" class="i method">PopulateFromSerializedInfo</a>(<span class="r75 r">serializedScriptExtent</span>);
            <b>return</b> <span class="r76 r">extent</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
