<!DOCTYPE html>
<html><head><title>Parser.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(8152);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Management.Automation/engine/parser/Parser.cs" target="_top">engine\parser\Parser.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Management.Automation" target="_top">src\System.Management.Automation\System.Management.Automation.csproj</a> (System.Management.Automation)</td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Corporation.</span>
<span class="c">// Licensed under the MIT License.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Collections</span>.<span class="i">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Tracing</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Runspaces</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Runtime</span>.<span class="i">CompilerServices</span>;
<b>using</b> <span class="i n">System</span>.<span class="i">Threading</span>.<span class="i">Tasks</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Subsystem</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Subsystem</span>.<span class="i n">DSC</span>;
<b>using</b> <span class="i">Dsc</span> = <span class="i n">Microsoft</span>.<span class="i n">PowerShell</span>.<span class="i n">DesiredStateConfiguration</span>.<span class="i n">Internal</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>
{
    <b>using</b> <span class="i">KeyValuePair</span> = <span class="i">Tuple</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>, <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt;;
    <b>using</b> <span class="i">IfClause</span> = <span class="i">Tuple</span>&lt;<a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a>, <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a>&gt;;
    <b>using</b> <span class="i">SwitchClause</span> = <span class="i">Tuple</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>, <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a>&gt;;
 
    <b>internal enum</b> <a id="5c0497999a31aece" href="../../R/5c0497999a31aece.html" target="n" data-glyph="20,0" class="t t"><span id="44e9594b9f50e2e5">ParseMode</span></a>
    {
        <a id="33fb9c7ca2039a3e" href="../../R/33fb9c7ca2039a3e.html" target="n" data-glyph="24,1" class="i field">Default</a> = 0,
        <a id="8b44977978de7d50" href="../../R/8b44977978de7d50.html" target="n" data-glyph="24,1" class="i field">ModuleAnalysis</a> = 1
    }
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> The parser that parses PowerShell script and returns a </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c">, tokens, and error messages</span>
    <span class="c">///</span><span class="c"> if the script cannot be parsed successfully.</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public sealed class</b> <a id="bbf5e856fb3215c5" href="../../R/bbf5e856fb3215c5.html" target="n" data-glyph="0,0" class="t t">Parser</a>
    {
        <b>private readonly</b> <a href="tokenizer.cs.html#fac4dc2d20ae0759" class="t t">Tokenizer</a> <a id="9f3418a9634d9789" href="../../R/9f3418a9634d9789.html" target="n" data-glyph="46,1" class="i field">_tokenizer</a>;
        <b>internal</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="5e04e9f27cfc4fbb" href="../../R/5e04e9f27cfc4fbb.html" target="n" data-glyph="44,1" class="i field">_ungotToken</a>;
        <b>private bool</b> <a id="c988d1d8cef04ca7" href="../../R/c988d1d8cef04ca7.html" target="n" data-glyph="46,1" class="i field">_disableCommaOperator</a>;
        <b>private bool</b> <a id="be9d31b21b6625a3" href="../../R/be9d31b21b6625a3.html" target="n" data-glyph="46,1" class="i field">_savingTokens</a>;
        <b>private bool</b> <a id="79c6907f0c6e9834" href="../../R/79c6907f0c6e9834.html" target="n" data-glyph="46,1" class="i field">_inConfiguration</a>;
        <b>private</b> <a href="#5c0497999a31aece" class="t t">ParseMode</a> <a id="910e5c21bb17bf84" href="../../R/910e5c21bb17bf84.html" target="n" data-glyph="46,1" class="i field">_parseMode</a>;
 
        <b>internal string</b> <a id="b95552b4b6eec94f" href="../../R/b95552b4b6eec94f.html" target="n" data-glyph="44,1" class="i field">_fileName</a>;
 
        <b>internal bool</b> <a id="1efe96ce80819a98" href="../../R/1efe96ce80819a98.html" target="n" data-glyph="104,1" class="i property">ProduceV2Tokens</a> { <b>get</b>; <b>set</b>; }
 
        <b>internal const string</b> <a id="d9090e2972c2cdfd" href="../../R/d9090e2972c2cdfd.html" target="n" data-glyph="8,1" class="i field">VERBATIM_ARGUMENT</a> = <span class="s">&quot;--%&quot;</span>;
        <b>internal const string</b> <a id="7d52fa9f4230b072" href="../../R/7d52fa9f4230b072.html" target="n" data-glyph="8,1" class="i field">VERBATIM_PARAMETERNAME</a> = <span class="s">&quot;-%&quot;</span>;  <span class="c">// Same as VERBATIM_ARGUMENT w/o the first &#39;-&#39;.</span>
 
        <b>internal</b> <a id="aee2c3138d83ea53" href="../../R/aee2c3138d83ea53.html" target="n" data-glyph="74,1" class="t constructor">Parser</a>()
        {
            <a href="#9f3418a9634d9789" class="i field">_tokenizer</a> = <b>new</b> <a href="tokenizer.cs.html#52ace7262fad7648" class="t constructor">Tokenizer</a>(<a href="#bbf5e856fb3215c5" class="k">this</a>);
            <a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a> = <b>new</b> <span class="i">List</span>&lt;<a href="#3b2ee49e322daa35" class="t t">ParseError</a>&gt;();
            <a href="#b95552b4b6eec94f" class="i field">_fileName</a> = <b>null</b>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parse input from the specified file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">fileName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the file to parse.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">tokens</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Returns the tokens from parsing the script.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">errors</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Returns errors, if any, discovered while parsing the script.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that represents the input script file.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="7eda9a6e0ad43105" href="../../R/7eda9a6e0ad43105.html" target="n" data-glyph="72,1" class="i method">ParseFile</a>(<b>string</b> <span id="r0 rd" class="r0 r">fileName</span>, <b>out</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[] <span id="r1 rd" class="r1 r">tokens</span>, <b>out</b> <a href="#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r2 rd" class="r2 r">errors</span>)
        {
            <b>const string</b> <span id="r3 rd" class="r3 r">scriptSchemaExtension</span> = <span class="s">&quot;.schema.psm1&quot;</span>;
            <b>var</b> <span id="r4 rd" class="r4 r">parseDscResource</span> = <b>false</b>;
            <span class="c">// If the file has the &#39;schema.psm1&#39; extension, then it is a &#39;DSC module file&#39; however we don&#39;t actually load the</span>
            <span class="c">// module at parse time so we can&#39;t use the normal mechanisms to bind the module name for configuration commands.</span>
            <span class="c">// As an alternative, we extract the base name of the module file and use that as the module name for any keywords exported by this file.</span>
            <a href="#bbf5e856fb3215c5" class="k">var</a> <span id="r5 rd" class="r5 r">parser</span> = <b>new</b> <a href="#aee2c3138d83ea53" class="t constructor">Parser</a>();
            <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r0 r">fileName</span>) &amp;&amp; <span class="r0 r">fileName</span>.<span class="i">Length</span> &gt; <span class="r3 r">scriptSchemaExtension</span>.<span class="i">Length</span> &amp;&amp; <span class="r0 r">fileName</span>.<span class="i">EndsWith</span>(<span class="r3 r">scriptSchemaExtension</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
            {
                <span class="r5 r">parser</span>.<a href="#cb5979f0183d7827" class="i field">_keywordModuleName</a> = <span class="i">Path</span>.<span class="i">GetFileName</span>(<span class="r0 r">fileName</span>.<span class="i">AsSpan</span>(0, <span class="r0 r">fileName</span>.<span class="i">Length</span> - <span class="r3 r">scriptSchemaExtension</span>.<span class="i">Length</span>)).<span class="i">ToString</span>();
                <span class="r4 r">parseDscResource</span> = <b>true</b>;
            }
 
            <b>string</b> <span id="r6 rd" class="r6 r">scriptContents</span>;
            <b>try</b>
            {
                <a href="../ExternalScriptInfo.cs.html#7806ac40f903221c" class="k">var</a> <span id="r7 rd" class="r7 r">esi</span> = <b>new</b> <a href="../ExternalScriptInfo.cs.html#12b68b14765ad8b7" class="t constructor">ExternalScriptInfo</a>(<span class="r0 r">fileName</span>, <span class="r0 r">fileName</span>);
                <span class="r6 r">scriptContents</span> = <span class="r7 r">esi</span>.<a href="../ExternalScriptInfo.cs.html#9f9388511bd97894" class="i property">ScriptContents</a>;
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r8 rd" class="r8 r">e</span>)
            {
                <a href="Position.cs.html#9b361bb7f5af38a5" class="k">var</a> <span id="r9 rd" class="r9 r">emptyExtent</span> = <b>new</b> <span class="t">EmptyScriptExtent</span>();
                <b>var</b> <span id="r10 rd" class="r10 r">errorMsg</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="i">ParserStrings</span>.<span class="i">FileReadError</span>, <span class="r8 r">e</span>.<span class="i">Message</span>);
                <span class="r2 r">errors</span> = <b>new</b>[] { <b>new</b> <span class="t">ParseError</span>(<span class="r9 r">emptyExtent</span>, <span class="s">&quot;FileReadError&quot;</span>, <span class="r10 r">errorMsg</span>) };
                <span class="r1 r">tokens</span> = <span class="i">Array</span>.<span class="i">Empty</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt;();
                <b>return</b> <b>new</b> <a href="ast.cs.html#97cd877cfe108c7b" class="t constructor">ScriptBlockAst</a>(<span class="r9 r">emptyExtent</span>, <b>null</b>, <b>new</b> <a href="ast.cs.html#843ddfcdc5cdf1a3" class="t constructor">StatementBlockAst</a>(<span class="r9 r">emptyExtent</span>, <b>null</b>, <b>null</b>), <b>false</b>);
            }
 
            <b>var</b> <span id="r11 rd" class="r11 r">tokenList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt;();
            <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r12 rd" class="r12 r">result</span>;
            <b>try</b>
            {
                <b>if</b> (!<span class="r4 r">parseDscResource</span>)
                {
                    <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="tokenizer.cs.html#0cdae039c0460080" class="i method">Push</a>();
                }
 
                <span class="r12 r">result</span> = <span class="r5 r">parser</span>.<a href="#3b3edfaa9020f895" class="i method">Parse</a>(<span class="r0 r">fileName</span>, <span class="r6 r">scriptContents</span>, <span class="r11 r">tokenList</span>, <b>out</b> <span class="r2 r">errors</span>, <a href="#5c0497999a31aece" class="t t">ParseMode</a>.<a href="#33fb9c7ca2039a3e" class="i field">Default</a>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r13 rd" class="r13 r">e</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">ParseException</span>(<span class="i">ParserStrings</span>.<span class="i">UnrecoverableParserError</span>, <span class="r13 r">e</span>);
            }
            <b>finally</b>
            {
                <b>if</b> (!<span class="r4 r">parseDscResource</span>)
                {
                    <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="tokenizer.cs.html#89e041ec233d5707" class="i method">Pop</a>();
                }
            }
 
            <span class="r1 r">tokens</span> = <span class="r11 r">tokenList</span>.<span class="i">ToArray</span>();
            <b>return</b> <span class="r12 r">result</span>;
        }
 
        <b>private string</b> <a id="cb5979f0183d7827" href="../../R/cb5979f0183d7827.html" target="n" data-glyph="46,1" class="i field">_keywordModuleName</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parse input that does not come from a file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">input</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The input to parse.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r15 r">tokens</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Returns the tokens from parsing the script.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r16 r">errors</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Returns errors, if any, discovered while parsing the script.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that represents the input script file.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="8c264bb718ff180a" href="../../R/8c264bb718ff180a.html" target="n" data-glyph="72,1" class="i method">ParseInput</a>(<b>string</b> <span id="r14 rd" class="r14 r">input</span>, <b>out</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[] <span id="r15 rd" class="r15 r">tokens</span>, <b>out</b> <a href="#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r16 rd" class="r16 r">errors</span>)
        {
            <b>return</b> <a href="#4f8e15f3d9557f8e" class="i method">ParseInput</a>(<span class="r14 r">input</span>, <b>null</b> <span class="c">/* fileName */</span>, <b>out</b> <span class="r15 r">tokens</span>, <b>out</b> <span class="r16 r">errors</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parse input that does not come from a file.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">input</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The input to parse.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">fileName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The fileName if present or null.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r19 r">tokens</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Returns the tokens from parsing the script.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r20 r">errors</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">Returns errors, if any, discovered while parsing the script.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">The </span><span class="c">&lt;</span><span class="c">see</span> <span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a><span class="c">&quot;</span><span class="c">/&gt;</span><span class="c"> that represents the input script file.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public static</b> <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="4f8e15f3d9557f8e" href="../../R/4f8e15f3d9557f8e.html" target="n" data-glyph="72,1" class="i method">ParseInput</a>(<b>string</b> <span id="r17 rd" class="r17 r">input</span>, <b>string</b> <span id="r18 rd" class="r18 r">fileName</span>, <b>out</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[] <span id="r19 rd" class="r19 r">tokens</span>, <b>out</b> <a href="#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r20 rd" class="r20 r">errors</span>)
        {
            <b>if</b> (<span class="r17 r">input</span> <b>is null</b>)
            {
                <b>throw</b> <b>new</b> <span class="i">ArgumentNullException</span>(<b>nameof</b>(<span class="r17 r">input</span>));
            }
 
            <a href="#bbf5e856fb3215c5" class="t t">Parser</a> <span id="r21 rd" class="r21 r">parser</span> = <b>new</b> <a href="#aee2c3138d83ea53" class="t constructor">Parser</a>();
            <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r22 rd" class="r22 r">tokenList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt;();
            <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r23 rd" class="r23 r">result</span>;
            <b>try</b>
            {
                <span class="r23 r">result</span> = <span class="r21 r">parser</span>.<a href="#3b3edfaa9020f895" class="i method">Parse</a>(<span class="r18 r">fileName</span>, <span class="r17 r">input</span>, <span class="r22 r">tokenList</span>, <b>out</b> <span class="r20 r">errors</span>, <a href="#5c0497999a31aece" class="t t">ParseMode</a>.<a href="#33fb9c7ca2039a3e" class="i field">Default</a>);
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r24 rd" class="r24 r">e</span>)
            {
                <b>throw</b> <b>new</b> <span class="t">ParseException</span>(<span class="i">ParserStrings</span>.<span class="i">UnrecoverableParserError</span>, <span class="r24 r">e</span>);
            }
 
            <span class="r19 r">tokens</span> = <span class="r22 r">tokenList</span>.<span class="i">ToArray</span>();
            <b>return</b> <span class="r23 r">result</span>;
        }
 
        <b>internal</b> <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="3b3edfaa9020f895" href="../../R/3b3edfaa9020f895.html" target="n" data-glyph="74,1" class="i method">Parse</a>(<b>string</b> <span id="r25 rd" class="r25 r">fileName</span>, <b>string</b> <span id="r26 rd" class="r26 r">input</span>, <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r27 rd" class="r27 r">tokenList</span>, <b>out</b> <a href="#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r28 rd" class="r28 r">errors</span>, <a href="#5c0497999a31aece" class="t t">ParseMode</a> <span id="r29 rd" class="r29 r">parseMode</span>)
        {
            <b>try</b>
            {
                <b>return</b> <a href="#d48c029b14be2bf8" class="i method">ParseTask</a>(<span class="r25 r">fileName</span>, <span class="r26 r">input</span>, <span class="r27 r">tokenList</span>, <b>false</b>, <span class="r29 r">parseMode</span>);
            }
            <b>finally</b>
            {
                <span class="r28 r">errors</span> = <a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">ToArray</span>();
            }
        }
 
        <b>private</b> <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="d48c029b14be2bf8" href="../../R/d48c029b14be2bf8.html" target="n" data-glyph="76,1" class="i method">ParseTask</a>(<b>string</b> <span id="r30 rd" class="r30 r">fileName</span>, <b>string</b> <span id="r31 rd" class="r31 r">input</span>, <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r32 rd" class="r32 r">tokenList</span>, <b>bool</b> <span id="r33 rd" class="r33 r">recursed</span>, <a href="#5c0497999a31aece" class="t t">ParseMode</a> <span id="r34 rd" class="r34 r">parseMode</span>)
        {
            <b>bool</b> <span id="r35 rd" class="r35 r">etwEnabled</span> = <a href="#ef505205d8f64188" class="t t">ParserEventSource</a>.<a href="#10130af1551d9144" class="i field">Log</a>.<span class="i">IsEnabled</span>();
            <b>if</b> (<span class="r35 r">etwEnabled</span>) <a href="#ef505205d8f64188" class="t t">ParserEventSource</a>.<a href="#10130af1551d9144" class="i field">Log</a>.<span class="i">ParseStart</span>(<a href="#ef505205d8f64188" class="t t">ParserEventSource</a>.<a href="#299420625c4b9670" class="i method">GetFileOrScript</a>(<span class="r30 r">fileName</span>, <span class="r31 r">input</span>), <span class="r31 r">input</span>.<span class="i">Length</span>);
 
            <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r36 rd" class="r36 r">ast</span> = <b>null</b>;
 
            <a href="#910e5c21bb17bf84" class="i field">_parseMode</a> = <span class="r34 r">parseMode</span>;
            <a href="#b95552b4b6eec94f" class="i field">_fileName</a> = <span class="r30 r">fileName</span>;
            <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#be909e3e2bc4f0f4" class="i method">Initialize</a>(<span class="r30 r">fileName</span>, <span class="r31 r">input</span>, <span class="r32 r">tokenList</span>);
            <a href="#be9d31b21b6625a3" class="i field">_savingTokens</a> = (<span class="r32 r">tokenList</span> != <b>null</b>);
            <a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Clear</span>();
 
            <b>try</b>
            {
                <span class="r36 r">ast</span> = <a href="#41a9f47c78b86651" class="i method">ScriptBlockRule</a>(<b>null</b>, <span class="r37 r">isFilter</span>: <b>false</b>);
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
                <span class="r36 r">ast</span>.<a href="ast.cs.html#360723934e684b68" class="i method">InternalVisit</a>(<b>new</b> <a href="AstVisitor.cs.html#7e66cc91c4cc89d7" class="t constructor">CheckAllParentsSet</a>(<span class="r36 r">ast</span>));
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                <span class="r36 r">ast</span>.<a href="ast.cs.html#db84554dcf2e5444" class="i property">ScriptRequirements</a> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#a39ef7e7f8af6bad" class="i method">GetScriptRequirements</a>();
 
                <b>if</b> (<span class="r34 r">parseMode</span> == <a href="#5c0497999a31aece" class="t t">ParseMode</a>.<a href="#33fb9c7ca2039a3e" class="i field">Default</a>)
                {
                    <span class="r36 r">ast</span>.<a href="ast.cs.html#3e5400a9fb46cc34" class="i method">PerformPostParseChecks</a>(<a href="#bbf5e856fb3215c5" class="k">this</a>);
                }
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
                <span class="r36 r">ast</span>.<a href="ast.cs.html#360723934e684b68" class="i method">InternalVisit</a>(<b>new</b> <span class="t">CheckTypeBuilder</span>());
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
            <b>catch</b> (<span class="i">InsufficientExecutionStackException</span>)
            {
                <b>if</b> (!<span class="r33 r">recursed</span>)
                {
                    <span class="c">// We&#39;ll try parsing once more, this time on a new thread.  The assumption here is</span>
                    <span class="c">// that the stack was close to overflowing before we tried to parse, and that won&#39;t</span>
                    <span class="c">// be a problem on a new thread.</span>
                    <b>var</b> <span id="r38 rd" class="r38 r">task</span> = <b>new</b> <span class="i">Task</span>&lt;<a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a>&gt;(() =&gt; <a href="#d48c029b14be2bf8" class="i method">ParseTask</a>(<span class="r30 r">fileName</span>, <span class="r31 r">input</span>, <span class="r32 r">tokenList</span>, <b>true</b>, <span class="r34 r">parseMode</span>));
                    <span class="r38 r">task</span>.<span class="i">Start</span>();
                    <span class="r38 r">task</span>.<span class="i">Wait</span>();
                    <span class="r36 r">ast</span> = <span class="r38 r">task</span>.<span class="i">Result</span>;
                }
                <b>else</b>
                {
                    <span class="i">ReportError</span>(<a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e07f6456e81dea92" class="i method">CurrentExtent</a>(),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ScriptTooComplicated</span>),
                        <span class="i">ParserStrings</span>.<span class="i">ScriptTooComplicated</span>);
                }
            }
 
            <b>if</b> (<span class="r35 r">etwEnabled</span>) <a href="#ef505205d8f64188" class="t t">ParserEventSource</a>.<a href="#10130af1551d9144" class="i field">Log</a>.<a href="#903914159b6415e7" class="i method">ParseStop</a>();
            <b>return</b> <span class="r36 r">ast</span>;
        }
 
        <span class="c">// This helper routine is used from the runtime to convert a string to a number.</span>
        <b>internal static object</b> <a id="9153eaabe13401f3" href="../../R/9153eaabe13401f3.html" target="n" data-glyph="74,1" class="i method">ScanNumber</a>(<b>string</b> <span id="r39 rd" class="r39 r">str</span>, <span class="i">Type</span> <span id="r40 rd" class="r40 r">toType</span>, <b>bool</b> <span id="r41 rd" class="r41 r">shouldTryCoercion</span> = <b>true</b>)
        {
            <span class="r39 r">str</span> = <span class="r39 r">str</span>.<span class="i">Trim</span>();
            <b>if</b> (<span class="r39 r">str</span>.<span class="i">Length</span> == 0)
            {
                <span class="c">// For backwards compatibility, we treat the empty string (w/ or w/o whitespace) as the</span>
                <span class="c">// integer constant 0.  This is a slight change in semantics, the empty string was previously</span>
                <span class="c">// only considered a number if we committed to a numeric operation, e.g.:</span>
                <span class="c">//    5 - &quot;&quot;   - this results in 5</span>
                <span class="c">// Returning 0 here means that</span>
                <span class="c">//   &quot;&quot; - &quot;&quot;   - will result in 0, previously was an error.</span>
                <span class="c">// This is mostly of interest for the operators -, /, %, -band, -bor, -bxor as these operators</span>
                <span class="c">// allow strings as the lval and still do a numeric operation, whereas + and * treat string</span>
                <span class="c">// lvals differently.</span>
                <b>return</b> 0;
            }
 
            <a href="tokenizer.cs.html#fac4dc2d20ae0759" class="k">var</a> <span id="r42 rd" class="r42 r">tokenizer</span> = (<b>new</b> <a href="#aee2c3138d83ea53" class="t constructor">Parser</a>()).<a href="#9f3418a9634d9789" class="i field">_tokenizer</a>;
            <span class="r42 r">tokenizer</span>.<a href="tokenizer.cs.html#be909e3e2bc4f0f4" class="i method">Initialize</a>(<b>null</b>, <span class="r39 r">str</span>, <b>null</b>);
            <span class="r42 r">tokenizer</span>.<a href="tokenizer.cs.html#cc92b8f58ff56ac5" class="i property">AllowSignedNumbers</a> = <b>true</b>;
            <a href="token.cs.html#71038a309db9781f" class="k">var</a> <span id="r43 rd" class="r43 r">token</span> = <span class="r42 r">tokenizer</span>.<a href="tokenizer.cs.html#afe5746238887d1f" class="i method">NextToken</a>() <b>as</b> <a href="token.cs.html#71038a309db9781f" class="t t">NumberToken</a>;
 
            <b>if</b> (<span class="r43 r">token</span> == <b>null</b> || !<span class="r42 r">tokenizer</span>.<a href="tokenizer.cs.html#a297aca912bee2fe" class="i method">IsAtEndOfScript</a>(<span class="r43 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>))
            {
                <b>if</b> (<span class="r41 r">shouldTryCoercion</span>)
                {
                    <span class="c">// We call ConvertTo, primarily because we expect it will throw an exception,</span>
                    <span class="c">// but it&#39;s possible it could succeed, e.g. if the string had commas, our lexer</span>
                    <span class="c">// will fail, but Convert.ChangeType could succeed.</span>
                    <b>return</b> <a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<span class="i">ConvertTo</span>(<span class="r39 r">str</span>, <span class="r40 r">toType</span>, <span class="i">CultureInfo</span>.<span class="i">InvariantCulture</span>);
                }
                <b>else</b>
                {
                    <b>throw</b> <b>new</b> <a href="../../utils/ParserException.cs.html#2f39476aea478a50" class="t constructor">ParseException</a>();
                }
            }
 
            <b>return</b> <span class="r43 r">token</span>.<a href="token.cs.html#e451e512705875f9" class="i property">Value</a>;
        }
 
        <b>internal static</b> <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <a id="48b79e78a1e64334" href="../../R/48b79e78a1e64334.html" target="n" data-glyph="74,1" class="i method">ScanType</a>(<b>string</b> <span id="r44 rd" class="r44 r">typename</span>, <b>bool</b> <span id="r45 rd" class="r45 r">ignoreErrors</span>)
        {
            <span class="r44 r">typename</span> = <span class="r44 r">typename</span>.<span class="i">Trim</span>();
            <b>if</b> (<span class="r44 r">typename</span>.<span class="i">Length</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="#bbf5e856fb3215c5" class="k">var</a> <span id="r46 rd" class="r46 r">parser</span> = <b>new</b> <a href="#aee2c3138d83ea53" class="t constructor">Parser</a>();
            <a href="tokenizer.cs.html#fac4dc2d20ae0759" class="k">var</a> <span id="r47 rd" class="r47 r">tokenizer</span> = <span class="r46 r">parser</span>.<a href="#9f3418a9634d9789" class="i field">_tokenizer</a>;
            <span class="r47 r">tokenizer</span>.<a href="tokenizer.cs.html#be909e3e2bc4f0f4" class="i method">Initialize</a>(<b>null</b>, <span class="r44 r">typename</span>, <b>null</b>);
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r48 rd" class="r48 r">unused</span>;
            <a href="ast.cs.html#a422e1772da6dbc8" class="k">var</a> <span id="r49 rd" class="r49 r">result</span> = <span class="r46 r">parser</span>.<a href="#94ecdfa0b8f28cd7" class="i method">TypeNameRule</a>(<span class="r50 r">allowAssemblyQualifiedNames</span>: <b>true</b>, <span class="r51 r">firstTypeNameToken</span>: <b>out</b> <span class="r48 r">unused</span>);
 
            <a href="SemanticChecks.cs.html#20ff17b776f5a22d" class="t t">SemanticChecks</a>.<a href="SemanticChecks.cs.html#f6210ab6083ade61" class="i method">CheckArrayTypeNameDepth</a>(<span class="r49 r">result</span>, <a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>, <span class="r46 r">parser</span>);
            <b>if</b> (!<span class="r45 r">ignoreErrors</span> &amp;&amp; <span class="r46 r">parser</span>.<a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Count</span> &gt; 0)
            {
                <span class="r49 r">result</span> = <b>null</b>;
            }
 
            <b>return</b> <span class="r49 r">result</span>;
        }
 
        <b>internal static</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="e08021455ac48035" href="../../R/e08021455ac48035.html" target="n" data-glyph="74,1" class="i method">ScanString</a>(<b>string</b> <span id="r52 rd" class="r52 r">str</span>)
        {
            <span class="r52 r">str</span> = <span class="r52 r">str</span>.<span class="i">Replace</span>(<span class="s">&quot;\&quot;&quot;</span>, <span class="s">&quot;\&quot;\&quot;&quot;</span>);
            <a href="#bbf5e856fb3215c5" class="k">var</a> <span id="r53 rd" class="r53 r">parser</span> = <b>new</b> <a href="#aee2c3138d83ea53" class="t constructor">Parser</a>();
            <span class="r53 r">parser</span>.<a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<span class="i">Initialize</span>(<b>null</b>, <span class="s">&#39;&quot;&#39;</span> + <span class="r52 r">str</span> + <span class="s">&#39;&quot;&#39;</span>, <b>null</b>);
            <a href="token.cs.html#7be5d7d2cd2a65ac" class="k">var</a> <span id="r54 rd" class="r54 r">strToken</span> = (<a href="token.cs.html#7be5d7d2cd2a65ac" class="t t">StringExpandableToken</a>)<span class="r53 r">parser</span>.<a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#afe5746238887d1f" class="i method">NextToken</a>();
            <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r55 rd" class="r55 r">ast</span> = <span class="r53 r">parser</span>.<a href="#7700f40d33c1ea62" class="i method">ExpandableStringRule</a>(<span class="r54 r">strToken</span>);
            <b>if</b> (<span class="r53 r">parser</span>.<a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Count</span> &gt; 0)
            {
                <b>throw</b> <b>new</b> <span class="t">ParseException</span>(<span class="r53 r">parser</span>.<a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">ToArray</span>());
            }
 
            <b>return</b> <span class="r55 r">ast</span>;
        }
 
        <b>private string</b> <a id="51ee9393f5ec5a50" href="../../R/51ee9393f5ec5a50.html" target="n" data-glyph="46,1" class="i field">_previousFirstTokenText</a>;
        <b>private string</b> <a id="e937f4fb24e5c9ec" href="../../R/e937f4fb24e5c9ec.html" target="n" data-glyph="46,1" class="i field">_previousLastTokenText</a>;
 
        <b>private static bool</b> <a id="aeb1a5755ab67f80" href="../../R/aeb1a5755ab67f80.html" target="n" data-glyph="76,1" class="i method">IgnoreTokenWhenUpdatingPreviousFirstLast</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r56 rd" class="r56 r">token</span>)
        {
            <b>return</b> (<span class="r56 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8b5a9c54e2029553" class="i field">Variable</a> || <span class="r56 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1aeb1084525225c9" class="i field">Generic</a>) &amp;&amp;
                   (<span class="r56 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>.<span class="i">Equals</span>(<span class="s">&quot;$^&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) ||
                    <span class="r56 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>.<span class="i">Equals</span>(<span class="s">&quot;$$&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>));
        }
 
        <b>internal void</b> <a id="076c5a23ac9a0d97" href="../../R/076c5a23ac9a0d97.html" target="n" data-glyph="74,1" class="i method">SetPreviousFirstLastToken</a>(<a href="../ExecutionContext.cs.html#130bda5418e8559c" class="t t">ExecutionContext</a> <span id="r57 rd" class="r57 r">context</span>)
        {
            <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r58 rd" class="r58 r">firstToken</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#0b3a6fb9271cc752" class="i property">FirstToken</a>;
            <b>if</b> (<span class="r58 r">firstToken</span> != <b>null</b>)
            {
                <span class="r57 r">context</span>.<a href="../ExecutionContext.cs.html#fa7f7322f772be22" class="i method">SetVariable</a>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#a4f67b1192d302c4" class="i field">FirstTokenVarPath</a>, <a href="#51ee9393f5ec5a50" class="i field">_previousFirstTokenText</a>);
                <b>if</b> (!<a href="#aeb1a5755ab67f80" class="i method">IgnoreTokenWhenUpdatingPreviousFirstLast</a>(<span class="r58 r">firstToken</span>))
                {
                    <a href="token.cs.html#dce06fb5d7448125" class="k">var</a> <span id="r59 rd" class="r59 r">stringToken</span> = <span class="r58 r">firstToken</span> <b>as</b> <a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a>;
                    <a href="#51ee9393f5ec5a50" class="i field">_previousFirstTokenText</a> = <span class="r59 r">stringToken</span> != <b>null</b>
                        ? <span class="r59 r">stringToken</span>.<a href="token.cs.html#f95f094124370df7" class="i property">Value</a>
                        : <span class="r58 r">firstToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>;
                }
 
                <span class="r57 r">context</span>.<a href="../ExecutionContext.cs.html#fa7f7322f772be22" class="i method">SetVariable</a>(<a href="../SpecialVariables.cs.html#07948374b47849e8" class="t t">SpecialVariables</a>.<a href="../SpecialVariables.cs.html#c318fcfc34609f2e" class="i field">LastTokenVarPath</a>, <a href="#e937f4fb24e5c9ec" class="i field">_previousLastTokenText</a>);
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r60 rd" class="r60 r">lastToken</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#830aef4c77937ae5" class="i property">LastToken</a>;
                <b>if</b> (!<a href="#aeb1a5755ab67f80" class="i method">IgnoreTokenWhenUpdatingPreviousFirstLast</a>(<span class="r60 r">lastToken</span>))
                {
                    <a href="token.cs.html#dce06fb5d7448125" class="k">var</a> <span id="r61 rd" class="r61 r">stringToken</span> = <span class="r60 r">lastToken</span> <b>as</b> <a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a>;
                    <a href="#e937f4fb24e5c9ec" class="i field">_previousLastTokenText</a> = <span class="r61 r">stringToken</span> != <b>null</b>
                        ? <span class="r61 r">stringToken</span>.<a href="token.cs.html#f95f094124370df7" class="i property">Value</a>
                        : <span class="r60 r">lastToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>;
                }
            }
        }
 
        <b>internal</b> <span class="i">List</span>&lt;<a href="#3b2ee49e322daa35" class="t t">ParseError</a>&gt; <a id="e8f5d233c7c0eda2" href="../../R/e8f5d233c7c0eda2.html" target="n" data-glyph="104,1" class="i property">ErrorList</a> { <b>get</b>; }
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Utilities
 
        <b>private void</b> <a id="b262a345f728b573" href="../../R/b262a345f728b573.html" target="n" data-glyph="76,1" class="i method">SkipNewlines</a>()
        {
            <b>if</b> (<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> == <b>null</b> || <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a>)
            {
                <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> = <b>null</b>;
                <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#2e4046ce3ce22f0a" class="i method">SkipNewlines</a>(<span class="r62 r">skipSemis</span>: <b>false</b>);
            }
        }
 
        <b>private void</b> <a id="20cf6d6d776dad25" href="../../R/20cf6d6d776dad25.html" target="n" data-glyph="76,1" class="i method">SkipNewlinesAndSemicolons</a>()
        {
            <b>if</b> (<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> == <b>null</b> || <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a> || <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>)
            {
                <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> = <b>null</b>;
                <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#2e4046ce3ce22f0a" class="i method">SkipNewlines</a>(<span class="r62 r">skipSemis</span>: <b>true</b>);
            }
        }
 
        <b>private void</b> <a id="e51058c98956995e" href="../../R/e51058c98956995e.html" target="n" data-glyph="76,1" class="i method">SyncOnError</a>(<b>bool</b> <span id="r63 rd" class="r63 r">consumeClosingToken</span>, <b>params</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>[] <span id="r64 rd" class="r64 r">syncTokens</span>)
        {
            <b>int</b> <span id="r65 rd" class="r65 r">parens</span> = <span class="r64 r">syncTokens</span>.<span class="i">Contains</span>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>) ? 1 : 0;
            <b>int</b> <span id="r66 rd" class="r66 r">curlies</span> = <span class="r64 r">syncTokens</span>.<span class="i">Contains</span>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>) ? 1 : 0;
            <b>int</b> <span id="r67 rd" class="r67 r">braces</span> = <span class="r64 r">syncTokens</span>.<span class="i">Contains</span>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>) ? 1 : 0;
            <b>while</b> (<b>true</b>)
            {
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r68 rd" class="r68 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>switch</b> (<span class="r68 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
                {
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>: ++<span class="r65 r">parens</span>; <b>break</b>;
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>:
                        --<span class="r65 r">parens</span>;
                        <b>if</b> (<span class="r65 r">parens</span> == 0 &amp;&amp; <span class="r64 r">syncTokens</span>.<span class="i">Contains</span>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>))
                        {
                            <b>if</b> (!<span class="r63 r">consumeClosingToken</span>)
                            {
                                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r68 r">token</span>);
                            }
 
                            <b>return</b>;
                        }
 
                        <b>break</b>;
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>: ++<span class="r66 r">curlies</span>; <b>break</b>;
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>:
                        --<span class="r66 r">curlies</span>;
                        <b>if</b> (<span class="r66 r">curlies</span> == 0 &amp;&amp; <span class="r64 r">syncTokens</span>.<span class="i">Contains</span>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>))
                        {
                            <b>if</b> (!<span class="r63 r">consumeClosingToken</span>)
                            {
                                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r68 r">token</span>);
                            }
 
                            <b>return</b>;
                        }
 
                        <b>break</b>;
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>: ++<span class="r67 r">braces</span>; <b>break</b>;
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>:
                        --<span class="r67 r">braces</span>;
                        <b>if</b> (<span class="r67 r">braces</span> == 0 &amp;&amp; <span class="r64 r">syncTokens</span>.<span class="i">Contains</span>(<a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>))
                        {
                            <b>if</b> (!<span class="r63 r">consumeClosingToken</span>)
                            {
                                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r68 r">token</span>);
                            }
 
                            <b>return</b>;
                        }
 
                        <b>break</b>;
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>:
                        <span class="c">// Never consume &lt;EOF&gt;, but return it to caller</span>
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r68 r">token</span>);
                        <b>return</b>;
                }
 
                <b>if</b> (<span class="r64 r">syncTokens</span>.<span class="i">Contains</span>(<span class="r68 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>) &amp;&amp; <span class="r65 r">parens</span> == 0 &amp;&amp; <span class="r66 r">curlies</span> == 0 &amp;&amp; <span class="r67 r">braces</span> == 0)
                {
                    <b>break</b>;
                }
            }
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="98aafb96cd3508ac" href="../../R/98aafb96cd3508ac.html" target="n" data-glyph="76,1" class="i method">NextToken</a>()
        {
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r69 rd" class="r69 r">token</span> = <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> ?? <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#afe5746238887d1f" class="i method">NextToken</a>();
            <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> = <b>null</b>;
            <b>return</b> <span class="r69 r">token</span>;
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="ea786851e84d8cea" href="../../R/ea786851e84d8cea.html" target="n" data-glyph="76,1" class="i method">PeekToken</a>()
        {
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r70 rd" class="r70 r">token</span> = <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> ?? <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#afe5746238887d1f" class="i method">NextToken</a>();
            <b>if</b> (<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> == <b>null</b>)
                <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> = <span class="r70 r">token</span>;
            <b>return</b> <span class="r70 r">token</span>;
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="e92e7b8af3f0e276" href="../../R/e92e7b8af3f0e276.html" target="n" data-glyph="76,1" class="i method">NextMemberAccessToken</a>(<b>bool</b> <span id="r71 rd" class="r71 r">allowLBracket</span>)
        {
            <span class="c">// If _ungotToken is not null, we&#39;re in some sort of error state, don&#39;t return the token.</span>
            <b>if</b> (<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> != <b>null</b>)
                <b>return</b> <b>null</b>;
            <b>return</b> <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#3af92499058b9e05" class="i method">GetMemberAccessOperator</a>(<span class="r71 r">allowLBracket</span>);
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="278d93d6ea13c290" href="../../R/278d93d6ea13c290.html" target="n" data-glyph="76,1" class="i method">NextInvokeMemberToken</a>()
        {
            <span class="c">// If _ungotToken is not null, we&#39;re in some sort of error state, don&#39;t return the token.</span>
            <b>if</b> (<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> != <b>null</b>)
                <b>return</b> <b>null</b>;
            <b>return</b> <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#554579c509994635" class="i method">GetInvokeMemberOpenParen</a>();
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="ad1f983a7da03b1f" href="../../R/ad1f983a7da03b1f.html" target="n" data-glyph="76,1" class="i method">NextLBracket</a>()
        {
            <b>if</b> (<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> != <b>null</b>)
            {
                <b>if</b> (<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>) <b>return</b> <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <span class="c">// If _ungotToken is not null, we&#39;re in some sort of error state, don&#39;t return the token.</span>
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#68cf8b1df706f946" class="i method">GetLBracket</a>();
        }
 
        <b>private</b> <a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a> <a id="e6e7524f3bd072d3" href="../../R/e6e7524f3bd072d3.html" target="n" data-glyph="76,1" class="i method">GetVerbatimCommandArgumentToken</a>()
        {
            <b>if</b> (<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> == <b>null</b> || <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c3ec93ee8b22aa7f" class="i field">Parameter</a>)
            {
                <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> = <b>null</b>;
                <b>return</b> <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#4b703256d9c4df51" class="i method">GetVerbatimCommandArgument</a>();
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private void</b> <a id="40ecb045eb2a7f82" href="../../R/40ecb045eb2a7f82.html" target="n" data-glyph="76,1" class="i method">SkipToken</a>()
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> != <b>null</b>, <span class="s">&quot;Don&#39;t skip a token you didn&#39;t unget&quot;</span>);
            <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> = <b>null</b>;
        }
 
        <b>private void</b> <a id="b64e60a764c9d1ee" href="../../R/b64e60a764c9d1ee.html" target="n" data-glyph="76,1" class="i method">UngetToken</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r72 rd" class="r72 r">token</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> == <b>null</b>, <span class="s">&quot;Only 1 token lookahead is supported&quot;</span>);
            <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> = <span class="r72 r">token</span>;
        }
 
        <b>private void</b> <a id="9465510520349e4e" href="../../R/9465510520349e4e.html" target="n" data-glyph="76,1" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a> <span id="r73 rd" class="r73 r">mode</span>)
        {
            <b>if</b> (<span class="r73 r">mode</span> != <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a> &amp;&amp; <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> != <b>null</b>)
            {
                <span class="c">// Only rescan tokens that differ b/w command and expression modes.</span>
                <b>if</b> (!<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#84def6774d758bed" class="i method">HasTrait</a>(<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#659463b006e3c381" class="i field">ParseModeInvariant</a>))
                {
                    <a href="#73d0e59d1708bfb0" class="i method">Resync</a>(<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>);
                }
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">DEBUG</span>
                <b>else</b> <b>if</b> (<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
                {
                    <span class="c">// Verify the comment above.</span>
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r74 rd" class="r74 r">ungotToken</span> = <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>;
                    <b>var</b> <span id="r75 rd" class="r75 r">oldTokenList</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#233100b0d292a6a3" class="i property">TokenList</a>;
                    <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#233100b0d292a6a3" class="i property">TokenList</a> = <b>null</b>;
                    <a href="#73d0e59d1708bfb0" class="i method">Resync</a>(<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>);
                    <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a> = <span class="r73 r">mode</span>;
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r76 rd" class="r76 r">rescan</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#afe5746238887d1f" class="i method">NextToken</a>();
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r74 r">ungotToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <span class="r76 r">rescan</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>, <span class="s">&quot;Rescan failed to return same kind&quot;</span>);
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r74 r">ungotToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a> == <span class="r76 r">rescan</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <span class="s">&quot;Rescan failed to return same text&quot;</span>);
                    <a href="Position.cs.html#fb2ad3feb9004d98" class="t t">IScriptPosition</a> <span id="r77 rd" class="r77 r">pos1</span> = <span class="r74 r">ungotToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>;
                    <a href="Position.cs.html#fb2ad3feb9004d98" class="t t">IScriptPosition</a> <span id="r78 rd" class="r78 r">pos2</span> = <span class="r76 r">rescan</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#88220ab61fd15a4b" class="i property">StartScriptPosition</a>;
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r77 r">pos1</span>.<a href="Position.cs.html#adb21ecf0073d187" class="i property">ColumnNumber</a> == <span class="r78 r">pos2</span>.<a href="Position.cs.html#adb21ecf0073d187" class="i property">ColumnNumber</a>, <span class="s">&quot;Rescan failed to return same start column&quot;</span>);
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r77 r">pos1</span>.<a href="Position.cs.html#d4acfffbdddc618b" class="i property">LineNumber</a> == <span class="r78 r">pos2</span>.<a href="Position.cs.html#d4acfffbdddc618b" class="i property">LineNumber</a>, <span class="s">&quot;Rescan failed to return same start line#&quot;</span>);
                    <span class="r77 r">pos1</span> = <span class="r74 r">ungotToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#b8cb5655f70ff8ee" class="i property">EndScriptPosition</a>;
                    <span class="r78 r">pos2</span> = <span class="r76 r">rescan</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#b8cb5655f70ff8ee" class="i property">EndScriptPosition</a>;
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r77 r">pos1</span>.<a href="Position.cs.html#adb21ecf0073d187" class="i property">ColumnNumber</a> == <span class="r78 r">pos2</span>.<a href="Position.cs.html#adb21ecf0073d187" class="i property">ColumnNumber</a>, <span class="s">&quot;Rescan failed to return same end column&quot;</span>);
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r77 r">pos1</span>.<a href="Position.cs.html#d4acfffbdddc618b" class="i property">LineNumber</a> == <span class="r78 r">pos2</span>.<a href="Position.cs.html#d4acfffbdddc618b" class="i property">LineNumber</a>, <span class="s">&quot;Rescan failed to return same end line#&quot;</span>);
                    <span class="c">// Make sure we leave things as they were - Resync clears _ungotToken.</span>
                    <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> = <span class="r74 r">ungotToken</span>;
                    <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#233100b0d292a6a3" class="i property">TokenList</a> = <span class="r75 r">oldTokenList</span>;
                }
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
            }
 
            <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a> = <span class="r73 r">mode</span>;
        }
 
        <b>private void</b> <a id="73d0e59d1708bfb0" href="../../R/73d0e59d1708bfb0.html" target="n" data-glyph="76,1" class="i method">Resync</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r79 rd" class="r79 r">token</span>)
        {
            <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> = <b>null</b>;
            <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#8de22e02c2949bb8" class="i method">Resync</a>(<span class="r79 r">token</span>);
        }
 
        <b>private void</b> <a id="55d3ff509af9c3dd" href="../../R/55d3ff509af9c3dd.html" target="n" data-glyph="76,1" class="i method">Resync</a>(<b>int</b> <span id="r80 rd" class="r80 r">restorePoint</span>)
        {
            <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> = <b>null</b>;
            <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#63c4980d7eb834ea" class="i method">Resync</a>(<span class="r80 r">restorePoint</span>);
        }
 
        <b>private static bool</b> <a id="71bba9aeff3a33d4" href="../../R/71bba9aeff3a33d4.html" target="n" data-glyph="76,1" class="i method">IsSpecificParameter</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r81 rd" class="r81 r">token</span>, <b>string</b> <span id="r82 rd" class="r82 r">parameter</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r81 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c3ec93ee8b22aa7f" class="i field">Parameter</a>, <span class="s">&quot;Token must be a ParameterToken&quot;</span>);
            <a href="token.cs.html#ee13ee02b3131929" class="k">var</a> <span id="r83 rd" class="r83 r">paramToken</span> = (<a href="token.cs.html#ee13ee02b3131929" class="t t">ParameterToken</a>)<span class="r81 r">token</span>;
            <b>return</b> <span class="r82 r">parameter</span>.<span class="i">StartsWith</span>(<span class="r83 r">paramToken</span>.<a href="token.cs.html#c72db3af1374663c" class="i property">ParameterName</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
        }
 
        <b>internal void</b> <a id="236208528ac56c21" href="../../R/236208528ac56c21.html" target="n" data-glyph="74,1" class="i method">RequireStatementTerminator</a>()
        {
            <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r84 rd" class="r84 r">terminatorToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <b>if</b> (<span class="r84 r">terminatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a> || <span class="r84 r">terminatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>)
            {
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
            }
            <b>else</b> <b>if</b> (<span class="r84 r">terminatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
            {
                <span class="i">ReportIncompleteInput</span>(<span class="r84 r">terminatorToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingStatementTerminator</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingStatementTerminator</span>);
            }
        }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="dd55e127a0d16829" href="../../R/dd55e127a0d16829.html" target="n" data-glyph="74,1" class="i method">ExtentOf</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r85 rd" class="r85 r">first</span>, <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r86 rd" class="r86 r">last</span>)
        {
            <b>if</b> (<span class="r85 r">first</span> <b>is</b> <a href="Position.cs.html#9b361bb7f5af38a5" class="t t">EmptyScriptExtent</a>) <b>return</b> <span class="r86 r">last</span>;
            <b>if</b> (<span class="r86 r">last</span> <b>is</b> <a href="Position.cs.html#9b361bb7f5af38a5" class="t t">EmptyScriptExtent</a>) <b>return</b> <span class="r85 r">first</span>;
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r85 r">first</span> <b>is</b> <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a> &amp;&amp; <span class="r86 r">last</span> <b>is</b> <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>,
                <span class="s">&quot;Private method expects internal position representation&quot;</span>);
            <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a> <span id="r87 rd" class="r87 r">l</span> = (<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<span class="r85 r">first</span>;
            <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a> <span id="r88 rd" class="r88 r">r</span> = (<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<span class="r86 r">last</span>;
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r87 r">l</span>.<a href="Position.cs.html#efcbc0d78353af5a" class="i property">PositionHelper</a> == <span class="r88 r">r</span>.<a href="Position.cs.html#efcbc0d78353af5a" class="i property">PositionHelper</a>, <span class="s">&quot;Can&#39;t get the extent across files&quot;</span>);
            <b>return</b> <b>new</b> <a href="Position.cs.html#0b34c128e3d218a0" class="t constructor">InternalScriptExtent</a>(<span class="r87 r">l</span>.<a href="Position.cs.html#efcbc0d78353af5a" class="i property">PositionHelper</a>, <span class="r87 r">l</span>.<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a>, <span class="r88 r">r</span>.<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a>);
        }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="c6ad43b3028af740" href="../../R/c6ad43b3028af740.html" target="n" data-glyph="74,1" class="i method">Before</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r89 rd" class="r89 r">extent</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r89 r">extent</span> <b>is</b> <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>, <span class="s">&quot;Private method expects internal position representation&quot;</span>);
            <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a> <span id="r90 rd" class="r90 r">scriptExtent</span> = (<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<span class="r89 r">extent</span>;
            <b>int</b> <span id="r91 rd" class="r91 r">offset</span> = <span class="r90 r">scriptExtent</span>.<a href="Position.cs.html#a439c4119678d493" class="i property">StartOffset</a> - 1;
            <b>if</b> (<span class="r91 r">offset</span> &lt; 0) <span class="r91 r">offset</span> = 0;
            <b>return</b> <b>new</b> <a href="Position.cs.html#0b34c128e3d218a0" class="t constructor">InternalScriptExtent</a>(<span class="r90 r">scriptExtent</span>.<a href="Position.cs.html#efcbc0d78353af5a" class="i property">PositionHelper</a>, <span class="r91 r">offset</span>, <span class="r91 r">offset</span>);
        }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="44fc203b5b5d4ad4" href="../../R/44fc203b5b5d4ad4.html" target="n" data-glyph="74,1" class="i method">After</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r92 rd" class="r92 r">extent</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r92 r">extent</span> <b>is</b> <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>, <span class="s">&quot;Private method expects internal position representation&quot;</span>);
            <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a> <span id="r93 rd" class="r93 r">scriptExtent</span> = (<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<span class="r92 r">extent</span>;
            <b>int</b> <span id="r94 rd" class="r94 r">offset</span> = <span class="r93 r">scriptExtent</span>.<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a>;
            <b>return</b> <b>new</b> <a href="Position.cs.html#0b34c128e3d218a0" class="t constructor">InternalScriptExtent</a>(<span class="r93 r">scriptExtent</span>.<a href="Position.cs.html#efcbc0d78353af5a" class="i property">PositionHelper</a>, <span class="r94 r">offset</span>, <span class="r94 r">offset</span>);
        }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="ccb6c46e5e3d182e" href="../../R/ccb6c46e5e3d182e.html" target="n" data-glyph="74,1" class="i method">LastCharacterOf</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r95 rd" class="r95 r">extent</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r95 r">extent</span> <b>is</b> <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>, <span class="s">&quot;Private method expects internal position representation&quot;</span>);
            <a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a> <span id="r96 rd" class="r96 r">scriptExtent</span> = (<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<span class="r95 r">extent</span>;
            <b>int</b> <span id="r97 rd" class="r97 r">offset</span> = <span class="r96 r">scriptExtent</span>.<a href="Position.cs.html#fc9692125234532d" class="i property">EndOffset</a> - 1;
            <b>if</b> (<span class="r97 r">offset</span> &lt; 0)
            {
                <span class="r97 r">offset</span> = 0;
            }
 
            <b>return</b> <b>new</b> <a href="Position.cs.html#0b34c128e3d218a0" class="t constructor">InternalScriptExtent</a>(<span class="r96 r">scriptExtent</span>.<a href="Position.cs.html#efcbc0d78353af5a" class="i property">PositionHelper</a>, <span class="r97 r">offset</span>, <span class="r97 r">offset</span>);
        }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="98f9e5041badc0fc" href="../../R/98f9e5041badc0fc.html" target="n" data-glyph="74,1" class="i method">ExtentFromFirstOf</a>(<b>params object</b>[] <span id="r98 rd" class="r98 r">objs</span>)
        {
            <b>foreach</b> (<b>object</b> <span id="r99 rd" class="r99 r">obj</span> <b>in</b> <span class="r98 r">objs</span>)
            {
                <b>if</b> (<span class="r99 r">obj</span> != <b>null</b>)
                {
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r100 rd" class="r100 r">token</span> = <span class="r99 r">obj</span> <b>as</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>;
                    <b>if</b> (<span class="r100 r">token</span> != <b>null</b>)
                    {
                        <b>return</b> <span class="r100 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    }
 
                    <a href="ast.cs.html#d47621d83efd14de" class="k">var</a> <span id="r101 rd" class="r101 r">ast</span> = <span class="r99 r">obj</span> <b>as</b> <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>;
                    <b>if</b> (<span class="r101 r">ast</span> != <b>null</b>)
                    {
                        <b>return</b> <span class="r101 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                    }
 
                    <a href="ast.cs.html#a422e1772da6dbc8" class="k">var</a> <span id="r102 rd" class="r102 r">typename</span> = <span class="r99 r">obj</span> <b>as</b> <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a>;
                    <b>if</b> (<span class="r102 r">typename</span> != <b>null</b>)
                    {
                        <b>return</b> <span class="r102 r">typename</span>.<a href="ast.cs.html#2b8e897172d31016" class="i property">Extent</a>;
                    }
 
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r99 r">obj</span> <b>is</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>, <span class="s">&quot;Only accepts tokens, asts, and IScriptExtents&quot;</span>);
                    <b>return</b> (<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a>)<span class="r99 r">obj</span>;
                }
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;One of the objects must not be null&quot;</span>);
            <b>return</b> <a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>;
        }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="e2dca4f752c5c572" href="../../R/e2dca4f752c5c572.html" target="n" data-glyph="74,1" class="i method">ExtentOf</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r103 rd" class="r103 r">first</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r104 rd" class="r104 r">last</span>) { <b>return</b> <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r103 r">first</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r104 r">last</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>); }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="f4b9cf4dcd548ea3" href="../../R/f4b9cf4dcd548ea3.html" target="n" data-glyph="74,1" class="i method">ExtentOf</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r105 rd" class="r105 r">first</span>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r106 rd" class="r106 r">last</span>) { <b>return</b> <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r105 r">first</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r106 r">last</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>); }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="4ad82407bcef8f0d" href="../../R/4ad82407bcef8f0d.html" target="n" data-glyph="74,1" class="i method">ExtentOf</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r107 rd" class="r107 r">first</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r108 rd" class="r108 r">last</span>) { <b>return</b> <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r107 r">first</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r108 r">last</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>); }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="e1a46ab1f1292733" href="../../R/e1a46ab1f1292733.html" target="n" data-glyph="74,1" class="i method">ExtentOf</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r109 rd" class="r109 r">first</span>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r110 rd" class="r110 r">last</span>) { <b>return</b> <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r109 r">first</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r110 r">last</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>); }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="4229d79777aa8b76" href="../../R/4229d79777aa8b76.html" target="n" data-glyph="74,1" class="i method">ExtentOf</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r111 rd" class="r111 r">first</span>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r112 rd" class="r112 r">last</span>) { <b>return</b> <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r111 r">first</span>, <span class="r112 r">last</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>); }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="f641ab898c5a3be2" href="../../R/f641ab898c5a3be2.html" target="n" data-glyph="74,1" class="i method">ExtentOf</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r113 rd" class="r113 r">first</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r114 rd" class="r114 r">last</span>) { <b>return</b> <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r113 r">first</span>, <span class="r114 r">last</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>); }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="a571f93282f04222" href="../../R/a571f93282f04222.html" target="n" data-glyph="74,1" class="i method">ExtentOf</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r115 rd" class="r115 r">first</span>, <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r116 rd" class="r116 r">last</span>) { <b>return</b> <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r115 r">first</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r116 r">last</span>); }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="65fd6d77f297d927" href="../../R/65fd6d77f297d927.html" target="n" data-glyph="74,1" class="i method">ExtentOf</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r117 rd" class="r117 r">first</span>, <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r118 rd" class="r118 r">last</span>) { <b>return</b> <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r117 r">first</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r118 r">last</span>); }
        <span class="c">// private static IScriptExtent Before(Ast ast) { return Before(ast.Extent); }</span>
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="cb433f96b9585085" href="../../R/cb433f96b9585085.html" target="n" data-glyph="74,1" class="i method">Before</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r119 rd" class="r119 r">token</span>) { <b>return</b> <a href="#c6ad43b3028af740" class="i method">Before</a>(<span class="r119 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>); }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="40407f0b4b50ace7" href="../../R/40407f0b4b50ace7.html" target="n" data-glyph="74,1" class="i method">After</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r120 rd" class="r120 r">ast</span>) { <b>return</b> <a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r120 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>); }
 
        <b>internal static</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="c46b3b53010f50d6" href="../../R/c46b3b53010f50d6.html" target="n" data-glyph="74,1" class="i method">After</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r121 rd" class="r121 r">token</span>) { <b>return</b> <a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r121 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>); }
 
        <b>private static</b> <span class="i">IEnumerable</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <a id="5a40a6e894a3582f" href="../../R/5a40a6e894a3582f.html" target="n" data-glyph="76,1" class="i method">GetNestedErrorAsts</a>(<b>params object</b>[] <span id="r122 rd" class="r122 r">asts</span>)
        {
            <b>foreach</b> (<b>var</b> <span id="r123 rd" class="r123 r">obj</span> <b>in</b> <span class="r122 r">asts</span>)
            {
                <b>if</b> (<span class="r123 r">obj</span> != <b>null</b>)
                {
                    <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r124 rd" class="r124 r">ast</span> = <span class="r123 r">obj</span> <b>as</b> <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>;
                    <b>if</b> (<span class="r124 r">ast</span> != <b>null</b>)
                    {
                        <b>yield</b> <b>return</b> <span class="r124 r">ast</span>;
                    }
                    <b>else</b>
                    {
                        <b>var</b> <span id="r125 rd" class="r125 r">enumerable</span> = <span class="r123 r">obj</span> <b>as</b> <span class="i">IEnumerable</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;;
                        <b>if</b> (<span class="r125 r">enumerable</span> != <b>null</b>)
                        {
                            <b>foreach</b> (<b>var</b> <span id="r126 rd" class="r126 r">ast2</span> <b>in</b> <span class="r125 r">enumerable</span>)
                            {
                                <b>if</b> (<span class="r126 r">ast2</span> != <b>null</b>)
                                {
                                    <b>yield</b> <b>return</b> <span class="r126 r">ast2</span>;
                                }
                            }
                        }
                        <b>else</b>
                        {
                            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<b>false</b>, <span class="s">&quot;Caller to pass only asts, or IEnumerable&lt;Ast&gt;&quot;</span>);
                        }
                    }
                }
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parses the specified constant hashtable string into a Hashtable object.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r127 r">input</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Hashtable string.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r128 r">result</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The Hashtable object.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>internal static bool</b> <a id="fff91726305cc0a4" href="../../R/fff91726305cc0a4.html" target="n" data-glyph="74,1" class="i method">TryParseAsConstantHashtable</a>(<b>string</b> <span id="r127 rd" class="r127 r">input</span>, <b>out</b> <span class="i">Hashtable</span> <span id="r128 rd" class="r128 r">result</span>)
        {
            <span class="r128 r">result</span> = <b>null</b>;
 
            <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r127 r">input</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>[] <span id="r129 rd" class="r129 r">throwAwayTokens</span>;
            <a href="#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r130 rd" class="r130 r">parseErrors</span>;
            <a href="ast.cs.html#6f963589327835a4" class="k">var</a> <span id="r131 rd" class="r131 r">ast</span> = <a href="#bbf5e856fb3215c5" class="t t">Parser</a>.<a href="#8c264bb718ff180a" class="i method">ParseInput</a>(<span class="r127 r">input</span>, <b>out</b> <span class="r129 r">throwAwayTokens</span>, <b>out</b> <span class="r130 r">parseErrors</span>);
 
            <b>if</b> ((<span class="r131 r">ast</span> == <b>null</b>) ||
                <span class="r130 r">parseErrors</span>.<span class="i">Length</span> &gt; 0 ||
                <span class="r131 r">ast</span>.<a href="ast.cs.html#08794a618a2d04ac" class="i property">BeginBlock</a> != <b>null</b> ||
                <span class="r131 r">ast</span>.<a href="ast.cs.html#8940fb8f9b3e6444" class="i property">ProcessBlock</a> != <b>null</b> ||
                <span class="r131 r">ast</span>.<a href="ast.cs.html#4549d1761658a004" class="i property">DynamicParamBlock</a> != <b>null</b> ||
                <span class="r131 r">ast</span>.<a href="ast.cs.html#958e631868900aba" class="i property">EndBlock</a>.<a href="ast.cs.html#2b645ddd993169db" class="i property">Traps</a> != <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>var</b> <span id="r132 rd" class="r132 r">statements</span> = <span class="r131 r">ast</span>.<a href="ast.cs.html#958e631868900aba" class="i property">EndBlock</a>.<a href="ast.cs.html#496f71fcd5c4e6a1" class="i property">Statements</a>;
            <b>if</b> (<span class="r132 r">statements</span>.<span class="i">Count</span> != 1)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (!(<span class="r132 r">statements</span>[0] <b>is</b> <a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r133 rd" class="r133 r">pipelineAst</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r134 rd" class="r134 r">expr</span> = <span class="r133 r">pipelineAst</span>.<a href="ast.cs.html#df65de159259e5e0" class="i method">GetPureExpression</a>();
            <b>if</b> (<span class="r134 r">expr</span> == <b>null</b>)
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>if</b> (!(<span class="r134 r">expr</span> <b>is</b> <a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r135 rd" class="r135 r">hashTableAst</span>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>object</b> <span id="r136 rd" class="r136 r">hashtable</span>;
            <b>if</b> (!<a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<a href="ConstantValues.cs.html#594e7e13f898b0a1" class="i method">IsConstant</a>(<span class="r135 r">hashTableAst</span>, <b>out</b> <span class="r136 r">hashtable</span>, <span class="r137 r">forRequires</span>: <b>true</b>))
            {
                <b>return</b> <b>false</b>;
            }
 
            <b>var</b> <span id="r138 rd" class="r138 r">data</span> = <span class="r136 r">hashtable</span> <b>as</b> <span class="i">Hashtable</span>;
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>((<span class="r138 r">data</span> != <b>null</b>), <span class="s">&quot;IsConstantValueVisitor.IsConstant() should return false when the specified HashtableAst is not a avalid Hashtable&quot;</span>);
            <span class="r128 r">result</span> = <span class="r138 r">data</span>;
            <b>return</b> <b>true</b>;
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Utilities
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Statements
 
        <b>private</b> <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="41a9f47c78b86651" href="../../R/41a9f47c78b86651.html" target="n" data-glyph="76,1" class="i method">ScriptBlockRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r139 rd" class="r139 r">lCurly</span>, <b>bool</b> <span id="r37 rd" class="r37 r">isFilter</span>)
        {
            <b>return</b> <a href="#305d86f1b6248e31" class="i method">ScriptBlockRule</a>(<span class="r139 r">lCurly</span>, <span class="r37 r">isFilter</span>, <b>null</b>);
        }
 
        <b>private</b> <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="305d86f1b6248e31" href="../../R/305d86f1b6248e31.html" target="n" data-glyph="76,1" class="i method">ScriptBlockRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r140 rd" class="r140 r">lCurly</span>, <b>bool</b> <span id="r141 rd" class="r141 r">isFilter</span>, <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r142 rd" class="r142 r">predefinedStatementAst</span>)
        {
            <span class="c">// G  script-block:</span>
            <span class="c">// G      using-statements:opt   param-block:opt   statement-terminators:opt   script-block-body:opt</span>
            <span class="c">// G</span>
            <span class="c">// G  using-statements:</span>
            <span class="c">// G      using-statement</span>
            <span class="c">// G      using-statements   using-statement</span>
 
            <span class="c">// We could set the mode here, but we can avoid rescanning keywords if the caller</span>
            <span class="c">// sets the mode before skipping newlines.</span>
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a> == <a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#d9f88bf7436b84df" class="i field">Command</a>,
                <span class="s">&quot;Caller to make sure the mode is correct.&quot;</span>);
 
            <span class="c">// Skipping newlines here saves a more expensive resync if there is no parameter block.</span>
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <b>var</b> <span id="r143 rd" class="r143 r">usingStatements</span> = <span class="r140 r">lCurly</span> == <b>null</b> ? <a href="#93edeeeb0d3883a3" class="i method">UsingStatementsRule</a>() : <b>null</b>;
 
            <b>var</b> <span id="r144 rd" class="r144 r">restorePoint</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#820e8f7ae7d9d17c" class="i method">GetRestorePoint</a>();
            <a href="ast.cs.html#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r145 rd" class="r145 r">paramBlock</span> = <a href="#9dbe521d0aea4f1f" class="i method">ParamBlockRule</a>();
            <b>if</b> (<span class="r145 r">paramBlock</span> == <b>null</b>)
            {
                <span class="c">// In case we scanned some attributes or type constraints but they didn&#39;t</span>
                <span class="c">// belong to a param statement, we need to reparse them (because they will</span>
                <span class="c">// mean something different, such as a type literal expression, or a cast.)</span>
                <a href="#55d3ff509af9c3dd" class="i method">Resync</a>(<span class="r144 r">restorePoint</span>);
            }
 
            <a href="#20cf6d6d776dad25" class="i method">SkipNewlinesAndSemicolons</a>();
 
            <b>return</b> <a href="#b31f7e9b41cf3176" class="i method">ScriptBlockBodyRule</a>(<span class="r140 r">lCurly</span>, <span class="r143 r">usingStatements</span>, <span class="r145 r">paramBlock</span>, <span class="r141 r">isFilter</span>, <span class="r142 r">predefinedStatementAst</span>);
        }
 
        <b>private</b> <span class="i">List</span>&lt;<a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <a id="93edeeeb0d3883a3" href="../../R/93edeeeb0d3883a3.html" target="n" data-glyph="76,1" class="i method">UsingStatementsRule</a>()
        {
            <span class="i">List</span>&lt;<a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <span id="r146 rd" class="r146 r">result</span> = <b>null</b>;
 
            <b>while</b> (<b>true</b>)
            {
                <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r147 rd" class="r147 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r147 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9e1e77e046f0b0f" class="i field">Using</a>)
                {
                    <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                    <a href="ast.cs.html#9c25dfdd7f4807b0" class="k">var</a> <span id="r148 rd" class="r148 r">statement</span> = <a href="#45244f65958da4bb" class="i method">UsingStatementRule</a>(<span class="r147 r">token</span>);
                    <a href="#20cf6d6d776dad25" class="i method">SkipNewlinesAndSemicolons</a>();
                    <b>if</b> (<span class="r146 r">result</span> == <b>null</b>)
                    {
                        <span class="r146 r">result</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt;();
                    }
 
                    <a href="ast.cs.html#a269e1753cbc4c90" class="k">var</a> <span id="r149 rd" class="r149 r">usingStatement</span> = <span class="r148 r">statement</span> <b>as</b> <a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a>;
                    <span class="c">// otherwise returned statement is ErrorStatementAst.</span>
                    <span class="c">// We ignore it here, because error already reported to the parser.</span>
                    <b>if</b> (<span class="r149 r">usingStatement</span> != <b>null</b>)
                    {
                        <span class="r146 r">result</span>.<span class="i">Add</span>(<span class="r149 r">usingStatement</span>);
                    }
 
                    <b>continue</b>;
                }
 
                <span class="c">// Normally we don&#39;t need to resync, but our caller may speculatively scan much more than</span>
                <span class="c">// one token, so it needs the restore point to include this token.</span>
                <a href="#73d0e59d1708bfb0" class="i method">Resync</a>(<span class="r147 r">token</span>);
                <b>break</b>;
            }
 
            <b>return</b> <span class="r146 r">result</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <a id="9dbe521d0aea4f1f" href="../../R/9dbe521d0aea4f1f.html" target="n" data-glyph="76,1" class="i method">ParamBlockRule</a>()
        {
            <span class="c">// G  param-block:</span>
            <span class="c">// G      new-lines:opt   attribute-list:opt   new-lines:opt   &#39;param&#39;   new-lines:opt</span>
            <span class="c">// G              &#39;(&#39;   parameter-list:opt   new-lines:opt   &#39;)&#39;</span>
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <span class="i">List</span>&lt;<a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt; <span id="r150 rd" class="r150 r">candidateAttributes</span> = <a href="#4b35774058ff957d" class="i method">AttributeListRule</a>(<b>false</b>);
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r151 rd" class="r151 r">paramToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <b>if</b> (<span class="r151 r">paramToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3dce94013578e058" class="i field">Param</a>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r152 rd" class="r152 r">lparen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r152 r">lparen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>)
            {
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r152 r">lparen</span>);
 
                <span class="c">// This is not an error, we&#39;ll end up trying to invoke a command named &#39;param&#39;.</span>
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">List</span>&lt;<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <span id="r153 rd" class="r153 r">parameters</span> = <a href="#dadaf18d18923b93" class="i method">ParameterListRule</a>();
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r154 rd" class="r154 r">rParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <a href="Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r155 rd" class="r155 r">endExtent</span> = <span class="r154 r">rParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
            <b>if</b> (<span class="r154 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>)
            {
                <span class="c">// ErrorRecovery: assume we saw the closing paren and continue like normal.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r154 r">rParen</span>);
                <span class="r155 r">endExtent</span> = <a href="#cb433f96b9585085" class="i method">Before</a>(<span class="r154 r">rParen</span>);
                <span class="i">ReportIncompleteInput</span>(<span class="i">After</span>(<span class="r153 r">parameters</span> != <b>null</b> &amp;&amp; <span class="r153 r">parameters</span>.<span class="i">Count</span> &gt; 0 ? <span class="r153 r">parameters</span>.<span class="i">Last</span>().<span class="i">Extent</span> : <span class="r152 r">lparen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInFunctionParameterList</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInFunctionParameterList</span>);
            }
 
            <span class="i">List</span>&lt;<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <span id="r156 rd" class="r156 r">attributes</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;();
            <b>if</b> (<span class="r150 r">candidateAttributes</span> != <b>null</b>)
            {
                <b>foreach</b> (<a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a> <span id="r157 rd" class="r157 r">attr</span> <b>in</b> <span class="r150 r">candidateAttributes</span>)
                {
                    <a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a> <span id="r158 rd" class="r158 r">attribute</span> = <span class="r157 r">attr</span> <b>as</b> <a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>;
                    <b>if</b> (<span class="r158 r">attribute</span> != <b>null</b>)
                    {
                        <span class="r156 r">attributes</span>.<span class="i">Add</span>(<span class="r158 r">attribute</span>);
                    }
                    <b>else</b>
                    {
                        <span class="c">// ErrorRecovery: nothing to do, this is a semantic error that is caught in the parser</span>
                        <span class="c">// because the ast only allows attributes, no type constraints.</span>
 
                        <span class="i">ReportError</span>(<span class="r157 r">attr</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TypeNotAllowedBeforeParam</span>),
                            <span class="i">ParserStrings</span>.<span class="i">TypeNotAllowedBeforeParam</span>,
                            <span class="r157 r">attr</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>);
                    }
                }
            }
 
            <b>return</b> <b>new</b> <span class="t">ParamBlockAst</span>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r151 r">paramToken</span>, <span class="r155 r">endExtent</span>), <span class="r156 r">attributes</span>, <span class="r153 r">parameters</span>);
        }
 
        <b>private</b> <span class="i">List</span>&lt;<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a id="dadaf18d18923b93" href="../../R/dadaf18d18923b93.html" target="n" data-glyph="76,1" class="i method">ParameterListRule</a>()
        {
            <span class="c">// G  parameter-list:</span>
            <span class="c">// G      script-parameter</span>
            <span class="c">// G      parameter-list   new-lines:opt   &#39;,&#39;   script-parameter</span>
 
            <span class="i">List</span>&lt;<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <span id="r159 rd" class="r159 r">parameters</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt;();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r160 rd" class="r160 r">commaToken</span> = <b>null</b>;
            <b>while</b> (<b>true</b>)
            {
                <a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a> <span id="r161 rd" class="r161 r">parameter</span> = <a href="#85506d88a2910d91" class="i method">ParameterRule</a>();
                <b>if</b> (<span class="r161 r">parameter</span> == <b>null</b>)
                {
                    <b>if</b> (<span class="r160 r">commaToken</span> != <b>null</b>)
                    {
                        <span class="c">// ErrorRecovery: ??</span>
 
                        <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r160 r">commaToken</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterToken</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterToken</span>,
                            <span class="r160 r">commaToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                    }
 
                    <b>break</b>;
                }
 
                <span class="r159 r">parameters</span>.<span class="i">Add</span>(<span class="r161 r">parameter</span>);
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r160 r">commaToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r160 r">commaToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                {
                    <b>break</b>;
                }
 
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
            }
 
            <b>return</b> <span class="r159 r">parameters</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a> <a id="85506d88a2910d91" href="../../R/85506d88a2910d91.html" target="n" data-glyph="76,1" class="i method">ParameterRule</a>()
        {
            <span class="c">// G  script-parameter:</span>
            <span class="c">// G      new-lines:opt   attribute-list:opt   new-lines:opt   variable   script-parameter-default:opt</span>
            <span class="c">// G  script-parameter-default:</span>
            <span class="c">// G      new-lines:opt   &#39;=&#39;   new-lines:opt   expression</span>
 
            <span class="i">List</span>&lt;<a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt; <span id="r162 rd" class="r162 r">attributes</span>;
            <a href="token.cs.html#cb1e7cc3b0285414" class="t t">VariableToken</a> <span id="r163 rd" class="r163 r">variableToken</span>;
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r164 rd" class="r164 r">defaultValue</span> = <b>null</b>;
 
            <b>bool</b> <span id="r165 rd" class="r165 r">oldDisableCommaOperator</span> = <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a>;
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r166 rd" class="r166 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <b>true</b>;
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#9b6269e007d113c3" class="i field">Expression</a>);
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r162 r">attributes</span> = <a href="#4b35774058ff957d" class="i method">AttributeListRule</a>(<b>false</b>);
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r167 rd" class="r167 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r167 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8b5a9c54e2029553" class="i field">Variable</a> &amp;&amp; <span class="r167 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4fc017e5ff76f173" class="i field">SplattedVariable</a>)
                {
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r167 r">token</span>);
                    <b>if</b> (<span class="r162 r">attributes</span> != <b>null</b>)
                    {
                        <span class="c">// ErrorRecovery: skip to closing paren because returning null signals the last parameter.</span>
 
                        <span class="i">ReportIncompleteInput</span>(<span class="i">After</span>(<span class="r162 r">attributes</span>.<span class="i">Last</span>()),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidFunctionParameter</span>),
                            <span class="i">ParserStrings</span>.<span class="i">InvalidFunctionParameter</span>);
                        <a href="#e51058c98956995e" class="i method">SyncOnError</a>(<b>true</b>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>);
 
                        <span class="c">// Even though we don&#39;t have a complete parameter, we do have attributes.  Intellisense</span>
                        <span class="c">// might want to complete something in the attributes, so we need to return something useful.</span>
                        <a href="Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r168 rd" class="r168 r">extent</span> = <span class="i">ExtentOf</span>(<span class="r162 r">attributes</span>[0].<span class="i">Extent</span>, <span class="r162 r">attributes</span>[<span class="r162 r">attributes</span>.<span class="i">Count</span> - 1].<span class="i">Extent</span>);
                        <b>return</b> <b>new</b> <span class="t">ParameterAst</span>(<span class="r168 r">extent</span>, <b>new</b> <a href="ast.cs.html#ca2f2cf1331a5386" class="t constructor">VariableExpressionAst</a>(<span class="r168 r">extent</span>, <span class="s">&quot;__error__&quot;</span>, <b>false</b>), <span class="r162 r">attributes</span>, <b>null</b>);
                    }
 
                    <b>return</b> <b>null</b>;
                }
 
                <span class="r163 r">variableToken</span> = ((<a href="token.cs.html#cb1e7cc3b0285414" class="t t">VariableToken</a>)<span class="r167 r">token</span>);
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r169 rd" class="r169 r">equalsToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r169 r">equalsToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d78e08594ff6b79a" class="i field">Equals</a>)
                {
                    <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <span class="r164 r">defaultValue</span> = <a href="#8da955af7d659a21" class="i method">ExpressionRule</a>();
                    <b>if</b> (<span class="r164 r">defaultValue</span> == <b>null</b>)
                    {
                        <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r169 r">equalsToken</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterToken</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterToken</span>,
                            <span class="r169 r">equalsToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                    }
                }
            }
            <b>finally</b>
            {
                <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <span class="r165 r">oldDisableCommaOperator</span>;
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r166 r">oldTokenizerMode</span>);
            }
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r170 rd" class="r170 r">startExtent</span> = (<span class="r162 r">attributes</span> == <b>null</b>) ? <span class="r163 r">variableToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a> : <span class="r162 r">attributes</span>[0].<span class="i">Extent</span>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r171 rd" class="r171 r">endExtent</span> = (<span class="r164 r">defaultValue</span> == <b>null</b>) ? <span class="r163 r">variableToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a> : <span class="r164 r">defaultValue</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
            <b>return</b> <b>new</b> <span class="t">ParameterAst</span>(<a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r170 r">startExtent</span>, <span class="r171 r">endExtent</span>),
                <b>new</b> <a href="ast.cs.html#7703a30c5cc584b7" class="t constructor">VariableExpressionAst</a>(<span class="r163 r">variableToken</span>), <span class="r162 r">attributes</span>, <span class="r164 r">defaultValue</span>);
        }
 
        <b>private</b> <span class="i">List</span>&lt;<a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt; <a id="4b35774058ff957d" href="../../R/4b35774058ff957d.html" target="n" data-glyph="76,1" class="i method">AttributeListRule</a>(<b>bool</b> <span id="r172 rd" class="r172 r">inExpressionMode</span>)
        {
            <span class="c">// G  attribute-list:</span>
            <span class="c">// G      attribute</span>
            <span class="c">// G      attribute-list   attribute</span>
 
            <span class="i">List</span>&lt;<a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt; <span id="r173 rd" class="r173 r">attributes</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt;();
            <a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a> <span id="r174 rd" class="r174 r">attribute</span> = <a href="#b8ee90436ed71ebc" class="i method">AttributeRule</a>();
            <b>while</b> (<span class="r174 r">attribute</span> != <b>null</b>)
            {
                <span class="r173 r">attributes</span>.<span class="i">Add</span>(<span class="r174 r">attribute</span>);
                <b>if</b> (!<span class="r172 r">inExpressionMode</span> || <span class="r174 r">attribute</span> <b>is</b> <a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>)
                {
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                }
 
                <span class="r174 r">attribute</span> = <a href="#b8ee90436ed71ebc" class="i method">AttributeRule</a>();
            }
 
            <b>if</b> (<span class="r173 r">attributes</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <span class="r173 r">attributes</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a> <a id="b8ee90436ed71ebc" href="../../R/b8ee90436ed71ebc.html" target="n" data-glyph="76,1" class="i method">AttributeRule</a>()
        {
            <span class="c">// G  attribute:</span>
            <span class="c">// G      &#39;[&#39;   attribute-name   &#39;(&#39;   attribute-arguments   &#39;)&#39;   &#39;]&#39;</span>
            <span class="c">// G  attribute-name:</span>
            <span class="c">// G      type-spec</span>
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r175 rd" class="r175 r">lBracket</span> = <a href="#ad1f983a7da03b1f" class="i method">NextLBracket</a>();
            <b>if</b> (<span class="r175 r">lBracket</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r176 rd" class="r176 r">firstTypeNameToken</span>;
            <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r177 rd" class="r177 r">typeName</span> = <a href="#94ecdfa0b8f28cd7" class="i method">TypeNameRule</a>(<span class="r50 r">allowAssemblyQualifiedNames</span>: <b>true</b>, <span class="r51 r">firstTypeNameToken</span>: <b>out</b> <span class="r176 r">firstTypeNameToken</span>);
            <b>if</b> (<span class="r177 r">typeName</span> == <b>null</b>)
            {
                <span class="c">// ErrorRecovery: Return null so we stop looking for attributes.</span>
 
                <a href="#73d0e59d1708bfb0" class="i method">Resync</a>(<span class="r175 r">lBracket</span>);  <span class="c">// TypeNameRule might have consumed some tokens</span>
                <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r175 r">lBracket</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingTypename</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingTypename</span>);
                <b>return</b> <b>null</b>;
            }
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r178 rd" class="r178 r">lParenOrRBracket</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r178 r">lParenOrRBracket</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>)
            {
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r179 rd" class="r179 r">positionalArguments</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;();
                <span class="i">List</span>&lt;<a href="ast.cs.html#283d46191e6456a4" class="t t">NamedAttributeArgumentAst</a>&gt; <span id="r180 rd" class="r180 r">namedArguments</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#283d46191e6456a4" class="t t">NamedAttributeArgumentAst</a>&gt;();
 
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r181 rd" class="r181 r">lastItemExtent</span> = <span class="r178 r">lParenOrRBracket</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r182 rd" class="r182 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
                <b>try</b>
                {
                    <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#9b6269e007d113c3" class="i field">Expression</a>);
                    <span class="i">AttributeArgumentsRule</span>(<span class="r179 r">positionalArguments</span>, <span class="r180 r">namedArguments</span>, <b>ref</b> <span class="r181 r">lastItemExtent</span>);
                }
                <b>finally</b>
                {
                    <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r182 r">oldTokenizerMode</span>);
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r183 rd" class="r183 r">rParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r183 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>)
                {
                    <span class="c">// ErrorRecovery: pretend we saw a &#39;)&#39;, attempt to find an &#39;]&#39;.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r183 r">rParen</span>);
                    <span class="r183 r">rParen</span> = <b>null</b>;
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r181 r">lastItemExtent</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInExpression</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInExpression</span>);
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r184 rd" class="r184 r">rBracket</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r184 r">rBracket</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>)
                {
                    <span class="c">// ErrorRecovery: pretend we saw a &#39;]&#39;, return our result.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r184 r">rBracket</span>);
                    <span class="r184 r">rBracket</span> = <b>null</b>;
                    <span class="c">// Don&#39;t bother reporting a missing &#39;]&#39; if we reported a missing &#39;)&#39;.</span>
                    <b>if</b> (<span class="r183 r">rParen</span> != <b>null</b>)
                    {
                        <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r183 r">rParen</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EndSquareBracketExpectedAtEndOfAttribute</span>),
                            <span class="i">ParserStrings</span>.<span class="i">EndSquareBracketExpectedAtEndOfAttribute</span>);
                    }
                }
 
                <span class="r176 r">firstTypeNameToken</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> |= <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#2ff56e60a2755d3f" class="i field">AttributeName</a>;
                <b>return</b> <b>new</b> <span class="t">AttributeAst</span>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r175 r">lBracket</span>, <a href="#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r184 r">rBracket</span>, <span class="r183 r">rParen</span>, <span class="r181 r">lastItemExtent</span>)), <span class="r177 r">typeName</span>, <span class="r179 r">positionalArguments</span>, <span class="r180 r">namedArguments</span>);
            }
 
            <b>if</b> (<a href="#1efe96ce80819a98" class="i property">ProduceV2Tokens</a>)
            {
                <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r185 rd" class="r185 r">typeToken</span> = <b>new</b> <a href="token.cs.html#bdf3e1fce1afd274" class="t constructor">Token</a>((<a href="Position.cs.html#a988805453837004" class="t t">InternalScriptExtent</a>)<a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r175 r">lBracket</span>, <span class="r178 r">lParenOrRBracket</span>),
                    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a>, <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#5f165a9a05394b87" class="i field">TypeName</a>);
                <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#6976344d863ce9cd" class="i method">ReplaceSavedTokens</a>(<span class="r175 r">lBracket</span>, <span class="r178 r">lParenOrRBracket</span>, <span class="r185 r">typeToken</span>);
            }
 
            <b>if</b> (<span class="r178 r">lParenOrRBracket</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>)
            {
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r178 r">lParenOrRBracket</span>);
                <span class="i">ReportError</span>(<a href="#cb433f96b9585085" class="i method">Before</a>(<span class="r178 r">lParenOrRBracket</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EndSquareBracketExpectedAtEndOfAttribute</span>),
                    <span class="i">ParserStrings</span>.<span class="i">EndSquareBracketExpectedAtEndOfAttribute</span>);
                <span class="r178 r">lParenOrRBracket</span> = <b>null</b>;
            }
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#51c2fb9bdf674fb1" class="t constructor">TypeConstraintAst</a>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r175 r">lBracket</span>, <a href="#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r178 r">lParenOrRBracket</span>, <span class="r177 r">typeName</span>.<a href="ast.cs.html#2b8e897172d31016" class="i property">Extent</a>)), <span class="r177 r">typeName</span>);
        }
 
        <b>private void</b> <a id="b9dbece6ec276cfe" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">AttributeArgumentsRule</a>(<span class="i">ICollection</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r186 rd" class="r186 r">positionalArguments</span>,
                                            <span class="i">ICollection</span>&lt;<a href="ast.cs.html#283d46191e6456a4" class="t t">NamedAttributeArgumentAst</a>&gt; <span id="r187 rd" class="r187 r">namedArguments</span>,
                                            <b>ref</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r188 rd" class="r188 r">lastItemExtent</span>)
        {
            <span class="c">// G  attribute-arguments:</span>
            <span class="c">// G      attribute-argument</span>
            <span class="c">// G      attribute-argument   new-lines:opt   &#39;,&#39;   attribute-arguments</span>
            <span class="c">// G  attribute-argument:</span>
            <span class="c">// G      new-lines:opt   expression</span>
            <span class="c">// G      new-lines:opt   property-name   &#39;=&#39;   new-lines:opt   expression</span>
 
            <b>bool</b> <span id="r189 rd" class="r189 r">oldDisableCommaOperator</span> = <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r190 rd" class="r190 r">commaToken</span> = <b>null</b>;
            <span class="i">HashSet</span>&lt;<b>string</b>&gt; <span id="r191 rd" class="r191 r">keysSeen</span> = <b>new</b> <span class="i">HashSet</span>&lt;<b>string</b>&gt;();
            <b>try</b>
            {
                <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <b>true</b>;
                <b>while</b> (<b>true</b>)
                {
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                    <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <span id="r192 rd" class="r192 r">name</span> = <a href="#942135886d841ed5" class="i method">SimpleNameRule</a>();
                    <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r193 rd" class="r193 r">expr</span>;
                    <b>bool</b> <span id="r194 rd" class="r194 r">expressionOmitted</span> = <b>false</b>;
 
                    <b>if</b> (<span class="r192 r">name</span> != <b>null</b>)
                    {
                        <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r195 rd" class="r195 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                        <b>if</b> (<span class="r195 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d78e08594ff6b79a" class="i field">Equals</a>)
                        {
                            <span class="r195 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                            <span class="r193 r">expr</span> = <a href="#8da955af7d659a21" class="i method">ExpressionRule</a>();
 
                            <b>if</b> (<span class="r193 r">expr</span> == <b>null</b>)
                            {
                                <span class="c">// ErrorRecovery: ?</span>
 
                                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r196 rd" class="r196 r">errorPosition</span> = <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r195 r">token</span>);
                                <span class="i">ReportIncompleteInput</span>(
                                    <span class="r196 r">errorPosition</span>,
                                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingExpressionInNamedArgument</span>),
                                    <span class="i">ParserStrings</span>.<span class="i">MissingExpressionInNamedArgument</span>);
                                <span class="r193 r">expr</span> = <b>new</b> <a href="ast.cs.html#521987ae533dc4bd" class="t constructor">ErrorExpressionAst</a>(<span class="r196 r">errorPosition</span>);
                                <a href="#e51058c98956995e" class="i method">SyncOnError</a>(<b>true</b>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a>);
                            }
 
                            <span class="r188 r">lastItemExtent</span> = <span class="r193 r">expr</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                        }
                        <b>else</b>
                        {
                            <span class="c">// If the expression is missing, assume the value true</span>
                            <span class="c">// and record that it was defaulted for better error messages.</span>
                            <span class="r193 r">expr</span> = <b>new</b> <a href="ast.cs.html#e66e5aa53121afdc" class="t constructor">ConstantExpressionAst</a>(<span class="r192 r">name</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <b>true</b>);
                            <span class="r194 r">expressionOmitted</span> = <b>true</b>;
                        }
                    }
                    <b>else</b>
                    {
                        <span class="r193 r">expr</span> = <a href="#8da955af7d659a21" class="i method">ExpressionRule</a>();
                    }
 
                    <b>if</b> (<span class="r192 r">name</span> != <b>null</b>)
                    {
                        <b>if</b> (<span class="r191 r">keysSeen</span>.<span class="i">Contains</span>(<span class="r192 r">name</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>))
                        {
                            <span class="c">// ErrorRecovery: this is a semantic error, so just keep parsing.</span>
 
                            <span class="i">ReportError</span>(<span class="r192 r">name</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DuplicateNamedArgument</span>),
                                <span class="i">ParserStrings</span>.<span class="i">DuplicateNamedArgument</span>,
                                <span class="r192 r">name</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>);
                        }
                        <b>else</b>
                        {
                            <span class="r187 r">namedArguments</span>.<span class="i">Add</span>(<b>new</b> <a href="ast.cs.html#98717b4b553d59d3" class="t constructor">NamedAttributeArgumentAst</a>(<a href="#f4b9cf4dcd548ea3" class="i method">ExtentOf</a>(<span class="r192 r">name</span>, <span class="r193 r">expr</span>),
                                <span class="r192 r">name</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <span class="r193 r">expr</span>, <span class="r194 r">expressionOmitted</span>));
                        }
                    }
                    <b>else</b> <b>if</b> (<span class="r193 r">expr</span> != <b>null</b>)
                    {
                        <span class="r186 r">positionalArguments</span>.<span class="i">Add</span>(<span class="r193 r">expr</span>);
                        <span class="r188 r">lastItemExtent</span> = <span class="r193 r">expr</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                    }
                    <b>else</b> <b>if</b> (<span class="r190 r">commaToken</span> != <b>null</b>)
                    {
                        <span class="c">// ErrorRecovery: Pretend we saw the argument and keep going.</span>
 
                        <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r197 rd" class="r197 r">errorExtent</span> = <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r190 r">commaToken</span>);
                        <span class="i">ReportIncompleteInput</span>(
                            <span class="r197 r">errorExtent</span>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterToken</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterToken</span>,
                            <span class="r190 r">commaToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                        <span class="r186 r">positionalArguments</span>.<span class="i">Add</span>(<b>new</b> <a href="ast.cs.html#521987ae533dc4bd" class="t constructor">ErrorExpressionAst</a>(<span class="r197 r">errorExtent</span>));
                        <span class="r188 r">lastItemExtent</span> = <span class="r197 r">errorExtent</span>;
                    }
 
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <span class="r190 r">commaToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                    <b>if</b> (<span class="r190 r">commaToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                    {
                        <b>break</b>;
                    }
 
                    <span class="r188 r">lastItemExtent</span> = <span class="r190 r">commaToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                }
            }
            <b>finally</b>
            {
                <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <span class="r189 r">oldDisableCommaOperator</span>;
            }
        }
 
        <b>private</b> <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <a id="94ecdfa0b8f28cd7" href="../../R/94ecdfa0b8f28cd7.html" target="n" data-glyph="76,1" class="i method">TypeNameRule</a>(<b>bool</b> <span id="r50 rd" class="r50 r">allowAssemblyQualifiedNames</span>, <b>out</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r51 rd" class="r51 r">firstTypeNameToken</span>)
        {
            <span class="c">// G  type-spec:</span>
            <span class="c">// G      array-type-name    dimension:opt   &#39;]&#39;</span>
            <span class="c">// G      generic-type-name   generic-type-arguments   &#39;]&#39;</span>
            <span class="c">// G      type-name</span>
            <span class="c">// G  array-type-name:</span>
            <span class="c">// G      type-name   &#39;[&#39;</span>
            <span class="c">// G  generic-type-name:</span>
            <span class="c">// G      type-name   &#39;[&#39;</span>
            <span class="c">// G  dimension:</span>
            <span class="c">// G      &#39;,&#39;</span>
            <span class="c">// G      dimension   &#39;,&#39;</span>
            <span class="c">// G  generic-type-arguments:</span>
            <span class="c">// G      type-spec</span>
            <span class="c">// G      generic-type-arguments   &#39;,&#39;   type-spec</span>
            <span class="c">// G  type-name:</span>
            <span class="c">// G      namespace-type-name</span>
            <span class="c">// G      namespace-type-name   &#39;,&#39;   assembly-name-spec</span>
            <span class="c">// G  namespace-type-name:</span>
            <span class="c">// G      nested-type-name</span>
            <span class="c">// G      namespace-spec   &#39;.&#39;   nested-type-name</span>
            <span class="c">// G  nested-type-name:</span>
            <span class="c">// G      type-name-identifier</span>
            <span class="c">// G      nested-type-name   &#39;+&#39;   type-name-identifier</span>
            <span class="c">// G  namespace-spec:</span>
            <span class="c">// G      type-name-identifier</span>
            <span class="c">// G      type-name-identifier   &#39;.&#39;   type-name-identifier</span>
            <span class="c">// G  type-name-identifier:</span>
            <span class="c">// G      type-name-identifier-char</span>
            <span class="c">// G      type-name-identifier   type-name-identifier-char</span>
            <span class="c">// G  type-name-identifier-char:</span>
            <span class="c">// G      any letter, digit, &#39;.&#39;, &#39;`&#39;, or &#39;_&#39;.</span>
 
            <span class="c">// The above grammar is specified by the CLR.  We don&#39;t attempt to implement the above grammar precisely, e.g.</span>
            <span class="c">// we would permit &#39;a+b.c&#39;.  The above grammar would disallow this.</span>
 
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r198 rd" class="r198 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <span class="c">// Switch to typename mode to avoid aggressive argument tokenization.</span>
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#2fb25110d5ff3e8b" class="i field">TypeName</a>);
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r199 rd" class="r199 r">typeName</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r199 r">typeName</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a>)
                {
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r199 r">typeName</span>);
                    <span class="r51 r">firstTypeNameToken</span> = <b>null</b>;
                    <b>return</b> <b>null</b>;
                }
 
                <span class="c">// firstTypeNameToken is returned so we can mark it as an attribute if it turns out</span>
                <span class="c">// that we&#39;ve got a attribute instead of a type literal.</span>
                <span class="r51 r">firstTypeNameToken</span> = <span class="r199 r">typeName</span>;
                <b>return</b> <a href="#9b44aef0915ed62d" class="i method">FinishTypeNameRule</a>(<span class="r199 r">typeName</span>, <span class="r200 r">allowAssemblyQualifiedNames</span>: <span class="r50 r">allowAssemblyQualifiedNames</span>);
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r198 r">oldTokenizerMode</span>);
            }
        }
 
        <b>private</b> <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <a id="9b44aef0915ed62d" href="../../R/9b44aef0915ed62d.html" target="n" data-glyph="76,1" class="i method">FinishTypeNameRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r201 rd" class="r201 r">typeName</span>, <b>bool</b> <span id="r202 rd" class="r202 r">unBracketedGenericArg</span> = <b>false</b>, <b>bool</b> <span id="r200 rd" class="r200 r">allowAssemblyQualifiedNames</span> = <b>true</b>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r201 r">typeName</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a>, <span class="s">&quot;Caller must verify the argument.&quot;</span>);
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r203 rd" class="r203 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <b>if</b> (<span class="r203 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>)
            {
                <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r204 rd" class="r204 r">lbracket</span> = <span class="r203 r">token</span>;
 
                <span class="c">// Array or generic</span>
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r203 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>switch</b> (<span class="r203 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
                {
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>:
                        <a href="ast.cs.html#83b43c1855a09e15" class="k">var</a> <span id="r205 rd" class="r205 r">elementType</span> = <b>new</b> <a href="ast.cs.html#1bbc28f331464eab" class="t constructor">TypeName</a>(<span class="r201 r">typeName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r201 r">typeName</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                        <b>return</b> <a href="#f001b77e40d1aaf4" class="i method">CompleteArrayTypeName</a>(<span class="r205 r">elementType</span>, <span class="r205 r">elementType</span>, <span class="r203 r">token</span>);
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a>:
                        <b>return</b> <a href="#55778c1685124b34" class="i method">GenericTypeArgumentsRule</a>(<span class="r201 r">typeName</span>, <span class="r203 r">token</span>, <span class="r202 r">unBracketedGenericArg</span>);
 
                    <b>default</b>:
                        <span class="c">// ErrorRecovery: sync to &#39;]&#39;, and return non-null to avoid cascading errors.</span>
 
                        <b>if</b> (<span class="r203 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
                        {
                            <span class="i">ReportError</span>(<span class="r203 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>),
                                <span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>,
                                <span class="r203 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                            <a href="#e51058c98956995e" class="i method">SyncOnError</a>(<b>true</b>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>);
                        }
                        <b>else</b>
                        {
                            <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r203 r">token</span>);
                            <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r204 r">lbracket</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingTypename</span>),
                                <span class="i">ParserStrings</span>.<span class="i">MissingTypename</span>);
                        }
 
                        <b>return</b> <b>new</b> <a href="ast.cs.html#1bbc28f331464eab" class="t constructor">TypeName</a>(<span class="r201 r">typeName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r201 r">typeName</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                }
            }
 
            <b>if</b> (<span class="r203 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a> &amp;&amp; <span class="r200 r">allowAssemblyQualifiedNames</span> &amp;&amp; !<span class="r202 r">unBracketedGenericArg</span>)
            {
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <b>string</b> <span id="r206 rd" class="r206 r">assemblyNameSpec</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#a322ff38d3963f0c" class="i method">GetAssemblyNameSpec</a>();
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrWhiteSpace</span>(<span class="r206 r">assemblyNameSpec</span>))
                {
                    <span class="i">ReportError</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r203 r">token</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingAssemblyNameSpecification</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingAssemblyNameSpecification</span>);
                    <b>return</b> <b>new</b> <a href="ast.cs.html#1bbc28f331464eab" class="t constructor">TypeName</a>(<span class="r201 r">typeName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r201 r">typeName</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                }
 
                <b>return</b> <b>new</b> <a href="ast.cs.html#f6430e74ef3d1e35" class="t constructor">TypeName</a>(<a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r201 r">typeName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e07f6456e81dea92" class="i method">CurrentExtent</a>()), <span class="r201 r">typeName</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <span class="r206 r">assemblyNameSpec</span>);
            }
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#1bbc28f331464eab" class="t constructor">TypeName</a>(<span class="r201 r">typeName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r201 r">typeName</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
        }
 
        <b>private</b> <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <a id="ce126f258165056f" href="../../R/ce126f258165056f.html" target="n" data-glyph="76,1" class="i method">GetSingleGenericArgument</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r207 rd" class="r207 r">firstToken</span>)
        {
            <b>if</b> (<span class="r207 r">firstToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a>)
            {
                <b>return</b> <a href="#9b44aef0915ed62d" class="i method">FinishTypeNameRule</a>(<span class="r207 r">firstToken</span>, <span class="r202 r">unBracketedGenericArg</span>: <b>true</b>);
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r207 r">firstToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>, <span class="s">&quot;caller to verify correct token kind&quot;</span>);
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r208 rd" class="r208 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r208 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a>)
            {
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r208 r">token</span>);
                <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r208 r">token</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingTypename</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingTypename</span>);
                <b>return</b> <b>new</b> <a href="ast.cs.html#1bbc28f331464eab" class="t constructor">TypeName</a>(<span class="r207 r">firstToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;:ErrorTypeName:&quot;</span>);
            }
 
            <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r209 rd" class="r209 r">typeName</span> = <a href="#9b44aef0915ed62d" class="i method">FinishTypeNameRule</a>(<span class="r208 r">token</span>);
            <b>if</b> (<span class="r209 r">typeName</span> != <b>null</b>)
            {
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r210 rd" class="r210 r">rBracket</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r210 r">rBracket</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>)
                {
                    <span class="c">// ErrorRecovery: pretend we saw the closing bracket.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r210 r">rBracket</span>);
                    <span class="i">ReportIncompleteInput</span>(<a href="#cb433f96b9585085" class="i method">Before</a>(<span class="r210 r">rBracket</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EndSquareBracketExpectedAtEndOfType</span>),
                        <span class="i">ParserStrings</span>.<span class="i">EndSquareBracketExpectedAtEndOfType</span>);
                }
            }
 
            <b>return</b> <span class="r209 r">typeName</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <a id="55778c1685124b34" href="../../R/55778c1685124b34.html" target="n" data-glyph="76,1" class="i method">GenericTypeArgumentsRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r211 rd" class="r211 r">genericTypeName</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r212 rd" class="r212 r">firstToken</span>, <b>bool</b> <span id="r213 rd" class="r213 r">unBracketedGenericArg</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r212 r">firstToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a> || <span class="r212 r">firstToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>, <span class="s">&quot;unexpected first token&quot;</span>);
            <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
            <b>var</b> <span id="r214 rd" class="r214 r">genericArguments</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a>&gt;();
 
            <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r215 rd" class="r215 r">typeName</span> = <a href="#ce126f258165056f" class="i method">GetSingleGenericArgument</a>(<span class="r212 r">firstToken</span>);
            <span class="r214 r">genericArguments</span>.<span class="i">Add</span>(<span class="r215 r">typeName</span>);
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r216 rd" class="r216 r">commaOrRBracketToken</span>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r217 rd" class="r217 r">token</span>;
            <b>while</b> (<b>true</b>)
            {
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r216 r">commaOrRBracketToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r216 r">commaOrRBracketToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                {
                    <b>break</b>;
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <span class="r217 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r217 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a> || <span class="r217 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>)
                {
                    <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                    <span class="r215 r">typeName</span> = <a href="#ce126f258165056f" class="i method">GetSingleGenericArgument</a>(<span class="r217 r">token</span>);
                }
                <b>else</b>
                {
                    <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r216 r">commaOrRBracketToken</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingTypename</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingTypename</span>);
                    <span class="r215 r">typeName</span> = <b>new</b> <a href="ast.cs.html#1bbc28f331464eab" class="t constructor">TypeName</a>(<span class="r216 r">commaOrRBracketToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;:ErrorTypeName:&quot;</span>);
                }
 
                <span class="r214 r">genericArguments</span>.<span class="i">Add</span>(<span class="r215 r">typeName</span>);
            }
 
            <b>if</b> (<span class="r216 r">commaOrRBracketToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>)
            {
                <span class="c">// ErrorRecovery: pretend we had the closing bracket and just continue on.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r216 r">commaOrRBracketToken</span>);
                <span class="i">ReportIncompleteInput</span>(<a href="#cb433f96b9585085" class="i method">Before</a>(<span class="r216 r">commaOrRBracketToken</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EndSquareBracketExpectedAtEndOfAttribute</span>),
                    <span class="i">ParserStrings</span>.<span class="i">EndSquareBracketExpectedAtEndOfAttribute</span>);
                <span class="r216 r">commaOrRBracketToken</span> = <b>null</b>;
            }
 
            <a href="ast.cs.html#83b43c1855a09e15" class="k">var</a> <span id="r218 rd" class="r218 r">openGenericType</span> = <b>new</b> <a href="ast.cs.html#1bbc28f331464eab" class="t constructor">TypeName</a>(<span class="r211 r">genericTypeName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r211 r">genericTypeName</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
            <a href="ast.cs.html#d3e3939e37307477" class="k">var</a> <span id="r219 rd" class="r219 r">result</span> = <b>new</b> <span class="t">GenericTypeName</span>(<a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r211 r">genericTypeName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="i">ExtentFromFirstOf</span>(<span class="r216 r">commaOrRBracketToken</span>, <span class="r214 r">genericArguments</span>.<span class="i">LastOrDefault</span>(), <span class="r212 r">firstToken</span>)),
                <span class="r218 r">openGenericType</span>, <span class="r214 r">genericArguments</span>);
            <span class="r217 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <b>if</b> (<span class="r217 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>)
            {
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <b>return</b> <a href="#f001b77e40d1aaf4" class="i method">CompleteArrayTypeName</a>(<span class="r219 r">result</span>, <span class="r218 r">openGenericType</span>, <a href="#98aafb96cd3508ac" class="i method">NextToken</a>());
            }
 
            <b>if</b> (<span class="r217 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a> &amp;&amp; !<span class="r213 r">unBracketedGenericArg</span>)
            {
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <b>string</b> <span id="r220 rd" class="r220 r">assemblyNameSpec</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#a322ff38d3963f0c" class="i method">GetAssemblyNameSpec</a>();
                <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r220 r">assemblyNameSpec</span>))
                {
                    <span class="i">ReportError</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r217 r">token</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingAssemblyNameSpecification</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingAssemblyNameSpecification</span>);
                }
                <b>else</b>
                {
                    <span class="r218 r">openGenericType</span>.<a href="ast.cs.html#e32629caa327873e" class="i property">AssemblyName</a> = <span class="r220 r">assemblyNameSpec</span>;
                }
            }
 
            <b>return</b> <span class="r219 r">result</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <a id="f001b77e40d1aaf4" href="../../R/f001b77e40d1aaf4.html" target="n" data-glyph="76,1" class="i method">CompleteArrayTypeName</a>(<a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r221 rd" class="r221 r">elementType</span>, <a href="ast.cs.html#83b43c1855a09e15" class="t t">TypeName</a> <span id="r222 rd" class="r222 r">typeForAssemblyQualification</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r223 rd" class="r223 r">firstTokenAfterLBracket</span>)
        {
            <b>while</b> (<b>true</b>)
            {
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r224 rd" class="r224 r">token</span>;
                <b>switch</b> (<span class="r223 r">firstTokenAfterLBracket</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
                {
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>:
                        <b>int</b> <span id="r225 rd" class="r225 r">dim</span> = 1;
                        <span class="r224 r">token</span> = <span class="r223 r">firstTokenAfterLBracket</span>;
                        <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r226 rd" class="r226 r">lastComma</span>;
                        <b>do</b>
                        {
                            <span class="r226 r">lastComma</span> = <span class="r224 r">token</span>;
                            <span class="r225 r">dim</span> += 1;
                            <span class="r224 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                        } <b>while</b> (<span class="r224 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>);
 
                        <b>if</b> (<span class="r224 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>)
                        {
                            <span class="c">// ErrorRecovery: just pretend we saw a &#39;]&#39;.</span>
 
                            <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r224 r">token</span>);
                            <span class="i">ReportError</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r226 r">lastComma</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EndSquareBracketExpectedAtEndOfAttribute</span>),
                                <span class="i">ParserStrings</span>.<span class="i">EndSquareBracketExpectedAtEndOfAttribute</span>);
                        }
 
                        <span class="r221 r">elementType</span> = <b>new</b> <a href="ast.cs.html#b7ddb3bddac03e32" class="t constructor">ArrayTypeName</a>(<a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r221 r">elementType</span>.<a href="ast.cs.html#2b8e897172d31016" class="i property">Extent</a>, <span class="r224 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>), <span class="r221 r">elementType</span>, <span class="r225 r">dim</span>);
                        <b>break</b>;
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>:
                        <span class="r221 r">elementType</span> = <b>new</b> <a href="ast.cs.html#b7ddb3bddac03e32" class="t constructor">ArrayTypeName</a>(<a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r221 r">elementType</span>.<a href="ast.cs.html#2b8e897172d31016" class="i property">Extent</a>, <span class="r223 r">firstTokenAfterLBracket</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>), <span class="r221 r">elementType</span>, 1);
                        <b>break</b>;
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>:
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r223 r">firstTokenAfterLBracket</span>);
                        <span class="i">ReportError</span>(<a href="#cb433f96b9585085" class="i method">Before</a>(<span class="r223 r">firstTokenAfterLBracket</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EndSquareBracketExpectedAtEndOfAttribute</span>),
                            <span class="i">ParserStrings</span>.<span class="i">EndSquareBracketExpectedAtEndOfAttribute</span>);
                        <b>break</b>;
 
                    <b>default</b>:
                        <span class="c">// ErrorRecovery: sync to &#39;]&#39;, and return null to avoid cascading errors.</span>
 
                        <span class="i">ReportError</span>(<span class="r223 r">firstTokenAfterLBracket</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>),
                            <span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>,
                            <span class="r223 r">firstTokenAfterLBracket</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                        <a href="#e51058c98956995e" class="i method">SyncOnError</a>(<b>true</b>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>);
                        <b>break</b>;
                }
 
                <span class="r224 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r224 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                {
                    <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                    <b>var</b> <span id="r227 rd" class="r227 r">assemblyName</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#a322ff38d3963f0c" class="i method">GetAssemblyNameSpec</a>();
                    <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r227 r">assemblyName</span>))
                    {
                        <span class="i">ReportError</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r224 r">token</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingAssemblyNameSpecification</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingAssemblyNameSpecification</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r222 r">typeForAssemblyQualification</span>.<a href="ast.cs.html#e32629caa327873e" class="i property">AssemblyName</a> = <span class="r227 r">assemblyName</span>;
                    }
 
                    <b>break</b>;
                }
 
                <b>if</b> (<span class="r224 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>)
                {
                    <b>break</b>;
                }
 
                <span class="c">// Jagged array, skip the &#39;[&#39; and keep parsing.</span>
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <span class="r223 r">firstTokenAfterLBracket</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            }
 
            <b>return</b> <span class="r221 r">elementType</span>;
        }
 
        <b>private bool</b> <a id="060342f78e4db7f8" href="../../R/060342f78e4db7f8.html" target="n" data-glyph="76,1" class="i method">CompleteScriptBlockBody</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r228 rd" class="r228 r">lCurly</span>, <b>ref</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r229 rd" class="r229 r">bodyExtent</span>, <b>out</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r230 rd" class="r230 r">fullBodyExtent</span>)
        {
            <span class="c">// If the caller passed in the open curly, then they expect us to consume the closing curly</span>
            <span class="c">// and include that in the extent.</span>
            <b>if</b> (<span class="r228 r">lCurly</span> != <b>null</b>)
            {
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r231 rd" class="r231 r">rCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r232 rd" class="r232 r">endScriptBlock</span>;
                <b>if</b> (<span class="r231 r">rCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>)
                {
                    <span class="c">// ErrorRecovery: pretend we saw the closing curly.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r231 r">rCurly</span>);
                    <span class="r232 r">endScriptBlock</span> = <span class="r229 r">bodyExtent</span> ?? <span class="r228 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    <span class="i">ReportIncompleteInput</span>(<span class="r228 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <span class="r231 r">rCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndCurlyBrace</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingEndCurlyBrace</span>);
                }
                <b>else</b>
                {
                    <span class="r232 r">endScriptBlock</span> = <span class="r231 r">rCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    <span class="c">// If body was empty, use the extent b/w (but not including) the curlies, but only</span>
                    <span class="c">// if that region has at least 1 character.</span>
                    <b>if</b> (<span class="r229 r">bodyExtent</span> == <b>null</b> &amp;&amp; (<span class="r228 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#155675f601d14734" class="i property">EndColumnNumber</a> != <span class="r231 r">rCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>))
                    {
                        <span class="r229 r">bodyExtent</span> = <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r228 r">lCurly</span>), <a href="#cb433f96b9585085" class="i method">Before</a>(<span class="r231 r">rCurly</span>));
                    }
                }
 
                <span class="r230 r">fullBodyExtent</span> = <a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r228 r">lCurly</span>, <span class="r232 r">endScriptBlock</span>);
            }
            <b>else</b>
            {
                <span class="r230 r">fullBodyExtent</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#d94187e9658017e7" class="i method">GetScriptExtent</a>();
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r233 rd" class="r233 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r233 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
                {
                    <span class="c">// ErrorRecovery: eat the unexpected token, and continue parsing to find more</span>
                    <span class="c">// of the script.</span>
 
                    <span class="i">ReportError</span>(<span class="r233 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>),
                        <span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>,
                        <span class="r233 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                    <b>return</b> <b>false</b>;
                }
            }
 
            <b>return</b> <b>true</b>;
        }
 
        <b>private</b> <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="b31f7e9b41cf3176" href="../../R/b31f7e9b41cf3176.html" target="n" data-glyph="76,1" class="i method">ScriptBlockBodyRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r234 rd" class="r234 r">lCurly</span>, <span class="i">List</span>&lt;<a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <span id="r235 rd" class="r235 r">usingStatements</span>, <a href="ast.cs.html#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r236 rd" class="r236 r">paramBlockAst</span>, <b>bool</b> <span id="r237 rd" class="r237 r">isFilter</span>, <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r238 rd" class="r238 r">predefinedStatementAst</span>)
        {
            <span class="c">// G  script-block-body:</span>
            <span class="c">// G      named-block-list</span>
            <span class="c">// G      statement-list</span>
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r239 rd" class="r239 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
 
            <b>if</b> ((<span class="r239 r">token</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> &amp; <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#387f851b946225c7" class="i field">ScriptBlockBlockName</a>) == <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#387f851b946225c7" class="i field">ScriptBlockBlockName</a>)
            {
                <b>return</b> <a href="#39e5881e6298cb7b" class="i method">NamedBlockListRule</a>(<span class="r234 r">lCurly</span>, <span class="r235 r">usingStatements</span>, <span class="r236 r">paramBlockAst</span>);
            }
 
            <span class="i">List</span>&lt;<a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt; <span id="r240 rd" class="r240 r">traps</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt;();
            <span class="i">List</span>&lt;<a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <span id="r241 rd" class="r241 r">statements</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt;();
            <b>if</b> (<span class="r238 r">predefinedStatementAst</span> != <b>null</b>)
            {
                <span class="r241 r">statements</span>.<span class="i">Add</span>(<span class="r238 r">predefinedStatementAst</span>);
            }
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r242 rd" class="r242 r">statementListExtent</span> = <span class="r236 r">paramBlockAst</span>?.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r243 rd" class="r243 r">scriptBlockExtent</span>;
 
            <b>while</b> (<b>true</b>)
            {
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r244 rd" class="r244 r">extent</span> = <a href="#4fde70daaf395c24" class="i method">StatementListRule</a>(<span class="r241 r">statements</span>, <span class="r240 r">traps</span>);
                <b>if</b> (<span class="r242 r">statementListExtent</span> == <b>null</b>)
                {
                    <span class="r242 r">statementListExtent</span> = <span class="r244 r">extent</span>;
                }
                <b>else</b> <b>if</b> (<span class="r244 r">extent</span> != <b>null</b>)
                {
                    <span class="r242 r">statementListExtent</span> = <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r242 r">statementListExtent</span>, <span class="r244 r">extent</span>);
                }
 
                <b>if</b> (<a href="#060342f78e4db7f8" class="i method">CompleteScriptBlockBody</a>(<span class="r234 r">lCurly</span>, <b>ref</b> <span class="r242 r">statementListExtent</span>, <b>out</b> <span class="r243 r">scriptBlockExtent</span>))
                {
                    <b>break</b>;
                }
            }
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#a2dbcaca81de6b8e" class="t constructor">ScriptBlockAst</a>(<span class="r243 r">scriptBlockExtent</span>, <span class="r235 r">usingStatements</span>, <span class="r236 r">paramBlockAst</span>,
                <b>new</b> <span class="t">StatementBlockAst</span>(<span class="r242 r">statementListExtent</span> ?? <a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>, <span class="r241 r">statements</span>, <span class="r240 r">traps</span>), <span class="r237 r">isFilter</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <a id="39e5881e6298cb7b" href="../../R/39e5881e6298cb7b.html" target="n" data-glyph="76,1" class="i method">NamedBlockListRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r245 rd" class="r245 r">lCurly</span>, <span class="i">List</span>&lt;<a href="ast.cs.html#a269e1753cbc4c90" class="t t">UsingStatementAst</a>&gt; <span id="r246 rd" class="r246 r">usingStatements</span>, <a href="ast.cs.html#be95362bdc5e7d07" class="t t">ParamBlockAst</a> <span id="r247 rd" class="r247 r">paramBlockAst</span>)
        {
            <span class="c">// G  named-block-list:</span>
            <span class="c">// G      named-block</span>
            <span class="c">// G      named-block-list   named-block</span>
            <span class="c">// G  named-block:</span>
            <span class="c">// G      statement-terminators:opt   block-name   statement-block</span>
            <span class="c">// G  block-name:  one of</span>
            <span class="c">// G      &#39;dynamicparam&#39;   &#39;begin&#39;   &#39;process&#39;    &#39;end&#39;</span>
 
            <a href="ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r248 rd" class="r248 r">dynamicParamBlock</span> = <b>null</b>;
            <a href="ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r249 rd" class="r249 r">beginBlock</span> = <b>null</b>;
            <a href="ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r250 rd" class="r250 r">processBlock</span> = <b>null</b>;
            <a href="ast.cs.html#61c97c02c53bf32d" class="t t">NamedBlockAst</a> <span id="r251 rd" class="r251 r">endBlock</span> = <b>null</b>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r252 rd" class="r252 r">startExtent</span> = <span class="r245 r">lCurly</span> != <b>null</b>
                                            ? <span class="r245 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>
                                            : <span class="r247 r">paramBlockAst</span>?.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r253 rd" class="r253 r">endExtent</span> = <b>null</b>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r254 rd" class="r254 r">extent</span> = <b>null</b>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r255 rd" class="r255 r">scriptBlockExtent</span> = <b>null</b>;
 
            <b>while</b> (<b>true</b>)
            {
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r256 rd" class="r256 r">blockNameToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>switch</b> (<span class="r256 r">blockNameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
                {
                    <b>default</b>:
                        <span class="c">// Next token is unexpected.</span>
                        <span class="c">// ErrorRecovery: if &#39;lCurly&#39; is present, pretend we saw a closing curly; otherwise, eat the unexpected token.</span>
                        <b>if</b> (<span class="r245 r">lCurly</span> != <b>null</b>)
                        {
                            <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r256 r">blockNameToken</span>);
                            <span class="r255 r">scriptBlockExtent</span> = <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r252 r">startExtent</span>, <span class="r253 r">endExtent</span>);
                        }
                        <b>else</b>
                        {
                            <span class="c">// If &quot;lCurly == null&quot;, then it&#39;s a ps1/psm1 file, and thus the extent is the whole file.</span>
                            <span class="r255 r">scriptBlockExtent</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#d94187e9658017e7" class="i method">GetScriptExtent</a>();
                        }
 
                        <span class="c">// Report error about the unexpected token.</span>
                        <span class="i">ReportError</span>(<span class="r256 r">blockNameToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingNamedBlocks</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingNamedBlocks</span>,
                            <span class="r256 r">blockNameToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                        <b>goto</b> <span class="i">return_script_block_ast</span>;
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>:
                        <span class="c">// If the next token is RCurly or &lt;eof&gt;, handle it in &#39;CompleteScriptBlockBody&#39;.</span>
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r256 r">blockNameToken</span>);
                        <span class="r254 r">extent</span> = <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r252 r">startExtent</span>, <span class="r253 r">endExtent</span>);
                        <b>goto</b> <span class="i">finished_named_block_list</span>;
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#47d5893abf9a2fb2" class="i field">Dynamicparam</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#21e2c9fe8b59b672" class="i field">Begin</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5a3e1e2680f1369f" class="i field">Process</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#052b72289e97de9a" class="i field">End</a>:
                        <b>break</b>;
                }
 
                <b>if</b> (<span class="r252 r">startExtent</span> == <b>null</b>)
                {
                    <span class="r252 r">startExtent</span> = <span class="r256 r">blockNameToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                }
 
                <span class="r253 r">endExtent</span> = <span class="r256 r">blockNameToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
 
                <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r257 rd" class="r257 r">statementBlock</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
 
                <b>if</b> (<span class="r257 r">statementBlock</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: Eat the block name and keep going, there might be a valid block next.</span>
 
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r256 r">blockNameToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingNamedStatementBlock</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingNamedStatementBlock</span>,
                        <span class="r256 r">blockNameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                    <span class="r257 r">statementBlock</span> = <b>new</b> <span class="t">StatementBlockAst</span>(<span class="r256 r">blockNameToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="i">Array</span>.<span class="i">Empty</span>&lt;<a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt;(), <b>null</b>);
                }
                <b>else</b>
                {
                    <span class="r253 r">endExtent</span> = <span class="r257 r">statementBlock</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                }
 
                <span class="r254 r">extent</span> = <a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r256 r">blockNameToken</span>, <span class="r253 r">endExtent</span>);
                <b>if</b> (<span class="r256 r">blockNameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#21e2c9fe8b59b672" class="i field">Begin</a> &amp;&amp; <span class="r249 r">beginBlock</span> == <b>null</b>)
                {
                    <span class="r249 r">beginBlock</span> = <b>new</b> <a href="ast.cs.html#96d8e19358d66e35" class="t constructor">NamedBlockAst</a>(<span class="r254 r">extent</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#21e2c9fe8b59b672" class="i field">Begin</a>, <span class="r257 r">statementBlock</span>, <b>false</b>);
                }
                <b>else</b> <b>if</b> (<span class="r256 r">blockNameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5a3e1e2680f1369f" class="i field">Process</a> &amp;&amp; <span class="r250 r">processBlock</span> == <b>null</b>)
                {
                    <span class="r250 r">processBlock</span> = <b>new</b> <a href="ast.cs.html#96d8e19358d66e35" class="t constructor">NamedBlockAst</a>(<span class="r254 r">extent</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5a3e1e2680f1369f" class="i field">Process</a>, <span class="r257 r">statementBlock</span>, <b>false</b>);
                }
                <b>else</b> <b>if</b> (<span class="r256 r">blockNameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#052b72289e97de9a" class="i field">End</a> &amp;&amp; <span class="r251 r">endBlock</span> == <b>null</b>)
                {
                    <span class="r251 r">endBlock</span> = <b>new</b> <a href="ast.cs.html#96d8e19358d66e35" class="t constructor">NamedBlockAst</a>(<span class="r254 r">extent</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#052b72289e97de9a" class="i field">End</a>, <span class="r257 r">statementBlock</span>, <b>false</b>);
                }
                <b>else</b> <b>if</b> (<span class="r256 r">blockNameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#47d5893abf9a2fb2" class="i field">Dynamicparam</a> &amp;&amp; <span class="r248 r">dynamicParamBlock</span> == <b>null</b>)
                {
                    <span class="r248 r">dynamicParamBlock</span> = <b>new</b> <a href="ast.cs.html#96d8e19358d66e35" class="t constructor">NamedBlockAst</a>(<span class="r254 r">extent</span>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#47d5893abf9a2fb2" class="i field">Dynamicparam</a>, <span class="r257 r">statementBlock</span>, <b>false</b>);
                }
                <b>else</b>
                {
                    <span class="c">// ErrorRecovery: this is a semantic error, we can keep parsing w/o trouble.</span>
 
                    <span class="i">ReportError</span>(<span class="r254 r">extent</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DuplicateScriptCommandClause</span>),
                        <span class="i">ParserStrings</span>.<span class="i">DuplicateScriptCommandClause</span>,
                        <span class="r256 r">blockNameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                }
 
                <a href="#20cf6d6d776dad25" class="i method">SkipNewlinesAndSemicolons</a>();
            }
 
        <span class="i">finished_named_block_list</span>:
            <a href="#060342f78e4db7f8" class="i method">CompleteScriptBlockBody</a>(<span class="r245 r">lCurly</span>, <b>ref</b> <span class="r254 r">extent</span>, <b>out</b> <span class="r255 r">scriptBlockExtent</span>);
 
        <span class="i">return_script_block_ast</span>:
            <b>return</b> <b>new</b> <span class="t">ScriptBlockAst</span>(<span class="r255 r">scriptBlockExtent</span>, <span class="r246 r">usingStatements</span>, <span class="r247 r">paramBlockAst</span>, <span class="r249 r">beginBlock</span>, <span class="r250 r">processBlock</span>, <span class="r251 r">endBlock</span>,
                <span class="r248 r">dynamicParamBlock</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <a id="15197feac3278717" href="../../R/15197feac3278717.html" target="n" data-glyph="76,1" class="i method">StatementBlockRule</a>()
        {
            <span class="c">// G  statement-block:</span>
            <span class="c">// G      new-lines:opt   &#39;{&#39;   statement-list:opt   new-lines:opt   &#39;}&#39;</span>
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r258 rd" class="r258 r">lCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r258 r">lCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>)
            {
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r258 r">lCurly</span>);
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">List</span>&lt;<a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt; <span id="r259 rd" class="r259 r">traps</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt;();
            <span class="i">List</span>&lt;<a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <span id="r260 rd" class="r260 r">statements</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt;();
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r261 rd" class="r261 r">statementListExtent</span> = <a href="#4fde70daaf395c24" class="i method">StatementListRule</a>(<span class="r260 r">statements</span>, <span class="r259 r">traps</span>);
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r262 rd" class="r262 r">rCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r263 rd" class="r263 r">endBlock</span>;
            <b>if</b> (<span class="r262 r">rCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>)
            {
                <span class="c">// ErrorRecovery: Pretend we saw the missing curly and keep parsing.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r262 r">rCurly</span>);
                <span class="r263 r">endBlock</span> = <span class="r261 r">statementListExtent</span> ?? <span class="r258 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <span class="i">ReportIncompleteInput</span>(<span class="r258 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                    <span class="r262 r">rCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndCurlyBrace</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingEndCurlyBrace</span>);
            }
            <b>else</b>
            {
                <span class="r263 r">endBlock</span> = <span class="r262 r">rCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
            }
 
            <b>return</b> <b>new</b> <span class="t">StatementBlockAst</span>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r258 r">lCurly</span>, <span class="r263 r">endBlock</span>), <span class="r260 r">statements</span>, <span class="r259 r">traps</span>);
        }
 
        <b>private</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="4fde70daaf395c24" href="../../R/4fde70daaf395c24.html" target="n" data-glyph="76,1" class="i method">StatementListRule</a>(<span class="i">List</span>&lt;<a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <span id="r264 rd" class="r264 r">statements</span>, <span class="i">List</span>&lt;<a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt; <span id="r265 rd" class="r265 r">traps</span>)
        {
            <span class="c">// G  statement-list:</span>
            <span class="c">// G      statement</span>
            <span class="c">// G      statement-list   statement</span>
 
            <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r266 rd" class="r266 r">firstStatement</span> = <b>null</b>;
            <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r267 rd" class="r267 r">lastStatement</span> = <b>null</b>;
            <a href="#20cf6d6d776dad25" class="i method">SkipNewlinesAndSemicolons</a>();
            <b>while</b> (<b>true</b>)
            {
                <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r268 rd" class="r268 r">statement</span> = <a href="#90788aa7288d5462" class="i method">StatementRule</a>();
 
                <b>if</b> (<span class="r268 r">statement</span> == <b>null</b>)
                {
                    <b>break</b>;
                }
 
                <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#fd34384505f698b0" class="i method">CheckAstIsBeforeSignature</a>(<span class="r268 r">statement</span>);
 
                <a href="ast.cs.html#5cedc9c886fbe837" class="k">var</a> <span id="r269 rd" class="r269 r">trapStatementAst</span> = <span class="r268 r">statement</span> <b>as</b> <a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a>;
                <b>if</b> (<span class="r269 r">trapStatementAst</span> != <b>null</b>)
                {
                    <span class="r265 r">traps</span>.<span class="i">Add</span>(<span class="r269 r">trapStatementAst</span>);
                }
                <b>else</b>
                {
                    <span class="r264 r">statements</span>.<span class="i">Add</span>(<span class="r268 r">statement</span>);
                }
 
                <span class="c">// Track the last statement inside our loop so we don&#39;t use the EmptyPipeline</span>
                <span class="c">// as our last statement.  The last statement is used to track the extent of</span>
                <span class="c">// this statement list.</span>
                <b>if</b> (<span class="r266 r">firstStatement</span> == <b>null</b>)
                {
                    <span class="r266 r">firstStatement</span> = <span class="r268 r">statement</span>;
                }
 
                <span class="r267 r">lastStatement</span> = <span class="r268 r">statement</span>;
 
                <a href="#20cf6d6d776dad25" class="i method">SkipNewlinesAndSemicolons</a>();
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r270 rd" class="r270 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r270 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a> || <span class="r270 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>)
                {
                    <b>break</b>;
                }
            }
 
            <b>return</b> (<span class="r266 r">firstStatement</span> == <b>null</b>) ? <b>null</b> : <a href="#f4b9cf4dcd548ea3" class="i method">ExtentOf</a>(<span class="r266 r">firstStatement</span>, <span class="r267 r">lastStatement</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parse a single statement.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A statement ast.  Never returns null, always returns PipelineAst.EmptyPipeline if there was no statement.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="90788aa7288d5462" href="../../R/90788aa7288d5462.html" target="n" data-glyph="76,1" class="i method">StatementRule</a>()
        {
            <span class="c">// G  statement:</span>
            <span class="c">// G      if-statement</span>
            <span class="c">// G      label:opt   labeled-statement</span>
            <span class="c">// G      function-statement</span>
            <span class="c">// G      flow-control-statement   statement-terminator</span>
            <span class="c">// G      trap-statement</span>
            <span class="c">// G      try-statement</span>
            <span class="c">// G      data-statement</span>
            <span class="c">// G      pipeline-chain   statement-terminator</span>
            <span class="c">// G</span>
            <span class="c">// G  labeled-statement:</span>
            <span class="c">// G      switch-statement</span>
            <span class="c">// G      foreach-statement</span>
            <span class="c">// G      for-statement</span>
            <span class="c">// G      while-statement</span>
            <span class="c">// G      do-statement</span>
            <span class="c">// G</span>
            <span class="c">// G  flow-control-statement:</span>
            <span class="c">// G      &#39;break&#39;   label-expression:opt</span>
            <span class="c">// G      &#39;continue&#39;   label-expression:opt</span>
            <span class="c">// G      &#39;throw&#39;    pipeline:opt</span>
            <span class="c">// G      &#39;return&#39;   pipeline:opt</span>
            <span class="c">// G      &#39;exit&#39;   pipeline:opt</span>
            <span class="c">// G</span>
            <span class="c">// G  statement-terminator:</span>
            <span class="c">// G      &#39;;&#39;</span>
            <span class="c">// G      new-line-character</span>
            <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
            <b>int</b> <span id="r271 rd" class="r271 r">restorePoint</span> = 0;
 
            <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r272 rd" class="r272 r">statement</span>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r273 rd" class="r273 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
 
            <span class="i">List</span>&lt;<a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt; <span id="r274 rd" class="r274 r">attributes</span> = <b>null</b>;
            <b>if</b> (<span class="r273 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1aeb1084525225c9" class="i field">Generic</a> &amp;&amp; <span class="r273 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>[0] == <span class="s">&#39;[&#39;</span>)
            {
                <span class="r271 r">restorePoint</span> = <span class="r273 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>;
                <a href="#73d0e59d1708bfb0" class="i method">Resync</a>(<span class="r273 r">token</span>);
                <span class="r274 r">attributes</span> = <a href="#4b35774058ff957d" class="i method">AttributeListRule</a>(<b>false</b>);
                <span class="r273 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
 
                <b>if</b> (<span class="r274 r">attributes</span> != <b>null</b>
                    &amp;&amp; <span class="r274 r">attributes</span>.<span class="i">Count</span> &gt; 0)
                {
                    <b>if</b> ((<span class="r273 r">token</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> &amp; <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#d0c8ad47a2b375cb" class="i field">StatementDoesntSupportAttributes</a>) != 0)
                    {
                        <b>if</b> (<span class="r274 r">attributes</span>.<span class="i">OfType</span>&lt;<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;().<span class="i">Any</span>())
                        {
                            <a href="#55d3ff509af9c3dd" class="i method">Resync</a>(<span class="r271 r">restorePoint</span>);
                            <span class="r273 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                        }
                        <b>else</b>
                        {
                            <span class="i">ReportError</span>(<span class="r274 r">attributes</span>[0].<span class="i">Extent</span>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedAttribute</span>),
                                <span class="i">ParserStrings</span>.<span class="i">UnexpectedAttribute</span>,
                                <span class="r274 r">attributes</span>[0].<span class="i">TypeName</span>.<span class="i">FullName</span>);
                        }
                    }
                    <b>else</b> <b>if</b> ((<span class="r273 r">token</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> &amp; <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#bffc83c32a1428ea" class="i field">Keyword</a>) != 0)
                    {
                        <b>foreach</b> (<b>var</b> <span id="r275 rd" class="r275 r">attr</span> <b>in</b> <span class="r274 r">attributes</span>.<span class="i">Where</span>(<b>static</b> <span id="r276 rd" class="r276 r">attr</span> =&gt; <span class="r276 r">attr</span> <b>is not</b> <a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>))
                        {
                            <span class="i">ReportError</span>(<span class="r275 r">attr</span>.<span class="i">Extent</span>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TypeNotAllowedBeforeStatement</span>),
                                <span class="i">ParserStrings</span>.<span class="i">TypeNotAllowedBeforeStatement</span>,
                                <span class="r275 r">attr</span>.<span class="i">TypeName</span>.<span class="i">FullName</span>);
                            <b>break</b>;
                        }
                    }
                    <b>else</b>
                    {
                        <a href="#55d3ff509af9c3dd" class="i method">Resync</a>(<span class="r271 r">restorePoint</span>);
                        <span class="r273 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                    }
                }
            }
 
            <b>switch</b> (<span class="r273 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
            {
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c81edbb275411cf8" class="i field">If</a>:
                    <span class="r272 r">statement</span> = <a href="#4613cb608305449e" class="i method">IfStatementRule</a>(<span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#16bd62526b80a3f2" class="i field">Switch</a>:
                    <span class="r272 r">statement</span> = <a href="#6ff99ec89a9b0852" class="i method">SwitchStatementRule</a>(<b>null</b>, <span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5b4aeac56a39476f" class="i field">Foreach</a>:
                    <span class="r272 r">statement</span> = <a href="#fd6b7e4011769f20" class="i method">ForeachStatementRule</a>(<b>null</b>, <span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#783a6f71a3854549" class="i field">For</a>:
                    <span class="r272 r">statement</span> = <a href="#ba51fa7b7becb48f" class="i method">ForStatementRule</a>(<b>null</b>, <span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#73bf75a67618407f" class="i field">While</a>:
                    <span class="r272 r">statement</span> = <a href="#402593b1b428d906" class="i method">WhileStatementRule</a>(<b>null</b>, <span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b1e5a3400d6e1c03" class="i field">Do</a>:
                    <span class="r272 r">statement</span> = <a href="#bbaea32273e026b0" class="i method">DoWhileStatementRule</a>(<b>null</b>, <span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3c2a6b9c7f9c912e" class="i field">Function</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#52136afaad8df2b6" class="i field">Filter</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#99d9163a866a9433" class="i field">Workflow</a>:
                    <span class="r272 r">statement</span> = <a href="#e1dd5b49bc9d01a5" class="i method">FunctionDeclarationRule</a>(<span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#edc303eb50c77bb8" class="i field">Return</a>:
                    <span class="r272 r">statement</span> = <a href="#d19aedd1cdbbd55f" class="i method">ReturnStatementRule</a>(<span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#580acfa458287a29" class="i field">Throw</a>:
                    <span class="r272 r">statement</span> = <a href="#b755e30f98ce0459" class="i method">ThrowStatementRule</a>(<span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#576951e7d9614f3b" class="i field">Exit</a>:
                    <span class="r272 r">statement</span> = <a href="#ea0606b790ff732a" class="i method">ExitStatementRule</a>(<span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#061f2b67dad9bf4f" class="i field">Break</a>:
                    <span class="r272 r">statement</span> = <a href="#ea97b8e43503579e" class="i method">BreakStatementRule</a>(<span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fe3642108980de67" class="i field">Continue</a>:
                    <span class="r272 r">statement</span> = <a href="#0ae741efb306d8fa" class="i method">ContinueStatementRule</a>(<span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d05715c602a417ca" class="i field">Trap</a>:
                    <span class="r272 r">statement</span> = <a href="#6b594b77edd12104" class="i method">TrapStatementRule</a>(<span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fadaef62886f88e2" class="i field">Try</a>:
                    <span class="r272 r">statement</span> = <a href="#011fc3da5af347cc" class="i method">TryStatementRule</a>(<span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#201174c1f7b0fa04" class="i field">Data</a>:
                    <span class="r272 r">statement</span> = <a href="#5a9d1f48e6b699c2" class="i method">DataStatementRule</a>(<span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#2078224c34fc71d1" class="i field">Parallel</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8b72ef21ced0e588" class="i field">Sequence</a>:
                    <span class="r272 r">statement</span> = <a href="#10839897260ae6ac" class="i method">BlockStatementRule</a>(<span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c97348c99412133c" class="i field">Configuration</a>:
                    <span class="r272 r">statement</span> = <span class="i">ConfigurationStatementRule</span>(<span class="r274 r">attributes</span>?.<span class="i">OfType</span>&lt;<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;(), <span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4e63f55d1e632f22" class="i field">From</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#347b5b545161c618" class="i field">Define</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f407e8439ffcdefc" class="i field">Var</a>:
                    <span class="i">ReportError</span>(<span class="r273 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ReservedKeywordNotAllowed</span>),
                        <span class="i">ParserStrings</span>.<span class="i">ReservedKeywordNotAllowed</span>,
                        <span class="r273 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                    <span class="r272 r">statement</span> = <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<span class="r273 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8f496697b15d1ca2" class="i field">Label</a>:
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <span class="r272 r">statement</span> = <a href="#2c425148897d3420" class="i method">LabeledStatementRule</a>((<a href="token.cs.html#424ba3736e9bca64" class="t t">LabelToken</a>)<span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>:
                    <b>if</b> (<span class="r274 r">attributes</span> != <b>null</b>)
                    {
                        <a href="#55d3ff509af9c3dd" class="i method">Resync</a>(<span class="r271 r">restorePoint</span>);
                        <span class="r272 r">statement</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
                    }
                    <b>else</b>
                    {
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r273 r">token</span>);
                        <span class="r272 r">statement</span> = <b>null</b>;
                    }
 
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4f659f327f8dcd2c" class="i field">Else</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b2d298294746ea02" class="i field">ElseIf</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c84d840825952d7b" class="i field">Catch</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3775e39bd88a79e5" class="i field">Until</a>:
                    <b>if</b> (<a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Count</span> &gt; 0)
                    {
                        <span class="c">// If we have already seen an error, just eat these tokens.  By eating the token, we won&#39;t</span>
                        <span class="c">// generate an odd pipeline with the keyword as a command name, which should provider a better</span>
                        <span class="c">// user experience (e.g., better syntax coloring.)</span>
                        <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                        <b>return</b> <a href="#90788aa7288d5462" class="i method">StatementRule</a>();
                    }
 
                    <b>goto</b> <b>default</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e7868dd662d25e11" class="i field">DynamicKeyword</a>:
                    <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <span id="r277 rd" class="r277 r">keywordData</span> = <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="tokenizer.cs.html#1f19ca15ed12e7d3" class="i method">GetKeyword</a>(<span class="r273 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                    <span class="r272 r">statement</span> = <a href="#b30e03ac8467884d" class="i method">DynamicKeywordStatementRule</a>(<span class="r273 r">token</span>, <span class="r277 r">keywordData</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#00143ac38c888bfa" class="i field">Class</a>:
                    <span class="r272 r">statement</span> = <a href="#1318b95e671b61fc" class="i method">ClassDefinitionRule</a>(<span class="r274 r">attributes</span>, <span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#6db945f74edccb76" class="i field">Enum</a>:
                    <span class="r272 r">statement</span> = <a href="#6c0d51b2072aa4f7" class="i method">EnumDefinitionRule</a>(<span class="r274 r">attributes</span>, <span class="r273 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9e1e77e046f0b0f" class="i field">Using</a>:
                    <span class="r272 r">statement</span> = <a href="#45244f65958da4bb" class="i method">UsingStatementRule</a>(<span class="r273 r">token</span>);
                    <span class="c">// Report an error - usings must appear before anything else in the script, but parse it anyway</span>
                    <span class="i">ReportError</span>(<span class="r272 r">statement</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UsingMustBeAtStartOfScript</span>),
                        <span class="i">ParserStrings</span>.<span class="i">UsingMustBeAtStartOfScript</span>);
                    <b>break</b>;
 
                <b>default</b>:
                    <b>if</b> (<span class="r274 r">attributes</span> != <b>null</b>)
                    {
                        <a href="#55d3ff509af9c3dd" class="i method">Resync</a>(<span class="r271 r">restorePoint</span>);
                    }
                    <b>else</b>
                    {
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r273 r">token</span>);
                    }
 
                    <span class="r272 r">statement</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
                    <b>break</b>;
            }
 
            <b>return</b> <span class="r272 r">statement</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <a id="942135886d841ed5" href="../../R/942135886d841ed5.html" target="n" data-glyph="76,1" class="i method">SimpleNameRule</a>()
        {
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r278 rd" class="r278 r">token</span>;
            <b>return</b> <a href="#299756015ec6936d" class="i method">SimpleNameRule</a>(<b>out</b> <span class="r278 r">token</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <a id="299756015ec6936d" href="../../R/299756015ec6936d.html" target="n" data-glyph="76,1" class="i method">SimpleNameRule</a>(<b>out</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r279 rd" class="r279 r">token</span>)
        {
            <b>try</b>
            {
                <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#8103814d5a556488" class="i property">WantSimpleName</a> = <b>true</b>;
                <span class="r279 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            }
            <b>finally</b>
            {
                <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#8103814d5a556488" class="i property">WantSimpleName</a> = <b>false</b>;
            }
 
            <b>if</b> (<span class="r279 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a>)
            {
                <span class="c">// We mark the token as a member name even though it may be a loop name or data variable name.</span>
                <span class="c">// V2 did this, so it&#39;s at least backwards compatible.</span>
                <span class="r279 r">token</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> |= <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#e2013f56302cb2d2" class="i field">MemberName</a>;
 
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <b>return</b> <b>new</b> <a href="ast.cs.html#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r279 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r279 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <a href="ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="ast.cs.html#7902d7b060b16556" class="i field">BareWord</a>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="a33f091484610e28" href="../../R/a33f091484610e28.html" target="n" data-glyph="76,1" class="i method">LabelOrKeyRule</a>()
        {
            <span class="c">// G  label-expression:</span>
            <span class="c">// G      simple-name</span>
            <span class="c">// G      unary-expression</span>
            <span class="c">// G  key-expression:</span>
            <span class="c">// G      simple-name</span>
            <span class="c">// G      unary-expression</span>
 
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r280 rd" class="r280 r">simpleName</span> = <a href="#942135886d841ed5" class="i method">SimpleNameRule</a>();
            <b>if</b> (<span class="r280 r">simpleName</span> != <b>null</b>)
            {
                <b>return</b> <span class="r280 r">simpleName</span>;
            }
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r281 rd" class="r281 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <b>if</b> (<span class="r281 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a> &amp;&amp; <span class="r281 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>)
            {
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r282 rd" class="r282 r">labelExpr</span>;
                <b>bool</b> <span id="r283 rd" class="r283 r">disableCommaOperator</span> = <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a>;
                <b>try</b>
                {
                    <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <b>true</b>;
                    <span class="r282 r">labelExpr</span> = <a href="#8b954079b3dc7b2c" class="i method">UnaryExpressionRule</a>();
                }
                <b>finally</b>
                {
                    <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <span class="r283 r">disableCommaOperator</span>;
                }
 
                <b>if</b> (<span class="r282 r">labelExpr</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r282 r">labelExpr</span>;
                }
 
                <span class="c">// If this is a label, then any token other than EOF here is effectively unreachable code.  E.g.</span>
                <span class="c">//         break &amp; &quot;cmd&quot;</span>
                <span class="c">// Gets parsed as:</span>
                <span class="c">//         break ; &amp; &quot;cmd&quot;</span>
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private</b> <a href="ast.cs.html#410610c8cad1e99b" class="t t">BreakStatementAst</a> <a id="ea97b8e43503579e" href="../../R/ea97b8e43503579e.html" target="n" data-glyph="76,1" class="i method">BreakStatementRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r284 rd" class="r284 r">breakToken</span>)
        {
            <span class="c">// G  flow-control-statement:</span>
            <span class="c">// G      &#39;break&#39;   label-expression:opt</span>
 
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r285 rd" class="r285 r">labelExpr</span> = <a href="#a33f091484610e28" class="i method">LabelOrKeyRule</a>();
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r286 rd" class="r286 r">extent</span> = (<span class="r285 r">labelExpr</span> != <b>null</b>)
                ? <a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r284 r">breakToken</span>, <span class="r285 r">labelExpr</span>)
                : <span class="r284 r">breakToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#64b5a03810b882c0" class="t constructor">BreakStatementAst</a>(<span class="r286 r">extent</span>, <span class="r285 r">labelExpr</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#f8a733d027117fbc" class="t t">ContinueStatementAst</a> <a id="0ae741efb306d8fa" href="../../R/0ae741efb306d8fa.html" target="n" data-glyph="76,1" class="i method">ContinueStatementRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r287 rd" class="r287 r">continueToken</span>)
        {
            <span class="c">// G  flow-control-statement:</span>
            <span class="c">// G      &#39;continue&#39;   label-expression:opt</span>
 
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r288 rd" class="r288 r">labelExpr</span> = <a href="#a33f091484610e28" class="i method">LabelOrKeyRule</a>();
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r289 rd" class="r289 r">extent</span> = (<span class="r288 r">labelExpr</span> != <b>null</b>)
                ? <a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r287 r">continueToken</span>, <span class="r288 r">labelExpr</span>)
                : <span class="r287 r">continueToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#9216abb5dcc1436d" class="t constructor">ContinueStatementAst</a>(<span class="r289 r">extent</span>, <span class="r288 r">labelExpr</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#ba60713bd71ce457" class="t t">ReturnStatementAst</a> <a id="d19aedd1cdbbd55f" href="../../R/d19aedd1cdbbd55f.html" target="n" data-glyph="76,1" class="i method">ReturnStatementRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r290 rd" class="r290 r">token</span>)
        {
            <span class="c">// G  flow-control-statement:</span>
            <span class="c">// G      &#39;return&#39;   pipeline-chain:opt</span>
 
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r291 rd" class="r291 r">pipeline</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r292 rd" class="r292 r">extent</span> = (<span class="r291 r">pipeline</span> != <b>null</b>)
                ? <a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r290 r">token</span>, <span class="r291 r">pipeline</span>)
                : <span class="r290 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
            <b>return</b> <b>new</b> <a href="ast.cs.html#b9bd1eeac7539b56" class="t constructor">ReturnStatementAst</a>(<span class="r292 r">extent</span>, <span class="r291 r">pipeline</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#c410ad4dd51f9687" class="t t">ExitStatementAst</a> <a id="ea0606b790ff732a" href="../../R/ea0606b790ff732a.html" target="n" data-glyph="76,1" class="i method">ExitStatementRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r293 rd" class="r293 r">token</span>)
        {
            <span class="c">// G  flow-control-statement:</span>
            <span class="c">// G      &#39;exit&#39;   pipeline-chain:opt</span>
 
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r294 rd" class="r294 r">pipeline</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r295 rd" class="r295 r">extent</span> = (<span class="r294 r">pipeline</span> != <b>null</b>)
                ? <a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r293 r">token</span>, <span class="r294 r">pipeline</span>)
                : <span class="r293 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
            <b>return</b> <b>new</b> <a href="ast.cs.html#b785dc866e1d4a3c" class="t constructor">ExitStatementAst</a>(<span class="r295 r">extent</span>, <span class="r294 r">pipeline</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#07e9c4f5bce4153b" class="t t">ThrowStatementAst</a> <a id="b755e30f98ce0459" href="../../R/b755e30f98ce0459.html" target="n" data-glyph="76,1" class="i method">ThrowStatementRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r296 rd" class="r296 r">token</span>)
        {
            <span class="c">// G  flow-control-statement:</span>
            <span class="c">// G      &#39;throw&#39;    pipeline:opt</span>
 
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r297 rd" class="r297 r">pipeline</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r298 rd" class="r298 r">extent</span> = (<span class="r297 r">pipeline</span> != <b>null</b>)
                ? <a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r296 r">token</span>, <span class="r297 r">pipeline</span>)
                : <span class="r296 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#eecff8dcadc3d274" class="t constructor">ThrowStatementAst</a>(<span class="r298 r">extent</span>, <span class="r297 r">pipeline</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="2c425148897d3420" href="../../R/2c425148897d3420.html" target="n" data-glyph="76,1" class="i method">LabeledStatementRule</a>(<a href="token.cs.html#424ba3736e9bca64" class="t t">LabelToken</a> <span id="r299 rd" class="r299 r">label</span>)
        {
            <span class="c">// G  statement:</span>
            <span class="c">// G      label:opt   labeled-statement</span>
            <span class="c">// G</span>
            <span class="c">// G  labeled-statement:</span>
            <span class="c">// G      switch-statement</span>
            <span class="c">// G      foreach-statement</span>
            <span class="c">// G      for-statement</span>
            <span class="c">// G      while-statement</span>
            <span class="c">// G      do-statement</span>
            <span class="c">// G      pipeline-chain</span>
 
            <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r300 rd" class="r300 r">statement</span>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r301 rd" class="r301 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>switch</b> (<span class="r301 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
            {
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#16bd62526b80a3f2" class="i field">Switch</a>:
                    <span class="r300 r">statement</span> = <a href="#6ff99ec89a9b0852" class="i method">SwitchStatementRule</a>(<span class="r299 r">label</span>, <span class="r301 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#5b4aeac56a39476f" class="i field">Foreach</a>:
                    <span class="r300 r">statement</span> = <a href="#fd6b7e4011769f20" class="i method">ForeachStatementRule</a>(<span class="r299 r">label</span>, <span class="r301 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#783a6f71a3854549" class="i field">For</a>:
                    <span class="r300 r">statement</span> = <a href="#ba51fa7b7becb48f" class="i method">ForStatementRule</a>(<span class="r299 r">label</span>, <span class="r301 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#73bf75a67618407f" class="i field">While</a>:
                    <span class="r300 r">statement</span> = <a href="#402593b1b428d906" class="i method">WhileStatementRule</a>(<span class="r299 r">label</span>, <span class="r301 r">token</span>);
                    <b>break</b>;
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b1e5a3400d6e1c03" class="i field">Do</a>:
                    <span class="r300 r">statement</span> = <a href="#bbaea32273e026b0" class="i method">DoWhileStatementRule</a>(<span class="r299 r">label</span>, <span class="r301 r">token</span>);
                    <b>break</b>;
                <b>default</b>:
                    <span class="c">// We can only unget 1 token, but have 2 to unget, so resync on the label.</span>
                    <a href="#73d0e59d1708bfb0" class="i method">Resync</a>(<span class="r299 r">label</span>);
                    <span class="r300 r">statement</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
                    <b>break</b>;
            }
 
            <b>return</b> <span class="r300 r">statement</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="10839897260ae6ac" href="../../R/10839897260ae6ac.html" target="n" data-glyph="76,1" class="i method">BlockStatementRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r302 rd" class="r302 r">kindToken</span>)
        {
            <span class="c">// G block-statement</span>
            <span class="c">// G      keyword    statement-block</span>
 
            <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r303 rd" class="r303 r">body</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
 
            <span class="c">// ErrorRecovery: nothing more to look for, so just return the error statement.</span>
            <b>if</b> (<span class="r303 r">body</span> == <b>null</b>)
            {
                <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r302 r">kindToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingStatementAfterKeyword</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingStatementAfterKeyword</span>,
                    <span class="r302 r">kindToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r302 r">kindToken</span>, <span class="r302 r">kindToken</span>));
            }
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#716c4965353726f3" class="t constructor">BlockStatementAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r302 r">kindToken</span>, <span class="r303 r">body</span>), <span class="r302 r">kindToken</span>, <span class="r303 r">body</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Handle the InlineScript syntax in the script workflow.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r304 r">inlineScriptToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r305 r">elements</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> true  -- InlineScript parsing successful</span>
        <span class="c">///</span><span class="c"> false -- InlineScript parsing unsuccessful</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private bool</b> <a id="7f829b3002a4621d" href="../../R/7f829b3002a4621d.html" target="n" data-glyph="76,1" class="i method">InlineScriptRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r304 rd" class="r304 r">inlineScriptToken</span>, <span class="i">List</span>&lt;<a href="ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt; <span id="r305 rd" class="r305 r">elements</span>)
        {
            <span class="c">// G Command</span>
            <span class="c">// G      InlineScript    scriptblock-expression</span>
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r305 r">elements</span> != <b>null</b> &amp;&amp; <span class="r305 r">elements</span>.<span class="i">Count</span> == 0, <span class="s">&quot;The CommandElement list should be empty&quot;</span>);
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r306 rd" class="r306 r">commandName</span> = <b>new</b> <a href="ast.cs.html#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r304 r">inlineScriptToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r304 r">inlineScriptToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <a href="ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="ast.cs.html#7902d7b060b16556" class="i field">BareWord</a>);
            <span class="r304 r">inlineScriptToken</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> |= <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b71c6dfcf4959b35" class="i field">CommandName</a>;
            <span class="r305 r">elements</span>.<span class="i">Add</span>(<span class="r306 r">commandName</span>);
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r307 rd" class="r307 r">lCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
 
            <b>if</b> (<span class="r307 r">lCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>)
            {
                <span class="c">// ErrorRecovery: If there is no opening curly, assume it hasn&#39;t been entered yet and don&#39;t consume anything.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r307 r">lCurly</span>);
                <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r304 r">inlineScriptToken</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingStatementAfterKeyword</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingStatementAfterKeyword</span>,
                    <span class="r304 r">inlineScriptToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                <b>return</b> <b>false</b>;
            }
 
            <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r308 rd" class="r308 r">expr</span> = <a href="#6042c9a5e817fc8e" class="i method">ScriptBlockExpressionRule</a>(<span class="r307 r">lCurly</span>);
            <span class="r305 r">elements</span>.<span class="i">Add</span>(<span class="r308 r">expr</span>);
            <b>return</b> <b>true</b>;
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="4613cb608305449e" href="../../R/4613cb608305449e.html" target="n" data-glyph="76,1" class="i method">IfStatementRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r309 rd" class="r309 r">ifToken</span>)
        {
            <span class="c">// G  if-statement:</span>
            <span class="c">// G      &#39;if&#39;   new-lines:opt   &#39;(&#39;   pipeline-chain   &#39;)&#39;   statement-block   elseif-clauses:opt   else-clause:opt</span>
            <span class="c">// G  elseif-clauses:</span>
            <span class="c">// G      elseif-clause</span>
            <span class="c">// G      elseif-clauses   elseif-clause</span>
            <span class="c">// G  elseif-clause:</span>
            <span class="c">// G      &#39;elseif&#39;   new-lines:opt   &#39;(&#39;   pipeline-chain   &#39;)&#39;   statement-block</span>
            <span class="c">// G  else-clause:</span>
            <span class="c">// G      &#39;else&#39;   statement-block</span>
 
            <span class="i">List</span>&lt;<span class="i">IfClause</span>&gt; <span id="r310 rd" class="r310 r">clauses</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">IfClause</span>&gt;();
            <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r311 rd" class="r311 r">componentAsts</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;();
            <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r312 rd" class="r312 r">elseClause</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r313 rd" class="r313 r">keyword</span> = <span class="r309 r">ifToken</span>;
 
            <b>while</b> (<b>true</b>)
            {
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r314 rd" class="r314 r">lParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r314 r">lParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>)
                {
                    <span class="c">// ErrorRecovery: assume user just typed &#39;if&#39; or &#39;elseif&#39; and hadn&#39;t started typing anything</span>
                    <span class="c">// else yet.  Next token is likely a newline, so just put it back and keep parsing.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r314 r">lParen</span>);
                    <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r313 r">keyword</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingOpenParenthesisInIfStatement</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingOpenParenthesisInIfStatement</span>,
                        <span class="r313 r">keyword</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                    <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r309 r">ifToken</span>, <span class="r313 r">keyword</span>), <span class="r311 r">componentAsts</span>);
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r315 rd" class="r315 r">condition</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
                <b>if</b> (<span class="r315 r">condition</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: assume pipeline just hasn&#39;t been entered yet, continue hoping</span>
                    <span class="c">// to find a close paren and statement block.</span>
 
                    <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r316 rd" class="r316 r">errorPosition</span> = <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r314 r">lParen</span>);
                    <span class="i">ReportIncompleteInput</span>(
                        <span class="r316 r">errorPosition</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">IfStatementMissingCondition</span>),
                        <span class="i">ParserStrings</span>.<span class="i">IfStatementMissingCondition</span>,
                        <span class="r313 r">keyword</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                    <span class="r315 r">condition</span> = <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<span class="r316 r">errorPosition</span>);
                }
                <b>else</b>
                {
                    <span class="r311 r">componentAsts</span>.<span class="i">Add</span>(<span class="r315 r">condition</span>);
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r317 rd" class="r317 r">rParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r317 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>)
                {
                    <span class="c">// ErrorRecovery: assume the next token is a newline or part of something else,</span>
                    <span class="c">// so stop parsing the statement and try parsing something else if possible.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r317 r">rParen</span>);
                    <span class="c">// Don&#39;t bother reporting this error if we already reported an empty condition error.</span>
                    <b>if</b> (<span class="r315 r">condition</span> <b>is not</b> <a href="ast.cs.html#e02a155b7afded8b" class="t t">ErrorStatementAst</a>)
                    {
                        <span class="i">ReportIncompleteInput</span>(<span class="r317 r">rParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisAfterStatement</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisAfterStatement</span>,
                            <span class="r313 r">keyword</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                    }
 
                    <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r309 r">ifToken</span>, <a href="#cb433f96b9585085" class="i method">Before</a>(<span class="r317 r">rParen</span>)), <span class="r311 r">componentAsts</span>);
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r318 rd" class="r318 r">body</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
                <b>if</b> (<span class="r318 r">body</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: assume the next token is a newline or part of something else,</span>
                    <span class="c">// so stop parsing the statement and try parsing something else.</span>
 
                    <span class="i">ReportIncompleteInput</span>(<span class="r317 r">rParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingStatementBlock</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingStatementBlock</span>,
                        <span class="r313 r">keyword</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                    <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r309 r">ifToken</span>, <span class="r317 r">rParen</span>), <span class="r311 r">componentAsts</span>);
                }
 
                <span class="r311 r">componentAsts</span>.<span class="i">Add</span>(<span class="r318 r">body</span>);
 
                <span class="r310 r">clauses</span>.<span class="i">Add</span>(<b>new</b> <span class="i">IfClause</span>(<span class="r315 r">condition</span>, <span class="r318 r">body</span>));
 
                <span class="c">// Save a restore point here. In case there is no &#39;elseif&#39; or &#39;else&#39; following,</span>
                <span class="c">// we should resync back here to preserve the possible new lines. The new lines</span>
                <span class="c">// could be important for the following parsing. For example, in case we are in</span>
                <span class="c">// a HashExpression, a new line might be needed for parsing the key-value that</span>
                <span class="c">// is following the if statement:</span>
                <span class="c">//    @{</span>
                <span class="c">//       a = if (1) {}</span>
                <span class="c">//       b = 10</span>
                <span class="c">//    }</span>
 
                <b>int</b> <span id="r319 rd" class="r319 r">restorePoint</span> = <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> == <b>null</b> ? <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#820e8f7ae7d9d17c" class="i method">GetRestorePoint</a>() : <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a>;
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r313 r">keyword</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
 
                <b>if</b> (<span class="r313 r">keyword</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b2d298294746ea02" class="i field">ElseIf</a>)
                {
                    <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                    <b>continue</b>;
                }
                <b>else</b> <b>if</b> (<span class="r313 r">keyword</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4f659f327f8dcd2c" class="i field">Else</a>)
                {
                    <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <span class="r312 r">elseClause</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
                    <b>if</b> (<span class="r312 r">elseClause</span> == <b>null</b>)
                    {
                        <span class="c">// ErrorRecovery: assume the next token is a newline or part of something else,</span>
                        <span class="c">// so stop parsing the statement and try parsing something else.</span>
 
                        <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r313 r">keyword</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingStatementBlockAfterElse</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingStatementBlockAfterElse</span>);
                        <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r309 r">ifToken</span>, <span class="r313 r">keyword</span>), <span class="r311 r">componentAsts</span>);
                    }
                }
                <b>else</b>
                {
                    <span class="c">// There is no &#39;elseif&#39; or &#39;else&#39; following, so resync back to the possible new lines.</span>
                    <a href="#55d3ff509af9c3dd" class="i method">Resync</a>(<span class="r319 r">restorePoint</span>);
                }
 
                <b>break</b>;
            }
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r320 rd" class="r320 r">endExtent</span> = (<span class="r312 r">elseClause</span> != <b>null</b>)
                ? <span class="r312 r">elseClause</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>
                : <span class="r310 r">clauses</span>[<span class="r310 r">clauses</span>.<span class="i">Count</span> - 1].<span class="i">Item2</span>.<span class="i">Extent</span>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r321 rd" class="r321 r">extent</span> = <a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r309 r">ifToken</span>, <span class="r320 r">endExtent</span>);
            <b>return</b> <b>new</b> <span class="t">IfStatementAst</span>(<span class="r321 r">extent</span>, <span class="r310 r">clauses</span>, <span class="r312 r">elseClause</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="6ff99ec89a9b0852" href="../../R/6ff99ec89a9b0852.html" target="n" data-glyph="76,1" class="i method">SwitchStatementRule</a>(<a href="token.cs.html#424ba3736e9bca64" class="t t">LabelToken</a> <span id="r322 rd" class="r322 r">labelToken</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r323 rd" class="r323 r">switchToken</span>)
        {
            <span class="c">// G  switch-statement:</span>
            <span class="c">// G      &#39;switch&#39;   new-lines:opt   switch-parameters:opt   switch-condition   switch-body</span>
            <span class="c">// G  switch-parameters:</span>
            <span class="c">// G      switch-parameter</span>
            <span class="c">// G      switch-parameters   switch-parameter</span>
            <span class="c">// G  switch-parameter:</span>
            <span class="c">// G      &#39;-regex&#39;</span>
            <span class="c">// G      &#39;-wildcard&#39;</span>
            <span class="c">// G      &#39;-exact&#39;</span>
            <span class="c">// G      &#39;-casesensitive&#39;</span>
            <span class="c">// G      &#39;-parallel&#39;</span>
            <span class="c">// G  switch-condition:</span>
            <span class="c">// G      &#39;(&#39;   new-lines:opt   pipeline   new-lines:opt   &#39;)&#39;</span>
            <span class="c">// G      -file   new-lines:opt   switch-filename</span>
            <span class="c">// G  switch-filename:</span>
            <span class="c">// G      command-argument</span>
            <span class="c">// G      primary-expression</span>
            <span class="c">// G  switch-body:</span>
            <span class="c">// G      new-lines:opt   &#39;{&#39;   new-lines:opt   switch-clauses   &#39;}&#39;</span>
            <span class="c">// G  switch-clauses:</span>
            <span class="c">// G      switch-clause</span>
            <span class="c">// G      switch-clauses   switch-clause</span>
            <span class="c">// G  switch-clause:</span>
            <span class="c">// G      switch-clause-condition   statement-block   statement-terminators:opt</span>
            <span class="c">// G  switch-clause-condition:</span>
            <span class="c">// G      command-argument</span>
            <span class="c">// G      primary-expression</span>
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r324 rd" class="r324 r">startExtent</span> = (<span class="r322 r">labelToken</span> ?? <span class="r323 r">switchToken</span>).<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r325 rd" class="r325 r">endErrorStatement</span> = <span class="r324 r">startExtent</span>;
            <b>bool</b> <span id="r326 rd" class="r326 r">isError</span> = <b>false</b>;
            <b>bool</b> <span id="r327 rd" class="r327 r">isIncompleteError</span> = <b>false</b>;
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <b>bool</b> <span id="r328 rd" class="r328 r">needErrorCondition</span> = <b>false</b>; <span class="c">// Only used to track if we need to include (condition) ast for the error statement.</span>
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r329 rd" class="r329 r">condition</span> = <b>null</b>;
            <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;&gt; <span id="r330 rd" class="r330 r">specifiedFlags</span> = <b>null</b>; <span class="c">// Only used to track all flags specified for the error ast</span>
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r331 rd" class="r331 r">switchParameterToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a> <span id="r332 rd" class="r332 r">flags</span> = <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#c295735669134c1e" class="i field">None</a>;
            <b>while</b> (<span class="r331 r">switchParameterToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c3ec93ee8b22aa7f" class="i field">Parameter</a>)
            {
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <span class="r325 r">endErrorStatement</span> = <span class="r331 r">switchParameterToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <span class="r330 r">specifiedFlags</span> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;&gt;();
 
                <b>if</b> (<a href="#71bba9aeff3a33d4" class="i method">IsSpecificParameter</a>(<span class="r331 r">switchParameterToken</span>, <span class="s">&quot;regex&quot;</span>))
                {
                    <span class="r332 r">flags</span> |= <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#6c98f78beaa551f0" class="i field">Regex</a>;
                    <span class="r332 r">flags</span> &amp;= ~<a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#8c2beda7309b3ae0" class="i field">Wildcard</a>;
 
                    <b>if</b> (!<span class="r330 r">specifiedFlags</span>.<span class="i">ContainsKey</span>(<span class="s">&quot;regex&quot;</span>))
                    {
                        <span class="r330 r">specifiedFlags</span>.<span class="i">Add</span>(<span class="s">&quot;regex&quot;</span>, <b>new</b> <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r331 r">switchParameterToken</span>, <b>null</b>));
                    }
                }
                <b>else</b> <b>if</b> (<a href="#71bba9aeff3a33d4" class="i method">IsSpecificParameter</a>(<span class="r331 r">switchParameterToken</span>, <span class="s">&quot;wildcard&quot;</span>))
                {
                    <span class="r332 r">flags</span> |= <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#8c2beda7309b3ae0" class="i field">Wildcard</a>;
                    <span class="r332 r">flags</span> &amp;= ~<a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#6c98f78beaa551f0" class="i field">Regex</a>;
 
                    <b>if</b> (!<span class="r330 r">specifiedFlags</span>.<span class="i">ContainsKey</span>(<span class="s">&quot;wildcard&quot;</span>))
                    {
                        <span class="r330 r">specifiedFlags</span>.<span class="i">Add</span>(<span class="s">&quot;wildcard&quot;</span>, <b>new</b> <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r331 r">switchParameterToken</span>, <b>null</b>));
                    }
                }
                <b>else</b> <b>if</b> (<a href="#71bba9aeff3a33d4" class="i method">IsSpecificParameter</a>(<span class="r331 r">switchParameterToken</span>, <span class="s">&quot;exact&quot;</span>))
                {
                    <span class="r332 r">flags</span> &amp;= ~<a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#6c98f78beaa551f0" class="i field">Regex</a>;
                    <span class="r332 r">flags</span> &amp;= ~<a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#8c2beda7309b3ae0" class="i field">Wildcard</a>;
 
                    <b>if</b> (!<span class="r330 r">specifiedFlags</span>.<span class="i">ContainsKey</span>(<span class="s">&quot;exact&quot;</span>))
                    {
                        <span class="r330 r">specifiedFlags</span>.<span class="i">Add</span>(<span class="s">&quot;exact&quot;</span>, <b>new</b> <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r331 r">switchParameterToken</span>, <b>null</b>));
                    }
                }
                <b>else</b> <b>if</b> (<a href="#71bba9aeff3a33d4" class="i method">IsSpecificParameter</a>(<span class="r331 r">switchParameterToken</span>, <span class="s">&quot;casesensitive&quot;</span>))
                {
                    <span class="r332 r">flags</span> |= <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#5612873142e6f4be" class="i field">CaseSensitive</a>;
 
                    <b>if</b> (!<span class="r330 r">specifiedFlags</span>.<span class="i">ContainsKey</span>(<span class="s">&quot;casesensitive&quot;</span>))
                    {
                        <span class="r330 r">specifiedFlags</span>.<span class="i">Add</span>(<span class="s">&quot;casesensitive&quot;</span>, <b>new</b> <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r331 r">switchParameterToken</span>, <b>null</b>));
                    }
                }
                <b>else</b> <b>if</b> (<a href="#71bba9aeff3a33d4" class="i method">IsSpecificParameter</a>(<span class="r331 r">switchParameterToken</span>, <span class="s">&quot;parallel&quot;</span>))
                {
                    <span class="r332 r">flags</span> |= <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#ef0ad3b1b1c543cb" class="i field">Parallel</a>;
 
                    <b>if</b> (!<span class="r330 r">specifiedFlags</span>.<span class="i">ContainsKey</span>(<span class="s">&quot;parallel&quot;</span>))
                    {
                        <span class="r330 r">specifiedFlags</span>.<span class="i">Add</span>(<span class="s">&quot;parallel&quot;</span>, <b>new</b> <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r331 r">switchParameterToken</span>, <b>null</b>));
                    }
                }
                <b>else</b> <b>if</b> (<a href="#71bba9aeff3a33d4" class="i method">IsSpecificParameter</a>(<span class="r331 r">switchParameterToken</span>, <span class="s">&quot;file&quot;</span>))
                {
                    <span class="r332 r">flags</span> |= <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#298af185be79cfea" class="i field">File</a>;
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r333 rd" class="r333 r">fileNameExpr</span> = <a href="#6ab87e657667a8ae" class="i method">GetSingleCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#56c226fdeaaab47b" class="i field">FileName</a>);
                    <b>if</b> (<span class="r333 r">fileNameExpr</span> == <b>null</b>)
                    {
                        <span class="c">// ErrorRecovery: pretend we saw the filename and continue.</span>
 
                        <span class="r326 r">isError</span> = <b>true</b>;
                        <span class="r327 r">isIncompleteError</span> = <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r331 r">switchParameterToken</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingFilenameOption</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingFilenameOption</span>);
 
                        <b>if</b> (!<span class="r330 r">specifiedFlags</span>.<span class="i">ContainsKey</span>(<span class="s">&quot;file&quot;</span>))
                        {
                            <span class="r330 r">specifiedFlags</span>.<span class="i">Add</span>(<span class="s">&quot;file&quot;</span>, <b>new</b> <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r331 r">switchParameterToken</span>, <b>null</b>));
                        }
                    }
                    <b>else</b>
                    {
                        <span class="r325 r">endErrorStatement</span> = <span class="r333 r">fileNameExpr</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                        <span class="r329 r">condition</span> = <b>new</b> <a href="ast.cs.html#208c7297a3426413" class="t constructor">PipelineAst</a>(<span class="r333 r">fileNameExpr</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                                    <b>new</b> <a href="ast.cs.html#cdb6db10eccdfa97" class="t constructor">CommandExpressionAst</a>(<span class="r333 r">fileNameExpr</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r333 r">fileNameExpr</span>, <b>null</b>), <span class="r334 r">background</span>: <b>false</b>);
 
                        <b>if</b> (!<span class="r330 r">specifiedFlags</span>.<span class="i">ContainsKey</span>(<span class="s">&quot;file&quot;</span>))
                        {
                            <span class="r330 r">specifiedFlags</span>.<span class="i">Add</span>(<span class="s">&quot;file&quot;</span>, <b>new</b> <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r331 r">switchParameterToken</span>, <span class="r329 r">condition</span>));
                        }
                    }
                }
                <b>else</b>
                {
                    <span class="c">// ErrorRecovery: just ignore the token, continue parsing.</span>
 
                    <span class="r326 r">isError</span> = <b>true</b>;
                    <span class="i">ReportError</span>(<span class="r331 r">switchParameterToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidSwitchFlag</span>),
                        <span class="i">ParserStrings</span>.<span class="i">InvalidSwitchFlag</span>,
                        ((<a href="token.cs.html#ee13ee02b3131929" class="t t">ParameterToken</a>)<span class="r331 r">switchParameterToken</span>).<a href="token.cs.html#c72db3af1374663c" class="i property">ParameterName</a>);
                }
 
                <span class="r331 r">switchParameterToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            }
 
            <b>if</b> (<span class="r331 r">switchParameterToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#069476ae2e7b4442" class="i field">Minus</a>)
            {
                <span class="r330 r">specifiedFlags</span> ??= <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;&gt;();
                <span class="r330 r">specifiedFlags</span>.<span class="i">Add</span>(<a href="#d9090e2972c2cdfd" class="i field">VERBATIM_ARGUMENT</a>, <b>new</b> <span class="i">Tuple</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>, <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;(<span class="r331 r">switchParameterToken</span>, <b>null</b>));
            }
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r335 rd" class="r335 r">lParen</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <b>if</b> (<span class="r335 r">lParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>)
            {
                <span class="r325 r">endErrorStatement</span> = <span class="r335 r">lParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
 
                <b>if</b> ((<span class="r332 r">flags</span> &amp; <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#298af185be79cfea" class="i field">File</a>) == <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#298af185be79cfea" class="i field">File</a>)
                {
                    <span class="c">// ErrorRecovery: nothing special this is a semantic error.</span>
 
                    <span class="r326 r">isError</span> = <b>true</b>;
                    <span class="i">ReportError</span>(<span class="r335 r">lParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">PipelineValueRequired</span>),
                        <span class="i">ParserStrings</span>.<span class="i">PipelineValueRequired</span>);
                }
 
                <span class="r328 r">needErrorCondition</span> = <b>true</b>; <span class="c">// need to add condition ast to the error statement if the parsing fails</span>
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r329 r">condition</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
                <b>if</b> (<span class="r329 r">condition</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: pretend we saw the condition and keep parsing.</span>
 
                    <span class="r326 r">isError</span> = <b>true</b>;
                    <span class="r327 r">isIncompleteError</span> = <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r335 r">lParen</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">PipelineValueRequired</span>),
                        <span class="i">ParserStrings</span>.<span class="i">PipelineValueRequired</span>);
                }
                <b>else</b>
                {
                    <span class="r325 r">endErrorStatement</span> = <span class="r329 r">condition</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r336 rd" class="r336 r">rParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r336 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>)
                {
                    <span class="c">// ErrorRecovery: Try to parse the switch body, if we don&#39;t find a body, then bail.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r336 r">rParen</span>);
                    <b>if</b> (!<span class="r327 r">isIncompleteError</span>)
                    {
                        <span class="r326 r">isError</span> = <b>true</b>;
                        <span class="r327 r">isIncompleteError</span> =
                            <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r325 r">endErrorStatement</span>),
                                                  <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInSwitchStatement</span>),
                                                  <span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInSwitchStatement</span>);
                    }
                }
                <b>else</b>
                {
                    <span class="r325 r">endErrorStatement</span> = <span class="r336 r">rParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                }
            }
            <b>else</b> <b>if</b> (<span class="r329 r">condition</span> == <b>null</b>)
            {
                <b>if</b> ((<span class="r332 r">flags</span> &amp; <a href="ast.cs.html#f3ebdce54e14c694" class="t t">SwitchFlags</a>.<a href="ast.cs.html#298af185be79cfea" class="i field">File</a>) == 0)
                {
                    <span class="r326 r">isError</span> = <b>true</b>;
                    <span class="r327 r">isIncompleteError</span> = <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r325 r">endErrorStatement</span>),
                                                              <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">PipelineValueRequired</span>),
                                                              <span class="i">ParserStrings</span>.<span class="i">PipelineValueRequired</span>);
                }
                <b>else</b>
                {
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r326 r">isError</span>, <span class="s">&quot;An error should already have been issued&quot;</span>);
                }
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r337 rd" class="r337 r">lCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r338 rd" class="r338 r">@default</span> = <b>null</b>;
            <span class="i">List</span>&lt;<span class="i">SwitchClause</span>&gt; <span id="r339 rd" class="r339 r">clauses</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">SwitchClause</span>&gt;();
            <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r340 rd" class="r340 r">errorAsts</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;();  <span class="c">// in case there is an error, we want the asts parsed up to the error.</span>
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r341 rd" class="r341 r">rCurly</span> = <b>null</b>;
            <b>if</b> (<span class="r337 r">lCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>)
            {
                <span class="c">// ErrorRecovery: Assume we don&#39;t have any switch body to parse.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r337 r">lCurly</span>);
                <b>if</b> (!<span class="r327 r">isIncompleteError</span>)
                {
                    <span class="r326 r">isError</span> = <b>true</b>;
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r325 r">endErrorStatement</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingCurlyBraceInSwitchStatement</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingCurlyBraceInSwitchStatement</span>);
                }
            }
            <b>else</b>
            {
                <span class="r325 r">endErrorStatement</span> = <span class="r337 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <b>while</b> (<b>true</b>)
                {
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r342 rd" class="r342 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                    <b>bool</b> <span id="r343 rd" class="r343 r">isDefaultClause</span> = <span class="r342 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a01b3cf32fcceac9" class="i field">Default</a>;
                    <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r344 rd" class="r344 r">clauseCondition</span> = <b>null</b>;
 
                    <b>if</b> (<span class="r343 r">isDefaultClause</span>)
                    {
                        <span class="c">// Consume the &#39;default&#39; token.</span>
                        <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                        <span class="r344 r">clauseCondition</span> = <b>new</b> <a href="ast.cs.html#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r342 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r342 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <a href="ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="ast.cs.html#7902d7b060b16556" class="i field">BareWord</a>);
                    }
                    <b>else</b>
                    {
                        <span class="r344 r">clauseCondition</span> = <a href="#6ab87e657667a8ae" class="i method">GetSingleCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#dd735003440d40a6" class="i field">SwitchCondition</a>);
                        <b>if</b> (<span class="r344 r">clauseCondition</span> == <b>null</b>)
                        {
                            <span class="c">// ErrorRecovery: if we don&#39;t have anything that looks like a condition, we won&#39;t</span>
                            <span class="c">// find a body (because a body is just a script block, which works as a condition.)</span>
                            <span class="c">// So don&#39;t look for a body, hope we find the &#39;}&#39; next.</span>
                            <span class="r326 r">isError</span> = <b>true</b>;
                            <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r325 r">endErrorStatement</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingSwitchConditionExpression</span>),
                                <span class="i">ParserStrings</span>.<span class="i">MissingSwitchConditionExpression</span>);
 
                            <span class="c">// Consume a closing curly, if there is one, to avoid an extra error</span>
                            <b>if</b> (<a href="#ea786851e84d8cea" class="i method">PeekToken</a>().<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>)
                            {
                                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                            }
 
                            <b>break</b>;
                        }
                    }
 
                    <span class="r340 r">errorAsts</span>.<span class="i">Add</span>(<span class="r344 r">clauseCondition</span>);
                    <span class="r325 r">endErrorStatement</span> = <span class="r344 r">clauseCondition</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
 
                    <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r345 rd" class="r345 r">clauseBody</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
                    <b>if</b> (<span class="r345 r">clauseBody</span> == <b>null</b>)
                    {
                        <span class="c">// ErrorRecovery: We might find another condition/body pair, so keep going.</span>
 
                        <span class="r326 r">isError</span> = <b>true</b>;
                        <span class="r327 r">isIncompleteError</span> = <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r325 r">endErrorStatement</span>),
                                                                  <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingSwitchStatementClause</span>),
                                                                  <span class="i">ParserStrings</span>.<span class="i">MissingSwitchStatementClause</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r340 r">errorAsts</span>.<span class="i">Add</span>(<span class="r345 r">clauseBody</span>);
                        <span class="r325 r">endErrorStatement</span> = <span class="r345 r">clauseBody</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
 
                        <b>if</b> (<span class="r343 r">isDefaultClause</span>)
                        {
                            <b>if</b> (<span class="r338 r">@default</span> != <b>null</b>)
                            {
                                <span class="c">// ErrorRecovery: just report the error and continue, forget the previous default clause.</span>
 
                                <span class="r326 r">isError</span> = <b>true</b>;
                                <span class="i">ReportError</span>(<span class="r344 r">clauseCondition</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MultipleSwitchDefaultClauses</span>),
                                    <span class="i">ParserStrings</span>.<span class="i">MultipleSwitchDefaultClauses</span>);
                            }
 
                            <span class="r338 r">@default</span> = <span class="r345 r">clauseBody</span>;
                        }
                        <b>else</b>
                        {
                            <span class="r339 r">clauses</span>.<span class="i">Add</span>(<b>new</b> <span class="i">SwitchClause</span>(<span class="r344 r">clauseCondition</span>, <span class="r345 r">clauseBody</span>));
                        }
                    }
 
                    <a href="#20cf6d6d776dad25" class="i method">SkipNewlinesAndSemicolons</a>();
 
                    <span class="r342 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                    <b>if</b> (<span class="r342 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>)
                    {
                        <span class="r341 r">rCurly</span> = <span class="r342 r">token</span>;
                        <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                        <b>break</b>;
                    }
 
                    <b>if</b> (<span class="r342 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
                    {
                        <b>if</b> (!<span class="r327 r">isIncompleteError</span>)
                        {
                            <span class="r326 r">isError</span> = <b>true</b>;
                            <span class="i">ReportIncompleteInput</span>(<span class="r337 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                <span class="r342 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndCurlyBrace</span>),
                                <span class="i">ParserStrings</span>.<span class="i">MissingEndCurlyBrace</span>);
                        }
 
                        <b>break</b>;
                    }
                }
            }
 
            <b>if</b> (<span class="r326 r">isError</span>)
            {
                <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r324 r">startExtent</span>, <span class="r325 r">endErrorStatement</span>), <span class="r323 r">switchToken</span>, <span class="r330 r">specifiedFlags</span>,
                                             <span class="r328 r">needErrorCondition</span> ? <a href="#5a40a6e894a3582f" class="i method">GetNestedErrorAsts</a>(<span class="r329 r">condition</span>) : <b>null</b>, <span class="i">GetNestedErrorAsts</span>(<span class="r340 r">errorAsts</span>));
            }
 
            <b>return</b> <b>new</b> <span class="t">SwitchStatementAst</span>(<a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r322 r">labelToken</span> ?? <span class="r323 r">switchToken</span>, <span class="r341 r">rCurly</span>),
                <span class="r322 r">labelToken</span>?.<a href="token.cs.html#43986cebcafcf714" class="i property">LabelText</a>, <span class="r329 r">condition</span>, <span class="r332 r">flags</span>, <span class="r339 r">clauses</span>, <span class="r338 r">@default</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="58bbcc7774ff437e" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">ConfigurationStatementRule</a>(<span class="i">IEnumerable</span>&lt;<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt; <span id="r346 rd" class="r346 r">customAttributes</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r347 rd" class="r347 r">configurationToken</span>)
        {
            <span class="c">// G  configuration-statement:</span>
            <span class="c">// G      &#39;configuration&#39;   new-lines:opt  singleNameExpression  new-lines:opt statement-block</span>
            <span class="c">// G  singleNameExpression:</span>
            <span class="c">// G      command-argument</span>
            <span class="c">// G      primary-expression</span>
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r348 rd" class="r348 r">startExtent</span> = <span class="r347 r">configurationToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r349 rd" class="r349 r">endErrorStatement</span> = <span class="r348 r">startExtent</span>;
            <b>bool</b> <span id="r350 rd" class="r350 r">isError</span> = <b>false</b>;
 
            <span class="c">// The expression that returns the configuration name.</span>
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r351 rd" class="r351 r">configurationName</span>;
            <b>string</b> <span id="r352 rd" class="r352 r">simpleConfigurationNameValue</span> = <b>null</b>;
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r353 rd" class="r353 r">configurationNameToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r354 rd" class="r354 r">configurationKeywordToken</span> = <span class="r353 r">configurationNameToken</span>;
 
            <b>if</b> (<span class="r353 r">configurationNameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>)
            {
                <span class="i">ReportError</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r348 r">startExtent</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingConfigurationName</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingConfigurationName</span>);
 
                <span class="c">// Try reading the configuration body - this should keep the parse in sync - but we won&#39;t return it</span>
                <a href="#6042c9a5e817fc8e" class="i method">ScriptBlockExpressionRule</a>(<span class="r353 r">configurationNameToken</span>);
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r353 r">configurationNameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
            {
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r353 r">configurationNameToken</span>);
 
                <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r353 r">configurationNameToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>),
                                      <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingConfigurationName</span>),
                                      <span class="i">ParserStrings</span>.<span class="i">MissingConfigurationName</span>);
                <b>return</b> <b>null</b>;
            }
 
            <span class="c">// Unget the configuration token so it can possibly be re-read as part of an expression</span>
            <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r353 r">configurationNameToken</span>);
 
            <span class="c">// Finally read the name for this configuration</span>
            <span class="r351 r">configurationName</span> = <a href="#80cfd429d1e12c0a" class="i method">GetWordOrExpression</a>(<span class="r353 r">configurationNameToken</span>);
            <b>if</b> (<span class="r351 r">configurationName</span> == <b>null</b>)
            {
                <span class="r350 r">isError</span> = <b>true</b>;
                <span class="i">ReportIncompleteInput</span>(<span class="r353 r">configurationNameToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingConfigurationName</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingConfigurationName</span>);
            }
            <b>else</b>
            {
                <b>object</b> <span id="r355 rd" class="r355 r">outValue</span>;
                <b>if</b> (<a href="ConstantValues.cs.html#763a3f726666bcfe" class="t t">IsConstantValueVisitor</a>.<a href="ConstantValues.cs.html#594e7e13f898b0a1" class="i method">IsConstant</a>(<span class="r351 r">configurationName</span>, <b>out</b> <span class="r355 r">outValue</span>))
                {
                    <span class="r352 r">simpleConfigurationNameValue</span> = <span class="r355 r">outValue</span> <b>as string</b>;
                    <b>if</b> (<span class="r352 r">simpleConfigurationNameValue</span> == <b>null</b> ||
                        !<span class="i n">System</span>.<span class="i">Text</span>.<span class="i">RegularExpressions</span>.<span class="i">Regex</span>.<span class="i">IsMatch</span>(<span class="r352 r">simpleConfigurationNameValue</span>, <span class="s">&quot;^[A-Za-z][A-Za-z0-9_./-]*$&quot;</span>))
                    {
                        <span class="c">// This is actually a semantics check, the syntax is fine at this point.</span>
                        <span class="c">// Continue parsing to get as much information as possible</span>
                        <span class="r350 r">isError</span> = <b>true</b>;
                        <span class="i">ReportError</span>(<span class="r351 r">configurationName</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidConfigurationName</span>),
                            <span class="i">ParserStrings</span>.<span class="i">InvalidConfigurationName</span>,
                            <span class="r352 r">simpleConfigurationNameValue</span> ?? <b>string</b>.<span class="i">Empty</span>);
                    }
                }
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <span class="c">//</span>
            <span class="c">// Load the system classes and import them as keywords</span>
            <span class="c">//</span>
            <span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a> <span id="r356 rd" class="r356 r">localRunspace</span> = <b>null</b>;
            <b>bool</b> <span id="r357 rd" class="r357 r">topLevel</span> = <b>false</b>;
            <b>try</b>
            {
                <span class="c">// At this point, we&#39;ll need a runspace to use to hold the metadata for the parse. If there is no</span>
                <span class="c">// current runspace to use, we create one and set it to be the default for this thread...</span>
                <b>if</b> (<span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> == <b>null</b>)
                {
                    <span class="r356 r">localRunspace</span> =
                        <span class="i n">Runspaces</span>.<a href="../hostifaces/ConnectionFactory.cs.html#c5fbe142e4e21218" class="t t">RunspaceFactory</a>.<a href="../hostifaces/ConnectionFactory.cs.html#19132aa2ac867b76" class="i method">CreateRunspace</a>(<span class="i n">Runspaces</span>.<a href="../InitialSessionState.cs.html#b17f88d4755d5fd7" class="t t">InitialSessionState</a>.<a href="../InitialSessionState.cs.html#904bc85f721c6764" class="i method">CreateDefault2</a>());
                    <span class="r356 r">localRunspace</span>.<a href="../hostifaces/Connection.cs.html#bd7dc249cd7abc4e" class="i property">ThreadOptions</a> = <span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#e3e452d2492397a5" class="t t">PSThreadOptions</a>.<a href="../hostifaces/Connection.cs.html#1eea8c0b04b31e81" class="i field">UseCurrentThread</a>;
                    <span class="r356 r">localRunspace</span>.<a href="../hostifaces/Connection.cs.html#61f55439fb78f2fe" class="i method">Open</a>();
                    <span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> = <span class="r356 r">localRunspace</span>;
                }
 
                <span class="c">// Configuration is not supported on ARM or in ConstrainedLanguage</span>
                <b>if</b> (<a href="../../utils/PsUtils.cs.html#2010e19f156f8c91" class="t t">PsUtils</a>.<a href="../../utils/PsUtils.cs.html#45dd30da86ec04e7" class="i method">IsRunningOnProcessorArchitectureARM</a>() || <a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>.<a href="../hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> == <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#9f1205fe78117fc2" class="i field">ConstrainedLanguage</a>)
                {
                    <span class="i">ReportError</span>(<span class="r347 r">configurationToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ConfigurationNotAllowedInConstrainedLanguage</span>),
                                <span class="i">ParserStrings</span>.<span class="i">ConfigurationNotAllowedInConstrainedLanguage</span>,
                                <span class="r347 r">configurationToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                    <b>return</b> <b>null</b>;
                }
 
                <span class="c">// Configuration is not supported on WinPE</span>
                <b>if</b> (<a href="../Utils.cs.html#9185d6ecbaebbec0" class="t t">Utils</a>.<a href="../Utils.cs.html#9aecc212ae3f42c7" class="i method">IsWinPEHost</a>())
                {
                    <span class="i">ReportError</span>(<span class="r347 r">configurationToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ConfigurationNotAllowedOnWinPE</span>),
                                <span class="i">ParserStrings</span>.<span class="i">ConfigurationNotAllowedOnWinPE</span>,
                                <span class="r347 r">configurationToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                    <b>return</b> <b>null</b>;
                }
 
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r358 rd" class="r358 r">configurationBodyScriptBlock</span> = <b>null</b>;
 
                <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a> <span id="r359 rd" class="r359 r">p</span> = <b>null</b>;
 
                <span class="c">// Save the parser we&#39;re using so we can resume the current parse when we&#39;re done.</span>
                <a href="#bbf5e856fb3215c5" class="k">var</a> <span id="r360 rd" class="r360 r">currentParser</span> = <span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>.<a href="../hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#7b897dde7067af78" class="i property">Engine</a>.<a href="../AutomationEngine.cs.html#ceed5f2c3fd0e6be" class="i field">EngineParser</a>;
                <span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>.<a href="../hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#7b897dde7067af78" class="i property">Engine</a>.<a href="../AutomationEngine.cs.html#ceed5f2c3fd0e6be" class="i field">EngineParser</a> = <b>new</b> <a href="#aee2c3138d83ea53" class="t constructor">Parser</a>();
 
                <b>try</b>
                {
                    <b>if</b> (<span class="r356 r">localRunspace</span> != <b>null</b>)
                    {
                        <span class="r359 r">p</span> = <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#40345bc4625ff918" class="i method">Create</a>();
                        <span class="r359 r">p</span>.<a href="../hostifaces/PowerShell.cs.html#ccf57242c9d46642" class="i property">Runspace</a> = <span class="r356 r">localRunspace</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r359 r">p</span> = <a href="../hostifaces/PowerShell.cs.html#3d1b346df3be574c" class="t t">PowerShell</a>.<a href="../hostifaces/PowerShell.cs.html#1c6a51d3c837bb4d" class="i method">Create</a>(<a href="../hostifaces/PowerShell.cs.html#c3c0f0e5e0b337ff" class="t t">RunspaceMode</a>.<a href="../hostifaces/PowerShell.cs.html#75d224de5df87e75" class="i field">CurrentRunspace</a>);
                    }
 
                    <b>try</b>
                    {
                        <span class="c">// See of the default CIM keywords are already loaded. If they haven&#39;t been</span>
                        <span class="c">// then this is the top level. Record that information and then load the defaults</span>
                        <span class="c">// keywords.</span>
                        <b>if</b> (<a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="tokenizer.cs.html#1f19ca15ed12e7d3" class="i method">GetKeyword</a>(<span class="s">&quot;OMI_ConfigurationDocument&quot;</span>) == <b>null</b>)
                        {
                            <span class="c">// Load the default CIM keywords</span>
                            <span class="i">Collection</span>&lt;<span class="i">Exception</span>&gt; <span id="r361 rd" class="r361 r">CIMKeywordErrors</span> = <b>new</b> <span class="i">Collection</span>&lt;<span class="i">Exception</span>&gt;();
 
                            <span class="c">// DscSubsystem is auto-registered when PSDesiredStateConfiguration v3 module is loaded</span>
                            <span class="c">// so if DscSubsystem is registered that means user intention to use v3 APIs.</span>
                            <a href="../Subsystem/DscSubsystem/ICrossPlatformDsc.cs.html#a3416ac15f89aebb" class="t t">ICrossPlatformDsc</a> <span id="r362 rd" class="r362 r">dscSubsystem</span> = <a href="../Subsystem/SubsystemManager.cs.html#6ddf6a3088da961a" class="t t">SubsystemManager</a>.<a href="../Subsystem/SubsystemManager.cs.html#d2d9d349eedfb603" class="i method">GetSubsystem</a>&lt;<a href="../Subsystem/DscSubsystem/ICrossPlatformDsc.cs.html#a3416ac15f89aebb" class="t t">ICrossPlatformDsc</a>&gt;();
                            <b>if</b> (<span class="r362 r">dscSubsystem</span> != <b>null</b>)
                            {
                                <span class="r362 r">dscSubsystem</span>.<a href="../Subsystem/DscSubsystem/ICrossPlatformDsc.cs.html#35ac98b1fa79bdcd" class="i method">LoadDefaultKeywords</a>(<span class="r361 r">CIMKeywordErrors</span>);
                            }
                            <b>else</b>
                            {
                                <span class="i n">Dsc</span>.<a href="../../DscSupport/CimDSCParser.cs.html#bfd37d71cb227350" class="t t">DscClassCache</a>.<a href="../../DscSupport/CimDSCParser.cs.html#fb94c5ac76850865" class="i method">LoadDefaultCimKeywords</a>(<span class="r361 r">CIMKeywordErrors</span>);
                            }
 
                            <span class="c">// Report any errors encountered while loading CIM dynamic keywords.</span>
                            <b>if</b> (<span class="r361 r">CIMKeywordErrors</span>.<span class="i">Count</span> &gt; 0)
                            {
                                <a href="#df37c3c8d2644618" class="i method">ReportErrorsAsWarnings</a>(<span class="r361 r">CIMKeywordErrors</span>);
                            }
 
                            <span class="c">// Load any keywords that have been defined earlier in the script.</span>
                            <b>if</b> (<a href="#6ba1a1af2cfaf913" class="i field">_configurationKeywordsDefinedInThisFile</a> != <b>null</b>)
                            {
                                <b>foreach</b> (<b>var</b> <span id="r363 rd" class="r363 r">kw</span> <b>in</b> <a href="#6ba1a1af2cfaf913" class="i field">_configurationKeywordsDefinedInThisFile</a>.<span class="i">Values</span>)
                                {
                                    <b>if</b> (!<a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<span class="i">ContainsKeyword</span>(<span class="r363 r">kw</span>.<span class="i">Keyword</span>))
                                    {
                                        <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<span class="i">AddKeyword</span>(<span class="r363 r">kw</span>);
                                    }
                                }
                            }
 
                            <span class="r357 r">topLevel</span> = <b>true</b>;
                        }
                    }
                    <b>catch</b> (<span class="i">Exception</span> <span id="r364 rd" class="r364 r">e</span>)
                    {
                        <span class="c">// This shouldn&#39;t happen - the system classes should always be good, but just in case,</span>
                        <span class="c">// we&#39;ll catch the exception and report it as an error.</span>
                        <span class="i">ReportError</span>(<span class="r354 r">configurationKeywordToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ParserError</span>),
                            <span class="i">ParserStrings</span>.<span class="i">ParserError</span>,
                            <span class="r364 r">e</span>.<span class="i">ToString</span>());
                        <b>return</b> <b>null</b>;
                    }
                }
                <b>finally</b>
                {
                    <b>if</b> (<span class="r359 r">p</span> != <b>null</b>)
                    {
                        <span class="r359 r">p</span>.<a href="../hostifaces/PowerShell.cs.html#18cbb6bfae891ee7" class="i method">Dispose</a>();
                    }
 
                    <span class="c">//</span>
                    <span class="c">// Put the parser back...</span>
                    <span class="c">//</span>
                    <span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>.<a href="../hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#7b897dde7067af78" class="i property">Engine</a>.<a href="../AutomationEngine.cs.html#ceed5f2c3fd0e6be" class="i field">EngineParser</a> = <span class="r360 r">currentParser</span>;
                }
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r365 rd" class="r365 r">lCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r365 r">lCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>)
                {
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r365 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingCurlyInConfigurationStatement</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingCurlyInConfigurationStatement</span>);
                    <span class="r350 r">isError</span> = <b>true</b>;
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r365 r">lCurly</span>);
                }
                <b>else</b>
                {
                    <b>var</b> <span id="r366 rd" class="r366 r">oldInConfiguration</span> = <a href="#79c6907f0c6e9834" class="i field">_inConfiguration</a>;
                    <b>try</b>
                    {
                        <a href="#79c6907f0c6e9834" class="i field">_inConfiguration</a> = <b>true</b>;
                        <span class="r358 r">configurationBodyScriptBlock</span> = <a href="#6042c9a5e817fc8e" class="i method">ScriptBlockExpressionRule</a>(<span class="r365 r">lCurly</span>);
                    }
                    <b>finally</b>
                    {
                        <a href="#79c6907f0c6e9834" class="i field">_inConfiguration</a> = <span class="r366 r">oldInConfiguration</span>;
                    }
 
                    <b>if</b> (<span class="r358 r">configurationBodyScriptBlock</span> == <b>null</b>)
                    {
                        <span class="i">ReportError</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r365 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ConfigurationBodyEmpty</span>),
                            <span class="i">ParserStrings</span>.<span class="i">ConfigurationBodyEmpty</span>);
                        <b>return</b> <b>null</b>;
                    }
                }
 
                <b>if</b> (<span class="r350 r">isError</span>)
                {
                    <b>return</b> <b>new</b> <a href="ast.cs.html#9afb18709d821fbe" class="t constructor">ErrorStatementAst</a>(<a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r348 r">startExtent</span>, <span class="r349 r">endErrorStatement</span>), <span class="r347 r">configurationToken</span>);
                }
 
                <span class="k preprocess">#</span><span class="k preprocess">region</span> &quot;Add Configuration Keywords&quot;
 
                <span class="c">// If the configuration name is a constant string, then</span>
                <span class="c">// if we&#39;re not at the top level, we&#39;ll add it to the list of configuration resource keywords.</span>
                <span class="c">// If we are at the top level, then we&#39;ll add it to the list of keywords defined in this</span>
                <span class="c">// parse so it can be used as a resource in subsequent config statements.</span>
                <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r367 rd" class="r367 r">scAst</span> = <span class="r351 r">configurationName</span> <b>as</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>;
                <b>if</b> (<span class="r367 r">scAst</span> != <b>null</b>)
                {
                    <a href="tokenizer.cs.html#c72d6f1daa581d48" class="k">var</a> <span id="r368 rd" class="r368 r">keywordToAddForThisConfigurationStatement</span> = <b>new</b> <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>.<span class="t">DynamicKeyword</span>
                    {
                        <a href="tokenizer.cs.html#46e96fbd06c2c3af" class="i property">BodyMode</a> = <a href="tokenizer.cs.html#dc369c18a439471a" class="t t">DynamicKeywordBodyMode</a>.<a href="tokenizer.cs.html#5da06d8412de17c8" class="i field">Hashtable</a>,
                        <a href="tokenizer.cs.html#9757f90b46da4d4e" class="i property">ImplementingModule</a> = <a href="#cb5979f0183d7827" class="i field">_keywordModuleName</a>,
                        <a href="tokenizer.cs.html#b4378cc74685de63" class="i property">Keyword</a> = <span class="r367 r">scAst</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>,
                        <a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> = <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#36ae172a002d6bd7" class="i field">NameRequired</a>,
                        <a href="tokenizer.cs.html#b4ebddb633c81f5b" class="i property">DirectCall</a> = <b>true</b>,
                    };
 
                    <span class="c">// Add the DependsOn property.</span>
                    <a href="tokenizer.cs.html#d3231c99121763c4" class="k">var</a> <span id="r369 rd" class="r369 r">dependsOnProp</span> = <b>new</b> <span class="t">DynamicKeywordProperty</span>
                    {
                        <a href="tokenizer.cs.html#f2dfcdf74f160f88" class="i property">Mandatory</a> = <b>true</b>,
                        <a href="tokenizer.cs.html#1f6c4268727988c7" class="i property">Name</a> = <span class="s">&quot;DependsOn&quot;</span>,
                    };
                    <span class="r368 r">keywordToAddForThisConfigurationStatement</span>.<a href="tokenizer.cs.html#5381d21bcf0af976" class="i property">Properties</a>.<span class="i">Add</span>(<span class="r369 r">dependsOnProp</span>.<a href="tokenizer.cs.html#1f6c4268727988c7" class="i property">Name</a>, <span class="r369 r">dependsOnProp</span>);
 
                    <span class="c">// Add the PsDscRunAsCredential property.</span>
                    <a href="tokenizer.cs.html#d3231c99121763c4" class="k">var</a> <span id="r370 rd" class="r370 r">RunAsProp</span> = <b>new</b> <span class="t">DynamicKeywordProperty</span>
                    {
                        <a href="tokenizer.cs.html#f2dfcdf74f160f88" class="i property">Mandatory</a> = <b>true</b>,
                        <a href="tokenizer.cs.html#1f6c4268727988c7" class="i property">Name</a> = <span class="s">&quot;PsDscRunAsCredential&quot;</span>,
                    };
                    <span class="r368 r">keywordToAddForThisConfigurationStatement</span>.<a href="tokenizer.cs.html#5381d21bcf0af976" class="i property">Properties</a>.<span class="i">Add</span>(<span class="r370 r">RunAsProp</span>.<a href="tokenizer.cs.html#1f6c4268727988c7" class="i property">Name</a>, <span class="r370 r">RunAsProp</span>);
 
                    <span class="c">// Extract the parameters, if any and them to the keyword definition.</span>
                    <a href="ast.cs.html#5ec0737db546f4f5" class="k">var</a> <span id="r371 rd" class="r371 r">sbeAst</span> = <span class="r358 r">configurationBodyScriptBlock</span> <b>as</b> <a href="ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a>;
                    <b>if</b> (<span class="r371 r">sbeAst</span> != <b>null</b>)
                    {
                        <a href="ast.cs.html#be95362bdc5e7d07" class="k">var</a> <span id="r372 rd" class="r372 r">pList</span> = <span class="r371 r">sbeAst</span>.<a href="ast.cs.html#3155915865e15c92" class="i property">ScriptBlock</a>.<a href="ast.cs.html#3fd8788db62344d2" class="i property">ParamBlock</a>;
                        <b>if</b> (<span class="r372 r">pList</span> != <b>null</b>)
                        {
                            <b>foreach</b> (<b>var</b> <span id="r373 rd" class="r373 r">parm</span> <b>in</b> <span class="r372 r">pList</span>.<a href="ast.cs.html#ffac8f01ede94077" class="i property">Parameters</a>)
                            {
                                <a href="tokenizer.cs.html#d3231c99121763c4" class="k">var</a> <span id="r374 rd" class="r374 r">keywordProp</span> = <b>new</b> <span class="t">DynamicKeywordProperty</span>();
                                <span class="r374 r">keywordProp</span>.<a href="tokenizer.cs.html#1f6c4268727988c7" class="i property">Name</a> = <span class="r373 r">parm</span>.<span class="i">Name</span>.<span class="i">VariablePath</span>.<span class="i">UserPath</span>;
                                <b>if</b> (<span class="r373 r">parm</span>.<span class="i">Attributes</span> != <b>null</b>)
                                {
                                    <b>foreach</b> (<b>var</b> <span id="r375 rd" class="r375 r">attr</span> <b>in</b> <span class="r373 r">parm</span>.<span class="i">Attributes</span>)
                                    {
                                        <a href="ast.cs.html#34b9d5dbbaca964d" class="k">var</a> <span id="r376 rd" class="r376 r">typeConstraint</span> = <span class="r375 r">attr</span> <b>as</b> <a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>;
                                        <b>if</b> (<span class="r376 r">typeConstraint</span> != <b>null</b>)
                                        {
                                            <span class="r374 r">keywordProp</span>.<a href="tokenizer.cs.html#ee8bc84e145d2931" class="i property">TypeConstraint</a> = <span class="r376 r">typeConstraint</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#d299e8e1674e18ab" class="i property">Name</a>;
                                            <b>continue</b>;
                                        }
 
                                        <a href="ast.cs.html#f576d1d6cbb736a0" class="k">var</a> <span id="r377 rd" class="r377 r">aAst</span> = <span class="r375 r">attr</span> <b>as</b> <a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>;
                                        <b>if</b> (<span class="r377 r">aAst</span> != <b>null</b>)
                                        {
                                            <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r377 r">aAst</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#d299e8e1674e18ab" class="i property">Name</a>, <span class="s">&quot;Parameter&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                            {
                                                <b>if</b> (<span class="r377 r">aAst</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a> != <b>null</b>)
                                                {
                                                    <b>foreach</b> (<b>var</b> <span id="r378 rd" class="r378 r">na</span> <b>in</b> <span class="r377 r">aAst</span>.<a href="ast.cs.html#6bb710ef7b74106a" class="i property">NamedArguments</a>)
                                                    {
                                                        <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r378 r">na</span>.<span class="i">ArgumentName</span>, <span class="s">&quot;Mandatory&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                                        {
                                                            <b>if</b> (<span class="r378 r">na</span>.<span class="i">ExpressionOmitted</span>)
                                                            {
                                                                <span class="r374 r">keywordProp</span>.<a href="tokenizer.cs.html#f2dfcdf74f160f88" class="i property">Mandatory</a> = <b>true</b>;
                                                            }
                                                            <b>else</b> <b>if</b> (<span class="r378 r">na</span>.<span class="i">Argument</span> != <b>null</b>)
                                                            {
                                                                <a href="ast.cs.html#ebd8ad798cde7861" class="t t">ConstantExpressionAst</a> <span id="r379 rd" class="r379 r">ceAst</span> = <span class="r378 r">na</span>.<span class="i">Argument</span> <b>as</b> <a href="ast.cs.html#ebd8ad798cde7861" class="t t">ConstantExpressionAst</a>;
                                                                <b>if</b> (<span class="r379 r">ceAst</span> != <b>null</b>)
                                                                {
                                                                    <span class="r374 r">keywordProp</span>.<a href="tokenizer.cs.html#f2dfcdf74f160f88" class="i property">Mandatory</a> = <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<a href="../LanguagePrimitives.cs.html#6dac09d64da9900c" class="t t">LanguagePrimitives</a>.<a href="../LanguagePrimitives.cs.html#7b42a860769a8de5" class="i method">IsTrue</a>(<span class="r379 r">ceAst</span>.<a href="ast.cs.html#8e2d2054af044253" class="i property">Value</a>);
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
 
                                <span class="r368 r">keywordToAddForThisConfigurationStatement</span>.<a href="tokenizer.cs.html#5381d21bcf0af976" class="i property">Properties</a>.<span class="i">Add</span>(<span class="r374 r">keywordProp</span>.<a href="tokenizer.cs.html#1f6c4268727988c7" class="i property">Name</a>, <span class="r374 r">keywordProp</span>);
                            }
                        }
                    }
 
                    <b>if</b> (<span class="r357 r">topLevel</span>)
                    {
                        <b>if</b> (<a href="#6ba1a1af2cfaf913" class="i field">_configurationKeywordsDefinedInThisFile</a> == <b>null</b>)
                        {
                            <a href="#6ba1a1af2cfaf913" class="i field">_configurationKeywordsDefinedInThisFile</a> = <b>new</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt;();
                        }
 
                        <a href="#6ba1a1af2cfaf913" class="i field">_configurationKeywordsDefinedInThisFile</a>[<span class="r368 r">keywordToAddForThisConfigurationStatement</span>.<a href="tokenizer.cs.html#b4378cc74685de63" class="i property">Keyword</a>] = <span class="r368 r">keywordToAddForThisConfigurationStatement</span>;
                    }
                    <b>else</b>
                    {
                        <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>.<a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="tokenizer.cs.html#1aa0699a8df0ecd2" class="i method">AddKeyword</a>(<span class="r368 r">keywordToAddForThisConfigurationStatement</span>);
                    }
                }
 
                <span class="k preprocess">#</span><span class="k preprocess">endregion</span>
 
                <span class="c">// End of dynamic keyword definition for this function...</span>
                <span class="c">//############################################################</span>
                <span class="c">//############################################################</span>
 
                <b>bool</b> <span id="r380 rd" class="r380 r">isMetaConfiguration</span> = <b>false</b>;
                <b>if</b> (<span class="r346 r">customAttributes</span> != <b>null</b>)
                {
                    <span class="r380 r">isMetaConfiguration</span> = <span class="r346 r">customAttributes</span>.<span class="i">Any</span>(
                         <span id="r381 rd" class="r381 r">attribute</span> =&gt; (<span class="r381 r">attribute</span>.<span class="i">TypeName</span>.<span class="i">GetReflectionAttributeType</span>() != <b>null</b>) &amp;&amp;
                                      (<span class="r381 r">attribute</span>.<span class="i">TypeName</span>.<span class="i">GetReflectionAttributeType</span>() == <b>typeof</b>(<a href="../Attributes.cs.html#94fe11f1e2480ea1" class="t t">DscLocalConfigurationManagerAttribute</a>)));
                }
 
                <a href="ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a> <span id="r382 rd" class="r382 r">bodyAst</span> = <span class="r358 r">configurationBodyScriptBlock</span> <b>as</b> <a href="ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a>;
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r383 rd" class="r383 r">configurationExtent</span> = <a href="#4229d79777aa8b76" class="i method">ExtentOf</a>(<span class="r348 r">startExtent</span>, <span class="r382 r">bodyAst</span>);
                <b>return</b> <b>new</b> <a href="ast.cs.html#8f3c4e19cb14c49f" class="t constructor">ConfigurationDefinitionAst</a>(<span class="r383 r">configurationExtent</span>,
                    <span class="r382 r">bodyAst</span>,
                    <span class="r380 r">isMetaConfiguration</span> ? <a href="ast.cs.html#786dff667907c54f" class="t t">ConfigurationType</a>.<a href="ast.cs.html#e1069d3c13089322" class="i field">Meta</a> : <a href="ast.cs.html#786dff667907c54f" class="t t">ConfigurationType</a>.<a href="ast.cs.html#251df5e9ba731897" class="i field">Resource</a>,
                    <span class="r351 r">configurationName</span>)
                {
                    <a href="ast.cs.html#d40fe37376267313" class="i property">LCurlyToken</a> = <span class="r365 r">lCurly</span>,
                    <a href="ast.cs.html#0efa958062060e17" class="i property">ConfigurationToken</a> = <span class="r347 r">configurationToken</span>,
                    <a href="ast.cs.html#0528a2e7b8bcb178" class="i property">CustomAttributes</a> = <span class="r346 r">customAttributes</span>,
                    <a href="ast.cs.html#965ad4d7acbcd14a" class="i property">DefinedKeywords</a> = <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="tokenizer.cs.html#037ec5d089661a20" class="i method">GetKeyword</a>()
                };
            }
            <b>catch</b> (<span class="i">Exception</span> <span id="r384 rd" class="r384 r">e</span>)
            {
                <span class="c">// In theory this should never happen so if it does, we&#39;ll report the actual exception rather than introducing a new message</span>
                <span class="i">ReportError</span>(<span class="r354 r">configurationKeywordToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ParserError</span>),
                    <span class="i">ParserStrings</span>.<span class="i">ParserError</span>,
                    <span class="s">&quot;ConfigurationStatementToken: &quot;</span> + <span class="r384 r">e</span>);
                <b>return</b> <b>null</b>;
            }
            <b>finally</b>
            {
                <span class="c">// If we had to allocate a runspace for the parser, we&#39;ll free it now.</span>
                <b>if</b> (<span class="r356 r">localRunspace</span> != <b>null</b>)
                {
                    <span class="c">// If a runspace was created for this operation, close it and reset the default runspace to null.</span>
                    <span class="r356 r">localRunspace</span>.<a href="../hostifaces/Connection.cs.html#e7b6aa3b7b07847b" class="i method">Close</a>();
                    <span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> = <b>null</b>;
                }
 
                <b>if</b> (<span class="r357 r">topLevel</span>)
                {
                    <span class="c">//</span>
                    <span class="c">// Clear out all of the cached classes and keywords.</span>
                    <span class="c">// They will need to be reloaded when the generated function is actually run.</span>
                    <span class="c">//</span>
                    <a href="../Subsystem/DscSubsystem/ICrossPlatformDsc.cs.html#a3416ac15f89aebb" class="t t">ICrossPlatformDsc</a> <span id="r385 rd" class="r385 r">dscSubsystem</span> = <a href="../Subsystem/SubsystemManager.cs.html#6ddf6a3088da961a" class="t t">SubsystemManager</a>.<a href="../Subsystem/SubsystemManager.cs.html#d2d9d349eedfb603" class="i method">GetSubsystem</a>&lt;<a href="../Subsystem/DscSubsystem/ICrossPlatformDsc.cs.html#a3416ac15f89aebb" class="t t">ICrossPlatformDsc</a>&gt;();
                    <b>if</b> (<span class="r385 r">dscSubsystem</span> != <b>null</b>)
                    {
                        <span class="r385 r">dscSubsystem</span>.<a href="../Subsystem/DscSubsystem/ICrossPlatformDsc.cs.html#90919a46190f8c9f" class="i method">ClearCache</a>();
                    }
                    <b>else</b>
                    {
                        <span class="i n">Dsc</span>.<a href="../../DscSupport/CimDSCParser.cs.html#bfd37d71cb227350" class="t t">DscClassCache</a>.<a href="../../DscSupport/CimDSCParser.cs.html#6ebe0026b4cda8f1" class="i method">ClearCache</a>();
                    }
 
                    <span class="i n">System</span>.<span class="i n">Management</span>.<span class="i n">Automation</span>.<span class="i n">Language</span>.<a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="tokenizer.cs.html#e3ae68982f2c125a" class="i method">Reset</a>();
                }
 
                <span class="c">// Finally resync the tokenizer at the current position</span>
                <span class="c">// this will flush any cached dynamic keyword tokens.</span>
                <b>var</b> <span id="r386 rd" class="r386 r">restorePoint</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#820e8f7ae7d9d17c" class="i method">GetRestorePoint</a>();
                <a href="#55d3ff509af9c3dd" class="i method">Resync</a>(<span class="r386 r">restorePoint</span>);
            }
        }
 
        <b>private</b> <span class="i">Dictionary</span>&lt;<b>string</b>, <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>&gt; <a id="6ba1a1af2cfaf913" href="../../R/6ba1a1af2cfaf913.html" target="n" data-glyph="46,1" class="i field">_configurationKeywordsDefinedInThisFile</a>;
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Reads an argument expression for a keyword or keyword parameter.</span>
        <span class="c">///</span><span class="c"> This can be either a bare word or an expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r387 r">keywordToken</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The token of the associated keyword.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="80cfd429d1e12c0a" href="../../R/80cfd429d1e12c0a.html" target="n" data-glyph="76,1" class="i method">GetWordOrExpression</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r387 rd" class="r387 r">keywordToken</span>)
        {
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r388 rd" class="r388 r">nameToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
 
            <b>if</b> (<span class="r388 r">nameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
            {
                <span class="c">// ErrorRecovery: report incomplete statement and return</span>
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r388 r">nameToken</span>);
                <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r387 r">keywordToken</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiredNameOrExpressionMissing</span>),
                    <span class="i">ParserStrings</span>.<span class="i">RequiredNameOrExpressionMissing</span>);
                <b>return</b> <b>null</b>;
            }
 
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r389 rd" class="r389 r">argument</span> = <a href="#b230abe7ca3d2b4e" class="i method">GetCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#87392123862baf4c" class="i field">CommandArgument</a>, <span class="r388 r">nameToken</span>);
            <b>if</b> (<span class="r389 r">argument</span> == <b>null</b>)
            {
                <a href="Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r390 rd" class="r390 r">extent</span> = <span class="r387 r">keywordToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <span class="i">ReportError</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r390 r">extent</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ParameterRequiresArgument</span>),
                    <span class="i">ParserStrings</span>.<span class="i">ParameterRequiresArgument</span>,
                    <span class="r387 r">keywordToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
            }
 
            <b>return</b> <span class="r389 r">argument</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="fd6b7e4011769f20" href="../../R/fd6b7e4011769f20.html" target="n" data-glyph="76,1" class="i method">ForeachStatementRule</a>(<a href="token.cs.html#424ba3736e9bca64" class="t t">LabelToken</a> <span id="r391 rd" class="r391 r">labelToken</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r392 rd" class="r392 r">forEachToken</span>)
        {
            <span class="c">// G  foreach-statement:</span>
            <span class="c">// G      &#39;foreach&#39;   new-lines:opt   foreach-parameters:opt   new-lines:opt   &#39;(&#39;</span>
            <span class="c">// G          new-lines:opt   variable   new-lines:opt   &#39;in&#39;   new-lines:opt   pipeline</span>
            <span class="c">// G          new-lines:opt   &#39;)&#39;   statement-block</span>
            <span class="c">// G  foreach-parameters:</span>
            <span class="c">// G      foreach-parameter</span>
            <span class="c">// G      foreach-parameters   foreach-parameter</span>
            <span class="c">// G  foreach-parameter:</span>
            <span class="c">// G      &#39;-parallel&#39;</span>
            <span class="c">// G      &#39;-throttlelimit&#39; new-lines:opt   foreach-throttlelimit</span>
            <span class="c">// G  foreach-throttlelimit:</span>
            <span class="c">// G      command-argument</span>
            <span class="c">// G      primary-expression</span>
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r393 rd" class="r393 r">startOfStatement</span> = <span class="r391 r">labelToken</span> != <b>null</b> ? <span class="r391 r">labelToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a> : <span class="r392 r">forEachToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r394 rd" class="r394 r">endErrorStatement</span> = <b>null</b>;
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <span class="c">// Process parameters on foreach</span>
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r395 rd" class="r395 r">foreachParameterToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <a href="ast.cs.html#23c2c283246ee841" class="t t">ForEachFlags</a> <span id="r396 rd" class="r396 r">flags</span> = <a href="ast.cs.html#23c2c283246ee841" class="t t">ForEachFlags</a>.<a href="ast.cs.html#9936c14ad16b99e7" class="i field">None</a>;
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r397 rd" class="r397 r">throttleLimit</span> = <b>null</b>;
 
            <b>while</b> (<span class="r395 r">foreachParameterToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c3ec93ee8b22aa7f" class="i field">Parameter</a>)
            {
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
 
                <b>if</b> (<a href="#71bba9aeff3a33d4" class="i method">IsSpecificParameter</a>(<span class="r395 r">foreachParameterToken</span>, <span class="s">&quot;parallel&quot;</span>))
                {
                    <span class="r396 r">flags</span> |= <a href="ast.cs.html#23c2c283246ee841" class="t t">ForEachFlags</a>.<a href="ast.cs.html#15784204dbd0f70a" class="i field">Parallel</a>;
                }
                <b>else</b> <b>if</b> (<a href="#71bba9aeff3a33d4" class="i method">IsSpecificParameter</a>(<span class="r395 r">foreachParameterToken</span>, <span class="s">&quot;throttlelimit&quot;</span>))
                {
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <span class="r397 r">throttleLimit</span> = <a href="#6ab87e657667a8ae" class="i method">GetSingleCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#87392123862baf4c" class="i field">CommandArgument</a>);
                    <b>if</b> (<span class="r397 r">throttleLimit</span> == <b>null</b>)
                    {
                        <span class="c">// ErrorRecovery: pretend we saw the throttle limit and continue.</span>
 
                        <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r395 r">foreachParameterToken</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingThrottleLimit</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingThrottleLimit</span>);
                    }
                }
                <b>else</b>
                {
                    <span class="c">// ErrorRecovery: just ignore the token, continue parsing.</span>
 
                    <span class="r394 r">endErrorStatement</span> = <span class="r395 r">foreachParameterToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    <span class="i">ReportError</span>(<span class="r395 r">foreachParameterToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidForeachFlag</span>),
                        <span class="i">ParserStrings</span>.<span class="i">InvalidForeachFlag</span>,
                        ((<a href="token.cs.html#ee13ee02b3131929" class="t t">ParameterToken</a>)<span class="r395 r">foreachParameterToken</span>).<a href="token.cs.html#c72db3af1374663c" class="i property">ParameterName</a>);
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r395 r">foreachParameterToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            }
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r398 rd" class="r398 r">lParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r398 r">lParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>)
            {
                <span class="c">// ErrorRecovery: assume the rest of the statement is missing.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r398 r">lParen</span>);
                <span class="r394 r">endErrorStatement</span> = <span class="r392 r">forEachToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r394 r">endErrorStatement</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingOpenParenthesisAfterKeyword</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingOpenParenthesisAfterKeyword</span>,
                    <span class="r392 r">forEachToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r393 r">startOfStatement</span>, <span class="r394 r">endErrorStatement</span>));
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r399 rd" class="r399 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r399 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8b5a9c54e2029553" class="i field">Variable</a> &amp;&amp; <span class="r399 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4fc017e5ff76f173" class="i field">SplattedVariable</a>)
            {
                <span class="c">// ErrorRecovery: assume the rest of the statement is missing.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r399 r">token</span>);
                <span class="r394 r">endErrorStatement</span> = <span class="r398 r">lParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r394 r">endErrorStatement</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingVariableNameAfterForeach</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingVariableNameAfterForeach</span>);
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r393 r">startOfStatement</span>, <span class="r394 r">endErrorStatement</span>));
            }
 
            <a href="ast.cs.html#248562b22b336dec" class="k">var</a> <span id="r400 rd" class="r400 r">variableAst</span> = <b>new</b> <a href="ast.cs.html#7703a30c5cc584b7" class="t constructor">VariableExpressionAst</a>((<a href="token.cs.html#cb1e7cc3b0285414" class="t t">VariableToken</a>)<span class="r399 r">token</span>);
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r401 rd" class="r401 r">pipeline</span> = <b>null</b>;
            <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r402 rd" class="r402 r">body</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r403 rd" class="r403 r">inToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r403 r">inToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#93ab1d10ca7f1f77" class="i field">In</a>)
            {
                <span class="c">// ErrorRecovery: assume the rest of the statement is missing.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r403 r">inToken</span>);
                <span class="r394 r">endErrorStatement</span> = <span class="r400 r">variableAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r394 r">endErrorStatement</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingInInForeach</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingInInForeach</span>);
            }
            <b>else</b>
            {
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r401 r">pipeline</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
                <b>if</b> (<span class="r401 r">pipeline</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: assume the rest of the statement is missing.</span>
 
                    <span class="r394 r">endErrorStatement</span> = <span class="r403 r">inToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r394 r">endErrorStatement</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingForeachExpression</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingForeachExpression</span>);
                }
                <b>else</b>
                {
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r404 rd" class="r404 r">rParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                    <b>if</b> (<span class="r404 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>)
                    {
                        <span class="c">// ErrorRecovery: assume the rest of the statement is missing.</span>
 
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r404 r">rParen</span>);
                        <span class="r394 r">endErrorStatement</span> = <span class="r401 r">pipeline</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                        <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r394 r">endErrorStatement</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisAfterForeach</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisAfterForeach</span>);
                    }
                    <b>else</b>
                    {
                        <span class="r402 r">body</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
                        <b>if</b> (<span class="r402 r">body</span> == <b>null</b>)
                        {
                            <span class="c">// ErrorRecovery: nothing more to look for, so just return the error statement.</span>
 
                            <span class="r394 r">endErrorStatement</span> = <span class="r404 r">rParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                            <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r394 r">endErrorStatement</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingForeachStatement</span>),
                                <span class="i">ParserStrings</span>.<span class="i">MissingForeachStatement</span>);
                        }
                    }
                }
            }
 
            <b>if</b> (<span class="r394 r">endErrorStatement</span> != <b>null</b>)
            {
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r393 r">startOfStatement</span>, <span class="r394 r">endErrorStatement</span>),
                                             <a href="#5a40a6e894a3582f" class="i method">GetNestedErrorAsts</a>(<span class="r400 r">variableAst</span>, <span class="r401 r">pipeline</span>, <span class="r402 r">body</span>));
            }
 
            <b>return</b> <b>new</b> <span class="t">ForEachStatementAst</span>(<a href="#4229d79777aa8b76" class="i method">ExtentOf</a>(<span class="r393 r">startOfStatement</span>, <span class="r402 r">body</span>),
                <span class="r391 r">labelToken</span>?.<a href="token.cs.html#43986cebcafcf714" class="i property">LabelText</a>,
                <span class="r396 r">flags</span>,
                <span class="r397 r">throttleLimit</span>, <span class="r400 r">variableAst</span>, <span class="r401 r">pipeline</span>, <span class="r402 r">body</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="ba51fa7b7becb48f" href="../../R/ba51fa7b7becb48f.html" target="n" data-glyph="76,1" class="i method">ForStatementRule</a>(<a href="token.cs.html#424ba3736e9bca64" class="t t">LabelToken</a> <span id="r405 rd" class="r405 r">labelToken</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r406 rd" class="r406 r">forToken</span>)
        {
            <span class="c">// G  for-statement:</span>
            <span class="c">// G      &#39;for&#39;   new-lines:opt   &#39;(&#39;</span>
            <span class="c">// G            new-lines:opt   for-initializer:opt   statement-terminator</span>
            <span class="c">// G            new-lines:opt   for-condition:opt   statement-terminator</span>
            <span class="c">// G            new-lines:opt   for-iterator:opt</span>
            <span class="c">// G            new-lines:opt   &#39;)&#39;   statement-block</span>
            <span class="c">// G      &#39;for&#39;   new-lines:opt   &#39;(&#39;</span>
            <span class="c">// G            new-lines:opt   for-initializer:opt   statement-terminator</span>
            <span class="c">// G            new-lines:opt   for-condition:opt</span>
            <span class="c">// G            new-lines:opt   &#39;)&#39;   statement-block</span>
            <span class="c">// G      &#39;for&#39;   new-lines:opt   &#39;(&#39;</span>
            <span class="c">// G            new-lines:opt   for-initializer:opt</span>
            <span class="c">// G            new-lines:opt   &#39;)&#39;   statement-block</span>
            <span class="c">// G  for-initializer:</span>
            <span class="c">// G      pipeline-chain</span>
            <span class="c">// G  for-condition:</span>
            <span class="c">// G      pipeline-chain</span>
            <span class="c">// G  for-iterator:</span>
            <span class="c">// G      pipeline-chain</span>
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r407 rd" class="r407 r">endErrorStatement</span> = <b>null</b>;
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r408 rd" class="r408 r">lParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r408 r">lParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>)
            {
                <span class="c">// ErrorRecovery: don&#39;t continue parsing the for statement.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r408 r">lParen</span>);
                <span class="r407 r">endErrorStatement</span> = <span class="r406 r">forToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r407 r">endErrorStatement</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingOpenParenthesisAfterKeyword</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingOpenParenthesisAfterKeyword</span>,
                    <span class="r406 r">forToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r405 r">labelToken</span> ?? <span class="r406 r">forToken</span>, <span class="r407 r">endErrorStatement</span>));
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r409 rd" class="r409 r">initializer</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
            <b>if</b> (<span class="r409 r">initializer</span> != <b>null</b>)
            {
                <span class="r407 r">endErrorStatement</span> = <span class="r409 r">initializer</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
            }
 
            <b>if</b> (<a href="#ea786851e84d8cea" class="i method">PeekToken</a>().<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>)
            {
                <span class="r407 r">endErrorStatement</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>().<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r410 rd" class="r410 r">condition</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
            <b>if</b> (<span class="r410 r">condition</span> != <b>null</b>)
            {
                <span class="r407 r">endErrorStatement</span> = <span class="r410 r">condition</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
            }
 
            <b>if</b> (<a href="#ea786851e84d8cea" class="i method">PeekToken</a>().<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>)
            {
                <span class="r407 r">endErrorStatement</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>().<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r411 rd" class="r411 r">iterator</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
            <b>if</b> (<span class="r411 r">iterator</span> != <b>null</b>)
            {
                <span class="r407 r">endErrorStatement</span> = <span class="r411 r">iterator</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r412 rd" class="r412 r">rParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r413 rd" class="r413 r">body</span> = <b>null</b>;
            <b>if</b> (<span class="r412 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>)
            {
                <span class="c">// ErrorRecovery: don&#39;t continue parsing the for statement.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r412 r">rParen</span>);
                <b>if</b> (<span class="r407 r">endErrorStatement</span> == <b>null</b>)
                {
                    <span class="r407 r">endErrorStatement</span> = <span class="r408 r">lParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                }
 
                <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r407 r">endErrorStatement</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisAfterStatement</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisAfterStatement</span>,
                    <span class="r406 r">forToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
            }
            <b>else</b>
            {
                <span class="r413 r">body</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
                <b>if</b> (<span class="r413 r">body</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: return an error statement.</span>
                    <span class="r407 r">endErrorStatement</span> = <span class="r412 r">rParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r407 r">endErrorStatement</span>),
                                          <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingLoopStatement</span>),
                                          <span class="i">ParserStrings</span>.<span class="i">MissingLoopStatement</span>,
                                          <span class="r406 r">forToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                }
            }
 
            <b>if</b> (<span class="r413 r">body</span> == <b>null</b>)
            {
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r405 r">labelToken</span> ?? <span class="r406 r">forToken</span>, <span class="r407 r">endErrorStatement</span>),
                    <a href="#5a40a6e894a3582f" class="i method">GetNestedErrorAsts</a>(<span class="r409 r">initializer</span>, <span class="r410 r">condition</span>, <span class="r411 r">iterator</span>));
            }
 
            <b>return</b> <b>new</b> <span class="t">ForStatementAst</span>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r405 r">labelToken</span> ?? <span class="r406 r">forToken</span>, <span class="r413 r">body</span>),
                <span class="r405 r">labelToken</span>?.<a href="token.cs.html#43986cebcafcf714" class="i property">LabelText</a>, <span class="r409 r">initializer</span>, <span class="r410 r">condition</span>, <span class="r411 r">iterator</span>, <span class="r413 r">body</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="402593b1b428d906" href="../../R/402593b1b428d906.html" target="n" data-glyph="76,1" class="i method">WhileStatementRule</a>(<a href="token.cs.html#424ba3736e9bca64" class="t t">LabelToken</a> <span id="r414 rd" class="r414 r">labelToken</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r415 rd" class="r415 r">whileToken</span>)
        {
            <span class="c">// G  while-statement:</span>
            <span class="c">// G      &#39;while &#39;  new-lines:opt   &#39;(&#39;   new-lines:opt   while-condition   new-lines:opt   &#39;)&#39;   statement-block</span>
            <span class="c">// G</span>
            <span class="c">// G   while-condition:</span>
            <span class="c">// G       pipeline-chain</span>
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r416 rd" class="r416 r">lParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r416 r">lParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>)
            {
                <span class="c">// ErrorRecovery: assume user just typed &#39;while&#39; and hadn&#39;t started typing anything</span>
                <span class="c">// else yet.  Next token is likely a newline, so just put it back and keep parsing.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r416 r">lParen</span>);
                <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r415 r">whileToken</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingOpenParenthesisAfterKeyword</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingOpenParenthesisAfterKeyword</span>,
                    <span class="r415 r">whileToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r414 r">labelToken</span> ?? <span class="r415 r">whileToken</span>, <span class="r415 r">whileToken</span>));
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r417 rd" class="r417 r">condition</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r418 rd" class="r418 r">errorCondition</span> = <b>null</b>;
            <b>if</b> (<span class="r417 r">condition</span> == <b>null</b>)
            {
                <span class="c">// ErrorRecovery: assume pipeline just hasn&#39;t been entered yet, continue hoping</span>
                <span class="c">// to find a close paren and statement block.</span>
 
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r419 rd" class="r419 r">errorPosition</span> = <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r416 r">lParen</span>);
                <span class="i">ReportIncompleteInput</span>(
                    <span class="r419 r">errorPosition</span>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterKeyword</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterKeyword</span>,
                    <span class="r415 r">whileToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                <span class="r417 r">condition</span> = <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<span class="r419 r">errorPosition</span>);
            }
            <b>else</b>
            {
                <span class="r418 r">errorCondition</span> = <span class="r417 r">condition</span>;
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r420 rd" class="r420 r">rParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r420 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>)
            {
                <span class="c">// ErrorRecovery: assume the next token is a newline or part of something else,</span>
                <span class="c">// so stop parsing the statement and try parsing something else if possible.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r420 r">rParen</span>);
                <b>if</b> (<span class="r417 r">condition</span> <b>is not</b> <a href="ast.cs.html#e02a155b7afded8b" class="t t">ErrorStatementAst</a>)
                {
                    <span class="i">ReportIncompleteInput</span>(<a href="#40407f0b4b50ace7" class="i method">After</a>(<span class="r417 r">condition</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisAfterStatement</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisAfterStatement</span>,
                        <span class="r415 r">whileToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                }
 
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r414 r">labelToken</span> ?? <span class="r415 r">whileToken</span>, <span class="r417 r">condition</span>), <a href="#5a40a6e894a3582f" class="i method">GetNestedErrorAsts</a>(<span class="r418 r">errorCondition</span>));
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r421 rd" class="r421 r">body</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
            <b>if</b> (<span class="r421 r">body</span> == <b>null</b>)
            {
                <span class="c">// ErrorRecovery: assume the next token is a newline or part of something else.</span>
 
                <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r420 r">rParen</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingLoopStatement</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingLoopStatement</span>,
                    <span class="r415 r">whileToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r414 r">labelToken</span> ?? <span class="r415 r">whileToken</span>, <span class="r420 r">rParen</span>), <a href="#5a40a6e894a3582f" class="i method">GetNestedErrorAsts</a>(<span class="r418 r">errorCondition</span>));
            }
 
            <b>return</b> <b>new</b> <span class="t">WhileStatementAst</span>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r414 r">labelToken</span> ?? <span class="r415 r">whileToken</span>, <span class="r421 r">body</span>),
                <span class="r414 r">labelToken</span>?.<a href="token.cs.html#43986cebcafcf714" class="i property">LabelText</a>, <span class="r417 r">condition</span>, <span class="r421 r">body</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parse a dynamic keyword statement which will be either of the form</span>
        <span class="c">///</span><span class="c">     keyword [parameters] [name] { a=1; b=2; } # constructor with properties</span>
        <span class="c">///</span><span class="c"> or</span>
        <span class="c">///</span><span class="c">     keyword [parameters] [name] { ... }  # constructor with a simple body.</span>
        <span class="c">///</span><span class="c"> or keywordcommand parameters</span>
        <span class="c">///</span><span class="c"> This custom keyword does not introduce a new AST node type. Instead it generates a</span>
        <span class="c">///</span><span class="c"> CommandAst that calls a PowerShell command to implement the keyword&#39;s logic.</span>
        <span class="c">///</span><span class="c"> This command has one of two signatures:</span>
        <span class="c">///</span><span class="c">     keywordImplCommand.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r422 r">functionName</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The name of the function to invoke.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r423 r">keywordData</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The data for this keyword definition.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="b30e03ac8467884d" href="../../R/b30e03ac8467884d.html" target="n" data-glyph="76,1" class="i method">DynamicKeywordStatementRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r422 rd" class="r422 r">functionName</span>, <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a> <span id="r423 rd" class="r423 r">keywordData</span>)
        {
            <span class="c">//////////////////////////////////////////////////////////////////////////////////</span>
            <span class="c">// If a custom action was provided. then invoke it</span>
            <span class="c">//////////////////////////////////////////////////////////////////////////////////</span>
            <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#49ed139342b9adc4" class="i property">PreParse</a> != <b>null</b>)
            {
                <b>try</b>
                {
                    <a href="#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r424 rd" class="r424 r">errors</span> = <span class="r423 r">keywordData</span>.<span class="i">PreParse</span>(<span class="r423 r">keywordData</span>);
                    <b>if</b> (<span class="r424 r">errors</span> != <b>null</b> &amp;&amp; <span class="r424 r">errors</span>.<span class="i">Length</span> &gt; 0)
                    {
                        <b>foreach</b> (<a href="#3b2ee49e322daa35" class="k">var</a> <span id="r425 rd" class="r425 r">e</span> <b>in</b> <span class="r424 r">errors</span>)
                        {
                            <a href="#67620d15942976b8" class="i method">ReportError</a>(<span class="r425 r">e</span>);
                        }
                    }
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r426 rd" class="r426 r">e</span>)
                {
                    <span class="i">ReportError</span>(<span class="r422 r">functionName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DynamicKeywordPreParseException</span>),
                        <span class="i">ParserStrings</span>.<span class="i">DynamicKeywordPreParseException</span>,
                        <span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#1ab8fd5746dc90ae" class="i property">ResourceName</a>, <span class="r426 r">e</span>.<span class="i">ToString</span>());
                    <b>return</b> <b>null</b>;
                }
            }
 
            <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#0478d618518110b3" class="i property">IsReservedKeyword</a>)
            {
                <span class="c">// ErrorRecovery: eat the token</span>
                <span class="i">ReportError</span>(<span class="r422 r">functionName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnsupportedReservedKeyword</span>),
                    <span class="i">ParserStrings</span>.<span class="i">UnsupportedReservedKeyword</span>,
                    <span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#b4378cc74685de63" class="i property">Keyword</a>);
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#19d5aaf963addcf9" class="i property">HasReservedProperties</a>)
            {
                <span class="c">// ErrorRecovery: eat the token</span>
                <span class="i">ReportError</span>(<span class="r422 r">functionName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnsupportedReservedProperty</span>),
                    <span class="i">ParserStrings</span>.<span class="i">UnsupportedReservedProperty</span>,
                    <span class="s">&quot;&#39;Require&#39;, &#39;Trigger&#39;, &#39;Notify&#39;, &#39;Before&#39;, &#39;After&#39; and &#39;Subscribe&#39;&quot;</span>);
                <b>return</b> <b>null</b>;
            }
 
            <b>string</b> <span id="r427 rd" class="r427 r">elementName</span> = <b>string</b>.<span class="i">Empty</span>;
 
            <a href="ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a> <span id="r428 rd" class="r428 r">dynamicKeywordAst</span>;
            <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#46e96fbd06c2c3af" class="i property">BodyMode</a> == <a href="tokenizer.cs.html#dc369c18a439471a" class="t t">DynamicKeywordBodyMode</a>.<a href="tokenizer.cs.html#a2dc466a9a78cf46" class="i field">Command</a>)
            {
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r422 r">functionName</span>);
                <span class="r428 r">dynamicKeywordAst</span> = (<a href="ast.cs.html#2c7580ec5eda8932" class="t t">DynamicKeywordStatementAst</a>)<a href="#e1eadfb26e3b4083" class="i method">CommandRule</a>(<span class="r429 r">forDynamicKeyword</span>: <b>true</b>);
                <span class="r428 r">dynamicKeywordAst</span>.<a href="ast.cs.html#0f0688a599c6de89" class="i property">Keyword</a> = <span class="r423 r">keywordData</span>;
                <span class="r428 r">dynamicKeywordAst</span>.<a href="ast.cs.html#914807ae6c6aa6f9" class="i property">FunctionName</a> = <span class="r422 r">functionName</span>;
            }
            <b>else</b>
            {
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <span class="c">// The expression that returns the resource name or names.</span>
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r430 rd" class="r430 r">instanceName</span> = <b>null</b>;
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r431 rd" class="r431 r">nameToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r431 r">nameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
                {
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r431 r">nameToken</span>);
 
                    <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> == <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#36ae172a002d6bd7" class="i field">NameRequired</a> || <span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> == <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#f6123ea2d4c5e6ea" class="i field">SimpleNameRequired</a>)
                    {
                        <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r422 r">functionName</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiredNameOrExpressionMissing</span>),
                            <span class="i">ParserStrings</span>.<span class="i">RequiredNameOrExpressionMissing</span>);
                    }
                    <b>else</b>
                    {
                        <span class="c">// Name not required so report missing brace</span>
                        <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r422 r">functionName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingBraceInObjectDefinition</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingBraceInObjectDefinition</span>);
                    }
 
                    <b>return</b> <b>null</b>;
                }
 
                <span class="c">// If it&#39;s an lcurly, then no name was provided, and we skip to the body processing</span>
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r432 rd" class="r432 r">lCurly</span> = <b>null</b>;
                <b>if</b> (<span class="r431 r">nameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>)
                {
                    <span class="r432 r">lCurly</span> = <span class="r431 r">nameToken</span>;
                    <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> == <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#36ae172a002d6bd7" class="i field">NameRequired</a> || <span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> == <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#f6123ea2d4c5e6ea" class="i field">SimpleNameRequired</a>)
                    {
                        <span class="i">ReportError</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r422 r">functionName</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiredNameOrExpressionMissing</span>),
                            <span class="i">ParserStrings</span>.<span class="i">RequiredNameOrExpressionMissing</span>);
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r431 r">nameToken</span>);
                        <b>return</b> <b>null</b>;
                    }
                }
                <b>else</b> <b>if</b> (<span class="r431 r">nameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a> || <span class="r431 r">nameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e7868dd662d25e11" class="i field">DynamicKeyword</a>)
                {
                    <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> == <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#f4392d4c8185a4f0" class="i field">NoName</a>)
                    {
                        <span class="i">ReportError</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r422 r">functionName</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedNameForType</span>),
                            <span class="i">ParserStrings</span>.<span class="i">UnexpectedNameForType</span>,
                            <span class="r422 r">functionName</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>,
                            <span class="r431 r">nameToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r431 r">nameToken</span>);
                        <b>return</b> <b>null</b>;
                    }
 
                    <span class="c">// If it&#39;s an identifier then this is the name for the data object</span>
                    <span class="r427 r">elementName</span> = <span class="r431 r">nameToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>;
 
                    <span class="c">// If only a simple name is allowed, then the string must be non-null.</span>
                    <b>if</b> ((<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> == <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#f6123ea2d4c5e6ea" class="i field">SimpleNameRequired</a> || <span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> == <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#dd4d9558e70de62a" class="i field">SimpleOptionalName</a>) &amp;&amp; <b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r427 r">elementName</span>))
                    {
                        <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r422 r">functionName</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiredNameOrExpressionMissing</span>),
                            <span class="i">ParserStrings</span>.<span class="i">RequiredNameOrExpressionMissing</span>);
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r431 r">nameToken</span>);
                        <b>return</b> <b>null</b>;
                    }
                }
                <b>else</b>
                {
                    <span class="c">// see if an expression was provided instead of a bare word...</span>
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r431 r">nameToken</span>);
                    <span class="r430 r">instanceName</span> = <a href="#6ab87e657667a8ae" class="i method">GetSingleCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#883387f0e772618e" class="i field">CommandName</a>);
 
                    <b>if</b> (<span class="r430 r">instanceName</span> == <b>null</b>)
                    {
                        <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> == <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#f6123ea2d4c5e6ea" class="i field">SimpleNameRequired</a> || <span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> == <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#dd4d9558e70de62a" class="i field">SimpleOptionalName</a>)
                        {
                            <span class="i">ReportError</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r422 r">functionName</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RequiredNameOrExpressionMissing</span>),
                                <span class="i">ParserStrings</span>.<span class="i">RequiredNameOrExpressionMissing</span>);
                        }
                        <b>else</b>
                        {
                            <span class="c">// It wasn&#39;t an &#39;{&#39; and it wasn&#39;t a name expression so it&#39;s a unexpected token.</span>
                            <span class="i">ReportError</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r422 r">functionName</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>),
                                <span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>,
                                <span class="r431 r">nameToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                        }
 
                        <b>return</b> <b>null</b>;
                    }
 
                    <span class="c">// Ok, we got a name expression, but we&#39;re expecting no name, so it&#39;s and error.</span>
                    <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> == <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#f4392d4c8185a4f0" class="i field">NoName</a>)
                    {
                        <span class="i">ReportError</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r422 r">functionName</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedNameForType</span>),
                            <span class="i">ParserStrings</span>.<span class="i">UnexpectedNameForType</span>,
                            <span class="r422 r">functionName</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>,
                            <span class="r430 r">instanceName</span>.<a href="ast.cs.html#e8e96a43a76cce85" class="i method">ToString</a>());
                        <b>return</b> <b>null</b>;
                    }
 
                    <span class="c">// We were expecting a simple name so report an error</span>
                    <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> == <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#f6123ea2d4c5e6ea" class="i field">SimpleNameRequired</a> || <span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#a246b575bebf7355" class="i property">NameMode</a> == <a href="tokenizer.cs.html#84f739c2f84d69ad" class="t t">DynamicKeywordNameMode</a>.<a href="tokenizer.cs.html#dd4d9558e70de62a" class="i field">SimpleOptionalName</a>)
                    {
                        <span class="c">// If no match, then this is an incomplete token BUGBUG fix message</span>
                        <span class="i">ReportError</span>(<span class="r431 r">nameToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>),
                            <span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>,
                            <span class="r431 r">nameToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                        <b>return</b> <b>null</b>;
                    }
                }
 
                <span class="c">// If we didn&#39;t get a resource expression AST, then we need to build one out of the</span>
                <span class="c">// name that was specified. It may be the case that we don&#39;t have</span>
                <span class="c">// a resource name in which case it will be the empty string. Even in the cases were</span>
                <span class="c">// we aren&#39;t expecting a name, we still do this so that the signature of the implementing function remains</span>
                <span class="c">// the same.</span>
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r433 rd" class="r433 r">originalInstanceName</span> = <span class="r430 r">instanceName</span>;
                <b>if</b> (<span class="r430 r">instanceName</span> == <b>null</b>)
                {
                    <span class="r430 r">instanceName</span> = <b>new</b> <a href="ast.cs.html#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r431 r">nameToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r427 r">elementName</span>, <a href="ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="ast.cs.html#7902d7b060b16556" class="i field">BareWord</a>);
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <span class="c">//</span>
                <span class="c">// Now look for the body of the data statement.</span>
                <span class="c">//</span>
                <b>if</b> (<span class="r432 r">lCurly</span> == <b>null</b>)
                {
                    <span class="r432 r">lCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
 
                    <b>if</b> (<span class="r432 r">lCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
                    {
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r432 r">lCurly</span>);
                        <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r422 r">functionName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingBraceInObjectDefinition</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingBraceInObjectDefinition</span>);
 
                        <span class="c">// Preserve the name expression for tab completion</span>
                        <b>return</b> <span class="r433 r">originalInstanceName</span> == <b>null</b>
                                   ? <b>null</b>
                                   : <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r422 r">functionName</span>, <span class="r433 r">originalInstanceName</span>),
                                                           <a href="#5a40a6e894a3582f" class="i method">GetNestedErrorAsts</a>(<span class="r433 r">originalInstanceName</span>));
                    }
 
                    <b>if</b> (<span class="r432 r">lCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>)
                    {
                        <span class="c">// We need to generate a reasonable error message for this case:</span>
                        <span class="c">//</span>
                        <span class="c">// Configuration C {</span>
                        <span class="c">//   node $AllNode.NodeName{ # There is no space before curly, and we are converting scriptblock to and argument to call &#39;NodeName&#39;</span>
                        <span class="c">//     ...</span>
                        <span class="c">//   }</span>
                        <span class="c">// } # we don&#39;t want to simple report an unexpected token here, it would be super-confusing.</span>
 
                        <a href="ast.cs.html#be11dcb1e53f56b8" class="t t">InvokeMemberExpressionAst</a> <span id="r434 rd" class="r434 r">instanceInvokeMemberExpressionAst</span> = <span class="r430 r">instanceName</span> <b>as</b> <a href="ast.cs.html#be11dcb1e53f56b8" class="t t">InvokeMemberExpressionAst</a>;
 
                        <b>if</b> (<span class="r434 r">instanceInvokeMemberExpressionAst</span> != <b>null</b> &amp;&amp;
                            <span class="r434 r">instanceInvokeMemberExpressionAst</span>.<a href="ast.cs.html#0f1554608efc28f3" class="i property">Arguments</a>.<span class="i">Count</span> == 1 &amp;&amp;
                            <span class="r434 r">instanceInvokeMemberExpressionAst</span>.<a href="ast.cs.html#0f1554608efc28f3" class="i property">Arguments</a>[0] <b>is</b> <a href="ast.cs.html#5ec0737db546f4f5" class="t t">ScriptBlockExpressionAst</a> &amp;&amp;
                            <span class="c">// the last condition checks that there is no space between &quot;method&quot; name and &#39;{&#39;</span>
                            <span class="r434 r">instanceInvokeMemberExpressionAst</span>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a> == <span class="r434 r">instanceInvokeMemberExpressionAst</span>.<a href="ast.cs.html#0f1554608efc28f3" class="i property">Arguments</a>[0].<span class="i">Extent</span>.<span class="i">StartOffset</span>)
                        {
                            <span class="i">ReportError</span>(<a href="#ccb6c46e5e3d182e" class="i method">LastCharacterOf</a>(<span class="r434 r">instanceInvokeMemberExpressionAst</span>.<a href="ast.cs.html#2c25418a24e5cfa1" class="i property">Member</a>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedTokenInDynamicKeyword</span>),
                                <span class="i">ParserStrings</span>.<span class="i">UnexpectedTokenInDynamicKeyword</span>,
                                <span class="r422 r">functionName</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                        }
                        <b>else</b>
                        {
                            <span class="i">ReportError</span>(<span class="r432 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>),
                                <span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>,
                                <span class="r432 r">lCurly</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                        }
 
                        <b>if</b> (<span class="r432 r">lCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9023444a1ee3a84" class="i field">Dot</a> &amp;&amp; <span class="r433 r">originalInstanceName</span> != <b>null</b> &amp;&amp; <span class="r432 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#14e0029eb01de3bb" class="i property">StartOffset</a> == <span class="r433 r">originalInstanceName</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#ca890c6b6bd34ec4" class="i property">EndOffset</a>)
                        {
                            <span class="c">// Generate more useful ast for tab-completing extension methods on special DSC collection variables</span>
                            <span class="c">// e.g. configuration foo { node $AllNodes.&lt;tab&gt;</span>
 
                            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r435 rd" class="r435 r">errorExtent</span> = <a href="#4ad82407bcef8f0d" class="i method">ExtentOf</a>(<span class="r433 r">originalInstanceName</span>, <span class="r432 r">lCurly</span>);
                            <a href="ast.cs.html#bdf2b3276843e0c2" class="k">var</a> <span id="r436 rd" class="r436 r">errorExpr</span> = <b>new</b> <a href="ast.cs.html#521987ae533dc4bd" class="t constructor">ErrorExpressionAst</a>(<span class="r435 r">errorExtent</span>);
                            <a href="ast.cs.html#a3e8bc64452a67d0" class="k">var</a> <span id="r437 rd" class="r437 r">memberExpr</span> = <b>new</b> <a href="ast.cs.html#12093696666cdd51" class="t constructor">MemberExpressionAst</a>(<span class="r433 r">originalInstanceName</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r433 r">originalInstanceName</span>, <span class="r436 r">errorExpr</span>, <span class="r438 r">@static</span>: <b>false</b>);
 
                            <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<span class="r435 r">errorExtent</span>, <b>new</b>[] { <span class="r437 r">memberExpr</span> });
                        }
 
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r432 r">lCurly</span>);
                        <span class="c">// Preserve the name expression for tab completion</span>
                        <b>return</b> <span class="r433 r">originalInstanceName</span> == <b>null</b>
                                   ? <b>null</b>
                                   : <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r422 r">functionName</span>, <span class="r433 r">originalInstanceName</span>),
                                                           <a href="#5a40a6e894a3582f" class="i method">GetNestedErrorAsts</a>(<span class="r433 r">originalInstanceName</span>));
                    }
                }
 
                <span class="c">//</span>
                <span class="c">// The keyword data is used to see</span>
                <span class="c">// if a scriptblock or a hashtable is expected.</span>
                <span class="c">//</span>
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r439 rd" class="r439 r">body</span> = <b>null</b>;
                <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#46e96fbd06c2c3af" class="i property">BodyMode</a> == <a href="tokenizer.cs.html#dc369c18a439471a" class="t t">DynamicKeywordBodyMode</a>.<a href="tokenizer.cs.html#57e864f08639804e" class="i field">ScriptBlock</a>)
                {
                    <b>var</b> <span id="r440 rd" class="r440 r">oldInConfiguration</span> = <a href="#79c6907f0c6e9834" class="i field">_inConfiguration</a>;
                    <b>try</b>
                    {
                        <a href="#79c6907f0c6e9834" class="i field">_inConfiguration</a> = <b>false</b>;
                        <span class="r439 r">body</span> = <a href="#6042c9a5e817fc8e" class="i method">ScriptBlockExpressionRule</a>(<span class="r432 r">lCurly</span>);
                    }
                    <b>finally</b>
                    {
                        <a href="#79c6907f0c6e9834" class="i field">_inConfiguration</a> = <span class="r440 r">oldInConfiguration</span>;
                    }
                }
                <b>else</b> <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#46e96fbd06c2c3af" class="i property">BodyMode</a> == <a href="tokenizer.cs.html#dc369c18a439471a" class="t t">DynamicKeywordBodyMode</a>.<a href="tokenizer.cs.html#5da06d8412de17c8" class="i field">Hashtable</a>)
                {
                    <span class="c">// Resource property value could be set to nested DSC resources except Script resource</span>
                    <b>bool</b> <span id="r441 rd" class="r441 r">isScriptResource</span> = <b>string</b>.<span class="i">Equals</span>(<span class="r422 r">functionName</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <span class="s">@&quot;Script&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
                    <b>try</b>
                    {
                        <b>if</b> (<span class="r441 r">isScriptResource</span>)
                            <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="tokenizer.cs.html#0cdae039c0460080" class="i method">Push</a>();
                        <span class="r439 r">body</span> = <a href="#cf64b709609b3987" class="i method">HashExpressionRule</a>(<span class="r432 r">lCurly</span>, <b>true</b> <span class="c">/* parsingSchemaElement */</span>);
                    }
                    <b>finally</b>
                    {
                        <b>if</b> (<span class="r441 r">isScriptResource</span>)
                            <a href="tokenizer.cs.html#c72d6f1daa581d48" class="t t">DynamicKeyword</a>.<a href="tokenizer.cs.html#89e041ec233d5707" class="i method">Pop</a>();
                    }
                }
                <span class="c">// commandast</span>
                <span class="c">// elements: instancename/dynamickeyword/hashtable or scripblockexpress</span>
                <b>if</b> (<span class="r439 r">body</span> == <b>null</b>)
                {
                    <span class="c">// Failed to read the statement body</span>
                    <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r432 r">lCurly</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingStatementAfterKeyword</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingStatementAfterKeyword</span>,
                        <span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#b4378cc74685de63" class="i property">Keyword</a>);
 
                    <span class="c">// Preserve the name expression for tab completion</span>
                    <b>return</b> <span class="r433 r">originalInstanceName</span> == <b>null</b>
                               ? <b>null</b>
                               : <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r422 r">functionName</span>, <span class="r433 r">originalInstanceName</span>),
                                                       <a href="#5a40a6e894a3582f" class="i method">GetNestedErrorAsts</a>(<span class="r433 r">originalInstanceName</span>));
                }
 
                <span class="c">//////////////////////////////////////////////////////////////////////////</span>
                <span class="c">// The statement is now fully parsed</span>
                <span class="c">//////////////////////////////////////////////////////////////////////////</span>
 
                <span class="c">//</span>
                <span class="c">// Create DynamicKeywordStatementAst</span>
                <span class="c">//</span>
                <span class="i">Collection</span>&lt;<a href="ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt; <span id="r442 rd" class="r442 r">commandElements</span> = <b>new</b> <span class="i">Collection</span>&lt;<a href="ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt;
                {
                    <b>new</b> <a href="ast.cs.html#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r422 r">functionName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r422 r">functionName</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <a href="ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="ast.cs.html#7902d7b060b16556" class="i field">BareWord</a>),
                    (<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>)<span class="r430 r">instanceName</span>.<a href="ast.cs.html#7559dca1878820e8" class="i method">Copy</a>(),
                    (<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>)<span class="r439 r">body</span>.<a href="ast.cs.html#7559dca1878820e8" class="i method">Copy</a>()
                };
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r443 rd" class="r443 r">nextToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r444 rd" class="r444 r">dynamicKeywordExtent</span> = <a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r422 r">functionName</span>, <a href="#cb433f96b9585085" class="i method">Before</a>(<span class="r443 r">nextToken</span>));
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r443 r">nextToken</span>);
                <span class="r428 r">dynamicKeywordAst</span> = <b>new</b> <span class="t">DynamicKeywordStatementAst</span>(<span class="r444 r">dynamicKeywordExtent</span>, <span class="r442 r">commandElements</span>)
                {
                    <a href="ast.cs.html#0f0688a599c6de89" class="i property">Keyword</a> = <span class="r423 r">keywordData</span>,
                    <a href="ast.cs.html#4849619dbe3369d5" class="i property">LCurly</a> = <span class="r432 r">lCurly</span>,
                    <a href="ast.cs.html#914807ae6c6aa6f9" class="i property">FunctionName</a> = <span class="r422 r">functionName</span>,
                    <a href="ast.cs.html#42254f2c9f80529f" class="i property">InstanceName</a> = <span class="r430 r">instanceName</span>,
                    <a href="ast.cs.html#1c0c55ce1a10bab9" class="i property">OriginalInstanceName</a> = <span class="r433 r">originalInstanceName</span>,
                    <a href="ast.cs.html#f158e061c28b7505" class="i property">BodyExpression</a> = <span class="r439 r">body</span>,
                    <a href="ast.cs.html#3ad30598f32e7b03" class="i property">ElementName</a> = <span class="r427 r">elementName</span>,
                };
            }
 
            <span class="c">//////////////////////////////////////////////////////////////////////////////////</span>
            <span class="c">// If a custom action was provided. then invoke it</span>
            <span class="c">//////////////////////////////////////////////////////////////////////////////////</span>
            <b>if</b> (<span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#fd34ab8e73a2860c" class="i property">PostParse</a> != <b>null</b>)
            {
                <b>try</b>
                {
                    <a href="#3b2ee49e322daa35" class="t t">ParseError</a>[] <span id="r445 rd" class="r445 r">errors</span> = <span class="r423 r">keywordData</span>.<span class="i">PostParse</span>(<span class="r428 r">dynamicKeywordAst</span>);
                    <b>if</b> (<span class="r445 r">errors</span> != <b>null</b> &amp;&amp; <span class="r445 r">errors</span>.<span class="i">Length</span> &gt; 0)
                    {
                        <b>foreach</b> (<a href="#3b2ee49e322daa35" class="k">var</a> <span id="r446 rd" class="r446 r">e</span> <b>in</b> <span class="r445 r">errors</span>)
                        {
                            <a href="#67620d15942976b8" class="i method">ReportError</a>(<span class="r446 r">e</span>);
                        }
                    }
                }
                <b>catch</b> (<span class="i">Exception</span> <span id="r447 rd" class="r447 r">e</span>)
                {
                    <span class="i">ReportError</span>(<span class="r422 r">functionName</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DynamicKeywordPostParseException</span>),
                        <span class="i">ParserStrings</span>.<span class="i">DynamicKeywordPostParseException</span>,
                        <span class="r423 r">keywordData</span>.<a href="tokenizer.cs.html#b4378cc74685de63" class="i property">Keyword</a>,
                        <span class="r447 r">e</span>.<span class="i">ToString</span>());
                    <b>return</b> <b>null</b>;
                }
            }
 
            <b>return</b> <span class="r428 r">dynamicKeywordAst</span>;
        }
 
        <b>internal</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="f30c3b80bc82348b" href="../../R/../../0000000000.html" target="n" data-glyph="74,1" class="i method">CreateErrorStatementAst</a>(
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r448 rd" class="r448 r">functionName</span>,
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r449 rd" class="r449 r">instanceName</span>,
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r450 rd" class="r450 r">bodyExpression</span>)
        {
            <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r448 r">functionName</span>, <span class="r450 r">bodyExpression</span>), <a href="#5a40a6e894a3582f" class="i method">GetNestedErrorAsts</a>(<span class="r449 r">instanceName</span>, <span class="r450 r">bodyExpression</span>));
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="bbaea32273e026b0" href="../../R/bbaea32273e026b0.html" target="n" data-glyph="76,1" class="i method">DoWhileStatementRule</a>(<a href="token.cs.html#424ba3736e9bca64" class="t t">LabelToken</a> <span id="r451 rd" class="r451 r">labelToken</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r452 rd" class="r452 r">doToken</span>)
        {
            <span class="c">// G  do-statement:</span>
            <span class="c">// G      &#39;do&#39;   statement-block  new-lines:opt   &#39;while&#39;   new-lines:opt   &#39;(&#39;   while-condition   new-lines:opt   &#39;)&#39;</span>
            <span class="c">// G      &#39;do&#39;   statement-block   new-lines:opt   &#39;until&#39;   new-lines:opt   &#39;(&#39;   while-condition   new-lines:opt   &#39;)&#39;</span>
            <span class="c">// G</span>
            <span class="c">// G  while-condition:</span>
            <span class="c">// G      new-lines:opt   pipeline</span>
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r453 rd" class="r453 r">startExtent</span> = (<span class="r451 r">labelToken</span> ?? <span class="r452 r">doToken</span>).<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r454 rd" class="r454 r">endErrorStatement</span> = <b>null</b>;
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r455 rd" class="r455 r">rParen</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r456 rd" class="r456 r">whileOrUntilToken</span> = <b>null</b>;
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r457 rd" class="r457 r">condition</span> = <b>null</b>;
            <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r458 rd" class="r458 r">body</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
            <b>if</b> (<span class="r458 r">body</span> == <b>null</b>)
            {
                <span class="c">// ErrorRecovery: Skip the keyword and stop trying to parse this statement, continue on whatever</span>
                <span class="c">// comes next.</span>
 
                <span class="r454 r">endErrorStatement</span> = <span class="r452 r">doToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r454 r">endErrorStatement</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingLoopStatement</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingLoopStatement</span>,
                    <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b1e5a3400d6e1c03" class="i field">Do</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
            }
            <b>else</b>
            {
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r456 r">whileOrUntilToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r456 r">whileOrUntilToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#73bf75a67618407f" class="i field">While</a> &amp;&amp; <span class="r456 r">whileOrUntilToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3775e39bd88a79e5" class="i field">Until</a>)
                {
                    <span class="c">// ErrorRecovery: Skip looking for a condition, continue on whatever comes next.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r456 r">whileOrUntilToken</span>);
                    <span class="r454 r">endErrorStatement</span> = <span class="r458 r">body</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r454 r">endErrorStatement</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingWhileOrUntilInDoWhile</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingWhileOrUntilInDoWhile</span>);
                }
                <b>else</b>
                {
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r459 rd" class="r459 r">lParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                    <b>if</b> (<span class="r459 r">lParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>)
                    {
                        <span class="c">// ErrorRecovery: Skip looking for the condition, return an error statement.</span>
 
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r459 r">lParen</span>);
                        <span class="r454 r">endErrorStatement</span> = <span class="r456 r">whileOrUntilToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                        <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r454 r">endErrorStatement</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingOpenParenthesisAfterKeyword</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingOpenParenthesisAfterKeyword</span>,
                            <span class="r456 r">whileOrUntilToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                    }
                    <b>else</b>
                    {
                        <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                        <span class="r457 r">condition</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
                        <b>if</b> (<span class="r457 r">condition</span> == <b>null</b>)
                        {
                            <span class="c">// ErrorRecovery: try to get the matching close paren, then return an error statement.</span>
 
                            <span class="r454 r">endErrorStatement</span> = <span class="r459 r">lParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                            <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r454 r">endErrorStatement</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterKeyword</span>),
                                <span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterKeyword</span>,
                                <span class="r456 r">whileOrUntilToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                        }
 
                        <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                        <span class="r455 r">rParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                        <b>if</b> (<span class="r455 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>)
                        {
                            <span class="c">// ErrorRecovery: this is it, so just pretend we saw the paren, return an error statement.</span>
 
                            <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r455 r">rParen</span>);
 
                            <span class="c">// If condition == null, we issue an error message already, don&#39;t bother with this one.</span>
                            <b>if</b> (<span class="r457 r">condition</span> != <b>null</b>)
                            {
                                <span class="r454 r">endErrorStatement</span> = <span class="r457 r">condition</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                                <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r454 r">endErrorStatement</span>),
                                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisAfterStatement</span>),
                                    <span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisAfterStatement</span>,
                                    <span class="r456 r">whileOrUntilToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                            }
                        }
                    }
                }
            }
 
            <b>if</b> (<span class="r454 r">endErrorStatement</span> != <b>null</b>)
            {
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r453 r">startExtent</span>, <span class="r454 r">endErrorStatement</span>), <a href="#5a40a6e894a3582f" class="i method">GetNestedErrorAsts</a>(<span class="r458 r">body</span>, <span class="r457 r">condition</span>));
            }
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r460 rd" class="r460 r">extent</span> = <a href="#f641ab898c5a3be2" class="i method">ExtentOf</a>(<span class="r453 r">startExtent</span>, <span class="r455 r">rParen</span>);
            <b>string</b> <span id="r461 rd" class="r461 r">label</span> = <span class="r451 r">labelToken</span>?.<a href="token.cs.html#43986cebcafcf714" class="i property">LabelText</a>;
            <b>if</b> (<span class="r456 r">whileOrUntilToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3775e39bd88a79e5" class="i field">Until</a>)
            {
                <b>return</b> <b>new</b> <a href="ast.cs.html#3f8786d40ee146dc" class="t constructor">DoUntilStatementAst</a>(<span class="r460 r">extent</span>, <span class="r461 r">label</span>, <span class="r457 r">condition</span>, <span class="r458 r">body</span>);
            }
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#4c0084da04267c4f" class="t constructor">DoWhileStatementAst</a>(<span class="r460 r">extent</span>, <span class="r461 r">label</span>, <span class="r457 r">condition</span>, <span class="r458 r">body</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="1318b95e671b61fc" href="../../R/1318b95e671b61fc.html" target="n" data-glyph="76,1" class="i method">ClassDefinitionRule</a>(<span class="i">List</span>&lt;<a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt; <span id="r462 rd" class="r462 r">customAttributes</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r463 rd" class="r463 r">classToken</span>)
        {
            <span class="c">// G  class-statement:</span>
            <span class="c">// G      attribute-list:opt   &#39;class&#39;   new-lines:opt   class-name   new-lines:opt  &#39;{&#39;   class-member-list   &#39;}&#39;</span>
            <span class="c">// G      attribute-list:opt   &#39;class&#39;   new-lines:opt   class-name   new-lines:opt  &#39;:&#39;  base-type-list  &#39;{&#39;  new-lines:opt  class-member-list:opt  &#39;}&#39;</span>
            <span class="c">// G</span>
            <span class="c">// G  class-name:</span>
            <span class="c">// G      simple-name</span>
            <span class="c">// G</span>
            <span class="c">// G  base-type-list:</span>
            <span class="c">// G      new-lines:opt   type-name   new-lines:opt</span>
            <span class="c">// G      base-class-list  &#39;,&#39;   new-lines:opt   type-name   new-lines:opt</span>
            <span class="c">// G</span>
            <span class="c">// G  class-member-list:</span>
            <span class="c">// G      class-member  new-lines:opt</span>
            <span class="c">// G      class-member-list   class-member</span>
 
            <span class="c">// PowerShell classes are not supported in ConstrainedLanguage</span>
            <b>if</b> (<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>?.<a href="../hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>?.<a href="../ExecutionContext.cs.html#ebe55e376f6c32fa" class="i property">LanguageMode</a> == <a href="../SessionStatePublic.cs.html#450052824aba2e3f" class="t t">PSLanguageMode</a>.<a href="../SessionStatePublic.cs.html#9f1205fe78117fc2" class="i field">ConstrainedLanguage</a>)
            {
                <span class="i">ReportError</span>(<span class="r463 r">classToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ClassesNotAllowedInConstrainedLanguage</span>),
                            <span class="i">ParserStrings</span>.<span class="i">ClassesNotAllowedInConstrainedLanguage</span>,
                            <span class="r463 r">classToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
 
                <b>return</b> <b>null</b>;
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r464 rd" class="r464 r">classNameToken</span>;
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r465 rd" class="r465 r">name</span> = <a href="#299756015ec6936d" class="i method">SimpleNameRule</a>(<b>out</b> <span class="r464 r">classNameToken</span>);
            <b>if</b> (<span class="r465 r">name</span> == <b>null</b>)
            {
                <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r463 r">classToken</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingNameAfterKeyword</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingNameAfterKeyword</span>,
                    <span class="r463 r">classToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<span class="r463 r">classToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
            }
 
            <span class="c">// Class name token represents a name of type, not a member. Highlight it as a type name.</span>
            <span class="r464 r">classNameToken</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> &amp;= ~<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#e2013f56302cb2d2" class="i field">MemberName</a>;
            <span class="r464 r">classNameToken</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> |= <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#5f165a9a05394b87" class="i field">TypeName</a>;
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <span class="c">// handle inheritance constraint.</span>
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r466 rd" class="r466 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>var</b> <span id="r467 rd" class="r467 r">superClassesList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;();
            <b>try</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#2dcac73d38701d80" class="i field">Signature</a>);
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r468 rd" class="r468 r">colonToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r468 r">colonToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a3c2c007e625be62" class="i field">Colon</a>)
                {
                    <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r469 rd" class="r469 r">superClass</span>;
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r470 rd" class="r470 r">unused</span>;
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r471 rd" class="r471 r">commaToken</span> = <b>null</b>;
                    <b>while</b> (<b>true</b>)
                    {
                        <span class="r469 r">superClass</span> = <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#94ecdfa0b8f28cd7" class="i method">TypeNameRule</a>(<span class="r50 r">allowAssemblyQualifiedNames</span>: <b>false</b>, <span class="r51 r">firstTypeNameToken</span>: <b>out</b> <span class="r470 r">unused</span>);
                        <b>if</b> (<span class="r469 r">superClass</span> == <b>null</b>)
                        {
                            <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<a href="#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r471 r">commaToken</span>, <span class="r468 r">colonToken</span>)),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TypeNameExpected</span>),
                                <span class="i">ParserStrings</span>.<span class="i">TypeNameExpected</span>);
                            <b>break</b>;
                        }
 
                        <span class="r467 r">superClassesList</span>.<span class="i">Add</span>(<b>new</b> <a href="ast.cs.html#51c2fb9bdf674fb1" class="t constructor">TypeConstraintAst</a>(<span class="r469 r">superClass</span>.<a href="ast.cs.html#2b8e897172d31016" class="i property">Extent</a>, <span class="r469 r">superClass</span>));
                        <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                        <span class="r471 r">commaToken</span> = <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                        <b>if</b> (<span class="r471 r">commaToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                        {
                            <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                            <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                        }
                        <b>else</b>
                        {
                            <b>break</b>;
                        }
                    }
                }
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r472 rd" class="r472 r">lCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r472 r">lCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>)
                {
                    <span class="c">// ErrorRecovery: If there is no opening curly, assume it hasn&#39;t been entered yet and don&#39;t consume anything.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r472 r">lCurly</span>);
                    <b>var</b> <span id="r473 rd" class="r473 r">lastElement</span> = (<span class="r467 r">superClassesList</span>.<span class="i">Count</span> &gt; 0) ? (<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>)<span class="r467 r">superClassesList</span>[<span class="r467 r">superClassesList</span>.<span class="i">Count</span> - 1] : <span class="r465 r">name</span>;
                    <span class="i">ReportIncompleteInput</span>(<span class="i">After</span>(<span class="r473 r">lastElement</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingTypeBody</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingTypeBody</span>,
                        <span class="r463 r">classToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                    <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<span class="i">ExtentOf</span>(<span class="r463 r">classToken</span>, <span class="r473 r">lastElement</span>), <span class="r467 r">superClassesList</span>);
                }
 
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r474 rd" class="r474 r">lastExtent</span> = <span class="r472 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r475 rd" class="r475 r">nestedAsts</span> = <b>null</b>;
                <a href="ast.cs.html#6092492a0585632c" class="t t">MemberAst</a> <span id="r476 rd" class="r476 r">member</span>;
                <span class="i">List</span>&lt;<a href="ast.cs.html#6092492a0585632c" class="t t">MemberAst</a>&gt; <span id="r477 rd" class="r477 r">members</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#6092492a0585632c" class="t t">MemberAst</a>&gt;();
                <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r478 rd" class="r478 r">astsOnError</span> = <b>null</b>;
 
                <b>while</b> ((<span class="r476 r">member</span> = <a href="#976242569f714d3d" class="i method">ClassMemberRule</a>(<span class="r465 r">name</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <b>out</b> <span class="r478 r">astsOnError</span>)) != <b>null</b> || <span class="r478 r">astsOnError</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r476 r">member</span> != <b>null</b>)
                    {
                        <span class="r477 r">members</span>.<span class="i">Add</span>(<span class="r476 r">member</span>);
                        <span class="r474 r">lastExtent</span> = <span class="r476 r">member</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                    }
 
                    <b>if</b> (<span class="r478 r">astsOnError</span> != <b>null</b> &amp;&amp; <span class="r478 r">astsOnError</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <b>if</b> (<span class="r475 r">nestedAsts</span> == <b>null</b>)
                        {
                            <span class="r475 r">nestedAsts</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;();
                        }
 
                        <span class="r475 r">nestedAsts</span>.<span class="i">AddRange</span>(<span class="r478 r">astsOnError</span>);
                        <span class="r474 r">lastExtent</span> = <span class="r478 r">astsOnError</span>.<span class="i">Last</span>().<span class="i">Extent</span>;
                    }
                }
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r479 rd" class="r479 r">rCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r479 r">rCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>)
                {
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r479 r">rCurly</span>);
                    <span class="i">ReportIncompleteInput</span>(
                        <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r472 r">lCurly</span>),
                        <span class="r479 r">rCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndCurlyBrace</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingEndCurlyBrace</span>);
                }
                <b>else</b>
                {
                    <span class="r474 r">lastExtent</span> = <span class="r479 r">rCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                }
 
                <b>var</b> <span id="r480 rd" class="r480 r">startExtent</span> = <span class="r462 r">customAttributes</span> != <b>null</b> &amp;&amp; <span class="r462 r">customAttributes</span>.<span class="i">Count</span> &gt; 0
                                      ? <span class="r462 r">customAttributes</span>[0].<span class="i">Extent</span>
                                      : <span class="r463 r">classToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <a href="Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r481 rd" class="r481 r">extent</span> = <span class="i">ExtentOf</span>(<span class="r480 r">startExtent</span>, <span class="r474 r">lastExtent</span>);
                <a href="ast.cs.html#d7f0bc21c0f10879" class="k">var</a> <span id="r482 rd" class="r482 r">classDefn</span> = <b>new</b> <span class="t">TypeDefinitionAst</span>(<span class="r481 r">extent</span>, <span class="r465 r">name</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <span class="r462 r">customAttributes</span>?.<span class="i">OfType</span>&lt;<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;(), <span class="r477 r">members</span>, <a href="ast.cs.html#b246aec2982cbe0e" class="t t">TypeAttributes</a>.<a href="ast.cs.html#d60e921be64513ed" class="i field">Class</a>, <span class="r467 r">superClassesList</span>);
                <b>if</b> (<span class="r462 r">customAttributes</span> != <b>null</b> &amp;&amp; <span class="r462 r">customAttributes</span>.<span class="i">OfType</span>&lt;<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;().<span class="i">Any</span>())
                {
                    <b>if</b> (<span class="r475 r">nestedAsts</span> == <b>null</b>)
                    {
                        <span class="r475 r">nestedAsts</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;();
                    }
                    <span class="c">// no need to report error since the error is reported in method StatementRule</span>
                    <span class="r475 r">nestedAsts</span>.<span class="i">AddRange</span>(<span class="r462 r">customAttributes</span>.<span class="i">OfType</span>&lt;<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;());
                    <span class="r475 r">nestedAsts</span>.<span class="i">Add</span>(<span class="r482 r">classDefn</span>);
                }
 
                <b>if</b> (<span class="r475 r">nestedAsts</span> != <b>null</b> &amp;&amp; <span class="r475 r">nestedAsts</span>.<span class="i">Count</span> &gt; 0)
                {
                    <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<span class="r481 r">extent</span>, <span class="r475 r">nestedAsts</span>);
                }
 
                <b>return</b> <span class="r482 r">classDefn</span>;
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r466 r">oldTokenizerMode</span>);
            }
        }
 
        <b>private</b> <a href="ast.cs.html#6092492a0585632c" class="t t">MemberAst</a> <a id="976242569f714d3d" href="../../R/976242569f714d3d.html" target="n" data-glyph="76,1" class="i method">ClassMemberRule</a>(<b>string</b> <span id="r483 rd" class="r483 r">className</span>, <b>out</b> <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r484 rd" class="r484 r">astsOnError</span>)
        {
            <span class="c">// G  class-member:</span>
            <span class="c">// G      method-member</span>
            <span class="c">// G      property-member</span>
            <span class="c">// G</span>
            <span class="c">// G  method-member:</span>
            <span class="c">// G      member-attribute-list:opt function-statement</span>
            <span class="c">// G</span>
            <span class="c">// G  property-member:</span>
            <span class="c">// G      member-attribute-list:opt  variable</span>
            <span class="c">// G      member-attribute-list:opt  variable  &#39;=&#39;  expression</span>
            <span class="c">// G</span>
            <span class="c">// G  member-attribute-list:</span>
            <span class="c">// G      member-attribute</span>
            <span class="c">// G      member-attribute-list  member-attribute</span>
            <span class="c">// G</span>
            <span class="c">// G  member-attribute:</span>
            <span class="c">// G      attribute</span>
            <span class="c">// G      &#39;static&#39;</span>
            <span class="c">// G      &#39;hidden&#39;</span>
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r485 rd" class="r485 r">startExtent</span> = <b>null</b>;
            <b>var</b> <span id="r486 rd" class="r486 r">attributeList</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;();
            <a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r487 rd" class="r487 r">typeConstraint</span> = <b>null</b>;
            <b>bool</b> <span id="r488 rd" class="r488 r">scanningAttributes</span> = <b>true</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r489 rd" class="r489 r">staticToken</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r490 rd" class="r490 r">hiddenToken</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r491 rd" class="r491 r">token</span> = <b>null</b>;
            <b>object</b> <span id="r492 rd" class="r492 r">lastAttribute</span> = <b>null</b>;
            <span class="r484 r">astsOnError</span> = <b>null</b>;
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">SUPPORT_PUBLIC_PRIVATE</span>
<span class="e">// Public/private not yet supported
            Token publicToken = null;
            Token privateToken = null;
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
            <b>while</b> (<span class="r488 r">scanningAttributes</span>)
            {
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <a href="ast.cs.html#35c989f6a7b4eace" class="k">var</a> <span id="r493 rd" class="r493 r">attribute</span> = <a href="#b8ee90436ed71ebc" class="i method">AttributeRule</a>();
                <b>if</b> (<span class="r493 r">attribute</span> != <b>null</b>)
                {
                    <span class="r492 r">lastAttribute</span> = <span class="r493 r">attribute</span>;
                    <b>if</b> (<span class="r485 r">startExtent</span> == <b>null</b>)
                    {
                        <span class="r485 r">startExtent</span> = <span class="r493 r">attribute</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                    }
 
                    <a href="ast.cs.html#f576d1d6cbb736a0" class="k">var</a> <span id="r494 rd" class="r494 r">attributeAst</span> = <span class="r493 r">attribute</span> <b>as</b> <a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>;
                    <b>if</b> (<span class="r494 r">attributeAst</span> != <b>null</b>)
                    {
                        <span class="r486 r">attributeList</span>.<span class="i">Add</span>(<span class="r494 r">attributeAst</span>);
                    }
                    <b>else</b> <b>if</b> (<span class="r487 r">typeConstraint</span> == <b>null</b>)
                    {
                        <span class="r487 r">typeConstraint</span> = (<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>)<span class="r493 r">attribute</span>;
                    }
                    <b>else</b>
                    {
                        <span class="i">ReportError</span>(<span class="r493 r">attribute</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TooManyTypes</span>), <span class="i">ParserStrings</span>.<span class="i">TooManyTypes</span>);
                    }
 
                    <b>continue</b>;
                }
 
                <span class="r491 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r485 r">startExtent</span> == <b>null</b>)
                {
                    <span class="r485 r">startExtent</span> = <span class="r491 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                }
 
                <b>switch</b> (<span class="r491 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
                {
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">SUPPORT_PUBLIC_PRIVATE</span>
<span class="e">                    case TokenKind.Public:
                        if (publicToken != null)
                        {
                            ReportError(token.Extent,
                                nameof(ParserStrings.DuplicateQualifier),
                                ParserStrings.DuplicateQualifier,
                                token.Text);
                        }
 
                        if (privateToken != null)
                        {
                            ReportError(token.Extent,
                                nameof(ParserStrings.ModifiersCannotBeCombined),
                                ParserStrings.ModifiersCannotBeCombined,
                                privateToken.Text,
                                token.Text);
                        }
 
                        publicToken = token;
                        SkipToken();
                        break;
 
                    case TokenKind.Private:
                        if (privateToken != null)
                        {
                            ReportError(token.Extent,
                                nameof(ParserStrings.DuplicateQualifier),
                                ParserStrings.DuplicateQualifier,
                                token.Text);
                        }
 
                        if (publicToken != null)
                        {
                            ReportError(token.Extent,
                                nameof(ParserStrings.ModifiersCannotBeCombined),
                                ParserStrings.ModifiersCannotBeCombined,
                                publicToken.Text,
                                token.Text);
                        }
 
                        privateToken = token;
                        SkipToken();
                        break;
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e78a6a229c4b55ce" class="i field">Hidden</a>:
                        <b>if</b> (<span class="r490 r">hiddenToken</span> != <b>null</b>)
                        {
                            <span class="i">ReportError</span>(<span class="r491 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DuplicateQualifier</span>),
                                <span class="i">ParserStrings</span>.<span class="i">DuplicateQualifier</span>,
                                <span class="r491 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                        }
 
                        <span class="r490 r">hiddenToken</span> = <span class="r491 r">token</span>;
                        <span class="r492 r">lastAttribute</span> = <span class="r491 r">token</span>;
                        <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                        <b>break</b>;
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c46f4d572b9409c5" class="i field">Static</a>:
                        <b>if</b> (<span class="r489 r">staticToken</span> != <b>null</b>)
                        {
                            <span class="i">ReportError</span>(<span class="r491 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">DuplicateQualifier</span>),
                                <span class="i">ParserStrings</span>.<span class="i">DuplicateQualifier</span>,
                                <span class="r491 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                        }
 
                        <span class="r489 r">staticToken</span> = <span class="r491 r">token</span>;
                        <span class="r492 r">lastAttribute</span> = <span class="r491 r">token</span>;
                        <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                        <b>break</b>;
 
                    <b>default</b>:
                        <span class="r488 r">scanningAttributes</span> = <b>false</b>;
                        <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r491 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8b5a9c54e2029553" class="i field">Variable</a>)
            {
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
 
                <a href="token.cs.html#cb1e7cc3b0285414" class="k">var</a> <span id="r495 rd" class="r495 r">varToken</span> = <span class="r491 r">token</span> <b>as</b> <a href="token.cs.html#cb1e7cc3b0285414" class="t t">VariableToken</a>;
 
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r496 rd" class="r496 r">initialValueAst</span> = <b>null</b>;
                <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r497 rd" class="r497 r">assignToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r497 r">assignToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d78e08594ff6b79a" class="i field">Equals</a>)
                {
                    <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <span class="r496 r">initialValueAst</span> = <a href="#8da955af7d659a21" class="i method">ExpressionRule</a>();
                }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">SUPPORT_PUBLIC_PRIVATE</span>
<span class="e">                PropertyAttributes attributes = privateToken != null ? PropertyAttributes.Private : PropertyAttributes.Public;
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
                <a href="ast.cs.html#003cbc0806eaf107" class="t t">PropertyAttributes</a> <span id="r498 rd" class="r498 r">attributes</span> = <a href="ast.cs.html#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="ast.cs.html#b2401842fad0b17e" class="i field">Public</a>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                <b>if</b> (<span class="r489 r">staticToken</span> != <b>null</b>)
                {
                    <span class="r498 r">attributes</span> |= <a href="ast.cs.html#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="ast.cs.html#43f6609d852582fe" class="i field">Static</a>;
                }
 
                <b>if</b> (<span class="r490 r">hiddenToken</span> != <b>null</b>)
                {
                    <span class="r498 r">attributes</span> |= <a href="ast.cs.html#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="ast.cs.html#db9fd4c5992c99bd" class="i field">Hidden</a>;
                }
 
                <a href="Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r499 rd" class="r499 r">endExtent</span> = <span class="r496 r">initialValueAst</span> != <b>null</b> ? <span class="r496 r">initialValueAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a> : <span class="r495 r">varToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r500 rd" class="r500 r">terminatorToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r500 r">terminatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a> &amp;&amp; <span class="r500 r">terminatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a> &amp;&amp; <span class="r500 r">terminatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>)
                {
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r499 r">endExtent</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingPropertyTerminator</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingPropertyTerminator</span>);
                }
 
                <a href="#20cf6d6d776dad25" class="i method">SkipNewlinesAndSemicolons</a>();
 
                <span class="c">// Include the semicolon in the extent but not newline or rcurly as that will look weird, e.g. if an error is reported on the full extent</span>
                <b>if</b> (<span class="r500 r">terminatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>)
                {
                    <span class="r499 r">endExtent</span> = <span class="r500 r">terminatorToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                }
 
                <b>if</b> (!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r495 r">varToken</span>.<a href="token.cs.html#d09f7d390fc346e4" class="i property">Name</a>))
                {
                    <b>return</b> <b>new</b> <span class="t">PropertyMemberAst</span>(<a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r485 r">startExtent</span>, <span class="r499 r">endExtent</span>), <span class="r495 r">varToken</span>.<a href="token.cs.html#d09f7d390fc346e4" class="i property">Name</a>,
                        <span class="r487 r">typeConstraint</span>, <span class="r486 r">attributeList</span>, <span class="r498 r">attributes</span>, <span class="r496 r">initialValueAst</span>);
                }
                <b>else</b>
                {
                    <span class="c">// Incompleted input like:</span>
                    <span class="c">// class foo { $private: }</span>
                    <span class="c">// Error message already emitted by tokenizer ScanVariable</span>
 
                    <span class="i">RecordErrorAsts</span>(<span class="r486 r">attributeList</span>, <b>ref</b> <span class="r484 r">astsOnError</span>);
                    <a href="#be375e7eb13fa797" class="i method">RecordErrorAsts</a>(<span class="r487 r">typeConstraint</span>, <b>ref</b> <span class="r484 r">astsOnError</span>);
                    <a href="#be375e7eb13fa797" class="i method">RecordErrorAsts</a>(<span class="r496 r">initialValueAst</span>, <b>ref</b> <span class="r484 r">astsOnError</span>);
                    <b>return</b> <b>null</b>;
                }
            }
 
            <b>if</b> (<a href="#1a50e45fa0fcbd98" class="i method">TryUseTokenAsSimpleName</a>(<span class="r491 r">token</span>))
            {
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <a href="ast.cs.html#dd61b2a7b388405b" class="k">var</a> <span id="r501 rd" class="r501 r">functionDefinition</span> = <a href="#e9bec71d7d4d4fd8" class="i method">MethodDeclarationRule</a>(<span class="r491 r">token</span>, <span class="r483 r">className</span>, <span class="r489 r">staticToken</span> != <b>null</b>) <b>as</b> <a href="ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a>;
 
                <b>if</b> (<span class="r501 r">functionDefinition</span> == <b>null</b>)
                {
                    <span class="c">// TODO: better error recovery - shouldn&#39;t assume this was the last class member</span>
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Count</span> &gt; 0, <span class="s">&quot;Should be an error if we don&#39;t have a function&quot;</span>);
                    <a href="#e51058c98956995e" class="i method">SyncOnError</a>(<b>false</b>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>);
                    <span class="i">RecordErrorAsts</span>(<span class="r486 r">attributeList</span>, <b>ref</b> <span class="r484 r">astsOnError</span>);
                    <a href="#be375e7eb13fa797" class="i method">RecordErrorAsts</a>(<span class="r487 r">typeConstraint</span>, <b>ref</b> <span class="r484 r">astsOnError</span>);
                    <b>return</b> <b>null</b>;
                }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> <span class="i">SUPPORT_PUBLIC_PRIVATE</span>
<span class="e">                MethodAttributes attributes = privateToken != null ? MethodAttributes.Private : MethodAttributes.Public;
</span><span class="k preprocess">#</span><span class="k preprocess">else</span>
                <a href="ast.cs.html#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a> <span id="r502 rd" class="r502 r">attributes</span> = <a href="ast.cs.html#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a>.<a href="ast.cs.html#f2d4c4659fabc967" class="i field">Public</a>;
<span class="k preprocess">#</span><span class="k preprocess">endif</span>
                <b>if</b> (<span class="r489 r">staticToken</span> != <b>null</b>)
                {
                    <span class="r502 r">attributes</span> |= <a href="ast.cs.html#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a>.<a href="ast.cs.html#09a86f235bd689ff" class="i field">Static</a>;
                }
 
                <b>if</b> (<span class="r490 r">hiddenToken</span> != <b>null</b>)
                {
                    <span class="r502 r">attributes</span> |= <a href="ast.cs.html#e5a1ea7f5a227ec3" class="t t">MethodAttributes</a>.<a href="ast.cs.html#c7f8d97ad1275e8b" class="i field">Hidden</a>;
                }
 
                <b>return</b> <b>new</b> <span class="t">FunctionMemberAst</span>(<a href="#4229d79777aa8b76" class="i method">ExtentOf</a>(<span class="r485 r">startExtent</span>, <span class="r501 r">functionDefinition</span>), <span class="r501 r">functionDefinition</span>, <span class="r487 r">typeConstraint</span>, <span class="r486 r">attributeList</span>, <span class="r502 r">attributes</span>);
            }
 
            <b>if</b> (<span class="r492 r">lastAttribute</span> != <b>null</b>)
            {
                <span class="c">// We have the start of a member, but didn&#39;t see a variable or &#39;def&#39;.</span>
                <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<a href="#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r492 r">lastAttribute</span>)),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">IncompleteMemberDefinition</span>),
                    <span class="i">ParserStrings</span>.<span class="i">IncompleteMemberDefinition</span>);
                <span class="i">RecordErrorAsts</span>(<span class="r486 r">attributeList</span>, <b>ref</b> <span class="r484 r">astsOnError</span>);
                <a href="#be375e7eb13fa797" class="i method">RecordErrorAsts</a>(<span class="r487 r">typeConstraint</span>, <b>ref</b> <span class="r484 r">astsOnError</span>);
            }
 
            <b>return</b> <b>null</b>;
        }
 
        <b>private static bool</b> <a id="1a50e45fa0fcbd98" href="../../R/1a50e45fa0fcbd98.html" target="n" data-glyph="76,1" class="i method">TryUseTokenAsSimpleName</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r503 rd" class="r503 r">token</span>)
        {
            <b>if</b> (<span class="r503 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a>
                || <span class="r503 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e7868dd662d25e11" class="i field">DynamicKeyword</a>
                || <span class="r503 r">token</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a>.<span class="i">HasFlag</span>(<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#bffc83c32a1428ea" class="i field">Keyword</a>))
            {
                <span class="r503 r">token</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> = <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b2a92bcc145033f2" class="i field">None</a>;
                <b>return</b> <b>true</b>;
            }
 
            <b>return</b> <b>false</b>;
        }
 
        <b>private static void</b> <a id="be375e7eb13fa797" href="../../R/be375e7eb13fa797.html" target="n" data-glyph="76,1" class="i method">RecordErrorAsts</a>(<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <span id="r504 rd" class="r504 r">errAst</span>, <b>ref</b> <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r505 rd" class="r505 r">astsOnError</span>)
        {
            <b>if</b> (<span class="r504 r">errAst</span> == <b>null</b>)
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r505 r">astsOnError</span> == <b>null</b>)
            {
                <span class="r505 r">astsOnError</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;();
            }
 
            <span class="r505 r">astsOnError</span>.<span class="i">Add</span>(<span class="r504 r">errAst</span>);
        }
 
        <b>private static void</b> <a id="ea507a4ec320f159" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">RecordErrorAsts</a>(<span class="i">IEnumerable</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r506 rd" class="r506 r">errAsts</span>, <b>ref</b> <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r507 rd" class="r507 r">astsOnError</span>)
        {
            <b>if</b> (<span class="r506 r">errAsts</span> == <b>null</b> || !<span class="r506 r">errAsts</span>.<span class="i">Any</span>())
            {
                <b>return</b>;
            }
 
            <b>if</b> (<span class="r507 r">astsOnError</span> == <b>null</b>)
            {
                <span class="r507 r">astsOnError</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;();
            }
 
            <span class="r507 r">astsOnError</span>.<span class="i">AddRange</span>(<span class="r506 r">errAsts</span>);
        }
 
        <b>private</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <a id="800900b222611126" href="../../R/../../0000000000.html" target="n" data-glyph="76,1" class="i method">NextTypeIdentifierToken</a>()
        {
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r508 rd" class="r508 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <span class="c">// Switch to typename mode to avoid aggressive argument tokenization.</span>
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#2fb25110d5ff3e8b" class="i field">TypeName</a>);
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r509 rd" class="r509 r">typeName</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r509 r">typeName</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7ad757fcc8d67426" class="i field">Identifier</a>)
                {
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r509 r">typeName</span>);
                    <b>return</b> <b>null</b>;
                }
 
                <b>return</b> <span class="r509 r">typeName</span>;
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r508 r">oldTokenizerMode</span>);
            }
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="6c0d51b2072aa4f7" href="../../R/6c0d51b2072aa4f7.html" target="n" data-glyph="76,1" class="i method">EnumDefinitionRule</a>(<span class="i">List</span>&lt;<a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a>&gt; <span id="r510 rd" class="r510 r">customAttributes</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r511 rd" class="r511 r">enumToken</span>)
        {
            <span class="c">// G  enum-statement:</span>
            <span class="c">// G      &#39;enum&#39;   new-lines:opt   enum-name   &#39;{&#39;   enum-member-list   &#39;}&#39;</span>
            <span class="c">// G      &#39;enum&#39;   new-lines:opt   enum-name   &#39;:&#39;  enum-underlying-type  &#39;{&#39;   enum-member-list   &#39;}&#39;</span>
            <span class="c">// G</span>
            <span class="c">// G  enum-name:</span>
            <span class="c">// G      simple-name</span>
            <span class="c">// G</span>
            <span class="c">// G  enum-underlying-type:</span>
            <span class="c">// G      new-lines:opt   valid-type-name   new-lines:opt</span>
            <span class="c">// G</span>
            <span class="c">// G  enum-member-list:</span>
            <span class="c">// G      enum-member  new-lines:opt</span>
            <span class="c">// G      enum-member-list   enum-member</span>
 
            <b>const</b> <span class="i">TypeCode</span> <span id="r512 rd" class="r512 r">ValidUnderlyingTypeCodes</span> = <span class="i">TypeCode</span>.<span class="i">Byte</span> | <span class="i">TypeCode</span>.<span class="i">Int16</span> | <span class="i">TypeCode</span>.<span class="i">Int32</span> | <span class="i">TypeCode</span>.<span class="i">Int64</span> | <span class="i">TypeCode</span>.<span class="i">SByte</span> | <span class="i">TypeCode</span>.<span class="i">UInt16</span> | <span class="i">TypeCode</span>.<span class="i">UInt32</span> | <span class="i">TypeCode</span>.<span class="i">UInt64</span>;
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r513 rd" class="r513 r">name</span> = <a href="#942135886d841ed5" class="i method">SimpleNameRule</a>();
            <b>if</b> (<span class="r513 r">name</span> == <b>null</b>)
            {
                <span class="i">ReportIncompleteInput</span>(
                    <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r511 r">enumToken</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingNameAfterKeyword</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingNameAfterKeyword</span>,
                    <span class="r511 r">enumToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<span class="r511 r">enumToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
            }
 
            <a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a> <span id="r514 rd" class="r514 r">underlyingTypeConstraint</span> = <b>null</b>;
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r515 rd" class="r515 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#2dcac73d38701d80" class="i field">Signature</a>);
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r516 rd" class="r516 r">colonToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r516 r">colonToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a3c2c007e625be62" class="i field">Colon</a>)
                {
                    <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <a href="ast.cs.html#a422e1772da6dbc8" class="t t">ITypeName</a> <span id="r517 rd" class="r517 r">underlyingType</span>;
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r518 rd" class="r518 r">unused</span>;
                    <span class="r517 r">underlyingType</span> = <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#94ecdfa0b8f28cd7" class="i method">TypeNameRule</a>(<span class="r50 r">allowAssemblyQualifiedNames</span>: <b>false</b>, <span class="r51 r">firstTypeNameToken</span>: <b>out</b> <span class="r518 r">unused</span>);
                    <b>if</b> (<span class="r517 r">underlyingType</span> == <b>null</b>)
                    {
                        <span class="i">ReportIncompleteInput</span>(
                            <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r516 r">colonToken</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">TypeNameExpected</span>),
                            <span class="i">ParserStrings</span>.<span class="i">TypeNameExpected</span>);
                    }
                    <b>else</b>
                    {
                        <b>var</b> <span id="r519 rd" class="r519 r">resolvedType</span> = <span class="r517 r">underlyingType</span>.<a href="ast.cs.html#eba83ef9fd0feedd" class="i method">GetReflectionType</a>();
                        <b>if</b> (<span class="r519 r">resolvedType</span> == <b>null</b> || !<span class="r512 r">ValidUnderlyingTypeCodes</span>.<span class="i">HasFlag</span>(<span class="r519 r">resolvedType</span>.<span class="i">GetTypeCode</span>()))
                        {
                            <span class="i">ReportError</span>(
                                <span class="r517 r">underlyingType</span>.<a href="ast.cs.html#2b8e897172d31016" class="i property">Extent</a>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidUnderlyingType</span>),
                                <span class="i">ParserStrings</span>.<span class="i">InvalidUnderlyingType</span>,
                                <span class="r517 r">underlyingType</span>.<a href="ast.cs.html#d299e8e1674e18ab" class="i property">Name</a>);
                        }
                        <span class="r514 r">underlyingTypeConstraint</span> = <b>new</b> <a href="ast.cs.html#51c2fb9bdf674fb1" class="t constructor">TypeConstraintAst</a>(<span class="r517 r">underlyingType</span>.<a href="ast.cs.html#2b8e897172d31016" class="i property">Extent</a>, <span class="r517 r">underlyingType</span>);
                    }
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r520 rd" class="r520 r">lCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r520 r">lCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>)
                {
                    <span class="c">// ErrorRecovery: If there is no opening curly, assume it hasn&#39;t been entered yet and don&#39;t consume anything.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r520 r">lCurly</span>);
                    <span class="i">ReportIncompleteInput</span>(
                        <a href="#40407f0b4b50ace7" class="i method">After</a>(<span class="r513 r">name</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingTypeBody</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingTypeBody</span>,
                        <span class="r511 r">enumToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                    <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r511 r">enumToken</span>, <span class="r513 r">name</span>));
                }
 
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r521 rd" class="r521 r">lastExtent</span> = <span class="r520 r">lCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <a href="ast.cs.html#6092492a0585632c" class="t t">MemberAst</a> <span id="r522 rd" class="r522 r">member</span>;
                <span class="i">List</span>&lt;<a href="ast.cs.html#6092492a0585632c" class="t t">MemberAst</a>&gt; <span id="r523 rd" class="r523 r">members</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#6092492a0585632c" class="t t">MemberAst</a>&gt;();
                <b>while</b> ((<span class="r522 r">member</span> = <a href="#076334b9cc434e53" class="i method">EnumMemberRule</a>()) != <b>null</b>)
                {
                    <span class="r523 r">members</span>.<span class="i">Add</span>(<span class="r522 r">member</span>);
                    <span class="r521 r">lastExtent</span> = <span class="r522 r">member</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                }
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r524 rd" class="r524 r">rCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r524 r">rCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>)
                {
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r524 r">rCurly</span>);
                    <span class="i">ReportIncompleteInput</span>(
                        <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r520 r">lCurly</span>),
                        <span class="r524 r">rCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndCurlyBrace</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingEndCurlyBrace</span>);
                }
 
                <b>var</b> <span id="r525 rd" class="r525 r">startExtent</span> = <span class="r510 r">customAttributes</span> != <b>null</b> &amp;&amp; <span class="r510 r">customAttributes</span>.<span class="i">Count</span> &gt; 0
                                          ? <span class="r510 r">customAttributes</span>[0].<span class="i">Extent</span>
                                          : <span class="r511 r">enumToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                <a href="Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r526 rd" class="r526 r">extent</span> = <span class="i">ExtentOf</span>(<span class="r525 r">startExtent</span>, <span class="r524 r">rCurly</span>);
                <a href="ast.cs.html#d7f0bc21c0f10879" class="k">var</a> <span id="r527 rd" class="r527 r">enumDefn</span> = <b>new</b> <span class="t">TypeDefinitionAst</span>(<span class="r526 r">extent</span>, <span class="r513 r">name</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <span class="r510 r">customAttributes</span>?.<span class="i">OfType</span>&lt;<a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>&gt;(), <span class="r523 r">members</span>, <a href="ast.cs.html#b246aec2982cbe0e" class="t t">TypeAttributes</a>.<a href="ast.cs.html#ed298c43d5bc1d4b" class="i field">Enum</a>, <span class="r514 r">underlyingTypeConstraint</span> == <b>null</b> ? <b>null</b> : <b>new</b>[] { <span class="r514 r">underlyingTypeConstraint</span> });
                <b>if</b> (<span class="r510 r">customAttributes</span> != <b>null</b> &amp;&amp; <span class="r510 r">customAttributes</span>.<span class="i">OfType</span>&lt;<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;().<span class="i">Any</span>())
                {
                    <span class="c">// No need to report error since there is error reported in method StatementRule</span>
                    <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt; <span id="r528 rd" class="r528 r">nestedAsts</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;();
                    <span class="r528 r">nestedAsts</span>.<span class="i">AddRange</span>(<span class="r510 r">customAttributes</span>.<span class="i">OfType</span>&lt;<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;());
                    <span class="r528 r">nestedAsts</span>.<span class="i">Add</span>(<span class="r527 r">enumDefn</span>);
                    <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<span class="r525 r">startExtent</span>, <span class="r528 r">nestedAsts</span>);
                }
 
                <b>return</b> <span class="r527 r">enumDefn</span>;
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r515 r">oldTokenizerMode</span>);
            }
        }
 
        <b>private</b> <a href="ast.cs.html#6092492a0585632c" class="t t">MemberAst</a> <a id="076334b9cc434e53" href="../../R/076334b9cc434e53.html" target="n" data-glyph="76,1" class="i method">EnumMemberRule</a>()
        {
            <span class="c">// G  enum-member:</span>
            <span class="c">// G      enum-member-name</span>
            <span class="c">// G      enum-member-name  &#39;=&#39;  expression</span>
            <span class="c">// G</span>
            <span class="c">// G  enum-member-name:</span>
            <span class="c">// G      simple-name</span>
 
            <b>const</b> <a href="ast.cs.html#003cbc0806eaf107" class="t t">PropertyAttributes</a> <span id="r529 rd" class="r529 r">enumMemberAttributes</span> =
                <a href="ast.cs.html#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="ast.cs.html#b2401842fad0b17e" class="i field">Public</a> | <a href="ast.cs.html#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="ast.cs.html#43f6609d852582fe" class="i field">Static</a> | <a href="ast.cs.html#003cbc0806eaf107" class="t t">PropertyAttributes</a>.<a href="ast.cs.html#743cc7ba3d819534" class="i field">Literal</a>;
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r530 rd" class="r530 r">enumeratorName</span> = <a href="#942135886d841ed5" class="i method">SimpleNameRule</a>();
            <b>if</b> (<span class="r530 r">enumeratorName</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r531 rd" class="r531 r">endExtent</span> = <span class="r530 r">enumeratorName</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r532 rd" class="r532 r">initialValueAst</span> = <b>null</b>;
            <b>var</b> <span id="r533 rd" class="r533 r">missingInitializer</span> = <b>false</b>;
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r534 rd" class="r534 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r535 rd" class="r535 r">assignToken</span> = <b>null</b>;
            <b>try</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#9b6269e007d113c3" class="i field">Expression</a>);
                <span class="r535 r">assignToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r535 r">assignToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d78e08594ff6b79a" class="i field">Equals</a>)
                {
                    <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                    <span class="r532 r">initialValueAst</span> = <a href="#8da955af7d659a21" class="i method">ExpressionRule</a>();
                    <b>if</b> (<span class="r532 r">initialValueAst</span> == <b>null</b>)
                    {
                        <span class="i">ReportError</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r535 r">assignToken</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ExpectedValueExpression</span>),
                            <span class="i">ParserStrings</span>.<span class="i">ExpectedValueExpression</span>,
                            <span class="r535 r">assignToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                        <span class="r531 r">endExtent</span> = <span class="r535 r">assignToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                        <span class="r533 r">missingInitializer</span> = <b>true</b>;
                    }
                    <b>else</b>
                    {
                        <span class="r531 r">endExtent</span> = <span class="r532 r">initialValueAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                    }
                }
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r534 r">oldTokenizerMode</span>);
            }
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r536 rd" class="r536 r">terminatorToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <b>if</b> (<span class="r536 r">terminatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a> &amp;&amp; <span class="r536 r">terminatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a> &amp;&amp; <span class="r536 r">terminatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>)
            {
                <span class="c">// If the initializer is missing, no sense in reporting another error about a missing terminator</span>
                <b>if</b> (!<span class="r533 r">missingInitializer</span>)
                {
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r531 r">endExtent</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingPropertyTerminator</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingPropertyTerminator</span>);
                }
            }
 
            <a href="#20cf6d6d776dad25" class="i method">SkipNewlinesAndSemicolons</a>();
 
            <span class="c">// Include the semicolon in the extent but not newline or rcurly as that will look weird, e.g. if an error is reported on the full extent</span>
            <b>if</b> (<span class="r536 r">terminatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>)
            {
                <span class="r531 r">endExtent</span> = <span class="r536 r">terminatorToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
            }
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#13db239495d63d20" class="t constructor">PropertyMemberAst</a>(<a href="#a571f93282f04222" class="i method">ExtentOf</a>(<span class="r530 r">enumeratorName</span>, <span class="r531 r">endExtent</span>), <span class="r530 r">enumeratorName</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>, <b>null</b>, <b>null</b>, <span class="r529 r">enumMemberAttributes</span>, <span class="r532 r">initialValueAst</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="45244f65958da4bb" href="../../R/45244f65958da4bb.html" target="n" data-glyph="76,1" class="i method">UsingStatementRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r537 rd" class="r537 r">usingToken</span>)
        {
            <span class="c">// G  using-statement:</span>
            <span class="c">// G      &#39;using&#39;   &#39;namespace&#39;   identifier</span>
            <span class="c">// G      &#39;using&#39;   &#39;namespace&#39;   identifier   &#39;=&#39;   identifier</span>
            <span class="c">// G      &#39;using&#39;   &#39;module&#39;   identifier</span>
            <span class="c">// G      &#39;using&#39;   &#39;module&#39;   identifier   &#39;=&#39;   identifier</span>
            <span class="c">// G      &#39;using&#39;   &#39;module&#39;   hashtable</span>
            <span class="c">// G      &#39;using&#39;   &#39;module&#39;   identifier   &#39;=&#39;   hashtable</span>
            <span class="c">// G      &#39;using&#39;   &#39;type&#39;   identifier   &#39;=&#39;   identifier</span>
            <span class="c">// G      &#39;using&#39;   &#39;assembly&#39;   identifier</span>
            <span class="c">// G      &#39;using&#39;   &#39;command&#39;   identifier   &#39;=&#39;   identifier</span>
 
            <span class="c">// in case of aliasing (=), first identifier is alias name, second identifier is alias value (the real name).</span>
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r538 rd" class="r538 r">directiveToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
 
            <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a> <span id="r539 rd" class="r539 r">kind</span>;
            <b>bool</b> <span id="r540 rd" class="r540 r">aliasAllowed</span> = <b>false</b>;
            <b>bool</b> <span id="r541 rd" class="r541 r">aliasRequired</span> = <b>false</b>;
            <b>switch</b> (<span class="r538 r">directiveToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
            {
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#015fb9772cac6b50" class="i field">Namespace</a>:
                    <span class="r539 r">kind</span> = <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#8c39b25da17c5e31" class="i field">Namespace</a>;
                    <span class="r540 r">aliasAllowed</span> = <b>true</b>;
                    <b>break</b>;
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d9216d9794ad2d67" class="i field">Type</a>:
                    <span class="r539 r">kind</span> = <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#32e92208f14046ce" class="i field">Type</a>;
                    <span class="r541 r">aliasRequired</span> = <b>true</b>;
                    <b>break</b>;
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#28e33e1e928d8428" class="i field">Module</a>:
                    <span class="r539 r">kind</span> = <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#4e97afe747960a96" class="i field">Module</a>;
                    <span class="r540 r">aliasAllowed</span> = <b>true</b>;
                    <b>break</b>;
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#024a39a4c23da230" class="i field">Command</a>:
                    <span class="r539 r">kind</span> = <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#68fe72ea611e4f8d" class="i field">Command</a>;
                    <span class="r541 r">aliasRequired</span> = <b>true</b>;
                    <b>break</b>;
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4369a9b7ca950fe3" class="i field">Assembly</a>:
                    <span class="r539 r">kind</span> = <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#98acf874996a057c" class="i field">Assembly</a>;
                    <b>break</b>;
 
                <b>default</b>:
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r538 r">directiveToken</span>);
                    <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r537 r">usingToken</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingUsingStatementDirective</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingUsingStatementDirective</span>);
                    <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<span class="r537 r">usingToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
            }
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r542 rd" class="r542 r">itemToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>switch</b> (<span class="r542 r">itemToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
            {
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a>:
                <span class="c">// Example: &#39;using module ,exampleModuleName&#39;</span>
                <span class="c">// GetCommandArgument will successfully return an argument for a unary array argument</span>
                <span class="c">// but we don&#39;t want to allow that syntax with a using statement.</span>
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>:
                    {
                        <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r538 r">directiveToken</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingUsingItemName</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingUsingItemName</span>);
                        <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r537 r">usingToken</span>, <span class="r538 r">directiveToken</span>));
                    }
            }
 
            <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r543 rd" class="r543 r">itemAst</span> = <a href="#b230abe7ca3d2b4e" class="i method">GetCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#87392123862baf4c" class="i field">CommandArgument</a>, <span class="r542 r">itemToken</span>);
            <b>if</b> (<span class="r543 r">itemAst</span> == <b>null</b>)
            {
                <span class="i">ReportError</span>(<span class="r542 r">itemToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidValueForUsingItemName</span>),
                    <span class="i">ParserStrings</span>.<span class="i">InvalidValueForUsingItemName</span>,
                    <span class="r542 r">itemToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                <span class="c">// ErrorRecovery: If there is no identifier, skip whole &#39;using&#39; line</span>
                <a href="#e51058c98956995e" class="i method">SyncOnError</a>(<b>true</b>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a>);
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r537 r">usingToken</span>, <span class="r542 r">itemToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
            }
 
            <b>if</b> (<span class="r543 r">itemAst</span> <b>is not</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>
                &amp;&amp; (<span class="r539 r">kind</span> != <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#4e97afe747960a96" class="i field">Module</a> || <span class="r543 r">itemAst</span> <b>is not</b> <a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a>))
            {
                <span class="i">ReportError</span>(<a href="#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r543 r">itemAst</span>, <span class="r542 r">itemToken</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidValueForUsingItemName</span>),
                    <span class="i">ParserStrings</span>.<span class="i">InvalidValueForUsingItemName</span>,
                    <span class="r543 r">itemAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#43ce932d9225bc9c" class="i property">Text</a>);
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r537 r">usingToken</span>, <a href="#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r543 r">itemAst</span>, <span class="r542 r">itemToken</span>)));
            }
 
            <a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a> <span id="r544 rd" class="r544 r">htAst</span> = <b>null</b>;
            <b>switch</b> (<span class="r539 r">kind</span>)
            {
                <b>case</b> <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#98acf874996a057c" class="i field">Assembly</a>:
                    <span class="r543 r">itemAst</span> = <a href="#c4b294bb60b07872" class="i method">ResolveUsingAssembly</a>((<a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)<span class="r543 r">itemAst</span>);
                    <b>break</b>;
                <b>case</b> <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#4e97afe747960a96" class="i field">Module</a>:
                    <span class="r544 r">htAst</span> = <span class="r543 r">itemAst</span> <b>as</b> <a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a>;
                    <b>break</b>;
            }
 
            <span class="c">// if htAst is not null, then we don&#39;t expect alias</span>
            <b>if</b> ((<span class="r540 r">aliasAllowed</span> || <span class="r541 r">aliasRequired</span>) &amp;&amp; (<span class="r544 r">htAst</span> == <b>null</b>))
            {
                <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r545 rd" class="r545 r">equalsToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r545 r">equalsToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d78e08594ff6b79a" class="i field">Equals</a>)
                {
                    <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
 
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r546 rd" class="r546 r">aliasToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                    <b>if</b> (<span class="r546 r">aliasToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
                    {
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r546 r">aliasToken</span>);
                        <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r545 r">equalsToken</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingNamespaceAlias</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingNamespaceAlias</span>);
                        <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r537 r">usingToken</span>, <span class="r545 r">equalsToken</span>));
                    }
 
                    <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r547 rd" class="r547 r">aliasAst</span> = <a href="#b230abe7ca3d2b4e" class="i method">GetCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#87392123862baf4c" class="i field">CommandArgument</a>, <span class="r546 r">aliasToken</span>);
                    <b>if</b> (<span class="r539 r">kind</span> == <a href="ast.cs.html#0837a04517723905" class="t t">UsingStatementKind</a>.<a href="ast.cs.html#4e97afe747960a96" class="i field">Module</a> &amp;&amp; <span class="r547 r">aliasAst</span> <b>is</b> <a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a>)
                    {
                        <span class="r544 r">htAst</span> = (<a href="ast.cs.html#fd6e450f68cfd52b" class="t t">HashtableAst</a>)<span class="r547 r">aliasAst</span>;
                    }
                    <b>else</b> <b>if</b> (<span class="r547 r">aliasAst</span> <b>is not</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)
                    {
                        <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r537 r">usingToken</span>, <span class="r547 r">aliasAst</span>), <b>new</b> <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>[] { <span class="r543 r">itemAst</span>, <span class="r547 r">aliasAst</span> });
                    }
 
                    <a href="#236208528ac56c21" class="i method">RequireStatementTerminator</a>();
 
                    <b>if</b> (<span class="r544 r">htAst</span> == <b>null</b>)
                    {
                        <b>return</b> <b>new</b> <a href="ast.cs.html#8707b54e786c43b3" class="t constructor">UsingStatementAst</a>(
                            <a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r537 r">usingToken</span>, <span class="r546 r">aliasToken</span>),
                            <span class="r539 r">kind</span>,
                            (<a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)<span class="r543 r">itemAst</span>,
                            (<a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)<span class="r547 r">aliasAst</span>);
                    }
                    <b>else</b>
                    {
                        <b>return</b> <b>new</b> <a href="ast.cs.html#4522b0f6bef6dd2b" class="t constructor">UsingStatementAst</a>(
                            <a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r537 r">usingToken</span>, <span class="r546 r">aliasToken</span>),
                            (<a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)<span class="r543 r">itemAst</span>,
                            <span class="r544 r">htAst</span>);
                    }
                }
 
                <b>if</b> (<span class="r541 r">aliasRequired</span>)
                {
                    <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r542 r">itemToken</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEqualsInUsingAlias</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingEqualsInUsingAlias</span>);
                    <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r537 r">usingToken</span>, <span class="r543 r">itemAst</span>), <b>new</b> <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>[] { <span class="r543 r">itemAst</span> });
                }
            }
 
            <a href="#236208528ac56c21" class="i method">RequireStatementTerminator</a>();
 
            <b>if</b> (<span class="r544 r">htAst</span> == <b>null</b>)
            {
                <b>return</b> <b>new</b> <a href="ast.cs.html#4108c0236bff4485" class="t constructor">UsingStatementAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r537 r">usingToken</span>, <span class="r543 r">itemAst</span>), <span class="r539 r">kind</span>, (<a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a>)<span class="r543 r">itemAst</span>);
            }
            <b>else</b>
            {
                <b>return</b> <b>new</b> <a href="ast.cs.html#07320bfb632893ad" class="t constructor">UsingStatementAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r537 r">usingToken</span>, <span class="r543 r">itemAst</span>), <span class="r544 r">htAst</span>);
            }
        }
 
        <b>private</b> <a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <a id="c4b294bb60b07872" href="../../R/c4b294bb60b07872.html" target="n" data-glyph="76,1" class="i method">ResolveUsingAssembly</a>(<a href="ast.cs.html#e18e1bad255cd022" class="t t">StringConstantExpressionAst</a> <span id="r548 rd" class="r548 r">name</span>)
        {
            <b>var</b> <span id="r549 rd" class="r549 r">assemblyName</span> = <span class="r548 r">name</span>.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>;
            <span class="i">Uri</span> <span id="r550 rd" class="r550 r">uri</span>;
            <span class="c">// assemblyName can be invalid, i.e. during typing.</span>
            <span class="c">// We only use uri to check that we don&#39;t allow UNC paths.</span>
            <b>if</b> (<span class="i">Uri</span>.<span class="i">TryCreate</span>(<span class="r549 r">assemblyName</span>, <span class="i">UriKind</span>.<span class="i">Absolute</span>, <b>out</b> <span class="r550 r">uri</span>))
            {
                <b>if</b> (<span class="r550 r">uri</span>.<span class="i">IsUnc</span>)
                {
                    <span class="i">ReportError</span>(<span class="r548 r">name</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">CannotLoadAssemblyFromUncPath</span>),
                        <span class="i">ParserStrings</span>.<span class="i">CannotLoadAssemblyFromUncPath</span>,
                        <span class="r549 r">assemblyName</span>);
                }
 
                <span class="c">// don&#39;t allow things like &#39;using assembly http://microsoft.com&#39;</span>
                <b>if</b> (<span class="r550 r">uri</span>.<span class="i">Scheme</span> != <span class="s">&quot;file&quot;</span>)
                {
                    <span class="i">ReportError</span>(<span class="r548 r">name</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">CannotLoadAssemblyWithUriSchema</span>),
                        <span class="i">ParserStrings</span>.<span class="i">CannotLoadAssemblyWithUriSchema</span>,
                        <span class="r550 r">uri</span>.<span class="i">Scheme</span>);
                }
            }
            <b>else</b>
            {
                <b>string</b> <span id="r551 rd" class="r551 r">assemblyFileName</span> = <span class="r549 r">assemblyName</span>;
                <b>try</b>
                {
                    <b>var</b> <span id="r552 rd" class="r552 r">scriptFileName</span> = <span class="r548 r">name</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#e933edecd2b0cc1d" class="i property">File</a>;
                    <b>if</b> (!<span class="i">Path</span>.<span class="i">IsPathRooted</span>(<span class="r551 r">assemblyFileName</span>))
                    {
                        <b>string</b> <span id="r553 rd" class="r553 r">workingDirectory</span>;
                        <b>if</b> (<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r552 r">scriptFileName</span>))
                        {
                            <span class="c">// We are in REPL, or Invoke-Expression, or ScriptBlock.Create, etc.</span>
                            <span class="c">// It&#39;s legal to use &#39;.\foo.dll&#39;, and we should do lookup in $pwd.</span>
                            <span class="c">// We resolving it in parse time to avoid difference in script behavior,</span>
                            <span class="c">// when script execution is delayed from parsing, i.e.</span>
                            <span class="c">// $script = [scriptblock]::Create(&#39;using assembly .\foo.dll; [Foo].foo()&#39;)</span>
                            <span class="c">// # using assembly behavior should be the same in these two cases:</span>
                            <span class="c">// cd A; $script.Invoke()</span>
                            <span class="c">// cd B; $script.Invoke()</span>
                            <b>if</b> (<span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a> != <b>null</b>)
                            {
                                <span class="r553 r">workingDirectory</span> = <span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>.<a href="../hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>.<a href="../ExecutionContext.cs.html#27c4e82ba7216ff8" class="i property">EngineIntrinsics</a>.<a href="../EngineIntrinsics.cs.html#73254f4142672190" class="i property">SessionState</a>.<a href="../SessionStatePublic.cs.html#3390cfbbdcffb036" class="i property">Path</a>.<a href="../PathInterfaces.cs.html#91ffa5f8fc6b1308" class="i property">CurrentLocation</a>.<a href="../../namespaces/PathInfo.cs.html#de00cd47bf0cf721" class="i property">Path</a>;
                            }
                            <b>else</b>
                            {
                                <span class="c">// In this case, our best guess is process working directory.</span>
                                <span class="r553 r">workingDirectory</span> = <span class="i">Directory</span>.<span class="i">GetCurrentDirectory</span>();
                            }
                        }
                        <b>else</b>
                        {
                            <span class="r553 r">workingDirectory</span> = <span class="i">Path</span>.<span class="i">GetDirectoryName</span>(<span class="r552 r">scriptFileName</span>);
                        }
 
                        <span class="r551 r">assemblyFileName</span> = <span class="r553 r">workingDirectory</span> + <span class="s">@&quot;\&quot;</span> + <span class="r551 r">assemblyFileName</span>;
                    }
 
<span class="k preprocess">#</span><span class="k preprocess">if</span> !<span class="i">CORECLR</span>
<span class="e">                    if (!File.Exists(assemblyFileName))
                    {
                        GlobalAssemblyCache.ResolvePartialName(assemblyName, out assemblyFileName);
                    }
</span><span class="k preprocess">#</span><span class="k preprocess">endif</span>
                }
                <b>catch</b>
                {
                }
 
                <b>if</b> (<span class="r551 r">assemblyFileName</span> == <b>null</b> || !<span class="i">File</span>.<span class="i">Exists</span>(<span class="r551 r">assemblyFileName</span>))
                {
                    <span class="i">ReportError</span>(<span class="r548 r">name</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ErrorLoadingAssembly</span>),
                        <span class="i">ParserStrings</span>.<span class="i">ErrorLoadingAssembly</span>,
                        <span class="r549 r">assemblyName</span>);
                }
                <b>else</b>
                {
                    <b>return</b> <b>new</b> <a href="ast.cs.html#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r548 r">name</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r551 r">assemblyFileName</span>, <span class="r548 r">name</span>.<a href="ast.cs.html#de305f3ed8002148" class="i property">StringConstantType</a>);
                }
            }
 
            <b>return</b> <span class="r548 r">name</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="e9bec71d7d4d4fd8" href="../../R/e9bec71d7d4d4fd8.html" target="n" data-glyph="76,1" class="i method">MethodDeclarationRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r554 rd" class="r554 r">functionNameToken</span>, <b>string</b> <span id="r555 rd" class="r555 r">className</span>, <b>bool</b> <span id="r556 rd" class="r556 r">isStaticMethod</span>)
        {
            <span class="c">// G  method-statement:</span>
            <span class="c">// G      new-lines:opt   function-name   function-parameter-declaration   base-ctor-call:opt  &#39;{&#39;   script-block   &#39;}&#39;</span>
            <span class="c">// G</span>
            <span class="c">// G  base-ctor-call: // can be present only if function-name == className</span>
            <span class="c">// G      &#39;:&#39;    new-lines:opt   &#39;base&#39;   new-lines:opt   parenthesized-expression   new-lines:opt</span>
            <span class="c">// G</span>
            <span class="c">// G  function-name:</span>
            <span class="c">// G      command-argument</span>
 
            <b>var</b> <span id="r557 rd" class="r557 r">functionName</span> = <span class="r554 r">functionNameToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>;
            <span class="i">List</span>&lt;<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <span id="r558 rd" class="r558 r">parameters</span>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r559 rd" class="r559 r">lParen</span> = <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r560 rd" class="r560 r">endErrorStatement</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r561 rd" class="r561 r">rParen</span> = <b>null</b>;
 
            <b>if</b> (<span class="r559 r">lParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>)
            {
                <span class="r558 r">parameters</span> = <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#dfa3b2cbc7d020a3" class="i method">FunctionParameterDeclarationRule</a>(<b>out</b> <span class="r560 r">endErrorStatement</span>, <b>out</b> <span class="r561 r">rParen</span>);
            }
            <b>else</b>
            {
                <a href="#bbf5e856fb3215c5" class="k">this</a>.<span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r554 r">functionNameToken</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingMethodParameterList</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingMethodParameterList</span>);
                <span class="r558 r">parameters</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt;();
            }
 
            <b>bool</b> <span id="r562 rd" class="r562 r">isCtor</span> = <span class="r557 r">functionName</span>.<span class="i">Equals</span>(<span class="r555 r">className</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>);
            <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r563 rd" class="r563 r">baseCtorCallParams</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r564 rd" class="r564 r">baseToken</span> = <b>null</b>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r565 rd" class="r565 r">baseCallLastExtent</span> = <b>null</b>;
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a> <span id="r566 rd" class="r566 r">oldTokenizerMode</span>;
            <b>if</b> (<span class="r562 r">isCtor</span> &amp;&amp; !<span class="r556 r">isStaticMethod</span>)
            {
                <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r566 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
                <b>try</b>
                {
                    <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#2dcac73d38701d80" class="i field">Signature</a>);
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r567 rd" class="r567 r">colonToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                    <b>if</b> (<span class="r567 r">colonToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a3c2c007e625be62" class="i field">Colon</a>)
                    {
                        <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                        <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                        <span class="r564 r">baseToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                        <b>if</b> (<span class="r564 r">baseToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d50e353dd6e40631" class="i field">Base</a>)
                        {
                            <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                            <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                            <span class="r559 r">lParen</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                            <b>if</b> (<span class="r559 r">lParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>)
                            {
                                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                                <span class="c">// we don&#39;t allow syntax</span>
                                <span class="c">// : base{ script }</span>
                                <span class="c">// as a short for for</span>
                                <span class="c">// : base( { script } )</span>
                                <span class="r563 r">baseCtorCallParams</span> = <a href="#b2cf3f2831888cd8" class="i method">InvokeParamParenListRule</a>(<span class="r559 r">lParen</span>, <b>out</b> <span class="r565 r">baseCallLastExtent</span>);
                                <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                            }
                            <b>else</b>
                            {
                                <span class="r560 r">endErrorStatement</span> = <span class="r564 r">baseToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                                <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r564 r">baseToken</span>),
                                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingMethodParameterList</span>),
                                    <span class="i">ParserStrings</span>.<span class="i">MissingMethodParameterList</span>);
                            }
                        }
                        <b>else</b>
                        {
                            <span class="r560 r">endErrorStatement</span> = <span class="r567 r">colonToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                            <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r567 r">colonToken</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingBaseCtorCall</span>),
                                <span class="i">ParserStrings</span>.<span class="i">MissingBaseCtorCall</span>);
                        }
                    }
                }
                <b>finally</b>
                {
                    <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r566 r">oldTokenizerMode</span>);
                }
 
                <b>if</b> (<span class="r563 r">baseCtorCallParams</span> == <b>null</b>)
                {
                    <span class="c">// Assuming implicit default ctor</span>
                    <span class="r563 r">baseCtorCallParams</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;();
                }
            }
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r568 rd" class="r568 r">lCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r568 r">lCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>)
            {
                <span class="c">// ErrorRecovery: If there is no opening curly, assume it hasn&#39;t been entered yet and don&#39;t consume anything.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r568 r">lCurly</span>);
                <b>if</b> (<span class="r560 r">endErrorStatement</span> == <b>null</b>)
                {
                    <span class="r560 r">endErrorStatement</span> = <a href="#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r561 r">rParen</span>, <span class="r554 r">functionNameToken</span>);
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r560 r">endErrorStatement</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingFunctionBody</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingFunctionBody</span>);
                }
            }
 
            <b>if</b> (<span class="r560 r">endErrorStatement</span> != <b>null</b>)
            {
                <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r554 r">functionNameToken</span>, <span class="r560 r">endErrorStatement</span>), <span class="r558 r">parameters</span>);
            }
 
            <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r569 rd" class="r569 r">baseCtorCallStatement</span> = <b>null</b>;
            <b>if</b> (<span class="r562 r">isCtor</span> &amp;&amp; !<span class="r556 r">isStaticMethod</span>)
            {
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r570 rd" class="r570 r">baseCallExtent</span>;
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r571 rd" class="r571 r">baseKeywordExtent</span>;
                <b>if</b> (<span class="r564 r">baseToken</span> != <b>null</b>)
                {
                    <span class="r570 r">baseCallExtent</span> = <a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r564 r">baseToken</span>, <span class="r565 r">baseCallLastExtent</span>);
                    <span class="r571 r">baseKeywordExtent</span> = <span class="r564 r">baseToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                }
                <b>else</b>
                {
                    <span class="r570 r">baseCallExtent</span> = <a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>;
                    <span class="r571 r">baseKeywordExtent</span> = <a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>;
                }
 
                <a href="ast.cs.html#93dc2e4429de8e4e" class="k">var</a> <span id="r572 rd" class="r572 r">invokeMemberAst</span> = <b>new</b> <span class="t">BaseCtorInvokeMemberExpressionAst</span>(<span class="r571 r">baseKeywordExtent</span>, <span class="r570 r">baseCallExtent</span>, <span class="r563 r">baseCtorCallParams</span>);
                <span class="r569 r">baseCtorCallStatement</span> = <b>new</b> <a href="ast.cs.html#cdb6db10eccdfa97" class="t constructor">CommandExpressionAst</a>(<span class="r572 r">invokeMemberAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r572 r">invokeMemberAst</span>, <b>null</b>);
            }
 
            <span class="r566 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#d9f88bf7436b84df" class="i field">Command</a>);
                <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r573 rd" class="r573 r">scriptBlock</span> = <a href="#305d86f1b6248e31" class="i method">ScriptBlockRule</a>(<span class="r568 r">lCurly</span>, <b>false</b>, <span class="r569 r">baseCtorCallStatement</span>);
                <a href="ast.cs.html#dd61b2a7b388405b" class="k">var</a> <span id="r574 rd" class="r574 r">result</span> = <b>new</b> <span class="t">FunctionDefinitionAst</span>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r554 r">functionNameToken</span>, <span class="r573 r">scriptBlock</span>),
                    <span class="c">/*isFilter:*/</span><b>false</b>, <span class="c">/*isWorkflow:*/</span><b>false</b>, <span class="r554 r">functionNameToken</span>, <span class="r558 r">parameters</span>, <span class="r573 r">scriptBlock</span>);
 
                <b>return</b> <span class="r574 r">result</span>;
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r566 r">oldTokenizerMode</span>);
            }
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="e1dd5b49bc9d01a5" href="../../R/e1dd5b49bc9d01a5.html" target="n" data-glyph="76,1" class="i method">FunctionDeclarationRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r575 rd" class="r575 r">functionToken</span>)
        {
            <span class="c">// G  function-statement:</span>
            <span class="c">// G      &#39;function&#39;   new-lines:opt   function-name   function-parameter-declaration:opt   &#39;{&#39;   script-block   &#39;}&#39;</span>
            <span class="c">// G      &#39;filter&#39;   new-lines:opt   function-name   function-parameter-declaration:opt   &#39;{&#39;   script-block   &#39;}&#39;</span>
            <span class="c">// G      &#39;workflow&#39;   new-lines:opt   function-name   function-parameter-declaration:opt   &#39;{&#39;   script-block   &#39;}&#39;</span>
            <span class="c">// G</span>
            <span class="c">// G  function-name:</span>
            <span class="c">// G      command-argument</span>
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r576 rd" class="r576 r">functionNameToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>switch</b> (<span class="r576 r">functionNameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
            {
                <span class="c">// The following are not allowed as function names, anything else is allowed:</span>
                <span class="c">// The general rule is - punctuators and unary operators are not allowed</span>
                <span class="c">// We want to allow as much as reasonably possible, e.g. if it could be a</span>
                <span class="c">// valid command name, we want to allow it with very limited exceptions.</span>
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f09193da35fa965b" class="i field">Pipe</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#cf388c7cb0667161" class="i field">AtParen</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ad46aed3b80ba825" class="i field">AtCurly</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e5f4f5a7b13ffa10" class="i field">Redirection</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#2af5a1104a333244" class="i field">RedirectInStd</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#074f3be81f88796f" class="i field">AndAnd</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a07cbb74e75a87a" class="i field">OrOr</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ed112ae477a73c36" class="i field">Ampersand</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8b5a9c54e2029553" class="i field">Variable</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4fc017e5ff76f173" class="i field">SplattedVariable</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b3843759239f0c51" class="i field">HereStringExpandable</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a6a2bdb661c2a296" class="i field">HereStringLiteral</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#0c560abdae080116" class="i field">StringLiteral</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4e0d26e8d7050abc" class="i field">StringExpandable</a>:
                    <span class="c">// ErrorRecovery: Don&#39;t continue, assume the function isn&#39;t there yet.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r576 r">functionNameToken</span>);
                    <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r575 r">functionToken</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingNameAfterKeyword</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingNameAfterKeyword</span>,
                        <span class="r575 r">functionToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                    <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<span class="r575 r">functionToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
            }
 
            <span class="c">// A function name that matches a keyword isn&#39;t really a keyword, so don&#39;t color it that way</span>
            <span class="r576 r">functionNameToken</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> &amp;= ~<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#bffc83c32a1428ea" class="i field">Keyword</a>;
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r577 rd" class="r577 r">endErrorStatement</span>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r578 rd" class="r578 r">rParen</span>;
            <b>var</b> <span id="r579 rd" class="r579 r">parameters</span> = <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#dfa3b2cbc7d020a3" class="i method">FunctionParameterDeclarationRule</a>(<b>out</b> <span class="r577 r">endErrorStatement</span>, <b>out</b> <span class="r578 r">rParen</span>);
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r580 rd" class="r580 r">lCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r580 r">lCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>)
            {
                <span class="c">// ErrorRecovery: If there is no opening curly, assume it hasn&#39;t been entered yet and don&#39;t consume anything.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r580 r">lCurly</span>);
                <b>if</b> (<span class="r577 r">endErrorStatement</span> == <b>null</b>)
                {
                    <span class="r577 r">endErrorStatement</span> = <a href="#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r578 r">rParen</span>, <span class="r576 r">functionNameToken</span>);
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r577 r">endErrorStatement</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingFunctionBody</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingFunctionBody</span>);
                }
            }
 
            <b>if</b> (<span class="r577 r">endErrorStatement</span> != <b>null</b>)
            {
                <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r575 r">functionToken</span>, <span class="r577 r">endErrorStatement</span>), <span class="r579 r">parameters</span>);
            }
 
            <b>bool</b> <span id="r581 rd" class="r581 r">isFilter</span> = <span class="r575 r">functionToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#52136afaad8df2b6" class="i field">Filter</a>;
            <b>bool</b> <span id="r582 rd" class="r582 r">isWorkflow</span> = <span class="r575 r">functionToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#99d9163a866a9433" class="i field">Workflow</a>;
 
            <b>bool</b> <span id="r583 rd" class="r583 r">oldTokenizerWorkflowContext</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#73ba79aabc0d9f2b" class="i property">InWorkflowContext</a>;
            <b>try</b>
            {
                <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#73ba79aabc0d9f2b" class="i property">InWorkflowContext</a> = <span class="r582 r">isWorkflow</span>;
 
                <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r584 rd" class="r584 r">scriptBlock</span> = <a href="#41a9f47c78b86651" class="i method">ScriptBlockRule</a>(<span class="r580 r">lCurly</span>, <span class="r581 r">isFilter</span>);
                <b>var</b> <span id="r585 rd" class="r585 r">functionName</span> = (<span class="r576 r">functionNameToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1aeb1084525225c9" class="i field">Generic</a>)
                                       ? ((<a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a>)<span class="r576 r">functionNameToken</span>).<a href="token.cs.html#f95f094124370df7" class="i property">Value</a>
                                       : <span class="r576 r">functionNameToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>;
 
                <a href="ast.cs.html#dd61b2a7b388405b" class="t t">FunctionDefinitionAst</a> <span id="r586 rd" class="r586 r">result</span> = <b>new</b> <span class="t">FunctionDefinitionAst</span>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r575 r">functionToken</span>, <span class="r584 r">scriptBlock</span>),
                    <span class="r581 r">isFilter</span>, <span class="r582 r">isWorkflow</span>, <span class="r576 r">functionNameToken</span>, <span class="r579 r">parameters</span>, <span class="r584 r">scriptBlock</span>);
                <b>return</b> <span class="r586 r">result</span>;
            }
            <b>finally</b>
            {
                <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#73ba79aabc0d9f2b" class="i property">InWorkflowContext</a> = <span class="r583 r">oldTokenizerWorkflowContext</span>;
            }
        }
 
        <b>private</b> <span class="i">List</span>&lt;<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <a id="dfa3b2cbc7d020a3" href="../../R/dfa3b2cbc7d020a3.html" target="n" data-glyph="76,1" class="i method">FunctionParameterDeclarationRule</a>(<b>out</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r587 rd" class="r587 r">endErrorStatement</span>, <b>out</b> <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r588 rd" class="r588 r">rParen</span>)
        {
            <span class="c">// G  function-parameter-declaration:</span>
            <span class="c">// G      new-lines:opt   &#39;(&#39;   parameter-list   new-lines:opt   &#39;)&#39;</span>
 
            <span class="i">List</span>&lt;<a href="ast.cs.html#bf2a2797225b11b5" class="t t">ParameterAst</a>&gt; <span id="r589 rd" class="r589 r">parameters</span> = <b>null</b>;
            <span class="r587 r">endErrorStatement</span> = <b>null</b>;
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <span class="r588 r">rParen</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r590 rd" class="r590 r">lParen</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <b>if</b> (<span class="r590 r">lParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>)
            {
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <span class="r589 r">parameters</span> = <a href="#dadaf18d18923b93" class="i method">ParameterListRule</a>();
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <span class="r588 r">rParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r588 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>)
                {
                    <span class="c">// ErrorRecovery: assume a body follows, so just keep parsing.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r588 r">rParen</span>);
                    <span class="r587 r">endErrorStatement</span> = <span class="r589 r">parameters</span>.<span class="i">Count</span> &gt; 0 ? <span class="r589 r">parameters</span>.<span class="i">Last</span>().<span class="i">Extent</span> : <span class="r590 r">lParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r587 r">endErrorStatement</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInFunctionParameterList</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInFunctionParameterList</span>);
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            }
 
            <b>return</b> <span class="r589 r">parameters</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="6b594b77edd12104" href="../../R/6b594b77edd12104.html" target="n" data-glyph="76,1" class="i method">TrapStatementRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r591 rd" class="r591 r">trapToken</span>)
        {
            <span class="c">// G  trap-statement:</span>
            <span class="c">// G      &#39;trap&#39;  new-lines:opt   type-literal:opt   statement-block</span>
 
            <b>var</b> <span id="r592 rd" class="r592 r">restorePoint</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#820e8f7ae7d9d17c" class="i method">GetRestorePoint</a>();
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a> <span id="r593 rd" class="r593 r">type</span> = <a href="#b8ee90436ed71ebc" class="i method">AttributeRule</a>();
            <a href="ast.cs.html#34b9d5dbbaca964d" class="k">var</a> <span id="r594 rd" class="r594 r">typeConstraintAst</span> = <span class="r593 r">type</span> <b>as</b> <a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>;
            <b>if</b> (<span class="r593 r">type</span> != <b>null</b> &amp;&amp; <span class="r594 r">typeConstraintAst</span> == <b>null</b>)
            {
                <span class="c">// Presumably we parsed an attribute instead of a type.  Put it back and let the code</span>
                <span class="c">// below report a missing trap body.  The attribute might belong to something that</span>
                <span class="c">// is after the trap, something like:</span>
                <span class="c">//    trap</span>
                <span class="c">//    [ValidateNotNullOrEmpty()]$var</span>
                <a href="#55d3ff509af9c3dd" class="i method">Resync</a>(<span class="r592 r">restorePoint</span>);
            }
 
            <a href="ast.cs.html#268644c84b225866" class="k">var</a> <span id="r595 rd" class="r595 r">body</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
            <b>if</b> (<span class="r595 r">body</span> == <b>null</b>)
            {
                <span class="c">// ErrorRecovery: just return an error statement.</span>
 
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r596 rd" class="r596 r">endErrorStatement</span> = <a href="#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r594 r">typeConstraintAst</span>, <span class="r591 r">trapToken</span>);
                <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r596 r">endErrorStatement</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingTrapStatement</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingTrapStatement</span>);
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r591 r">trapToken</span>, <span class="r596 r">endErrorStatement</span>), <a href="#5a40a6e894a3582f" class="i method">GetNestedErrorAsts</a>(<span class="r594 r">typeConstraintAst</span>));
            }
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#2a6bb2763a18f4f6" class="t constructor">TrapStatementAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r591 r">trapToken</span>, <span class="r595 r">body</span>), <span class="r594 r">typeConstraintAst</span>, <span class="r595 r">body</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Parse a catch block.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r597 r">endErrorStatement</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Set to the last thing scanned that is definitely part of the catch, but only set after issuing an error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r598 r">errorAsts</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> If there are any errors and CatchBlockRule is returning null, this list is used to return back any asts</span>
        <span class="c">///</span><span class="c"> consumed here (essentially the type constraints.)</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">A catch clause, or null there is no catch or there was some error.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>private</b> <a href="ast.cs.html#fafbccc59f688c0e" class="t t">CatchClauseAst</a> <a id="61377e6192243646" href="../../R/61377e6192243646.html" target="n" data-glyph="76,1" class="i method">CatchBlockRule</a>(<b>ref</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r597 rd" class="r597 r">endErrorStatement</span>, <b>ref</b> <span class="i">List</span>&lt;<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt; <span id="r598 rd" class="r598 r">errorAsts</span>)
        {
            <span class="c">// G  catch-clause:</span>
            <span class="c">// G      new-lines:opt   &#39;catch&#39;   catch-type-list:opt   statement-block</span>
            <span class="c">// G  catch-type-list:</span>
            <span class="c">// G      new-lines:opt   type-literal</span>
            <span class="c">// G      catch-type-list   new-lines:opt   &#39;,&#39;   new-lines:opt   type-literal</span>
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r599 rd" class="r599 r">catchToken</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r599 r">catchToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c84d840825952d7b" class="i field">Catch</a>)
            {
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r599 r">catchToken</span>);
                <b>return</b> <b>null</b>;
            }
 
            <span class="i">List</span>&lt;<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt; <span id="r600 rd" class="r600 r">exceptionTypes</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r601 rd" class="r601 r">commaToken</span> = <b>null</b>;
            <b>while</b> (<b>true</b>)
            {
                <b>var</b> <span id="r602 rd" class="r602 r">restorePoint</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#820e8f7ae7d9d17c" class="i method">GetRestorePoint</a>();
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a> <span id="r603 rd" class="r603 r">type</span> = <a href="#b8ee90436ed71ebc" class="i method">AttributeRule</a>();
 
                <b>if</b> (<span class="r603 r">type</span> == <b>null</b>)
                {
                    <b>if</b> (<span class="r601 r">commaToken</span> != <b>null</b>)
                    {
                        <span class="c">// ErrorRecovery: Just consume the comma, pretend it wasn&#39;t there and look for the handler block.</span>
 
                        <span class="r597 r">endErrorStatement</span> = <span class="r601 r">commaToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                        <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r597 r">endErrorStatement</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingTypeLiteralToken</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingTypeLiteralToken</span>);
                    }
 
                    <b>break</b>;
                }
 
                <a href="ast.cs.html#34b9d5dbbaca964d" class="k">var</a> <span id="r604 rd" class="r604 r">typeConstraintAst</span> = <span class="r603 r">type</span> <b>as</b> <a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>;
                <b>if</b> (<span class="r604 r">typeConstraintAst</span> == <b>null</b>)
                {
                    <span class="c">// Presumably we parsed an attribute instead of a type.  Put it back and let the code</span>
                    <span class="c">// below report a missing catch clause body.  The attribute might belong to something that</span>
                    <span class="c">// is after the try/catch, something like:</span>
                    <span class="c">//    catch</span>
                    <span class="c">//    [ValidateNotNullOrEmpty()]$var</span>
 
                    <a href="#55d3ff509af9c3dd" class="i method">Resync</a>(<span class="r602 r">restorePoint</span>);
                    <b>break</b>;
                }
 
                <b>if</b> (<span class="r600 r">exceptionTypes</span> == <b>null</b>)
                {
                    <span class="r600 r">exceptionTypes</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt;();
                }
 
                <span class="r600 r">exceptionTypes</span>.<span class="i">Add</span>(<span class="r604 r">typeConstraintAst</span>);
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r601 r">commaToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r601 r">commaToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                {
                    <b>break</b>;
                }
 
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
            }
 
            <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r605 rd" class="r605 r">handler</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
            <b>if</b> (<span class="r605 r">handler</span> == <b>null</b>)
            {
                <span class="c">// Avoid issuing an extra error if we&#39;ve already issued one, plus the end of the ErrorStatementAst</span>
                <span class="c">// shouldn&#39;t be updated.</span>
                <b>if</b> (<span class="r601 r">commaToken</span> == <b>null</b> || <span class="r597 r">endErrorStatement</span> != <span class="r601 r">commaToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>)
                {
                    <span class="c">// ErrorRecovery: just use the &quot;missing&quot; block in the result ast.</span>
 
                    <span class="r597 r">endErrorStatement</span> = <span class="r600 r">exceptionTypes</span> != <b>null</b> ? <span class="r600 r">exceptionTypes</span>.<span class="i">Last</span>().<span class="i">Extent</span> : <span class="r599 r">catchToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r597 r">endErrorStatement</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingCatchHandlerBlock</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingCatchHandlerBlock</span>);
                }
 
                <b>if</b> (<span class="r600 r">exceptionTypes</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r598 r">errorAsts</span> == <b>null</b>)
                    {
                        <span class="r598 r">errorAsts</span> = <span class="r600 r">exceptionTypes</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r598 r">errorAsts</span>.<span class="i">AddRange</span>(<span class="r600 r">exceptionTypes</span>);
                    }
                }
 
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <b>new</b> <span class="t">CatchClauseAst</span>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r599 r">catchToken</span>, <span class="r605 r">handler</span>), <span class="r600 r">exceptionTypes</span>, <span class="r605 r">handler</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="011fc3da5af347cc" href="../../R/011fc3da5af347cc.html" target="n" data-glyph="76,1" class="i method">TryStatementRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r606 rd" class="r606 r">tryToken</span>)
        {
            <span class="c">// G  try-statement:</span>
            <span class="c">// G      &#39;try&#39;   statement-block   catch-clauses</span>
            <span class="c">// G      &#39;try&#39;   statement-block   finally-clause</span>
            <span class="c">// G      &#39;try&#39;   statement-block   catch-clauses   finally-clause</span>
            <span class="c">// G  catch-clauses:</span>
            <span class="c">// G      catch-clause</span>
            <span class="c">// G      catch-clauses   catch-clause</span>
            <span class="c">// G  catch-clause:</span>
            <span class="c">// G      new-lines:opt   &#39;catch&#39;   catch-type-list:opt   statement-block</span>
            <span class="c">// G  catch-type-list:</span>
            <span class="c">// G      new-lines:opt   type-literal</span>
            <span class="c">// G      catch-type-list   new-lines:opt   &#39;,&#39;   new-lines:opt   type-literal</span>
            <span class="c">// G  finally-clause:</span>
            <span class="c">// G      new-lines:opt   &#39;finally&#39;   statement-block</span>
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r607 rd" class="r607 r">body</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
            <b>if</b> (<span class="r607 r">body</span> == <b>null</b>)
            {
                <span class="c">// ErrorRecovery: don&#39;t parse more, return an error statement.</span>
 
                <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r606 r">tryToken</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingTryStatementBlock</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingTryStatementBlock</span>);
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<span class="r606 r">tryToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
            }
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r608 rd" class="r608 r">endErrorStatement</span> = <b>null</b>;
            <a href="ast.cs.html#fafbccc59f688c0e" class="t t">CatchClauseAst</a> <span id="r609 rd" class="r609 r">catchClause</span>;
            <span class="i">List</span>&lt;<a href="ast.cs.html#fafbccc59f688c0e" class="t t">CatchClauseAst</a>&gt; <span id="r610 rd" class="r610 r">catches</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#fafbccc59f688c0e" class="t t">CatchClauseAst</a>&gt;();
            <span class="i">List</span>&lt;<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>&gt; <span id="r611 rd" class="r611 r">errorAsts</span> = <b>null</b>;
            <b>while</b> ((<span class="r609 r">catchClause</span> = <a href="#61377e6192243646" class="i method">CatchBlockRule</a>(<b>ref</b> <span class="r608 r">endErrorStatement</span>, <b>ref</b> <span class="r611 r">errorAsts</span>)) != <b>null</b>)
            {
                <span class="r610 r">catches</span>.<span class="i">Add</span>(<span class="r609 r">catchClause</span>);
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r612 rd" class="r612 r">finallyToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r613 rd" class="r613 r">finallyBlock</span> = <b>null</b>;
            <b>if</b> (<span class="r612 r">finallyToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4524273aecb9e45c" class="i field">Finally</a>)
            {
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <span class="r613 r">finallyBlock</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
 
                <b>if</b> (<span class="r613 r">finallyBlock</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: just return null, a null finally block is fine in the resulting ast (but maybe consider</span>
                    <span class="c">// marking the resulting ast as having an error.)</span>
 
                    <span class="r608 r">endErrorStatement</span> = <span class="r612 r">finallyToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r608 r">endErrorStatement</span>),
                                          <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingFinallyStatementBlock</span>),
                                          <span class="i">ParserStrings</span>.<span class="i">MissingFinallyStatementBlock</span>,
                                          <span class="r612 r">finallyToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                }
            }
 
            <b>if</b> (<span class="r610 r">catches</span>.<span class="i">Count</span> == 0 &amp;&amp; <span class="r613 r">finallyBlock</span> == <b>null</b> &amp;&amp; <span class="r608 r">endErrorStatement</span> == <b>null</b>)
            {
                <span class="c">// ErrorRecovery: don&#39;t parse more, return an error statement.</span>
 
                <span class="r608 r">endErrorStatement</span> = <span class="r607 r">body</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r608 r">endErrorStatement</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingCatchOrFinally</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingCatchOrFinally</span>);
            }
 
            <b>if</b> (<span class="r608 r">endErrorStatement</span> != <b>null</b>)
            {
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r606 r">tryToken</span>, <span class="r608 r">endErrorStatement</span>), <span class="i">GetNestedErrorAsts</span>(<span class="r607 r">body</span>, <span class="r610 r">catches</span>, <span class="r611 r">errorAsts</span>));
            }
 
            <b>return</b> <b>new</b> <span class="t">TryStatementAst</span>(<span class="i">ExtentOf</span>(<span class="r606 r">tryToken</span>, <span class="r613 r">finallyBlock</span> != <b>null</b> ? <span class="r613 r">finallyBlock</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a> : <span class="r610 r">catches</span>.<span class="i">Last</span>().<span class="i">Extent</span>),
                                       <span class="r607 r">body</span>, <span class="r610 r">catches</span>, <span class="r613 r">finallyBlock</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <a id="5a9d1f48e6b699c2" href="../../R/5a9d1f48e6b699c2.html" target="n" data-glyph="76,1" class="i method">DataStatementRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r614 rd" class="r614 r">dataToken</span>)
        {
            <span class="c">// G  data-statement:</span>
            <span class="c">// G      &#39;data&#39;    new-lines:opt   data-name   data-commands-allowed:opt   statement-block</span>
            <span class="c">// G  data-name:</span>
            <span class="c">// G      simple-name</span>
            <span class="c">// G  data-commands-allowed:</span>
            <span class="c">// G      new-lines:opt   &#39;-supportedcommand&#39;   data-commands-list</span>
            <span class="c">// G  data-commands-list:</span>
            <span class="c">// G      new-lines:opt   data-command</span>
            <span class="c">// G      data-commands-list   &#39;,&#39;   new-lines:opt   data-command</span>
            <span class="c">// G  data-command:</span>
            <span class="c">// G      command-name-expr</span>
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r615 rd" class="r615 r">endErrorStatement</span> = <b>null</b>;
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r616 rd" class="r616 r">dataVariableNameAst</span> = <a href="#942135886d841ed5" class="i method">SimpleNameRule</a>();
            <b>string</b> <span id="r617 rd" class="r617 r">dataVariableName</span> = <span class="r616 r">dataVariableNameAst</span>?.<a href="ast.cs.html#a6dc72732a1c7e0d" class="i property">Value</a>;
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r618 rd" class="r618 r">supportedCommandToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r619 rd" class="r619 r">commands</span> = <b>null</b>;
            <b>if</b> (<span class="r618 r">supportedCommandToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c3ec93ee8b22aa7f" class="i field">Parameter</a>)
            {
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
 
                <b>if</b> (!<a href="#71bba9aeff3a33d4" class="i method">IsSpecificParameter</a>(<span class="r618 r">supportedCommandToken</span>, <span class="s">&quot;SupportedCommand&quot;</span>))
                {
                    <span class="c">// ErrorRecovery: Assume the parameter is just misspelled, look for command names next</span>
 
                    <span class="r615 r">endErrorStatement</span> = <span class="r618 r">supportedCommandToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    <span class="i">ReportError</span>(<span class="r615 r">endErrorStatement</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">InvalidParameterForDataSectionStatement</span>),
                        <span class="i">ParserStrings</span>.<span class="i">InvalidParameterForDataSectionStatement</span>,
                        ((<a href="token.cs.html#ee13ee02b3131929" class="t t">ParameterToken</a>)<span class="r618 r">supportedCommandToken</span>).<a href="token.cs.html#c72db3af1374663c" class="i property">ParameterName</a>);
                }
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r620 rd" class="r620 r">commaToken</span> = <b>null</b>;
                <span class="r619 r">commands</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;();
                <b>while</b> (<b>true</b>)
                {
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r621 rd" class="r621 r">ast</span> = <a href="#6ab87e657667a8ae" class="i method">GetSingleCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#883387f0e772618e" class="i field">CommandName</a>);
                    <b>if</b> (<span class="r621 r">ast</span> == <b>null</b>)
                    {
                        <span class="c">// ErrorRecovery: Look for the data statement body.</span>
 
                        <span class="c">// Only report an error if an error hasn&#39;t already been issued.</span>
                        <b>if</b> (<span class="r615 r">endErrorStatement</span> == <b>null</b>)
                        {
                            <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r620 r">commaToken</span> ?? <span class="r618 r">supportedCommandToken</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingValueForSupportedCommandInDataSectionStatement</span>),
                                <span class="i">ParserStrings</span>.<span class="i">MissingValueForSupportedCommandInDataSectionStatement</span>);
                        }
 
                        <span class="r615 r">endErrorStatement</span> = <span class="r620 r">commaToken</span> != <b>null</b> ? <span class="r620 r">commaToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a> : <span class="r618 r">supportedCommandToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                        <b>break</b>;
                    }
 
                    <span class="r619 r">commands</span>.<span class="i">Add</span>(<span class="r621 r">ast</span>);
 
                    <span class="r620 r">commaToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                    <b>if</b> (<span class="r620 r">commaToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                    {
                        <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                        <b>continue</b>;
                    }
 
                    <b>break</b>;
                }
            }
 
            <a href="ast.cs.html#268644c84b225866" class="t t">StatementBlockAst</a> <span id="r622 rd" class="r622 r">body</span> = <b>null</b>;
            <b>if</b> (<span class="r615 r">endErrorStatement</span> == <b>null</b>)
            {
                <span class="r622 r">body</span> = <a href="#15197feac3278717" class="i method">StatementBlockRule</a>();
                <b>if</b> (<span class="r622 r">body</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: return an error statement.</span>
 
                    <span class="r615 r">endErrorStatement</span> = <span class="r619 r">commands</span> != <b>null</b>
                                            ? <span class="r619 r">commands</span>.<span class="i">Last</span>().<span class="i">Extent</span>
                                            : <a href="#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r616 r">dataVariableNameAst</span>, <span class="r614 r">dataToken</span>);
                    <span class="i">ReportIncompleteInput</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r615 r">endErrorStatement</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingStatementBlockForDataSection</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingStatementBlockForDataSection</span>);
                }
            }
 
            <b>if</b> (<span class="r615 r">endErrorStatement</span> != <b>null</b>)
            {
                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r614 r">dataToken</span>, <span class="r615 r">endErrorStatement</span>), <span class="i">GetNestedErrorAsts</span>(<span class="r619 r">commands</span>));
            }
 
            <b>return</b> <b>new</b> <span class="t">DataStatementAst</span>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r614 r">dataToken</span>, <span class="r622 r">body</span>), <span class="r617 r">dataVariableName</span>, <span class="r619 r">commands</span>, <span class="r622 r">body</span>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Statements
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Pipelines
 
        <b>private</b> <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <a id="9fe484111cd89222" href="../../R/9fe484111cd89222.html" target="n" data-glyph="76,1" class="i method">PipelineChainRule</a>()
        {
            <span class="c">// G  pipeline-chain:</span>
            <span class="c">// G      pipeline</span>
            <span class="c">// G      pipeline-chain chain-operator pipeline</span>
            <span class="c">// G</span>
            <span class="c">// G  chain-operator:</span>
            <span class="c">// G      &#39;||&#39;</span>
            <span class="c">// G      &#39;&amp;&amp;&#39;</span>
 
            <span class="c">// If this feature is not enabled,</span>
            <span class="c">// just look for pipelines as before.</span>
            <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
 
            <span class="c">// First look for assignment, since PipelineRule once handled that and this supercedes that.</span>
            <span class="c">// We may end up with an expression here as a result,</span>
            <span class="c">// in which case we hang on to it to pass it into the first pipeline rule call.</span>
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r623 rd" class="r623 r">assignToken</span> = <b>null</b>;
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r624 rd" class="r624 r">expr</span>;
 
            <span class="c">// Look for an expression,</span>
            <span class="c">// which could either be a variable to assign to,</span>
            <span class="c">// or the first expression in a pipeline: &quot;Hi&quot; | % { $_ }</span>
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r625 rd" class="r625 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#9b6269e007d113c3" class="i field">Expression</a>);
                <span class="r624 r">expr</span> = <a href="#8da955af7d659a21" class="i method">ExpressionRule</a>();
                <b>if</b> (<span class="r624 r">expr</span> != <b>null</b>)
                {
                    <span class="c">// We peek here because we are in expression mode, otherwise =0 will get scanned</span>
                    <span class="c">// as a single token.</span>
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r626 rd" class="r626 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                    <b>if</b> (<span class="r626 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#84def6774d758bed" class="i method">HasTrait</a>(<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#c02b7eb49b9e2b47" class="i field">AssignmentOperator</a>))
                    {
                        <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                        <span class="r623 r">assignToken</span> = <span class="r626 r">token</span>;
                    }
                }
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r625 r">oldTokenizerMode</span>);
            }
 
            <span class="c">// If we have an assign token, deal with assignment</span>
            <b>if</b> (<span class="r624 r">expr</span> != <b>null</b> &amp;&amp; <span class="r623 r">assignToken</span> != <b>null</b>)
            {
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r627 rd" class="r627 r">statement</span> = <a href="#90788aa7288d5462" class="i method">StatementRule</a>();
 
                <b>if</b> (<span class="r627 r">statement</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: we are very likely at EOF because pretty much anything should result in some</span>
                    <span class="c">// pipeline, so just keep parsing.</span>
                    <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r628 rd" class="r628 r">errorExtent</span> = <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r623 r">assignToken</span>);
                    <span class="i">ReportIncompleteInput</span>(
                        <span class="r628 r">errorExtent</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ExpectedValueExpression</span>),
                        <span class="i">ParserStrings</span>.<span class="i">ExpectedValueExpression</span>,
                        <span class="r623 r">assignToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                    <span class="r627 r">statement</span> = <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<span class="r628 r">errorExtent</span>);
                }
 
                <b>return</b> <b>new</b> <a href="ast.cs.html#d091f17bebe00b69" class="t constructor">AssignmentStatementAst</a>(
                    <a href="#f4b9cf4dcd548ea3" class="i method">ExtentOf</a>(<span class="r624 r">expr</span>, <span class="r627 r">statement</span>),
                    <span class="r624 r">expr</span>,
                    <span class="r623 r">assignToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>,
                    <span class="r627 r">statement</span>,
                    <span class="r623 r">assignToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
            }
 
            <span class="c">// Start scanning for a pipeline chain,</span>
            <span class="c">// possibly starting with the expression from earlier</span>
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r629 rd" class="r629 r">startExpression</span> = <span class="r624 r">expr</span>;
            <a href="ast.cs.html#4ed29ab5c0549573" class="t t">ChainableAst</a> <span id="r630 rd" class="r630 r">currentPipelineChain</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r631 rd" class="r631 r">currentChainOperatorToken</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r632 rd" class="r632 r">nextToken</span> = <b>null</b>;
            <b>bool</b> <span id="r633 rd" class="r633 r">background</span> = <b>false</b>;
            <b>while</b> (<b>true</b>)
            {
                <span class="c">// Look for the next pipeline in the chain,</span>
                <span class="c">// at this point we should already have parsed all assignments</span>
                <span class="c">// in enclosing calls to PipelineChainRule</span>
                <a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a> <span id="r634 rd" class="r634 r">nextPipeline</span>;
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r635 rd" class="r635 r">firstPipelineToken</span> = <b>null</b>;
                <b>if</b> (<span class="r629 r">startExpression</span> != <b>null</b>)
                {
                    <span class="r634 r">nextPipeline</span> = (<a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a>)<a href="#73cd6e3973ec5032" class="i method">PipelineRule</a>(<span class="r629 r">startExpression</span>);
                    <span class="r629 r">startExpression</span> = <b>null</b>;
                }
                <b>else</b>
                {
                    <span class="c">// Remember the token for error reporting,</span>
                    <span class="c">// since erroneous results in the rules still consume tokens</span>
                    <span class="r635 r">firstPipelineToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                    <span class="r634 r">nextPipeline</span> = (<a href="ast.cs.html#785915ec8547ce9f" class="t t">PipelineAst</a>)<a href="#73cd6e3973ec5032" class="i method">PipelineRule</a>();
                }
 
                <b>if</b> (<span class="r634 r">nextPipeline</span> == <b>null</b>)
                {
                    <b>if</b> (<span class="r631 r">currentChainOperatorToken</span> == <b>null</b>)
                    {
                        <span class="c">// We haven&#39;t seen a chain token, so the caller is responsible</span>
                        <span class="c">// for expecting a pipeline and must manage this</span>
                        <b>return</b> <b>null</b>;
                    }
 
                    <span class="c">// See if we are responsible for reporting the issue</span>
                    <b>switch</b> (<span class="r635 r">firstPipelineToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
                    {
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>:
                            <span class="c">// If we&#39;re at EOF, we should allow input to complete</span>
                            <span class="i">ReportIncompleteInput</span>(
                                <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r631 r">currentChainOperatorToken</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EmptyPipelineChainElement</span>),
                                <span class="i">ParserStrings</span>.<span class="i">EmptyPipelineChainElement</span>,
                                <span class="r631 r">currentChainOperatorToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                            <b>break</b>;
 
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9023444a1ee3a84" class="i field">Dot</a>:
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ed112ae477a73c36" class="i field">Ampersand</a>:
                            <span class="c">// If something like &#39;command &amp;&amp; &amp;&#39; or &#39;command &amp;&amp; .&#39; was provided,</span>
                            <span class="c">// CommandRule has already reported the error.</span>
                            <b>break</b>;
 
                        <b>default</b>:
                            <span class="i">ReportError</span>(
                                <a href="#e2dca4f752c5c572" class="i method">ExtentOf</a>(<span class="r631 r">currentChainOperatorToken</span>, <span class="r635 r">firstPipelineToken</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EmptyPipelineChainElement</span>),
                                <span class="i">ParserStrings</span>.<span class="i">EmptyPipelineChainElement</span>,
                                <span class="r631 r">currentChainOperatorToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                            <b>break</b>;
                    }
 
                    <b>return</b> <b>new</b> <span class="t">ErrorStatementAst</span>(
                        <a href="#4ad82407bcef8f0d" class="i method">ExtentOf</a>(<span class="r630 r">currentPipelineChain</span>, <span class="r631 r">currentChainOperatorToken</span>),
                        <span class="r631 r">currentChainOperatorToken</span>,
                        <b>new</b>[] { <span class="r630 r">currentPipelineChain</span> });
                }
 
                <span class="c">// Look ahead for a chain operator</span>
                <span class="r632 r">nextToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>switch</b> (<span class="r632 r">nextToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
                {
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#074f3be81f88796f" class="i field">AndAnd</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a07cbb74e75a87a" class="i field">OrOr</a>:
                        <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                        <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                        <b>break</b>;
 
                    <span class="c">// Background operators may also occur here</span>
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ed112ae477a73c36" class="i field">Ampersand</a>:
                        <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                        <span class="r632 r">nextToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
 
                        <b>switch</b> (<span class="r632 r">nextToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
                        {
                            <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#074f3be81f88796f" class="i field">AndAnd</a>:
                            <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a07cbb74e75a87a" class="i field">OrOr</a>:
                                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                                <span class="i">ReportError</span>(<span class="r632 r">nextToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">BackgroundOperatorInPipelineChain</span>), <span class="i">ParserStrings</span>.<span class="i">BackgroundOperatorInPipelineChain</span>);
                                <b>return</b> <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<a href="#a571f93282f04222" class="i method">ExtentOf</a>(<span class="r630 r">currentPipelineChain</span> ?? <span class="r634 r">nextPipeline</span>, <span class="r632 r">nextToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
                        }
 
                        <span class="r633 r">background</span> = <b>true</b>;
                        <b>goto</b> <b>default</b>;
 
                    <span class="c">// No more chain operators -- return</span>
                    <b>default</b>:
                        <span class="c">// If we haven&#39;t seen a chain yet, pass through the pipeline</span>
                        <span class="c">// Simplifies the AST and prevents allocation</span>
                        <b>if</b> (<span class="r630 r">currentPipelineChain</span> == <b>null</b>)
                        {
                            <b>if</b> (!<span class="r633 r">background</span>)
                            {
                                <b>return</b> <span class="r634 r">nextPipeline</span>;
                            }
 
                            <span class="c">// Set background on the pipeline AST</span>
                            <span class="r634 r">nextPipeline</span>.<a href="ast.cs.html#552590fec9ffecb9" class="i property">Background</a> = <b>true</b>;
                            <b>return</b> <span class="r634 r">nextPipeline</span>;
                        }
 
                        <b>return</b> <b>new</b> <a href="ast.cs.html#07e97055b063d48b" class="t constructor">PipelineChainAst</a>(
                            <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r630 r">currentPipelineChain</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r634 r">nextPipeline</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>),
                            <span class="r630 r">currentPipelineChain</span>,
                            <span class="r634 r">nextPipeline</span>,
                            <span class="r631 r">currentChainOperatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>,
                            <span class="r633 r">background</span>);
                }
 
                <span class="c">// Assemble the new chain statement AST</span>
                <span class="r630 r">currentPipelineChain</span> = <span class="r630 r">currentPipelineChain</span> == <b>null</b>
                    ? (<a href="ast.cs.html#4ed29ab5c0549573" class="t t">ChainableAst</a>)<span class="r634 r">nextPipeline</span>
                    : <b>new</b> <a href="ast.cs.html#07e97055b063d48b" class="t constructor">PipelineChainAst</a>(
                        <a href="#dd55e127a0d16829" class="i method">ExtentOf</a>(<span class="r630 r">currentPipelineChain</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r634 r">nextPipeline</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>),
                        <span class="r630 r">currentPipelineChain</span>,
                        <span class="r634 r">nextPipeline</span>,
                        <span class="r631 r">currentChainOperatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>);
 
                <span class="c">// Remember the last operator to chain the coming pipeline</span>
                <span class="r631 r">currentChainOperatorToken</span> = <span class="r632 r">nextToken</span>;
 
                <span class="c">// Look ahead to report incomplete input if needed</span>
                <b>if</b> (<a href="#ea786851e84d8cea" class="i method">PeekToken</a>().<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
                {
                    <span class="i">ReportIncompleteInput</span>(
                        <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r632 r">nextToken</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EmptyPipelineChainElement</span>),
                        <span class="i">ParserStrings</span>.<span class="i">EmptyPipelineChainElement</span>);
 
                    <b>return</b> <span class="r630 r">currentPipelineChain</span>;
                }
            }
        }
 
        <b>private</b> <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <a id="73cd6e3973ec5032" href="../../R/73cd6e3973ec5032.html" target="n" data-glyph="76,1" class="i method">PipelineRule</a>(
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r636 rd" class="r636 r">startExpression</span> = <b>null</b>,
            <b>bool</b> <span id="r637 rd" class="r637 r">allowBackground</span> = <b>false</b>)
        {
            <span class="c">// G  pipeline:</span>
            <span class="c">// G      assignment-expression</span>
            <span class="c">// G      expression   redirections:opt  pipeline-tail:opt</span>
            <span class="c">// G      command   pipeline-tail:opt</span>
            <span class="c">// G</span>
            <span class="c">// G  assignment-expression:</span>
            <span class="c">// G      expression   assignment-operator   statement</span>
            <span class="c">// G</span>
            <span class="c">// G  pipeline-tail:</span>
            <span class="c">// G      new-lines:opt   &#39;|&#39;   new-lines:opt   command   pipeline-tail:opt</span>
            <span class="c">//</span>
            <b>var</b> <span id="r638 rd" class="r638 r">pipelineElements</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>&gt;();
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r639 rd" class="r639 r">startExtent</span> = <b>null</b>;
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r640 rd" class="r640 r">nextToken</span> = <b>null</b>;
            <b>bool</b> <span id="r641 rd" class="r641 r">scanning</span> = <b>true</b>;
            <b>bool</b> <span id="r642 rd" class="r642 r">background</span> = <b>false</b>;
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r643 rd" class="r643 r">expr</span> = <span class="r636 r">startExpression</span>;
            <b>while</b> (<span class="r641 r">scanning</span>)
            {
                <a href="ast.cs.html#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a> <span id="r644 rd" class="r644 r">commandAst</span>;
 
                <b>if</b> (<span class="r643 r">expr</span> == <b>null</b>)
                {
                    <span class="c">// Look for an expression at the beginning of a pipeline</span>
                    <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r645 rd" class="r645 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
                    <b>try</b>
                    {
                        <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#9b6269e007d113c3" class="i field">Expression</a>);
                        <span class="r643 r">expr</span> = <a href="#8da955af7d659a21" class="i method">ExpressionRule</a>();
                    }
                    <b>finally</b>
                    {
                        <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r645 r">oldTokenizerMode</span>);
                    }
                }
 
                <b>if</b> (<span class="r643 r">expr</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r638 r">pipelineElements</span>.<span class="i">Count</span> &gt; 0)
                    {
                        <span class="c">// ErrorRecovery: this is a semantic error, so just keep parsing.</span>
                        <span class="i">ReportError</span>(
                            <span class="r643 r">expr</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ExpressionsMustBeFirstInPipeline</span>),
                            <span class="i">ParserStrings</span>.<span class="i">ExpressionsMustBeFirstInPipeline</span>);
                    }
 
                    <a href="ast.cs.html#62235daca4a9c495" class="t t">RedirectionAst</a>[] <span id="r646 rd" class="r646 r">redirections</span> = <b>null</b>;
                    <a href="token.cs.html#0cf16cab44989c21" class="k">var</a> <span id="r647 rd" class="r647 r">redirectionToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>() <b>as</b> <a href="token.cs.html#0cf16cab44989c21" class="t t">RedirectionToken</a>;
                    <a href="ast.cs.html#62235daca4a9c495" class="t t">RedirectionAst</a> <span id="r648 rd" class="r648 r">lastRedirection</span> = <b>null</b>;
                    <b>while</b> (<span class="r647 r">redirectionToken</span> != <b>null</b>)
                    {
                        <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
 
                        <b>if</b> (<span class="r646 r">redirections</span> == <b>null</b>)
                        {
                            <span class="r646 r">redirections</span> = <b>new</b> <a href="ast.cs.html#62235daca4a9c495" class="t t">RedirectionAst</a>[<a href="ast.cs.html#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>.<a href="ast.cs.html#80ff30fa4d2e1f56" class="i field">MaxRedirections</a>];
                        }
 
                        <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r649 rd" class="r649 r">unused</span> = <b>null</b>;
                        <span class="r648 r">lastRedirection</span> = <a href="#210e22a8c53156b3" class="i method">RedirectionRule</a>(<span class="r647 r">redirectionToken</span>, <span class="r646 r">redirections</span>, <b>ref</b> <span class="r649 r">unused</span>);
 
                        <span class="r647 r">redirectionToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>() <b>as</b> <a href="token.cs.html#0cf16cab44989c21" class="t t">RedirectionToken</a>;
                    }
 
                    <a href="Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r650 rd" class="r650 r">exprExtent</span> = <span class="r648 r">lastRedirection</span> != <b>null</b> ? <a href="#f4b9cf4dcd548ea3" class="i method">ExtentOf</a>(<span class="r643 r">expr</span>, <span class="r648 r">lastRedirection</span>) : <span class="r643 r">expr</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                    <span class="r644 r">commandAst</span> = <b>new</b> <span class="t">CommandExpressionAst</span>(
                        <span class="r650 r">exprExtent</span>,
                        <span class="r643 r">expr</span>,
                        <span class="r646 r">redirections</span>?.<span class="i">Where</span>(<b>static</b> <span id="r651 rd" class="r651 r">r</span> =&gt; <span class="r651 r">r</span> != <b>null</b>));
                }
                <b>else</b>
                {
                    <span class="r644 r">commandAst</span> = (<a href="ast.cs.html#a310aaa1e0374ddd" class="t t">CommandAst</a>)<a href="#e1eadfb26e3b4083" class="i method">CommandRule</a>(<span class="r429 r">forDynamicKeyword</span>: <b>false</b>);
                }
 
                <b>if</b> (<span class="r644 r">commandAst</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r639 r">startExtent</span> == <b>null</b>)
                    {
                        <span class="r639 r">startExtent</span> = <span class="r644 r">commandAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                    }
 
                    <span class="r638 r">pipelineElements</span>.<span class="i">Add</span>(<span class="r644 r">commandAst</span>);
                }
                <b>else</b> <b>if</b> (<span class="r638 r">pipelineElements</span>.<span class="i">Count</span> &gt; 0 || <a href="#ea786851e84d8cea" class="i method">PeekToken</a>().<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f09193da35fa965b" class="i field">Pipe</a>)
                {
                    <span class="c">// ErrorRecovery: just fall through</span>
                    <span class="c">// If the first pipe element is null, the position points to the pipe (ideally it would</span>
                    <span class="c">// point before, but the pipe could be the first character), otherwise the empty element</span>
                    <span class="c">// is after the pipe character.</span>
                    <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r652 rd" class="r652 r">errorPosition</span> = <span class="r640 r">nextToken</span> != <b>null</b> ? <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r640 r">nextToken</span>) : <a href="#ea786851e84d8cea" class="i method">PeekToken</a>().<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    <span class="i">ReportIncompleteInput</span>(
                        <span class="r652 r">errorPosition</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EmptyPipeElement</span>),
                        <span class="i">ParserStrings</span>.<span class="i">EmptyPipeElement</span>);
                }
 
                <span class="c">// Reset the expression for the next loop</span>
                <span class="r643 r">expr</span> = <b>null</b>;
                <span class="r640 r">nextToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
 
                <span class="c">// Skip newlines before pipe tokens to support (pipe)line continuation when pipe</span>
                <span class="c">// tokens start the next line of script</span>
                <b>if</b> (<span class="r640 r">nextToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a> &amp;&amp; <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#51b8c2449f201b9a" class="i method">IsPipeContinuation</a>(<span class="r640 r">nextToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>))
                {
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <span class="r640 r">nextToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                }
 
                <b>switch</b> (<span class="r640 r">nextToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
                {
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>:
                        <span class="c">// Handled by invoking rule</span>
                        <span class="r641 r">scanning</span> = <b>false</b>;
                        <b>continue</b>;
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#074f3be81f88796f" class="i field">AndAnd</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a07cbb74e75a87a" class="i field">OrOr</a>:
                        <span class="r641 r">scanning</span> = <b>false</b>;
                        <b>continue</b>;
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ed112ae477a73c36" class="i field">Ampersand</a>:
                        <b>if</b> (!<span class="r637 r">allowBackground</span>)
                        {
                            <span class="c">// Handled by invoking rule</span>
                            <span class="r641 r">scanning</span> = <b>false</b>;
                            <b>continue</b>;
                        }
 
                        <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                        <span class="r641 r">scanning</span> = <b>false</b>;
                        <span class="r642 r">background</span> = <b>true</b>;
                        <b>break</b>;
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f09193da35fa965b" class="i field">Pipe</a>:
                        <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                        <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                        <b>if</b> (<a href="#ea786851e84d8cea" class="i method">PeekToken</a>().<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
                        {
                            <span class="r641 r">scanning</span> = <b>false</b>;
                            <span class="i">ReportIncompleteInput</span>(
                                <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r640 r">nextToken</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">EmptyPipeElement</span>),
                                <span class="i">ParserStrings</span>.<span class="i">EmptyPipeElement</span>);
                        }
 
                        <b>break</b>;
 
                    <b>default</b>:
                        <span class="c">// ErrorRecovery: don&#39;t eat the token, assume it belongs to something else.</span>
                        <span class="i">ReportError</span>(
                            <span class="r640 r">nextToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>),
                            <span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>,
                            <span class="r640 r">nextToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                        <span class="r641 r">scanning</span> = <b>false</b>;
                        <b>break</b>;
                }
            }
 
            <b>if</b> (<span class="r638 r">pipelineElements</span>.<span class="i">Count</span> == 0)
            {
                <b>return</b> <b>null</b>;
            }
 
            <b>return</b> <b>new</b> <span class="t">PipelineAst</span>(<span class="i">ExtentOf</span>(<span class="r639 r">startExtent</span>, <span class="r638 r">pipelineElements</span>[<span class="r638 r">pipelineElements</span>.<span class="i">Count</span> - 1]), <span class="r638 r">pipelineElements</span>, <span class="r642 r">background</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#62235daca4a9c495" class="t t">RedirectionAst</a> <a id="210e22a8c53156b3" href="../../R/210e22a8c53156b3.html" target="n" data-glyph="76,1" class="i method">RedirectionRule</a>(<a href="token.cs.html#0cf16cab44989c21" class="t t">RedirectionToken</a> <span id="r653 rd" class="r653 r">redirectionToken</span>, <a href="ast.cs.html#62235daca4a9c495" class="t t">RedirectionAst</a>[] <span id="r654 rd" class="r654 r">redirections</span>, <b>ref</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r655 rd" class="r655 r">extent</span>)
        {
            <span class="c">// G  redirections:</span>
            <span class="c">// G      redirection</span>
            <span class="c">// G      redirections   redirection</span>
            <span class="c">// G  redirection:</span>
            <span class="c">// G      merging-redirection-operator</span>
            <span class="c">// G      file-redirection-operator   redirected-file-name</span>
            <span class="c">// G  redirected-file-name:</span>
            <span class="c">// G      command-argument</span>
            <span class="c">// G      primary-expression</span>
 
            <a href="ast.cs.html#62235daca4a9c495" class="t t">RedirectionAst</a> <span id="r656 rd" class="r656 r">result</span>;
 
            <a href="token.cs.html#0f2d65da8d7dc362" class="k">var</a> <span id="r657 rd" class="r657 r">fileRedirectionToken</span> = <span class="r653 r">redirectionToken</span> <b>as</b> <a href="token.cs.html#0f2d65da8d7dc362" class="t t">FileRedirectionToken</a>;
            <b>if</b> (<span class="r657 r">fileRedirectionToken</span> != <b>null</b> || (<span class="r653 r">redirectionToken</span> <b>is</b> <a href="token.cs.html#a1de8cd3efaa7514" class="t t">InputRedirectionToken</a>))
            {
                <span class="c">// get location</span>
                <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r658 rd" class="r658 r">filename</span> = <a href="#6ab87e657667a8ae" class="i method">GetSingleCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#56c226fdeaaab47b" class="i field">FileName</a>);
                <b>if</b> (<span class="r658 r">filename</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: Just pretend we have a filename and continue parsing.</span>
 
                    <span class="i">ReportError</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r653 r">redirectionToken</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingFileSpecification</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingFileSpecification</span>);
                    <span class="r658 r">filename</span> = <b>new</b> <a href="ast.cs.html#521987ae533dc4bd" class="t constructor">ErrorExpressionAst</a>(<span class="r653 r">redirectionToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
                }
 
                <b>if</b> (<span class="r657 r">fileRedirectionToken</span> == <b>null</b>)
                {
                    <span class="c">// Must be an input redirection</span>
                    <span class="i">ReportError</span>(<span class="r653 r">redirectionToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RedirectionNotSupported</span>),
                        <span class="i">ParserStrings</span>.<span class="i">RedirectionNotSupported</span>,
                        <span class="r653 r">redirectionToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                    <span class="r655 r">extent</span> = <a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r653 r">redirectionToken</span>, <span class="r658 r">filename</span>);
                    <b>return</b> <b>null</b>;
                }
 
                <span class="r656 r">result</span> = <b>new</b> <a href="ast.cs.html#3db17bc3755e0514" class="t constructor">FileRedirectionAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r657 r">fileRedirectionToken</span>, <span class="r658 r">filename</span>), <span class="r657 r">fileRedirectionToken</span>.<a href="token.cs.html#d276d289bf88bc3f" class="i property">FromStream</a>,
                                                <span class="r658 r">filename</span>, <span class="r657 r">fileRedirectionToken</span>.<a href="token.cs.html#a9a347ff6dcb8b8b" class="i property">Append</a>);
            }
            <b>else</b>
            {
                <a href="token.cs.html#626dd0ebba561118" class="k">var</a> <span id="r659 rd" class="r659 r">mergingRedirectionToken</span> = (<a href="token.cs.html#626dd0ebba561118" class="t t">MergingRedirectionToken</a>)<span class="r653 r">redirectionToken</span>;
 
                <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a> <span id="r660 rd" class="r660 r">fromStream</span> = <span class="r659 r">mergingRedirectionToken</span>.<a href="token.cs.html#bdd3901ece6342a2" class="i property">FromStream</a>;
                <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a> <span id="r661 rd" class="r661 r">toStream</span> = <span class="r659 r">mergingRedirectionToken</span>.<a href="token.cs.html#8d87ad5d1f970ef4" class="i property">ToStream</a>;
                <b>if</b> (<span class="r661 r">toStream</span> != <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="ast.cs.html#eef57f42e4c4012c" class="i field">Output</a>)
                {
                    <span class="c">// Have we seen something like 1&gt;&amp;2 or 2&gt;&amp;3</span>
                    <span class="c">// ErrorRecovery: This is just a semantic error, so no special recovery.</span>
 
                    <span class="i">ReportError</span>(<span class="r653 r">redirectionToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RedirectionNotSupported</span>),
                        <span class="i">ParserStrings</span>.<span class="i">RedirectionNotSupported</span>,
                        <span class="r659 r">mergingRedirectionToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                    <span class="r661 r">toStream</span> = <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="ast.cs.html#eef57f42e4c4012c" class="i field">Output</a>;
                }
                <b>else</b> <b>if</b> (<span class="r660 r">fromStream</span> == <span class="r661 r">toStream</span>)
                {
                    <span class="c">// Make sure 1&gt;&amp;1, 2&gt;&amp;2, etc. is an error.</span>
                    <span class="c">// ErrorRecovery: This is just a semantic error, so no special recovery.</span>
 
                    <span class="i">ReportError</span>(<span class="r653 r">redirectionToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">RedirectionNotSupported</span>),
                        <span class="i">ParserStrings</span>.<span class="i">RedirectionNotSupported</span>,
                        <span class="r659 r">mergingRedirectionToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                }
 
                <span class="r656 r">result</span> = <b>new</b> <a href="ast.cs.html#09fae3cd5578a4e0" class="t constructor">MergingRedirectionAst</a>(<span class="r659 r">mergingRedirectionToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r659 r">mergingRedirectionToken</span>.<a href="token.cs.html#bdd3901ece6342a2" class="i property">FromStream</a>, <span class="r661 r">toStream</span>);
            }
 
            <b>if</b> (<span class="r654 r">redirections</span>[(<b>int</b>)<span class="r656 r">result</span>.<a href="ast.cs.html#54d26a89dbf0384f" class="i property">FromStream</a>] == <b>null</b>)
            {
                <span class="r654 r">redirections</span>[(<b>int</b>)<span class="r656 r">result</span>.<a href="ast.cs.html#54d26a89dbf0384f" class="i property">FromStream</a>] = <span class="r656 r">result</span>;
            }
            <b>else</b>
            {
                <b>string</b> <span id="r662 rd" class="r662 r">errorStream</span>;
                <b>switch</b> (<span class="r656 r">result</span>.<a href="ast.cs.html#54d26a89dbf0384f" class="i property">FromStream</a>)
                {
                    <b>case</b> <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="ast.cs.html#e7ee7b8a1be15429" class="i field">All</a>: <span class="r662 r">errorStream</span> = <span class="i">ParserStrings</span>.<span class="i">AllStream</span>; <b>break</b>;
                    <b>case</b> <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="ast.cs.html#eef57f42e4c4012c" class="i field">Output</a>: <span class="r662 r">errorStream</span> = <span class="i">ParserStrings</span>.<span class="i">OutputStream</span>; <b>break</b>;
                    <b>case</b> <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="ast.cs.html#9d1b0150bfeb2a28" class="i field">Error</a>: <span class="r662 r">errorStream</span> = <span class="i">ParserStrings</span>.<span class="i">ErrorStream</span>; <b>break</b>;
                    <b>case</b> <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="ast.cs.html#f7c802fd607d5b44" class="i field">Warning</a>: <span class="r662 r">errorStream</span> = <span class="i">ParserStrings</span>.<span class="i">WarningStream</span>; <b>break</b>;
                    <b>case</b> <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="ast.cs.html#9cb9a8aa5616a489" class="i field">Verbose</a>: <span class="r662 r">errorStream</span> = <span class="i">ParserStrings</span>.<span class="i">VerboseStream</span>; <b>break</b>;
                    <b>case</b> <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="ast.cs.html#179346bf2c8c70e8" class="i field">Debug</a>: <span class="r662 r">errorStream</span> = <span class="i">ParserStrings</span>.<span class="i">DebugStream</span>; <b>break</b>;
                    <b>case</b> <a href="ast.cs.html#56e58ab4dc31cf5f" class="t t">RedirectionStream</a>.<a href="ast.cs.html#6b317670c1b918f0" class="i field">Information</a>: <span class="r662 r">errorStream</span> = <span class="i">ParserStrings</span>.<span class="i">InformationStream</span>; <b>break</b>;
                    <b>default</b>:
                        <b>throw</b> <a href="../../P/6de812d1f374e1ae.html#6de812d1f374e1ae" class="t t">PSTraceSource</a>.<span class="i">NewArgumentOutOfRangeException</span>(<span class="s">&quot;result.FromStream&quot;</span>, <span class="r656 r">result</span>.<a href="ast.cs.html#54d26a89dbf0384f" class="i property">FromStream</a>);
                }
 
                <span class="i">ReportError</span>(<span class="r656 r">result</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">StreamAlreadyRedirected</span>),
                    <span class="i">ParserStrings</span>.<span class="i">StreamAlreadyRedirected</span>,
                    <span class="r662 r">errorStream</span>);
            }
 
            <span class="r655 r">extent</span> = <span class="r656 r">result</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
            <b>return</b> <span class="r656 r">result</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="6ab87e657667a8ae" href="../../R/6ab87e657667a8ae.html" target="n" data-glyph="76,1" class="i method">GetSingleCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a> <span id="r663 rd" class="r663 r">context</span>)
        {
            <b>if</b> (<a href="#ea786851e84d8cea" class="i method">PeekToken</a>().<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a> || <a href="#ea786851e84d8cea" class="i method">PeekToken</a>().<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r664 rd" class="r664 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#d9f88bf7436b84df" class="i field">Command</a>);
                <b>return</b> <a href="#b230abe7ca3d2b4e" class="i method">GetCommandArgument</a>(<span class="r663 r">context</span>, <a href="#98aafb96cd3508ac" class="i method">NextToken</a>());
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r664 r">oldTokenizerMode</span>);
            }
        }
 
        [<span class="i">Flags</span>]
        <b>private enum</b> <a id="d353212a396b4c0a" href="../../R/d353212a396b4c0a.html" target="n" data-glyph="22,1" class="t t"><span id="30ec26f4e44e75df">CommandArgumentContext</span></a>
        {
            <a id="883387f0e772618e" href="../../R/883387f0e772618e.html" target="n" data-glyph="24,2" class="i field">CommandName</a> = 0x01,
            <a id="27a5869aab4dd27c" href="../../R/27a5869aab4dd27c.html" target="n" data-glyph="24,2" class="i field">CommandNameAfterInvocationOperator</a> = 0x02 | <a href="#883387f0e772618e" class="i field">CommandName</a>,
            <a id="56c226fdeaaab47b" href="../../R/56c226fdeaaab47b.html" target="n" data-glyph="24,2" class="i field">FileName</a> = 0x04,
            <a id="87392123862baf4c" href="../../R/87392123862baf4c.html" target="n" data-glyph="24,2" class="i field">CommandArgument</a> = 0x08,
            <a id="dd735003440d40a6" href="../../R/dd735003440d40a6.html" target="n" data-glyph="24,2" class="i field">SwitchCondition</a> = 0x10,
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="b230abe7ca3d2b4e" href="../../R/b230abe7ca3d2b4e.html" target="n" data-glyph="76,1" class="i method">GetCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a> <span id="r665 rd" class="r665 r">context</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r666 rd" class="r666 r">token</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r666 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>, <span class="s">&quot;A unary comma is an error in command mode, and should have already been reported.&quot;</span>);
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r667 rd" class="r667 r">exprAst</span>;
            <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r668 rd" class="r668 r">commandArgs</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r669 rd" class="r669 r">commaToken</span> = <b>null</b>;
            <b>bool</b> <span id="r670 rd" class="r670 r">foundVerbatimArgument</span> = <b>false</b>;
 
            <b>while</b> (<b>true</b>)
            {
                <b>switch</b> (<span class="r666 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
                {
                    <span class="c">// The following tokens are never allowed as command arguments.</span>
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f09193da35fa965b" class="i field">Pipe</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e5f4f5a7b13ffa10" class="i field">Redirection</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#2af5a1104a333244" class="i field">RedirectInStd</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#074f3be81f88796f" class="i field">AndAnd</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a07cbb74e75a87a" class="i field">OrOr</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ed112ae477a73c36" class="i field">Ampersand</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3d9a9ff2e958417f" class="i field">MinusMinus</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>:
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r666 r">token</span>);
 
                        <span class="c">// If we haven&#39;t seen an argument, the caller must issue an error.  If we&#39;ve seen at least one</span>
                        <span class="c">// argument, then we will issue the error and return back the arguments seen so far.</span>
                        <b>if</b> (<span class="r669 r">commaToken</span> == <b>null</b>)
                        {
                            <b>return</b> <b>null</b>;
                        }
 
                        <span class="c">// ErrorRecovery: stop looking for additional arguments, exclude the trailing comma</span>
 
                        <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r669 r">commaToken</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingExpression</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingExpression</span>,
                            <span class="s">&quot;,&quot;</span>);
                        <b>return</b> <b>new</b> <span class="t">ErrorExpressionAst</span>(<span class="i">ExtentOf</span>(<span class="r668 r">commandArgs</span>[0], <span class="r669 r">commaToken</span>), <span class="r668 r">commandArgs</span>);
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4fc017e5ff76f173" class="i field">SplattedVariable</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8b5a9c54e2029553" class="i field">Variable</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4ed416f347b26a1b" class="i field">Number</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b3843759239f0c51" class="i field">HereStringExpandable</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4e0d26e8d7050abc" class="i field">StringExpandable</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a6a2bdb661c2a296" class="i field">HereStringLiteral</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#0c560abdae080116" class="i field">StringLiteral</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#daaf3713e66e6f30" class="i field">DollarParen</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#cf388c7cb0667161" class="i field">AtParen</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ad46aed3b80ba825" class="i field">AtCurly</a>:
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>:
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r666 r">token</span>);
                        <span class="r667 r">exprAst</span> = <a href="#b835651f99e7555e" class="i method">PrimaryExpressionRule</a>(<span class="r671 r">withMemberAccess</span>: <b>true</b>);
                        <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r667 r">exprAst</span> != <b>null</b>, <span class="s">&quot;PrimaryExpressionRule should never return null&quot;</span>);
                        <b>break</b>;
 
                    <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1aeb1084525225c9" class="i field">Generic</a>:
                        <b>if</b> ((<span class="r665 r">context</span> &amp; <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#883387f0e772618e" class="i field">CommandName</a>) != 0)
                        {
                            <span class="r666 r">token</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> |= <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b71c6dfcf4959b35" class="i field">CommandName</a>;
                        }
 
                        <a href="token.cs.html#dce06fb5d7448125" class="k">var</a> <span id="r672 rd" class="r672 r">genericToken</span> = (<a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a>)<span class="r666 r">token</span>;
                        <a href="token.cs.html#7be5d7d2cd2a65ac" class="k">var</a> <span id="r673 rd" class="r673 r">expandableToken</span> = <span class="r672 r">genericToken</span> <b>as</b> <a href="token.cs.html#7be5d7d2cd2a65ac" class="t t">StringExpandableToken</a>;
                        <span class="c">// A command name w/o invocation operator is not expandable even if the token has expandable parts</span>
                        <span class="c">// If we have seen an invocation operator, the command name is expandable.</span>
                        <b>if</b> (<span class="r673 r">expandableToken</span> != <b>null</b> &amp;&amp; <span class="r665 r">context</span> != <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#883387f0e772618e" class="i field">CommandName</a>)
                        {
                            <b>var</b> <span id="r674 rd" class="r674 r">nestedExpressions</span> = <a href="#122ccfcd73508d8e" class="i method">ParseNestedExpressions</a>(<span class="r673 r">expandableToken</span>);
                            <span class="r667 r">exprAst</span> = <b>new</b> <span class="t">ExpandableStringExpressionAst</span>(<span class="r673 r">expandableToken</span>, <span class="r673 r">expandableToken</span>.<a href="token.cs.html#f95f094124370df7" class="i property">Value</a>,
                                                                        <span class="r673 r">expandableToken</span>.<a href="token.cs.html#748bd58514848bc8" class="i property">FormatString</a>, <span class="r674 r">nestedExpressions</span>);
                        }
                        <b>else</b>
                        {
                            <span class="r667 r">exprAst</span> = <b>new</b> <a href="ast.cs.html#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r672 r">genericToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r672 r">genericToken</span>.<a href="token.cs.html#f95f094124370df7" class="i property">Value</a>, <a href="ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="ast.cs.html#7902d7b060b16556" class="i field">BareWord</a>);
 
                            <span class="c">// If this is a verbatim argument, then don&#39;t continue peeking</span>
                            <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r672 r">genericToken</span>.<a href="token.cs.html#f95f094124370df7" class="i property">Value</a>, <a href="#d9090e2972c2cdfd" class="i field">VERBATIM_ARGUMENT</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                            {
                                <span class="r670 r">foundVerbatimArgument</span> = <b>true</b>;
                            }
                        }
 
                        <b>break</b>;
 
                    <b>default</b>:
                        <span class="r667 r">exprAst</span> = <b>new</b> <a href="ast.cs.html#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r666 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r666 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <a href="ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="ast.cs.html#7902d7b060b16556" class="i field">BareWord</a>);
 
                        <span class="c">// A command/argument that matches a keyword isn&#39;t really a keyword, so don&#39;t color it that way</span>
                        <span class="r666 r">token</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> &amp;= ~<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#bffc83c32a1428ea" class="i field">Keyword</a>;
 
                        <b>switch</b> (<span class="r665 r">context</span>)
                        {
                            <b>case</b> <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#883387f0e772618e" class="i field">CommandName</a>:
                            <b>case</b> <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#27a5869aab4dd27c" class="i field">CommandNameAfterInvocationOperator</a>:
                                <span class="r666 r">token</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> |= <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b71c6dfcf4959b35" class="i field">CommandName</a>;
                                <b>break</b>;
                            <b>case</b> <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#56c226fdeaaab47b" class="i field">FileName</a>:
                            <b>case</b> <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#87392123862baf4c" class="i field">CommandArgument</a>:
                            <b>case</b> <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#dd735003440d40a6" class="i field">SwitchCondition</a>:
                                <span class="r666 r">token</span>.<a href="token.cs.html#c0c8e05c7db308ef" class="i method">SetIsCommandArgument</a>();
                                <b>break</b>;
                        }
 
                        <b>break</b>;
                }
 
                <b>if</b> (<span class="r665 r">context</span> != <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#87392123862baf4c" class="i field">CommandArgument</a>)
                {
                    <b>break</b>;
                }
 
                <b>if</b> (<span class="r670 r">foundVerbatimArgument</span>)
                {
                    <b>break</b>;
                }
 
                <span class="r666 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r666 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                {
                    <b>break</b>;
                }
 
                <span class="r669 r">commaToken</span> = <span class="r666 r">token</span>;
                <b>if</b> (<span class="r668 r">commandArgs</span> == <b>null</b>)
                {
                    <span class="r668 r">commandArgs</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;();
                }
 
                <span class="r668 r">commandArgs</span>.<span class="i">Add</span>(<span class="r667 r">exprAst</span>);
 
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <span class="r666 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r668 r">commandArgs</span> != <b>null</b> || <span class="r667 r">exprAst</span> != <b>null</b>, <span class="s">&quot;How did that happen?&quot;</span>);
 
            <b>if</b> (<span class="r668 r">commandArgs</span> != <b>null</b>)
            {
                <span class="r668 r">commandArgs</span>.<span class="i">Add</span>(<span class="r667 r">exprAst</span>);
                <b>return</b> <b>new</b> <span class="t">ArrayLiteralAst</span>(<span class="i">ExtentOf</span>(<span class="r668 r">commandArgs</span>[0], <span class="r668 r">commandArgs</span>[<span class="r668 r">commandArgs</span>.<span class="i">Count</span> - 1]), <span class="r668 r">commandArgs</span>);
            }
 
            <b>return</b> <span class="r667 r">exprAst</span>;
        }
 
        <b>internal</b> <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a> <a id="e1eadfb26e3b4083" href="../../R/e1eadfb26e3b4083.html" target="n" data-glyph="74,1" class="i method">CommandRule</a>(<b>bool</b> <span id="r429 rd" class="r429 r">forDynamicKeyword</span>)
        {
            <span class="c">// G  command:</span>
            <span class="c">// G      command-name   command-elements:opt</span>
            <span class="c">// G      command-invocation-operator   command-module:opt  command-name-expr   command-elements:opt</span>
            <span class="c">// G  command-invocation-operator:  one of</span>
            <span class="c">// G      &#39;&amp;&#39;   &#39;.&#39;</span>
            <span class="c">// G  command-module:</span>
            <span class="c">// G      primary-expression</span>
            <span class="c">// G  command-name:</span>
            <span class="c">// G      generic-token</span>
            <span class="c">// G      generic-token-with-subexpr</span>
            <span class="c">// G  generic-token-with-subexpr: No whitespace is allowed between ) and command-name.</span>
            <span class="c">// G      generic-token-with-subexpr-start   statement-list:opt   )   command-name</span>
            <span class="c">// G  command-name-expr:</span>
            <span class="c">// G      command-name</span>
            <span class="c">// G      primary-expression</span>
            <span class="c">// G  command-elements:</span>
            <span class="c">// G      command-element</span>
            <span class="c">// G      command-elements   command-element</span>
            <span class="c">// G  command-element:</span>
            <span class="c">// G      command-parameter</span>
            <span class="c">// G      command-argument</span>
            <span class="c">// G      redirection</span>
            <span class="c">// G  command-argument:</span>
            <span class="c">// G      command-name-expr</span>
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r675 rd" class="r675 r">firstToken</span>;
            <b>bool</b> <span id="r676 rd" class="r676 r">dotSource</span>, <span id="r677 rd" class="r677 r">ampersand</span>;
            <b>bool</b> <span id="r678 rd" class="r678 r">sawDashDash</span> = <b>false</b>;
            <b>bool</b> <span id="r679 rd" class="r679 r">foundVerbatimArgument</span> = <b>false</b>;
 
            <a href="ast.cs.html#62235daca4a9c495" class="t t">RedirectionAst</a>[] <span id="r680 rd" class="r680 r">redirections</span> = <b>null</b>;
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r681 rd" class="r681 r">endExtent</span>;
            <b>var</b> <span id="r682 rd" class="r682 r">elements</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a>&gt;();
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r683 rd" class="r683 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#d9f88bf7436b84df" class="i field">Command</a>);
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r684 rd" class="r684 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <span class="r675 r">firstToken</span> = <span class="r684 r">token</span>;
                <span class="r681 r">endExtent</span> = <span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
 
                <span class="r676 r">dotSource</span> = <b>false</b>;
                <span class="r677 r">ampersand</span> = <b>false</b>;
 
                <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a> <span id="r685 rd" class="r685 r">context</span>;
                <b>if</b> (<span class="r684 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9023444a1ee3a84" class="i field">Dot</a>)
                {
                    <span class="r676 r">dotSource</span> = <b>true</b>;
                    <span class="r684 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                    <span class="r685 r">context</span> = <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#27a5869aab4dd27c" class="i field">CommandNameAfterInvocationOperator</a>;
                }
                <b>else</b> <b>if</b> (<span class="r684 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ed112ae477a73c36" class="i field">Ampersand</a>)
                {
                    <span class="r677 r">ampersand</span> = <b>true</b>;
                    <span class="r684 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                    <span class="r685 r">context</span> = <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#27a5869aab4dd27c" class="i field">CommandNameAfterInvocationOperator</a>;
                }
                <b>else</b>
                {
                    <span class="r685 r">context</span> = <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#883387f0e772618e" class="i field">CommandName</a>;
                }
 
                <b>bool</b> <span id="r686 rd" class="r686 r">scanning</span> = <b>true</b>;
                <b>while</b> (<span class="r686 r">scanning</span>)
                {
                    <b>switch</b> (<span class="r684 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
                    {
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f09193da35fa965b" class="i field">Pipe</a>:
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>:
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>:
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#600440634a32d0c4" class="i field">EndOfInput</a>:
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a>:
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>:
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#074f3be81f88796f" class="i field">AndAnd</a>:
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a07cbb74e75a87a" class="i field">OrOr</a>:
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ed112ae477a73c36" class="i field">Ampersand</a>:
                            <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r684 r">token</span>);
                            <span class="r686 r">scanning</span> = <b>false</b>;
                            <b>continue</b>;
 
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3d9a9ff2e958417f" class="i field">MinusMinus</a>:
                            <span class="r681 r">endExtent</span> = <span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                            <span class="c">// Add the first -- as a parameter, which is then ignored when constructing the command processor unless it&#39;s a native</span>
                            <span class="c">// command.  All subsequent -- are added as arguments.</span>
                            <span class="r682 r">elements</span>.<span class="i">Add</span>(<span class="r678 r">sawDashDash</span>
                                ? (<a href="ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a>)<b>new</b> <a href="ast.cs.html#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r684 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <a href="ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="ast.cs.html#7902d7b060b16556" class="i field">BareWord</a>)
                                : <b>new</b> <a href="ast.cs.html#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="s">&quot;-&quot;</span>, <b>null</b>, <span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
                            <span class="r678 r">sawDashDash</span> = <b>true</b>;
                            <b>break</b>;
 
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>:
                            <span class="r681 r">endExtent</span> = <span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                            <span class="i">ReportError</span>(<span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingArgument</span>),
                                <span class="i">ParserStrings</span>.<span class="i">MissingArgument</span>);
                            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                            <b>break</b>;
 
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c3ec93ee8b22aa7f" class="i field">Parameter</a>:
                            <b>if</b> ((<span class="r685 r">context</span> &amp; <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#883387f0e772618e" class="i field">CommandName</a>) != 0 || <span class="r678 r">sawDashDash</span>)
                            {
                                <span class="r681 r">endExtent</span> = <span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                                <span class="r684 r">token</span>.<a href="token.cs.html#f9d0ded14a71a369" class="i property">TokenFlags</a> |= <a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#b71c6dfcf4959b35" class="i field">CommandName</a>;
                                <a href="ast.cs.html#e18e1bad255cd022" class="k">var</a> <span id="r687 rd" class="r687 r">commandName</span> = <b>new</b> <a href="ast.cs.html#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r684 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <a href="ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="ast.cs.html#7902d7b060b16556" class="i field">BareWord</a>);
                                <span class="r682 r">elements</span>.<span class="i">Add</span>(<span class="r687 r">commandName</span>);
                                <b>break</b>;
                            }
 
                            <a href="token.cs.html#ee13ee02b3131929" class="k">var</a> <span id="r688 rd" class="r688 r">parameterToken</span> = (<a href="token.cs.html#ee13ee02b3131929" class="t t">ParameterToken</a>)<span class="r684 r">token</span>;
                            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r689 rd" class="r689 r">parameterArgs</span>;
                            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r690 rd" class="r690 r">extent</span>;
                            <span class="c">// If the next token is a comma, don&#39;t grab it as part of the argument.  The next time through this</span>
                            <span class="c">// loop will issue an error.</span>
                            <b>if</b> (<span class="r688 r">parameterToken</span>.<a href="token.cs.html#22ffb3fe3f47e60e" class="i property">UsedColon</a> &amp;&amp; <a href="#ea786851e84d8cea" class="i method">PeekToken</a>().<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                            {
                                <span class="r689 r">parameterArgs</span> = <a href="#b230abe7ca3d2b4e" class="i method">GetCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#87392123862baf4c" class="i field">CommandArgument</a>, <a href="#98aafb96cd3508ac" class="i method">NextToken</a>());
                                <b>if</b> (<span class="r689 r">parameterArgs</span> == <b>null</b>)
                                {
                                    <span class="r690 r">extent</span> = <span class="r688 r">parameterToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                                    <span class="i">ReportError</span>(<a href="#44fc203b5b5d4ad4" class="i method">After</a>(<span class="r690 r">extent</span>),
                                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ParameterRequiresArgument</span>),
                                        <span class="i">ParserStrings</span>.<span class="i">ParameterRequiresArgument</span>,
                                        <span class="r688 r">parameterToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                                }
                                <b>else</b>
                                {
                                    <span class="r690 r">extent</span> = <a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r684 r">token</span>, <span class="r689 r">parameterArgs</span>);
                                }
                            }
                            <b>else</b>
                            {
                                <span class="r689 r">parameterArgs</span> = <b>null</b>;
                                <span class="r690 r">extent</span> = <span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                            }
 
                            <span class="r681 r">endExtent</span> = <span class="r690 r">extent</span>;
                            <a href="ast.cs.html#b97c3b8b32a8faec" class="k">var</a> <span id="r691 rd" class="r691 r">paramAst</span> = <b>new</b> <a href="ast.cs.html#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<span class="r690 r">extent</span>, <span class="r688 r">parameterToken</span>.<a href="token.cs.html#c72db3af1374663c" class="i property">ParameterName</a>, <span class="r689 r">parameterArgs</span>, <span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
                            <span class="r682 r">elements</span>.<span class="i">Add</span>(<span class="r691 r">paramAst</span>);
                            <b>break</b>;
 
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e5f4f5a7b13ffa10" class="i field">Redirection</a>:
                        <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#2af5a1104a333244" class="i field">RedirectInStd</a>:
                            <b>if</b> ((<span class="r685 r">context</span> &amp; <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#883387f0e772618e" class="i field">CommandName</a>) == 0)
                            {
                                <b>if</b> (<span class="r680 r">redirections</span> == <b>null</b>)
                                {
                                    <span class="r680 r">redirections</span> = <b>new</b> <a href="ast.cs.html#62235daca4a9c495" class="t t">RedirectionAst</a>[<a href="ast.cs.html#dd8dd8a40be8b41f" class="t t">CommandBaseAst</a>.<a href="ast.cs.html#80ff30fa4d2e1f56" class="i field">MaxRedirections</a>];
                                }
 
                                <a href="#210e22a8c53156b3" class="i method">RedirectionRule</a>((<a href="token.cs.html#0cf16cab44989c21" class="t t">RedirectionToken</a>)<span class="r684 r">token</span>, <span class="r680 r">redirections</span>, <b>ref</b> <span class="r681 r">endExtent</span>);
                            }
                            <b>else</b>
                            {
                                <span class="c">// For backwards compatibility, we allow redirection operators as command names.</span>
                                <span class="c">// V2 did not allow:</span>
                                <span class="c">//     &amp; &lt;&lt;</span>
                                <span class="c">// but V3 and on will because it falls out rather naturally here.</span>
                                <span class="r681 r">endExtent</span> = <span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                                <span class="r682 r">elements</span>.<span class="i">Add</span>(<b>new</b> <a href="ast.cs.html#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r684 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r684 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>, <a href="ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="ast.cs.html#7902d7b060b16556" class="i field">BareWord</a>));
                            }
 
                            <b>break</b>;
 
                        <b>default</b>:
                            <b>if</b> (<span class="r684 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#7002a360506192c2" class="i field">InlineScript</a> &amp;&amp; <span class="r685 r">context</span> == <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#883387f0e772618e" class="i field">CommandName</a>)
                            {
                                <span class="r686 r">scanning</span> = <a href="#7f829b3002a4621d" class="i method">InlineScriptRule</a>(<span class="r684 r">token</span>, <span class="r682 r">elements</span>);
                                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r682 r">elements</span>.<span class="i">Count</span> &gt;= 1, <span class="s">&quot;We should at least have the command name: inlinescript&quot;</span>);
                                <span class="r681 r">endExtent</span> = <span class="r682 r">elements</span>.<span class="i">Last</span>().<span class="i">Extent</span>;
 
                                <b>if</b> (!<span class="r686 r">scanning</span>) { <b>continue</b>; }
                            }
                            <b>else</b>
                            {
                                <a href="ast.cs.html#78a833319fe635b4" class="k">var</a> <span id="r692 rd" class="r692 r">ast</span> = <a href="#b230abe7ca3d2b4e" class="i method">GetCommandArgument</a>(<span class="r685 r">context</span>, <span class="r684 r">token</span>);
 
                                <span class="c">// If this is the special verbatim argument syntax, look for the next element</span>
                                <a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a> <span id="r693 rd" class="r693 r">argumentToken</span> = <span class="r684 r">token</span> <b>as</b> <a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a>;
                                <b>if</b> ((<span class="r693 r">argumentToken</span> != <b>null</b>) &amp;&amp; <b>string</b>.<span class="i">Equals</span>(<span class="r693 r">argumentToken</span>.<a href="token.cs.html#f95f094124370df7" class="i property">Value</a>, <a href="#d9090e2972c2cdfd" class="i field">VERBATIM_ARGUMENT</a>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>))
                                {
                                    <span class="r682 r">elements</span>.<span class="i">Add</span>(<span class="r692 r">ast</span>);
                                    <span class="r681 r">endExtent</span> = <span class="r692 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
 
                                    <a href="token.cs.html#dce06fb5d7448125" class="k">var</a> <span id="r694 rd" class="r694 r">verbatimToken</span> = <a href="#e6e7524f3bd072d3" class="i method">GetVerbatimCommandArgumentToken</a>();
                                    <b>if</b> (<span class="r694 r">verbatimToken</span> != <b>null</b>)
                                    {
                                        <span class="r679 r">foundVerbatimArgument</span> = <b>true</b>;
                                        <span class="r686 r">scanning</span> = <b>false</b>;
                                        <span class="r692 r">ast</span> = <b>new</b> <a href="ast.cs.html#9347f3b86ace4042" class="t constructor">StringConstantExpressionAst</a>(<span class="r694 r">verbatimToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r694 r">verbatimToken</span>.<a href="token.cs.html#f95f094124370df7" class="i property">Value</a>, <a href="ast.cs.html#9280da14e6db65ed" class="t t">StringConstantType</a>.<a href="ast.cs.html#7902d7b060b16556" class="i field">BareWord</a>);
                                        <span class="r682 r">elements</span>.<span class="i">Add</span>(<span class="r692 r">ast</span>);
                                        <span class="r681 r">endExtent</span> = <span class="r692 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                                    }
 
                                    <b>break</b>;
                                }
 
                                <span class="r681 r">endExtent</span> = <span class="r692 r">ast</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
                                <span class="r682 r">elements</span>.<span class="i">Add</span>(<span class="r692 r">ast</span>);
                            }
 
                            <b>break</b>;
                    }
 
                    <b>if</b> (!<span class="r679 r">foundVerbatimArgument</span>)
                    {
                        <span class="r685 r">context</span> = <a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#87392123862baf4c" class="i field">CommandArgument</a>;
                        <span class="r684 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                    }
                }
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r683 r">oldTokenizerMode</span>);
            }
 
            <b>if</b> (<span class="r682 r">elements</span>.<span class="i">Count</span> == 0)
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<span class="r429 r">forDynamicKeyword</span>, <span class="s">&quot;DynamicKeyword should have command name at least&quot;</span>);
 
                <b>if</b> (<span class="r676 r">dotSource</span> || <span class="r677 r">ampersand</span>)
                {
                    <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r695 rd" class="r695 r">extent</span> = <span class="r675 r">firstToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
                    <span class="i">ReportError</span>(<span class="r695 r">extent</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingExpression</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingExpression</span>,
                        <span class="r675 r">firstToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                }
 
                <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (<span class="r429 r">forDynamicKeyword</span>)
            {
                <span class="c">// TODO: report error if any redirections</span>
                <b>return</b> <b>new</b> <span class="t">DynamicKeywordStatementAst</span>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r675 r">firstToken</span>, <span class="r681 r">endExtent</span>), <span class="r682 r">elements</span>);
            }
 
            <b>return</b> <b>new</b> <span class="t">CommandAst</span>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r675 r">firstToken</span>, <span class="r681 r">endExtent</span>), <span class="r682 r">elements</span>,
                                  <span class="r676 r">dotSource</span> || <span class="r677 r">ampersand</span> ? <span class="r675 r">firstToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> : <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a>,
                                  <span class="r680 r">redirections</span>?.<span class="i">Where</span>(<b>static</b> <span id="r696 rd" class="r696 r">r</span> =&gt; <span class="r696 r">r</span> != <b>null</b>));
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Pipelines
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Expressions
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Parse an expression.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r697 r">endNumberOnTernaryOpChars</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When it&#39;s known for sure that we are expecting an expression, allowing a generic token like &#39;12?&#39; or &#39;12:&#39; is</span>
        <span class="c">///</span><span class="c"> not useful. In those cases, we force to start a new token upon seeing &#39;?&#39; and &#39;:&#39; when scanning for a number</span>
        <span class="c">///</span><span class="c"> by setting this parameter to true, hoping to find a ternary expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="8da955af7d659a21" href="../../R/8da955af7d659a21.html" target="n" data-glyph="76,1" class="i method">ExpressionRule</a>(<b>bool</b> <span id="r697 rd" class="r697 r">endNumberOnTernaryOpChars</span> = <b>false</b>)
        {
            <span class="c">// G  expression:</span>
            <span class="c">// G      logical-expression</span>
            <span class="c">// G</span>
            <span class="c">// G  logical-expression:</span>
            <span class="c">// G      binary-expression</span>
            <span class="c">// G      ternary-expression</span>
            <span class="c">// G</span>
            <span class="c">// G  ternary-expression:</span>
            <span class="c">// G      binary-expression   &#39;?&#39;   new-lines:opt   ternary-expression   new-lines:opt   &#39;:&#39;   new-lines:opt   ternary-expression</span>
 
            <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r698 rd" class="r698 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#9b6269e007d113c3" class="i field">Expression</a>);
 
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r699 rd" class="r699 r">condition</span> = <a href="#4e580f51c998093f" class="i method">BinaryExpressionRule</a>(<span class="r697 r">endNumberOnTernaryOpChars</span>);
                <b>if</b> (<span class="r699 r">condition</span> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r700 rd" class="r700 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
 
                <b>if</b> (<span class="r700 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#59fc719fefc40227" class="i field">QuestionMark</a>)
                {
                    <b>return</b> <span class="r699 r">condition</span>;
                }
 
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <span class="c">// We have seen the ternary operator &#39;?&#39; and now expecting the &#39;IfFalse&#39; expression.</span>
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r701 rd" class="r701 r">ifTrue</span> = <a href="#8da955af7d659a21" class="i method">ExpressionRule</a>(<span class="r697 r">endNumberOnTernaryOpChars</span>: <b>true</b>);
                <b>if</b> (<span class="r701 r">ifTrue</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: create an error expression to fill out the ast and keep parsing.</span>
                    <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r702 rd" class="r702 r">extent</span> = <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r700 r">token</span>);
 
                    <span class="i">ReportIncompleteInput</span>(
                        <span class="r702 r">extent</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ExpectedValueExpression</span>),
                        <span class="i">ParserStrings</span>.<span class="i">ExpectedValueExpression</span>,
                        <span class="r700 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                    <span class="r701 r">ifTrue</span> = <b>new</b> <a href="ast.cs.html#521987ae533dc4bd" class="t constructor">ErrorExpressionAst</a>(<span class="r702 r">extent</span>);
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <span class="r700 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r700 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a3c2c007e625be62" class="i field">Colon</a>)
                {
                    <b>var</b> <span id="r703 rd" class="r703 r">componentAsts</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>&gt;() { <span class="r699 r">condition</span> };
 
                    <span class="c">// ErrorRecovery: we have done the expression parsing and should try parsing something else.</span>
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r700 r">token</span>);
 
                    <span class="c">// Don&#39;t bother reporting this error if we already reported an empty &#39;IfTrue&#39; operand error.</span>
                    <b>if</b> (<span class="r701 r">ifTrue</span> <b>is not</b> <a href="ast.cs.html#bdf2b3276843e0c2" class="t t">ErrorExpressionAst</a>)
                    {
                        <span class="r703 r">componentAsts</span>.<span class="i">Add</span>(<span class="r701 r">ifTrue</span>);
                        <span class="i">ReportIncompleteInput</span>(
                            <span class="r700 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingColonInTernaryExpression</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingColonInTernaryExpression</span>);
                    }
 
                    <b>return</b> <b>new</b> <span class="t">ErrorExpressionAst</span>(<a href="#a571f93282f04222" class="i method">ExtentOf</a>(<span class="r699 r">condition</span>, <a href="#cb433f96b9585085" class="i method">Before</a>(<span class="r700 r">token</span>)), <span class="r703 r">componentAsts</span>);
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r704 rd" class="r704 r">ifFalse</span> = <a href="#8da955af7d659a21" class="i method">ExpressionRule</a>(<span class="r697 r">endNumberOnTernaryOpChars</span>: <b>true</b>);
                <b>if</b> (<span class="r704 r">ifFalse</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: create an error expression to fill out the ast and keep parsing.</span>
                    <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r705 rd" class="r705 r">extent</span> = <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r700 r">token</span>);
 
                    <span class="i">ReportIncompleteInput</span>(
                        <span class="r705 r">extent</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ExpectedValueExpression</span>),
                        <span class="i">ParserStrings</span>.<span class="i">ExpectedValueExpression</span>,
                        <span class="r700 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                    <span class="r704 r">ifFalse</span> = <b>new</b> <a href="ast.cs.html#521987ae533dc4bd" class="t constructor">ErrorExpressionAst</a>(<span class="r705 r">extent</span>);
                }
 
                <b>return</b> <b>new</b> <a href="ast.cs.html#adda7d3b76cf30cd" class="t constructor">TernaryExpressionAst</a>(<a href="#f4b9cf4dcd548ea3" class="i method">ExtentOf</a>(<span class="r699 r">condition</span>, <span class="r704 r">ifFalse</span>), <span class="r699 r">condition</span>, <span class="r701 r">ifTrue</span>, <span class="r704 r">ifFalse</span>);
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r698 r">oldTokenizerMode</span>);
            }
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Parse a binary expression.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r706 r">endNumberOnTernaryOpChars</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When it&#39;s known for sure that we are expecting an expression, allowing a generic token like &#39;12?&#39; or &#39;12:&#39; is</span>
        <span class="c">///</span><span class="c"> not useful. In those cases, we force to start a new token upon seeing &#39;?&#39; and &#39;:&#39; when scanning for a number</span>
        <span class="c">///</span><span class="c"> by setting this parameter to true, hoping to find a ternary expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="4e580f51c998093f" href="../../R/4e580f51c998093f.html" target="n" data-glyph="76,1" class="i method">BinaryExpressionRule</a>(<b>bool</b> <span id="r706 rd" class="r706 r">endNumberOnTernaryOpChars</span> = <b>false</b>)
        {
            <span class="c">// G  binary-expression:</span>
            <span class="c">// G      bitwise-expression</span>
            <span class="c">// G      binary-expression   &#39;-and&#39;   new-lines:opt   bitwise-expression</span>
            <span class="c">// G      binary-expression   &#39;-or&#39;   new-lines:opt   bitwise-expression</span>
            <span class="c">// G      binary-expression   &#39;-xor&#39;   new-lines:opt   bitwise-expression</span>
            <span class="c">// G</span>
            <span class="c">// G  bitwise-expression:</span>
            <span class="c">// G      comparison-expression</span>
            <span class="c">// G      bitwise-expression   &#39;-band&#39;   new-lines:opt   comparison-expression</span>
            <span class="c">// G      bitwise-expression   &#39;-bor&#39;   new-lines:opt   comparison-expression</span>
            <span class="c">// G      bitwise-expression   &#39;-bxor&#39;   new-lines:opt   comparison-expression</span>
            <span class="c">// G</span>
            <span class="c">// G  comparison-expression:</span>
            <span class="c">// G      nullcoalesce-expression</span>
            <span class="c">// G      comparison-expression   comparison-operator   new-lines:opt   nullcoalesce-expression</span>
            <span class="c">// G</span>
            <span class="c">// G  nullcoalesce-expression:</span>
            <span class="c">// G      additive-expression</span>
            <span class="c">// G      nullcoalesce-expression   &#39;??&#39;   new-lines:opt   additive-expression</span>
            <span class="c">// G</span>
            <span class="c">// G  additive-expression:</span>
            <span class="c">// G      multiplicative-expression</span>
            <span class="c">// G      additive-expression   &#39;+&#39;   new-lines:opt   multiplicative-expression</span>
            <span class="c">// G      additive-expression   dash   new-lines:opt   multiplicative-expression</span>
            <span class="c">// G</span>
            <span class="c">// G  multiplicative-expression:</span>
            <span class="c">// G      format-expression</span>
            <span class="c">// G      multiplicative-expression   &#39;*&#39;   new-lines:opt   format-expression</span>
            <span class="c">// G      multiplicative-expression   &#39;/&#39;   new-lines:opt   format-expression</span>
            <span class="c">// G      multiplicative-expression   &#39;%&#39;   new-lines:opt   format-expression</span>
            <span class="c">// G</span>
            <span class="c">// G  format-expression:</span>
            <span class="c">// G      range-expression</span>
            <span class="c">// G      format-expression   format-operator    new-lines:opt   range-expression</span>
            <span class="c">// G</span>
            <span class="c">// G  range-expression:</span>
            <span class="c">// G      array-literal-expression</span>
            <span class="c">// G      range-expression   &#39;..&#39;   new-lines:opt   array-literal-expression</span>
            <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r707 rd" class="r707 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#9b6269e007d113c3" class="i field">Expression</a>);
 
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r708 rd" class="r708 r">lhs</span>, <span id="r709 rd" class="r709 r">rhs</span>;
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r710 rd" class="r710 r">expr</span> = <a href="#1054519f3e821cb4" class="i method">ArrayLiteralRule</a>(<span class="r706 r">endNumberOnTernaryOpChars</span>);
 
                <b>if</b> (<span class="r710 r">expr</span> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <a href="token.cs.html#ee13ee02b3131929" class="t t">ParameterToken</a> <span id="r711 rd" class="r711 r">paramToken</span>;
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r712 rd" class="r712 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (!<span class="r712 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#84def6774d758bed" class="i method">HasTrait</a>(<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#359e25a8812963af" class="i field">BinaryOperator</a>))
                {
                    <span class="r711 r">paramToken</span> = <span class="r712 r">token</span> <b>as</b> <a href="token.cs.html#ee13ee02b3131929" class="t t">ParameterToken</a>;
                    <b>if</b> (<span class="r711 r">paramToken</span> != <b>null</b>)
                    {
                        <b>return</b> <a href="#fd1fba0d47b08e77" class="i method">ErrorRecoveryParameterInExpression</a>(<span class="r711 r">paramToken</span>, <span class="r710 r">expr</span>);
                    }
 
                    <b>return</b> <span class="r710 r">expr</span>;
                }
                <b>else</b> <b>if</b> (<span class="r712 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#074f3be81f88796f" class="i field">AndAnd</a> || <span class="r712 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a07cbb74e75a87a" class="i field">OrOr</a>)
                {
                    <b>return</b> <span class="r710 r">expr</span>;
                }
 
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
 
                <span class="i">Stack</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r713 rd" class="r713 r">operandStack</span> = <b>new</b> <span class="i">Stack</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;();
                <span class="i">Stack</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r714 rd" class="r714 r">operatorStack</span> = <b>new</b> <span class="i">Stack</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt;();
 
                <span class="r713 r">operandStack</span>.<span class="i">Push</span>(<span class="r710 r">expr</span>);
                <span class="r714 r">operatorStack</span>.<span class="i">Push</span>(<span class="r712 r">token</span>);
 
                <b>int</b> <span id="r715 rd" class="r715 r">precedence</span> = <span class="r712 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#02de04bf6ad64186" class="i method">GetBinaryPrecedence</a>();
                <b>while</b> (<b>true</b>)
                {
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                    <span class="c">// We have seen a binary operator token and now expecting the right-hand-side expression.</span>
                    <span class="r710 r">expr</span> = <a href="#1054519f3e821cb4" class="i method">ArrayLiteralRule</a>(<span class="r716 r">endNumberOnTernaryOpChars</span>: <b>true</b>);
                    <b>if</b> (<span class="r710 r">expr</span> == <b>null</b>)
                    {
                        <span class="c">// ErrorRecovery: create an error expression to fill out the ast and keep parsing.</span>
                        <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r717 rd" class="r717 r">extent</span> = <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r712 r">token</span>);
 
                        <span class="c">// Use token.Text, not token.Kind.Text() b/c the kind might not match the actual operator used</span>
                        <span class="c">// when a case insensitive operator is used.</span>
                        <span class="i">ReportIncompleteInput</span>(
                            <span class="r717 r">extent</span>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ExpectedValueExpression</span>),
                            <span class="i">ParserStrings</span>.<span class="i">ExpectedValueExpression</span>,
                            <span class="r712 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
 
                        <span class="r710 r">expr</span> = <b>new</b> <a href="ast.cs.html#521987ae533dc4bd" class="t constructor">ErrorExpressionAst</a>(<span class="r717 r">extent</span>);
                    }
 
                    <span class="r713 r">operandStack</span>.<span class="i">Push</span>(<span class="r710 r">expr</span>);
 
                    <span class="r712 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
 
                    <b>if</b> (!<span class="r712 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#84def6774d758bed" class="i method">HasTrait</a>(<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#359e25a8812963af" class="i field">BinaryOperator</a>))
                    {
                        <span class="c">// Remember the token that we stopped on, but only parameters, used for error recovery</span>
                        <span class="r711 r">paramToken</span> = <span class="r712 r">token</span> <b>as</b> <a href="token.cs.html#ee13ee02b3131929" class="t t">ParameterToken</a>;
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r712 r">token</span>);
                        <b>break</b>;
                    }
 
                    <b>int</b> <span id="r718 rd" class="r718 r">newPrecedence</span> = <span class="r712 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#02de04bf6ad64186" class="i method">GetBinaryPrecedence</a>();
                    <b>while</b> (<span class="r718 r">newPrecedence</span> &lt;= <span class="r715 r">precedence</span>)
                    {
                        <span class="r709 r">rhs</span> = <span class="r713 r">operandStack</span>.<span class="i">Pop</span>();
                        <span class="r708 r">lhs</span> = <span class="r713 r">operandStack</span>.<span class="i">Pop</span>();
                        <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r719 rd" class="r719 r">op</span> = <span class="r714 r">operatorStack</span>.<span class="i">Pop</span>();
                        <span class="r713 r">operandStack</span>.<span class="i">Push</span>(<b>new</b> <a href="ast.cs.html#285ee0c928c6e703" class="t constructor">BinaryExpressionAst</a>(<a href="#f4b9cf4dcd548ea3" class="i method">ExtentOf</a>(<span class="r708 r">lhs</span>, <span class="r709 r">rhs</span>), <span class="r708 r">lhs</span>, <span class="r719 r">op</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>, <span class="r709 r">rhs</span>, <span class="r719 r">op</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>));
                        <b>if</b> (<span class="r714 r">operatorStack</span>.<span class="i">Count</span> == 0)
                        {
                            <b>break</b>;
                        }
                        <span class="r715 r">precedence</span> = <span class="r714 r">operatorStack</span>.<span class="i">Peek</span>().<span class="i">Kind</span>.<span class="i">GetBinaryPrecedence</span>();
                    }
 
                    <span class="r714 r">operatorStack</span>.<span class="i">Push</span>(<span class="r712 r">token</span>);
                    <span class="r715 r">precedence</span> = <span class="r718 r">newPrecedence</span>;
                }
 
                <span class="r709 r">rhs</span> = <span class="r713 r">operandStack</span>.<span class="i">Pop</span>();
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r713 r">operandStack</span>.<span class="i">Count</span> == <span class="r714 r">operatorStack</span>.<span class="i">Count</span>, <span class="s">&quot;Stacks out of sync&quot;</span>);
                <b>while</b> (<span class="r713 r">operandStack</span>.<span class="i">Count</span> &gt; 0)
                {
                    <span class="r708 r">lhs</span> = <span class="r713 r">operandStack</span>.<span class="i">Pop</span>();
                    <span class="r712 r">token</span> = <span class="r714 r">operatorStack</span>.<span class="i">Pop</span>();
                    <span class="r709 r">rhs</span> = <b>new</b> <a href="ast.cs.html#285ee0c928c6e703" class="t constructor">BinaryExpressionAst</a>(<a href="#f4b9cf4dcd548ea3" class="i method">ExtentOf</a>(<span class="r708 r">lhs</span>, <span class="r709 r">rhs</span>), <span class="r708 r">lhs</span>, <span class="r712 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>, <span class="r709 r">rhs</span>, <span class="r712 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
                }
 
                <b>if</b> (<span class="r711 r">paramToken</span> != <b>null</b>)
                {
                    <b>return</b> <a href="#fd1fba0d47b08e77" class="i method">ErrorRecoveryParameterInExpression</a>(<span class="r711 r">paramToken</span>, <span class="r709 r">rhs</span>);
                }
 
                <b>return</b> <span class="r709 r">rhs</span>;
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r707 r">oldTokenizerMode</span>);
            }
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="fd1fba0d47b08e77" href="../../R/fd1fba0d47b08e77.html" target="n" data-glyph="76,1" class="i method">ErrorRecoveryParameterInExpression</a>(<a href="token.cs.html#ee13ee02b3131929" class="t t">ParameterToken</a> <span id="r720 rd" class="r720 r">paramToken</span>, <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r721 rd" class="r721 r">expr</span>)
        {
            <span class="c">// ErrorRecovery - when we have a parameter in an expression, eat it under the assumption</span>
            <span class="c">// that it&#39;s an incomplete operator.  This simplifies analysis later, e.g. trying to autocomplete</span>
            <span class="c">// operators.</span>
 
            <span class="i">ReportError</span>(<span class="r720 r">paramToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>),
                <span class="i">ParserStrings</span>.<span class="i">UnexpectedToken</span>,
                <span class="r720 r">paramToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
            <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
            <b>return</b> <b>new</b> <span class="t">ErrorExpressionAst</span>(<a href="#4ad82407bcef8f0d" class="i method">ExtentOf</a>(<span class="r721 r">expr</span>, <span class="r720 r">paramToken</span>),
                <b>new</b> <a href="ast.cs.html#d47621d83efd14de" class="t t">Ast</a>[] {
                    <span class="r721 r">expr</span>,
                    <b>new</b> <a href="ast.cs.html#1a9adbfa2026244e" class="t constructor">CommandParameterAst</a>(<span class="r720 r">paramToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r720 r">paramToken</span>.<a href="token.cs.html#c72db3af1374663c" class="i property">ParameterName</a>, <b>null</b>, <span class="r720 r">paramToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>)});
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Parse an array literal expression.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r716 r">endNumberOnTernaryOpChars</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When it&#39;s known for sure that we are expecting an expression, allowing a generic token like &#39;12?&#39; or &#39;12:&#39; is</span>
        <span class="c">///</span><span class="c"> not useful. In those cases, we force to start a new token upon seeing &#39;?&#39; and &#39;:&#39; when scanning for a number</span>
        <span class="c">///</span><span class="c"> by setting this parameter to true, hoping to find a ternary expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="1054519f3e821cb4" href="../../R/1054519f3e821cb4.html" target="n" data-glyph="76,1" class="i method">ArrayLiteralRule</a>(<b>bool</b> <span id="r716 rd" class="r716 r">endNumberOnTernaryOpChars</span> = <b>false</b>)
        {
            <span class="c">// G  array-literal-expression:</span>
            <span class="c">// G      unary-expression</span>
            <span class="c">// G      unary-expression   &#39;,&#39;    new-lines:opt   array-literal-expression</span>
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r722 rd" class="r722 r">lastExpr</span> = <a href="#8b954079b3dc7b2c" class="i method">UnaryExpressionRule</a>(<span class="r716 r">endNumberOnTernaryOpChars</span>);
            <b>if</b> (<span class="r722 r">lastExpr</span> == <b>null</b>)
            {
                <b>return</b> <b>null</b>;
            }
 
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r723 rd" class="r723 r">firstExpr</span> = <span class="r722 r">lastExpr</span>;
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r724 rd" class="r724 r">commaToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <b>if</b> (<span class="r724 r">commaToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a> || <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a>)
            {
                <b>return</b> <span class="r722 r">lastExpr</span>;
            }
 
            <b>var</b> <span id="r725 rd" class="r725 r">arrayValues</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; { <span class="r722 r">lastExpr</span> };
 
            <b>while</b> (<span class="r724 r">commaToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
            {
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <span class="c">// We have seen a comma token and now expecting an expression as an array element.</span>
                <span class="r722 r">lastExpr</span> = <a href="#8b954079b3dc7b2c" class="i method">UnaryExpressionRule</a>(<span class="r726 r">endNumberOnTernaryOpChars</span>: <b>true</b>);
                <b>if</b> (<span class="r722 r">lastExpr</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: create an error expression for the ast and break.</span>
                    <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r724 r">commaToken</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterToken</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterToken</span>,
                        <span class="r724 r">commaToken</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
                    <span class="r722 r">lastExpr</span> = <b>new</b> <a href="ast.cs.html#521987ae533dc4bd" class="t constructor">ErrorExpressionAst</a>(<span class="r724 r">commaToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
                    <span class="r725 r">arrayValues</span>.<span class="i">Add</span>(<span class="r722 r">lastExpr</span>);
                    <b>break</b>;
                }
 
                <span class="r725 r">arrayValues</span>.<span class="i">Add</span>(<span class="r722 r">lastExpr</span>);
 
                <span class="r724 r">commaToken</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            }
 
            <b>return</b> <b>new</b> <span class="t">ArrayLiteralAst</span>(<a href="#f4b9cf4dcd548ea3" class="i method">ExtentOf</a>(<span class="r723 r">firstExpr</span>, <span class="r722 r">lastExpr</span>), <span class="r725 r">arrayValues</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Parse an unary expression.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r726 r">endNumberOnTernaryOpChars</span><span class="c">&quot;</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> When it&#39;s known for sure that we are expecting an expression, allowing a generic token like &#39;12?&#39; or &#39;12:&#39; is</span>
        <span class="c">///</span><span class="c"> not useful. In those cases, we force to start a new token upon seeing &#39;?&#39; and &#39;:&#39; when scanning for a number</span>
        <span class="c">///</span><span class="c"> by setting this parameter to true, hoping to find a ternary expression.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="8b954079b3dc7b2c" href="../../R/8b954079b3dc7b2c.html" target="n" data-glyph="76,1" class="i method">UnaryExpressionRule</a>(<b>bool</b> <span id="r726 rd" class="r726 r">endNumberOnTernaryOpChars</span> = <b>false</b>)
        {
            <span class="c">// G  unary-expression:</span>
            <span class="c">// G      primary-expression</span>
            <span class="c">// G      expression-with-unary-operator</span>
            <span class="c">// G</span>
            <span class="c">// G  expression-with-unary-operator:</span>
            <span class="c">// G      &#39;,&#39;   new-lines:opt   unary-expression</span>
            <span class="c">// G      &#39;-not&#39;   new-lines:opt   unary-expression</span>
            <span class="c">// G      &#39;!&#39;   new-lines:opt   unary-expression</span>
            <span class="c">// G      &#39;-bnot&#39;   new-lines:opt   unary-expression</span>
            <span class="c">// G      &#39;+&#39;   new-lines:opt   unary-expression</span>
            <span class="c">// G      dash   new-lines:opt   unary-expression</span>
            <span class="c">// G      pre-increment-expression</span>
            <span class="c">// G      pre-decrement-expression</span>
            <span class="c">// G      cast-expression</span>
            <span class="c">// G      &#39;-split&#39;   new-lines:opt   unary-expression</span>
            <span class="c">// G      &#39;-join&#39;   new-lines:opt   unary-expression</span>
            <span class="c">// G</span>
            <span class="c">// G  pre-increment-expression:</span>
            <span class="c">// G      &#39;++&#39;   new-lines:opt   unary-expression</span>
            <span class="c">// G</span>
            <span class="c">// G  pre-decrement-expression:</span>
            <span class="c">// G      dashdash   new-lines:opt   unary-expression</span>
            <span class="c">// G</span>
            <span class="c">// G  cast-expression:</span>
            <span class="c">// G      type-literal   unary-expression</span>
            <span class="i">RuntimeHelpers</span>.<span class="i">EnsureSufficientExecutionStack</span>();
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r727 rd" class="r727 r">expr</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r728 rd" class="r728 r">token</span>;
            <b>bool</b> <span id="r729 rd" class="r729 r">oldAllowSignedNumbers</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#cc92b8f58ff56ac5" class="i property">AllowSignedNumbers</a>;
            <b>bool</b> <span id="r730 rd" class="r730 r">oldForceEndNumberOnTernaryOperators</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#0259572152f59499" class="i property">ForceEndNumberOnTernaryOpChars</a>;
            <b>try</b>
            {
                <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#cc92b8f58ff56ac5" class="i property">AllowSignedNumbers</a> = <b>true</b>;
                <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#0259572152f59499" class="i property">ForceEndNumberOnTernaryOpChars</a> = <span class="r726 r">endNumberOnTernaryOpChars</span>;
 
                <b>if</b> (<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> != <b>null</b>)
                {
                    <span class="c">// Possibly a signed number. Need to resync.</span>
                    <b>bool</b> <span id="r731 rd" class="r731 r">needResync</span> = <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#069476ae2e7b4442" class="i field">Minus</a>;
 
                    <b>if</b> (!<span class="r731 r">needResync</span>)
                    {
                        <span class="c">// A generic token possibly composed of numbers and ternary operator chars. Need to resync.</span>
                        <span class="r731 r">needResync</span> = <span class="r726 r">endNumberOnTernaryOpChars</span> &amp;&amp; <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#1aeb1084525225c9" class="i field">Generic</a>;
                    }
 
                    <b>if</b> (<span class="r731 r">needResync</span>)
                    {
                        <a href="#73d0e59d1708bfb0" class="i method">Resync</a>(<a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a>);
                    }
                }
 
                <span class="r728 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            }
            <b>finally</b>
            {
                <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#cc92b8f58ff56ac5" class="i property">AllowSignedNumbers</a> = <span class="r729 r">oldAllowSignedNumbers</span>;
                <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#0259572152f59499" class="i property">ForceEndNumberOnTernaryOpChars</a> = <span class="r730 r">oldForceEndNumberOnTernaryOperators</span>;
            }
 
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r732 rd" class="r732 r">child</span>;
            <b>if</b> (<span class="r728 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#84def6774d758bed" class="i method">HasTrait</a>(<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#84cb73ac24504e0d" class="i field">UnaryOperator</a>))
            {
                <b>if</b> (<a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> &amp;&amp; <span class="r728 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <span class="c">// We have seen a unary operator token and now expecting an expression.</span>
                <span class="r732 r">child</span> = <a href="#8b954079b3dc7b2c" class="i method">UnaryExpressionRule</a>(<span class="r726 r">endNumberOnTernaryOpChars</span>: <b>true</b>);
                <b>if</b> (<span class="r732 r">child</span> != <b>null</b>)
                {
                    <b>if</b> (<span class="r728 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                    {
                        <span class="r727 r">expr</span> = <b>new</b> <span class="t">ArrayLiteralAst</span>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r728 r">token</span>, <span class="r732 r">child</span>), <b>new</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>[] { <span class="r732 r">child</span> });
                    }
                    <b>else</b>
                    {
                        <span class="r727 r">expr</span> = <b>new</b> <a href="ast.cs.html#b430512411f55a56" class="t constructor">UnaryExpressionAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r728 r">token</span>, <span class="r732 r">child</span>), <span class="r728 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>, <span class="r732 r">child</span>);
                    }
                }
                <b>else</b>
                {
                    <span class="c">// ErrorRecovery: don&#39;t bother constructing a unary expression, but we know we must have</span>
                    <span class="c">// some sort of expression, so return an error expression.</span>
                    <span class="c">//</span>
                    <span class="c">// Use token.Text, not token.Kind.Text() b/c the kind might not match the actual operator used</span>
                    <span class="c">// when a case insensitive operator is used.</span>
                    <span class="i">ReportIncompleteInput</span>(
                        <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r728 r">token</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterOperator</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterOperator</span>,
                        <span class="r728 r">token</span>.<a href="token.cs.html#8678cd2db79d7b1c" class="i property">Text</a>);
 
                    <b>return</b> <b>new</b> <a href="ast.cs.html#521987ae533dc4bd" class="t constructor">ErrorExpressionAst</a>(<span class="r728 r">token</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
                }
            }
            <b>else</b> <b>if</b> (<span class="r728 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>)
            {
                <span class="c">// Possibly a type literal or attribute.</span>
                <b>var</b> <span id="r733 rd" class="r733 r">attributes</span> = <a href="#4b35774058ff957d" class="i method">AttributeListRule</a>(<b>true</b>);
                <b>if</b> (<span class="r733 r">attributes</span> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <a href="ast.cs.html#35c989f6a7b4eace" class="t t">AttributeBaseAst</a> <span id="r734 rd" class="r734 r">lastAttribute</span> = <span class="r733 r">attributes</span>.<span class="i">Last</span>();
                <b>if</b> (<span class="r734 r">lastAttribute</span> <b>is</b> <a href="ast.cs.html#f576d1d6cbb736a0" class="t t">AttributeAst</a>)
                {
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                    <span class="c">// We are now expecting a child expression.</span>
                    <span class="r732 r">child</span> = <a href="#8b954079b3dc7b2c" class="i method">UnaryExpressionRule</a>(<span class="r726 r">endNumberOnTernaryOpChars</span>: <b>true</b>);
                    <b>if</b> (<span class="r732 r">child</span> == <b>null</b>)
                    {
                        <span class="c">// ErrorRecovery: We have a list of attributes, and we know it&#39;s not before a param statement,</span>
                        <span class="c">// so we know we must have some sort of expression.  Return an error expression then.</span>
                        <span class="i">ReportIncompleteInput</span>(
                            <span class="r734 r">lastAttribute</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>,
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">UnexpectedAttribute</span>),
                            <span class="i">ParserStrings</span>.<span class="i">UnexpectedAttribute</span>,
                            <span class="r734 r">lastAttribute</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>.<a href="ast.cs.html#15c64a580f477707" class="i property">FullName</a>);
 
                        <b>return</b> <b>new</b> <a href="ast.cs.html#521987ae533dc4bd" class="t constructor">ErrorExpressionAst</a>(<a href="#e1a46ab1f1292733" class="i method">ExtentOf</a>(<span class="r728 r">token</span>, <span class="r734 r">lastAttribute</span>));
                    }
 
                    <span class="r727 r">expr</span> = <b>new</b> <a href="ast.cs.html#fe01d62af02ff2f7" class="t constructor">AttributedExpressionAst</a>(<a href="#f4b9cf4dcd548ea3" class="i method">ExtentOf</a>(<span class="r734 r">lastAttribute</span>, <span class="r732 r">child</span>), <span class="r734 r">lastAttribute</span>, <span class="r732 r">child</span>);
                }
                <b>else</b>
                {
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(
                        <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> == <b>null</b> || <a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Count</span> &gt; 0,
                        <span class="s">&quot;Unexpected lookahead from AttributeListRule.&quot;</span>);
 
                    <span class="c">// If we&#39;ve looked ahead, don&#39;t go looking for a member access token, we&#39;ve already issued an error,</span>
                    <span class="c">// just assume we&#39;re not trying to access a member.</span>
                    <a href="token.cs.html#ec5d9ac6a36d920c" class="k">var</a> <span id="r735 rd" class="r735 r">memberAccessToken</span> = <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> != <b>null</b> ? <b>null</b> : <a href="#e92e7b8af3f0e276" class="i method">NextMemberAccessToken</a>(<b>false</b>);
                    <b>if</b> (<span class="r735 r">memberAccessToken</span> != <b>null</b>)
                    {
                        <span class="r727 r">expr</span> = <a href="#18c046e5a8f4a2f6" class="i method">CheckPostPrimaryExpressionOperators</a>(
                            <span class="r735 r">memberAccessToken</span>,
                            <b>new</b> <a href="ast.cs.html#ead902e37b5f71c3" class="t constructor">TypeExpressionAst</a>(<span class="r734 r">lastAttribute</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r734 r">lastAttribute</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>));
                    }
                    <b>else</b>
                    {
                        <span class="r728 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                        <b>if</b> (<span class="r728 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a> &amp;&amp; <span class="r728 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                        {
                            <span class="c">// We are now expecting a child expression.</span>
                            <span class="r732 r">child</span> = <a href="#8b954079b3dc7b2c" class="i method">UnaryExpressionRule</a>(<span class="r726 r">endNumberOnTernaryOpChars</span>: <b>true</b>);
                            <b>if</b> (<span class="r732 r">child</span> != <b>null</b>)
                            {
                                <span class="r727 r">expr</span> = <b>new</b> <a href="ast.cs.html#0a8a1869daa42cd3" class="t constructor">ConvertExpressionAst</a>(
                                    <a href="#f4b9cf4dcd548ea3" class="i method">ExtentOf</a>(<span class="r734 r">lastAttribute</span>, <span class="r732 r">child</span>),
                                    (<a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>)<span class="r734 r">lastAttribute</span>, <span class="r732 r">child</span>);
                            }
                        }
                    }
 
                    <b>if</b> (<span class="r727 r">expr</span> == <b>null</b>)
                    {
                        <span class="r727 r">expr</span> = <b>new</b> <a href="ast.cs.html#ead902e37b5f71c3" class="t constructor">TypeExpressionAst</a>(<span class="r734 r">lastAttribute</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r734 r">lastAttribute</span>.<a href="ast.cs.html#eae1f2f74db44d11" class="i property">TypeName</a>);
                    }
                }
 
                <b>for</b> (<b>int</b> <span id="r736 rd" class="r736 r">i</span> = <span class="r733 r">attributes</span>.<span class="i">Count</span> - 2; <span class="r736 r">i</span> &gt;= 0; --<span class="r736 r">i</span>)
                {
                    <a href="ast.cs.html#34b9d5dbbaca964d" class="k">var</a> <span id="r737 rd" class="r737 r">typeConstraint</span> = <span class="r733 r">attributes</span>[<span class="r736 r">i</span>] <b>as</b> <a href="ast.cs.html#34b9d5dbbaca964d" class="t t">TypeConstraintAst</a>;
 
                    <span class="r727 r">expr</span> = <span class="r737 r">typeConstraint</span> != <b>null</b>
                                ? <b>new</b> <a href="ast.cs.html#0a8a1869daa42cd3" class="t constructor">ConvertExpressionAst</a>(<a href="#f4b9cf4dcd548ea3" class="i method">ExtentOf</a>(<span class="r737 r">typeConstraint</span>, <span class="r727 r">expr</span>), <span class="r737 r">typeConstraint</span>, <span class="r727 r">expr</span>)
                                : <b>new</b> <span class="t">AttributedExpressionAst</span>(<span class="i">ExtentOf</span>(<span class="r733 r">attributes</span>[<span class="r736 r">i</span>], <span class="r727 r">expr</span>), <span class="r733 r">attributes</span>[<span class="r736 r">i</span>], <span class="r727 r">expr</span>);
                }
            }
            <b>else</b>
            {
                <span class="r727 r">expr</span> = <a href="#b835651f99e7555e" class="i method">PrimaryExpressionRule</a>(<span class="r671 r">withMemberAccess</span>: <b>true</b>);
            }
 
            <b>if</b> (<span class="r727 r">expr</span> != <b>null</b>)
            {
                <span class="r728 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a> <span id="r738 rd" class="r738 r">operation</span> = (<span class="r728 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#93a18b78948c1c09" class="i field">PlusPlus</a>)
                                            ? <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a49966ed41b2bd06" class="i field">PostfixPlusPlus</a>
                                            : (<span class="r728 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#3d9a9ff2e958417f" class="i field">MinusMinus</a>)
                                                ? <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8a3018df4a2c2998" class="i field">PostfixMinusMinus</a>
                                                : <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a>;
                <b>if</b> (<span class="r738 r">operation</span> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#109dbe127dd9cac0" class="i field">Unknown</a>)
                {
                    <a href="#40ecb045eb2a7f82" class="i method">SkipToken</a>();
                    <span class="r727 r">expr</span> = <b>new</b> <a href="ast.cs.html#b430512411f55a56" class="t constructor">UnaryExpressionAst</a>(<a href="#4ad82407bcef8f0d" class="i method">ExtentOf</a>(<span class="r727 r">expr</span>, <span class="r728 r">token</span>), <span class="r738 r">operation</span>, <span class="r727 r">expr</span>);
                }
            }
 
            <b>return</b> <span class="r727 r">expr</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="b835651f99e7555e" href="../../R/b835651f99e7555e.html" target="n" data-glyph="76,1" class="i method">PrimaryExpressionRule</a>(<b>bool</b> <span id="r671 rd" class="r671 r">withMemberAccess</span>)
        {
            <span class="c">// G  primary-expression:</span>
            <span class="c">// G      value</span>
            <span class="c">// G      member-access</span>
            <span class="c">// G      element-access</span>
            <span class="c">// G      invocation-expression</span>
            <span class="c">// G      post-increment-expression</span>
            <span class="c">// G      post-decrement-expression</span>
            <span class="c">// G  value:</span>
            <span class="c">// G      parenthesized-expression</span>
            <span class="c">// G      sub-expression</span>
            <span class="c">// G      array-expression</span>
            <span class="c">// G      script-block-expression</span>
            <span class="c">// G      hash-literal-expression</span>
            <span class="c">// G      literal</span>
            <span class="c">// G      type-literal</span>
            <span class="c">// G      variable</span>
 
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r739 rd" class="r739 r">expr</span>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r740 rd" class="r740 r">token</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
 
            <b>switch</b> (<span class="r740 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>)
            {
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4fc017e5ff76f173" class="i field">SplattedVariable</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#8b5a9c54e2029553" class="i field">Variable</a>:
                    <span class="r739 r">expr</span> = <a href="#2d212729d76ac716" class="i method">CheckUsingVariable</a>((<a href="token.cs.html#cb1e7cc3b0285414" class="t t">VariableToken</a>)<span class="r740 r">token</span>, <span class="r741 r">withMemberAccess</span>: <span class="r671 r">withMemberAccess</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4ed416f347b26a1b" class="i field">Number</a>:
                    <span class="r739 r">expr</span> = <b>new</b> <a href="ast.cs.html#362090dc6e396bbc" class="t constructor">ConstantExpressionAst</a>((<a href="token.cs.html#71038a309db9781f" class="t t">NumberToken</a>)<span class="r740 r">token</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#b3843759239f0c51" class="i field">HereStringExpandable</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4e0d26e8d7050abc" class="i field">StringExpandable</a>:
                    <span class="r739 r">expr</span> = <a href="#7700f40d33c1ea62" class="i method">ExpandableStringRule</a>((<a href="token.cs.html#7be5d7d2cd2a65ac" class="t t">StringExpandableToken</a>)<span class="r740 r">token</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a6a2bdb661c2a296" class="i field">HereStringLiteral</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#0c560abdae080116" class="i field">StringLiteral</a>:
                    <span class="r739 r">expr</span> = <b>new</b> <a href="ast.cs.html#e7861490ceaad5be" class="t constructor">StringConstantExpressionAst</a>((<a href="token.cs.html#dce06fb5d7448125" class="t t">StringToken</a>)<span class="r740 r">token</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>:
                    <span class="r739 r">expr</span> = <a href="#5ff86fe25f37996f" class="i method">ParenthesizedExpressionRule</a>(<span class="r740 r">token</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#cf388c7cb0667161" class="i field">AtParen</a>:
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#daaf3713e66e6f30" class="i field">DollarParen</a>:
                    <span class="r739 r">expr</span> = <a href="#d828564ba0d2a853" class="i method">SubExpressionRule</a>(<span class="r740 r">token</span>);
                    <b>break</b>;
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ad46aed3b80ba825" class="i field">AtCurly</a>:
                    <span class="r739 r">expr</span> = <a href="#cf64b709609b3987" class="i method">HashExpressionRule</a>(<span class="r740 r">token</span>, <b>false</b> <span class="c">/* parsingSchemaElement */</span> );
                    <b>break</b>;
 
                <b>case</b> <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>:
                    <span class="r739 r">expr</span> = <a href="#6042c9a5e817fc8e" class="i method">ScriptBlockExpressionRule</a>(<span class="r740 r">token</span>);
                    <b>break</b>;
 
                <b>default</b>:
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r740 r">token</span>);
                    <b>return</b> <b>null</b>;
            }
 
            <b>if</b> (!<span class="r671 r">withMemberAccess</span>)
            {
                <b>return</b> <span class="r739 r">expr</span>;
            }
 
            <b>return</b> <a href="#18c046e5a8f4a2f6" class="i method">CheckPostPrimaryExpressionOperators</a>(<a href="#e92e7b8af3f0e276" class="i method">NextMemberAccessToken</a>(<b>true</b>), <span class="r739 r">expr</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="2d212729d76ac716" href="../../R/2d212729d76ac716.html" target="n" data-glyph="76,1" class="i method">CheckUsingVariable</a>(<a href="token.cs.html#cb1e7cc3b0285414" class="t t">VariableToken</a> <span id="r742 rd" class="r742 r">variableToken</span>, <b>bool</b> <span id="r741 rd" class="r741 r">withMemberAccess</span>)
        {
            <a href="../VariablePath.cs.html#41e5b41974741cc5" class="k">var</a> <span id="r743 rd" class="r743 r">variablePath</span> = <span class="r742 r">variableToken</span>.<a href="token.cs.html#d5a3911ea8b02b43" class="i property">VariablePath</a>;
            <b>if</b> (<span class="r743 r">variablePath</span>.<a href="../VariablePath.cs.html#70f672ec2e5c2bcb" class="i property">IsDriveQualified</a> &amp;&amp; <span class="r743 r">variablePath</span>.<a href="../VariablePath.cs.html#88c3e3f5b3aa0d19" class="i property">DriveName</a>.<span class="i">Equals</span>(<span class="s">&quot;using&quot;</span>, <span class="i">StringComparison</span>.<span class="i">OrdinalIgnoreCase</span>) &amp;&amp; <span class="r743 r">variablePath</span>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>.<span class="i">Length</span> &gt; 0)
            {
                <a href="../VariablePath.cs.html#41e5b41974741cc5" class="k">var</a> <span id="r744 rd" class="r744 r">realVariablePath</span> = <b>new</b> <a href="../VariablePath.cs.html#6f51a22b7d168e83" class="t constructor">VariablePath</a>(<span class="r743 r">variablePath</span>.<a href="../VariablePath.cs.html#4d193f060335d69e" class="i property">UnqualifiedPath</a>);
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r745 rd" class="r745 r">childExpr</span> = <b>new</b> <a href="ast.cs.html#aead8965a3ad2e1e" class="t constructor">VariableExpressionAst</a>(<span class="r742 r">variableToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r744 r">realVariablePath</span>, (<span class="r742 r">variableToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#4fc017e5ff76f173" class="i field">SplattedVariable</a>));
                <b>if</b> (<span class="r741 r">withMemberAccess</span>)
                {
                    <span class="r745 r">childExpr</span> = <a href="#18c046e5a8f4a2f6" class="i method">CheckPostPrimaryExpressionOperators</a>(<a href="#e92e7b8af3f0e276" class="i method">NextMemberAccessToken</a>(<b>true</b>), <span class="r745 r">childExpr</span>);
                }
 
                <b>return</b> <b>new</b> <a href="ast.cs.html#6a83e62c29bc3272" class="t constructor">UsingExpressionAst</a>(<span class="r745 r">childExpr</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r745 r">childExpr</span>);
            }
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#7703a30c5cc584b7" class="t constructor">VariableExpressionAst</a>(<span class="r742 r">variableToken</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="18c046e5a8f4a2f6" href="../../R/18c046e5a8f4a2f6.html" target="n" data-glyph="76,1" class="i method">CheckPostPrimaryExpressionOperators</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r746 rd" class="r746 r">token</span>, <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r747 rd" class="r747 r">expr</span>)
        {
            <b>while</b> (<span class="r746 r">token</span> != <b>null</b>)
            {
                <span class="c">// To support fluent style programming, allow newlines after the member access operator.</span>
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
                <b>if</b> (<span class="r746 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a9023444a1ee3a84" class="i field">Dot</a> || <span class="r746 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ba396ba04fe0fde5" class="i field">ColonColon</a> || <span class="r746 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#97da13a8bbbf83e2" class="i field">QuestionDot</a>)
                {
                    <span class="r747 r">expr</span> = <a href="#c1aa074866e2a3cb" class="i method">MemberAccessRule</a>(<span class="r747 r">expr</span>, <span class="r746 r">token</span>);
                }
                <b>else</b> <b>if</b> (<span class="r746 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a> || <span class="r746 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ccf850170f25476f" class="i field">QuestionLBracket</a>)
                {
                    <span class="r747 r">expr</span> = <a href="#512a999922c25da3" class="i method">ElementAccessRule</a>(<span class="r747 r">expr</span>, <span class="r746 r">token</span>);
                }
 
                <span class="r746 r">token</span> = <a href="#e92e7b8af3f0e276" class="i method">NextMemberAccessToken</a>(<b>true</b>);
            }
 
            <b>return</b> <span class="r747 r">expr</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="cf64b709609b3987" href="../../R/cf64b709609b3987.html" target="n" data-glyph="76,1" class="i method">HashExpressionRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r748 rd" class="r748 r">atCurlyToken</span>, <b>bool</b> <span id="r749 rd" class="r749 r">parsingSchemaElement</span>)
        {
            <span class="c">// G  hash-literal-expression:</span>
            <span class="c">// G      &#39;@{&#39;   new-lines:opt   hash-literal-body:opt   new-lines:opt   &#39;}&#39;</span>
            <span class="c">// G  hash-literal-body:</span>
            <span class="c">// G      hash-entry</span>
            <span class="c">// G      hash-literal-body   statement-terminators   hash-entry</span>
            <span class="c">// G  statement-terminators:</span>
            <span class="c">// G      statement-terminator</span>
            <span class="c">// G      statement-terminators   statement-terminator</span>
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
 
            <span class="i">List</span>&lt;<span class="i">KeyValuePair</span>&gt; <span id="r750 rd" class="r750 r">keyValuePairs</span> = <b>new</b> <span class="i">List</span>&lt;<span class="i">KeyValuePair</span>&gt;();
            <b>while</b> (<b>true</b>)
            {
                <span class="i">KeyValuePair</span> <span id="r751 rd" class="r751 r">pair</span> = <a href="#45741cbd6ae0ed5a" class="i method">GetKeyValuePair</a>(<span class="r749 r">parsingSchemaElement</span>);
                <b>if</b> (<span class="r751 r">pair</span> == <b>null</b>)
                {
                    <b>break</b>;
                }
 
                <span class="r750 r">keyValuePairs</span>.<span class="i">Add</span>(<span class="r751 r">pair</span>);
 
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r752 rd" class="r752 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
                <b>if</b> (<span class="r752 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a> &amp;&amp; <span class="r752 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>)
                {
                    <b>break</b>;
                }
 
                <a href="#20cf6d6d776dad25" class="i method">SkipNewlinesAndSemicolons</a>();
            }
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r753 rd" class="r753 r">endExtent</span>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r754 rd" class="r754 r">rCurly</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r754 r">rCurly</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>)
            {
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r754 r">rCurly</span>);
                <b>string</b> <span id="r755 rd" class="r755 r">errorId</span>;
                <b>string</b> <span id="r756 rd" class="r756 r">errorMsg</span>;
                <b>if</b> (<span class="r749 r">parsingSchemaElement</span>)
                {
                    <span class="r755 r">errorId</span> = <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">IncompletePropertyAssignmentBlock</span>);
                    <span class="r756 r">errorMsg</span> = <span class="i">ParserStrings</span>.<span class="i">IncompletePropertyAssignmentBlock</span>;
                }
                <b>else</b>
                {
                    <span class="r755 r">errorId</span> = <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndCurlyBrace</span>);
                    <span class="r756 r">errorMsg</span> = <span class="i">ParserStrings</span>.<span class="i">MissingEndCurlyBrace</span>;
                }
 
                <a href="#d8cdf029ddc6c03a" class="i method">ReportIncompleteInput</a>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r748 r">atCurlyToken</span>), <span class="r754 r">rCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>, <span class="r755 r">errorId</span>, <span class="r756 r">errorMsg</span>);
                <span class="r753 r">endExtent</span> = <a href="#cb433f96b9585085" class="i method">Before</a>(<span class="r754 r">rCurly</span>);
            }
            <b>else</b>
            {
                <span class="r753 r">endExtent</span> = <span class="r754 r">rCurly</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>;
            }
 
            <a href="ast.cs.html#fd6e450f68cfd52b" class="k">var</a> <span id="r757 rd" class="r757 r">hashAst</span> = <b>new</b> <span class="t">HashtableAst</span>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r748 r">atCurlyToken</span>, <span class="r753 r">endExtent</span>), <span class="r750 r">keyValuePairs</span>);
            <span class="r757 r">hashAst</span>.<a href="ast.cs.html#6706cae89a393ac3" class="i property">IsSchemaElement</a> = <span class="r749 r">parsingSchemaElement</span>;
            <b>return</b> <span class="r757 r">hashAst</span>;
        }
 
        <b>private</b> <span class="i">KeyValuePair</span> <a id="45741cbd6ae0ed5a" href="../../R/45741cbd6ae0ed5a.html" target="n" data-glyph="76,1" class="i method">GetKeyValuePair</a>(<b>bool</b> <span id="r758 rd" class="r758 r">parsingSchemaElement</span>)
        {
            <span class="c">// G  hash-entry:</span>
            <span class="c">// G      key-expression   &#39;=&#39;   new-lines:opt   statement</span>
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r759 rd" class="r759 r">equals</span>;
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r760 rd" class="r760 r">key</span>;
 
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r761 rd" class="r761 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#9b6269e007d113c3" class="i field">Expression</a>);
                <span class="r760 r">key</span> = <a href="#a33f091484610e28" class="i method">LabelOrKeyRule</a>();
                <b>if</b> (<span class="r760 r">key</span> == <b>null</b>)
                {
                    <b>return</b> <b>null</b>;
                }
 
                <span class="r759 r">equals</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r761 r">oldTokenizerMode</span>);
            }
 
            <b>if</b> (<span class="r759 r">equals</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#d78e08594ff6b79a" class="i field">Equals</a>)
            {
                <span class="c">// ErrorRecovery: Pretend we saw the &#39;=&#39; and a statement.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r759 r">equals</span>);
                <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r762 rd" class="r762 r">errorExtent</span> = <a href="#40407f0b4b50ace7" class="i method">After</a>(<span class="r760 r">key</span>);
 
                <b>string</b> <span id="r763 rd" class="r763 r">errorId</span>;
                <b>string</b> <span id="r764 rd" class="r764 r">errorMsg</span>;
                <b>if</b> (<span class="r758 r">parsingSchemaElement</span>)
                {
                    <span class="r763 r">errorId</span> = <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEqualsInPropertyAssignmentBlock</span>);
                    <span class="r764 r">errorMsg</span> = <span class="i">ParserStrings</span>.<span class="i">MissingEqualsInPropertyAssignmentBlock</span>;
                }
                <b>else</b>
                {
                    <span class="r763 r">errorId</span> = <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEqualsInHashLiteral</span>);
                    <span class="r764 r">errorMsg</span> = <span class="i">ParserStrings</span>.<span class="i">MissingEqualsInHashLiteral</span>;
                }
 
                <a href="#54fe0fe51414c862" class="i method">ReportError</a>(<span class="r762 r">errorExtent</span>, <span class="r763 r">errorId</span>, <span class="r764 r">errorMsg</span>);
                <a href="#e51058c98956995e" class="i method">SyncOnError</a>(<b>false</b>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#fa7a2db081fa97d8" class="i field">RCurly</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#63d62c6d035bda20" class="i field">Semi</a>, <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#c105a5282a4e4395" class="i field">NewLine</a>);
                <b>return</b> <b>new</b> <span class="i">KeyValuePair</span>(<span class="r760 r">key</span>, <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<span class="r762 r">errorExtent</span>));
            }
 
            <a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a> <span id="r765 rd" class="r765 r">statement</span>;
            <b>try</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#d9f88bf7436b84df" class="i field">Command</a>);
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r765 r">statement</span> = <a href="#90788aa7288d5462" class="i method">StatementRule</a>();
                <b>if</b> (<span class="r765 r">statement</span> == <b>null</b>)
                {
                    <span class="c">// ErrorRecovery: pretend we saw a statement and keep parsing.</span>
 
                    <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r766 rd" class="r766 r">errorExtent</span> = <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r759 r">equals</span>);
 
                    <b>string</b> <span id="r767 rd" class="r767 r">errorId</span>;
                    <b>string</b> <span id="r768 rd" class="r768 r">errorMsg</span>;
                    <b>if</b> (<span class="r758 r">parsingSchemaElement</span>)
                    {
                        <span class="r767 r">errorId</span> = <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEqualsInPropertyAssignmentBlock</span>);
                        <span class="r768 r">errorMsg</span> = <span class="i">ParserStrings</span>.<span class="i">MissingEqualsInPropertyAssignmentBlock</span>;
                    }
                    <b>else</b>
                    {
                        <span class="r767 r">errorId</span> = <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingStatementInHashLiteral</span>);
                        <span class="r768 r">errorMsg</span> = <span class="i">ParserStrings</span>.<span class="i">MissingStatementInHashLiteral</span>;
                    }
 
                    <a href="#d4db672ef75b7aa3" class="i method">ReportIncompleteInput</a>(<span class="r766 r">errorExtent</span>, <span class="r767 r">errorId</span>, <span class="r768 r">errorMsg</span>);
                    <span class="r765 r">statement</span> = <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<span class="r766 r">errorExtent</span>);
                }
            }
            <b>finally</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r761 r">oldTokenizerMode</span>);
            }
 
            <b>return</b> <b>new</b> <span class="i">KeyValuePair</span>(<span class="r760 r">key</span>, <span class="r765 r">statement</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="6042c9a5e817fc8e" href="../../R/6042c9a5e817fc8e.html" target="n" data-glyph="76,1" class="i method">ScriptBlockExpressionRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r769 rd" class="r769 r">lCurly</span>)
        {
            <span class="c">// G  script-block-expression:</span>
            <span class="c">// G      &#39;{&#39;   new-lines:opt   script-block   new-lines:opt   &#39;}&#39;</span>
 
            <a href="ast.cs.html#6f963589327835a4" class="t t">ScriptBlockAst</a> <span id="r770 rd" class="r770 r">scriptBlockAst</span>;
 
            <b>bool</b> <span id="r771 rd" class="r771 r">oldDisableCommaOperator</span> = <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a>;
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r772 rd" class="r772 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <b>false</b>;
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#d9f88bf7436b84df" class="i field">Command</a>);
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r770 r">scriptBlockAst</span> = <a href="#41a9f47c78b86651" class="i method">ScriptBlockRule</a>(<span class="r769 r">lCurly</span>, <span class="r37 r">isFilter</span>: <b>false</b>);
            }
            <b>finally</b>
            {
                <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <span class="r771 r">oldDisableCommaOperator</span>;
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r772 r">oldTokenizerMode</span>);
            }
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#dd24d41ff02dddc5" class="t constructor">ScriptBlockExpressionAst</a>(<span class="r770 r">scriptBlockAst</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>, <span class="r770 r">scriptBlockAst</span>);
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="d828564ba0d2a853" href="../../R/d828564ba0d2a853.html" target="n" data-glyph="76,1" class="i method">SubExpressionRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r773 rd" class="r773 r">firstToken</span>)
        {
            <span class="c">// G  array-expression:</span>
            <span class="c">// G      &#39;@(&#39;   new-lines:opt   statement-list:opt   new-lines:opt   &#39;)&#39;</span>
            <span class="c">// G  sub-expression:</span>
            <span class="c">// G      &#39;$(&#39;   new-lines:opt   statement-list:opt   new-lines:opt   &#39;)&#39;</span>
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r774 rd" class="r774 r">statementListExtent</span>;
            <span class="i">List</span>&lt;<a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt; <span id="r775 rd" class="r775 r">traps</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#5cedc9c886fbe837" class="t t">TrapStatementAst</a>&gt;();
            <span class="i">List</span>&lt;<a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt; <span id="r776 rd" class="r776 r">statements</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#9c25dfdd7f4807b0" class="t t">StatementAst</a>&gt;();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r777 rd" class="r777 r">rParen</span>;
 
            <b>bool</b> <span id="r778 rd" class="r778 r">oldDisableCommaOperator</span> = <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a>;
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r779 rd" class="r779 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>try</b>
            {
                <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <b>false</b>;
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#d9f88bf7436b84df" class="i field">Command</a>);
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r774 r">statementListExtent</span> = <a href="#4fde70daaf395c24" class="i method">StatementListRule</a>(<span class="r776 r">statements</span>, <span class="r775 r">traps</span>);
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r777 r">rParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r777 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>)
                {
                    <span class="c">// ErrorRecovery: Assume only the closing paren is missing, continue as though it was present.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r777 r">rParen</span>);
                    <span class="i">ReportIncompleteInput</span>(<span class="r777 r">rParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInSubexpression</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInSubexpression</span>);
                }
            }
            <b>finally</b>
            {
                <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <span class="r778 r">oldDisableCommaOperator</span>;
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r779 r">oldTokenizerMode</span>);
            }
 
            <span class="c">// End extent is rparen, end of the statement list (if no rparen), or the first token (if no statements).</span>
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r780 rd" class="r780 r">extent</span> = <a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r773 r">firstToken</span>,
                                            <span class="r777 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a> ? <span class="r777 r">rParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a> : <span class="r774 r">statementListExtent</span> ?? <span class="r773 r">firstToken</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
            <b>if</b> (<span class="r773 r">firstToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#daaf3713e66e6f30" class="i field">DollarParen</a>)
            {
                <b>return</b> <b>new</b> <a href="ast.cs.html#ee5a380f086fe18d" class="t constructor">SubExpressionAst</a>(<span class="r780 r">extent</span>,
                                            <b>new</b> <span class="t">StatementBlockAst</span>(<span class="r774 r">statementListExtent</span> ?? <a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>,
                                                                  <span class="r776 r">statements</span>, <span class="r775 r">traps</span>));
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r773 r">firstToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#cf388c7cb0667161" class="i field">AtParen</a>, <span class="s">&quot;only support $() and @() here.&quot;</span>);
            <b>return</b> <b>new</b> <a href="ast.cs.html#af3aa3b81046afbd" class="t constructor">ArrayExpressionAst</a>(<span class="r780 r">extent</span>,
                                          <b>new</b> <span class="t">StatementBlockAst</span>(<span class="r774 r">statementListExtent</span> ?? <a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#01bfb713b57f7955" class="i property">EmptyExtent</a>, <span class="r776 r">statements</span>, <span class="r775 r">traps</span>));
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="5ff86fe25f37996f" href="../../R/5ff86fe25f37996f.html" target="n" data-glyph="76,1" class="i method">ParenthesizedExpressionRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r781 rd" class="r781 r">lParen</span>)
        {
            <span class="c">// G  parenthesized-expression:</span>
            <span class="c">// G      &#39;(&#39;   new-lines:opt   pipeline-chain   new-lines:opt   &#39;)&#39;</span>
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r782 rd" class="r782 r">rParen</span>;
            <a href="ast.cs.html#86812479028959b8" class="t t">PipelineBaseAst</a> <span id="r783 rd" class="r783 r">pipelineAst</span>;
 
            <a href="tokenizer.cs.html#39faa36c58f275ae" class="k">var</a> <span id="r784 rd" class="r784 r">oldTokenizerMode</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#e8fec060763b56d8" class="i property">Mode</a>;
            <b>var</b> <span id="r785 rd" class="r785 r">oldDisableCommaOperator</span> = <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a>;
            <b>try</b>
            {
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<a href="tokenizer.cs.html#39faa36c58f275ae" class="t t">TokenizerMode</a>.<a href="tokenizer.cs.html#d9f88bf7436b84df" class="i field">Command</a>);
                <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <b>false</b>;
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r783 r">pipelineAst</span> = <a href="#9fe484111cd89222" class="i method">PipelineChainRule</a>();
                <b>if</b> (<span class="r783 r">pipelineAst</span> == <b>null</b>)
                {
                    <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r786 rd" class="r786 r">errorPosition</span> = <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r781 r">lParen</span>);
                    <span class="i">ReportIncompleteInput</span>(
                        <span class="r786 r">errorPosition</span>,
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">ExpectedExpression</span>),
                        <span class="i">ParserStrings</span>.<span class="i">ExpectedExpression</span>);
                    <span class="r783 r">pipelineAst</span> = <b>new</b> <a href="ast.cs.html#03a67eb2183c3b50" class="t constructor">ErrorStatementAst</a>(<span class="r786 r">errorPosition</span>);
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r782 r">rParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r782 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>)
                {
                    <span class="c">// ErrorRecovery: Assume only the closing paren is missing, continue as though it was present.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r782 r">rParen</span>);
                    <span class="i">ReportIncompleteInput</span>(<a href="#40407f0b4b50ace7" class="i method">After</a>(<span class="r783 r">pipelineAst</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInExpression</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInExpression</span>);
                    <span class="r782 r">rParen</span> = <b>null</b>;
                }
            }
            <b>finally</b>
            {
                <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <span class="r785 r">oldDisableCommaOperator</span>;
                <a href="#9465510520349e4e" class="i method">SetTokenizerMode</a>(<span class="r784 r">oldTokenizerMode</span>);
            }
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#e5300f124d1ef239" class="t constructor">ParenExpressionAst</a>(<a href="#65fd6d77f297d927" class="i method">ExtentOf</a>(<span class="r781 r">lParen</span>, <a href="#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r782 r">rParen</span>, <span class="r783 r">pipelineAst</span>)), <span class="r783 r">pipelineAst</span>);
        }
 
        <b>private</b> <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <a id="122ccfcd73508d8e" href="../../R/122ccfcd73508d8e.html" target="n" data-glyph="76,1" class="i method">ParseNestedExpressions</a>(<a href="token.cs.html#7be5d7d2cd2a65ac" class="t t">StringExpandableToken</a> <span id="r787 rd" class="r787 r">expandableStringToken</span>)
        {
            <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r788 rd" class="r788 r">nestedExpressions</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;();
            <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt; <span id="r789 rd" class="r789 r">newNestedTokens</span> = <a href="#be9d31b21b6625a3" class="i field">_savingTokens</a> ? <b>new</b> <span class="i">List</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt;() : <b>null</b>;
            <b>foreach</b> (<b>var</b> <span id="r790 rd" class="r790 r">token</span> <b>in</b> <span class="r787 r">expandableStringToken</span>.<a href="token.cs.html#6847b32dc0516c6a" class="i property">NestedTokens</a>)
            {
                <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<span class="r790 r">token</span>.<span class="i">HasError</span> || <a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Count</span> &gt; 0, <span class="s">&quot;No nested tokens should have unreported errors.&quot;</span>);
 
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r791 rd" class="r791 r">exprAst</span>;
                <a href="token.cs.html#cb1e7cc3b0285414" class="k">var</a> <span id="r792 rd" class="r792 r">varToken</span> = <span class="r790 r">token</span> <b>as</b> <a href="token.cs.html#cb1e7cc3b0285414" class="t t">VariableToken</a>;
 
                <b>if</b> (<span class="r792 r">varToken</span> != <b>null</b>)
                {
                    <span class="r791 r">exprAst</span> = <a href="#2d212729d76ac716" class="i method">CheckUsingVariable</a>(<span class="r792 r">varToken</span>, <b>false</b>);
                    <b>if</b> (<a href="#be9d31b21b6625a3" class="i field">_savingTokens</a>) { <span class="r789 r">newNestedTokens</span>.<span class="i">Add</span>(<span class="r792 r">varToken</span>); }
                }
                <span class="c">// Enable if we decide we still need to support</span>
                <span class="c">//     &quot;${}&quot;  or &quot;$var:&quot;</span>
                <span class="c">// else if (token.Kind == TokenKind.Unknown)</span>
                <span class="c">// {</span>
                <span class="c">//    // Diagnostics.Assert(token.Text.Equals(&quot;${}&quot;, StringComparison.OrdinalIgnoreCase),</span>
                <span class="c">//    //    &quot;The unknown token is only used in an expandable string when it&#39;s an empty variable name.&quot;);</span>
                <span class="c">//    // TODO: Need strict-mode check at runtime.</span>
                <span class="c">//    // TODO: in V2, &quot;${}&quot; expanded to &#39;$&#39;, but &quot;$var:&quot; expanded to the empty string</span>
                <span class="c">//    exprAst = new StringConstantExpressionAst(token.Extent, &quot;$&quot;, StringConstantType.BareWord);</span>
                <span class="c">//    if (_savingTokens) { newNestedTokens.Add(token); }</span>
                <span class="c">// }</span>
                <b>else</b>
                {
                    <a href="tokenizer.cs.html#7ca04afa98129e98" class="t t">TokenizerState</a> <span id="r793 rd" class="r793 r">ts</span> = <b>null</b>;
                    <b>try</b>
                    {
                        <span class="r793 r">ts</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#c9153ca32ee89b31" class="i method">StartNestedScan</a>((<a href="token.cs.html#ea24fc4d8cf7c397" class="t t">UnscannedSubExprToken</a>)<span class="r790 r">token</span>);
                        <span class="r791 r">exprAst</span> = <a href="#b835651f99e7555e" class="i method">PrimaryExpressionRule</a>(<span class="r671 r">withMemberAccess</span>: <b>true</b>);
                        <b>if</b> (<a href="#be9d31b21b6625a3" class="i field">_savingTokens</a>) { <span class="r789 r">newNestedTokens</span>.<span class="i">AddRange</span>(<a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#233100b0d292a6a3" class="i property">TokenList</a>); }
                    }
                    <b>finally</b>
                    {
                        <span class="c">// _ungotToken is probably &lt;EOF&gt;, but if there were errors, it could be something</span>
                        <span class="c">// else.  Either way, we don&#39;t want it.</span>
                        <a href="#5e04e9f27cfc4fbb" class="i field">_ungotToken</a> = <b>null</b>;
                        <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#28dd58bc3bbb1c19" class="i method">FinishNestedScan</a>(<span class="r793 r">ts</span>);
                    }
                }
 
                <span class="r788 r">nestedExpressions</span>.<span class="i">Add</span>(<span class="r791 r">exprAst</span>);
            }
 
            <b>if</b> (<a href="#be9d31b21b6625a3" class="i field">_savingTokens</a>) { <span class="r787 r">expandableStringToken</span>.<a href="token.cs.html#6847b32dc0516c6a" class="i property">NestedTokens</a> = <b>new</b> <span class="i">ReadOnlyCollection</span>&lt;<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a>&gt;(<span class="r789 r">newNestedTokens</span>); }
 
            <b>return</b> <span class="r788 r">nestedExpressions</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="7700f40d33c1ea62" href="../../R/7700f40d33c1ea62.html" target="n" data-glyph="76,1" class="i method">ExpandableStringRule</a>(<a href="token.cs.html#7be5d7d2cd2a65ac" class="t t">StringExpandableToken</a> <span id="r794 rd" class="r794 r">strToken</span>)
        {
            <span class="c">// G  value:</span>
            <span class="c">// G      literal</span>
 
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r795 rd" class="r795 r">expr</span>;
            <span class="c">// We need to scan the nested tokens even if there was some error. This is used by the tab completion: &quot;pshome is $psh&lt;tab&gt;</span>
            <b>if</b> (<span class="r794 r">strToken</span>.<a href="token.cs.html#6847b32dc0516c6a" class="i property">NestedTokens</a> != <b>null</b>)
            {
                <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r796 rd" class="r796 r">nestedExpressions</span> = <a href="#122ccfcd73508d8e" class="i method">ParseNestedExpressions</a>(<span class="r794 r">strToken</span>);
                <span class="r795 r">expr</span> = <b>new</b> <span class="t">ExpandableStringExpressionAst</span>(<span class="r794 r">strToken</span>, <span class="r794 r">strToken</span>.<a href="token.cs.html#f95f094124370df7" class="i property">Value</a>, <span class="r794 r">strToken</span>.<a href="token.cs.html#748bd58514848bc8" class="i property">FormatString</a>, <span class="r796 r">nestedExpressions</span>);
            }
            <b>else</b>
            {
                <span class="r795 r">expr</span> = <b>new</b> <a href="ast.cs.html#e7861490ceaad5be" class="t constructor">StringConstantExpressionAst</a>(<span class="r794 r">strToken</span>);
            }
 
            <b>return</b> <span class="r795 r">expr</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="764450b4806fc062" href="../../R/764450b4806fc062.html" target="n" data-glyph="76,1" class="i method">MemberNameRule</a>()
        {
            <span class="c">// G  member-name:</span>
            <span class="c">// G      simple-name</span>
            <span class="c">// G      string-literal</span>
            <span class="c">// G      string-literal-with-subexpression</span>
            <span class="c">// G      expression-with-unary-operator</span>
            <span class="c">// G      value</span>
 
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r797 rd" class="r797 r">simpleName</span> = <a href="#942135886d841ed5" class="i method">SimpleNameRule</a>();
            <b>if</b> (<span class="r797 r">simpleName</span> != <b>null</b>)
            {
                <b>return</b> <span class="r797 r">simpleName</span>;
            }
 
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r798 rd" class="r798 r">token</span> = <a href="#ea786851e84d8cea" class="i method">PeekToken</a>();
            <b>if</b> (<span class="r798 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a>.<a href="token.cs.html#84def6774d758bed" class="i method">HasTrait</a>(<a href="token.cs.html#fb1c35b7167e0165" class="t t">TokenFlags</a>.<a href="token.cs.html#84cb73ac24504e0d" class="i field">UnaryOperator</a>) || <span class="r798 r">token</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#a46f33927cda3a6d" class="i field">LBracket</a>)
            {
                <b>return</b> <a href="#8b954079b3dc7b2c" class="i method">UnaryExpressionRule</a>();
            }
 
            <b>return</b> <a href="#b835651f99e7555e" class="i method">PrimaryExpressionRule</a>(<span class="r671 r">withMemberAccess</span>: <b>false</b>);
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="c1aa074866e2a3cb" href="../../R/c1aa074866e2a3cb.html" target="n" data-glyph="76,1" class="i method">MemberAccessRule</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r799 rd" class="r799 r">targetExpr</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r800 rd" class="r800 r">operatorToken</span>)
        {
            <span class="c">// G  member-access: No whitespace is allowed between terms in these productions.</span>
            <span class="c">// G      primary-expression   &#39;.&#39;   member-name</span>
            <span class="c">// G      primary-expression   &#39;::&#39;   member-name</span>
 
            <span class="c">// On entry, we&#39;ve verified that operatorToken is not preceded by whitespace.</span>
 
            <a href="ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r801 rd" class="r801 r">member</span> = <a href="#764450b4806fc062" class="i method">MemberNameRule</a>();
 
            <b>if</b> (<span class="r801 r">member</span> == <b>null</b>)
            {
                <span class="c">// ErrorRecovery: pretend we saw a property name, don&#39;t bother looking for an invocation,</span>
                <span class="c">// and keep parsing.</span>
 
                <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r800 r">operatorToken</span>),
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingPropertyName</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingPropertyName</span>);
                <span class="r801 r">member</span> = <a href="#6ab87e657667a8ae" class="i method">GetSingleCommandArgument</a>(<a href="#d353212a396b4c0a" class="t t">CommandArgumentContext</a>.<a href="#87392123862baf4c" class="i field">CommandArgument</a>) ??
                    <b>new</b> <a href="ast.cs.html#521987ae533dc4bd" class="t constructor">ErrorExpressionAst</a>(<a href="#4ad82407bcef8f0d" class="i method">ExtentOf</a>(<span class="r799 r">targetExpr</span>, <span class="r800 r">operatorToken</span>));
            }
            <b>else</b>
            {
                <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r802 rd" class="r802 r">lParen</span> = <a href="#278d93d6ea13c290" class="i method">NextInvokeMemberToken</a>();
                <b>if</b> (<span class="r802 r">lParen</span> != <b>null</b>)
                {
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r802 r">lParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a> || <span class="r802 r">lParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#f560e2d72b308a07" class="i field">LCurly</a>, <span class="s">&quot;token kind incorrect&quot;</span>);
                    <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r801 r">member</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>.<a href="Position.cs.html#155675f601d14734" class="i property">EndColumnNumber</a> == <span class="r802 r">lParen</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>.<a href="Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>,
                                       <span class="s">&quot;member and paren must be adjacent&quot;</span>);
                    <b>return</b> <a href="#05d64d5060a03f4c" class="i method">MemberInvokeRule</a>(<span class="r799 r">targetExpr</span>, <span class="r802 r">lParen</span>, <span class="r800 r">operatorToken</span>, <span class="r801 r">member</span>);
                }
            }
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#123e2cd4ddcd7c76" class="t constructor">MemberExpressionAst</a>(
                    <a href="#f4b9cf4dcd548ea3" class="i method">ExtentOf</a>(<span class="r799 r">targetExpr</span>, <span class="r801 r">member</span>),
                    <span class="r799 r">targetExpr</span>,
                    <span class="r801 r">member</span>,
                    <span class="r803 r">@static</span>: <span class="r800 r">operatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ba396ba04fe0fde5" class="i field">ColonColon</a>,
                    <span class="r804 r">nullConditional</span>: <span class="r800 r">operatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#97da13a8bbbf83e2" class="i field">QuestionDot</a>);
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="05d64d5060a03f4c" href="../../R/05d64d5060a03f4c.html" target="n" data-glyph="76,1" class="i method">MemberInvokeRule</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r805 rd" class="r805 r">targetExpr</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r806 rd" class="r806 r">lBracket</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r807 rd" class="r807 r">operatorToken</span>, <a href="ast.cs.html#22790ae48f5438c6" class="t t">CommandElementAst</a> <span id="r808 rd" class="r808 r">member</span>)
        {
            <span class="c">// G  invocation-expression: target-expression passed as a parameter. lBracket can be &#39;(&#39; or &#39;{&#39;.</span>
            <span class="c">// G      target-expression   member-name   invoke-param-list</span>
            <span class="c">// G  invoke-param-list:</span>
            <span class="c">// G      &#39;(&#39;   invoke-param-paren-list</span>
            <span class="c">// G      script-block</span>
 
            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r809 rd" class="r809 r">lastExtent</span> = <b>null</b>;
 
            <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r810 rd" class="r810 r">arguments</span>;
            <b>if</b> (<span class="r806 r">lBracket</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#9784d220b8ac50f2" class="i field">LParen</a>)
            {
                <span class="r810 r">arguments</span> = <a href="#bbf5e856fb3215c5" class="k">this</a>.<a href="#b2cf3f2831888cd8" class="i method">InvokeParamParenListRule</a>(<span class="r806 r">lBracket</span>, <b>out</b> <span class="r809 r">lastExtent</span>);
            }
            <b>else</b>
            {
                <span class="r810 r">arguments</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;();
                <span class="c">// handle the construct $x.methodName{2+2} as through it had been written $x.methodName({2+2})</span>
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r811 rd" class="r811 r">argument</span> = <a href="#6042c9a5e817fc8e" class="i method">ScriptBlockExpressionRule</a>(<span class="r806 r">lBracket</span>);
                <span class="r810 r">arguments</span>.<span class="i">Add</span>(<span class="r811 r">argument</span>);
                <span class="r809 r">lastExtent</span> = <span class="r811 r">argument</span>.<a href="ast.cs.html#d9d5cd324ee61136" class="i property">Extent</a>;
            }
 
            <b>return</b> <b>new</b> <span class="t">InvokeMemberExpressionAst</span>(
                <a href="#a571f93282f04222" class="i method">ExtentOf</a>(<span class="r805 r">targetExpr</span>, <span class="r809 r">lastExtent</span>),
                <span class="r805 r">targetExpr</span>,
                <span class="r808 r">member</span>,
                <span class="r810 r">arguments</span>,
                <span class="r807 r">operatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ba396ba04fe0fde5" class="i field">ColonColon</a>,
                <span class="r807 r">operatorToken</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#97da13a8bbbf83e2" class="i field">QuestionDot</a>);
        }
 
        <b>private</b> <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <a id="b2cf3f2831888cd8" href="../../R/b2cf3f2831888cd8.html" target="n" data-glyph="76,1" class="i method">InvokeParamParenListRule</a>(<a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r812 rd" class="r812 r">lParen</span>, <b>out</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r813 rd" class="r813 r">lastExtent</span>)
        {
            <span class="c">// G  argument-list: &#39;(&#39; is passed in lParen</span>
            <span class="c">// G      argument-expression-list:opt   new-lines:opt   &#39;)&#39;</span>
            <span class="c">// G  argument-expression-list:</span>
            <span class="c">// G      argument-expression</span>
            <span class="c">// G      argument-expression   new-lines:opt   &#39;,&#39;   argument-expression-list</span>
            <span class="c">// G  argument-expression:</span>
            <span class="c">// G      See grammar for expression - the only difference is that an</span>
            <span class="c">// G      array-literal-expression is not allowed - the comma is used</span>
            <span class="c">// G      to separate argument-expressions.</span>
 
            <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt; <span id="r814 rd" class="r814 r">arguments</span> = <b>new</b> <span class="i">List</span>&lt;<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a>&gt;();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r815 rd" class="r815 r">comma</span> = <b>null</b>;
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r816 rd" class="r816 r">rParen</span> = <b>null</b>;
 
            <b>bool</b> <span id="r817 rd" class="r817 r">oldDisableCommaOperator</span> = <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a>;
            <b>bool</b> <span id="r818 rd" class="r818 r">reportedError</span> = <b>false</b>;
 
            <b>try</b>
            {
                <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <b>true</b>;
 
                <b>while</b> (<b>true</b>)
                {
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r819 rd" class="r819 r">argument</span> = <a href="#8da955af7d659a21" class="i method">ExpressionRule</a>();
                    <b>if</b> (<span class="r819 r">argument</span> == <b>null</b>)
                    {
                        <b>if</b> (<span class="r815 r">comma</span> != <b>null</b>)
                        {
                            <span class="c">// ErrorRecovery: sync at closing paren or newline.</span>
 
                            <span class="i">ReportIncompleteInput</span>(<a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r815 r">comma</span>),
                                <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterToken</span>),
                                <span class="i">ParserStrings</span>.<span class="i">MissingExpressionAfterToken</span>,
                                <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>.<a href="token.cs.html#7fc630435d0dbb33" class="i method">Text</a>());
                            <span class="r818 r">reportedError</span> = <b>true</b>;
                        }
 
                        <b>break</b>;
                    }
 
                    <span class="r814 r">arguments</span>.<span class="i">Add</span>(<span class="r819 r">argument</span>);
 
                    <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                    <span class="r815 r">comma</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                    <b>if</b> (<span class="r815 r">comma</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#214bb2e1d5690022" class="i field">Comma</a>)
                    {
                        <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r815 r">comma</span>);
                        <span class="r815 r">comma</span> = <b>null</b>;
                        <b>break</b>;
                    }
                }
 
                <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
                <span class="r816 r">rParen</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
                <b>if</b> (<span class="r816 r">rParen</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#33afcffc839d1905" class="i field">RParen</a>)
                {
                    <span class="c">// ErrorRecovery: pretend we saw a closing paren or curly and keep parsing.</span>
 
                    <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r816 r">rParen</span>);
                    <b>if</b> (!<span class="r818 r">reportedError</span>)
                    {
                        <span class="i">ReportIncompleteInput</span>(<span class="r814 r">arguments</span>.<span class="i">Count</span> &gt; 0 ? <span class="i">After</span>(<span class="r814 r">arguments</span>.<span class="i">Last</span>()) : <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r812 r">lParen</span>),
                            <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInMethodCall</span>),
                            <span class="i">ParserStrings</span>.<span class="i">MissingEndParenthesisInMethodCall</span>);
                    }
 
                    <span class="r816 r">rParen</span> = <b>null</b>;
                }
            }
            <b>finally</b>
            {
                <a href="#c988d1d8cef04ca7" class="i field">_disableCommaOperator</a> = <span class="r817 r">oldDisableCommaOperator</span>;
            }
 
            <span class="r813 r">lastExtent</span> = <span class="i">ExtentFromFirstOf</span>(<span class="r816 r">rParen</span>, <span class="r815 r">comma</span>, <span class="r814 r">arguments</span>.<span class="i">LastOrDefault</span>(), <span class="r812 r">lParen</span>);
            <b>return</b> <span class="r814 r">arguments</span>;
        }
 
        <b>private</b> <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <a id="512a999922c25da3" href="../../R/512a999922c25da3.html" target="n" data-glyph="76,1" class="i method">ElementAccessRule</a>(<a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r820 rd" class="r820 r">primaryExpression</span>, <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r821 rd" class="r821 r">lBracket</span>)
        {
            <span class="c">// G  element-access:</span>
            <span class="c">// G      primary-expression   &#39;[&#39;   new-lines:opt   expression   new-lines:opt   &#39;]&#39;</span>
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="ast.cs.html#78a833319fe635b4" class="t t">ExpressionAst</a> <span id="r822 rd" class="r822 r">indexExpr</span> = <a href="#8da955af7d659a21" class="i method">ExpressionRule</a>();
            <b>if</b> (<span class="r822 r">indexExpr</span> == <b>null</b>)
            {
                <span class="c">// ErrorRecovery: hope we see a closing bracket.  If we don&#39;t, we&#39;ll pretend we saw</span>
                <span class="c">// the closing bracket, but build an expression that can&#39;t compile.</span>
 
                <a href="Position.cs.html#bbc751d075344454" class="k">var</a> <span id="r823 rd" class="r823 r">errorExtent</span> = <a href="#c46b3b53010f50d6" class="i method">After</a>(<span class="r821 r">lBracket</span>);
                <span class="i">ReportIncompleteInput</span>(
                    <span class="r823 r">errorExtent</span>,
                    <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingArrayIndexExpression</span>),
                    <span class="i">ParserStrings</span>.<span class="i">MissingArrayIndexExpression</span>);
                <span class="r822 r">indexExpr</span> = <b>new</b> <a href="ast.cs.html#521987ae533dc4bd" class="t constructor">ErrorExpressionAst</a>(<span class="r821 r">lBracket</span>.<a href="token.cs.html#f26f26676a7c22a1" class="i property">Extent</a>);
            }
 
            <a href="#b262a345f728b573" class="i method">SkipNewlines</a>();
            <a href="token.cs.html#ec5d9ac6a36d920c" class="t t">Token</a> <span id="r824 rd" class="r824 r">rBracket</span> = <a href="#98aafb96cd3508ac" class="i method">NextToken</a>();
            <b>if</b> (<span class="r824 r">rBracket</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> != <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#e50e68a5c0f39895" class="i field">RBracket</a>)
            {
                <span class="c">// ErrorRecovery: just pretend we had a closing bracket and continue parsing.</span>
 
                <a href="#b64e60a764c9d1ee" class="i method">UngetToken</a>(<span class="r824 r">rBracket</span>);
                <span class="c">// Skip reporting the error if we&#39;ve already reported a missing index.</span>
                <b>if</b> (<span class="r822 r">indexExpr</span> <b>is not</b> <a href="ast.cs.html#bdf2b3276843e0c2" class="t t">ErrorExpressionAst</a>)
                {
                    <span class="i">ReportIncompleteInput</span>(<a href="#40407f0b4b50ace7" class="i method">After</a>(<span class="r822 r">indexExpr</span>),
                        <b>nameof</b>(<span class="i">ParserStrings</span>.<span class="i">MissingEndSquareBracket</span>),
                        <span class="i">ParserStrings</span>.<span class="i">MissingEndSquareBracket</span>);
                }
 
                <span class="r824 r">rBracket</span> = <b>null</b>;
            }
 
            <b>return</b> <b>new</b> <a href="ast.cs.html#feffe271856401b8" class="t constructor">IndexExpressionAst</a>(<a href="#a571f93282f04222" class="i method">ExtentOf</a>(<span class="r820 r">primaryExpression</span>, <a href="#98f9e5041badc0fc" class="i method">ExtentFromFirstOf</a>(<span class="r824 r">rBracket</span>, <span class="r822 r">indexExpr</span>)), <span class="r820 r">primaryExpression</span>, <span class="r822 r">indexExpr</span>, <span class="r821 r">lBracket</span>.<a href="token.cs.html#520c1782d294a73a" class="i property">Kind</a> == <a href="token.cs.html#a2b5a7fabb06263c" class="t t">TokenKind</a>.<a href="token.cs.html#ccf850170f25476f" class="i field">QuestionLBracket</a>);
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Expressions
 
        <span class="k preprocess">#</span><span class="k preprocess">region</span> Error Reporting
 
        <b>private void</b> <a id="4aea0b4d98961aac" href="../../R/4aea0b4d98961aac.html" target="n" data-glyph="76,1" class="i method">SaveError</a>(<a href="#3b2ee49e322daa35" class="t t">ParseError</a> <span id="r825 rd" class="r825 r">error</span>)
        {
            <b>if</b> (<a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Count</span> &gt; 0)
            {
                <b>foreach</b> (<a href="#3b2ee49e322daa35" class="t t">ParseError</a> <span id="r826 rd" class="r826 r">err</span> <b>in</b> <a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a>)
                {
                    <b>if</b> (<span class="r826 r">err</span>.<a href="#155f5c3671507bb6" class="i property">ErrorId</a>.<span class="i">Equals</span>(<span class="r825 r">error</span>.<a href="#155f5c3671507bb6" class="i property">ErrorId</a>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>)
                        &amp;&amp; <span class="r826 r">err</span>.<a href="#2346ecbe464834f8" class="i property">Extent</a>.<a href="Position.cs.html#155675f601d14734" class="i property">EndColumnNumber</a> == <span class="r825 r">error</span>.<a href="#2346ecbe464834f8" class="i property">Extent</a>.<a href="Position.cs.html#155675f601d14734" class="i property">EndColumnNumber</a>
                        &amp;&amp; <span class="r826 r">err</span>.<a href="#2346ecbe464834f8" class="i property">Extent</a>.<a href="Position.cs.html#ccd649a5269e237d" class="i property">EndLineNumber</a> == <span class="r825 r">error</span>.<a href="#2346ecbe464834f8" class="i property">Extent</a>.<a href="Position.cs.html#ccd649a5269e237d" class="i property">EndLineNumber</a>
                        &amp;&amp; <span class="r826 r">err</span>.<a href="#2346ecbe464834f8" class="i property">Extent</a>.<a href="Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a> == <span class="r825 r">error</span>.<a href="#2346ecbe464834f8" class="i property">Extent</a>.<a href="Position.cs.html#8fcbdc214acf2f0f" class="i property">StartColumnNumber</a>
                        &amp;&amp; <span class="r826 r">err</span>.<a href="#2346ecbe464834f8" class="i property">Extent</a>.<a href="Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a> == <span class="r825 r">error</span>.<a href="#2346ecbe464834f8" class="i property">Extent</a>.<a href="Position.cs.html#cc356dc28b41997d" class="i property">StartLineNumber</a>)
                    {
                        <b>return</b>;
                    }
                }
            }
 
            <a href="#e8f5d233c7c0eda2" class="i property">ErrorList</a>.<span class="i">Add</span>(<span class="r825 r">error</span>);
        }
 
        <b>private void</b> <a id="e1476fdc1f728fb7" href="../../R/e1476fdc1f728fb7.html" target="n" data-glyph="76,1" class="i method">SaveError</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r827 rd" class="r827 r">extent</span>, <b>string</b> <span id="r828 rd" class="r828 r">errorId</span>, <b>string</b> <span id="r829 rd" class="r829 r">errorMsg</span>, <b>bool</b> <span id="r830 rd" class="r830 r">incompleteInput</span>, <b>params object</b>[] <span id="r831 rd" class="r831 r">args</span>)
        {
            <a href="#fbc452ed050bae6f" class="i method">AssertErrorIdCorrespondsToMsgString</a>(<span class="r828 r">errorId</span>, <span class="r829 r">errorMsg</span>);
 
            <b>if</b> (<span class="r831 r">args</span> != <b>null</b> &amp;&amp; <span class="r831 r">args</span>.<span class="i">Length</span> &gt; 0)
            {
                <span class="r829 r">errorMsg</span> = <b>string</b>.<span class="i">Format</span>(<span class="i">CultureInfo</span>.<span class="i">CurrentCulture</span>, <span class="r829 r">errorMsg</span>, <span class="r831 r">args</span>);
            }
 
            <a href="#3b2ee49e322daa35" class="t t">ParseError</a> <span id="r832 rd" class="r832 r">errorToSave</span> = <b>new</b> <a href="#e3c8f7017ca851dc" class="t constructor">ParseError</a>(<span class="r827 r">extent</span>, <span class="r828 r">errorId</span>, <span class="r829 r">errorMsg</span>, <span class="r830 r">incompleteInput</span>);
            <a href="#4aea0b4d98961aac" class="i method">SaveError</a>(<span class="r832 r">errorToSave</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Debug assertion to ensure that all errors saved by the parser come</span>
        <span class="c">///</span><span class="c"> from resource (.resx) files.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r833 r">errorId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The error ID string (.resx key).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r834 r">errorMsg</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The error message, which may be a template string (.resx value).</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        [<span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Conditional</span>(<span class="s">&quot;DEBUG&quot;</span>)]
        [<span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i">Conditional</span>(<span class="s">&quot;ASSERTIONS_TRACE&quot;</span>)]
        <b>private static void</b> <a id="fbc452ed050bae6f" href="../../R/fbc452ed050bae6f.html" target="n" data-glyph="76,1" class="i method">AssertErrorIdCorrespondsToMsgString</a>(<b>string</b> <span id="r833 rd" class="r833 r">errorId</span>, <b>string</b> <span id="r834 rd" class="r834 r">errorMsg</span>)
        {
            <span class="c">// These types are the ones known to contain</span>
            <span class="c">// strings used by the parser as errors</span>
            <span class="i">Type</span>[] <span id="r835 rd" class="r835 r">resxTypes</span> = <b>new</b>[]
            {
                <b>typeof</b>(<span class="i">ParserStrings</span>),
                <b>typeof</b>(<span class="i">DiscoveryExceptions</span>),
                <b>typeof</b>(<span class="i">ExtendedTypeSystem</span>),
                <b>typeof</b>(<span class="i">MshSnapInCmdletResources</span>),
                <b>typeof</b>(<span class="i">ParameterBinderStrings</span>)
            };
 
            <span class="c">// Go through each resource type and see if the errorId key is in it, and whether the value corresponds to the errorMsg</span>
            <b>bool</b> <span id="r836 rd" class="r836 r">msgCorrespondsToString</span> = <b>false</b>;
            <b>foreach</b> (<span class="i">Type</span> <span id="r837 rd" class="r837 r">resxType</span> <b>in</b> <span class="r835 r">resxTypes</span>)
            {
                <b>string</b> <span id="r838 rd" class="r838 r">resxErrorBody</span> = <span class="r837 r">resxType</span>.<span class="i">GetProperty</span>(<span class="r833 r">errorId</span>, <span class="i">BindingFlags</span>.<span class="i">Static</span> | <span class="i">BindingFlags</span>.<span class="i">NonPublic</span>)?.<span class="i">GetValue</span>(<b>null</b>) <b>as string</b>;
                <b>if</b> (<b>string</b>.<span class="i">Equals</span>(<span class="r834 r">errorMsg</span>, <span class="r838 r">resxErrorBody</span>, <span class="i">StringComparison</span>.<span class="i">Ordinal</span>))
                {
                    <span class="r836 r">msgCorrespondsToString</span> = <b>true</b>;
                    <b>break</b>;
                }
            }
 
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(<span class="r836 r">msgCorrespondsToString</span>, <b>string</b>.<span class="i">Format</span>(<span class="s">&quot;Parser error ID \&quot;{0}\&quot; must correspond to the error message \&quot;{1}\&quot;&quot;</span>, <span class="r833 r">errorId</span>, <span class="r834 r">errorMsg</span>));
        }
 
        <b>private static object</b>[] <a id="563710ec33acaeee" href="../../R/563710ec33acaeee.html" target="n" data-glyph="106,1" class="i property">arrayOfOneArg</a>
        {
            <b>get</b> { <b>return</b> <a href="#ad2f96cc101d8ee3" class="i field">t_arrayOfOneArg</a> ??= <b>new</b> <b>object</b>[1]; }
        }
 
        [<span class="i">ThreadStatic</span>]
        <b>private static object</b>[] <a id="ad2f96cc101d8ee3" href="../../R/ad2f96cc101d8ee3.html" target="n" data-glyph="46,1" class="i field">t_arrayOfOneArg</a>;
 
        <b>private static object</b>[] <a id="4248c3c346c534e9" href="../../R/4248c3c346c534e9.html" target="n" data-glyph="106,1" class="i property">arrayOfTwoArgs</a>
        {
            <b>get</b> { <b>return</b> <a href="#b8f29c221e9c56b1" class="i field">t_arrayOfTwoArgs</a> ??= <b>new</b> <b>object</b>[2]; }
        }
 
        [<span class="i">ThreadStatic</span>]
        <b>private static object</b>[] <a id="b8f29c221e9c56b1" href="../../R/b8f29c221e9c56b1.html" target="n" data-glyph="46,1" class="i field">t_arrayOfTwoArgs</a>;
 
        <b>internal bool</b> <a id="d4db672ef75b7aa3" href="../../R/d4db672ef75b7aa3.html" target="n" data-glyph="74,1" class="i method">ReportIncompleteInput</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r839 rd" class="r839 r">extent</span>, <b>string</b> <span id="r840 rd" class="r840 r">errorId</span>, <b>string</b> <span id="r841 rd" class="r841 r">errorMsg</span>)
        {
            <span class="c">// If the error position isn&#39;t at the end of the input, then we don&#39;t want to mark the error</span>
            <span class="c">// as incomplete input.</span>
            <b>bool</b> <span id="r842 rd" class="r842 r">incompleteInput</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#a297aca912bee2fe" class="i method">IsAtEndOfScript</a>(<span class="r839 r">extent</span>, <span class="r843 r">checkCommentsAndWhitespace</span>: <b>true</b>);
            <a href="#e1476fdc1f728fb7" class="i method">SaveError</a>(<span class="r839 r">extent</span>, <span class="r840 r">errorId</span>, <span class="r841 r">errorMsg</span>, <span class="r842 r">incompleteInput</span>, <b>null</b>);
            <b>return</b> <span class="r842 r">incompleteInput</span>;
        }
 
        <b>internal bool</b> <a id="b65021a43ed8265f" href="../../R/b65021a43ed8265f.html" target="n" data-glyph="74,1" class="i method">ReportIncompleteInput</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r844 rd" class="r844 r">extent</span>, <b>string</b> <span id="r845 rd" class="r845 r">errorId</span>, <b>string</b> <span id="r846 rd" class="r846 r">errorMsg</span>, <b>object</b> <span id="r847 rd" class="r847 r">arg</span>)
        {
            <span class="c">// If the error position isn&#39;t at the end of the input, then we don&#39;t want to mark the error</span>
            <span class="c">// as incomplete input.</span>
            <b>bool</b> <span id="r848 rd" class="r848 r">incompleteInput</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#a297aca912bee2fe" class="i method">IsAtEndOfScript</a>(<span class="r844 r">extent</span>, <span class="r843 r">checkCommentsAndWhitespace</span>: <b>true</b>);
            <a href="#563710ec33acaeee" class="i property">arrayOfOneArg</a>[0] = <span class="r847 r">arg</span>;
            <a href="#e1476fdc1f728fb7" class="i method">SaveError</a>(<span class="r844 r">extent</span>, <span class="r845 r">errorId</span>, <span class="r846 r">errorMsg</span>, <span class="r848 r">incompleteInput</span>, <a href="#563710ec33acaeee" class="i property">arrayOfOneArg</a>);
            <b>return</b> <span class="r848 r">incompleteInput</span>;
        }
 
        <b>internal bool</b> <a id="d8cdf029ddc6c03a" href="../../R/d8cdf029ddc6c03a.html" target="n" data-glyph="74,1" class="i method">ReportIncompleteInput</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r849 rd" class="r849 r">errorPosition</span>,
                                            <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r850 rd" class="r850 r">errorDetectedPosition</span>,
                                            <b>string</b> <span id="r851 rd" class="r851 r">errorId</span>,
                                            <b>string</b> <span id="r852 rd" class="r852 r">errorMsg</span>,
                                            <b>params object</b>[] <span id="r853 rd" class="r853 r">args</span>)
        {
            <span class="c">// If the error position isn&#39;t at the end of the input, then we don&#39;t want to mark the error</span>
            <span class="c">// as incomplete input.</span>
            <b>bool</b> <span id="r854 rd" class="r854 r">incompleteInput</span> = <a href="#9f3418a9634d9789" class="i field">_tokenizer</a>.<a href="tokenizer.cs.html#a297aca912bee2fe" class="i method">IsAtEndOfScript</a>(<span class="r850 r">errorDetectedPosition</span>, <span class="r843 r">checkCommentsAndWhitespace</span>: <b>true</b>);
            <a href="#e1476fdc1f728fb7" class="i method">SaveError</a>(<span class="r849 r">errorPosition</span>, <span class="r851 r">errorId</span>, <span class="r852 r">errorMsg</span>, <span class="r854 r">incompleteInput</span>, <span class="r853 r">args</span>);
            <b>return</b> <span class="r854 r">incompleteInput</span>;
        }
 
        <b>internal void</b> <a id="54fe0fe51414c862" href="../../R/54fe0fe51414c862.html" target="n" data-glyph="74,1" class="i method">ReportError</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r855 rd" class="r855 r">extent</span>, <b>string</b> <span id="r856 rd" class="r856 r">errorId</span>, <b>string</b> <span id="r857 rd" class="r857 r">errorMsg</span>)
        {
            <a href="#e1476fdc1f728fb7" class="i method">SaveError</a>(<span class="r855 r">extent</span>, <span class="r856 r">errorId</span>, <span class="r857 r">errorMsg</span>, <b>false</b>, <b>null</b>);
        }
 
        <b>internal void</b> <a id="a6ce762ed9f70927" href="../../R/a6ce762ed9f70927.html" target="n" data-glyph="74,1" class="i method">ReportError</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r858 rd" class="r858 r">extent</span>, <b>string</b> <span id="r859 rd" class="r859 r">errorId</span>, <b>string</b> <span id="r860 rd" class="r860 r">errorMsg</span>, <b>object</b> <span id="r861 rd" class="r861 r">arg</span>)
        {
            <a href="#563710ec33acaeee" class="i property">arrayOfOneArg</a>[0] = <span class="r861 r">arg</span>;
            <a href="#e1476fdc1f728fb7" class="i method">SaveError</a>(<span class="r858 r">extent</span>, <span class="r859 r">errorId</span>, <span class="r860 r">errorMsg</span>, <b>false</b>, <a href="#563710ec33acaeee" class="i property">arrayOfOneArg</a>);
        }
 
        <b>internal void</b> <a id="98f97ba3d90cdd5e" href="../../R/98f97ba3d90cdd5e.html" target="n" data-glyph="74,1" class="i method">ReportError</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r862 rd" class="r862 r">extent</span>, <b>string</b> <span id="r863 rd" class="r863 r">errorId</span>, <b>string</b> <span id="r864 rd" class="r864 r">errorMsg</span>, <b>object</b> <span id="r865 rd" class="r865 r">arg1</span>, <b>object</b> <span id="r866 rd" class="r866 r">arg2</span>)
        {
            <a href="#4248c3c346c534e9" class="i property">arrayOfTwoArgs</a>[0] = <span class="r865 r">arg1</span>;
            <a href="#4248c3c346c534e9" class="i property">arrayOfTwoArgs</a>[1] = <span class="r866 r">arg2</span>;
            <a href="#e1476fdc1f728fb7" class="i method">SaveError</a>(<span class="r862 r">extent</span>, <span class="r863 r">errorId</span>, <span class="r864 r">errorMsg</span>, <b>false</b>, <a href="#4248c3c346c534e9" class="i property">arrayOfTwoArgs</a>);
        }
 
        <b>internal void</b> <a id="681390f471bef368" href="../../R/681390f471bef368.html" target="n" data-glyph="74,1" class="i method">ReportError</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r867 rd" class="r867 r">extent</span>, <b>string</b> <span id="r868 rd" class="r868 r">errorId</span>, <b>string</b> <span id="r869 rd" class="r869 r">errorMsg</span>, <b>params object</b>[] <span id="r870 rd" class="r870 r">args</span>)
        {
            <a href="#e1476fdc1f728fb7" class="i method">SaveError</a>(<span class="r867 r">extent</span>, <span class="r868 r">errorId</span>, <span class="r869 r">errorMsg</span>, <b>false</b>, <span class="r870 r">args</span>);
        }
 
        <b>internal void</b> <a id="67620d15942976b8" href="../../R/67620d15942976b8.html" target="n" data-glyph="74,1" class="i method">ReportError</a>(<a href="#3b2ee49e322daa35" class="t t">ParseError</a> <span id="r871 rd" class="r871 r">error</span>)
        {
            <a href="#4aea0b4d98961aac" class="i method">SaveError</a>(<span class="r871 r">error</span>);
        }
 
        <b>private static void</b> <a id="df37c3c8d2644618" href="../../R/df37c3c8d2644618.html" target="n" data-glyph="76,1" class="i method">ReportErrorsAsWarnings</a>(<span class="i">Collection</span>&lt;<span class="i">Exception</span>&gt; <span id="r872 rd" class="r872 r">errors</span>)
        {
            <a href="../ExecutionContext.cs.html#130bda5418e8559c" class="k">var</a> <span id="r873 rd" class="r873 r">executionContext</span> = <span class="i n">Runspaces</span>.<a href="../hostifaces/Connection.cs.html#7e5b8eab1aa16fd7" class="t t">Runspace</a>.<a href="../hostifaces/Connection.cs.html#efcd2ba43103de17" class="i property">DefaultRunspace</a>.<a href="../hostifaces/Connection.cs.html#3a36e24a88649363" class="i property">ExecutionContext</a>;
            <b>if</b> (<span class="r873 r">executionContext</span> != <b>null</b> &amp;&amp; <span class="r873 r">executionContext</span>.<a href="../ExecutionContext.cs.html#ad328d08127401c1" class="i property">InternalHost</a> != <b>null</b> &amp;&amp; <span class="r873 r">executionContext</span>.<a href="../ExecutionContext.cs.html#ad328d08127401c1" class="i property">InternalHost</a>.<a href="../hostifaces/InternalHost.cs.html#d35ea6d8b175fa76" class="i property">UI</a> != <b>null</b>)
            {
                <b>foreach</b> (<b>var</b> <span id="r874 rd" class="r874 r">error</span> <b>in</b> <span class="r872 r">errors</span>)
                {
                    <b>if</b> (<span class="r874 r">error</span> != <b>null</b>)
                    {
                        <span class="r873 r">executionContext</span>.<a href="../ExecutionContext.cs.html#ad328d08127401c1" class="i property">InternalHost</a>.<a href="../hostifaces/InternalHost.cs.html#d35ea6d8b175fa76" class="i property">UI</a>.<span class="i">WriteWarningLine</span>(<span class="r874 r">error</span>.<span class="i">ToString</span>());
                    }
                }
            }
        }
 
        <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Error Reporting
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">region</span> Error related classes
 
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
    <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
    <b>public class</b> <a id="3b2ee49e322daa35" href="../../R/3b2ee49e322daa35.html" target="n" data-glyph="0,0" class="t t">ParseError</a>
    {
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Creates a new parse error.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r875 r">extent</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The IScriptExtent that represents the location of the error.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r876 r">errorId</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The error ID to associate with the error.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span> <span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r877 r">message</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">The message of the error.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
        <b>public</b> <a id="eb0f2f05b24bdb0e" href="../../R/eb0f2f05b24bdb0e.html" target="n" data-glyph="72,1" class="t constructor">ParseError</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r875 rd" class="r875 r">extent</span>, <b>string</b> <span id="r876 rd" class="r876 r">errorId</span>, <b>string</b> <span id="r877 rd" class="r877 r">message</span>)
            : <a href="#e3c8f7017ca851dc" class="k">this</a>(<span class="r875 r">extent</span>, <span class="r876 r">errorId</span>, <span class="r877 r">message</span>, <b>false</b>)
        {
        }
 
        <b>internal</b> <a id="e3c8f7017ca851dc" href="../../R/e3c8f7017ca851dc.html" target="n" data-glyph="74,1" class="t constructor">ParseError</a>(<a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <span id="r878 rd" class="r878 r">extent</span>, <b>string</b> <span id="r879 rd" class="r879 r">errorId</span>, <b>string</b> <span id="r880 rd" class="r880 r">message</span>, <b>bool</b> <span id="r881 rd" class="r881 r">incompleteInput</span>)
        {
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<a href="../../utils/assert.cs.html#703dade50a6809cd" class="i method">Assert</a>(<span class="r878 r">extent</span> != <b>null</b>, <span class="s">&quot;can&#39;t have a null position for a parse error&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r880 r">message</span>), <span class="s">&quot;can&#39;t have a null error message&quot;</span>);
            <a href="../../utils/assert.cs.html#c04955255430d32f" class="t t">Diagnostics</a>.<span class="i">Assert</span>(!<b>string</b>.<span class="i">IsNullOrEmpty</span>(<span class="r879 r">errorId</span>), <span class="s">&quot;can&#39;t have a null error id&quot;</span>);
 
            <a href="#2346ecbe464834f8" class="i property">Extent</a> = <span class="r878 r">extent</span>;
            <a href="#155f5c3671507bb6" class="i property">ErrorId</a> = <span class="r879 r">errorId</span>;
            <a href="#1f2eb421008e19b5" class="i property">Message</a> = <span class="r880 r">message</span>;
            <a href="#4d447a1bfcd822b6" class="i property">IncompleteInput</a> = <span class="r881 r">incompleteInput</span>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
        <b>public override string</b> <a id="58b8452033130dea" href="../../R/58b8452033130dea.html" target="n" data-glyph="72,1" class="i method">ToString</a>()
        {
            <b>return</b> <a href="Position.cs.html#5892e754643a6045" class="t t">PositionUtilities</a>.<a href="Position.cs.html#a5bde72c0431231a" class="i method">VerboseMessage</a>(<a href="#2346ecbe464834f8" class="i property">Extent</a>) + <span class="i">Environment</span>.<span class="i">NewLine</span> + <a href="#1f2eb421008e19b5" class="i property">Message</a>;
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public</b> <a href="Position.cs.html#bbc751d075344454" class="t t">IScriptExtent</a> <a id="2346ecbe464834f8" href="../../R/2346ecbe464834f8.html" target="n" data-glyph="102,1" class="i property">Extent</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="155f5c3671507bb6" href="../../R/155f5c3671507bb6.html" target="n" data-glyph="102,1" class="i property">ErrorId</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public string</b> <a id="1f2eb421008e19b5" href="../../R/1f2eb421008e19b5.html" target="n" data-glyph="102,1" class="i property">Message</a> { <b>get</b>; }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>public bool</b> <a id="4d447a1bfcd822b6" href="../../R/4d447a1bfcd822b6.html" target="n" data-glyph="102,1" class="i property">IncompleteInput</a> { <b>get</b>; }
    }
 
    <span class="k preprocess">#</span><span class="k preprocess">endregion</span> Error related classes
 
    <span class="c">// Guid is {eba789d9-533b-58d4-cd1f-2e6520e3a9c2}</span>
 
    [<span class="i">EventSource</span>(<span class="i">Name</span> = <span class="s">&quot;Microsoft-PowerShell-Parser&quot;</span>)]
    <b>internal class</b> <a id="ef505205d8f64188" href="../../R/ef505205d8f64188.html" target="n" data-glyph="2,0" class="t t"><span id="3a99c7192d7f2687">ParserEventSource</span></a> : <span class="i">EventSource</span>
    {
        <b>internal static readonly</b> <a href="#ef505205d8f64188" class="t t">ParserEventSource</a> <a id="10130af1551d9144" href="../../R/10130af1551d9144.html" target="n" data-glyph="44,1" class="i field">Log</a> = <b>new</b> <span class="t">ParserEventSource</span>();
 
        <b>internal const int</b> <a id="6f70152fd32781e1" href="../../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">MaxScriptLengthToLog</a> = 50;
 
        <b>public void</b> <a id="f95e0f0366a89f12" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">ParseStart</a>(<b>string</b> <span id="r882 rd" class="r882 r">FileName</span>, <b>int</b> <span id="r883 rd" class="r883 r">Length</span>) { <span class="i">WriteEvent</span>(1, <span class="r882 r">FileName</span>, <span class="r883 r">Length</span>); }
 
        <b>public void</b> <a id="903914159b6415e7" href="../../R/903914159b6415e7.html" target="n" data-glyph="72,1" class="i method">ParseStop</a>() { <span class="i">WriteEvent</span>(2); }
 
        <b>public void</b> <a id="0ed986f4938384f3" href="../../R/0ed986f4938384f3.html" target="n" data-glyph="72,1" class="i method">ResolveSymbolsStart</a>() { <span class="i">WriteEvent</span>(3); }
 
        <b>public void</b> <a id="d4d6de9d8d9c112c" href="../../R/d4d6de9d8d9c112c.html" target="n" data-glyph="72,1" class="i method">ResolveSymbolsStop</a>() { <span class="i">WriteEvent</span>(4); }
 
        <b>public void</b> <a id="8f10b17c4a508be7" href="../../R/8f10b17c4a508be7.html" target="n" data-glyph="72,1" class="i method">SemanticChecksStart</a>() { <span class="i">WriteEvent</span>(5); }
 
        <b>public void</b> <a id="c890e969e3d7b2bd" href="../../R/c890e969e3d7b2bd.html" target="n" data-glyph="72,1" class="i method">SemanticChecksStop</a>() { <span class="i">WriteEvent</span>(6); }
 
        <b>public void</b> <a id="e1d0f5d90e570c3e" href="../../R/e1d0f5d90e570c3e.html" target="n" data-glyph="72,1" class="i method">CheckSecurityStart</a>(<b>string</b> <span id="r884 rd" class="r884 r">FileName</span>) { <span class="i">WriteEvent</span>(7, <span class="r884 r">FileName</span>); }
 
        <b>public void</b> <a id="aa494aa06e3da34c" href="../../R/aa494aa06e3da34c.html" target="n" data-glyph="72,1" class="i method">CheckSecurityStop</a>(<b>string</b> <span id="r885 rd" class="r885 r">FileName</span>) { <span class="i">WriteEvent</span>(8, <span class="r885 r">FileName</span>); }
 
        <b>public void</b> <a id="384c72300cd29bd3" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">CompileStart</a>(<b>string</b> <span id="r886 rd" class="r886 r">FileName</span>, <b>int</b> <span id="r887 rd" class="r887 r">Length</span>, <b>bool</b> <span id="r888 rd" class="r888 r">Optimized</span>) { <span class="i">WriteEvent</span>(9, <span class="r886 r">FileName</span>, <span class="r887 r">Length</span>, <span class="r888 r">Optimized</span>); }
 
        <b>public void</b> <a id="b2b562f5afc6f3cf" href="../../R/b2b562f5afc6f3cf.html" target="n" data-glyph="72,1" class="i method">CompileStop</a>() { <span class="i">WriteEvent</span>(10); }
 
        <b>internal static string</b> <a id="299420625c4b9670" href="../../R/299420625c4b9670.html" target="n" data-glyph="74,1" class="i method">GetFileOrScript</a>(<b>string</b> <span id="r889 rd" class="r889 r">fileName</span>, <b>string</b> <span id="r890 rd" class="r890 r">input</span>)
        {
            <b>return</b> <span class="r889 r">fileName</span> ?? <span class="r890 r">input</span>.<span class="i">AsSpan</span>(0, <span class="i">Math</span>.<span class="i">Min</span>(256, <span class="r890 r">input</span>.<span class="i">Length</span>)).<span class="i">Trim</span>().<span class="i">ToString</span>();
        }
    }
}
</pre></td></tr></table></div></body></html>
